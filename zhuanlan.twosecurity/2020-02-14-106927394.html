<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>使用Burpsuite快速扫描授权漏洞</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/106927394">原文</a></p>
<div class="title-image"><img src="https://pic4.zhimg.com/v2-8f72bc83302e8bf7af69379937b40625_b.jpg" alt=""></div><p>Burpsuite 就不过多介绍了，今天来讲讲如何使用 Burpsuite 来快速扫描越权漏洞，提升工作效率的必备插件。</p><h2>AuthMatrix</h2><p>AuthMatrix 是 Burp Suite 的一个扩展插件，它提供了一种简单的方法来测试 Web 应用程序和 Web 服务中的授权功能。借助 AuthMatrix，渗透测试人员可以集中精力全面定义用户，角色和针对其特定目标应用程序的请求的表。这些表的结构与各种威胁建模方法中常见的访问控制矩阵的格式相似。</p><p>表格组装完成后，渗透测试人员可以使用简单的 web 界面启动角色和请求的所有组合。可通过易于阅读的彩色编码界面来确认结果，该界面指示系统中检测到的任何授权漏洞。此外，该扩展功能还可以保存和加载目标配置，以进行简单的回归测试。</p><blockquote>简单来说，它是用于检测权限授权问题的插件，设置好 session 就能进行自动化测试。</blockquote><p>插件项目地址：<a href="https://link.zhihu.com/?target=https%3A//github.com/SecurityInnovation/AuthMatrix" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">https://</span><span class="visible">github.com/SecurityInno</span><span class="invisible">vation/AuthMatrix</span><span class="ellipsis"></span></a></p><h2>安装</h2><p><b>一键安装</b></p><p>可以通过 BurpSuite 中的 BApp Store 安装 AuthMatrix。</p><p>【Extender】-&gt;【BApp Store】，找到 AuthMatrix，单击 【install】即可。</p><p><b>手动安装</b></p><p>下载项目中的 AuthMatrix.py。</p><p>下载地址：<a href="https://link.zhihu.com/?target=https%3A//github.com/SecurityInnovation/AuthMatrix" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">https://</span><span class="visible">github.com/SecurityInno</span><span class="invisible">vation/AuthMatrix</span><span class="ellipsis"></span></a></p><p>在 BurpSuite 中，【Extender】-&gt;【Add】，将扩展类型更改为 Python，然后选择刚下载的 python 文件即可安装。</p><h2>具体使用方法</h2><ul><li>点击 New Role，创建新角色（本例中有两个角色：super admin 和 admin）。</li><li>点击 New User，创建用户，用户名随意，方便区分即可（本例中使用了登陆邮箱）。</li><li>勾选用户对应的角色。</li><li>提取用户的唯一标识符填入 Session Token（推荐在登陆处抓包，使用 Repeater 构造不同用户的登陆请求获取各自的 cookie，如有多个 cookie 可用分号分隔）</li><li>在 Repeater 或 Proxy 的 HTTP History 处选择（按住 Control 键可多选）需要检测的 requests 后右键，选择 Send request to AuthMatrix。</li><li>回到 AuthMatrix 标签栏，更改 Success Regex 为合适的正则（本例中没权限访问时 response 里会有 errmsg，所以用了 errmsg，但默认的是 ^HTTP/1\.1 200 OK，所以每次都要手工改，比较麻烦）。</li><li>如果想检测全部的 requests，直接点最下面的 Run。如果想对单个 request 进行检测，在该 request 上右键选择 Run Request 即可（按 Control 多选同样适用）。</li><li>程序会自动将每个 request 里的 cookie 换成之前设置的同名 cookie，当 response 匹配到正则时，会出现红色，反之是绿色（蓝色是 session 过期）。</li></ul><blockquote>参考自：<a href="https://link.zhihu.com/?target=http%3A//0x0d.im/archives/how-to-use-burp-extension-authmatrix.html%3Futm_source%3Dtuicool%26utm_medium%3Dreferral" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">http://</span><span class="visible">0x0d.im/archives/how-to</span><span class="invisible">-use-burp-extension-authmatrix.html?utm_source=tuicool&amp;utm_medium=referral</span><span class="ellipsis"></span></a></blockquote><p><b>AuthMatrix示例配置</b></p><figure data-size="small"><noscript><img src="https://pic2.zhimg.com/v2-8f72bc83302e8bf7af69379937b40625_b.jpg" data-caption="" data-size="small" data-rawwidth="1266" data-rawheight="716" class="origin_image zh-lightbox-thumb" width="1266" data-original="https://pic2.zhimg.com/v2-8f72bc83302e8bf7af69379937b40625_r.jpg"/></noscript><img src="https://pic2.zhimg.com/v2-8f72bc83302e8bf7af69379937b40625_b.jpg" data-caption="" data-size="small" data-rawwidth="1266" data-rawheight="716" class="origin_image zh-lightbox-thumb lazy" width="1266" data-original="https://pic2.zhimg.com/v2-8f72bc83302e8bf7af69379937b40625_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-8f72bc83302e8bf7af69379937b40625_b.jpg"/></figure><p><b>检测到误报（无效的会话令牌）</b></p><figure data-size="small"><noscript><img src="https://pic1.zhimg.com/v2-ca291da6d861b06ed97a439d718811dc_b.jpg" data-caption="" data-size="small" data-rawwidth="1265" data-rawheight="713" class="origin_image zh-lightbox-thumb" width="1265" data-original="https://pic1.zhimg.com/v2-ca291da6d861b06ed97a439d718811dc_r.jpg"/></noscript><img src="https://pic1.zhimg.com/v2-ca291da6d861b06ed97a439d718811dc_b.jpg" data-caption="" data-size="small" data-rawwidth="1265" data-rawheight="713" class="origin_image zh-lightbox-thumb lazy" width="1265" data-original="https://pic1.zhimg.com/v2-ca291da6d861b06ed97a439d718811dc_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-ca291da6d861b06ed97a439d718811dc_b.jpg"/></figure><blockquote>高级使用具体在 github 项目。</blockquote><p><b>CSRF链</b></p><figure data-size="small"><noscript><img src="https://pic1.zhimg.com/v2-78e360cec77e1a555be51e878cb17da8_b.jpg" data-caption="" data-size="small" data-rawwidth="1077" data-rawheight="647" class="origin_image zh-lightbox-thumb" width="1077" data-original="https://pic1.zhimg.com/v2-78e360cec77e1a555be51e878cb17da8_r.jpg"/></noscript><img src="https://pic1.zhimg.com/v2-78e360cec77e1a555be51e878cb17da8_b.jpg" data-caption="" data-size="small" data-rawwidth="1077" data-rawheight="647" class="origin_image zh-lightbox-thumb lazy" width="1077" data-original="https://pic1.zhimg.com/v2-78e360cec77e1a555be51e878cb17da8_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-78e360cec77e1a555be51e878cb17da8_b.jpg"/></figure><p><b>跨用户资源测试链</b></p><figure data-size="small"><noscript><img src="https://pic1.zhimg.com/v2-4651535279e1730d73f0d538c0f725dc_b.jpg" data-caption="" data-size="small" data-rawwidth="1077" data-rawheight="648" class="origin_image zh-lightbox-thumb" width="1077" data-original="https://pic1.zhimg.com/v2-4651535279e1730d73f0d538c0f725dc_r.jpg"/></noscript><img src="https://pic1.zhimg.com/v2-4651535279e1730d73f0d538c0f725dc_b.jpg" data-caption="" data-size="small" data-rawwidth="1077" data-rawheight="648" class="origin_image zh-lightbox-thumb lazy" width="1077" data-original="https://pic1.zhimg.com/v2-4651535279e1730d73f0d538c0f725dc_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-4651535279e1730d73f0d538c0f725dc_b.jpg"/></figure><p><b>验证用户的链</b></p><figure data-size="small"><noscript><img src="https://pic1.zhimg.com/v2-10c81bc82b0e033da01e92dc9d970d44_b.jpg" data-caption="" data-size="small" data-rawwidth="1149" data-rawheight="728" class="origin_image zh-lightbox-thumb" width="1149" data-original="https://pic1.zhimg.com/v2-10c81bc82b0e033da01e92dc9d970d44_r.jpg"/></noscript><img src="https://pic1.zhimg.com/v2-10c81bc82b0e033da01e92dc9d970d44_b.jpg" data-caption="" data-size="small" data-rawwidth="1149" data-rawheight="728" class="origin_image zh-lightbox-thumb lazy" width="1149" data-original="https://pic1.zhimg.com/v2-10c81bc82b0e033da01e92dc9d970d44_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-10c81bc82b0e033da01e92dc9d970d44_b.jpg"/></figure><p>更多网络安全学习尽在 <a href="https://link.zhihu.com/?target=https%3A//www.baidu.com/link%3Furl%3DOcGTJIGtwpNYrGru7tSszpEf10ZQ0xIE7SvER9ejNcCar00KI-fG2lu214M4WKPc%26wd%3D%26eqid%3Da24dabb2002f492b000000065e13d46a" class=" wrap external" target="_blank" rel="nofollow noreferrer">二向箔安全</a>，另外，网络安全技能包又更新了！学 Python 的也能当黑客了，多实战沉浸式体验，让你回味无穷。</p><p>让你从 <b>程序猿→黑客x程序员 PLUS</b>！</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-718b79371d6ca42244a942f02f2b537c_b.jpg" data-caption="" data-size="normal" data-rawwidth="3058" data-rawheight="1720" class="origin_image zh-lightbox-thumb" width="3058" data-original="https://pic1.zhimg.com/v2-718b79371d6ca42244a942f02f2b537c_r.jpg"/></noscript><img src="https://pic1.zhimg.com/v2-718b79371d6ca42244a942f02f2b537c_b.jpg" data-caption="" data-size="normal" data-rawwidth="3058" data-rawheight="1720" class="origin_image zh-lightbox-thumb lazy" width="3058" data-original="https://pic1.zhimg.com/v2-718b79371d6ca42244a942f02f2b537c_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-718b79371d6ca42244a942f02f2b537c_b.jpg"/></figure><p>更多有关渗透测试的内容请前往<a href="https://link.zhihu.com/?target=https%3A//www.baidu.com/link%3Furl%3DOcGTJIGtwpNYrGru7tSszpEf10ZQ0xIE7SvER9ejNcCar00KI-fG2lu214M4WKPc%26wd%3D%26eqid%3Da24dabb2002f492b000000065e13d46a" class=" wrap external" target="_blank" rel="nofollow noreferrer">二向箔安全</a>进行学习，最近推出了“挖洞”班，想了解更多资讯的，可咨询客服微信 <b>twosecurity02</b></p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-2222e29c6decda168e1be1f049d93ccf_b.jpg" data-caption="" data-size="normal" data-rawwidth="3041" data-rawheight="2000" class="origin_image zh-lightbox-thumb" width="3041" data-original="https://pic4.zhimg.com/v2-2222e29c6decda168e1be1f049d93ccf_r.jpg"/></noscript><img src="https://pic4.zhimg.com/v2-2222e29c6decda168e1be1f049d93ccf_b.jpg" data-caption="" data-size="normal" data-rawwidth="3041" data-rawheight="2000" class="origin_image zh-lightbox-thumb lazy" width="3041" data-original="https://pic4.zhimg.com/v2-2222e29c6decda168e1be1f049d93ccf_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-2222e29c6decda168e1be1f049d93ccf_b.jpg"/></figure>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
