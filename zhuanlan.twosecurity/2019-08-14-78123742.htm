<div class="title-image"><img src="https://pic4.zhimg.com/v2-0e5fb0b2a2bc980b74cf0ccd1d08e67e_b.jpg" alt=""></div><p><b>即使你的 iPhone 受到六位数密码和touch ID指纹的双重保护，黑客同样能解锁你的手机。</b></p><h2>背景</h2><p>一名用户的 iPhone 6s 被偷之后不久，那个小偷不仅重置了他的一些在线服务密码，如Apple ID，而且还伪装成他，与银行进行联系，并尝试重置他银行账户的密码。不过幸运的是，犯罪分子并没有成功取出他银行卡中的钱，但是为什么可以重置他Apple ID的密码呢？不是有密码和指纹保护的嘛！</p><p>为了更好地理解这种情况，我们收集了更多的信息：</p><p>a) 这是一次有针对性的攻击事件吗？我的意思是，攻击者是否在此之前曾经通过网络钓鱼等方式获取到了这位用户的凭证，然后又专门来盗取他的iPhone手机？</p><p>这种可能性不大。因为这名用户表示，在手机被偷之前，身上并没有发生任何的异常事件。</p><p>b) 是否包含受害者信息的身份证或其他文件也被盗了？因为对于攻击者而言，用户的姓名或者电子邮件地址也是非常重要的数据。</p><p>事实证明，这类事情也没有发生过。</p><p>c) 手机被盗多久之后犯罪分子就解锁了iPhone和SIM卡呢？</p><p>大概两小时左右。</p><p>d) iPhone的解锁密码是否为弱密码？</p><p>不是。这个6位数的密码并不好猜，而且解锁密码与这名用户的车牌号以及其他的个人信息没有任何的关系。</p><p>鉴于此次事件如此的蹊跷，我们决定深入分析，看看受害者的iPhone到底是如何被解锁的。</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-87efe8cbb314755d15c30ce670751b75_b.jpg" data-caption="" data-size="normal" data-rawwidth="768" data-rawheight="512" class="origin_image zh-lightbox-thumb" width="768" data-original="https://pic2.zhimg.com/v2-87efe8cbb314755d15c30ce670751b75_r.jpg"/></noscript><img src="https://pic2.zhimg.com/v2-87efe8cbb314755d15c30ce670751b75_b.jpg" data-caption="" data-size="normal" data-rawwidth="768" data-rawheight="512" class="origin_image zh-lightbox-thumb lazy" width="768" data-original="https://pic2.zhimg.com/v2-87efe8cbb314755d15c30ce670751b75_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-87efe8cbb314755d15c30ce670751b75_b.jpg"/></figure><p class="ztext-empty-paragraph"><br/></p><h2>时间轴</h2><p>这名用户的手机是在某个下午被盗的，我们对事件的脉络进行了梳理，具体信息如下：</p><p>a)14:00  手机被盗；</p><p>b)16:03  用户激活了iPhone的“丢失模式”，并且通过 iCloud 远程清除了手机中的数据；</p><p>c)16:28  用户Google账户的密码被修改；</p><p>d)16:37  用户收到了一封邮件，邮件中包含一条重置Apple ID密码的链接；</p><p>e)16:38  又收到一封邮件，通知用户Apple ID密码已被更改;</p><p>f)16:43  一封新邮件，通知 iCloud 已经定位到了这台iPhone手机；</p><p>g)16:43  另一封新邮件，称 iCloud 已经清除了这台iPhone手机中的数据；</p><p>正如所见，用户Google账号和Apple账号的密码已经被犯罪分子重置了。 在没有密码的情况下，想要解锁 iPhone 手机几乎是不可能的。那么犯罪分子到底做了什么呢？</p><p>为此，我们开始研究实现这一切的可能性：</p><p>1）如果要修改Google账号的密码，首先要知道用户电子邮箱的地址。那么犯罪分子是怎么得到用户邮箱地址的呢？</p><p>用户手机在锁屏状态下是不会泄漏邮箱地址的，所以犯罪分子不可能从手机屏幕上获取用户Gmail邮箱的地址。</p><p>2）有没有办法从设备的IMEI来发现Apple ID呢？</p><p>我们在网上搜索并找到了这种付费服务：“从给定的IMEI中发现Apple的ID”。但是这些服务并不是在线操作的，通常需要24至48小时才能获得所需信息。但是犯罪分子只花了两小时就拿到了用户的Apple ID，所以这与我们的情况不符。</p><p>3）是否可以通过手机号码来找出用户的Gmail账号呢？</p><p>我们再次进行了搜索，发现Google提供了几种方法来帮助用户找回邮箱账号。例如与账号绑定的手机号或者用户姓名。由于这种情况下，犯罪分子可以轻易地获取到用户的手机号，而通过手机号来查找用户的姓名其实也并不难。所以，我们打算从这里开始入手……</p><p class="ztext-empty-paragraph"><br/></p><h2>情景模拟</h2><p>为了弄清楚事情的真相，我们就从犯罪分子通过手机号来查找用户的姓名开始入手。首先，用户重新购买一台新的iPhone 6s手机，并且将这台新手机设置成与被盗手机一样（包括Google账号和Apple账号），这样，我们就能最大程度地还原真实场景了。</p><p>为了获取手机号，我们从iPhone上取出SIM卡并插入另一部手机中。与真实场景相同，SIM卡并没有设置PIN码。在另一部手机中，我们可以轻易获取到用户的手机号码。</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-d8abe05b8e2f28f709a5992864946a88_b.jpg" data-caption="" data-size="normal" data-rawwidth="587" data-rawheight="456" class="origin_image zh-lightbox-thumb" width="587" data-original="https://pic1.zhimg.com/v2-d8abe05b8e2f28f709a5992864946a88_r.jpg"/></noscript><img src="https://pic1.zhimg.com/v2-d8abe05b8e2f28f709a5992864946a88_b.jpg" data-caption="" data-size="normal" data-rawwidth="587" data-rawheight="456" class="origin_image zh-lightbox-thumb lazy" width="587" data-original="https://pic1.zhimg.com/v2-d8abe05b8e2f28f709a5992864946a88_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-d8abe05b8e2f28f709a5992864946a88_b.jpg"/></figure><p>获取到用户的手机号之后，我们就可以在搜索引擎上来查找用户的姓名了。但不幸的是，我们什么也没找到。</p><p>接下来，我们便尝试用手机号在Facebook上进行查找。如果用户的Facebook账号绑定了手机的话，我们就可以直接通过手机号来查找到这名用户了。与刚才一样，我们还是什么也没找到。<br/></p><h2>WhatsApp+锁屏通知=攻击成功</h2><p>我突然想起来，如果你在一个<a href="https://link.zhihu.com/?target=https%3A//zh.wikipedia.org/wiki/WhatsApp" class=" wrap external" target="_blank" rel="nofollow noreferrer">WhatsApp</a>的讨论组里，收到一条陌生人发来的信息，那么信息上方将会显示用户姓名和手机号（例如9999-9999～Mike Arnold）。所以，如果我们可以用这台锁屏的iPhone来向WhatsApp讨论组发送信息的话，我们就可以获取到用户的姓名了。</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-67e5726783b9a97f42c48f132a528dd8_b.jpg" data-caption="" data-size="normal" data-rawwidth="660" data-rawheight="226" class="origin_image zh-lightbox-thumb" width="660" data-original="https://pic1.zhimg.com/v2-67e5726783b9a97f42c48f132a528dd8_r.jpg"/></noscript><img src="https://pic1.zhimg.com/v2-67e5726783b9a97f42c48f132a528dd8_b.jpg" data-caption="" data-size="normal" data-rawwidth="660" data-rawheight="226" class="origin_image zh-lightbox-thumb lazy" width="660" data-original="https://pic1.zhimg.com/v2-67e5726783b9a97f42c48f132a528dd8_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-67e5726783b9a97f42c48f132a528dd8_b.jpg"/></figure><p>首先，我们要确保这台iPhone手机会在锁屏界面显示WhatsApp的通知信息，于是我们向其发送了一条信息，这条信息也正如我们期待的那样显示在了锁屏界面中。接下来，我们还可以使用3D touch功能直接在锁屏界面上回复消息。</p><p>准备完毕之后，我们需要创建一个讨论组，然后把这位用户手机号所绑定的WhatsApp账号拉进讨论组里。由于加入讨论组是不需要进行验证的，所以进入讨论组之后，iPhone锁屏界面上便会出现了一条新的通知消息，以告诉用户他新加入了一个讨论组。当然了，讨论组中还有一些用于测试的其他用户。</p><p>接下来，我们在讨论组中发了一条信息，这条信息也成功在iPhone的锁屏界面上显示了。然后我们利用3D touch功能来回复这条信息，这样就成功获取到了用户的姓名。</p><p>下一步要做的，就是将我们所获取到的信息（手机号和用户姓名）填入Google的表单，然后获取用户的电子邮箱地址。<br/> </p><h2>修改Google账号的密码</h2><p>现在，我们就可以重现攻击者修改Google账户密码的操作了。操作步骤如下：</p><p>1.  进入Google的登录界面；</p><p>2.  选择“忘记密码”选项；</p><p>3.  在“你所能记住的最后一个密码”中随便填写一些数据；</p><p>4.  接下来，Google会要求你输入与该邮箱绑定的手机号码。在这一步中，Google会显示部分手机号码，但也足够验证手机号的正确性了。</p><p>5.  输入手机号码，Google会通过短信向iPhone发送一个验证码；</p><p>6.  填写完验证码之后，Google便会要求我们设置新的邮箱密码；</p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-5be2406ddcee003ef5ee000a8e760342_b.jpg" data-caption="" data-size="normal" data-rawwidth="493" data-rawheight="461" class="origin_image zh-lightbox-thumb" width="493" data-original="https://pic3.zhimg.com/v2-5be2406ddcee003ef5ee000a8e760342_r.jpg"/></noscript><img src="https://pic3.zhimg.com/v2-5be2406ddcee003ef5ee000a8e760342_b.jpg" data-caption="" data-size="normal" data-rawwidth="493" data-rawheight="461" class="origin_image zh-lightbox-thumb lazy" width="493" data-original="https://pic3.zhimg.com/v2-5be2406ddcee003ef5ee000a8e760342_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-5be2406ddcee003ef5ee000a8e760342_b.jpg"/></figure><p>很简单吧？其实只要犯罪分子拿到了你的手机或者SIM卡、以及你的姓名，他们就可以在几分钟之内重置你Gmail邮箱的密码。<br/> <br/> </p><p><b>修改Apple ID的密码</b></p><p>接下来，我们使用获取到的Google邮箱地址作为Apple ID的账号来尝试进行登录。与此前一样，先选择“忘记密码”选项，然后系统会将密码重置链接通过邮件发送至你的邮箱。剩下的操作就非常简单了，想必大家也都知道。最后，我们成功地修改了用户苹果账号的密码。</p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-7cc84828522512258eddc14b9b2cedca_b.jpg" data-caption="" data-size="normal" data-rawwidth="622" data-rawheight="375" class="origin_image zh-lightbox-thumb" width="622" data-original="https://pic3.zhimg.com/v2-7cc84828522512258eddc14b9b2cedca_r.jpg"/></noscript><img src="https://pic3.zhimg.com/v2-7cc84828522512258eddc14b9b2cedca_b.jpg" data-caption="" data-size="normal" data-rawwidth="622" data-rawheight="375" class="origin_image zh-lightbox-thumb lazy" width="622" data-original="https://pic3.zhimg.com/v2-7cc84828522512258eddc14b9b2cedca_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-7cc84828522512258eddc14b9b2cedca_b.jpg"/></figure><p class="ztext-empty-paragraph"><br/></p><p><b>解锁“新的”iPhone</b></p><p>当iPhone丢失之后，很多用户可能会远程锁定并擦除iPhone中的数据。但是当iPhone数据被远程清除之后，iPhone会要求你输入此前设备所绑定的Apple ID和密码，如果犯罪分子知道你的Apple ID和密码的话，他们就可以将这台iPhone当作一台全新的手机来使用了。</p><p class="ztext-empty-paragraph"><br/></p><p><b>建议</b></p><p>随着智能手机的功能越来越多，在方便了用户的同时，我们也应该学会如何保护自己的安全。为此，我们给大家提供了以下建议：</p><p>1.  禁止手机在锁屏状态下显示通知的详细信息；</p><p>2.  为SIM卡设置PIN码（密码保护），如果您的手机丢失或被盗了，可以大大降低被冒充的风险；</p><p>3.  如果可以的话，开启网络服务的双因素身份验证功能，双因素身份验证意味着您必须提供至少两种方法的组合来向您正在进行的系统证明您的身份。</p><p class="ztext-empty-paragraph"><br/></p><p>原文链接：<a href="https://link.zhihu.com/?target=http%3A//securityaffairs.co/wordpress/52432/hacking/unlocked-stolen-iphone-6s.html" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">http://</span><span class="visible">securityaffairs.co/word</span><span class="invisible">press/52432/hacking/unlocked-stolen-iphone-6s.html</span><span class="ellipsis"></span></a></p><p>参考安全客作者 <a href="https://link.zhihu.com/?target=http%3A//bobao.360.cn/member/contribute%3Fuid%3D2606963099" class=" wrap external" target="_blank" rel="nofollow noreferrer">WisFree</a> 翻译</p>