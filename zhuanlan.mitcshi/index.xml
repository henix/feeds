<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:media="http://search.yahoo.com/mrss/">
<channel>
<title>川流不息</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/</link>
<description>分享量化投资技术与实证心得 北京量信投资管理有限公司是一家在中国基金业协会备案登记的专业私募基金管理人。本专栏作者石川是公司联合创始人。希望通过这个平台和各位小伙伴分享我们在量化投资领域的知识和心得。原创不易，请保护版权，请在获得授权后转载。已委托“维权骑士”(http://rightknights.com) 为进行维权行动。</description>
<language>zh-cn</language>
<lastBuildDate>Fri, 06 Mar 2020 00:24:37 +0800</lastBuildDate>
<item>
<title>另类数据的前景和陷阱</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2020-03-02-110357302.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/110357302&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-dab2a3a9cd5e0eee616ce1a54191dea9_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;摘要&lt;/b&gt;&lt;/p&gt;&lt;p&gt;本文探讨对另类数据的五点思考。科学的使用 + 正确的预期，另类数据或大有可为。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;00 特斯拉工厂上空的“天眼”&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;美国时间 2018 年 10 月 25 日，困境中的特斯拉（Tesla）股票录得 9.14% 的大涨，只因为在前一个交易日盘后发布的 2018 Q3 财报大超华尔街预期。财报显示，爆款 Model 3 的产量在过去一个季度较之前几乎翻番，这无疑给了投资人注入了一剂强心针，也引得市场一片狂欢。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-74bfe1ccc308e4a2852c7ae4683137bd_b.jpg&quot; data-rawwidth=&quot;1014&quot; data-rawheight=&quot;370&quot; data-size=&quot;normal&quot; data-caption=&quot;&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1014&quot; data-original=&quot;https://pic2.zhimg.com/v2-74bfe1ccc308e4a2852c7ae4683137bd_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-74bfe1ccc308e4a2852c7ae4683137bd_b.jpg&quot; data-rawwidth=&quot;1014&quot; data-rawheight=&quot;370&quot; data-size=&quot;normal&quot; data-caption=&quot;&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1014&quot; data-original=&quot;https://pic2.zhimg.com/v2-74bfe1ccc308e4a2852c7ae4683137bd_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-74bfe1ccc308e4a2852c7ae4683137bd_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;面对 Model 3 产量的大增以及 9+% 大涨反映出的市场信心，最高兴的人当属 Tesla 的掌门人 Elon Musk。然而，除了 Musk 之外，同样高兴的另一群人大概要数另类数据公司 Thasos 以及它的很多对冲基金客户们。因为在 Tesla 发布 Q3 财报之前，这群人恐怕早就凭借着信息优势预判到了这一点，并提前在二级市场布局了。&lt;/p&gt;&lt;p&gt;Thasos 是怎么做到的？&lt;/p&gt;&lt;p&gt;他们在一张在线地图上环绕 Tesla 位于 Fremont，California 的占地 370 英亩的工厂，创建了一个数字围栏，以隔离从 Tesla 工厂范围内发出的智能手机位置信号。Thasos 租赁了数不胜数的智能手机 APP 收集到的数万亿个地理坐标的数据库，并通过电脑程序密切监测从 Tesla 工厂中发出的手机信号。使用手机信号量进行估计，他们发现从 2018 年 6 月到 10 月，Tesla 工厂夜间轮班时间增加了 30%。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-db3349d5fae928e070db581fcfece208_b.jpg&quot; data-rawwidth=&quot;801&quot; data-rawheight=&quot;413&quot; data-size=&quot;normal&quot; data-caption=&quot;&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;801&quot; data-original=&quot;https://pic1.zhimg.com/v2-db3349d5fae928e070db581fcfece208_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-db3349d5fae928e070db581fcfece208_b.jpg&quot; data-rawwidth=&quot;801&quot; data-rawheight=&quot;413&quot; data-size=&quot;normal&quot; data-caption=&quot;&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;801&quot; data-original=&quot;https://pic1.zhimg.com/v2-db3349d5fae928e070db581fcfece208_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-db3349d5fae928e070db581fcfece208_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;上图中左侧，横坐标 J、F、M 等为月份的英文首字母缩写。深蓝色曲线为通过手机信号估计出来的夜班（weekday late）工作时间。从图中清晰可见，在 6 月到 10 月之间，夜班工作时间较 Q2 有了大幅增长，意味着产能的提高。Thasos 将这个数据分享给了它的一些对冲基金客户。毫无疑问，这一数据发挥了巨大的作用。&lt;/p&gt;&lt;p&gt;这是将另类数据应用于二级市场投资的一个经典案例。&lt;/p&gt;&lt;p&gt;近年来，另类数据逐渐走进了二级市场投资的视线。随着使用常规数据 —— 量价、财务等 —— 构建交易信号、进行交易变得越来越拥挤，所获得的超额收益越来越被稀释，人们把目光投入到了另类数据上，希望通过独门数据源获取别人不知道的 α。另类数据也在借着这个风口获得了巨大的发展。来自 &lt;a href=&quot;https://link.zhihu.com/?target=http%3A//AlternativeData.org&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;http://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;AlternativeData.org&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;&lt;/span&gt;&lt;/a&gt; 的数据显示，在最近几年，另类数据 providers 的数量也出现了激增。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-e1d48445df22cd6abb9936314173fe82_b.jpg&quot; data-rawwidth=&quot;663&quot; data-rawheight=&quot;311&quot; data-size=&quot;normal&quot; data-caption=&quot;&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;663&quot; data-original=&quot;https://pic3.zhimg.com/v2-e1d48445df22cd6abb9936314173fe82_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-e1d48445df22cd6abb9936314173fe82_b.jpg&quot; data-rawwidth=&quot;663&quot; data-rawheight=&quot;311&quot; data-size=&quot;normal&quot; data-caption=&quot;&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;663&quot; data-original=&quot;https://pic3.zhimg.com/v2-e1d48445df22cd6abb9936314173fe82_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-e1d48445df22cd6abb9936314173fe82_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;其实，另类数据并非什么新鲜概念。在几十年前，当我们只有量价数据计算均值、布林带的时候，财务报表数据就是另类数据；当财务数据被广泛使用后，分析师一致预期就是另类数据；当分析师一致预期家喻户晓之后，网络舆情数据就成了另类数据；当人们对网络舆情不再陌生之后，非结构化的文本数据就变成了另类数据……&lt;/p&gt;&lt;p&gt;当人们接触到新的数据源的时候，一般的反应都是“两眼发光”。诚然，在市场变得更加有效的今天，新的数据源无疑是尚未被过度使用的“净土”、充满潜在的机会。但是，另类数据真的像人们想象的那样前景一片光明吗？是否任意一个新的数据源都能拿过来加工出一个靠谱的 α 因子？另类数据能否成为二级市场的 silver bullet？面对这些问题，海外业界也不乏争议之声，有人支持也有人反对。&lt;/p&gt;&lt;p&gt;本文以“另类数据的前景和陷阱”为题，阐述对另类数据的五点思考（下文第 1 到 5 节），仅是希望抛砖引玉。由于知识和资历有限，可能有些观点不尽完善，也欢迎各位小伙伴指正。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;01 技术和数据需匹配&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;关于另类数据的第一个思考是新的数据类型需要相应的分析技术。当我们仅有量、价数据的时候，传统的技术分析，如均线、布林带就能发挥很大的作用。然而，这些技术分析对结构化的会计报表数据却难有作为。为此，相应的分析手段也应运而生，比如多因子模型等。而如今，如果想要分析非结构化文本数据以及更 general 的多媒体数据，则更是需要相应的技术，如自然语言处理和广义人工智能。显然，这对管理人和投资者都提出了越来越高的要求。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-58d5918315d85b0e272f040ce94fa77a_b.jpg&quot; data-rawwidth=&quot;911&quot; data-rawheight=&quot;544&quot; data-size=&quot;normal&quot; data-caption=&quot;&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;911&quot; data-original=&quot;https://pic3.zhimg.com/v2-58d5918315d85b0e272f040ce94fa77a_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-58d5918315d85b0e272f040ce94fa77a_b.jpg&quot; data-rawwidth=&quot;911&quot; data-rawheight=&quot;544&quot; data-size=&quot;normal&quot; data-caption=&quot;&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;911&quot; data-original=&quot;https://pic3.zhimg.com/v2-58d5918315d85b0e272f040ce94fa77a_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-58d5918315d85b0e272f040ce94fa77a_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;随着另类数据量的爆发，另一个需要面对的问题则是维数灾难。以预测股票收益率为例，另类数据代表着不同的自变量。由于股票的样本数据就那么多，随着自变量的增加，则股票样本数据在这些变量构成的空间内将会越来越稀疏。参数的激增使得预测模型存在更高的过拟合风险，且预测的 bias 和 variance 都会变大。&lt;/p&gt;&lt;p&gt;此外，使用不同另类数据构建因子也会出现之前公众号强调多次的多重检验（multiple testing）的问题。当使用大量模型分析同样的数据时，总会出现仅仅因为运气就十分显著的因子。这要求人们在统计手段上尽可能排除这种 lucky factor，而在金融学业务上去真正理解另类数据和未来预期收益率之间的逻辑。这也引出了第二点思考，使用另类数据需要很强的 domain knowledge。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;02 Domain Knowledge&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;全新的数据是一把“双刃剑”。一方面，因为还没有人用过，因此它不存在“拥挤”的问题；而另一方面，如果使用者不具备该数据所要求的 domain knowledge，那很可能不知道从何下手。&lt;/p&gt;&lt;p&gt;在我们的想象中，另类数据也许是这样的：有令人兴奋的故事、而且是已经被 vendors 处理好的结构化数据，我们能直接拿来当成因子对资产排排序，就能一顿操作猛如虎。然而，在实际中，另类数据更像是在一个没人去过的地方发现了一座山。然而，这座山里有没有矿、从哪里开始挖、到底能挖出什么，更多的要看使用者自己的本事。&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;There are plenty of inputs. But how do investors go about filtering the signal from the noise?&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;在海外业界，实力充沛的大型资产管理公司由于具备足够的人才储备，通常自己进行数据分析。另一方面，另类数据 vendors 也会通过推出一些听上去十分有希望的 scenarios 从而推销数据。除了买方、卖方外，市场上也涌现出了第三方研究机构，投资者会委托他们进行另类数据的研究。&lt;/p&gt;&lt;p&gt;对于另类数据的使用者来说，使用 vendors 或者第三方提供的加工后的数据无疑是最方便的。但这种做法存在的问题是，这些 use cases 会被卖给很多不同的使用者。这会增加另类数据的拥挤度，降低其在未来获取收益的能力。因此，对于使用者来说，掌握 domain knowledge —— 包括另类数据如何产生、背后的业务流程是什么、金融学含义有哪些等 —— 无疑是最重要的，这可以掌握研究的主动权，并更有可能挖出独门的 α。&lt;/p&gt;&lt;blockquote&gt;&lt;b&gt;&lt;i&gt;What we&amp;#39;re generally looking for is something a little bit more raw, a bit more unprocessed, where we can really understand what the data is.&lt;/i&gt;&lt;/b&gt; &lt;i&gt;We can dive into it, we can do our analysis, we can do cleaning, we can apply it and back-test it with the goal of figuring out whether the data will provide a useful signal.&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;在这方面，公众号之前介绍的 Lee et al. (2019) 一文是一个很好的例子（见&lt;a href=&quot;https://zhuanlan.zhihu.com/p/44781908&quot; class=&quot;internal&quot;&gt;《获取 α 的新思路：&lt;/a&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzIyMDEwNDk1Mg%3D%3D%26mid%3D2650878357%26idx%3D1%26sn%3Dbd7b3a3e85ed5d0c124c4f06463363e1%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;科技关联度》&lt;/a&gt;）。该文针对美股，使用专利数据创造性的构建了科技关联度指标，获得了其他常见因子无法解释的超额收益。这个 idea 本身是需要对专利数据背后代表的业务逻辑，以及公司之间的关联有深刻的认识的。如果没有这种 domain knowledge，只是把专利数据拿来简单的统计哪个公司专利多、哪个公司专利少，恐怕并不能获得可观的 α。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;03 数据是否无偏&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;关于另类数据的第三个思考是，数据的生成（采集）过程是否 unbiased，能否很好的代表总体。为了说明这一点，不妨来看一个例子。&lt;/p&gt;&lt;p&gt;Green et al. (2019) 使用 Glassdoor 数据研究了员工评价与股票收益率之间的关系（[因子动物园] 的文章&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzUxNzY0NjU3Mw%3D%3D%26mid%3D2247484041%26idx%3D1%26sn%3Ddca759e5a95fde9627c77a44df765874%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;《乌合之众 or 群众的智慧：员工评价与股票收益》&lt;/a&gt;对该文进行了详细介绍）。Glassdoor 提供了员工对公司的综合评价和五个标准化评价指标，包括职业机会，薪酬福利，工作/生活平衡度，高层管理，企业文化与价值，所有评价皆为 1 至 5 星。&lt;/p&gt;&lt;p&gt;为了研究员工评价和股票收益率的关系，Green et al. (2019) 依据员工评价变化高低将股票分为三组（top 20%，middle 60%，bottom 20%），并用 high – low 构建了因子。理论上，员工评价变高，意味着经济环境及公司前景很可能在变好，在其他条件相同的情况下，公司应有更好的表现，因此预期收益率更高。实证结果支持了他们的猜想。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-d3202b4340018b2d2f5e6dc813a51065_b.jpg&quot; data-rawwidth=&quot;1015&quot; data-rawheight=&quot;630&quot; data-size=&quot;normal&quot; data-caption=&quot;&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1015&quot; data-original=&quot;https://pic2.zhimg.com/v2-d3202b4340018b2d2f5e6dc813a51065_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-d3202b4340018b2d2f5e6dc813a51065_b.jpg&quot; data-rawwidth=&quot;1015&quot; data-rawheight=&quot;630&quot; data-size=&quot;normal&quot; data-caption=&quot;&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1015&quot; data-original=&quot;https://pic2.zhimg.com/v2-d3202b4340018b2d2f5e6dc813a51065_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-d3202b4340018b2d2f5e6dc813a51065_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;结果显示，无论是等权还是市值加权，该因子确实能够获得显著的超额收益。此外，高、低评价变化组合的主要公司特征（如 beta、规模和 BM）基本一致，动量也非常接近，而员工评价变化平均相差超过 1 星，意味着其他常见因子无法解释公司评价它。这一点也进一步被 Fama and MacBeth (1973) regression 结果所验证：无论是单变量回归，还是控制了不同的公司特征后，员工评价变化都有显著的风险溢价。&lt;/p&gt;&lt;p&gt;毫无疑问，Green et al. (2019) 是一篇有趣的发现。不过我们仍然不禁要对 Glassdoor 的数据进行灵魂发问：员工评价数据是否无偏呢？是否是可信的？Glassdoor 的数据存在以下一些潜在问题：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;没有员工认证系统：这意味着任何人，可以在任何时间，对任何公司进行评价，而没有机制来保证这个人确实是或曾是该公司的员工。&lt;/li&gt;&lt;li&gt;人们更容易在对雇主不满时更容易发表（负面）评价。&lt;/li&gt;&lt;li&gt;人们往往过度夸大感受：Glassdoor 上有很多 1 星和 5 星评价。&lt;/li&gt;&lt;li&gt;评分体系本身并无科学依据。Glassdoor 并没有给出明确的说明每个星级到底代表什么。评分者可以任意的根据主观感受来选择 1 星到 5 星。工资不错？5 星！餐厅免费？5 星！免费健身房？5 星！…… 5 星可以代表任何事，但显然不是所有的 5 星和股票收益率的关系都是一致的。但我们不知道每个 5 星背后到底意味着什么。&lt;/li&gt;&lt;li&gt;有些雇主有奖励机制、鼓励员工提交 5 星评价。曾经有一个公司的评分大概 1.5 分左右，后来管理层发话说，如果员工仅发布经管理层审批后通过的留言，那么员工将得到 250 美元的奖励。这个公司后来的评分上升至 4.2。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;这些问题说明，Glassdoor 的数据的无偏性令人担忧。除此之外，我对其的另一个猜想是涉及到的公司的行业分布是否也会不均匀？比如，互联网或者科技公司的员工更容易也更愿意参与网上评价？而传统制造业企业的员工则没那么热衷？如果行业分布不均，那么 Green et al. (2019) 的研究结果将会由于没有控制行业影响而大打折扣。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;04 历史数据太短&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;对于大多数另类数据来说，一个不得不面对的问题是数据长度往往很短。据我（有限）的调研发现，通常来说另类数据集的历史数据长度是 5 年以内（2 到 3 年很常见）；5 年以上就是很长的了。历史数据太短会加剧多重检验的危害，增加过拟合问题。&lt;/p&gt;&lt;p&gt;下图结果来自 Bailey and Lopez de Prado (2012) 的研究。假设数据无法预测收益率，该研究发现，如果数据的长度仅有 2 年，则仅需要通过 7 个检验就能找到夏普率为 1 的策略；而如果数据的长度提高到 5 年，达到同样的效果则需要 45 个检验 —— 其实也非常很容易。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-3f4c2d06befeb36739b126e196db941e_b.jpg&quot; data-rawwidth=&quot;1015&quot; data-rawheight=&quot;453&quot; data-size=&quot;normal&quot; data-caption=&quot;&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1015&quot; data-original=&quot;https://pic3.zhimg.com/v2-3f4c2d06befeb36739b126e196db941e_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-3f4c2d06befeb36739b126e196db941e_b.jpg&quot; data-rawwidth=&quot;1015&quot; data-rawheight=&quot;453&quot; data-size=&quot;normal&quot; data-caption=&quot;&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1015&quot; data-original=&quot;https://pic3.zhimg.com/v2-3f4c2d06befeb36739b126e196db941e_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-3f4c2d06befeb36739b126e196db941e_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;这个例子说明，数据量越少，越容易出现过拟合。在这个时候，如果没有对另类数据背后逻辑的认知，则难以辨别出找到的信号是否真的有效。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;05 是否有增量贡献&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;对于另类数据的最后一个思考是检验其对预测收益率是否有增量贡献。&lt;/p&gt;&lt;p&gt;我曾经给期刊审稿了一篇文章，它讲的是使用网络论坛上的股票情绪构建策略获得超额收益。该文以论坛大 V 对股票的评价为输入，提出了一个专家系统进行选股。仔细读下来，该文可谓是“千疮百孔”，然而它最大的问题是没有进行业绩归因。&lt;/p&gt;&lt;p&gt;该文构建的策略确实跑赢了 benchmark，但是它没有用常见的多因子模型来进行分析、检验其是否在控制了其他因子后仍然能够获得超额收益，无法判断该数据对预测收益率是否有增量贡献。&lt;/p&gt;&lt;p&gt;同样作为研究网络舆情数据的研究，Liew and Budavari (2017) 这篇文章使用 tweet sentiments 数据，在 Fama and French (2015) 五因子基础上加入了第六个因子，指出该因子能在五因子之外解释个股收益率的时序波动。不过有意思的是，该文并没有研究该因子在解释个股预期收益率截面差异上的作用，所以 read/use with care……&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-0c788f9c69ace69cb8ea4b377eb4dda3_b.jpg&quot; data-rawwidth=&quot;1015&quot; data-rawheight=&quot;267&quot; data-size=&quot;normal&quot; data-caption=&quot;&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1015&quot; data-original=&quot;https://pic4.zhimg.com/v2-0c788f9c69ace69cb8ea4b377eb4dda3_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-0c788f9c69ace69cb8ea4b377eb4dda3_b.jpg&quot; data-rawwidth=&quot;1015&quot; data-rawheight=&quot;267&quot; data-size=&quot;normal&quot; data-caption=&quot;&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1015&quot; data-original=&quot;https://pic4.zhimg.com/v2-0c788f9c69ace69cb8ea4b377eb4dda3_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-0c788f9c69ace69cb8ea4b377eb4dda3_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;不管怎样，它比我审稿的那篇还是靠谱多了。（不过插句题外话，JPM 这几年的水平似乎有所下降。）&lt;/p&gt;&lt;p&gt;&lt;i&gt;Alternative data aren’t necessarily better when it comes to providing performance-enhancing insight, they are different.&lt;/i&gt;&lt;/p&gt;&lt;p&gt;上面这句话很好的总结了业界对于另类数据的合理期望。另类数据，顾名思义，它首先需要另类。如果绕了一大圈后发现，它背后的收益率驱动和其他收益源相同，那么它就没有什么额外的价值。在投资中，多样化被认为是唯一的“free lunch”。同样的道理对数据也成立。只有当另类数据和现有数据尽可能不相关，它才有可能捕捉到其他收益源之外的收益，提高投资组合的风险收益特征。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;06 结语&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;以上就是对另类数据的五点思考。&lt;/p&gt;&lt;p&gt;在本文最后，简单总结下另类数据的四大主流应用场景（其实前文的举例中有些已经涉及到了），包括网络抓取、情绪、卫星数据以及消费数据。&lt;/p&gt;&lt;p&gt;金融行业的数据研究机构 Greenwich Associates 的研究表明，网络抓取是目前使用最广泛的另类数据。它从目标网站收集数据，以获取有关品牌、公司和企业活动的信息。在这其中，最热门的数据包括 job listing 和 company review，它们能够为公司的增长前景提供一定的线索（但小心 Glassdoor 的问题）。此外，有关产品排名和促销活动的数据也极具价值，人们可以从中找寻公司表现的蛛丝马迹。&lt;/p&gt;&lt;p&gt;情绪数据则代表了另一大类的常见的另类数据。像社交媒体、新闻流、公司公告这些自不必说了，有很多相关的研究。除此之外，海外也开始对上市公司 earnings call 的 transcript 进行文本分析、捕捉高管的用词和语言，以此推断公司的前景。不过，在这方面，英文相较于中文有较大的优势，可操作性高不少。&lt;/p&gt;&lt;p&gt;卫星图像听上去很玄幻，但你几乎能在所有 leading 另类数据提供商的样例中找到它的身影。比如，卫星图像数据会被用来跟踪船只，监测农作物，并探测港口和油田的活动，推断大宗商品的库存等。&lt;/p&gt;&lt;p&gt;信用卡和借记卡的交易数据中也存在巨大的价值。在海外，一些另类数据商网罗了很多消费者，他们同意分享其消费数据。这类数据可以被用来追踪零售行业的收入，通过更细的粒度以及更高的频率来预测相关公司的基本面。不过，这类数据的可得性比较低。&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//AlternativeData.org&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;http://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;AlternativeData.org&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;&lt;/span&gt;&lt;/a&gt; 的调研指出，这类数据往往非常昂贵。&lt;/p&gt;&lt;p&gt;读到这里有小伙伴也许会问“你这题目文章叫前景和陷阱，这前面 blabla 说了五点都是陷阱啊，前景在哪里？”其实，把坑都填上、科学的使用再加之正确的预期，那么这些“陷阱”就将变成“前景”。据来自 &lt;a href=&quot;https://link.zhihu.com/?target=http%3A//AlternativeData.org&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;http://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;AlternativeData.org&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;&lt;/span&gt;&lt;/a&gt; 的统计数据显示，海外买方在购买另类数据上的支出在最近几年逐年增长。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-04c847f1e34ae5959787029e10b67b6c_b.jpg&quot; data-rawwidth=&quot;582&quot; data-rawheight=&quot;294&quot; data-size=&quot;normal&quot; data-caption=&quot;&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;582&quot; data-original=&quot;https://pic1.zhimg.com/v2-04c847f1e34ae5959787029e10b67b6c_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-04c847f1e34ae5959787029e10b67b6c_b.jpg&quot; data-rawwidth=&quot;582&quot; data-rawheight=&quot;294&quot; data-size=&quot;normal&quot; data-caption=&quot;&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;582&quot; data-original=&quot;https://pic1.zhimg.com/v2-04c847f1e34ae5959787029e10b67b6c_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-04c847f1e34ae5959787029e10b67b6c_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;我们有理由对另类数据的未来充满希望。&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;参考文献&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Bailey, D. H. and M. Lopez de Prado (2012). The Sharpe ratio efficient frontier. &lt;i&gt;Journal of Risk&lt;/i&gt;, Vol. 15(2), 3 – 44.&lt;/li&gt;&lt;li&gt;Fama, E. F. and J. D. MacBeth (1973). Risk, return, and equilibrium: empirical tests. &lt;i&gt;Journal of Political Economy&lt;/i&gt;, Vol. 81(3), 607 – 636.&lt;/li&gt;&lt;li&gt;Fama, E. F. and K. R. French (2015). A five-factor asset pricing model. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 116(1), 1 – 22.&lt;/li&gt;&lt;li&gt;Green, T. C., R. Huang, Q. Wen, and D. Zhou (2019). Crowdsourced employer reviews and stock returns. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 134(1), 236 – 251.&lt;/li&gt;&lt;li&gt;Lee, C. M. C., S. Teng, R. Wang, and R. Zhang (2019). Technological links and predictable returns. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 132(3), 76 – 96.&lt;/li&gt;&lt;li&gt;Liew, J. and T. Budavari (2017). The “six” factor – A social media factor derived directly from tweet sentiments. &lt;i&gt;The Journal of Portfolio Management&lt;/i&gt;, Vol. 43(3), 102 – 111.&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;免责声明：&lt;/b&gt;文章内容不可视为投资意见。市场有风险，入市需谨慎。&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处。已委托“维权骑士”(&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//rightknights.com/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;维权骑士_免费版权监测/版权保护/内容多平台分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2020-03-02-110357302</guid>
<pubDate>Mon, 02 Mar 2020 00:00:00 +0800</pubDate>
</item>
<item>
<title>一个策略的自白</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2020-02-17-106826464.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/106826464&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-ea1062e109fc1ca38483cf77de209a5d_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;00 引言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;我是一个策略。&lt;/p&gt;&lt;p&gt;我的管理人付出了很多的努力、使用科学的方法打造我。我历经模型提出、数据收集、回测验证、过拟合评价、模拟盘检验等多道工序，最终变成了现在的样子。&lt;/p&gt;&lt;p&gt;我在样本外的实盘中日复一日、年复一年地按照管理人设想的方式运转。从未出过差错。&lt;/p&gt;&lt;p&gt;但是最近，我的管理人在使用我以及和别人讨论我的时候，有些做法让我觉着很费解。这些做法包括“随机模式误解 + 小数定律偏误”、“吃补药”、“过度关注最大回撤”以及“择时”。&lt;/p&gt;&lt;p&gt;Something is Not Right。&lt;/p&gt;&lt;p&gt;我希望和我的管理人说说心里话。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;01 随机模式误解 + 小数定律偏误&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;长期来看，我的夏普率大概稳定的维持在 1.5 左右。然而最近一段时间无疑是我的“高光时刻”。最近两个月我的夏普率高达 3.0，这让我的管理人很高兴，非常高兴，非常非常高兴。&lt;/p&gt;&lt;p&gt;但我却觉着他这种情绪很危险。我希望告诉他千万不要误入 Tversky and Kahneman (1971) 指出的“小数定律偏误”。这两位心理学大咖通过研究发现了人们习惯犯以下两种错误：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;误认为不同的小样本之间会很相似；&lt;/li&gt;&lt;li&gt;误认为小样本能够很好的代表总体。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;除此之外，在通常情况下，人们会低估随机模式出现的频率。这一现象往往和小数定律偏误叠加，造成对总体错误的认知。&lt;/p&gt;&lt;p&gt;举个例子。在一个游戏中，参与者被要求猜测五轮扔硬币的结果（fair coin，正反面出现概率各为 50%，以 1 代表正面、0 代表反面）。最终得到的结果是，有 121 人猜测结果是 11010，35 人猜测结果为 10101，而 1 人猜测结果是 11111。11010 和 10101 里面都有三个 1，但猜前者的人数却更多，只因它看上去更随机一些，而非像 10101 那样 1 和 0 完美交错。而 11111 仅有 1 人猜测这说明人们认为随机结果不应如此一致。但事实上，这三种结果的概率完全相同，都是 (1/2)^5 不是吗？&lt;/p&gt;&lt;p&gt;在另一个实验中，263 名大学生在统计课上被要求判断 10 次扔硬币中出现连续正面，或连续反面的最大次数。比如，如果某次结果是 1101000110，那么最大的就是连续 3 个反面。在这些学生中，仅有 13% 的学生猜测最大连续结果的次数超过 4。然而事实却是，在 10 次扔硬币中，出现 4 次或 4 次以上连续结果（正或反）的概率高达 47%，远超过 13%。大多数人并不能正确认识到随机数据中出现连续相同结果的概率有多高。一旦连续结果出现，人们倾向认为这并非随机结果，而是有潜在的原因。&lt;/p&gt;&lt;p&gt;而对随机模式的误解也会随着游戏次数的增加（即数据量的增加）而加重。有一个教授，曾经做过一个非常有意思的实验。他让学生尽可能随机的给出长度为 100 的 0、1 序列（模拟扔硬币的结果）。与此同时，他使用电脑的随机数也生成一个长度为 100 的序列。使用统计检验两个序列发现，学生并不能很好的产生真正的随机序列。&lt;/p&gt;&lt;p&gt;当随机序列的长度变为 100 时，在通常的情况下是可以出现 6 到 8 个连续的 0 或者 1 的（即在随机生成的序列中，你可以在局部看到 00000000 或者 1111111 这样的排列）。但是，人们产生的“随机”序列却远比真实的有序的多。如果你也对这个实验感兴趣，不妨访问下面这个网站：&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//faculty.rhodes.edu/wetzel/random/mainbody.html&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;http://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;faculty.rhodes.edu/wetz&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;el/random/mainbody.html&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/p&gt;&lt;p&gt;以上例子均说明，人们对于随机序列产生的结果往往没有很好的认知。很多看似不可能的结果 —— 比如连续的 0 或者 1 —— 其实都是总体中的一个常见的结果。而随着样本数量的增加，看上去多么不可思议的随机模式也都会出现。&lt;/p&gt;&lt;p&gt;作为一个策略，假如我的收益率分布保持不变的话，那么收益率序列的一个局部（即一段短时间内）也会出现连续涨、或者跌的结果，就正如上面扔硬币的例子。然而，由于这种结果给人的感受并不随机，如果这时再叠加小数定律偏误，那么人们会误以为这个结果暗示着总体已经发生了变化。&lt;/p&gt;&lt;p&gt;在投资中，大数定律是我的朋友；而小数定律偏误却让我如临大敌。只有当交易次数足够多的时候，才能客观的评价我的优劣。仅根据有限次交易结果就改变对我的看法则是一种错误。&lt;/p&gt;&lt;p&gt;每年春节前，“X 年 X 涨”、“持股过年”这些标题从来不会缺席。可结果却又如何呢？因为疫情的影响，2 月 3 日节后第一个交易日，超过 3000 支股票跌停。当样本点非常少的时候，使用有限的样本点根本无法可靠的计算出变量的变化范围。&lt;/p&gt;&lt;p&gt;说到这，我还想起一个类比。亨利之后，阿森纳再无前锋，阿德巴约难堪大用。有段时间，阿德巴约连续进球，出现了高光时刻。有好事者采访时任曼联主帅弗格森时问他如何看待阿德巴约的表现。弗格森冷冷地说“他不是水平高，而是人生状态比较好。”&lt;/p&gt;&lt;h2&gt;&lt;b&gt;02 吃补药&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;我是一个量化策略，管理人总是希望引入最新的技术来改造我，以期获得更高的夏普率。我把这种改进称为“吃补药”。&lt;/p&gt;&lt;p&gt;在我们策略圈，海外有三大药厂，分别为 &lt;i&gt;Journal of Finance&lt;/i&gt;、&lt;i&gt;Journal of Financial Economics&lt;/i&gt;、&lt;i&gt;Review of Financial Studies&lt;/i&gt;。这三大厂的药最给力，比没有执照的黑作坊靠谱的多。&lt;/p&gt;&lt;p&gt;然而最近，我感觉补药吃的有点勤，这让我感觉很不好。我想对管理人说“学而不思则罔”。&lt;/p&gt;&lt;p&gt;对先进的技术 —— 交易算法、资产配置模型、数据处理方式 —— 着迷固然无可厚非。但是，针对特定的问题选择最合适的模型才能看出管理人的功力。不是所有的“补药”都能取得立竿见影的效果。只有真正搞懂其背后的逻辑以及应用时的假设，才有可能对症下药、有的放矢的解决问题。&lt;/p&gt;&lt;p&gt;量化策略绝不是一些神秘的魔法。醉心于模型的调教，见到数学公式就到处比划试试，则是舍本逐末。&lt;/p&gt;&lt;p&gt;“是药三分毒”。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;03 过度关注最大回撤&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;作为一个策略，有很多评价我的风险收益特征的指标，最大回撤就是其中之一。当管理人和投资者介绍我的时候，无一例外的会对我的最大回撤探讨一番。&lt;/p&gt;&lt;p&gt;诚然，最大回撤是一个非常重要的风险指标，但我想说的是，它并不是唯一的评价指标，也绝非最合理的评价指标。举个极端的、假想的例子。考虑如下两个策略。第一个策略的收益率序列分别为 { 0.011, -0.005, 0.011, -0.005, …}，长度为 100。第二个策略收益率序列的前 50 个点为 -0.005，后 50 个点为 0.011。它们的净值曲线如下图所示。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-0dd1de473f21e212c7a5db1b6cbaf9c0_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1004&quot; data-rawheight=&quot;580&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1004&quot; data-original=&quot;https://pic1.zhimg.com/v2-0dd1de473f21e212c7a5db1b6cbaf9c0_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-0dd1de473f21e212c7a5db1b6cbaf9c0_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1004&quot; data-rawheight=&quot;580&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1004&quot; data-original=&quot;https://pic1.zhimg.com/v2-0dd1de473f21e212c7a5db1b6cbaf9c0_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-0dd1de473f21e212c7a5db1b6cbaf9c0_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;第一个策略由于涨一天、跌一天，最大回撤为 -0.5%；反观第二个策略，由于它先连续跌了 50 天，因此最大回撤高达 -22.2%。与最大回撤的差异形成对比的是，无论是日频预期收益、波动率还是夏普率，这两个策略却都是一样的。仅仅因为涨跌序列顺序不同，造成了不同的最大回撤。&lt;/p&gt;&lt;p&gt;顾名思义，最大回撤就是“最大”的那个回撤，它本身就是一个很偶然的量。在样本内回测，得到的最大回撤只有这么一个点估计。一旦参数发生变化，最大回撤也会发生变化。因此，使用点估计来评价最大回撤是不够合理的。更科学的做法是对策略的尾部建模，得到最大回撤的分布再进行分析。&lt;/p&gt;&lt;p&gt;然而，我想和管理人说的并不是这个，而是除了最大回撤外，还有很多更加合理的评价回撤的指标，比如平均回撤、线性加权回撤等。近日 Korn , Moller, and Schwehm (2019) 等人写了一篇定量评价不同回撤指标的文章。这篇文章虽然稍显 boring，但是很好的传递出了一个重要的信息，即在众多回撤指标中，最大回撤并非最合理的。&lt;/p&gt;&lt;p&gt;对于一个策略，在每个时刻 t，我们都可以算出它较其之前最高点的回撤，称为 t 时刻的回撤。而该文认为，不同的回撤指标仅是这些 t 时刻的回撤的某种加权平均。比如，整个策略的最大回撤就是不同 t 时刻的回撤中最大的那个。Korn , Moller, and Schwehm (2019) 使用了不同的权重方式，定义了不同的回撤指标，如下面两图所示。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-8b88386e6e2c3988b5db90f8334ad8ba_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;918&quot; data-rawheight=&quot;594&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;918&quot; data-original=&quot;https://pic3.zhimg.com/v2-8b88386e6e2c3988b5db90f8334ad8ba_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-8b88386e6e2c3988b5db90f8334ad8ba_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;918&quot; data-rawheight=&quot;594&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;918&quot; data-original=&quot;https://pic3.zhimg.com/v2-8b88386e6e2c3988b5db90f8334ad8ba_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-8b88386e6e2c3988b5db90f8334ad8ba_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-4ccc0acfed35861c80a15a8c2ab5fdb9_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;891&quot; data-rawheight=&quot;599&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;891&quot; data-original=&quot;https://pic2.zhimg.com/v2-4ccc0acfed35861c80a15a8c2ab5fdb9_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-4ccc0acfed35861c80a15a8c2ab5fdb9_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;891&quot; data-rawheight=&quot;599&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;891&quot; data-original=&quot;https://pic2.zhimg.com/v2-4ccc0acfed35861c80a15a8c2ab5fdb9_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-4ccc0acfed35861c80a15a8c2ab5fdb9_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;接下来，Korn , Moller, and Schwehm (2019) 一文做了一个有趣的实验：考察不同回撤指标在区分策略上的能力。作为对照，它们考虑了随机策略（hit ratio = 0.5）和真正有正期望的策略（hit ratio = 0.6）。结果发现，在这些不同的回撤指标中，平均回撤（ADD）、线性加权回撤（lwDD）以及平均回撤平方（ADD^2）的效果最接近 —— 表现在使用这些回撤指标对策略性能排序的相似度高。而最大回撤（MDD）与前三者的相似度却有一定差异。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-5b593cdb4d8bbed63d3f54c6f3bb319c_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;900&quot; data-rawheight=&quot;905&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;900&quot; data-original=&quot;https://pic1.zhimg.com/v2-5b593cdb4d8bbed63d3f54c6f3bb319c_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-5b593cdb4d8bbed63d3f54c6f3bb319c_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;900&quot; data-rawheight=&quot;905&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;900&quot; data-original=&quot;https://pic1.zhimg.com/v2-5b593cdb4d8bbed63d3f54c6f3bb319c_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-5b593cdb4d8bbed63d3f54c6f3bb319c_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;既然存在差异，那么哪些回撤指标能够更好的区分随机策略和正期望策略呢？结果（下图）显示，ADD、lwDD 以及 ADD^2 的效果最佳。相比于最大回撤 MDD，这些回撤指标更能够区分随机和正期望策略，因而是更合理的评价指标。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-bec51fdf15cf6dba74204f2164534e46_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;919&quot; data-rawheight=&quot;775&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;919&quot; data-original=&quot;https://pic3.zhimg.com/v2-bec51fdf15cf6dba74204f2164534e46_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-bec51fdf15cf6dba74204f2164534e46_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;919&quot; data-rawheight=&quot;775&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;919&quot; data-original=&quot;https://pic3.zhimg.com/v2-bec51fdf15cf6dba74204f2164534e46_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-bec51fdf15cf6dba74204f2164534e46_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;投资者都是厌恶风险的；没有谁在策略发生回撤后仍然会感到很愉悦。然而，我想说的是，过分关注最大回撤的点估计、而忽视其他指标则可能步入误区。如果我的管理人一味地为了迎合投资者、调节参数以降低（样本内）最大回撤，那很可能得不偿失。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;04 择时&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;我想说的最后一点是能否对策略择时。作为一个策略，我总有表现好的时候、也总有表现差的时候，这其实都是正常的。然而，如果陷入第一节讨论的小数定律偏误，那可能会误认为可以择时。&lt;/p&gt;&lt;p&gt;如果我是一个满足“有效性”的策略，那么择时基本上是徒劳的。有效性的定义如下：&lt;/p&gt;&lt;p&gt;&lt;i&gt;一个有效的策略应该是时序收益率均值为正，且每期收益率之间满足 IID 分布，它的夏普率无法通过其他作用于其收益率序列之上的函数来提高。&lt;/i&gt;&lt;/p&gt;&lt;p&gt;上面这段话的意思是，如果有一个非有效的策略，它的时序收益率序列由 {R(t), t = 0, 1, …} 表示；那么存在一个作用于长度为 n 的历史收益率序列 {R(t-n), …, R(t)} 的函数 h，并令 g(t) = h{R(t-n), …, R(t)}，则以 {g(t), t = 0, 1, …} 为收益率序列的新策略比原始策略有更高的夏普率：SR(g(t)) &amp;gt; SR(f(t))。&lt;/p&gt;&lt;p&gt;夏普率衡量了一个策略的随机性，因此只要是存在随机性的策略，其夏普率就一定有上界。如果一个策略的各期收益率之间有相关性，那么则可以充分利用收益率的相关性来找到一个函数 h，使改进后的策略有更高的夏普率，直到各期收益率之间满足 IID。&lt;/p&gt;&lt;p&gt;一旦策略已经满足有效性 —— 按照上述定义，对于大部分外部投资者来说，他们看到的管理人的策略已经十分有效了 —— 额外的择时无法带来更好的风险收益特征。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;05 结语&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;我是一个策略。我的管理人把他的投资实践经验归纳总结，将经验抽象提炼转化成为科学知识，便形成了我。希望这份自白让我的管理人听到我的心声，规避量化投资中的一些常见问题，为投资者争取更高的风险调整后收益。&lt;/p&gt;&lt;p&gt;我只是一个策略。&lt;/p&gt;&lt;p&gt;I am only as good as the person who runs me.&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;参考文献&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Korn, O., P. M. Moller, and C. Schwehm (2019). Drawdown measures: Are they all the same? SSRN No. 3473694.&lt;/li&gt;&lt;li&gt;Tversky, A. and D. Kahneman (1971). Belief in the law of small numbers. &lt;i&gt;Psychological Bulletin&lt;/i&gt;, Vol. 76(2), 105 – 110.&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;免责声明：&lt;/b&gt;文章内容不可视为投资意见。市场有风险，入市需谨慎。&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处。已委托“维权骑士”(&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//rightknights.com/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;维权骑士_免费版权监测/版权保护/内容多平台分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2020-02-17-106826464</guid>
<pubDate>Mon, 17 Feb 2020 00:00:00 +0800</pubDate>
</item>
<item>
<title>直观理解 GRS 和 MV Spanning</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2020-02-03-104852124.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/104852124&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-66057442e5e29dde47360da45a49727a_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;摘要&lt;/b&gt;&lt;/p&gt;&lt;p&gt;GRS 和 Mean-Variance Spanning 是常见的多因子模型检验手段。本文介绍它们的直观含义。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;01 引言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;所有的多因子模型都“不完美”—— 只要我们拿足够多的 test assets 去“折磨”它，任何模型都会被拒绝。然而有些模型是“有用”的。&lt;/p&gt;&lt;p&gt;如果一个模型中的因子都有可靠的经济学或金融学依据、代表了某种系统性风险或错误定价的原因，且该多因子模型能够解释大量所谓的异象的话，那么这样一个模型就是有用的。然而从不同的逻辑出发，人们总能提出不同的因子，并用它们组合出不同的多因子模型。如何评判哪个模型更好呢？&lt;/p&gt;&lt;p&gt;Barillas and Shanken (2017) 指出，评价一个多因子模型既要看它能否解释 test assets 又要看它能否解释其他模型的因子。这意味着我们往往用一篮子资产去检验一个多因子模型。怎么检验呢？通常来说可以有两个切入点。&lt;/p&gt;&lt;p&gt;第一个切入点是联合检验 N 个定价误差是否为零；与之相反的，第二个切入点则是单独考察每个资产的定价误差是否为零。无论是哪种切入点，在学术界的实证资产定价中都十分常见。对于前者，最常使用的方法当属 GRS 检验和 Mean-Variance Spanning（均值-方差张成）检验。解释这两种检验的直观含义就是本文的目标。&lt;/p&gt;&lt;p&gt;在接下来的文章中，假设待检验的多因子模型包含 K 个因子，用于检验模型的 test assets 有 N 个。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;02 GRS 检验&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;GRS 检验由 Gibbons, Ross, Shanken (1989) 提出，并由此得名。关于它的检验统计量，前文&lt;a href=&quot;https://zhuanlan.zhihu.com/p/40984029&quot; class=&quot;internal&quot;&gt;《股票多因子模型的回归检验》&lt;/a&gt;的时序回归已经做过介绍，本文不再赘述。此外，[因子动物园] 的&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//mp.weixin.qq.com/s%3F__biz%3DMzUxNzY0NjU3Mw%3D%3D%26mid%3D2247484061%26idx%3D1%26sn%3Db836d7aa4d140ee6d2a2887dff882451%26chksm%3Df995b31fcee23a09274a42f56c6741369ffc174821200597e3de9319257903145ff4f6358046%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;《检验因子模型：&lt;/a&gt;&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//mp.weixin.qq.com/s%3F__biz%3DMzUxNzY0NjU3Mw%3D%3D%26mid%3D2247484061%26idx%3D1%26sn%3Db836d7aa4d140ee6d2a2887dff882451%26chksm%3Df995b31fcee23a09274a42f56c6741369ffc174821200597e3de9319257903145ff4f6358046%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Alpha, GRS 与 GMM》&lt;/a&gt;一文也有过说明，感兴趣的小伙伴请参考。&lt;/p&gt;&lt;p&gt;GRS 检验有两个优点。首先，它的 F-统计量是有限样本（finite sample）下的统计量，即 GRS 检验给出了给定样本大小 T 下这些定价误差应满足的联合分布，该检验是高度精确的。当样本量趋于无穷的时候，定价误差的联合分布渐进趋于 χ2 分布，但在有限样本下使用 χ2 分布并不可靠，这就凸显了 GRS 检验的价值。此外，GRS 检验有非常高的检验效力。当然，任何事物都有两面。GRS 统计量的精确性高度依赖正态分布假设，即资产收益率的残差服从联合正态分布。在现实中，该假设可能过于严格而无法满足，这会降低 GRS 检验在实践中的可信度。&lt;/p&gt;&lt;p&gt;GRS 检验被学术界广泛使用。比如 Liu, Stambaugh, and Yuan (2019) 就用 GRS 检验比较了他们提出的中国版三因子模型和按照 Fama and French (1993) 一文构建的三因子模型。通过这两个多因子模型之间的因子相互 PK，Liu, Stambaugh, and Yuan (2019) 发现他们的因子优于Fama and French (1993) 中的因子。&lt;/p&gt;&lt;p&gt;借助计算机的运算能力，我们如今可以很容易的计算出 GRS 统计量并进行检验。但是计算归计算，我们更希望搞清楚 GRS 检验背后的本质。好消息是，GRS 统计量还有另一种形式：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Cfrac%7BT-N-K%7D%7BN%7D%5Cleft%28%5Cleft%5B%5Cfrac%7B%5Csqrt%7B1%2B%5Chat%7B%5Ctheta%7D_%7BN%2BK%7D%5E2%7D%7D%7B%5Csqrt%7B1%2B%5Chat%7B%5Ctheta%7D_%7BK%7D%5E2%7D%7D%5Cright%5D%5E2-1%5Cright%29%5Csim+F_%7BN%2C+T-N-K%7D&quot; alt=&quot;\displaystyle\frac{T-N-K}{N}\left(\left[\frac{\sqrt{1+\hat{\theta}_{N+K}^2}}{\sqrt{1+\hat{\theta}_{K}^2}}\right]^2-1\right)\sim F_{N, T-N-K}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;上式中， &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+%CE%B8_%7BN%2BK%7D&quot; alt=&quot;\hat θ_{N+K}&quot; eeimg=&quot;1&quot;/&gt; 表示由全部 N 个 test assets 和 K 个因子构成的事后（ex post）最大夏普率投资组合的夏普率； &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+%CE%B8_K&quot; alt=&quot;\hat θ_K&quot; eeimg=&quot;1&quot;/&gt; 表示由 K 个因子构成的事后最大夏普率投资组合的夏普率。GRS 统计量可以直观的理解为当 K 个因子之外加入 N 个 test assets 之后，能够获得的最大夏普率是否显著高于仅由 K 个因子实现的最大夏普率。如果夏普率显著提高，那么该因子模型就不能解释这 N 个 test assets。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;03 Mean-Variance Spanning 检验&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;Huberman and Kandel (1987) 提出的 Mean-Variance Spanning（以下简称 MV Spanning）检验是另一种常见的联合检验手段。从名字就不难看出来，该方法和现代投资组合理论（Modern Portfolio Theory，下称 MPT）以及均值-方差分析有着紧密的联系。&lt;/p&gt;&lt;p&gt;这种方法的核心无疑是 spanning 一词。假如市场中有 K 个因子投资组合；通过按各种不同的权重配置它们又能得到许多新的组合。对于每个给定的预期收益率 \hat μ，都能找到它的最小方差投资组合。将不同 \hat μ的最小方差投资组合都绘制在横坐标为标准差、纵坐标为预期收益的二维平面内，就得到了人们熟悉的最小方差前沿（minimum-variance frontier），它的形状是一个抛物线。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-57cc51da97c662310a6a81d48c85e4a0_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;724&quot; data-rawheight=&quot;514&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;724&quot; data-original=&quot;https://pic1.zhimg.com/v2-57cc51da97c662310a6a81d48c85e4a0_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-57cc51da97c662310a6a81d48c85e4a0_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;724&quot; data-rawheight=&quot;514&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;724&quot; data-original=&quot;https://pic1.zhimg.com/v2-57cc51da97c662310a6a81d48c85e4a0_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-57cc51da97c662310a6a81d48c85e4a0_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;图中的最小方差前沿就是由这 K 个因子 spanned 出来的，这就是这种方法得名的原因。而 MV Spanning 检验所关注的问题用一句话概括那就是：加入 N 个 test assets 后，全部 N + K 个资产张成的新的最小方差前沿能否显著“优于”仅由 K 个因子张成的最小方差前沿。“优于”意味着对于每一个给定的预期收益率，N + K 个资产张成的前沿上的点都比 K 个因子张成的前沿上的点有更低的方差。&lt;/p&gt;&lt;p&gt;下面来看看数学上这种检验的原假设是什么。令 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cpmb%7BR%7D_%7B1t%7D&quot; alt=&quot;\pmb{R}_{1t}&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cpmb%7BR%7D_%7B2t%7D&quot; alt=&quot;\pmb{R}_{2t}&quot; eeimg=&quot;1&quot;/&gt; 分别为 K 个因子和 N 个test assets 的收益率向量。由多因子模型可知：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cpmb%7BR%7D_%7B2t%7D%3D%5Cpmb%7B%5Calpha%7D%2B%5Cpmb%7B%5Cbeta%7D%5Cpmb%7BR%7D_%7B1t%7D%2B%5Cpmb%7B%5Cvarepsilon%7D_t&quot; alt=&quot;\pmb{R}_{2t}=\pmb{\alpha}+\pmb{\beta}\pmb{R}_{1t}+\pmb{\varepsilon}_t&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;接下来，定义 &lt;b&gt;δ&lt;/b&gt; = &lt;b&gt;1&lt;/b&gt;_N – &lt;b&gt;β1&lt;/b&gt;_K（下标 N 和 K 代表向量中元素个数）。Huberman and Kandel (1987) 给出了 MV Spanning 检验的原假设的充要条件：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brrl%7D+H_0%26%5Cmbox%7B%3A%7D%26%5Cpmb%7B%5Calpha%7D%3D%5Cpmb%7B0%7D_N%2C~%5Cpmb%7B%5Cdelta%7D%3D%5Cpmb%7B0%7D_N+%5Cend%7Barray%7D&quot; alt=&quot;\begin{array}{rrl} H_0&amp;amp;\mbox{:}&amp;amp;\pmb{\alpha}=\pmb{0}_N,~\pmb{\delta}=\pmb{0}_N \end{array}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;当原假设成立时，对于任何一个 test asset（或这些 assets 的线性组合），我们总能使用 K 个因子来构建一个投资组合，并使得该投资组合的预期收益率和 test assets 的预期收益率相同，但方差更低。这两条关于预期收益率和方差的性质说明，这 N 个 test assets 无法在 K 的基础上张成更优的最小方差前沿，因此可以接受原假设。&lt;/p&gt;&lt;p&gt;除了上述数学含义外，从由全部 N + K 个资产张成的最小方差前沿上也能够找到上述原假设的直观解释。Kan and Zhou (2012) 指出，在这个最小方差前沿上存在两个特殊的投资组合。其一是全局最小方差组合（global minimum-variance portfolio），其二是从均值-标准差二维平面的原点向最小方差前沿做切线的切点。&lt;/p&gt;&lt;p&gt;如果原假设成立，条件 &lt;b&gt;α&lt;/b&gt; = &lt;b&gt;0&lt;/b&gt; 则意味着全局最小方差投资组合中，N 个 test assets 的权重都是零，即该组合完全由 K 个因子构成；条件 &lt;b&gt;δ&lt;/b&gt; = &lt;b&gt;0&lt;/b&gt; 意味着切点投资组合中也没有 N 个 test assets 的身影。换句话说，这两个特殊的投资组合均仅仅由 K 个因子构成。&lt;/p&gt;&lt;p&gt;在投资组合理论中，有一个重要的定理是 two-fund separation theorem。它的含义是，使用最小方差前沿上的任意两个组合就能构造出整个前沿，即前沿上的其他组合都可以由这两个投资组合的某种线性组合得到。利用 two-fund separation theorem，可以推断出如果这两个投资组合中均不包含 N 个 test assets，那么整个由 N + K 个资产构成的最小方差前沿上的所有投资组合都不包含它们，这就解释了为什么 &lt;b&gt;α&lt;/b&gt; = &lt;b&gt;0&lt;/b&gt; 和 &lt;b&gt;δ&lt;/b&gt; = &lt;b&gt;0&lt;/b&gt; 是原假设成立的充要条件。&lt;/p&gt;&lt;p&gt;虽然我们已经从直观上理解了 MV Spanning 检验要干什么以及它的原假设是什么，但为了进行检验，还是要用到具体的统计检验量。在这方面，Huberman and Kandel (1987) 一文最早提出了似然比（likelihood ratio）检验统计量；Kan and Zhou (2012) 在它的基础上又通过 Wald 检验和拉格朗日乘数（Lagrange multiplier）检验构建了两个检验统计量。这三个检验统计量在大样本下都渐进满足自由度为 2N 的 χ2 分布。&lt;/p&gt;&lt;p&gt;这三个统计量的表达式十分接近，且均和两个重要参数 λ_1 和 λ_2 有关。关于这两个参数，Kan and Zhou (2012) 给出了一个非常直观的经济学解释。为了介绍它，首先需要一些铺垫。考虑下图所示的均值-方差平面中由 K 个因子张成的最小方差前沿。在纵轴上取 (0,r) 点并从它向最小方差前沿做切线、找到切点组合 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%28%5Chat+%CE%BC_%7Btp%7D%2C+%5Chat+%CF%83_%7Btp%7D%29&quot; alt=&quot;(\hat μ_{tp}, \hat σ_{tp})&quot; eeimg=&quot;1&quot;/&gt; 。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-1acb2f4ecec2b832aba67c530b460aab_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;622&quot; data-rawheight=&quot;435&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;622&quot; data-original=&quot;https://pic4.zhimg.com/v2-1acb2f4ecec2b832aba67c530b460aab_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-1acb2f4ecec2b832aba67c530b460aab_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;622&quot; data-rawheight=&quot;435&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;622&quot; data-original=&quot;https://pic4.zhimg.com/v2-1acb2f4ecec2b832aba67c530b460aab_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-1acb2f4ecec2b832aba67c530b460aab_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;接下来，定义：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Chat%5Ctheta_K%28r%29%3D%5Cfrac%7B%5Chat%5Cmu_%7Btp%7D-r%7D%7B%5Chat%5Csigma_%7Btp%7D%7D&quot; alt=&quot;\displaystyle\hat\theta_K(r)=\frac{\hat\mu_{tp}-r}{\hat\sigma_{tp}}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;它表示图中切线的斜率。由于不同的 (0,r) 点会产生不同的切线，因此 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+%CE%B8_K%28r%29&quot; alt=&quot;\hat θ_K(r)&quot; eeimg=&quot;1&quot;/&gt; 是 r 的函数。当 r 等于真正的无风险利率 R_f 时， &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+%CE%B8_K%28R_f%29&quot; alt=&quot;\hat θ_K(R_f)&quot; eeimg=&quot;1&quot;/&gt; 就是从 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%280%2CR_f%29&quot; alt=&quot;(0,R_f)&quot; eeimg=&quot;1&quot;/&gt; 出发得到的切点组合的夏普率。类似的，当把 N 个 test assets 加入后，我们可以定义 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+%CE%B8_%7BN%2BK%7D%28r%29&quot; alt=&quot;\hat θ_{N+K}(r)&quot; eeimg=&quot;1&quot;/&gt; 。有了这两个 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+%CE%B8&quot; alt=&quot;\hat θ&quot; eeimg=&quot;1&quot;/&gt; 就可以写出 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%BB_1&quot; alt=&quot;λ_1&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%BB_2&quot; alt=&quot;λ_2&quot; eeimg=&quot;1&quot;/&gt; 的表达式了：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+%5Clambda_1%26%3D%26%5Cdisplaystyle%5Cmax_r%5Cfrac%7B1%2B%5Chat%5Ctheta%5E2_%7BN%2BK%7D%28r%29%7D%7B1%2B%5Chat%5Ctheta%5E2_%7BK%7D%28r%29%7D-1%5C%5C+%5Clambda_2%26%3D%26%5Cdisplaystyle%5Cmin_r%5Cfrac%7B1%2B%5Chat%5Ctheta%5E2_%7BN%2BK%7D%28r%29%7D%7B1%2B%5Chat%5Ctheta%5E2_%7BK%7D%28r%29%7D-1+%5Cend%7Barray%7D&quot; alt=&quot;\begin{array}{rll} \lambda_1&amp;amp;=&amp;amp;\displaystyle\max_r\frac{1+\hat\theta^2_{N+K}(r)}{1+\hat\theta^2_{K}(r)}-1\\ \lambda_2&amp;amp;=&amp;amp;\displaystyle\min_r\frac{1+\hat\theta^2_{N+K}(r)}{1+\hat\theta^2_{K}(r)}-1 \end{array}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;最后，通过 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%BB_1&quot; alt=&quot;λ_1&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%BB_2&quot; alt=&quot;λ_2&quot; eeimg=&quot;1&quot;/&gt; 就可以方便的求出似然比检验、Wald 检验以及拉格朗日乘数检验的统计量（分别记为 LR、W 和 LM）：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+LR%26%3D%26%5Cdisplaystyle+T%5Cleft%28%5Cln%281%2B%5Clambda_1%29%2B%5Cln%281%2B%5Clambda_2%29%5Cright%29%5Cstackrel%7BA%7D%7B%5Csim%7D%5Cchi%5E2_%7B2N%7D%5C%5C+W%26%3D%26%5Cdisplaystyle+T%5Cleft%28%5Clambda_1%2B%5Clambda_2%5Cright%29%5Cstackrel%7BA%7D%7B%5Csim%7D%5Cchi%5E2_%7B2N%7D%5C%5C+LM%26%3D%26%5Cdisplaystyle+T%5Cleft%28%5Cfrac%7B%5Clambda_1%7D%7B1%2B%5Clambda_1%7D%2B%5Cfrac%7B%5Clambda_2%7D%7B1%2B%5Clambda_2%7D%5Cright%29%5Cstackrel%7BA%7D%7B%5Csim%7D%5Cchi%5E2_%7B2N%7D+%5Cend%7Barray%7D&quot; alt=&quot;\begin{array}{rll} LR&amp;amp;=&amp;amp;\displaystyle T\left(\ln(1+\lambda_1)+\ln(1+\lambda_2)\right)\stackrel{A}{\sim}\chi^2_{2N}\\ W&amp;amp;=&amp;amp;\displaystyle T\left(\lambda_1+\lambda_2\right)\stackrel{A}{\sim}\chi^2_{2N}\\ LM&amp;amp;=&amp;amp;\displaystyle T\left(\frac{\lambda_1}{1+\lambda_1}+\frac{\lambda_2}{1+\lambda_2}\right)\stackrel{A}{\sim}\chi^2_{2N} \end{array}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;这三个统计量虽然略有差异，但它们都是以某种形式将 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%BB_1&quot; alt=&quot;λ_1&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%BB_2&quot; alt=&quot;λ_2&quot; eeimg=&quot;1&quot;/&gt; 凑在一起作为一个综合的分数来检验原假设。由 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%BB_1&quot; alt=&quot;λ_1&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%BB_2&quot; alt=&quot;λ_2&quot; eeimg=&quot;1&quot;/&gt; 的定义可知，我们实际上在纵轴上搜寻两个特殊的 r：对于第一个 r，由 K 和 N + K 个资产张成的最小方差前沿上的相应的两个切点的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+%CE%B8&quot; alt=&quot;\hat θ&quot; eeimg=&quot;1&quot;/&gt; 值差异最大；对于第二个 r，这两个最小方差前沿上的相应的两个切点的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+%CE%B8&quot; alt=&quot;\hat θ&quot; eeimg=&quot;1&quot;/&gt; 值差异最小。这三种统计量以这两个特殊 r 下两个前沿的综合差异来检验这两个前沿是否在统计上有所不同。&lt;/p&gt;&lt;p&gt;以上就是大样本下三种 MV Spanning 检验的统计量。有必要说明的是，当样本量 T 较总资产数 N + K 不足够大时，使用这些统计量并不准确，更好的方法是像 GRS 检验一样计算有限样本下的统计量。悲催的是，从数学上推导有限样本下统计量的表达式十分繁琐。不悲催的是，Kan and Zhou (2012) 给出了这些统计量的几何含义，理解起来就一个字 —— 爽！本文第 4 节将会介绍。&lt;/p&gt;&lt;p&gt;关于 MV Spanning 检验的应用，一个很有代表性的例子是 Han, Zhou, and Zhu (2016)（见&lt;a href=&quot;https://zhuanlan.zhihu.com/p/51043407&quot; class=&quot;internal&quot;&gt;《美股上一个跨越时间尺度的趋势因子》&lt;/a&gt;）。三位作者针对美股提出了一个趋势因子，它不同于传统的动量或反转，而是将不同时间尺度下收益率的动量和反转现象综合到一起，构建了一个综合的趋势因子。该文用新的趋势因子作为 test asset，用传统的短期反转、中期动量以及长期反转因子作为解释变量，通过 MV Spanning 检验进行了分析。结果显示，这三个因子无法解释新的趋势因子，即加入新的趋势因子后，最小方差前沿得到了显著提升。&lt;/p&gt;&lt;p&gt;最后，对比 MV Spanning 中的统计量和 GRS 检验的统计量能够发现这些表达式中都有“神秘的” &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+%CE%B8&quot; alt=&quot;\hat θ&quot; eeimg=&quot;1&quot;/&gt; —— 只不过 GRS 检验中的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+%CE%B8&quot; alt=&quot;\hat θ&quot; eeimg=&quot;1&quot;/&gt; 默认的是用无风险收益率 &lt;img src=&quot;https://www.zhihu.com/equation?tex=R_f&quot; alt=&quot;R_f&quot; eeimg=&quot;1&quot;/&gt; 计算的夏普率，而 MV Spanning 中的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+%CE%B8&quot; alt=&quot;\hat θ&quot; eeimg=&quot;1&quot;/&gt; 是使用一般的 r 计算。这意味着它们之间注定有一些关联。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;04 几何含义&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;无论是 GRS 还是 MV Spanning 都是为了检验 N 个 test assets 能否在原始 K 个因子基础上提高投资组合的风险收益特征。既然是“同一个目标、同一个梦想”，那么它们之间又有什么差异呢？最直观的说明无异于使用几何方法解释它们的含义。让我们从有效前沿（efficient frontier）说起。&lt;/p&gt;&lt;p&gt;根据市场中是否存在无风险收益率 &lt;img src=&quot;https://www.zhihu.com/equation?tex=R_f&quot; alt=&quot;R_f&quot; eeimg=&quot;1&quot;/&gt; ，有效前沿的定义是不同的。下图左侧展示了存在 &lt;img src=&quot;https://www.zhihu.com/equation?tex=R_f&quot; alt=&quot;R_f&quot; eeimg=&quot;1&quot;/&gt; 的情况、右侧展示了不存在 &lt;img src=&quot;https://www.zhihu.com/equation?tex=R_f&quot; alt=&quot;R_f&quot; eeimg=&quot;1&quot;/&gt; 的情况。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-5e96cc7fecc8590eb85c6346f320f8da_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1167&quot; data-rawheight=&quot;430&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1167&quot; data-original=&quot;https://pic3.zhimg.com/v2-5e96cc7fecc8590eb85c6346f320f8da_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-5e96cc7fecc8590eb85c6346f320f8da_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1167&quot; data-rawheight=&quot;430&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1167&quot; data-original=&quot;https://pic3.zhimg.com/v2-5e96cc7fecc8590eb85c6346f320f8da_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-5e96cc7fecc8590eb85c6346f320f8da_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;先看市场中存在无风险利率 &lt;img src=&quot;https://www.zhihu.com/equation?tex=R_f&quot; alt=&quot;R_f&quot; eeimg=&quot;1&quot;/&gt; 的情况。MPT 指出有效前沿是图中经过点 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%280%2C+R_f%29&quot; alt=&quot;(0, R_f)&quot; eeimg=&quot;1&quot;/&gt; 和切点的直线。无论一个人容忍的最大风险是什么，他都应该通过无风险资产和切点组合的某种线性组合实现最优选择，因为这条线的斜率最高，即夏普率最高。&lt;/p&gt;&lt;p&gt;GRS 检验假设市场中存在无风险利率 &lt;img src=&quot;https://www.zhihu.com/equation?tex=R_f&quot; alt=&quot;R_f&quot; eeimg=&quot;1&quot;/&gt; 。回顾一下本文第二节中 GRS 统计量，它关注的核心问题就是加入 N 个 test assets之后，使用全部 N + K 个资产得到的切点组合能否比仅仅使用 K 个因子得到的切点组合有更高的夏普率；除切点组合外，GRS 检验不关心最小方差前沿上的其他点。下图为 GRS 检验的几何意义。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-8def928bfcfa0186c73032ed66bcb9b2_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;612&quot; data-rawheight=&quot;431&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;612&quot; data-original=&quot;https://pic3.zhimg.com/v2-8def928bfcfa0186c73032ed66bcb9b2_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-8def928bfcfa0186c73032ed66bcb9b2_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;612&quot; data-rawheight=&quot;431&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;612&quot; data-original=&quot;https://pic3.zhimg.com/v2-8def928bfcfa0186c73032ed66bcb9b2_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-8def928bfcfa0186c73032ed66bcb9b2_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;为了方便解释，图中的纵坐标采取了相对 R_f 的超额收益。图中两条切线分别通过原点到由 K 个因子和全部 N + K 个资产张成的最小方差前沿的切点。如果多因子模型无法解释 test assets，那么加入它们之后应该显著提升切点组合的夏普率。在图中横坐标上的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+%CF%83+%3D+1&quot; alt=&quot;\hat σ = 1&quot; eeimg=&quot;1&quot;/&gt; 点出发做一条竖直线，它和两条切线相较于 A、B。由夏普率定义可知，A、B 两点纵坐标对应的超额收益恰恰就等于夏普率 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+%CE%B8_K&quot; alt=&quot;\hat θ_K&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+%CE%B8_%7BN%2BK%7D&quot; alt=&quot;\hat θ_{N+K}&quot; eeimg=&quot;1&quot;/&gt; ，而它们也正是正两条直线的斜率。&lt;/p&gt;&lt;p&gt;由此可知 GRS 统计量中的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Csqrt%7B1%2B%5Chat%7B%5Ctheta%7D_%7BK%7D%5E2%7D&quot; alt=&quot;\sqrt{1+\hat{\theta}_{K}^2}&quot; eeimg=&quot;1&quot;/&gt;  和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Csqrt%7B1%2B%5Chat%7B%5Ctheta%7D_%7BN%2BK%7D%5E2%7D&quot; alt=&quot;\sqrt{1+\hat{\theta}_{N+K}^2}&quot; eeimg=&quot;1&quot;/&gt;  分别为线段 OA 和 OB 的长度。因此 GRS 统计量的公式反应了这两个线段长度之比，它的意思是检验 OB 的长度是否显著的大于线段 OA 的长度。这正是 GRS 检验的几何意义。&lt;/p&gt;&lt;p&gt;再来说 MV Spanning。上一节介绍了大样本下三种统计量的渐进性质。下面的几何解释则给出了这些统计量在有限样本中的含义。与 GRS 检验不同，MV Spanning 并不假设 &lt;img src=&quot;https://www.zhihu.com/equation?tex=R_f&quot; alt=&quot;R_f&quot; eeimg=&quot;1&quot;/&gt; 的存在，因此适应更广泛的情况。当 &lt;img src=&quot;https://www.zhihu.com/equation?tex=R_f&quot; alt=&quot;R_f&quot; eeimg=&quot;1&quot;/&gt; 不存在时，有效前沿是最小方差前沿的上半部分（本小节第一张图的右侧）。&lt;/p&gt;&lt;p&gt;在这种情况下，仍然像 GRS 一样仅仅关注切点组合就不够了 —— 事实上，因为不存在 &lt;img src=&quot;https://www.zhihu.com/equation?tex=R_f&quot; alt=&quot;R_f&quot; eeimg=&quot;1&quot;/&gt; ，因此也没有传统意义上的切点组合。我们希望检验两个事后抛物线是不是在统计上“足够远”—— 原假设是事前没有差别。但既然仅使用一个点来评判不够了，那么怎么办呢？&lt;/p&gt;&lt;p&gt;对了，答案是“找两个点”。&lt;/p&gt;&lt;p&gt;从两个最小方差前沿上找到两个特殊的点进行比较、评判这两个前沿的差异，这就是 MV Spanning 检验的几何含义（下图，出自 Kan and Zhou 2012，就是要通过特殊的点来评价红、蓝两个前沿是不是在统计上足够接近）。而 LR、W 和 LM 三种不同检验统计量之间的差异仅仅因为它们比较这两个前沿的方式稍有区别。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-e0787b31becaca3c293503fb2cd34a9b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;788&quot; data-rawheight=&quot;560&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;788&quot; data-original=&quot;https://pic4.zhimg.com/v2-e0787b31becaca3c293503fb2cd34a9b_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-e0787b31becaca3c293503fb2cd34a9b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;788&quot; data-rawheight=&quot;560&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;788&quot; data-original=&quot;https://pic4.zhimg.com/v2-e0787b31becaca3c293503fb2cd34a9b_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-e0787b31becaca3c293503fb2cd34a9b_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;图中 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_1&quot; alt=&quot;g_1&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g&quot; alt=&quot;g&quot; eeimg=&quot;1&quot;/&gt; 分别为由 K 个因子和全部 N + K 个资产张成的事后最小方差投资组合，这两个点代表的投资组合的标准差的大小由图中线段 OD 和 OC 的长度表示。从 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g&quot; alt=&quot;g&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_1&quot; alt=&quot;g_1&quot; eeimg=&quot;1&quot;/&gt; 向纵轴做垂线，得到 A 和 B 两个点。从 A 出发向 K 个因子的最小方差前沿做切线，切线和直线 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+%CF%83+%3D+1&quot; alt=&quot;\hat σ = 1&quot; eeimg=&quot;1&quot;/&gt; 相交于点 G、同样从 A 出发做 N + K 个资产的最小方差前沿的渐进线，渐进线和直线 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+%CF%83+%3D+1&quot; alt=&quot;\hat σ = 1&quot; eeimg=&quot;1&quot;/&gt; 相交于点 H。类似的，以点 B 为起点，做 N + K 个资产的最小方差前沿的切线、做 K 个因子的最小方差前沿的渐进线，它们分别与直线 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+%CF%83+%3D+1&quot; alt=&quot;\hat σ = 1&quot; eeimg=&quot;1&quot;/&gt; 相交于点 E 和 F。使用 OC、OD、AG、AH、BE 和 BF 就可以解释三种检验统计量的几何意义。&lt;/p&gt;&lt;p&gt;先说似然比检验。在有限样本下，其检验统计量满足 &lt;img src=&quot;https://www.zhihu.com/equation?tex=F_%7B2N%2C+2%28T-K-N%29%7D&quot; alt=&quot;F_{2N, 2(T-K-N)}&quot; eeimg=&quot;1&quot;/&gt; 分布：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+LR%3D%5Cleft%28%5Cfrac%7BT-K-N%7D%7BN%7D%5Cright%29%5Cleft%5B%5Cleft%28%5Cfrac%7BOD%7D%7BOC%7D%5Cright%29%5Cleft%28%5Cfrac%7BAH%7D%7BBF%7D%5Cright%29-1%5Cright%5D&quot; alt=&quot;\displaystyle LR=\left(\frac{T-K-N}{N}\right)\left[\left(\frac{OD}{OC}\right)\left(\frac{AH}{BF}\right)-1\right]&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;LR 的大小和两个比值有关。第一个比值 OD/OC 比较两个全局最小方差组合的标准差。由于 K 个因子构成的最小方差组合的标准差一定不小于 N + K 个资产构成的最小方差组合的标准差，因此 OD/OC ≥ 1。第二个比值是 AH/BF。由于 N + K 个资产张成的事后最小方差前沿一定“优于”仅由 K 个因子张成的事后最小方差前沿，因此 AH/BF ≥ 1。如果原假设成立，即事前（ex ante）两个前沿一样，那么我们可以期待 OD/OC 和 AH/BF 都不会显著的偏离 1。如果它们其中之一或者二者全部显著大于 1，那么原假设就会被拒绝。&lt;/p&gt;&lt;p&gt;对于 Wald 检验和拉格朗日乘数检验，在有限样本下，它们统计量并不满足 F 分布，而是十分复杂的分布，但仍然可以写出它们统计量的几何含义：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brrrll%7D+W%26%5Cmbox%7B%3A%7D%26%5Cdisplaystyle+%5Clambda_1%2B%5Clambda_2%26%3D%26%5Cdisplaystyle%5Cleft%28%5Cfrac%7BOD%7D%7BOC%7D%5Cright%29%5E2-1%2B%5Cleft%28%5Cfrac%7BBE%7D%7BBF%7D%5Cright%29%5E2-1%5C%5C+LM%26%5Cmbox%7B%3A%7D%26%5Cdisplaystyle%5Cfrac%7B%5Clambda_1%7D%7B1%2B%5Clambda_1%7D%2B%5Cfrac%7B%5Clambda_2%7D%7B1%2B%5Clambda_2%7D%26%3D%26%5Cdisplaystyle+1-%5Cleft%28%5Cfrac%7BOC%7D%7BOD%7D%5Cright%29%5E2%2B1-%5Cleft%28%5Cfrac%7BAG%7D%7BAH%7D%5Cright%29%5E2+%5Cend%7Barray%7D&quot; alt=&quot;\begin{array}{rrrll} W&amp;amp;\mbox{:}&amp;amp;\displaystyle \lambda_1+\lambda_2&amp;amp;=&amp;amp;\displaystyle\left(\frac{OD}{OC}\right)^2-1+\left(\frac{BE}{BF}\right)^2-1\\ LM&amp;amp;\mbox{:}&amp;amp;\displaystyle\frac{\lambda_1}{1+\lambda_1}+\frac{\lambda_2}{1+\lambda_2}&amp;amp;=&amp;amp;\displaystyle 1-\left(\frac{OC}{OD}\right)^2+1-\left(\frac{AG}{AH}\right)^2 \end{array}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;怎么样？W 和 LM 的表达式看上去那是“相当对称”。&lt;/p&gt;&lt;p&gt;W 中的第一项是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%28OD%2FOC%29%5E2+-+1&quot; alt=&quot;(OD/OC)^2 - 1&quot; eeimg=&quot;1&quot;/&gt; ，它反映的仍然是两个全局最小方差组合的标准差偏离程度，由于 &lt;img src=&quot;https://www.zhihu.com/equation?tex=OD+%E2%89%A5+OC&quot; alt=&quot;OD ≥ OC&quot; eeimg=&quot;1&quot;/&gt; 因此该项中用 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%28OD%2FOC%29%5E2&quot; alt=&quot;(OD/OC)^2&quot; eeimg=&quot;1&quot;/&gt; 减去 1；再看 LM，它的第一项是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=1+-+%28OC%2FOD%29%5E2&quot; alt=&quot;1 - (OC/OD)^2&quot; eeimg=&quot;1&quot;/&gt; ，它和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%28OD%2FOC%29%5E2+-+1&quot; alt=&quot;(OD/OC)^2 - 1&quot; eeimg=&quot;1&quot;/&gt; 如出一辙，只不过因为分子分母互换了位置导致  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%28OC%2FOD%29%5E2+%E2%89%A4+1&quot; alt=&quot;(OC/OD)^2 ≤ 1&quot; eeimg=&quot;1&quot;/&gt;  因此该项中是用 1 减去 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%28OC%2FOD%29%5E2&quot; alt=&quot;(OC/OD)^2&quot; eeimg=&quot;1&quot;/&gt; 。&lt;/p&gt;&lt;p&gt;再看第二项。W 的第二项用到了线段 BE 和 BF，它们都是从 B 出发，BE 是 B 到全部 N + K 个资产的最小方差前沿的切线、BF 是 B 到 K 个因子的最小方差前沿的渐进线。 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%28BE%2FBF%29%5E2+-+1&quot; alt=&quot;(BE/BF)^2 - 1&quot; eeimg=&quot;1&quot;/&gt; 衡量了在 K 个因子的基础上加入 N 个 test assets 导致切线斜率平方的提升。反观 LM 的第二项，它用到了线段 AG 和 AH，它们都是从点 A 出发，AG 是 A 到 K 个因子的最小方差前沿的切线、AH 是 A 到 N + K 个资产的最小方差前沿的渐进线。 &lt;img src=&quot;https://www.zhihu.com/equation?tex=1+-+%28AG%2FAH%29%5E2&quot; alt=&quot;1 - (AG/AH)^2&quot; eeimg=&quot;1&quot;/&gt; 体现了从 N + K 个资产中去除 N 个 test assets（从而仅剩下 K 个因子）导致切线斜率平方的降低。&lt;/p&gt;&lt;p&gt;不光是表达式，就连解释起来都是那么“对称”。这种“对称”彰显了几何解释之美，彰显了数学之美。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;05 结语&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;GRS 和 MV Spanning 是实证资产定价中常见的检验方法（尤其是 GRS）。本文花了一些笔墨从直观上解释了它们都在干什么。&lt;/p&gt;&lt;p&gt;总结来说，GRS 假设 &lt;img src=&quot;https://www.zhihu.com/equation?tex=R_f&quot; alt=&quot;R_f&quot; eeimg=&quot;1&quot;/&gt; 存在，因此它关注的是切点组合的夏普率能否因 N 个 test assets 的加入而显著提升。反观 MV Spanning，它则直接比较两个最小方差前沿的差异。这些统计手段经过了几十年的发展和应用，而如今计算机的运算能力也可以“秒出”检验结果。然而，当我们搞清楚了这些检验统计量的直观含义后，它们便不再只是冰冷的公式，而是一个个令人拍案的“原来如此”。&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;参考文献&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Barillas, F. and J. Shanken (2017). Which alpha? &lt;i&gt;Review of Financial Studies&lt;/i&gt;, Vol. 30(4), 1316 – 1338.&lt;/li&gt;&lt;li&gt;Fama, E. F. and K. R. French (1993). Common risk factors in the returns on stocks and bonds. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 33(1), 3 – 56.&lt;/li&gt;&lt;li&gt;Gibbons, M. R., S. Ross, and J. Shanken (1989). A test of efficiency of a given portfolio.&lt;i&gt;Econometrica&lt;/i&gt;, Vol. 57(5), 1121 – 1152.&lt;/li&gt;&lt;li&gt;Han, Y., Zhou, G., Y. Zhu (2016). A trend factor: any economic gains from using information over investment horizons? &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 122(2), 352 – 375.&lt;/li&gt;&lt;li&gt;Huberman, G. and S. Kandel (1987). Mean-variance spanning. &lt;i&gt;Journal of Finance&lt;/i&gt;, Vol. 42(4), 873 – 888.&lt;/li&gt;&lt;li&gt;Kan, R. and G. Zhou (2012). Tests of mean-variance spanning. &lt;i&gt;Annals of Economics and Finance&lt;/i&gt;, Vol. 13(1), 145 – 193.&lt;/li&gt;&lt;li&gt;Liu, J., R. F. Stambaugh, and Y. Yuan (2019). Size and value in China. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 134(1), 48 – 69.&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;免责声明：&lt;/b&gt;文章内容不可视为投资意见。市场有风险，入市需谨慎。&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处。已委托“维权骑士”(&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//rightknights.com&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;维权骑士_免费版权监测/版权保护/内容多平台分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2020-02-03-104852124</guid>
<pubDate>Mon, 03 Feb 2020 00:00:00 +0800</pubDate>
</item>
<item>
<title>Generalized Method of Moments</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2020-01-27-92490417.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/92490417&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-99130ac172d0b32f0107c8fc68b18872_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;摘要&lt;/b&gt;&lt;/p&gt;&lt;p&gt;GMM 是研究 asset pricing 时绕不过的工具。本文介绍 GMM 框架的强大之处，并阐述其背后的数学之美。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;01 引言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;好了，来写写 &lt;b&gt;GMM（Generalized Method of Moments，广义矩估计）&lt;/b&gt;吧，站在 asset pricing 的视角。&lt;/p&gt;&lt;p&gt;前文&lt;a href=&quot;https://zhuanlan.zhihu.com/p/88458489&quot; class=&quot;internal&quot;&gt;《理解资产价格》&lt;/a&gt;已经提到，Hansen (1982) 提出的 GMM 在 empirical asset pricing 研究的历史上起到了举足轻重的作用，而如今无论是在经济学领域还是金融学领域，GMM 因其数学上的优雅和特性上的强大都被广泛的运用。&lt;/p&gt;&lt;p&gt;今天这篇文章算是我自己关于 GMM 的一个学习笔记，而我的学习资料（公众号的老朋友一定猜到了）正是 John Cochrane 教授的神书 Asset Pricing（Cochrane 2005）以及他在 UChicago 时做的 Online 课程中对 GMM 的介绍。Cochrane 教授讲的实在是太清楚、到位了，本文是我做对他所讲的内容的消化、梳理和再串联。&lt;/p&gt;&lt;p&gt;&lt;b&gt;本文的目标是试图从 intuition 出发揭示 GMM 蕴含数学之美；试图把公式掰开揉碎讲清楚从而帮助感兴趣的朋友理解大公式背后的本质。&lt;/b&gt;我会力争在行文中做到非常准确，在 population 和 sample 之间腾挪、把 variance 和 test statistic 都说清楚。Cochrane 教授说，学习 GMM 时最大的障碍就是它的 notation（数学符号）繁多；只要搞清楚 notation，其实 GMM 背后的数学精髓是非常简单的，因为 GMM 的核心最终能够归结为计算 the variance of the sample mean。希望本文能够带给你这种恍然大悟之感。&lt;/p&gt;&lt;p&gt;先来剧透一下，本文希望传达以下三方面内容：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;GMM 的框架包括 model、estimate 以及 test 三部分；&lt;/li&gt;&lt;li&gt;学习 GMM 时，最大的障碍往往来自 notation；搞清楚 notation 后，GMM 背后的数学非常容易理解；&lt;/li&gt;&lt;li&gt;GMM 不应被当作计量学的黑箱。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;b&gt;以我一贯的风格，行文中会“死磕”数学公式，因此这注定是一篇十分 technical 的文章。&lt;/b&gt;本文的技术性远超&lt;a href=&quot;https://zhuanlan.zhihu.com/p/40984029&quot; class=&quot;internal&quot;&gt;《股票多因子模型的回归检验》&lt;/a&gt;，因此同样建议在一个能静下心来思考的心境下和环境中阅读。对于不关心数学、仅想快速了解 GMM 是什么的读者来说，我强烈推荐&lt;a href=&quot;https://www.zhihu.com/question/41312883/answer/91484566?utm_source=wechat_session&amp;amp;utm_medium=social&amp;amp;utm_oi=728969207022125056&amp;amp;from=singlemessage&amp;amp;isappinstalled=0&quot; class=&quot;internal&quot;&gt;慧航大神关于 GMM 的回答&lt;/a&gt;。那篇回答对读者非常友好，涉及到的数学恰到好处，深入浅出的介绍了 GMM 的原理。&lt;/p&gt;&lt;p&gt;如果本文能对你理解 GMM 起到一点帮助，那完全是 Cochrane 教授的功劳；如果你看完后依然困惑，那一定也必须是怪我没写好……&lt;/p&gt;&lt;p&gt;Cochrane 教授说 GMM 的核心最终能够归结为计算 the variance of the sample mean；让我们就从 the variance of the sample mean 说起。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;02 Variance of the Sample Mean&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;考虑某随机变量  &lt;img src=&quot;https://www.zhihu.com/equation?tex=u_t&quot; alt=&quot;u_t&quot; eeimg=&quot;1&quot;/&gt; 。假设它在某个样本内的取值为 0，-1，3，3，-3。我们可以很容易的算出样本均值：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Cbar+u+%3D+%5Cmbox%7BE%7D_T%5Bu_t%5D%3D0.4&quot; alt=&quot;\displaystyle\bar u = \mbox{E}_T[u_t]=0.4&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;上式中， &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D_T+%3D+%281%2FT%29%5Csum%28.%29&quot; alt=&quot;\mbox{E}_T = (1/T)\sum(.)&quot; eeimg=&quot;1&quot;/&gt; 表示对样本数据求平均， &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbar+u&quot; alt=&quot;\bar u&quot; eeimg=&quot;1&quot;/&gt; 表示 &lt;img src=&quot;https://www.zhihu.com/equation?tex=u_t&quot; alt=&quot;u_t&quot; eeimg=&quot;1&quot;/&gt; 的样本均值。由于 &lt;img src=&quot;https://www.zhihu.com/equation?tex=u_t&quot; alt=&quot;u_t&quot; eeimg=&quot;1&quot;/&gt; 是一个随机变量，因此其&lt;b&gt;样本均值  &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbar+u_t&quot; alt=&quot;\bar u_t&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;本身也是一个随机变量&lt;/b&gt;。虽然它在我们这个样本中的取值为 0.4，但如果我们能够乘坐时光机回到过去“重写历史”，得到不同的样本，那么在不同样本中，样本均值的取值也会有所变化。比如在下面这个表中，假设除样本一（就是上面这个样本）之外，还有三个样本，而它们的样本均值 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbar+u&quot; alt=&quot;\bar u&quot; eeimg=&quot;1&quot;/&gt; 的取值分别为 -0.8，0.6 和 1.6。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-2d988b6aebb6c5ba1c5a23ccb4d1ad54_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;713&quot; data-rawheight=&quot;317&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;713&quot; data-original=&quot;https://pic1.zhimg.com/v2-2d988b6aebb6c5ba1c5a23ccb4d1ad54_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-2d988b6aebb6c5ba1c5a23ccb4d1ad54_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;713&quot; data-rawheight=&quot;317&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;713&quot; data-original=&quot;https://pic1.zhimg.com/v2-2d988b6aebb6c5ba1c5a23ccb4d1ad54_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-2d988b6aebb6c5ba1c5a23ccb4d1ad54_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;既然样本均值本身也是一个随机变量，那么一个很自然的问题就是样本均值在不同的样本中是如何变化的，即 variance of the sample mean。从 variance 的定义出发可得：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Cmbox%7Bvar%7D%28%5Cbar+u%29%3D%5Cmbox%7Bvar%7D%5Cleft%28%5Cfrac%7B1%7D%7BT%7D%5Csum_%7Bt%3D1%7D%5ET+u_t%5Cright%29%3D%5Cfrac%7B1%7D%7BT%5E2%7D%5Cmbox%7Bvar%7D%5Cleft%28%5Csum_%7Bt%3D1%7D%5ET+u_t%5Cright%29&quot; alt=&quot;\displaystyle\mbox{var}(\bar u)=\mbox{var}\left(\frac{1}{T}\sum_{t=1}^T u_t\right)=\frac{1}{T^2}\mbox{var}\left(\sum_{t=1}^T u_t\right)&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;在最简单的情况中，假设 &lt;img src=&quot;https://www.zhihu.com/equation?tex=u_t&quot; alt=&quot;u_t&quot; eeimg=&quot;1&quot;/&gt; 序列满足 i.i.d.，则上式可以简化成：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Cmbox%7Bvar%7D%28%5Cbar+u%29%3D%5Cfrac%7B1%7D%7BT%5E2%7D%5Cmbox%7Bvar%7D%5Cleft%28%5Csum_%7Bt%3D1%7D%5ET+u_t%5Cright%29%3D%5Cfrac%7B%5Csigma%5E2%28u_t%29%7D%7BT%7D&quot; alt=&quot;\displaystyle\mbox{var}(\bar u)=\frac{1}{T^2}\mbox{var}\left(\sum_{t=1}^T u_t\right)=\frac{\sigma^2(u_t)}{T}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;把两边开方就得到样本均值的 standard error：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Cmbox%7Bs.e.%7D%28%5Cbar+u%29%3D%5Cfrac%7B%5Csigma%28u_t%29%7D%7B%5Csqrt%7BT%7D%7D&quot; alt=&quot;\displaystyle\mbox{s.e.}(\bar u)=\frac{\sigma(u_t)}{\sqrt{T}}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;这大概是我们在统计课中学到的印象最深的一个式子（假设 &lt;img src=&quot;https://www.zhihu.com/equation?tex=u_t&quot; alt=&quot;u_t&quot; eeimg=&quot;1&quot;/&gt; 满足 i.i.d. 条件下样本均值的 standard error）。在更一般的情况中 —— 尤其是在金融数据（比如收益率）数据中 ——  &lt;img src=&quot;https://www.zhihu.com/equation?tex=u_t&quot; alt=&quot;u_t&quot; eeimg=&quot;1&quot;/&gt;  序列是前后是有非零的自相关的，即 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bcov%7D%28u_t%2C+u_%7Bt-j%7D%29+%E2%89%A0+0&quot; alt=&quot;\mbox{cov}(u_t, u_{t-j}) ≠ 0&quot; eeimg=&quot;1&quot;/&gt; ，因此需要得到更一般下样本均值  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbar+u&quot; alt=&quot;\bar u&quot; eeimg=&quot;1&quot;/&gt;  的 variance：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Cmbox%7Bvar%7D%28%5Cbar+u%29%3D%5Cfrac%7B1%7D%7BT%7D%5Cleft%5B%5Cmbox%7Bvar%7D%28u_t%29%2B%5Csum_%7Bj%3D1%7D%5ET%5Cfrac%7BT-j%7D%7BT%7D%5Cleft%28%5Cmbox%7Bcov%7D%28u_t%2C+u_%7Bt-j%7D%29%2B%5Cmbox%7Bcov%7D%28u_t%2C+u_%7Bt%2Bj%7D%29%5Cright%29%5Cright%5D&quot; alt=&quot;\displaystyle\mbox{var}(\bar u)=\frac{1}{T}\left[\mbox{var}(u_t)+\sum_{j=1}^T\frac{T-j}{T}\left(\mbox{cov}(u_t, u_{t-j})+\mbox{cov}(u_t, u_{t+j})\right)\right]&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;当  &lt;img src=&quot;https://www.zhihu.com/equation?tex=T&quot; alt=&quot;T&quot; eeimg=&quot;1&quot;/&gt;  趋于无穷大时（即 sample size 越来越大）， &lt;img src=&quot;https://www.zhihu.com/equation?tex=%28T+%E2%80%93+j%29%2FT&quot; alt=&quot;(T – j)/T&quot; eeimg=&quot;1&quot;/&gt; 趋于 1，就可以求出 &lt;img src=&quot;https://www.zhihu.com/equation?tex=var%28%5Cbar+u%29&quot; alt=&quot;var(\bar u)&quot; eeimg=&quot;1&quot;/&gt; 的渐进（asymptotic）形式：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Cmbox%7Bvar%7D%28%5Cbar+u%29%5Crightarrow%5Cfrac%7B1%7D%7BT%7D%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D%5Cmbox%7Bvar%7D%28u_t%2C+u_%7Bt-j%7D%29&quot; alt=&quot;\displaystyle\mbox{var}(\bar u)\rightarrow\frac{1}{T}\sum_{j=-\infty}^{\infty}\mbox{var}(u_t, u_{t-j})&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;下面再假设一个特殊的情况，即随机变量 &lt;img src=&quot;https://www.zhihu.com/equation?tex=u_t&quot; alt=&quot;u_t&quot; eeimg=&quot;1&quot;/&gt; 的&lt;b&gt;总体均值&lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D%5Bu_t%5D+%3D+0&quot; alt=&quot;\mbox{E}[u_t] = 0&quot; eeimg=&quot;1&quot;/&gt; ，并利用方差的定义  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28X%2C+Y%29+%3D+%5Cmbox%7BE%7D%5BXY%5D+%E2%80%93+%5Cmbox%7BE%7D%5BX%5D%5Cmbox%7BE%7D%5BY%5D&quot; alt=&quot;\mbox{var}(X, Y) = \mbox{E}[XY] – \mbox{E}[X]\mbox{E}[Y]&quot; eeimg=&quot;1&quot;/&gt;  可得：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Cmbox%7Bvar%7D%28%5Cbar+u%29%5Crightarrow%5Cfrac%7B1%7D%7BT%7D%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D%5Cmbox%7BE%7D%5Bu_tu_%7Bt-j%7D%5D%3D%5Cfrac%7B1%7D%7BT%7DS&quot; alt=&quot;\displaystyle\mbox{var}(\bar u)\rightarrow\frac{1}{T}\sum_{j=-\infty}^{\infty}\mbox{E}[u_tu_{t-j}]=\frac{1}{T}S&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;上式最后一项中的  &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt;  代表了中间项中那一大坨求和项。在 GMM 的术语中， &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt;  被称作 spectral density matrix at frequency zero of &lt;img src=&quot;https://www.zhihu.com/equation?tex=u_t&quot; alt=&quot;u_t&quot; eeimg=&quot;1&quot;/&gt; 。&lt;/p&gt;&lt;p&gt;OK！整理一下。本小节从我们熟悉的样本均值出发指出样本均值本身也是一个随机变量，并推导出当 sample size &lt;img src=&quot;https://www.zhihu.com/equation?tex=T&quot; alt=&quot;T&quot; eeimg=&quot;1&quot;/&gt;  趋于无穷且假设 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D%5Bu_t%5D+%3D+0&quot; alt=&quot;\mbox{E}[u_t] = 0&quot; eeimg=&quot;1&quot;/&gt; 时，variance of the sample mean 渐进趋于 &lt;img src=&quot;https://www.zhihu.com/equation?tex=S%2FT&quot; alt=&quot;S/T&quot; eeimg=&quot;1&quot;/&gt; ，其中  &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt;  是无穷级数求和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Csum%5Cmbox%7BE%7D%5Bu_tu_%7Bt-j%7D%5D&quot; alt=&quot;\sum\mbox{E}[u_tu_{t-j}]&quot; eeimg=&quot;1&quot;/&gt; 。&lt;/p&gt;&lt;p&gt;千万不要小看这个 &lt;img src=&quot;https://www.zhihu.com/equation?tex=var%28%5Cbar+u%29+%5Crightarrow+S%2FT&quot; alt=&quot;var(\bar u) \rightarrow S/T&quot; eeimg=&quot;1&quot;/&gt; 这个式子，它在下文 GMM 的数学推导中起着至关重要的作用。用 Cochrane 的话说，&lt;b&gt;GMM 中大绝大部分计量学均可归结到这个式子（most econometrics boils down to this）！&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;03 GMM 框架&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;回顾了 variance of the sample mean 之后，本小节就来直观的看看 GMM 到底是怎么回事儿。&lt;/p&gt;&lt;p&gt;&lt;b&gt;GMM 的作用是为了检验模型。&lt;/b&gt;模型到底对不对？模型的参数如何估计？误差是来自运气还是因为模型有误？GMM 提供了一个优雅而强大的计量学框架来回答这些问题。一般来说，GMM 框架分为以下三个部分：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;b&gt;第一部分：把待研究的问题表达成一系列总体矩条件（population moment conditions） ——&lt;/b&gt; &lt;b&gt;这是提出 model；&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;第二部分：使用样本数据得到对应的样本矩（sample moments），从而对参数进行估计 ——&lt;/b&gt; &lt;b&gt;这是把 model 和 data 联系起来；&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;第三部分：计算 sample moments 的 variance，从而对 population moments 进行 statistical test ——&lt;/b&gt; &lt;b&gt;这是检验 model。&lt;/b&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;b&gt;所以概括来说就是 GMM 就是用 sample moments 代替 population moments 然后对 population moments 进行统计检验。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;3.1 GMM 第一部分&lt;/b&gt;&lt;/p&gt;&lt;p&gt;我们用  &lt;img src=&quot;https://www.zhihu.com/equation?tex=x_t&quot; alt=&quot;x_t&quot; eeimg=&quot;1&quot;/&gt;  代表 data， &lt;img src=&quot;https://www.zhihu.com/equation?tex=b&quot; alt=&quot;b&quot; eeimg=&quot;1&quot;/&gt;  代表参数（这些都是 vectors），且存在一系列关于 &lt;img src=&quot;https://www.zhihu.com/equation?tex=x_t&quot; alt=&quot;x_t&quot; eeimg=&quot;1&quot;/&gt; 和 b 的函数 &lt;img src=&quot;https://www.zhihu.com/equation?tex=f%28x_t%2C+b%29&quot; alt=&quot;f(x_t, b)&quot; eeimg=&quot;1&quot;/&gt; 。 &lt;img src=&quot;https://www.zhihu.com/equation?tex=f%28x_t%2C+b%29&quot; alt=&quot;f(x_t, b)&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;的 expected value 即 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D%5Bf%28x_t%2C+b%29%5D&quot; alt=&quot;\mbox{E}[f(x_t, b)]&quot; eeimg=&quot;1&quot;/&gt; 就是 population moments。&lt;/b&gt;在 GMM 中，我们要求 population moments 满足 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D%5Bf%28x_t%2C+b%29%5D+%3D+0&quot; alt=&quot;\mbox{E}[f(x_t, b)] = 0&quot; eeimg=&quot;1&quot;/&gt; 的约束，&lt;b&gt;这一系列 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D%5Bf%28x_t%2C+b%29%5D+%3D+0&quot; alt=&quot;\mbox{E}[f(x_t, b)] = 0&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 约束就是 GMM 中的 population moment conditions（矩条件）。这些 moment conditions 是我们关于真实模型（true model）的猜测。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;需要说明的是，期望符号 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D&quot; alt=&quot;\mbox{E}&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt; 表示对总体求均值；而前面使用的（接下来也将会继续使用的）期望符号 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D_T&quot; alt=&quot;\mbox{E}_T&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;（有个下标 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=T&quot; alt=&quot;T&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;）表示对样本求均值。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;GMM 的第一部分是把待研究的问题转化成数据 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=x_t&quot; alt=&quot;x_t&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt; 和参数 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=b&quot; alt=&quot;b&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 的一系列方程 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=f&quot; alt=&quot;f&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;、且假设在 true model 下这些方程的 moments 满足 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D%5Bf%28x_t%2C+b%29%5D+%3D+0&quot; alt=&quot;\mbox{E}[f(x_t, b)] = 0&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+%5Cmbox%7BExpress+Model%7D%26%5Crightarrow%26%5Cdisplaystyle%5Cmbox%7BMean+of+%7Df%28%5Cmbox%7BData%2C+Parameter%7D%29%3D0%5C%5C+%26%5Crightarrow%26%5Cdisplaystyle%5Cmbox%7BE%7D%5Bf%28x_t%2C+b%29%5D%3D0+%5Cend%7Barray%7D+&quot; alt=&quot;\begin{array}{rll} \mbox{Express Model}&amp;amp;\rightarrow&amp;amp;\displaystyle\mbox{Mean of }f(\mbox{Data, Parameter})=0\\ &amp;amp;\rightarrow&amp;amp;\displaystyle\mbox{E}[f(x_t, b)]=0 \end{array} &quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;仍然晦涩？马上来看一些 asset pricing 中的例子。&lt;/p&gt;&lt;p&gt;从最基础的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=p+%3D+%5Cmbox%7BE%7D%5Bmx%5D&quot; alt=&quot;p = \mbox{E}[mx]&quot; eeimg=&quot;1&quot;/&gt; 出发（详见&lt;a href=&quot;https://zhuanlan.zhihu.com/p/88458489&quot; class=&quot;internal&quot;&gt;《理解资产价格》&lt;/a&gt;），其中 m 是 stochastic discount factor（由某些未知参数 &lt;img src=&quot;https://www.zhihu.com/equation?tex=b&quot; alt=&quot;b&quot; eeimg=&quot;1&quot;/&gt; 决定）、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=x&quot; alt=&quot;x&quot; eeimg=&quot;1&quot;/&gt;  是回报、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=p&quot; alt=&quot;p&quot; eeimg=&quot;1&quot;/&gt;  是价格。如果把 &lt;img src=&quot;https://www.zhihu.com/equation?tex=x&quot; alt=&quot;x&quot; eeimg=&quot;1&quot;/&gt; 换成超额收益（用 &lt;img src=&quot;https://www.zhihu.com/equation?tex=R%5Ee&quot; alt=&quot;R^e&quot; eeimg=&quot;1&quot;/&gt; 表示）则有：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Cmbox%7BE%7D%5Bm%28b%29R%5Ee%5D%3D0&quot; alt=&quot;\displaystyle\mbox{E}[m(b)R^e]=0&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;如果把  &lt;img src=&quot;https://www.zhihu.com/equation?tex=x&quot; alt=&quot;x&quot; eeimg=&quot;1&quot;/&gt;  换成 gross risk-free rate  &lt;img src=&quot;https://www.zhihu.com/equation?tex=R_f&quot; alt=&quot;R_f&quot; eeimg=&quot;1&quot;/&gt; （即 &lt;img src=&quot;https://www.zhihu.com/equation?tex=t&quot; alt=&quot;t&quot; eeimg=&quot;1&quot;/&gt; 时刻投入 1， &lt;img src=&quot;https://www.zhihu.com/equation?tex=t+%2B+1&quot; alt=&quot;t + 1&quot; eeimg=&quot;1&quot;/&gt; 时刻得到  &lt;img src=&quot;https://www.zhihu.com/equation?tex=R_f&quot; alt=&quot;R_f&quot; eeimg=&quot;1&quot;/&gt; ）则有：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Cmbox%7BE%7D%5Bm%28b%29R_f-1%5D%3D0&quot; alt=&quot;\displaystyle\mbox{E}[m(b)R_f-1]=0&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;这些都是 asset pricing 中常见的 moment conditions。&lt;/p&gt;&lt;p&gt;&lt;b&gt;3.2 GMM 第二部分&lt;/b&gt;&lt;/p&gt;&lt;p&gt;第一部分虽然把问题描述清楚了，但它们都是 population moment conditions，只是我们对于真实模型的猜想，我们有的只是样本数据。&lt;b&gt;GMM 的第二部分就是用 sample moments 来代替 population moments，从而建立起模型和数据之间的联系，以进行参数估计。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;和本文第二节一样，用  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D_T&quot; alt=&quot;\mbox{E}_T&quot; eeimg=&quot;1&quot;/&gt;  代表对样本数据求平均，则 sample moments 可以写成：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Cmbox%7BE%7D_T%5Bf%28x_t%2C+b%29%5D%3D%5Cfrac%7B1%7D%7BT%7D%5Csum_%7Bt%3D1%7D%5ET+f%28x_t%2C+b%29%5Cequiv+g_T%28b%29&quot; alt=&quot;\displaystyle\mbox{E}_T[f(x_t, b)]=\frac{1}{T}\sum_{t=1}^T f(x_t, b)\equiv g_T(b)&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;上式中最后引入符号 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; 仅仅是为了下文中简化公式。怎么样？看着这个式子有没有什么感想？无论研究的具体问题是什么（我们研究的是 asset pricing，而别人也可以研究经济学或金融学中其他的问题），不管 &lt;img src=&quot;https://www.zhihu.com/equation?tex=f&quot; alt=&quot;f&quot; eeimg=&quot;1&quot;/&gt; 到底长什么样子或数据 &lt;img src=&quot;https://www.zhihu.com/equation?tex=x_t&quot; alt=&quot;x_t&quot; eeimg=&quot;1&quot;/&gt; 和参数 &lt;img src=&quot;https://www.zhihu.com/equation?tex=b&quot; alt=&quot;b&quot; eeimg=&quot;1&quot;/&gt; 向量都是什么，&lt;b&gt;上面的 sample moments 也仅仅是 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=f%28x_t%2C+b%29&quot; alt=&quot;f(x_t, b)&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt; 在样本内取平均，因此也只是一种 sample mean！&lt;/b&gt;&lt;/p&gt;&lt;p&gt;从 sample moments 出发就可以进行参数估计。来自总体的 moment conditions 要求  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D%5Bf%28x_t%2C+b%29%5D+%3D+0&quot; alt=&quot;\mbox{E}[f(x_t, b)] = 0&quot; eeimg=&quot;1&quot;/&gt; ；使用样本数据，GMM estimator 的核心是找到  &lt;img src=&quot;https://www.zhihu.com/equation?tex=b&quot; alt=&quot;b&quot; eeimg=&quot;1&quot;/&gt;  的估计 —— 记为 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; —— 使得所有 sample moments 都尽可能的等于零：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Cmbox%7BE%7D_T%5Bf%28x_t%2C+%5Chat+b%29%5D%5Csimeq+0&quot; alt=&quot;\displaystyle\mbox{E}_T[f(x_t, \hat b)]\simeq 0&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;上式中之所以用了约等于而非等于，是因为&lt;b&gt;在实际问题中，sample moments 的个数往往超过参数的个数（这也被称为 overidentification）。&lt;/b&gt;假设一共有 n 个 moments（即 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; 是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=n+%C3%97+1&quot; alt=&quot;n × 1&quot; eeimg=&quot;1&quot;/&gt; 阶 vector）， &lt;img src=&quot;https://www.zhihu.com/equation?tex=p&quot; alt=&quot;p&quot; eeimg=&quot;1&quot;/&gt;  个参数（即  &lt;img src=&quot;https://www.zhihu.com/equation?tex=b&quot; alt=&quot;b&quot; eeimg=&quot;1&quot;/&gt;  是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=p+%C3%97+1&quot; alt=&quot;p × 1&quot; eeimg=&quot;1&quot;/&gt; 阶 vector）。当 &lt;img src=&quot;https://www.zhihu.com/equation?tex=n+%3E+p&quot; alt=&quot;n &amp;gt; p&quot; eeimg=&quot;1&quot;/&gt; 时，我们无法让所有的 sample moments 都等于零，而是选择让这其中的  &lt;img src=&quot;https://www.zhihu.com/equation?tex=p&quot; alt=&quot;p&quot; eeimg=&quot;1&quot;/&gt;  个 sample moments 或者这些 sample moments 的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=p&quot; alt=&quot;p&quot; eeimg=&quot;1&quot;/&gt; 个线性组合等于 0。这就是 GMM estimator：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Chat+b%3A+%5Cmbox%7Bset+%7D+ag_T%28%5Chat+b%29%3D0&quot; alt=&quot;\displaystyle\hat b: \mbox{set } ag_T(\hat b)=0&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;上式中， &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt;  是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=p+%C3%97+n&quot; alt=&quot;p × n&quot; eeimg=&quot;1&quot;/&gt; 阶矩阵，每一行都代表一个 sample moments 的线性组合。在具体问题中，根据 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; 的具体形式，上式可能有解析解或数值解。求解上式就可以获得 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; 。不过有的小伙伴可能会说：&lt;b&gt;等一下，你还没说矩条件的线性组合矩阵 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 是什么！不同的 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 显然会得到不同的参数估计。&lt;/b&gt;没错，在 GMM 的框架下，我们可以自由选择  &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; 。然而，纯从计量学的角度，有一个特殊的矩阵  &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt;  会让 GMM estimator 成为 efficient estimator。下文第 3.3 节和第 5 节将会就 efficiency 进行说明。&lt;/p&gt;&lt;p&gt;为了加深理解，仍然用 asset pricing 来举例子。假设 consumption-based CAPM（CCAPM）是真正的模型，因此随机折现因子 &lt;img src=&quot;https://www.zhihu.com/equation?tex=m&quot; alt=&quot;m&quot; eeimg=&quot;1&quot;/&gt; 由两个参数 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B2&quot; alt=&quot;β&quot; eeimg=&quot;1&quot;/&gt; 和  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B3&quot; alt=&quot;γ&quot; eeimg=&quot;1&quot;/&gt;  决定（CCAPM 的介绍请见&lt;a href=&quot;https://zhuanlan.zhihu.com/p/88458489&quot; class=&quot;internal&quot;&gt;《理解资产价格》&lt;/a&gt;），即 &lt;img src=&quot;https://www.zhihu.com/equation?tex=b%3D%5B%5Cbeta%2C%5Cgamma%5D%5E%5Cprime&quot; alt=&quot;b=[\beta,\gamma]^\prime&quot; eeimg=&quot;1&quot;/&gt; ；进一步假设我们有四个资产来检验 CCAPM，它们是 risk-free、市场组合以及 Fama and French (1993) 中的 HML 和 SMB。在这个例子中， &lt;img src=&quot;https://www.zhihu.com/equation?tex=n+%3D+4&quot; alt=&quot;n = 4&quot; eeimg=&quot;1&quot;/&gt; 而 &lt;img src=&quot;https://www.zhihu.com/equation?tex=p+%3D+2&quot; alt=&quot;p = 2&quot; eeimg=&quot;1&quot;/&gt; ，因此 &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; 是一个 &lt;img src=&quot;https://www.zhihu.com/equation?tex=2+%C3%97+4&quot; alt=&quot;2 × 4&quot; eeimg=&quot;1&quot;/&gt; 阶矩阵，而 GMM estimator 可以写成：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cleft%5B+%5Cbegin%7Barray%7D%7Bcccc%7D+a_%7B11%7D%26a_%7B12%7D%26a_%7B13%7D%26a_%7B14%7D%5C%5C+a_%7B21%7D%26a_%7B22%7D%26a_%7B23%7D%26a_%7B24%7D+%5Cend%7Barray%7D+%5Cright%5D+%5Cleft%5B+%5Cbegin%7Barray%7D%7Bl%7D+%5Cmbox%7BE%7D_T%5Bm%28%5Chat%5Cbeta%2C%5Chat%5Cgamma%29R%5Ee_m%5D%5C%5C+%5Cmbox%7BE%7D_T%5Bm%28%5Chat%5Cbeta%2C%5Chat%5Cgamma%29R_f-1%5D%5C%5C+%5Cmbox%7BE%7D_T%5Bm%28%5Chat%5Cbeta%2C%5Chat%5Cgamma%29R%5E%7B%5Cmbox%7BHML%7D%7D%5D%5C%5C+%5Cmbox%7BE%7D_T%5Bm%28%5Chat%5Cbeta%2C%5Chat%5Cgamma%29R%5E%7B%5Cmbox%7BSMB%7D%7D%5D+%5Cend%7Barray%7D+%5Cright%5D%3D+%5Cleft%5B+%5Cbegin%7Barray%7D%7Bc%7D+0%5C%5C0+%5Cend%7Barray%7D+%5Cright%5D&quot; alt=&quot;\left[ \begin{array}{cccc} a_{11}&amp;amp;a_{12}&amp;amp;a_{13}&amp;amp;a_{14}\\ a_{21}&amp;amp;a_{22}&amp;amp;a_{23}&amp;amp;a_{24} \end{array} \right] \left[ \begin{array}{l} \mbox{E}_T[m(\hat\beta,\hat\gamma)R^e_m]\\ \mbox{E}_T[m(\hat\beta,\hat\gamma)R_f-1]\\ \mbox{E}_T[m(\hat\beta,\hat\gamma)R^{\mbox{HML}}]\\ \mbox{E}_T[m(\hat\beta,\hat\gamma)R^{\mbox{SMB}}] \end{array} \right]= \left[ \begin{array}{c} 0\\0 \end{array} \right]&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;根据上式就可以使用 sample moments 求出参数估计 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; 。&lt;/p&gt;&lt;p&gt;&lt;b&gt;3.3 GMM 第三部分&lt;/b&gt;&lt;/p&gt;&lt;p&gt;使用 GMM estimator 得到的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; 仅仅是真实但未知参数 &lt;img src=&quot;https://www.zhihu.com/equation?tex=b_0&quot; alt=&quot;b_0&quot; eeimg=&quot;1&quot;/&gt; 的一个估计。从统计学的角度，我们自然关心估计的误差，即 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt; 。马上来回答上面遗留的矩阵 &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; 的选择的问题。&lt;b&gt;对于给定的 moments &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;，从计量学的角度有一个特殊的矩阵 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 使得 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 最小，这就是 efficient 的含义。&lt;/b&gt;Hansen (1982) 给出了这个  &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt;  的形式。关于 &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; 的进一步讨论将放在本文第五节。&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BVar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{Var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt;  的大小仅仅告诉我们参数估计是否准确，而对于研究的问题来说，我们更加关注的是当给定 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; 时，sample moments 的 variance，记为 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; ，的大小。从业务上说，在一般的 overidentification 问题下（moments 个数多于参数个数），sample moments 不可能都是零（如果 moments 个数  &lt;img src=&quot;https://www.zhihu.com/equation?tex=n&quot; alt=&quot;n&quot; eeimg=&quot;1&quot;/&gt;  等于参数个数  &lt;img src=&quot;https://www.zhihu.com/equation?tex=p&quot; alt=&quot;p&quot; eeimg=&quot;1&quot;/&gt; ，我们可以令每个 moment 都等于零从而求出全部  &lt;img src=&quot;https://www.zhihu.com/equation?tex=p&quot; alt=&quot;p&quot; eeimg=&quot;1&quot;/&gt;  个参数），因此我们关心 sample moments 联合起来相对于零的偏离的大小是多少。&lt;/p&gt;&lt;p&gt;&lt;b&gt;我们必须搞清楚 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T%28%5Chat+b%29&quot; alt=&quot;g_T(\hat b)&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 联合起来相对于零的偏离是因为运气成分还是因为选择的 population moment condition 就是错的。&lt;/b&gt;如果仅仅因为运气（即偏离的很小），那可以接受 population moment conditions —— 比如接受一个选择的 asset pricing 模型；如果不是因为运气（即偏离很大），那就只能拒绝 population moment conditions —— 即 reject 一个 asset pricing 模型。这就是 statistical test。唯有有了 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; ，才能够进行 statistical test。&lt;b&gt;计算 variance 并进行 statistical test 就是 GMM 的第三部分。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;值得一提的是，由于 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T%28%5Chat+b%29&quot; alt=&quot;g_T(\hat b)&quot; eeimg=&quot;1&quot;/&gt; 都是向量，因此 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; 事实上都代表了它们各自的 &lt;b&gt;variance-covariance matrix&lt;/b&gt;，其中 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt; 是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=p+%C3%97+p&quot; alt=&quot;p × p&quot; eeimg=&quot;1&quot;/&gt; 阶矩阵（共有 &lt;img src=&quot;https://www.zhihu.com/equation?tex=p&quot; alt=&quot;p&quot; eeimg=&quot;1&quot;/&gt; 个参数），而 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; 是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=n+%C3%97+n&quot; alt=&quot;n × n&quot; eeimg=&quot;1&quot;/&gt; 阶矩阵（共有  &lt;img src=&quot;https://www.zhihu.com/equation?tex=n&quot; alt=&quot;n&quot; eeimg=&quot;1&quot;/&gt;  个 moments）。&lt;/p&gt;&lt;p&gt;有了 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; 就可以写出 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T%28%5Chat+b%29&quot; alt=&quot;g_T(\hat b)&quot; eeimg=&quot;1&quot;/&gt; 的分布。当 sample size  &lt;img src=&quot;https://www.zhihu.com/equation?tex=T&quot; alt=&quot;T&quot; eeimg=&quot;1&quot;/&gt;  趋于无穷时， &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; 的满足以下渐进正态性：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Csqrt%7BT%7D%28%5Chat+b-b_0%29%5Crightarrow%5Cmathcal%7BN%7D%5Cleft%5B0%2C+%28ad%29%5E%7B-1%7DaSa%5E%5Cprime%28ad%29%5E%7B-1%5Cprime%7D%5Cright%5D&quot; alt=&quot;\displaystyle\sqrt{T}(\hat b-b_0)\rightarrow\mathcal{N}\left[0, (ad)^{-1}aSa^\prime(ad)^{-1\prime}\right]&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;上式中， &lt;img src=&quot;https://www.zhihu.com/equation?tex=-1&quot; alt=&quot;-1&quot; eeimg=&quot;1&quot;/&gt; 表示求逆， &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cprime&quot; alt=&quot;\prime&quot; eeimg=&quot;1&quot;/&gt; 表示转置，所以 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%28ad%29%5E%7B-1%5Cprime%7D&quot; alt=&quot;(ad)^{-1\prime}&quot; eeimg=&quot;1&quot;/&gt; 表示先求 &lt;img src=&quot;https://www.zhihu.com/equation?tex=ad&quot; alt=&quot;ad&quot; eeimg=&quot;1&quot;/&gt; 的逆矩阵再转置。这个式子正是 Hansen (1982) 中的 Theorem 3.1。Hansen (1982) 给出了渐进分布成立需要满足的一系列假设。在实际应用中，我们需要记住的是&lt;b&gt;数据 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=x_t&quot; alt=&quot;x_t&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 需要满足弱平稳性，这是因为 GMM 的基础是随着 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=T&quot; alt=&quot;T&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 的增大，sample mean 向 population mean 收敛。&lt;/b&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-45f6d1441ef969c244596d5bd9777482_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;904&quot; data-rawheight=&quot;116&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;904&quot; data-original=&quot;https://pic3.zhimg.com/v2-45f6d1441ef969c244596d5bd9777482_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-45f6d1441ef969c244596d5bd9777482_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;904&quot; data-rawheight=&quot;116&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;904&quot; data-original=&quot;https://pic3.zhimg.com/v2-45f6d1441ef969c244596d5bd9777482_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-45f6d1441ef969c244596d5bd9777482_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;此外， &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T%28%5Chat+b%29&quot; alt=&quot;g_T(\hat b)&quot; eeimg=&quot;1&quot;/&gt; 满足如下渐进正态性：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Csqrt%7BT%7Dg_T%28%5Chat+b%29%5Crightarrow%5Cmathcal%7BN%7D%5Cleft%5B0%2C%28I-d%28ad%29%5E%7B-1%7Da%29S%28I-d%28ad%29%5E%7B-1%7Da%29%5E%5Cprime%5Cright%5D&quot; alt=&quot;\displaystyle\sqrt{T}g_T(\hat b)\rightarrow\mathcal{N}\left[0,(I-d(ad)^{-1}a)S(I-d(ad)^{-1}a)^\prime\right]&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;上式中， &lt;img src=&quot;https://www.zhihu.com/equation?tex=I&quot; alt=&quot;I&quot; eeimg=&quot;1&quot;/&gt;  是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=n+%C3%97+n&quot; alt=&quot;n × n&quot; eeimg=&quot;1&quot;/&gt; 阶单位阵。这个式子正是 Hansen (1982) 中的 Lemma 4.1。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-79d44f2d157583534df26f3fd996edf6_b.png&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;911&quot; data-rawheight=&quot;106&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;911&quot; data-original=&quot;https://pic3.zhimg.com/v2-79d44f2d157583534df26f3fd996edf6_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-79d44f2d157583534df26f3fd996edf6_b.png&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;911&quot; data-rawheight=&quot;106&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;911&quot; data-original=&quot;https://pic3.zhimg.com/v2-79d44f2d157583534df26f3fd996edf6_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-79d44f2d157583534df26f3fd996edf6_b.png&quot;/&gt;&lt;/figure&gt;&lt;p&gt;看到这里，你大概在想：What the hell?! 这又  &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt;  又  &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt;  又  &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt;  又求逆又转置，这都是什么“牛鬼蛇神”？有一种“每个字都认识、但是放在一起就看不懂了”的既视感。这里的 a 就是上面 sample moments 的线性组合矩阵，但是  &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt;  和  &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt;  还没有介绍。别着急，第四节将会把这些式子掰开了、揉碎了说清楚的。&lt;/p&gt;&lt;p&gt;看到  &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt;  你是否想到什么？没错，本文第二节讲 the variance of the sample mean 的时候提到了  &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt; 。而上面 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; 看似无比复杂，但它们的本质也都离不开 the variance of the sample mean！&lt;/p&gt;&lt;p&gt;在有了 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T%28%5Chat+b%29&quot; alt=&quot;g_T(\hat b)&quot; eeimg=&quot;1&quot;/&gt; 的分布后，就可以对 GMM 第一部分中选择的模型进行检验，从而决定是接受还是拒绝它。以 asset pricing 为例，这些 moments 代表了不同资产或投资组合的 pricing errors。我们关心 pricing errors 是否联合起来显著不为零，这时可以用 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T%28%5Chat+b%29&quot; alt=&quot;g_T(\hat b)&quot; eeimg=&quot;1&quot;/&gt; 的分布构建 chi-squared statistic 来检验。如果 test statistic 超过给定显著性水平的阈值，那么我们就可以拒绝该 asset pricing 模型。&lt;/p&gt;&lt;p&gt;总结一下，本小节介绍了 GMM 的三部分：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;b&gt;第一部分是把关心的问题表述成一组 population moment conditions；&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;第二部分是用 sample moments 代替 population moments 从而把样本数据和模型联系起来，并进行参数估计；&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;第三部分是计算 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 和 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;，从而进行 statistical test，决定是否接受第一部分中的模型。&lt;/b&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;下一节就来看看 statistical test 背后的数学基础。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;04 数学基础&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;OK! Let&amp;#39;s do the math!&lt;/p&gt;&lt;p&gt;本节的目标是解释 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; 里面的那些  &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt; 、求逆以及转置。我会力争把所有涉及到的公式都讲清楚。了解本节的内容无疑会更好的理解 GMM 背后的数学之美（汗），但是从阅读的角度，跳过本小节也不影响对后文的理解。&lt;/p&gt;&lt;p&gt;先说  &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt; ，这是一切的核心。从下式出发来解释  &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt; ：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+g_T%28b_0%29%5Cequiv%5Cfrac%7B1%7D%7BT%7D%5Csum_%7Bt%3D1%7D%5ET+f%28x_t%2C+b_0%29%3D%5Cfrac%7B1%7D%7BT%7D%5Csum_%7Bt%3D1%7D%5ET+U_t&quot; alt=&quot;\displaystyle g_T(b_0)\equiv\frac{1}{T}\sum_{t=1}^T f(x_t, b_0)=\frac{1}{T}\sum_{t=1}^T U_t&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;上式中第一个等价符号是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; 的定义（参考 3.2 节），第二个等号是使用 &lt;img src=&quot;https://www.zhihu.com/equation?tex=U_t&quot; alt=&quot;U_t&quot; eeimg=&quot;1&quot;/&gt; 来代表 &lt;img src=&quot;https://www.zhihu.com/equation?tex=f%28x_t%2C+b_0%29&quot; alt=&quot;f(x_t, b_0)&quot; eeimg=&quot;1&quot;/&gt; 。&lt;b&gt;需要强调的是，上式中 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 的参数是真实（但未知）的参数 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=b_0&quot; alt=&quot;b_0&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;。而&lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=+g_T%28b_0%29&quot; alt=&quot; g_T(b_0)&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 的方差 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28b_0%29%29&quot; alt=&quot;\mbox{var}(g_T(b_0))&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 就表示 sample moments &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 在真实参数&lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=b_0&quot; alt=&quot;b_0&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;下的 sampling variance。无论 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=f&quot; alt=&quot;f&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt; 长什么样子，sample moments 的数学形式都仅仅取平均，因此 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28b_0%29%29&quot; alt=&quot;\mbox{var}(g_T(b_0))&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt; 正是 the variance of the sample mean！&lt;/b&gt;（这就是本文第二节的价值所在。）&lt;/p&gt;&lt;p&gt;上面之所以用了 &lt;img src=&quot;https://www.zhihu.com/equation?tex=U_t&quot; alt=&quot;U_t&quot; eeimg=&quot;1&quot;/&gt; ，一是为了简化表达式，二是为了和本文第二节中的小写 &lt;img src=&quot;https://www.zhihu.com/equation?tex=u_t&quot; alt=&quot;u_t&quot; eeimg=&quot;1&quot;/&gt; 呼应起来：这里的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=U_t&quot; alt=&quot;U_t&quot; eeimg=&quot;1&quot;/&gt; 对应第二节的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=u_t&quot; alt=&quot;u_t&quot; eeimg=&quot;1&quot;/&gt; 、这里的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T%28b_0%29&quot; alt=&quot;g_T(b_0)&quot; eeimg=&quot;1&quot;/&gt; 就是第二节的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbar+u&quot; alt=&quot;\bar u&quot; eeimg=&quot;1&quot;/&gt; ，因此马上得到（当  &lt;img src=&quot;https://www.zhihu.com/equation?tex=T&quot; alt=&quot;T&quot; eeimg=&quot;1&quot;/&gt;  趋于无穷）：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+%5Cmbox%7Bvar%7D%28g_T%28b_0%29%29%5Crightarrow%5Cfrac%7B1%7D%7BT%7D%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D%5Cmbox%7BE%7D%5BU_tU_%7Bt-j%7D%5E%5Cprime%5D%3D%5Cfrac%7B1%7D%7BT%7DS&quot; alt=&quot;\displaystyle \mbox{var}(g_T(b_0))\rightarrow\frac{1}{T}\sum_{j=-\infty}^{\infty}\mbox{E}[U_tU_{t-j}^\prime]=\frac{1}{T}S&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;&lt;b&gt;这正是 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt; 的定义&lt;/b&gt;（实际中，它可以用样本数据来估计）。上面的计算中之所以能把方差和协方差写成 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D%5BXY%5D&quot; alt=&quot;\mbox{E}[XY]&quot; eeimg=&quot;1&quot;/&gt; 的形式是因为我们假设真实模型满足 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D%5Bf%28x_t%2C+b_0%29%5D+%3D+%5Cmbox%7BE%7D%5BU_t%5D+%3D+0&quot; alt=&quot;\mbox{E}[f(x_t, b_0)] = \mbox{E}[U_t] = 0&quot; eeimg=&quot;1&quot;/&gt; 。（预期符号 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D&quot; alt=&quot;\mbox{E}&quot; eeimg=&quot;1&quot;/&gt; 没有下标 &lt;img src=&quot;https://www.zhihu.com/equation?tex=T&quot; alt=&quot;T&quot; eeimg=&quot;1&quot;/&gt; ，表示 population expectation。）&lt;/p&gt;&lt;p&gt;重要的事情说三遍：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;上面求的 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28b_0%29%29&quot; alt=&quot;\mbox{var}(g_T(b_0))&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 是 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 在真实参数 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=b_0&quot; alt=&quot;b_0&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt;、而非估计量 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 下的 variance。&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;上面求的&lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28b_0%29%29&quot; alt=&quot;\mbox{var}(g_T(b_0))&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;是 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 在真实参数 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=b_0&quot; alt=&quot;b_0&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt;、而非估计量 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 下的 variance。&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;上面求的&lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28b_0%29%29&quot; alt=&quot;\mbox{var}(g_T(b_0))&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;是 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 在真实参数 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=b_0&quot; alt=&quot;b_0&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt;、而非估计量 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 下的 variance。&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;当然，我们最终关心的是当 &lt;img src=&quot;https://www.zhihu.com/equation?tex=b+%3D+%5Chat+b&quot; alt=&quot;b = \hat b&quot; eeimg=&quot;1&quot;/&gt; 时 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; 的方差，即 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; 。然而，一旦有了 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28b_0%29%29+%3D+S%2FT&quot; alt=&quot;\mbox{var}(g_T(b_0)) = S/T&quot; eeimg=&quot;1&quot;/&gt; ，计算 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt; 以及 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; 就变得迎刃而解。这就是为什么 Cochrane 教授说一切都可以归结为计算 the variance of the sample mean。&lt;/p&gt;&lt;p&gt;接下来就看看 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt; 如何计算。由 GMM estimator 可知， &lt;img src=&quot;https://www.zhihu.com/equation?tex=ag_T%28%5Chat+b%29+%3D+0&quot; alt=&quot;ag_T(\hat b) = 0&quot; eeimg=&quot;1&quot;/&gt; 。将该式在真实参数 &lt;img src=&quot;https://www.zhihu.com/equation?tex=b_0&quot; alt=&quot;b_0&quot; eeimg=&quot;1&quot;/&gt; 进行一阶泰勒展开有：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+ag_T%28b_0%29%2Ba%5Cfrac%7B%5Cpartial+g_T%7D%7B%5Cpartial+b%5E%5Cprime%7D%28%5Chat+b-b_0%29%3D0&quot; alt=&quot;\displaystyle ag_T(b_0)+a\frac{\partial g_T}{\partial b^\prime}(\hat b-b_0)=0&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;细心的小伙伴可能注意到了一阶偏导数  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%E2%88%82g_T%2F%E2%88%82b%5E%5Cprime&quot; alt=&quot;∂g_T/∂b^\prime&quot; eeimg=&quot;1&quot;/&gt;  的分母中 &lt;img src=&quot;https://www.zhihu.com/equation?tex=b&quot; alt=&quot;b&quot; eeimg=&quot;1&quot;/&gt; 右上角有个十分诡异的转置符号。在计算偏导数时， &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; 是一个 &lt;img src=&quot;https://www.zhihu.com/equation?tex=n+%C3%97+1&quot; alt=&quot;n × 1&quot; eeimg=&quot;1&quot;/&gt; 阶向量（ &lt;img src=&quot;https://www.zhihu.com/equation?tex=n&quot; alt=&quot;n&quot; eeimg=&quot;1&quot;/&gt;  个 moments），而  &lt;img src=&quot;https://www.zhihu.com/equation?tex=b&quot; alt=&quot;b&quot; eeimg=&quot;1&quot;/&gt;  是一个 &lt;img src=&quot;https://www.zhihu.com/equation?tex=p+%C3%97+1&quot; alt=&quot;p × 1&quot; eeimg=&quot;1&quot;/&gt; 阶向量（ &lt;img src=&quot;https://www.zhihu.com/equation?tex=p&quot; alt=&quot;p&quot; eeimg=&quot;1&quot;/&gt; 个参数），因此偏导数其实是一个矩阵（要么 &lt;img src=&quot;https://www.zhihu.com/equation?tex=n+%C3%97+p&quot; alt=&quot;n × p&quot; eeimg=&quot;1&quot;/&gt; 阶、要么 &lt;img src=&quot;https://www.zhihu.com/equation?tex=p+%C3%97+n&quot; alt=&quot;p × n&quot; eeimg=&quot;1&quot;/&gt; 阶），而这类运算属于 matrix calculus。当转置符号出现在分母时，得到的矩阵是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=n+%C3%97+p&quot; alt=&quot;n × p&quot; eeimg=&quot;1&quot;/&gt; 阶，即每一行代表一个 moment，这种排列方式称作 numerator layout，也称作 Jacobian formulation。而这个一阶偏导数矩阵也正是我们的  &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt; ：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+d%5Cequiv%5Cmbox%7BE%7D%5Cleft%5B%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+b%5E%5Cprime%7D%28x_t%2C+b%29%5Cright%5D%3D%5Cfrac%7B%5Cpartial+g_T%28b%29%7D%7B%5Cpartial+b%5E%5Cprime%7D&quot; alt=&quot;\displaystyle d\equiv\mbox{E}\left[\frac{\partial f}{\partial b^\prime}(x_t, b)\right]=\frac{\partial g_T(b)}{\partial b^\prime}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;严格来说， &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt; 应该由 population moments 的一阶导数计算（上面的第一个等价条件）；但在应用中， &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt; 的取值用 sample moments 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=b+%3D+%5Chat+b&quot; alt=&quot;b = \hat b&quot; eeimg=&quot;1&quot;/&gt; 来估计（上面的第二的等式）。用  &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt;  替换  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%E2%88%82g_T%2F%E2%88%82b%5E%5Cprime&quot; alt=&quot;∂g_T/∂b^\prime&quot; eeimg=&quot;1&quot;/&gt;  并代入上面的泰勒展开，进行简单的代数运算可得：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+%26ag_T%28b_0%29%2Bad%28%5Chat+b-b_0%29%3D0%5C%5C+%5CRightarrow%26%5Chat+b-b_0%3D-%28ad%29%5E%7B-1%7Dag_T%28b_0%29+%5Cend%7Barray%7D&quot; alt=&quot;\begin{array}{rll} &amp;amp;ag_T(b_0)+ad(\hat b-b_0)=0\\ \Rightarrow&amp;amp;\hat b-b_0=-(ad)^{-1}ag_T(b_0) \end{array}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;上式两边直接求 variance 就得到 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt; 。值得一提的是，上式右侧的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%28ad%29%5E%7B-1%7Da&quot; alt=&quot;(ad)^{-1}a&quot; eeimg=&quot;1&quot;/&gt; 是系数矩阵而 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T%28b_0%29&quot; alt=&quot;g_T(b_0)&quot; eeimg=&quot;1&quot;/&gt; 的 variance 我们之前已经求出来了 —— 没错正是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=S%2FT&quot; alt=&quot;S/T&quot; eeimg=&quot;1&quot;/&gt; 。因此有：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Cmbox%7Bvar%7D%28%5Chat+b%29%3D%5Cfrac%7B1%7D%7BT%7D%28ad%29%5E%7B-1%7DaSa%5E%5Cprime%28ad%29%5E%7B-1%5Cprime%7D&quot; alt=&quot;\displaystyle\mbox{var}(\hat b)=\frac{1}{T}(ad)^{-1}aSa^\prime(ad)^{-1\prime}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;数学上虽然通过泰勒展开顺理成章的从 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28b_0%29%29&quot; alt=&quot;\mbox{var}(g_T(b_0))&quot; eeimg=&quot;1&quot;/&gt; 得到了 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt; ，但我们仍然希望从直觉上了解上面一顿操作猛如虎到底干了什么。考虑最简单的情况，即一个 moment 和一个参数（因此 &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; 是一个标量，令 &lt;img src=&quot;https://www.zhihu.com/equation?tex=a+%3D+1&quot; alt=&quot;a = 1&quot; eeimg=&quot;1&quot;/&gt; ），我们可以画出 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28b_0%29%29&quot; alt=&quot;\mbox{var}(g_T(b_0))&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt; 的关系。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-86baaf4c057fa96625436eafa0bd77c7_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;853&quot; data-rawheight=&quot;387&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;853&quot; data-original=&quot;https://pic4.zhimg.com/v2-86baaf4c057fa96625436eafa0bd77c7_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-86baaf4c057fa96625436eafa0bd77c7_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;853&quot; data-rawheight=&quot;387&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;853&quot; data-original=&quot;https://pic4.zhimg.com/v2-86baaf4c057fa96625436eafa0bd77c7_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-86baaf4c057fa96625436eafa0bd77c7_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;图中，灰色曲线表示不同参数  &lt;img src=&quot;https://www.zhihu.com/equation?tex=b&quot; alt=&quot;b&quot; eeimg=&quot;1&quot;/&gt;  时的 population moment，用 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g%28b%29&quot; alt=&quot;g(b)&quot; eeimg=&quot;1&quot;/&gt; 表示。对于真实参数 &lt;img src=&quot;https://www.zhihu.com/equation?tex=b_0&quot; alt=&quot;b_0&quot; eeimg=&quot;1&quot;/&gt; ，由假设有 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g%28b_0%29+%3D+%5Cmbox%7BE%7D%5Bf%28x_t%2C+b_0%29%5D+%3D+0&quot; alt=&quot;g(b_0) = \mbox{E}[f(x_t, b_0)] = 0&quot; eeimg=&quot;1&quot;/&gt; ，因此在图上，灰色曲线经过 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%28b_0%2C+0%29&quot; alt=&quot;(b_0, 0)&quot; eeimg=&quot;1&quot;/&gt; 这个点；蓝色曲线表示不同参数  &lt;img src=&quot;https://www.zhihu.com/equation?tex=b&quot; alt=&quot;b&quot; eeimg=&quot;1&quot;/&gt;  时的 sample moment，用 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T%28b%29&quot; alt=&quot;g_T(b)&quot; eeimg=&quot;1&quot;/&gt; 表示。图中 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T%28b_0%29&quot; alt=&quot;g_T(b_0)&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g%28b_0%29+%3D+0&quot; alt=&quot;g(b_0) = 0&quot; eeimg=&quot;1&quot;/&gt; 之间的距离就是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T%28b_0%29&quot; alt=&quot;g_T(b_0)&quot; eeimg=&quot;1&quot;/&gt; 的 sampling variation，即我们的样本可能由于 luck 或者 unluck，以至于 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T%28b_0%29+%E2%89%A0+0&quot; alt=&quot;g_T(b_0) ≠ 0&quot; eeimg=&quot;1&quot;/&gt; 而是较  &lt;img src=&quot;https://www.zhihu.com/equation?tex=0&quot; alt=&quot;0&quot; eeimg=&quot;1&quot;/&gt;  有一定的偏离，在统计上它就是  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28b_0%29%29&quot; alt=&quot;\mbox{var}(g_T(b_0))&quot; eeimg=&quot;1&quot;/&gt; 。&lt;/p&gt;&lt;p&gt;接下来，对于 sample moment &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; ，我们令其等于 0 求出的参数估计为 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; ，因此蓝色曲线  &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt;  经过 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%28%5Chat+b%2C+0%29&quot; alt=&quot;(\hat b, 0)&quot; eeimg=&quot;1&quot;/&gt; 这个点。下面在蓝线上的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; 点计算其切线（红色）并计算切线的斜率 &lt;img src=&quot;https://www.zhihu.com/equation?tex=d+%3D+%5Cmbox%7Bd%7Dg%2F%5Cmbox%7Bd%7Db&quot; alt=&quot;d = \mbox{d}g/\mbox{d}b&quot; eeimg=&quot;1&quot;/&gt; 。通过 &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt; 我们就可以把 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T%28b_0%29&quot; alt=&quot;g_T(b_0)&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g%28b_0%29+%3D+0&quot; alt=&quot;g(b_0) = 0&quot; eeimg=&quot;1&quot;/&gt; 之间的 sampling variation 转换成 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=b_0&quot; alt=&quot;b_0&quot; eeimg=&quot;1&quot;/&gt; 之间的 sampling variation，即 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt; 。这正是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28b_0%29%29&quot; alt=&quot;\mbox{var}(g_T(b_0))&quot; eeimg=&quot;1&quot;/&gt; 和  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt;  关系的几何含义。&lt;/p&gt;&lt;p&gt;下面我们如法炮制，利用一阶泰勒展开从 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28b_0%29%29&quot; alt=&quot;\mbox{var}(g_T(b_0))&quot; eeimg=&quot;1&quot;/&gt; 求解 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; ：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+g_T%28%5Chat+b%29%3Dg_T%28b_0%29%2B%5Cfrac%7B%5Cpartial+g_T%7D%7B%5Cpartial+b%5E%5Cprime%7D%28%5Chat+b-b_0%29&quot; alt=&quot;\displaystyle g_T(\hat b)=g_T(b_0)+\frac{\partial g_T}{\partial b^\prime}(\hat b-b_0)&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;由于 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b+%E2%80%93+b_0&quot; alt=&quot;\hat b – b_0&quot; eeimg=&quot;1&quot;/&gt; 已经在之前求出了，因此只需把它代入到上式就可得到：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+g_T%28%5Chat+b%29%26%3D%26%5Cdisplaystyle+g_T%28b_0%29-d%28ad%29%5E%7B-1%7Dag_T%28b_0%29%5C%5C+%26%3D%26%5Cleft%5BI-d%28ad%29%5E%7B-1%7Da%5Cright%5Dg_T%28b_0%29+%5Cend%7Barray%7D&quot; alt=&quot;\begin{array}{rll} g_T(\hat b)&amp;amp;=&amp;amp;\displaystyle g_T(b_0)-d(ad)^{-1}ag_T(b_0)\\ &amp;amp;=&amp;amp;\left[I-d(ad)^{-1}a\right]g_T(b_0) \end{array}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;两边同时求 variance（确切的说是 variance-covariance matrix）有：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29%26%3D%26%5Cdisplaystyle%5Cleft%5BI-d%28ad%29%5E%7B-1%7Da%5Cright%5D%5Cmbox%7Bvar%7D%28g_T%28b_0%29%29%5Cleft%5BI-d%28ad%29%5E%7B-1%7Da%5Cright%5D%5E%5Cprime%5C%5C+%26%3D%26%5Cdisplaystyle%5Cfrac%7B1%7D%7BT%7D%5Cleft%5BI-d%28ad%29%5E%7B-1%7Da%5Cright%5DS%5Cleft%5BI-d%28ad%29%5E%7B-1%7Da%5Cright%5D%5E%5Cprime+%5Cend%7Barray%7D&quot; alt=&quot;\begin{array}{rll} \mbox{var}(g_T(\hat b))&amp;amp;=&amp;amp;\displaystyle\left[I-d(ad)^{-1}a\right]\mbox{var}(g_T(b_0))\left[I-d(ad)^{-1}a\right]^\prime\\ &amp;amp;=&amp;amp;\displaystyle\frac{1}{T}\left[I-d(ad)^{-1}a\right]S\left[I-d(ad)^{-1}a\right]^\prime \end{array}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;上式中的第二个等式用到了我们的老朋友： &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28b_0%29%29+%3D+S%2FT&quot; alt=&quot;\mbox{var}(g_T(b_0)) = S/T&quot; eeimg=&quot;1&quot;/&gt; —— variance of sample mean！关于 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28b_0%29%29&quot; alt=&quot;\mbox{var}(g_T(b_0))&quot; eeimg=&quot;1&quot;/&gt; 的关系也可以从直觉上解释两句。不难看出， &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; 是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28b_0%29%29&quot; alt=&quot;\mbox{var}(g_T(b_0))&quot; eeimg=&quot;1&quot;/&gt; 乘以一个系数矩阵，这个系数矩阵是单位阵  &lt;img src=&quot;https://www.zhihu.com/equation?tex=I&quot; alt=&quot;I&quot; eeimg=&quot;1&quot;/&gt;  减去这一大坨 &lt;img src=&quot;https://www.zhihu.com/equation?tex=d%28ad%29%5E%7B-1%7Da&quot; alt=&quot;d(ad)^{-1}a&quot; eeimg=&quot;1&quot;/&gt; 。&lt;b&gt;因此从直觉上说，&lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 在 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=b+%3D+%5Chat+b&quot; alt=&quot;b = \hat b&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 时的方差 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;会比 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 在 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=b+%3D+b_0&quot; alt=&quot;b = b_0&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 时的方差 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28b_0%29%29&quot; alt=&quot;\mbox{var}(g_T(b_0))&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;要小一些。&lt;/b&gt;这是因为在 GMM 估计时，我们要求 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; 的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=p&quot; alt=&quot;p&quot; eeimg=&quot;1&quot;/&gt; 个线性组合等于零 —— &lt;img src=&quot;https://www.zhihu.com/equation?tex=ag_T%28%5Chat+b%29+%3D+0&quot; alt=&quot;ag_T(\hat b) = 0&quot; eeimg=&quot;1&quot;/&gt; —— 从而求出 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; ，因此求解 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; 的过程用掉了 sample moments 的一些 variation，所以当 &lt;img src=&quot;https://www.zhihu.com/equation?tex=b+%3D+%5Chat+b&quot; alt=&quot;b = \hat b&quot; eeimg=&quot;1&quot;/&gt; 时 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; 方差小于当 &lt;img src=&quot;https://www.zhihu.com/equation?tex=b+%3D+b_0&quot; alt=&quot;b = b_0&quot; eeimg=&quot;1&quot;/&gt; 时 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; 的方差。&lt;/p&gt;&lt;p&gt;&lt;b&gt;无论是 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 还是 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;，上面一顿泰勒展开操作虽然非常热闹，但它们其实都仅是用了统计学中的 delta method。所以，其实我们只是用了 variance of the sample mean（&lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=S%2FT&quot; alt=&quot;S/T&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;）+ delta method 就求出了我们关心的&lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 和 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;。就是这么简单。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;有了 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; ，就可以得到 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T%28%5Chat+b%29&quot; alt=&quot;g_T(\hat b)&quot; eeimg=&quot;1&quot;/&gt; 的渐近分布（3.3 节介绍过），使用它的分布就可以构建 chi-squared statistic 来对模型进行检验：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+%26%5Cdisplaystyle+g_T%28%5Chat+b%29%5E%5Cprime%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29%5E%7B-1%7Dg_T%28%5Chat+b%29%5Csim%5Cchi%5E2_%7Bn-p%7D%5C%5C+%5CRightarrow%26%5Cdisplaystyle+Tg_T%28%5Chat+b%29%5E%5Cprime%5Cleft%5B%5Cleft%28I-d%28ad%29%5E%7B-1%7Da%5Cright%29S%5Cleft%28I-d%28ad%29%5E%7B-1%7Da%5Cright%29%5E%5Cprime%5Cright%5D%5E%7B-1%7D+g_T%28%5Chat+b%29%5Csim%5Cchi%5E2_%7Bn-p%7D+%5Cend%7Barray%7D&quot; alt=&quot;\begin{array}{rll} &amp;amp;\displaystyle g_T(\hat b)^\prime\mbox{var}(g_T(\hat b))^{-1}g_T(\hat b)\sim\chi^2_{n-p}\\ \Rightarrow&amp;amp;\displaystyle Tg_T(\hat b)^\prime\left[\left(I-d(ad)^{-1}a\right)S\left(I-d(ad)^{-1}a\right)^\prime\right]^{-1} g_T(\hat b)\sim\chi^2_{n-p} \end{array}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;上式的第二步是把  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt;  的表达式代入并求逆；chi-squared statistic 的自由度是 moments 的个数减去参数的个数，即 &lt;img src=&quot;https://www.zhihu.com/equation?tex=n+%E2%80%93+p&quot; alt=&quot;n – p&quot; eeimg=&quot;1&quot;/&gt; 。&lt;b&gt;由于估计 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 的时候用掉了 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=p&quot; alt=&quot;p&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt; 个自由度，所以 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T%28%5Chat+b%29&quot; alt=&quot;g_T(\hat b)&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt; 的 variance-covariance matrix 不是满秩的（这也体现在了 chi-squared statistic 的自由度 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=n+%E2%80%93+p&quot; alt=&quot;n – p&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 上），因此上式中对 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 求逆实际上是 pseudo-inverse。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;如果你在 Wikipedia 或者其他书籍上查阅 GMM 的资料，也许看到的 chi-squared statistic 的表达式远没有上面这个复杂。&lt;b&gt;上述表达式是最 general 的情况&lt;/b&gt;，因为我们尚未讨论那个使 GMM estimator 变得 efficient 的特殊的矩阵  &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; 。在那个  &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt;  下， &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; 矩阵以及 chi-squared statistic 表达式将被大大的简化。Efficient GMM 就是下一节的内容。&lt;/p&gt;&lt;p&gt;总结一下本小节。上面用了大量的文字和推导把 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; 背后的数学含义呈现给各位，是希望这个过程能帮助小伙伴们加深对 GMM 的理解。站在 notation 的角度来说，虽然这些公式看上去很复杂（又是转置、又是求逆的），&lt;b&gt;但我们只需给 GMM 框架提供它需要的 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;、&lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;、&lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt; 和 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;，剩下的“无脑”交给 GMM 就可以计算出各种想要的统计量并进行 test，非常方便。&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;05 Efficient GMM&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;本文的 3.2 小节给出的 GMM estimator 如下：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Chat+b%3A+%5Cmbox%7Bset+%7D+ag_T%28%5Chat+b%29%3D0&quot; alt=&quot;\displaystyle\hat b: \mbox{set } ag_T(\hat b)=0&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;其中  &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt;  是一个 &lt;img src=&quot;https://www.zhihu.com/equation?tex=p+%C3%97+n&quot; alt=&quot;p × n&quot; eeimg=&quot;1&quot;/&gt; 阶矩阵，每一行都代表一个 sample moments 的线性组合。本节关心的问题是，&lt;b&gt;如何选取矩阵 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;？&lt;/b&gt;回答这个问题可以从&lt;b&gt;业务上&lt;/b&gt;和&lt;b&gt;统计上&lt;/b&gt;两方面思考 —— &lt;b&gt;永远不要忘记业务层面的思考！从经济学或金融学原理出发，尤其是针对 asset pricing 的问题，我们可以选择一些最 economically important 的 moments，让它们或它们的线性组合等于零。我们不应让 GMM 成为一个 statistical 黑箱，代替我们的思考。&lt;/b&gt;第七节将会进一步说明。&lt;/p&gt;&lt;p&gt;再来从统计上说，Hansen (1982) 指出了一个特殊的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; 矩阵，它能确保得到 efficient GMM estimator，即在给定的 moments &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; 下，该矩阵  &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt;  使得 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt; 最小。这个特殊的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; 矩阵为：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+a%3Dd%5E%5Cprime+S%5E%7B-1%7D&quot; alt=&quot;\displaystyle a=d^\prime S^{-1}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;看到这里可能又有小伙伴会问： &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt;  见过、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt;  见过、转置明白、求逆矩阵清楚，但是这四个符号组合在一起得到的  &lt;img src=&quot;https://www.zhihu.com/equation?tex=d%5E%5Cprime+S%5E%7B-1%7D&quot; alt=&quot;d^\prime S^{-1}&quot; eeimg=&quot;1&quot;/&gt;  是个什么鬼？？这个 &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; 到底有没有什么更直观的含义？别急，先来看看  &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt;  的阶数。本文的 3.2 节已经指出  &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt;  是一个 &lt;img src=&quot;https://www.zhihu.com/equation?tex=p+%C3%97+n&quot; alt=&quot;p × n&quot; eeimg=&quot;1&quot;/&gt; 阶矩阵，下面我们来验证一下。&lt;/p&gt;&lt;p&gt;前面首次提到 &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt; 的时候说过了，它是一阶偏导数  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%E2%88%82g_T%2F%E2%88%82b%5E%5Cprime&quot; alt=&quot;∂g_T/∂b^\prime&quot; eeimg=&quot;1&quot;/&gt; 。但由于 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; （ &lt;img src=&quot;https://www.zhihu.com/equation?tex=n+%C3%97+1&quot; alt=&quot;n × 1&quot; eeimg=&quot;1&quot;/&gt; 阶）和  &lt;img src=&quot;https://www.zhihu.com/equation?tex=b&quot; alt=&quot;b&quot; eeimg=&quot;1&quot;/&gt; （ &lt;img src=&quot;https://www.zhihu.com/equation?tex=p+%C3%97+1&quot; alt=&quot;p × 1&quot; eeimg=&quot;1&quot;/&gt; 阶）都是 vectors，因此  &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt;  是一个遵照 numerator layout（也称作 Jacobian formulation）排列的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=n+%C3%97+p&quot; alt=&quot;n × p&quot; eeimg=&quot;1&quot;/&gt; 阶矩阵。因此矩阵  &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt;  的转置  &lt;img src=&quot;https://www.zhihu.com/equation?tex=d%5E%5Cprime&quot; alt=&quot;d^\prime&quot; eeimg=&quot;1&quot;/&gt;  就是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=p+%C3%97+n&quot; alt=&quot;p × n&quot; eeimg=&quot;1&quot;/&gt; 的矩阵，它同样也是一个一阶偏导数  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%E2%88%82g_T%5E%5Cprime%2F%E2%88%82b&quot; alt=&quot;∂g_T^\prime/∂b&quot; eeimg=&quot;1&quot;/&gt;  —— 这次转置在 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; 上，遵循的是 denominator layout（也称 Hessian formulation），通常表示&lt;b&gt;求梯度（gradient）&lt;/b&gt;。最后，由于 &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt; 是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=n+%C3%97+n&quot; alt=&quot;n × n&quot; eeimg=&quot;1&quot;/&gt; 阶，因此 a 确实是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=p+%C3%97+n&quot; alt=&quot;p × n&quot; eeimg=&quot;1&quot;/&gt; 阶。&lt;/p&gt;&lt;p&gt;下面我们就来看看 &lt;img src=&quot;https://www.zhihu.com/equation?tex=d%5E%5Cprime+S%5E%7B-1%7D&quot; alt=&quot;d^\prime S^{-1}&quot; eeimg=&quot;1&quot;/&gt; 到底是个什么鬼。其实它有着非常清晰的含义。为了解释 &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; 就不得不提 GMM estimator 的另一种表达式，这可能也是之前接触过 GMM 的小伙伴更熟悉的一种表达式：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Chat+b%3D+%5Carg%5Cmin+g_T%28b%29%5E%5Cprime+Wg_T%28b%29&quot; alt=&quot;\displaystyle\hat b= \arg\min g_T(b)^\prime Wg_T(b)&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;上式中  &lt;img src=&quot;https://www.zhihu.com/equation?tex=W&quot; alt=&quot;W&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt; 是权重矩阵（weighting matrix）&lt;/b&gt;，它是一个半正定矩阵。这个式子的含义是，在 overidentification 问题中，既然我们无法让所有的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; 都等于零，那么就让所有  &lt;img src=&quot;https://www.zhihu.com/equation?tex=n&quot; alt=&quot;n&quot; eeimg=&quot;1&quot;/&gt;  个  &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt;  的范数的加权之和尽可能的接近零，以此来确定 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; 。&lt;/p&gt;&lt;p&gt;正如在本文的第一种 GMM estimator 表达中我们可以随意选择矩阵  &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt;  一样，在上面的第二种 GMM estimator 表达中我们可以随意选择权重矩阵  &lt;img src=&quot;https://www.zhihu.com/equation?tex=W&quot; alt=&quot;W&quot; eeimg=&quot;1&quot;/&gt; 。但是从 efficiency 的角度，最优的权重矩阵  &lt;img src=&quot;https://www.zhihu.com/equation?tex=W&quot; alt=&quot;W&quot; eeimg=&quot;1&quot;/&gt;  满足：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+W%3DS%5E%7B-1%7D&quot; alt=&quot;\displaystyle W=S^{-1}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;这从统计上非常好理解：我们有一组 moments &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; ，我们希望它们（非负）加权之和最接近零。使用 &lt;img src=&quot;https://www.zhihu.com/equation?tex=W+%3D+S%5E%7B-1%7D&quot; alt=&quot;W = S^{-1}&quot; eeimg=&quot;1&quot;/&gt; 即 &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt; 的&lt;b&gt;逆矩阵&lt;/b&gt;（别忘了 &lt;img src=&quot;https://www.zhihu.com/equation?tex=S%2FT&quot; alt=&quot;S/T&quot; eeimg=&quot;1&quot;/&gt; 是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28b_0%29%29&quot; alt=&quot;\mbox{var}(g_T(b_0))&quot; eeimg=&quot;1&quot;/&gt; ）&lt;b&gt;相当于给那些 sampling variation&lt;/b&gt; &lt;b&gt;大的 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 更低的权重、给那些 sampling variation&lt;/b&gt; &lt;b&gt;小的 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 更高的权重（inverse 的意义）。换句话说，我们更愿意相信那些误差小的 moments 并使用它们来得到尽可能准确的参数估计 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;，从而使 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 最低，这也就是 efficient 的含义。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;将 &lt;img src=&quot;https://www.zhihu.com/equation?tex=W+%3D+S%5E%7B-1%7D&quot; alt=&quot;W = S^{-1}&quot; eeimg=&quot;1&quot;/&gt; 代入上面第二个 GMM estimator 并求其 first order condition 有：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+%5Cleft%28%5Cfrac%7B%5Cpartial+g_T%5E%5Cprime%7D%7B%5Cpartial+b%7DS%5E%7B-1%7D%5Cright%29g_T%28%5Chat+b%29%3D0&quot; alt=&quot;\displaystyle \left(\frac{\partial g_T^\prime}{\partial b}S^{-1}\right)g_T(\hat b)=0&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;怎么样，看着眼熟不？括号里的第一项正是  &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt;  的转置  &lt;img src=&quot;https://www.zhihu.com/equation?tex=d%5E%5Cprime&quot; alt=&quot;d^\prime&quot; eeimg=&quot;1&quot;/&gt; ，第二项是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=S%5E%7B-1%7D&quot; alt=&quot;S^{-1}&quot; eeimg=&quot;1&quot;/&gt; ，这两个放一起  &lt;img src=&quot;https://www.zhihu.com/equation?tex=d%5E%5Cprime+S%5E%7B-1%7D&quot; alt=&quot;d^\prime S^{-1}&quot; eeimg=&quot;1&quot;/&gt;  正是第一种 GMM estimator 下最优的矩阵 &lt;img src=&quot;https://www.zhihu.com/equation?tex=a+%3D+d%5E%5Cprime+S%5E%7B-1%7D&quot; alt=&quot;a = d^\prime S^{-1}&quot; eeimg=&quot;1&quot;/&gt; ：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brrl%7D+%26%5Cmbox%7BGMM+estimator+%7DW%3DS%5E%7B-1%7D%3A%26%5Cdisplaystyle%5Chat+b%3D+%5Carg%5Cmin+g_T%28b%29%5E%5Cprime+S%5E%7B-1%7Dg_T%28b%29%5C%5C+%5CRightarrow%26%5Cmbox%7Bfirst+order+condition%7D%3A%26%5Cdisplaystyle+%5Cleft%28%5Cfrac%7B%5Cpartial+g_T%5E%5Cprime%7D%7B%5Cpartial+b%7DS%5E%7B-1%7D%5Cright%29g_T%28%5Chat+b%29%3D0%5C%5C+%5CRightarrow%26%26%5Cdisplaystyle+%5Cleft%28%5Cleft%5B%5Cfrac%7B%5Cpartial+g_T%7D%7B%5Cpartial+b%5E%5Cprime%7D%5Cright%5D%5E%5Cprime+S%5E%7B-1%7D%5Cright%29g_T%28%5Chat+b%29%3D0%5C%5C+%5CRightarrow%26%26%5Cdisplaystyle+%5Cleft%28d%5E%5Cprime+S%5E%7B-1%7D%5Cright%29g_T%28%5Chat+b%29%3D0%5C%5C+%5CRightarrow%26%5Cmbox%7BGMM+estimator+%7Da%3Dd%5E%5Cprime+S%5E%7B-1%7D%3A%26%5Cdisplaystyle+ag_T%28%5Chat+b%29%3D0+%5Cend%7Barray%7D&quot; alt=&quot;\begin{array}{rrl} &amp;amp;\mbox{GMM estimator }W=S^{-1}:&amp;amp;\displaystyle\hat b= \arg\min g_T(b)^\prime S^{-1}g_T(b)\\ \Rightarrow&amp;amp;\mbox{first order condition}:&amp;amp;\displaystyle \left(\frac{\partial g_T^\prime}{\partial b}S^{-1}\right)g_T(\hat b)=0\\ \Rightarrow&amp;amp;&amp;amp;\displaystyle \left(\left[\frac{\partial g_T}{\partial b^\prime}\right]^\prime S^{-1}\right)g_T(\hat b)=0\\ \Rightarrow&amp;amp;&amp;amp;\displaystyle \left(d^\prime S^{-1}\right)g_T(\hat b)=0\\ \Rightarrow&amp;amp;\mbox{GMM estimator }a=d^\prime S^{-1}:&amp;amp;\displaystyle ag_T(\hat b)=0 \end{array}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;这就是最优矩阵  &lt;img src=&quot;https://www.zhihu.com/equation?tex=a+%3D+d%5E%5Cprime+S%5E%7B-1%7D&quot; alt=&quot;a = d^\prime S^{-1}&quot; eeimg=&quot;1&quot;/&gt;  的含义。从上面的推导也不难看出这两种 GMM estimator 表达式是等价的：无论我们取何种  &lt;img src=&quot;https://www.zhihu.com/equation?tex=W&quot; alt=&quot;W&quot; eeimg=&quot;1&quot;/&gt;  权重矩阵，都有一个与之对应的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=a+%3D+d%5E%5Cprime+W&quot; alt=&quot;a = d^\prime W&quot; eeimg=&quot;1&quot;/&gt; 矩阵。当矩阵  &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt;  或权重矩阵  &lt;img src=&quot;https://www.zhihu.com/equation?tex=W&quot; alt=&quot;W&quot; eeimg=&quot;1&quot;/&gt;  取统计上最优时， &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; 以及 chi-squared test statistic 的表达式均可以大大化简。Hansen (1982) 给出了它们的形式：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+%5Cmbox%7Bvar%7D%28%5Chat+b%29%26%3D%26%5Cdisplaystyle%5Cfrac%7B1%7D%7BT%7D%5Cleft%28d%5E%5Cprime+S%5E%7B-1%7Dd%5Cright%29%5E%7B-1%7D%5C%5C+%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29%26%3D%26%5Cdisplaystyle%5Cfrac%7B1%7D%7BT%7D%5Cleft%28S-d%28d%5E%5Cprime+S%5E%7B-1%7Dd%29%5E%7B-1%7Dd%5E%5Cprime%5Cright%29%5C%5C+Tg_T%28%5Chat+b%29%5E%5Cprime+S%5E%7B-1%7Dg_T%28%5Chat+b%29%26%5Csim%26%5Cchi%5E2_%7Bn-p%7D+%5Cend%7Barray%7D&quot; alt=&quot;\begin{array}{rll} \mbox{var}(\hat b)&amp;amp;=&amp;amp;\displaystyle\frac{1}{T}\left(d^\prime S^{-1}d\right)^{-1}\\ \mbox{var}(g_T(\hat b))&amp;amp;=&amp;amp;\displaystyle\frac{1}{T}\left(S-d(d^\prime S^{-1}d)^{-1}d^\prime\right)\\ Tg_T(\hat b)^\prime S^{-1}g_T(\hat b)&amp;amp;\sim&amp;amp;\chi^2_{n-p} \end{array}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;&lt;b&gt;需要强调的是，以上的这些大大简化了的表达式只有当 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=a+%3D+d%5E%5Cprime+S%5E%7B-1%7D&quot; alt=&quot;a = d^\prime S^{-1}&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;（或 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=W+%3D+S%5E%7B-1%7D&quot; alt=&quot;W = S^{-1}&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;）时才成立！如果 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt; 或 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=W&quot; alt=&quot;W&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt; 取别的值，则应该使用本文第 4 节中介绍的更 general 的形式。&lt;/b&gt;很多关于 GMM 的材料中默认 &lt;img src=&quot;https://www.zhihu.com/equation?tex=W+%3D+S%5E%7B-1%7D&quot; alt=&quot;W = S^{-1}&quot; eeimg=&quot;1&quot;/&gt; 而给出了这些统计量的简化形式，使用时应搞清楚前提条件。&lt;/p&gt;&lt;p&gt;在实际估计中，因为必须先有 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; 才能估计  &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt; ，并计算 &lt;img src=&quot;https://www.zhihu.com/equation?tex=W+%3D+S%5E%7B-1%7D&quot; alt=&quot;W = S^{-1}&quot; eeimg=&quot;1&quot;/&gt; （或最优的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; ）；但另一方面只有使用 &lt;img src=&quot;https://www.zhihu.com/equation?tex=S%5E%7B-1%7D&quot; alt=&quot;S^{-1}&quot; eeimg=&quot;1&quot;/&gt; 才能得到最优的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; 。这似乎是一个鸡生蛋、蛋生鸡的问题。因此，实际中往往采用 two-stage estimates：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;First Stage：&lt;/b&gt;通常取 &lt;img src=&quot;https://www.zhihu.com/equation?tex=W+%3D+I&quot; alt=&quot;W = I&quot; eeimg=&quot;1&quot;/&gt; 单位阵，估计出 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; ；&lt;/li&gt;&lt;li&gt;&lt;b&gt;Second Stage：&lt;/b&gt;使用  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt;  估计 S，令 &lt;img src=&quot;https://www.zhihu.com/equation?tex=W+%3D+S%5E%7B-1%7D&quot; alt=&quot;W = S^{-1}&quot; eeimg=&quot;1&quot;/&gt; 进行再一次估计得到新的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; 。&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;当然，如果愿意，也可以把上面的第二步&lt;b&gt;迭代多次&lt;/b&gt;，得到最终的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; 。以上就完成了关于 GMM 的全部介绍。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;06 GMM does OLS&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;GMM 之所以如此强大，是因为它自带的“estimate、variance、test”三部曲能够干很多事儿！对于很多需要研究的问题，只要把它的模型塞进 GMM 的框架，就可以得到想要的分析结果。&lt;/p&gt;&lt;p&gt;本节就把我们熟悉的 OLS 放在 GMM 的框架下看看后者的强大之处。由于参数个数和 moments 个数相同，因此 OLS 不存在 overidentification 的问题，我们没有什么可以检验的。但是 GMM 仍然可以轻松的计算出参数的 variance（即完成 estimate 和 variance 两步），无论 OLS 的残差是否存在自相关或异方差。&lt;/p&gt;&lt;p&gt;想要使用 GMM 框架，只需要把 OLS 表述成 moment conditions。考虑 OLS 问题（截距被视作一个解释变量，不做区分；假设一共有  &lt;img src=&quot;https://www.zhihu.com/equation?tex=k&quot; alt=&quot;k&quot; eeimg=&quot;1&quot;/&gt;  个解释变量，因此 &lt;img src=&quot;https://www.zhihu.com/equation?tex=x_t&quot; alt=&quot;x_t&quot; eeimg=&quot;1&quot;/&gt; 表示 &lt;img src=&quot;https://www.zhihu.com/equation?tex=k+%C3%97+1&quot; alt=&quot;k × 1&quot; eeimg=&quot;1&quot;/&gt; 阶向量）如下：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+y_t%3D%5Cbeta%5E%5Cprime+x_t%2B%5Cvarepsilon_t&quot; alt=&quot;\displaystyle y_t=\beta^\prime x_t+\varepsilon_t&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;由 OLS 的性质可知，其解释变量和残差正交，因此 OLS 的 moment conditions 为：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T%28%5Chat%5Cbeta%29%3D%5Cmbox%7BE%7D_T%5Cleft%5Bx_t%28y_t-%5Chat%5Cbeta%5E%5Cprime+x_t%29%5Cright%5D%3D0&quot; alt=&quot;g_T(\hat\beta)=\mbox{E}_T\left[x_t(y_t-\hat\beta^\prime x_t)\right]=0&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;由于 moments 个数和参数个数相同，因此我们只需要令所有 sample moments 都等于零即可，这意味着矩阵 &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; 是单位阵 &lt;img src=&quot;https://www.zhihu.com/equation?tex=I&quot; alt=&quot;I&quot; eeimg=&quot;1&quot;/&gt; ，因此在上式的 GMM estimator 中省略了  &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; 。求解上述 sample moment conditions 就可以得到参数的估计：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Chat%5Cbeta%3D%5Cleft%5B%5Cmbox%7BE%7D_T%28x_tx_t%5E%5Cprime%29%5Cright%5D%5E%7B-1%7D%5Cmbox%7BE%7D_T%28x_ty_t%29&quot; alt=&quot;\displaystyle\hat\beta=\left[\mbox{E}_T(x_tx_t^\prime)\right]^{-1}\mbox{E}_T(x_ty_t)&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;如果令  &lt;img src=&quot;https://www.zhihu.com/equation?tex=X+%3D+%5Bx_1+x_2+%E2%80%A6+x_t%5D%5E%5Cprime&quot; alt=&quot;X = [x_1 x_2 … x_t]^\prime&quot; eeimg=&quot;1&quot;/&gt;  表示 data matrix，则有 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%281%2FT%29X%5E%5Cprime+X+%3D+%5Cmbox%7BE%7D_T%5Bx_tx_t%5E%5Cprime%5D&quot; alt=&quot;(1/T)X^\prime X = \mbox{E}_T[x_tx_t^\prime]&quot; eeimg=&quot;1&quot;/&gt; ，因此上式又可以写成：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Chat%5Cbeta%3D%5Cleft%5B%5Cmbox%7BE%7D_T%28x_tx_t%5E%5Cprime%29%5Cright%5D%5E%7B-1%7D%5Cmbox%7BE%7D_T%28x_ty_t%29%3D%28X%5E%5Cprime+X%29%5E%7B-1%7DX%5E%5Cprime+Y&quot; alt=&quot;\displaystyle\hat\beta=\left[\mbox{E}_T(x_tx_t^\prime)\right]^{-1}\mbox{E}_T(x_ty_t)=(X^\prime X)^{-1}X^\prime Y&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;这正是我们熟悉的 OLS estimator。GMM 的强大之处在于轻松的计算 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+%CE%B2%29&quot; alt=&quot;\mbox{var}(\hat β)&quot; eeimg=&quot;1&quot;/&gt; 。为此，我们需要给 GMM 框架提供它所需要的  &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt;  和  &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt; （已经有了  &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt;  和  &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; ）。根据  &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt;  和  &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt;  的定义可得：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+d%26%3D%26-%5Cmbox%7BE%7D%5Bx_tx_t%5E%5Cprime%5D%5C%5C+f%28x_t%2C+%5Cbeta%29%26%3D%26x_t%5Cvarepsilon_t%5C%5C+S%26%3D%26%5Cdisplaystyle%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D%5Cmbox%7BE%7D%5B%5Cvarepsilon_tx_tx_%7Bt-j%7D%5E%5Cprime%5Cvarepsilon_%7Bt-j%7D%5D+%5Cend%7Barray%7D&quot; alt=&quot;\begin{array}{rll} d&amp;amp;=&amp;amp;-\mbox{E}[x_tx_t^\prime]\\ f(x_t, \beta)&amp;amp;=&amp;amp;x_t\varepsilon_t\\ S&amp;amp;=&amp;amp;\displaystyle\sum_{j=-\infty}^{\infty}\mbox{E}[\varepsilon_tx_tx_{t-j}^\prime\varepsilon_{t-j}] \end{array}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;有了 &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt; ，直接利用 GMM 中的公式就可以求出 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+%CE%B2%29&quot; alt=&quot;\mbox{var}(\hat β)&quot; eeimg=&quot;1&quot;/&gt; ：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+%5Cmbox%7Bvar%7D%28%5Chat%5Cbeta%29%3D%5Cfrac%7B1%7D%7BT%7D%5Cmbox%7BE%7D%5Bx_tx_t%5E%5Cprime%5D%5E%7B-1%7D%5Cleft%5B%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D%5Cmbox%7BE%7D%5B%5Cvarepsilon_tx_tx_%7Bt-j%7D%5E%5Cprime%5Cvarepsilon_%7Bt-j%7D%5D%5Cright%5D%5Cmbox%7BE%7D%5Bx_tx_t%5E%5Cprime%5D%5E%7B-1%7D&quot; alt=&quot;\displaystyle \mbox{var}(\hat\beta)=\frac{1}{T}\mbox{E}[x_tx_t^\prime]^{-1}\left[\sum_{j=-\infty}^{\infty}\mbox{E}[\varepsilon_tx_tx_{t-j}^\prime\varepsilon_{t-j}]\right]\mbox{E}[x_tx_t^\prime]^{-1}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;这正是广义 OLS 下 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+%CE%B2%29&quot; alt=&quot;\mbox{var}(\hat β)&quot; eeimg=&quot;1&quot;/&gt; 的表达式（请参考&lt;a href=&quot;https://zhuanlan.zhihu.com/p/54913149&quot; class=&quot;internal&quot;&gt;《多因子回归检验中的 Newey-West 调整》&lt;/a&gt;对比）。&lt;/p&gt;&lt;p&gt;We are done!&lt;/p&gt;&lt;p&gt;下面考察几种情况。首先如果残差满足 i.i.d.， &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+%CE%B2%29&quot; alt=&quot;\mbox{var}(\hat β)&quot; eeimg=&quot;1&quot;/&gt; 就可以简化成我们最熟悉的样子：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+%5Cmbox%7Bvar%7D%28%5Chat%5Cbeta%29%3D%5Cfrac%7B1%7D%7BT%7D%5Csigma_%7B%5Cvarepsilon%7D%5E2%5Cmbox%7BE%7D%5Bx_tx_t%5E%5Cprime%5D%5E%7B-1%7D%3D%5Csigma_%7B%5Cvarepsilon%7D%5E2%5Cleft%28X%5E%5Cprime+X%5Cright%29%5E%7B-1%7D&quot; alt=&quot;\displaystyle \mbox{var}(\hat\beta)=\frac{1}{T}\sigma_{\varepsilon}^2\mbox{E}[x_tx_t^\prime]^{-1}=\sigma_{\varepsilon}^2\left(X^\prime X\right)^{-1}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;通常来说，残差中可能存在异方差、自相关或者两者皆有。在 GMM 的框架下，为了计算 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+%CE%B2%29&quot; alt=&quot;\mbox{var}(\hat β)&quot; eeimg=&quot;1&quot;/&gt; 仅需要在  &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt;  矩阵中考虑异方差和自相关造成的影响。当残差仅存在异方差时， &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt;  的表达式为：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+S%3D%5Cmbox%7BE%7D%5B%5Cvarepsilon_t%5E2x_tx_t%27%5D&quot; alt=&quot;\displaystyle S=\mbox{E}[\varepsilon_t^2x_tx_t&amp;#39;]&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;因此 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+%CE%B2%29&quot; alt=&quot;\mbox{var}(\hat β)&quot; eeimg=&quot;1&quot;/&gt; 的表达式变成：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+%5Cmbox%7Bvar%7D%28%5Chat%5Cbeta%29%3D%5Cfrac%7B1%7D%7BT%7D%5Cmbox%7BE%7D%5Bx_tx_t%5E%5Cprime%5D%5E%7B-1%7D%5Cmbox%7BE%7D%5B%5Cvarepsilon_t%5E2x_tx_t%5E%5Cprime%5D%5Cmbox%7BE%7D%5Bx_tx_t%5E%5Cprime%5D%5E%7B-1%7D&quot; alt=&quot;\displaystyle \mbox{var}(\hat\beta)=\frac{1}{T}\mbox{E}[x_tx_t^\prime]^{-1}\mbox{E}[\varepsilon_t^2x_tx_t^\prime]\mbox{E}[x_tx_t^\prime]^{-1}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;这正是大名鼎鼎的 White (1980) heteroscedasticity consistent estimator。&lt;/p&gt;&lt;p&gt;当残差即存在异方差又存在自相关时， &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt; 可以写作：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+S%3D%5Csum_%7Bj%3D-k%7D%5Ek+w_j%5Cmbox%7BE%7D%5B%5Cvarepsilon_tx_tx_%7Bt-j%7D%27%5Cvarepsilon_%7Bt-j%7D%5D&quot; alt=&quot;\displaystyle S=\sum_{j=-k}^k w_j\mbox{E}[\varepsilon_tx_tx_{t-j}&amp;#39;\varepsilon_{t-j}]&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;而 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+%CE%B2%29&quot; alt=&quot;\mbox{var}(\hat β)&quot; eeimg=&quot;1&quot;/&gt; 的表达式变成：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+%5Cmbox%7Bvar%7D%28%5Chat%5Cbeta%29%3D%5Cfrac%7B1%7D%7BT%7D%5Cmbox%7BE%7D%5Bx_tx_t%5E%5Cprime%5D%5E%7B-1%7D%5Cleft%5B%5Csum_%7Bj%3D-k%7D%5Ek+w_j%5Cmbox%7BE%7D%5B%5Cvarepsilon_tx_tx_%7Bt-j%7D%27%5Cvarepsilon_%7Bt-j%7D%5D%5Cright%5D%5Cmbox%7BE%7D%5Bx_tx_t%5E%5Cprime%5D%5E%7B-1%7D&quot; alt=&quot;\displaystyle \mbox{var}(\hat\beta)=\frac{1}{T}\mbox{E}[x_tx_t^\prime]^{-1}\left[\sum_{j=-k}^k w_j\mbox{E}[\varepsilon_tx_tx_{t-j}&amp;#39;\varepsilon_{t-j}]\right]\mbox{E}[x_tx_t^\prime]^{-1}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;这正是大名鼎鼎的 Newey and West (1987) autocorrelation consistent covariance estimator（见&lt;a href=&quot;https://zhuanlan.zhihu.com/p/54913149&quot; class=&quot;internal&quot;&gt;《多因子回归检验中的 Newey-West 调整》&lt;/a&gt;）。&lt;/p&gt;&lt;p&gt;无论残差具有什么特性，整个 OLS 的求解过程都可以很好的装到 GMM 的框架中。而当使用 GMM 框架时，只需按照它的要求来定义  &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt;  以及  &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt; ，就可以“无脑”的利用 GMM 给出的结果。这正是 GMM 的强大之处。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;07 不应成为黑箱&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;在结束本文之前，再花一小节讨论一个很重要的问题：&lt;b&gt;GMM 不应该成为计量学黑箱。&lt;/b&gt;这是我听完 Cochrane 教授的讲解后印象非常深刻的一点。&lt;/p&gt;&lt;p&gt;GMM 如此强大再加上现在各种编程语言（R、Stata 等）都能方便的计算，这种便捷性似乎把人们都惯坏了；&lt;b&gt;人们习惯于把问题描述成 moment conditions 然后一股脑塞进 GMM 并纯从统计的角度使用 efficient estimator（即 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=W+%3D+S%5E%7B-1%7D&quot; alt=&quot;W = S^{-1}&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;）。&lt;/b&gt;Cochrane 教授警告说这么做十分危险。&lt;/p&gt;&lt;p&gt;&lt;b&gt;GMM 的强大之处在于它不仅仅是一个计量学工具来做 test，而是它足够 flexible 从而可以让我们研究我们真正关心的经济学或金融学问题，这体现在我们可以从“先验”出发去定义最适合待研究问题的矩阵 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;（或权重矩阵 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=W&quot; alt=&quot;W&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;），而非无脑的选择 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=W+%3D+S%5E%7B-1%7D&quot; alt=&quot;W = S^{-1}&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;以 3.2 节中 asset pricing 的例子来说，我们有四个 moments，两个参数。这四个 moments 来自四个资产：risk-free、市场组合以及 HML 和 SMB，我们假设待检验的模型是 CCAPM。从经济学业务出发，我们可以选择如下的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=ag_T%28%5Chat+b%29+%3D+0&quot; alt=&quot;ag_T(\hat b) = 0&quot; eeimg=&quot;1&quot;/&gt; ：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cleft%5B+%5Cbegin%7Barray%7D%7Bcccc%7D+1%260%260%260%5C%5C+0%261%260%260+%5Cend%7Barray%7D+%5Cright%5D+%5Cleft%5B+%5Cbegin%7Barray%7D%7Bl%7D+%5Cmbox%7BE%7D_T%5Bm%28%5Chat%5Cbeta%2C%5Chat%5Cgamma%29R%5Ee_m%5D%5C%5C+%5Cmbox%7BE%7D_T%5Bm%28%5Chat%5Cbeta%2C%5Chat%5Cgamma%29R_f-1%5D%5C%5C+%5Cmbox%7BE%7D_T%5Bm%28%5Chat%5Cbeta%2C%5Chat%5Cgamma%29R%5E%7B%5Cmbox%7BHML%7D%7D%5D%5C%5C+%5Cmbox%7BE%7D_T%5Bm%28%5Chat%5Cbeta%2C%5Chat%5Cgamma%29R%5E%7B%5Cmbox%7BSMB%7D%7D%5D+%5Cend%7Barray%7D+%5Cright%5D%3D+%5Cleft%5B+%5Cbegin%7Barray%7D%7Bc%7D+0%5C%5C0+%5Cend%7Barray%7D+%5Cright%5D&quot; alt=&quot;\left[ \begin{array}{cccc} 1&amp;amp;0&amp;amp;0&amp;amp;0\\ 0&amp;amp;1&amp;amp;0&amp;amp;0 \end{array} \right] \left[ \begin{array}{l} \mbox{E}_T[m(\hat\beta,\hat\gamma)R^e_m]\\ \mbox{E}_T[m(\hat\beta,\hat\gamma)R_f-1]\\ \mbox{E}_T[m(\hat\beta,\hat\gamma)R^{\mbox{HML}}]\\ \mbox{E}_T[m(\hat\beta,\hat\gamma)R^{\mbox{SMB}}] \end{array} \right]= \left[ \begin{array}{c} 0\\0 \end{array} \right]&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;在这个矩阵  &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt;  中，我们令市场超额收益和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=R_f+&quot; alt=&quot;R_f &quot; eeimg=&quot;1&quot;/&gt; 完美满足两个 sample moment conditions，并由此进行 CCAPM 的参数估计，求出两个参数，然后使用另外两个资产 HML 和 SMB 来检验 CCAPM。由 GMM 框架可知，最终的 chi-squared test statistic 的自由度为 2（因为一共 4 个资产，2 个被用来估计参数），因此联合检验的实际上正是 HML 和 SMB 在 CCAPM 这个定价模型下的 pricing errors。如果 pricing errors 联合显著不为零，那么就可以拒绝 CCAPM。这个例子说明，&lt;b&gt;从经济学原理出发选择合适的 a 或 W 能让我们回答最感兴趣的经济学问题。&lt;/b&gt;GMM 的强大之处正在于此。&lt;/p&gt;&lt;p&gt;纯从统计学的角度来说， &lt;img src=&quot;https://www.zhihu.com/equation?tex=W+%3D+S%5E%7B-1%7D&quot; alt=&quot;W = S^{-1}&quot; eeimg=&quot;1&quot;/&gt; 确实能够得到 efficient GMM。但不要忘记，这个 efficient 的是以给定的 moments 为前提的 —— 如果换了或者添加了更多的 moments，参数的 efficient 估计也会发生变化。在金融市场中，有无数的资产，包括股票、债券、外汇、商品等，还有无数的投资组合，这些资产可以构成无数的 moments。为了 efficiency，我们应该把这成千上万资产的 moments 都塞进 GMM 才能得到 efficient 的估计。但显然，从业务的角度来说这毫无意义。在研究资产定价的时候，我们应该使用最“clever”的资产，比如 HML、SMB 这些投资组合。它们才是我们真正关心的问题。&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;The quest for efficiency doesn&amp;#39;t really drive us as much as the quest for something that is robust and that expresses what the model is supposed to do. —— John Cochrane&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;b&gt;GMM 非常好使，但在 asset pricing 的研究中，我们不应追求使用 GMM 进行一个仅在统计上正式但模型却缺乏含义的 statistical test。GMM 的强大在于它让我们从经济学和金融学原理出发，去 measure 和 estimate 最合理的模型、并同时对 sampling error 保持足够的认识。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;不要让 GMM 成为计量学的黑箱。&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;08 结语&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;呼！终于写完了！感谢你看到这里！&lt;/p&gt;&lt;p&gt;作为感谢，上点硬货 —— GMM 的 formula sheet（出自 Cochrane 2005）。它总结了前文解读的每一个公式。网上能找到的 Asset Pricing 的电子版还是 2000 年 6 月的版本，有不少 Typo。这张截图是来自 2005 年的修订版。怎么样？&lt;b&gt;GMM 其实并不复杂，我们只需要提供并计算 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;，&lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;，&lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=d+&quot; alt=&quot;d &quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;和 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;；有了它们，GMM 框架 takes care of everything else！&lt;/b&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-3dae1f9979c74ebe0a02ae47a70661cc_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;993&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-3dae1f9979c74ebe0a02ae47a70661cc_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-3dae1f9979c74ebe0a02ae47a70661cc_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;993&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-3dae1f9979c74ebe0a02ae47a70661cc_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-3dae1f9979c74ebe0a02ae47a70661cc_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;最后对全文简要总结如下：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;b&gt;GMM 的框架下包括 model、estimate 以及 test 三部分；它用 sample moments 代替 population moments 来检验后者；GMM 涉及的数学（不那么严谨的说）可以归结为 the variance of the sample mean + delta method。&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;从 notation 的角度，我们只需找到 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;、&lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;、&lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt; 和 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;，剩下的交给 GMM 的公式；&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;GMM 允许我们自由挑选矩阵 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;（或 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=W&quot; alt=&quot;W&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;）；从统计学的角度存在一个特定的 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;（或 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=W&quot; alt=&quot;W&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;）是最 efficient 的；但 GMM 不应被当作计量学的黑箱，理解你所研究的问题永远是最重要的。&lt;/b&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;写完本文，我的感受和写完&lt;a href=&quot;https://zhuanlan.zhihu.com/p/40984029&quot; class=&quot;internal&quot;&gt;《股票多因子模型的回归检验》&lt;/a&gt;是一模一样的，对 Cochrane 教授崇拜的五体投地。关于 GMM 的内容，Cochrane 教授在其 UChicago 的课程中介绍的非常生动、到位，听完再结合他的书仔细体会，那收获就一个字 —— 爽！&lt;/p&gt;&lt;p&gt;最后，我想用和&lt;a href=&quot;https://zhuanlan.zhihu.com/p/40984029&quot; class=&quot;internal&quot;&gt;《股票多因子模型的回归检验》&lt;/a&gt;一文同样的结语作为本文的收尾。在介绍 Asset Pricing 这门课的时候，Cochrane 教授谈到：&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;The math in real, academic, finance is not actually that hard. Understanding how to use the equations, and see what they really mean about the world... that&amp;#39;s hard, and that&amp;#39;s what I hope will be uniquely rewarding about this class.&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;再一次的，我也真心希望本文在你理解 GMM 以及应用它研究 asset pricing 的道路上起到一点点帮助。&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;参考文献&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Cochrane, J. H (2005). &lt;i&gt;Asset Pricing (revised edition)&lt;/i&gt;. Princeton University Press.&lt;/li&gt;&lt;li&gt;Fama, E. F. and K. R. French (1993). Common Risk Factors in the Returns on Stocks and Bonds. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 33(1), 3 – 56.&lt;/li&gt;&lt;li&gt;Hansen, L. P. (1982). Large sample properties of generalized method of moments estimators. &lt;i&gt;Econometrica&lt;/i&gt;, Vol. 50(4), 1029 – 1054.&lt;/li&gt;&lt;li&gt;Newey, W. K. and K. D. West (1987). A simple, positive semi-definite, heteroskedasticity and autocorrelation consistent covariance matrix. &lt;i&gt;Econometrica&lt;/i&gt;, Vol. 55(3), 703 – 708.&lt;/li&gt;&lt;li&gt;White, H. (1980). A heteroskedasticity-consistent covariance matrix estimator and a direct test for heteroskedasticity. &lt;i&gt;Econometrica&lt;/i&gt;, Vol. 48(4), 817 – 838.&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;免责声明：&lt;/b&gt;文章内容不可视为投资意见。市场有风险，入市需谨慎。&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处。已委托“维权骑士”(&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//rightknights.com/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;维权骑士_免费版权监测/版权保护/内容多平台分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2020-01-27-92490417</guid>
<pubDate>Mon, 27 Jan 2020 00:00:00 +0800</pubDate>
</item>
<item>
<title>前景理论与股票收益 (I)</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2020-01-20-103548438.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/103548438&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-3b01a76c41fea4c4efe774246d41913e_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;摘要&lt;/b&gt;&lt;/p&gt;&lt;p&gt;Barberis, Mukherjee, and Wang (2016) 使用累积前景理论构建了一个因子。在控制了常见变量后，该因子仍然能够获得显著的风险溢价。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;01 引言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;行为金融学向来备受争议。&lt;/p&gt;&lt;p&gt;近日，有效市场假说之父 Eugene Fama 在接受 Bloomberg 采访（&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653295869%26idx%3D1%26sn%3D1f90e26f8cebf04ec55832364180bc6f%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;此处有介绍&lt;/a&gt;）的时候再次抛出了他一贯的观点：&lt;/p&gt;&lt;blockquote&gt;&lt;b&gt;&lt;i&gt;There is no behavioral finance.&lt;/i&gt;&lt;/b&gt; &lt;i&gt;It’s all just a criticism of efficient markets, with no evidence.&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;一石激起千层浪。面对如此评价，有人当然“坐不住”了。行为经济学的代表人物，Eugene Fama 的同事 Richard Thaler 就站出来发 Twitter，以一贯的 Thaler 式幽默进行了回应，还顺手把 Fama 的老搭档 French 也捎上了（红色桃心暴露了我点了个赞……）：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-747379bbebac4c29c40379ef4d818112_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;593&quot; data-rawheight=&quot;227&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;593&quot; data-original=&quot;https://pic3.zhimg.com/v2-747379bbebac4c29c40379ef4d818112_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-747379bbebac4c29c40379ef4d818112_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;593&quot; data-rawheight=&quot;227&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;593&quot; data-original=&quot;https://pic3.zhimg.com/v2-747379bbebac4c29c40379ef4d818112_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-747379bbebac4c29c40379ef4d818112_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;如果“争议”到此就结束了，那我们未免太小看学术圈了。面对 Fama 和 Thaler 的神仙打架，另一位大咖也站出来发声，他就是 q-factor model 的作者之一张橹教授，而这一次张教授挺 Fama。由于 q-factor model 和 Fama-French 五因子模型之间的瓜葛（见&lt;a href=&quot;https://zhuanlan.zhihu.com/p/82233089&quot; class=&quot;internal&quot;&gt;《q-factor model 往事》&lt;/a&gt;），很难想象会有这样的局面。但正所谓“敌人的敌人就是我的朋友”，对行为金融学的不屑使得张教授这次也站在了 Fama 一边：&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;In Thaler’s tweet, he claims that Gene [Fama] owes him everything. I think Dick [Thaler] got the chronology exactly backward. Gene founded modern finance with EMH, against which Dick has successfully built his entire career. If anything, Dick owes Gene everything.&lt;/i&gt; &lt;i&gt;&lt;b&gt;I, on the other hand, owe much of my career to behavioral finance, whose tremendously important empirical contributions, with little in the way of theory, have left a glaring gulf for a theory-minded economist to fill.&lt;/b&gt;&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;注意上面加粗的最后一句。张教授认为行为金融学虽然有着大量的实证结果，但是却缺乏理论的支撑，从而造成了理论和实际之间的巨大鸿沟，而这个鸿沟则留给传统金融学的学者们（比如他自己）去消除。&lt;/p&gt;&lt;p&gt;好吧。&lt;/p&gt;&lt;p&gt;不管大神们怎么看，这不妨碍我们学习并将行为金融学应用于股票市场。颇有意思的是，一篇 2019 年底挂到 SSRN 上的文章针对美股比较了不同类型的策略，包括利用行为金融学的策略和基于基本面的策略（下图）。该文发现只有利用反应过度和反应不足能够战胜指数本身，并“吊打”其他类策略。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-dd7a06a56076f264000fd6e357179f57_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;764&quot; data-rawheight=&quot;583&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;764&quot; data-original=&quot;https://pic4.zhimg.com/v2-dd7a06a56076f264000fd6e357179f57_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-dd7a06a56076f264000fd6e357179f57_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;764&quot; data-rawheight=&quot;583&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;764&quot; data-original=&quot;https://pic4.zhimg.com/v2-dd7a06a56076f264000fd6e357179f57_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-dd7a06a56076f264000fd6e357179f57_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;谈到行为金融学里面的众多模型，我个人最喜欢的当属前景理论。而要论将前景理论和股票收益率相结合的研究，代表人物之一非 Nicholas Barberis 莫属。他和他的许多合作者在顶刊上发表了很多论文，研究前景理论能否预测股票收益率的截面差异，读来令人很有启发。因此，我计划不定期的介绍和实证 Barberis 的相关论文，而今天就是第一步，这就是本文题目中 (I) 的含义。&lt;/p&gt;&lt;p&gt;今天要聊的这篇文章是发表在 RFS 上的 Barberis, Mukherjee, and Wang (2016)。该文使用累积前景理论提出了一个因子，它能很好的解释股票预期收益率的截面差异。此外，在控制了传统的风格因子 —— 如 BM、Size、动量、长期反转 —— 和常见的风险类因子 —— 如偏度、异质波动率、流动性风险等 —— 之后，基于前景理论的因子仍然有效。Barberis, Mukherjee, and Wang (2016) 将该因子应用于美股和全球其他 46 个国家（包括 A 股），均发现了类似的现象。&lt;/p&gt;&lt;p&gt;以下第二节首先介绍累积前景理论；第三节解读 Barberis, Mukherjee, and Wang (2016)；第四节针对 A 股进行简单实证分析；最后第五节总结。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;02 累积前景理论&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;前景理论（Prospect Theory）由心理学家 Daniel Kahneman 和 Amos Tversky 提出，是一个描述人如何在不确定下做决策的分析框架。前景理论研究的问题是当面对多个选项时，人如何评估不同的选项并选出他认为最优的。在我们的情境中，每支股票就是一个“选项”。而体现不确定性的是，每个选项都有 &lt;img src=&quot;https://www.zhihu.com/equation?tex=m+%E2%89%A5+1&quot; alt=&quot;m ≥ 1&quot; eeimg=&quot;1&quot;/&gt; 种结果，其中每个结果有一定的实现概率（比如股票收益率会有一个分布），人们需要依据每个选项可能出现的结果来计算该选项的价值，并选出价值最高的。&lt;/p&gt;&lt;p&gt;前文&lt;a href=&quot;https://zhuanlan.zhihu.com/p/38526672&quot; class=&quot;internal&quot;&gt;《获得诺奖的行为金融学是怎么一回事?》&lt;/a&gt;对前景理论做过系统的介绍，不过它是基于 Kahneman and Tversky (1979) 的版本。这个最早的版本假设了每个选项最多有两个非零结果。令  &lt;img src=&quot;https://www.zhihu.com/equation?tex=x&quot; alt=&quot;x&quot; eeimg=&quot;1&quot;/&gt;  和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=y&quot; alt=&quot;y&quot; eeimg=&quot;1&quot;/&gt; 代表某选项的两个非零结果， &lt;img src=&quot;https://www.zhihu.com/equation?tex=p&quot; alt=&quot;p&quot; eeimg=&quot;1&quot;/&gt;  和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=q&quot; alt=&quot;q&quot; eeimg=&quot;1&quot;/&gt; 分别代表它们发生的概率，则该选项在数学上可以描述为 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%28x%2C+p%3B+y%2C+q%29&quot; alt=&quot;(x, p; y, q)&quot; eeimg=&quot;1&quot;/&gt; 。&lt;/p&gt;&lt;p&gt;该符号的意思是“以概率  &lt;img src=&quot;https://www.zhihu.com/equation?tex=p&quot; alt=&quot;p&quot; eeimg=&quot;1&quot;/&gt;  获得结果  &lt;img src=&quot;https://www.zhihu.com/equation?tex=x&quot; alt=&quot;x&quot; eeimg=&quot;1&quot;/&gt; ，以概率  &lt;img src=&quot;https://www.zhihu.com/equation?tex=q&quot; alt=&quot;q&quot; eeimg=&quot;1&quot;/&gt;  获得结果 &lt;img src=&quot;https://www.zhihu.com/equation?tex=y&quot; alt=&quot;y&quot; eeimg=&quot;1&quot;/&gt; ”，且  &lt;img src=&quot;https://www.zhihu.com/equation?tex=x&quot; alt=&quot;x&quot; eeimg=&quot;1&quot;/&gt;  和  &lt;img src=&quot;https://www.zhihu.com/equation?tex=y&quot; alt=&quot;y&quot; eeimg=&quot;1&quot;/&gt;  满足 &lt;img src=&quot;https://www.zhihu.com/equation?tex=x+%E2%89%A4+0+%E2%89%A4+y&quot; alt=&quot;x ≤ 0 ≤ y&quot; eeimg=&quot;1&quot;/&gt; 或反过来 &lt;img src=&quot;https://www.zhihu.com/equation?tex=y+%E2%89%A4+0+%E2%89%A4+x&quot; alt=&quot;y ≤ 0 ≤ x&quot; eeimg=&quot;1&quot;/&gt; 。根据前景理论，人们赋予选项 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%28x%2C+p+%3B+y%2C+q%29&quot; alt=&quot;(x, p ; y, q)&quot; eeimg=&quot;1&quot;/&gt; 的价值为：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=v%28x%29%5Cpi%28p%29%2Bv%28y%29%5Cpi%28q%29&quot; alt=&quot;v(x)\pi(p)+v(y)\pi(q)&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;其中 &lt;img src=&quot;https://www.zhihu.com/equation?tex=v%28.%29&quot; alt=&quot;v(.)&quot; eeimg=&quot;1&quot;/&gt; 表示价值函数， &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%80%28.%29&quot; alt=&quot;π(.)&quot; eeimg=&quot;1&quot;/&gt; 表示权重函数。某个选项的价值就是其所有可能出现结果的价值的加权平均，反映了一种“预期”的概念，这也是前景理论中 prospect 一词的由来。对于每个选项，人们按上述公式计算其价值，然后在所有选项中选择价值最高的一个。前景理论的核心就是价值函数和权重函数（下图）。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-3b029f2dfc4cd987bfd96d0bd4b3839c_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;538&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-3b029f2dfc4cd987bfd96d0bd4b3839c_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-3b029f2dfc4cd987bfd96d0bd4b3839c_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;538&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-3b029f2dfc4cd987bfd96d0bd4b3839c_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-3b029f2dfc4cd987bfd96d0bd4b3839c_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;Kahneman and Tversky (1979) 之所以极具创造性和现实意义是因为二位作者通过大量的心理学实验定性总结了 v(.) 和 π(.) 所具备的性质。具体而言，价值函数有以下三个重要性质：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;结果  &lt;img src=&quot;https://www.zhihu.com/equation?tex=x&quot; alt=&quot;x&quot; eeimg=&quot;1&quot;/&gt;  —— 即得与失（gains and losses）——是相对一个给定的&lt;b&gt;参考点（reference）&lt;/b&gt;而言的，而主观价值 &lt;img src=&quot;https://www.zhihu.com/equation?tex=+v%28x%29&quot; alt=&quot; v(x)&quot; eeimg=&quot;1&quot;/&gt; 是  &lt;img src=&quot;https://www.zhihu.com/equation?tex=x&quot; alt=&quot;x&quot; eeimg=&quot;1&quot;/&gt;  的非线性函数。&lt;/li&gt;&lt;li&gt;价值函数的第二个特点是它反映了人们&lt;b&gt;损失厌恶（loss aversion）&lt;/b&gt;。价值函数 &lt;img src=&quot;https://www.zhihu.com/equation?tex=v%28.%29&quot; alt=&quot;v(.)&quot; eeimg=&quot;1&quot;/&gt; 在 &lt;img src=&quot;https://www.zhihu.com/equation?tex=x%3D0&quot; alt=&quot;x=0&quot; eeimg=&quot;1&quot;/&gt; 左、右两侧并不对称，亏损部分的负增长快于收益部分的正增长： &lt;img src=&quot;https://www.zhihu.com/equation?tex=v%28x%29+%3C+-v%28-x%29&quot; alt=&quot;v(x) &amp;lt; -v(-x)&quot; eeimg=&quot;1&quot;/&gt; 。实证研究表明，亏损带来的痛苦是收益带来快乐的两倍左右。&lt;/li&gt;&lt;li&gt;无论是获利还是亏损，价值函数均呈现出&lt;b&gt;敏感度递减（diminishing sensitivity）&lt;/b&gt;。这意味着，当结果为获利时，价值函数为凹函数；当结果为亏损时，价值函数为凸函数。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;前景理论中的第二个关键是权重函数 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%80%28.%29&quot; alt=&quot;π(.)&quot; eeimg=&quot;1&quot;/&gt; ，它是某结果发生概率  &lt;img src=&quot;https://www.zhihu.com/equation?tex=p&quot; alt=&quot;p&quot; eeimg=&quot;1&quot;/&gt;  的函数，但它不是概率。它是在计算选项价值时，每个结果的权重。Kahneman and Tversky (1979) 指出 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%80%28p%29&quot; alt=&quot;π(p)&quot; eeimg=&quot;1&quot;/&gt; 应满足 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%80%280%29+%3D+0&quot; alt=&quot;π(0) = 0&quot; eeimg=&quot;1&quot;/&gt; 且 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%80%281%29+%3D+1&quot; alt=&quot;π(1) = 1&quot; eeimg=&quot;1&quot;/&gt; ，但是当 &lt;img src=&quot;https://www.zhihu.com/equation?tex=0+%3C+p+%3C+1&quot; alt=&quot;0 &amp;lt; p &amp;lt; 1&quot; eeimg=&quot;1&quot;/&gt; 时， &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%80%28p%29&quot; alt=&quot;π(p)&quot; eeimg=&quot;1&quot;/&gt; 是  &lt;img src=&quot;https://www.zhihu.com/equation?tex=p&quot; alt=&quot;p&quot; eeimg=&quot;1&quot;/&gt;  的非线性函数。上图右侧定性给出了当 &lt;img src=&quot;https://www.zhihu.com/equation?tex=0+%3C+p+%3C+1&quot; alt=&quot;0 &amp;lt; p &amp;lt; 1&quot; eeimg=&quot;1&quot;/&gt; 时 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%80%28p%29&quot; alt=&quot;π(p)&quot; eeimg=&quot;1&quot;/&gt; 的样子。当  &lt;img src=&quot;https://www.zhihu.com/equation?tex=p&quot; alt=&quot;p&quot; eeimg=&quot;1&quot;/&gt;  很小时， &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%80%28p%29+%3E+p&quot; alt=&quot;π(p) &amp;gt; p&quot; eeimg=&quot;1&quot;/&gt; ，表明对于那些发生概率很低的结果，人们往往高估它们发生的可能性。&lt;b&gt;人们倾向于高估尾部事件发生的概率正是权重函数最重要的性质。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;在生活中人们购买彩票和购买保险就是这样的例子。假设一张彩票 5 块钱，而买了彩票后有千分之一的机会得到 5000。人们往往会放大这个千分之一的可能性、从而认为彩票的吸引力很高，尽管彩票的预期收益也是 5 块钱，和成本一样。而在买保险时，假如 5 元保费可以规避一个损失 5000 元、发生概率千分之一的事故。在面对这种情况时，人们往往毫不犹豫选择购买保险，因为他们同样高估了事故发生的概率。&lt;/p&gt;&lt;p&gt;Kahneman and Tversky (1979) 提出的前景理论后来被视作行为金融学发展的重要基石之一。然而，这篇 1979 年的论文也并不完美。第一，它只允许待评估的选项有不超过两个非零的结果；第二，无论是价值函数还是权重函数，该文给出的都是定性、而非定量的结果。为了解决这些不完美，Tversky and Kahneman (1992) 对前景理论进行了改良和扩充，提出了累积前景理论（Cumulative Prospect Theory）。&lt;/p&gt;&lt;p&gt;这里插一小段颇具人情味的故事。由于 Tversky 太天才，他的学术道路发展得顺风顺水，但是 Kahneman 却一度陷入低迷，导致到了后期这老哥俩有些貌合神离。累积前景理论几乎是由 Tversky 一手开创的，但它的发表还是以两人为共同作者。谈到此，Tversky 曾表示，我们两个一起发表了很多论文，如果这篇打破了传统就会显得怪怪的。&lt;b&gt;人生是吧，得一如 Tversky 这样的学术知己足矣。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;言归正传。Tversky and Kahneman (1992) 给出了 &lt;img src=&quot;https://www.zhihu.com/equation?tex=v%28.%29&quot; alt=&quot;v(.)&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%80%28.%29&quot; alt=&quot;π(.)&quot; eeimg=&quot;1&quot;/&gt; 的解析表达式，且允许待评估的选项有多个结果。假设某个选项有 &lt;img src=&quot;https://www.zhihu.com/equation?tex=m&quot; alt=&quot;m&quot; eeimg=&quot;1&quot;/&gt; 个亏损的结果 &lt;img src=&quot;https://www.zhihu.com/equation?tex=x_%7B-m%7D+%3C+x_%7B-m-1%7D+%3C+%E2%80%A6+%3C+x_%7B-1%7D&quot; alt=&quot;x_{-m} &amp;lt; x_{-m-1} &amp;lt; … &amp;lt; x_{-1}&quot; eeimg=&quot;1&quot;/&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=n&quot; alt=&quot;n&quot; eeimg=&quot;1&quot;/&gt; 个盈利的结果 &lt;img src=&quot;https://www.zhihu.com/equation?tex=x_1+%3C+x_2+%3C+%E2%80%A6+%3C+x_n&quot; alt=&quot;x_1 &amp;lt; x_2 &amp;lt; … &amp;lt; x_n&quot; eeimg=&quot;1&quot;/&gt; 、以及（不失一般性）一个不赢不亏的结果 &lt;img src=&quot;https://www.zhihu.com/equation?tex=x_0+%3D+0&quot; alt=&quot;x_0 = 0&quot; eeimg=&quot;1&quot;/&gt; 。进一步假设 &lt;img src=&quot;https://www.zhihu.com/equation?tex=x_i&quot; alt=&quot;x_i&quot; eeimg=&quot;1&quot;/&gt; 发生的概率为 &lt;img src=&quot;https://www.zhihu.com/equation?tex=p_i&quot; alt=&quot;p_i&quot; eeimg=&quot;1&quot;/&gt; ，且 &lt;img src=&quot;https://www.zhihu.com/equation?tex=p_i&quot; alt=&quot;p_i&quot; eeimg=&quot;1&quot;/&gt; 满足 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Csum+p_i+%3D+1&quot; alt=&quot;\sum p_i = 1&quot; eeimg=&quot;1&quot;/&gt; 。在累积前景理论下，该选项可以表达为：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%28x_%7B-m%7D%2Cp_%7B-m%7D%3B%5Ccdots+x_%7B-1%7D%2Cp_%7B-1%7D%3Bx_0%2Cp_0%3Bx_1%2Cp_1%2C%5Ccdots%2Cx_n%2Cp_n%29&quot; alt=&quot;(x_{-m},p_{-m};\cdots x_{-1},p_{-1};x_0,p_0;x_1,p_1,\cdots,x_n,p_n)&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;该选项的价值为：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Csum_%7Bi%3D-m%7D%5En%5Cpi_i%28x_i%29v%28x_i%29&quot; alt=&quot;\displaystyle\sum_{i=-m}^n\pi_i(x_i)v(x_i)&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;对于价值函数，Tversky and Kahneman (1992) 给出的形式为：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=v%28x_i%29%3D%5Cleft%5C%7B+%5Cbegin%7Barray%7D%7Bll%7D+%5Cdisplaystyle+x_i%5E%7B%5Calpha%7D%26%5Cmbox%7Bif+%7Dx_i%5Cge+0%5C%5C+%5Cdisplaystyle+-%5Clambda%28-x_i%29%5E%7B%5Calpha%7D%26%5Cmbox%7Bif+%7Dx_i%3C0+%5Cend%7Barray%7D+%5Cright.+&quot; alt=&quot;v(x_i)=\left\{ \begin{array}{ll} \displaystyle x_i^{\alpha}&amp;amp;\mbox{if }x_i\ge 0\\ \displaystyle -\lambda(-x_i)^{\alpha}&amp;amp;\mbox{if }x_i&amp;lt;0 \end{array} \right. &quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;由上述定义可知， &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B1+%5Cin+%280%2C1%29&quot; alt=&quot;α \in (0,1)&quot; eeimg=&quot;1&quot;/&gt; 代表了敏感度递减的快慢，而 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%BB+%3E+1&quot; alt=&quot;λ &amp;gt; 1&quot; eeimg=&quot;1&quot;/&gt; 是损失厌恶系数、越高说明越厌恶损失。下图左侧给出了当 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B1+%3D+0.5&quot; alt=&quot;α = 0.5&quot; eeimg=&quot;1&quot;/&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%BB+%3D+2.5&quot; alt=&quot;λ = 2.5&quot; eeimg=&quot;1&quot;/&gt; 时的价值函数。在实际应用中，Tversky and Kahneman (1992) 根据他们的实验给出的参数取值为 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B1+%3D+0.88&quot; alt=&quot;α = 0.88&quot; eeimg=&quot;1&quot;/&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%BB+%3D+2.25&quot; alt=&quot;λ = 2.25&quot; eeimg=&quot;1&quot;/&gt; 。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-c9efecfe684e579476b4a3151b710e63_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;851&quot; data-rawheight=&quot;515&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;851&quot; data-original=&quot;https://pic4.zhimg.com/v2-c9efecfe684e579476b4a3151b710e63_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-c9efecfe684e579476b4a3151b710e63_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;851&quot; data-rawheight=&quot;515&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;851&quot; data-original=&quot;https://pic4.zhimg.com/v2-c9efecfe684e579476b4a3151b710e63_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-c9efecfe684e579476b4a3151b710e63_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;再来看看累积前景理论中的权重函数。它的定义为：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Bequation%7D+%5Clabel%7Beq%3Acpt+pi%7D+%5Cbegin%7Barray%7D%7Brll%7D+%5Cpi%28x_i%29%26%3D%26%5Cleft%5C%7B+%5Cbegin%7Barray%7D%7Bll%7D+%5Cdisplaystyle+w%5E%2B%28p_i%2B%5Ccdots%2Bp_n%29-w%5E%2B%28p_%7Bi%2B1%7D%2B%5Ccdots%2Bp_n%29%26%5Cmbox%7Bif+%7D0%5Cle+i+%5Cle+n%5C%5C+%5Cdisplaystyle+w%5E-%28p_%7B-m%7D%2B%5Ccdots%2Bp_i%29-w%5E-%28p_%7B-m%7D%2B%5Ccdots%2Bp_%7Bi-1%7D%29%26%5Cmbox%7Bif+%7D-m%5Cle+i+%3C0+%5Cend%7Barray%7D+%5Cright.%5C%5C%5C%5C+w%5E%2B%28P%29+%26%3D%26%5Cdisplaystyle%5Cfrac%7BP%5E%5Cgamma%7D%7B%28%5Cdisplaystyle+P%5E%5Cgamma%2B%281-P%29%5E%5Cgamma%29%5E%7B%281%2F%5Cgamma%29%7D%7D%5C%5C+w%5E-%28P%29+%26%3D%26%5Cdisplaystyle%5Cfrac%7BP%5E%5Cdelta%7D%7B%28%5Cdisplaystyle+P%5E%5Cdelta%2B%281-P%29%5E%5Cdelta%29%5E%7B%281%2F%5Cdelta%29%7D%7D++%5Cend%7Barray%7D+%5Cend%7Bequation%7D+&quot; alt=&quot;\begin{equation} \label{eq:cpt pi} \begin{array}{rll} \pi(x_i)&amp;amp;=&amp;amp;\left\{ \begin{array}{ll} \displaystyle w^+(p_i+\cdots+p_n)-w^+(p_{i+1}+\cdots+p_n)&amp;amp;\mbox{if }0\le i \le n\\ \displaystyle w^-(p_{-m}+\cdots+p_i)-w^-(p_{-m}+\cdots+p_{i-1})&amp;amp;\mbox{if }-m\le i &amp;lt;0 \end{array} \right.\\\\ w^+(P) &amp;amp;=&amp;amp;\displaystyle\frac{P^\gamma}{(\displaystyle P^\gamma+(1-P)^\gamma)^{(1/\gamma)}}\\ w^-(P) &amp;amp;=&amp;amp;\displaystyle\frac{P^\delta}{(\displaystyle P^\delta+(1-P)^\delta)^{(1/\delta)}}  \end{array} \end{equation} &quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;式中 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B3%2C+%CE%B4+%E2%88%88+%280%2C+1%29&quot; alt=&quot;γ, δ ∈ (0, 1)&quot; eeimg=&quot;1&quot;/&gt; 。在以上定义中，当 &lt;img src=&quot;https://www.zhihu.com/equation?tex=i+%3D+n&quot; alt=&quot;i = n&quot; eeimg=&quot;1&quot;/&gt; 或 &lt;img src=&quot;https://www.zhihu.com/equation?tex=-m&quot; alt=&quot;-m&quot; eeimg=&quot;1&quot;/&gt; 时，权重函数分别简化为  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%80%28x_n%29%3Dw%5E%2B%28p_n%29&quot; alt=&quot;π(x_n)=w^+(p_n)&quot; eeimg=&quot;1&quot;/&gt;  和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%80%28x_%7B-m%7D%29%3Dw%5E-%28p_%7B-m%7D%29&quot; alt=&quot;π(x_{-m})=w^-(p_{-m})&quot; eeimg=&quot;1&quot;/&gt; 。与前景理论不同，在累积前景理论中， &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%80%28x_i%29&quot; alt=&quot;π(x_i)&quot; eeimg=&quot;1&quot;/&gt; 的取值由累积权重函数 &lt;img src=&quot;https://www.zhihu.com/equation?tex=w%5E%2B%28.%29&quot; alt=&quot;w^+(.)&quot; eeimg=&quot;1&quot;/&gt; 或  &lt;img src=&quot;https://www.zhihu.com/equation?tex=w%5E-%28.%29&quot; alt=&quot;w^-(.)&quot; eeimg=&quot;1&quot;/&gt; 决定。对于 &lt;img src=&quot;https://www.zhihu.com/equation?tex=x_i+%E2%89%A5+0&quot; alt=&quot;x_i ≥ 0&quot; eeimg=&quot;1&quot;/&gt; 的结果， &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%80%28x_i%29&quot; alt=&quot;π(x_i)&quot; eeimg=&quot;1&quot;/&gt; 的计算方法如下：分别计算所有&lt;b&gt;不差于&lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=x_i&quot; alt=&quot;x_i&quot; eeimg=&quot;1&quot;/&gt; 的结果的概率之和（即 &lt;img src=&quot;https://www.zhihu.com/equation?tex=p_i+%2B+%E2%80%A6+%2B+p_n&quot; alt=&quot;p_i + … + p_n&quot; eeimg=&quot;1&quot;/&gt; ），和所有&lt;b&gt;严格优于&lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=x_i&quot; alt=&quot;x_i&quot; eeimg=&quot;1&quot;/&gt; 的结果的概率之和（即 &lt;img src=&quot;https://www.zhihu.com/equation?tex=p_%7Bi%2B1%7D+%2B+%E2%80%A6+%2B+p_n&quot; alt=&quot;p_{i+1} + … + p_n&quot; eeimg=&quot;1&quot;/&gt; ），将这两个概率之和代入 &lt;img src=&quot;https://www.zhihu.com/equation?tex=w%5E%2B%28.%29&quot; alt=&quot;w^+(.)&quot; eeimg=&quot;1&quot;/&gt; 并求它们的差，即 &lt;img src=&quot;https://www.zhihu.com/equation?tex=w%5E%2B%28p_i+%2B+%E2%80%A6+%2B+p_n%29+-+w%5E%2B%28p_%7Bi%2B1%7D+%2B+%E2%80%A6+%2B+p_n%29&quot; alt=&quot;w^+(p_i + … + p_n) - w^+(p_{i+1} + … + p_n)&quot; eeimg=&quot;1&quot;/&gt; ，这个差就是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%80%28x_i%29&quot; alt=&quot;π(x_i)&quot; eeimg=&quot;1&quot;/&gt; 。按照类似的方法可以解释 &lt;img src=&quot;https://www.zhihu.com/equation?tex=x_i+%3C+0&quot; alt=&quot;x_i &amp;lt; 0&quot; eeimg=&quot;1&quot;/&gt; 时 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%80%28x_i%29&quot; alt=&quot;π(x_i)&quot; eeimg=&quot;1&quot;/&gt; 的计算方法。&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=w%5E%2B%28.%29&quot; alt=&quot;w^+(.)&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=w%5E-%28.%29&quot; alt=&quot;w^-(.)&quot; eeimg=&quot;1&quot;/&gt; 的形式相同，只是分别由参数  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B3&quot; alt=&quot;γ&quot; eeimg=&quot;1&quot;/&gt;  和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B4&quot; alt=&quot;δ&quot; eeimg=&quot;1&quot;/&gt; 决定，从而允许人们对于盈利和亏损结果赋予不同的权重。Tversky and Kahneman (1992) 给出的参数取值为 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B3+%3D+0.61&quot; alt=&quot;γ = 0.61&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B4+%3D+0.69&quot; alt=&quot;δ = 0.69&quot; eeimg=&quot;1&quot;/&gt; 。由定义可知： &lt;img src=&quot;https://www.zhihu.com/equation?tex=w%5E%2B%280%29+%3D+w%5E-%280%29+%3D+0&quot; alt=&quot;w^+(0) = w^-(0) = 0&quot; eeimg=&quot;1&quot;/&gt; 且 &lt;img src=&quot;https://www.zhihu.com/equation?tex=w%5E%2B%281%29+%3D+w%5E-%281%29+%3D+1&quot; alt=&quot;w^+(1) = w^-(1) = 1&quot; eeimg=&quot;1&quot;/&gt; 。上图右侧给出了不同 δ 取值下权重函数的形状。&lt;/p&gt;&lt;p&gt;累积前景理论中的权重函数延续了早先版本中权重函数的重要特征，即对于小概率结果，其权重要高于结果发生的概率本身。由于累积前景理论允许盈利和亏损两端都有多个结果，这意味着&lt;b&gt;人们会高估结果分布两端的尾部出现的概率。&lt;/b&gt;由定义可知，对于极端收益结果 &lt;img src=&quot;https://www.zhihu.com/equation?tex=x_n&quot; alt=&quot;x_n&quot; eeimg=&quot;1&quot;/&gt; 和极端亏损结果 &lt;img src=&quot;https://www.zhihu.com/equation?tex=x_%7B-m%7D&quot; alt=&quot;x_{-m}&quot; eeimg=&quot;1&quot;/&gt; ，它们的权重为 &lt;img src=&quot;https://www.zhihu.com/equation?tex=w%5E%2B%28p_n%29&quot; alt=&quot;w^+(p_n)&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=w%5E-%28p_%7B-m%7D%29&quot; alt=&quot;w^-(p_{-m})&quot; eeimg=&quot;1&quot;/&gt; 。假设 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B3+%3D+%CE%B4+%3D+0.65&quot; alt=&quot;γ = δ = 0.65&quot; eeimg=&quot;1&quot;/&gt; ，并假设 &lt;img src=&quot;https://www.zhihu.com/equation?tex=x_n&quot; alt=&quot;x_n&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=x_%7B-m%7D&quot; alt=&quot;x_{-m}&quot; eeimg=&quot;1&quot;/&gt; 出现的概率均为 0.01。由公式可知， &lt;img src=&quot;https://www.zhihu.com/equation?tex=w%5E%2B%28p_n%29+%3D+w%5E-%28p_%7B-m%7D%29+%3D+0.047&quot; alt=&quot;w^+(p_n) = w^-(p_{-m}) = 0.047&quot; eeimg=&quot;1&quot;/&gt; ，因此 &lt;img src=&quot;https://www.zhihu.com/equation?tex=w%5E%2B%28p_n%29+%3E+p_n&quot; alt=&quot;w^+(p_n) &amp;gt; p_n&quot; eeimg=&quot;1&quot;/&gt; 且 &lt;img src=&quot;https://www.zhihu.com/equation?tex=w%5E-%28p_%7B-m%7D%29+%3E+p_%7B-m%7D&quot; alt=&quot;w^-(p_{-m}) &amp;gt; p_{-m}&quot; eeimg=&quot;1&quot;/&gt; 。关于 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%80%28x_i%29&quot; alt=&quot;π(x_i)&quot; eeimg=&quot;1&quot;/&gt; ，第二点需要指出的是，如果一个选项的结果都是盈利（即所有 &lt;img src=&quot;https://www.zhihu.com/equation?tex=x_i&quot; alt=&quot;x_i&quot; eeimg=&quot;1&quot;/&gt; 均大于零）或都是亏损（即所有 &lt;img src=&quot;https://www.zhihu.com/equation?tex=x_i&quot; alt=&quot;x_i&quot; eeimg=&quot;1&quot;/&gt; 均小于零），则该选项所有结果的权重函数满足所有 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%80%28x_i%29&quot; alt=&quot;π(x_i)&quot; eeimg=&quot;1&quot;/&gt; 之和为 1。然而，对于更一般的情况，即某个选项既有盈利结果又有亏损结果时，所有结果的权重之和并不一定等于 1，它可能大于 1 也可能小于 1，但这并不影响累积前景理论的性质或应用。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;03 Barberis, Mukherjee, and Wang (2016)&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;价值函数的三大特征：相对参考点而言、损失厌恶、敏感度递减，以及权重函数的重要特征：人们高估尾部事件发生概率，这四点构成了前景理论的核心内容。Barberis 教授指出，要想利用前景理论分析股票收益率，那么应该尽可能的考虑上述全部要素。&lt;/p&gt;&lt;p&gt;为了应用累积前景理论解释股票收益率，有两个问题需要解决：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;预测股票未来的收益率分布，并以此作为该选项（每个股票就是一个选项）结果的分布；&lt;/li&gt;&lt;li&gt;将选项结果分布代入累积前景理论的价值和权重函数，计算其价值，并研究股票的前景理论价值与未来收益率之间的关系。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;关于第一点，预测未来收益率基本上是 mission impossible。Barberis, Mukherjee, and Wang (2016) 指出，&lt;b&gt;普通投资者会使用股票过去五年的历史月收益率（即 60 个样本点）分布作为替代物。&lt;/b&gt;在这样的设定下，Barberis, Mukherjee, and Wang (2016) 将股票过去 60 个月的月频收益率按从小到大排列，记为 &lt;img src=&quot;https://www.zhihu.com/equation?tex=r_%7B-m%7D%2C+r_%7B-m%2B1%7D%2C+%E2%80%A6%2C+r_%7Bn-1%7D%2C+r_%7Bn%7D&quot; alt=&quot;r_{-m}, r_{-m+1}, …, r_{n-1}, r_{n}&quot; eeimg=&quot;1&quot;/&gt; ，并假设每个结果发生的概率是 1/60。使用累积前景理论的数学符号，每个股票的结果分布可以表达为：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Cleft%28r_%7B-m%7D%2C%5Cfrac%7B1%7D%7B60%7D%3Br_%7B-m%2B1%7D%2C%5Cfrac%7B1%7D%7B60%7D%3B%5Ccdots%3Br_%7B-1%7D%2C%5Cfrac%7B1%7D%7B60%7D%3Br_%7B1%7D%2C%5Cfrac%7B1%7D%7B60%7D%3B%5Ccdots%3Br_%7Bn-1%7D%2C%5Cfrac%7B1%7D%7B60%7D%3Br_%7Bn%7D%2C%5Cfrac%7B1%7D%7B60%7D%5Cright%29&quot; alt=&quot;\displaystyle\left(r_{-m},\frac{1}{60};r_{-m+1},\frac{1}{60};\cdots;r_{-1},\frac{1}{60};r_{1},\frac{1}{60};\cdots;r_{n-1},\frac{1}{60};r_{n},\frac{1}{60}\right)&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;将其代入前景理论的价值和权重函数就得到每支股票的 TK 价值：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Br%7D+%5Cdisplaystyle%5Cmbox%7BTK%7D%5Cequiv%5Csum_%7Bi%3D-m%7D%5E%7B-1%7Dv%28r_i%29%5Cleft%5Bw%5E-%5Cleft%28%5Cfrac%7Bi%2Bm%2B1%7D%7B60%7D%5Cright%29-w%5E-%5Cleft%28%5Cfrac%7Bi%2Bm%7D%7B60%7D%5Cright%29%5Cright%5D%5C%5C+%2B%5Cdisplaystyle+%5Csum_%7Bi%3D1%7D%5E%7Bn%7Dv%28r_i%29%5Cleft%5Bw%5E%2B%5Cleft%28%5Cfrac%7Bn-i%2B1%7D%7B60%7D%5Cright%29-w%5E%2B%5Cleft%28%5Cfrac%7Bn-i%7D%7B60%7D%5Cright%29%5Cright%5D+%5Cend%7Barray%7D+&quot; alt=&quot;\begin{array}{r} \displaystyle\mbox{TK}\equiv\sum_{i=-m}^{-1}v(r_i)\left[w^-\left(\frac{i+m+1}{60}\right)-w^-\left(\frac{i+m}{60}\right)\right]\\ +\displaystyle \sum_{i=1}^{n}v(r_i)\left[w^+\left(\frac{n-i+1}{60}\right)-w^+\left(\frac{n-i}{60}\right)\right] \end{array} &quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;在实证中，Barberis, Mukherjee, and Wang (2016) 使用了 Tversky and Kahneman (1992) 原文中的参数，即 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B1+%3D+0.88&quot; alt=&quot;α = 0.88&quot; eeimg=&quot;1&quot;/&gt; ， &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%BB+%3D+2.25&quot; alt=&quot;λ = 2.25&quot; eeimg=&quot;1&quot;/&gt; ， &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B3+%3D+0.61&quot; alt=&quot;γ = 0.61&quot; eeimg=&quot;1&quot;/&gt; ， &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B4+%3D+0.69&quot; alt=&quot;δ = 0.69&quot; eeimg=&quot;1&quot;/&gt; 。这样的好处是可以避免 data snooping，因为这些参数是根据近 30 年前的实验总结的，而当初的实验和股票收益率预测没什么关系。&lt;/p&gt;&lt;p&gt;对于第二点，我们先从直观上梳理一下：面对形形色色的股票，以它们的历史收益率为输入，投资者通过累计前景理论可以得到每支股票的价值（下称 TK 价值；TK 是 Tversky 和 Kahneman 的首字母）。由于 TK 价值高的股票更具吸引力，因此投资者会扎堆买入 TK 价值高的、扎堆卖出 TK 价值低的股票，造成前者被超买而后者被超卖，因此&lt;b&gt;股票未来的预期收益率和当前的 TK 价值呈负相关。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;为了验证这个猜测，Barberis, Mukherjee, and Wang (2016) 提出了一个简单的数学模型 —— 市场中分为按 mean-variance 最优化购买股票的人和按 TK 价值购买股票的人，并推导出在均衡状态下，股票预期收益率和 TK 价值确实呈现负相关。&lt;/p&gt;&lt;p&gt;下面就来看看 Barberis, Mukherjee, and Wang (2016) 针对美股的实证结果。&lt;/p&gt;&lt;p&gt;首先，下表展示了 TK 价值和其他常见因子的均值以及相关系数。在这张表中，我最关心的是 TK 和 Lt rev（长期反转）的相关性。这二者之间的相关系数高达 0.56。之所以关心 Lt rev，是因为 TK 是根据过去五年的历史收益率计算的，而显然历史收益率越高，TK 值就越高。而 Lt rev 也是如此。此外，美股上确实存在长期反转现象，即过去 3 到 5 年的收益率和未来呈现负相关。因此，我们自然关心在控制了 Lt rev 之后，TK 是否仍然可以获得显著的超额收益。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-e9c5e54fa5a3380d3fdf27d8dfb8084a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;892&quot; data-rawheight=&quot;610&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;892&quot; data-original=&quot;https://pic3.zhimg.com/v2-e9c5e54fa5a3380d3fdf27d8dfb8084a_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-e9c5e54fa5a3380d3fdf27d8dfb8084a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;892&quot; data-rawheight=&quot;610&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;892&quot; data-original=&quot;https://pic3.zhimg.com/v2-e9c5e54fa5a3380d3fdf27d8dfb8084a_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-e9c5e54fa5a3380d3fdf27d8dfb8084a_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;为检验 TK 因子，Barberis, Mukherjee, and Wang (2016) 首先进行了常规的 portfolio sort test。下表给出了结果。无论是相对无风险的超额收益，还是相对一些多因子模型的超额收益 α，TK 因子 —— &lt;b&gt;由于猜想是 TK 因子和未来收益率呈现负相关，因此 TK 因子是 Low – High&lt;/b&gt; —— 均表现出了显著的收益率。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-689b9e7916023e42c879ac33daeb9f13_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;825&quot; data-rawheight=&quot;706&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;825&quot; data-original=&quot;https://pic4.zhimg.com/v2-689b9e7916023e42c879ac33daeb9f13_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-689b9e7916023e42c879ac33daeb9f13_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;825&quot; data-rawheight=&quot;706&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;825&quot; data-original=&quot;https://pic4.zhimg.com/v2-689b9e7916023e42c879ac33daeb9f13_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-689b9e7916023e42c879ac33daeb9f13_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;再来是 Fama and MacBeth (1973) Regression。它可以控制其他解释变量，考察 TK 因子能否获得显著超额收益。&lt;b&gt;FM regression 由于是用当期因子值和下期收益率回归，因此下表中 TK 因子的 risk premium 为负证实了 Barberis, Mukherjee, and Wang (2016) 的猜想，即 TK 值和未来收益率呈现负相关。&lt;/b&gt;此外，在控制了常见的因子之后，TK 因子依然显著（唯一例外是第 7 组实验，显著性水平是 5.5%）。对于我个人关注的问题，在控制了 Lt rev 之后，TK 的显著性没有受到影响。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-9ca121950e9cf4ec890e1b27b3369ad1_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;792&quot; data-rawheight=&quot;765&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;792&quot; data-original=&quot;https://pic2.zhimg.com/v2-9ca121950e9cf4ec890e1b27b3369ad1_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-9ca121950e9cf4ec890e1b27b3369ad1_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;792&quot; data-rawheight=&quot;765&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;792&quot; data-original=&quot;https://pic2.zhimg.com/v2-9ca121950e9cf4ec890e1b27b3369ad1_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-9ca121950e9cf4ec890e1b27b3369ad1_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;Barberis, Mukherjee, and Wang (2016) 一文另外一个非常具有想象力的实证结果是分析了前景理论中的哪个性质对 TK 与股票收益率的负相关贡献最大。前面我们提到，前景理论的几个重要性质包括损失厌恶、敏感度递减以及高估尾部。这些性质通过价值和权重函数的形状表现出来。&lt;/p&gt;&lt;p&gt;最关键的来了：&lt;b&gt;我们可以通过改变价值和权重函数的参数，让上述性质中的一个或多个消失，从而仅考虑保留下的性质和股票预期收益率的关系，以此来研究前景理论中哪个或哪些性质对于预测未来收益率是最重要的。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;以 LA，CC 和 PW 分别代表损失厌恶、敏感度递减以及高估尾部三个性质，Barberis, Mukherjee, and Wang (2016) 对上述问题的研究结果如下表所示。举例来说，表中 LACC 代表了因子包含损失厌恶和敏感度递减两个性质，但不包括高估尾部，以此类推；TK 是原始的 TK 因子。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-25999731890488cee7030766780cfd00_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;801&quot; data-rawheight=&quot;619&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;801&quot; data-original=&quot;https://pic1.zhimg.com/v2-25999731890488cee7030766780cfd00_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-25999731890488cee7030766780cfd00_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;801&quot; data-rawheight=&quot;619&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;801&quot; data-original=&quot;https://pic1.zhimg.com/v2-25999731890488cee7030766780cfd00_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-25999731890488cee7030766780cfd00_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;结果显示，在这些性质中，发挥核心作用的是 PW 代表的权重函数的性质，即投资者高估尾部事件发生的概率。当 PW 性质被从前景理论中“去掉”时，剩下的 LA 和 CC 以及它们的组合均无法获得显著的收益。&lt;/p&gt;&lt;p&gt;这样的结果，从不同 TK 取值的分组 portfolios 的公司特征可以看到一些端倪。以 Skew 为例，从下表可以观察到，随着 TK 值从最低档到最高档，每组中股票平均的 Skew 也在上升，特别是在第 9 组到 High TK 组发生的跳变。由于右偏的股票具有彩票收益特征，因此它们对于按 TK 值交易的投资者无疑是非常有吸引力的。这一现象能够帮助我们理解为什么高估尾部权重这个性质在预测未来收益率时发挥了重要作用。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-0c26cd6e0570fbcc2060e1866d7165ed_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;325&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-0c26cd6e0570fbcc2060e1866d7165ed_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-0c26cd6e0570fbcc2060e1866d7165ed_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;325&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-0c26cd6e0570fbcc2060e1866d7165ed_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-0c26cd6e0570fbcc2060e1866d7165ed_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;除上述检验和分析外，Barberis, Mukherjee, and Wang (2016) 还进行了大量的稳健性分析。出于篇幅考虑，本文就不逐一介绍了。感兴趣的小伙伴不妨阅读这篇论文。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;04 A 股市场的简单实证&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;本节按照 Barberis, Mukherjee, and Wang (2016) 的思路针对 A 股进行简单实证。特别感谢 &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzI3Mjk5OTU1Ng%3D%3D%26mid%3D2247484227%26idx%3D1%26sn%3D2b4bc2a6ae6b059a81d2ec12705e7649%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;[Chihiro Quantitative Research]&lt;/a&gt; 的刀疤连对实证分析的支持！&lt;/p&gt;&lt;p&gt;实证期从 1998 年 9 月 30 日至 2019 年 9 月 30 日。每月末，使用过去 36 个月的收益率数据计算 TK 值（因此数据实际上是从 1995 年开始）。之所以选择三年而非五年是因为 A 股市场受政策影响较大。太长的历史时间窗口内收益率的时间序列难以满足平稳性。&lt;/p&gt;&lt;p&gt;此外由于停牌造成的影响，实证中做了如下处理。如果一支股票在某个月内有超过 2/3 的交易日停牌，则认为该月的收益率为空；如果一个支股票在 36 个月的计算窗口内有低于 24 个有效月收益率数据，则在当期计算 TK 值时将其剔除在外。最后，如果某支股票的实际有效月频收益率样本数小于 36，则按实际有效月频收益率个数 &lt;img src=&quot;https://www.zhihu.com/equation?tex=T&quot; alt=&quot;T&quot; eeimg=&quot;1&quot;/&gt; 计算每个结果的概率，即 &lt;img src=&quot;https://www.zhihu.com/equation?tex=1%2FT&quot; alt=&quot;1/T&quot; eeimg=&quot;1&quot;/&gt; 而非 1/36。&lt;/p&gt;&lt;p&gt;由于是简单实证，因此本文仅使用 portfolio sort test。每月末将股票按 TK 值从低到高排序分成 10 组，并通过做多 Low 组同时做空 High 组构建 TK 因子。实证中同时考虑等权和市值加权。结果如下。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-6c17aae0ea0d4abe093048d80253ae77_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;951&quot; data-rawheight=&quot;343&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;951&quot; data-original=&quot;https://pic4.zhimg.com/v2-6c17aae0ea0d4abe093048d80253ae77_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-6c17aae0ea0d4abe093048d80253ae77_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;951&quot; data-rawheight=&quot;343&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;951&quot; data-original=&quot;https://pic4.zhimg.com/v2-6c17aae0ea0d4abe093048d80253ae77_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-6c17aae0ea0d4abe093048d80253ae77_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;上述简单的实证结果显示，在等权下 TK 因子十分显著，然而在市值加权下，TK 因子就没有什么作为了。毫无疑问，这表明小市值对 TK 因子有一定影响。为进一步考察 Size 的影响，我们也通过 dependent double sorting 对市值进行了控制 —— 即首先按市值分组，再把每个市值组内的股票按 TK 值分组。在这种检验下依然能观察到 TK 因子的作用。&lt;/p&gt;&lt;p&gt;关于 TK 因子的更多 insights，需要更充分、详实的实证来支撑。这些超出本文的目标，搞事情小组会在今后某期文章中对 TK 因子进行完整的分析。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;05 结语&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;Barberis (2018) 一文曾对行为金融学如何影响股票的价格和交易量进行了系统的总结（见&lt;a href=&quot;https://zhuanlan.zhihu.com/p/78564724&quot; class=&quot;internal&quot;&gt;《资产价格和交易量背后的行为金融学》&lt;/a&gt;），而前景理论无疑是行为金融学中的一块重要的 building block。&lt;/p&gt;&lt;p&gt;在一篇最新出炉的文章中，Barberis, Jin, and Wang (2019) 更是将前景理论和股票收益率的研究带上了一个新的台阶。该文考虑了一个动态模型，在前述前景理论重要性质的基础上，将投资者的 prior gain or loss 引入了模型，一举尝试解释了美股市场中最常见的 22 个异象。该模型很好的解释了其中 13 个异象 —— 不仅仅解释了首尾两组的 spread return，而且对一些异象甚至很好的解释了中间组收益率的单调性！&lt;/p&gt;&lt;p&gt;没错，你大概猜到了，未来《前景理论和股票收益 (II)》就将要介绍 Barberis, Jin, and Wang (2019)。但由于这篇文章的模型太复杂，必要的铺垫是十分必要的，因此就有了本文。&lt;/p&gt;&lt;p&gt;诚然，面对股票收益率背后的驱动，即因子的逻辑，风险解释远比行为金融学支持的 mispricing 更令人信服。但是，越来越多的实证结果表明，真正能在样本外获得超额收益的因子或策略或多或少都和行为金融学有关。它理应被认真对待。&lt;/p&gt;&lt;p&gt;在对行为金融学的看法上，我站 Thaler、Barberis 等人。&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;参考文献&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Barberis, N. (2018). Psychology-based models of asset prices and trading volume. Working paper, Yale School of Management.&lt;/li&gt;&lt;li&gt;Barberis, N., A. Mukherjee, and B. Wang (2016). Prospect theory and stock returns: An empirical test. &lt;i&gt;Review of Financial Studies&lt;/i&gt;, Vol. 29(11), 3068 – 3107.&lt;/li&gt;&lt;li&gt;Barberis, N., L. Jin, and B. Wang (2019). Prospect theory and stock market anomalies. Available at SSRN: &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//ssrn.com/abstract%3D3477463&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;ssrn.com/abstract=34774&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;63&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;.&lt;/li&gt;&lt;li&gt;Fama, E. F. and J. D. MacBeth (1973). Risk, return, and equilibrium: empirical tests. &lt;i&gt;Journal of Political Economy&lt;/i&gt;, Vol. 81(3), 607 – 636.&lt;/li&gt;&lt;li&gt;Kahneman, D. and A. Tversky (1979). Prospect Theory: an analysis of decision under risk. &lt;i&gt;Econometrica&lt;/i&gt;, Vol. 47(2), 263 – 292.&lt;/li&gt;&lt;li&gt;Newey, W. K. and K. D. West (1987). A simple, positive semi-definite, heteroskedasticity and autocorrelation consistent covariance matrix. &lt;i&gt;Econometrica&lt;/i&gt;, Vol. 55(3), 703 – 708.&lt;/li&gt;&lt;li&gt;Tversky, A. and D. Kahneman (1992). Advances in prospect theory: cumulative representation of uncertainty. &lt;i&gt;Journal of Risk and Uncertainty&lt;/i&gt;, Vol. 5(4), 297 – 323.&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;免责声明：&lt;/b&gt;文章内容不可视为投资意见。市场有风险，入市需谨慎。&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处。已委托“维权骑士”(&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//rightknights.com&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;维权骑士_免费版权监测/版权保护/内容多平台分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2020-01-20-103548438</guid>
<pubDate>Mon, 20 Jan 2020 00:00:00 +0800</pubDate>
</item>
<item>
<title>因子样本外表现为什么变差？</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2019-12-17-96990210.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/96990210&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-506754755985b7fe2c33deb05a917583_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;摘要&lt;/b&gt;&lt;/p&gt;&lt;p&gt;曝光导致错误定价减弱、因子拥挤和交易成本是因子样本外变差的三大原因。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;00 引言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;因子样本外的表现较样本内变差是人们的共识。这里的因子包括异象（anomalies）和传统意义上的风格 beta 因子，在下文不做区分，统称为因子。造成因子样本内、外表现差异的最主要原因自然是样本内的 data snooping（即因子本来就是假的），但如果因子确实是真实的，那么它们在样本外变差的原因是什么呢？学术界和业界的主要观点包括以下三种：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;b&gt;曝光导致错误定价减弱&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;因子拥挤&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;交易成本&lt;/b&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;在 2019 年 9 月刚刚结束的 Wharton 商学院 Jacobs Levy Center 年会中，一共深入讨论了四篇论文，其中两篇就和因子样本外表现有关，它们分别是 Bowles et al. (2019) 以及 Chen and Velikov (2019)，足见这个话题的重要性。具体来说，Bowles et al. (2019) 以 Anomaly Time 为题从“曝光导致错误定价减弱”的角度谈论了因子的表现；而 Chen and Velikov (2019) 则从“交易成本”的角度指出，在考虑了非常合理的费用之后，绝大多数因子在样本外根本无法赚钱。&lt;/p&gt;&lt;p&gt;本文就来简要探讨一下因子样本外表现变差的三个原因。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;01 曝光导致错误定价减弱&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;因子代表着市场某方面的非有效性、代表了某种 mispricing（错误定价）。&lt;/b&gt;只要套利限制不是过大，那么聪明的投资者一定会先人一步去交易这个因子，导致错误定价收窄，这就解释了为什么&lt;b&gt;当因子被发表后，它的收益往往也跟着显著下降。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;在这方面，McLean and Pontiff (2016)  的研究颇具代表性。该文研究了 97 个因子，发现因子样本外的表现比样本内的表现下降了 26%、而发表后（post-publication）的表现较样本内则下降了 58%。McLean and Pontiff (2016)  考虑样本内外差异是为了控制过拟合的影响。上述结果表明，58% 与 26% 之差 —— 即 32% —— 就是发表本身造成因子效果的减弱。McLean and Pontiff (2016)  把它称作 publication-informed trading。这背后的逻辑链是：因子被发表导致它被公布于众 --&amp;gt; 越来越多的人交易该因子从而减弱了错误定价 --&amp;gt; 最终导致因子收益率降低。&lt;/p&gt;&lt;p&gt;如果说 McLean and Pontiff (2016)  检验了因子的平均收益，Bowles et al. (2019) 则是从时效性的角度展示了因子背后的信息越来越快的被 priced in。长久以来，由于 Fama and French (1993) 的影响太过深远，学术界在研究因子的时候为了避免未来数据，通常采用每年再平衡的方法（量价相关的指标通常是月频再平衡），导致构建因子的指标数据严重滞后。这其中最著名的例子要数 Eugene Fama 的弟子 Cliff Asness 使用月频价格对 HML 的改造（&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzUxNzY0NjU3Mw%3D%3D%26mid%3D2247483911%26idx%3D1%26sn%3D29be96059644fdf80dc9db87a69b9fa5%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Asness and Frazzini 2013&lt;/a&gt;）。使用了月频价格数据后的 HML 较 Fama and French (1993) 三因子的 HML 表现更好，说明了数据时效性的重要性。&lt;/p&gt;&lt;p&gt;再来看个更显著的例子。下图显示了 Reliant Energy Inc. 这家公司 2007 和 2008 两年 10-K filing 的时间，以及按学术界传统每年 6 月底再平衡时该公司的股价变化。在 2007 年 10-K filing 到 6 月底这 85 天内，因最新的财报数据，该公司股价上涨 59.09%。如果按照两个 10-K filing 之间来调仓选入该股票，那么在两个披露期之间可以获利 44.63%；而在传统研究框架下，如果在两个 6 月底调仓，选入该股票却亏损 21.08%。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-a5ef0242551f31c74192fecb9c996fc8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;555&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-a5ef0242551f31c74192fecb9c996fc8_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-a5ef0242551f31c74192fecb9c996fc8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;555&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-a5ef0242551f31c74192fecb9c996fc8_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-a5ef0242551f31c74192fecb9c996fc8_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;对于使用财务指标构造的因子，学术界之所以使用每年再平衡是因为学术界的重心毕竟是 empirical asset pricing。&lt;b&gt;为了研究成果的可复制性和可比性&lt;/b&gt;，大家用的都是同样的数据库、采用同样的再平衡周期，因此也就没有想过要用粒度更细的数据。&lt;/p&gt;&lt;p&gt;Bowles et al. (2019) 一文则另辟蹊径，使用 &lt;b&gt;Compustat Snapshot 数据库&lt;/b&gt;对因子时效进行了分析。用 Bowles et al. (2019) 自己的话说，Snapshot 在学术界用的很少，但它却是有着粒度最细的数据 —— 细到记录财报中&lt;b&gt;每个单一变量&lt;/b&gt;更新的时间：&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;For&lt;/i&gt; &lt;i&gt;&lt;b&gt;each&lt;/b&gt;&lt;/i&gt; &lt;i&gt;financial statement&lt;/i&gt; &lt;i&gt;&lt;b&gt;variable&lt;/b&gt;, Snapshot identifies&lt;/i&gt; &lt;i&gt;&lt;b&gt;the first date&lt;/b&gt;&lt;/i&gt; &lt;i&gt;on which each variable was reported.&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;以美股为例，通常上市公司先有 earnings announcement 然后才有 10-Q 和 10-K filing。而在 earnings announcement 上往往只会公布 total revenue 和 net income 等少许指标，而在正式的 filing 中才披露全部财报内容。在这种情况下，Snapshot 数据库会在 earnings announcement 当日更新 total revenue 和 net income 数据，而等到实际 filing 之后再更新其他数据。因此，使用 Snapshot 数据可以保证在用来计算因子的指标被更新后，第一时间更新因子、进行投资组合的再平衡。&lt;/p&gt;&lt;p&gt;利用 Snapshot 数据，Bowles et al. (2019) 研究了一些常见的源自财务数据的因子，发现绝大多数因子在最新数据更新后的 120 天之内（特别是最初的 30 天内）能够获得显著的超额收益。而在 120 天之后，超额收益消失（下图）。不过，Bowles et al. (2019) 也指出，最近几年的实证结果显示，因子的超额收益消失的更快。基于这些发现，Bowles et al. (2019) 认为因子是真实的（而非 data snooping 出来的），但很快就会因套利交易而消失。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-3d261a3427bde6d4c651f1f51cb16c6b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;899&quot; data-rawheight=&quot;627&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;899&quot; data-original=&quot;https://pic4.zhimg.com/v2-3d261a3427bde6d4c651f1f51cb16c6b_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-3d261a3427bde6d4c651f1f51cb16c6b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;899&quot; data-rawheight=&quot;627&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;899&quot; data-original=&quot;https://pic4.zhimg.com/v2-3d261a3427bde6d4c651f1f51cb16c6b_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-3d261a3427bde6d4c651f1f51cb16c6b_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;Bowles et al. (2019) 针对美股的研究和前不久天风证券的一篇《和时间赛跑 —— 利用实时财务信息增强组合收益》针对 A 股的报告异曲同工。该研究显示，利用业绩预告和快报能够提升财务信息的时效性，提高财务因子的表现。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;02 因子拥挤&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;造成因子样本外变差的第二个原因是&lt;b&gt;因子拥挤（factor crowding）&lt;/b&gt;。&lt;/p&gt;&lt;p&gt;通常来说，因子都有周期性。当某类因子好使的时候，就会造成更多的资金引入，从而出现因子拥挤，并降低该因子未来的预期收益率。而 rule-based （使用相似的指标排序、接近的调仓频率）的因子投资无疑加剧了这种负面影响。&lt;/p&gt;&lt;p&gt;由于因子拥挤度和因子未来收益率呈现负相关，如何定量计算因子拥挤度就成为人们关注的问题。在这方面，MSCI 整理了相关研究，提出五个描述因子拥挤度的代理指标（Bayraktar et al. 2015，Bonne et al. 2018）。这五个指标是：valuation spread、short Interest spread、pairwise correlation、factor volatility 以及 factor reversal。考虑到由于制度问题，short interest spread 在 A 股上并不适用，下面对其他四个指标做简要介绍。海通证券的报告《因子失效预警：因子拥挤》针对 A 股对上述四个指标进行了分析。&lt;/p&gt;&lt;p&gt;&lt;b&gt;2.1 Valuation Spread&lt;/b&gt;&lt;/p&gt;&lt;p&gt;顾名思义，valuation spread（估值价差）考虑的正是因子的估值。关于因子估值在 A 股上的实证，感兴趣的小伙伴请参考&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzI3Mjk5OTU1Ng%3D%3D%26mid%3D2247483923%26idx%3D1%26sn%3Ddd5e368d21c71137a7d2fd971af7c970%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;《你家因子便宜吗？&lt;/a&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzI3Mjk5OTU1Ng%3D%3D%26mid%3D2247483923%26idx%3D1%26sn%3Ddd5e368d21c71137a7d2fd971af7c970%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;——基于value spread的因子择时研究》&lt;/a&gt;。这背后的逻辑是，当更多资金涌入某个因子时（特别是多头时），会造成受波及股票的价格上涨，使它们的估值变高。因此，因子估值和因子拥挤度成正相关，是一个不错代理指标。&lt;/p&gt;&lt;p&gt;估值价差的计算方法十分直观。首先选择一个合适的股票估值指标，比如 B/P，然后分别计算因子多空两头组合中该估值指标的中位数，以此作为多空两头的估值，最后这两个估值差就是因子的估值价差。以 B/P 为例，Bonne et al. (2018) 使用的计算公式为：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvaluation+spread%7D%3D%5Cdisplaystyle%5Cln%5Cleft%28%5Cfrac%7B%5Cmbox%7Bmedian+B%2FP+in+long+leg%7D%7D%7B%5Cmbox%7Bmedian+B%2FP+in+short+leg%7D%7D%5Cright%29&quot; alt=&quot;\mbox{valuation spread}=\displaystyle\ln\left(\frac{\mbox{median B/P in long leg}}{\mbox{median B/P in short leg}}\right)&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;&lt;b&gt;2.2 Pairwise Correlation&lt;/b&gt;&lt;/p&gt;&lt;p&gt;第二个指标是 Pairwise Correlation（配对相关性）。它是为了从因子投资组合内股票收益率的相关程度来试图揭示资金持仓的集中程度，并以此来评价因子的拥挤程度。为了计算该指标，Bonne et al. (2018) 采用了如下步骤：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;将因子多（空）头内的股票做市场、市值等中性化处理，得到残差；&lt;/li&gt;&lt;li&gt;使用 63 个交易日的残差计算每个股票和其所在多、空头内平均残差收益率的相关性。以多头为例，使用多头组合中第 i 支股票的残差收益率和剩余股票残差收益率均值计算相关系数。空头处理相同。&lt;/li&gt;&lt;li&gt;计算多、空两头组内所有股票相关系数的均值；&lt;/li&gt;&lt;li&gt;将多、空两头相关系数均值再取平均，得到该因子 Pairwise Correlation 的原始值，最后再将该值进行标准化就得到最终该因子的 Pairwise Correlation。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;b&gt;2.3 Factor Volatility&lt;/b&gt;&lt;/p&gt;&lt;p&gt;由于资金的流入会加剧因子收益率的波动，因此 Bonne et al. (2018) 从这个角度提出了衡量因子拥挤度的第三个指标：Factor Volatility（因子波动率）。值得一提的是，Bonne et al. (2018) 使用的是预测的未来因子波动率相对未来市场波动率的比值来计算该指标。他们认为这么做可以有效的控制市场波动率变化造成的影响。在实际操作中，一个简化的处理方法是使用因子的历史波动率。&lt;/p&gt;&lt;p&gt;&lt;b&gt;2.4 Factor Reversal&lt;/b&gt;&lt;/p&gt;&lt;p&gt;最后一个指标是 Factor Reversal（因子反转）。De Bondt and Thaler (1985) 这篇著名的论文表明美股在 3 到 5 年的中长期尺度上存在反转。由于因子是股票构成的投资组合，因此我们可以自然的从股票的反转延伸出因子的反转。Bonne et al. (2018) 使用因子过去三年的累积收益率计算该指标。&lt;/p&gt;&lt;p&gt;以前文提到的《因子失效预警：因子拥挤》研究结果为例，下图展示了估值价差和因子反转两个因子拥挤度指标和 A 股上一些常见因子未来收益率的关系（之所以没有放另外两个指标的结果是因为报告中的计算方法和 Bonne et al. 2018 的方法差异较大；方法并无优劣之分，但因实证结果并不直接对应前文介绍的方法，故略去）。图中结果显示，对其中大部分因子，这两个指标和因子未来收益率成负相关，说明该因子拥挤会造成因子表现变差。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-55557f4d5c71fa6e8c53a1d4b1d48306_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;364&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-55557f4d5c71fa6e8c53a1d4b1d48306_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-55557f4d5c71fa6e8c53a1d4b1d48306_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;364&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-55557f4d5c71fa6e8c53a1d4b1d48306_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-55557f4d5c71fa6e8c53a1d4b1d48306_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;最后，因子拥挤也会引发流动性冲击。一旦市场中发生冲击因子的事件后，持有相似头寸的管理人会竞相卖出手中的股票，由此产生的流动性危机会造成很大的亏损。2007 年 8 月，美股市场上一些非常优秀的量化对冲基金在短时间内录得了巨大的亏损。Khandani and Lo (2011) 对此进行了研究并发现，很多基金经理在短时间内清理了相似的头寸，巨大的抛压对流动性造成了巨大的打击、使得这些股票的价格在短时间内大幅下跌。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;03 交易成本&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;交易成本是因子在样本外的效果较样本内显著变差的第三个原因。&lt;/p&gt;&lt;p&gt;&lt;b&gt;学术论文通常不会对交易费用给予充分的考虑，这会造成对因子收益率的高估。&lt;/b&gt;此外，由于因子投资组合一般都是多、空对冲的组合，如果不合理考虑做空限制，也会高估因子的收益。Novy-Marx and Velikov (2015) 研究了交易费用对因子效果的影响，并提出三个思路降低交易成本：（1）仅使用交易费用低的股票构建因子组合；（2）降低因子组合再平衡的频率；（3）在交易时考虑更严格的买卖价差约束。&lt;/p&gt;&lt;p&gt;在 Chen and Velikov (2019) 一文中，二位作者使用 &lt;b&gt;effective spread（有效价差）&lt;/b&gt;的概念代替传统的 bid-ask spread，对多达 120 种因子进行了研究。他们的研究发现 …… 哎，先上图吧。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-5d8545bd2c7fb372fb44982e2e191473_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;807&quot; data-rawheight=&quot;428&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;807&quot; data-original=&quot;https://pic4.zhimg.com/v2-5d8545bd2c7fb372fb44982e2e191473_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-5d8545bd2c7fb372fb44982e2e191473_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;807&quot; data-rawheight=&quot;428&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;807&quot; data-original=&quot;https://pic4.zhimg.com/v2-5d8545bd2c7fb372fb44982e2e191473_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-5d8545bd2c7fb372fb44982e2e191473_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;上图中，蓝色的 bar 代表着 120 个因子样本内的平均 gross 收益率（不考虑任何交易成本）；黄色 bar 为这些因子在发表后的平均 gross 收益率；红色 bar 为考虑了交易成本后，这些因子的平均收益率 —— &lt;b&gt;负的&lt;/b&gt;。&lt;/p&gt;&lt;p&gt;来看下具体研究方法。Chen and Velikov (2019) 对 effective spread 的定义为：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Beffective+spread%7D%3D%5Cdisplaystyle+2%5Ctimes%5Cleft%28%5Cln%28%5Cmbox%7Btrade+price%7D%29-%5Cln%28%5Cmbox%7Bquote+midpoint%7D%29%5Cright%29&quot; alt=&quot;\mbox{effective spread}=\displaystyle 2\times\left(\ln(\mbox{trade price})-\ln(\mbox{quote midpoint})\right)&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;为了考虑交易成本，他们假设每次调仓时的交易费用为上述 effective spread 的一半。从上述定义不难看出，因子的费后 net return 和换手率以及换仓时的 effective spread 息息相关：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bnet+return%7D%3D%5Cdisplaystyle+%5Cmbox%7Bgross+return%7D-%5Cmbox%7Bturnover%7D%5Ctimes%5Cmbox%7Beffective+spread%7D&quot; alt=&quot;\mbox{net return}=\displaystyle \mbox{gross return}-\mbox{turnover}\times\mbox{effective spread}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;有必要指出的是，Chen and Velikov (2019) 的研究仅考虑交易费用，并不考虑任何冲击成本。这意味着考虑了冲击成本后，因子样本外的 net return 只能更惨。下表显示了在考虑了成本后，120 个因子在样本内、外的收益情况（括号中为标准差）。结果显示，考虑成本后，即便是样本内，这些因子的月均收益仅有 0.05%，而样本外的收益更是小于零。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-65f3dc33c08959a08315feb8f2824e05_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;865&quot; data-rawheight=&quot;361&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;865&quot; data-original=&quot;https://pic2.zhimg.com/v2-65f3dc33c08959a08315feb8f2824e05_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-65f3dc33c08959a08315feb8f2824e05_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;865&quot; data-rawheight=&quot;361&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;865&quot; data-original=&quot;https://pic2.zhimg.com/v2-65f3dc33c08959a08315feb8f2824e05_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-65f3dc33c08959a08315feb8f2824e05_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;下图展示了样本外，这 120 个因子的 net returns 的分布。这些 net returns 经过了一定的交易优化处理，有效降低了换手率和交易成本，因此整体来看所有因子的 net return 均值是大于零的，而非上表中 -0.03% 那么惨。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-72ba155e7d1058b8443a9f9279aeedf8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;688&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-72ba155e7d1058b8443a9f9279aeedf8_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-72ba155e7d1058b8443a9f9279aeedf8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;688&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-72ba155e7d1058b8443a9f9279aeedf8_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-72ba155e7d1058b8443a9f9279aeedf8_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;这个分布看上去像是一个均值接近零的正态分布，和随机因子的表现并无太大差异（即如果我们使用完全随机生成的 120 个因子，其中也总会有一些是“显著”的）。由于发表的因子都多少存在 selection bias，因此面对上述结果，Chen and Velikov (2019) 不禁发问：排除运气后，还有多少因子是显著的？为了回答上述问题，他们采用了 empirical Bayes 方法对 selection bias 进行修正。&lt;/p&gt;&lt;p&gt;Chen and Velikov (2019) 假设因子  &lt;img src=&quot;https://www.zhihu.com/equation?tex=i&quot; alt=&quot;i&quot; eeimg=&quot;1&quot;/&gt;  在被发表后的样本平均收益率 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbar+r_i&quot; alt=&quot;\bar r_i&quot; eeimg=&quot;1&quot;/&gt; 由真实 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%BC_i&quot; alt=&quot;μ_i&quot; eeimg=&quot;1&quot;/&gt; 和噪音 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B5_i&quot; alt=&quot;ε_i&quot; eeimg=&quot;1&quot;/&gt; 决定：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbar+r_i%3D%5Cmu_i%2B%5Cvarepsilon_i&quot; alt=&quot;\bar r_i=\mu_i+\varepsilon_i&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;其中 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B5_i&quot; alt=&quot;ε_i&quot; eeimg=&quot;1&quot;/&gt; 满足正态分布 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmathcal%7BN%7D%280%2C+%5Cmbox%7BSE%7D_i%29&quot; alt=&quot;\mathcal{N}(0, \mbox{SE}_i)&quot; eeimg=&quot;1&quot;/&gt; ，这里 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BSE%7D_i&quot; alt=&quot;\mbox{SE}_i&quot; eeimg=&quot;1&quot;/&gt; 是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbar+r_i&quot; alt=&quot;\bar r_i&quot; eeimg=&quot;1&quot;/&gt; 的 standard error。Chen and Velikov (2019) 进一步假设所有因子 net return 的真实均值 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%BC_i&quot; alt=&quot;μ_i&quot; eeimg=&quot;1&quot;/&gt; 都满足如下正态分布：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmu_i%5Csim%5Cmathcal%7BN%7D%28%5Cmu_%7B%5Cmu%7D%2C%5Csigma_%7B%5Cmu%7D%29&quot; alt=&quot;\mu_i\sim\mathcal{N}(\mu_{\mu},\sigma_{\mu})&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;Chen and Velikov (2019) 采用 method of moments 对参数 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%BC_%CE%BC&quot; alt=&quot;μ_μ&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%83_%CE%BC&quot; alt=&quot;σ_μ&quot; eeimg=&quot;1&quot;/&gt; 进行估计：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+%5Chat%5Cmu_%7B%5Cmu%7D%26%3D%26%5Cdisplaystyle%5Cfrac%7B1%7D%7BN%7D%5Csum_i%5Cbar+r_i%5C%5C+%5Chat%5Csigma_%7B%5Cmu%7D%5E2%26%3D%26%5Cdisplaystyle%5Cmax%5Cleft%5C%7B%5Cleft%5B%5Cfrac%7B1%7D%7BN%7D%5Csum_i%28%5Cbar+r_i-%5Chat%5Cmu_%7B%5Cmu%7D%29%5E2-%5Cfrac%7B1%7D%7BN%7D%5Csum_i%5Cmbox%7BSE%7D_i%5E2%5Cright%5D%2C0%5Cright%5C%7D+%5Cend%7Barray%7D&quot; alt=&quot;\begin{array}{rll} \hat\mu_{\mu}&amp;amp;=&amp;amp;\displaystyle\frac{1}{N}\sum_i\bar r_i\\ \hat\sigma_{\mu}^2&amp;amp;=&amp;amp;\displaystyle\max\left\{\left[\frac{1}{N}\sum_i(\bar r_i-\hat\mu_{\mu})^2-\frac{1}{N}\sum_i\mbox{SE}_i^2\right],0\right\} \end{array}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;上式说明 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+%CE%BC_%CE%BC&quot; alt=&quot;\hat μ_μ&quot; eeimg=&quot;1&quot;/&gt; 是所有因子平均收益率的截面均值。看到这里，似乎还没见 Bayes 的影子。别着急，有了 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbar+r_i&quot; alt=&quot;\bar r_i&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%BC_%CE%BC&quot; alt=&quot;μ_μ&quot; eeimg=&quot;1&quot;/&gt; 的估计，接下来马上就要&lt;b&gt;贝叶斯收缩（Bayes shrinkage）&lt;/b&gt;了：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D%5B%5Cmu_i%7Cr_i%2C%5Cmbox%7BSE%7D_i%5D%3Ds_i%5Cmu_%7B%5Cmu%7D%2B%281-s_i%29%5Cbar+r_i&quot; alt=&quot;\mbox{E}[\mu_i|r_i,\mbox{SE}_i]=s_i\mu_{\mu}+(1-s_i)\bar r_i&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;上式中 &lt;img src=&quot;https://www.zhihu.com/equation?tex=s_i&quot; alt=&quot;s_i&quot; eeimg=&quot;1&quot;/&gt; 是收缩系数，它由 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbar+r_i&quot; alt=&quot;\bar r_i&quot; eeimg=&quot;1&quot;/&gt; 的 standard error（ &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BSE%7D_i&quot; alt=&quot;\mbox{SE}_i&quot; eeimg=&quot;1&quot;/&gt; ）和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%BC_%7B%5Cmu%7D&quot; alt=&quot;μ_{\mu}&quot; eeimg=&quot;1&quot;/&gt; 的标准差 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%83_%CE%BC&quot; alt=&quot;σ_μ&quot; eeimg=&quot;1&quot;/&gt; 的相对大小决定：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=s_i%3D%5Cdisplaystyle%5Cfrac%7B%5Cmbox%7BSE%7D%5E2_i%7D%7B%5Csigma_%7B%5Cmu%7D%5E2%2B%5Cmbox%7BSE%7D_i%5E2%7D&quot; alt=&quot;s_i=\displaystyle\frac{\mbox{SE}^2_i}{\sigma_{\mu}^2+\mbox{SE}_i^2}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;结合 &lt;img src=&quot;https://www.zhihu.com/equation?tex=s_i&quot; alt=&quot;s_i&quot; eeimg=&quot;1&quot;/&gt; 的定义不难看出，如果 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BSE%7D_i&quot; alt=&quot;\mbox{SE}_i&quot; eeimg=&quot;1&quot;/&gt; 小说明 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbar+r_i&quot; alt=&quot;\bar r_i&quot; eeimg=&quot;1&quot;/&gt; 可信，则收缩后的因子  &lt;img src=&quot;https://www.zhihu.com/equation?tex=i&quot; alt=&quot;i&quot; eeimg=&quot;1&quot;/&gt;  的收益率由其主宰；如果 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BSE%7D_i&quot; alt=&quot;\mbox{SE}_i&quot; eeimg=&quot;1&quot;/&gt; 相对 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%83_%CE%BC&quot; alt=&quot;σ_μ&quot; eeimg=&quot;1&quot;/&gt; 很大就说明 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbar+r_i&quot; alt=&quot;\bar r_i&quot; eeimg=&quot;1&quot;/&gt; 不靠谱，则因子 &lt;img src=&quot;https://www.zhihu.com/equation?tex=i&quot; alt=&quot;i&quot; eeimg=&quot;1&quot;/&gt; 的收益率由全部 120 个因子的截面均值主宰。经如此调整后，Chen and Velikov (2019) 得到了如下结果。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-3d0ca713d273e202558ccd0104055625_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;751&quot; data-rawheight=&quot;303&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;751&quot; data-original=&quot;https://pic2.zhimg.com/v2-3d0ca713d273e202558ccd0104055625_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-3d0ca713d273e202558ccd0104055625_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;751&quot; data-rawheight=&quot;303&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;751&quot; data-original=&quot;https://pic2.zhimg.com/v2-3d0ca713d273e202558ccd0104055625_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-3d0ca713d273e202558ccd0104055625_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;排除 selection bias 之后，即便是最好的因子（top 5%），被发表后月均 net return 仅有 0.21% —— 这还是在允许等权构建因子的前提下。当使用市值加权时，该数值降低至 0.07%。基于以上结果，Chen and Velikov (2019) 认为考虑了合理的交易成本后，绝大多数因子在样本外都无法获利。不要忘记，以上结果还是基于对交易进行了优化后的结果。&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;Average investors should expect&lt;/i&gt; &lt;i&gt;&lt;b&gt;only tiny profits&lt;/b&gt;&lt;/i&gt; &lt;i&gt;from selected, cost-mitigated anomaly strategies.&lt;/i&gt;&lt;/blockquote&gt;&lt;h2&gt;&lt;b&gt;04 结语&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;由于曝光导致错误定价减弱、因子拥挤以及交易成本等原因，因子样本外表现变差是因子投资中必须面对的问题。这也催生了业界对因子择时的极大兴趣，并尝试使用各种手段持续挖新的因子（新的因子意味着曝光少、拥挤度低）。Arnott et al. (2019) 一文也严肃讨论了投资人在因子投资中常犯的三大错误，第一条就是对样本内的表现非理性外推，造成对因子样本外的表现缺乏理性预期。&lt;/p&gt;&lt;p&gt;另外，当因子表现变差时，人们由此想到的另一个问题是因子是否会失效。对此，我们认为如果因子背后的原因是风险补偿或者错误定价，那么还是有理由相信因子长期来看会有效的。在这方面，Asness (2015) 有过精彩的讨论。该文认为诸如 value、momentum、carry 等因子在长期来看会持续有效。这背后的原因主要包括：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;从风险的角度来看，因子承担了某些不可预知的风险，需要得到相应的补偿。只要风险是真实存在的，承担这种风险长期就会得到回报。&lt;/li&gt;&lt;li&gt;从行为金融学的角度来看，投资者认知偏差和信息传播速度等因素可以导致股票的价格偏离内在价值。只要投资者“动物精神”不消失，那么错误定价就会一直存在，就给了使用因子获取收益的机会。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;最后，还有一个事实也不得不提：很多人知道了一个因子，并不代表他会利用这个因子，也并不代表他无条件的信任这个因子，更不代表他会坚定不移的使用这个因子。知道并不意味着懂，懂并不意味着会用，会用也并不意味着始终如一。因此，有充分先验依据的因子的长期表现依然值得期待。&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;参考文献&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Arnott, R., C. R. Harvey, V. Kalesnik, and J. Linnainmaa (2019). Alice’s adventures in factorland: Three blunders that plague factor investing. &lt;i&gt;The Journal of Portfolio Management&lt;/i&gt;, Vol. 45(4), 18 – 36.&lt;/li&gt;&lt;li&gt;Asness, C. S. (2015). How can a strategy still work if everyone knows about it? AQR Research Insight.&lt;/li&gt;&lt;li&gt;Asness, C. S. and A. Frazzini (2013). The devil in HML’s details. &lt;i&gt;The Journal of Portfolio Management&lt;/i&gt;, Vol. 39(4), 49 – 68.&lt;/li&gt;&lt;li&gt;Bayraktar, M., S. Doole, A. Kassam, and S. Radchenko (2015). Lost in the crowd? Identifying and measuring crowded strategies and trades. MSCI Research Insight.&lt;/li&gt;&lt;li&gt;Bonne, G., L. Roisenberg, R. Kouzmenko, and P. Zangari (2018). MSCI integrated factor crowding model. MSCI Research Insight.&lt;/li&gt;&lt;li&gt;Bowles, B., A. V. Reed, M. Ringgenberg, and J. R. Thornock (2019). Anomaly time. SSRN Working Paper.&lt;/li&gt;&lt;li&gt;Chen, A. Y. and M. Velikov (2019). Accounting for anomaly zoo: A trading cost perspective. SSRN Working Paper.&lt;/li&gt;&lt;li&gt;De Bondt, W. M. and R. H. Thaler (1985). Does the stock market overreact? Journal of Finance, Vol. 40(3), 793 – 805.&lt;/li&gt;&lt;li&gt;Fama, E. F. and K. R. French (1993). Common risk factors in the returns on stocks and bonds. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 33(1), 3 – 56.&lt;/li&gt;&lt;li&gt;Khandani, A. E. and A. W. Lo (2011). What happened to the quants in August 2007? Evidence from factors and transactions data. &lt;i&gt;Journal of Financial Markets&lt;/i&gt;, Vol. 14(1), 1 – 46.&lt;/li&gt;&lt;li&gt;McLean, R.D. and J. Pontiff (2016). Does academic research destroy stock return predictability? &lt;i&gt;Journal of Finance&lt;/i&gt;, Vol. 71(1), 5 – 32.&lt;/li&gt;&lt;li&gt;Novy-Marx, R. and M. Velikov (2015). A taxonomy of anomalies and their trading costs. &lt;i&gt;Review of Financial Studies&lt;/i&gt;, Vol. 29(1), 104 – 147.&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;免责声明：&lt;/b&gt;文章内容不可视为投资意见。市场有风险，入市需谨慎。&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处。已委托“维权骑士”(&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//rightknights.com/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;维权骑士_免费版权监测/版权保护/内容多平台分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2019-12-17-96990210</guid>
<pubDate>Tue, 17 Dec 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>因子样本外表现为什么变差？</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2019-12-12-96990210.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/96990210&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-506754755985b7fe2c33deb05a917583_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;摘要&lt;/b&gt;&lt;/p&gt;&lt;p&gt;曝光导致错误定价减弱、因子拥挤和交易成本是因子样本外变差的三大原因。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;00 引言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;因子样本外的表现较样本内变差是人们的共识。这里的因子包括异象（anomalies）和传统意义上的风格 beta 因子，在下文不做区分，统称为因子。造成因子样本内、外表现差异的最主要原因自然是样本内的 data snooping（即因子本来就是假的），但如果因子确实是真实的，那么它们在样本外变差的原因是什么呢？学术界和业界的主要观点包括以下三种：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;b&gt;曝光导致错误定价减弱&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;因子拥挤&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;交易成本&lt;/b&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;在 2019 年 9 月刚刚结束的 Wharton 商学院 Jacobs Levy Center 年会中，一共深入讨论了四篇论文，其中两篇就和因子样本外表现有关，它们分别是 Bowles et al. (2019) 以及 Chen and Velikov (2019)，足见这个话题的重要性。具体来说，Bowles et al. (2019) 以 Anomaly Time 为题从“曝光导致错误定价减弱”的角度谈论了因子的表现；而 Chen and Velikov (2019) 则从“交易成本”的角度指出，在考虑了非常合理的费用之后，绝大多数因子在样本外根本无法赚钱。&lt;/p&gt;&lt;p&gt;本文就来简要探讨一下因子样本外表现变差的三个原因。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;01 曝光导致错误定价减弱&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;因子代表着市场某方面的非有效性、代表了某种 mispricing（错误定价）。&lt;/b&gt;只要套利限制不是过大，那么聪明的投资者一定会先人一步去交易这个因子，导致错误定价收窄，这就解释了为什么&lt;b&gt;当因子被发表后，它的收益往往也跟着显著下降。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;在这方面，McLean and Pontiff (2016)  的研究颇具代表性。该文研究了 97 个因子，发现因子样本外的表现比样本内的表现下降了 26%、而发表后（post-publication）的表现较样本内则下降了 58%。McLean and Pontiff (2016)  考虑样本内外差异是为了控制过拟合的影响。上述结果表明，58% 与 26% 之差 —— 即 32% —— 就是发表本身造成因子效果的减弱。McLean and Pontiff (2016)  把它称作 publication-informed trading。这背后的逻辑链是：因子被发表导致它被公布于众 --&amp;gt; 越来越多的人交易该因子从而减弱了错误定价 --&amp;gt; 最终导致因子收益率降低。&lt;/p&gt;&lt;p&gt;如果说 McLean and Pontiff (2016)  检验了因子的平均收益，Bowles et al. (2019) 则是从时效性的角度展示了因子背后的信息越来越快的被 priced in。长久以来，由于 Fama and French (1993) 的影响太过深远，学术界在研究因子的时候为了避免未来数据，通常采用每年再平衡的方法（量价相关的指标通常是月频再平衡），导致构建因子的指标数据严重滞后。这其中最著名的例子要数 Eugene Fama 的弟子 Cliff Asness 使用月频价格对 HML 的改造（&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzUxNzY0NjU3Mw%3D%3D%26mid%3D2247483911%26idx%3D1%26sn%3D29be96059644fdf80dc9db87a69b9fa5%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Asness and Frazzini 2013&lt;/a&gt;）。使用了月频价格数据后的 HML 较 Fama and French (1993) 三因子的 HML 表现更好，说明了数据时效性的重要性。&lt;/p&gt;&lt;p&gt;再来看个更显著的例子。下图显示了 Reliant Energy Inc. 这家公司 2007 和 2008 两年 10-K filing 的时间，以及按学术界传统每年 6 月底再平衡时该公司的股价变化。在 2007 年 10-K filing 到 6 月底这 85 天内，因最新的财报数据，该公司股价上涨 59.09%。如果按照两个 10-K filing 之间来调仓选入该股票，那么在两个披露期之间可以获利 44.63%；而在传统研究框架下，如果在两个 6 月底调仓，选入该股票却亏损 21.08%。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-a5ef0242551f31c74192fecb9c996fc8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;555&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-a5ef0242551f31c74192fecb9c996fc8_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-a5ef0242551f31c74192fecb9c996fc8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;555&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-a5ef0242551f31c74192fecb9c996fc8_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-a5ef0242551f31c74192fecb9c996fc8_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;对于使用财务指标构造的因子，学术界之所以使用每年再平衡是因为学术界的重心毕竟是 empirical asset pricing。&lt;b&gt;为了研究成果的可复制性和可比性&lt;/b&gt;，大家用的都是同样的数据库、采用同样的再平衡周期，因此也就没有想过要用粒度更细的数据。&lt;/p&gt;&lt;p&gt;Bowles et al. (2019) 一文则另辟蹊径，使用 &lt;b&gt;Compustat Snapshot 数据库&lt;/b&gt;对因子时效进行了分析。用 Bowles et al. (2019) 自己的话说，Snapshot 在学术界用的很少，但它却是有着粒度最细的数据 —— 细到记录财报中&lt;b&gt;每个单一变量&lt;/b&gt;更新的时间：&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;For&lt;/i&gt; &lt;i&gt;&lt;b&gt;each&lt;/b&gt;&lt;/i&gt; &lt;i&gt;financial statement&lt;/i&gt; &lt;i&gt;&lt;b&gt;variable&lt;/b&gt;, Snapshot identifies&lt;/i&gt; &lt;i&gt;&lt;b&gt;the first date&lt;/b&gt;&lt;/i&gt; &lt;i&gt;on which each variable was reported.&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;以美股为例，通常上市公司先有 earnings announcement 然后才有 10-Q 和 10-K filing。而在 earnings announcement 上往往只会公布 total revenue 和 net income 等少许指标，而在正式的 filing 中才披露全部财报内容。在这种情况下，Snapshot 数据库会在 earnings announcement 当日更新 total revenue 和 net income 数据，而等到实际 filing 之后再更新其他数据。因此，使用 Snapshot 数据可以保证在用来计算因子的指标被更新后，第一时间更新因子、进行投资组合的再平衡。&lt;/p&gt;&lt;p&gt;利用 Snapshot 数据，Bowles et al. (2019) 研究了一些常见的源自财务数据的因子，发现绝大多数因子在最新数据更新后的 120 天之内（特别是最初的 30 天内）能够获得显著的超额收益。而在 120 天之后，超额收益消失（下图）。不过，Bowles et al. (2019) 也指出，最近几年的实证结果显示，因子的超额收益消失的更快。基于这些发现，Bowles et al. (2019) 认为因子是真实的（而非 data snooping 出来的），但很快就会因套利交易而消失。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-3d261a3427bde6d4c651f1f51cb16c6b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;899&quot; data-rawheight=&quot;627&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;899&quot; data-original=&quot;https://pic4.zhimg.com/v2-3d261a3427bde6d4c651f1f51cb16c6b_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-3d261a3427bde6d4c651f1f51cb16c6b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;899&quot; data-rawheight=&quot;627&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;899&quot; data-original=&quot;https://pic4.zhimg.com/v2-3d261a3427bde6d4c651f1f51cb16c6b_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-3d261a3427bde6d4c651f1f51cb16c6b_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;Bowles et al. (2019) 针对美股的研究和前不久天风证券的一篇《和时间赛跑 —— 利用实时财务信息增强组合收益》针对 A 股的报告异曲同工。该研究显示，利用业绩预告和快报能够提升财务信息的时效性，提高财务因子的表现。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;02 因子拥挤&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;造成因子样本外变差的第二个原因是&lt;b&gt;因子拥挤（factor crowding）&lt;/b&gt;。&lt;/p&gt;&lt;p&gt;通常来说，因子都有周期性。当某类因子好使的时候，就会造成更多的资金引入，从而出现因子拥挤，并降低该因子未来的预期收益率。而 rule-based （使用相似的指标排序、接近的调仓频率）的因子投资无疑加剧了这种负面影响。&lt;/p&gt;&lt;p&gt;由于因子拥挤度和因子未来收益率呈现负相关，如何定量计算因子拥挤度就成为人们关注的问题。在这方面，MSCI 整理了相关研究，提出五个描述因子拥挤度的代理指标（Bayraktar et al. 2015，Bonne et al. 2018）。这五个指标是：valuation spread、short Interest spread、pairwise correlation、factor volatility 以及 factor reversal。考虑到由于制度问题，short interest spread 在 A 股上并不适用，下面对其他四个指标做简要介绍。海通证券的报告《因子失效预警：因子拥挤》针对 A 股对上述四个指标进行了分析。&lt;/p&gt;&lt;p&gt;&lt;b&gt;2.1 Valuation Spread&lt;/b&gt;&lt;/p&gt;&lt;p&gt;顾名思义，valuation spread（估值价差）考虑的正是因子的估值。关于因子估值在 A 股上的实证，感兴趣的小伙伴请参考&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzI3Mjk5OTU1Ng%3D%3D%26mid%3D2247483923%26idx%3D1%26sn%3Ddd5e368d21c71137a7d2fd971af7c970%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;《你家因子便宜吗？&lt;/a&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzI3Mjk5OTU1Ng%3D%3D%26mid%3D2247483923%26idx%3D1%26sn%3Ddd5e368d21c71137a7d2fd971af7c970%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;——基于value spread的因子择时研究》&lt;/a&gt;。这背后的逻辑是，当更多资金涌入某个因子时（特别是多头时），会造成受波及股票的价格上涨，使它们的估值变高。因此，因子估值和因子拥挤度成正相关，是一个不错代理指标。&lt;/p&gt;&lt;p&gt;估值价差的计算方法十分直观。首先选择一个合适的股票估值指标，比如 B/P，然后分别计算因子多空两头组合中该估值指标的中位数，以此作为多空两头的估值，最后这两个估值差就是因子的估值价差。以 B/P 为例，Bonne et al. (2018) 使用的计算公式为：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvaluation+spread%7D%3D%5Cdisplaystyle%5Cln%5Cleft%28%5Cfrac%7B%5Cmbox%7Bmedian+B%2FP+in+long+leg%7D%7D%7B%5Cmbox%7Bmedian+B%2FP+in+short+leg%7D%7D%5Cright%29&quot; alt=&quot;\mbox{valuation spread}=\displaystyle\ln\left(\frac{\mbox{median B/P in long leg}}{\mbox{median B/P in short leg}}\right)&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;&lt;b&gt;2.2 Pairwise Correlation&lt;/b&gt;&lt;/p&gt;&lt;p&gt;第二个指标是 Pairwise Correlation（配对相关性）。它是为了从因子投资组合内股票收益率的相关程度来试图揭示资金持仓的集中程度，并以此来评价因子的拥挤程度。为了计算该指标，Bonne et al. (2018) 采用了如下步骤：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;将因子多（空）头内的股票做市场、市值等中性化处理，得到残差；&lt;/li&gt;&lt;li&gt;使用 63 个交易日的残差计算每个股票和其所在多、空头内平均残差收益率的相关性。以多头为例，使用多头组合中第 i 支股票的残差收益率和剩余股票残差收益率均值计算相关系数。空头处理相同。&lt;/li&gt;&lt;li&gt;计算多、空两头组内所有股票相关系数的均值；&lt;/li&gt;&lt;li&gt;将多、空两头相关系数均值再取平均，得到该因子 Pairwise Correlation 的原始值，最后再将该值进行标准化就得到最终该因子的 Pairwise Correlation。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;b&gt;2.3 Factor Volatility&lt;/b&gt;&lt;/p&gt;&lt;p&gt;由于资金的流入会加剧因子收益率的波动，因此 Bonne et al. (2018) 从这个角度提出了衡量因子拥挤度的第三个指标：Factor Volatility（因子波动率）。值得一提的是，Bonne et al. (2018) 使用的是预测的未来因子波动率相对未来市场波动率的比值来计算该指标。他们认为这么做可以有效的控制市场波动率变化造成的影响。在实际操作中，一个简化的处理方法是使用因子的历史波动率。&lt;/p&gt;&lt;p&gt;&lt;b&gt;2.4 Factor Reversal&lt;/b&gt;&lt;/p&gt;&lt;p&gt;最后一个指标是 Factor Reversal（因子反转）。De Bondt and Thaler (1985) 这篇著名的论文表明美股在 3 到 5 年的中长期尺度上存在反转。由于因子是股票构成的投资组合，因此我们可以自然的从股票的反转延伸出因子的反转。Bonne et al. (2018) 使用因子过去三年的累积收益率计算该指标。&lt;/p&gt;&lt;p&gt;以前文提到的《因子失效预警：因子拥挤》研究结果为例，下图展示了估值价差和因子反转两个因子拥挤度指标和 A 股上一些常见因子未来收益率的关系（之所以没有放另外两个指标的结果是因为报告中的计算方法和 Bonne et al. 2018 的方法差异较大；方法并无优劣之分，但因实证结果并不直接对应前文介绍的方法，故略去）。图中结果显示，对其中大部分因子，这两个指标和因子未来收益率成负相关，说明该因子拥挤会造成因子表现变差。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-55557f4d5c71fa6e8c53a1d4b1d48306_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;364&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-55557f4d5c71fa6e8c53a1d4b1d48306_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-55557f4d5c71fa6e8c53a1d4b1d48306_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;364&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-55557f4d5c71fa6e8c53a1d4b1d48306_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-55557f4d5c71fa6e8c53a1d4b1d48306_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;最后，因子拥挤也会引发流动性冲击。一旦市场中发生冲击因子的事件后，持有相似头寸的管理人会竞相卖出手中的股票，由此产生的流动性危机会造成很大的亏损。2007 年 8 月，美股市场上一些非常优秀的量化对冲基金在短时间内录得了巨大的亏损。Khandani and Lo (2011) 对此进行了研究并发现，很多基金经理在短时间内清理了相似的头寸，巨大的抛压对流动性造成了巨大的打击、使得这些股票的价格在短时间内大幅下跌。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;03 交易成本&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;交易成本是因子在样本外的效果较样本内显著变差的第三个原因。&lt;/p&gt;&lt;p&gt;&lt;b&gt;学术论文通常不会对交易费用给予充分的考虑，这会造成对因子收益率的高估。&lt;/b&gt;此外，由于因子投资组合一般都是多、空对冲的组合，如果不合理考虑做空限制，也会高估因子的收益。Novy-Marx and Velikov (2015) 研究了交易费用对因子效果的影响，并提出三个思路降低交易成本：（1）仅使用交易费用低的股票构建因子组合；（2）降低因子组合再平衡的频率；（3）在交易时考虑更严格的买卖价差约束。&lt;/p&gt;&lt;p&gt;在 Chen and Velikov (2019) 一文中，二位作者使用 &lt;b&gt;effective spread（有效价差）&lt;/b&gt;的概念代替传统的 bid-ask spread，对多达 120 种因子进行了研究。他们的研究发现 …… 哎，先上图吧。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-5d8545bd2c7fb372fb44982e2e191473_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;807&quot; data-rawheight=&quot;428&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;807&quot; data-original=&quot;https://pic4.zhimg.com/v2-5d8545bd2c7fb372fb44982e2e191473_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-5d8545bd2c7fb372fb44982e2e191473_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;807&quot; data-rawheight=&quot;428&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;807&quot; data-original=&quot;https://pic4.zhimg.com/v2-5d8545bd2c7fb372fb44982e2e191473_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-5d8545bd2c7fb372fb44982e2e191473_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;上图中，蓝色的 bar 代表着 120 个因子样本内的平均 gross 收益率（不考虑任何交易成本）；黄色 bar 为这些因子在发表后的平均 gross 收益率；红色 bar 为考虑了交易成本后，这些因子的平均收益率 —— &lt;b&gt;负的&lt;/b&gt;。&lt;/p&gt;&lt;p&gt;来看下具体研究方法。Chen and Velikov (2019) 对 effective spread 的定义为：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Beffective+spread%7D%3D%5Cdisplaystyle+2%5Ctimes%5Cleft%28%5Cln%28%5Cmbox%7Btrade+price%7D%29-%5Cln%28%5Cmbox%7Bquote+midpoint%7D%29%5Cright%29&quot; alt=&quot;\mbox{effective spread}=\displaystyle 2\times\left(\ln(\mbox{trade price})-\ln(\mbox{quote midpoint})\right)&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;为了考虑交易成本，他们假设每次调仓时的交易费用为上述 effective spread 的一半。从上述定义不难看出，因子的费后 net return 和换手率以及换仓时的 effective spread 息息相关：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bnet+return%7D%3D%5Cdisplaystyle+%5Cmbox%7Bgross+return%7D-%5Cmbox%7Bturnover%7D%5Ctimes%5Cmbox%7Beffective+spread%7D&quot; alt=&quot;\mbox{net return}=\displaystyle \mbox{gross return}-\mbox{turnover}\times\mbox{effective spread}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;有必要指出的是，Chen and Velikov (2019) 的研究仅考虑交易费用，并不考虑任何冲击成本。这意味着考虑了冲击成本后，因子样本外的 net return 只能更惨。下表显示了在考虑了成本后，120 个因子在样本内、外的收益情况（括号中为标准差）。结果显示，考虑成本后，即便是样本内，这些因子的月均收益仅有 0.05%，而样本外的收益更是小于零。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-65f3dc33c08959a08315feb8f2824e05_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;865&quot; data-rawheight=&quot;361&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;865&quot; data-original=&quot;https://pic2.zhimg.com/v2-65f3dc33c08959a08315feb8f2824e05_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-65f3dc33c08959a08315feb8f2824e05_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;865&quot; data-rawheight=&quot;361&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;865&quot; data-original=&quot;https://pic2.zhimg.com/v2-65f3dc33c08959a08315feb8f2824e05_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-65f3dc33c08959a08315feb8f2824e05_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;下图展示了样本外，这 120 个因子的 net returns 的分布。这些 net returns 经过了一定的交易优化处理，有效降低了换手率和交易成本，因此整体来看所有因子的 net return 均值是大于零的，而非上表中 -0.03% 那么惨。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-72ba155e7d1058b8443a9f9279aeedf8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;688&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-72ba155e7d1058b8443a9f9279aeedf8_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-72ba155e7d1058b8443a9f9279aeedf8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;688&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-72ba155e7d1058b8443a9f9279aeedf8_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-72ba155e7d1058b8443a9f9279aeedf8_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;这个分布看上去像是一个均值接近零的正态分布，和随机因子的表现并无太大差异（即如果我们使用完全随机生成的 120 个因子，其中也总会有一些是“显著”的）。由于发表的因子都多少存在 selection bias，因此面对上述结果，Chen and Velikov (2019) 不禁发问：排除运气后，还有多少因子是显著的？为了回答上述问题，他们采用了 empirical Bayes 方法对 selection bias 进行修正。&lt;/p&gt;&lt;p&gt;Chen and Velikov (2019) 假设因子  &lt;img src=&quot;https://www.zhihu.com/equation?tex=i&quot; alt=&quot;i&quot; eeimg=&quot;1&quot;/&gt;  在被发表后的样本平均收益率 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbar+r_i&quot; alt=&quot;\bar r_i&quot; eeimg=&quot;1&quot;/&gt; 由真实 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%BC_i&quot; alt=&quot;μ_i&quot; eeimg=&quot;1&quot;/&gt; 和噪音 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B5_i&quot; alt=&quot;ε_i&quot; eeimg=&quot;1&quot;/&gt; 决定：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbar+r_i%3D%5Cmu_i%2B%5Cvarepsilon_i&quot; alt=&quot;\bar r_i=\mu_i+\varepsilon_i&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;其中 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B5_i&quot; alt=&quot;ε_i&quot; eeimg=&quot;1&quot;/&gt; 满足正态分布 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmathcal%7BN%7D%280%2C+%5Cmbox%7BSE%7D_i%29&quot; alt=&quot;\mathcal{N}(0, \mbox{SE}_i)&quot; eeimg=&quot;1&quot;/&gt; ，这里 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BSE%7D_i&quot; alt=&quot;\mbox{SE}_i&quot; eeimg=&quot;1&quot;/&gt; 是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbar+r_i&quot; alt=&quot;\bar r_i&quot; eeimg=&quot;1&quot;/&gt; 的 standard error。Chen and Velikov (2019) 进一步假设所有因子 net return 的真实均值 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%BC_i&quot; alt=&quot;μ_i&quot; eeimg=&quot;1&quot;/&gt; 都满足如下正态分布：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmu_i%5Csim%5Cmathcal%7BN%7D%28%5Cmu_%7B%5Cmu%7D%2C%5Csigma_%7B%5Cmu%7D%29&quot; alt=&quot;\mu_i\sim\mathcal{N}(\mu_{\mu},\sigma_{\mu})&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;Chen and Velikov (2019) 采用 method of moments 对参数 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%BC_%CE%BC&quot; alt=&quot;μ_μ&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%83_%CE%BC&quot; alt=&quot;σ_μ&quot; eeimg=&quot;1&quot;/&gt; 进行估计：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+%5Chat%5Cmu_%7B%5Cmu%7D%26%3D%26%5Cdisplaystyle%5Cfrac%7B1%7D%7BN%7D%5Csum_i%5Cbar+r_i%5C%5C+%5Chat%5Csigma_%7B%5Cmu%7D%5E2%26%3D%26%5Cdisplaystyle%5Cmax%5Cleft%5C%7B%5Cleft%5B%5Cfrac%7B1%7D%7BN%7D%5Csum_i%28%5Cbar+r_i-%5Chat%5Cmu_%7B%5Cmu%7D%29%5E2-%5Cfrac%7B1%7D%7BN%7D%5Csum_i%5Cmbox%7BSE%7D_i%5E2%5Cright%5D%2C0%5Cright%5C%7D+%5Cend%7Barray%7D&quot; alt=&quot;\begin{array}{rll} \hat\mu_{\mu}&amp;amp;=&amp;amp;\displaystyle\frac{1}{N}\sum_i\bar r_i\\ \hat\sigma_{\mu}^2&amp;amp;=&amp;amp;\displaystyle\max\left\{\left[\frac{1}{N}\sum_i(\bar r_i-\hat\mu_{\mu})^2-\frac{1}{N}\sum_i\mbox{SE}_i^2\right],0\right\} \end{array}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;上式说明 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+%CE%BC_%CE%BC&quot; alt=&quot;\hat μ_μ&quot; eeimg=&quot;1&quot;/&gt; 是所有因子平均收益率的截面均值。看到这里，似乎还没见 Bayes 的影子。别着急，有了 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbar+r_i&quot; alt=&quot;\bar r_i&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%BC_%CE%BC&quot; alt=&quot;μ_μ&quot; eeimg=&quot;1&quot;/&gt; 的估计，接下来马上就要&lt;b&gt;贝叶斯收缩（Bayes shrinkage）&lt;/b&gt;了：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D%5B%5Cmu_i%7Cr_i%2C%5Cmbox%7BSE%7D_i%5D%3Ds_i%5Cmu_%7B%5Cmu%7D%2B%281-s_i%29%5Cbar+r_i&quot; alt=&quot;\mbox{E}[\mu_i|r_i,\mbox{SE}_i]=s_i\mu_{\mu}+(1-s_i)\bar r_i&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;上式中 &lt;img src=&quot;https://www.zhihu.com/equation?tex=s_i&quot; alt=&quot;s_i&quot; eeimg=&quot;1&quot;/&gt; 是收缩系数，它由 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbar+r_i&quot; alt=&quot;\bar r_i&quot; eeimg=&quot;1&quot;/&gt; 的 standard error（ &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BSE%7D_i&quot; alt=&quot;\mbox{SE}_i&quot; eeimg=&quot;1&quot;/&gt; ）和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%BC_i&quot; alt=&quot;μ_i&quot; eeimg=&quot;1&quot;/&gt; 的标准差 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%83_%CE%BC&quot; alt=&quot;σ_μ&quot; eeimg=&quot;1&quot;/&gt; 的相对大小决定：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=s_i%3D%5Cdisplaystyle%5Cfrac%7B%5Cmbox%7BSE%7D%5E2_i%7D%7B%5Csigma_%7B%5Cmu%7D%5E2%2B%5Cmbox%7BSE%7D_i%5E2%7D&quot; alt=&quot;s_i=\displaystyle\frac{\mbox{SE}^2_i}{\sigma_{\mu}^2+\mbox{SE}_i^2}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;结合 &lt;img src=&quot;https://www.zhihu.com/equation?tex=s_i&quot; alt=&quot;s_i&quot; eeimg=&quot;1&quot;/&gt; 的定义不难看出，如果 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BSE%7D_i&quot; alt=&quot;\mbox{SE}_i&quot; eeimg=&quot;1&quot;/&gt; 小说明 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbar+r_i&quot; alt=&quot;\bar r_i&quot; eeimg=&quot;1&quot;/&gt; 可信，则收缩后的因子  &lt;img src=&quot;https://www.zhihu.com/equation?tex=i&quot; alt=&quot;i&quot; eeimg=&quot;1&quot;/&gt;  的收益率由其主宰；如果 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BSE%7D_i&quot; alt=&quot;\mbox{SE}_i&quot; eeimg=&quot;1&quot;/&gt; 相对 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%83_%CE%BC&quot; alt=&quot;σ_μ&quot; eeimg=&quot;1&quot;/&gt; 很大就说明 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbar+r_i&quot; alt=&quot;\bar r_i&quot; eeimg=&quot;1&quot;/&gt; 不靠谱，则因子 &lt;img src=&quot;https://www.zhihu.com/equation?tex=i&quot; alt=&quot;i&quot; eeimg=&quot;1&quot;/&gt; 的收益率由全部 120 个因子的截面均值主宰。经如此调整后，Chen and Velikov (2019) 得到了如下结果。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-3d0ca713d273e202558ccd0104055625_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;751&quot; data-rawheight=&quot;303&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;751&quot; data-original=&quot;https://pic2.zhimg.com/v2-3d0ca713d273e202558ccd0104055625_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-3d0ca713d273e202558ccd0104055625_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;751&quot; data-rawheight=&quot;303&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;751&quot; data-original=&quot;https://pic2.zhimg.com/v2-3d0ca713d273e202558ccd0104055625_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-3d0ca713d273e202558ccd0104055625_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;排除 selection bias 之后，即便是最好的因子（top 5%），被发表后月均 net return 仅有 0.21% —— 这还是在允许等权构建因子的前提下。当使用市值加权时，该数值降低至 0.07%。基于以上结果，Chen and Velikov (2019) 认为考虑了合理的交易成本后，绝大多数因子在样本外都无法获利。不要忘记，以上结果还是基于对交易进行了优化后的结果。&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;Average investors should expect&lt;/i&gt; &lt;i&gt;&lt;b&gt;only tiny profits&lt;/b&gt;&lt;/i&gt; &lt;i&gt;from selected, cost-mitigated anomaly strategies.&lt;/i&gt;&lt;/blockquote&gt;&lt;h2&gt;&lt;b&gt;04 结语&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;由于曝光导致错误定价减弱、因子拥挤以及交易成本等原因，因子样本外表现变差是因子投资中必须面对的问题。这也催生了业界对因子择时的极大兴趣，并尝试使用各种手段持续挖新的因子（新的因子意味着曝光少、拥挤度低）。Arnott et al. (2019) 一文也严肃讨论了投资人在因子投资中常犯的三大错误，第一条就是对样本内的表现非理性外推，造成对因子样本外的表现缺乏理性预期。&lt;/p&gt;&lt;p&gt;另外，当因子表现变差时，人们由此想到的另一个问题是因子是否会失效。对此，我们认为如果因子背后的原因是风险补偿或者错误定价，那么还是有理由相信因子长期来看会有效的。在这方面，Asness (2015) 有过精彩的讨论。该文认为诸如 value、momentum、carry 等因子在长期来看会持续有效。这背后的原因主要包括：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;从风险的角度来看，因子承担了某些不可预知的风险，需要得到相应的补偿。只要风险是真实存在的，承担这种风险长期就会得到回报。&lt;/li&gt;&lt;li&gt;从行为金融学的角度来看，投资者认知偏差和信息传播速度等因素可以导致股票的价格偏离内在价值。只要投资者“动物精神”不消失，那么错误定价就会一直存在，就给了使用因子获取收益的机会。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;最后，还有一个事实也不得不提：很多人知道了一个因子，并不代表他会利用这个因子，也并不代表他无条件的信任这个因子，更不代表他会坚定不移的使用这个因子。知道并不意味着懂，懂并不意味着会用，会用也并不意味着始终如一。因此，有充分先验依据的因子的长期表现依然值得期待。&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;参考文献&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Arnott, R., C. R. Harvey, V. Kalesnik, and J. Linnainmaa (2019). Alice’s adventures in factorland: Three blunders that plague factor investing. &lt;i&gt;The Journal of Portfolio Management&lt;/i&gt;, Vol. 45(4), 18 – 36.&lt;/li&gt;&lt;li&gt;Asness, C. S. (2015). How can a strategy still work if everyone knowns about it? AQR Research Insight.&lt;/li&gt;&lt;li&gt;Asness, C. S. and A. Frazzini (2013). The devil in HML’s details. &lt;i&gt;The Journal of Portfolio Management&lt;/i&gt;, Vol. 39(4), 49 – 68.&lt;/li&gt;&lt;li&gt;Bayraktar, M., S. Doole, A. Kassam, and S. Radchenko (2015). Lost in the crowd? Identifying and measuring crowded strategies and trades. MSCI Research Insight.&lt;/li&gt;&lt;li&gt;Bonne, G., L. Roisenberg, R. Kouzmenko, and P. Zangari (2018). MSCI integrated factor crowding model. MSCI Research Insight.&lt;/li&gt;&lt;li&gt;Bowles, B., A. V. Reed, M. Ringgenberg, and J. R. Thornock (2019). Anomaly time. SSRN Working Paper.&lt;/li&gt;&lt;li&gt;Chen, A. Y. and M. Velikov (2019). Accounting for anomaly zoo: A trading cost perspective. SSRN Working Paper.&lt;/li&gt;&lt;li&gt;De Bondt, W. M. and R. H. Thaler (1985). Does the stock market overreact? Journal of Finance, Vol. 40(3), 793 – 805.&lt;/li&gt;&lt;li&gt;Fama, E. F. and K. R. French (1993). Common risk factors in the returns on stocks and bonds. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 33(1), 3 – 56.&lt;/li&gt;&lt;li&gt;Khandani, A. E. and A. W. Lo (2011). What happened to the quants in August 2007? Evidence from factors and transactions data. &lt;i&gt;Journal of Financial Markets&lt;/i&gt;, Vol. 14(1), 1 – 46.&lt;/li&gt;&lt;li&gt;McLean, R.D. and J. Pontiff (2016). Does academic research destroy stock return predictability? &lt;i&gt;Journal of Finance&lt;/i&gt;, Vol. 71(1), 5 – 32.&lt;/li&gt;&lt;li&gt;Novy-Marx, R. and M. Velikov (2015). A taxonomy of anomalies and their trading costs. &lt;i&gt;Review of Financial Studies&lt;/i&gt;, Vol. 29(1), 104 – 147.&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;免责声明：&lt;/b&gt;文章内容不可视为投资意见。市场有风险，入市需谨慎。&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处。已委托“维权骑士”(&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//rightknights.com/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;维权骑士_免费版权监测/版权保护/内容多平台分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2019-12-12-96990210</guid>
<pubDate>Thu, 12 Dec 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>残差动量 —— 有理有据还是数据挖掘？</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2019-12-04-95259084.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/95259084&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-9b0d610e327f63373ff51c4ed40c4f72_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;作者：&lt;/b&gt;刀疤连（Chihiro Quantitative Research）、llanglli（因子动物园）；石川&lt;/p&gt;&lt;p&gt;&lt;b&gt;摘要：&lt;/b&gt;与传统动量不同，残差动量在 A 股效果显著。但这背后是有理有据还是数据挖掘？&lt;/p&gt;&lt;h2&gt;&lt;b&gt;1 引言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;动量，更确切地说是 Jegadeesh and Titman (1993) 提出的截面相对强弱，一直以来是美股生命力最旺盛的异象之一。无论是 Fama and French (1993) 三因子模型还是 Fama and French (2015) 五因子模型均无法解释动量策略（Blitz et al. 2018），因此 Eugene Fama 也不得不承认它是最显著的异象。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-eecf1c351ae4d09fa2d438264c4d3c0b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;968&quot; data-rawheight=&quot;331&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;968&quot; data-original=&quot;https://pic4.zhimg.com/v2-eecf1c351ae4d09fa2d438264c4d3c0b_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-eecf1c351ae4d09fa2d438264c4d3c0b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;968&quot; data-rawheight=&quot;331&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;968&quot; data-original=&quot;https://pic4.zhimg.com/v2-eecf1c351ae4d09fa2d438264c4d3c0b_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-eecf1c351ae4d09fa2d438264c4d3c0b_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;在美股上，动量策略虽然长期来看很不错，但这种做多前期 Winner 做空前期 Loser 的对冲组合却时不时会来个 crash，俗称动量崩溃（momentum crash），即动量策略会遭遇不多但持续时间长、幅度大的下跌。学术界的研究认为这和该组合的动态风险敞口有关。Geczy and Samonov (2013) 基于超长的美国股市数据指出，动量效应对于市场组合有着动态的暴露，具体敞口则取决于市场状态。当市场从一种状态转换到另一种状态的初期，动量组合对于最新市场状态有着负的暴露，从而导致市场转换期的大幅损失。Daniel and Moskowitz (2016) 发现动量崩溃与该策略的尾部风险有关。崩溃往往发生在市场恐慌时，此时资产价格大跌而波动率大幅上升，这与 Geczy and Samonov (2013) 的发现一致。&lt;/p&gt;&lt;p&gt;为了改善动量策略的极端表现，2011 年来自 Robeco 的 David Blitz 领衔发表了 Blitz, Huij, and Martens (2011) 一文，提出了残差动量（residual momentum）策略。该策略使用股票相对于 Fama and French (1993) 三因子模型的残差收益率，经残差波动率调整后计算了残差动量（因此也被称为异质动量，idiosyncratic momentum）。Blitz, Huij, and Martens (2011) 的实证结果显示，该策略比传统动量策略能够获得更高的风险收益比。除此之外，Hanauer and Windmueller (2019) 指出残差动量在传动动量 crash 的时期表现更好，能够极大降低亏损。&lt;/p&gt;&lt;p&gt;尽管动量策略在美股呼风唤雨，但是它到了 A 股中似乎画风一变、难有作为。那么，残差动量又如何呢？Lin (2019) 一文使用 Blitz, Huij, and Martens (2011) 的思路在 A 股上实证了残差动量策略，得出了惊人的效果（下图）。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-bd4ce3733210b19e5f194861b15bd110_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;804&quot; data-rawheight=&quot;661&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;804&quot; data-original=&quot;https://pic1.zhimg.com/v2-bd4ce3733210b19e5f194861b15bd110_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-bd4ce3733210b19e5f194861b15bd110_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;804&quot; data-rawheight=&quot;661&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;804&quot; data-original=&quot;https://pic1.zhimg.com/v2-bd4ce3733210b19e5f194861b15bd110_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-bd4ce3733210b19e5f194861b15bd110_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;怎么样？多、空对冲得到的残差动量（红线）累积收益率稳健上行（Panel A），滚动三年窗口的夏普率（Panel B）在整个实证窗口内均为正，且在很高的比例下在 1.0 以上，这种表现让多少风格因子汗颜？&lt;/p&gt;&lt;p&gt;坦白说，我们第一眼看到这个结果是不信的。再加上 Finance Research Letters 这个期刊的口碑也不是太过硬，更令人增加了几分怀疑。残差动量的计算方法是否合理，即其背后到底代表了什么原因？A 股市场上的残差动量是否真的有如此惊人的表现？带着这些问题，本期搞事情小组就来对残差动量进行深度实证。&lt;/p&gt;&lt;p&gt;先来看看 Blitz, Huij, and Martens (2011) 提出的残差动量计算方法。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;2 计算方法：有理有据？&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;Blitz, Huij, and Martens (2011) 使用 Fama and French (1993) 三因子模型为基准，使用股票月频超额收益和三因子月频收益率数据构建时序回归模型：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=r_%7Bi%2Ct%7D%3D%5Calpha_i%2B%5Cbeta_%7B1%2Ci%7D%5Cmbox%7BRMRF%7D_t%2B%5Cbeta_%7B2%2Ci%7D%5Cmbox%7BSMB%7D_t%2B%5Cbeta_%7B3%2Ci%7D%5Cmbox%7BHML%7D_t%2B%5Cvarepsilon_%7Bi%2Ct%7D&quot; alt=&quot;r_{i,t}=\alpha_i+\beta_{1,i}\mbox{RMRF}_t+\beta_{2,i}\mbox{SMB}_t+\beta_{3,i}\mbox{HML}_t+\varepsilon_{i,t}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;上式中，&lt;img src=&quot;https://www.zhihu.com/equation?tex=r_%7Bi%2C+t%7D&quot; alt=&quot;r_{i, t}&quot; eeimg=&quot;1&quot;/&gt; 为股票 i 在第 t 月相对无风险利率的超额收益，&lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B1_i&quot; alt=&quot;α_i&quot; eeimg=&quot;1&quot;/&gt; 表示三因子模型无法解释的 abnormal return，&lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B5_%7Bi%2C+t%7D&quot; alt=&quot;ε_{i, t}&quot; eeimg=&quot;1&quot;/&gt; 表示残差。在每个 T 月初，Blitz, Huij, and Martens (2011) 构建残差动量的方法包括以下几步：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;使用&lt;b&gt;过去 36 个月&lt;/b&gt;的收益率数据进行上述时序回归，得到参数估计和残差 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B5_%7Bi%2C+t%7D&quot; alt=&quot;ε_{i, t}&quot; eeimg=&quot;1&quot;/&gt; 序列；&lt;/li&gt;&lt;li&gt;在上述回归得到的 36 的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B5_%7Bi%2C+t%7D&quot; alt=&quot;ε_{i, t}&quot; eeimg=&quot;1&quot;/&gt; 中，&lt;b&gt;仅使用 T – 12 到 T – 2&lt;/b&gt; 这 11 个月的残差项 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B5_%7Bi%2C+t%7D&quot; alt=&quot;ε_{i, t}&quot; eeimg=&quot;1&quot;/&gt; ，计算这些残差项的收益率之和；之所以舍弃最近一个月，即 T – 1 月的收益率，是类比常规动量策略对最近一个月短期反转的规避；&lt;/li&gt;&lt;li&gt;同样的，使用 T – 12 到 T – 2 的这 11 个残差项  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B5_%7Bi%2C+t%7D&quot; alt=&quot;ε_{i, t}&quot; eeimg=&quot;1&quot;/&gt; ，计算它们的标准差（也就是常说的残差波动率）；将第二项的&lt;b&gt;残差总收益率除以残差波动率进行标准化&lt;/b&gt;，就得到了最终标准化后的残差动量；通过做多残差动量最高的 10% 并同时做空残差动量最低的 10% 就构建了残差动量因子组合。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;有意思的是，Blitz, Huij, and Martens (2011) 一文仅是使用文字描述了残差动量的计算方法，但并没有给出任何一目了然的公式。不过最近的 Blitz, Hanauer, and Vidojevic (2018) 一文给出了明确的公式：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bresidual+mom%7D_%7Bi%2Ct%7D%3D%5Cdisplaystyle%5Cfrac%7B%5Csum_%7BT-12%7D%5E%7BT-2%7D%5Cvarepsilon_%7Bi%2Ct%7D%7D%7B%5Csqrt%7B%5Csum_%7BT-12%7D%5E%7BT-2%7D%28%5Cvarepsilon_%7Bi%2Ct%7D-%5Cbar%5Cvarepsilon_%7Bi%7D%29%5E2%7D%7D&quot; alt=&quot;\mbox{residual mom}_{i,t}=\displaystyle\frac{\sum_{T-12}^{T-2}\varepsilon_{i,t}}{\sqrt{\sum_{T-12}^{T-2}(\varepsilon_{i,t}-\bar\varepsilon_{i})^2}}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;值得一提的是，该公式的分母中，根号内的部分较常见的方差公式差 1/11 这个系数。但由于它不改变残差动量排名的单调性，因此上式等价于残差总收益被残差波动率进行标准化。搞事情小组就计算残差动量的三个步骤有以下四点疑问。&lt;/p&gt;&lt;p&gt;首先，在时序回归时，Blitz, Huij, and Martens (2011) 考虑了截距项 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B1_i&quot; alt=&quot;α_i&quot; eeimg=&quot;1&quot;/&gt; ，但是并没有把它作为异质动量的一部分。如果仅从“残差”动量这个名字来看，似乎使用回归方程的残差计算无可厚非；但如果抛开新的动量因子叫什么， &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B1_i&quot; alt=&quot;α_i&quot; eeimg=&quot;1&quot;/&gt; 毫无疑问属于收益率中无法被三因子模型解释的部分。Blitz, Huij, and Martens (2011) 给出的理由是， &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B1_i&quot; alt=&quot;α_i&quot; eeimg=&quot;1&quot;/&gt; 的作用是控制模型设定偏误，这个解释似乎是合理的。&lt;/p&gt;&lt;p&gt;其次，在 Blitz, Huij, and Martens (2011) 的方法中，用来计算每个 T 时刻残差动量的残差来自同一个时序回归：使用 36 期月频收益率回归，但只选择了 T – 12 到 T – 2 这 11 个点计算非标准化之前的残差动量。从 OLS 回归隐含的假设来说，残差时间序列应该满足平稳性，且由于回归中考虑了截距项，因此这 36 个残差项的均值严格等于零。因此，从数学上说这 36 个残差项是一个均值为零的平稳序列，而 T – 12 到 T – 2 中间的 11 个点仅仅是这个平稳序列中的一部分。&lt;b&gt;无论这部分的均值是否大于零，它的大小为什么会和该股票未来收益率正相关，而非仅仅是个随机扰动呢（它们仅是一个均值为零的平稳序列中的一部分）？此外，为什么不同股票中，不同平稳残差序列在同一段时期的残差和大小能够预示它们未来预期收益率的差异呢？&lt;/b&gt;Blitz, Huij, and Martens (2011) 一文对这些问题并未给出太多的讨论。&lt;/p&gt;&lt;p&gt;从上面的说明中可以引出第三点疑问。如前所述，Blitz, Huij, and Martens (2011) 在每个月初 T 使用最近 36 个月进行一次回归得到 36 个残差，并使用其中的 11 个计算残差动量，因此这 11 个残差来自同一个回归（如下图）。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-29a561943dbfb3717b4e132adf4fddbe_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;663&quot; data-rawheight=&quot;181&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;663&quot; data-original=&quot;https://pic3.zhimg.com/v2-29a561943dbfb3717b4e132adf4fddbe_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-29a561943dbfb3717b4e132adf4fddbe_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;663&quot; data-rawheight=&quot;181&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;663&quot; data-original=&quot;https://pic3.zhimg.com/v2-29a561943dbfb3717b4e132adf4fddbe_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-29a561943dbfb3717b4e132adf4fddbe_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;与上述方法相对应的，可以考虑计算残差动量的残差来自 11 个不同的回归。比如，对于 T 期，使用 T – 37 到 T – 2 这 36 个月的数据回归，并仅记录 T – 2 的残差，记为 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B5_%7Bi%2C+T-2%7D%5E%7B%281%29%7D&quot; alt=&quot;ε_{i, T-2}^{(1)}&quot; eeimg=&quot;1&quot;/&gt; ，上标 (1) 代表第 1 次回归；然后使用 T – 38 到 T – 3 这 36 个月的数据回归，并仅记录 T – 3 的残差 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B5_%7Bi%2C+T-3%7D%5E%7B%282%29%7D&quot; alt=&quot;ε_{i, T-3}^{(2)}&quot; eeimg=&quot;1&quot;/&gt; ；以此类推，最终使用 T – 47 到 T – 12 这 36 个月的数据回归，并仅记录 T – 12 的残差 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B5_%7Bi%2C+T-12%7D%5E%7B%2811%29%7D&quot; alt=&quot;ε_{i, T-12}^{(11)}&quot; eeimg=&quot;1&quot;/&gt; 。使用上述来自 11 个回归的残差计算残差收益率。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-9f5b310b7d1b6b204913ab629713be28_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;895&quot; data-rawheight=&quot;253&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;895&quot; data-original=&quot;https://pic1.zhimg.com/v2-9f5b310b7d1b6b204913ab629713be28_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-9f5b310b7d1b6b204913ab629713be28_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;895&quot; data-rawheight=&quot;253&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;895&quot; data-original=&quot;https://pic1.zhimg.com/v2-9f5b310b7d1b6b204913ab629713be28_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-9f5b310b7d1b6b204913ab629713be28_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;虽然第二种方法听上去有些怪怪的，也不如 Blitz, Huij, and Martens (2011) 的方法易于理解，但学术界对它也有一定的研究。比如 Gutierrez and Prinsky (2007) 就使用这种方法研究了异质动量。因此，单一回归和多个回归计算残差动量有什么区别就是我们的第三个疑问。本文的实证中将会考虑这两种方法。&lt;/p&gt;&lt;p&gt;最后一点疑问是在计算残差动量时，是否有必要使用残差标准差作为分母，对残差动量进行标准化。对于这个操作，Blitz, Huij, and Martens (2011) 引用 Gutierrez and Prinsky (2007) 的研究指出上述标准化可以降低残差的噪声，得到更加纯净的异质动量，提高残差动量的效果。Blitz, Hanauer, and Vidojevic (2018) 的后续研究强调说无论是否标准化，残差动量本身都可以获得显著的超额收益率。&lt;/p&gt;&lt;p&gt;关于这一点，搞事情小组关注的重点是这波操作在 A 股上是否会“夸大”残差动量的效果。上述标准化将残差标准差作为分母，这意味着当分子上的残差动量相同的情况下，标准化可以起到高配低异质波动、低配高异质波动的情况。搞事情小组之前的研究&lt;a href=&quot;https://zhuanlan.zhihu.com/p/80443596&quot; class=&quot;internal&quot;&gt;《异质波动率之谜》&lt;/a&gt;指出，低异质波动率现象确实存在于 A 股市场，说明如此标准化肯定有助于加强残差动量。因此，如果按照 Blitz, Huij, and Martens (2011) 的方法计算的残差动量在 A 股上有效，那么它到底因为分子的部分、分母的部分、还是两部分均有贡献？这就成为必须回答的问题。在接下来的实证中也将会把这两部分拆开来看。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;3 实证&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;本节和下一节针对 A 股进行实证分析。本节的重点是比较单一回归（Blitz, Huij, and Martens 2011 的方法）和多次回归计算残差动量这两种方法。下一节将会把残差波动率的影响剥离开分析。&lt;/p&gt;&lt;p&gt;在以下的分析中，实证期为 1999 年 1 月 1 日至 2019 年 9 月 30 日；在每月末构建投资组合的时候剔除掉次新股、停牌股、风险警示股、一字涨跌停股；同时考虑等权和市值加权两种情况。在计算残差收益率时，采用搞事情小组维护的以月频进行再平衡灵活版 Fama and French (1993) 三因子模型。&lt;/p&gt;&lt;p&gt;首先来看按照 Blitz, Huij, and Martens (2011) 的方法计算残差动量的结果；结果以 portfolio test result 的方式呈现。下图 1 — 3 显示了这 10 组（第 0 组为残差动量最低；第 9 组为残差动量最高组）以及残差动量因子（即第 9 组减去第 0 组）的累积收益率和风险收益特征，其中 Panel A 为等权、Panel B 为市值加权。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-3953be4c4fc33863d3a59a64fac89145_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;871&quot; data-rawheight=&quot;647&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;871&quot; data-original=&quot;https://pic2.zhimg.com/v2-3953be4c4fc33863d3a59a64fac89145_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-3953be4c4fc33863d3a59a64fac89145_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;871&quot; data-rawheight=&quot;647&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;871&quot; data-original=&quot;https://pic2.zhimg.com/v2-3953be4c4fc33863d3a59a64fac89145_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-3953be4c4fc33863d3a59a64fac89145_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-a820b8e42eaa5fabd4fc82da34ccb5c5_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;878&quot; data-rawheight=&quot;677&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;878&quot; data-original=&quot;https://pic2.zhimg.com/v2-a820b8e42eaa5fabd4fc82da34ccb5c5_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-a820b8e42eaa5fabd4fc82da34ccb5c5_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;878&quot; data-rawheight=&quot;677&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;878&quot; data-original=&quot;https://pic2.zhimg.com/v2-a820b8e42eaa5fabd4fc82da34ccb5c5_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-a820b8e42eaa5fabd4fc82da34ccb5c5_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-f4bd846559839ed665df44d5e11610e7_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;985&quot; data-rawheight=&quot;473&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;985&quot; data-original=&quot;https://pic4.zhimg.com/v2-f4bd846559839ed665df44d5e11610e7_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-f4bd846559839ed665df44d5e11610e7_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;985&quot; data-rawheight=&quot;473&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;985&quot; data-original=&quot;https://pic4.zhimg.com/v2-f4bd846559839ed665df44d5e11610e7_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-f4bd846559839ed665df44d5e11610e7_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;上述结果显示，&lt;b&gt;无论是等权还是市值加权，在 A 股上均可以观察到显著的残差动量效应&lt;/b&gt;（虽然本文的实证结果并没有 Lin 2019 中的惊艳，该文仅考虑了等权的情况）。在等权下，残差动量因子的夏普率高达 0.78，其最大回撤为 -25.35%，有效抵御了 momentum crash 风险。当采用市值加权时，残差动量效果有所减弱，但依然显著。这样的结果和传统截面动量因子在 A 股上的效果截然不同。&lt;/p&gt;&lt;p&gt;当然，面对这样的结果，我们仍然不知道到底是作为分母的残差波动率贡献了多少，该问题将在第四节研究。下面再来看看第二种方法，即采用 11 个回归计算残差收益率、再计算残差动量的结果。下图 4 — 6 显示了相应的 portfolio sort test 结果。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-9cb250b77a030880680aa1f64c37a35e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;891&quot; data-rawheight=&quot;651&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;891&quot; data-original=&quot;https://pic3.zhimg.com/v2-9cb250b77a030880680aa1f64c37a35e_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-9cb250b77a030880680aa1f64c37a35e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;891&quot; data-rawheight=&quot;651&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;891&quot; data-original=&quot;https://pic3.zhimg.com/v2-9cb250b77a030880680aa1f64c37a35e_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-9cb250b77a030880680aa1f64c37a35e_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-b71ad539879548c2d04a0efda480e406_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;873&quot; data-rawheight=&quot;673&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;873&quot; data-original=&quot;https://pic3.zhimg.com/v2-b71ad539879548c2d04a0efda480e406_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-b71ad539879548c2d04a0efda480e406_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;873&quot; data-rawheight=&quot;673&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;873&quot; data-original=&quot;https://pic3.zhimg.com/v2-b71ad539879548c2d04a0efda480e406_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-b71ad539879548c2d04a0efda480e406_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-257dec3f6702cb5a8dbec2bbc57a74df_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;982&quot; data-rawheight=&quot;472&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;982&quot; data-original=&quot;https://pic4.zhimg.com/v2-257dec3f6702cb5a8dbec2bbc57a74df_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-257dec3f6702cb5a8dbec2bbc57a74df_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;982&quot; data-rawheight=&quot;472&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;982&quot; data-original=&quot;https://pic4.zhimg.com/v2-257dec3f6702cb5a8dbec2bbc57a74df_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-257dec3f6702cb5a8dbec2bbc57a74df_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;当采用 11 个不同的回归时，残差动量的效果较前一种方法变差。无论是等权还是市值加权，残差动量因子在 2007 到 2009 年间都经历了长时间且大幅度的回撤。除此之外，这十个 portfolios 的单调性也变差。我们对此的猜想是，使用 11 个不同的回归计算残差收益率这种方法额外引入了不必要的不对称性，即不同时期的残差来自不同的分布。由于残差动量的计算高度依赖参数估计的准确性，长期来看这种方法的不稳定性更高。&lt;/p&gt;&lt;p&gt;需要强调的是，虽然第二种方法不如 Blitz, Huij, and Martens (2011) 的方法，但这种结果上的差异仍然没有回答上一节关于残差动量计算方法的两个问题：（1）为什么均值为零的平稳序列中的一部分和未来收益率正相关；（2）为什么这部分残差能够解释预期收益率的截面差异。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;4 进一步实证&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;第三节的实证结果显示经标准化后的残差动量在 A 股是有效的。本小节的实证就来回答第二个问题：残差波动率在这方面是否起到了显著的作用？&lt;/p&gt;&lt;p&gt;为了控制残差波动率（即作为分母的残差标准差）的影响，本文采用 double dependent sort 进行分析。首先按照残差波动率（记为 ivol）从低到高把所有股票分成五组，然后再把每组内的股票按照原始残差动量（记为 imom）高低分成五组。这样一共得到 25 个投资组合，以考察每个 ivol 组内原始残差动量是否能够解释股票的预期收益率差异。图 7、8 分别显示了等权和市值加权下，这 25 个投资组合的年化收益率。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-71317d4658806a0aef8b8967a1e4378f_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;792&quot; data-rawheight=&quot;722&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;792&quot; data-original=&quot;https://pic4.zhimg.com/v2-71317d4658806a0aef8b8967a1e4378f_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-71317d4658806a0aef8b8967a1e4378f_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;792&quot; data-rawheight=&quot;722&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;792&quot; data-original=&quot;https://pic4.zhimg.com/v2-71317d4658806a0aef8b8967a1e4378f_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-71317d4658806a0aef8b8967a1e4378f_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-b7a69cd3c8f77ab8b066894e2572beed_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;800&quot; data-rawheight=&quot;713&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;800&quot; data-original=&quot;https://pic2.zhimg.com/v2-b7a69cd3c8f77ab8b066894e2572beed_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-b7a69cd3c8f77ab8b066894e2572beed_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;800&quot; data-rawheight=&quot;713&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;800&quot; data-original=&quot;https://pic2.zhimg.com/v2-b7a69cd3c8f77ab8b066894e2572beed_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-b7a69cd3c8f77ab8b066894e2572beed_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;从图 7、8 的结果中可以观察到以下几点：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;在控制了 ivol 之后，每组内的 imom 基本上依然单调，呈现高 imom 比低 imom 组的预期收益率更高的现象，说明原始残差动量就是有效的。&lt;/li&gt;&lt;li&gt;在低 ivol 组内，各 imom 组的收益率比其在高 ivol 组内的对应的 imom 组的收益率更高。&lt;/li&gt;&lt;li&gt;从头（imom4）尾（imom0）两组的区分度来说，&lt;b&gt;imom4 – imom0 的收益率在五个 ivol 组内呈现出倒 U 形&lt;/b&gt;，意味着无论是低波动组还是高波动组，imom 对于截面预期收益率差异的解释都不如在中等 ivol 组内更好。我们对此的猜想是，在高波动组中噪音更高，且 OLS 回归系数的标准误和残差标准差成正比，因此参数估计的误差也更高，这些都对准确计算残差动量有影响；而在低波动组中，残差所代表的和定价有关的信息可能已经反映在了其他风格因子上，从而降低了它的解释能力。&lt;/li&gt;&lt;li&gt;无论是等权还是市值加权，均能观察到上述几点；市值加权较等权的平均收益更低。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;经过以上的分析，我们可以说基于 Blitz, Huij, and Martens (2011) 定义的残差动量在 A 股有效，并非依靠了低异质波动率的原因，作为分子的原始残差动量在没有被标准化的情况下依然能获得显著的超额收益。事实上，作为 robustness check，我们也仅使用原始残差动量（即未经残差波动率标准化）构建了残差动量因子，实证结果显示它在 A 股上的效果甚至超过了经标准化的版本（等权时，未经标准化的残差动量因子夏普率为 .82，高于经标准化后的 .78；市值加权时，前者的夏普率为 .59，高于后者的 .58）。&lt;/p&gt;&lt;p&gt;这样的结果似乎足以令人兴奋了。但是，我们还想抛出一个问号，并以此总结全文。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;5 结语：问题比发现更多&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;毫无疑问，残差动量 —— 无论其背后的“故事”是什么 —— 其有效的必要条件是有一个靠谱的定价模型。虽然美股上已经有很多主流的多因子模型，但是针对 A 股却并没有广泛被认可的定价模型。这让任何研究残差收益率的实证结果都面临挑战。&lt;/p&gt;&lt;p&gt;在计算残差动量的时候，Blitz, Huij, and Martens (2011) 以控制模型设定偏误为由舍去了回归中的  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B1_i&quot; alt=&quot;α_i&quot; eeimg=&quot;1&quot;/&gt; 。面对这种处理，我们仍然很好奇，如果带上 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B1_i&quot; alt=&quot;α_i&quot; eeimg=&quot;1&quot;/&gt; 又会怎样？从 A 股上的实证结果来看，&lt;b&gt;带上 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B1_i&quot; alt=&quot;α_i&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 之后，残差动量翻车了……&lt;/b&gt;&lt;/p&gt;&lt;p&gt;仍然以 Blitz, Huij, and Martens (2011) 的方法获得残差收益率，在计算残差动量时，使用 T – 12 到 T – 2 期之间的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B1_i&quot; alt=&quot;α_i&quot; eeimg=&quot;1&quot;/&gt; 和残差总收益之和作为分子：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bresidual+mom%7D_%7Bi%2Ct%7D%5E%5Cprime%3D%5Cdisplaystyle%5Cfrac%7B11%5Calpha_i%2B%5Csum_%7BT-12%7D%5E%7BT-2%7D%5Cvarepsilon_%7Bi%2Ct%7D%7D%7B%5Csqrt%7B%5Csum_%7BT-12%7D%5E%7BT-2%7D%28%5Cvarepsilon_%7Bi%2Ct%7D-%5Cbar%5Cvarepsilon_%7Bi%7D%29%5E2%7D%7D&quot; alt=&quot;\mbox{residual mom}_{i,t}^\prime=\displaystyle\frac{11\alpha_i+\sum_{T-12}^{T-2}\varepsilon_{i,t}}{\sqrt{\sum_{T-12}^{T-2}(\varepsilon_{i,t}-\bar\varepsilon_{i})^2}}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;以等权为例，在上述定义下，残差动量变成了残差反转（图 9）。除此之外，我们也尝试了在时序回归计算残差收益率时不加入截距项，也得到了残差反转的结果。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-ee9ffbdc9ed4de6ba2e0563a49b906ec_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;987&quot; data-rawheight=&quot;591&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;987&quot; data-original=&quot;https://pic1.zhimg.com/v2-ee9ffbdc9ed4de6ba2e0563a49b906ec_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-ee9ffbdc9ed4de6ba2e0563a49b906ec_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;987&quot; data-rawheight=&quot;591&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;987&quot; data-original=&quot;https://pic1.zhimg.com/v2-ee9ffbdc9ed4de6ba2e0563a49b906ec_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-ee9ffbdc9ed4de6ba2e0563a49b906ec_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;作为开放性的问题，本文并不试图对上述看起来十分矛盾的结果进行更深入的讨论。只是希望通过它们说明，&lt;b&gt;在使用残差收益率构建因子的时候，模型怎么设定、参数如何估计都会直接影响因子的计算，且有时甚至产生完全相反的效果，因此必须要搞清楚每一步的原因是什么，以免陷入数据挖掘。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;前文&lt;a href=&quot;https://zhuanlan.zhihu.com/p/40468929&quot; class=&quot;internal&quot;&gt;《给你的动量策略加点“料”》&lt;/a&gt;曾指出，传统动量策略之所以有效和人们的有限注意力（limited attention）有关，并以此作为一个维度改进了传统动量。由于大脑中的资源有限，一系列频繁但微小的变化对于人的吸引力远不如少数却显著的变化；因此投资者对于连续信息造成的股价变化反应不足。随着时间的推移，这些信息缓慢的被吸收并反映到价格中，从而导致了动量。而对于残差动量，Blitz, Huij, and Martens (2011) 认为也可以从 gradual-information-diffusion 假说解释：信息在投资者之间的扩散是缓慢的，而且相比于影响所有公司的公共事件，投资者对于那些针对公司的特定事件的反应则更加迟缓，这就形成了残差动量。&lt;/p&gt;&lt;p&gt;从投资者的反应不足来解释动量和残差动量似乎是站的住脚的。&lt;b&gt;而对于美股市场，动量和残差动量双双有效，且残差动量的效果优于传统动量这个结果也是可以支持上述假说的。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;但是 A 股……&lt;b&gt;在动量如此不好使的前提下，仅仅使用了一个同样对于 A 股也不那么完美的定价模型计算出残差，就得到了如此好使的残差动量。&lt;/b&gt;这背后的原因恐怕比残差动量这个简单的公式要复杂得多。&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;参考文献&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Blitz, D., M. X. Hanauer, and M. Vidojevic (2018). The idiosyncratic momentum anomaly. SSRN 2947044.&lt;/li&gt;&lt;li&gt;Blitz, D., M. X. Hanauer, M. Vidojevic, and P. van Vliet (2018). Five concerns with the five-factor model. &lt;i&gt;The Journal of Portfolio Management&lt;/i&gt;, Vol. 44(4), 71 – 78.&lt;/li&gt;&lt;li&gt;Blitz, D., J. Huij, and M. Martens (2011). Residual momentum. &lt;i&gt;Journal of Empirical Finance&lt;/i&gt;, Vol. 18(3), 506 – 521.&lt;/li&gt;&lt;li&gt;Daniel, K. and T. J. Moskowitz (2016). Momentum crashes. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 122(2), 221 – 247.&lt;/li&gt;&lt;li&gt;Fama, E. F. and K. R. French (1993). Common risk factors in the returns on stocks and bonds. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 33(1), 3 – 56.&lt;/li&gt;&lt;li&gt;Fama, E. F. and K. R. French (2015). A five-factor asset pricing model. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 116(1), 1 – 22.&lt;/li&gt;&lt;li&gt;Geczy, C. and M. Samonov (2016). Two centuries of price-return momentum. &lt;i&gt;Financial Analysts Journal&lt;/i&gt;, Vol. 72(5), 32 – 56.&lt;/li&gt;&lt;li&gt;Gutierrez, R. C. and C. A. Prinsky (2007). Momentum, reversal, and the trading behaviors of institutions. &lt;i&gt;Journal of Financial Markets&lt;/i&gt;, Vol. 10(1), 48 – 75.&lt;/li&gt;&lt;li&gt;Hanauer, M. X. and S. Windmueller (2019). Enhanced momentum strategies. SSRN 2427919.&lt;/li&gt;&lt;li&gt;Jegadeesh, N. and S. Titman (1993). Returns to Buying Winners and Selling Losers: Implications for Stock Market Efficiency. &lt;i&gt;Journal of Finance&lt;/i&gt;, Vol. 48(1), 65 – 91.&lt;/li&gt;&lt;li&gt;Lin, Q. (2019). Residual momentum and the cross-section of stock returns: Chinese evidence. &lt;i&gt;Finance Research Letters&lt;/i&gt;, Vol. 29, 206 – 215.&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;免责声明：&lt;/b&gt;文章内容不可视为投资意见。市场有风险，入市需谨慎。&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处。已委托“维权骑士”(&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//rightknights.com&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;维权骑士_免费版权监测/版权保护/内容多平台分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2019-12-04-95259084</guid>
<pubDate>Wed, 04 Dec 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>Generalized Method of Moments</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2019-11-21-92490417.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/92490417&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-99130ac172d0b32f0107c8fc68b18872_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;摘要&lt;/b&gt;&lt;/p&gt;&lt;p&gt;GMM 是研究 asset pricing 时绕不过的工具。本文介绍 GMM 框架的强大之处，并阐述其背后的数学之美。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;01 引言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;好了，来写写 &lt;b&gt;GMM（Generalized Method of Moments，广义矩估计）&lt;/b&gt;吧，站在 asset pricing 的视角。&lt;/p&gt;&lt;p&gt;前文&lt;a href=&quot;https://zhuanlan.zhihu.com/p/88458489&quot; class=&quot;internal&quot;&gt;《理解资产价格》&lt;/a&gt;已经提到，Hansen (1982) 提出的 GMM 在 empirical asset pricing 研究的历史上起到了举足轻重的作用，而如今无论是在经济学领域还是金融学领域，GMM 因其数学上的优雅和特性上的强大都被广泛的运用。&lt;/p&gt;&lt;p&gt;今天这篇文章算是我自己关于 GMM 的一个学习笔记，而我的学习资料（公众号的老朋友一定猜到了）正是 John Cochrane 教授的神书 Asset Pricing（Cochrane 2005）以及他在 UChicago 时做的 Online 课程中对 GMM 的介绍。Cochrane 教授讲的实在是太清楚、到位了，本文是我做对他所讲的内容的消化、梳理和再串联。&lt;/p&gt;&lt;p&gt;&lt;b&gt;本文的目标是试图从 intuition 出发揭示 GMM 蕴含数学之美；试图把公式掰开揉碎讲清楚从而帮助感兴趣的朋友理解大公式背后的本质。&lt;/b&gt;我会力争在行文中做到非常准确，在 population 和 sample 之间腾挪、把 variance 和 test statistic 都说清楚。Cochrane 教授说，学习 GMM 时最大的障碍就是它的 notation（数学符号）繁多；只要搞清楚 notation，其实 GMM 背后的数学精髓是非常简单的，因为 GMM 的核心最终能够归结为计算 the variance of the sample mean。希望本文能够带给你这种恍然大悟之感。&lt;/p&gt;&lt;p&gt;先来剧透一下，本文希望传达以下三方面内容：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;GMM 的框架包括 model、estimate 以及 test 三部分；&lt;/li&gt;&lt;li&gt;学习 GMM 时，最大的障碍往往来自 notation；搞清楚 notation 后，GMM 背后的数学非常容易理解；&lt;/li&gt;&lt;li&gt;GMM 不应被当作计量学的黑箱。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;b&gt;以我一贯的风格，行文中会“死磕”数学公式，因此这注定是一篇十分 technical 的文章。&lt;/b&gt;本文的技术性远超&lt;a href=&quot;https://zhuanlan.zhihu.com/p/40984029&quot; class=&quot;internal&quot;&gt;《股票多因子模型的回归检验》&lt;/a&gt;，因此同样建议在一个能静下心来思考的心境下和环境中阅读。对于不关心数学、仅想快速了解 GMM 是什么的读者来说，我强烈推荐&lt;a href=&quot;https://www.zhihu.com/question/41312883/answer/91484566?utm_source=wechat_session&amp;amp;utm_medium=social&amp;amp;utm_oi=728969207022125056&amp;amp;from=singlemessage&amp;amp;isappinstalled=0&quot; class=&quot;internal&quot;&gt;慧航大神关于 GMM 的回答&lt;/a&gt;。那篇回答对读者非常友好，涉及到的数学恰到好处，深入浅出的介绍了 GMM 的原理。&lt;/p&gt;&lt;p&gt;如果本文能对你理解 GMM 起到一点帮助，那完全是 Cochrane 教授的功劳；如果你看完后依然困惑，那一定也必须是怪我没写好……&lt;/p&gt;&lt;p&gt;Cochrane 教授说 GMM 的核心最终能够归结为计算 the variance of the sample mean；让我们就从 the variance of the sample mean 说起。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;02 Variance of the Sample Mean&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;考虑某随机变量  &lt;img src=&quot;https://www.zhihu.com/equation?tex=u_t&quot; alt=&quot;u_t&quot; eeimg=&quot;1&quot;/&gt; 。假设它在某个样本内的取值为 0，-1，3，3，-3。我们可以很容易的算出样本均值：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Cbar+u+%3D+%5Cmbox%7BE%7D_T%5Bu_t%5D%3D0.4&quot; alt=&quot;\displaystyle\bar u = \mbox{E}_T[u_t]=0.4&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;上式中， &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D_T+%3D+%281%2FT%29%5Csum%28.%29&quot; alt=&quot;\mbox{E}_T = (1/T)\sum(.)&quot; eeimg=&quot;1&quot;/&gt; 表示对样本数据求平均， &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbar+u&quot; alt=&quot;\bar u&quot; eeimg=&quot;1&quot;/&gt; 表示 &lt;img src=&quot;https://www.zhihu.com/equation?tex=u_t&quot; alt=&quot;u_t&quot; eeimg=&quot;1&quot;/&gt; 的样本均值。由于 &lt;img src=&quot;https://www.zhihu.com/equation?tex=u_t&quot; alt=&quot;u_t&quot; eeimg=&quot;1&quot;/&gt; 是一个随机变量，因此其&lt;b&gt;样本均值  &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbar+u_t&quot; alt=&quot;\bar u_t&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;本身也是一个随机变量&lt;/b&gt;。虽然它在我们这个样本中的取值为 0.4，但如果我们能够乘坐时光机回到过去“重写历史”，得到不同的样本，那么在不同样本中，样本均值的取值也会有所变化。比如在下面这个表中，假设除样本一（就是上面这个样本）之外，还有三个样本，而它们的样本均值 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbar+u&quot; alt=&quot;\bar u&quot; eeimg=&quot;1&quot;/&gt; 的取值分别为 -0.8，0.6 和 1.6。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-2d988b6aebb6c5ba1c5a23ccb4d1ad54_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;713&quot; data-rawheight=&quot;317&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;713&quot; data-original=&quot;https://pic1.zhimg.com/v2-2d988b6aebb6c5ba1c5a23ccb4d1ad54_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-2d988b6aebb6c5ba1c5a23ccb4d1ad54_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;713&quot; data-rawheight=&quot;317&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;713&quot; data-original=&quot;https://pic1.zhimg.com/v2-2d988b6aebb6c5ba1c5a23ccb4d1ad54_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-2d988b6aebb6c5ba1c5a23ccb4d1ad54_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;既然样本均值本身也是一个随机变量，那么一个很自然的问题就是样本均值在不同的样本中是如何变化的，即 variance of the sample mean。从 variance 的定义出发可得：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Cmbox%7Bvar%7D%28%5Cbar+u%29%3D%5Cmbox%7Bvar%7D%5Cleft%28%5Cfrac%7B1%7D%7BT%7D%5Csum_%7Bt%3D1%7D%5ET+u_t%5Cright%29%3D%5Cfrac%7B1%7D%7BT%5E2%7D%5Cmbox%7Bvar%7D%5Cleft%28%5Csum_%7Bt%3D1%7D%5ET+u_t%5Cright%29&quot; alt=&quot;\displaystyle\mbox{var}(\bar u)=\mbox{var}\left(\frac{1}{T}\sum_{t=1}^T u_t\right)=\frac{1}{T^2}\mbox{var}\left(\sum_{t=1}^T u_t\right)&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;在最简单的情况中，假设 &lt;img src=&quot;https://www.zhihu.com/equation?tex=u_t&quot; alt=&quot;u_t&quot; eeimg=&quot;1&quot;/&gt; 序列满足 i.i.d.，则上式可以简化成：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Cmbox%7Bvar%7D%28%5Cbar+u%29%3D%5Cfrac%7B1%7D%7BT%5E2%7D%5Cmbox%7Bvar%7D%5Cleft%28%5Csum_%7Bt%3D1%7D%5ET+u_t%5Cright%29%3D%5Cfrac%7B%5Csigma%5E2%28u_t%29%7D%7BT%7D&quot; alt=&quot;\displaystyle\mbox{var}(\bar u)=\frac{1}{T^2}\mbox{var}\left(\sum_{t=1}^T u_t\right)=\frac{\sigma^2(u_t)}{T}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;把两边开方就得到样本均值的 standard error：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Cmbox%7Bs.e.%7D%28%5Cbar+u%29%3D%5Cfrac%7B%5Csigma%28u_t%29%7D%7B%5Csqrt%7BT%7D%7D&quot; alt=&quot;\displaystyle\mbox{s.e.}(\bar u)=\frac{\sigma(u_t)}{\sqrt{T}}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;这大概是我们在统计课中学到的印象最深的一个式子（假设 &lt;img src=&quot;https://www.zhihu.com/equation?tex=u_t&quot; alt=&quot;u_t&quot; eeimg=&quot;1&quot;/&gt; 满足 i.i.d. 条件下样本均值的 standard error）。在更一般的情况中 —— 尤其是在金融数据（比如收益率）数据中 ——  &lt;img src=&quot;https://www.zhihu.com/equation?tex=u_t&quot; alt=&quot;u_t&quot; eeimg=&quot;1&quot;/&gt;  序列是前后是有非零的自相关的，即 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bcov%7D%28u_t%2C+u_%7Bt-j%7D%29+%E2%89%A0+0&quot; alt=&quot;\mbox{cov}(u_t, u_{t-j}) ≠ 0&quot; eeimg=&quot;1&quot;/&gt; ，因此需要得到更一般下样本均值  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbar+u&quot; alt=&quot;\bar u&quot; eeimg=&quot;1&quot;/&gt;  的 variance：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Cmbox%7Bvar%7D%28%5Cbar+u%29%3D%5Cfrac%7B1%7D%7BT%7D%5Cleft%5B%5Cmbox%7Bvar%7D%28u_t%29%2B%5Csum_%7Bj%3D1%7D%5ET%5Cfrac%7BT-j%7D%7BT%7D%5Cleft%28%5Cmbox%7Bcov%7D%28u_t%2C+u_%7Bt-j%7D%29%2B%5Cmbox%7Bcov%7D%28u_t%2C+u_%7Bt%2Bj%7D%29%5Cright%29%5Cright%5D&quot; alt=&quot;\displaystyle\mbox{var}(\bar u)=\frac{1}{T}\left[\mbox{var}(u_t)+\sum_{j=1}^T\frac{T-j}{T}\left(\mbox{cov}(u_t, u_{t-j})+\mbox{cov}(u_t, u_{t+j})\right)\right]&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;当  &lt;img src=&quot;https://www.zhihu.com/equation?tex=T&quot; alt=&quot;T&quot; eeimg=&quot;1&quot;/&gt;  趋于无穷大时（即 sample size 越来越大）， &lt;img src=&quot;https://www.zhihu.com/equation?tex=%28T+%E2%80%93+j%29%2FT&quot; alt=&quot;(T – j)/T&quot; eeimg=&quot;1&quot;/&gt; 趋于 1，就可以求出 &lt;img src=&quot;https://www.zhihu.com/equation?tex=var%28%5Cbar+u%29&quot; alt=&quot;var(\bar u)&quot; eeimg=&quot;1&quot;/&gt; 的渐进（asymptotic）形式：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Cmbox%7Bvar%7D%28%5Cbar+u%29%5Crightarrow%5Cfrac%7B1%7D%7BT%7D%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D%5Cmbox%7Bvar%7D%28u_t%2C+u_%7Bt-j%7D%29&quot; alt=&quot;\displaystyle\mbox{var}(\bar u)\rightarrow\frac{1}{T}\sum_{j=-\infty}^{\infty}\mbox{var}(u_t, u_{t-j})&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;下面再假设一个特殊的情况，即随机变量 &lt;img src=&quot;https://www.zhihu.com/equation?tex=u_t&quot; alt=&quot;u_t&quot; eeimg=&quot;1&quot;/&gt; 的&lt;b&gt;总体均值&lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D%5Bu_t%5D+%3D+0&quot; alt=&quot;\mbox{E}[u_t] = 0&quot; eeimg=&quot;1&quot;/&gt; ，并利用方差的定义  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28X%2C+Y%29+%3D+%5Cmbox%7BE%7D%5BXY%5D+%E2%80%93+%5Cmbox%7BE%7D%5BX%5D%5Cmbox%7BE%7D%5BY%5D&quot; alt=&quot;\mbox{var}(X, Y) = \mbox{E}[XY] – \mbox{E}[X]\mbox{E}[Y]&quot; eeimg=&quot;1&quot;/&gt;  可得：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Cmbox%7Bvar%7D%28%5Cbar+u%29%5Crightarrow%5Cfrac%7B1%7D%7BT%7D%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D%5Cmbox%7BE%7D%5Bu_tu_%7Bt-j%7D%5D%3D%5Cfrac%7B1%7D%7BT%7DS&quot; alt=&quot;\displaystyle\mbox{var}(\bar u)\rightarrow\frac{1}{T}\sum_{j=-\infty}^{\infty}\mbox{E}[u_tu_{t-j}]=\frac{1}{T}S&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;上式最后一项中的  &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt;  代表了中间项中那一大坨求和项。在 GMM 的术语中， &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt;  被称作 spectral density matrix at frequency zero of &lt;img src=&quot;https://www.zhihu.com/equation?tex=u_t&quot; alt=&quot;u_t&quot; eeimg=&quot;1&quot;/&gt; 。&lt;/p&gt;&lt;p&gt;OK！整理一下。本小节从我们熟悉的样本均值出发指出样本均值本身也是一个随机变量，并推导出当 sample size &lt;img src=&quot;https://www.zhihu.com/equation?tex=T&quot; alt=&quot;T&quot; eeimg=&quot;1&quot;/&gt;  趋于无穷且假设 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D%5Bu_t%5D+%3D+0&quot; alt=&quot;\mbox{E}[u_t] = 0&quot; eeimg=&quot;1&quot;/&gt; 时，variance of the sample mean 渐进趋于 &lt;img src=&quot;https://www.zhihu.com/equation?tex=S%2FT&quot; alt=&quot;S/T&quot; eeimg=&quot;1&quot;/&gt; ，其中  &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt;  是无穷级数求和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Csum%5Cmbox%7BE%7D%5Bu_tu_%7Bt-j%7D%5D&quot; alt=&quot;\sum\mbox{E}[u_tu_{t-j}]&quot; eeimg=&quot;1&quot;/&gt; 。&lt;/p&gt;&lt;p&gt;千万不要小看这个 &lt;img src=&quot;https://www.zhihu.com/equation?tex=var%28%5Cbar+u%29+%5Crightarrow+S%2FT&quot; alt=&quot;var(\bar u) \rightarrow S/T&quot; eeimg=&quot;1&quot;/&gt; 这个式子，它在下文 GMM 的数学推导中起着至关重要的作用。用 Cochrane 的话说，&lt;b&gt;GMM 中大绝大部分计量学均可归结到这个式子（most econometrics boils down to this）！&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;03 GMM 框架&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;回顾了 variance of the sample mean 之后，本小节就来直观的看看 GMM 到底是怎么回事儿。&lt;/p&gt;&lt;p&gt;&lt;b&gt;GMM 的作用是为了检验模型。&lt;/b&gt;模型到底对不对？模型的参数如何估计？误差是来自运气还是因为模型有误？GMM 提供了一个优雅而强大的计量学框架来回答这些问题。一般来说，GMM 框架分为以下三个部分：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;b&gt;第一部分：把待研究的问题表达成一系列总体矩条件（population moment conditions） ——&lt;/b&gt; &lt;b&gt;这是提出 model；&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;第二部分：使用样本数据得到对应的样本矩（sample moments），从而对参数进行估计 ——&lt;/b&gt; &lt;b&gt;这是把 model 和 data 联系起来；&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;第三部分：计算 sample moments 的 variance，从而对 population moments 进行 statistical test ——&lt;/b&gt; &lt;b&gt;这是检验 model。&lt;/b&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;b&gt;所以概括来说就是 GMM 就是用 sample moments 代替 population moments 然后对 population moments 进行统计检验。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;3.1 GMM 第一部分&lt;/b&gt;&lt;/p&gt;&lt;p&gt;我们用  &lt;img src=&quot;https://www.zhihu.com/equation?tex=x_t&quot; alt=&quot;x_t&quot; eeimg=&quot;1&quot;/&gt;  代表 data， &lt;img src=&quot;https://www.zhihu.com/equation?tex=b&quot; alt=&quot;b&quot; eeimg=&quot;1&quot;/&gt;  代表参数（这些都是 vectors），且存在一系列关于 &lt;img src=&quot;https://www.zhihu.com/equation?tex=x_t&quot; alt=&quot;x_t&quot; eeimg=&quot;1&quot;/&gt; 和 b 的函数 &lt;img src=&quot;https://www.zhihu.com/equation?tex=f%28x_t%2C+b%29&quot; alt=&quot;f(x_t, b)&quot; eeimg=&quot;1&quot;/&gt; 。 &lt;img src=&quot;https://www.zhihu.com/equation?tex=f%28x_t%2C+b%29&quot; alt=&quot;f(x_t, b)&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;的 expected value 即 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D%5Bf%28x_t%2C+b%29%5D&quot; alt=&quot;\mbox{E}[f(x_t, b)]&quot; eeimg=&quot;1&quot;/&gt; 就是 population moments。&lt;/b&gt;在 GMM 中，我们要求 population moments 满足 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D%5Bf%28x_t%2C+b%29%5D+%3D+0&quot; alt=&quot;\mbox{E}[f(x_t, b)] = 0&quot; eeimg=&quot;1&quot;/&gt; 的约束，&lt;b&gt;这一系列 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D%5Bf%28x_t%2C+b%29%5D+%3D+0&quot; alt=&quot;\mbox{E}[f(x_t, b)] = 0&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 约束就是 GMM 中的 population moment conditions（矩条件）。这些 moment conditions 是我们关于真实模型（true model）的猜测。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;需要说明的是，期望符号 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D&quot; alt=&quot;\mbox{E}&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt; 表示对总体求均值；而前面使用的（接下来也将会继续使用的）期望符号 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D_T&quot; alt=&quot;\mbox{E}_T&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;（有个下标 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=T&quot; alt=&quot;T&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;）表示对样本求均值。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;GMM 的第一部分是把待研究的问题转化成数据 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=x_t&quot; alt=&quot;x_t&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt; 和参数 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=b&quot; alt=&quot;b&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 的一系列方程 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=f&quot; alt=&quot;f&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;、且假设在 true model 下这些方程的 moments 满足 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D%5Bf%28x_t%2C+b%29%5D+%3D+0&quot; alt=&quot;\mbox{E}[f(x_t, b)] = 0&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+%5Cmbox%7BExpress+Model%7D%26%5Crightarrow%26%5Cdisplaystyle%5Cmbox%7BMean+of+%7Df%28%5Cmbox%7BData%2C+Parameter%7D%29%3D0%5C%5C+%26%5Crightarrow%26%5Cdisplaystyle%5Cmbox%7BE%7D%5Bf%28x_t%2C+b%29%5D%3D0+%5Cend%7Barray%7D+&quot; alt=&quot;\begin{array}{rll} \mbox{Express Model}&amp;amp;\rightarrow&amp;amp;\displaystyle\mbox{Mean of }f(\mbox{Data, Parameter})=0\\ &amp;amp;\rightarrow&amp;amp;\displaystyle\mbox{E}[f(x_t, b)]=0 \end{array} &quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;仍然晦涩？马上来看一些 asset pricing 中的例子。&lt;/p&gt;&lt;p&gt;从最基础的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=p+%3D+%5Cmbox%7BE%7D%5Bmx%5D&quot; alt=&quot;p = \mbox{E}[mx]&quot; eeimg=&quot;1&quot;/&gt; 出发（详见&lt;a href=&quot;https://zhuanlan.zhihu.com/p/88458489&quot; class=&quot;internal&quot;&gt;《理解资产价格》&lt;/a&gt;），其中 m 是 stochastic discount factor（由某些未知参数 &lt;img src=&quot;https://www.zhihu.com/equation?tex=b&quot; alt=&quot;b&quot; eeimg=&quot;1&quot;/&gt; 决定）、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=x&quot; alt=&quot;x&quot; eeimg=&quot;1&quot;/&gt;  是回报、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=p&quot; alt=&quot;p&quot; eeimg=&quot;1&quot;/&gt;  是价格。如果把 &lt;img src=&quot;https://www.zhihu.com/equation?tex=x&quot; alt=&quot;x&quot; eeimg=&quot;1&quot;/&gt; 换成超额收益（用 &lt;img src=&quot;https://www.zhihu.com/equation?tex=R%5Ee&quot; alt=&quot;R^e&quot; eeimg=&quot;1&quot;/&gt; 表示）则有：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Cmbox%7BE%7D%5Bm%28b%29R%5Ee%5D%3D0&quot; alt=&quot;\displaystyle\mbox{E}[m(b)R^e]=0&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;如果把  &lt;img src=&quot;https://www.zhihu.com/equation?tex=x&quot; alt=&quot;x&quot; eeimg=&quot;1&quot;/&gt;  换成 gross risk-free rate  &lt;img src=&quot;https://www.zhihu.com/equation?tex=R_f&quot; alt=&quot;R_f&quot; eeimg=&quot;1&quot;/&gt; （即 &lt;img src=&quot;https://www.zhihu.com/equation?tex=t&quot; alt=&quot;t&quot; eeimg=&quot;1&quot;/&gt; 时刻投入 1， &lt;img src=&quot;https://www.zhihu.com/equation?tex=t+%2B+1&quot; alt=&quot;t + 1&quot; eeimg=&quot;1&quot;/&gt; 时刻得到  &lt;img src=&quot;https://www.zhihu.com/equation?tex=R_f&quot; alt=&quot;R_f&quot; eeimg=&quot;1&quot;/&gt; ）则有：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Cmbox%7BE%7D%5Bm%28b%29R_f-1%5D%3D0&quot; alt=&quot;\displaystyle\mbox{E}[m(b)R_f-1]=0&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;这些都是 asset pricing 中常见的 moment conditions。&lt;/p&gt;&lt;p&gt;&lt;b&gt;3.2 GMM 第二部分&lt;/b&gt;&lt;/p&gt;&lt;p&gt;第一部分虽然把问题描述清楚了，但它们都是 population moment conditions，只是我们对于真实模型的猜想，我们有的只是样本数据。&lt;b&gt;GMM 的第二部分就是用 sample moments 来代替 population moments，从而建立起模型和数据之间的联系，以进行参数估计。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;和本文第二节一样，用  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D_T&quot; alt=&quot;\mbox{E}_T&quot; eeimg=&quot;1&quot;/&gt;  代表对样本数据求平均，则 sample moments 可以写成：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Cmbox%7BE%7D_T%5Bf%28x_t%2C+b%29%5D%3D%5Cfrac%7B1%7D%7BT%7D%5Csum_%7Bt%3D1%7D%5ET+f%28x_t%2C+b%29%5Cequiv+g_T%28b%29&quot; alt=&quot;\displaystyle\mbox{E}_T[f(x_t, b)]=\frac{1}{T}\sum_{t=1}^T f(x_t, b)\equiv g_T(b)&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;上式中最后引入符号 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; 仅仅是为了下文中简化公式。怎么样？看着这个式子有没有什么感想？无论研究的具体问题是什么（我们研究的是 asset pricing，而别人也可以研究经济学或金融学中其他的问题），不管 &lt;img src=&quot;https://www.zhihu.com/equation?tex=f&quot; alt=&quot;f&quot; eeimg=&quot;1&quot;/&gt; 到底长什么样子或数据 &lt;img src=&quot;https://www.zhihu.com/equation?tex=x_t&quot; alt=&quot;x_t&quot; eeimg=&quot;1&quot;/&gt; 和参数 &lt;img src=&quot;https://www.zhihu.com/equation?tex=b&quot; alt=&quot;b&quot; eeimg=&quot;1&quot;/&gt; 向量都是什么，&lt;b&gt;上面的 sample moments 也仅仅是 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=f%28x_t%2C+b%29&quot; alt=&quot;f(x_t, b)&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt; 在样本内取平均，因此也只是一种 sample mean！&lt;/b&gt;&lt;/p&gt;&lt;p&gt;从 sample moments 出发就可以进行参数估计。来自总体的 moment conditions 要求  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D%5Bf%28x_t%2C+b%29%5D+%3D+0&quot; alt=&quot;\mbox{E}[f(x_t, b)] = 0&quot; eeimg=&quot;1&quot;/&gt; ；使用样本数据，GMM estimator 的核心是找到  &lt;img src=&quot;https://www.zhihu.com/equation?tex=b&quot; alt=&quot;b&quot; eeimg=&quot;1&quot;/&gt;  的估计 —— 记为 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; —— 使得所有 sample moments 都尽可能的等于零：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Cmbox%7BE%7D_T%5Bf%28x_t%2C+%5Chat+b%29%5D%5Csimeq+0&quot; alt=&quot;\displaystyle\mbox{E}_T[f(x_t, \hat b)]\simeq 0&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;上式中之所以用了约等于而非等于，是因为&lt;b&gt;在实际问题中，sample moments 的个数往往超过参数的个数（这也被称为 overidentification）。&lt;/b&gt;假设一共有 n 个 moments（即 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; 是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=n+%C3%97+1&quot; alt=&quot;n × 1&quot; eeimg=&quot;1&quot;/&gt; 阶 vector）， &lt;img src=&quot;https://www.zhihu.com/equation?tex=p&quot; alt=&quot;p&quot; eeimg=&quot;1&quot;/&gt;  个参数（即  &lt;img src=&quot;https://www.zhihu.com/equation?tex=b&quot; alt=&quot;b&quot; eeimg=&quot;1&quot;/&gt;  是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=p+%C3%97+1&quot; alt=&quot;p × 1&quot; eeimg=&quot;1&quot;/&gt; 阶 vector）。当 &lt;img src=&quot;https://www.zhihu.com/equation?tex=n+%3E+p&quot; alt=&quot;n &amp;gt; p&quot; eeimg=&quot;1&quot;/&gt; 时，我们无法让所有的 sample moments 都等于零，而是选择让这其中的  &lt;img src=&quot;https://www.zhihu.com/equation?tex=p&quot; alt=&quot;p&quot; eeimg=&quot;1&quot;/&gt;  个 sample moments 或者这些 sample moments 的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=p&quot; alt=&quot;p&quot; eeimg=&quot;1&quot;/&gt; 个线性组合等于 0。这就是 GMM estimator：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Chat+b%3A+%5Cmbox%7Bset+%7D+ag_T%28%5Chat+b%29%3D0&quot; alt=&quot;\displaystyle\hat b: \mbox{set } ag_T(\hat b)=0&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;上式中， &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt;  是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=p+%C3%97+n&quot; alt=&quot;p × n&quot; eeimg=&quot;1&quot;/&gt; 阶矩阵，每一行都代表一个 sample moments 的线性组合。在具体问题中，根据 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; 的具体形式，上式可能有解析解或数值解。求解上式就可以获得 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; 。不过有的小伙伴可能会说：&lt;b&gt;等一下，你还没说矩条件的线性组合矩阵 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 是什么！不同的 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 显然会得到不同的参数估计。&lt;/b&gt;没错，在 GMM 的框架下，我们可以自由选择  &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; 。然而，纯从计量学的角度，有一个特殊的矩阵  &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt;  会让 GMM estimator 成为 efficient estimator。下文第 3.3 节和第 5 节将会就 efficiency 进行说明。&lt;/p&gt;&lt;p&gt;为了加深理解，仍然用 asset pricing 来举例子。假设 consumption-based CAPM（CCAPM）是真正的模型，因此随机折现因子 &lt;img src=&quot;https://www.zhihu.com/equation?tex=m&quot; alt=&quot;m&quot; eeimg=&quot;1&quot;/&gt; 由两个参数 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B2&quot; alt=&quot;β&quot; eeimg=&quot;1&quot;/&gt; 和  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B3&quot; alt=&quot;γ&quot; eeimg=&quot;1&quot;/&gt;  决定（CCAPM 的介绍请见&lt;a href=&quot;https://zhuanlan.zhihu.com/p/88458489&quot; class=&quot;internal&quot;&gt;《理解资产价格》&lt;/a&gt;），即 &lt;img src=&quot;https://www.zhihu.com/equation?tex=b%3D%5B%5Cbeta%2C%5Cgamma%5D%5E%5Cprime&quot; alt=&quot;b=[\beta,\gamma]^\prime&quot; eeimg=&quot;1&quot;/&gt; ；进一步假设我们有四个资产来检验 CCAPM，它们是 risk-free、市场组合以及 Fama and French (1993) 中的 HML 和 SMB。在这个例子中， &lt;img src=&quot;https://www.zhihu.com/equation?tex=n+%3D+4&quot; alt=&quot;n = 4&quot; eeimg=&quot;1&quot;/&gt; 而 &lt;img src=&quot;https://www.zhihu.com/equation?tex=p+%3D+2&quot; alt=&quot;p = 2&quot; eeimg=&quot;1&quot;/&gt; ，因此 &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; 是一个 &lt;img src=&quot;https://www.zhihu.com/equation?tex=2+%C3%97+4&quot; alt=&quot;2 × 4&quot; eeimg=&quot;1&quot;/&gt; 阶矩阵，而 GMM estimator 可以写成：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cleft%5B+%5Cbegin%7Barray%7D%7Bcccc%7D+a_%7B11%7D%26a_%7B12%7D%26a_%7B13%7D%26a_%7B14%7D%5C%5C+a_%7B21%7D%26a_%7B22%7D%26a_%7B23%7D%26a_%7B24%7D+%5Cend%7Barray%7D+%5Cright%5D+%5Cleft%5B+%5Cbegin%7Barray%7D%7Bl%7D+%5Cmbox%7BE%7D_T%5Bm%28%5Chat%5Cbeta%2C%5Chat%5Cgamma%29R%5Ee_m%5D%5C%5C+%5Cmbox%7BE%7D_T%5Bm%28%5Chat%5Cbeta%2C%5Chat%5Cgamma%29R_f-1%5D%5C%5C+%5Cmbox%7BE%7D_T%5Bm%28%5Chat%5Cbeta%2C%5Chat%5Cgamma%29R%5E%7B%5Cmbox%7BHML%7D%7D%5D%5C%5C+%5Cmbox%7BE%7D_T%5Bm%28%5Chat%5Cbeta%2C%5Chat%5Cgamma%29R%5E%7B%5Cmbox%7BSMB%7D%7D%5D+%5Cend%7Barray%7D+%5Cright%5D%3D+%5Cleft%5B+%5Cbegin%7Barray%7D%7Bc%7D+0%5C%5C0+%5Cend%7Barray%7D+%5Cright%5D&quot; alt=&quot;\left[ \begin{array}{cccc} a_{11}&amp;amp;a_{12}&amp;amp;a_{13}&amp;amp;a_{14}\\ a_{21}&amp;amp;a_{22}&amp;amp;a_{23}&amp;amp;a_{24} \end{array} \right] \left[ \begin{array}{l} \mbox{E}_T[m(\hat\beta,\hat\gamma)R^e_m]\\ \mbox{E}_T[m(\hat\beta,\hat\gamma)R_f-1]\\ \mbox{E}_T[m(\hat\beta,\hat\gamma)R^{\mbox{HML}}]\\ \mbox{E}_T[m(\hat\beta,\hat\gamma)R^{\mbox{SMB}}] \end{array} \right]= \left[ \begin{array}{c} 0\\0 \end{array} \right]&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;根据上式就可以使用 sample moments 求出参数估计 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; 。&lt;/p&gt;&lt;p&gt;&lt;b&gt;3.3 GMM 第三部分&lt;/b&gt;&lt;/p&gt;&lt;p&gt;使用 GMM estimator 得到的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; 仅仅是真实但未知参数 &lt;img src=&quot;https://www.zhihu.com/equation?tex=b_0&quot; alt=&quot;b_0&quot; eeimg=&quot;1&quot;/&gt; 的一个估计。从统计学的角度，我们自然关心估计的误差，即 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt; 。马上来回答上面遗留的矩阵 &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; 的选择的问题。&lt;b&gt;对于给定的 moments &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;，从计量学的角度有一个特殊的矩阵 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 使得 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 最小，这就是 efficient 的含义。&lt;/b&gt;Hansen (1982) 给出了这个  &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt;  的形式。关于 &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; 的进一步讨论将放在本文第五节。&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BVar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{Var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt;  的大小仅仅告诉我们参数估计是否准确，而对于研究的问题来说，我们更加关注的是当给定 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; 时，sample moments 的 variance，记为 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; ，的大小。从业务上说，在一般的 overidentification 问题下（moments 个数多于参数个数），sample moments 不可能都是零（如果 moments 个数  &lt;img src=&quot;https://www.zhihu.com/equation?tex=n&quot; alt=&quot;n&quot; eeimg=&quot;1&quot;/&gt;  等于参数个数  &lt;img src=&quot;https://www.zhihu.com/equation?tex=p&quot; alt=&quot;p&quot; eeimg=&quot;1&quot;/&gt; ，我们可以令每个 moment 都等于零从而求出全部  &lt;img src=&quot;https://www.zhihu.com/equation?tex=p&quot; alt=&quot;p&quot; eeimg=&quot;1&quot;/&gt;  个参数），因此我们关心 sample moments 联合起来相对于零的偏离的大小是多少。&lt;/p&gt;&lt;p&gt;&lt;b&gt;我们必须搞清楚 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T%28%5Chat+b%29&quot; alt=&quot;g_T(\hat b)&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 联合起来相对于零的偏离是因为运气成分还是因为选择的 population moment condition 就是错的。&lt;/b&gt;如果仅仅因为运气（即偏离的很小），那可以接受 population moment conditions —— 比如接受一个选择的 asset pricing 模型；如果不是因为运气（即偏离很大），那就只能拒绝 population moment conditions —— 即 reject 一个 asset pricing 模型。这就是 statistical test。唯有有了 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; ，才能够进行 statistical test。&lt;b&gt;计算 variance 并进行 statistical test 就是 GMM 的第三部分。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;值得一提的是，由于 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T%28%5Chat+b%29&quot; alt=&quot;g_T(\hat b)&quot; eeimg=&quot;1&quot;/&gt; 都是向量，因此 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; 事实上都代表了它们各自的 &lt;b&gt;variance-covariance matrix&lt;/b&gt;，其中 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt; 是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=p+%C3%97+p&quot; alt=&quot;p × p&quot; eeimg=&quot;1&quot;/&gt; 阶矩阵（共有 &lt;img src=&quot;https://www.zhihu.com/equation?tex=p&quot; alt=&quot;p&quot; eeimg=&quot;1&quot;/&gt; 个参数），而 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; 是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=n+%C3%97+n&quot; alt=&quot;n × n&quot; eeimg=&quot;1&quot;/&gt; 阶矩阵（共有  &lt;img src=&quot;https://www.zhihu.com/equation?tex=n&quot; alt=&quot;n&quot; eeimg=&quot;1&quot;/&gt;  个 moments）。&lt;/p&gt;&lt;p&gt;有了 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; 就可以写出 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T%28%5Chat+b%29&quot; alt=&quot;g_T(\hat b)&quot; eeimg=&quot;1&quot;/&gt; 的分布。当 sample size  &lt;img src=&quot;https://www.zhihu.com/equation?tex=T&quot; alt=&quot;T&quot; eeimg=&quot;1&quot;/&gt;  趋于无穷时， &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; 的满足以下渐进正态性：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Csqrt%7BT%7D%28%5Chat+b-b_0%29%5Crightarrow%5Cmathcal%7BN%7D%5Cleft%5B0%2C+%28ad%29%5E%7B-1%7DaSa%5E%5Cprime%28ad%29%5E%7B-1%5Cprime%7D%5Cright%5D&quot; alt=&quot;\displaystyle\sqrt{T}(\hat b-b_0)\rightarrow\mathcal{N}\left[0, (ad)^{-1}aSa^\prime(ad)^{-1\prime}\right]&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;上式中， &lt;img src=&quot;https://www.zhihu.com/equation?tex=-1&quot; alt=&quot;-1&quot; eeimg=&quot;1&quot;/&gt; 表示求逆， &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cprime&quot; alt=&quot;\prime&quot; eeimg=&quot;1&quot;/&gt; 表示转置，所以 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%28ad%29%5E%7B-1%5Cprime%7D&quot; alt=&quot;(ad)^{-1\prime}&quot; eeimg=&quot;1&quot;/&gt; 表示先求 &lt;img src=&quot;https://www.zhihu.com/equation?tex=ad&quot; alt=&quot;ad&quot; eeimg=&quot;1&quot;/&gt; 的逆矩阵再转置。这个式子正是 Hansen (1982) 中的 Theorem 3.1。Hansen (1982) 给出了渐进分布成立需要满足的一系列假设。在实际应用中，我们需要记住的是&lt;b&gt;数据 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=x_t&quot; alt=&quot;x_t&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 需要满足弱平稳性，这是因为 GMM 的基础是随着 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=T&quot; alt=&quot;T&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 的增大，sample mean 向 population mean 收敛。&lt;/b&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-45f6d1441ef969c244596d5bd9777482_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;904&quot; data-rawheight=&quot;116&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;904&quot; data-original=&quot;https://pic3.zhimg.com/v2-45f6d1441ef969c244596d5bd9777482_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-45f6d1441ef969c244596d5bd9777482_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;904&quot; data-rawheight=&quot;116&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;904&quot; data-original=&quot;https://pic3.zhimg.com/v2-45f6d1441ef969c244596d5bd9777482_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-45f6d1441ef969c244596d5bd9777482_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;此外， &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T%28%5Chat+b%29&quot; alt=&quot;g_T(\hat b)&quot; eeimg=&quot;1&quot;/&gt; 满足如下渐进正态性：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Csqrt%7BT%7Dg_T%28%5Chat+b%29%5Crightarrow%5Cmathcal%7BN%7D%5Cleft%5B0%2C%28I-d%28ad%29%5E%7B-1%7Da%29S%28I-d%28ad%29%5E%7B-1%7Da%29%5E%5Cprime%5Cright%5D&quot; alt=&quot;\displaystyle\sqrt{T}g_T(\hat b)\rightarrow\mathcal{N}\left[0,(I-d(ad)^{-1}a)S(I-d(ad)^{-1}a)^\prime\right]&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;上式中， &lt;img src=&quot;https://www.zhihu.com/equation?tex=I&quot; alt=&quot;I&quot; eeimg=&quot;1&quot;/&gt;  是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=n+%C3%97+n&quot; alt=&quot;n × n&quot; eeimg=&quot;1&quot;/&gt; 阶单位阵。这个式子正是 Hansen (1982) 中的 Lemma 4.1。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-79d44f2d157583534df26f3fd996edf6_b.png&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;911&quot; data-rawheight=&quot;106&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;911&quot; data-original=&quot;https://pic3.zhimg.com/v2-79d44f2d157583534df26f3fd996edf6_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-79d44f2d157583534df26f3fd996edf6_b.png&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;911&quot; data-rawheight=&quot;106&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;911&quot; data-original=&quot;https://pic3.zhimg.com/v2-79d44f2d157583534df26f3fd996edf6_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-79d44f2d157583534df26f3fd996edf6_b.png&quot;/&gt;&lt;/figure&gt;&lt;p&gt;看到这里，你大概在想：What the hell?! 这又  &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt;  又  &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt;  又  &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt;  又求逆又转置，这都是什么“牛鬼蛇神”？有一种“每个字都认识、但是放在一起就看不懂了”的既视感。这里的 a 就是上面 sample moments 的线性组合矩阵，但是  &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt;  和  &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt;  还没有介绍。别着急，第四节将会把这些式子掰开了、揉碎了说清楚的。&lt;/p&gt;&lt;p&gt;看到  &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt;  你是否想到什么？没错，本文第二节讲 the variance of the sample mean 的时候提到了  &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt; 。而上面 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; 看似无比复杂，但它们的本质也都离不开 the variance of the sample mean！&lt;/p&gt;&lt;p&gt;在有了 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T%28%5Chat+b%29&quot; alt=&quot;g_T(\hat b)&quot; eeimg=&quot;1&quot;/&gt; 的分布后，就可以对 GMM 第一部分中选择的模型进行检验，从而决定是接受还是拒绝它。以 asset pricing 为例，这些 moments 代表了不同资产或投资组合的 pricing errors。我们关心 pricing errors 是否联合起来显著不为零，这时可以用 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T%28%5Chat+b%29&quot; alt=&quot;g_T(\hat b)&quot; eeimg=&quot;1&quot;/&gt; 的分布构建 chi-squared statistic 来检验。如果 test statistic 超过给定显著性水平的阈值，那么我们就可以拒绝该 asset pricing 模型。&lt;/p&gt;&lt;p&gt;总结一下，本小节介绍了 GMM 的三部分：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;b&gt;第一部分是把关心的问题表述成一组 population moment conditions；&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;第二部分是用 sample moments 代替 population moments 从而把样本数据和模型联系起来，并进行参数估计；&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;第三部分是计算 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 和 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;，从而进行 statistical test，决定是否接受第一部分中的模型。&lt;/b&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;下一节就来看看 statistical test 背后的数学基础。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;04 数学基础&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;OK! Let&amp;#39;s do the math!&lt;/p&gt;&lt;p&gt;本节的目标是解释 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; 里面的那些  &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt; 、求逆以及转置。我会力争把所有涉及到的公式都讲清楚。了解本节的内容无疑会更好的理解 GMM 背后的数学之美（汗），但是从阅读的角度，跳过本小节也不影响对后文的理解。&lt;/p&gt;&lt;p&gt;先说  &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt; ，这是一切的核心。从下式出发来解释  &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt; ：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+g_T%28b_0%29%5Cequiv%5Cfrac%7B1%7D%7BT%7D%5Csum_%7Bt%3D1%7D%5ET+f%28x_t%2C+b_0%29%3D%5Cfrac%7B1%7D%7BT%7D%5Csum_%7Bt%3D1%7D%5ET+U_t&quot; alt=&quot;\displaystyle g_T(b_0)\equiv\frac{1}{T}\sum_{t=1}^T f(x_t, b_0)=\frac{1}{T}\sum_{t=1}^T U_t&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;上式中第一个等价符号是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; 的定义（参考 3.2 节），第二个等号是使用 &lt;img src=&quot;https://www.zhihu.com/equation?tex=U_t&quot; alt=&quot;U_t&quot; eeimg=&quot;1&quot;/&gt; 来代表 &lt;img src=&quot;https://www.zhihu.com/equation?tex=f%28x_t%2C+b_0%29&quot; alt=&quot;f(x_t, b_0)&quot; eeimg=&quot;1&quot;/&gt; 。&lt;b&gt;需要强调的是，上式中 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 的参数是真实（但未知）的参数 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=b_0&quot; alt=&quot;b_0&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;。而&lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=+g_T%28b_0%29&quot; alt=&quot; g_T(b_0)&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 的方差 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28b_0%29%29&quot; alt=&quot;\mbox{var}(g_T(b_0))&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 就表示 sample moments &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 在真实参数&lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=b_0&quot; alt=&quot;b_0&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;下的 sampling variance。无论 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=f&quot; alt=&quot;f&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt; 长什么样子，sample moments 的数学形式都仅仅取平均，因此 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28b_0%29%29&quot; alt=&quot;\mbox{var}(g_T(b_0))&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt; 正是 the variance of the sample mean！&lt;/b&gt;（这就是本文第二节的价值所在。）&lt;/p&gt;&lt;p&gt;上面之所以用了 &lt;img src=&quot;https://www.zhihu.com/equation?tex=U_t&quot; alt=&quot;U_t&quot; eeimg=&quot;1&quot;/&gt; ，一是为了简化表达式，二是为了和本文第二节中的小写 &lt;img src=&quot;https://www.zhihu.com/equation?tex=u_t&quot; alt=&quot;u_t&quot; eeimg=&quot;1&quot;/&gt; 呼应起来：这里的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=U_t&quot; alt=&quot;U_t&quot; eeimg=&quot;1&quot;/&gt; 对应第二节的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=u_t&quot; alt=&quot;u_t&quot; eeimg=&quot;1&quot;/&gt; 、这里的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T%28b_0%29&quot; alt=&quot;g_T(b_0)&quot; eeimg=&quot;1&quot;/&gt; 就是第二节的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbar+u&quot; alt=&quot;\bar u&quot; eeimg=&quot;1&quot;/&gt; ，因此马上得到（当  &lt;img src=&quot;https://www.zhihu.com/equation?tex=T&quot; alt=&quot;T&quot; eeimg=&quot;1&quot;/&gt;  趋于无穷）：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+%5Cmbox%7Bvar%7D%28g_T%28b_0%29%29%5Crightarrow%5Cfrac%7B1%7D%7BT%7D%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D%5Cmbox%7BE%7D%5BU_tU_%7Bt-j%7D%5E%5Cprime%5D%3D%5Cfrac%7B1%7D%7BT%7DS&quot; alt=&quot;\displaystyle \mbox{var}(g_T(b_0))\rightarrow\frac{1}{T}\sum_{j=-\infty}^{\infty}\mbox{E}[U_tU_{t-j}^\prime]=\frac{1}{T}S&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;&lt;b&gt;这正是 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt; 的定义&lt;/b&gt;（实际中，它可以用样本数据来估计）。上面的计算中之所以能把方差和协方差写成 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D%5BXY%5D&quot; alt=&quot;\mbox{E}[XY]&quot; eeimg=&quot;1&quot;/&gt; 的形式是因为我们假设真实模型满足 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D%5Bf%28x_t%2C+b_0%29%5D+%3D+%5Cmbox%7BE%7D%5BU_t%5D+%3D+0&quot; alt=&quot;\mbox{E}[f(x_t, b_0)] = \mbox{E}[U_t] = 0&quot; eeimg=&quot;1&quot;/&gt; 。（预期符号 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D&quot; alt=&quot;\mbox{E}&quot; eeimg=&quot;1&quot;/&gt; 没有下标 &lt;img src=&quot;https://www.zhihu.com/equation?tex=T&quot; alt=&quot;T&quot; eeimg=&quot;1&quot;/&gt; ，表示 population expectation。）&lt;/p&gt;&lt;p&gt;重要的事情说三遍：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;上面求的 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28b_0%29%29&quot; alt=&quot;\mbox{var}(g_T(b_0))&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 是 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 在真实参数 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=b_0&quot; alt=&quot;b_0&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt;、而非估计量 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 下的 variance。&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;上面求的&lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28b_0%29%29&quot; alt=&quot;\mbox{var}(g_T(b_0))&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;是 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 在真实参数 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=b_0&quot; alt=&quot;b_0&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt;、而非估计量 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 下的 variance。&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;上面求的&lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28b_0%29%29&quot; alt=&quot;\mbox{var}(g_T(b_0))&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;是 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 在真实参数 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=b_0&quot; alt=&quot;b_0&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt;、而非估计量 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 下的 variance。&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;当然，我们最终关心的是当 &lt;img src=&quot;https://www.zhihu.com/equation?tex=b+%3D+%5Chat+b&quot; alt=&quot;b = \hat b&quot; eeimg=&quot;1&quot;/&gt; 时 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; 的方差，即 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; 。然而，一旦有了 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28b_0%29%29+%3D+S%2FT&quot; alt=&quot;\mbox{var}(g_T(b_0)) = S/T&quot; eeimg=&quot;1&quot;/&gt; ，计算 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt; 以及 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; 就变得迎刃而解。这就是为什么 Cochrane 教授说一切都可以归结为计算 the variance of the sample mean。&lt;/p&gt;&lt;p&gt;接下来就看看 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt; 如何计算。由 GMM estimator 可知， &lt;img src=&quot;https://www.zhihu.com/equation?tex=ag_T%28%5Chat+b%29+%3D+0&quot; alt=&quot;ag_T(\hat b) = 0&quot; eeimg=&quot;1&quot;/&gt; 。将该式在真实参数 &lt;img src=&quot;https://www.zhihu.com/equation?tex=b_0&quot; alt=&quot;b_0&quot; eeimg=&quot;1&quot;/&gt; 进行一阶泰勒展开有：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+ag_T%28b_0%29%2Ba%5Cfrac%7B%5Cpartial+g_T%7D%7B%5Cpartial+b%5E%5Cprime%7D%28%5Chat+b-b_0%29%3D0&quot; alt=&quot;\displaystyle ag_T(b_0)+a\frac{\partial g_T}{\partial b^\prime}(\hat b-b_0)=0&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;细心的小伙伴可能注意到了一阶偏导数  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%E2%88%82g_T%2F%E2%88%82b%5E%5Cprime&quot; alt=&quot;∂g_T/∂b^\prime&quot; eeimg=&quot;1&quot;/&gt;  的分母中 &lt;img src=&quot;https://www.zhihu.com/equation?tex=b&quot; alt=&quot;b&quot; eeimg=&quot;1&quot;/&gt; 右上角有个十分诡异的转置符号。在计算偏导数时， &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; 是一个 &lt;img src=&quot;https://www.zhihu.com/equation?tex=n+%C3%97+1&quot; alt=&quot;n × 1&quot; eeimg=&quot;1&quot;/&gt; 阶向量（ &lt;img src=&quot;https://www.zhihu.com/equation?tex=n&quot; alt=&quot;n&quot; eeimg=&quot;1&quot;/&gt;  个 moments），而  &lt;img src=&quot;https://www.zhihu.com/equation?tex=b&quot; alt=&quot;b&quot; eeimg=&quot;1&quot;/&gt;  是一个 &lt;img src=&quot;https://www.zhihu.com/equation?tex=p+%C3%97+1&quot; alt=&quot;p × 1&quot; eeimg=&quot;1&quot;/&gt; 阶向量（ &lt;img src=&quot;https://www.zhihu.com/equation?tex=p&quot; alt=&quot;p&quot; eeimg=&quot;1&quot;/&gt; 个参数），因此偏导数其实是一个矩阵（要么 &lt;img src=&quot;https://www.zhihu.com/equation?tex=n+%C3%97+p&quot; alt=&quot;n × p&quot; eeimg=&quot;1&quot;/&gt; 阶、要么 &lt;img src=&quot;https://www.zhihu.com/equation?tex=p+%C3%97+n&quot; alt=&quot;p × n&quot; eeimg=&quot;1&quot;/&gt; 阶），而这类运算属于 matrix calculus。当转置符号出现在分母时，得到的矩阵是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=n+%C3%97+p&quot; alt=&quot;n × p&quot; eeimg=&quot;1&quot;/&gt; 阶，即每一行代表一个 moment，这种排列方式称作 numerator layout，也称作 Jacobian formulation。而这个一阶偏导数矩阵也正是我们的  &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt; ：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+d%5Cequiv%5Cmbox%7BE%7D%5Cleft%5B%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+b%5E%5Cprime%7D%28x_t%2C+b%29%5Cright%5D%3D%5Cfrac%7B%5Cpartial+g_T%28b%29%7D%7B%5Cpartial+b%5E%5Cprime%7D&quot; alt=&quot;\displaystyle d\equiv\mbox{E}\left[\frac{\partial f}{\partial b^\prime}(x_t, b)\right]=\frac{\partial g_T(b)}{\partial b^\prime}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;严格来说， &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt; 应该由 population moments 的一阶导数计算（上面的第一个等价条件）；但在应用中， &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt; 的取值用 sample moments 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=b+%3D+%5Chat+b&quot; alt=&quot;b = \hat b&quot; eeimg=&quot;1&quot;/&gt; 来估计（上面的第二的等式）。用  &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt;  替换  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%E2%88%82g_T%2F%E2%88%82b%5E%5Cprime&quot; alt=&quot;∂g_T/∂b^\prime&quot; eeimg=&quot;1&quot;/&gt;  并代入上面的泰勒展开，进行简单的代数运算可得：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+%26ag_T%28b_0%29%2Bad%28%5Chat+b-b_0%29%3D0%5C%5C+%5CRightarrow%26%5Chat+b-b_0%3D-%28ad%29%5E%7B-1%7Dag_T%28b_0%29+%5Cend%7Barray%7D&quot; alt=&quot;\begin{array}{rll} &amp;amp;ag_T(b_0)+ad(\hat b-b_0)=0\\ \Rightarrow&amp;amp;\hat b-b_0=-(ad)^{-1}ag_T(b_0) \end{array}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;上式两边直接求 variance 就得到 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b-b_0%29&quot; alt=&quot;\mbox{var}(\hat b-b_0)&quot; eeimg=&quot;1&quot;/&gt; 。值得一提的是，上式右侧的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%28ad%29%5E%7B-1%7Da&quot; alt=&quot;(ad)^{-1}a&quot; eeimg=&quot;1&quot;/&gt; 是系数矩阵而 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T%28b_0%29&quot; alt=&quot;g_T(b_0)&quot; eeimg=&quot;1&quot;/&gt; 的 variance 我们之前已经求出来了 —— 没错正是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=S%2FT&quot; alt=&quot;S/T&quot; eeimg=&quot;1&quot;/&gt; 。因此有：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Cmbox%7Bvar%7D%28%5Chat+b-b_0%29%3D%5Cfrac%7B1%7D%7BT%7D%28ad%29%5E%7B-1%7DaSa%5E%5Cprime%28ad%29%5E%7B-1%5Cprime%7D&quot; alt=&quot;\displaystyle\mbox{var}(\hat b-b_0)=\frac{1}{T}(ad)^{-1}aSa^\prime(ad)^{-1\prime}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;数学上虽然通过泰勒展开顺理成章的从 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28b_0%29%29&quot; alt=&quot;\mbox{var}(g_T(b_0))&quot; eeimg=&quot;1&quot;/&gt; 得到了 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b-b_0%29&quot; alt=&quot;\mbox{var}(\hat b-b_0)&quot; eeimg=&quot;1&quot;/&gt; ，但我们仍然希望从直觉上了解上面一顿操作猛如虎到底干了什么。考虑最简单的情况，即一个 moment 和一个参数（因此 &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; 是一个标量，令 &lt;img src=&quot;https://www.zhihu.com/equation?tex=a+%3D+1&quot; alt=&quot;a = 1&quot; eeimg=&quot;1&quot;/&gt; ），我们可以画出 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28b_0%29%29&quot; alt=&quot;\mbox{var}(g_T(b_0))&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b+-+b_0%29&quot; alt=&quot;\mbox{var}(\hat b - b_0)&quot; eeimg=&quot;1&quot;/&gt; 的关系。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-86baaf4c057fa96625436eafa0bd77c7_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;853&quot; data-rawheight=&quot;387&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;853&quot; data-original=&quot;https://pic4.zhimg.com/v2-86baaf4c057fa96625436eafa0bd77c7_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-86baaf4c057fa96625436eafa0bd77c7_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;853&quot; data-rawheight=&quot;387&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;853&quot; data-original=&quot;https://pic4.zhimg.com/v2-86baaf4c057fa96625436eafa0bd77c7_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-86baaf4c057fa96625436eafa0bd77c7_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;图中，灰色曲线表示不同参数  &lt;img src=&quot;https://www.zhihu.com/equation?tex=b&quot; alt=&quot;b&quot; eeimg=&quot;1&quot;/&gt;  时的 population moment，用 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g%28b%29&quot; alt=&quot;g(b)&quot; eeimg=&quot;1&quot;/&gt; 表示。对于真实参数 &lt;img src=&quot;https://www.zhihu.com/equation?tex=b_0&quot; alt=&quot;b_0&quot; eeimg=&quot;1&quot;/&gt; ，由假设有 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g%28b_0%29+%3D+%5Cmbox%7BE%7D%5Bf%28x_t%2C+b_0%29%5D+%3D+0&quot; alt=&quot;g(b_0) = \mbox{E}[f(x_t, b_0)] = 0&quot; eeimg=&quot;1&quot;/&gt; ，因此在图上，灰色曲线经过 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%28b_0%2C+0%29&quot; alt=&quot;(b_0, 0)&quot; eeimg=&quot;1&quot;/&gt; 这个点；蓝色曲线表示不同参数  &lt;img src=&quot;https://www.zhihu.com/equation?tex=b&quot; alt=&quot;b&quot; eeimg=&quot;1&quot;/&gt;  时的 sample moment，用 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T%28b%29&quot; alt=&quot;g_T(b)&quot; eeimg=&quot;1&quot;/&gt; 表示。图中 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T%28b_0%29&quot; alt=&quot;g_T(b_0)&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g%28b_0%29+%3D+0&quot; alt=&quot;g(b_0) = 0&quot; eeimg=&quot;1&quot;/&gt; 之间的距离就是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T%28b_0%29&quot; alt=&quot;g_T(b_0)&quot; eeimg=&quot;1&quot;/&gt; 的 sampling variation，即我们的样本可能由于 luck 或者 unluck，以至于 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T%28b_0%29+%E2%89%A0+0&quot; alt=&quot;g_T(b_0) ≠ 0&quot; eeimg=&quot;1&quot;/&gt; 而是较  &lt;img src=&quot;https://www.zhihu.com/equation?tex=0&quot; alt=&quot;0&quot; eeimg=&quot;1&quot;/&gt;  有一定的偏离，在统计上它就是  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28b_0%29%29&quot; alt=&quot;\mbox{var}(g_T(b_0))&quot; eeimg=&quot;1&quot;/&gt; 。&lt;/p&gt;&lt;p&gt;接下来，对于 sample moment &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; ，我们令其等于 0 求出的参数估计为 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; ，因此蓝色曲线  &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt;  经过 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%28%5Chat+b%2C+0%29&quot; alt=&quot;(\hat b, 0)&quot; eeimg=&quot;1&quot;/&gt; 这个点。下面在蓝线上的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; 点计算其切线（红色）并计算切线的斜率 &lt;img src=&quot;https://www.zhihu.com/equation?tex=d+%3D+%5Cmbox%7Bd%7Dg%2F%5Cmbox%7Bd%7Db&quot; alt=&quot;d = \mbox{d}g/\mbox{d}b&quot; eeimg=&quot;1&quot;/&gt; 。通过 &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt; 我们就可以把 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T%28b_0%29&quot; alt=&quot;g_T(b_0)&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g%28b_0%29+%3D+0&quot; alt=&quot;g(b_0) = 0&quot; eeimg=&quot;1&quot;/&gt; 之间的 sampling variation 转换成 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=b_0&quot; alt=&quot;b_0&quot; eeimg=&quot;1&quot;/&gt; 之间的 sampling variation，即 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b+%E2%80%93+b_0%29&quot; alt=&quot;\mbox{var}(\hat b – b_0)&quot; eeimg=&quot;1&quot;/&gt; 。这正是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28b_0%29%29&quot; alt=&quot;\mbox{var}(g_T(b_0))&quot; eeimg=&quot;1&quot;/&gt; 和  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b+%E2%80%93+b_0%29&quot; alt=&quot;\mbox{var}(\hat b – b_0)&quot; eeimg=&quot;1&quot;/&gt;  关系的几何含义。&lt;/p&gt;&lt;p&gt;下面我们如法炮制，利用一阶泰勒展开从 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28b_0%29%29&quot; alt=&quot;\mbox{var}(g_T(b_0))&quot; eeimg=&quot;1&quot;/&gt; 求解 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; ：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+g_T%28%5Chat+b%29%3Dg_T%28b_0%29%2B%5Cfrac%7B%5Cpartial+g_T%7D%7B%5Cpartial+b%5E%5Cprime%7D%28%5Chat+b-b_0%29&quot; alt=&quot;\displaystyle g_T(\hat b)=g_T(b_0)+\frac{\partial g_T}{\partial b^\prime}(\hat b-b_0)&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;由于 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b+%E2%80%93+b_0&quot; alt=&quot;\hat b – b_0&quot; eeimg=&quot;1&quot;/&gt; 已经在之前求出了，因此只需把它代入到上式就可得到：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+g_T%28%5Chat+b%29%26%3D%26%5Cdisplaystyle+g_T%28b_0%29-d%28ad%29%5E%7B-1%7Dag_T%28b_0%29%5C%5C+%26%3D%26%5Cleft%5BI-d%28ad%29%5E%7B-1%7Da%5Cright%5Dg_T%28b_0%29+%5Cend%7Barray%7D&quot; alt=&quot;\begin{array}{rll} g_T(\hat b)&amp;amp;=&amp;amp;\displaystyle g_T(b_0)-d(ad)^{-1}ag_T(b_0)\\ &amp;amp;=&amp;amp;\left[I-d(ad)^{-1}a\right]g_T(b_0) \end{array}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;两边同时求 variance（确切的说是 variance-covariance matrix）有：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29%26%3D%26%5Cdisplaystyle%5Cleft%5BI-d%28ad%29%5E%7B-1%7Da%5Cright%5D%5Cmbox%7Bvar%7D%28g_T%28b_0%29%29%5Cleft%5BI-d%28ad%29%5E%7B-1%7Da%5Cright%5D%5E%5Cprime%5C%5C+%26%3D%26%5Cdisplaystyle%5Cfrac%7B1%7D%7BT%7D%5Cleft%5BI-d%28ad%29%5E%7B-1%7Da%5Cright%5DS%5Cleft%5BI-d%28ad%29%5E%7B-1%7Da%5Cright%5D%5E%5Cprime+%5Cend%7Barray%7D&quot; alt=&quot;\begin{array}{rll} \mbox{var}(g_T(\hat b))&amp;amp;=&amp;amp;\displaystyle\left[I-d(ad)^{-1}a\right]\mbox{var}(g_T(b_0))\left[I-d(ad)^{-1}a\right]^\prime\\ &amp;amp;=&amp;amp;\displaystyle\frac{1}{T}\left[I-d(ad)^{-1}a\right]S\left[I-d(ad)^{-1}a\right]^\prime \end{array}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;上式中的第二个等式用到了我们的老朋友： &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28b_0%29%29+%3D+S%2FT&quot; alt=&quot;\mbox{var}(g_T(b_0)) = S/T&quot; eeimg=&quot;1&quot;/&gt; —— variance of sample mean！关于 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28b_0%29%29&quot; alt=&quot;\mbox{var}(g_T(b_0))&quot; eeimg=&quot;1&quot;/&gt; 的关系也可以从直觉上解释两句。不难看出， &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; 是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28b_0%29%29&quot; alt=&quot;\mbox{var}(g_T(b_0))&quot; eeimg=&quot;1&quot;/&gt; 乘以一个系数矩阵，这个系数矩阵是单位阵  &lt;img src=&quot;https://www.zhihu.com/equation?tex=I&quot; alt=&quot;I&quot; eeimg=&quot;1&quot;/&gt;  减去这一大坨 &lt;img src=&quot;https://www.zhihu.com/equation?tex=d%28ad%29%5E%7B-1%7Da&quot; alt=&quot;d(ad)^{-1}a&quot; eeimg=&quot;1&quot;/&gt; 。&lt;b&gt;因此从直觉上说，&lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 在 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=b+%3D+%5Chat+b&quot; alt=&quot;b = \hat b&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 时的方差 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;会比 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 在 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=b+%3D+b_0&quot; alt=&quot;b = b_0&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 时的方差 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28b_0%29%29&quot; alt=&quot;\mbox{var}(g_T(b_0))&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;要小一些。&lt;/b&gt;这是因为在 GMM 估计时，我们要求 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; 的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=p&quot; alt=&quot;p&quot; eeimg=&quot;1&quot;/&gt; 个线性组合等于零 —— &lt;img src=&quot;https://www.zhihu.com/equation?tex=ag_T%28%5Chat+b%29+%3D+0&quot; alt=&quot;ag_T(\hat b) = 0&quot; eeimg=&quot;1&quot;/&gt; —— 从而求出 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; ，因此求解 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; 的过程用掉了 sample moments 的一些 variation，所以当 &lt;img src=&quot;https://www.zhihu.com/equation?tex=b+%3D+%5Chat+b&quot; alt=&quot;b = \hat b&quot; eeimg=&quot;1&quot;/&gt; 时 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; 方差小于当 &lt;img src=&quot;https://www.zhihu.com/equation?tex=b+%3D+b_0&quot; alt=&quot;b = b_0&quot; eeimg=&quot;1&quot;/&gt; 时 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; 的方差。&lt;/p&gt;&lt;p&gt;&lt;b&gt;无论是 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 还是 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;，上面一顿泰勒展开操作虽然非常热闹，但它们其实都仅是用了统计学中的 delta method。所以，其实我们只是用了 variance of the sample mean（&lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=S%2FT&quot; alt=&quot;S/T&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;）+ delta method 就求出了我们关心的&lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 和 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;。就是这么简单。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;有了 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; ，就可以得到 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T%28%5Chat+b%29&quot; alt=&quot;g_T(\hat b)&quot; eeimg=&quot;1&quot;/&gt; 的渐近分布（3.3 节介绍过），使用它的分布就可以构建 chi-squared statistic 来对模型进行检验：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+%26%5Cdisplaystyle+g_T%28%5Chat+b%29%5E%5Cprime%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29%5E%7B-1%7Dg_T%28%5Chat+b%29%5Csim%5Cchi%5E2_%7Bn-p%7D%5C%5C+%5CRightarrow%26%5Cdisplaystyle+Tg_T%28%5Chat+b%29%5E%5Cprime%5Cleft%5B%5Cleft%28I-d%28ad%29%5E%7B-1%7Da%5Cright%29S%5Cleft%28I-d%28ad%29%5E%7B-1%7Da%5Cright%29%5E%5Cprime%5Cright%5D%5E%7B-1%7D+g_T%28%5Chat+b%29%5Csim%5Cchi%5E2_%7Bn-p%7D+%5Cend%7Barray%7D&quot; alt=&quot;\begin{array}{rll} &amp;amp;\displaystyle g_T(\hat b)^\prime\mbox{var}(g_T(\hat b))^{-1}g_T(\hat b)\sim\chi^2_{n-p}\\ \Rightarrow&amp;amp;\displaystyle Tg_T(\hat b)^\prime\left[\left(I-d(ad)^{-1}a\right)S\left(I-d(ad)^{-1}a\right)^\prime\right]^{-1} g_T(\hat b)\sim\chi^2_{n-p} \end{array}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;上式的第二步是把  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt;  的表达式代入并求逆；chi-squared statistic 的自由度是 moments 的个数减去参数的个数，即 &lt;img src=&quot;https://www.zhihu.com/equation?tex=n+%E2%80%93+p&quot; alt=&quot;n – p&quot; eeimg=&quot;1&quot;/&gt; 。&lt;b&gt;由于估计 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 的时候用掉了 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=p&quot; alt=&quot;p&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt; 个自由度，所以 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T%28%5Chat+b%29&quot; alt=&quot;g_T(\hat b)&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt; 的 variance-covariance matrix 不是满秩的（这也体现在了 chi-squared statistic 的自由度 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=n+%E2%80%93+p&quot; alt=&quot;n – p&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 上），因此上式中对 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 求逆实际上是 pseudo-inverse。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;如果你在 Wikipedia 或者其他书籍上查阅 GMM 的资料，也许看到的 chi-squared statistic 的表达式远没有上面这个复杂。&lt;b&gt;上述表达式是最 general 的情况&lt;/b&gt;，因为我们尚未讨论那个使 GMM estimator 变得 efficient 的特殊的矩阵  &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; 。在那个  &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt;  下， &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; 矩阵以及 chi-squared statistic 表达式将被大大的简化。Efficient GMM 就是下一节的内容。&lt;/p&gt;&lt;p&gt;总结一下本小节。上面用了大量的文字和推导把 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; 背后的数学含义呈现给各位，是希望这个过程能帮助小伙伴们加深对 GMM 的理解。站在 notation 的角度来说，虽然这些公式看上去很复杂（又是转置、又是求逆的），&lt;b&gt;但我们只需给 GMM 框架提供它需要的 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;、&lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;、&lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt; 和 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;，剩下的“无脑”交给 GMM 就可以计算出各种想要的统计量并进行 test，非常方便。&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;05 Efficient GMM&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;本文的 3.2 小节给出的 GMM estimator 如下：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Chat+b%3A+%5Cmbox%7Bset+%7D+ag_T%28%5Chat+b%29%3D0&quot; alt=&quot;\displaystyle\hat b: \mbox{set } ag_T(\hat b)=0&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;其中  &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt;  是一个 &lt;img src=&quot;https://www.zhihu.com/equation?tex=p+%C3%97+n&quot; alt=&quot;p × n&quot; eeimg=&quot;1&quot;/&gt; 阶矩阵，每一行都代表一个 sample moments 的线性组合。本节关心的问题是，&lt;b&gt;如何选取矩阵 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;？&lt;/b&gt;回答这个问题可以从&lt;b&gt;业务上&lt;/b&gt;和&lt;b&gt;统计上&lt;/b&gt;两方面思考 —— &lt;b&gt;永远不要忘记业务层面的思考！从经济学或金融学原理出发，尤其是针对 asset pricing 的问题，我们可以选择一些最 economically important 的 moments，让它们或它们的线性组合等于零。我们不应让 GMM 成为一个 statistical 黑箱，代替我们的思考。&lt;/b&gt;第七节将会进一步说明。&lt;/p&gt;&lt;p&gt;再来从统计上说，Hansen (1982) 指出了一个特殊的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; 矩阵，它能确保得到 efficient GMM estimator，即在给定的 moments &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; 下，该矩阵  &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt;  使得 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt; 最小。这个特殊的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; 矩阵为：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+a%3Dd%5E%5Cprime+S%5E%7B-1%7D&quot; alt=&quot;\displaystyle a=d^\prime S^{-1}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;看到这里可能又有小伙伴会问： &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt;  见过、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt;  见过、转置明白、求逆矩阵清楚，但是这四个符号组合在一起得到的  &lt;img src=&quot;https://www.zhihu.com/equation?tex=d%5E%5Cprime+S%5E%7B-1%7D&quot; alt=&quot;d^\prime S^{-1}&quot; eeimg=&quot;1&quot;/&gt;  是个什么鬼？？这个 &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; 到底有没有什么更直观的含义？别急，先来看看  &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt;  的阶数。本文的 3.2 节已经指出  &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt;  是一个 &lt;img src=&quot;https://www.zhihu.com/equation?tex=p+%C3%97+n&quot; alt=&quot;p × n&quot; eeimg=&quot;1&quot;/&gt; 阶矩阵，下面我们来验证一下。&lt;/p&gt;&lt;p&gt;前面首次提到 &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt; 的时候说过了，它是一阶偏导数  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%E2%88%82g_T%2F%E2%88%82b%5E%5Cprime&quot; alt=&quot;∂g_T/∂b^\prime&quot; eeimg=&quot;1&quot;/&gt; 。但由于 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; （ &lt;img src=&quot;https://www.zhihu.com/equation?tex=n+%C3%97+1&quot; alt=&quot;n × 1&quot; eeimg=&quot;1&quot;/&gt; 阶）和  &lt;img src=&quot;https://www.zhihu.com/equation?tex=b&quot; alt=&quot;b&quot; eeimg=&quot;1&quot;/&gt; （ &lt;img src=&quot;https://www.zhihu.com/equation?tex=p+%C3%97+1&quot; alt=&quot;p × 1&quot; eeimg=&quot;1&quot;/&gt; 阶）都是 vectors，因此  &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt;  是一个遵照 numerator layout（也称作 Jacobian formulation）排列的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=n+%C3%97+p&quot; alt=&quot;n × p&quot; eeimg=&quot;1&quot;/&gt; 阶矩阵。因此矩阵  &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt;  的转置  &lt;img src=&quot;https://www.zhihu.com/equation?tex=d%5E%5Cprime&quot; alt=&quot;d^\prime&quot; eeimg=&quot;1&quot;/&gt;  就是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=p+%C3%97+n&quot; alt=&quot;p × n&quot; eeimg=&quot;1&quot;/&gt; 的矩阵，它同样也是一个一阶偏导数  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%E2%88%82g_T%5E%5Cprime%2F%E2%88%82b&quot; alt=&quot;∂g_T^\prime/∂b&quot; eeimg=&quot;1&quot;/&gt;  —— 这次转置在 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; 上，遵循的是 denominator layout（也称 Hessian formulation），通常表示&lt;b&gt;求梯度（gradient）&lt;/b&gt;。最后，由于 &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt; 是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=n+%C3%97+n&quot; alt=&quot;n × n&quot; eeimg=&quot;1&quot;/&gt; 阶，因此 a 确实是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=p+%C3%97+n&quot; alt=&quot;p × n&quot; eeimg=&quot;1&quot;/&gt; 阶。&lt;/p&gt;&lt;p&gt;下面我们就来看看 &lt;img src=&quot;https://www.zhihu.com/equation?tex=d%5E%5Cprime+S%5E%7B-1%7D&quot; alt=&quot;d^\prime S^{-1}&quot; eeimg=&quot;1&quot;/&gt; 到底是个什么鬼。其实它有着非常清晰的含义。为了解释 &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; 就不得不提 GMM estimator 的另一种表达式，这可能也是之前接触过 GMM 的小伙伴更熟悉的一种表达式：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Chat+b%3D+%5Carg%5Cmin+g_T%28b%29%5E%5Cprime+Wg_T%28b%29&quot; alt=&quot;\displaystyle\hat b= \arg\min g_T(b)^\prime Wg_T(b)&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;上式中  &lt;img src=&quot;https://www.zhihu.com/equation?tex=W&quot; alt=&quot;W&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt; 是权重矩阵（weighting matrix）&lt;/b&gt;，它是一个半正定矩阵。这个式子的含义是，在 overidentification 问题中，既然我们无法让所有的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; 都等于零，那么就让所有  &lt;img src=&quot;https://www.zhihu.com/equation?tex=n&quot; alt=&quot;n&quot; eeimg=&quot;1&quot;/&gt;  个  &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt;  的范数的加权之和尽可能的接近零，以此来确定 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; 。&lt;/p&gt;&lt;p&gt;正如在本文的第一种 GMM estimator 表达中我们可以随意选择矩阵  &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt;  一样，在上面的第二种 GMM estimator 表达中我们可以随意选择权重矩阵  &lt;img src=&quot;https://www.zhihu.com/equation?tex=W&quot; alt=&quot;W&quot; eeimg=&quot;1&quot;/&gt; 。但是从 efficiency 的角度，最优的权重矩阵  &lt;img src=&quot;https://www.zhihu.com/equation?tex=W&quot; alt=&quot;W&quot; eeimg=&quot;1&quot;/&gt;  满足：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+W%3DS%5E%7B-1%7D&quot; alt=&quot;\displaystyle W=S^{-1}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;这从统计上非常好理解：我们有一组 moments &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; ，我们希望它们（非负）加权之和最接近零。使用 &lt;img src=&quot;https://www.zhihu.com/equation?tex=W+%3D+S%5E%7B-1%7D&quot; alt=&quot;W = S^{-1}&quot; eeimg=&quot;1&quot;/&gt; 即 &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt; 的&lt;b&gt;逆矩阵&lt;/b&gt;（别忘了 &lt;img src=&quot;https://www.zhihu.com/equation?tex=S%2FT&quot; alt=&quot;S/T&quot; eeimg=&quot;1&quot;/&gt; 是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28b_0%29%29&quot; alt=&quot;\mbox{var}(g_T(b_0))&quot; eeimg=&quot;1&quot;/&gt; ）&lt;b&gt;相当于给那些 sampling variation&lt;/b&gt; &lt;b&gt;大的 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 更低的权重、给那些 sampling variation&lt;/b&gt; &lt;b&gt;小的 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 更高的权重（inverse 的意义）。换句话说，我们更愿意相信那些误差小的 moments 并使用它们来得到尽可能准确的参数估计 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;，从而使 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 最低，这也就是 efficient 的含义。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;将 &lt;img src=&quot;https://www.zhihu.com/equation?tex=W+%3D+S%5E%7B-1%7D&quot; alt=&quot;W = S^{-1}&quot; eeimg=&quot;1&quot;/&gt; 代入上面第二个 GMM estimator 并求其 first order condition 有：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+%5Cleft%28%5Cfrac%7B%5Cpartial+g_T%5E%5Cprime%7D%7B%5Cpartial+b%7DS%5E%7B-1%7D%5Cright%29g_T%28%5Chat+b%29%3D0&quot; alt=&quot;\displaystyle \left(\frac{\partial g_T^\prime}{\partial b}S^{-1}\right)g_T(\hat b)=0&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;怎么样，看着眼熟不？括号里的第一项正是  &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt;  的转置  &lt;img src=&quot;https://www.zhihu.com/equation?tex=d%5E%5Cprime&quot; alt=&quot;d^\prime&quot; eeimg=&quot;1&quot;/&gt; ，第二项是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=S%5E%7B-1%7D&quot; alt=&quot;S^{-1}&quot; eeimg=&quot;1&quot;/&gt; ，这两个放一起  &lt;img src=&quot;https://www.zhihu.com/equation?tex=d%5E%5Cprime+S%5E%7B-1%7D&quot; alt=&quot;d^\prime S^{-1}&quot; eeimg=&quot;1&quot;/&gt;  正是第一种 GMM estimator 下最优的矩阵 &lt;img src=&quot;https://www.zhihu.com/equation?tex=a+%3D+d%5E%5Cprime+S%5E%7B-1%7D&quot; alt=&quot;a = d^\prime S^{-1}&quot; eeimg=&quot;1&quot;/&gt; ：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brrl%7D+%26%5Cmbox%7BGMM+estimator+%7DW%3DS%5E%7B-1%7D%3A%26%5Cdisplaystyle%5Chat+b%3D+%5Carg%5Cmin+g_T%28b%29%5E%5Cprime+S%5E%7B-1%7Dg_T%28b%29%5C%5C+%5CRightarrow%26%5Cmbox%7Bfirst+order+condition%7D%3A%26%5Cdisplaystyle+%5Cleft%28%5Cfrac%7B%5Cpartial+g_T%5E%5Cprime%7D%7B%5Cpartial+b%7DS%5E%7B-1%7D%5Cright%29g_T%28%5Chat+b%29%3D0%5C%5C+%5CRightarrow%26%26%5Cdisplaystyle+%5Cleft%28%5Cleft%5B%5Cfrac%7B%5Cpartial+g_T%7D%7B%5Cpartial+b%5E%5Cprime%7D%5Cright%5D%5E%5Cprime+S%5E%7B-1%7D%5Cright%29g_T%28%5Chat+b%29%3D0%5C%5C+%5CRightarrow%26%26%5Cdisplaystyle+%5Cleft%28d%5E%5Cprime+S%5E%7B-1%7D%5Cright%29g_T%28%5Chat+b%29%3D0%5C%5C+%5CRightarrow%26%5Cmbox%7BGMM+estimator+%7Da%3Dd%5E%5Cprime+S%5E%7B-1%7D%3A%26%5Cdisplaystyle+ag_T%28%5Chat+b%29%3D0+%5Cend%7Barray%7D&quot; alt=&quot;\begin{array}{rrl} &amp;amp;\mbox{GMM estimator }W=S^{-1}:&amp;amp;\displaystyle\hat b= \arg\min g_T(b)^\prime S^{-1}g_T(b)\\ \Rightarrow&amp;amp;\mbox{first order condition}:&amp;amp;\displaystyle \left(\frac{\partial g_T^\prime}{\partial b}S^{-1}\right)g_T(\hat b)=0\\ \Rightarrow&amp;amp;&amp;amp;\displaystyle \left(\left[\frac{\partial g_T}{\partial b^\prime}\right]^\prime S^{-1}\right)g_T(\hat b)=0\\ \Rightarrow&amp;amp;&amp;amp;\displaystyle \left(d^\prime S^{-1}\right)g_T(\hat b)=0\\ \Rightarrow&amp;amp;\mbox{GMM estimator }a=d^\prime S^{-1}:&amp;amp;\displaystyle ag_T(\hat b)=0 \end{array}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;这就是最优矩阵  &lt;img src=&quot;https://www.zhihu.com/equation?tex=a+%3D+d%5E%5Cprime+S%5E%7B-1%7D&quot; alt=&quot;a = d^\prime S^{-1}&quot; eeimg=&quot;1&quot;/&gt;  的含义。从上面的推导也不难看出这两种 GMM estimator 表达式是等价的：无论我们取何种  &lt;img src=&quot;https://www.zhihu.com/equation?tex=W&quot; alt=&quot;W&quot; eeimg=&quot;1&quot;/&gt;  权重矩阵，都有一个与之对应的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=a+%3D+d%5E%5Cprime+W&quot; alt=&quot;a = d^\prime W&quot; eeimg=&quot;1&quot;/&gt; 矩阵。当矩阵  &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt;  或权重矩阵  &lt;img src=&quot;https://www.zhihu.com/equation?tex=W&quot; alt=&quot;W&quot; eeimg=&quot;1&quot;/&gt;  取统计上最优时， &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; 以及 chi-squared test statistic 的表达式均可以大大化简。Hansen (1982) 给出了它们的形式：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+%5Cmbox%7Bvar%7D%28%5Chat+b%29%26%3D%26%5Cdisplaystyle%5Cfrac%7B1%7D%7BT%7D%5Cleft%28d%5E%5Cprime+S%5E%7B-1%7Dd%5Cright%29%5E%7B-1%7D%5C%5C+%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29%26%3D%26%5Cdisplaystyle%5Cfrac%7B1%7D%7BT%7D%5Cleft%28S-d%28d%5E%5Cprime+S%5E%7B-1%7Dd%29%5E%7B-1%7Dd%5E%5Cprime%5Cright%29%5C%5C+Tg_T%28%5Chat+b%29%5E%5Cprime+S%5E%7B-1%7Dg_T%28%5Chat+b%29%26%5Csim%26%5Cchi%5E2_%7Bn-p%7D+%5Cend%7Barray%7D&quot; alt=&quot;\begin{array}{rll} \mbox{var}(\hat b)&amp;amp;=&amp;amp;\displaystyle\frac{1}{T}\left(d^\prime S^{-1}d\right)^{-1}\\ \mbox{var}(g_T(\hat b))&amp;amp;=&amp;amp;\displaystyle\frac{1}{T}\left(S-d(d^\prime S^{-1}d)^{-1}d^\prime\right)\\ Tg_T(\hat b)^\prime S^{-1}g_T(\hat b)&amp;amp;\sim&amp;amp;\chi^2_{n-p} \end{array}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;&lt;b&gt;需要强调的是，以上的这些大大简化了的表达式只有当 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=a+%3D+d%5E%5Cprime+S%5E%7B-1%7D&quot; alt=&quot;a = d^\prime S^{-1}&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;（或 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=W+%3D+S%5E%7B-1%7D&quot; alt=&quot;W = S^{-1}&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;）时才成立！如果 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt; 或 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=W&quot; alt=&quot;W&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt; 取别的值，则应该使用本文第 4 节中介绍的更 general 的形式。&lt;/b&gt;很多关于 GMM 的材料中默认 &lt;img src=&quot;https://www.zhihu.com/equation?tex=W+%3D+S%5E%7B-1%7D&quot; alt=&quot;W = S^{-1}&quot; eeimg=&quot;1&quot;/&gt; 而给出了这些统计量的简化形式，使用时应搞清楚前提条件。&lt;/p&gt;&lt;p&gt;在实际估计中，因为必须先有 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; 才能估计  &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt; ，并计算 &lt;img src=&quot;https://www.zhihu.com/equation?tex=W+%3D+S%5E%7B-1%7D&quot; alt=&quot;W = S^{-1}&quot; eeimg=&quot;1&quot;/&gt; （或最优的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; ）；但另一方面只有使用 &lt;img src=&quot;https://www.zhihu.com/equation?tex=S%5E%7B-1%7D&quot; alt=&quot;S^{-1}&quot; eeimg=&quot;1&quot;/&gt; 才能得到最优的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; 。这似乎是一个鸡生蛋、蛋生鸡的问题。因此，实际中往往采用 two-stage estimates：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;First Stage：&lt;/b&gt;通常取 &lt;img src=&quot;https://www.zhihu.com/equation?tex=W+%3D+I&quot; alt=&quot;W = I&quot; eeimg=&quot;1&quot;/&gt; 单位阵，估计出 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; ；&lt;/li&gt;&lt;li&gt;&lt;b&gt;Second Stage：&lt;/b&gt;使用  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt;  估计 S，令 &lt;img src=&quot;https://www.zhihu.com/equation?tex=W+%3D+S%5E%7B-1%7D&quot; alt=&quot;W = S^{-1}&quot; eeimg=&quot;1&quot;/&gt; 进行再一次估计得到新的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; 。&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;当然，如果愿意，也可以把上面的第二步&lt;b&gt;迭代多次&lt;/b&gt;，得到最终的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; 。以上就完成了关于 GMM 的全部介绍。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;06 GMM does OLS&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;GMM 之所以如此强大，是因为它自带的“estimate、variance、test”三部曲能够干很多事儿！对于很多需要研究的问题，只要把它的模型塞进 GMM 的框架，就可以得到想要的分析结果。&lt;/p&gt;&lt;p&gt;本节就把我们熟悉的 OLS 放在 GMM 的框架下看看后者的强大之处。由于参数个数和 moments 个数相同，因此 OLS 不存在 overidentification 的问题，我们没有什么可以检验的。但是 GMM 仍然可以轻松的计算出参数的 variance（即完成 estimate 和 variance 两步），无论 OLS 的残差是否存在自相关或异方差。&lt;/p&gt;&lt;p&gt;想要使用 GMM 框架，只需要把 OLS 表述成 moment conditions。考虑 OLS 问题（截距被视作一个解释变量，不做区分；假设一共有  &lt;img src=&quot;https://www.zhihu.com/equation?tex=k&quot; alt=&quot;k&quot; eeimg=&quot;1&quot;/&gt;  个解释变量，因此 &lt;img src=&quot;https://www.zhihu.com/equation?tex=x_t&quot; alt=&quot;x_t&quot; eeimg=&quot;1&quot;/&gt; 表示 &lt;img src=&quot;https://www.zhihu.com/equation?tex=k+%C3%97+1&quot; alt=&quot;k × 1&quot; eeimg=&quot;1&quot;/&gt; 阶向量）如下：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+y_t%3D%5Cbeta%5E%5Cprime+x_t%2B%5Cvarepsilon_t&quot; alt=&quot;\displaystyle y_t=\beta^\prime x_t+\varepsilon_t&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;由 OLS 的性质可知，其解释变量和残差正交，因此 OLS 的 moment conditions 为：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T%28%5Chat%5Cbeta%29%3D%5Cmbox%7BE%7D_T%5Cleft%5Bx_t%28y_t-%5Chat%5Cbeta%5E%5Cprime+x_t%29%5Cright%5D%3D0&quot; alt=&quot;g_T(\hat\beta)=\mbox{E}_T\left[x_t(y_t-\hat\beta^\prime x_t)\right]=0&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;由于 moments 个数和参数个数相同，因此我们只需要令所有 sample moments 都等于零即可，这意味着矩阵 &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; 是单位阵 &lt;img src=&quot;https://www.zhihu.com/equation?tex=I&quot; alt=&quot;I&quot; eeimg=&quot;1&quot;/&gt; ，因此在上式的 GMM estimator 中省略了  &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; 。求解上述 sample moment conditions 就可以得到参数的估计：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Chat%5Cbeta%3D%5Cleft%5B%5Cmbox%7BE%7D_T%28x_tx_t%5E%5Cprime%29%5Cright%5D%5E%7B-1%7D%5Cmbox%7BE%7D_T%28x_ty_t%29&quot; alt=&quot;\displaystyle\hat\beta=\left[\mbox{E}_T(x_tx_t^\prime)\right]^{-1}\mbox{E}_T(x_ty_t)&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;如果令  &lt;img src=&quot;https://www.zhihu.com/equation?tex=X+%3D+%5Bx_1+x_2+%E2%80%A6+x_t%5D%5E%5Cprime&quot; alt=&quot;X = [x_1 x_2 … x_t]^\prime&quot; eeimg=&quot;1&quot;/&gt;  表示 data matrix，则有 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%281%2FT%29X%5E%5Cprime+X+%3D+%5Cmbox%7BE%7D_T%5Bx_tx_t%5E%5Cprime%5D&quot; alt=&quot;(1/T)X^\prime X = \mbox{E}_T[x_tx_t^\prime]&quot; eeimg=&quot;1&quot;/&gt; ，因此上式又可以写成：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Chat%5Cbeta%3D%5Cleft%5B%5Cmbox%7BE%7D_T%28x_tx_t%5E%5Cprime%29%5Cright%5D%5E%7B-1%7D%5Cmbox%7BE%7D_T%28x_ty_t%29%3D%28X%5E%5Cprime+X%29%5E%7B-1%7DX%5E%5Cprime+Y&quot; alt=&quot;\displaystyle\hat\beta=\left[\mbox{E}_T(x_tx_t^\prime)\right]^{-1}\mbox{E}_T(x_ty_t)=(X^\prime X)^{-1}X^\prime Y&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;这正是我们熟悉的 OLS estimator。GMM 的强大之处在于轻松的计算 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+%CE%B2%29&quot; alt=&quot;\mbox{var}(\hat β)&quot; eeimg=&quot;1&quot;/&gt; 。为此，我们需要给 GMM 框架提供它所需要的  &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt;  和  &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt; （已经有了  &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt;  和  &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; ）。根据  &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt;  和  &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt;  的定义可得：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+d%26%3D%26-%5Cmbox%7BE%7D%5Bx_tx_t%5E%5Cprime%5D%5C%5C+f%28x_t%2C+%5Cbeta%29%26%3D%26x_t%5Cvarepsilon_t%5C%5C+S%26%3D%26%5Cdisplaystyle%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D%5Cmbox%7BE%7D%5B%5Cvarepsilon_tx_tx_%7Bt-j%7D%5E%5Cprime%5Cvarepsilon_%7Bt-j%7D%5D+%5Cend%7Barray%7D&quot; alt=&quot;\begin{array}{rll} d&amp;amp;=&amp;amp;-\mbox{E}[x_tx_t^\prime]\\ f(x_t, \beta)&amp;amp;=&amp;amp;x_t\varepsilon_t\\ S&amp;amp;=&amp;amp;\displaystyle\sum_{j=-\infty}^{\infty}\mbox{E}[\varepsilon_tx_tx_{t-j}^\prime\varepsilon_{t-j}] \end{array}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;有了 &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt; ，直接利用 GMM 中的公式就可以求出 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+%CE%B2%29&quot; alt=&quot;\mbox{var}(\hat β)&quot; eeimg=&quot;1&quot;/&gt; ：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+%5Cmbox%7Bvar%7D%28%5Chat%5Cbeta%29%3D%5Cfrac%7B1%7D%7BT%7D%5Cmbox%7BE%7D%5Bx_tx_t%5E%5Cprime%5D%5E%7B-1%7D%5Cleft%5B%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D%5Cmbox%7BE%7D%5B%5Cvarepsilon_tx_tx_%7Bt-j%7D%5E%5Cprime%5Cvarepsilon_%7Bt-j%7D%5D%5Cright%5D%5Cmbox%7BE%7D%5Bx_tx_t%5E%5Cprime%5D%5E%7B-1%7D&quot; alt=&quot;\displaystyle \mbox{var}(\hat\beta)=\frac{1}{T}\mbox{E}[x_tx_t^\prime]^{-1}\left[\sum_{j=-\infty}^{\infty}\mbox{E}[\varepsilon_tx_tx_{t-j}^\prime\varepsilon_{t-j}]\right]\mbox{E}[x_tx_t^\prime]^{-1}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;这正是广义 OLS 下 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+%CE%B2%29&quot; alt=&quot;\mbox{var}(\hat β)&quot; eeimg=&quot;1&quot;/&gt; 的表达式（请参考&lt;a href=&quot;https://zhuanlan.zhihu.com/p/54913149&quot; class=&quot;internal&quot;&gt;《多因子回归检验中的 Newey-West 调整》&lt;/a&gt;对比）。&lt;/p&gt;&lt;p&gt;We are done!&lt;/p&gt;&lt;p&gt;下面考察几种情况。首先如果残差满足 i.i.d.， &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+%CE%B2%29&quot; alt=&quot;\mbox{var}(\hat β)&quot; eeimg=&quot;1&quot;/&gt; 就可以简化成我们最熟悉的样子：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+%5Cmbox%7Bvar%7D%28%5Chat%5Cbeta%29%3D%5Cfrac%7B1%7D%7BT%7D%5Csigma_%7B%5Cvarepsilon%7D%5E2%5Cmbox%7BE%7D%5Bx_tx_t%5E%5Cprime%5D%5E%7B-1%7D%3D%5Csigma_%7B%5Cvarepsilon%7D%5E2%5Cleft%28X%5E%5Cprime+X%5Cright%29%5E%7B-1%7D&quot; alt=&quot;\displaystyle \mbox{var}(\hat\beta)=\frac{1}{T}\sigma_{\varepsilon}^2\mbox{E}[x_tx_t^\prime]^{-1}=\sigma_{\varepsilon}^2\left(X^\prime X\right)^{-1}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;通常来说，残差中可能存在异方差、自相关或者两者皆有。在 GMM 的框架下，为了计算 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+%CE%B2%29&quot; alt=&quot;\mbox{var}(\hat β)&quot; eeimg=&quot;1&quot;/&gt; 仅需要在  &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt;  矩阵中考虑异方差和自相关造成的影响。当残差仅存在异方差时， &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt;  的表达式为：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+S%3D%5Cmbox%7BE%7D%5B%5Cvarepsilon_t%5E2x_tx_t%27%5D&quot; alt=&quot;\displaystyle S=\mbox{E}[\varepsilon_t^2x_tx_t&amp;#39;]&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;因此 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+%CE%B2%29&quot; alt=&quot;\mbox{var}(\hat β)&quot; eeimg=&quot;1&quot;/&gt; 的表达式变成：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+%5Cmbox%7Bvar%7D%28%5Chat%5Cbeta%29%3D%5Cfrac%7B1%7D%7BT%7D%5Cmbox%7BE%7D%5Bx_tx_t%5E%5Cprime%5D%5E%7B-1%7D%5Cmbox%7BE%7D%5B%5Cvarepsilon_t%5E2x_tx_t%5E%5Cprime%5D%5Cmbox%7BE%7D%5Bx_tx_t%5E%5Cprime%5D%5E%7B-1%7D&quot; alt=&quot;\displaystyle \mbox{var}(\hat\beta)=\frac{1}{T}\mbox{E}[x_tx_t^\prime]^{-1}\mbox{E}[\varepsilon_t^2x_tx_t^\prime]\mbox{E}[x_tx_t^\prime]^{-1}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;这正是大名鼎鼎的 White (1980) heteroscedasticity consistent estimator。&lt;/p&gt;&lt;p&gt;当残差即存在异方差又存在自相关时， &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt; 可以写作：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+S%3D%5Csum_%7Bj%3D-k%7D%5Ek+w_j%5Cmbox%7BE%7D%5B%5Cvarepsilon_tx_tx_%7Bt-j%7D%27%5Cvarepsilon_%7Bt-j%7D%5D&quot; alt=&quot;\displaystyle S=\sum_{j=-k}^k w_j\mbox{E}[\varepsilon_tx_tx_{t-j}&amp;#39;\varepsilon_{t-j}]&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;而 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+%CE%B2%29&quot; alt=&quot;\mbox{var}(\hat β)&quot; eeimg=&quot;1&quot;/&gt; 的表达式变成：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+%5Cmbox%7Bvar%7D%28%5Chat%5Cbeta%29%3D%5Cfrac%7B1%7D%7BT%7D%5Cmbox%7BE%7D%5Bx_tx_t%5E%5Cprime%5D%5E%7B-1%7D%5Cleft%5B%5Csum_%7Bj%3D-k%7D%5Ek+w_j%5Cmbox%7BE%7D%5B%5Cvarepsilon_tx_tx_%7Bt-j%7D%27%5Cvarepsilon_%7Bt-j%7D%5D%5Cright%5D%5Cmbox%7BE%7D%5Bx_tx_t%5E%5Cprime%5D%5E%7B-1%7D&quot; alt=&quot;\displaystyle \mbox{var}(\hat\beta)=\frac{1}{T}\mbox{E}[x_tx_t^\prime]^{-1}\left[\sum_{j=-k}^k w_j\mbox{E}[\varepsilon_tx_tx_{t-j}&amp;#39;\varepsilon_{t-j}]\right]\mbox{E}[x_tx_t^\prime]^{-1}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;这正是大名鼎鼎的 Newey and West (1987) autocorrelation consistent covariance estimator（见&lt;a href=&quot;https://zhuanlan.zhihu.com/p/54913149&quot; class=&quot;internal&quot;&gt;《多因子回归检验中的 Newey-West 调整》&lt;/a&gt;）。&lt;/p&gt;&lt;p&gt;无论残差具有什么特性，整个 OLS 的求解过程都可以很好的装到 GMM 的框架中。而当使用 GMM 框架时，只需按照它的要求来定义  &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt;  以及  &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt; ，就可以“无脑”的利用 GMM 给出的结果。这正是 GMM 的强大之处。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;07 不应成为黑箱&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;在结束本文之前，再花一小节讨论一个很重要的问题：&lt;b&gt;GMM 不应该成为计量学黑箱。&lt;/b&gt;这是我听完 Cochrane 教授的讲解后印象非常深刻的一点。&lt;/p&gt;&lt;p&gt;GMM 如此强大再加上现在各种编程语言（R、Stata 等）都能方便的计算，这种便捷性似乎把人们都惯坏了；&lt;b&gt;人们习惯于把问题描述成 moment conditions 然后一股脑塞进 GMM 并纯从统计的角度使用 efficient estimator（即 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=W+%3D+S%5E%7B-1%7D&quot; alt=&quot;W = S^{-1}&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;）。&lt;/b&gt;Cochrane 教授警告说这么做十分危险。&lt;/p&gt;&lt;p&gt;&lt;b&gt;GMM 的强大之处在于它不仅仅是一个计量学工具来做 test，而是它足够 flexible 从而可以让我们研究我们真正关心的经济学或金融学问题，这体现在我们可以从“先验”出发去定义最适合待研究问题的矩阵 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;（或权重矩阵 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=W&quot; alt=&quot;W&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;），而非无脑的选择 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=W+%3D+S%5E%7B-1%7D&quot; alt=&quot;W = S^{-1}&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;以 3.2 节中 asset pricing 的例子来说，我们有四个 moments，两个参数。这四个 moments 来自四个资产：risk-free、市场组合以及 HML 和 SMB，我们假设待检验的模型是 CCAPM。从经济学业务出发，我们可以选择如下的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=ag_T%28%5Chat+b%29+%3D+0&quot; alt=&quot;ag_T(\hat b) = 0&quot; eeimg=&quot;1&quot;/&gt; ：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cleft%5B+%5Cbegin%7Barray%7D%7Bcccc%7D+1%260%260%260%5C%5C+0%261%260%260+%5Cend%7Barray%7D+%5Cright%5D+%5Cleft%5B+%5Cbegin%7Barray%7D%7Bl%7D+%5Cmbox%7BE%7D_T%5Bm%28%5Chat%5Cbeta%2C%5Chat%5Cgamma%29R%5Ee_m%5D%5C%5C+%5Cmbox%7BE%7D_T%5Bm%28%5Chat%5Cbeta%2C%5Chat%5Cgamma%29R_f-1%5D%5C%5C+%5Cmbox%7BE%7D_T%5Bm%28%5Chat%5Cbeta%2C%5Chat%5Cgamma%29R%5E%7B%5Cmbox%7BHML%7D%7D%5D%5C%5C+%5Cmbox%7BE%7D_T%5Bm%28%5Chat%5Cbeta%2C%5Chat%5Cgamma%29R%5E%7B%5Cmbox%7BSMB%7D%7D%5D+%5Cend%7Barray%7D+%5Cright%5D%3D+%5Cleft%5B+%5Cbegin%7Barray%7D%7Bc%7D+0%5C%5C0+%5Cend%7Barray%7D+%5Cright%5D&quot; alt=&quot;\left[ \begin{array}{cccc} 1&amp;amp;0&amp;amp;0&amp;amp;0\\ 0&amp;amp;1&amp;amp;0&amp;amp;0 \end{array} \right] \left[ \begin{array}{l} \mbox{E}_T[m(\hat\beta,\hat\gamma)R^e_m]\\ \mbox{E}_T[m(\hat\beta,\hat\gamma)R_f-1]\\ \mbox{E}_T[m(\hat\beta,\hat\gamma)R^{\mbox{HML}}]\\ \mbox{E}_T[m(\hat\beta,\hat\gamma)R^{\mbox{SMB}}] \end{array} \right]= \left[ \begin{array}{c} 0\\0 \end{array} \right]&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;在这个矩阵  &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt;  中，我们令市场超额收益和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=R_f+&quot; alt=&quot;R_f &quot; eeimg=&quot;1&quot;/&gt; 完美满足两个 sample moment conditions，并由此进行 CCAPM 的参数估计，求出两个参数，然后使用另外两个资产 HML 和 SMB 来检验 CCAPM。由 GMM 框架可知，最终的 chi-squared test statistic 的自由度为 2（因为一共 4 个资产，2 个被用来估计参数），因此联合检验的实际上正是 HML 和 SMB 在 CCAPM 这个定价模型下的 pricing errors。如果 pricing errors 联合显著不为零，那么就可以拒绝 CCAPM。这个例子说明，&lt;b&gt;从经济学原理出发选择合适的 a 或 W 能让我们回答最感兴趣的经济学问题。&lt;/b&gt;GMM 的强大之处正在于此。&lt;/p&gt;&lt;p&gt;纯从统计学的角度来说， &lt;img src=&quot;https://www.zhihu.com/equation?tex=W+%3D+S%5E%7B-1%7D&quot; alt=&quot;W = S^{-1}&quot; eeimg=&quot;1&quot;/&gt; 确实能够得到 efficient GMM。但不要忘记，这个 efficient 的是以给定的 moments 为前提的 —— 如果换了或者添加了更多的 moments，参数的 efficient 估计也会发生变化。在金融市场中，有无数的资产，包括股票、债券、外汇、商品等，还有无数的投资组合，这些资产可以构成无数的 moments。为了 efficiency，我们应该把这成千上万资产的 moments 都塞进 GMM 才能得到 efficient 的估计。但显然，从业务的角度来说这毫无意义。在研究资产定价的时候，我们应该使用最“clever”的资产，比如 HML、SMB 这些投资组合。它们才是我们真正关心的问题。&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;The quest for efficiency doesn&amp;#39;t really drive us as much as the quest for something that is robust and that expresses what the model is supposed to do. —— John Cochrane&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;b&gt;GMM 非常好使，但在 asset pricing 的研究中，我们不应追求使用 GMM 进行一个仅在统计上正式但模型却缺乏含义的 statistical test。GMM 的强大在于它让我们从经济学和金融学原理出发，去 measure 和 estimate 最合理的模型、并同时对 sampling error 保持足够的认识。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;不要让 GMM 成为计量学的黑箱。&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;08 结语&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;呼！终于写完了！感谢你看到这里！&lt;/p&gt;&lt;p&gt;作为感谢，上点硬货 —— GMM 的 formula sheet（出自 Cochrane 2005）。它总结了前文解读的每一个公式。网上能找到的 Asset Pricing 的电子版还是 2000 年 6 月的版本，有不少 Typo。这张截图是来自 2005 年的修订版。怎么样？&lt;b&gt;GMM 其实并不复杂，我们只需要提供并计算 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;，&lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;，&lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=d+&quot; alt=&quot;d &quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;和 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;；有了它们，GMM 框架 takes care of everything else！&lt;/b&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-3dae1f9979c74ebe0a02ae47a70661cc_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;993&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-3dae1f9979c74ebe0a02ae47a70661cc_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-3dae1f9979c74ebe0a02ae47a70661cc_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;993&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-3dae1f9979c74ebe0a02ae47a70661cc_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-3dae1f9979c74ebe0a02ae47a70661cc_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;最后对全文简要总结如下：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;b&gt;GMM 的框架下包括 model、estimate 以及 test 三部分；它用 sample moments 代替 population moments 来检验后者；GMM 涉及的数学（不那么严谨的说）可以归结为 the variance of the sample mean + delta method。&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;从 notation 的角度，我们只需找到 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;、&lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;、&lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt; 和 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;，剩下的交给 GMM 的公式；&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;GMM 允许我们自由挑选矩阵 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;（或 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=W&quot; alt=&quot;W&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;）；从统计学的角度存在一个特定的 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;（或 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=W&quot; alt=&quot;W&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;）是最 efficient 的；但 GMM 不应被当作计量学的黑箱，理解你所研究的问题永远是最重要的。&lt;/b&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;写完本文，我的感受和写完&lt;a href=&quot;https://zhuanlan.zhihu.com/p/40984029&quot; class=&quot;internal&quot;&gt;《股票多因子模型的回归检验》&lt;/a&gt;是一模一样的，对 Cochrane 教授崇拜的五体投地。关于 GMM 的内容，Cochrane 教授在其 UChicago 的课程中介绍的非常生动、到位，听完再结合他的书仔细体会，那收获就一个字 —— 爽！&lt;/p&gt;&lt;p&gt;最后，我想用和&lt;a href=&quot;https://zhuanlan.zhihu.com/p/40984029&quot; class=&quot;internal&quot;&gt;《股票多因子模型的回归检验》&lt;/a&gt;一文同样的结语作为本文的收尾。在介绍 Asset Pricing 这门课的时候，Cochrane 教授谈到：&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;The math in real, academic, finance is not actually that hard. Understanding how to use the equations, and see what they really mean about the world... that&amp;#39;s hard, and that&amp;#39;s what I hope will be uniquely rewarding about this class.&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;再一次的，我也真心希望本文在你理解 GMM 以及应用它研究 asset pricing 的道路上起到一点点帮助。&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;参考文献&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Cochrane, J. H (2005). &lt;i&gt;Asset Pricing (revised edition)&lt;/i&gt;. Princeton University Press.&lt;/li&gt;&lt;li&gt;Fama, E. F. and K. R. French (1993). Common Risk Factors in the Returns on Stocks and Bonds. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 33(1), 3 – 56.&lt;/li&gt;&lt;li&gt;Hansen, L. P. (1982). Large sample properties of generalized method of moments estimators. &lt;i&gt;Econometrica&lt;/i&gt;, Vol. 50(4), 1029 – 1054.&lt;/li&gt;&lt;li&gt;Newey, W. K. and K. D. West (1987). A simple, positive semi-definite, heteroskedasticity and autocorrelation consistent covariance matrix. &lt;i&gt;Econometrica&lt;/i&gt;, Vol. 55(3), 703 – 708.&lt;/li&gt;&lt;li&gt;White, H. (1980). A heteroskedasticity-consistent covariance matrix estimator and a direct test for heteroskedasticity. &lt;i&gt;Econometrica&lt;/i&gt;, Vol. 48(4), 817 – 838.&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;免责声明：&lt;/b&gt;文章内容不可视为投资意见。市场有风险，入市需谨慎。&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处。已委托“维权骑士”(&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//rightknights.com/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;维权骑士_免费版权监测/版权保护/内容多平台分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2019-11-21-92490417</guid>
<pubDate>Thu, 21 Nov 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>Wikipedia of Trend Following (II)</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2019-11-09-91028298.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/91028298&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-f4268ba0b0326e704f9f7ed1ce25cfb0_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;00 引言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;近日，《贫穷的本质》这本书突然火了。它的英文原作是 Poor Economics，出版于 2011 年，并于当年就斩获了 Financial Times and Goldman Sachs Business Book of the Year Award。中文版《贫穷的本质》早在 2013 年 4 月就由中信出版集团带到了国内。然而它却突然在 2019 年 10 月的某一天火了。究其原因，是因为其作者 —— 来自 MIT 的 Abhijit Banerjee 以及 Esther Duflo 教授 —— 连同 Harvard 的 Michael Kremer 教授分享了 2019 年诺贝尔经济学奖。从该书的作者获奖到该书在国内迅速走红毫无疑问是一个 trend following（趋势追踪）的鲜活实例，而这样的例子每时每刻都发生在我们身边。&lt;/p&gt;&lt;p&gt;在金融市场，trend following 更是最具生命力的一种交易策略。之前，我的好友刀疤连就于趋势追踪写了一篇两万字雄文（&lt;a href=&quot;https://zhuanlan.zhihu.com/p/81421085&quot; class=&quot;internal&quot;&gt;链接在此&lt;/a&gt;，因为该文涉及的内容的广泛性，我称其为 Wikipedia of Trend Following），该文系统阐述了趋势追踪策略的是与非。考虑到我自己之前也写过多篇关于趋势追踪的文章，因此今天也来就这个话题系统梳理一下；我将本文命名为 Wikipedia of Trend Following (II)。本文的正文部分共包含七小节：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;第一节：&lt;/b&gt;时序与截面&lt;/li&gt;&lt;li&gt;&lt;b&gt;第二节：&lt;/b&gt;确定计算趋势的时间尺度&lt;/li&gt;&lt;li&gt;&lt;b&gt;第三节：&lt;/b&gt;哪个趋势指标更好使？&lt;/li&gt;&lt;li&gt;&lt;b&gt;第四节：&lt;/b&gt;移动平均的本质&lt;/li&gt;&lt;li&gt;&lt;b&gt;第五节：&lt;/b&gt;对趋势追踪的正确预期&lt;/li&gt;&lt;li&gt;&lt;b&gt;第六节：&lt;/b&gt;从风险角度看趋势策略&lt;/li&gt;&lt;li&gt;&lt;b&gt;第七节：&lt;/b&gt;结语&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;下面就让我们开启趋势之旅。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;01 时序与截面&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;Trend Following 策略指的是投资者根据资产的上涨或者下跌趋势做出相应的多、空交易。&lt;/b&gt;具体来说，趋势追踪又可以分为时序动量（time-series momentum）和截面动量（cross-sectional momentum）两类。&lt;/p&gt;&lt;p&gt;在时序动量中，投资者做多之前上涨趋势显著的资产、做空之前下跌趋势显著的资产；而在截面动量中，投资者做多在截面上收益率&lt;b&gt;相对&lt;/b&gt;较高的资产、做空在截面上收益率&lt;b&gt;相对&lt;/b&gt;较低的资产。在时序动量中，我们希望资产可以各自延续其在之前的趋势。而在截面动量中，相比于每个资产绝对走势，我们更关注的是它们相对的强弱走势，希望强者恒强、弱者恒弱，因此截面动量又称为 winners-minus-losers 策略。&lt;/p&gt;&lt;p&gt;以下从资产相关性的角度比较一下时序和截面动量的差异。&lt;/p&gt;&lt;p&gt;多样化（diversification）是规避投资风险的重要思想，其体现是将资金分配到不同的资产中。对于时序动量策略来说，要想获得多样化收益（diversification gain），就必须考虑相关性低的资产。Roncalli (2017) 指出，当资产之间的相关性很高时，时序动量策略的表现不会因为资产个数的增加而显著提升。下图为假设资产相关系数为 80% 的情况下，资产个数和时序动量策略年化收益率的累积分布函数的关系。由于资产之间的相关性很高，当资产个数超过 3 时，多样化带来的额外收益就几乎不发生改变了。&lt;b&gt;时序动量喜欢相关性低的资产。&lt;/b&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-35f486968368faaa220f758fc3e3e2b9_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;937&quot; data-rawheight=&quot;419&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;937&quot; data-original=&quot;https://pic2.zhimg.com/v2-35f486968368faaa220f758fc3e3e2b9_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-35f486968368faaa220f758fc3e3e2b9_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;937&quot; data-rawheight=&quot;419&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;937&quot; data-original=&quot;https://pic2.zhimg.com/v2-35f486968368faaa220f758fc3e3e2b9_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-35f486968368faaa220f758fc3e3e2b9_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;与时序动量不同，&lt;b&gt;截面动量策略喜欢相关性高的资产。&lt;/b&gt;同样是来自 Roncalli (2017) 的研究表明，截面动量策略的夏普率随着资产相关性的增加而提高（下图）。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-49e39b60028a698839eaf509285af590_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;942&quot; data-rawheight=&quot;416&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;942&quot; data-original=&quot;https://pic1.zhimg.com/v2-49e39b60028a698839eaf509285af590_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-49e39b60028a698839eaf509285af590_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;942&quot; data-rawheight=&quot;416&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;942&quot; data-original=&quot;https://pic1.zhimg.com/v2-49e39b60028a698839eaf509285af590_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-49e39b60028a698839eaf509285af590_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;一般当人们提到 trend following 的时候，指的往往是时序动量策略，即多、空交易信号根据资产自己上涨或下跌的趋势而构建。&lt;/b&gt;本文接下来的讨论也将围绕时序动量展开。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;02 确定计算趋势的时间尺度&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;想要通过 trend following 策略赚钱，最重要的一点是什么？很多文献告诉我们，趋势追踪中的重中之重包括 trend measure（即选择最优的指标来计算趋势）以及 position sizing（仓位管理）。毫无疑问，这两点对于趋势策略至关重要，但在我看来，&lt;b&gt;更重要的要数选择计算趋势的时间尺度。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;举个例子，Winton Capital（元盛 —— 每当提及趋势追踪时，我脑海中想到的第一个名字）在 2013 年的一篇 research note（Winton 2013）中以下列来自四大类的 20 个资产进行了趋势策略时间尺度的研究。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-89e10ea3a32618611c4b72f6f36978bf_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;722&quot; data-rawheight=&quot;268&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;722&quot; data-original=&quot;https://pic4.zhimg.com/v2-89e10ea3a32618611c4b72f6f36978bf_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-89e10ea3a32618611c4b72f6f36978bf_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;722&quot; data-rawheight=&quot;268&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;722&quot; data-original=&quot;https://pic4.zhimg.com/v2-89e10ea3a32618611c4b72f6f36978bf_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-89e10ea3a32618611c4b72f6f36978bf_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;Winton (2013) 依据趋势追踪策略换手率的高低定义了 fast、medium 以及 slow 三个级别的策略（换手率越高意味着时间尺度越短），并交易上述 20 种资产。风险调整后，这三个级别策略的表现如下图所示。从中不难看出，fast 级别（换手率高）自 2004 年开始就基本失效了，而 medium 和 slow 级别策略在 2004 年之后依然有效；自 2012 年之后，medium 级别策略较其之前的表现也有所减弱，而 slow 级别的表现相对稳健，虽然其绝对收益不如 fast 和 medium 级别。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-defb5906854303986f2ea128876c3337_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;727&quot; data-rawheight=&quot;390&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;727&quot; data-original=&quot;https://pic4.zhimg.com/v2-defb5906854303986f2ea128876c3337_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-defb5906854303986f2ea128876c3337_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;727&quot; data-rawheight=&quot;390&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;727&quot; data-original=&quot;https://pic4.zhimg.com/v2-defb5906854303986f2ea128876c3337_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-defb5906854303986f2ea128876c3337_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;再来看两个离我们更近的例子。下图中，我用&lt;b&gt;同样的参数&lt;/b&gt;分别以上证指数和标普 500 指数为资产，构建了仅做多的趋势追踪策略。结果显示，适合上证指数的趋势参数在标普 500 指数上完全不好使。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-963fc8114660dd1e755c987c4ca85fae_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;731&quot; data-rawheight=&quot;553&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;731&quot; data-original=&quot;https://pic3.zhimg.com/v2-963fc8114660dd1e755c987c4ca85fae_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-963fc8114660dd1e755c987c4ca85fae_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;731&quot; data-rawheight=&quot;553&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;731&quot; data-original=&quot;https://pic3.zhimg.com/v2-963fc8114660dd1e755c987c4ca85fae_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-963fc8114660dd1e755c987c4ca85fae_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;上面的强烈对比说明：&lt;b&gt;趋势策略好使的前提是计算趋势的时间尺度和资产的收益率特征匹配。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;前文&lt;a href=&quot;https://zhuanlan.zhihu.com/p/40358079&quot; class=&quot;internal&quot;&gt;《什么样的收益率特性适合趋势追踪策略》&lt;/a&gt;使用如下的数学模型对上述观点进行了详细的论述，这里简单回顾下。考虑到资产收益率序列通常包含低频均值、非常微弱的自相关性以及白噪声三个部分构成，利用如下步骤人工合成对数收益率：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brrll%7D+%5Cmbox%7BStep+1%3A%7D%26b_0%26%5Csim%26%5Cmathcal%7BN%7D%280%2C+%5Csigma%29%5C%5C+%5Cmbox%7BStep+2%3A%7D%26e_t%26%5Csim%26%5Cmathcal%7BN%7D%280%2C+%5Csigma%29%5C%5C+%5Cmbox%7BStep+3%3A%7D%26b_t%26%3D%26%5Crho%5Ctimes+b_%7Bt-1%7D%2Be_t%2C~~t%3D1%2C2%2C%5Ccdots%5C%5C+%5Cmbox%7BStep+4%3A%7D%26r_t%26%3D%26b_t-%5Cmu_b%2B%5Cmu%2C~~+t%3D0%2C1%2C2%2C%5Ccdots+%5Cend%7Barray%7D&quot; alt=&quot;\begin{array}{rrll} \mbox{Step 1:}&amp;amp;b_0&amp;amp;\sim&amp;amp;\mathcal{N}(0, \sigma)\\ \mbox{Step 2:}&amp;amp;e_t&amp;amp;\sim&amp;amp;\mathcal{N}(0, \sigma)\\ \mbox{Step 3:}&amp;amp;b_t&amp;amp;=&amp;amp;\rho\times b_{t-1}+e_t,~~t=1,2,\cdots\\ \mbox{Step 4:}&amp;amp;r_t&amp;amp;=&amp;amp;b_t-\mu_b+\mu,~~ t=0,1,2,\cdots \end{array}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;上述过程中， &lt;img src=&quot;https://www.zhihu.com/equation?tex=e_t&quot; alt=&quot;e_t&quot; eeimg=&quot;1&quot;/&gt; 是白噪声序列，它满足均值为 0，标准差为  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%83&quot; alt=&quot;σ&quot; eeimg=&quot;1&quot;/&gt;  的正态分布。 &lt;img src=&quot;https://www.zhihu.com/equation?tex=r_t&quot; alt=&quot;r_t&quot; eeimg=&quot;1&quot;/&gt; 是人工对数收益率序列。为了使它满足给定的长期均值  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%BC&quot; alt=&quot;μ&quot; eeimg=&quot;1&quot;/&gt;  和自相关性 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%81&quot; alt=&quot;ρ&quot; eeimg=&quot;1&quot;/&gt; ，构造过程中使用了辅助序列  &lt;img src=&quot;https://www.zhihu.com/equation?tex=b_t&quot; alt=&quot;b_t&quot; eeimg=&quot;1&quot;/&gt; 。首先利用迭代构造出满足自相关性  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%81&quot; alt=&quot;ρ&quot; eeimg=&quot;1&quot;/&gt;  的序列  &lt;img src=&quot;https://www.zhihu.com/equation?tex=b_t&quot; alt=&quot;b_t&quot; eeimg=&quot;1&quot;/&gt; 。由于在构造 &lt;img src=&quot;https://www.zhihu.com/equation?tex=b_t&quot; alt=&quot;b_t&quot; eeimg=&quot;1&quot;/&gt; 时可能会引入非零样本均值 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%BC_b&quot; alt=&quot;μ_b&quot; eeimg=&quot;1&quot;/&gt; ，因此在利用 &lt;img src=&quot;https://www.zhihu.com/equation?tex=b_t&quot; alt=&quot;b_t&quot; eeimg=&quot;1&quot;/&gt; 构造 &lt;img src=&quot;https://www.zhihu.com/equation?tex=r_t&quot; alt=&quot;r_t&quot; eeimg=&quot;1&quot;/&gt; 时，将 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%BC_b&quot; alt=&quot;μ_b&quot; eeimg=&quot;1&quot;/&gt; 去除并把给定的均值 μ &lt;img src=&quot;https://www.zhihu.com/equation?tex=b_t&quot; alt=&quot;b_t&quot; eeimg=&quot;1&quot;/&gt; 加回来。这样最终生成的对数收益率序列 &lt;img src=&quot;https://www.zhihu.com/equation?tex=r_t&quot; alt=&quot;r_t&quot; eeimg=&quot;1&quot;/&gt; 同时满足的低频均值 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%BC&quot; alt=&quot;μ&quot; eeimg=&quot;1&quot;/&gt; 和自相关性  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%81&quot; alt=&quot;ρ&quot; eeimg=&quot;1&quot;/&gt; 。&lt;/p&gt;&lt;p&gt;利用这个数学模型，以  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%BC&quot; alt=&quot;μ&quot; eeimg=&quot;1&quot;/&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%81&quot; alt=&quot;ρ&quot; eeimg=&quot;1&quot;/&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%83&quot; alt=&quot;σ&quot; eeimg=&quot;1&quot;/&gt;  作为输入，&lt;a href=&quot;https://zhuanlan.zhihu.com/p/40358079&quot; class=&quot;internal&quot;&gt;《什么样的收益率特性适合趋势追踪策略》&lt;/a&gt;一文进行了大量的仿真分析，研究了趋势策略的效果与参数组  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%BC&quot; alt=&quot;μ&quot; eeimg=&quot;1&quot;/&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%81&quot; alt=&quot;ρ&quot; eeimg=&quot;1&quot;/&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%83&quot; alt=&quot;σ&quot; eeimg=&quot;1&quot;/&gt;  的关系并得到如下结论：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;b&gt;长期均值 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%BC&quot; alt=&quot;μ&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 主宰自相关性 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%81&quot; alt=&quot;ρ&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; —— 比起缥缈的自相关性，低频分量 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%BC&quot; alt=&quot;μ&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt; 才是真正的趋势（想想股市的大牛市）；&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;收益率均值 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%BC&quot; alt=&quot;μ&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt; 和收益率标准差 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%83&quot; alt=&quot;σ&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt; 的数量级之差影响趋势效果 —— 这意味着合理选择计算趋势的时间尺度至关重要。&lt;/b&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;通常来说，对于日频数据，收益率标准差比均值高两个数量级，在这个级别上趋势策略难有作为。如果把时间拉长，在更低的频率（即更长的时间尺度）上计算收益率，可以有效提高均值并降低其标准差，当均值和标准差相差一个数量级时，趋势策略或大有可为。这就是为什么同一组趋势参数在 A 股好使（A 股大牛市的时候日收益率均值太高）却在美股上不好使（例如，在过去 3000 个交易日中，SPX 的日频收益率标准差是其均值的近 40 倍，而其月频收益率的标准差仅是其均值的 7 倍）。&lt;/p&gt;&lt;p&gt;以上就是关于时间尺度的讨论。一旦确定了计算趋势的时间尺度，下一步就是选择合适的指标了，比如是使用价格均线还是收益率均值来衡量趋势强弱？是使用简单的移动平均还是对近期数据权重更高的指数平均？这都属于 trend measure 要回答的问题。而关于构建趋势策略的另一方面 position sizing，刀疤连在&lt;a href=&quot;https://zhuanlan.zhihu.com/p/81421085&quot; class=&quot;internal&quot;&gt;之前的文章&lt;/a&gt;中有过详细说明，本文不再赘述。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;03 哪个趋势指标更好使 ？&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;关于不同 trend measures 的比较，Levine and Pedersen (2016) 有过精彩的讨论，&lt;a href=&quot;https://zhuanlan.zhihu.com/p/50483693&quot; class=&quot;internal&quot;&gt;《有没有哪个趋势指标更好使？&lt;/a&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzIyMDEwNDk1Mg%3D%3D%26mid%3D2650878543%26idx%3D1%26sn%3D336f00e5703605956fbe799cee5efbfb%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;》&lt;/a&gt;一文也做过解读。结论是 —— 先泼盆冷水吧 —— 并没有哪种 measure 吊打其他的。&lt;/p&gt;&lt;p&gt;在技术层面，各种捕捉趋势的方法也是层出不穷：基于收益率的时序动量、来自技术分析的均线交叉或通道突破、各种 state space 模型比如 Kalman 滤波、基于价格的线性回归、甚至是频域分析。当某种方法的回测结果不是那么给力的时候，人们的第一反应总是寻找下一个更复杂的方法。然而究其核心，上述方法都是基于价格或者收益率的时间序列计算出来的。&lt;b&gt;Levine and Pedersen (2016) 通过使用 trend signature plots（趋势签名图）这个概念比较了不同的 trend measures 方法，认为不同的方法并没有本质区别。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;以时序收益率均值，技术分析中的长、短均线交叉，Kalman 滤波，以及价格对时间的时序回归这些常见的 trend measures 为例，它们的 trend signature plots 如下图所示。在给定的计算趋势的时间尺度下，这些方法的 trend signature plots 显然没有它们的名字听上去差异那么大。&lt;b&gt;它们虽然形态有些差异，但其本质仍然都是收益率的某种加权平均。&lt;/b&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-bba29386be8d4a02b6dcaf3651f156a6_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;599&quot; data-rawheight=&quot;757&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;599&quot; data-original=&quot;https://pic3.zhimg.com/v2-bba29386be8d4a02b6dcaf3651f156a6_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-bba29386be8d4a02b6dcaf3651f156a6_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;599&quot; data-rawheight=&quot;757&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;599&quot; data-original=&quot;https://pic3.zhimg.com/v2-bba29386be8d4a02b6dcaf3651f156a6_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-bba29386be8d4a02b6dcaf3651f156a6_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;除了从数学上证明不同 trend measures 并无实质差异外，Levine and Pedersen (2016) 也通过一个实例进行了说明。它们采用 Moskowitz, Ooi, and Pedersen (2012) 一文中的 58 种资产为交易对象，在不同时间尺度上分别使用两种不同的 trend measures 来构建策略、考察趋势策略的效果。得到的结论和本小节以及上一节完全一致：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;b&gt;计算趋势的时间尺度至关重要；&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;在给定的时间尺度下，具体使用哪种 trend measure 差异并不大。&lt;/b&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;既然不同 trend measures 的差异很小，接下来我们就以最简单的移动平均为例来探究一下趋势信号背后的本质。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;04 移动平均的本质&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;在人们的认知中，趋势追踪是一个右侧交易策略，它使用某个 trend measure 来描述过去一段时间上涨或下跌趋势的强弱，并假设该趋势会持续。而无论采取何种 trend measure，我们都无法提前预判趋势何时会结束，因此趋势策略往往在趋势发生逆转时录得较大的亏损，这也正是趋势策略的风险收益特征。在良好的风控下，这并不是太大的缺点，本文的第六节将从风险的角度进一步讨论这一点。&lt;/p&gt;&lt;p&gt;在本小节，我们试图回答的问题是，趋势策略为什么注定是一个右侧交易策略，为什么无法预知趋势什么时候会结束，意味着&lt;b&gt;趋势信号有明显的滞后性&lt;/b&gt;。这就要从趋势信号（以移动平均为例）的本质说起。&lt;/p&gt;&lt;p&gt;&lt;b&gt;从数学上说，移动平均的本质是一种低通滤波。它的目的是过滤掉时间序列中的高频扰动，保留有用的低频趋势。&lt;/b&gt;如何从时间序列中抽取出真正的低频趋势呢？下面将从数学上解释移动平均的本质，并揭示趋势信号滞后性的成因。&lt;/p&gt;&lt;p&gt;假设我们有一个时间序列 &lt;img src=&quot;https://www.zhihu.com/equation?tex=y+%3D+%5C%7B%E2%80%A6%2C+y_%7Bt-2%7D%2C+y_%7Bt-1%7D%2C+y_t%2C+y_%7Bt%2B1%7D%2C+y_%7Bt%2B2%7D%2C+%E2%80%A6%5C%7D&quot; alt=&quot;y = \{…, y_{t-2}, y_{t-1}, y_t, y_{t+1}, y_{t+2}, …\}&quot; eeimg=&quot;1&quot;/&gt; ，如下图所示。另外，假设我们有一个作用在时域 t 上的过滤函数 F（F 的具体形式由选择的移动平均算法决定）。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-619498171ee8d57fc4442eaa7bfd891e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;272&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-619498171ee8d57fc4442eaa7bfd891e_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-619498171ee8d57fc4442eaa7bfd891e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;272&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-619498171ee8d57fc4442eaa7bfd891e_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-619498171ee8d57fc4442eaa7bfd891e_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;在理论上，在任意 t 时刻的低频滤波（用 &lt;img src=&quot;https://www.zhihu.com/equation?tex=x_t&quot; alt=&quot;x_t&quot; eeimg=&quot;1&quot;/&gt; 表示）在数学上可以表示为该时间序列 y 和过滤函数 F 在整个时域上的卷积，即&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+x_t%3D%5Csum_%7Bi%3D-%5Cinfty%7D%5E%7B%5Cinfty%7DF_iy_%7Bt-i%7D&quot; alt=&quot;\displaystyle x_t=\sum_{i=-\infty}^{\infty}F_iy_{t-i}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;其中， &lt;img src=&quot;https://www.zhihu.com/equation?tex=F_i&quot; alt=&quot;F_i&quot; eeimg=&quot;1&quot;/&gt; 为过滤函数 F 在时刻 i 的取值（可以理解为 &lt;img src=&quot;https://www.zhihu.com/equation?tex=y_%7Bt-1%7D&quot; alt=&quot;y_{t-1}&quot; eeimg=&quot;1&quot;/&gt; 的权重；比如简单平均就是等权）。在实际中通常使用长度为 T 的窗口来代替上面这个无穷级数，这意味着过滤函数 F 只在窗口长度 T 内有效、在窗口之外为 0，如下图所示：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-3e64ae392341f8c1558d45724c7c3b18_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;294&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-3e64ae392341f8c1558d45724c7c3b18_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-3e64ae392341f8c1558d45724c7c3b18_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;294&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-3e64ae392341f8c1558d45724c7c3b18_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-3e64ae392341f8c1558d45724c7c3b18_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;加入长度为 T 的窗函数后，在时刻t的低频滤波变为该时间序列 y 和过滤函数 F 在这个窗口内的卷积：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+x_t%3D%5Csum_%7Bi%3Dt-%28T-1%29%2F2%7D%5E%7Bt%2B%28T-1%29%2F2%7DF_iy_%7Bt-i%7D&quot; alt=&quot;\displaystyle x_t=\sum_{i=t-(T-1)/2}^{t+(T-1)/2}F_iy_{t-i}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;&lt;b&gt;上述公式最大的问题是：在计算 t 时刻的低频分量时，利用到了未来的数据。换句话说，理论上的低通滤波（或者移动平滑）必须要用事后数据，其假设所有数据都发生后再在全局上计算所有时点的低频分量。&lt;/b&gt;但这在实时数据中是不可能的，因为在任何当前时刻 t，我们都没有未来数据可以利用。由于现实中无法使用 t-(T-1)/2 到 t+(T-1)/2 之间的数据，只能退而求其次将整个窗口在时间轴上向左平移 (T-1)/2 个单位、使用 t-(T-1) 到 t 之间的数据来计算 &lt;img src=&quot;https://www.zhihu.com/equation?tex=x_t&quot; alt=&quot;x_t&quot; eeimg=&quot;1&quot;/&gt; ，如下图所示：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-ddb99a4cd3447b2e7fd99e40a2aaf48f_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1027&quot; data-rawheight=&quot;318&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1027&quot; data-original=&quot;https://pic4.zhimg.com/v2-ddb99a4cd3447b2e7fd99e40a2aaf48f_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-ddb99a4cd3447b2e7fd99e40a2aaf48f_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1027&quot; data-rawheight=&quot;318&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1027&quot; data-original=&quot;https://pic4.zhimg.com/v2-ddb99a4cd3447b2e7fd99e40a2aaf48f_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-ddb99a4cd3447b2e7fd99e40a2aaf48f_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;如此处理后，对于实时数据，在当前时刻 t 的低频滤波变为该时间序列 y 和过滤函数 F 在 t-T+1 到 t 之间的卷积：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+x_t%3D%5Csum_%7Bi%3Dt-T%2B1%7D%5E%7Bt%7DF_iy_%7Bt-i%7D&quot; alt=&quot;\displaystyle x_t=\sum_{i=t-T+1}^{t}F_iy_{t-i}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;以 simple moving average 为例，在窗口 T 内，过滤函数在每个时点的取值都是 1/T（等权）。利用上述公式计算得到的实际上是 t-(T-1)/2 时刻、而非 t 时刻的低频趋势，而我们却只能把它当作 t 时刻的低频趋势使用，如此就产生了 (T-1)/2 的滞后。&lt;/p&gt;&lt;p&gt;&lt;b&gt;没有未来数据便是趋势信号滞后的根本原因。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;从上述公式可知，计算均线的时间窗口 T 越大，滞后 (T-1)/2 也就越多（比如我们看股票数据里面 MA20、MA30、MA50 等日均线，随着均线窗口 T 增大，得到的移动平滑曲线也越滞后）。正是由于滞后性和计算均线计算均线窗口的关系，人们本能上更加抵触使用长时间窗口来计算趋势。同时，人们也更加偏好使用指数加权或其他复杂的加权方法，以期更快捕捉趋势变化的原因（业界为此开发出了很多不同的移动平均算法，见&lt;a href=&quot;https://zhuanlan.zhihu.com/p/38276041&quot; class=&quot;internal&quot;&gt;《移动平均：你知道的与你不知道的》&lt;/a&gt;），但没有未来数据造成的滞后性使得趋势追踪注定成为右侧交易策略。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;05 对趋势追踪表现的正确预期&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;要想成功的使用趋势追踪策略，除了对其各个方面有深入的理解外，还要对它的表现有合理的预期，这就是本小节的话题。&lt;/p&gt;&lt;p&gt;在关于趋势策略（时序动量）的研究中，最重要的一篇文章当属 Moskowitz, Ooi, and Pedersen (2012) 这篇发表于顶刊 Journal of Financial Economics 的题为 Time series momentum 的文章。下图正来自这篇文章。它展示了对不同大类的资产使用 12-month trend measure 进行趋势追踪策略的年化夏普率。虽然趋势追踪策略在所有资产均获得正的夏普率，但大部分年化夏普率都在 0.4 以下。以当前市场上资金的主流（yet 非理性）看法来看，这样的表现毫无吸引力，&lt;b&gt;但这个范畴内的夏普率恰恰就是趋势策略在单一资产上的代表性表现。&lt;/b&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-c79f129f2edf2cd9304baf53166a4dcd_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;994&quot; data-rawheight=&quot;542&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;994&quot; data-original=&quot;https://pic2.zhimg.com/v2-c79f129f2edf2cd9304baf53166a4dcd_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-c79f129f2edf2cd9304baf53166a4dcd_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;994&quot; data-rawheight=&quot;542&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;994&quot; data-original=&quot;https://pic2.zhimg.com/v2-c79f129f2edf2cd9304baf53166a4dcd_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-c79f129f2edf2cd9304baf53166a4dcd_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;虽然趋势追踪在单一策略上提高空间有限，但好处是不同类资产的相关性较低，因此我们可以把它们的趋势策略放在一起，既实现了分散化，又能提升风险收益特征。这便给了人们无限的想象空间。下面我们就来模拟一下。&lt;/p&gt;&lt;p&gt;在模拟中，我使用了元盛开发的 &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//tools.winton.com/thefuture/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;The Future 工具&lt;/a&gt;，它以单一策略的夏普率、相关性等参数作为输入，非常方便的可视化出这些单一策略组合在一起之后的效果。假设我们有 20 个单一趋势追踪策略，每个策略的夏普率为 0.4，策略之间的相关性为 0.1，则可以得到以下的仿真结果：portfolio 的夏普率提升到了 1.16，显著高于单一策略的 0.4。当然，这仅仅是一次仿真；复合策略夏普率的分布可以通过数学推导、在合理的假设下得到，或通过更多的仿真得到。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-9bd7970a6b486c399a67d82812dda64e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;504&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-9bd7970a6b486c399a67d82812dda64e_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-9bd7970a6b486c399a67d82812dda64e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;504&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-9bd7970a6b486c399a67d82812dda64e_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-9bd7970a6b486c399a67d82812dda64e_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;上面这个小实验表明众多品种的趋势策略放在一起后的综合效果确实能够显著提升风险收益特征。&lt;b&gt;然而我们也必须认识到，多品种的趋势追踪策略仍然可能在短到中期（1 - 3 年）的范围内持续亏损。&lt;/b&gt;下图是大名鼎鼎的 Barclay CTA Index（考虑到趋势追踪占 CTA 中很高的比重，因此以该 Index 的表现代表趋势策略在历史上的表现），它在 2011 年 7 月之后的表现就有些惨不忍睹，从 2015 年开始几乎在持续的回撤。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-af8198fa05cd39921fc4a584bbfd0d8c_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;715&quot; data-rawheight=&quot;468&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;715&quot; data-original=&quot;https://pic1.zhimg.com/v2-af8198fa05cd39921fc4a584bbfd0d8c_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-af8198fa05cd39921fc4a584bbfd0d8c_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;715&quot; data-rawheight=&quot;468&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;715&quot; data-original=&quot;https://pic1.zhimg.com/v2-af8198fa05cd39921fc4a584bbfd0d8c_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-af8198fa05cd39921fc4a584bbfd0d8c_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;趋势追踪策略并不是圣杯；根据市场所处的状态，它有好使的时候，更有持续亏损的时候。长期来看，趋势追踪策略可以获得很好的收益、值得配置；&lt;b&gt;但真正能配置以及驾驭它的人，一定是对短到中期内它的表现能有多差有非常清醒的认知。&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;06 从风险的角度看趋势策略&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;最后来从风险的角度看趋势追踪。&lt;/p&gt;&lt;p&gt;对于大部分常见的资产或者投资策略，它们的收益分布都有如下的形状 —— 均值为正，但是左侧存在着极端事件造成的巨大亏损，从而造成分布的负偏。这个分布通常被称为 Taleb Distribution，以 Nassim Nicholas Taleb 命名；他以《黑天鹅》一书闻名于世（黑天鹅代表了左侧的极端事件）。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-37044c90db5bb2d28f841f7248a49be9_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;572&quot; data-rawheight=&quot;322&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;572&quot; data-original=&quot;https://pic2.zhimg.com/v2-37044c90db5bb2d28f841f7248a49be9_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-37044c90db5bb2d28f841f7248a49be9_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;572&quot; data-rawheight=&quot;322&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;572&quot; data-original=&quot;https://pic2.zhimg.com/v2-37044c90db5bb2d28f841f7248a49be9_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-37044c90db5bb2d28f841f7248a49be9_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;而趋势追踪策略的收益分布（假设合理使用杠杆和进行风控）却和上面不同，趋势策略的收益率分布往往是 positive skewed 的。从趋势策略的 PnL 曲线来看，它在更多的时候是连续经历小幅回撤，然后换来一大波（大趋势）的上涨，从而将之前的众多小幅回撤抹平，使得该策略的长期收益为正。这个“亏损有限、收益无限”的特征造就了趋势策略收益分布的正偏。这个分布又被称作圣杯分布（Holy Grail distribution）。趋势追踪策略虽然不是圣杯，但它的收益分布满足圣杯分布。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-61ebead93d98b4c4a2686f2cbc943a08_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;562&quot; data-rawheight=&quot;350&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;562&quot; data-original=&quot;https://pic1.zhimg.com/v2-61ebead93d98b4c4a2686f2cbc943a08_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-61ebead93d98b4c4a2686f2cbc943a08_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;562&quot; data-rawheight=&quot;350&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;562&quot; data-original=&quot;https://pic1.zhimg.com/v2-61ebead93d98b4c4a2686f2cbc943a08_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-61ebead93d98b4c4a2686f2cbc943a08_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;正是因为这种独特的特性，使得趋势策略能在其他资产发生左侧尾部风险的时候脱颖而出，这也就是它为什么享有 crisis alpha 的美名。关于 crisis alpha 的特性，&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzIyMDEwNDk1Mg%3D%3D%26mid%3D2650879433%26idx%3D1%26sn%3D423052122849a8115f34ff3122ad3d9c%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;刀疤连的文章&lt;/a&gt;中有过详细的描述并针对国内市场进行了实证研究。&lt;/p&gt;&lt;p&gt;为什么不同策略的收益率会表现出不同的分布特征？这可以从两类不同的风险来解释。任何投资策略想要赚钱，都需要承担一定的风险。而策略承担什么类型的风险就决定了它的收益分布具备何种的特征。&lt;b&gt;风险可以被分为 convergent risks 和 divergent risks 两大类，因此策略也可以被视为 convergent risk taking 和 divergent risk taking 两大类。&lt;/b&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;b&gt;Convergent risks 是那些被人们理解、可通过建模来测量（尽管不一定准确）的风险；&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;Divergent risks 是哪些未知的风险、无法预测的风险、不能很好的被度量的风险。&lt;/b&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;当构建 convergent risk taking 策略的时候，人们根据金融学或者经济学原理对资产的走势有一个先验信仰，并以此为判断做出投资决策。另一方面，在构建 divergent risk taking 策略时，人们假设资产未来的走势是未知的、不使用任何先验信仰来辅助判断资产会涨还是会跌，而是根据资产价格自身的发展做出相应的判断。&lt;/p&gt;&lt;p&gt;举例来说，股票市场中的价值投资正是 convergent risk taking 的代表。这类策略通过深度行业研究挖掘上市公司的内在价值，当价格低于价值时则买入，耐心的等待其价格向价值回归、无视短期的波动甚至是持续下跌，这是这类策略愿意且主动承担的风险。而常见于 CTA 中的趋势追踪策略则是 divergent risk taking 的代表。这类策略对资产的内在价值不做任何判断，而是严格依据价格的走势进行交易：价格上涨了做多、价格下跌时做空；当盈利时会逐渐加仓，当亏损时会及时清仓。正因如此，趋势追踪策略属于 divergent risk taking 策略，因而其收益满足圣杯分布的特性，这也正是趋势追踪策略能够长盛不衰的原因。&lt;/p&gt;&lt;p&gt;&lt;b&gt;有必要指出的是，圣杯分布是非常美好的，而获得美好的东西注定是十分困难的。&lt;/b&gt;趋势追踪策略最困难的地方在于在趋势中拿的住单子，让利润奔跑（只有这样才能实现收益率分布的右尾）。然而，由于认知偏差，人们往往对确定性高的低收益过度偏爱，因而总是倾向早早平掉盈利的单子。唯有克服人性的错误，才有可能真正享受到趋势策略带来的圣杯分布。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;07 结语&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;来回顾一下本文对趋势追踪策略做了哪些思考。&lt;/p&gt;&lt;p&gt;从技术层面来看，一个成功的趋势策略，最重要的是计算趋势的时间尺度，策略的参数应适应资产的收益率特征。当确定了时间尺度后，具体使用哪个 trend measure 并无本质区别，把更多的精力放在 position sizing 来控制风险可能是更好的选择。作为右侧交易策略，使用历史数据计算得到的趋势信号注定有一定的滞后性，这是难以避免的，使用诸如指数平滑来给最新的数据更高的权重是业界对于减少滞后性的一种尝试。&lt;/p&gt;&lt;p&gt;从心理层面来看，想要成功使用趋势追踪策略就必须要对它的风险收益特征有清醒的认识。单资产上的趋势策略的夏普率通常不高，但是把不同低相关资产的趋势策略组合在一起能显著提升 portfolio 的夏普率。即便如此，趋势策略在短到中期内（例如 1 年）也非常有可能出现持续的回撤。驾驭趋势策略不在于理解它长期来看的正期望，而在于欣然接受它短期内潜在的很差的表现。&lt;/p&gt;&lt;p&gt;从风险角度来看，趋势策略属于 divergent risk taking 策略。它虽然不是圣杯，但它的收益率分布满足圣杯分布，这使得它具备 crisis alpha 等优点，极具配置价值。不过值得一提的是，有研究表明，过度使用杠杆对这类策略的收益和风险的放大是非线性的。因此，科学、有效的风控是使用趋势策略的重要一环。&lt;/p&gt;&lt;p&gt;以上。&lt;/p&gt;&lt;p&gt;好了，我要接着去读最近刚入手的《贫穷的本质》了。各位再见。&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;参考文献&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Levine, A. and L. H. Pedersen (2016). Which trend is your friend? &lt;i&gt;Financial Analysts Journal&lt;/i&gt;, Vol. 72(3), 51 – 66.&lt;/li&gt;&lt;li&gt;Moskowitz, T., Y. H. Ooi, and L. H. Pedersen (2012). Time Series Momentum. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 104(2), 228 – 250.&lt;/li&gt;&lt;li&gt;Roncalli, T. (2017). Keep up the momentum. SSRN: &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//ssrn.com/abstract%3D3083921&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;ssrn.com/abstract=30839&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;21&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;.&lt;/li&gt;&lt;li&gt;Winton (2013). Historical Performance of Trend Following. Winton Capital Research Note.&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;免责声明：&lt;/b&gt;文章内容不可视为投资意见。市场有风险，入市需谨慎。&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处。已委托“维权骑士”(&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//rightknights.com&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;维权骑士_免费版权监测/版权保护/内容多平台分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2019-11-09-91028298</guid>
<pubDate>Sat, 09 Nov 2019 00:00:00 +0800</pubDate>
</item>
</channel>
</rss>
