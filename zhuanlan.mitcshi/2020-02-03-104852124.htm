<div class="title-image"><img src="https://pic1.zhimg.com/v2-66057442e5e29dde47360da45a49727a_b.jpg" alt=""></div><p><b>摘要</b></p><p>GRS 和 Mean-Variance Spanning 是常见的多因子模型检验手段。本文介绍它们的直观含义。</p><h2><b>01 引言</b></h2><p>所有的多因子模型都“不完美”—— 只要我们拿足够多的 test assets 去“折磨”它，任何模型都会被拒绝。然而有些模型是“有用”的。</p><p>如果一个模型中的因子都有可靠的经济学或金融学依据、代表了某种系统性风险或错误定价的原因，且该多因子模型能够解释大量所谓的异象的话，那么这样一个模型就是有用的。然而从不同的逻辑出发，人们总能提出不同的因子，并用它们组合出不同的多因子模型。如何评判哪个模型更好呢？</p><p>Barillas and Shanken (2017) 指出，评价一个多因子模型既要看它能否解释 test assets 又要看它能否解释其他模型的因子。这意味着我们往往用一篮子资产去检验一个多因子模型。怎么检验呢？通常来说可以有两个切入点。</p><p>第一个切入点是联合检验 N 个定价误差是否为零；与之相反的，第二个切入点则是单独考察每个资产的定价误差是否为零。无论是哪种切入点，在学术界的实证资产定价中都十分常见。对于前者，最常使用的方法当属 GRS 检验和 Mean-Variance Spanning（均值-方差张成）检验。解释这两种检验的直观含义就是本文的目标。</p><p>在接下来的文章中，假设待检验的多因子模型包含 K 个因子，用于检验模型的 test assets 有 N 个。</p><h2><b>02 GRS 检验</b></h2><p>GRS 检验由 Gibbons, Ross, Shanken (1989) 提出，并由此得名。关于它的检验统计量，前文<a href="https://zhuanlan.zhihu.com/p/40984029" class="internal">《股票多因子模型的回归检验》</a>的时序回归已经做过介绍，本文不再赘述。此外，[因子动物园] 的<a href="https://link.zhihu.com/?target=http%3A//mp.weixin.qq.com/s%3F__biz%3DMzUxNzY0NjU3Mw%3D%3D%26mid%3D2247484061%26idx%3D1%26sn%3Db836d7aa4d140ee6d2a2887dff882451%26chksm%3Df995b31fcee23a09274a42f56c6741369ffc174821200597e3de9319257903145ff4f6358046%26scene%3D21%23wechat_redirect" class=" wrap external" target="_blank" rel="nofollow noreferrer">《检验因子模型：</a><a href="https://link.zhihu.com/?target=http%3A//mp.weixin.qq.com/s%3F__biz%3DMzUxNzY0NjU3Mw%3D%3D%26mid%3D2247484061%26idx%3D1%26sn%3Db836d7aa4d140ee6d2a2887dff882451%26chksm%3Df995b31fcee23a09274a42f56c6741369ffc174821200597e3de9319257903145ff4f6358046%26scene%3D21%23wechat_redirect" class=" wrap external" target="_blank" rel="nofollow noreferrer">Alpha, GRS 与 GMM》</a>一文也有过说明，感兴趣的小伙伴请参考。</p><p>GRS 检验有两个优点。首先，它的 F-统计量是有限样本（finite sample）下的统计量，即 GRS 检验给出了给定样本大小 T 下这些定价误差应满足的联合分布，该检验是高度精确的。当样本量趋于无穷的时候，定价误差的联合分布渐进趋于 χ2 分布，但在有限样本下使用 χ2 分布并不可靠，这就凸显了 GRS 检验的价值。此外，GRS 检验有非常高的检验效力。当然，任何事物都有两面。GRS 统计量的精确性高度依赖正态分布假设，即资产收益率的残差服从联合正态分布。在现实中，该假设可能过于严格而无法满足，这会降低 GRS 检验在实践中的可信度。</p><p>GRS 检验被学术界广泛使用。比如 Liu, Stambaugh, and Yuan (2019) 就用 GRS 检验比较了他们提出的中国版三因子模型和按照 Fama and French (1993) 一文构建的三因子模型。通过这两个多因子模型之间的因子相互 PK，Liu, Stambaugh, and Yuan (2019) 发现他们的因子优于Fama and French (1993) 中的因子。</p><p>借助计算机的运算能力，我们如今可以很容易的计算出 GRS 统计量并进行检验。但是计算归计算，我们更希望搞清楚 GRS 检验背后的本质。好消息是，GRS 统计量还有另一种形式：</p><p><img src="https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Cfrac%7BT-N-K%7D%7BN%7D%5Cleft%28%5Cleft%5B%5Cfrac%7B%5Csqrt%7B1%2B%5Chat%7B%5Ctheta%7D_%7BN%2BK%7D%5E2%7D%7D%7B%5Csqrt%7B1%2B%5Chat%7B%5Ctheta%7D_%7BK%7D%5E2%7D%7D%5Cright%5D%5E2-1%5Cright%29%5Csim+F_%7BN%2C+T-N-K%7D" alt="\displaystyle\frac{T-N-K}{N}\left(\left[\frac{\sqrt{1+\hat{\theta}_{N+K}^2}}{\sqrt{1+\hat{\theta}_{K}^2}}\right]^2-1\right)\sim F_{N, T-N-K}" eeimg="1"/> </p><p>上式中， <img src="https://www.zhihu.com/equation?tex=%5Chat+%CE%B8_%7BN%2BK%7D" alt="\hat θ_{N+K}" eeimg="1"/> 表示由全部 N 个 test assets 和 K 个因子构成的事后（ex post）最大夏普率投资组合的夏普率； <img src="https://www.zhihu.com/equation?tex=%5Chat+%CE%B8_K" alt="\hat θ_K" eeimg="1"/> 表示由 K 个因子构成的事后最大夏普率投资组合的夏普率。GRS 统计量可以直观的理解为当 K 个因子之外加入 N 个 test assets 之后，能够获得的最大夏普率是否显著高于仅由 K 个因子实现的最大夏普率。如果夏普率显著提高，那么该因子模型就不能解释这 N 个 test assets。</p><h2><b>03 Mean-Variance Spanning 检验</b></h2><p>Huberman and Kandel (1987) 提出的 Mean-Variance Spanning（以下简称 MV Spanning）检验是另一种常见的联合检验手段。从名字就不难看出来，该方法和现代投资组合理论（Modern Portfolio Theory，下称 MPT）以及均值-方差分析有着紧密的联系。</p><p>这种方法的核心无疑是 spanning 一词。假如市场中有 K 个因子投资组合；通过按各种不同的权重配置它们又能得到许多新的组合。对于每个给定的预期收益率 \hat μ，都能找到它的最小方差投资组合。将不同 \hat μ的最小方差投资组合都绘制在横坐标为标准差、纵坐标为预期收益的二维平面内，就得到了人们熟悉的最小方差前沿（minimum-variance frontier），它的形状是一个抛物线。</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-57cc51da97c662310a6a81d48c85e4a0_b.jpg" data-caption="" data-size="normal" data-rawwidth="724" data-rawheight="514" class="origin_image zh-lightbox-thumb" width="724" data-original="https://pic1.zhimg.com/v2-57cc51da97c662310a6a81d48c85e4a0_r.jpg"/></noscript><img src="https://pic1.zhimg.com/v2-57cc51da97c662310a6a81d48c85e4a0_b.jpg" data-caption="" data-size="normal" data-rawwidth="724" data-rawheight="514" class="origin_image zh-lightbox-thumb lazy" width="724" data-original="https://pic1.zhimg.com/v2-57cc51da97c662310a6a81d48c85e4a0_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-57cc51da97c662310a6a81d48c85e4a0_b.jpg"/></figure><p>图中的最小方差前沿就是由这 K 个因子 spanned 出来的，这就是这种方法得名的原因。而 MV Spanning 检验所关注的问题用一句话概括那就是：加入 N 个 test assets 后，全部 N + K 个资产张成的新的最小方差前沿能否显著“优于”仅由 K 个因子张成的最小方差前沿。“优于”意味着对于每一个给定的预期收益率，N + K 个资产张成的前沿上的点都比 K 个因子张成的前沿上的点有更低的方差。</p><p>下面来看看数学上这种检验的原假设是什么。令 <img src="https://www.zhihu.com/equation?tex=%5Cpmb%7BR%7D_%7B1t%7D" alt="\pmb{R}_{1t}" eeimg="1"/> 和 <img src="https://www.zhihu.com/equation?tex=%5Cpmb%7BR%7D_%7B2t%7D" alt="\pmb{R}_{2t}" eeimg="1"/> 分别为 K 个因子和 N 个test assets 的收益率向量。由多因子模型可知：</p><p><img src="https://www.zhihu.com/equation?tex=%5Cpmb%7BR%7D_%7B2t%7D%3D%5Cpmb%7B%5Calpha%7D%2B%5Cpmb%7B%5Cbeta%7D%5Cpmb%7BR%7D_%7B1t%7D%2B%5Cpmb%7B%5Cvarepsilon%7D_t" alt="\pmb{R}_{2t}=\pmb{\alpha}+\pmb{\beta}\pmb{R}_{1t}+\pmb{\varepsilon}_t" eeimg="1"/> </p><p>接下来，定义 <b>δ</b> = <b>1</b>_N – <b>β1</b>_K（下标 N 和 K 代表向量中元素个数）。Huberman and Kandel (1987) 给出了 MV Spanning 检验的原假设的充要条件：</p><p><img src="https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brrl%7D+H_0%26%5Cmbox%7B%3A%7D%26%5Cpmb%7B%5Calpha%7D%3D%5Cpmb%7B0%7D_N%2C~%5Cpmb%7B%5Cdelta%7D%3D%5Cpmb%7B0%7D_N+%5Cend%7Barray%7D" alt="\begin{array}{rrl} H_0&amp;\mbox{:}&amp;\pmb{\alpha}=\pmb{0}_N,~\pmb{\delta}=\pmb{0}_N \end{array}" eeimg="1"/> </p><p>当原假设成立时，对于任何一个 test asset（或这些 assets 的线性组合），我们总能使用 K 个因子来构建一个投资组合，并使得该投资组合的预期收益率和 test assets 的预期收益率相同，但方差更低。这两条关于预期收益率和方差的性质说明，这 N 个 test assets 无法在 K 的基础上张成更优的最小方差前沿，因此可以接受原假设。</p><p>除了上述数学含义外，从由全部 N + K 个资产张成的最小方差前沿上也能够找到上述原假设的直观解释。Kan and Zhou (2012) 指出，在这个最小方差前沿上存在两个特殊的投资组合。其一是全局最小方差组合（global minimum-variance portfolio），其二是从均值-标准差二维平面的原点向最小方差前沿做切线的切点。</p><p>如果原假设成立，条件 <b>α</b> = <b>0</b> 则意味着全局最小方差投资组合中，N 个 test assets 的权重都是零，即该组合完全由 K 个因子构成；条件 <b>δ</b> = <b>0</b> 意味着切点投资组合中也没有 N 个 test assets 的身影。换句话说，这两个特殊的投资组合均仅仅由 K 个因子构成。</p><p>在投资组合理论中，有一个重要的定理是 two-fund separation theorem。它的含义是，使用最小方差前沿上的任意两个组合就能构造出整个前沿，即前沿上的其他组合都可以由这两个投资组合的某种线性组合得到。利用 two-fund separation theorem，可以推断出如果这两个投资组合中均不包含 N 个 test assets，那么整个由 N + K 个资产构成的最小方差前沿上的所有投资组合都不包含它们，这就解释了为什么 <b>α</b> = <b>0</b> 和 <b>δ</b> = <b>0</b> 是原假设成立的充要条件。</p><p>虽然我们已经从直观上理解了 MV Spanning 检验要干什么以及它的原假设是什么，但为了进行检验，还是要用到具体的统计检验量。在这方面，Huberman and Kandel (1987) 一文最早提出了似然比（likelihood ratio）检验统计量；Kan and Zhou (2012) 在它的基础上又通过 Wald 检验和拉格朗日乘数（Lagrange multiplier）检验构建了两个检验统计量。这三个检验统计量在大样本下都渐进满足自由度为 2N 的 χ2 分布。</p><p>这三个统计量的表达式十分接近，且均和两个重要参数 λ_1 和 λ_2 有关。关于这两个参数，Kan and Zhou (2012) 给出了一个非常直观的经济学解释。为了介绍它，首先需要一些铺垫。考虑下图所示的均值-方差平面中由 K 个因子张成的最小方差前沿。在纵轴上取 (0,r) 点并从它向最小方差前沿做切线、找到切点组合 <img src="https://www.zhihu.com/equation?tex=%28%5Chat+%CE%BC_%7Btp%7D%2C+%5Chat+%CF%83_%7Btp%7D%29" alt="(\hat μ_{tp}, \hat σ_{tp})" eeimg="1"/> 。</p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-1acb2f4ecec2b832aba67c530b460aab_b.jpg" data-caption="" data-size="normal" data-rawwidth="622" data-rawheight="435" class="origin_image zh-lightbox-thumb" width="622" data-original="https://pic4.zhimg.com/v2-1acb2f4ecec2b832aba67c530b460aab_r.jpg"/></noscript><img src="https://pic4.zhimg.com/v2-1acb2f4ecec2b832aba67c530b460aab_b.jpg" data-caption="" data-size="normal" data-rawwidth="622" data-rawheight="435" class="origin_image zh-lightbox-thumb lazy" width="622" data-original="https://pic4.zhimg.com/v2-1acb2f4ecec2b832aba67c530b460aab_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-1acb2f4ecec2b832aba67c530b460aab_b.jpg"/></figure><p>接下来，定义：</p><p><img src="https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Chat%5Ctheta_K%28r%29%3D%5Cfrac%7B%5Chat%5Cmu_%7Btp%7D-r%7D%7B%5Chat%5Csigma_%7Btp%7D%7D" alt="\displaystyle\hat\theta_K(r)=\frac{\hat\mu_{tp}-r}{\hat\sigma_{tp}}" eeimg="1"/> </p><p>它表示图中切线的斜率。由于不同的 (0,r) 点会产生不同的切线，因此 <img src="https://www.zhihu.com/equation?tex=%5Chat+%CE%B8_K%28r%29" alt="\hat θ_K(r)" eeimg="1"/> 是 r 的函数。当 r 等于真正的无风险利率 R_f 时， <img src="https://www.zhihu.com/equation?tex=%5Chat+%CE%B8_K%28R_f%29" alt="\hat θ_K(R_f)" eeimg="1"/> 就是从 <img src="https://www.zhihu.com/equation?tex=%280%2CR_f%29" alt="(0,R_f)" eeimg="1"/> 出发得到的切点组合的夏普率。类似的，当把 N 个 test assets 加入后，我们可以定义 <img src="https://www.zhihu.com/equation?tex=%5Chat+%CE%B8_%7BN%2BK%7D%28r%29" alt="\hat θ_{N+K}(r)" eeimg="1"/> 。有了这两个 <img src="https://www.zhihu.com/equation?tex=%5Chat+%CE%B8" alt="\hat θ" eeimg="1"/> 就可以写出 <img src="https://www.zhihu.com/equation?tex=%CE%BB_1" alt="λ_1" eeimg="1"/> 和 <img src="https://www.zhihu.com/equation?tex=%CE%BB_2" alt="λ_2" eeimg="1"/> 的表达式了：</p><p><img src="https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+%5Clambda_1%26%3D%26%5Cdisplaystyle%5Cmax_r%5Cfrac%7B1%2B%5Chat%5Ctheta%5E2_%7BN%2BK%7D%28r%29%7D%7B1%2B%5Chat%5Ctheta%5E2_%7BK%7D%28r%29%7D-1%5C%5C+%5Clambda_2%26%3D%26%5Cdisplaystyle%5Cmin_r%5Cfrac%7B1%2B%5Chat%5Ctheta%5E2_%7BN%2BK%7D%28r%29%7D%7B1%2B%5Chat%5Ctheta%5E2_%7BK%7D%28r%29%7D-1+%5Cend%7Barray%7D" alt="\begin{array}{rll} \lambda_1&amp;=&amp;\displaystyle\max_r\frac{1+\hat\theta^2_{N+K}(r)}{1+\hat\theta^2_{K}(r)}-1\\ \lambda_2&amp;=&amp;\displaystyle\min_r\frac{1+\hat\theta^2_{N+K}(r)}{1+\hat\theta^2_{K}(r)}-1 \end{array}" eeimg="1"/> </p><p>最后，通过 <img src="https://www.zhihu.com/equation?tex=%CE%BB_1" alt="λ_1" eeimg="1"/> 和 <img src="https://www.zhihu.com/equation?tex=%CE%BB_2" alt="λ_2" eeimg="1"/> 就可以方便的求出似然比检验、Wald 检验以及拉格朗日乘数检验的统计量（分别记为 LR、W 和 LM）：</p><p><img src="https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+LR%26%3D%26%5Cdisplaystyle+T%5Cleft%28%5Cln%281%2B%5Clambda_1%29%2B%5Cln%281%2B%5Clambda_2%29%5Cright%29%5Cstackrel%7BA%7D%7B%5Csim%7D%5Cchi%5E2_%7B2N%7D%5C%5C+W%26%3D%26%5Cdisplaystyle+T%5Cleft%28%5Clambda_1%2B%5Clambda_2%5Cright%29%5Cstackrel%7BA%7D%7B%5Csim%7D%5Cchi%5E2_%7B2N%7D%5C%5C+LM%26%3D%26%5Cdisplaystyle+T%5Cleft%28%5Cfrac%7B%5Clambda_1%7D%7B1%2B%5Clambda_1%7D%2B%5Cfrac%7B%5Clambda_2%7D%7B1%2B%5Clambda_2%7D%5Cright%29%5Cstackrel%7BA%7D%7B%5Csim%7D%5Cchi%5E2_%7B2N%7D+%5Cend%7Barray%7D" alt="\begin{array}{rll} LR&amp;=&amp;\displaystyle T\left(\ln(1+\lambda_1)+\ln(1+\lambda_2)\right)\stackrel{A}{\sim}\chi^2_{2N}\\ W&amp;=&amp;\displaystyle T\left(\lambda_1+\lambda_2\right)\stackrel{A}{\sim}\chi^2_{2N}\\ LM&amp;=&amp;\displaystyle T\left(\frac{\lambda_1}{1+\lambda_1}+\frac{\lambda_2}{1+\lambda_2}\right)\stackrel{A}{\sim}\chi^2_{2N} \end{array}" eeimg="1"/> </p><p>这三个统计量虽然略有差异，但它们都是以某种形式将 <img src="https://www.zhihu.com/equation?tex=%CE%BB_1" alt="λ_1" eeimg="1"/> 和 <img src="https://www.zhihu.com/equation?tex=%CE%BB_2" alt="λ_2" eeimg="1"/> 凑在一起作为一个综合的分数来检验原假设。由 <img src="https://www.zhihu.com/equation?tex=%CE%BB_1" alt="λ_1" eeimg="1"/> 和 <img src="https://www.zhihu.com/equation?tex=%CE%BB_2" alt="λ_2" eeimg="1"/> 的定义可知，我们实际上在纵轴上搜寻两个特殊的 r：对于第一个 r，由 K 和 N + K 个资产张成的最小方差前沿上的相应的两个切点的 <img src="https://www.zhihu.com/equation?tex=%5Chat+%CE%B8" alt="\hat θ" eeimg="1"/> 值差异最大；对于第二个 r，这两个最小方差前沿上的相应的两个切点的 <img src="https://www.zhihu.com/equation?tex=%5Chat+%CE%B8" alt="\hat θ" eeimg="1"/> 值差异最小。这三种统计量以这两个特殊 r 下两个前沿的综合差异来检验这两个前沿是否在统计上有所不同。</p><p>以上就是大样本下三种 MV Spanning 检验的统计量。有必要说明的是，当样本量 T 较总资产数 N + K 不足够大时，使用这些统计量并不准确，更好的方法是像 GRS 检验一样计算有限样本下的统计量。悲催的是，从数学上推导有限样本下统计量的表达式十分繁琐。不悲催的是，Kan and Zhou (2012) 给出了这些统计量的几何含义，理解起来就一个字 —— 爽！本文第 4 节将会介绍。</p><p>关于 MV Spanning 检验的应用，一个很有代表性的例子是 Han, Zhou, and Zhu (2016)（见<a href="https://zhuanlan.zhihu.com/p/51043407" class="internal">《美股上一个跨越时间尺度的趋势因子》</a>）。三位作者针对美股提出了一个趋势因子，它不同于传统的动量或反转，而是将不同时间尺度下收益率的动量和反转现象综合到一起，构建了一个综合的趋势因子。该文用新的趋势因子作为 test asset，用传统的短期反转、中期动量以及长期反转因子作为解释变量，通过 MV Spanning 检验进行了分析。结果显示，这三个因子无法解释新的趋势因子，即加入新的趋势因子后，最小方差前沿得到了显著提升。</p><p>最后，对比 MV Spanning 中的统计量和 GRS 检验的统计量能够发现这些表达式中都有“神秘的” <img src="https://www.zhihu.com/equation?tex=%5Chat+%CE%B8" alt="\hat θ" eeimg="1"/> —— 只不过 GRS 检验中的 <img src="https://www.zhihu.com/equation?tex=%5Chat+%CE%B8" alt="\hat θ" eeimg="1"/> 默认的是用无风险收益率 <img src="https://www.zhihu.com/equation?tex=R_f" alt="R_f" eeimg="1"/> 计算的夏普率，而 MV Spanning 中的 <img src="https://www.zhihu.com/equation?tex=%5Chat+%CE%B8" alt="\hat θ" eeimg="1"/> 是使用一般的 r 计算。这意味着它们之间注定有一些关联。</p><h2><b>04 几何含义</b></h2><p>无论是 GRS 还是 MV Spanning 都是为了检验 N 个 test assets 能否在原始 K 个因子基础上提高投资组合的风险收益特征。既然是“同一个目标、同一个梦想”，那么它们之间又有什么差异呢？最直观的说明无异于使用几何方法解释它们的含义。让我们从有效前沿（efficient frontier）说起。</p><p>根据市场中是否存在无风险收益率 <img src="https://www.zhihu.com/equation?tex=R_f" alt="R_f" eeimg="1"/> ，有效前沿的定义是不同的。下图左侧展示了存在 <img src="https://www.zhihu.com/equation?tex=R_f" alt="R_f" eeimg="1"/> 的情况、右侧展示了不存在 <img src="https://www.zhihu.com/equation?tex=R_f" alt="R_f" eeimg="1"/> 的情况。</p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-5e96cc7fecc8590eb85c6346f320f8da_b.jpg" data-caption="" data-size="normal" data-rawwidth="1167" data-rawheight="430" class="origin_image zh-lightbox-thumb" width="1167" data-original="https://pic3.zhimg.com/v2-5e96cc7fecc8590eb85c6346f320f8da_r.jpg"/></noscript><img src="https://pic3.zhimg.com/v2-5e96cc7fecc8590eb85c6346f320f8da_b.jpg" data-caption="" data-size="normal" data-rawwidth="1167" data-rawheight="430" class="origin_image zh-lightbox-thumb lazy" width="1167" data-original="https://pic3.zhimg.com/v2-5e96cc7fecc8590eb85c6346f320f8da_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-5e96cc7fecc8590eb85c6346f320f8da_b.jpg"/></figure><p>先看市场中存在无风险利率 <img src="https://www.zhihu.com/equation?tex=R_f" alt="R_f" eeimg="1"/> 的情况。MPT 指出有效前沿是图中经过点 <img src="https://www.zhihu.com/equation?tex=%280%2C+R_f%29" alt="(0, R_f)" eeimg="1"/> 和切点的直线。无论一个人容忍的最大风险是什么，他都应该通过无风险资产和切点组合的某种线性组合实现最优选择，因为这条线的斜率最高，即夏普率最高。</p><p>GRS 检验假设市场中存在无风险利率 <img src="https://www.zhihu.com/equation?tex=R_f" alt="R_f" eeimg="1"/> 。回顾一下本文第二节中 GRS 统计量，它关注的核心问题就是加入 N 个 test assets之后，使用全部 N + K 个资产得到的切点组合能否比仅仅使用 K 个因子得到的切点组合有更高的夏普率；除切点组合外，GRS 检验不关心最小方差前沿上的其他点。下图为 GRS 检验的几何意义。</p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-8def928bfcfa0186c73032ed66bcb9b2_b.jpg" data-caption="" data-size="normal" data-rawwidth="612" data-rawheight="431" class="origin_image zh-lightbox-thumb" width="612" data-original="https://pic3.zhimg.com/v2-8def928bfcfa0186c73032ed66bcb9b2_r.jpg"/></noscript><img src="https://pic3.zhimg.com/v2-8def928bfcfa0186c73032ed66bcb9b2_b.jpg" data-caption="" data-size="normal" data-rawwidth="612" data-rawheight="431" class="origin_image zh-lightbox-thumb lazy" width="612" data-original="https://pic3.zhimg.com/v2-8def928bfcfa0186c73032ed66bcb9b2_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-8def928bfcfa0186c73032ed66bcb9b2_b.jpg"/></figure><p>为了方便解释，图中的纵坐标采取了相对 R_f 的超额收益。图中两条切线分别通过原点到由 K 个因子和全部 N + K 个资产张成的最小方差前沿的切点。如果多因子模型无法解释 test assets，那么加入它们之后应该显著提升切点组合的夏普率。在图中横坐标上的 <img src="https://www.zhihu.com/equation?tex=%5Chat+%CF%83+%3D+1" alt="\hat σ = 1" eeimg="1"/> 点出发做一条竖直线，它和两条切线相较于 A、B。由夏普率定义可知，A、B 两点纵坐标对应的超额收益恰恰就等于夏普率 <img src="https://www.zhihu.com/equation?tex=%5Chat+%CE%B8_K" alt="\hat θ_K" eeimg="1"/> 和 <img src="https://www.zhihu.com/equation?tex=%5Chat+%CE%B8_%7BN%2BK%7D" alt="\hat θ_{N+K}" eeimg="1"/> ，而它们也正是正两条直线的斜率。</p><p>由此可知 GRS 统计量中的 <img src="https://www.zhihu.com/equation?tex=%5Csqrt%7B1%2B%5Chat%7B%5Ctheta%7D_%7BK%7D%5E2%7D" alt="\sqrt{1+\hat{\theta}_{K}^2}" eeimg="1"/>  和 <img src="https://www.zhihu.com/equation?tex=%5Csqrt%7B1%2B%5Chat%7B%5Ctheta%7D_%7BN%2BK%7D%5E2%7D" alt="\sqrt{1+\hat{\theta}_{N+K}^2}" eeimg="1"/>  分别为线段 OA 和 OB 的长度。因此 GRS 统计量的公式反应了这两个线段长度之比，它的意思是检验 OB 的长度是否显著的大于线段 OA 的长度。这正是 GRS 检验的几何意义。</p><p>再来说 MV Spanning。上一节介绍了大样本下三种统计量的渐进性质。下面的几何解释则给出了这些统计量在有限样本中的含义。与 GRS 检验不同，MV Spanning 并不假设 <img src="https://www.zhihu.com/equation?tex=R_f" alt="R_f" eeimg="1"/> 的存在，因此适应更广泛的情况。当 <img src="https://www.zhihu.com/equation?tex=R_f" alt="R_f" eeimg="1"/> 不存在时，有效前沿是最小方差前沿的上半部分（本小节第一张图的右侧）。</p><p>在这种情况下，仍然像 GRS 一样仅仅关注切点组合就不够了 —— 事实上，因为不存在 <img src="https://www.zhihu.com/equation?tex=R_f" alt="R_f" eeimg="1"/> ，因此也没有传统意义上的切点组合。我们希望检验两个事后抛物线是不是在统计上“足够远”—— 原假设是事前没有差别。但既然仅使用一个点来评判不够了，那么怎么办呢？</p><p>对了，答案是“找两个点”。</p><p>从两个最小方差前沿上找到两个特殊的点进行比较、评判这两个前沿的差异，这就是 MV Spanning 检验的几何含义（下图，出自 Kan and Zhou 2012，就是要通过特殊的点来评价红、蓝两个前沿是不是在统计上足够接近）。而 LR、W 和 LM 三种不同检验统计量之间的差异仅仅因为它们比较这两个前沿的方式稍有区别。</p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-e0787b31becaca3c293503fb2cd34a9b_b.jpg" data-caption="" data-size="normal" data-rawwidth="788" data-rawheight="560" class="origin_image zh-lightbox-thumb" width="788" data-original="https://pic4.zhimg.com/v2-e0787b31becaca3c293503fb2cd34a9b_r.jpg"/></noscript><img src="https://pic4.zhimg.com/v2-e0787b31becaca3c293503fb2cd34a9b_b.jpg" data-caption="" data-size="normal" data-rawwidth="788" data-rawheight="560" class="origin_image zh-lightbox-thumb lazy" width="788" data-original="https://pic4.zhimg.com/v2-e0787b31becaca3c293503fb2cd34a9b_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-e0787b31becaca3c293503fb2cd34a9b_b.jpg"/></figure><p>图中 <img src="https://www.zhihu.com/equation?tex=g_1" alt="g_1" eeimg="1"/> 和 <img src="https://www.zhihu.com/equation?tex=g" alt="g" eeimg="1"/> 分别为由 K 个因子和全部 N + K 个资产张成的事后最小方差投资组合，这两个点代表的投资组合的标准差的大小由图中线段 OD 和 OC 的长度表示。从 <img src="https://www.zhihu.com/equation?tex=g" alt="g" eeimg="1"/> 和 <img src="https://www.zhihu.com/equation?tex=g_1" alt="g_1" eeimg="1"/> 向纵轴做垂线，得到 A 和 B 两个点。从 A 出发向 K 个因子的最小方差前沿做切线，切线和直线 <img src="https://www.zhihu.com/equation?tex=%5Chat+%CF%83+%3D+1" alt="\hat σ = 1" eeimg="1"/> 相交于点 G、同样从 A 出发做 N + K 个资产的最小方差前沿的渐进线，渐进线和直线 <img src="https://www.zhihu.com/equation?tex=%5Chat+%CF%83+%3D+1" alt="\hat σ = 1" eeimg="1"/> 相交于点 H。类似的，以点 B 为起点，做 N + K 个资产的最小方差前沿的切线、做 K 个因子的最小方差前沿的渐进线，它们分别与直线 <img src="https://www.zhihu.com/equation?tex=%5Chat+%CF%83+%3D+1" alt="\hat σ = 1" eeimg="1"/> 相交于点 E 和 F。使用 OC、OD、AG、AH、BE 和 BF 就可以解释三种检验统计量的几何意义。</p><p>先说似然比检验。在有限样本下，其检验统计量满足 <img src="https://www.zhihu.com/equation?tex=F_%7B2N%2C+2%28T-K-N%29%7D" alt="F_{2N, 2(T-K-N)}" eeimg="1"/> 分布：</p><p><img src="https://www.zhihu.com/equation?tex=%5Cdisplaystyle+LR%3D%5Cleft%28%5Cfrac%7BT-K-N%7D%7BN%7D%5Cright%29%5Cleft%5B%5Cleft%28%5Cfrac%7BOD%7D%7BOC%7D%5Cright%29%5Cleft%28%5Cfrac%7BAH%7D%7BBF%7D%5Cright%29-1%5Cright%5D" alt="\displaystyle LR=\left(\frac{T-K-N}{N}\right)\left[\left(\frac{OD}{OC}\right)\left(\frac{AH}{BF}\right)-1\right]" eeimg="1"/> </p><p>LR 的大小和两个比值有关。第一个比值 OD/OC 比较两个全局最小方差组合的标准差。由于 K 个因子构成的最小方差组合的标准差一定不小于 N + K 个资产构成的最小方差组合的标准差，因此 OD/OC ≥ 1。第二个比值是 AH/BF。由于 N + K 个资产张成的事后最小方差前沿一定“优于”仅由 K 个因子张成的事后最小方差前沿，因此 AH/BF ≥ 1。如果原假设成立，即事前（ex ante）两个前沿一样，那么我们可以期待 OD/OC 和 AH/BF 都不会显著的偏离 1。如果它们其中之一或者二者全部显著大于 1，那么原假设就会被拒绝。</p><p>对于 Wald 检验和拉格朗日乘数检验，在有限样本下，它们统计量并不满足 F 分布，而是十分复杂的分布，但仍然可以写出它们统计量的几何含义：</p><p><img src="https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brrrll%7D+W%26%5Cmbox%7B%3A%7D%26%5Cdisplaystyle+%5Clambda_1%2B%5Clambda_2%26%3D%26%5Cdisplaystyle%5Cleft%28%5Cfrac%7BOD%7D%7BOC%7D%5Cright%29%5E2-1%2B%5Cleft%28%5Cfrac%7BBE%7D%7BBF%7D%5Cright%29%5E2-1%5C%5C+LM%26%5Cmbox%7B%3A%7D%26%5Cdisplaystyle%5Cfrac%7B%5Clambda_1%7D%7B1%2B%5Clambda_1%7D%2B%5Cfrac%7B%5Clambda_2%7D%7B1%2B%5Clambda_2%7D%26%3D%26%5Cdisplaystyle+1-%5Cleft%28%5Cfrac%7BOC%7D%7BOD%7D%5Cright%29%5E2%2B1-%5Cleft%28%5Cfrac%7BAG%7D%7BAH%7D%5Cright%29%5E2+%5Cend%7Barray%7D" alt="\begin{array}{rrrll} W&amp;\mbox{:}&amp;\displaystyle \lambda_1+\lambda_2&amp;=&amp;\displaystyle\left(\frac{OD}{OC}\right)^2-1+\left(\frac{BE}{BF}\right)^2-1\\ LM&amp;\mbox{:}&amp;\displaystyle\frac{\lambda_1}{1+\lambda_1}+\frac{\lambda_2}{1+\lambda_2}&amp;=&amp;\displaystyle 1-\left(\frac{OC}{OD}\right)^2+1-\left(\frac{AG}{AH}\right)^2 \end{array}" eeimg="1"/> </p><p>怎么样？W 和 LM 的表达式看上去那是“相当对称”。</p><p>W 中的第一项是 <img src="https://www.zhihu.com/equation?tex=%28OD%2FOC%29%5E2+-+1" alt="(OD/OC)^2 - 1" eeimg="1"/> ，它反映的仍然是两个全局最小方差组合的标准差偏离程度，由于 <img src="https://www.zhihu.com/equation?tex=OD+%E2%89%A5+OC" alt="OD ≥ OC" eeimg="1"/> 因此该项中用 <img src="https://www.zhihu.com/equation?tex=%28OD%2FOC%29%5E2" alt="(OD/OC)^2" eeimg="1"/> 减去 1；再看 LM，它的第一项是 <img src="https://www.zhihu.com/equation?tex=1+-+%28OC%2FOD%29%5E2" alt="1 - (OC/OD)^2" eeimg="1"/> ，它和 <img src="https://www.zhihu.com/equation?tex=%28OD%2FOC%29%5E2+-+1" alt="(OD/OC)^2 - 1" eeimg="1"/> 如出一辙，只不过因为分子分母互换了位置导致  <img src="https://www.zhihu.com/equation?tex=%28OC%2FOD%29%5E2+%E2%89%A4+1" alt="(OC/OD)^2 ≤ 1" eeimg="1"/>  因此该项中是用 1 减去 <img src="https://www.zhihu.com/equation?tex=%28OC%2FOD%29%5E2" alt="(OC/OD)^2" eeimg="1"/> 。</p><p>再看第二项。W 的第二项用到了线段 BE 和 BF，它们都是从 B 出发，BE 是 B 到全部 N + K 个资产的最小方差前沿的切线、BF 是 B 到 K 个因子的最小方差前沿的渐进线。 <img src="https://www.zhihu.com/equation?tex=%28BE%2FBF%29%5E2+-+1" alt="(BE/BF)^2 - 1" eeimg="1"/> 衡量了在 K 个因子的基础上加入 N 个 test assets 导致切线斜率平方的提升。反观 LM 的第二项，它用到了线段 AG 和 AH，它们都是从点 A 出发，AG 是 A 到 K 个因子的最小方差前沿的切线、AH 是 A 到 N + K 个资产的最小方差前沿的渐进线。 <img src="https://www.zhihu.com/equation?tex=1+-+%28AG%2FAH%29%5E2" alt="1 - (AG/AH)^2" eeimg="1"/> 体现了从 N + K 个资产中去除 N 个 test assets（从而仅剩下 K 个因子）导致切线斜率平方的降低。</p><p>不光是表达式，就连解释起来都是那么“对称”。这种“对称”彰显了几何解释之美，彰显了数学之美。</p><h2><b>05 结语</b></h2><p>GRS 和 MV Spanning 是实证资产定价中常见的检验方法（尤其是 GRS）。本文花了一些笔墨从直观上解释了它们都在干什么。</p><p>总结来说，GRS 假设 <img src="https://www.zhihu.com/equation?tex=R_f" alt="R_f" eeimg="1"/> 存在，因此它关注的是切点组合的夏普率能否因 N 个 test assets 的加入而显著提升。反观 MV Spanning，它则直接比较两个最小方差前沿的差异。这些统计手段经过了几十年的发展和应用，而如今计算机的运算能力也可以“秒出”检验结果。然而，当我们搞清楚了这些检验统计量的直观含义后，它们便不再只是冰冷的公式，而是一个个令人拍案的“原来如此”。</p><p class="ztext-empty-paragraph"><br/></p><p><b>参考文献</b></p><ul><li>Barillas, F. and J. Shanken (2017). Which alpha? <i>Review of Financial Studies</i>, Vol. 30(4), 1316 – 1338.</li><li>Fama, E. F. and K. R. French (1993). Common risk factors in the returns on stocks and bonds. <i>Journal of Financial Economics</i>, Vol. 33(1), 3 – 56.</li><li>Gibbons, M. R., S. Ross, and J. Shanken (1989). A test of efficiency of a given portfolio.<i>Econometrica</i>, Vol. 57(5), 1121 – 1152.</li><li>Han, Y., Zhou, G., Y. Zhu (2016). A trend factor: any economic gains from using information over investment horizons? <i>Journal of Financial Economics</i>, Vol. 122(2), 352 – 375.</li><li>Huberman, G. and S. Kandel (1987). Mean-variance spanning. <i>Journal of Finance</i>, Vol. 42(4), 873 – 888.</li><li>Kan, R. and G. Zhou (2012). Tests of mean-variance spanning. <i>Annals of Economics and Finance</i>, Vol. 13(1), 145 – 193.</li><li>Liu, J., R. F. Stambaugh, and Y. Yuan (2019). Size and value in China. <i>Journal of Financial Economics</i>, Vol. 134(1), 48 – 69.</li></ul><p class="ztext-empty-paragraph"><br/></p><p><b>免责声明：</b>文章内容不可视为投资意见。市场有风险，入市需谨慎。</p><p class="ztext-empty-paragraph"><br/></p><p class="ztext-empty-paragraph"><br/></p><p>原创不易，请保护版权。如需转载，请联系获得授权，并注明出处。已委托“维权骑士”(<a href="https://link.zhihu.com/?target=http%3A//rightknights.com" class=" wrap external" target="_blank" rel="nofollow noreferrer">维权骑士_免费版权监测/版权保护/内容多平台分发</a>) 为进行维权行动。</p><p></p><p></p>