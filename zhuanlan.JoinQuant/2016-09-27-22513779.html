<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>【JoinQuant】Hurst指数与股票投资</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/22513779">原文</a></p>
<div class="title-image"><img src="https://pic4.zhimg.com/v2-1af13b447f2babc530070f258c4a7b1f_b.jpg" alt=""></div>导语：真实中，股票收益率的分布并不像我们所期望的那样是独立正态分布，而是有偏的——收益率时间序列往往存在自相关性。如果能够根据收益率的记忆性分析出它的趋势，那么便可以将此作为一个择时的依据，制定量化交易策略。那么，如何刻画这一统计特性？使用Hurst指数便是其中一种办法。<p>在标准金融学模型中，我们基本都假定股票的波动是随机独立的。一个随机独立的波动率对应的股票变动如下图所示：<br/></p><p><figure><noscript><img src="https://pic4.zhimg.com/v2-2234c1bf55f0437a827acd939a426617_b.png" data-rawwidth="1275" data-rawheight="557" class="origin_image zh-lightbox-thumb" width="1275" data-original="https://pic4.zhimg.com/v2-2234c1bf55f0437a827acd939a426617_r.jpg"/></noscript><img src="https://pic4.zhimg.com/v2-2234c1bf55f0437a827acd939a426617_b.png" data-rawwidth="1275" data-rawheight="557" class="origin_image zh-lightbox-thumb lazy" width="1275" data-original="https://pic4.zhimg.com/v2-2234c1bf55f0437a827acd939a426617_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-2234c1bf55f0437a827acd939a426617_b.png"/></figure>但是实际上，真实的股票数据并非这样——股票的低迷往往会持续很长的时间，而突然的增长则是远超过平均收益的暴涨。<br/></p><figure><noscript><img src="https://pic1.zhimg.com/v2-6793726eedb8c160b26f3917a3436d00_b.png" data-rawwidth="1300" data-rawheight="204" class="origin_image zh-lightbox-thumb" width="1300" data-original="https://pic1.zhimg.com/v2-6793726eedb8c160b26f3917a3436d00_r.jpg"/></noscript><img src="https://pic1.zhimg.com/v2-6793726eedb8c160b26f3917a3436d00_b.png" data-rawwidth="1300" data-rawheight="204" class="origin_image zh-lightbox-thumb lazy" width="1300" data-original="https://pic1.zhimg.com/v2-6793726eedb8c160b26f3917a3436d00_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-6793726eedb8c160b26f3917a3436d00_b.png"/></figure><p>直观上的原因在于，看上去随机的收益率并不是那么的随机——它们具有一些自相关性。例如，在大部分股票市场，当前收益率持续较高的时候，之后的收益率也更可能高（牛市往往持续一段时间），当前收益率低时，之后的收益率也低（熊市往往也会持续很长时间）。<br/>听起来有点像动量效应，其实吧，我们得再次声明下，任何CTA类策略，要么就是抓趋势（偏动量）的，要么就是抓震荡（偏均值回归）的。<br/>自相关性的应用其实起源于其他场景。Hurst指数就可以刻画这一统计性质。Hurst指数的来源就是Hurst本人在研究河流流量之后发现，干旱的时间愈久，就更可能出现持续的干旱；大洪水之后，也更可能出现大洪水。<br/>我们可以像hurst本人刻画河流流量一样，将hurst指数用于刻画股票的记忆性，通过识别股票价格的波动趋势，买入更有可能持续上涨的股票，实现收益。<br/></p><h4>1.1 Hurst指数的计算</h4><p><figure><noscript><img src="https://pic1.zhimg.com/v2-37b2efa74e3430bb29277a1a2c57ef18_b.png" data-rawwidth="1251" data-rawheight="448" class="origin_image zh-lightbox-thumb" width="1251" data-original="https://pic1.zhimg.com/v2-37b2efa74e3430bb29277a1a2c57ef18_r.jpg"/></noscript><img src="https://pic1.zhimg.com/v2-37b2efa74e3430bb29277a1a2c57ef18_b.png" data-rawwidth="1251" data-rawheight="448" class="origin_image zh-lightbox-thumb lazy" width="1251" data-original="https://pic1.zhimg.com/v2-37b2efa74e3430bb29277a1a2c57ef18_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-37b2efa74e3430bb29277a1a2c57ef18_b.png"/></figure>（上图是计算hurst指数的流程图，可配合以下文字一起咀嚼）<br/>简单来讲，hurst指数的计算，是计算一个序列(R/S)t（接下来会具体介绍(R/S)t的计算方法）对t的变化斜率。<br/></p><figure><noscript><img src="https://pic4.zhimg.com/v2-37a17526932a34cc2e87ce63a619002f_b.png" data-rawwidth="1097" data-rawheight="621" class="origin_image zh-lightbox-thumb" width="1097" data-original="https://pic4.zhimg.com/v2-37a17526932a34cc2e87ce63a619002f_r.jpg"/></noscript><img src="https://pic4.zhimg.com/v2-37a17526932a34cc2e87ce63a619002f_b.png" data-rawwidth="1097" data-rawheight="621" class="origin_image zh-lightbox-thumb lazy" width="1097" data-original="https://pic4.zhimg.com/v2-37a17526932a34cc2e87ce63a619002f_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-37a17526932a34cc2e87ce63a619002f_b.png"/></figure><p>如上图所示，如果我们有一系列（t，(R/S)t）的数据，那么回归得到的红线的斜率就是hurst指数的值。<br/>而这里的t就是选择的样本区间的长度（例如选择了八十天的数据，那么t=80），接下来的关键就是计算(R/S)t值。<br/><br/>取沪深300日回报率(daily return)n天内的数据作为时间序列，记回报率X=X1,X2X3,…,Xn为一串时间序列。<br/></p><p>第一步：计算这个序列的均值:</p><br/><figure><noscript><img src="https://pic4.zhimg.com/v2-29288fbaa6f2bb6d783d2a7c82e151f7_b.png" data-rawwidth="233" data-rawheight="91" class="content_image" width="233"/></noscript><img src="https://pic4.zhimg.com/v2-29288fbaa6f2bb6d783d2a7c82e151f7_b.png" data-rawwidth="233" data-rawheight="91" class="content_image lazy" width="233" data-actualsrc="https://pic4.zhimg.com/v2-29288fbaa6f2bb6d783d2a7c82e151f7_b.png"/></figure><br/><p>第二步：计算离差序列(deviation):</p><br/><figure><noscript><img src="https://pic4.zhimg.com/v2-c15c406055bcc6e3e7fdb4d147a2513f_b.png" data-rawwidth="177" data-rawheight="55" class="content_image" width="177"/></noscript><img src="https://pic4.zhimg.com/v2-c15c406055bcc6e3e7fdb4d147a2513f_b.png" data-rawwidth="177" data-rawheight="55" class="content_image lazy" width="177" data-actualsrc="https://pic4.zhimg.com/v2-c15c406055bcc6e3e7fdb4d147a2513f_b.png"/></figure><br/><p>第三步：将离差序列求和，计算出离差序列和的极差(widest difference)：<br/><figure><noscript><img src="https://pic1.zhimg.com/v2-21d6223cd2c217215d3e8d02134cba64_b.png" data-rawwidth="567" data-rawheight="175" class="origin_image zh-lightbox-thumb" width="567" data-original="https://pic1.zhimg.com/v2-21d6223cd2c217215d3e8d02134cba64_r.jpg"/></noscript><img src="https://pic1.zhimg.com/v2-21d6223cd2c217215d3e8d02134cba64_b.png" data-rawwidth="567" data-rawheight="175" class="origin_image zh-lightbox-thumb lazy" width="567" data-original="https://pic1.zhimg.com/v2-21d6223cd2c217215d3e8d02134cba64_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-21d6223cd2c217215d3e8d02134cba64_b.png"/></figure>第四步：计算序列X的标准差(standard deviation):</p><figure><noscript><img src="https://pic1.zhimg.com/v2-c36c10f54f60c50cfb91bda61b4e80d4_b.png" data-rawwidth="357" data-rawheight="114" class="content_image" width="357"/></noscript><img src="https://pic1.zhimg.com/v2-c36c10f54f60c50cfb91bda61b4e80d4_b.png" data-rawwidth="357" data-rawheight="114" class="content_image lazy" width="357" data-actualsrc="https://pic1.zhimg.com/v2-c36c10f54f60c50cfb91bda61b4e80d4_b.png"/></figure><p>第五步：计算R/S值：<br/></p><p>(R/S)t=Rt/St<br/>R=第3步中计算的离差序列和的极差R=第3步中计算的离差序列和的极差<br/>S=第4步中计算的标准差S=第4步中计算的标准差<br/><br/>根据上面1-5步的计算，我们得到了一个序列X=X1,X2,X3,…,Xn对应的R/S，因为这个序列样本有n个，因此R/S可以写作(R/S)n<br/>如前所述，我们需要计算一系列的（t，(R/S)t），因此我们需要重复上面的步骤——<br/><br/>第六步：重复1-5步计算R/S，但分别取不一样的t值（t=2,3,…,n），这相当于我们对序列：<br/></p><p><figure><noscript><img src="https://pic2.zhimg.com/v2-f826d30f27e7e2caa3ba972c35659d09_b.png" data-rawwidth="307" data-rawheight="154" class="content_image" width="307"/></noscript><img src="https://pic2.zhimg.com/v2-f826d30f27e7e2caa3ba972c35659d09_b.png" data-rawwidth="307" data-rawheight="154" class="content_image lazy" width="307" data-actualsrc="https://pic2.zhimg.com/v2-f826d30f27e7e2caa3ba972c35659d09_b.png"/></figure>分别计算按照上述分段方法得到的(R/S)t值。<br/></p><p>第七步：计算Hurst指数<br/>a. 将每种分段方法的片段大小（即所取得时间区间t）和R/S对10取对数<br/>b. 这样我们就有了对数序列。将lg(R/S)t作为被解释变量Y，lgt作为解释变量X，线性回归估计斜率H，H就是Hurst指数。<br/><br/>对Hurst指数的直观解释是：当所选取的样本越多，样本的变化也就越丰富，因此离差序列和的极差（以下简称极差）也会越大。如果序列有相关性时，序列长期向着一个方向变化，计算所得的极差就会比完全随机的情形更大，因此当极差随样本增加增长得越快时，序列的记忆性就越强。而hurst就是描述样本规模和R/S的上述关系，当hurst指数大的时候，其记忆性自然也就越强。<br/>（我们这个是level0的理解深度，未来的量化课堂文章会讲原理）<br/></p><h4>1.2 Hurst指数的性质</h4><p>Hurst指数体现了时间序列的自相关性，尤其反映了序列中隐藏的长期趋势，统计学上称为长期记忆(long-term memory)。Hurst指数居于0-1之间。以0.5为间隔，时间序列在不同的区间会表现不同的特性：</p><p>H=0.5：标准布朗运动。此时，序列为随机游走，表现马尔可夫链特性。<br/>H≠0.5：分形布朗运动，这种运动不是完全随机的，具有长期相关性——<br/>当H&gt;0.5时，表现为持续性（即持续之前序列的性质）；<br/>当H&lt;0.5时，表现为反持续性。</p><h4>1.3 Hurst指数的应用</h4><p>思路：根据收益率变化趋势与hurst指数，判断应该买入还是卖出——<br/>如果过去收益率增加并且序列有正相关性，买入股票；<br/>如果过去收益率降低并且序列有正相关性，卖出股票；<br/>如果过去收益率降低并且序列有负相关性，买入股票；<br/>如果过去收益率增加并且序列有负相关性，卖出股票；</p><p>具体而言，在我们的策略中，采用hurst指数来衡量序列相关性。当hurst&gt;0.6时，认为序列有趋势性，当hurst&lt;0.4时，认为hurst有负相关性； <br/><br/>而对于判断过去收益增加还是减少，一种办法是直接用当前收盘价和前N日收盘价比较，如果当日收盘价高，则认为收益增加。但是在我们的设定中，这种办法的缺陷是这实际上只能判断收益增加，但是不能判断收益率的变化，因此在本文的策略中，采用的是N日收益率对时间回归。如果回归所得的斜率为正，则认为在过去N日中收益率是增长的趋势（注意：是收益率向上，而不是股票走势向上哦！）；如果回归所得的斜率为负，则认为在过去N日中收益率是减少的趋势。<br/>注：在应用中，我们取N=59（收盘价数据取N=60天的数据）。</p><p>根据回测结果，可以看出hurst的择时在应对大跌时效果较好，但因为要保证收益率是持续增长，往往在大牛市中会提前空仓，但一整个牛熊市下来，收益率远高于大盘。<br/></p><figure><noscript><img src="https://pic2.zhimg.com/v2-c09123c7b5801355a3045fc4fcdb5ebd_b.png" data-rawwidth="1291" data-rawheight="327" class="origin_image zh-lightbox-thumb" width="1291" data-original="https://pic2.zhimg.com/v2-c09123c7b5801355a3045fc4fcdb5ebd_r.jpg"/></noscript><img src="https://pic2.zhimg.com/v2-c09123c7b5801355a3045fc4fcdb5ebd_b.png" data-rawwidth="1291" data-rawheight="327" class="origin_image zh-lightbox-thumb lazy" width="1291" data-original="https://pic2.zhimg.com/v2-c09123c7b5801355a3045fc4fcdb5ebd_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-c09123c7b5801355a3045fc4fcdb5ebd_b.png"/></figure><figure><noscript><img src="https://pic4.zhimg.com/v2-f47793f046d2e2f9ecd46b3b40287d9b_b.png" data-rawwidth="1294" data-rawheight="702" class="origin_image zh-lightbox-thumb" width="1294" data-original="https://pic4.zhimg.com/v2-f47793f046d2e2f9ecd46b3b40287d9b_r.jpg"/></noscript><img src="https://pic4.zhimg.com/v2-f47793f046d2e2f9ecd46b3b40287d9b_b.png" data-rawwidth="1294" data-rawheight="702" class="origin_image zh-lightbox-thumb lazy" width="1294" data-original="https://pic4.zhimg.com/v2-f47793f046d2e2f9ecd46b3b40287d9b_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-f47793f046d2e2f9ecd46b3b40287d9b_b.png"/></figure><p>到JoinQuant查看代码并与作者交流讨论：<a class=" wrap external" href="https://link.zhihu.com/?target=https%3A//www.joinquant.com/post/1958%3Ff%3Dzh" target="_blank" rel="nofollow noreferrer">【量化课堂】Hurst指数与应用（单股票）</a></p><p><b>JoinQuant 聚宽  最专业的量化交易平台</b><b>，</b><b>免费提供数据获取、研究环境、策略回测、实盘连接、发送交易信号，学习交流等一站式功能体验。</b></p><p><b>Welcome to  </b><b><a href="www.joinquant.com/?f=zh&amp;m=intro" class="">JoinQuant</a> !</b></p>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
