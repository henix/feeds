<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>IPv6 三个访问本地地址的小Tips</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/71697134">原文</a></p>
<div class="title-image"><img src="https://pic4.zhimg.com/v2-8446c9be5b67b2546b744ce3590ec89a_b.jpg" alt=""></div><p>作者： <a class="member_mention" href="https://www.zhihu.com/people/6f8ffd80705c262c2ee3fa4d9b3f8f06" data-hash="6f8ffd80705c262c2ee3fa4d9b3f8f06" data-hovercard="p$b$6f8ffd80705c262c2ee3fa4d9b3f8f06">@周佩雨</a>，就职于长亭科技</p><p>最近发现家里宽带支持IPv6了，这里分享三个利用IPv6访问本地地址（内网地址）的方法。</p><p>通常来说，我们用localhost来代表本地地址<code>127.0.0.1</code>。其实在IPv6中有他自己的表示方法<code>ip6-localhost</code>：</p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-9c763ab88e4f7d129d15bbcf9ebca18f_b.jpg" data-caption="" data-size="normal" data-rawwidth="520" data-rawheight="157" class="origin_image zh-lightbox-thumb" width="520" data-original="https://pic4.zhimg.com/v2-9c763ab88e4f7d129d15bbcf9ebca18f_r.jpg"/></noscript><img src="https://pic4.zhimg.com/v2-9c763ab88e4f7d129d15bbcf9ebca18f_b.jpg" data-caption="" data-size="normal" data-rawwidth="520" data-rawheight="157" class="origin_image zh-lightbox-thumb lazy" width="520" data-original="https://pic4.zhimg.com/v2-9c763ab88e4f7d129d15bbcf9ebca18f_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-9c763ab88e4f7d129d15bbcf9ebca18f_b.jpg"/></figure><p>另外，大家应该都知道<a href="https://link.zhihu.com/?target=http%3A//xip.io" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">http://</span><span class="visible">xip.io</span><span class="invisible"></span></a>这个服务，可以将任何IP地址用域名的形式表示，用来测试SSRF漏洞比较方便。但<a href="https://link.zhihu.com/?target=http%3A//xip.io" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">http://</span><span class="visible">xip.io</span><span class="invisible"></span></a>只支持IPv4，IPv6下也有个类似的服务，ip6.name。</p><p>比如，我们可以通过<code>x.1.ip6.name</code>访问<code>::1</code>，也就是本地：</p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-f91ae6e58867e675c907e2d3daf5a342_b.jpg" data-caption="" data-size="normal" data-rawwidth="502" data-rawheight="248" class="origin_image zh-lightbox-thumb" width="502" data-original="https://pic3.zhimg.com/v2-f91ae6e58867e675c907e2d3daf5a342_r.jpg"/></noscript><img src="https://pic3.zhimg.com/v2-f91ae6e58867e675c907e2d3daf5a342_b.jpg" data-caption="" data-size="normal" data-rawwidth="502" data-rawheight="248" class="origin_image zh-lightbox-thumb lazy" width="502" data-original="https://pic3.zhimg.com/v2-f91ae6e58867e675c907e2d3daf5a342_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-f91ae6e58867e675c907e2d3daf5a342_b.jpg"/></figure><p>再分享一个Windows下有趣的冷知识吧。</p><p>UNC Path是Windows中访问共享资源的方法，前段时间代码审计圈子里还分享过PHP利用UNC、WebDAV来包含远程文件的方法：<a href="https://link.zhihu.com/?target=https%3A//t.zsxq.com/fUjiMfY" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">https://</span><span class="visible">t.zsxq.com/fUjiMfY</span><span class="invisible"></span></a></p><p>而UNC Path是不支持冒号的，所以我们没法在UNC Path中使用IPv6地址：<code>\\[fe80::2]\share</code>。所以微软官方想了一个歪招，他们注册了一个域名<code>ipv6-literal.net</code>，然后在Windows系统中，将IPv6地址中的冒号换成横线作为<code>ipv6-literal.net</code>子域名，如<code>2408-8207-1850-2a60--4c8.ipv6-literal.net</code>。</p><p>通过这个域名即可访问到对应的IPv6目标：</p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-0283612d32154e30aaa433eb2ba12612_b.jpg" data-caption="" data-size="normal" data-rawwidth="515" data-rawheight="443" class="origin_image zh-lightbox-thumb" width="515" data-original="https://pic3.zhimg.com/v2-0283612d32154e30aaa433eb2ba12612_r.jpg"/></noscript><img src="https://pic3.zhimg.com/v2-0283612d32154e30aaa433eb2ba12612_b.jpg" data-caption="" data-size="normal" data-rawwidth="515" data-rawheight="443" class="origin_image zh-lightbox-thumb lazy" width="515" data-original="https://pic3.zhimg.com/v2-0283612d32154e30aaa433eb2ba12612_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-0283612d32154e30aaa433eb2ba12612_b.jpg"/></figure><p>这就类似于微软官方推出的一个ip6.name服务。</p><p>但是，有趣的是，这里和ip6.name、<a href="https://link.zhihu.com/?target=http%3A//xip.io" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">http://</span><span class="visible">xip.io</span><span class="invisible"></span></a>有一个很大的区别，我们访问<code>2408-8207-1850-2a60--4c8.ipv6-literal.net</code>的时候，系统是不会真正发送DNS请求的，这个域名仿佛内置在Windows操作系统中，与生俱来就存在。</p><p>所以，你会发现，其实<code>ipv6-literal.net</code>这个域名微软早就已经不续费了（现在的所有者是Godaddy），但我们仍然可以直接在浏览器里通过<code>0--1.ipv6-literal.net</code>来访问到<code>::1</code>，也就是我本地：</p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-f246c5eea2b844f09667018e2786361e_b.jpg" data-caption="" data-size="normal" data-rawwidth="747" data-rawheight="169" class="origin_image zh-lightbox-thumb" width="747" data-original="https://pic3.zhimg.com/v2-f246c5eea2b844f09667018e2786361e_r.jpg"/></noscript><img src="https://pic3.zhimg.com/v2-f246c5eea2b844f09667018e2786361e_b.jpg" data-caption="" data-size="normal" data-rawwidth="747" data-rawheight="169" class="origin_image zh-lightbox-thumb lazy" width="747" data-original="https://pic3.zhimg.com/v2-f246c5eea2b844f09667018e2786361e_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-f246c5eea2b844f09667018e2786361e_b.jpg"/></figure><p>所以在SSRF等漏洞的测试中，我们不妨利用一下上述三个URL技巧，尝试绕过一些限制。</p><p>另外，SSRF测试中，即使目标没有连入IPv6网络，但本地系统、内网通常是支持IPv6的，所以不是说没有IPv6外网IP的目标就不能用IPv6的技巧进行测试。</p>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
