<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Hacking Cryptocurrency Miners with OSINT Techniques</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/30583233">原文</a></p>
<div class="title-image"><img src="https://pic2.zhimg.com/v2-c6a250d6772c007463945761564528a2_r.jpg" alt=""></div><p>注意：实验所用的方法可能会对网络产生一定的危害，带来的风险请自行承担。 </p><p>Open Source Intelligence（OSINT，开源情报），是在攻击之前收集信息的第一种技术之一。过去也有许多使用 OSINT 攻击的黑客案例。随着 IoT 设备的发展，我们可以在公共网络上收集大量重要信息。本文将以搜集加密货币挖掘设备——挖矿机（比特币 [蚂蚁矿机]和以太坊 [Claymore]）的敏感信息为例。 </p><p>许多挖矿机需要连网来发送或者接收数据，这为攻击者提供了可乘之机。 </p><h2><b>侦查蚂蚁矿机！ </b></h2><p>最好的比特币采矿设备是<a href="https://shop.bitmain.com/antminer_s9_asic_bitcoin_miner.htm?flag=overview">蚂蚁矿机 </a>S9 / S7，它的硬件使用了 “lighttpd / 1.4.32” 的 Web 服务器，其中一些开放了 SSH 端口。这儿有一个 “Lighttpd 1.4.31” 的 exploit 。但是，您无法使用此 exploit 攻击服务器。 </p><p>Web 服务器上的网页受 “ <a href="https://en.wikipedia.org/wiki/Digest_access_authentication">Digest HTTP Authentication （摘要认证）</a>” 的保护。至关重要的一点是矿机 需要用户名和密码来登录。 </p><img src="https://pic3.zhimg.com/v2-5e38d2aed8d8d87cc2ede8d761a65a9a_r.jpg" data-caption="使用摘要认证的蚂蚁矿机配置页面 " data-rawwidth="800" data-rawheight="251"><p>众所周知，使用 OSINT 收集数据需要一些信息或关键字。这里的关键字是在每次向服务器发送请求时出现在 HTTP 头中的 “antMiner Configuration”（蚂蚁矿机配置信息）。 </p><p>我用了下面的语法在 <a href="http://censys.io/">censys</a> 和 <a href="http://shodan.io/">shodan</a> 收集了一些IP地址。 </p><code lang="text">(antminer) AND protocols.raw: “80/http” AND 80.http.get.title: “401” </code><img src="https://pic2.zhimg.com/v2-40f508941ee186bf725cbf007614d430_r.jpg" data-caption="censys搜索语法 " data-rawwidth="800" data-rawheight="436"><p>该系统可以通过暴力破解 HTTP 端口或 SSH 端口来访问。 </p><p>首先，我需要一个用户指南来得到 HTTP 的默认用户名和密码。之后，我在 Google 上搜索 “antminer default password” （蚂蚁矿机默认密码），并发现了这个“用户指南”。 </p><img src="https://pic3.zhimg.com/v2-6dbf832f680a54fc129d2bd4c324b195_r.jpg" data-caption="AntMiner用户手册" data-rawwidth="800" data-rawheight="562"><p>对于本教程，我更喜欢使用 <a href="https://tools.kali.org/password-attacks/hydra">hydra</a> 来进行暴力破解（爆破HTTP摘要认证），它使用了<a href="https://github.com/danielmiessler/SecLists/tree/master/Passwords">最常用的10.000密码</a>。您也可以使用 <a href="https://portswigger.net/burp">Burp Suite</a> 的 Intruder 功能。 </p><p>下面是使用 hydra 的命令： </p><code lang="text">hydra -l root -P commonPasswords.txt -vV {TARGET} http-get / </code><p>如果你足够幸运，你就可以访问这个配置页面。 </p><img src="https://pic4.zhimg.com/v2-165b8a377f9171c8c0ac00292b440c5a_r.jpg" data-caption="antMiner配置页面 " data-rawwidth="769" data-rawheight="585"><p>攻击者可以任意编辑这个页面。 </p><h2><b>Claymore 采矿软件 </b></h2><p>另一种类型的攻击也是针对 <a href="https://github.com/nanopool/Claymore-Dual-Miner/releases">Claymore</a> 这个采矿软件（如 Altcoins，ethereum，zcash miner） </p><p>我使用了如下所示语法在 shodan 上搜索了一下： </p><code lang="text">Dorks: “ETH — Total Speed:” </code><img src="https://pic2.zhimg.com/v2-451dea9797c2418d1207dd1ae7848667_r.jpg" data-caption=" Dorks：“ETH - Total Speed：” " data-rawwidth="800" data-rawheight="368"><p>您可以通过 Claymore 远程管理  API 发送一些 JSON 数据包来管理采矿服务器。 </p><p>在这里，我们用一些命令控制 GPU 的使用模式（禁用，双模式等）或编辑 config.txt 来改变钱包池（pool wallet）的地址 </p><img src="https://pic1.zhimg.com/v2-49afe80f40aa78b986b5e0ef784f3feb_r.jpg" data-caption="Claymore远程管理器API.txt " data-rawwidth="800" data-rawheight="463"><p>我们将发送 “miner_restart” 或 “control_gpu” 命令来检测它是只读还是可写、可读的。我在MAC 系统上使用 NC 发送 JSON 命令。 </p><p>首先，我尝试 ” miner_getstat1” 这条指令 </p><img src="https://pic4.zhimg.com/v2-5a71f4b8a959ea730f0a4720c0e872dc_r.jpg" data-caption="此代码给出了采矿服务器的统计信息 " data-rawwidth="800" data-rawheight="217"><p>之后，我使用 ” control_gpu” 来探测它是只读还是可读、可写的 </p><p>我收到了一个错误代码 </p><img src="https://pic3.zhimg.com/v2-132db4ab092ebf963725e9e8892476c2_r.jpg" data-caption="miner服务器具有只读模式 " data-rawwidth="800" data-rawheight="656"><p>我通过不同的 IP 重启了系统，这表明 Claymore 的远程管理 API 允许读和写 </p><img src="https://pic1.zhimg.com/v2-73899e499741862cd5d8cbd21042c9a4_r.jpg" data-caption="重启采矿服务器 " data-rawwidth="800" data-rawheight="44"><p>Claymore 远程管理还允许您使用 JSON 格式（发送 json 文件）编辑配置文件。但是，您可以使用 Claymore’s Ethereum Dual Miner  管理工具在 Windows 上轻松编辑，这也可以更改钱包池的地址。 </p><p>miner 服务器具有只读模式 </p><img src="https://pic3.zhimg.com/v2-7e0fa6249f4171f347d4129bda5f5024_r.jpg" data-caption="如果您有读/写权限，可以编辑config.txt " data-rawwidth="800" data-rawheight="529"><img src="https://pic3.zhimg.com/v2-3e383fac6a3d38ab7c308b2240acf86d_r.jpg" data-caption="您可以查看或编辑池的pool’s wallet的地址 " data-rawwidth="800" data-rawheight="609"><h2><b>攻击设想 :) </b></h2><ul><li>我没有通过发送 JSON 命令在 Claymore  采矿软件上尝试命令注入。如果它有漏洞，您可以访问服务器而不需要具备有读写权限。 </li><li>您可以使用 OSINT 来改进搜索技巧从而收集大量数据。  </li><li>您甚至可以通过在编辑 config.txt 后控制风扇来损坏所有 GPU。</li></ul><p><br></p><p>参考：<a href="https://medium.com/@s3yfullah/hacking-cryptocurrency-miners-with-osint-techniques-677bbb3e0157">https://medium.com/@s3yfullah/hacking-cryptocurrency-miners-with-osint-techniques-677bbb3e0157</a></p>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
