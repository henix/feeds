<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:media="http://search.yahoo.com/mrss/">
<channel>
<title>【量化投资与机器学习】微信公众号</title>
<link>https://henix.github.io/feeds/zhuanlan.Lhtz-Jqxx/</link>
<description>在量化投资的道路上，你不是一个人在战斗！ 主要介绍关于量化投资和机器学习的知识和应用。通过研报，论坛，博客，程序等途径全面的为大家带来知识食粮。版块语言分为：Python、Matlab、R，涉及领域有：量化投资、机器学习、深度学习、综合应用、干货分享等。</description>
<language>zh-cn</language>
<lastBuildDate>Mon, 15 Apr 2019 23:47:44 +0800</lastBuildDate>
<item>
<title>​机器学习分类算法在因子投资中的应用</title>
<link>https://henix.github.io/feeds/zhuanlan.Lhtz-Jqxx/2019-04-14-62408392.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/62408392&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-ff075b369fda5aacc519479b10a055a5_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;▎编译：shan | 公众号翻译部&lt;/p&gt;&lt;p&gt;▎作者：Druce Vertes&lt;/p&gt;&lt;h2&gt;&lt;b&gt;第一部分：分类算法介绍&lt;/b&gt;&lt;/h2&gt;&lt;h3&gt;&lt;b&gt;什么是分类算法？&lt;/b&gt;&lt;/h3&gt;&lt;p&gt;回归预测了连续的值，比如一个资产的收益，而分类算法预测了一个离散的值，比如，这个股票下一段时间的表现是否比现在要好？这就是个二分问题，需要一个是或者否的答案，另一个例子：如果将一只股票的业绩区间分成四份，那么这支股票的下个月业绩会落在那块，这就是个多项分类问题，会得到4个可能的结果。在这篇文章中，我们将给分类问题进行高屋建瓴的解析，并在组合上应用分类算法预测收益。分类算法本身是深度学习的一种，最开始是用于手写识别或者图像识别，分类算法是机器学习中的基础算法，在它的基础上可以做出很多有意思的东西。&lt;/p&gt;&lt;p&gt;代码链接：&lt;/p&gt;&lt;p&gt;&lt;i&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/druce/Machine-learning-for-financial-market-prediction/blob/master/Classification%2520Mad%2520Science.ipynb&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;github.com/druce/Machin&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;e-learning-for-financial-market-prediction/blob/master/Classification%20Mad%20Science.ipynb&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/i&gt;&lt;/p&gt;&lt;h3&gt;&lt;b&gt;分类算法要素&lt;/b&gt;&lt;/h3&gt;&lt;p&gt;首先，我们在二维坐标上生成一些红色和蓝色的点，整个坐标系在0-100中间。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-2ecf6a083c5da0a92bc60a7a03f621d2_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1064&quot; data-rawheight=&quot;998&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1064&quot; data-original=&quot;https://pic3.zhimg.com/v2-2ecf6a083c5da0a92bc60a7a03f621d2_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-2ecf6a083c5da0a92bc60a7a03f621d2_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1064&quot; data-rawheight=&quot;998&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1064&quot; data-original=&quot;https://pic3.zhimg.com/v2-2ecf6a083c5da0a92bc60a7a03f621d2_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-2ecf6a083c5da0a92bc60a7a03f621d2_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;测试数据中：&lt;/p&gt;&lt;p&gt;2000个红色点以坐标（25,25）为中心，标准差为50，设置label=0；&lt;/p&gt;&lt;p&gt;2000个蓝色点以坐标（80,80）为中心，标准差为20，设置label=1。&lt;/p&gt;&lt;p&gt;我们希望寻找的一个函数，输入x和y就能得出是在红色区还是蓝色区，逻辑回归是一个简单且流行的分类算法。&lt;/p&gt;&lt;p&gt;我们展示一下如何应用逻辑回归。&lt;/p&gt;&lt;p&gt;1、首先我们设定z(x,y)=ax+by+c&lt;/p&gt;&lt;p&gt;2、然后我们用squashing激活函数把正数映射到1，负数映射到0&lt;/p&gt;&lt;p&gt;3、然后我们使用损失函数去度量预测误差，这个误差项应该在预测正确的时候趋近为0&lt;/p&gt;&lt;p&gt;4、最后我们算出参数a,b,c来最小化这个损失函数&lt;/p&gt;&lt;p&gt;如果我们能训练这个分类器，使其的误差趋近于0，那么我们就能得到一个函数能够尽量的匹配预测值和观察值。&lt;/p&gt;&lt;p&gt;我们通过使用梯度下降方法来降低误差，先随机选择参数值a，b和c，确定这些值的移动方向以使整个函数的误差缩小，然后更新a，b和c的值使最终的误差最小。&lt;/p&gt;&lt;p&gt;我们得到一个红点和蓝点的分类如下：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-328e931bb928ca3e888bea4ad1739e5f_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1046&quot; data-rawheight=&quot;990&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1046&quot; data-original=&quot;https://pic4.zhimg.com/v2-328e931bb928ca3e888bea4ad1739e5f_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-328e931bb928ca3e888bea4ad1739e5f_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1046&quot; data-rawheight=&quot;990&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1046&quot; data-original=&quot;https://pic4.zhimg.com/v2-328e931bb928ca3e888bea4ad1739e5f_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-328e931bb928ca3e888bea4ad1739e5f_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;让我们仔细看看隐藏在背后的这四个步骤。&lt;/p&gt;&lt;p&gt;决策函数Z(x,y): = ax + by + c与ax + by + c = 0的欧式距离成正比，它代表了到分类边界的距离。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-176faa97f2551d096c408d8b1e29aebc_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;1006&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-176faa97f2551d096c408d8b1e29aebc_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-176faa97f2551d096c408d8b1e29aebc_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;1006&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-176faa97f2551d096c408d8b1e29aebc_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-176faa97f2551d096c408d8b1e29aebc_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;Squashing函数&lt;/b&gt;：在逻辑回归里，squashing函数式逻辑回归函数为  这种类型的函数称作激活函数，函数形状很像’S’，因此用S(X)来表示，可以将负无穷到正无穷的数据映射到[0,1]区间之内，直观的解释是它将对数几率映射到了0-1之间。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-00213ef112d2b32b75c99a3032cfc580_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;719&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-00213ef112d2b32b75c99a3032cfc580_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-00213ef112d2b32b75c99a3032cfc580_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;719&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-00213ef112d2b32b75c99a3032cfc580_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-00213ef112d2b32b75c99a3032cfc580_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;损失函数：假设我们预测是蓝色点的概率为0.8，那么如何判断预测的准确性，对于二分分类问题来说，我们想要尽量缩小误差。V = - log(p)y - log(1-p)(1-y) 在这个式子中，y是我们的预测结果，p是我们预测为篮点区域的概率。&lt;/p&gt;&lt;p&gt;一个好的方法来可视化log loss是用-log(correctness)，如果我们确定预测是100%准确的，则log(loss)=0，如果我们的预测是100%错误的，则log(loss)将得到正无穷。&lt;/p&gt;&lt;p&gt;我们继续分解这个问题，我们的预测结果是0或者1，那么我们的预测的概率就在0和1 之间。如果我们的预测值是1（蓝色点），并且我们的预测准确率为p(假设为0.8)，那么V=-log(0.8). V = - log(p)y - log(1-p)(1-y) 等式的第二项为0因为1-y=0。当一个预测接近1时，log loss趋近于0，如果一个预测趋近于0时，log loss则非常大。相反，如果预测值为0（红色点区域），那么损失函数V = -log(1-p)，第一项为0因为y=0，如果我们的预测接近于0，那么log loss为0，如果预测趋近于1，那么log loss则非常大。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-bd501e7895f561f501f2fa4c71ddd623_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;735&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-bd501e7895f561f501f2fa4c71ddd623_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-bd501e7895f561f501f2fa4c71ddd623_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;735&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-bd501e7895f561f501f2fa4c71ddd623_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-bd501e7895f561f501f2fa4c71ddd623_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;在以上四步中，我们用以下方法来分解二分分类问题：&lt;/p&gt;&lt;p&gt;1、寻找到合适的参数a,b,c&lt;/p&gt;&lt;p&gt;2、最小化损失函数V(S(ax + by + c)) = J(a,b,c)…&lt;/p&gt;&lt;p&gt;3、训练所有的训练集&lt;/p&gt;&lt;p&gt;这些就是二分分类方法的要素：寻找一个函数和满足函数的参数（a,b和c），使其预测概率为1，并且最小化损失函数，我们可以借助计算机来实现它。&lt;/p&gt;&lt;h3&gt;&lt;b&gt;最后一点&lt;/b&gt;&lt;/h3&gt;&lt;p&gt;当预测概率超过一个概率阈值时，我们预测蓝色类。一般来说，我们不应该假设我们的决策边界必须在50%概率线上。在实际问题中，我们应该考虑假阳性与假阴性的成本。当我们提高概率阈值时，我们减少了误报的数量，增加了误报的数量。ROC曲线可以帮助我们可视化。我们想要选择一个决策边界阈值来最大化真实世界的性能，如果我们增加一个正预测的阈值，那么更少的假阳性的边际收益等于额外的假阴性的成本。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-9c216f93f898cc0420d22aff454ecb91_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;724&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-9c216f93f898cc0420d22aff454ecb91_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-9c216f93f898cc0420d22aff454ecb91_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;724&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-9c216f93f898cc0420d22aff454ecb91_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-9c216f93f898cc0420d22aff454ecb91_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;h3&gt;&lt;b&gt;分类算法Overview&lt;/b&gt;&lt;/h3&gt;&lt;p&gt;那么在如此多的分类算法中，我们如何找到试用的分类算法呢？&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-a80897b7a6a3b57e7102cca74cb2c3d9_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;986&quot; data-rawheight=&quot;1420&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;986&quot; data-original=&quot;https://pic2.zhimg.com/v2-a80897b7a6a3b57e7102cca74cb2c3d9_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-a80897b7a6a3b57e7102cca74cb2c3d9_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;986&quot; data-rawheight=&quot;1420&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;986&quot; data-original=&quot;https://pic2.zhimg.com/v2-a80897b7a6a3b57e7102cca74cb2c3d9_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-a80897b7a6a3b57e7102cca74cb2c3d9_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;那么应该明确的问题：&lt;/p&gt;&lt;p&gt;1、x和y符合什么分布。&lt;/p&gt;&lt;p&gt;2、决策边界的图形是什么样子的？是线性还是非线性。&lt;/p&gt;&lt;p&gt;3、确定损失函数，并且如何最小化损失函数，常用的损失函数有 均方根误差（mean-squared-error），交叉熵损失（cross-entropy loss），折页损失（hinge loss）等。&lt;/p&gt;&lt;p&gt;4、如何在过拟合和提升预测效果之间权衡。&lt;/p&gt;&lt;p&gt;5、最后，看下这个算法如何训练数据，如何根据x找到确定的y，这个算法的复杂度是多少，比如逻辑回归比较简单效率较高，而神经网络则需要较长的时间去训练数据，这个分类器是离散的还是连续的，连续的分类器试用任意的x和y。而离散的分类器是一个略完备的模型。逻辑回归用于离散变量的分类，即它的输出y的取值范围是一个离散的集合，因此是离散型分类器。&lt;/p&gt;&lt;p&gt;上图中的前五个分类器都是线性的，这些分类器预测的结果相近，只在前提条件，适用的分布，损失函数和如何缩小过拟合有些许不同。&lt;/p&gt;&lt;p&gt;其他分类器有的有非线性的决策边界：如Quadratic Discriminant Analysis, Multi-Layer Perceptron, Gaussian Naive Bayes, 和 Keras NN。剩下的分类器可能是分段线性的，如KNN, Trees, Bagging, Boosting，比如K近邻(KNN)算法是找到最近的k个邻居来进行分类的，而K是在交叉验证中得到的。应用Boosting模型最近在Kaggle机器学习大赛中获得了很多奖，它主要用的是集成学习的思路，即对新的实例进行分类的时候，把多个单分类器的结果进行某种组合，来对最终的结果进行分类。&lt;/p&gt;&lt;p&gt;下面简单介绍下其他的分类算法：&lt;/p&gt;&lt;p&gt;&lt;b&gt;决策树算法：&lt;/b&gt;决策树是一种简单但广泛使用的分类器，它通过训练数据构建决策树，对未知的数据进行分类。决策树的每个内部节点表示在一个属性上的测试，每个分枝代表该测试的一个输出，而每个树叶结点存放着一个类标号。&lt;/p&gt;&lt;p&gt;&lt;b&gt;Bagging算法：&lt;/b&gt;bootstrap aggregating的缩写。让该学习算法训练多轮，每轮的训练集由从初始的训练集中随机取出的n个训练倒组成，初始训练例在某轮训练集中可以出现多次或根本不出现训练之后可得到一个预测函数序列h．，… …h 最终的预测函数H对分类问题采用投票方式，对回归问题采用简单平均方法对新示例进行判别。&lt;/p&gt;&lt;p&gt;&lt;b&gt;决策森林：&lt;/b&gt;随机森林指通过多颗决策树联合组成的预测模型，可以对样本或者特征取bagging。&lt;/p&gt;&lt;p&gt;&lt;b&gt;Boosting算法：&lt;/b&gt;其中主要的是AdaBoost（Adaptive Boosting）。初始化时对每一个训练例赋相等的权重1／n，然后用该学算法对训练集训练t轮，每次训练后，对训练失败的训练例赋以较大的权重，也就是让学习算法在后续的学习中集中对比较难的训练铡进行学习，从而得到一个预测函数序列h 一…h其中h有一定的权重，预测效果好的预测函数权重较大，反之较小。最终的预测函数H对分类问题采用有权重的投票方式，对回归问题采用加权平均的方法对新示例进行判别。( 类似Bagging方法，但是训练是串行进行的，第k个分类器训练时关注对前k-1分类器中错分的文档，即不是随机取，而是加大取这些文档的概率)。&lt;/p&gt;&lt;p&gt;&lt;b&gt;集成算法：&lt;/b&gt;在运行了很多分类算法之后，我们可以选择最终的分类器模型。在上面的例子中，我们使用Voting Classifier模型，相比逻辑回归来说获得了85.9%的准确率和更好的AUC。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-abfef1c60310215a129162773f17bf2a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;1102&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-abfef1c60310215a129162773f17bf2a_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-abfef1c60310215a129162773f17bf2a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;1102&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-abfef1c60310215a129162773f17bf2a_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-abfef1c60310215a129162773f17bf2a_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;我们现在有了足够多的工具来对数据进行分类，收集和清洗以得到一个好的数据集，找到一个合适的模型就能解决80%的问题。&lt;/p&gt;&lt;p&gt;总结一下，在分类算法中，我们学到了&lt;/p&gt;&lt;p&gt;1、分类算法的基础&lt;/p&gt;&lt;p&gt;2、如何应用逻辑回归&lt;/p&gt;&lt;p&gt;3、不同分类算法的区别&lt;/p&gt;&lt;p&gt;4、如何组合分类算法以得到更好的结果&lt;/p&gt;&lt;p&gt;分类算法是机器学习算法的基础，很多机器学习问题的解决都始于分类算法，如语音识别、无人驾驶汽车等。在第二部分，我们将用分类算法建立一个价值投资和趋势投资的组合。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;第二部分：分类算法在投资的应用&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;下面我们将分析下分类算法在投资中的应用，我们先简述一些基础概念：&lt;/p&gt;&lt;h3&gt;&lt;b&gt;价值与动量&lt;/b&gt;&lt;/h3&gt;&lt;p&gt;价值投资策略核心是寻找高性价比的股票，通常我们使用PB(price/bookvalue)来衡量一个股票的性价比。我们将股票按照PB分成5个区间，逐月记录这五组股票的收益，这些是从1973到2017的结果。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-03a0c6a83441bf922203ee1f4b5ead02_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;772&quot; data-rawheight=&quot;912&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;772&quot; data-original=&quot;https://pic3.zhimg.com/v2-03a0c6a83441bf922203ee1f4b5ead02_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-03a0c6a83441bf922203ee1f4b5ead02_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;772&quot; data-rawheight=&quot;912&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;772&quot; data-original=&quot;https://pic3.zhimg.com/v2-03a0c6a83441bf922203ee1f4b5ead02_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-03a0c6a83441bf922203ee1f4b5ead02_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;从结果中我们可以得到，价值投资确实能赚钱。&lt;/p&gt;&lt;h3&gt;&lt;b&gt;趋势投资&lt;/b&gt;&lt;/h3&gt;&lt;p&gt;我们还可以用趋势策略，即挑选最近长势喜人的股票，这只股票可能最近有利好。利好可能包括：&lt;br/&gt;1、好的信息逐渐披露出来，比如公司前景喜人，开始可能只是内部人员了解，之后大众逐渐了解，利润增加，股票市场价格逐渐增长；&lt;/p&gt;&lt;p&gt;2、公司被低估，公司在招聘，市场，媒体上等各种表现超过大家预期，股价也会增长；&lt;/p&gt;&lt;p&gt;3、近期政策层利好等都会使股价近期提高；&lt;/p&gt;&lt;p&gt;趋势策略是市场形成的，那么如何用数据证明趋势策略有用，我们将股票按过去一年涨幅分成5个区间，走势图如下所示。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-1c03abcf793ed474c381afbce2dee4ae_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;768&quot; data-rawheight=&quot;918&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;768&quot; data-original=&quot;https://pic3.zhimg.com/v2-1c03abcf793ed474c381afbce2dee4ae_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-1c03abcf793ed474c381afbce2dee4ae_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;768&quot; data-rawheight=&quot;918&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;768&quot; data-original=&quot;https://pic3.zhimg.com/v2-1c03abcf793ed474c381afbce2dee4ae_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-1c03abcf793ed474c381afbce2dee4ae_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;价值策略和趋势策略相结合&lt;/b&gt;&lt;/p&gt;&lt;p&gt;为了给我们之后的分类算法一个比较的标准，我们按价值策略和趋势策略中的表现分别为每一只股票打分，把股票集合按分数进行排序形成组合，表现如下图：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-6722527c3c12676b00418c326e3f2f74_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;762&quot; data-rawheight=&quot;924&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;762&quot; data-original=&quot;https://pic1.zhimg.com/v2-6722527c3c12676b00418c326e3f2f74_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-6722527c3c12676b00418c326e3f2f74_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;762&quot; data-rawheight=&quot;924&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;762&quot; data-original=&quot;https://pic1.zhimg.com/v2-6722527c3c12676b00418c326e3f2f74_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-6722527c3c12676b00418c326e3f2f74_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;这样就给我们的模型一个比较的基准，这个组合的sharp ratio为0.47，让我们看看用机器学习的方式是不是能得到更好的结果。&lt;/p&gt;&lt;h3&gt;&lt;b&gt;分类算法是否有效&lt;/b&gt;&lt;/h3&gt;&lt;p&gt;首先，我们用个非常简单的分类方式，将股票按value/momentum的比值进行分类，对最好的那一类进行投资。对投资的组合每个月进行rebalance。&lt;/p&gt;&lt;p&gt;另外一个稍微复杂的方法，用逻辑回归进行预测，看看那只股票会在最好的投资区间，然后对最好的那一类进行投资。预测银子选择(P/B)和趋势因子，我们选择3个月的收益来看整个结果，以防止某个月的收益有扰动。&lt;/p&gt;&lt;p&gt;但是我们看到结果并不好，这个结果和我们最开始的基准差不太多，那么到底是什么原因？我们怎么才能得到更好的结果。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-87651d44730d427b1572c285bcf4545b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;778&quot; data-rawheight=&quot;916&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;778&quot; data-original=&quot;https://pic4.zhimg.com/v2-87651d44730d427b1572c285bcf4545b_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-87651d44730d427b1572c285bcf4545b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;778&quot; data-rawheight=&quot;916&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;778&quot; data-original=&quot;https://pic4.zhimg.com/v2-87651d44730d427b1572c285bcf4545b_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-87651d44730d427b1572c285bcf4545b_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;我们可以看到在这个逻辑回归中，随时函数用的是log loss损失函数，但是log loss损失函数把所有损失看成相同的。比如如果在第五区间的预测结果落到了第一区间，其实它的error是远比落在第四区间要大的多的。&lt;/p&gt;&lt;p&gt;另外一个问题是，如果我们得到一只股票在五个区间的概率0.30, 0.09, 0.11, 0.21, 0.29，第零区间和第四区间只有1%的差距，那么我们是否能确定落在第一区间呢？那么如果我们每次都把股票分到概率最高的区间可能会导致预测不准。我们把预测的结果画图，发现大部分都是落在表现最不好的两个区间内的。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-436eeb45e22dbe808a9eb0d5052adbb1_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;812&quot; data-rawheight=&quot;520&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;812&quot; data-original=&quot;https://pic2.zhimg.com/v2-436eeb45e22dbe808a9eb0d5052adbb1_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-436eeb45e22dbe808a9eb0d5052adbb1_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;812&quot; data-rawheight=&quot;520&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;812&quot; data-original=&quot;https://pic2.zhimg.com/v2-436eeb45e22dbe808a9eb0d5052adbb1_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-436eeb45e22dbe808a9eb0d5052adbb1_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;h3&gt;&lt;b&gt; 可以确定分类吗？&lt;/b&gt;&lt;/h3&gt;&lt;p&gt;0.30 x 0 + 0.09 x 1 + 0.11 x 2 + 0.21 x 3 + 0.29 x 4 = 2.1&lt;/p&gt;&lt;p&gt;为了使分类更有效，我将预测结果做了个加权平均，因此本来分给第零个区间的，被分给了第二个区间，用这个方式优化后，我们的结果为：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-c658d3890ecd6f54d8864abcc9afe558_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;788&quot; data-rawheight=&quot;924&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;788&quot; data-original=&quot;https://pic1.zhimg.com/v2-c658d3890ecd6f54d8864abcc9afe558_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-c658d3890ecd6f54d8864abcc9afe558_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;788&quot; data-rawheight=&quot;924&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;788&quot; data-original=&quot;https://pic1.zhimg.com/v2-c658d3890ecd6f54d8864abcc9afe558_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-c658d3890ecd6f54d8864abcc9afe558_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;好消息是我们的结果连续性更好了，并且收益和sharp ratio都有提高；坏消息是我们最好的区间sharp ratio为0.46，比最早做的逻辑回归还稍微差一点。&lt;/p&gt;&lt;p&gt;现实是残酷的，这可能是因为我们在最好的区间放了20%的股票，之前的逻辑回归，我们选了更少的股票，优中选优从而得到了更好的结果。&lt;/p&gt;&lt;h3&gt;&lt;b&gt;优化分类算法&lt;/b&gt;&lt;/h3&gt;&lt;p&gt;所以我们应该是选择对了方向，但是是否可以用更好的分类器来解决这个问题呢？&lt;/p&gt;&lt;p&gt;Gradient boosting models 是非常好的分类算法，我们可以尝试XGBoost分类算法来判别哪些股票会落入最好的投资区间。&lt;/p&gt;&lt;p&gt;结果如下：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-716b43334efc7de39efbc1d72468d917_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;760&quot; data-rawheight=&quot;908&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;760&quot; data-original=&quot;https://pic4.zhimg.com/v2-716b43334efc7de39efbc1d72468d917_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-716b43334efc7de39efbc1d72468d917_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;760&quot; data-rawheight=&quot;908&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;760&quot; data-original=&quot;https://pic4.zhimg.com/v2-716b43334efc7de39efbc1d72468d917_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-716b43334efc7de39efbc1d72468d917_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;分类是否是个好选择？&lt;/b&gt;&lt;/p&gt;&lt;p&gt;XGBoost分类算法得到的结果非常好，下面说下这个方法的缺点：&lt;/p&gt;&lt;p&gt;1、用三个1月的return要比一个月的return结果更平滑，降低过拟合，但是可能丢失了部分信息；&lt;/p&gt;&lt;p&gt;2、用log loss作为评价函数，容易使差不多概率的分类出错，如最好的区间概率0.3，最差区间概率0.29这种情况；&lt;/p&gt;&lt;p&gt;但是我们也有使用分类的理由：组合构建类似分类问题，选股票就是在做分类。但是我不建议直接应用分类算法，分类算法在预测收益和是否有default风险上很好用，在组合构建上也许有更好的方式。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;结论&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;我们学到了什么：&lt;/p&gt;&lt;p&gt;1、单独的价值策略或者趋势策略结果不错；&lt;/p&gt;&lt;p&gt;2、单纯的使用分类算法并不能得到好的收益；&lt;/p&gt;&lt;p&gt;3、Gradient boosting 分类算法能显著的提高结果；&lt;/p&gt;&lt;p&gt;4、直接进行逻辑回归也许是个更好的解决方法。&lt;/p&gt;&lt;p&gt;&lt;i&gt;—End—&lt;/i&gt;&lt;/p&gt;&lt;p&gt;量化投资与机器学习微信公众号，是业内垂直于&lt;b&gt;Quant&lt;/b&gt;、&lt;b&gt;MFE&lt;/b&gt;、&lt;b&gt;CST&lt;/b&gt;等专业的主流自媒体。公众号拥有来自&lt;b&gt;公募、私募、券商、银行、海外&lt;/b&gt;等众多圈内&lt;b&gt;10W+&lt;/b&gt;关注者。每日发布行业前沿研究成果和最新资讯。&lt;/p&gt;</description>
<author>量化投资机器学习</author>
<guid isPermaLink="false">2019-04-14-62408392</guid>
<pubDate>Sun, 14 Apr 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>独家 | 定制股票交易OpenAI Gym强化学习环境（附代码）</title>
<link>https://henix.github.io/feeds/zhuanlan.Lhtz-Jqxx/2019-04-14-62408172.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/62408172&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-61c8d4db7605b80d08f42959b31d99fc_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;▎作者：Adam King&lt;/p&gt;&lt;p&gt;&lt;b&gt;▎&lt;/b&gt;编译：公众号翻译部&lt;/p&gt;&lt;h2&gt;&lt;b&gt;前言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;OpenAI&lt;/b&gt; 的 gym 是一个很棒的软件包，允许你创建自定义强化学习agents。它提供了相当多的预构建环境，如CartPole、MountainCar，以及大量免费的Atari游戏供用户体验。&lt;/p&gt;&lt;p&gt;这些环境非常适合学习，但最终你将需要设置一个agent来解决自定义问题。为此，你需要创建一个关于你特定问题域的自定义环境。之后，我们将创建一个自定义股票市场环境来模拟股票交易。&lt;/p&gt;&lt;blockquote&gt;&lt;b&gt;代码在文末获取&lt;/b&gt;&lt;/blockquote&gt;&lt;p&gt;首先，让我们了解一下环境到底是什么。环境包含运行agent并允许其学习的所有必要功能。每个环境必须实现下gym界面：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-727b4021e0916b9fb99799e62b24bb17_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1058&quot; data-rawheight=&quot;1054&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1058&quot; data-original=&quot;https://pic4.zhimg.com/v2-727b4021e0916b9fb99799e62b24bb17_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-727b4021e0916b9fb99799e62b24bb17_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1058&quot; data-rawheight=&quot;1054&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1058&quot; data-original=&quot;https://pic4.zhimg.com/v2-727b4021e0916b9fb99799e62b24bb17_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-727b4021e0916b9fb99799e62b24bb17_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;在构造函数中，我们首先定义 action_space 的类型和大小，它将包含agent在环境中可能采取的所有操作。类似地，我们将定义 observation_space，它包含agent要观察的所有环境数据。&lt;/p&gt;&lt;p&gt;我们的重置方法将被调用，以周期性地将环境重置为初始状态。在此之后，将在环境中执行许多步骤，其中模型将提供一个操作，并且必须执行该操作，然后返回下一个观察结果。这也是计算奖励的地方，稍后会详细介绍。&lt;/p&gt;&lt;p&gt;最后，可以定期调用render方法来打印再现的环境。这可以像打印语句一样简单，也可以像使用openGL渲染3D环境一样复杂。对于本例，我们将坚持使用print语句。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;股票交易环境&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;我们将创建一个股票交易环境。然后，我们将训练agent成为一个有利可图的贸易环境。&lt;/p&gt;&lt;p&gt;我们需要考虑的第一件事是人工交易者如何感知他们所处的环境。&lt;b&gt;在决定交易之前，他们会观察到什么?&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;交易员很可能会看一些股票价格走势的图表，或许还会加上一些技术指标。在此基础上，他们将把这些视觉信息与他们之前对类似价格走势的了解相结合，从而对股票可能的走势做出明智的决定。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;所以让我们把这转换成我们的agent应该如何感知它的环境。&lt;/p&gt;&lt;p&gt;observation_space包含我们希望agent在进行交易之前或不进行交易之前考虑的所有输入变量。在本例中，我们希望agent查看过去五天股票的数据（开、高、低、收和日成交量），以及其他一些数据，如帐户余额、当前股票头寸和当前利润。&lt;/p&gt;&lt;p&gt;这里的直觉是，对于每个时间步骤，我们希望我们的agent考虑导致当前价格价格变动的行为，以及它们自己的投资组合的状态，以便为下一步行动做出明智的决策。&lt;/p&gt;&lt;p&gt;一旦交易者感知到了他们所处的环境，他们就需要采取行动。在我们的agent例子中，它的action_space将包含三种可能性：&lt;b&gt;买进股票、卖出股票或什么都不做&lt;/b&gt;。&lt;/p&gt;&lt;p&gt;但这还不，我们需要知道每次买入或卖出的股票数量。使用gym的Box space，我们可以创建一个动作空间，其中包含离散数量的动作类型（买进、卖出和持有），以及连续的买进/卖出金额（分别为：账户余额/头寸大小的0-100%）。&lt;/p&gt;&lt;p&gt;你将注意到这个金额对于hold操作是不必要的，但是无论如何都会提供。我们的agent最初并不知道这一点，但随着时间的推移，应该会知道这个金额与此操作无关。&lt;/p&gt;&lt;p&gt;在实现我们的环境之前，最后要考虑的是激励。我们想激励长期持续的利润。在每个步骤，我们将把激励设置为账户余额乘以到目前为止的时间步数的一部分。&lt;/p&gt;&lt;p&gt;&lt;b&gt;这样做的目的是在早期阶段推迟对agent的过快奖励，并允许它在过于深入地优化单个策略之前进行充分的探索。它还将奖励那些长期维持较高平衡的agent，而不是那些使用不可持续策略快速赚钱的agent。&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;实现&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;现在我们已经定义了我们的观察空间、行动空间和激励，是时候实现我们的环境了。首先，我们需要在环境的构造函数中定义action_space和observation_space。环境期望传入一个pandas的dataframe，其中包含要学习的股票数据。类似这样的数据格式：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-32a9416aa6bb4f0c140c2ad167ed876b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;438&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-32a9416aa6bb4f0c140c2ad167ed876b_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-32a9416aa6bb4f0c140c2ad167ed876b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;438&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-32a9416aa6bb4f0c140c2ad167ed876b_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-32a9416aa6bb4f0c140c2ad167ed876b_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-466153cb451005ffa6e210cc212e1720_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;449&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-466153cb451005ffa6e210cc212e1720_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-466153cb451005ffa6e210cc212e1720_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;449&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-466153cb451005ffa6e210cc212e1720_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-466153cb451005ffa6e210cc212e1720_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;接下来，我们将编写reset方法，在创建新环境或重置现有环境的状态时调用该方法。在这里，我们将设置每个agent的初始余额，并将其打开位置初始化为空列表。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-e275e5e66988b571f772a2bb82f53adb_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;421&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-e275e5e66988b571f772a2bb82f53adb_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-e275e5e66988b571f772a2bb82f53adb_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;421&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-e275e5e66988b571f772a2bb82f53adb_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-e275e5e66988b571f772a2bb82f53adb_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;我们将当前步骤设置为dataframe中的一个随机点，因为我们的许多agent经常在训练中重置环境。nextObservation方法编译最后五个时间步骤的股票数据，附加agent的帐户信息，并将所有值缩放到0到1之间。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-6e3dddc20c37427be73fc8ad3fc60aa9_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;716&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-6e3dddc20c37427be73fc8ad3fc60aa9_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-6e3dddc20c37427be73fc8ad3fc60aa9_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;716&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-6e3dddc20c37427be73fc8ad3fc60aa9_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-6e3dddc20c37427be73fc8ad3fc60aa9_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;接下来，我们的环境需要能够迈出一步。在每一步，我们将采取指定的行动（由我们的模型选择），计算激励，并返回下一个观察结果。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-e638cd2ce8a7781d070b8bf678e91f91_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;446&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-e638cd2ce8a7781d070b8bf678e91f91_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-e638cd2ce8a7781d070b8bf678e91f91_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;446&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-e638cd2ce8a7781d070b8bf678e91f91_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-e638cd2ce8a7781d070b8bf678e91f91_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;现在，我们的_takeAction方法需要执行模型提供的操作，并购买、出售或持有股票。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-8884248261fe1094439486ff019a22a1_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;986&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-8884248261fe1094439486ff019a22a1_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-8884248261fe1094439486ff019a22a1_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;986&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-8884248261fe1094439486ff019a22a1_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-8884248261fe1094439486ff019a22a1_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;现在唯一要做的就是将环境呈现到屏幕上。为了简单起见，我们将呈现到目前为止的利润和一些其他有趣的指标。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-121d71ae5917a1c4f6afc1a22994f97d_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;484&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-121d71ae5917a1c4f6afc1a22994f97d_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-121d71ae5917a1c4f6afc1a22994f97d_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;484&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-121d71ae5917a1c4f6afc1a22994f97d_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-121d71ae5917a1c4f6afc1a22994f97d_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;我们的环境是完整的。现在，我们可以使用dataframe实例化StockTradingEnv环境，并使用来自stable-baselines的模型对其进行测试。&lt;/p&gt;&lt;p&gt;&lt;i&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/hill-a/stable-baselines&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;github.com/hill-a/stabl&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;e-baselines&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/i&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-150ff0bb293e1a2e22cf77f0cc9f720b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;737&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-150ff0bb293e1a2e22cf77f0cc9f720b_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-150ff0bb293e1a2e22cf77f0cc9f720b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;737&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-150ff0bb293e1a2e22cf77f0cc9f720b_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-150ff0bb293e1a2e22cf77f0cc9f720b_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-9fd4013033a9e0276d724298096c648b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;708&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-9fd4013033a9e0276d724298096c648b_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-9fd4013033a9e0276d724298096c648b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;708&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-9fd4013033a9e0276d724298096c648b_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-9fd4013033a9e0276d724298096c648b_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;当然，我们先做了个简单的测试，如果真的想通过使用深度学习对股市进行应用，那将需要更多的时间和精力。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;推荐阅读&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289074%26idx%3D1%26sn%3De859d363eef9249236244466a1af41b6%26chksm%3D802e3867b759b1717f77e07a51ee5671e8115130c66562577280ba1243cba08218add04f1f00%26token%3D449379994%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;01、经过多年交易之后你应该学到的东西（深度分享）&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289050%26idx%3D1%26sn%3D60043a5c95b877dd329a5fd150ddacc4%26chksm%3D802e384fb759b1598e500087374772059aa21b31ae104b3dca04331cf4b63a233c5e04c1945a%26token%3D449379994%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;02、监督学习标签在股市中的应用（代码+书籍）&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289018%26idx%3D1%26sn%3D8c411f676c2c0d92b0dd218f041bee4b%26chksm%3D802e382fb759b139ffebf633ac14cdd0f21938e4613fe632d5d9231dab3d2aca95a11628378a%26token%3D449379994%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;03、全球投行顶尖机器学习团队全面分析&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289014%26idx%3D1%26sn%3D3762d405e332c599a21b48a7dc4df587%26chksm%3D802e3823b759b135928d55044c2729aea9690f86752b680eb973d1a376dc53cfa18287d0060b%26token%3D449379994%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;04、使用Tensorflow预测股票市场变动&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289238%26idx%3D1%26sn%3D3144f5792f84455dd53c27a78e8a316c%26chksm%3D802e3903b759b015da88acde4fcbc8547ab3e6acbb5a0897404bbefe1d8a414265d5d5766ee4%26token%3D2020206794%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;05、使用LSTM预测股票市场基于Tensorflow&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289314%26idx%3D1%26sn%3D87c5a12b23a875966db7be50d11f09cd%26chksm%3D802e3977b759b061675d1988168c1fec06c602e8583fbcc9b76f87008e0c10b702acc85467a0%26token%3D1972390229%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;06、美丽的回测——教你定量计算过拟合概率&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289347%26idx%3D1%26sn%3Dbf5d7899bc4a854d4ba9046fdc6fe0d6%26chksm%3D802e3996b759b080287213840987bb0a0c02e4e1d4d7aae23f10a225a92ef6dd922d8006123d%26token%3D290397496%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;07、利用动态深度学习预测金融时间序列基于Python&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289394%26idx%3D1%26sn%3D24a836136d730aa268605628e683d629%26chksm%3D802e39a7b759b0b1dcf7aaa560699130a907716b71fc9c45ff0e5d236c5ae8ef80ebdb09dbb6%26token%3D290397496%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;08、Facebook开源神器Prophet预测时间序列基于Python&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289437%26idx%3D1%26sn%3Df0dca7da8e69e7ba736992cb3d034ce7%26chksm%3D802e39c8b759b0de5bce401c580623d0729ecca69d13926479d36e19aff8c9c9e8a20265afff%26token%3D290397496%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;09、Facebook开源神器Prophet预测股市行情基于Python&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289358%26idx%3D1%26sn%3Ddb6e8ab85b08f6e67790ec0e401e586e%26chksm%3D802e399bb759b08d6eec855f9901ea856d0da68c7425cba62791b8948da6ad761a3d88543dad%26token%3D290397496%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;10、2018第三季度最受欢迎的券商金工研报前50（附下载）&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289447%26idx%3D1%26sn%3Df2948715bf82569a6556d518e56c1f9e%26chksm%3D802e39f2b759b0e4502d1aaac562b87789573b55c76b3c85897d8c9d88dbf9a0b7ee34d86a4e%26token%3D290397496%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;11、实战交易策略的精髓（公众号深度呈现）&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289478%26idx%3D1%26sn%3Df8e01a641be021993d8ef2d84e94a299%26chksm%3D802e3e13b759b7055cf27a280c672371008a5564c97c658eee89ce8481396a28d254836ff9af%26token%3D290397496%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;12、Markowitz有效边界和投资组合优化基于Python&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289495%26idx%3D1%26sn%3Dc4eeaa2e9f9c10995be9ea0c56d29ba7%26chksm%3D802e3e02b759b7148227675c23c403fb9a543b733e3d27fa237b53840e030bf387a473d83e3c%26token%3D1260956004%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;13、使用LSTM模型预测股价基于Keras&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289507%26idx%3D1%26sn%3Df0ca71aa07531bbbdbd33213f0bab89f%26chksm%3D802e3e36b759b720138b3b17a4dd0e198e054b9de29a038fdd50805f824effa55831111ad026%26token%3D1936245282%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;14、量化金融导论1：资产收益的程式化介绍基于Python&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289533%26idx%3D1%26sn%3D4ef964834e84a9995111bb057b0fc5dd%26chksm%3D802e3e28b759b73e0618eb1262c53aa0601fbf5805525a7c7ff40dc3db62c7704496611bdbf1%26token%3D1950551577%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;15、预测股市崩盘基于统计机器学习与神经网络（Python+文档）&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289609%26idx%3D1%26sn%3Dc7f0b3e47025862d10bb53b6ab88bcda%26chksm%3D802e3e9cb759b78abf6b8b049c59bf18ccfb2ead7580d1f557d36de2292f59dcbd94dcd41910%26token%3D2085008037%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;16、实现最优投资组合有效前沿基于Python（附代码）&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289615%26idx%3D1%26sn%3D1cdc89afb997d0c580bf0cef296d946c%26chksm%3D802e3e9ab759b78ce9f0cd152a680d4a413d6c8dcb02a7a296f4091993a7e4137e7520394575%26token%3D2085008037%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;17、精心为大家整理了一些超级棒的机器学习资料（附链接）&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289623%26idx%3D1%26sn%3D28a3600fd7a72d7be00b066ca0f98244%26chksm%3D802e3e82b759b7943f43a4f6ef4a91e4153fa6b8210de9590235fa8ee66eb9811ce177054dbc%26token%3D1389401983%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;18、海量Wind数据，与全网用户零距离邂逅！&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289640%26idx%3D1%26sn%3D34e94fcbe99052b8e7381ecc48a36dc0%26chksm%3D802e3ebdb759b7ab897cd329a680715b6f8294e63550ddf0c57b9e1320b2b7d1408c6fdca0c7%26token%3D1389401983%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;19、机器学习、深度学习、量化金融、Python等最新书籍汇总下载&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289725%26idx%3D1%26sn%3D4b65cd1fb8331438e4c0b3d0eae6b51f%26chksm%3D802e3ee8b759b7fe1b94e84d54cc23b0ab05853d5cd227812574b350e9fc2cce9e5f1bc6cb7a%26token%3D1389401983%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;20、各大卖方2019年A股策略报告，都是有故事的人！&lt;/a&gt;&lt;/p&gt;&lt;h3&gt;&lt;b&gt;如何获取代码&lt;/b&gt;&lt;/h3&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s/_A0q8DFAsIclaofVgZfjMA&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic3.zhimg.com/v2-b27bd1b689d0289f1dff01388574ae46_180x120.jpg&quot; data-image-width=&quot;1280&quot; data-image-height=&quot;544&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;独家 | 定制股票交易OpenAI Gym强化学习环境（附代码）&lt;/a&gt;&lt;p&gt;&lt;i&gt;—End—&lt;/i&gt;&lt;/p&gt;&lt;p&gt;量化投资与机器学习微信公众号，是业内垂直于&lt;b&gt;Quant&lt;/b&gt;、&lt;b&gt;MFE&lt;/b&gt;、&lt;b&gt;CST&lt;/b&gt;等专业的主流自媒体。公众号拥有来自&lt;b&gt;公募、私募、券商、银行、海外&lt;/b&gt;等众多圈内&lt;b&gt;10W+&lt;/b&gt;关注者。每日发布行业前沿研究成果和最新资讯。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>量化投资机器学习</author>
<guid isPermaLink="false">2019-04-14-62408172</guid>
<pubDate>Sun, 14 Apr 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>超级干货 | ML、DL预测股市模型汇总（史上最全，没有之一）</title>
<link>https://henix.github.io/feeds/zhuanlan.Lhtz-Jqxx/2019-04-14-62407696.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/62407696&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-b84c7b82eeb0a5ee32cac2628d2eb3d3_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;前言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;今天给大家分享一个超级干货：机器学习、深度学习预测股票的所有模型大汇总。&lt;/p&gt;&lt;p&gt;全程代码分享！！！！！！！！！！！&lt;/p&gt;&lt;blockquote&gt;&lt;b&gt;代码在文末获取&lt;/b&gt;&lt;/blockquote&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-b3998cebc88e7e49e7590fc9a486027c_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;406&quot; data-rawheight=&quot;442&quot; class=&quot;content_image&quot; width=&quot;406&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-b3998cebc88e7e49e7590fc9a486027c_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;406&quot; data-rawheight=&quot;442&quot; class=&quot;content_image lazy&quot; width=&quot;406&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-b3998cebc88e7e49e7590fc9a486027c_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;h2&gt;&lt;b&gt;Stacking models&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;1、Deep Feed-forward Auto-Encoder Neural Network to reduce dimension + Deep Recurrent Neural Network + ARIMA + Extreme Boosting Gradient Regressor&lt;/p&gt;&lt;p&gt;2、Adaboost + Bagging + Extra Trees + Gradient Boosting + Random Forest + XGB&lt;/p&gt;&lt;h2&gt;&lt;b&gt;Deep-learning models&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;1、LSTM Recurrent Neural Network&lt;/p&gt;&lt;p&gt;2、ncoder-Decoder Feed-forward + LSTM Recurrent Neural Network&lt;/p&gt;&lt;p&gt;3、LSTM Bidirectional Neural Network&lt;/p&gt;&lt;p&gt;4、2-Path LSTM Recurrent Neural Network&lt;/p&gt;&lt;p&gt;5、GRU Recurrent Neural Network&lt;/p&gt;&lt;p&gt;6、Encoder-Decoder Feed-forward + GRU Recurrent Neural Network&lt;/p&gt;&lt;p&gt;7、GRU Bidirectional Neural Network&lt;/p&gt;&lt;p&gt;8、2-Path GRU Recurrent Neural Network&lt;/p&gt;&lt;p&gt;9、Vanilla Recurrent Neural Network&lt;/p&gt;&lt;p&gt;10、Encoder-Decoder Feed-forward + Vanilla Recurrent Neural Network&lt;/p&gt;&lt;p&gt;11、Vanilla Bidirectional Neural Network&lt;/p&gt;&lt;p&gt;12、2-Path Vanilla Recurrent Neural Network&lt;/p&gt;&lt;p&gt;13、LSTM Sequence-to-Sequence Recurrent Neural Network&lt;/p&gt;&lt;p&gt;14、LSTM with Attention Recurrent Neural Network&lt;/p&gt;&lt;p&gt;15、LSTM Sequence-to-Sequence with Attention Recurrent Neural Network&lt;/p&gt;&lt;p&gt;16、LSTM Sequence-to-Sequence Bidirectional Recurrent Neural Network&lt;/p&gt;&lt;p&gt;17、LSTM Sequence-to-Sequence with Attention Bidirectional Recurrent Neural Network&lt;/p&gt;&lt;p&gt;18、LSTM with Attention Scaled-Dot Recurrent Neural Network&lt;/p&gt;&lt;p&gt;19、LSTM with Dilated Recurrent Neural Network&lt;/p&gt;&lt;p&gt;20、Only Attention Neural Network&lt;/p&gt;&lt;p&gt;21、Multihead Attention Neural Network&lt;/p&gt;&lt;p&gt;22、LSTM with Bahdanau Attention&lt;/p&gt;&lt;p&gt;23、LSTM with Luong Attention&lt;/p&gt;&lt;p&gt;24、LSTM with Bahdanau + Luong Attention&lt;/p&gt;&lt;p&gt;25、DNC Recurrent Neural Network&lt;/p&gt;&lt;p&gt;26、Residual LSTM Recurrent Neural Network&lt;/p&gt;&lt;p&gt;27、Byte-net&lt;/p&gt;&lt;p&gt;28、Attention is all you need&lt;/p&gt;&lt;p&gt;29、Fairseq&lt;/p&gt;&lt;h2&gt;&lt;b&gt;Agents&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;1、Turtle-trading agent&lt;/p&gt;&lt;p&gt;2、Moving-average agent&lt;/p&gt;&lt;p&gt;3、Signal rolling agent&lt;/p&gt;&lt;p&gt;4、Policy-gradient agent&lt;/p&gt;&lt;p&gt;5、Q-learning agent&lt;/p&gt;&lt;p&gt;6、Evolution-strategy agent&lt;/p&gt;&lt;p&gt;7、Double Q-learning agent&lt;/p&gt;&lt;p&gt;8、Recurrent Q-learning agent&lt;/p&gt;&lt;p&gt;9、Double Recurrent Q-learning agent&lt;/p&gt;&lt;p&gt;10、Duel Q-learning agent&lt;/p&gt;&lt;p&gt;11、Double Duel Q-learning agent&lt;/p&gt;&lt;p&gt;12、Duel Recurrent Q-learning agent&lt;/p&gt;&lt;p&gt;13、Double Duel Recurrent Q-learning agent&lt;/p&gt;&lt;p&gt;14、Actor-critic agent&lt;/p&gt;&lt;p&gt;15、Actor-critic Duel agent&lt;/p&gt;&lt;p&gt;16、Actor-critic Recurrent agent&lt;/p&gt;&lt;p&gt;17、Actor-critic Duel Recurrent agent&lt;/p&gt;&lt;p&gt;18、Curiosity Q-learning agent&lt;/p&gt;&lt;p&gt;19、Recurrent Curiosity Q-learning agent&lt;/p&gt;&lt;p&gt;20、Duel Curiosity Q-learning agent&lt;/p&gt;&lt;p&gt;21、Neuro-evolution agent&lt;/p&gt;&lt;p&gt;22、Neuro-evolution with Novelty search agent&lt;/p&gt;&lt;p&gt;23、ABCD strategy agent&lt;/p&gt;&lt;h2&gt;&lt;b&gt;Data Explorations&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;1、stock market study on TESLA stock&lt;/p&gt;&lt;p&gt;2、fashion trending prediction with cross-validatio&lt;/p&gt;&lt;p&gt;3、Bitcoin analysis with LSTM predictionOutliers study using K-means, SVM, and Gaussian on TESLA stock &lt;/p&gt;&lt;p&gt;4、Kijang Emas Bank Negara&lt;/p&gt;&lt;h2&gt;&lt;b&gt;Simulations&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;1、Stock market simulation using Monte Carlo&lt;br/&gt;2、Stock market simulation using Monte Carlo Markov Chain Metropolis-Hasting&lt;/p&gt;&lt;h2&gt;&lt;b&gt;Tensorflow-js&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;LSTM Recurrent Neural Network and Simple signal rolling agent inside &lt;br/&gt;&lt;/p&gt;&lt;h3&gt;&lt;b&gt;部分结果展示&lt;/b&gt;&lt;/h3&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-2af5dfe40f39cd0bd4d4d89a27e8305b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;894&quot; data-rawheight=&quot;321&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;894&quot; data-original=&quot;https://pic4.zhimg.com/v2-2af5dfe40f39cd0bd4d4d89a27e8305b_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-2af5dfe40f39cd0bd4d4d89a27e8305b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;894&quot; data-rawheight=&quot;321&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;894&quot; data-original=&quot;https://pic4.zhimg.com/v2-2af5dfe40f39cd0bd4d4d89a27e8305b_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-2af5dfe40f39cd0bd4d4d89a27e8305b_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-fc98ed83694eafe63fc7a965191bb3c8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;540&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-fc98ed83694eafe63fc7a965191bb3c8_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-fc98ed83694eafe63fc7a965191bb3c8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;540&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-fc98ed83694eafe63fc7a965191bb3c8_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-fc98ed83694eafe63fc7a965191bb3c8_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-729ba4b666b45167892e1c2e31d14c2b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;883&quot; data-rawheight=&quot;582&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;883&quot; data-original=&quot;https://pic4.zhimg.com/v2-729ba4b666b45167892e1c2e31d14c2b_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-729ba4b666b45167892e1c2e31d14c2b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;883&quot; data-rawheight=&quot;582&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;883&quot; data-original=&quot;https://pic4.zhimg.com/v2-729ba4b666b45167892e1c2e31d14c2b_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-729ba4b666b45167892e1c2e31d14c2b_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-d1fe0c625db9bcbe47bddae1b47ae09c_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;883&quot; data-rawheight=&quot;582&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;883&quot; data-original=&quot;https://pic1.zhimg.com/v2-d1fe0c625db9bcbe47bddae1b47ae09c_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-d1fe0c625db9bcbe47bddae1b47ae09c_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;883&quot; data-rawheight=&quot;582&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;883&quot; data-original=&quot;https://pic1.zhimg.com/v2-d1fe0c625db9bcbe47bddae1b47ae09c_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-d1fe0c625db9bcbe47bddae1b47ae09c_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-d5501deea27d4517abc297dc099963c8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;883&quot; data-rawheight=&quot;373&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;883&quot; data-original=&quot;https://pic1.zhimg.com/v2-d5501deea27d4517abc297dc099963c8_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-d5501deea27d4517abc297dc099963c8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;883&quot; data-rawheight=&quot;373&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;883&quot; data-original=&quot;https://pic1.zhimg.com/v2-d5501deea27d4517abc297dc099963c8_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-d5501deea27d4517abc297dc099963c8_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;h2&gt;&lt;b&gt;推荐阅读&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289074%26idx%3D1%26sn%3De859d363eef9249236244466a1af41b6%26chksm%3D802e3867b759b1717f77e07a51ee5671e8115130c66562577280ba1243cba08218add04f1f00%26token%3D449379994%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;01、经过多年交易之后你应该学到的东西（深度分享）&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289050%26idx%3D1%26sn%3D60043a5c95b877dd329a5fd150ddacc4%26chksm%3D802e384fb759b1598e500087374772059aa21b31ae104b3dca04331cf4b63a233c5e04c1945a%26token%3D449379994%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;02、监督学习标签在股市中的应用（代码+书籍）&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289018%26idx%3D1%26sn%3D8c411f676c2c0d92b0dd218f041bee4b%26chksm%3D802e382fb759b139ffebf633ac14cdd0f21938e4613fe632d5d9231dab3d2aca95a11628378a%26token%3D449379994%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;03、全球投行顶尖机器学习团队全面分析&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289014%26idx%3D1%26sn%3D3762d405e332c599a21b48a7dc4df587%26chksm%3D802e3823b759b135928d55044c2729aea9690f86752b680eb973d1a376dc53cfa18287d0060b%26token%3D449379994%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;04、使用Tensorflow预测股票市场变动&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289238%26idx%3D1%26sn%3D3144f5792f84455dd53c27a78e8a316c%26chksm%3D802e3903b759b015da88acde4fcbc8547ab3e6acbb5a0897404bbefe1d8a414265d5d5766ee4%26token%3D2020206794%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;05、使用LSTM预测股票市场基于Tensorflow&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289314%26idx%3D1%26sn%3D87c5a12b23a875966db7be50d11f09cd%26chksm%3D802e3977b759b061675d1988168c1fec06c602e8583fbcc9b76f87008e0c10b702acc85467a0%26token%3D1972390229%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;06、美丽的回测——教你定量计算过拟合概率&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289347%26idx%3D1%26sn%3Dbf5d7899bc4a854d4ba9046fdc6fe0d6%26chksm%3D802e3996b759b080287213840987bb0a0c02e4e1d4d7aae23f10a225a92ef6dd922d8006123d%26token%3D290397496%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;07、利用动态深度学习预测金融时间序列基于Python&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289394%26idx%3D1%26sn%3D24a836136d730aa268605628e683d629%26chksm%3D802e39a7b759b0b1dcf7aaa560699130a907716b71fc9c45ff0e5d236c5ae8ef80ebdb09dbb6%26token%3D290397496%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;08、Facebook开源神器Prophet预测时间序列基于Python&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289437%26idx%3D1%26sn%3Df0dca7da8e69e7ba736992cb3d034ce7%26chksm%3D802e39c8b759b0de5bce401c580623d0729ecca69d13926479d36e19aff8c9c9e8a20265afff%26token%3D290397496%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;09、Facebook开源神器Prophet预测股市行情基于Python&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289358%26idx%3D1%26sn%3Ddb6e8ab85b08f6e67790ec0e401e586e%26chksm%3D802e399bb759b08d6eec855f9901ea856d0da68c7425cba62791b8948da6ad761a3d88543dad%26token%3D290397496%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;10、2018第三季度最受欢迎的券商金工研报前50（附下载）&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289447%26idx%3D1%26sn%3Df2948715bf82569a6556d518e56c1f9e%26chksm%3D802e39f2b759b0e4502d1aaac562b87789573b55c76b3c85897d8c9d88dbf9a0b7ee34d86a4e%26token%3D290397496%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;11、实战交易策略的精髓（公众号深度呈现）&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289478%26idx%3D1%26sn%3Df8e01a641be021993d8ef2d84e94a299%26chksm%3D802e3e13b759b7055cf27a280c672371008a5564c97c658eee89ce8481396a28d254836ff9af%26token%3D290397496%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;12、Markowitz有效边界和投资组合优化基于Python&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289495%26idx%3D1%26sn%3Dc4eeaa2e9f9c10995be9ea0c56d29ba7%26chksm%3D802e3e02b759b7148227675c23c403fb9a543b733e3d27fa237b53840e030bf387a473d83e3c%26token%3D1260956004%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;13、使用LSTM模型预测股价基于Keras&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289507%26idx%3D1%26sn%3Df0ca71aa07531bbbdbd33213f0bab89f%26chksm%3D802e3e36b759b720138b3b17a4dd0e198e054b9de29a038fdd50805f824effa55831111ad026%26token%3D1936245282%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;14、量化金融导论1：资产收益的程式化介绍基于Python&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289533%26idx%3D1%26sn%3D4ef964834e84a9995111bb057b0fc5dd%26chksm%3D802e3e28b759b73e0618eb1262c53aa0601fbf5805525a7c7ff40dc3db62c7704496611bdbf1%26token%3D1950551577%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;15、预测股市崩盘基于统计机器学习与神经网络（Python+文档）&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289609%26idx%3D1%26sn%3Dc7f0b3e47025862d10bb53b6ab88bcda%26chksm%3D802e3e9cb759b78abf6b8b049c59bf18ccfb2ead7580d1f557d36de2292f59dcbd94dcd41910%26token%3D2085008037%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;16、实现最优投资组合有效前沿基于Python（附代码）&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289615%26idx%3D1%26sn%3D1cdc89afb997d0c580bf0cef296d946c%26chksm%3D802e3e9ab759b78ce9f0cd152a680d4a413d6c8dcb02a7a296f4091993a7e4137e7520394575%26token%3D2085008037%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;17、精心为大家整理了一些超级棒的机器学习资料（附链接）&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289623%26idx%3D1%26sn%3D28a3600fd7a72d7be00b066ca0f98244%26chksm%3D802e3e82b759b7943f43a4f6ef4a91e4153fa6b8210de9590235fa8ee66eb9811ce177054dbc%26token%3D1389401983%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;18、海量Wind数据，与全网用户零距离邂逅！&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289640%26idx%3D1%26sn%3D34e94fcbe99052b8e7381ecc48a36dc0%26chksm%3D802e3ebdb759b7ab897cd329a680715b6f8294e63550ddf0c57b9e1320b2b7d1408c6fdca0c7%26token%3D1389401983%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;19、机器学习、深度学习、量化金融、Python等最新书籍汇总下载&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289725%26idx%3D1%26sn%3D4b65cd1fb8331438e4c0b3d0eae6b51f%26chksm%3D802e3ee8b759b7fe1b94e84d54cc23b0ab05853d5cd227812574b350e9fc2cce9e5f1bc6cb7a%26token%3D1389401983%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;20、各大卖方2019年A股策略报告，都是有故事的人！&lt;/a&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;如何获取代码&lt;/b&gt;&lt;/h2&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s/i6a3VimTOi8yQfdTp_npSg&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic1.zhimg.com/v2-9bd54611943d793a918a99b7b857908c_ipico.jpg&quot; data-image-width=&quot;1080&quot; data-image-height=&quot;1080&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;超级干货 | ML、DL预测股市模型汇总（史上最全，没有之一）&lt;/a&gt;&lt;p&gt;&lt;i&gt;—End—&lt;/i&gt;&lt;/p&gt;&lt;p&gt;量化投资与机器学习微信公众号，是业内垂直于&lt;b&gt;Quant&lt;/b&gt;、&lt;b&gt;MFE&lt;/b&gt;、&lt;b&gt;CST&lt;/b&gt;等专业的主流自媒体。公众号拥有来自&lt;b&gt;公募、私募、券商、银行、海外&lt;/b&gt;等众多圈内&lt;b&gt;10W+&lt;/b&gt;关注者。每日发布行业前沿研究成果和最新资讯。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>量化投资机器学习</author>
<guid isPermaLink="false">2019-04-14-62407696</guid>
<pubDate>Sun, 14 Apr 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>打造新一代高频交易 | MIT才女Christina Qi专访</title>
<link>https://henix.github.io/feeds/zhuanlan.Lhtz-Jqxx/2019-04-14-62407470.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/62407470&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-aaaa5cb591b55102879bfb9ff1f295b9_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;公众号导读&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;Christina Qi被誉为业内最受欢迎的女性，实至名归。从麻省理工学院（MIT）毕业后不久，她与其他人共同创立了Domeyard对冲基金。6年后，Christina Qi和他的联合创始人如今已成为对冲基金和金融科技领域的领军人物。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;背景&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;2016年10月，在普林斯顿Quant Trading Conference组委会演讲晚宴上，我遇到了Christina Qi。我和她谈了我在这个行业的经历以及想要追求它的激情。我还主持了她所在的小组，这给了我一个更好的机会去更多地了解她的为人和她的成功。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-9574413f55c6ce6b5f11b979ac660b41_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;640&quot; data-rawheight=&quot;960&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;640&quot; data-original=&quot;https://pic2.zhimg.com/v2-9574413f55c6ce6b5f11b979ac660b41_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-9574413f55c6ce6b5f11b979ac660b41_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;640&quot; data-rawheight=&quot;960&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;640&quot; data-original=&quot;https://pic2.zhimg.com/v2-9574413f55c6ce6b5f11b979ac660b41_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-9574413f55c6ce6b5f11b979ac660b41_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;h2&gt;&lt;b&gt;Christina Qi&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;Domeyard LP合伙人、《福布斯》30位30岁以下富豪。27岁的Christina Qi完成了大多数人一生中可能从未想过要做的事情。在MIT读本科时，她与两位联合创始人共同创建了Domeyard。白天，她会去上课，晚上，她会交易并努力发展公司。Christina Qi在本科期间接触了这个行业，当时她在高盛、UBS、Zions银行和麻省理工学院林肯实验室（MIT Lincoln Laboratory）等几家大型投行实习。除此之外，她还是MIT的客座讲师，与诺贝尔奖得主罗Robert Merton共事。像她这样的女性很少，她的道路是独一无二的，因为她正在做她自己喜欢做的事情，因为她全心全意地热衷于此，而不是因为其他人才这样做。&lt;/p&gt;&lt;p&gt;好了后面的介绍你们要全程看英文啦。不是我们不翻译哈。一是希望原汁原味呈现，二是搞量化的多看看国外文献、论坛啥的很正常啊，英语是要过关的呢！&lt;/p&gt;&lt;p&gt;周末快乐&lt;/p&gt;&lt;h2&gt;&lt;b&gt;What Christina does and how she does it&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;When speaking with Christina, I asked her “what motivated you to start your hedge fund and what was your vision?” In response she told me a long story about how during her student years when she interned for several large investment banks, she felt there wasn’t a lot of use of technology. As a millennial, technology plays a huge role in our everyday lives. She wanted to come up with a way in which firms could utilize and access technology easier and incorporate it into their trading routines. With the growth of technology taking over the space of many investment banks and trading firms, she wanted to bring it to places that needed it the most.&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-28406d2edef4342c5cefa7ed1288c489_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;787&quot; data-rawheight=&quot;525&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;787&quot; data-original=&quot;https://pic2.zhimg.com/v2-28406d2edef4342c5cefa7ed1288c489_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-28406d2edef4342c5cefa7ed1288c489_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;787&quot; data-rawheight=&quot;525&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;787&quot; data-original=&quot;https://pic2.zhimg.com/v2-28406d2edef4342c5cefa7ed1288c489_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-28406d2edef4342c5cefa7ed1288c489_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;Domeyard LP is a Boston-based hedge fund specializes in high frequency trading; specifically, they use strategies such as statistical arbitrage, short term strategies, and they look at overnight data to make their predictions for the next day. Christina says she loves the freedom of being able to carve her own path and have the decision on what she wants to do. She loves being able to essentially do whatever she wants. As a co-founder and Partner at Domeyard, she was able to help start and create a culture that cultivates intelligent minds and brilliant ideas. When coming up with the name Domeyard, her and her co-founders decided to integrate ‘yard’ from Harvard and ‘dome’ from MIT.&lt;/p&gt;&lt;h2&gt;&lt;b&gt;Looking into the future&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;The future of her company is something she frequently thinks about. In the next five years, she hopes to continue creating more amazing ideas and to expand the number of people who work at her company. She said she wants to pursue other things such as venture capital and see where it continues to grow from there. In addition to asking her questions about where she sees potential for her company, I asked her about challenges she faced along the way and how she overcame them. She said that as a woman, there is excessive pressure about fitting in or you will be outcasted. Discrimination exists subconsciously in the field, where men may do and say things they don’t really mean or don’t understand may be sexist. She believes it is incredibly important to not take these types of comments personally and to, instead, address them more head-on. She gave me an example of a time when she was at a dinner event and once it was over, a guy came up to her and told her they were done with their plates. She said that this instance surprised her and she was shocked about the comment, but she learned to laugh it off.&lt;/p&gt;&lt;h2&gt;&lt;b&gt;Success and getting there&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;In terms of some of the greatest instances of success to happen for her company, they were featured in Forbes in an article entitled “The Three Quants In Their 20s Running a Hedge Fund Making $1 Billion of Trades Daily.” Harvard performed a case study on the company when it was first started, and soon after that, the word spread about Domeyard and more people began reaching out. Christina is the most sought after woman in the industry. She has received so much attention that she is not particularly sure how to respond to her success. At times, she mentioned, she was not really sure how she got to where she was and if she even deserved it. She mentioned how amazing it is that after you become famous, people who ignored you in the past suddenly want to associate with you. She told me how when she was working on a trading desk in Japan as an intern, she sat next to a door in the back of the room and was basically ignored a vast majority of the day. There was a guy in particular who never talked to her but once she started Domeyard, that exact same company reached out and wanted to invest in it.&lt;/p&gt;&lt;h2&gt;&lt;b&gt;Christina outside of work&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;When Christina is not working, she likes to engage in different types of activities such as reading books, watching anime and TV, and hanging out with her friends. She told me her friends are of all different ages, even teenagers. She said she enjoys hanging out with people of all age groups. She frequently brought up how she enjoys living the ‘millennial life’ where she always is on her phone and meeting up with different people. When you speak with Christina, she is very easy-going and personable. In every interaction I have had with her, I feel at ease because, although she is really successful, she knows how to connect with nearly anyone she is speaking with.&lt;/p&gt;&lt;p&gt;The advice Christina would give to students aspiring to enter the industry is to always interview your interviewer. She says it’s crucial to ask as many questions as possible in order to make sure something is for you. She also said that companies check their candidates’ social media profiles and that it’s important to always present yourself professionally, even if it’s just a random profile online. She also said that when you are at an interview, one way to make sure something is for you is to observe the culture and atmosphere. Every place has a different vibe and some workers may all be older or all younger, so it’s important to make sure you can actually picture yourself at these companies and be realistico on whether or not you can picture yourself there. A few last pieces of advice Christina gave was to be open-minded with opportunities you’re given. The industry is constantly changing and it is definitely alright to change jobs and industries where necessary. Also, she mentioned that you won’t enjoy your job 100% of the time, but be happy at least 80% of the time you are working.&lt;/p&gt;&lt;h2&gt;&lt;b&gt;Conclusion&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;As a young finance fanatic and engineer, I look up to Christina and all that she has done. Since meeting her at the Princeton Quant Trading Conference and having dinner with her and the rest of my fellow committee members, I knew she was someone I could trust. Since speaking with Christina on the phone about her career, I am even more inspired and motivated to continue down my current path in finance. Though Christina said she didn’t really have a role model when pursuing the industry, I regard her as one of mine.&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;By Katelyn Schoenberger&lt;/i&gt;&lt;/blockquote&gt;&lt;h2&gt;&lt;b&gt;推荐阅读&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289074%26idx%3D1%26sn%3De859d363eef9249236244466a1af41b6%26chksm%3D802e3867b759b1717f77e07a51ee5671e8115130c66562577280ba1243cba08218add04f1f00%26token%3D449379994%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;01、经过多年交易之后你应该学到的东西（深度分享）&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289050%26idx%3D1%26sn%3D60043a5c95b877dd329a5fd150ddacc4%26chksm%3D802e384fb759b1598e500087374772059aa21b31ae104b3dca04331cf4b63a233c5e04c1945a%26token%3D449379994%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;02、监督学习标签在股市中的应用（代码+书籍）&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289018%26idx%3D1%26sn%3D8c411f676c2c0d92b0dd218f041bee4b%26chksm%3D802e382fb759b139ffebf633ac14cdd0f21938e4613fe632d5d9231dab3d2aca95a11628378a%26token%3D449379994%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;03、全球投行顶尖机器学习团队全面分析&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289014%26idx%3D1%26sn%3D3762d405e332c599a21b48a7dc4df587%26chksm%3D802e3823b759b135928d55044c2729aea9690f86752b680eb973d1a376dc53cfa18287d0060b%26token%3D449379994%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;04、使用Tensorflow预测股票市场变动&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289238%26idx%3D1%26sn%3D3144f5792f84455dd53c27a78e8a316c%26chksm%3D802e3903b759b015da88acde4fcbc8547ab3e6acbb5a0897404bbefe1d8a414265d5d5766ee4%26token%3D2020206794%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;05、使用LSTM预测股票市场基于Tensorflow&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289314%26idx%3D1%26sn%3D87c5a12b23a875966db7be50d11f09cd%26chksm%3D802e3977b759b061675d1988168c1fec06c602e8583fbcc9b76f87008e0c10b702acc85467a0%26token%3D1972390229%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;06、美丽的回测——教你定量计算过拟合概率&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289347%26idx%3D1%26sn%3Dbf5d7899bc4a854d4ba9046fdc6fe0d6%26chksm%3D802e3996b759b080287213840987bb0a0c02e4e1d4d7aae23f10a225a92ef6dd922d8006123d%26token%3D290397496%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;07、利用动态深度学习预测金融时间序列基于Python&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289394%26idx%3D1%26sn%3D24a836136d730aa268605628e683d629%26chksm%3D802e39a7b759b0b1dcf7aaa560699130a907716b71fc9c45ff0e5d236c5ae8ef80ebdb09dbb6%26token%3D290397496%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;08、Facebook开源神器Prophet预测时间序列基于Python&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289437%26idx%3D1%26sn%3Df0dca7da8e69e7ba736992cb3d034ce7%26chksm%3D802e39c8b759b0de5bce401c580623d0729ecca69d13926479d36e19aff8c9c9e8a20265afff%26token%3D290397496%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;09、Facebook开源神器Prophet预测股市行情基于Python&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289358%26idx%3D1%26sn%3Ddb6e8ab85b08f6e67790ec0e401e586e%26chksm%3D802e399bb759b08d6eec855f9901ea856d0da68c7425cba62791b8948da6ad761a3d88543dad%26token%3D290397496%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;10、2018第三季度最受欢迎的券商金工研报前50（附下载）&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289447%26idx%3D1%26sn%3Df2948715bf82569a6556d518e56c1f9e%26chksm%3D802e39f2b759b0e4502d1aaac562b87789573b55c76b3c85897d8c9d88dbf9a0b7ee34d86a4e%26token%3D290397496%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;11、实战交易策略的精髓（公众号深度呈现）&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289478%26idx%3D1%26sn%3Df8e01a641be021993d8ef2d84e94a299%26chksm%3D802e3e13b759b7055cf27a280c672371008a5564c97c658eee89ce8481396a28d254836ff9af%26token%3D290397496%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;12、Markowitz有效边界和投资组合优化基于Python&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289495%26idx%3D1%26sn%3Dc4eeaa2e9f9c10995be9ea0c56d29ba7%26chksm%3D802e3e02b759b7148227675c23c403fb9a543b733e3d27fa237b53840e030bf387a473d83e3c%26token%3D1260956004%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;13、使用LSTM模型预测股价基于Keras&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289507%26idx%3D1%26sn%3Df0ca71aa07531bbbdbd33213f0bab89f%26chksm%3D802e3e36b759b720138b3b17a4dd0e198e054b9de29a038fdd50805f824effa55831111ad026%26token%3D1936245282%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;14、量化金融导论1：资产收益的程式化介绍基于Python&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289533%26idx%3D1%26sn%3D4ef964834e84a9995111bb057b0fc5dd%26chksm%3D802e3e28b759b73e0618eb1262c53aa0601fbf5805525a7c7ff40dc3db62c7704496611bdbf1%26token%3D1950551577%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;15、预测股市崩盘基于统计机器学习与神经网络（Python+文档）&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289609%26idx%3D1%26sn%3Dc7f0b3e47025862d10bb53b6ab88bcda%26chksm%3D802e3e9cb759b78abf6b8b049c59bf18ccfb2ead7580d1f557d36de2292f59dcbd94dcd41910%26token%3D2085008037%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;16、实现最优投资组合有效前沿基于Python（附代码）&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289615%26idx%3D1%26sn%3D1cdc89afb997d0c580bf0cef296d946c%26chksm%3D802e3e9ab759b78ce9f0cd152a680d4a413d6c8dcb02a7a296f4091993a7e4137e7520394575%26token%3D2085008037%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;17、精心为大家整理了一些超级棒的机器学习资料（附链接）&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289623%26idx%3D1%26sn%3D28a3600fd7a72d7be00b066ca0f98244%26chksm%3D802e3e82b759b7943f43a4f6ef4a91e4153fa6b8210de9590235fa8ee66eb9811ce177054dbc%26token%3D1389401983%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;18、海量Wind数据，与全网用户零距离邂逅！&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289640%26idx%3D1%26sn%3D34e94fcbe99052b8e7381ecc48a36dc0%26chksm%3D802e3ebdb759b7ab897cd329a680715b6f8294e63550ddf0c57b9e1320b2b7d1408c6fdca0c7%26token%3D1389401983%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;19、机器学习、深度学习、量化金融、Python等最新书籍汇总下载&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289725%26idx%3D1%26sn%3D4b65cd1fb8331438e4c0b3d0eae6b51f%26chksm%3D802e3ee8b759b7fe1b94e84d54cc23b0ab05853d5cd227812574b350e9fc2cce9e5f1bc6cb7a%26token%3D1389401983%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;20、各大卖方2019年A股策略报告，都是有故事的人！&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;i&gt;—End—&lt;/i&gt;&lt;/p&gt;&lt;p&gt;量化投资与机器学习微信公众号，是业内垂直于&lt;b&gt;Quant&lt;/b&gt;、&lt;b&gt;MFE&lt;/b&gt;、&lt;b&gt;CST&lt;/b&gt;等专业的主流自媒体。公众号拥有来自&lt;b&gt;公募、私募、券商、银行、海外&lt;/b&gt;等众多圈内&lt;b&gt;10W+&lt;/b&gt;关注者。每日发布行业前沿研究成果和最新资讯。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>量化投资机器学习</author>
<guid isPermaLink="false">2019-04-14-62407470</guid>
<pubDate>Sun, 14 Apr 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>干货 | Python优化技巧：bowl、plate 和valley函数（附代码）</title>
<link>https://henix.github.io/feeds/zhuanlan.Lhtz-Jqxx/2019-04-09-61875176.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/61875176&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-097d913d09ea6e62fde21b75440270e8_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s/h7YMMU95ya9fu8hrKLrtYQ&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic4.zhimg.com/v2-b0d5d85b26e2d7780d75357bd2c30aff_180x120.jpg&quot; data-image-width=&quot;1080&quot; data-image-height=&quot;459&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;干货 | Python优化技巧：bowl、plate 和valley函数（附代码）&lt;/a&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>量化投资机器学习</author>
<guid isPermaLink="false">2019-04-09-61875176</guid>
<pubDate>Tue, 09 Apr 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>算法交易系统开发，揭开Developer的神秘面纱（代码+核心思路）</title>
<link>https://henix.github.io/feeds/zhuanlan.Lhtz-Jqxx/2019-04-08-61747659.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/61747659&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-976e6d0607f0dcb2d37e4e334e10ef32_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;▎作者：Roman Paolucci&lt;/p&gt;&lt;p&gt;&lt;b&gt;▎&lt;/b&gt;编译：yana | 公众号翻译部&lt;/p&gt;&lt;h2&gt;&lt;b&gt;量化开发&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;通常量化研究员会用Python或R开发交易模型。然后把这些模型交给量化开发人员，用java或C++在交易系统中使用。量化交易员通常在这些系统的帮助下执行交易。作为一个研究员、开发人员和交易员，多年与Interactive Broker 的 Java API打交道。在这篇文章中，我们会建立一个算法交易系统，用于基于模型的自动交易执行。在开发交易系统时，在概念上有无限的设计模式可以遵循。但是，&lt;b&gt;本文的目的是为最常见的开发阶段提供简单的解决方案&lt;/b&gt;。这篇文章分成三个部分：&lt;/p&gt;&lt;p&gt;&lt;b&gt;• 连接Interactive Broker交易站（TWS）&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;• 创建实时市场数据流&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;• 实现自动交易执行模型&lt;/b&gt;&lt;/p&gt;&lt;p&gt;安装Interactive Brokers TWS：&lt;/p&gt;&lt;p&gt;&lt;i&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//www.interactivebrokers.com.hk/en/index.php%3Ff%3D16040&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://www.&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;interactivebrokers.com.hk&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;/en/index.php?f=16040&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/i&gt;&lt;/p&gt;&lt;p&gt;安装API：&lt;/p&gt;&lt;p&gt;&lt;i&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//www.interactivebrokers.com.hk/en/index.php%3Ff%3D5041&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://www.&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;interactivebrokers.com.hk&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;/en/index.php?f=5041&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/i&gt;&lt;/p&gt;&lt;p&gt;查看API文档：&lt;/p&gt;&lt;p&gt;&lt;i&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//interactivebrokers.github.io/tws-api/index.html&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;interactivebrokers.github.io&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;/tws-api/index.html&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/i&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-c75d324e47267297f56d0480b41b139b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;764&quot; data-rawheight=&quot;700&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;764&quot; data-original=&quot;https://pic4.zhimg.com/v2-c75d324e47267297f56d0480b41b139b_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-c75d324e47267297f56d0480b41b139b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;764&quot; data-rawheight=&quot;700&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;764&quot; data-original=&quot;https://pic4.zhimg.com/v2-c75d324e47267297f56d0480b41b139b_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-c75d324e47267297f56d0480b41b139b_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;重点&lt;/b&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;• &lt;b&gt;项目代码可以在文末下载。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;• 如果您没有Interactive Brokers的账户，你可以使用模拟账户【用户名：edemo，密码：demouser】来跟随并免费建立一个交易系统。&lt;/p&gt;&lt;p&gt;• 假设你有中级Java编程经验。&lt;/p&gt;&lt;p&gt;• 假设你具有使用API的一些知识，并且能够在IDE中进行安装过程和设置。&lt;/p&gt;&lt;p&gt;• 在真实账户进行交易时，某些证券的实时市场数据流需要一级市场数据订阅，更多信息可在此处找到：&lt;/p&gt;&lt;p&gt;&lt;i&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//www.interactivebrokers.com/en/software/am3/am/settings/marketdatasubscriptions.htm&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://www.&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;interactivebrokers.com/&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;en/software/am3/am/settings/marketdatasubscriptions.htm&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/i&gt;&lt;br/&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;连接&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;本节介绍用Java连接TWS以及该过程的几个特性。&lt;/p&gt;&lt;h3&gt;&lt;b&gt;配置TWS&lt;/b&gt;&lt;/h3&gt;&lt;p&gt;第一步是配置您TWS。首先使用上面的模拟帐户或个人帐户登录，然后执行以下操作：&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;选择 “Classic TWS” → 选择 “Conbgure” &lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;选择 “API” → 启用 ActiveX 和 Client Sockets &lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;禁用只读API → Apply → Ok&lt;/b&gt;&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-8e7159b1bea196b75ae1f1b22be7a0fd_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;900&quot; data-rawheight=&quot;458&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;900&quot; data-original=&quot;https://pic2.zhimg.com/v2-8e7159b1bea196b75ae1f1b22be7a0fd_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-8e7159b1bea196b75ae1f1b22be7a0fd_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;900&quot; data-rawheight=&quot;458&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;900&quot; data-original=&quot;https://pic2.zhimg.com/v2-8e7159b1bea196b75ae1f1b22be7a0fd_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-8e7159b1bea196b75ae1f1b22be7a0fd_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;我们现在允许从127.0.0.1:7497进行API连接。&lt;/p&gt;&lt;p&gt;我们还允许Java通过禁用只读API来执行交易。&lt;/p&gt;&lt;p&gt;如果连接不成功，则可能需要转发端口。有关端口的更多信息，请参阅：主机和端口文档。&lt;i&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//ibkr.info/node/2816&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;ibkr.info/node/2816&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/i&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;连接处理&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;到目前为止，假设您已经从Interactive Brokers安装了API，并在首选IDE中设置它的工作空间。我们将创建IConnectionHandler接口，来处理服务器和客户端之间的连接事件，从而实现Java和TWS之间建立连接：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-4c99c7a0034fd3ccbcbdb1050c012fad_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1056&quot; data-rawheight=&quot;1244&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1056&quot; data-original=&quot;https://pic2.zhimg.com/v2-4c99c7a0034fd3ccbcbdb1050c012fad_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-4c99c7a0034fd3ccbcbdb1050c012fad_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1056&quot; data-rawheight=&quot;1244&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1056&quot; data-original=&quot;https://pic2.zhimg.com/v2-4c99c7a0034fd3ccbcbdb1050c012fad_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-4c99c7a0034fd3ccbcbdb1050c012fad_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;接下来，需要创建ILogger接口的实现：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-b08026b1125cb1ba27fdf8f9673ebf2d_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;402&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-b08026b1125cb1ba27fdf8f9673ebf2d_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-b08026b1125cb1ba27fdf8f9673ebf2d_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;402&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-b08026b1125cb1ba27fdf8f9673ebf2d_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-b08026b1125cb1ba27fdf8f9673ebf2d_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;既然我们知道如何处理连接和记录信息（使用我们的接口实现），就可以建立与TWS的连接。在项目的主要类Demo中连接到TWS：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-9e5a0b8864f136a6f3a639d56ae0c1b3_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;652&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-9e5a0b8864f136a6f3a639d56ae0c1b3_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-9e5a0b8864f136a6f3a639d56ae0c1b3_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;652&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-9e5a0b8864f136a6f3a639d56ae0c1b3_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-9e5a0b8864f136a6f3a639d56ae0c1b3_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;主控制器是&lt;b&gt;ApiController&lt;/b&gt;，通过它发送请求并从TWS接收响应。&lt;/p&gt;&lt;p&gt;连接成功，可以在终端中看到：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-c01f3713732a0630031c8021bc341daa_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;987&quot; data-rawheight=&quot;439&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;987&quot; data-original=&quot;https://pic3.zhimg.com/v2-c01f3713732a0630031c8021bc341daa_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-c01f3713732a0630031c8021bc341daa_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;987&quot; data-rawheight=&quot;439&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;987&quot; data-original=&quot;https://pic3.zhimg.com/v2-c01f3713732a0630031c8021bc341daa_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-c01f3713732a0630031c8021bc341daa_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;现在已成功连接到TWS，我们可以创建实时市场数据流来处理实时数据。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;实时数据流&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;本节介绍设置市场数据流的过程。&lt;/p&gt;&lt;h3&gt;&lt;b&gt;市场数据句柄&lt;/b&gt;&lt;/h3&gt;&lt;p&gt;与连接处理程序类似，必须创建ITopMktDataHandler接口的实例，以便处理服务器响应的数据。通过给实例方法传递参数的方式，从服务器接收数据。在数据发生变化时服务器对其进行响应，因此Price, Volume，Bid_Size，Ask_Size等功能的更改会发送给ITopMktDataHandler的实例方法。要在下一节中实现任何类型的交易模型，我们需要一种方法来捕获这些数据。现在把最新修改价格存储在ArrayList顶部：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-45137435e5514747a287216794755abd_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;1067&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-45137435e5514747a287216794755abd_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-45137435e5514747a287216794755abd_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;1067&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-45137435e5514747a287216794755abd_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-45137435e5514747a287216794755abd_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;简而言之，在TopMktDataHandlerImplementation的新类中实现ITopMktDataHandler接口，处理服务器响应的数据。 tickPrice方法会在服务器更改时从服务器接收数据。当服务器响应最新价格的变化时，我们将其添加到ArrayList价格。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;可视化 Price ArrayList 的行为&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;我们正在改变将新项添加到ArrayList的方式。以下是其工作原理的图形表示：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-b82d2c930e925fcda01182265cc44aa9_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;695&quot; data-rawheight=&quot;439&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;695&quot; data-original=&quot;https://pic2.zhimg.com/v2-b82d2c930e925fcda01182265cc44aa9_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-b82d2c930e925fcda01182265cc44aa9_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;695&quot; data-rawheight=&quot;439&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;695&quot; data-original=&quot;https://pic2.zhimg.com/v2-b82d2c930e925fcda01182265cc44aa9_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-b82d2c930e925fcda01182265cc44aa9_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;新价格到达时，我们将其插入到ArrayList的顶部，可以通过语句 &lt;b&gt;price.get（0）&lt;/b&gt;获得最新价格。在建模和交易执行部分会更具相关性。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;创建合约对象&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;这个过程最重要的部分是建立一个NewContract对象作为参数传递给请求。为此，我们使用流式传输的安全性的参数初始化NewContract对象。我将使用期货合约作为例子：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-334ab6954b9a00c63d397ac70da141ed_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;387&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-334ab6954b9a00c63d397ac70da141ed_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-334ab6954b9a00c63d397ac70da141ed_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;387&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-334ab6954b9a00c63d397ac70da141ed_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-334ab6954b9a00c63d397ac70da141ed_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;请求实时市场数据流&lt;/b&gt;&lt;/p&gt;&lt;p&gt;现在有办法处理数据流，并定义了流的安全性，接下来看下并细分请求方法：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-8d19bf270ed36b87814e0c496fcef6b3_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;72&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-8d19bf270ed36b87814e0c496fcef6b3_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-8d19bf270ed36b87814e0c496fcef6b3_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;72&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-8d19bf270ed36b87814e0c496fcef6b3_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-8d19bf270ed36b87814e0c496fcef6b3_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;第一个参数是合约，简单地传递初始化契约的方法。&lt;/p&gt;&lt;p&gt;第二个参数可以保留为空字符串。&lt;/p&gt;&lt;p&gt;第三个参数确定是否正在请求快照，我们显然希望将此请求建立为流。&lt;/p&gt;&lt;p&gt;最后一个参数是ITopMktDataHandler。这允许我们使用服务器的响应数据来处理事务。&lt;/p&gt;&lt;p&gt;以下是主类Demo建立数据流的更新：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-6016714c5bcd96cf77f224d6890b6286_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;808&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-6016714c5bcd96cf77f224d6890b6286_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-6016714c5bcd96cf77f224d6890b6286_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;808&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-6016714c5bcd96cf77f224d6890b6286_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-6016714c5bcd96cf77f224d6890b6286_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;运行此操作后，可以在终端中获得以下输出：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-8543942366ec1de9a03a0622d642d3d6_b.gif&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;600&quot; data-rawheight=&quot;402&quot; data-thumbnail=&quot;https://pic3.zhimg.com/v2-8543942366ec1de9a03a0622d642d3d6_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;600&quot; data-original=&quot;https://pic3.zhimg.com/v2-8543942366ec1de9a03a0622d642d3d6_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-8543942366ec1de9a03a0622d642d3d6_b.gif&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;600&quot; data-rawheight=&quot;402&quot; data-thumbnail=&quot;https://pic3.zhimg.com/v2-8543942366ec1de9a03a0622d642d3d6_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;600&quot; data-original=&quot;https://pic3.zhimg.com/v2-8543942366ec1de9a03a0622d642d3d6_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-8543942366ec1de9a03a0622d642d3d6_b.gif&quot;/&gt;&lt;/figure&gt;&lt;p&gt;我们已成功为特定合约创建了市场数据流。&lt;br/&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;自动交易执行模型&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;可能是算法交易系统开发中最迷人的部分&lt;/b&gt;。本节是关于实现模型和自动订单执行的全部内容。&lt;/p&gt;&lt;h3&gt;&lt;b&gt;模型开发&lt;/b&gt;&lt;/h3&gt;&lt;p&gt;&lt;b&gt;这是我们交易系统中最重要的部分&lt;/b&gt;。如果模型没有盈利，就不会赚钱。虽然我们在本文中不会过多谈论模型开发过程，但想稍微谈谈它。 &lt;/p&gt;&lt;p&gt;正如我在介绍中简要提到的，&lt;b&gt;通常模型开发是一个不同的角色，属于定量研究员的职责。研究人员用Python或R开发模型，开发人员用Java或C ++实现它，交易者负责交易执行。大多数研究人员使用某种形式的机器学习来协助开发他们的模型。就是掌握Python中的数据科学库，如Pandas，ScikitLearn，Numpy和R中的包，如quantmod。如果您希望在模型开发中了解有关机器学习应用程序的更多信息。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;虽然有几种方法可以开发交易模型，但显然它绝不是一门精确的科学。&lt;b&gt;一些模型设计具有遗传能力，以不断适应市场条件，而其他模型设置有损失限制，因此当它们停止执行时，它们会被废弃。&lt;/b&gt;对于定量研究，高级金融，数学和统计知识是必不可少的。这些技能与创造力和坚持不懈相媲美，从而推动了建模过程。&lt;/p&gt;&lt;p&gt;一般模型设计过程可以看作如下：&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;阅读博士论文或其他相关信息 → 草拟模型创意 → 回测模型（评估绩效的一些关键指标）→ 废弃不良模型（通常约为所有模型创意的70％-90％）→ 继续开发和审查剩余模型 → 查看生产潜力 → 重复过程。&lt;/b&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;任意实施模式&lt;/b&gt;&lt;/p&gt;&lt;p&gt;我们将使用&lt;b&gt;基于价格变化阈值的简单策略来构建期货合约&lt;/b&gt;。以下是进入策略的直观表示：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-5dd3c6dabf185f06eb75c2313e12c040_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;800&quot; data-rawheight=&quot;439&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;800&quot; data-original=&quot;https://pic1.zhimg.com/v2-5dd3c6dabf185f06eb75c2313e12c040_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-5dd3c6dabf185f06eb75c2313e12c040_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;800&quot; data-rawheight=&quot;439&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;800&quot; data-original=&quot;https://pic1.zhimg.com/v2-5dd3c6dabf185f06eb75c2313e12c040_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-5dd3c6dabf185f06eb75c2313e12c040_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;下一步是制定退场策略。为简单起见，我们的退场策略只是一个限制，并分别停止1点和0.5点（费用后保持相同的费用）&lt;/p&gt;&lt;p&gt;此模型的目的是展示基于模型的自动订单执行的简单解决方案。不建议在真实账户上实施此策略。&lt;br/&gt;&lt;/p&gt;&lt;h3&gt;&lt;b&gt;模型开发&lt;/b&gt;&lt;/h3&gt;&lt;p&gt;我们将从TopMktDataHandlerImplementation中的价格ArrayList获取信息。在获得价格之后，我们将要开发一个类来处理（基于模型的）进入信号，然后开发一个类来处理发送订单。我将使用EntrySignalA类作为我的主要信号：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-86aab41eb4535d0d06bb37918df64bfb_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;962&quot; data-rawheight=&quot;560&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;962&quot; data-original=&quot;https://pic4.zhimg.com/v2-86aab41eb4535d0d06bb37918df64bfb_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-86aab41eb4535d0d06bb37918df64bfb_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;962&quot; data-rawheight=&quot;560&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;962&quot; data-original=&quot;https://pic4.zhimg.com/v2-86aab41eb4535d0d06bb37918df64bfb_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-86aab41eb4535d0d06bb37918df64bfb_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;既然我们有办法让价格符合我们的信号，以确定买入或卖出，我们需要创建一个类来处理订单。我们将创建一个类来实现自定义订单和处理活动订单。&lt;/p&gt;&lt;p&gt;现在我们可以在信号类中使用placeBracketOrder方法：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-924b0e5407c3582930147736d75ef324_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;938&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-924b0e5407c3582930147736d75ef324_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-924b0e5407c3582930147736d75ef324_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;938&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-924b0e5407c3582930147736d75ef324_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-924b0e5407c3582930147736d75ef324_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-6b0687eca910a1f3782d47ff386c8dd3_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;959&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-6b0687eca910a1f3782d47ff386c8dd3_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-6b0687eca910a1f3782d47ff386c8dd3_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;959&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-6b0687eca910a1f3782d47ff386c8dd3_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-6b0687eca910a1f3782d47ff386c8dd3_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-c2e375e7573cb4ee430ddcd7f488cae2_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;960&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-c2e375e7573cb4ee430ddcd7f488cae2_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-c2e375e7573cb4ee430ddcd7f488cae2_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;960&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-c2e375e7573cb4ee430ddcd7f488cae2_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-c2e375e7573cb4ee430ddcd7f488cae2_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-3450b940122ee9cebded4f6a85bc1ed3_b.png&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;61&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-3450b940122ee9cebded4f6a85bc1ed3_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-3450b940122ee9cebded4f6a85bc1ed3_b.png&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;61&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-3450b940122ee9cebded4f6a85bc1ed3_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-3450b940122ee9cebded4f6a85bc1ed3_b.png&quot;/&gt;&lt;/figure&gt;&lt;h3&gt;&lt;b&gt;要点&lt;/b&gt;&lt;/h3&gt;&lt;p&gt;在此例中，使用1000和2000作为parentOrderId。如果交易没有唯一的订单ID，则不会发送交易。但是，如果在TWS中重置订单ID API序列，则将重置所有现有订单ID，并且可以重复使用。有许多方法可以生成唯一的订单ID，例如将当前日期/时间转换为整数。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;全放在一起&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;如果我们从逻辑上考虑这个问题，有一个非常简单的方法可以将它实现。只需在服务器响应的方法底部添加信号类的实例，以获得价格的每次变化：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-5ea5882d758d2b6ab1a0f792c9a9c71d_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;977&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-5ea5882d758d2b6ab1a0f792c9a9c71d_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-5ea5882d758d2b6ab1a0f792c9a9c71d_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;977&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-5ea5882d758d2b6ab1a0f792c9a9c71d_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-5ea5882d758d2b6ab1a0f792c9a9c71d_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;我们现在有一个简单的系统，可以根据我们的模型自动执行交易。这是我们的模型执行买入订单时的样子：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-74cfdf00fa00f825c7d39c61fe3c9d13_b.gif&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;600&quot; data-rawheight=&quot;276&quot; data-thumbnail=&quot;https://pic4.zhimg.com/v2-74cfdf00fa00f825c7d39c61fe3c9d13_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;600&quot; data-original=&quot;https://pic4.zhimg.com/v2-74cfdf00fa00f825c7d39c61fe3c9d13_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-74cfdf00fa00f825c7d39c61fe3c9d13_b.gif&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;600&quot; data-rawheight=&quot;276&quot; data-thumbnail=&quot;https://pic4.zhimg.com/v2-74cfdf00fa00f825c7d39c61fe3c9d13_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;600&quot; data-original=&quot;https://pic4.zhimg.com/v2-74cfdf00fa00f825c7d39c61fe3c9d13_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-74cfdf00fa00f825c7d39c61fe3c9d13_b.gif&quot;/&gt;&lt;/figure&gt;&lt;h2&gt;&lt;b&gt;量化开发人员 - 系统开发&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;作为量化开发人员，你的工作通常是创建基于经过严格测试的oi模型的交易系统。&lt;/b&gt;在这个例子中，我们引导你完成算法交易系统的开发，并为关键的开发阶段提供了简单的解决方案。有很多方法来改进这个系统（显然是模型），例如：&lt;/p&gt;&lt;p&gt;&lt;b&gt;• 在交易执行系统中添加安全标志&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;• 未能以非最优价格执行订单&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;• 当前模型性能的分析库&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;• 等等&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;如何获取代码&lt;/b&gt;&lt;/h2&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s/Vy2jKfUKumfCo0xYUUu0RA&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic4.zhimg.com/v2-86c99c2ff42d04bccf01bee78aa6ed83_180x120.jpg&quot; data-image-width=&quot;1280&quot; data-image-height=&quot;545&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;算法交易系统开发，揭开Developer的神秘面纱（代码+核心思路）&lt;/a&gt;&lt;p&gt;&lt;i&gt;—End—&lt;/i&gt;&lt;/p&gt;&lt;p&gt;量化投资与机器学习微信公众号，是业内垂直于&lt;b&gt;Quant&lt;/b&gt;、&lt;b&gt;MFE&lt;/b&gt;、&lt;b&gt;CST&lt;/b&gt;等专业的主流自媒体。公众号拥有来自&lt;b&gt;公募、私募、券商、银行、海外&lt;/b&gt;等众多圈内&lt;b&gt;10W+&lt;/b&gt;关注者。每日发布行业前沿研究成果和最新资讯。&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-781e4b70c99e97eb46045eefdd07923a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;1080&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-781e4b70c99e97eb46045eefdd07923a_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-781e4b70c99e97eb46045eefdd07923a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;1080&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-781e4b70c99e97eb46045eefdd07923a_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-781e4b70c99e97eb46045eefdd07923a_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>量化投资机器学习</author>
<guid isPermaLink="false">2019-04-08-61747659</guid>
<pubDate>Mon, 08 Apr 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>使用Prophet预测股价并进行多策略交易（附代码）</title>
<link>https://henix.github.io/feeds/zhuanlan.Lhtz-Jqxx/2019-04-08-61746724.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/61746724&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-068ad39bdc4ce5c6eb81b264b987a987_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;▎作者：Mike&lt;/p&gt;&lt;p&gt;&lt;b&gt;▎&lt;/b&gt;编译：公众号翻译部&lt;/p&gt;&lt;p&gt;在这篇文章中，我们将使用Prophet来预测时间序列。使用的数据是SA&amp;amp;P500历史调整收盘价。先建立一个3年的预测，然后模拟1980年以来的历史月度预测。最后，将创建多样的交易策略。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-8a14e3bd44e3ff2cbb67956fa3588cbb_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;765&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-8a14e3bd44e3ff2cbb67956fa3588cbb_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-8a14e3bd44e3ff2cbb67956fa3588cbb_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;765&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-8a14e3bd44e3ff2cbb67956fa3588cbb_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-8a14e3bd44e3ff2cbb67956fa3588cbb_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//facebook.github.io/prophet/&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;facebook.github.io/prop&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;het/&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;库的导入&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;导入Python标准库。还将从 functools 中导入 Prophet 和 reduce。&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pandas&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pd&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;fbprophet&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Prophet&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;functools&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;reduce&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;matplotlib&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inline&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;warnings&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;warnings&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filterwarnings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ignore&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;style&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;use&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;seaborn-deep&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;display&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float_format&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;{:,.2f}&amp;#34;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;数据获取&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;使用的数据是1980年以来的标准普尔500指数历史数据。&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;describe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-24575f3fd6032445b8c18274d133d743_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;538&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-24575f3fd6032445b8c18274d133d743_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-24575f3fd6032445b8c18274d133d743_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;538&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-24575f3fd6032445b8c18274d133d743_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-24575f3fd6032445b8c18274d133d743_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;h2&gt;&lt;b&gt;数据准备&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;要使prophet用起来，我们需要将日期和Adj close列的名称更改为ds和y。 在大多数机器学习项目中，术语y通常用于目标列（要测试的内容）。&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Date&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Adj Close&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;columns&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;y&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-c109a8dbd1656a9be5332f8d679d373c_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;364&quot; data-rawheight=&quot;708&quot; class=&quot;content_image&quot; width=&quot;364&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-c109a8dbd1656a9be5332f8d679d373c_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;364&quot; data-rawheight=&quot;708&quot; class=&quot;content_image lazy&quot; width=&quot;364&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-c109a8dbd1656a9be5332f8d679d373c_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;h2&gt;&lt;b&gt;Prophet&lt;/b&gt;&lt;/h2&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-416740735fff7ee48ff9c40221a0ced1_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;719&quot; data-rawheight=&quot;354&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;719&quot; data-original=&quot;https://pic2.zhimg.com/v2-416740735fff7ee48ff9c40221a0ced1_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-416740735fff7ee48ff9c40221a0ced1_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;719&quot; data-rawheight=&quot;354&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;719&quot; data-original=&quot;https://pic2.zhimg.com/v2-416740735fff7ee48ff9c40221a0ced1_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-416740735fff7ee48ff9c40221a0ced1_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;在使用Prophet创建预测之前，先将数据可视化。直观的来感受数据。&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Prophet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fbprophet&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;forecaster&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Prophet&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;at&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x21216301c18&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;要激活Prophet模型，我们只需调用Prophet()并将其分配给一个名为Model的变量。接下来，我们通过调用fit方法将股票数据匹配到模型中。&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;future = model.make_future_dataframe(1095, freq=&amp;#39;d&amp;#39;)

future_boolean = future[&amp;#39;ds&amp;#39;].map(lambda x : True if x.weekday() in range(0, 5) else False)
future = future[future_boolean] 

future.tail()&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-109e18281a1162a8d4817f4d435e420d_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;314&quot; data-rawheight=&quot;390&quot; class=&quot;content_image&quot; width=&quot;314&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-109e18281a1162a8d4817f4d435e420d_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;314&quot; data-rawheight=&quot;390&quot; class=&quot;content_image lazy&quot; width=&quot;314&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-109e18281a1162a8d4817f4d435e420d_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;我们需要创建一些未来的日期。Prophet为我们提供了一个名为make_future_dataframe的函数。传入未来周期和频率的数量。以上是我们对未来1095天或3年的预测。&lt;/p&gt;&lt;p&gt;由于股票只能在交易日操作，我们需要将预测数据从周末中删除。为此，我们创建一个布尔表达式，如果一天不等于0-4，则返回False。“0 =星期一，6=星期六，等等。”&lt;/p&gt;&lt;p&gt;然后我们将布尔表达式传递给dataframe，它只返回True值。我们现在有一个包含未来3年交易日的预测数据。&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;forecast&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;future&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;forecast&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tail&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-76c9ee4e56ab44ddff2065e1be54e66a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;363&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-76c9ee4e56ab44ddff2065e1be54e66a_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-76c9ee4e56ab44ddff2065e1be54e66a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;363&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-76c9ee4e56ab44ddff2065e1be54e66a_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-76c9ee4e56ab44ddff2065e1be54e66a_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;我们从模型中调用predict的预测，并在前面创建的future的dataframe中传递该预测。我们在一个名为forecast的新dataframe中返回结果。&lt;/p&gt;&lt;p&gt;当我们查看预测数据时，会看到一堆新术语。我们最感兴趣的是yhat，它是我们的预测值。（yhat是y的预测）&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-3ac5c9099150ae7957fd5dc0e9b81e13_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;712&quot; data-rawheight=&quot;424&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;712&quot; data-original=&quot;https://pic4.zhimg.com/v2-3ac5c9099150ae7957fd5dc0e9b81e13_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-3ac5c9099150ae7957fd5dc0e9b81e13_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;712&quot; data-rawheight=&quot;424&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;712&quot; data-original=&quot;https://pic4.zhimg.com/v2-3ac5c9099150ae7957fd5dc0e9b81e13_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-3ac5c9099150ae7957fd5dc0e9b81e13_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot_components&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;forecast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-e6e1d121e46df4f3a6a05c21832e475f_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;640&quot; data-rawheight=&quot;640&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;640&quot; data-original=&quot;https://pic4.zhimg.com/v2-e6e1d121e46df4f3a6a05c21832e475f_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-e6e1d121e46df4f3a6a05c21832e475f_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;640&quot; data-rawheight=&quot;640&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;640&quot; data-original=&quot;https://pic4.zhimg.com/v2-e6e1d121e46df4f3a6a05c21832e475f_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-e6e1d121e46df4f3a6a05c21832e475f_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;Prophet提供了两个方便的可视化助手，plot和plot_components。plot函数创建了实际/预测的图表，plot_components提供了趋势/季节性的图表。&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;stock_price_forecast&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;forecast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;yhat&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;yhat_lower&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;yhat_upper&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;merge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stock_price_forecast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;how&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;right&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;royalblue&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;#34495e&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;#e74c3c&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;#e74c3c&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-ec1f34b5c3c56f77b492e6b6e2bf5246_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;942&quot; data-rawheight=&quot;451&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;942&quot; data-original=&quot;https://pic3.zhimg.com/v2-ec1f34b5c3c56f77b492e6b6e2bf5246_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-ec1f34b5c3c56f77b492e6b6e2bf5246_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;942&quot; data-rawheight=&quot;451&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;942&quot; data-original=&quot;https://pic3.zhimg.com/v2-ec1f34b5c3c56f77b492e6b6e2bf5246_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-ec1f34b5c3c56f77b492e6b6e2bf5246_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;可视化助手只是使用我们的预测dataframe中的数据。我们可以重新创建相同的图表。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;模拟预测&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;虽然我们在上面创建的3年预测非常酷，但我们不想在没有使用交易策略对业绩进行反向测试的情况下就对其做出任何交易决定。&lt;/p&gt;&lt;p&gt;在本节中，我们将模拟Prophet在1980年就已经存在，并使用它来创建到2019年的月度预测。然后，我们将在下一节中使用这些数据来模拟各种交易策略对我们刚刚购买并持有该股票的效果。&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;dayname&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;day_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;month&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;year&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month/year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;/&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; 

&lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;merge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
&lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month/year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;drop_duplicates&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;drop&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month/year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;how&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;left&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;columns&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month/year_index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tail&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-76fb4468f5ff6606a0744645e484fb14_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;336&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-76fb4468f5ff6606a0744645e484fb14_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-76fb4468f5ff6606a0744645e484fb14_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;336&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-76fb4468f5ff6606a0744645e484fb14_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-76fb4468f5ff6606a0744645e484fb14_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;在模拟月度预测之前，我们需要向stock_price dataframe添加一些列，这是我们在这个项目开始时创建的，目的是使它更容易使用。添加month、year、month/year和month/year_index。&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;loop_list&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month/year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;unique&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tolist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;max_num&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loop_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;forecast_frames&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;item&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loop_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_num&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;pass&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month/year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loop_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]][&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;\
        &lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month/year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()]&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()[[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;y&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Prophet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;future&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month/year_index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)][[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;forecast&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;future&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;forecast_frames&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;forecast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;stock_price_forecast&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;reduce&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;lambda&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;top&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bottom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;concat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;top&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bottom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sort&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;forecast_frames&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;stock_price_forecast&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stock_price_forecast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;yhat&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;yhat_lower&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;yhat_upper&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;stock_price_forecast&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to_csv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;stock_price_forecast.csv&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;基本上我们在stock_price中循环每个月/年，并将预测模型与该时期可用的股票数据进行拟合，然后提前一个月预测。继续这样做，直到最后一个月/年。最后，将这些预测合并到一个名为stock_price_forecast的数据框中。将结果保存在csv文件中，这样如果需要重置数据，就不必再次运行模型。&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;stock_price_forecast&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read_csv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;stock_price_forecast.csv&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;parse_dates&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;merge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;y&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;month/year_index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stock_price_forecast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Percent Change&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;y&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pct_change&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;y&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;yhat&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;yhat_lower&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;yhat_upper&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;royalblue&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;#34495e&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;#e74c3c&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;#e74c3c&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-fcd13149db737b375f4e83ea12ed214a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;942&quot; data-rawheight=&quot;451&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;942&quot; data-original=&quot;https://pic3.zhimg.com/v2-fcd13149db737b375f4e83ea12ed214a_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-fcd13149db737b375f4e83ea12ed214a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;942&quot; data-rawheight=&quot;451&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;942&quot; data-original=&quot;https://pic3.zhimg.com/v2-fcd13149db737b375f4e83ea12ed214a_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-fcd13149db737b375f4e83ea12ed214a_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-0421851ac9849b522a5a0957284e994d_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;310&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-0421851ac9849b522a5a0957284e994d_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-0421851ac9849b522a5a0957284e994d_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;310&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-0421851ac9849b522a5a0957284e994d_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-0421851ac9849b522a5a0957284e994d_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;最后，我们将预测与实际价格结合起来，创建一个百分比变化列，将在下面的交易算法中使用。最后，将预测与实际情况作图，以查看它的表现如何。正如你所看到的，有一点延迟。它的行为很像移动平均线。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;交易算法&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;创建了四个初始交易算法:&lt;/p&gt;&lt;p&gt;&lt;b&gt;Hold：&lt;/b&gt;这是一种买入并持有的策略。也就是说，我们买股票并持有到最后一段时间。&lt;/p&gt;&lt;p&gt;&lt;b&gt;Prophet：&lt;/b&gt;这种策略是当我们的预测显示下跌趋势时卖出，当我的预测显示上涨趋势时买进&lt;/p&gt;&lt;p&gt;&lt;b&gt;Prophet Thresh：&lt;/b&gt;这个策略是只有当股票价格跌破我们的yhat_lower边界时才卖出。&lt;/p&gt;&lt;p&gt;&lt;b&gt;Seasonality：&lt;/b&gt;这一策略是在8月退出市场，重新进入Ocober。这是基于上面的季节性图表。&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dropna&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Hold&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Prophet&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Prophet Thresh&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Seasonality&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Hold = {df[&amp;#39;Hold&amp;#39;].iloc[-1]*1000:,.0f}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Prophet = {df[&amp;#39;Prophet&amp;#39;].iloc[-1]*1000:,.0f}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Prophet Thresh = {df[&amp;#39;Prophet Thresh&amp;#39;].iloc[-1]*1000:,.0f}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Seasonality = {df[&amp;#39;Seasonality&amp;#39;].iloc[-1]*1000:,.0f}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Hold = 24,396&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;Prophet&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;13&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;366&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Prophet&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Thresh&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;17&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;087&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Seasonality&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;861&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-ad538c9b61d3505281065ccb1568b64c_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;949&quot; data-rawheight=&quot;451&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;949&quot; data-original=&quot;https://pic1.zhimg.com/v2-ad538c9b61d3505281065ccb1568b64c_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-ad538c9b61d3505281065ccb1568b64c_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;949&quot; data-rawheight=&quot;451&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;949&quot; data-original=&quot;https://pic1.zhimg.com/v2-ad538c9b61d3505281065ccb1568b64c_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-ad538c9b61d3505281065ccb1568b64c_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;br/&gt;&lt;br/&gt;我们绘制了初始资金为1000美元初始模拟策略结果。你可以看到季节性做得最好，持有策略其次。两种基于Prophet的策略都做得不太好。让我们看看是否可以通过优化阈值来改进Prophet Thresh。&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;performance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;linspace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;99&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;y&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;yhat_lower&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shift&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Percent Change&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cumprod&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;performance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;best_yhat&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataFrame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;performance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;idxmax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataFrame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;performance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Best Yhat = {best_yhat:,.2f}&amp;#39;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-c3da8947278b18c32ba9ec2fc3cebf64_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;930&quot; data-rawheight=&quot;469&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;930&quot; data-original=&quot;https://pic1.zhimg.com/v2-c3da8947278b18c32ba9ec2fc3cebf64_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-c3da8947278b18c32ba9ec2fc3cebf64_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;930&quot; data-rawheight=&quot;469&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;930&quot; data-original=&quot;https://pic1.zhimg.com/v2-c3da8947278b18c32ba9ec2fc3cebf64_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-c3da8947278b18c32ba9ec2fc3cebf64_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;br/&gt;上面我们循环遍历不同百分比的thresh以找到最优的thresh。最佳阈值是当前yhat_lower值的92%。&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Optimized Prophet Thresh&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;y&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;yhat_lower&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;best_yhat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shift&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; 
&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Percent Change&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cumprod&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dropna&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Hold&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Prophet&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Prophet Thresh&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;&amp;#39;Seasonality&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Optimized Prophet Thresh&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Hold = {df[&amp;#39;Hold&amp;#39;].iloc[-1]*1000:,.0f}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Prophet = {df[&amp;#39;Prophet&amp;#39;].iloc[-1]*1000:,.0f}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Prophet Thresh = {df[&amp;#39;Prophet Thresh&amp;#39;].iloc[-1]*1000:,.0f}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Seasonality = {df[&amp;#39;Seasonality&amp;#39;].iloc[-1]*1000:,.0f}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Optimized Prophet Thresh = {df[&amp;#39;Optimized Prophet Thresh&amp;#39;].iloc[-1]*1000:,.0f}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;Hold&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;24&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;396&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Prophet&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;13&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;366&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Prophet&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Thresh&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;17&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;087&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Seasonality&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;861&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Optimized&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Prophet&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Thresh&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;36&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;375&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-0ad0a24f068be2d35b99f1cc76ff2b2d_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;949&quot; data-rawheight=&quot;451&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;949&quot; data-original=&quot;https://pic2.zhimg.com/v2-0ad0a24f068be2d35b99f1cc76ff2b2d_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-0ad0a24f068be2d35b99f1cc76ff2b2d_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;949&quot; data-rawheight=&quot;451&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;949&quot; data-original=&quot;https://pic2.zhimg.com/v2-0ad0a24f068be2d35b99f1cc76ff2b2d_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-0ad0a24f068be2d35b99f1cc76ff2b2d_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;以上我们看到的是新的最佳交易策略。不幸的是，无论是优化的ProphetThresh都在有问题，&lt;b&gt;因为他们使用的数据有未来函数存在，而这些数据在我们交易的时候是不可用的&lt;/b&gt;。我们将需要为我们预测的每个当前时间点创建一个优化的Thresh。&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;fcst_thresh&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;index&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month/year_index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;unique&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()):&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;temp_df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month/year_index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month/year_index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;unique&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]][&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;\
        &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month/year_index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()]&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;performance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;thresh&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;linspace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;99&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;percent&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;temp_df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;y&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;temp_df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;yhat_lower&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;thresh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shift&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;temp_df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Percent Change&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cumprod&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;performance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;thresh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;percent&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;best_thresh&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataFrame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;performance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;idxmax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month/year_index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;unique&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;pass&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fcst_thresh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month/year_index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;unique&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;best_thresh&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fcst_thresh&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataFrame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fcst_thresh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;columns&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month/year_index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Fcst Thresh&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fcst_thresh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Fcst Thresh&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-277d239e051fb896a52146f5a9d92301_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;933&quot; data-rawheight=&quot;469&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;933&quot; data-original=&quot;https://pic2.zhimg.com/v2-277d239e051fb896a52146f5a9d92301_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-277d239e051fb896a52146f5a9d92301_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;933&quot; data-rawheight=&quot;469&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;933&quot; data-original=&quot;https://pic2.zhimg.com/v2-277d239e051fb896a52146f5a9d92301_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-277d239e051fb896a52146f5a9d92301_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;循环遍历数据，并为当前时间点找到到目前为止的最佳阈值百分比。正如你所看到的，随着时间的推移（1980年1月1日- 2019年3月18日），当前的thresh的百分比会跳跃。&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;yhat_optimized&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;merge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fcst_thresh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month/year_index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;how&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;left&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Fcst Thresh&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shift&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;yhat_lower&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Prophet Fcst Thresh&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;y&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;yhat_optimized&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shift&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Percent Change&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cumprod&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dropna&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Hold&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Prophet&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Prophet Thresh&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Prophet Fcst Thresh&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Hold = {df[&amp;#39;Hold&amp;#39;].iloc[-1]*1000:,.0f}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Prophet = {df[&amp;#39;Prophet&amp;#39;].iloc[-1]*1000:,.0f}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Prophet Thresh = {df[&amp;#39;Prophet Thresh&amp;#39;].iloc[-1]*1000:,.0f}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# print(f&amp;#34;Seasonality = {df[&amp;#39;Seasonality&amp;#39;].iloc[-1]*1000:,.0f}&amp;#34;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Prophet Fcst Thresh = {df[&amp;#39;Prophet Fcst Thresh&amp;#39;].iloc[-1]*1000:,.0f}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Hold&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;24&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;396&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Prophet&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;13&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;366&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Prophet&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Thresh&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;17&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;087&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Prophet&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Fcst&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Thresh&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;620&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-d155b463825af5986d9a4ece4eadb611_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;949&quot; data-rawheight=&quot;451&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;949&quot; data-original=&quot;https://pic2.zhimg.com/v2-d155b463825af5986d9a4ece4eadb611_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-d155b463825af5986d9a4ece4eadb611_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;949&quot; data-rawheight=&quot;451&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;949&quot; data-original=&quot;https://pic2.zhimg.com/v2-d155b463825af5986d9a4ece4eadb611_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-d155b463825af5986d9a4ece4eadb611_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;就像我们在创建新的交易策略并绘制图表所做的那样。不幸的是，结果变得更糟，但我们做得比我们最初的ProphetThresh更好。我们不使用到目前为止的整个周期来计算thresh，而是像移动平均线（30、60、90等等），尝试各种滚动窗口的时间。&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;rolling_thresh&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;index&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month/year_index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;unique&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()):&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;rolling_performance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;roll&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;400&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;temp_df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month/year_index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DateOffset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;months&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;roll&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;\
            &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month/year_index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()]&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;performance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;thresh&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;linspace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;99&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;percent&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;temp_df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;y&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;temp_df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;yhat_lower&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;thresh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shift&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;temp_df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Percent Change&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cumprod&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;performance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;thresh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;percent&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;per_df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataFrame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;performance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;best_thresh&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;per_df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;idxmax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;percents&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;per_df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;best_thresh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;rolling_performance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;best_thresh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;percents&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;per_df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataFrame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rolling_performance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;best_rolling_thresh&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;per_df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;idxmax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month/year_index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;unique&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;pass&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;rolling_thresh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month/year_index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;unique&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;best_rolling_thresh&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;rolling_thresh&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataFrame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rolling_thresh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;columns&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month/year_index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Fcst Thresh&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;rolling_thresh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Fcst Thresh&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-d71538707faa3a62600bc9e7cfba0774_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;933&quot; data-rawheight=&quot;469&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;933&quot; data-original=&quot;https://pic1.zhimg.com/v2-d71538707faa3a62600bc9e7cfba0774_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-d71538707faa3a62600bc9e7cfba0774_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;933&quot; data-rawheight=&quot;469&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;933&quot; data-original=&quot;https://pic1.zhimg.com/v2-d71538707faa3a62600bc9e7cfba0774_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-d71538707faa3a62600bc9e7cfba0774_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;上面和以前很相似，但是现在我们尝试了不同的移动窗口和不同的阈值百分比。这变得相当复杂。从上面可以看到，随着时间的推移，阈值百分比随时间而变化。现在让我们看看我们是怎么做的。&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;yhat_optimized&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;merge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rolling_thresh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month/year_index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;how&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;left&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Fcst Thresh&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fillna&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shift&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;yhat_lower&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Prophet Rolling Thresh&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;y&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;yhat_optimized&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shift&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Percent Change&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cumprod&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dropna&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Hold&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Prophet&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Prophet Thresh&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Prophet Fcst Thresh&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Prophet Rolling Thresh&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Hold = {df[&amp;#39;Hold&amp;#39;].iloc[-1]*1000:,.0f}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Prophet = {df[&amp;#39;Prophet&amp;#39;].iloc[-1]*1000:,.0f}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Prophet Thresh = {df[&amp;#39;Prophet Thresh&amp;#39;].iloc[-1]*1000:,.0f}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# print(f&amp;#34;Seasonality = {df[&amp;#39;Seasonality&amp;#39;].iloc[-1]*1000:,.0f}&amp;#34;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Prophet Fcst Thresh = {df[&amp;#39;Prophet Fcst Thresh&amp;#39;].iloc[-1]*1000:,.0f}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Prophet Rolling Thresh = {df[&amp;#39;Prophet Rolling Thresh&amp;#39;].iloc[-1]*1000:,.0f}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;Hold&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;24&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;396&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Prophet&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;13&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;366&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Prophet&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Thresh&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;17&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;087&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Prophet&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Fcst&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Thresh&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;620&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Prophet&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Rolling&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Thresh&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;23&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;621&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-5758d5567355ff6af5249f4b073d8efd_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;949&quot; data-rawheight=&quot;451&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;949&quot; data-original=&quot;https://pic2.zhimg.com/v2-5758d5567355ff6af5249f4b073d8efd_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-5758d5567355ff6af5249f4b073d8efd_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;949&quot; data-rawheight=&quot;451&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;949&quot; data-original=&quot;https://pic2.zhimg.com/v2-5758d5567355ff6af5249f4b073d8efd_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-5758d5567355ff6af5249f4b073d8efd_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;正如你所看到的，仍然没有击败最简单买入持有策略。也许&lt;b&gt;&lt;i&gt;&amp;#34;Time in the Market is better then Timing the Market&amp;#34;&lt;/i&gt;&lt;/b&gt;这句话有一定道理。&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Time Traveler&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;y&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shift&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;yhat&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shift&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Percent Change&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cumprod&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dropna&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Hold&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Prophet&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Prophet Thresh&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Prophet Fcst Thresh&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Prophet Rolling Thresh&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Time Traveler&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Hold = {df[&amp;#39;Hold&amp;#39;].iloc[-1]*1000:,.0f}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Prophet = {df[&amp;#39;Prophet&amp;#39;].iloc[-1]*1000:,.0f}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Prophet Thresh = {df[&amp;#39;Prophet Thresh&amp;#39;].iloc[-1]*1000:,.0f}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# print(f&amp;#34;Seasonality = {df[&amp;#39;Seasonality&amp;#39;].iloc[-1]*1000:,.0f}&amp;#34;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Prophet Fcst Thresh = {df[&amp;#39;Prophet Fcst Thresh&amp;#39;].iloc[-1]*1000:,.0f}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Prophet Rolling Thresh = {df[&amp;#39;Prophet Rolling Thresh&amp;#39;].iloc[-1]*1000:,.0f}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Time Traveler = {df[&amp;#39;Time Traveler&amp;#39;].iloc[-1]*1000:,.0f}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;Hold&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;24&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;396&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Prophet&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;13&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;366&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Prophet&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Thresh&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;17&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;087&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Prophet&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Fcst&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Thresh&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;620&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Prophet&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Rolling&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Thresh&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;23&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;621&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Time&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Traveler&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;288&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;513&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-0f9c4d18e75b18e515b0062412e9d5bb_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;955&quot; data-rawheight=&quot;451&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;955&quot; data-original=&quot;https://pic4.zhimg.com/v2-0f9c4d18e75b18e515b0062412e9d5bb_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-0f9c4d18e75b18e515b0062412e9d5bb_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;955&quot; data-rawheight=&quot;451&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;955&quot; data-original=&quot;https://pic4.zhimg.com/v2-0f9c4d18e75b18e515b0062412e9d5bb_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-0f9c4d18e75b18e515b0062412e9d5bb_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;上面是Time Traveler策略。这当然是一个完美的交易策略，因为我们事先知道当市场上下波动。你最多能从1000美元中赚到288,513美元。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;总结&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;时间序列预测是非常复杂的，但Prophet使它非常容易创建稳健的预测，只需很少的努力。虽然它并没有使我们对股票市场的预测变得丰富，但是它仍然非常有用，并且可以快速地来解决不同领域的许多问题。&lt;i&gt;原文：&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//www.gardnmi.com/post/forecasting-stock-perfomance-with-prophet%23Simulating-Forecasts&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://www.&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;gardnmi.com/post/foreca&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;sting-stock-perfomance-with-prophet#Simulating-Forecasts&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/i&gt;&lt;/p&gt;&lt;p&gt;&lt;i&gt;—End—&lt;/i&gt;&lt;/p&gt;&lt;p&gt;量化投资与机器学习微信公众号，是业内垂直于&lt;b&gt;Quant&lt;/b&gt;、&lt;b&gt;MFE&lt;/b&gt;、&lt;b&gt;CST&lt;/b&gt;等专业的主流自媒体。公众号拥有来自&lt;b&gt;公募、私募、券商、银行、海外&lt;/b&gt;等众多圈内&lt;b&gt;10W+&lt;/b&gt;关注者。每日发布行业前沿研究成果和最新资讯。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>量化投资机器学习</author>
<guid isPermaLink="false">2019-04-08-61746724</guid>
<pubDate>Mon, 08 Apr 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>干货 | 如何用一行代码在多CPU环境下高效并行Pandas</title>
<link>https://henix.github.io/feeds/zhuanlan.Lhtz-Jqxx/2019-04-08-61746020.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/61746020&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-4f467d15a0b6c9cba5345ca6b0406c01_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;▎作者：Manu NALEPA&lt;/p&gt;&lt;p&gt;&lt;b&gt;▎&lt;/b&gt;编译：公众号翻译部&lt;/p&gt;&lt;p&gt;本文中介绍的&lt;b&gt;库只支持Linux&lt;/b&gt;和&lt;b&gt;MacOS&lt;/b&gt;。&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;安装文件文末下载&lt;/b&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-f7d3a12c6cd5494f3efb20eb28c99c14_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;310&quot; data-rawheight=&quot;228&quot; class=&quot;content_image&quot; width=&quot;310&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-f7d3a12c6cd5494f3efb20eb28c99c14_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;310&quot; data-rawheight=&quot;228&quot; class=&quot;content_image lazy&quot; width=&quot;310&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-f7d3a12c6cd5494f3efb20eb28c99c14_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;h2&gt;&lt;b&gt;什么问题困扰着我们?&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;对于Pandas，当你运行以下代码行时：&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;apply&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-41a8929271ebf00fa11d84837b9d8305_b.gif&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;699&quot; data-rawheight=&quot;159&quot; data-thumbnail=&quot;https://pic2.zhimg.com/v2-41a8929271ebf00fa11d84837b9d8305_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;699&quot; data-original=&quot;https://pic2.zhimg.com/v2-41a8929271ebf00fa11d84837b9d8305_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-41a8929271ebf00fa11d84837b9d8305_b.gif&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;699&quot; data-rawheight=&quot;159&quot; data-thumbnail=&quot;https://pic2.zhimg.com/v2-41a8929271ebf00fa11d84837b9d8305_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;699&quot; data-original=&quot;https://pic2.zhimg.com/v2-41a8929271ebf00fa11d84837b9d8305_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-41a8929271ebf00fa11d84837b9d8305_b.gif&quot;/&gt;&lt;figcaption&gt;只使用一个CPU&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;即使你的计算机有多个CPU，也只有一个CPU是完全用于计算的。&lt;/p&gt;&lt;p&gt;我们希望用一种简单的方法来代替CPU的使用：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-ccd581d0b1cc4660349369d7aca42033_b.gif&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;699&quot; data-rawheight=&quot;159&quot; data-thumbnail=&quot;https://pic4.zhimg.com/v2-ccd581d0b1cc4660349369d7aca42033_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;699&quot; data-original=&quot;https://pic4.zhimg.com/v2-ccd581d0b1cc4660349369d7aca42033_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-ccd581d0b1cc4660349369d7aca42033_b.gif&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;699&quot; data-rawheight=&quot;159&quot; data-thumbnail=&quot;https://pic4.zhimg.com/v2-ccd581d0b1cc4660349369d7aca42033_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;699&quot; data-original=&quot;https://pic4.zhimg.com/v2-ccd581d0b1cc4660349369d7aca42033_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-ccd581d0b1cc4660349369d7aca42033_b.gif&quot;/&gt;&lt;figcaption&gt;所有CPU齐上阵&lt;/figcaption&gt;&lt;/figure&gt;&lt;h2&gt;&lt;b&gt;Pandaral·lel如何解决这个问题？&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;Pandaral·lel的理念是将Pandas计算分配到计算机上所有可用的CPU上，以获得显著的速度提升。&lt;/p&gt;&lt;p&gt;&lt;b&gt;▍安装&lt;/b&gt;&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pip&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pandarallel&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;▍初始化&lt;/b&gt;&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Import&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pandarallel&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pandarallel&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Initialization&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pandarallel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;initialize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;▍用法&lt;/b&gt;&lt;/p&gt;&lt;p&gt;对于一个带有Pandas DataFrame df的简单用例和一个应用func的函数，只需用parallel_apply替换经典的apply。&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Standard pandas apply&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;apply&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Parallel apply&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parallel_apply&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;注意，如果不想并行化计算，仍然可以使用经典的apply方法。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-8c9b6df16ab6fbc7250bf00cd9ca7587_b.gif&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;758&quot; data-rawheight=&quot;76&quot; data-thumbnail=&quot;https://pic4.zhimg.com/v2-8c9b6df16ab6fbc7250bf00cd9ca7587_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;758&quot; data-original=&quot;https://pic4.zhimg.com/v2-8c9b6df16ab6fbc7250bf00cd9ca7587_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-8c9b6df16ab6fbc7250bf00cd9ca7587_b.gif&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;758&quot; data-rawheight=&quot;76&quot; data-thumbnail=&quot;https://pic4.zhimg.com/v2-8c9b6df16ab6fbc7250bf00cd9ca7587_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;758&quot; data-original=&quot;https://pic4.zhimg.com/v2-8c9b6df16ab6fbc7250bf00cd9ca7587_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-8c9b6df16ab6fbc7250bf00cd9ca7587_b.gif&quot;/&gt;&lt;/figure&gt;&lt;p&gt;你还可以通过在initialize函数中传递progress_bar=True来显示每个工作CPU的一个进度条。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-d89300ae2d13ccde85b67da1cde4c94a_b.gif&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;728&quot; data-rawheight=&quot;238&quot; data-thumbnail=&quot;https://pic3.zhimg.com/v2-d89300ae2d13ccde85b67da1cde4c94a_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;728&quot; data-original=&quot;https://pic3.zhimg.com/v2-d89300ae2d13ccde85b67da1cde4c94a_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-d89300ae2d13ccde85b67da1cde4c94a_b.gif&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;728&quot; data-rawheight=&quot;238&quot; data-thumbnail=&quot;https://pic3.zhimg.com/v2-d89300ae2d13ccde85b67da1cde4c94a_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;728&quot; data-original=&quot;https://pic3.zhimg.com/v2-d89300ae2d13ccde85b67da1cde4c94a_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-d89300ae2d13ccde85b67da1cde4c94a_b.gif&quot;/&gt;&lt;/figure&gt;&lt;p&gt;在一个更加复杂的Pandas DataFrame df用例中，DataFrame column1和column2的两列，以及一个函数用于func：&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Standard pandas apply&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;groupby&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;column1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;column2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rolling&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;apply&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Parallel apply&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;groupby&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;column1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;column2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rolling&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parallel_apply&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;基准&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;以下是其中四个例子的配置：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;操作系统：Linux Ubuntu 16.04&lt;/li&gt;&lt;li&gt;硬件：Intel Core i7 @ 3.40 GHz - 4核&lt;/li&gt;&lt;/ul&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load_ext&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;autoreload&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;autoreload&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pandas&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pd&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;time&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pandarallel&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pandarallel&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;math&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;▍DataFrame.apply&lt;/b&gt;&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;f_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;5e6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataFrame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;dict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;apply&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res_parallel&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parallel_apply&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;equals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;res_parallel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;▍DataFrame.applymap&lt;/b&gt;&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;df_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1e7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataFrame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;dict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;applymap&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res_parallel&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parallel_applymap&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;equals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;res_parallel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;▍DataFrame.groupby.apply&lt;/b&gt;&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;df_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;3e7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataFrame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;dict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;


&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;dum&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;item&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;dum&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;log10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dum&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;groupby&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;a&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;apply&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res_parallel&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;groupby&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;a&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parallel_apply&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;equals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;res_parallel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;▍DataFrame.groupby.rolling.apply&lt;/b&gt;&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;df_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1e6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataFrame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;dict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;300&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;groupby&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rolling&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;apply&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;raw&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res_parallel&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;groupby&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rolling&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parallel_apply&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;raw&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;equals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;res_parallel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-17cc5af8933e3f513c0bc10edd9b1cb7_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;954&quot; data-rawheight=&quot;507&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;954&quot; data-original=&quot;https://pic4.zhimg.com/v2-17cc5af8933e3f513c0bc10edd9b1cb7_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-17cc5af8933e3f513c0bc10edd9b1cb7_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;954&quot; data-rawheight=&quot;507&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;954&quot; data-original=&quot;https://pic4.zhimg.com/v2-17cc5af8933e3f513c0bc10edd9b1cb7_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-17cc5af8933e3f513c0bc10edd9b1cb7_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;h2&gt;标准 vs 并行四核（越低越好）&lt;/h2&gt;&lt;p&gt;除了df.groupby.col_name.rolling。如果应用程序的速度只增加了x3.2倍，那么平均速度就会增加大约x4倍，即使用的计算机上的内核数量。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;▍Series.map&lt;/b&gt;&lt;/h2&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;df_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;5e7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataFrame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;dict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;log10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res_parallel&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parallel_map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;equals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;res_parallel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;▍Series.apply&lt;/b&gt;&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;df_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;3.5e7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataFrame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;dict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;power&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bias&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;log10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;power&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bias&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;apply&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bias&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res_parallel&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parallel_apply&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bias&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;equals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;res_parallel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;▍Series.rolling.apply&lt;/b&gt;&lt;/h2&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;df_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1e6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataFrame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;dict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))))&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rolling&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;apply&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;raw&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res_parallel&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rolling&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parallel_apply&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;raw&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;equals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;res_parallel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;警告&lt;/b&gt;&lt;/p&gt;&lt;p&gt;1、进度条是一项实验性功能。这可能导致相当大的性能损失。parallel_apply不能用于DataFrameGroupy.parallel_apply。&lt;/p&gt;&lt;p&gt;2、使用df一个Pandas DataFrame，series 一个 Pandas Series，func一个函数来应用/ map，args1，args2一些参数＆col_name一个列名：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-84500b949460f3003e71f86116a2f75a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;952&quot; data-rawheight=&quot;606&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;952&quot; data-original=&quot;https://pic3.zhimg.com/v2-84500b949460f3003e71f86116a2f75a_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-84500b949460f3003e71f86116a2f75a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;952&quot; data-rawheight=&quot;606&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;952&quot; data-original=&quot;https://pic3.zhimg.com/v2-84500b949460f3003e71f86116a2f75a_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-84500b949460f3003e71f86116a2f75a_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-66e42399020f09072ade303483560baa_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;601&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-66e42399020f09072ade303483560baa_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-66e42399020f09072ade303483560baa_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;601&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-66e42399020f09072ade303483560baa_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-66e42399020f09072ade303483560baa_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;h2&gt;&lt;b&gt;具体如何操作的？&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;调用parallel_apply时，Pandaral·lel：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;实例化Pyarrow Plasma shared memory。&lt;/li&gt;&lt;/ul&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//arrow.apache.org/docs/python/plasma.html&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;The Plasma In-Memory Object Store&lt;/a&gt;&lt;ul&gt;&lt;li&gt;为每个CPU创建一个子进程，并要求每个CPU处理DataFrame的一个子部分。&lt;/li&gt;&lt;li&gt;在父进程中组合所有结果。&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;与其他进程间通信媒介相比，使用共享内存的主要优点是不存在序列化/反序列化，这可能会导致CPU开销过大。&lt;/p&gt;&lt;p&gt;&lt;b&gt;警告&lt;/b&gt;&lt;/p&gt;&lt;p&gt;1、&lt;b&gt;并行化是有条件的&lt;/b&gt;（实现新进程，通过共享内存发送数据等等），所以&lt;b&gt;只有当并行化的计算量足够高时，并行化才有效&lt;/b&gt;。对于很少的数据，使用parallezation并不总是有效的。&lt;/p&gt;&lt;p&gt;2、应用的函数不应该是lambda函数。&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pandarallel&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pandarallel&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;math&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sin&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;pandarallel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;initialize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# FORBIDDEN&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parallel_apply&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;lambda&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# ALLOWED&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parallel_apply&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;问题排除&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;我有8个CPU，但是 &lt;i&gt;parallel_apply&lt;/i&gt; 只加快了大约x4的计算速度。为什么?&lt;/p&gt;&lt;p&gt;实际上，Pandarallel 只能加快计算速度，直到你计算机有大约核心的数量。最近大多数CPU（如Intel core-i7）都使用超线程。例如，一个4核的超线程CPU将向操作系统显示8个CPU，但实际上只有4个物理计算单元。&lt;/p&gt;&lt;p&gt;在Ubuntu上，你可以用如下获得内核的数量：&lt;/p&gt;&lt;p&gt;&lt;i&gt;$ grep - m1 &amp;#39;cpu core &amp;#39; /proc/cpuinfo.&lt;/i&gt;&lt;/p&gt;&lt;p&gt;当我运行如下时：&lt;/p&gt;&lt;p&gt;&lt;i&gt;from pandarallel import pandarallel&lt;/i&gt;&lt;/p&gt;&lt;p&gt;我得到：&lt;/p&gt;&lt;p&gt;&lt;i&gt;ModuleNotFoundError: No module named &amp;#39;pyarrow._plasma。&lt;/i&gt;&lt;/p&gt;&lt;p&gt;为什么?&lt;/p&gt;&lt;p&gt;目前，Pyarrow Plasma只在Linux和macOS上工作（不支持Windows）&lt;/p&gt;&lt;h2&gt;&lt;b&gt;如何获取代码&lt;/b&gt;&lt;/h2&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s/2-Ayzmzo8tydDLoKpz1Ezw&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic1.zhimg.com/v2-d1a7a1925a8fd1a1f884a8f891f8f7e0_180x120.jpg&quot; data-image-width=&quot;1280&quot; data-image-height=&quot;543&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;干货 | 如何用一行代码在多CPU环境下高效并行Pandas&lt;/a&gt;&lt;p&gt;&lt;i&gt;—End—&lt;/i&gt;&lt;/p&gt;&lt;p&gt;量化投资与机器学习微信公众号，是业内垂直于&lt;b&gt;Quant&lt;/b&gt;、&lt;b&gt;MFE&lt;/b&gt;、&lt;b&gt;CST&lt;/b&gt;等专业的&lt;b&gt;主流自媒体&lt;/b&gt;。公众号拥有来自&lt;b&gt;公募、私募、券商、银行、海外&lt;/b&gt;等众多圈内&lt;b&gt;10W+&lt;/b&gt;关注者。每日发布行业前沿研究成果和最新资讯。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>量化投资机器学习</author>
<guid isPermaLink="false">2019-04-08-61746020</guid>
<pubDate>Mon, 08 Apr 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>必须收藏 | 手把手教你几分钟内搭建自己强大的深度学习环境</title>
<link>https://henix.github.io/feeds/zhuanlan.Lhtz-Jqxx/2019-04-04-61405359.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/61405359&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-8cf58f2ca334ea6047160056046e435d_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;▎作者：Dipanjan Sarkar&lt;/p&gt;&lt;p&gt;&lt;b&gt;▎&lt;/b&gt;编译：&lt;b&gt;Remedios&lt;/b&gt; | 公众号翻译部&lt;/p&gt;&lt;h2&gt;&lt;b&gt;介绍&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;在此，向大数据致谢。不过，这里真正的MVP是更快更好的计算，这也使1980、90年代的论文具有更加重要的意义（LSTM诞生于1997）！&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-4ccf0df4a7d90cfcef3b6b3eac629b60_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;925&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-4ccf0df4a7d90cfcef3b6b3eac629b60_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-4ccf0df4a7d90cfcef3b6b3eac629b60_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;925&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-4ccf0df4a7d90cfcef3b6b3eac629b60_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-4ccf0df4a7d90cfcef3b6b3eac629b60_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;▍&lt;i&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//www.bioinf.jku.at/publications/older/2604.pdf&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://www.&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;bioinf.jku.at/publicati&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;ons/older/2604.pdf&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/i&gt;&lt;/p&gt;&lt;p&gt;因为有了更好更快的CPU和GPU，我们最终可以利用神经网络和深度学习。不管我们是否喜欢，传统统计和机器学习模型在高维、非结构化和更复杂更大体积的数据上有很大的限制性。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-3bfa74a6ed14bf9e584bc11dec155c57_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;940&quot; data-rawheight=&quot;548&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;940&quot; data-original=&quot;https://pic4.zhimg.com/v2-3bfa74a6ed14bf9e584bc11dec155c57_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-3bfa74a6ed14bf9e584bc11dec155c57_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;940&quot; data-rawheight=&quot;548&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;940&quot; data-original=&quot;https://pic4.zhimg.com/v2-3bfa74a6ed14bf9e584bc11dec155c57_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-3bfa74a6ed14bf9e584bc11dec155c57_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;深度学习在这些领域开始表现出众，并且我们已经渐渐开始看到行业在一些大规模的现实问题中开始接受它们。吴恩达自己几年前也开始提到这些可喜的事实。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-8c1b965684361df65315706fbecc4983_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1008&quot; data-rawheight=&quot;1314&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1008&quot; data-original=&quot;https://pic4.zhimg.com/v2-8c1b965684361df65315706fbecc4983_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-8c1b965684361df65315706fbecc4983_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1008&quot; data-rawheight=&quot;1314&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1008&quot; data-original=&quot;https://pic4.zhimg.com/v2-8c1b965684361df65315706fbecc4983_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-8c1b965684361df65315706fbecc4983_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;深度学习好的方面是&lt;/b&gt;，我们有更好的计算，更多的数据和广泛边界的开源框架供我们在建立解决方案时使用，如keras，tensorflow和pytorch。&lt;/p&gt;&lt;p&gt;&lt;b&gt;深度学习的缺点是什么？&lt;/b&gt;从头建立你自己的深度学习环境可能是一项非常艰巨的任务，特别是你迫切需要开始写代码实现你的深度学习模型时。&lt;/p&gt;&lt;p&gt;多次经历了这个痛苦的过程并发现简单的使用服务的方式之后，&lt;b&gt;我们写了这个指南旨在让你轻松快速地考虑建立你个人深度学习环境的各个必要方面，以便你能够更快更好地建立深度学习环境并解决问题&lt;/b&gt;。在这份指南中，我们将提到以下几个方面的内容：&lt;/p&gt;&lt;p&gt;&lt;b&gt;1、最小配置基于云的深度学习环境&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;2、建立你自己的基于云的深度学习环境&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;3、自有设置的建议&lt;/b&gt;&lt;/p&gt;&lt;p&gt;让我们立刻开始吧！&lt;/p&gt;&lt;h2&gt;&lt;b&gt;最小配置基于云的深度学习环境&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;如果你真的想要不在专用的硬件上做任何投资就建立深度学习环境，或者你想要跳过所有那些麻烦的配置和设置命令，&lt;/b&gt;这里有一些专为你准备的选项！使用一个预先配置好的基于云的深度学习环境是最佳选择。这里有几个基于云的深度学习服务提供商。下面的选择使你能够使用最少的配置和设置立刻开始工作。这是我们一个很好的综合列表，&lt;b&gt;其中的项目都是我们亲自用过或从同伴的深度学习从业者那里听说过的。&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Google Colaboratory&lt;/li&gt;&lt;ul&gt;&lt;li&gt;&lt;i&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//colab.research.google.com/&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;colab.research.google.com&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/i&gt;&lt;br/&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;Paperspace Gradient&lt;/li&gt;&lt;ul&gt;&lt;li&gt;&lt;i&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//www.paperspace.com/gradient&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://www.&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;paperspace.com/gradient&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/i&gt;&lt;br/&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;FloydHub Workspace&lt;/li&gt;&lt;ul&gt;&lt;li&gt;&lt;i&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//www.floydhub.com/product/build&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://www.&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;floydhub.com/product/bu&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;ild&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/i&gt;&lt;br/&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;Lambda GPU Cloud&lt;/li&gt;&lt;ul&gt;&lt;li&gt;&lt;i&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//lambdalabs.com/service/gpu-cloud&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;lambdalabs.com/service/&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;gpu-cloud&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/i&gt;&lt;br/&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;AWS Deep Learning AMIs&lt;/li&gt;&lt;ul&gt;&lt;li&gt;&lt;i&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//aws.amazon.com/cn/machine-learning/amis/&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;aws.amazon.com/cn/machi&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;ne-learning/amis/&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/i&gt;&lt;br/&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;GCP Deep Learning VM Images&lt;/li&gt;&lt;ul&gt;&lt;li&gt;&lt;i&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//cloud.google.com/deep-learning-vm&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;cloud.google.com/deep-l&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;earning-vm&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/i&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;p&gt;我们会介绍这些提供商的概要以便你了解得足够清楚来以它们开始。除此之外，我们鼓励你走出去进一步探索它们并基于你的喜好选择其中之一。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;Google Colaboratory&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;可能是最好的之一并且仍然是谷歌的免费产品&lt;/b&gt;，使你能够在一个依靠GPU甚至是TPU的深度学习环境中运行可交互的Jupyter notebook。谷歌一直积极地在使用和促进这个产品在很多方面的用途，包括他们广受欢迎的机器学习速成班（Machine Learning Crash Course）。总而言之，Colarboratory 是一个免费的Jupyter notebook 环境不需要任何社会中并且使你能够运行你自己的机器学习模型甚至无需任何花费就能使用一个GPU。&lt;/p&gt;&lt;p&gt;默认情况下你就得到了一个依靠CPU建立的下载了所有库的深度学习环境，你可以用以下代码来验证这些事实：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-69e3d63fb4101385cc49a7dd90924e2a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;434&quot; data-rawheight=&quot;435&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;434&quot; data-original=&quot;https://pic3.zhimg.com/v2-69e3d63fb4101385cc49a7dd90924e2a_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-69e3d63fb4101385cc49a7dd90924e2a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;434&quot; data-rawheight=&quot;435&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;434&quot; data-original=&quot;https://pic3.zhimg.com/v2-69e3d63fb4101385cc49a7dd90924e2a_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-69e3d63fb4101385cc49a7dd90924e2a_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;现在，使用一个CPU对于相对简单、工作量和数据更少的的模型已经足够了，你肯定需要对更复杂的问题使用GPU。正如在下面的截图中展示的，改变Google Colab的运行时间来使用一个GPU仅仅会多花几秒钟。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-c39b08b9d5e1a017dcee13542a99c973_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1043&quot; data-rawheight=&quot;543&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1043&quot; data-original=&quot;https://pic4.zhimg.com/v2-c39b08b9d5e1a017dcee13542a99c973_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-c39b08b9d5e1a017dcee13542a99c973_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1043&quot; data-rawheight=&quot;543&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1043&quot; data-original=&quot;https://pic4.zhimg.com/v2-c39b08b9d5e1a017dcee13542a99c973_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-c39b08b9d5e1a017dcee13542a99c973_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;Google Colab然后分配出一个新的GPU使你的深度学习环境配置完成，你可以通过下列代码看GPU类型。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-0f6d766c9bcc668a790c8987efccd317_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;704&quot; data-rawheight=&quot;453&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;704&quot; data-original=&quot;https://pic4.zhimg.com/v2-0f6d766c9bcc668a790c8987efccd317_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-0f6d766c9bcc668a790c8987efccd317_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;704&quot; data-rawheight=&quot;453&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;704&quot; data-original=&quot;https://pic4.zhimg.com/v2-0f6d766c9bcc668a790c8987efccd317_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-0f6d766c9bcc668a790c8987efccd317_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;似乎你免费得到了一个含12GB记忆的Tesla K80 GPU ！那是 AWS p2.xlarge  以0.9刀每小时的价格供给你的。&lt;/b&gt;最终你可以使用以下代码来确认你的深度学习库正在使用GPU。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-fc76dcfebbfb8a1b8ebed7b889a283b3_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;889&quot; data-rawheight=&quot;471&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;889&quot; data-original=&quot;https://pic4.zhimg.com/v2-fc76dcfebbfb8a1b8ebed7b889a283b3_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-fc76dcfebbfb8a1b8ebed7b889a283b3_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;889&quot; data-rawheight=&quot;471&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;889&quot; data-original=&quot;https://pic4.zhimg.com/v2-fc76dcfebbfb8a1b8ebed7b889a283b3_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-fc76dcfebbfb8a1b8ebed7b889a283b3_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;这应该使你能够在Google Colab上尝试运行你自己的深度学习模型。轻松利用 my colab notebook来测试依靠于CPU和GPU的深度学习环境吧！&lt;/p&gt;&lt;h2&gt;&lt;b&gt;Paperspace Gradient°&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;Gradient°是由致力于机器学习和数据科学的轻松基础设施的公司Paperspace的产品。&lt;b&gt;它给开发者一套完整的工具来探索数据，训练深度学习模型并且在GPU上运行计算工作。Gradient°完全依靠Paperspace GPU云的一键Jupyter notebook。&lt;/b&gt;我们从油桶上下载了这个视频，更进一步详细地进行了介绍。&lt;/p&gt;&lt;a class=&quot;video-box&quot; href=&quot;https://link.zhihu.com/?target=https%3A//www.zhihu.com/video/1097104208796499968&quot; target=&quot;_blank&quot; data-video-id=&quot;&quot; data-video-playable=&quot;true&quot; data-name=&quot;&quot; data-poster=&quot;https://pic2.zhimg.com/v2-8fa64ed322250133bfb7abec07e38fdf.jpg&quot; data-lens-id=&quot;1097104208796499968&quot;&gt;&lt;img class=&quot;thumbnail&quot; src=&quot;https://pic2.zhimg.com/v2-8fa64ed322250133bfb7abec07e38fdf.jpg&quot;/&gt;&lt;span class=&quot;content&quot;&gt;&lt;span class=&quot;title&quot;&gt;&lt;span class=&quot;z-ico-extern-gray&quot;&gt;&lt;/span&gt;&lt;span class=&quot;z-ico-extern-blue&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;url&quot;&gt;&lt;span class=&quot;z-ico-video&quot;&gt;&lt;/span&gt;https://www.zhihu.com/video/1097104208796499968&lt;/span&gt;&lt;/span&gt;&lt;/a&gt;&lt;p&gt;下面是他们的一些基础情况：&lt;/p&gt;&lt;p&gt;&lt;i&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//www.paperspace.com/pricing&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://www.&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;paperspace.com/pricing&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/i&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-3fbf15100396fb670e367bbb43f97f02_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;545&quot; data-rawheight=&quot;391&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;545&quot; data-original=&quot;https://pic3.zhimg.com/v2-3fbf15100396fb670e367bbb43f97f02_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-3fbf15100396fb670e367bbb43f97f02_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;545&quot; data-rawheight=&quot;391&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;545&quot; data-original=&quot;https://pic3.zhimg.com/v2-3fbf15100396fb670e367bbb43f97f02_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-3fbf15100396fb670e367bbb43f97f02_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;你需要花钱购买GPU但是这个价格相较于其他服务提供商（例如Quadro P4000 每小时花0.5美元，Tesla K80 每小时花0.59美元）还是非常有竞争力的，&lt;b&gt;相较于AWS上有相似功能要便宜很多。&lt;/b&gt;&lt;br/&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;FloydHub Workspace&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;FloydHub的一个有趣的产品是FloydHub Workspace，&lt;b&gt;目标是通过提供一个完全配置好的开发环境减少你自己建立云端深度学习环境的麻烦&lt;/b&gt;。最好的部分？尽管这不是免费的，&lt;b&gt;你仅仅花一秒钟的钱就可以从一个CPU终端无缝切入到一个GPU终端。&lt;/b&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-1884b31135dd7421d8e721d7f7eb0f31_b.gif&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;640&quot; data-rawheight=&quot;383&quot; data-thumbnail=&quot;https://pic2.zhimg.com/v2-1884b31135dd7421d8e721d7f7eb0f31_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;640&quot; data-original=&quot;https://pic2.zhimg.com/v2-1884b31135dd7421d8e721d7f7eb0f31_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-1884b31135dd7421d8e721d7f7eb0f31_b.gif&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;640&quot; data-rawheight=&quot;383&quot; data-thumbnail=&quot;https://pic2.zhimg.com/v2-1884b31135dd7421d8e721d7f7eb0f31_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;640&quot; data-original=&quot;https://pic2.zhimg.com/v2-1884b31135dd7421d8e721d7f7eb0f31_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-1884b31135dd7421d8e721d7f7eb0f31_b.gif&quot;/&gt;&lt;/figure&gt;&lt;p&gt;他们的价格也非常好，&lt;b&gt;你可以花最便宜的价格（12刀）得到一个有 12GB空间的Tesla K80, 61GB的RAM和200GB 10小时的SSD的专用实例。&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;Lambda GPU Cloud&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;Lambda Labs 或者说 Lambda是一个为人类的进步提供计算服务的AI产业公司。他们专攻于深度学习工作站并且最近已经启动了Lambda GPU Cloud，不过目前还在封闭测试阶段。&lt;b&gt;每个Lambda GPU Cloud实例有4个GPU并且比 AWS的p2.8xlarge实例快两倍。他们说你简单地按下一个按钮，就可以直接SSH远程进入一个4 GPU的实例。价格是0.9刀每个GPU每小时。&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;AWS Deep Learning AMIs&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;Amazon Web 服务（AWS）是亚马逊的一个子业务，提供基于付费订阅的按命令运行的云计算平台。最近，他们已经启动了为建立深度学习模型专用GPU加强工作量的Amazon Machine Images（AMIs）项目， Deep Learning AMIs。 &lt;b&gt;AWS Deep Learning AMIs为我们提供必需的设备，预先设置好的工具和框架以大规模地加速云端深度学习。它预先配置了所有最新和最好的深度学习框架。&lt;/b&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-285be38148128f06977340a6a0146986_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;220&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-285be38148128f06977340a6a0146986_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-285be38148128f06977340a6a0146986_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;220&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-285be38148128f06977340a6a0146986_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-285be38148128f06977340a6a0146986_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;你可以得到特别为深度学习建立的虚拟环境Conda AMI或者是基础AMI 配上配置和定制建立。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-8b9282b4e47d7d23e3db042fe42e0961_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;800&quot; data-rawheight=&quot;221&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;800&quot; data-original=&quot;https://pic2.zhimg.com/v2-8b9282b4e47d7d23e3db042fe42e0961_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-8b9282b4e47d7d23e3db042fe42e0961_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;800&quot; data-rawheight=&quot;221&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;800&quot; data-original=&quot;https://pic2.zhimg.com/v2-8b9282b4e47d7d23e3db042fe42e0961_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-8b9282b4e47d7d23e3db042fe42e0961_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;因为你根据小时付费，请谨慎选择你自己的AWS实例。最便宜的选择应该是p2.xlarge以每小时0.9刀的价格向你提供一个12GB的GPU。&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;GCP Deep Learning VM Images&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;GCP是谷歌云平台提供给我们的一套用于运行深度学习模型和空间的云计算服务&lt;/b&gt;。它最大的&lt;b&gt;优点&lt;/b&gt;是在&lt;b&gt;与谷歌内部为它的终端用户所提供的相同的基础设施上运行。GCP也提供给你第一年价值300刀的免费积分。&lt;/b&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-60be5357db806196e728960ed6a361cc_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;978&quot; data-rawheight=&quot;267&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;978&quot; data-original=&quot;https://pic1.zhimg.com/v2-60be5357db806196e728960ed6a361cc_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-60be5357db806196e728960ed6a361cc_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;978&quot; data-rawheight=&quot;267&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;978&quot; data-original=&quot;https://pic1.zhimg.com/v2-60be5357db806196e728960ed6a361cc_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-60be5357db806196e728960ed6a361cc_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;Google Cloud Deep Learning VM Images 使开发者能够在一个Google Compute Engine 实例上运行一个包括受欢迎的深度学习和机器学习框架的VM图像。你可以使用有名的机器学习框架比如TensorFlow, PyTorch或Scikit-learn启动Compute Engine实例。优点在于，你仅仅需要一次点击就能增加云TPU和CPU支持。&lt;b&gt;它的价格也非常有竞争性，并且比AWS便宜。GCP VMs给你仅花费每小时0.45刀使用一个12GB的Tesla K80 GPU的权限。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;▍&lt;/b&gt;&lt;i&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//cloud.google.com/compute/pricing%23gpus&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;cloud.google.com/comput&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;e/pricing#gpus&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/i&gt;&lt;/p&gt;&lt;p&gt;相信这些选项应该给你了一个很好的概念来开启你的深度学习之旅。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;建立你自己的云端深度学习环境&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;当准备好了你自己的云端配置，有时候你就想要建立你自己个性化的云端或者预置深度学习环境。在这个章节，我们会介绍如何在云端利用广为使用的云平台建立一个强大的深度学习环境。主要步骤如下：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;选择一个云提供商&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;创建你的虚拟服务器&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;配置你的虚拟服务器&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;设置你的深度学习环境&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;使用你的深度学习环境&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;验证GPU可用性&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;让我们来仔细看看建立深度学习环境的过程。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;选择一个云提供商&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;现在市面上有许多价格比较便宜并且具有竞争性的云提供商。我们已经在上一部分看到了他们中的一部分。我们正在寻找具有“平台即服务”能力产品，这些产品要使我们能够在平台上管理数据应用和基础的配置，同时为深度学习使用GPU计算。下图展示了一些深度学习从业者常用的云提供商，包括亚马逊的AWS，微软的Azure和谷歌的GCP。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-8750ea0714350d2c32ab2d24963e8a6d_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;741&quot; data-rawheight=&quot;390&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;741&quot; data-original=&quot;https://pic2.zhimg.com/v2-8750ea0714350d2c32ab2d24963e8a6d_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-8750ea0714350d2c32ab2d24963e8a6d_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;741&quot; data-rawheight=&quot;390&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;741&quot; data-original=&quot;https://pic2.zhimg.com/v2-8750ea0714350d2c32ab2d24963e8a6d_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-8750ea0714350d2c32ab2d24963e8a6d_b.jpg&quot;/&gt;&lt;figcaption&gt;支持深度学习的云提供商&lt;/figcaption&gt;&lt;/figure&gt;&lt;h2&gt;&lt;b&gt;创建你的虚拟服务器&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;选择你的云服务器提供商之后的下一步是创建你的VM实例，这个实例基本上包括一个作为代码主机的服务器，数据和配置设置。建立一个VM的下一步取决于你选择了什么云服务器。&lt;/p&gt;&lt;p&gt;下面的教程将为你提供一个深入的指南，帮助你在AWS和GCP中创建和设置自己的实例。&lt;/p&gt;&lt;p&gt;&lt;b&gt;▍&lt;i&gt;使用AWS深度学习AMI创建和设置云实例&lt;/i&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;▍&lt;/b&gt;&lt;i&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//aws.amazon.com/cn/blogs/machine-learning/get-started-with-deep-learning-using-the-aws-deep-learning-ami/&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;aws.amazon.com/cn/blogs&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;/machine-learning/get-started-with-deep-learning-using-the-aws-deep-learning-ami/&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/i&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;▍&lt;i&gt;使用GCP Marketplace创建和设置云实例&lt;/i&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;▍&lt;/b&gt;&lt;i&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//cloud.google.com/deep-learning-vm/docs/quickstart-marketplace%23before-you-begin&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;cloud.google.com/deep-l&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;earning-vm/docs/quickstart-marketplace#before-you-begin&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/i&gt;&lt;/p&gt;&lt;p&gt;在这本书《Hands-on Transfer Learning with Python》第二章中，介绍了一步一步地在AWS上创建和实例化自己的VM的指南。整个代码库都是开源的，可以在GitHub上查看：&lt;/p&gt;&lt;p&gt;&lt;b&gt;▍&lt;/b&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/dipanjanS/hands-on-transfer-learning-with-python&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;github.com/dipanjanS/ha&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;nds-on-transfer-learning-with-python&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-4c3cb067b17d9d298fed09fae7d9a9f5_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;388&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-4c3cb067b17d9d298fed09fae7d9a9f5_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-4c3cb067b17d9d298fed09fae7d9a9f5_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;388&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-4c3cb067b17d9d298fed09fae7d9a9f5_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-4c3cb067b17d9d298fed09fae7d9a9f5_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-385e0019e34d6bd4b34b99c7f81a7b1a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;815&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-385e0019e34d6bd4b34b99c7f81a7b1a_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-385e0019e34d6bd4b34b99c7f81a7b1a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;815&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-385e0019e34d6bd4b34b99c7f81a7b1a_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-385e0019e34d6bd4b34b99c7f81a7b1a_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-c3652f1dcfef671a2f10ca87a3f4f709_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;680&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-c3652f1dcfef671a2f10ca87a3f4f709_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-c3652f1dcfef671a2f10ca87a3f4f709_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;680&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-c3652f1dcfef671a2f10ca87a3f4f709_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-c3652f1dcfef671a2f10ca87a3f4f709_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-2cb311ef18ed23c76806bcdd11260884_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;524&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-2cb311ef18ed23c76806bcdd11260884_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-2cb311ef18ed23c76806bcdd11260884_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;524&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-2cb311ef18ed23c76806bcdd11260884_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-2cb311ef18ed23c76806bcdd11260884_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;h2&gt;&lt;b&gt;配置你的虚拟服务器&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;实例创建之后，你就可以从云提供商的平台启动这个实例了，特别是当你是从AWS或者是从GCP实例页面启动的EC2用户时。&lt;b&gt;通常你需要一个私人密匙来登录你的服务器，从本地终端使用SSH。通常情况下AWS会让你在创建你的VM的最后一步时设置内自己的密匙，并且给你一个可下载的私人密匙。GCP允许你直接使用SSH从GCP实例页面登陆你的系统。然后，如果需要你可以在系统上创建你自己的SSH密匙。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;记得在一个安全位置保存你的私人SSH密匙，并从终端使用下列指令登陆你的服务器。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-949efbfcedd614cdb10c8d10df484ffe_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;603&quot; data-rawheight=&quot;435&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;603&quot; data-original=&quot;https://pic3.zhimg.com/v2-949efbfcedd614cdb10c8d10df484ffe_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-949efbfcedd614cdb10c8d10df484ffe_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;603&quot; data-rawheight=&quot;435&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;603&quot; data-original=&quot;https://pic3.zhimg.com/v2-949efbfcedd614cdb10c8d10df484ffe_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-949efbfcedd614cdb10c8d10df484ffe_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;祝贺！你现在已经成功地登陆了你的深度学习服务器。下面的深度学习设置细节仅当你使用的是Linux服务器时才需要被执行。我们的Linux版本是&lt;b&gt;Ubuntu 18.10.&lt;/b&gt;你可以根据你的喜好自由选择你自己的操作系统。&lt;/p&gt;&lt;p&gt;我们将广泛地在试验和研究中使用Jupyter notebook,它也经常被用于给notebook服务器建立一个密码，这样未知访问者就不能通过公共IP地址访问该服务器了。如果你不想设置密码，你可以跳过密码设置的步骤。这里的第一步是创建一个新的由Open SSL认证的SSL。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-92f2b356636b42321a6323bd0fdf581c_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;654&quot; data-rawheight=&quot;294&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;654&quot; data-original=&quot;https://pic1.zhimg.com/v2-92f2b356636b42321a6323bd0fdf581c_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-92f2b356636b42321a6323bd0fdf581c_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;654&quot; data-rawheight=&quot;294&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;654&quot; data-original=&quot;https://pic1.zhimg.com/v2-92f2b356636b42321a6323bd0fdf581c_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-92f2b356636b42321a6323bd0fdf581c_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;如果系统中没有下载python，我们推荐使用Anaconda搭建Python环境。&lt;/p&gt;&lt;p&gt;下一步是为我们的Jupyter notebook服务器生成一个认证文件，以防它没有呈现。通常情况下这个文件会在你的主文件夹，在&lt;i&gt;&lt;b&gt;~/.jupyter/jupyter_notebook_config.py &lt;/b&gt;&lt;/i&gt;&lt;/p&gt;&lt;p&gt;。如果它没有被呈现，你可以用以下命令创造它。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-8db6005b1056427b1e97355230d10503_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;476&quot; data-rawheight=&quot;81&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;476&quot; data-original=&quot;https://pic4.zhimg.com/v2-8db6005b1056427b1e97355230d10503_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-8db6005b1056427b1e97355230d10503_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;476&quot; data-rawheight=&quot;81&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;476&quot; data-original=&quot;https://pic4.zhimg.com/v2-8db6005b1056427b1e97355230d10503_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-8db6005b1056427b1e97355230d10503_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;为了保证notebook的密码安全性，我们首先要生成一个密码和它的哈希。我们可以利用以下代码：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-24227bd87dc767fb9f7bb39920909c24_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;612&quot; data-rawheight=&quot;295&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;612&quot; data-original=&quot;https://pic1.zhimg.com/v2-24227bd87dc767fb9f7bb39920909c24_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-24227bd87dc767fb9f7bb39920909c24_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;612&quot; data-rawheight=&quot;295&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;612&quot; data-original=&quot;https://pic1.zhimg.com/v2-24227bd87dc767fb9f7bb39920909c24_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-24227bd87dc767fb9f7bb39920909c24_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;一旦你键入密码并认证，函数会返回给你一个哈希，这个哈希就是你密码的哈希。复制并保存返回的哈希值因为我们很快又要用到，接下来，启动你最爱的文本编辑器来编辑Jupyter 认证文件，如下：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-48a52fa4661f8dc351300ea73cc5c391_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;670&quot; data-rawheight=&quot;314&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;670&quot; data-original=&quot;https://pic2.zhimg.com/v2-48a52fa4661f8dc351300ea73cc5c391_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-48a52fa4661f8dc351300ea73cc5c391_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;670&quot; data-rawheight=&quot;314&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;670&quot; data-original=&quot;https://pic2.zhimg.com/v2-48a52fa4661f8dc351300ea73cc5c391_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-48a52fa4661f8dc351300ea73cc5c391_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;我们现在做好了设置我们的深度学习环境的准备。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;设置你的深度学习环境&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;我们现在开始设置使用GPU的深度学习环境的必须配置。如果你的实例中已经有了CUDA和cuDNN，你可以跳过以下所需步骤：&lt;/p&gt;&lt;p&gt;&lt;b&gt;▍1、下载图片驱动器&lt;/b&gt;&lt;/p&gt;&lt;p&gt;这里的第一步是为了保证你的图片驱动器已经为你的GPU下载好了。接下去我们假设你正在使用一个NVIDIA GPU。最好的方法来测试驱动器是否下载好了的就是在终端中运行 nvidia-smi 命令。现在如果下面的命令运行失败，我们就需要下载这个GPU驱动器。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-64ebd9610cf76505b503c8b7d905e4b5_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;704&quot; data-rawheight=&quot;849&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;704&quot; data-original=&quot;https://pic2.zhimg.com/v2-64ebd9610cf76505b503c8b7d905e4b5_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-64ebd9610cf76505b503c8b7d905e4b5_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;704&quot; data-rawheight=&quot;849&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;704&quot; data-original=&quot;https://pic2.zhimg.com/v2-64ebd9610cf76505b503c8b7d905e4b5_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-64ebd9610cf76505b503c8b7d905e4b5_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;▍2、下载CUDA&lt;/b&gt;&lt;/p&gt;&lt;p&gt;NVIDIA® CUDA® 工具箱是一个用于创建应用和程序的可以最大化使用NVIDIA GPU的开发环境。有GPU加速的CUDA库使许多领域有所发展，包括线性代数，图像和视频处理，深度学习和图像分析等。假设我们正在使用一个基于Ubuntu的系统，你可以到官方的NVIDIA CUDA页面并且下载这个必要的配置文件：&lt;/p&gt;&lt;p&gt;&lt;b&gt;▍&lt;/b&gt;&lt;i&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//developer.nvidia.com/cuda-downloads%3Ftarget_os%3DLinux%26target_arch%3Dx86_64%26target_distro%3DUbuntu&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;developer.nvidia.com/cu&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;da-downloads?target_os=Linux&amp;amp;target_arch=x86_64&amp;amp;target_distro=Ubuntu&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/i&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-e112d66c5771c8722d9b266b64e4d6d1_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;559&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-e112d66c5771c8722d9b266b64e4d6d1_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-e112d66c5771c8722d9b266b64e4d6d1_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;559&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-e112d66c5771c8722d9b266b64e4d6d1_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-e112d66c5771c8722d9b266b64e4d6d1_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;在写这篇文章的时候，CUDA10已经发布了但还是非常新，因此我们将使用旧版的CUDA9.0，你可以从旧版的发布页面获取：&lt;/p&gt;&lt;p&gt;&lt;b&gt;▍&lt;/b&gt;&lt;i&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//developer.nvidia.com/cuda-toolkit-archive&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;developer.nvidia.com/cu&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;da-toolkit-archive&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/i&gt;&lt;/p&gt;&lt;p&gt;如果你已经有了一个服务器，那你最好使用终端下载配置文件使用以下命令认证CUDA。 &lt;/p&gt;&lt;p&gt;&lt;b&gt;▍3、下载cuDNN&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;NVIDIA CUDA® 深度神经网络库是一个GPU加速的深度神经网络基元的库&lt;/b&gt;。&lt;b&gt;cuDNN库提供神经网络标准路径高度调谐的实现，包括前向和后向卷积，池化，正则化和激活层。&lt;/b&gt;深度学习从业者可以依赖于cuDNN使用深度学习框架广泛在GPU上广泛加速。你可以从官方页面下载cuDNN，但是你需要注册一个NVIDIA账号：&lt;/p&gt;&lt;p&gt;&lt;b&gt;▍&lt;/b&gt;&lt;i&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//developer.nvidia.com/cudnn&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;developer.nvidia.com/cu&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;dnn&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/i&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-a395d0cd2a406ef6b0abfaa1b0e69cfa_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;660&quot; data-rawheight=&quot;457&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;660&quot; data-original=&quot;https://pic3.zhimg.com/v2-a395d0cd2a406ef6b0abfaa1b0e69cfa_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-a395d0cd2a406ef6b0abfaa1b0e69cfa_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;660&quot; data-rawheight=&quot;457&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;660&quot; data-original=&quot;https://pic3.zhimg.com/v2-a395d0cd2a406ef6b0abfaa1b0e69cfa_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-a395d0cd2a406ef6b0abfaa1b0e69cfa_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;你将得到一个cuDNN的下载链接，之后在终端时从服务器时直接下载时会用到。通常情况下，这很大程度上依赖于GPU的设置。&lt;/p&gt;&lt;p&gt;&lt;b&gt;▍4、下载深度学习框架&lt;/b&gt;&lt;/p&gt;&lt;p&gt;现在，我们需要下载并配置我们的Python深度学习框架。我们使用大量的keras和tensorflow和下列指令来帮助我们下载到我们的环境中。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-9624f89d89d947853854a54ff3cd7649_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;564&quot; data-rawheight=&quot;346&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;564&quot; data-original=&quot;https://pic2.zhimg.com/v2-9624f89d89d947853854a54ff3cd7649_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-9624f89d89d947853854a54ff3cd7649_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;564&quot; data-rawheight=&quot;346&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;564&quot; data-original=&quot;https://pic2.zhimg.com/v2-9624f89d89d947853854a54ff3cd7649_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-9624f89d89d947853854a54ff3cd7649_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;h2&gt;&lt;b&gt;使用你的深度学习环境&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;我们并不是一直要在服务器的终端商编写代码。因为我们想要将Jupyter Notebooks用于交互性研究，我们将在从本地操作系统在云端服务器上进入Notebook。为了达到这个目的，我们首先需要从远程实例启动我们的Jupyter Notebook。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-49bd5cc0cc725a85cdd7e1da59623d15_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;629&quot; data-rawheight=&quot;290&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;629&quot; data-original=&quot;https://pic2.zhimg.com/v2-49bd5cc0cc725a85cdd7e1da59623d15_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-49bd5cc0cc725a85cdd7e1da59623d15_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;629&quot; data-rawheight=&quot;290&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;629&quot; data-original=&quot;https://pic2.zhimg.com/v2-49bd5cc0cc725a85cdd7e1da59623d15_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-49bd5cc0cc725a85cdd7e1da59623d15_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;现在如果你有一个公共的IP只想你的实例并且端口&lt;b&gt;8888&lt;/b&gt;是暴露的，你可以直接键入&lt;b&gt;http://&amp;lt;IP_Address&amp;gt;:8888 &lt;/b&gt;然后从本地浏览器进入你的Jupyter 服务器。&lt;/p&gt;&lt;p&gt;另一个选项，特别对于AWS实例来说，是要允许本地实例中的虚拟主机从本地机器上的浏览器进入我们的云端服务器notebook，也就是要建立SSH隧道。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-b4163b42476dbab923154f339b6f4cc1_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;640&quot; data-rawheight=&quot;235&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;640&quot; data-original=&quot;https://pic2.zhimg.com/v2-b4163b42476dbab923154f339b6f4cc1_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-b4163b42476dbab923154f339b6f4cc1_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;640&quot; data-rawheight=&quot;235&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;640&quot; data-original=&quot;https://pic2.zhimg.com/v2-b4163b42476dbab923154f339b6f4cc1_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-b4163b42476dbab923154f339b6f4cc1_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;我们从虚拟服务器进入远程notebook服务器，注意检查浏览器的地址中有&lt;b&gt;https&lt;/b&gt;，否则会出现SSL错误。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;验证GPU可用性&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;最后的步骤是确认一切都在正常运作中，并且我们的深度学习框架正在利用我们的（付费使用的）GPU，下面的代码将帮助我们验证这个事实。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-2cc54f7c199b47e49ad8c3dfd7cf19e4_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;733&quot; data-rawheight=&quot;690&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;733&quot; data-original=&quot;https://pic1.zhimg.com/v2-2cc54f7c199b47e49ad8c3dfd7cf19e4_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-2cc54f7c199b47e49ad8c3dfd7cf19e4_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;733&quot; data-rawheight=&quot;690&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;733&quot; data-original=&quot;https://pic1.zhimg.com/v2-2cc54f7c199b47e49ad8c3dfd7cf19e4_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-2cc54f7c199b47e49ad8c3dfd7cf19e4_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;br/&gt;我们的深度学习设置已经基本完成啦！&lt;/p&gt;&lt;h2&gt;&lt;b&gt;自有设置的建议&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;通常使用者或机构可能不想要利用云端服务器，特别是当他们的数据敏感是，他们致力于建立私有的深度学习环境。这里的主要关注点应当是投资在正确的硬件和软件上，以最大化地利用正确的GPU以建立深度学习模型。对于硬件有以下几点需要强调的：&lt;/p&gt;&lt;p&gt;&lt;b&gt;处理器：&lt;/b&gt;你可以购买i5或者i7的英特尔CPU，或者是奢侈一点买一个Intel Xeon。&lt;/p&gt;&lt;p&gt;&lt;b&gt;RAM：&lt;/b&gt;为内存考虑投资至少32GB 的 DDR4\DDR5或更好的RAM。&lt;/p&gt;&lt;p&gt;&lt;b&gt;硬盘：&lt;/b&gt;选择一个1TB的硬盘是很棒的，为了快速获取数据你也可以购买至少128GB或者256GB的SSD。&lt;/p&gt;&lt;p&gt;&lt;b&gt;GPU：&lt;/b&gt;GPU也许是深度学习需要的最重要的配件。买一个NVIDIA GPU，或者至少是比8GB的GTX1070更好的。&lt;/p&gt;&lt;p&gt;其他你不能忽略的东西包括一个母版，能源提供，坚固的盒子和冷却器。一旦你配置好了你的装备，对于软件配置，你可以重复前面几节的出去云环境配置外的所有步骤，然后开始你的深度学习研究。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;总结&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;这个手把手指南的目标是让开发者，工程师和深度学习从业者从零开始快速建立自己的深度学习环境&lt;b&gt;。我希望这个指南帮助你建立你自己的深度学习环境并不要把时间浪费在从论坛和Stack Overflow数不清的帖子里找答案上。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;现在，开始你的深度学习吧！&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;i&gt;—End—&lt;/i&gt;&lt;/p&gt;&lt;p&gt;量化投资与机器学习微信公众号，是业内垂直于&lt;b&gt;Quant&lt;/b&gt;、&lt;b&gt;MFE&lt;/b&gt;、&lt;b&gt;CST&lt;/b&gt;等专业的主流自媒体。公众号拥有来自&lt;b&gt;公募、私募、券商、银行、海外&lt;/b&gt;等众多圈内&lt;b&gt;10W+&lt;/b&gt;关注者。每日发布行业前沿研究成果和最新资讯。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>量化投资机器学习</author>
<guid isPermaLink="false">2019-04-04-61405359</guid>
<pubDate>Thu, 04 Apr 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>Fama-French，让我们重新认识你！</title>
<link>https://henix.github.io/feeds/zhuanlan.Lhtz-Jqxx/2019-04-01-61092551.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/61092551&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-aad4af32f1084e9e42d8e858bc9df8f5_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;正文&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;在1992年的论文中， Eugene Fama和Ken French提出了两种新的因子，可以用来帮助解释CAPM中某些股票超出“全市场组合”的超额收益。这些新的因子是“价值”（股价/账面价值）和“规模”（市值）。尽管事实上价值投资的观念已并不陌生（1949年Ben Graham出版了Intelligent Investor一书），Fama和French还是引发了一场寻找其他新因子的热潮。人们希望这些因子可以解释（当然也可能捕捉）超出市场的表现。不出意外地，对新因子的搜寻导致了聪明Beta（Smart Beta）ETF的盛行。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-131872974675e709e9a0b40161fecb3a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;619&quot; data-rawheight=&quot;296&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;619&quot; data-original=&quot;https://pic3.zhimg.com/v2-131872974675e709e9a0b40161fecb3a_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-131872974675e709e9a0b40161fecb3a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;619&quot; data-rawheight=&quot;296&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;619&quot; data-original=&quot;https://pic3.zhimg.com/v2-131872974675e709e9a0b40161fecb3a_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-131872974675e709e9a0b40161fecb3a_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;通常来说，这对投资者（包括个人投资者和机构投资者）来说是个有利的发展，因为投资格局（特别是主动型Alpha基金经理的领域）正在逐渐变得“民主”，正如下图所示。这就允许投资者以简单、成本有效、透明的形式接触到为主动型基金经理带来大部分收益的因子。由于模型的成熟，&lt;b&gt;Smart Beta ETFs甚至可以完全有效地复制某些对冲基金的策略&lt;/b&gt;。论文：&lt;i&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//jwm.iijournals.com/content/14/3/58&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;jwm.iijournals.com/cont&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;ent/14/3/58&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/i&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-a8be9afe7d8e8f7f07a1dfbebd372f0a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;487&quot; data-rawheight=&quot;512&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;487&quot; data-original=&quot;https://pic3.zhimg.com/v2-a8be9afe7d8e8f7f07a1dfbebd372f0a_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-a8be9afe7d8e8f7f07a1dfbebd372f0a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;487&quot; data-rawheight=&quot;512&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;487&quot; data-original=&quot;https://pic3.zhimg.com/v2-a8be9afe7d8e8f7f07a1dfbebd372f0a_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-a8be9afe7d8e8f7f07a1dfbebd372f0a_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;h2&gt;&lt;b&gt;因子并非生来平等&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;尽管Alpha的商品化对投资者（和“主动到被动”策略转换的驱动力）来说很有利，许多投资者还是把价值因子（举个例子）看作一个同质的构建块，在投资组合中可有可无，找到最便宜的ETF然后坐享其成就可以了。Two Sigma在一篇文章中提出了这一问题：&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;Consider the equity value factor. Academics have written about the excess returns of “high value” stocks (as compared to the broader equity market) for nearly a century (e.g., Graham and Dodd, 1934). One might expect that the financial market equivalent of a patent—i.e., the “secret sauce” embedded in an investment style—would have long since expired, but Figure 1 and the accompanying table contradict that notion.&lt;/i&gt;&lt;/blockquote&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-4f343775df3bf853fbc2d9e75cebe301_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;506&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-4f343775df3bf853fbc2d9e75cebe301_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-4f343775df3bf853fbc2d9e75cebe301_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;506&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-4f343775df3bf853fbc2d9e75cebe301_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-4f343775df3bf853fbc2d9e75cebe301_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;论文文末下载&lt;/b&gt;&lt;/p&gt;&lt;p&gt;显然价值风险因子之间的差别主要由这两种因素引起：&lt;b&gt;①定义；②构建&lt;/b&gt;。&lt;/p&gt;&lt;p&gt;虽然Fama和French常常因“发现”了价值（和规模）因子而饱受赞誉，这种想法在投资者之中绝不是全新的主意。Benjamin Graham（价值投资之父）在数十年之前就已经出版了一本完整的关于这方面的书。Fama和French只是用了一种简单的方法来定义价值（只需比较账面价值和市值），作为分析超额收益的一种方式。他们提出的价值因子被称为&lt;b&gt;“高账面市值比-低账面市值比”（HML），计算方式是对前30%账面市值比公司的股票收益取平均然后减去后30%账面市值比公司股票收益的平均数&lt;/b&gt;。&lt;/p&gt;&lt;p&gt;正如Two Sigma所指出的那样， &lt;b&gt;“Fama-Frennch(1991)在学界与业界引发了一系列的问题。问题之一就是账面市值比是否能够代表获得价值风险因子敞口最有效的方法。举例来说，为什么不按照收益率或者现金流收益率对公司进行排序呢？”&lt;/b&gt;&lt;/p&gt;&lt;p&gt;他们还使用了滚动相关分析法，对2种不同（但都很流行）的“价值”定义的预期收益进行了说明：账面市值比和收益率。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-8814c0ed92f931c479d8356b7fb3e6d2_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;661&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-8814c0ed92f931c479d8356b7fb3e6d2_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-8814c0ed92f931c479d8356b7fb3e6d2_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;661&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-8814c0ed92f931c479d8356b7fb3e6d2_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-8814c0ed92f931c479d8356b7fb3e6d2_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;显然，如何定义“价值”举足轻重。正如在Vanguard最近发布的一篇文章种所说，&lt;b&gt;价值的定义和落实的不同对投资表现有显著的影响。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;地址：&lt;i&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//vanguardinstitutionalblog.com/2018/04/23/do-you-like-your-style-factor-spicy-or-tangy-evaluating-factor-funds/&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;vanguardinstitutionalblog.com&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;/2018/04/23/do-you-like-your-style-factor-spicy-or-tangy-evaluating-factor-funds/&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/i&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-c43d6745ea9aa36dd7e2ae656e112027_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;1099&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-c43d6745ea9aa36dd7e2ae656e112027_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-c43d6745ea9aa36dd7e2ae656e112027_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;1099&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-c43d6745ea9aa36dd7e2ae656e112027_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-c43d6745ea9aa36dd7e2ae656e112027_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;h2&gt;&lt;b&gt;方法：理论 vs. 实践&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;现在显然的问题是：“&lt;b&gt;如何正确定义和解释价值因子（或者任何因子）？&lt;/b&gt;”当一个因子不止一次被纳入考虑范围，这个问题就会变得愈发重要。为了继续探索，我们考虑Fama和French论文中一个最流行的例子：&lt;b&gt;小市值&lt;/b&gt;。其是Smart Beta中最受欢迎的，并且从1992论文发表以来，已经有数以百计的小市值基金（主动型和被动型）设立。为了深入测试这些因子，我们看看Eugene Fama任职的公司——Dimensional Fund Advisors（DFA），尤其是DFA美国小市值组合&lt;b&gt;DFA US SmallCap Value Portfolio&lt;/b&gt; (DFSVX)。&lt;/p&gt;&lt;p&gt;从基金计划书中可以看出：&lt;/p&gt;&lt;blockquote&gt;&lt;b&gt;①“证券主要被视为价值股，因为一个公司的低股价与账面价值有关”。&lt;/b&gt;&lt;br/&gt;&lt;b&gt;②“美国小市值公司的相对市场价值越高，就越具有代表性”。&lt;/b&gt;&lt;/blockquote&gt;&lt;p&gt;所以，这个基金落实小市值因子的方式正与Fama和French的论文如出一辙，用账面价值代表价值。此外，这个基金按照市值为组合中的股票分配权重（这一方法有很多已知缺陷）。&lt;/p&gt;&lt;p&gt;然而，没有绝对正确或错误的方法来表示对价值因子的敞口（风险溢价），所以投资者应该意识到他们选择某一方案时所承担的风险（直接的和间接的）。仅仅依赖对价值的单一定义会增加特定敞口的风险（这个敞口体现了相对于其他定义出现的较大偏离）。类似地，根&lt;b&gt;据市值分配权重可能会导致放大特定时期内的价值影响&lt;/b&gt;（在2018年“FANG”体现显著），称为动量倾斜。在这两种情况之一下，这些风险或倾斜可能会被投资者完全接受——&lt;b&gt;必须指出它们代表的风险是小市值因子的使用，而不是因子本身。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;让我们考虑另一种小市值因子的使用，Invesco S&amp;amp;P 600 Pure Value ETF（RZV）。这只ETF同样搜寻获取丰厚的小市值风险溢价的机会，但是换了一种方式：&lt;/p&gt;&lt;blockquote&gt;&lt;b&gt;①“价值通过这几种风险因子来衡量：市净率、市盈率、市销率”。&lt;/b&gt;&lt;br/&gt;&lt;b&gt;②“股票的权重按照Style(Value) Score的比例来分配”。&lt;/b&gt;&lt;/blockquote&gt;&lt;p&gt;这种方式通过3种分离的度量价值的方法来分散模型风险，然后根据复合度量来赋予权。重。另外，根据价值排序后的小市值股票已经按照盈利能力进行过筛选。这是格外有趣的，&lt;b&gt;因为大量学术研究已经表明盈利能力（更宽泛地说，“质量”）是以一种鲁棒的、可以实际增加“经典”因子溢价（如价值）的“条件”因子。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;AQR在2015的一篇论文（Size Matters, If you Control Your Junk）中，指出当评估小市值溢价时控制质量的重要性。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-22c3aaec344a9de7a97e82b3547a7509_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;480&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-22c3aaec344a9de7a97e82b3547a7509_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-22c3aaec344a9de7a97e82b3547a7509_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;480&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-22c3aaec344a9de7a97e82b3547a7509_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-22c3aaec344a9de7a97e82b3547a7509_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;论文文末下载&lt;/b&gt;&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;The previous evidence on the variability of the size effect is largely due to the volatile performance of small, low quality “junky” firms. Controlling for junk, a much stronger and more stable size premium emerges that is robust across time, including those periods where the size effect seems to fail; monotonic in size and not concentrated in the extremes; robust across months of the year; robust across non-market price based measures of size; not subsumed by illiquidity premia; and robust internationally. These results are robust across a variety of quality measures as well.&lt;/i&gt;&lt;br/&gt;&lt;br/&gt;&lt;i&gt;We further find that interactions between size and other firm characteristics, such as value and momentum, can also be fully or partially explained by quality versus junk. Hence, the quality of a firm helps clean up the relation between size and the cross-section of expected returns.&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;事实上，Fama和French在2014年的一篇论文中重新回顾了他们的三因子模型（侧重规模和价值因子），并引入了两个新的&lt;b&gt;“质量”因子&lt;/b&gt;：&lt;b&gt;“盈利能力”和“投资”&lt;/b&gt;。有趣的是，&lt;b&gt;他们发现当这两个新因子被纳入考虑，“价值”就没有之前那么重要了。&lt;/b&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-03d91c1f0fb93c2105764eff2647ac9f_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;823&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-03d91c1f0fb93c2105764eff2647ac9f_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-03d91c1f0fb93c2105764eff2647ac9f_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;823&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-03d91c1f0fb93c2105764eff2647ac9f_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-03d91c1f0fb93c2105764eff2647ac9f_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-493bba317cacc0dd8002f055558fcb95_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;387&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-493bba317cacc0dd8002f055558fcb95_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-493bba317cacc0dd8002f055558fcb95_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;387&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-493bba317cacc0dd8002f055558fcb95_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-493bba317cacc0dd8002f055558fcb95_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;所以，Invesco S&amp;amp;P 600 Pure Value ETF (RZV)&lt;b&gt;对全部小市值股票按照盈利能力进行了筛选，根据价值的3种度量方法进行排序，按照价值“得分”赋予权重&lt;/b&gt;。直观地来看，这种方法看起来是要将DFA的两个潜在缺点一起解决。&lt;/p&gt;&lt;p&gt;Invesco的方法同样更好地与主动型基金追捧的价值敞口保持了一致，但是使用的是一种基于规则的方法（从而避免了任一主动型基金经理决策引起的所有问题）。&lt;/p&gt;&lt;p&gt;那么，这两种方法对比起来会怎样？&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-e5298c806691f381f3a2a157bfaab9a5_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1008&quot; data-rawheight=&quot;567&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1008&quot; data-original=&quot;https://pic2.zhimg.com/v2-e5298c806691f381f3a2a157bfaab9a5_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-e5298c806691f381f3a2a157bfaab9a5_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1008&quot; data-rawheight=&quot;567&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1008&quot; data-original=&quot;https://pic2.zhimg.com/v2-e5298c806691f381f3a2a157bfaab9a5_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-e5298c806691f381f3a2a157bfaab9a5_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-e8ec8c72780bf8e8dcfa795a309d5061_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;908&quot; data-rawheight=&quot;402&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;908&quot; data-original=&quot;https://pic2.zhimg.com/v2-e8ec8c72780bf8e8dcfa795a309d5061_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-e8ec8c72780bf8e8dcfa795a309d5061_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;908&quot; data-rawheight=&quot;402&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;908&quot; data-original=&quot;https://pic2.zhimg.com/v2-e8ec8c72780bf8e8dcfa795a309d5061_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-e8ec8c72780bf8e8dcfa795a309d5061_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-d7e222b288c1caafcba634a24fa6cdf7_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;840&quot; data-rawheight=&quot;598&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;840&quot; data-original=&quot;https://pic4.zhimg.com/v2-d7e222b288c1caafcba634a24fa6cdf7_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-d7e222b288c1caafcba634a24fa6cdf7_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;840&quot; data-rawheight=&quot;598&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;840&quot; data-original=&quot;https://pic4.zhimg.com/v2-d7e222b288c1caafcba634a24fa6cdf7_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-d7e222b288c1caafcba634a24fa6cdf7_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;所以，在过去12年里，与DFA基金相同，&lt;b&gt;S&amp;amp;P 600 Value ETF一直在试图提取小市值价值溢价，但是达到了更低的波动率，更低的回撤和更高的回报&lt;/b&gt;（扣除交易成本及费用后）。&lt;/p&gt;&lt;p&gt;&lt;b&gt;这两种方法都被看做是“聪明Beta”策略，但我们认为其中一种比另一种更“聪明”。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;论文下载：&lt;/b&gt;&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s/APgXkU8grojKHlOSuzez1A&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic2.zhimg.com/v2-e367fe6b9f29c3ff6bdbe1a50423143d_180x120.jpg&quot; data-image-width=&quot;1280&quot; data-image-height=&quot;542&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Fama-French，让我们重新认识你！&lt;/a&gt;&lt;p&gt;▎作者：McMillan&lt;/p&gt;&lt;p&gt;&lt;b&gt;▎&lt;/b&gt;编译：&lt;b&gt;Archan Jin&lt;/b&gt; | 公众号翻译部&lt;/p&gt;&lt;p&gt;&lt;i&gt;—End—&lt;/i&gt;&lt;/p&gt;&lt;p&gt;量化投资与机器学习微信公众号，是业内垂直于&lt;b&gt;Quant&lt;/b&gt;、&lt;b&gt;MFE&lt;/b&gt;、&lt;b&gt;CST&lt;/b&gt;等专业的&lt;b&gt;主流自媒体&lt;/b&gt;。公众号拥有来自&lt;b&gt;公募、私募、券商、银行、海外&lt;/b&gt;等众多圈内&lt;b&gt;10W+&lt;/b&gt;关注者。每日发布行业前沿研究成果和最新资讯。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>量化投资机器学习</author>
<guid isPermaLink="false">2019-04-01-61092551</guid>
<pubDate>Mon, 01 Apr 2019 00:00:00 +0800</pubDate>
</item>
</channel>
</rss>
