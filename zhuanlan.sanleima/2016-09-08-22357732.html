<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>量化研究（九）：Delta对冲的盈亏分布</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/22357732">原文</a></p>
<div class="title-image"><img src="https://pic4.zhimg.com/b1f600eebbf2ddc11de7ca00ac71d3c0_r.jpg" alt=""></div><p>（图多、慎点。）</p>前一阵子期权组来了几名实习生，帮我们做一些基础研究工作。<p>交流的过程中发现实习生们对于Delta对冲的认知还是有点蒙逼。</p><p>于是写下此文，以后用作培训普及之用。</p><p>---</p><p>在量化研究（六）中提到了，BSM期权定价公式，实际上就是运用了Delta对冲的思想。</p><p>通过用现货来动态复制期权头寸，从而使得整个组合无风险。</p><p>这里有两个问题值得注意：（1）为什么可以通过现货复制期权？（2）为什么是Delta对冲？</p><p>关于第一个问题，金融学中有一个概念，叫“完备市场”。</p><p><a href="https://en.wikipedia.org/wiki/Complete_market" data-editable="true" data-title="Complete market" class="">Complete market</a><br></p><p>大概意思是，如果一个市场的完备的，那么这个市场上所有的衍生品都可以通过现货来进行复制。BSM期权定价公式里面的假设其实就已经内含了完备市场的假设。</p><p>关于第二个问题，由于期权是<b>收益非线性的衍生品，</b>非线性的特点，导致期权价格变动和标的价格变动并不是线性变化的关系。在量化研究（六）里面提到，期权的瞬时收益可以通过泰勒分解展开：</p><equation>dV=\Delta dS+\frac{1}{2} \Gamma (ds)^{2} +\theta dt</equation><br><p>在实际中，由于现货本身是没有高阶项导数的，因此在复制的时候会出现偏差。这个在量化研究（六）里已经说过，不再赘述。</p><p>今天这篇专栏就通过模拟回测来谈谈Delta对冲的盈亏分布。</p><p>初始条件如下：</p><p><img src="https://pic2.zhimg.com/15b95cfcc44fd5173a6df50e62f54df6_r.png" data-rawwidth="554" data-rawheight="144">通过GBM运动与常数波动率生成的路径如下图示（一万条路径）：</p><p><img src="https://pic1.zhimg.com/a9b093b0470fcbe9935b4b7b29eb2ed9_r.png" data-rawwidth="1448" data-rawheight="868">根据上述路径，计算出期权的价格与delta。</p><p>接下来以期权卖方的视角进行分析，假设我们卖出的是ATM期权。</p><p>我们知道，看涨期权买方的期末Payoff是长这个样子的：</p><p><img src="https://pic2.zhimg.com/e1dd26e1905ef54b60164e7a03990a1a_r.png" data-rawwidth="1448" data-rawheight="868">由于我们是期权的卖方，因此，通过现货复制期权的复制头寸也应该是上图的样子。</p><p>这里说一下：由于期权卖方收取的权利金是大概率不足够覆盖现货的保证金，因此在对冲的时候需要借贷，整个现货组合的市值扣除借贷的金额就等于现货复制期权的复制头寸。</p><p>先考虑通过股票来复制的情况，交易单位是1股/手。</p><p>在到期日，复制的情况如下图所示：</p><p><img src="https://pic4.zhimg.com/f5a3e6985a10a016d2213cc62589de4a_r.png" data-rawwidth="1448" data-rawheight="868">蓝色的点就是现货复制头寸的期末盈亏状况，可以看到，散点图几乎和期权的期末payoff曲线吻合。这里我们可以看到两个问题：</p><p>1. 执行价两端的情况出现较少，也即是说，极端盈亏情况出现较少。</p><p>2. 执行价附近的离散情况比较严重，即复制误差较大。</p><p>根据图示，复制后，整个资产组合的盈亏大概会长得像正态分布的样子。</p><p>事实上如图示：</p><img src="https://pic2.zhimg.com/074503da30bb2391c478397fe94dabee_r.png" data-rawwidth="584" data-rawheight="734"><p>关于执行价附近离散情况比较严重的情况，请参见下图：</p><p><img src="https://pic2.zhimg.com/0ed5954d8e233b5dc8696ae6cdba07ba_r.png" data-rawwidth="858" data-rawheight="270">由于标的价格在执行价附近波动的时候delta变动频繁，无法连续对冲导致对冲的时候容易被两边打脸造成亏损。尤其是临近到期日，假如标的价依然在执行价附近的话，Gamma变动会加剧，导致复制误差加大。</p><p>实际上，Delta对冲会面临如下问题：</p><p>1. 无法连续对冲导致的对冲误差。由于存在交易费用，因此对冲频率和交易费用二者在对冲交易的时候需要权衡。 </p><p>2. 波动率样本误差。由于计算波动率的时候取样频率也是离散的，于是会产生样本误差。《Volatility Trading》一书，第二章中说到，一般波动率从的取样误差由下式给出：</p><equation>\sigma_{measured}\approx \sigma \pm \frac{\sigma }{2N}  </equation><br><p>3. 对冲路径依赖问题。由于对冲非连续的缘故，原本属于非方向性的对冲交易就变成了追涨杀跌，同样波动率的两条标的路径，对冲后的PnL会完全不一样。（这个通过上述回测就知道了。）</p><p>在量化研究（六）里面曾经提到过，Delta对冲后，资产组合的盈亏如下式：</p><equation>PnL =\int_{0}^{T} \frac{1}{2} \Gamma S^{2}\left\{   \sigma _{imp} ^{2}-  \sigma _{real}^{2} \right\}  dt</equation><br><p>留意到式子里面有个S的平方，因此Delta对冲后，总获利是依赖于股价的路径的。</p><p>关于对冲究竟用什么样的波动率，《Volatility Trading》里的第七章同样给出了建议：</p><p><img src="https://pic4.zhimg.com/b7f31c7d79e502b55fa8475d7e22520e_r.jpg" data-rawwidth="1280" data-rawheight="960">对于期权卖方（Short Gamma）来说，遇上趋势行情，一般会调低波动率。遇上震荡行情，一般会调高波动率。</p><p><b>====== 以下是废话 ======</b></p><p>记得当时还在基金公司实习，正是找不到工作的时候。</p><p>当时在想着，这次实习可能是人生中最后一次做跟量化相关的工作了。</p><p>于是我特意买了一本笔记本，把每天的分析证明记下来。</p><p>好让我在去了银行做柜员之后，偶尔还能拿出来翻看，想着当年自己也牛逼过。</p><p>到了今天，专栏文章有一半内容都是当时做的笔记。</p><p>不知道这算不算天道酬勤的例子。</p><p>人生啊，确实要比当归大条一点。</p><p><b>======================</b></p><p>---</p><p>冼尼玛</p><p>2016/09/08</p><p><b>=========== 交易员崛起 · 专栏目录 ===========</b></p><ul><li><a href="https://zhuanlan.zhihu.com/p/22012204" class="" data-editable="true" data-title="交易员崛起 · 专栏目录">交易员崛起 · 专栏目录</a></li></ul>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
