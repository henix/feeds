<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Scala vs Clojure</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/20145351">原文</a></p>
<p>本文对工程中选择Scala和Clojure的优劣进行了主观评价，仅供参考。</p><b>语法</b><br>Clojure采用Lisp语法，语法更简洁。<br>Scala更接近Java习惯。<br>（平手）<br><br><b>类型系统</b><br>Clojure是动态类型语言，类型系统弱。<br>Scala有强大的静态类型系统，支持类型推断、泛型、既存类型。<br>（Scala胜）<br><br><b>功能</b><br>Clojure的标准库小巧，容器不算丰富，能调用Java库，但Java调用clojure函数不方便。<br>Scala与Java的互交互性极好，标准库中有完备的可变容器库以及不可变容器库。社区也有好几种Spark、Play、Akka等杀手级框架。<br>（Scala胜）<br><br><b>性能</b><br>Clojure在动态类型语言中是顶尖的性能，<br>Scala和Java性能相当，比Clojure稍快（<a href="https://benchmarksgame.alioth.debian.org/u64/benchmark.php?test=all&amp;lang=clojure&amp;lang2=scala&amp;data=u64" class="">https://benchmarksgame.alioth.debian.org/u64/benchmark.php?test=all&amp;lang=clojure&amp;lang2=scala&amp;data=u64</a>）。<br>（Scala胜）<br><br><b>宏</b><br>Clojure继承了Lisp『代码即数据』的思想，宏稳定易用。用Clojure进行元编程，定义DSL很方便。<br>Scala也有宏，但Scala的宏复杂bug又多，只能说聊胜于无。一部分原因是因为Scala语言本身较为复杂，另一部分原因是Scala宏的设计拙劣。<br>（Clojure 胜）<br><br>综上所述：<br>如果你的项目大量使用元编程的编程范式，那么用更简洁的Clojure，多用宏，多定义自己的DSL，就不错。<br>如果你使用主流的面向对象编程和函数式编程范式，那么用Scala更加高效。<br><br>（本文完，以下是八卦）<br><br>有趣的是，Clojure作为一门动态类型语言，能获得只比Scala稍差性能的原因，归根到底，跟Scala的作者还有点关系。<br><br>Scala的作者马丁·奥德斯基也是Generic Java的作者，而Generic Java主要是给Java增加了泛型功能，后来整合到了SUN的Java 5中。<br><br>由于旧版Java虚拟机不支持泛型，为了保证向后兼容性，马丁采用了『类型擦除』的方案。类型参数在运行时会被抹掉，Java虚拟机还是把泛型类型当成Object一样处理。可想而知这么做性能好不了。<br><br>于是Java虚拟机就拼命优化，什么装箱拆箱、虚函数调用、类型检查，统统优化掉，还可以在运行时分析字节码，优化最常调用的分支的性能。这些优化，除了能增进泛型的性能以外，对动态类型语言也很有效。<br><br>结果就是，Clojure的CPU性能可以吊打JavaScript V8虚拟机，而V8又可以吊打世界上其他一切非Lisp的动态类型语言。（评测参见<a href="https://benchmarksgame.alioth.debian.org/u64/benchmark.php?test=all&amp;lang=clojure&amp;lang2=v8&amp;data=u64" class="">https://benchmarksgame.alioth.debian.org/u64/benchmark.php?test=all&amp;lang=clojure&amp;lang2=v8&amp;data=u64</a>，V8和Clojure相比，唯一获胜项目是正则表达式匹配，归功于库而不是虚拟机本身 ）
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
