<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>TensorFlow 学习之循环神经网络（RNN）</title>
</head>
<body>
<p><a href="https://mp.weixin.qq.com/s?timestamp=1548447375&amp;src=3&amp;ver=1&amp;signature=1FUoAzhNzQsJjxvguV9C36O8brhKfZ91rINdoH0s90cKuA1rmIEYDOqmRHMdswDQfMFTtcyPtwh6*8p5XtiX9gjF4Bl6lqPxCcPfc1K54xkj7PdptbVg0NV39-uhPe1qS*R*gnRhOQrzgu5dxuViYDtApUSkgX6n09ASqiUTC9g=">原文</a></p>
<div id="js_top_ad_area" class="top_banner"></div><div class="rich_media_inner">

        
        
        <div id="page-content" class="rich_media_area_primary">
          <div class="rich_media_area_primary_inner">
                                    
                        

            <div id="img-content">

                
                <h2 class="rich_media_title" id="activity-name">
                    
                    
                    TensorFlow 学习之循环神经网络（RNN）

                                                                                </h2>
                <div id="meta_content" class="rich_media_meta_list">
                                                            <span id="copyright_logo" class="rich_media_meta rich_media_meta_text meta_tag_text">原创：</span>
                                                            <span class="rich_media_meta rich_media_meta_text">
                                                JoinQuant-PM
                                            </span>
                                        
                                        <span class="rich_media_meta rich_media_meta_nickname" id="profileBt">
                      <a href="javascript:void(0);" id="js_name">
                        聚宽量化实验室                      </a>
                      <div id="js_profile_qrcode" class="profile_container" style="display:none;">
                          <div class="profile_inner">
                              <strong class="profile_nickname">聚宽量化实验室</strong>
                              <img class="profile_avatar" id="js_profile_qrcode_img" src="" alt="">

                              <p class="profile_meta">
                              <label class="profile_meta_label">微信号</label>
                              <span class="profile_meta_value">JoinQuant-jx</span>
                              </p>

                              <p class="profile_meta">
                              <label class="profile_meta_label">功能介绍</label>
                              <span class="profile_meta_value">用数学+编程，驾驭金融市场波动。 汇集最优质量化投资模型，和最勤奋聪明的大脑。</span>
                              </p>
                              
                          </div>
                          <span class="profile_arrow_wrp" id="js_profile_arrow_wrp">
                              <i class="profile_arrow arrow_out"></i>
                              <i class="profile_arrow arrow_in"></i>
                          </span>
                      </div>
                    </span>


                    <em id="publish_time" class="rich_media_meta rich_media_meta_text"></em>





                </div>
                
                
                
                
                                                
                                                                
                                
                
                <div class="rich_media_content " id="js_content">
                    

                    

                    
                    
                    <section style="box-sizing: border-box;font-size: 16px;"><section style="box-sizing: border-box;" powered-by="xiumi.us"><section style="margin-top: 10px;margin-bottom: 10px;text-align: center;box-sizing: border-box;"><section style="display: inline-block;width: 100%;border-width: 1px;border-style: solid;border-color: transparent;padding: 10px;box-sizing: border-box;"><section style="box-sizing: border-box;" powered-by="xiumi.us"><section style="box-sizing: border-box;"><section style="text-align: justify;font-size: 14px;box-sizing: border-box;"><p style="white-space: normal;box-sizing: border-box;">近期， JoinQuant 金融终端上线了<strong style="box-sizing: border-box;">python3.6版本</strong>，并且为小伙伴们带来了诸多重要更新：</p><ul class=" list-paddingleft-2" style=""><li><p style="box-sizing: border-box;">期权数据；<br style="box-sizing: border-box;"></p></li><li><p style="box-sizing: border-box;">支持 Tick 回测功能；</p></li><li><p style="box-sizing: border-box;">研究示例文件增加了 TensorFlow、PyTorch 的安装教程；<br style="box-sizing: border-box;"></p></li><li><p style="box-sizing: border-box;">支持 pip 一键安装 TensorFlow、PyTorch、Keras 等深度学习库；<br style="box-sizing: border-box;"></p></li><li><p style="box-sizing: border-box;">组合优化更新：支持风险因子暴露限制、换手率限制、流动性限制、流动性限制、行业偏离度限制、追踪误差限制、换手率限制等；</p></li></ul><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p><p style="white-space: normal;box-sizing: border-box;">温馨提示：可以点击JoinQuant 金融终端下载最新版本的客户端软件。<strong>点击<span style="text-decoration: underline;box-sizing: border-box;">阅读原文</span><span style="box-sizing: border-box;">，</span><span style="box-sizing: border-box;">可</span>获取本文研究文件。</strong></p><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p></section></section></section><section style="box-sizing: border-box;" powered-by="xiumi.us"><section style="margin-top: 10px;margin-bottom: 10px;box-sizing: border-box;"><section style="width: 100%;border-top: 1px solid rgba(0, 0, 0, 0.92);box-sizing: border-box;"></section><section style="padding-right: 9px;padding-left: 9px;margin-top: -9px;margin-bottom: -9px;box-sizing: border-box;"><section style="border-left: 1px solid rgba(0, 0, 0, 0.92);border-right: 1px solid rgba(0, 0, 0, 0.92);padding: 15px;box-sizing: border-box;"><section style="box-sizing: border-box;" powered-by="xiumi.us"><section style="box-sizing: border-box;"><section style="text-align: left;font-size: 14px;line-height: 1.8;box-sizing: border-box;"><p style="text-indent: 0em;box-sizing: border-box;"><span style="font-size: 15px;box-sizing: border-box;"><strong style="box-sizing: border-box;">目录</strong></span></p><ol class=" list-paddingleft-2" style=""><li><p style="box-sizing: border-box;">循环神经网络简介</p></li><li><p style="box-sizing: border-box;">简单的循环神经网络</p></li><li><p style="box-sizing: border-box;">用TensorFlow构建简单的循环神经网络</p></li><li><p style="box-sizing: border-box;">各种不同的循环神经网络</p></li></ol></section></section></section></section></section><section style="width: 100%;border-bottom: 1px solid rgba(0, 0, 0, 0.92);box-sizing: border-box;"></section></section></section></section></section></section><section style="box-sizing: border-box;" powered-by="xiumi.us"><section style="margin-top: 10px;margin-bottom: 10px;text-align: center;box-sizing: border-box;"><section style="display: inline-block;width: 100%;border-width: 1px;border-style: solid;border-color: transparent;padding: 10px;box-sizing: border-box;"><section style="box-sizing: border-box;" powered-by="xiumi.us"><section style="margin-top: 10px;margin-bottom: 10px;text-align: left;box-sizing: border-box;"><section style="display: inline-block;vertical-align: top;background-color: rgb(255, 255, 255);box-sizing: border-box;"><section style="display: inline-block;vertical-align: top;padding-right: 5px;box-sizing: border-box;"><p style="box-sizing: border-box;"><strong style="box-sizing: border-box;">1. 循环神经网络简介</strong></p></section><section style="margin-right: 4px;margin-bottom: 4px;display: inline-block;vertical-align: bottom;width: 5px;border-right: 1px solid rgba(0, 0, 0, 0.92);border-left: 1px solid rgba(0, 0, 0, 0.92);height: 8px;transform-origin: center bottom 0px;-webkit-transform-origin: center bottom 0px;-moz-transform-origin: center bottom 0px;-o-transform-origin: center bottom 0px;transform: skew(-30deg);-webkit-transform: skew(-30deg);-moz-transform: skew(-30deg);-o-transform: skew(-30deg);border-top-color: rgba(0, 0, 0, 0.92);border-bottom-color: rgba(0, 0, 0, 0.92);box-sizing: border-box;"></section></section><section style="height: 12px;margin-top: -12px;border-top: 1px solid rgba(0, 0, 0, 0.92);box-sizing: border-box;"></section></section></section><section style="box-sizing: border-box;" powered-by="xiumi.us"><section style="box-sizing: border-box;"><section style="text-align: justify;font-size: 14px;line-height: 1.8;box-sizing: border-box;"><p style="white-space: normal;box-sizing: border-box;"><strong style="box-sizing: border-box;">循环神经网络</strong><span style="font-size: 13px;box-sizing: border-box;">（Recurrent Neural Network, RNN）</span>是一类用于处理序列数据的神经网络。就像卷积网络是专门用于处理网格化数据（像一个图像），循环神经网络是专门用于处理序列数据的。<span style="color: rgba(53, 53, 53, 0.88);font-size: 12px;letter-spacing: 0px;">P.S. 为了方便理解，该篇文章尽量的删减了所需公式部分。 </span></p><p style="white-space: normal;box-sizing: border-box;"><span style="color: rgba(53, 53, 53, 0.88);font-size: 12px;letter-spacing: 0px;"><br></span></p><p style="white-space: normal;box-sizing: border-box;">讲到循环神经网络就不得不提起神经网络，而两者最大的不同就是循环神经网络可以根据过去做到未来。我们可以根据不同的训练准则，选择性的精确保留过去序列的某些方面。下图为神经网络与循环神经网络的对比。</p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="0.21926053310404128" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/zEy1aCmAZQS5mRKwGwhQpWA8wKXpKTbcZ1WibcTMXk0C2ZZX7QcQYW1PN3Ko1M8tf9Ria3LFgrIlY0BNKibMmW8Mg/640?wx_fmt=png" data-type="png" data-w="1163" style=""></p><p style="white-space: normal;box-sizing: border-box;">在图中可以看到一个普通的神经网络就是将输入x通过函数f的计算再到状态h。而循环神经网络顾名思义就是一个循环过程，这个循环网络只处理来自输入X的信息，将其合并到经过时间向前传播的状态h，f是数据的处理函数。可以发现当前状态是可以影响其未来的状态。</p></section></section></section></section></section></section><section style="box-sizing: border-box;" powered-by="xiumi.us"><section style="margin-top: 10px;margin-bottom: 10px;text-align: center;box-sizing: border-box;"><section style="display: inline-block;width: 100%;border-width: 1px;border-style: solid;border-color: transparent;padding: 10px;box-sizing: border-box;"><section style="box-sizing: border-box;" powered-by="xiumi.us"><section style="margin-top: 10px;margin-bottom: 10px;text-align: left;box-sizing: border-box;"><section style="display: inline-block;vertical-align: top;background-color: rgb(255, 255, 255);box-sizing: border-box;"><section style="display: inline-block;vertical-align: top;padding-right: 5px;box-sizing: border-box;"><p style="box-sizing: border-box;"><strong style="box-sizing: border-box;">2.简单的循环神经网络</strong></p></section><section style="margin-right: 4px;margin-bottom: 4px;display: inline-block;vertical-align: bottom;width: 5px;border-right: 1px solid rgba(0, 0, 0, 0.92);border-left: 1px solid rgba(0, 0, 0, 0.92);height: 8px;transform-origin: center bottom 0px;-webkit-transform-origin: center bottom 0px;-moz-transform-origin: center bottom 0px;-o-transform-origin: center bottom 0px;transform: skew(-30deg);-webkit-transform: skew(-30deg);-moz-transform: skew(-30deg);-o-transform: skew(-30deg);border-top-color: rgba(0, 0, 0, 0.92);border-bottom-color: rgba(0, 0, 0, 0.92);box-sizing: border-box;"></section></section><section style="height: 12px;margin-top: -12px;border-top: 1px solid rgba(0, 0, 0, 0.92);box-sizing: border-box;"></section></section></section><section style="box-sizing: border-box;" powered-by="xiumi.us"><section style="box-sizing: border-box;"><section style="text-align: justify;font-size: 14px;line-height: 1.8;box-sizing: border-box;"><p style="white-space: normal;box-sizing: border-box;">我们将上面那个没有输出的循环神经网络扩展成一个完整的循环神经网络</p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="0.5536105032822757" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/zEy1aCmAZQS5mRKwGwhQpWA8wKXpKTbcDvFDzvfdwGjtohngzTsNyAZ8Mv5oyAqiayhSicCzz0f3j3BHMibvRbKfQ/640?wx_fmt=png" data-type="png" data-w="914" style=""></p><p style="white-space: normal;box-sizing: border-box;">在图中损失L衡量每个y^与相应的训练目标y的距离。从图中可以看出模型为向前传播。</p><p style="white-space: normal;box-sizing: border-box;"><br></p><p style="white-space: normal;box-sizing: border-box;">为了更好地解释上面的循环神经网络，我们先假设一些东西。在上图中没有指定隐藏单元的激活函数，我们假设激活函数为f。RNN从特定的起始状态h(0)开始向前传播。从t=1到t=τ的每个时间步，我们应用以下更新方程：</p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="0.4020618556701031" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/zEy1aCmAZQS5mRKwGwhQpWA8wKXpKTbcTx4JXe4TZxmt9EgIPQygINAIZ6Tj4sC5jYpTibwvIZqZhDYohd54ia1Q/640?wx_fmt=png" data-type="png" data-w="291" style=""></p><p style="white-space: normal;box-sizing: border-box;">其中的参数的偏执向量b和c联通权重矩阵<strong style="box-sizing: border-box;"> U、V、W</strong>，分别对应于输入到隐藏、隐藏到输出和隐藏到隐藏的链接的权重。通过上面的公式就可以计算出估计的y值，但是上面这些权重到底该取多少合适，我们并不知道，所以这个时候就需要通过我们上述估计出的y和真实的y做对比，之后通过设置学习率和选择优化器来重新调整<strong style="box-sizing: border-box;"> U、V、W</strong>，一直重复这个过程直到误差符合要求为止。这个过程和普通的神经网络是大致相同的。</p></section></section></section></section></section></section><section style="box-sizing: border-box;" powered-by="xiumi.us"><section style="margin-top: 10px;margin-bottom: 10px;text-align: center;box-sizing: border-box;"><section style="display: inline-block;width: 100%;border-width: 1px;border-style: solid;border-color: transparent;padding: 10px;box-sizing: border-box;"><section style="box-sizing: border-box;" powered-by="xiumi.us"><section style="margin-top: 10px;margin-bottom: 10px;text-align: left;box-sizing: border-box;"><section style="display: inline-block;vertical-align: top;background-color: rgb(255, 255, 255);box-sizing: border-box;"><section style="display: inline-block;vertical-align: top;padding-right: 5px;box-sizing: border-box;"><p style="box-sizing: border-box;"><strong style="box-sizing: border-box;">3. 用TensorFlow构建简单的循环神经网络</strong></p></section><section style="margin-right: 4px;margin-bottom: 4px;display: inline-block;vertical-align: bottom;width: 5px;border-right: 1px solid rgba(0, 0, 0, 0.92);border-left: 1px solid rgba(0, 0, 0, 0.92);height: 8px;transform-origin: center bottom 0px;-webkit-transform-origin: center bottom 0px;-moz-transform-origin: center bottom 0px;-o-transform-origin: center bottom 0px;transform: skew(-30deg);-webkit-transform: skew(-30deg);-moz-transform: skew(-30deg);-o-transform: skew(-30deg);border-top-color: rgba(0, 0, 0, 0.92);border-bottom-color: rgba(0, 0, 0, 0.92);box-sizing: border-box;"></section></section><section style="height: 12px;margin-top: -12px;border-top: 1px solid rgba(0, 0, 0, 0.92);box-sizing: border-box;"></section></section></section><section style="box-sizing: border-box;" powered-by="xiumi.us"><section style="box-sizing: border-box;"><section style="text-align: justify;font-size: 14px;line-height: 1.8;box-sizing: border-box;"><p style="white-space: normal;box-sizing: border-box;">TensorFlow 是计算机图模型，即用图的形式来表示运算过程的一种模型。大概来说就是我们需要在图中先画出来各个参数设定，设定好之后再运行它。对于 TensorFlow 图里面的各个元素来说，设定好它是并不运行的，直到用命令运行图中的某个参数我们才会运行。</p><p style="white-space: normal;box-sizing: border-box;"><br></p><p style="white-space: normal;box-sizing: border-box;"><strong style="box-sizing: border-box;">下面是用 TensorFlow 建立一个循环神经网络模型，查看模型训练的效果。</strong></p><p style="white-space: normal;box-sizing: border-box;"><br></p><p style="white-space: normal;box-sizing: border-box;">以沪深300指数为例，我们想要预测下一天的指数收盘价。具体思路就是为了精准的预测输出值，就需要一个多次重复的一个过程，先随机的指定权重和偏置，经过一次次的循环，更新权重和偏置，最后找到最优的值来确定输出。其中每一次的计算流程如下图所示，我们希望得到L(t)L(t),之后再根据其值得大小调整权重，最后得到训练的结果：</p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="0.5475206611570248" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/zEy1aCmAZQS5mRKwGwhQpWA8wKXpKTbcKc25Aib44Umfc4wfG7CGF4IrrUZzKibaHfYia0XwwXl0YkVYfh458COwA/640?wx_fmt=png" data-type="png" data-w="968" style=""></p><p style="white-space: normal;box-sizing: border-box;">注：在用 TensorFlow 最重要的一点就是对数据维度、形状的把控，一不小心就会出现问题。</p><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p><p style="white-space: normal;box-sizing: border-box;">第一步，我们需要载入用到的包。</p></section></section></section><section style="box-sizing: border-box;" powered-by="xiumi.us"><section style="margin-top: 10px;margin-bottom: 10px;box-sizing: border-box;"><section style="display: inline-block;width: 98%;border-width: 1px;border-style: solid;border-color: transparent;padding: 10px;background-color: rgb(239, 239, 239);box-sizing: border-box;"><section style="box-sizing: border-box;" powered-by="xiumi.us"><section style="box-sizing: border-box;"><section style="text-align: left;font-size: 14px;line-height: 1.7;box-sizing: border-box;"><p style="box-sizing: border-box;"><strong style="box-sizing: border-box;">import</strong> tensorflow <strong style="box-sizing: border-box;">as</strong> tf<br style="box-sizing: border-box;"><strong style="box-sizing: border-box;">import</strong> numpy <strong style="box-sizing: border-box;">as</strong> np<br style="box-sizing: border-box;"><strong style="box-sizing: border-box;">import</strong> pandas <strong style="box-sizing: border-box;">as</strong> pd<br style="box-sizing: border-box;"><span style="color: rgb(160, 160, 160);box-sizing: border-box;">#函数用于清除默认图形堆栈并重置全局默认图形</span><br style="box-sizing: border-box;">tf.reset_default_graph()</p></section></section></section></section></section></section><section style="box-sizing: border-box;" powered-by="xiumi.us"><section style="box-sizing: border-box;"><section style="text-align: justify;font-size: 14px;line-height: 1.8;box-sizing: border-box;"><p style="white-space: normal;box-sizing: border-box;">第二步，对输入值和输出值进行设定。</p></section></section></section><section style="box-sizing: border-box;" powered-by="xiumi.us"><section style="margin-top: 10px;margin-bottom: 10px;box-sizing: border-box;"><section style="display: inline-block;width: 98%;border-width: 1px;border-style: solid;border-color: transparent;padding: 10px;background-color: rgb(239, 239, 239);box-sizing: border-box;"><section style="box-sizing: border-box;" powered-by="xiumi.us"><section style="box-sizing: border-box;"><section style="text-align: left;font-size: 14px;line-height: 1.7;box-sizing: border-box;"><p style="box-sizing: border-box;"><span style="color: rgb(160, 160, 160);box-sizing: border-box;">#数据定义<br style="box-sizing: border-box;">#输入值x：以当天沪深300指数的开盘价、收盘价、最高价、最低价为输入数据</span><br style="box-sizing: border-box;">x_temp=get_price(<span style="color: rgb(169, 55, 68);box-sizing: border-box;">'000300.XSHG'</span>,start_date=<span style="color: rgb(169, 55, 68);box-sizing: border-box;">'2018-01-01'</span>,end_date=<span style="color: rgb(169, 55, 68);box-sizing: border-box;">'2018-12-31'</span>)[<span style="color: rgb(19, 134, 56);box-sizing: border-box;">0</span>:-<span style="color: rgb(19, 134, 56);box-sizing: border-box;">1</span>].iloc[:,:-<span style="color: rgb(19, 134, 56);box-sizing: border-box;">2</span>]<br style="box-sizing: border-box;"><span style="color: rgb(160, 160, 160);box-sizing: border-box;">#将x调整为TensorFlow的格式（由于tf处理数据的格式需要改成float32）</span>x=tf.Variable(np.array(x_temp).astype(np.float32))<br style="box-sizing: border-box;"><span style="color: rgb(160, 160, 160);box-sizing: border-box;">#输出值y：以第二天沪深300指数的收盘价作为输出数据</span>y_temp=get_price(<span style="color: rgb(169, 55, 68);box-sizing: border-box;">'000300.XSHG'</span>,start_date=<span style="color: rgb(169, 55, 68);box-sizing: border-box;">'2018-01-01'</span>,end_date=<span style="color: rgb(169, 55, 68);box-sizing: border-box;">'2018-12-31'</span>)[<span style="color: rgb(19, 134, 56);box-sizing: border-box;">1</span>:][<span style="color: rgb(169, 55, 68);box-sizing: border-box;">'open'</span>]<br style="box-sizing: border-box;"><span style="color: rgb(160, 160, 160);box-sizing: border-box;">#将y调整为TensorFlow的格式</span><br style="box-sizing: border-box;">y_temp=pd.DataFrame(y_temp)y=tf.Variable(np.array(y_temp).astype(np.float32))</p></section></section></section></section></section></section><section style="box-sizing: border-box;" powered-by="xiumi.us"><section style="box-sizing: border-box;"><section style="text-align: justify;font-size: 14px;line-height: 1.8;box-sizing: border-box;"><p style="white-space: normal;box-sizing: border-box;">第三步：定义循环神经网络的构成图与一些参数</p><p style="white-space: normal;box-sizing: border-box;">1、隐藏层的层数：</p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="0.07896077432501274" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/zEy1aCmAZQS5mRKwGwhQpWA8wKXpKTbcHGnq30XDSyeV64rkRwxicXiaroR7a0Pl2gMH0oyrT1jiciaDYichFBIm4EQ/640?wx_fmt=png" data-type="png" data-w="1963" style=""></p><p style="white-space: normal;box-sizing: border-box;">在图中显示为1层，但实际上层数多一点学习效果更好，可以想象为一个黑箱，这里设置为128层。</p><p style="white-space: normal;box-sizing: border-box;"><br></p><p style="white-space: normal;box-sizing: border-box;">2、学习率：学习率就是根据误差大小，选择学习的比率。这里设置为0.1</p></section></section></section><section style="box-sizing: border-box;" powered-by="xiumi.us"><section style="margin-top: 10px;margin-bottom: 10px;box-sizing: border-box;"><section style="display: inline-block;width: 98%;border-width: 1px;border-style: solid;border-color: transparent;padding: 10px;background-color: rgb(239, 239, 239);box-sizing: border-box;"><section style="box-sizing: border-box;" powered-by="xiumi.us"><section style="box-sizing: border-box;"><section style="text-align: left;font-size: 14px;line-height: 1.7;box-sizing: border-box;"><p style="box-sizing: border-box;"><span style="color: rgb(160, 160, 160);box-sizing: border-box;">#设置学习率为0.1</span><br style="box-sizing: border-box;">lr=<span style="color: rgb(19, 134, 56);box-sizing: border-box;">0.1</span><br style="box-sizing: border-box;"><span style="color: rgb(160, 160, 160);box-sizing: border-box;">#设置隐藏层的层数为128</span><br style="box-sizing: border-box;">hidden_units=<span style="color: rgb(19, 134, 56);box-sizing: border-box;">128</span><br style="box-sizing: border-box;"><span style="color: rgb(160, 160, 160);box-sizing: border-box;">#输入参数的维度</span><br style="box-sizing: border-box;">x_inputs=len(x_temp.columns)<br style="box-sizing: border-box;"><span style="color: rgb(160, 160, 160);box-sizing: border-box;">#输入数据的长度</span><br style="box-sizing: border-box;">n_step=len(x_temp.index)<br style="box-sizing: border-box;"><span style="color: rgb(160, 160, 160);box-sizing: border-box;">#输出的维度</span><br style="box-sizing: border-box;">y_output=len(y_temp.columns)</p></section></section></section></section></section></section><section style="box-sizing: border-box;" powered-by="xiumi.us"><section style="box-sizing: border-box;"><section style="text-align: justify;font-size: 14px;line-height: 1.8;box-sizing: border-box;"><p style="white-space: normal;box-sizing: border-box;">第四步：随机定义各个权重，这里需要设置的有x输入的权重U和输出的权重V，隐藏层的权重W可以不用自己设定</p></section></section></section><section style="box-sizing: border-box;" powered-by="xiumi.us"><section style="margin-top: 10px;margin-bottom: 10px;box-sizing: border-box;"><section style="display: inline-block;width: 98%;border-width: 1px;border-style: solid;border-color: transparent;padding: 10px;background-color: rgb(239, 239, 239);box-sizing: border-box;"><section style="box-sizing: border-box;" powered-by="xiumi.us"><section style="box-sizing: border-box;"><section style="text-align: left;font-size: 14px;line-height: 1.7;box-sizing: border-box;"><p style="box-sizing: border-box;"><span style="color: rgb(160, 160, 160);box-sizing: border-box;">#设置权重，权重为随机数</span><br style="box-sizing: border-box;">weights={    <br style="box-sizing: border-box;">    <span style="color: rgb(169, 55, 68);box-sizing: border-box;">'U'</span>:tf.Variable(tf.constant(<span style="color: rgb(19, 134, 56);box-sizing: border-box;">0</span>.<span style="color: rgb(19, 134, 56);box-sizing: border-box;">25</span>,shape=[x_inputs, y_output])),     <span style="color: rgb(169, 55, 68);box-sizing: border-box;">'V'</span>:tf.Variable(tf.random_normal([hidden_units, n_step])),}biases={    <br style="box-sizing: border-box;">     <span style="color: rgb(169, 55, 68);box-sizing: border-box;">'U'</span>:tf.Variable(tf.constant(<span style="color: rgb(19, 134, 56);box-sizing: border-box;">0</span>.<span style="color: rgb(19, 134, 56);box-sizing: border-box;">0</span>, shape=[n_step,y_output])),<br style="box-sizing: border-box;">   <span style="color: rgb(169, 55, 68);box-sizing: border-box;"> 'V'</span>:tf.Variable(tf.constant(<span style="color: rgb(19, 134, 56);box-sizing: border-box;">0</span>.<span style="color: rgb(19, 134, 56);box-sizing: border-box;">0</span>, shape=[n_step,])),}</p></section></section></section></section></section></section><section style="box-sizing: border-box;" powered-by="xiumi.us"><section style="box-sizing: border-box;"><section style="text-align: justify;font-size: 14px;line-height: 1.8;box-sizing: border-box;"><p style="white-space: normal;box-sizing: border-box;">第五步：计算的前期准备已经OK了，接下来可以进行计算了~按照上面图中的步骤：</p><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p><p style="white-space: normal;box-sizing: border-box;">（1）计算图中输入数据进行加权处理后得到的数据</p><p style="white-space: normal;box-sizing: border-box;"> a(t)=b+Wh(t−1)+Uxta(t)=b+Wh(t−1)+Uxt 根据权重和偏执的设置，用此公式得出的是x最终的输入数据</p></section></section></section><section style="box-sizing: border-box;" powered-by="xiumi.us"><section style="margin-top: 10px;margin-bottom: 10px;box-sizing: border-box;"><section style="display: inline-block;width: 98%;border-width: 1px;border-style: solid;border-color: transparent;padding: 10px;background-color: rgb(239, 239, 239);box-sizing: border-box;"><section style="box-sizing: border-box;" powered-by="xiumi.us"><section style="box-sizing: border-box;"><section style="text-align: left;font-size: 14px;line-height: 1.7;box-sizing: border-box;"><p style="box-sizing: border-box;">x_in = tf.matmul(x, weights[<span style="color: rgb(169, 55, 68);box-sizing: border-box;">'U'</span>])+biases[<span style="color: rgb(169, 55, 68);box-sizing: border-box;">'U'</span>]<br style="box-sizing: border-box;">x_in = tf.reshape(x_in, [-<span style="color: rgb(19, 134, 56);box-sizing: border-box;">1</span>, n_step, y_output])</p></section></section></section></section></section></section><section style="box-sizing: border-box;" powered-by="xiumi.us"><section style="box-sizing: border-box;"><section style="text-align: justify;font-size: 14px;line-height: 1.8;box-sizing: border-box;"><p style="white-space: normal;box-sizing: border-box;">（2）定义隐藏层的处理方式和计算出输出值</p></section></section></section><section style="box-sizing: border-box;" powered-by="xiumi.us"><section style="margin-top: 10px;margin-bottom: 10px;box-sizing: border-box;"><section style="display: inline-block;width: 98%;border-width: 1px;border-style: solid;border-color: transparent;padding: 10px;background-color: rgb(239, 239, 239);box-sizing: border-box;"><section style="box-sizing: border-box;" powered-by="xiumi.us"><section style="box-sizing: border-box;"><section style="text-align: left;font-size: 14px;line-height: 1.7;box-sizing: border-box;"><p style="box-sizing: border-box;"><span style="color: rgb(160, 160, 160);box-sizing: border-box;">#定义隐藏层的处理方式（这里的函数是可以自行选择,可以多去探索一下）</span><br style="box-sizing: border-box;">cell = tf.nn.rnn_cell.LSTMCell(hidden_units)<br style="box-sizing: border-box;"><span style="color: rgb(160, 160, 160);box-sizing: border-box;">#计算出隐藏层中每层的结果</span><br style="box-sizing: border-box;">outputs, states = tf.nn.dynamic_rnn(cell, x_in, dtype=tf.float32)<br style="box-sizing: border-box;"><span style="color: rgb(160, 160, 160);box-sizing: border-box;">#outputs记录了隐藏层中每一层的输出，但是如果要计算出最后的输出，只需要最后一层即可</span><br style="box-sizing: border-box;">output = tf.transpose(outputs, [1,0,2])[-1]<br style="box-sizing: border-box;"><span style="color: rgb(160, 160, 160);box-sizing: border-box;">#根据权重得到对y的估计值</span><br style="box-sizing: border-box;">results=tf.matmul(output, weights['V']) + biases['V']</p></section></section></section></section></section></section><section style="box-sizing: border-box;" powered-by="xiumi.us"><section style="box-sizing: border-box;"><section style="text-align: justify;font-size: 14px;line-height: 1.8;box-sizing: border-box;"><p style="white-space: normal;box-sizing: border-box;">（3）求出预测的误差，再根据误差大小和学习率用优化器调整权重设置。</p></section></section></section><section style="box-sizing: border-box;" powered-by="xiumi.us"><section style="margin-top: 10px;margin-bottom: 10px;box-sizing: border-box;"><section style="display: inline-block;width: 98%;border-width: 1px;border-style: solid;border-color: transparent;padding: 10px;background-color: rgb(239, 239, 239);box-sizing: border-box;"><section style="box-sizing: border-box;" powered-by="xiumi.us"><section style="box-sizing: border-box;"><section style="text-align: left;font-size: 14px;line-height: 1.7;box-sizing: border-box;"><p style="box-sizing: border-box;"><span style="color: rgb(160, 160, 160);box-sizing: border-box;">#算误差</span><br style="box-sizing: border-box;">cost=tf.reduce_mean(tf.square(results-y))<br style="box-sizing: border-box;"><span style="color: rgb(160, 160, 160);box-sizing: border-box;">#根据误差大小和学习率用优化器调整权重设置</span><br style="box-sizing: border-box;">train_op = tf.train.AdamOptimizer(<span style="color: rgb(19, 134, 56);box-sizing: border-box;">0.1</span>).minimize(cost)</p></section></section></section></section></section></section><section style="box-sizing: border-box;" powered-by="xiumi.us"><section style="box-sizing: border-box;"><section style="text-align: justify;font-size: 14px;line-height: 1.8;box-sizing: border-box;"><p style="white-space: normal;box-sizing: border-box;">第六步：进行多遍循环运行，并查看误差</p></section></section></section><section style="box-sizing: border-box;" powered-by="xiumi.us"><section style="margin-top: 10px;margin-bottom: 10px;box-sizing: border-box;"><section style="display: inline-block;width: 98%;border-width: 1px;border-style: solid;border-color: transparent;padding: 10px;background-color: rgb(239, 239, 239);box-sizing: border-box;"><section style="box-sizing: border-box;" powered-by="xiumi.us"><section style="box-sizing: border-box;"><section style="text-align: left;font-size: 14px;line-height: 1.7;box-sizing: border-box;"><p style="box-sizing: border-box;"><span style="color: rgb(160, 160, 160);box-sizing: border-box;">#初始化</span><br style="box-sizing: border-box;">init = tf.global_variables_initializer()<br style="box-sizing: border-box;"><span style="color: rgb(160, 160, 160);box-sizing: border-box;">#构建一个图</span><br style="box-sizing: border-box;">sess = tf.Session()<br style="box-sizing: border-box;"><span style="color: rgb(160, 160, 160);box-sizing: border-box;">#先把图初始化</span><br style="box-sizing: border-box;">sess.run(init)<br style="box-sizing: border-box;"><span style="color: rgb(160, 160, 160);box-sizing: border-box;">#运行30000次来调整权重，每1000次打印出误差和预测的y值</span><br style="box-sizing: border-box;"><strong style="box-sizing: border-box;">for</strong> i <strong style="box-sizing: border-box;">in</strong> range(<span style="color: rgb(19, 134, 56);box-sizing: border-box;">30000</span>):    </p><p style="box-sizing: border-box;">        sess.run(train_op)    <br style="box-sizing: border-box;">             <strong style="box-sizing: border-box;"> if</strong> i % <span style="color: rgb(19, 134, 56);box-sizing: border-box;">1000</span> == <span style="color: rgb(19, 134, 56);box-sizing: border-box;">0</span>:        <br style="box-sizing: border-box;">                <span style="font-size: 12px;color: rgb(160, 160, 160);box-sizing: border-box;">  #由于学习出的结果过多，这里只显示最后一个值</span>                print(sess.run(cost),sess.run(results[<span style="color: rgb(19, 134, 56);box-sizing: border-box;">-1</span>][<span style="color: rgb(19, 134, 56);box-sizing: border-box;">-1</span>]))</p></section></section></section></section></section></section><section style="box-sizing: border-box;" powered-by="xiumi.us"><section style="box-sizing: border-box;"><section style="text-align: justify;font-size: 14px;line-height: 1.8;box-sizing: border-box;"><p style="white-space: normal;box-sizing: border-box;">最后通过运行就可以看到训练的结果。</p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="0.45073375262054505" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/zEy1aCmAZQS5mRKwGwhQpWA8wKXpKTbc8qNDSZbk3IJWoukibVhme9cZXqqGciculFZe0s4ZHO4Fz4pHx5QGsp0A/640?wx_fmt=png" data-type="png" data-w="477" style=""></p><p style="white-space: normal;box-sizing: border-box;">我们就可以看出，训练误差已经是非常的小了，这证明循环神经网络的学习能力还是很强的！我们可以通过调整里面的参数来建立自己的循环神经网络模型。</p><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p><p style="white-space: normal;box-sizing: border-box;"><strong style="box-sizing: border-box;">综上所述这里提供了一个经过循环神经网络算法来预测股票收盘价的模型训练过程，提供了该算法的思路流程。这里并没有使用模型预测的步骤，文章只是想讲解RNN，因此未包含模型预测部分，请知悉~</strong></p><p style="white-space: normal;box-sizing: border-box;"><br></p><p style="white-space: normal;box-sizing: border-box;">P.S. 注意！在实际应用中，训练中的误差不是越小越好~有的时候训练时样本误差很小，但到实验组时就会出现预测效率大大降低。这是由于学习过度也就是过拟合！所以说一定要掌握好一个合适的度！</p></section></section></section></section></section></section><section style="box-sizing: border-box;" powered-by="xiumi.us"><section style="margin-top: 10px;margin-bottom: 10px;text-align: center;box-sizing: border-box;"><section style="display: inline-block;width: 100%;border-width: 1px;border-style: solid;border-color: transparent;padding: 10px;box-sizing: border-box;"><section style="box-sizing: border-box;" powered-by="xiumi.us"><section style="margin-top: 10px;margin-bottom: 10px;text-align: left;box-sizing: border-box;"><section style="display: inline-block;vertical-align: top;background-color: rgb(255, 255, 255);box-sizing: border-box;"><section style="display: inline-block;vertical-align: top;padding-right: 5px;box-sizing: border-box;"><p style="box-sizing: border-box;"><strong style="box-sizing: border-box;">4. 各种不同的循环神经网络</strong></p></section><section style="margin-right: 4px;margin-bottom: 4px;display: inline-block;vertical-align: bottom;width: 5px;border-right: 1px solid rgba(0, 0, 0, 0.92);border-left: 1px solid rgba(0, 0, 0, 0.92);height: 8px;transform-origin: center bottom 0px;-webkit-transform-origin: center bottom 0px;-moz-transform-origin: center bottom 0px;-o-transform-origin: center bottom 0px;transform: skew(-30deg);-webkit-transform: skew(-30deg);-moz-transform: skew(-30deg);-o-transform: skew(-30deg);border-top-color: rgba(0, 0, 0, 0.92);border-bottom-color: rgba(0, 0, 0, 0.92);box-sizing: border-box;"></section></section><section style="height: 12px;margin-top: -12px;border-top: 1px solid rgba(0, 0, 0, 0.92);box-sizing: border-box;"></section></section></section><section style="box-sizing: border-box;" powered-by="xiumi.us"><section style="box-sizing: border-box;"><section style="text-align: justify;font-size: 14px;line-height: 1.8;box-sizing: border-box;"><p style="white-space: normal;box-sizing: border-box;">所以你以为循环神经网络就是这么简单吗...NO！循环神经网络可以再各处进行循环，例如：</p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="0.539282250242483" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/zEy1aCmAZQS5mRKwGwhQpWA8wKXpKTbcPG8BIleQdmYtXmpCRXXAfdNa9wnJf458NnmU1NIfwhQdjWElic1cVpQ/640?wx_fmt=png" data-type="png" data-w="1031" style=""></p><p style="white-space: normal;box-sizing: border-box;">这类RNN的唯一循环是从输出到隐藏层的反馈链接。</p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="0.6756756756756757" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/zEy1aCmAZQS5mRKwGwhQpWA8wKXpKTbcXIRyX2GXvtJEHwHvGprB1TaQBc7clu9VzMNxDhiakJFluLydZpUJdkg/640?wx_fmt=png" data-type="png" data-w="592" style=""></p><p style="white-space: normal;box-sizing: border-box;">这类 RNN 是在时间序列结束时，具有单个输出。</p><p style="white-space: normal;box-sizing: border-box;">RNN 有很多不同的种类，我们可以根据需要自己构建不同的 RNN 的模型。</p><p style="white-space: normal;box-sizing: border-box;"><br></p><p style="white-space: normal;box-sizing: border-box;">循环神经网络就到这里就结束了！欢迎指正批评！</p></section></section></section></section></section></section></section>
                </div>
                <script nonce="1332689026" type="text/javascript">
                    var first_sceen__time = (+new Date());

                    if ("" == 1 && document.getElementById('js_content')) {
                        document.getElementById('js_content').addEventListener("selectstart",function(e){ e.preventDefault(); });
                    }

                    
                    (function(){
                        if (navigator.userAgent.indexOf("WindowsWechat") != -1){
                            var link = document.createElement('link');
                            var head = document.getElementsByTagName('head')[0];
                            link.rel = 'stylesheet';
                            link.type = 'text/css';
                            link.href = "//res.wx.qq.com/mmbizwap/zh_CN/htmledition/style/page/appmsg_new/winwx430b95.css";
                            head.appendChild(link);
                        }
                    })();
                </script>

                
                <div class="ct_mpda_wrp" id="js_sponsor_ad_area" style="display:none;"></div>
                
                
                <div class="read-more__area" id="js_more_read_area" style="display:none;">
                    
                </div>

                
                                <div class="reward_area tc reward_area_primary" id="js_preview_reward_author" style="display:none;">
                    <div class="reward-avatar" style="display: none;" id="js_preview_reward_author_avatar">
                        <img src="" alt="" id="js_preview_reward_author_head">
                    </div>
                    
                                        <div class="reward-author" id="js_preview_reward_author_name">JoinQuant-PM</div>
                                        <p class="reward_tips" id="js_preview_reward_author_wording" style="display:none;"></p>
                    <p>
                        <a class="reward_button" id="js_preview_reward_author_link" href="##"><span id="js_preview_reward_link_text">赞赏</span></a>
                    </p>
                </div>

                <div class="reward_qrcode_area reward_area tc" id="js_preview_reward_qrcode" style="display:none;">
                    <p class="tips_global">长按二维码向我转账</p>
                    <p id="js_preview_reward_ios_wording" class="reward_tips" style="display:none;"></p>
                    <span class="reward_qrcode_img_wrp"><img class="reward_qrcode_img" src="//res.wx.qq.com/mmbizwap/zh_CN/htmledition/images/pic/appmsg/pic_reward_qrcode.2x42f400.png"></span>
                    <p class="tips_global">受苹果公司新规定影响，微信 iOS 版的赞赏功能被关闭，可通过二维码转账支持公众号。</p>
                </div>
                                
                
                            </div>
                                    
                        


                        
            <ul id="js_hotspot_area" class="article_extend_area"></ul>


            

            


<div class="rich_media_tool" id="js_toobar3">

        <a class="media_tool_meta meta_primary" id="js_view_source" href="##">阅读原文</a>
        <div id="js_read_area3" class="media_tool_meta tips_global_primary meta_primary" style="display:none;">阅读 <span id="readNum3"></span></div>

    <span style="display:none;" class="media_tool_meta meta_extra meta_praise" id="like_old">
        <i class="icon_praise_gray"></i><span class="praise_num" id="likeNum_old"></span>
    </span>

    <span style="display:none;" class="media_tool_meta meta_extra meta_like" id="like3">
        <button class="like_btn" id="js_like_btn"> 
          好看<span class="like_num" id="likeNum3"></span>
        </button>
    </span>

    <div id="js_like_educate" style="display:none">
        <div class="weui-mask"></div>
        <div class="weui-dialog weui-dialog_haokan">
        <div class="weui-dialog__hd"><strong class="weui-dialog__title" id="educate_title">已推荐到看一看</strong></div>
        <div class="weui-dialog__bd">
          <img class="pic_haokan" src="//res.wx.qq.com/mmbizwap/zh_CN/htmledition/images/pic/appmsg/pic_haokan42f400.png">
            你的朋友可以在“发现”-“看一看”看到你认为好看的文章。        </div>
        <div class="weui-dialog__ft" id="educate_btn" style="display: none">
          <a href="javascript:;" class="weui-dialog__btn weui-dialog__btn_default" id="js_cancel">取消</a>
          <a href="javascript:;" class="weui-dialog__btn weui-dialog__btn_primary" id="js_confirm">推荐</a>
        </div>
        <div class="weui-dialog__ft" id="educate_btn2" style="display: none">
          <a href="javascript:;" class="weui-dialog__btn weui-dialog__btn_primary" id="js_acknowledge">我知道了</a>
        </div>
        </div>
    </div>

    <div id="js_unlike_educate" style="display:none">
        <div class="weui-mask"></div>
        <div class="weui-dialog">
        
        <div class="weui-dialog__bd">
            已取消，“好看”想法已同步删除        </div>
        <div class="weui-dialog__ft">
          <a href="javascript:;" class="weui-dialog__btn weui-dialog__btn_primary" id="js_unlike_know">知道了</a>
        </div>
        </div>
    </div>

    
    </div>


<div class="like_comment_wrp" id="js_a_like_comment" style="display: none;">
  <div class="like_comment_inner">
    <div class="like_comment_hd" style="display:none" id="js_like_title"></div>
    <div class="like_comment_bd">
      <div class="tips_global_primary like_comment_tips">
        <i class="weui-icon-success"></i>已推荐到看一看<a href="javascript:;" class="like_comment_share_link" id="js_a_like_comment_share">和朋友分享想法</a>
      </div>
    </div>
    <div class="like_comment_ft">
      <span id="js_a_like_comment_msg" class="like_comment_msg" style="visibility:hidden">最多200字，当前共<span id="js_a_like_current_cnt"></span>字</span>
      <button class="like_comment_btn" disabled id="js_a_like_confirm">发送</button>
    </div>
  </div>
</div>

<div id="js_like_toast" style="display: none;">
  <div class="weui-mask_transparent"></div>
  <div class="weui-toast">
    <i class="weui-icon-success-no-circle weui-icon_toast"></i>
    <p class="weui-toast__content" id="js_toast_msg">已发送</p>
  </div>
</div>


<div style="display: none;" id="js_b_comment_panel" class="like_comment_primary_pop">
  <div class="like_comment_primary_wrp" id="js_b_wrp">
    <div class="like_comment_primary_inner">
      <div class="like_comment_primary_hd">
        <h4 class="like_comment_primary_title">
          朋友将在看一看看到        </h4>
        <button id="js_b_like_confirm" class="like_comment_primary_btn">确定</button>
      </div>
      <div id="js_b_comment_text_first" class="like_comment_primary_bd">
        <span class="tips_global_primary">
          分享你的想法...        </span>
      </div>
    </div>
  </div>
  <div class="like_comment_primary_mask" id="js_mask_1"></div>
</div>

<div style="display: none;" id="js_b_comment_final">
  <div class="like_comment_primary_wrp editing" id="js_comment_wrp">
    <div class="like_comment_primary_inner">
      <div class="like_comment_primary_hd">
        <button class="like_comment_primary_cancel" id="js_b_comment_cancel">取消</button>
        <h4 class="like_comment_primary_title"> 分享想法到看一看 </h4>
        <button class="like_comment_primary_btn" id="js_b_comment_confirm">确定</button>
      </div>
      <div class="like_comment_primary_bd">
        <textarea class="like_comment_textarea weui-textarea" placeholder="分享你的想法..." id="js_b_comment_text_second"></textarea>
      </div>
      <span class="like_comment_msg" id="js_b_like_comment_msg" style="visibility: hidden;">最多200字，当前共<span id="js_b_like_current_cnt"></span>字</span>
    </div>
  </div>
  <div class="like_comment_primary_mask" id="js_mask_2"></div>
</div>

<div id="js_loading" style=" display: none;">
    <div class="weui-mask_transparent"></div>
    <div class="weui-toast">
        <i class="weui-loading weui-icon_toast"></i>
        <p class="weui-toast__content">发送中</p>
    </div>
</div>

<div id="js_fail" style="display:none">
    <div class="weui-mask"></div>
    <div class="weui-dialog">
    <div class="weui-dialog__bd">
        网络异常，请稍后重试    </div>
    <div class="weui-dialog__ft">
      <a href="javascript:;" class="weui-dialog__btn weui-dialog__btn_primary" id="js_fail_inform">知道了</a>
    </div>
    </div>
</div>



                        <div class="rich_media_tool" id="js_sg_bar">

                                <a class="media_tool_meta meta_primary" href="https://www.joinquant.com/post/16250?tag=algorithm" target="_blank">阅读原文</a>
                                
            </div>
                      </div>
        </div>

        <div class="rich_media_area_primary sougou" id="sg_tj" style="display:none"></div>


        
        <div class="rich_media_area_extra">
          <div class="rich_media_area_extra_inner">
              
              <div id="js_share_appmsg">
              </div>

              
                            <div class="mpda_bottom_container" id="js_bottom_ad_area"></div>
                            
              <div id="js_iframetest" style="display:none;"></div>
                            
                            
              <div class="rich_media_extra rich_media_extra_discuss" id="js_cmt_container" style="display:none">
                

                
                <div class="discuss_mod" id="js_friend_cmt_area" style="display:none">
                  
                  
                  
                </div>

                                <div class="discuss_mod" id="js_cmt_area" style="display:none">
                </div>
                              </div>
          </div>
        </div>

        
        <div id="js_pc_qr_code" class="qr_code_pc_outer" style="display:none;">
            <div class="qr_code_pc_inner">
                <div class="qr_code_pc">
                    <img id="js_pc_qr_code_img" class="qr_code_pc_img">
                    <p>微信扫一扫<br>关注该公众号</p>
                </div>
            </div>
        </div>
    </div>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
</body>
</html>
