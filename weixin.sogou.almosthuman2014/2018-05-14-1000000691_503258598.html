<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>业界 | 微信团队开源围棋AI技术PhoenixGo，复现AlphaGo Zero论文</title>
</head>
<body>
<p><a href="https://mp.weixin.qq.com/s?timestamp=1527113929&amp;src=3&amp;ver=1&amp;signature=XzB467pTXWO0syvN4O5xx3LsUEQoaadJb3N3ISU07ZSCJqhai4S2d7nPmCcGcGxlIB*r2-gEO-FMfdkjOCITKuKFpgRIuyJkkSPfd9h543sMbff4mBOIOnO5IZZ52BVyJVNG8YPiY-IWB6ehV71xff*tCkpO2oY88AC-n3SdqHg=">原文</a></p>
<div id="js_top_ad_area" class="top_banner"></div><div class="rich_media_inner">
                        
        
        <div id="page-content" class="rich_media_area_primary">
            
                        
            <div id="img-content">
                
                <h2 class="rich_media_title" id="activity-name">
                    业界 | 微信团队开源围棋AI技术PhoenixGo，复现AlphaGo Zero论文                                    </h2>
                <div id="meta_content" class="rich_media_meta_list">
                                                            <span class="rich_media_meta rich_media_meta_nickname" id="profileBt">
                      <a href="javascript:void(0);">
                        机器之心                      </a>
                      <div id="js_profile_qrcode" class="profile_container" style="display:none;">
                          <div class="profile_inner">
                              <strong class="profile_nickname">机器之心</strong>
                              <img class="profile_avatar" id="js_profile_qrcode_img" src="" alt="">

                              <p class="profile_meta">
                              <label class="profile_meta_label">微信号</label>
                              <span class="profile_meta_value">almosthuman2014</span>
                              </p>

                              <p class="profile_meta">
                              <label class="profile_meta_label">功能介绍</label>
                              <span class="profile_meta_value">专业的人工智能媒体和产业服务平台</span>
                              </p>
                              
                          </div>
                          <span class="profile_arrow_wrp" id="js_profile_arrow_wrp">
                              <i class="profile_arrow arrow_out"></i>
                              <i class="profile_arrow arrow_in"></i>
                          </span>
                      </div>
                    </span>

                    <em id="publish_time" class="rich_media_meta rich_media_meta_text">2018-05-14</em>

                                    </div>
                
                
                
                
                                                
                                                                
                
                <div class="rich_media_content " id="js_content">
                    

                    

                    
                    
                    <section style="max-width: 100%;color: rgb(51, 51, 51);"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section data-id="85660" data-custom="rgb(117, 117, 118)" data-color="rgb(117, 117, 118)" style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section data-id="85660" data-custom="rgb(117, 117, 118)" data-color="rgb(117, 117, 118)" style="max-width: 100%;border-width: 0px;border-style: initial;border-color: currentcolor;font-family: 微软雅黑;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="margin-top: 2em;padding-top: 0.5em;padding-bottom: 0.5em;max-width: 100%;border-style: solid none;font-family: inherit;text-decoration: inherit;border-top-color: rgb(204, 204, 204);border-bottom-color: rgb(204, 204, 204);border-top-width: 1px;border-bottom-width: 1px;box-sizing: border-box !important;word-wrap: break-word !important;"><p style="margin-top: -1.2em;max-width: 100%;min-height: 1em;text-align: center;line-height: 1.75em;border-width: initial;border-style: initial;border-color: currentcolor;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(255, 255, 255);background-color: rgb(117, 117, 118);box-sizing: border-box !important;word-wrap: break-word !important;">选自GitHub</span></p><section data-style="white-space: normal; text-align: left;font-size: 14px;line-height: 1.5em; color: rgb(12, 12, 12);" style="padding: 16px 16px 10px;max-width: 100%;font-family: inherit;box-sizing: border-box !important;word-wrap: break-word !important;"><p style="max-width: 100%;min-height: 1em;text-align: center;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;font-family: inherit;text-decoration: inherit;color: rgb(136, 136, 136);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">机器之心编译</strong></p><p style="max-width: 100%;min-height: 1em;text-align: center;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(136, 136, 136);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;">参与：李亚洲、路</strong></span></p></section></section></section></section></section></section></section></section></section></section></section></section><p><br></p><blockquote><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;color: rgb(136, 136, 136);">本文介绍了腾讯微信翻译团队开源的人工智能围棋项目 PhoenixGo，该项目是对 DeepMind <a href="http://mp.weixin.qq.com/s?__biz=MzA3MzI4MjgzMw==&amp;mid=2650732104&amp;idx=1&amp;sn=8d0f5b9a1d5ede22cc1017c1c596afe2&amp;chksm=871b3236b06cbb2051eaa1a4a8cf5b8c307c1655d9680af7e81f452ebe590a0b557bca84ab4c&amp;scene=21#wechat_redirect" target="_blank">AlphaGo Zero</a> 论文《Mastering the game of Go without human knowledge》的实现。</span></p></blockquote><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">PhoenixGo 是腾讯微信翻译团队开发的人工智能围棋程序。据介绍，该项目由几名工程师在开发机器翻译引擎之余，基于 AlphaGo Zero 论文实现，做了若干提高训练效率的创新，并利用微信服务器的闲时计算资源进行自我对弈，缓解了 Zero 版本对海量资源的苛刻需求。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">4 月底，在 2018 世界人工智能围棋大赛上，PhoenixGo 取得冠军。参赛队伍包括绝艺，LeelaZero、TSGo、石子旋风、Golois，HEROZ Kishi、Baduki 等来自中、日、韩、欧美等国家和地区的人工智能围棋高手。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">5 月 11 日，PhoenixGo 在 Github 上正式开源，以下是技术细节：</span></p><p><br></p><p style="text-align: left;line-height: 1.75em;"><span style="font-size: 15px;color: rgb(123, 12, 0);">项目地址：https://github.com/Tencent/PhoenixGo</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">如果你在研究中使用 PhoenixGo，请按以下方式引用库：</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;"></span></p><pre style="box-sizing: border-box;margin-top: 0px;margin-bottom: 0px;padding: 0px;font-size: 16px;color: rgb(62, 62, 62);line-height: inherit;background-color: rgb(255, 255, 255);"><code class="python language-python hljs" style="box-sizing: border-box;margin-right: 2px;margin-left: 2px;padding: 0.5em;font-size: 14px;color: rgb(169, 183, 198);line-height: 18px;border-radius: 0px;background: rgb(40, 43, 46);font-family: Consolas, Inconsolata, Courier, monospace;display: block;overflow-x: auto;letter-spacing: 0px;word-wrap: normal !important;word-break: normal !important;overflow-y: auto !important;"><span class="hljs-meta" style="box-sizing: border-box;font-size: inherit;color: rgb(91, 218, 237);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">@misc{PhoenixGo2018,</span><br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"> author = {Qinsong Zeng <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">and</span> Jianchang Zhang <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">and</span> Zhanpeng Zeng <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">and</span> Yongsheng Li <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">and</span> Ming Chen <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">and</span> Sifan Liu}<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"> title = {PhoenixGo},<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"> year = {<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">2018</span>},<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"> journal = {GitHub repository},<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"> howpublished = {\url{https://github.com/Tencent/PhoenixGo}}<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">}</code></pre><p><br></p><p style="text-align: center;line-height: 1.75em;"><span style="font-size: 16px;"><strong>构建和运行</strong></span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><strong><span style="font-size: 15px;">在 Linux 上</span></strong></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">1 要求</span></p><p><br></p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">支持 C++11 的 GCC；</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">Bazel（0.11.1）；</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">（可选）CUDA 和 cuDNN（支持 GPU）；</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">（可选）TensorRT（加速 GPU 上的计算，建议使用 3.0.4 版本）。</span></p></li></ul><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">2 构建</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">复制库，并进行构建配置：</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;"></span></p><pre style="box-sizing: border-box;margin-top: 0px;margin-bottom: 0px;padding: 0px;font-size: 16px;color: rgb(62, 62, 62);line-height: inherit;background-color: rgb(255, 255, 255);"><code class="python language-python hljs" style="box-sizing: border-box;margin-right: 2px;margin-left: 2px;padding: 0.5em;font-size: 14px;color: rgb(169, 183, 198);line-height: 18px;border-radius: 0px;background: rgb(40, 43, 46);font-family: Consolas, Inconsolata, Courier, monospace;display: block;overflow-x: auto;letter-spacing: 0px;word-wrap: normal !important;word-break: normal !important;overflow-y: auto !important;">git clone https://github.com/Tencent/PhoenixGo.git<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">cd PhoenixGo<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">./configure</code></pre><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">./configure 将询问 CUDA 和 TensorRT 的安装位置，如果必要指定二者的位置。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">然后使用 bazel 进行构建：</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;"></span></p><pre style="box-sizing: border-box;margin-top: 0px;margin-bottom: 0px;padding: 0px;font-size: 16px;color: rgb(62, 62, 62);line-height: inherit;background-color: rgb(255, 255, 255);"><code class="python language-python hljs" style="box-sizing: border-box;margin-right: 2px;margin-left: 2px;padding: 0.5em;font-size: 14px;color: rgb(169, 183, 198);line-height: 18px;border-radius: 0px;background: rgb(40, 43, 46);font-family: Consolas, Inconsolata, Courier, monospace;display: block;overflow-x: auto;letter-spacing: 0px;word-wrap: normal !important;word-break: normal !important;overflow-y: auto !important;">bazel build //mcts:mcts_main</code></pre><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">TensorFlow 等依赖项将会自动下载。构建过程可能需要很长时间。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">3 运行</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">下载和提取训练好的网络：</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;"></span></p><pre style="box-sizing: border-box;margin-top: 0px;margin-bottom: 0px;padding: 0px;font-size: 16px;color: rgb(62, 62, 62);line-height: inherit;background-color: rgb(255, 255, 255);"><code class="python language-python hljs" style="box-sizing: border-box;margin-right: 2px;margin-left: 2px;padding: 0.5em;font-size: 14px;color: rgb(169, 183, 198);line-height: 18px;border-radius: 0px;background: rgb(40, 43, 46);font-family: Consolas, Inconsolata, Courier, monospace;display: block;overflow-x: auto;letter-spacing: 0px;word-wrap: normal !important;word-break: normal !important;overflow-y: auto !important;">wget https://github.com/Tencent/PhoenixGo/releases/download/trained-network<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">-20</span>b-v1/trained-network<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">-20</span>b-v1.tar.gz<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">tar xvzf trained-network<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">-20</span>b-v1.tar.gz</code></pre><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">以 gtp 模式运行，使用配置文件（取决于 GPU 的数量和是否使用 TensorRT）：</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;"></span></p><pre style="box-sizing: border-box;margin-top: 0px;margin-bottom: 0px;padding: 0px;font-size: 16px;color: rgb(62, 62, 62);line-height: inherit;background-color: rgb(255, 255, 255);"><code class="python language-python hljs" style="box-sizing: border-box;margin-right: 2px;margin-left: 2px;padding: 0.5em;font-size: 14px;color: rgb(169, 183, 198);line-height: 18px;border-radius: 0px;background: rgb(40, 43, 46);font-family: Consolas, Inconsolata, Courier, monospace;display: block;overflow-x: auto;letter-spacing: 0px;word-wrap: normal !important;word-break: normal !important;overflow-y: auto !important;">bazel-bin/mcts/mcts_main --config_path=etc/{config} --gtp --logtostderr --v=<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">1</span></code></pre><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">该引擎支持 GTP 协议，这意味着它可以和具备 GTP 能力的 GUI 一起使用，如 Sabaki。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">--logtostderr 使 mcts_main 向 stderr 写入日志消息，如果你想将消息写入文件，将 --logtostderr 改成 --log_dir={log_dir} 即可。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">你可以按照此说明更改配置文件：https://github.com/Tencent/PhoenixGo#configure-guide</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">4 分布模式</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">如果不同的机器上有 GPU，PhoenixGo 支持分布式 worker。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">构建分布式 worker：</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;"></span></p><pre style="box-sizing: border-box;margin-top: 0px;margin-bottom: 0px;padding: 0px;font-size: 16px;color: rgb(62, 62, 62);line-height: inherit;background-color: rgb(255, 255, 255);"><code class="python language-python hljs" style="box-sizing: border-box;margin-right: 2px;margin-left: 2px;padding: 0.5em;font-size: 14px;color: rgb(169, 183, 198);line-height: 18px;border-radius: 0px;background: rgb(40, 43, 46);font-family: Consolas, Inconsolata, Courier, monospace;display: block;overflow-x: auto;letter-spacing: 0px;word-wrap: normal !important;word-break: normal !important;overflow-y: auto !important;">bazel build //dist:dist_zero_model_server</code></pre><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">在分布式 worker 上运行 dist_zero_model_server，每个 worker 对应一个 GPU：</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;"></span></p><pre style="box-sizing: border-box;margin-top: 0px;margin-bottom: 0px;padding: 0px;font-size: 16px;color: rgb(62, 62, 62);line-height: inherit;background-color: rgb(255, 255, 255);"><code class="python language-python hljs" style="box-sizing: border-box;margin-right: 2px;margin-left: 2px;padding: 0.5em;font-size: 14px;color: rgb(169, 183, 198);line-height: 18px;border-radius: 0px;background: rgb(40, 43, 46);font-family: Consolas, Inconsolata, Courier, monospace;display: block;overflow-x: auto;letter-spacing: 0px;word-wrap: normal !important;word-break: normal !important;overflow-y: auto !important;">CUDA_VISIBLE_DEVICES={gpu} bazel-bin/dist/dist_zero_model_server --server_address=<span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">"0.0.0.0:{port}"</span> --logtostderr</code></pre><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">在 config 文件中填充 worker 的 ip:port（etc/mcts_dist.conf 是 32 个 worker 的配置示例），并运行分布式 master：</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;"></span></p><pre style="box-sizing: border-box;margin-top: 0px;margin-bottom: 0px;padding: 0px;font-size: 16px;color: rgb(62, 62, 62);line-height: inherit;background-color: rgb(255, 255, 255);"><code class="python language-python hljs" style="box-sizing: border-box;margin-right: 2px;margin-left: 2px;padding: 0.5em;font-size: 14px;color: rgb(169, 183, 198);line-height: 18px;border-radius: 0px;background: rgb(40, 43, 46);font-family: Consolas, Inconsolata, Courier, monospace;display: block;overflow-x: auto;letter-spacing: 0px;word-wrap: normal !important;word-break: normal !important;overflow-y: auto !important;">bazel-bin/mcts/mcts_main --config_path=etc/{config} --gtp --logtostderr --v=<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">1</span></code></pre><p><br></p><p style="text-align: justify;line-height: 1.75em;"><strong><span style="font-size: 15px;"></span></strong></p><p><strong><span style="font-size: 15px;">在 macOS 上</span></strong></p><p><strong><span style="font-size: 15px;"><br></span></strong></p><p><span style="font-size: 15px;">注意：TensorFlow 在 1.2.0 版本之后停止支持 macOS 上的 GPU，因此在 macOS 上的操作只能在 CPU 上运行。</span></p><p><span style="font-size: 15px;"><br></span></p><p><span style="font-size: 15px;">1 要求 &amp; 构建</span></p><p><span style="font-size: 15px;"><br></span></p><p><span style="font-size: 15px;">同 Linux。</span></p><p><span style="font-size: 15px;"><br></span></p><p><span style="font-size: 15px;">2 运行</span></p><p><span style="font-size: 15px;"><br></span></p><p><span style="font-size: 15px;">首先添加 <span style="color: rgb(36, 41, 46);">libtensorflow_framework.so 到 <span style="font-size: 13.6px;font-variant-ligatures: normal;">LD_LIBRARY_PATH 中：</span></span></span></p><p><br></p><pre style="margin-top: 0px;margin-bottom: 0px;padding: 0px;background-color: rgb(255, 255, 255);box-sizing: border-box;font-size: 16px;color: rgb(62, 62, 62);line-height: inherit;font-variant-ligatures: normal;orphans: 2;widows: 2;"><code class="python language-python hljs" style="margin-right: 2px;margin-left: 2px;padding: 0.5em;letter-spacing: 0px;box-sizing: border-box;font-size: 14px;color: rgb(169, 183, 198);line-height: 18px;border-top-left-radius: 0px;border-top-right-radius: 0px;border-bottom-right-radius: 0px;border-bottom-left-radius: 0px;background-color: rgb(40, 43, 46);font-family: Consolas, Inconsolata, Courier, monospace;display: block;overflow-x: auto;word-wrap: normal !important;word-break: normal !important;overflow-y: auto !important;">$ export LD_LIBRARY_PATH=<span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">"$LD_LIBRARY_PATH:{project_root}/bazel-bin/external/org_tensorflow/tensorflow"</span><br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"></code><p><br></p></pre><p style="text-align: justify;line-height: 1.75em;"><strong><span style="font-size: 15px;">在 Windows 上</span></strong></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">正在进行。</span></p><p><br></p><p style="text-align: center;line-height: 1.75em;"><span style="font-size: 16px;"><strong>配置指南</strong></span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">以下是 config 文件中的一些重要选项：</span></p><p style="text-align: justify;line-height: 1.75em;"><br></p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">num_eval_threads：应与 GPU 的数量一致；</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">num_search_threads：应比 num_eval_threads * eval_batch_size 大一些；</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">timeout_ms_per_step：每步使用的时间；</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">max_simulations_per_step：每步要做多少模拟；</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">gpu_list：使用哪块 GPU，用逗号隔开；</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">model_config -&gt; train_dir：训练好的网络的存储目录；</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">model_config -&gt; checkpoint_path：使用哪个检查点，如果没设定，则从 train_dir/checkpoint 中获取；</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">model_config -&gt; enable_tensorrt：是否使用 TensorRT；</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">model_config -&gt; tensorrt_model_path：如果 enable_tensorrt，使用哪个 TensorRT 模型；</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">max_search_tree_size：树节点的最大数量，根据存储容量进行更改；</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">max_children_per_node：每个节点的子节点的最大数量，根据存储容量进行更改；</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">enable_background_search：在对手下棋的时候思考；</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">early_stop：如果结果不再更改，则 genmove 可能在 timeout_ms_per_step 之前返回；</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">unstable_overtime：如果结果仍然不稳定，则更多地考虑 timeout_ms_per_step * time_factor；</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">behind_overtime：如果赢率低于 act_threshold，则更多地考虑 timeout_ms_per_step * time_factor。</span></p></li></ul><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">分布模式的选项：</span></p><p><br></p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">enable_dist：启动分布模式；</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">dist_svr_addrs：分布式 worker 的 ip:port，多条线，每条线中有一个 ip:port；</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">dist_config -&gt; timeout_ms：RPC 超时。</span></p></li></ul><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">async 分布模式的选项：</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">Async 模式是在有大量分布式 worker 的时候使用的（多余 200），而在 sync 模式中需要过多的 eval 线程和搜索线程。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">etc/mcts_async_dist.conf 是 256 个 worker 模式的 config 示例。</span></p><p><br></p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">enable_async：开启 async 模式</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">enable_dist：开启分布模式</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">dist_svr_addrs：每个命令行 ip:port 的多行、用逗号分开的列表</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">eval_task_queue_size:根据分布 worker 的数量调整</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">num_search_threads：根据分布式 worker 的数量调整</span></p></li></ul><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">参看 mcts/mcts_config.proto 更详细的了解 config 选项。</span></p><p><br></p><p style="text-align: center;line-height: 1.75em;"><strong><span style="font-size: 16px;">命令行选项</span></strong></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">mcts_main 接受以下命令行选项：</span></p><p><br></p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">--config_path：配置文件路径；</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">--gtp：作为 GTP 引擎来运行，如果禁用，则只能进行 genmove；</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">--init_moves：围棋棋盘上最初的落子；</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">--gpu_list：覆写配置文件中的 gpu_list；</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">--listen_port：与 --gtp 一起使用，在 TCP 协议端口上运行 gtp 引擎；</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">--allow_ip：与 --listen_port 一起使用，是允许连接的客户端 ip 列表；</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">--fork_per_request：与 --listen_port 一起使用，表示是否 fork 每个请求。</span></p></li></ul><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">Glog 选项还支持：</span></p><p><br></p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">--logtostderr：向 stderr 写入日志消息；</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">--log_dir：向该文件夹中的文件写入日志消息；</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">--minloglevel：记录级别：0 - INFO、1 - WARNING、2 - ERROR；</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">--v：详细记录，--v=1 即记录调试日志，--v=0 即关闭记录。</span></p></li></ul><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">mcts_main --help 支持更多命令行选项。</span><img class="" data-ratio="0.3287671232876712" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gW8Zfpicd40EribGuaFicDBCRH6IOu1Rnc4T3W3J1wE0j6kQ6GorRSgicib0fmNrj3yzlokup2jia9Z0YVeA/640?wx_fmt=png" data-type="png" data-w="73" style="color: rgb(51, 51, 51);width: 38px;height: 15px;" width="48px"></p><p style="max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></p><p style="max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></p><p style="max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);"><strong style="max-width: 100%;text-align: justify;line-height: 25.6px;font-family: 微软雅黑;font-size: 14px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(127, 127, 127);box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;color: rgb(62, 62, 62);line-height: 25.6px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(127, 127, 127);box-sizing: border-box !important;word-wrap: break-word !important;">本文为机器之心编译，<strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;">转载请联系本公众号获得授权</span></strong></span></strong>。</span></strong><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></p><p style="margin-bottom: 5px;max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);"><span style="max-width: 100%;color: rgb(127, 127, 127);line-height: 25.6px;font-family: 微软雅黑;text-align: justify;box-sizing: border-box !important;word-wrap: break-word !important;">✄------------------------------------------------</span></p><p style="margin-bottom: 5px;max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);caret-color: rgb(51, 51, 51);font-size: 18px;font-family: 微软雅黑;text-align: center;line-height: 1.75em;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(217, 33, 66);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">加入机器之心（全职记者/实习生）：hr@jiqizhixin.com</span></strong></p><p style="max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);caret-color: rgb(51, 51, 51);font-size: 18px;font-family: 微软雅黑;text-align: center;line-height: 1.75em;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(217, 33, 66);line-height: 1.6;font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">投稿或寻求报道：<strong style="max-width: 100%;color: rgb(62, 62, 62);font-size: 18px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(217, 33, 66);line-height: 1.6;font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">content</span></strong>@jiqizhixin.com</span></strong></p><p style="max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);caret-color: rgb(51, 51, 51);font-size: 18px;font-family: 微软雅黑;text-align: center;line-height: 1.75em;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 12px;color: rgb(217, 33, 66);line-height: 1.6;box-sizing: border-box !important;word-wrap: break-word !important;">广告&amp;商务合作：bd@jiqizhixin.com</span></strong></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;"></span></p>
                </div>
                <script nonce="348273234" type="text/javascript">
                    var first_sceen__time = (+new Date());

                    if ("" == 1 && document.getElementById('js_content')) {
                        document.getElementById('js_content').addEventListener("selectstart",function(e){ e.preventDefault(); });
                    }

                    
                    (function(){
                        if (navigator.userAgent.indexOf("WindowsWechat") != -1){
                            var link = document.createElement('link');
                            var head = document.getElementsByTagName('head')[0];
                            link.rel = 'stylesheet';
                            link.type = 'text/css';
                            link.href = "//res.wx.qq.com/mmbizwap/zh_CN/htmledition/style/page/appmsg_new/winwx3db0db.css";
                            head.appendChild(link);
                        }
                    })();
                </script>
                
                
                                
                <div class="ct_mpda_wrp" id="js_sponsor_ad_area" style="display:none;"></div>

                
                                <div class="reward_area tc appmsg_card_context" id="js_preview_reward" style="display:none;">
                    <div class="reward_inner">
                        <p id="js_preview_reward_wording" class="tips_global reward_tips" style="display:none;"></p>
                        <p>
                            <a class="reward_access" id="js_preview_reward_link" href="##">赞赏</a>
                        </p>
                    </div>
                </div>
                <div class="reward_qrcode_area reward_area tc" id="js_preview_reward_qrcode" style="display:none;">
                    <p class="tips_global">长按二维码向我转账</p>
                    <p id="js_preview_reward_ios_wording" class="reward_tips" style="display:none;"></p>
                    <span class="reward_qrcode_img_wrp"><img class="reward_qrcode_img" src="//res.wx.qq.com/mmbizwap/zh_CN/htmledition/images/pic/appmsg/pic_reward_qrcode.2x3534dd.png"></span>
                    <p class="tips_global">受苹果公司新规定影响，微信 iOS 版的赞赏功能被关闭，可通过二维码转账支持公众号。</p>
                </div>
                            </div>
                                        
                                

                        
            <ul id="js_hotspot_area" class="article_extend_area"></ul>


            
                        <div class="rich_media_tool" id="js_toobar3">

                                            <span style="display:none;" class="media_tool_meta meta_primary tips_global meta_praise" id="like3">
                    <i class="icon_praise_gray"></i><span class="praise_num" id="likeNum3"></span>
                </span>
                <div id="js_read_area3" class="media_tool_meta tips_global meta_primary" style="display:none;">阅读 <span id="readNum3"></span></div>

                <a id="js_report_article3" style="display:none;" class="media_tool_meta tips_global meta_extra" href="##">投诉</a>

            </div>


                        <div class="rich_media_tool" id="js_sg_bar">

                                
            </div>
                    </div>

        <div class="rich_media_area_primary sougou" id="sg_tj" style="display:none"></div>


        
        <div class="rich_media_area_extra">
            
            <div id="js_share_appmsg">
            </div>

            
                        <div class="mpda_bottom_container" id="js_bottom_ad_area"></div>
                        
            <div id="js_iframetest" style="display:none;"></div>
                        
                        
            <div class="rich_media_extra rich_media_extra_discuss" id="js_cmt_container" style="display:none">
              
              <div class="weui-loadmore weui-loadmore_line mod_title_context_primary" id="js_cmt_title" style="display:none">
                <span class="weui-loadmore__tips">留言</span>
              </div>

              
              <div class="discuss_mod" id="js_friend_cmt_area" style="display:none">
                
                
                
              </div>

                            <div class="discuss_mod" id="js_cmt_area" style="display:none">
              </div>
                          </div>
        </div>

        
        <div id="js_pc_qr_code" class="qr_code_pc_outer" style="display:none;">
            <div class="qr_code_pc_inner">
                <div class="qr_code_pc">
                    <img id="js_pc_qr_code_img" class="qr_code_pc_img">
                    <p>微信扫一扫<br>关注该公众号</p>
                </div>
            </div>
        </div>
    </div>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
