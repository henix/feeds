<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Ehlers滤波器</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/51736211">原文</a></p>
<p>交易者使用的最常见的过滤器是移动平均线 - 简单移动平均线（SMA）或指数移动平均线（EMA）。这些是线性滤波器。线性滤波器最适合平滑因高频噪声而损坏的静止，缓慢变化的信号。不幸的是，价格数据在很大程度上并不是固定的。硬币翻转实验是统计静止过程的一个例子。但是，如果加权硬币随机引入实验，现在实验的统计数据取决于使用哪个硬币，因此是非平稳的。我们处理的信号通常可以统计描述。例如，人类语音具有类似噪声的统计数据。这个过程是不稳定的，因为它随时变化。虽然言语具有类似噪音的特征，但并不是说它不带有信息（除非来自律师或政治家）。价格数据类似于统计特征中的语音。它既像噪音又不稳定。在使用技术分析时我们在交易中遇到的主要问题之一是我们必须尝试恢复通常不稳定并且也被噪声破坏的信号。当处理具有其平均值的急剧转变或处理脉冲噪声的非平稳信号时，线性滤波技术会产生不良结果。在本文中，我将描述如何制作一些更好的非线性滤波器，以更好地处理这些信号。</p><p>有两种基本类型的滤波器，有限脉冲响应（FIR）滤波器和无限脉冲响应（IIR）滤波器。 EMA是IIR滤波器的示例。冲动的数学相当于尖锐的尖峰。在采样数据中，脉冲的值仅为一个样本的值为1，而所有其他样本的数据为零。相反，当脉冲施加到IIR滤波器时，第一输出的一部分被反馈到输入并被添加到下一个数据输入样本。因为这种计算是迭代的，所以脉冲的影响在理论上永远存在于输出中 - 因此名称为IIR。当脉冲施加到FIR滤波器的输入端，例如SMA时，脉冲的影响将仅在滤波器的输出长度上出现在滤波器输出中，否则输出将为零 - 因此称为FIR。</p><p>Perry Kaufman，Tushar Chande和其他人设计了非线性IIR滤波器以更好地平滑市场数据。基本方法是为EMA中的alpha参数制定波动率调整值。这些当然是可行的方法，但它们的有效性受到在强力攻击主要价格变动的同时提供足够平滑的相反要求的限制。此处发明的滤波器是非线性FIR滤波器。事实证明，它们在横向市场中提供了非凡的平滑，并且以最小的滞后积极地跟随主要价格走势。</p><p>与保持样本的时间顺序的线性滤波器相比，OS滤波器基于滤波器窗口内的样本的排序来进行操作。 数据按其汇总统计排序，例如它们的均值或方差，而不是它们的时间位置。。在OS滤波器中，中值滤波器是最为人所知的。它用于视频电路中以锐化图像边缘并消除脉冲噪声。在中值滤波器中，输出是观察窗口内所有数据值的中值。与平均滤波器相反，中值滤波器简单地丢弃除中值之外的所有数据。通过这种方式，可以消除冲动噪声峰值和极端价格数据，而不是包含在平均值中。中值可以落在数据窗口中的第一个样本，最后一个样本或两者之间的任何位置。因此，时间特征丢失。例如，如果输入到五抽头FIR滤波器的数据是顺序的[3 4 3 3 9]，则中值为4.该中值既不是平均值（4.4是平均值）也不是滤波器中心的值。在这种情况下，忽略9的大数据尖峰值。作为另一个例子，如果数据输入是[3 3 3 8 9]，则中值为8，而平均值为5.2。此示例显示中值过滤器可以快速跟踪数据的快速变化。</p><p>中值滤波器倾向于消除导致线性滤波器进行洗盘交易的短期变化。另一方面，响应于急剧和持续的价格变动的中值滤波器的滞后是很大的 - 它必然是滤波器窗口宽度的大约一半。图1显示了窗口宽度为10 bar的中值滤波器的响应。请注意，滤波器对10月/ 11月或1月/ 2月的小价格变动没有反应，这可能已经消除了几个潜在的洗盘交易。将由线性滤波器产生。</p><p>找到中位数是一个简单的排序问题。我们只需要按照幅度的顺序列出滤波器宽度内的数据样本，然后选择中心值。可以使用指数移动平均线对中值滤波器进行平滑处理，使其更易于呈现且更易于阅读。</p><img src="https://pic1.zhimg.com/v2-fb14dcceb664b84ebff75973f07ffa27_r.jpg" data-caption="图1 10bar中值滤波" data-size="normal" data-rawwidth="864" data-rawheight="539" data-watermark="watermark" data-original-src="v2-fb14dcceb664b84ebff75973f07ffa27" data-watermark-src="v2-7cb6770d6a3f08d3fb0bf5524ef252cf" data-private-watermark-src=""><p>与OS过滤器一样，Ehlers过滤器非常强大。此外，它们还利用数据的排序和时间特征。广义Ehlers滤波器可以定向到您选择的任何统计量，使得系数非常容易计算。最明显的统计数据是价格动量，因为这些数据使非线性Ehlers滤波器能够快速跟踪价格变化（因为它使KAMA IIR滤波器能够做同样的事情）。使用的统计范围几乎是无限的。例如，Ehlers滤波器在加速度（动量的速率变化），信噪比，体积，货币流量（delta价格乘以体积）等方面可以是非线性的。甚至其他指标，如随机指标或RSI也可用作统计数据。在解释计算程序后，这将变得更加明显。</p><p>Ehlers滤波器的公式类似于FIR滤波器。如果“y”是滤波器输出并且“xi”是滤波器窗口宽度“n”上的第i个输入，那么等式是：y = c1x1 + c2x2 + c3x3 + c4x4 + ...... + cnxn。c是包含你感兴趣的统计数据的系数。作为一个简单的例子，加权移动平均值使用与平均窗口内的数据样本位置成反比的统计量。注意，加权移动平均值使每个系数归一化为系数之和。此标准化使平均值保持与图表上的价格相同。例如，如果过滤器中的所有5个价格相同，则过滤器输出必须与这5个价格中的任何一个相同。作为一个更一般的例子，如果你对5 bar动量感兴趣，那么每个系数都是 <equation>P_t-P_{t-5}</equation> </p><p>以这种方式，系数根据它们在窗口内的大小排序。例如，c3可能具有最大的动量，c1可能是下一个最大的动量，并且它们在过滤器内的时间位置被保留。通过将所有系数归一化为它们的总和来保留滤波器的单位增益，就像我们对加权移动平均值所做的那样。一般形式如下：</p><p><equation>EhlersFilter=\frac{\sum_{i=1}^{N}c_ix_i}{\sum_{i=1}^{N}{c_i}}</equation> </p><p>Ehlers过滤器中使用的统计数据应该去除趋势以获得最大效果。 如果不消除统计数据的共同趋势，则每个系数将具有相对于它们之间可能存在的任何差异的大的共同项。 例如，如果5抽头过滤器的统计量为[-1 -2 0 2 1]，则统计量没有常数项，并且过滤器内的位置之间存在较大的百分比变化。 然而，如果统计量是[99 98 100 102 101]，则系数具有100的公共项，尽管系数之间的差异与第一示例中的相同。 在后一种情况下，系数之间只有很小的百分比差异，而Ehlers滤波器的性能几乎与简单的移动平均值无法区分。</p><p>图2说明了这样一个事实，即动量衍生的Ehlers滤波器可以快速响应快速的价格变动，同时在较大程度上抑制较小的价格变动。这种过滤器可用于快速响应趋势方向的变化，而不会产生在采用线性滤波器时如此普遍的洗盘。通过对每个系数求平方，可以使Ehlers滤波器非常具有攻击性。</p><img src="https://pic2.zhimg.com/v2-f4be2ed2e09def1245d0b72f690afc86_r.jpg" data-caption="图2 使用5 Bar动量的15 Bar Ehlers滤波器(红)与15 Bar SMA(蓝)" data-size="normal" data-rawwidth="864" data-rawheight="543" data-watermark="watermark" data-original-src="v2-f4be2ed2e09def1245d0b72f690afc86" data-watermark-src="v2-38622bca013789058eb7c2df62da1d86" data-private-watermark-src=""><p>Ehlers过滤器的更大灵活性开辟了技术分析研究的全新途径。例如，统计数据可以是市场活动的一些有形参数，例如资金流量或交易量。另一方面，可以使用诸如信噪比之类的更多神秘参数作为统计量。在这种情况下，信噪比最大的系数将具有最大权重，折扣信噪比较小的价格数据值。此外，Ehlers过滤器可以是自适应的。例如，在我们的示例中，5 Bar Momentum Ehlers滤波器的长度可以适应于测量的循环周期的长度。这种滤波器既是自适应的又是非线性的。</p><p>Ehlers滤波器的灵活性和适应性如图3所示，其中使用的统计量是当前价格与先前计算的滤波器值之间的差值。此版本具有IIR过滤器的某些方面。</p><img src="https://pic2.zhimg.com/v2-51fc095a77b8a4d74fa621f1ce167fe6_r.jpg" data-caption="图3 自适应15 Bar Ehlers滤波器(红)与15 Bar SMA(蓝)" data-size="normal" data-rawwidth="864" data-rawheight="543" data-watermark="watermark" data-original-src="v2-51fc095a77b8a4d74fa621f1ce167fe6" data-watermark-src="v2-cc6fa59b177c38ebd3b49a28936a7289" data-private-watermark-src=""><p>无论Ehlers过滤器的灵活性如何，退一步并反思导出此过滤器类型的动机是有用的。通过这样做，我们可以发现用于计算系数的最佳解决方案。我们知道市场数据通常是非平稳的。我们也知道，我们希望尽可能地跟随价格的急剧和持续变动。这导致视频工程师使用中值滤波器作为边缘检测器。但并非所有边缘都相同。我们可以看到图4中边缘的锐度，就像我们在一张纸上看到的那样，从我们的左肩上方照亮，并悬挂在桌子的边缘上。图4顶部的边缘非常锋利，好像纸张有折痕。继续向下图4，光漫射更加分散，给出了边缘变得更圆的错觉。事实上，图4的阴影是由高斯函数产生的，其标准偏差在图中从顶部到底部增加。</p><img src="https://pic2.zhimg.com/v2-33ac03d5b829b676cd7960dac9de3076_r.jpg" data-caption="图4 可视化边缘的锐度" data-size="normal" data-rawwidth="691" data-rawheight="629" data-watermark="watermark" data-original-src="v2-33ac03d5b829b676cd7960dac9de3076" data-watermark-src="v2-085b854ae49e8836a316617319b32dc4" data-private-watermark-src=""><p>如果我们将图4中的灰度阴影级别视为距离，我们可以根据边缘的锐度计算滤波器系数。白色是中间灰色的一个方向上的最大距离，黑色是另一个方向上的最大距离。因此，考虑到边缘清晰度，距离是离开边缘的度量。</p><p>过渡到价格图表，价格差异可以想象为距离。回顾毕达哥拉斯定理（三角形斜边的长度等于另外两边长度的平方和），我们可以将它应用于我们的需要，并说任何数据样本的广义长度是该价格与每个价格之间的价格差异的平方和的平方根返回过滤器窗口的长度。每个数据点的平方距离之和是Ehlers滤波器的系数。假设最后10个数据值为[1 1 1 1 1 1 2 3 4 5]。然后，Ehlers滤波器的系数将计算为：</p><p>C1 =1+2^2 +3^2 + 4^2 +4^2 =46 </p><p>C2 =1+2^2 +3^2 + 3^2 +3^2 =32 </p><p>C3 =1+2^2 +2^2 + 2^2 +2^2 =17 </p><p>C4 = 1 + 1 +1 + 1 + 1 = 5<br>C5 = 0</p><p>果滤波器观察窗口的价格相同，那么滤波器的系数都是相同的，我们 具有相当于SMA的价格。 另一方面，如果价格快速变化，则与增加的价格点的距离增加，并且对这些滤波器系数赋予更高的权重。 距离系数Ehlers滤波器的表现如图5所示。</p><img src="https://pic4.zhimg.com/v2-f9337b7bb30093a110f114e21ce29d68_r.jpg" data-caption="图5 距离系数Ehlers滤波器(红)与SMA(蓝)" data-size="normal" data-rawwidth="864" data-rawheight="541" data-watermark="watermark" data-original-src="v2-f9337b7bb30093a110f114e21ce29d68" data-watermark-src="v2-9c61203c846c83c3d96e69a87102161d" data-private-watermark-src=""><p>滤波器系数可以计算的更加非线性。例如，距离可以是立方的或者升高到四次幂（通过平方的平方距离）。倒数高斯响应是距离的更加非线性函数，我们可以使用它来计算滤波器系数。这些更加非线性的响应更加积极地跟随价格变动的边缘。然而，它们如此非线性这一事实消除了响应中的大部分灰色区域。</p><p>最非线性的计算产生的结果是中值滤波器无法辨别的。系数变为黑色和白色，因此中间灰色区域非常小。我目前的研究重点是更准确地确定价格转变的开始。当前计算的距离函数与</p><p>价格变动。在微积分方面，这是第一个导数。价格变化率的变化是即将到来的价格变动的理想标识符。在微积分方面，我们可以使用二阶导数的最大值来确定价格变化的开始。挑战在于如何将二阶导数转换为滤波器系数，而不会引入过多响应不可用的噪声。</p><p>在技​​术分析中使用Ehlers过滤器的机会是无限的，你将有机会利用它们获得自己的乐趣和利润。</p><p></p><p></p>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
</body>
</html>
