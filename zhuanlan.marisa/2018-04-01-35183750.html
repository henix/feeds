<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>发布Compute.scala，多维数组上的科学计算库</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/35183750">原文</a></p>
<p>同学们，愚人节快乐，</p><p>今天我很荣幸向大家介绍<b>Compute.scala</b>。Compute.scala是个科学计算库，可以利用GPU、CPU和其他设备并行计算多维数组。它是下一版本DeepLearning.scala v3.0的新后端，用来解决我们在DeepLearning.scala v2.0的ND4J后端中遇到的各种性能问题：</p><ul><li>Compute.scala可以把多个操作动态合并成一个核函数。执行复杂计算公式时能比以前大大加速。</li><li>Compute.scala可以把内存、显存和其他原生资源管理起来，消耗的资源要比ND4J依赖垃圾收集的做法少得多。</li><li>Compute的维度转换操作（比如<code class="inline">permute</code>, <code class="inline">broadcast</code>, <code class="inline">reshape</code>）都是视图，不额外占用显存或内存。</li><li>Compute的多维数组可以和JVM的集合互相转换，从而可以支持Scala原生的<code class="inline">map</code>、<code class="inline">reduce</code>等集合操作，而且依然可以运行在GPU上。</li></ul><p><br></p><h2>性能评测</h2><p>我们最近做了一些性能评测，对比Compute.scala和ND4J的性能：</p><ul><li><a href="http://jmh.morethan.io/?source=https://raw.githubusercontent.com/ThoughtWorksInc/Compute.scala/f4fcd1cd54b9deea8b8234114b2bcdcf8c739038/benchmarks/nvidia-gpu.json">Compute.scala vs ND4J on a NVIDIA Titan X GPU</a></li><li><a href="http://jmh.morethan.io/?source=https://thoughtworksinc.github.io/Compute.scala/benchmarks/amd-gpu.json">Compute.scala on a AMD RX480 GPU</a></li></ul><p>从性能评测结果看：</p><ul><li>Compute.scala支持各个厂商的GPU，ND4J只支持NVIDIA GPU。</li><li>在大数组上，Compute.scala比ND4J快。比如把65536×32的矩阵和32×32的矩阵相乘，那么Compute.scala要比ND4J快12倍多。</li><li>运行包含多个原子操作的复杂公式，Compute.scala比ND4J快。比如当对32×32×32的数组调用一个<code class="inline">tanh</code>时，Compute.scala只比ND4J快五倍多，但是如果执行的表达式包含了100个<code class="inline">tanh</code>，Compute.scala就比ND4J快三十倍多。</li><li>在很小的数组上执行单个简单操作时，ND4J比Compute.scala快。</li><li>ND4J的<code class="inline">permute</code>和<code class="inline">broadcast</code>极慢，大概比Compute.scala慢上百倍，导致我们的卷积评测根本跑不出能看的结果（注：和ND4J同一家作者的Deeplearning4J用了文档上没记载的内部特殊方式使用<code class="inline">permute</code>和<code class="inline">broadcast</code>，并不像上述评测里这么慢）。</li></ul><p>注：这个评测结果并不是愚人节笑话。</p><h2>后续工作</h2><p>我们刚刚完成Compute.scala的最小可用原型，版本号v0.3.1。Compute.scala的功能仍然有待继续完善，我们将在正式版本发布以前完成以下功能：</p><ul><li>支持单精度浮点数以外的数据类型(<a href="https://github.com/ThoughtWorksInc/Compute.scala/issues/104">#104</a>)</li><li>增加更多的OpenCL数学函数(<a href="https://github.com/ThoughtWorksInc/Compute.scala/issues/101">#101</a>)</li><li>进一步性能调优(<a href="https://github.com/ThoughtWorksInc/Compute.scala/labels/performance">#62, #103</a>)</li></ul><p>欢迎大家来贡献代码和文档。新贡献者可以从<a href="https://github.com/ThoughtWorksInc/Compute.scala/labels/good%20first%20issue">good first issues</a>开搞。</p><p><br></p><h2>相关链接</h2><ul><li><a href="https://github.com/ThoughtWorksInc/Compute.scala">Compute.scala on Github</a></li><li><a href="https://javadoc.io/page/com.thoughtworks.compute/tensors_2.12/latest/com/thoughtworks/compute/index.html">Compute API Documentation</a></li></ul>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
