<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>业界 | 解密谷歌Gmail新功能：结合BoW模型和RNN-LM，帮助用户快速写邮件</title>
</head>
<body>
<p><a href="https://mp.weixin.qq.com/s?timestamp=1527336182&amp;src=3&amp;ver=1&amp;signature=leOWfKV*bscD65K*PG6SPxB5fJmtMhNXlqi511dRFZqtVsAjKruBNDZ*P0Qs43RX*gLpx9hfyB1P8uwYA9jjkAx7iFSNXsZW*viWeKLgDXdQDjVwOb1d6yL63jkp5P1bYPf9CXJC7BLktn6BiB8Qxf7PWwffFmliyPvH-Gvtl9s=">原文</a></p>
<div id="js_top_ad_area" class="top_banner"></div><div class="rich_media_inner">
                        
        
        <div id="page-content" class="rich_media_area_primary">
            
                        
            <div id="img-content">
                
                <h2 class="rich_media_title" id="activity-name">
                    业界 | 解密谷歌Gmail新功能：结合BoW模型和RNN-LM，帮助用户快速写邮件                                                                                </h2>
                <div id="meta_content" class="rich_media_meta_list">
                                                            <span class="rich_media_meta rich_media_meta_nickname" id="profileBt">
                      <a href="javascript:void(0);">
                        机器之心                      </a>
                      <div id="js_profile_qrcode" class="profile_container" style="display:none;">
                          <div class="profile_inner">
                              <strong class="profile_nickname">机器之心</strong>
                              <img class="profile_avatar" id="js_profile_qrcode_img" src="" alt="">

                              <p class="profile_meta">
                              <label class="profile_meta_label">微信号</label>
                              <span class="profile_meta_value">almosthuman2014</span>
                              </p>

                              <p class="profile_meta">
                              <label class="profile_meta_label">功能介绍</label>
                              <span class="profile_meta_value">专业的人工智能媒体和产业服务平台</span>
                              </p>
                              
                          </div>
                          <span class="profile_arrow_wrp" id="js_profile_arrow_wrp">
                              <i class="profile_arrow arrow_out"></i>
                              <i class="profile_arrow arrow_in"></i>
                          </span>
                      </div>
                    </span>

                    <em id="publish_time" class="rich_media_meta rich_media_meta_text">2018-05-17</em>

                                    </div>
                
                
                
                
                                                
                                                                
                
                <div class="rich_media_content " id="js_content">
                    

                    

                    
                    
                    <section style="white-space: normal;max-width: 100%;caret-color: rgb(51, 51, 51);color: rgb(51, 51, 51);"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section data-id="85660" data-custom="rgb(117, 117, 118)" data-color="rgb(117, 117, 118)" style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section data-id="85660" data-custom="rgb(117, 117, 118)" data-color="rgb(117, 117, 118)" style="max-width: 100%;border-width: 0px;border-style: initial;border-color: currentcolor;font-family: 微软雅黑;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="margin-top: 2em;padding-top: 0.5em;padding-bottom: 0.5em;max-width: 100%;border-style: solid none;font-family: inherit;text-decoration: inherit;border-top-color: rgb(204, 204, 204);border-bottom-color: rgb(204, 204, 204);border-top-width: 1px;border-bottom-width: 1px;box-sizing: border-box !important;word-wrap: break-word !important;"><p style="margin-top: -1.2em;max-width: 100%;min-height: 1em;text-align: center;line-height: 1.75em;border-width: initial;border-style: initial;border-color: currentcolor;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="color: rgb(255, 255, 255);max-width: 100%;background-color: rgb(117, 117, 118);box-sizing: border-box !important;word-wrap: break-word !important;">选自Google AI</span></p><section data-style="white-space: normal; text-align: left;font-size: 14px;line-height: 1.5em; color: rgb(12, 12, 12);" style="padding: 16px 16px 10px;max-width: 100%;font-family: inherit;box-sizing: border-box !important;word-wrap: break-word !important;"><p style="max-width: 100%;min-height: 1em;text-align: center;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="color: rgb(136, 136, 136);max-width: 100%;font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;">作者：</strong><strong>Yonghui Wu</strong></span></p><p style="max-width: 100%;min-height: 1em;text-align: center;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="color: rgb(136, 136, 136);max-width: 100%;font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;">机器之心编译</strong></span></p></section></section></section></section></section></section></section></section></section></section></section></section><p style="white-space: normal;max-width: 100%;min-height: 1em;caret-color: rgb(51, 51, 51);color: rgb(51, 51, 51);"><span style="max-width: 100%;font-size: 15px;box-sizing: border-box !important;word-wrap: break-word !important;"></span><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></p><blockquote style="white-space: normal;max-width: 100%;caret-color: rgb(51, 51, 51);color: rgb(51, 51, 51);"></blockquote><blockquote><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;color: rgb(136, 136, 136);">谷歌在上周的 I/O 大会上，推出了 Gmail 新功能 Smart Compose，其结合了 BoW 模型和 RNN-LM，在用户打字时提出建议，帮助完成句子，提高电子邮件的写作速度。</span></p></blockquote><p style="text-align: justify;line-height: 1.75em;"><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">在上周的 I/O 大会上，谷歌推出了 Gmail 新功能——Smart Compose，该功能使用机器学习在用户打字时提出建议，帮助用户完成句子，从而提高电子邮件的写作速度。Smart Compose 基于为 Smart Reply 开发的技术，为电子邮件写作提供了一种新的方式——无论是回复收到的电子邮件还是从头写作新邮件。</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;"><br></span></p><p><img class="" data-copyright="0" data-ratio="0.7140625" src="https://mmbiz.qpic.cn/mmbiz_gif/KmXPKA19gW8LbPykCGiapLZmZXN1ia9pXsyUzWZBAmLk9ymy1jVSJbXNxUfAibRKY0fNib4V5k3H51phbrF5GSE0wA/640?wx_fmt=gif" data-type="gif" data-w="640" style=""></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">开发 Smart Compose 过程中面临的主要挑战包括：</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;"><br></span></p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">延迟：Smart Compose 基于每次击键提供预测，因此它必须在 100 毫秒内做出理想响应，用户才不会注意到任何延迟。如何平衡模型复杂度和推断速度是一个关键问题。</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">规模：Gmail 有超过 14 亿用户。要为所有用户提供有效的自动填充建议，模型必须具备足够的建模能力，才能够在不同的语境中提出恰当的建议。</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">公平性和隐私性：在开发 Smart Compose 时，谷歌需要解决训练过程中潜在偏见的源头，还必须遵守与 Smart Reply 相同的严格用户隐私标准，确保模型不会泄露用户的隐私信息。此外，研究人员无法访问电子邮件，这意味着他们必须开发、训练一个机器学习系统来处理他们无法读取的数据集。</span></p></li></ul><p style="text-align: justify;line-height: 1.75em;"><br></p><p style="text-align: center;"><strong>找到合适的模型</strong></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">典型的语言生成模型，如 n-gram、神经词袋模型（BoW）和 RNN 语言模型（RNN-LM），基于前面的单词序列学习预测下一个单词。但是，用户在当前电子邮件中正在打出的单词只是模型可用于预测下一个单词的「信号」。为了整合用户想表达内容的更多语境，谷歌的模型还基于电子邮件主题和之前的电子邮件主体内容（如果用户正在回复收到的电邮的话）。</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">包含这一额外语境的一种方法是将该问题看作序列到序列（seq2seq）机器翻译任务，其中源句子是主题和之前电子邮件主体的结合，目标序列是用户正在写的当前邮件。尽管该方法在预测质量方面表现良好，但它远远无法满足谷歌严格的延迟约束。</span></p><p style="text-align: justify;line-height: 1.75em;"><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">为了改善这种情况，谷歌研究者将 BoW 模型与 RNN-LM 结合起来，其速度快于 seq2seq 模型，且仅出现轻微的模型预测质量损失。在这种混合方法中，谷歌研究者通过把每个字段中的词嵌入取平均，对主题和之前的电子邮件进行编码。然后在每个解码步中，将这些平均词嵌入输入到目标序列 RNN-LM。模型架构如下图所示。</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;line-height: 1.75em;"><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;"></span></p><p><img class="" data-copyright="0" data-ratio="0.3703125" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gW8LbPykCGiapLZmZXN1ia9pXsoKBhzXHugeawerf9ydg6qdcTftkMuXfYm7ibibtDpRf2EMPoapLjTBcA/640?wx_fmt=png" data-type="png" data-w="640" style=""></p><p style="text-align: justify;line-height: 1.75em;"><span style="color: rgb(136, 136, 136);"><em><span style="font-size: 12px;">Smart Compose RNN-LM 模型架构。通过对每个字段中的词嵌入取平均，对主题和之前的电子邮件信息进行编码。然后在每个解码步将平均词嵌入输入到 RNN-LM。</span></em></span><br><span style="font-size: 15px;"></span></p><p style="text-align: justify;line-height: 1.75em;"><br></p><p style="text-align: center;"><strong>加速模型训练 &amp; 服务</strong></p><p style="text-align: center;"><strong><br></strong></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">当然，确定使用该建模方法后，谷歌仍然需要调整不同的模型超参数，并在数十亿样本上训练模型，这些样本需要消耗大量时间。为了加速，谷歌使用完整的 TPUv2 Pod 进行实验，能够在不到一天的时间中训练模型至收敛。</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">即使在训练较快的混合模型之后，在标准 CPU 上运行的 Smart Compose 最初版本仍然具备数百毫秒的平均服务延迟，这对于一个试图节约用户时间的功能来说是不可接受的。幸运的是，TPU 在推断时间可以使用，从而极大地加速用户体验。通过将大量计算卸载到 TPU 上，谷歌将平均延迟减少到几十毫秒，同时极大地提高了单个机器可服务的请求数量。</span></p><p style="text-align: justify;line-height: 1.75em;"><br></p><p style="text-align: center;"><strong>公平性和隐私</strong></p><p style="text-align: center;"><strong><br></strong></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">机器学习中的公平性非常重要，因为理解语言的模型可以反映出人类的认知偏见，从而导致惹人厌的词关联和句子。正如 Caliskan 等人在其近期论文《Semantics derived automatically from language corpora contain human-like biases》中所指出的，这些关联与自然语言数据有很深的纠缠，这是构建语言模型的挑战。谷歌正在积极探索继续减少训练步骤中的潜在偏见的方式。同时，由于 Smart Compose 在数十亿词组和句子上训练而成，类似于垃圾邮件机器学习模型的训练方式，因此谷歌已经进行大量测试，以确保只有多个用户使用的共同词组才会被模型记住，此举使用了论文《The Secret Sharer: Measuring Unintended Neural Network Memorization &amp; Extracting Secrets》的研究成果。</span></p><p style="text-align: justify;line-height: 1.75em;"><br></p><p style="text-align: center;"><strong>未来工作</strong></p><p style="text-align: center;"><strong><br></strong></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">谷歌一贯致力于通过先进架构（如 Transformer、RNMT+等）提高语言生成模型的建议质量，并使用最近、最先进的训练技术进行实验。一旦这些模型满足谷歌严格的延迟约束，谷歌将把它们部署到生产。谷歌还研究整合人类语言模型，旨在更准确地在其系统中模仿人类的写作风格。<img class="" data-ratio="0.3287671232876712" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gW8Zfpicd40EribGuaFicDBCRH6IOu1Rnc4T3W3J1wE0j6kQ6GorRSgicib0fmNrj3yzlokup2jia9Z0YVeA/640?wx_fmt=png" data-type="png" data-w="73" width="48px" style="font-size: 15px;text-align: justify;white-space: normal;caret-color: rgb(51, 51, 51);color: rgb(51, 51, 51);"></span></p><p><br></p><p><span style="color: rgb(136, 136, 136);"><em><span style="font-size: 12px;">原文链接：</span></em><em><span style="color: rgb(136, 136, 136);font-size: 12px;">https://ai.googleblog.com/2018/05/smart-compose-using-neural-networks-to.html</span></em></span></p><p><br></p><p><br></p><p style="white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;text-align: justify;line-height: 25.6px;font-family: 微软雅黑;font-size: 14px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(127, 127, 127);box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;color: rgb(62, 62, 62);line-height: 25.6px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(127, 127, 127);box-sizing: border-box !important;word-wrap: break-word !important;">本文为机器之心编译，<strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;">转载请联系本公众号获得授权</span></strong></span></strong>。</span></strong><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></p><p style="margin-bottom: 5px;white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(127, 127, 127);line-height: 25.6px;font-family: 微软雅黑;text-align: justify;box-sizing: border-box !important;word-wrap: break-word !important;">✄------------------------------------------------</span></p><p style="margin-bottom: 5px;white-space: normal;max-width: 100%;min-height: 1em;letter-spacing: 0.544px;font-size: 18px;font-family: 微软雅黑;text-align: center;line-height: 1.75em;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(217, 33, 66);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">加入机器之心（全职记者/实习生）：hr@jiqizhixin.com</span></strong></p><p style="white-space: normal;max-width: 100%;min-height: 1em;letter-spacing: 0.544px;font-size: 18px;font-family: 微软雅黑;text-align: center;line-height: 1.75em;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(217, 33, 66);line-height: 1.6;font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">投稿或寻求报道：<strong style="max-width: 100%;color: rgb(62, 62, 62);font-size: 18px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(217, 33, 66);line-height: 1.6;font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">content</span></strong>@jiqizhixin.com</span></strong></p><p style="white-space: normal;max-width: 100%;min-height: 1em;letter-spacing: 0.544px;font-size: 18px;font-family: 微软雅黑;text-align: center;line-height: 1.75em;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 12px;color: rgb(217, 33, 66);line-height: 1.6;box-sizing: border-box !important;word-wrap: break-word !important;">广告&amp;商务合作：bd@jiqizhixin.com</span></strong></p><p><br></p>
                </div>
                <script nonce="399828636" type="text/javascript">
                    var first_sceen__time = (+new Date());

                    if ("" == 1 && document.getElementById('js_content')) {
                        document.getElementById('js_content').addEventListener("selectstart",function(e){ e.preventDefault(); });
                    }

                    
                    (function(){
                        if (navigator.userAgent.indexOf("WindowsWechat") != -1){
                            var link = document.createElement('link');
                            var head = document.getElementsByTagName('head')[0];
                            link.rel = 'stylesheet';
                            link.type = 'text/css';
                            link.href = "//res.wx.qq.com/mmbizwap/zh_CN/htmledition/style/page/appmsg_new/winwx3db0db.css";
                            head.appendChild(link);
                        }
                    })();
                </script>
                
                
                                
                <div class="ct_mpda_wrp" id="js_sponsor_ad_area" style="display:none;"></div>

                
                                <div class="reward_area tc appmsg_card_context" id="js_preview_reward" style="display:none;">
                    <div class="reward_inner">
                        <p id="js_preview_reward_wording" class="tips_global reward_tips" style="display:none;"></p>
                        <p>
                            <a class="reward_access" id="js_preview_reward_link" href="##">赞赏</a>
                        </p>
                    </div>
                </div>
                <div class="reward_qrcode_area reward_area tc" id="js_preview_reward_qrcode" style="display:none;">
                    <p class="tips_global">长按二维码向我转账</p>
                    <p id="js_preview_reward_ios_wording" class="reward_tips" style="display:none;"></p>
                    <span class="reward_qrcode_img_wrp"><img class="reward_qrcode_img" src="//res.wx.qq.com/mmbizwap/zh_CN/htmledition/images/pic/appmsg/pic_reward_qrcode.2x3534dd.png"></span>
                    <p class="tips_global">受苹果公司新规定影响，微信 iOS 版的赞赏功能被关闭，可通过二维码转账支持公众号。</p>
                </div>
                            </div>
                                        
                                

                        
            <ul id="js_hotspot_area" class="article_extend_area"></ul>


            
                        <div class="rich_media_tool" id="js_toobar3">

                                            <span style="display:none;" class="media_tool_meta meta_primary tips_global meta_praise" id="like3">
                    <i class="icon_praise_gray"></i><span class="praise_num" id="likeNum3"></span>
                </span>
                <div id="js_read_area3" class="media_tool_meta tips_global meta_primary" style="display:none;">阅读 <span id="readNum3"></span></div>

                <a id="js_report_article3" style="display:none;" class="media_tool_meta tips_global meta_extra" href="##">投诉</a>

            </div>


                        <div class="rich_media_tool" id="js_sg_bar">

                                
            </div>
                    </div>

        <div class="rich_media_area_primary sougou" id="sg_tj" style="display:none"></div>


        
        <div class="rich_media_area_extra">
            
            <div id="js_share_appmsg">
            </div>

            
                        <div class="mpda_bottom_container" id="js_bottom_ad_area"></div>
                        
            <div id="js_iframetest" style="display:none;"></div>
                        
                        
            <div class="rich_media_extra rich_media_extra_discuss" id="js_cmt_container" style="display:none">
              
              <div class="discuss_mod" id="js_cmt_title" style="display:none">
                <div class="discuss_container">
                  <div class="weui-loadmore weui-loadmore_line mod_title_context_primary">
                    <span class="weui-loadmore__tips">留言</span>
                  </div>
                </div>
              </div>

              
              <div class="discuss_mod" id="js_friend_cmt_area" style="display:none">
                
                
                
              </div>

                            <div class="discuss_mod" id="js_cmt_area" style="display:none">
              </div>
                          </div>
        </div>

        
        <div id="js_pc_qr_code" class="qr_code_pc_outer" style="display:none;">
            <div class="qr_code_pc_inner">
                <div class="qr_code_pc">
                    <img id="js_pc_qr_code_img" class="qr_code_pc_img">
                    <p>微信扫一扫<br>关注该公众号</p>
                </div>
            </div>
        </div>
    </div>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
