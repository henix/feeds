<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:media="http://search.yahoo.com/mrss/">
<channel>
<title>TiDB çš„åèŠ±å›­</title>
<link>https://henix.github.io/feeds/zhuanlan.newsql/</link>
<description></description>
<language>zh-cn</language>
<lastBuildDate>Thu, 14 Feb 2019 09:14:30 +0800</lastBuildDate>
<item>
<title>2018 TiDB ç¤¾åŒºæˆé•¿è¶³è¿¹ä¸å°çº¢èŠ± | TiDB DevCon 2019</title>
<link>https://henix.github.io/feeds/zhuanlan.newsql/2019-02-13-56624608.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/56624608&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-92a3a0e2e2bfb0c412e1c516e0d6441a_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;2018 å¹´ TiDB äº§å“å˜å¾—æ›´åŠ æˆç†Ÿå’Œç¨³å®šï¼ŒåŒæ—¶ TiDB ç¤¾åŒºåŠ›é‡ä¹Ÿåœ¨å‘å±•å£®å¤§ã€‚åœ¨ TiDB DevCon 2019 ä¸Šï¼Œæˆ‘å¸è”åˆåˆ›å§‹äººå´”ç§‹å¸¦å¤§å®¶ä¸€èµ·å›é¡¾äº† 2018 å¹´ TiDB ç¤¾åŒºæˆé•¿è¶³è¿¹ï¼Œåœ¨ç¤¾åŒºè£èª‰æ—¶åˆ»ç¯èŠ‚ï¼Œæˆ‘ä»¬ä¸ºæ–°æ™‹ Committer æˆäºˆäº†è¯ä¹¦ï¼Œå¹¶ä¸º 2018 å¹´åº¦æœ€ä½³è´¡çŒ®ä¸ªäºº/å›¢é˜Ÿé¢å‘äº†è£èª‰å¥–æ¯ã€‚&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-955cdd6a3188a0733755599481ac02f8_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;720&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-955cdd6a3188a0733755599481ac02f8_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-955cdd6a3188a0733755599481ac02f8_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;720&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-955cdd6a3188a0733755599481ac02f8_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-955cdd6a3188a0733755599481ac02f8_b.jpg&quot;&gt;&lt;figcaption&gt;å›¾ 1 æˆ‘å¸è”åˆåˆ›å§‹äººå´”ç§‹&lt;/figcaption&gt;&lt;/figure&gt;&lt;blockquote&gt;åœ¨æˆ‘ä»¬çœ¼é‡Œè¿è¥å¼€æºç¤¾åŒºæœ€é‡è¦çš„æ˜¯ä¸¤ç‚¹ï¼Œä¸€ä¸ªæ˜¯äººæ‰ï¼Œä¸€ä¸ªæ˜¯ç”¨æˆ·ã€‚äººæ‰æ–¹é¢ä¸»è¦é¢å‘å¼€å‘è€…ï¼ŒåŒ…æ‹¬ TiDB Contributorã€Committer ä»¥åŠ TiDB ç”Ÿæ€å‘¨è¾¹çš„å¼€å‘è€…ç­‰ç­‰ã€‚å¦å¤–æ›´é‡è¦çš„ä¸€æ–¹é¢æ˜¯ç”¨æˆ·ã€‚ç”¨æˆ·å¯¹ TiDB çš„è®¤è¯†å’Œç»éªŒã€ç»™äºˆçš„åé¦ˆæ˜¯æ›´ç›´è§‚ã€æ›´è´´è¿‘ä¸šåŠ¡çš„ï¼Œå¹¶ä¸”ç”¨æˆ·å®é™…åº”ç”¨çš„åœºæ™¯ä¸æˆ‘ä»¬è‡ªèº«æµ‹è¯•çš„åœºæ™¯ç›¸æ¯”ï¼Œä¼šæ›´å¤æ‚ã€æ›´ä¸°å¯Œï¼Œä»–ä»¬çš„ä½¿ç”¨ç»éªŒä¼šè®©å¤§å®¶æ›´æœ‰å…±é¸£ï¼Œå¦å¤–å½“ç”¨æˆ·ä½¿ç”¨ TiDB è¿‡ç¨‹ä¸­é‡åˆ°ä¸€äº›é—®é¢˜ï¼Œè¿™æ—¶ç¤¾åŒºæœ‰è‰¯å¥½çš„åé¦ˆï¼Œå¸®åŠ©ç”¨æˆ·é¡ºåˆ©è§£å†³é—®é¢˜ï¼Œä¼šè®©ç”¨æˆ·å¯¹ TiDB æ›´æœ‰ä¿¡å¿ƒï¼Œå°±ä¼šè€ƒè™‘æ‰©å¤§ä½¿ç”¨çš„è§„æ¨¡å’Œæ·±åº¦ï¼ŒåŒæ—¶ TiDB ç¤¾åŒºæœ¬èº«ä¹Ÿä¼šå¾—åˆ°æˆé•¿ã€‚æ‰€ä»¥ï¼Œè¿è¥ä¸€ä¸ªå¥½çš„å¼€æºç¤¾åŒºï¼Œæ›´é‡è¦çš„æ˜¯ä»¥ç”¨æˆ·ä¸ºä¸­å¿ƒã€‚2019 å¹´æˆ‘ä»¬ä¹Ÿä¼šç§‰æ‰¿è¿™ä¸ªæƒ³æ³•ï¼Œ ç»§ç»­æŠŠã€Œç”¨æˆ·è‡³ä¸Šã€çš„è§‚å¿µå’Œç†å¿µå‘æŒ¥åˆ°æè‡´ï¼Œä¸ç”¨æˆ·ä¸€èµ·æˆé•¿ã€‚                                                                                                                            â€”â€”å´”ç§‹&lt;/blockquote&gt;&lt;h2&gt;&lt;b&gt;Product&lt;/b&gt;&lt;/h2&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-518fb381e34fadb0105856d1014d47b1_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1058&quot; data-rawheight=&quot;417&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1058&quot; data-original=&quot;https://pic2.zhimg.com/v2-518fb381e34fadb0105856d1014d47b1_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-518fb381e34fadb0105856d1014d47b1_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1058&quot; data-rawheight=&quot;417&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1058&quot; data-original=&quot;https://pic2.zhimg.com/v2-518fb381e34fadb0105856d1014d47b1_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-518fb381e34fadb0105856d1014d47b1_b.jpg&quot;&gt;&lt;figcaption&gt;å›¾ 2 TiDB äº§å“æ¶æ„&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;äº§å“æ˜¯å¼€æºç¤¾åŒºçš„åŸºçŸ³ï¼Œå¥½çš„äº§å“æ˜¯å¸å¼•äººæ‰ã€å£®å¤§ç¤¾åŒºåŠ›é‡çš„åŠ¨åŠ›ï¼Œè€Œä¸°å¯Œäº§å“æ¶æ„ã€æ‰©å……ç”Ÿæ€å‘¨è¾¹ä¹Ÿéœ€è¦ç¤¾åŒºä¼™ä¼´ä»¬çš„å…±åŒåŠªåŠ›ã€‚2018 å¹´ï¼ŒTiDB åœ¨ç¤¾åŒºä¼™ä¼´ä»¬å…±åŒåŠªåŠ›ä¸‹å‘å¸ƒäº† 2.1 GA ç‰ˆæœ¬ã€‚æˆ‘ä»¬ä¹Ÿå¼€æºäº† &lt;u&gt;&lt;a href=&quot;http://link.zhihu.com/?target=http%3A//mp.weixin.qq.com/s%3F__biz%3DMzI3NDIxNTQyOQ%3D%3D%26mid%3D2247486525%26idx%3D1%26sn%3D342f1b43912b5de5ce22253e5380a108%26chksm%3Deb162b57dc61a241272a87892549c6886ebaa196c19e040e533c0f109745bd7e781397d1321e%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TiDB-Operator&lt;/a&gt;ã€&lt;a href=&quot;http://link.zhihu.com/?target=http%3A//mp.weixin.qq.com/s%3F__biz%3DMzI3NDIxNTQyOQ%3D%3D%26mid%3D2247487797%26idx%3D1%26sn%3Dd6de39f3d0172418c682eeb7779ea5e8%26chksm%3Deb16365fdc61bf497ee794f8b99780c2ec946bd7e1ed13bd47871bfae1355d7c76b190ee7c5a%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TiDB-DMã€TiDB-Lightning&lt;/a&gt;&lt;/u&gt;ç­‰ç”Ÿæ€å·¥å…·ï¼Œå¤§å®¶å¯ä»¥ä¸€èµ·æ¥ä¸º TiDB æ·»ç –åŠ ç“¦ã€‚&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-b3c1ffc4d62e8bc3daf548f955442831_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;695&quot; data-rawheight=&quot;520&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;695&quot; data-original=&quot;https://pic2.zhimg.com/v2-b3c1ffc4d62e8bc3daf548f955442831_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-b3c1ffc4d62e8bc3daf548f955442831_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;695&quot; data-rawheight=&quot;520&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;695&quot; data-original=&quot;https://pic2.zhimg.com/v2-b3c1ffc4d62e8bc3daf548f955442831_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-b3c1ffc4d62e8bc3daf548f955442831_b.jpg&quot;&gt;&lt;figcaption&gt;å›¾ 3 TiDB äº§å“ç”Ÿæ€&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;æœ¬ç€ã€Œä»å¼€æºé¡¹ç›®ä¸­è·ç›Šï¼ŒåŒæ—¶å›é¦ˆå¼€æºç¤¾åŒºã€çš„æƒ³æ³•ï¼Œæˆ‘ä»¬æŒç»­ä¸º RocksDBã€etcd ç­‰å¼€æºé¡¹ç›®è´¡çŒ®åŠ›é‡ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿå°† grpc-rsã€raft-rs ã€rust-rocksdbã€parser ç­‰é¡¹ç›®ç‹¬ç«‹å‡ºæ¥ï¼ˆåœ¨ github/pingcap ç»„ç»‡ä¸‹ï¼‰ï¼Œæ–¹ä¾¿å¤§å®¶äº†è§£å’Œè¿ç”¨ã€‚è€Œæ›´åŠ ä»¤äººæ¬£å–œçš„æ˜¯ï¼Œæœ‰ä¸€äº›å¼€æºé¡¹ç›®æ­£åœ¨ TiDB ç”Ÿæ€ä¸Šè¡ç”Ÿæˆé•¿èµ·æ¥ï¼Œè¿›ä¸€æ­¥ä¸°å¯Œäº† TiDB ç”Ÿæ€ï¼š&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-26d3b6a7446ed8acda88f54886fc0064_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;392&quot; data-rawheight=&quot;345&quot; class=&quot;content_image&quot; width=&quot;392&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-26d3b6a7446ed8acda88f54886fc0064_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;392&quot; data-rawheight=&quot;345&quot; class=&quot;content_image lazy&quot; width=&quot;392&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-26d3b6a7446ed8acda88f54886fc0064_b.jpg&quot;&gt;&lt;figcaption&gt;å›¾ 4 åŸºäº TiDB ç”Ÿæ€çš„å¼€æºé¡¹ç›®:Gravity/Titan/Soar&lt;/figcaption&gt;&lt;/figure&gt;&lt;h2&gt;&lt;b&gt;Events&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;2018 å¹´ï¼ŒTiDB ç¤¾åŒºå—åˆ°äº†æ›´å¤šå›½å†…å¤–åª’ä½“çš„å…³æ³¨ï¼Œè·å¾—äº† InfoWorld |  Bossie Awards æœ€ä½³æ•°æ®å­˜å‚¨ä¸æ•°æ®åˆ†æå¹³å°å¥–ï¼Œå¹¶å…¥é€‰äº†ä¸¤ä¸ªé‡è¦çš„&lt;b&gt;ã€ŒLandscapeã€&lt;/b&gt;ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;FirstMark: Big Data &amp;amp; AI Landscape 2018&lt;/li&gt;&lt;li&gt;CNCF: Cloud Native Interactive Landscape&lt;/li&gt;&lt;/ul&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-584a6b051cbd97df3eed6d4ff59c6a75_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;712&quot; data-rawheight=&quot;387&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;712&quot; data-original=&quot;https://pic2.zhimg.com/v2-584a6b051cbd97df3eed6d4ff59c6a75_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-584a6b051cbd97df3eed6d4ff59c6a75_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;712&quot; data-rawheight=&quot;387&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;712&quot; data-original=&quot;https://pic2.zhimg.com/v2-584a6b051cbd97df3eed6d4ff59c6a75_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-584a6b051cbd97df3eed6d4ff59c6a75_b.jpg&quot;&gt;&lt;figcaption&gt;å›¾ 5 TiDB è·å¾— InfoWorld | Bossie Awards æœ€ä½³æ•°æ®å­˜å‚¨ä¸æ•°æ®åˆ†æå¹³å°å¥–&lt;/figcaption&gt;&lt;/figure&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-81ae94d7f8c5cd553c97e424123f8576_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1058&quot; data-rawheight=&quot;419&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1058&quot; data-original=&quot;https://pic3.zhimg.com/v2-81ae94d7f8c5cd553c97e424123f8576_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-81ae94d7f8c5cd553c97e424123f8576_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1058&quot; data-rawheight=&quot;419&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1058&quot; data-original=&quot;https://pic3.zhimg.com/v2-81ae94d7f8c5cd553c97e424123f8576_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-81ae94d7f8c5cd553c97e424123f8576_b.jpg&quot;&gt;&lt;figcaption&gt;å›¾ 6 TiDB å…¥é€‰ Big Data &amp;amp;amp; AI Landscape 2018 å’Œ Cloud Native Interactive Landscape&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;å¤–ç•Œæ¿€åŠ±æ˜¯ä¸€æ–¹é¢ï¼Œå¦ä¸€æ–¹é¢æˆ‘ä»¬ä¹Ÿç§¯æä¸ºç¤¾åŒºå°ä¼™ä¼´ä»¬åˆ›é€ äº¤æµã€ç¢°æ’çš„å¹³å°ã€‚ä¾‹å¦‚ï¼Œåœ¨ 2018 å¹´ 12 æœˆåˆï¼Œæˆ‘ä»¬ä¸¾åŠäº† TiDB Hackathonã€‚ç»è¿‡ä¸¤å¤©ä¸€å¤œçš„ã€Œæé™è„‘åŠ›ç«æŠ€ã€ï¼Œè¯ç”Ÿäº†ä¸€ç³»åˆ—åŸºäº TiDB ç”Ÿæ€çš„æœ‰æ„æ€çš„é¡¹ç›®ï¼Œå¸Œæœ›è¿™äº›é¡¹ç›®å¯ä»¥åœ¨ç¤¾åŒºåŠ›é‡çš„å¸®åŠ©ä¸‹å»¶ç»­ä¸‹å»ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;u&gt;&lt;a href=&quot;http://link.zhihu.com/?target=http%3A//mp.weixin.qq.com/s%3F__biz%3DMzI3NDIxNTQyOQ%3D%3D%26mid%3D2247487656%26idx%3D1%26sn%3Dc4ee830b5174ac062de2404ddffe821f%26chksm%3Deb1637c2dc61bed4fc52b9c30d2751f7c1a4f68290f15d17461dbf89dc3b9ae0522b83ce0983%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TBSSQL (TiDB Batch and Streaming SQL) &lt;/a&gt;&lt;/u&gt;&lt;/li&gt;&lt;li&gt;&lt;u&gt;&lt;a href=&quot;http://link.zhihu.com/?target=http%3A//mp.weixin.qq.com/s%3F__biz%3DMzI3NDIxNTQyOQ%3D%3D%26mid%3D2247487479%26idx%3D2%26sn%3D3a601b2ff9100a9797605a825e478c01%26chksm%3Deb16289ddc61a18b49051feb9faf7e00b2093e83e723417ea4bab90808464eb6278bc9f979ed%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TiDB Laboratory&lt;/a&gt;&lt;/u&gt;&lt;/li&gt;&lt;li&gt;&lt;u&gt;&lt;a href=&quot;http://link.zhihu.com/?target=http%3A//mp.weixin.qq.com/s%3F__biz%3DMzI3NDIxNTQyOQ%3D%3D%26mid%3D2247487479%26idx%3D1%26sn%3D8a8861419dd22344a021667545005769%26chksm%3Deb16289ddc61a18b034360c5b37437f3cdac956d6777b6711ef14d014211c58d08af969b965c%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TiDB æ”¯æŒå¤šç§å¤–éƒ¨æ•°æ®æºçš„è®¿é—®&lt;/a&gt;&lt;/u&gt;&lt;/li&gt;&lt;li&gt;&lt;u&gt;&lt;a href=&quot;http://link.zhihu.com/?target=http%3A//mp.weixin.qq.com/s%3F__biz%3DMzI3NDIxNTQyOQ%3D%3D%26mid%3D2247487370%26idx%3D2%26sn%3D7eb3d41b2b5cf2a8a440b12121796e2d%26chksm%3Deb1628e0dc61a1f6719856b0eeadd4e878c3b59e0127f8b8f65ed1fb99b2a8981739b5449ce7%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;PD çƒ­ç‚¹è°ƒåº¦è´å¶æ–¯æ¨¡å‹&lt;/a&gt;&lt;/u&gt;&lt;/li&gt;&lt;li&gt;&lt;u&gt;&lt;a href=&quot;http://link.zhihu.com/?target=http%3A//mp.weixin.qq.com/s%3F__biz%3DMzI3NDIxNTQyOQ%3D%3D%26mid%3D2247487555%26idx%3D2%26sn%3D53807a033fef11b8103048bbcac51b69%26chksm%3Deb163729dc61be3f6a64eafe6101054b34bd7f7266b68a3a1091cb751e1eb0d9dcf3f3af39c5%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TiEye&lt;/a&gt;&lt;/u&gt;&lt;/li&gt;&lt;li&gt;&lt;u&gt;&lt;a href=&quot;http://link.zhihu.com/?target=http%3A//mp.weixin.qq.com/s%3F__biz%3DMzI3NDIxNTQyOQ%3D%3D%26mid%3D2247487451%26idx%3D2%26sn%3D5f1ee6e838c3a86556fcd556662112c5%26chksm%3Deb1628b1dc61a1a7e8f4cb82e2bfaab40cbfb27e986f9705f9166d629ff31a812f7ae45b1d73%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TiQuery&lt;/a&gt;&lt;/u&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h2&gt;&lt;b&gt;Content&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;å†…å®¹åˆ†äº«è‡³ä¸Šã€‚æˆ‘ä»¬ä¸€ç›´å¸Œæœ›å¤§å®¶èƒ½å¤Ÿæ‡‚å¾—å¼€æºã€åˆ†äº«çš„ç²¾ç¥ï¼Œä¸»åŠ¨ä¼ æ’­æŠ€æœ¯çŸ¥è¯†ã€åˆ†äº«æ¨åŠ¨é¡¹ç›®è¿›å±•èƒŒåçš„é€»è¾‘ï¼Œè®©æ¯ä¸ªäººéƒ½æˆä¸º Bloggerï¼Œè®©ç¤¾åŒºæ‹¥æœ‰æ›´å¥½çš„ä¿¡æ¯ä¼ é€’å’Œäº¤æµçš„æ°›å›´ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬åœ¨ 2018 å¹´è¾“å‡ºäº†ä¸€ç³»åˆ—ç”¨æˆ·å®è·µï¼ˆ&lt;a href=&quot;http://link.zhihu.com/?target=http%3A//pingcap.com/cases-cn/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;pingcap.com/cases-cn/&lt;/a&gt;ï¼‰ã€&lt;u&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//www.pingcap.com/blog-cn/%23%25E6%25BA%2590%25E7%25A0%2581%25E9%2598%2585%25E8%25AF%25BB&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TiDB æºç é˜…è¯»&lt;/a&gt;&lt;/u&gt;ã€&lt;u&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//www.pingcap.com/blog-cn/%23TiDB-Ecosystem-Tools&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;äº§å“åŸç†ä»‹ç»&lt;/a&gt;&lt;/u&gt;ã€&lt;u&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//www.pingcap.com/blog-cn/tidb-community-guide-1/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;å¼€æºç¤¾åŒºå‚ä¸æŒ‡å—&lt;/a&gt;&lt;/u&gt;ç­‰æŠ€æœ¯æ–‡ç« ã€‚å›¾ 6 ä¸­æ ‡çº¢çš„ &lt;u&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//www.pingcap.com/blog-cn/tikv-source-code-reading-1/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TiKV æºç è§£æç³»åˆ—æ–‡ç« &lt;/a&gt;&lt;/u&gt;æ­£åœ¨ã€ŒæŒ–å‘ã€ä¸­ï¼Œæ•¬è¯·æœŸå¾…ã€‚&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-b54e9a512dfcca0fa8fbcd89b96e6c33_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1058&quot; data-rawheight=&quot;419&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1058&quot; data-original=&quot;https://pic4.zhimg.com/v2-b54e9a512dfcca0fa8fbcd89b96e6c33_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-b54e9a512dfcca0fa8fbcd89b96e6c33_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1058&quot; data-rawheight=&quot;419&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1058&quot; data-original=&quot;https://pic4.zhimg.com/v2-b54e9a512dfcca0fa8fbcd89b96e6c33_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-b54e9a512dfcca0fa8fbcd89b96e6c33_b.jpg&quot;&gt;&lt;figcaption&gt;å›¾ 7 2018 å¹´æŠ€æœ¯å†…å®¹è¾“å‡º&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;é™¤äº†è¿™äº›çº¿ä¸Šæ–‡å­—åˆ†äº«ï¼Œæˆ‘ä»¬ä¹ŸæŠŠå†…éƒ¨&lt;b&gt;Paper Reading&lt;/b&gt;æ´»åŠ¨æ”¾åˆ°äº†çº¿ä¸Šç›´æ’­å¹³å°&lt;b&gt;ï¼ˆBilibili ID: TiDB_Robotï¼‰&lt;/b&gt;ï¼Œå¼€æ”¾ç»™äº†ç¤¾åŒºå°ä¼™ä¼´ä»¬ã€‚å› ä¸º TiDB çš„å‘å±•å·²ç»è¿›å…¥æ–°å‹åˆ†å¸ƒå¼æ•°æ®åº“é¢†åŸŸçš„æ·±æ°´åŒºï¼Œæˆ‘ä»¬éœ€è¦å€ŸåŠ©å‰æ²¿å­¦æœ¯ç ”ç©¶ï¼Œç»“åˆç”¨æˆ·çš„åé¦ˆå»ºè®®å’Œè‡ªå·±çš„çµæ„Ÿï¼Œæ¢ç´¢ TiDB æœªæ¥æ–¹å‘çš„ç»†èŠ‚å±•å¼€å’Œè½åœ°æ–¹æ¡ˆï¼Œæ‰€ä»¥éå¸¸å¸Œæœ›é€šè¿‡ Paper Reading æ´»åŠ¨å¯ä»¥å’Œå¤§å®¶å…±åŒå­¦ä¹ å’Œè®¨è®ºã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;Community Plan&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;2018 å¹´æˆ‘ä»¬å¯åŠ¨äº†ä¸‰ä¸ªç¤¾åŒºåŸ¹è®­è®¡åˆ’ï¼Œé¢å‘ä¸åŒçš„äººç¾¤ï¼Œè®¾ç½®äº†ä¸€ç³»åˆ—çº¿ä¸Š/çº¿ä¸‹åŸ¹è®­è¯¾ç¨‹ï¼Œå¸®åŠ©å¤§å®¶äº†è§£å’Œä½¿ç”¨ TiDBï¼Œç”šè‡³èƒ½å¤Ÿç‹¬ç«‹éƒ¨ç½²ã€è¿ç»´ã€è°ƒä¼˜ TiDBã€‚2019 å¹´æˆ‘ä»¬ä¼šæ·±å…¥æ¨è¿›è¿™äº›è®¡åˆ’ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥æŠ¥ååŠ å…¥ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;PingCAP University&lt;/b&gt;&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-6e7c95584ecbbf7edb6bc70cdb2ab69b_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;453&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-6e7c95584ecbbf7edb6bc70cdb2ab69b_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-6e7c95584ecbbf7edb6bc70cdb2ab69b_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;453&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-6e7c95584ecbbf7edb6bc70cdb2ab69b_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-6e7c95584ecbbf7edb6bc70cdb2ab69b_b.jpg&quot;&gt;&lt;figcaption&gt;å›¾ 8 PingCAP University &lt;/figcaption&gt;&lt;/figure&gt;&lt;ul&gt;&lt;li&gt;  æŠ¥åï¼šuniversity-cn@pingcap.com&lt;/li&gt;&lt;li&gt;é€šè¿‡ &lt;u&gt;&lt;a href=&quot;http://link.zhihu.com/?target=http%3A//mp%253C/u%253E.weixin.qq.com/s%3F__biz%3DMzI3NDIxNTQyOQ%3D%3D%26mid%3D2247487041%26idx%3D1%26sn%3D24a620897124f227a9e59c8100c67542%26chksm%3Deb16292bdc61a03dd85c4de3666420437cff24b84506a62fb0e231a34ca99b96c3cb6b06068e%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;PingCAP University &lt;/a&gt;åŸ¹è®­/è®¤è¯ï¼Œèƒ½è·å¾—ä»€ä¹ˆï¼Ÿ&lt;/u&gt;&lt;/li&gt;&lt;ul&gt;&lt;li&gt;æ·±åº¦ç†è§£ TiDB æ¶æ„ã€åŸç†ä»¥åŠæœ€ä½³å®è·µï¼Œå…·å¤‡ç‹¬ç«‹éƒ¨ç½²ã€è¿ç»´å’Œè°ƒä¼˜ TiDB çš„èƒ½åŠ›ã€‚&lt;/li&gt;&lt;li&gt;ç†è®ºä¸å®è·µç›¸ç»“åˆï¼Œå¼ºè°ƒå®é™…åŠ¨æ‰‹èƒ½åŠ›ï¼Œæé«˜å‰æ²¿æŠ€æœ¯è§†é‡ï¼ŒåŸ¹å…»æ–°ä¸€ä»£ NewSQL æ•°æ®åº“ä¼˜ç§€äººæ‰ã€‚&lt;/li&gt;&lt;li&gt;è·å¾—æ¥è‡ª PingCAP å®˜æ–¹çš„ä¸“ä¸šæŠ€æœ¯èƒ½åŠ›è®¤å¯ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;b&gt;æœªæ¥è®¡åˆ’ï¼š&lt;/b&gt;&lt;/li&gt;&lt;ul&gt;&lt;li&gt;é¢å‘ç”¨æˆ·çš„çº¿ä¸Šè¯¾ç¨‹è®¾è®¡å®ç° &lt;/li&gt;&lt;li&gt;é¢å‘å¼€å‘è€…çš„è¯¾ç¨‹è®¾è®¡å®ç°&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;TiDB Academy &lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;TiDB for MySQL DBAsï¼ˆä¸»è¦é¢å‘æµ·å¤–ç”¨æˆ·ï¼‰&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//pingcap.com/tidb-academy/&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;pingcap.com/tidb-academ&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;y/&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt; &lt;/li&gt;&lt;/ul&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-9ac776d0369329bf9af406dbbbf7d7ee_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;622&quot; data-rawheight=&quot;416&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;622&quot; data-original=&quot;https://pic3.zhimg.com/v2-9ac776d0369329bf9af406dbbbf7d7ee_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-9ac776d0369329bf9af406dbbbf7d7ee_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;622&quot; data-rawheight=&quot;416&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;622&quot; data-original=&quot;https://pic3.zhimg.com/v2-9ac776d0369329bf9af406dbbbf7d7ee_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-9ac776d0369329bf9af406dbbbf7d7ee_b.jpg&quot;&gt;&lt;figcaption&gt;å›¾ 9 TiDB academy ç½‘ç«™é¡µé¢&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;TiDB Talent Plan&lt;/b&gt;&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-a601fdb3c6a4bb48db52d11db12f53f5_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;970&quot; data-rawheight=&quot;419&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;970&quot; data-original=&quot;https://pic2.zhimg.com/v2-a601fdb3c6a4bb48db52d11db12f53f5_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-a601fdb3c6a4bb48db52d11db12f53f5_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;970&quot; data-rawheight=&quot;419&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;970&quot; data-original=&quot;https://pic2.zhimg.com/v2-a601fdb3c6a4bb48db52d11db12f53f5_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-a601fdb3c6a4bb48db52d11db12f53f5_b.jpg&quot;&gt;&lt;figcaption&gt;å›¾ 10 ç¬¬ä¸€æœŸ TiDB Talent Plan&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;&lt;u&gt;&lt;a href=&quot;http://link.zhihu.com/?target=http%3A//mp.weixin.qq.com/s%3F__biz%3DMzI3NDIxNTQyOQ%3D%3D%26mid%3D2247487451%26idx%3D1%26sn%3D53b17f49e05af2cd832192fd67eaf75f%26chksm%3Deb1628b1dc61a1a704544f250cee480e7f6cf95cf5e84c2ccb7f0858398e685160122ed687b6%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;ç¬¬ä¸€æœŸ TiDB Talent Plan &lt;/a&gt;&lt;/u&gt;äº 2018 å¹´12 æœˆ 12 æ—¥è½å¹•ï¼Œå…­ä½å­¦å‘˜é¡ºåˆ©ç»“ä¸šã€‚åç»­æˆ‘ä»¬å¸Œæœ›æŠŠ Talent Plan çš„è¯¾ç¨‹ä»çº¿ä¸‹æ‹“å±•åˆ°çº¿ä¸Šï¼Œè®©æ›´å¤šå¯¹ TiDB ç¤¾åŒºæ„Ÿå…´è¶£çš„å°ä¼™ä¼´å¯ä»¥ä»ä¸­æ‰¾åˆ°ç»„ç»‡ï¼Œå‚ä¸å­¦ä¹ äº¤æµå’Œæ·±å…¥å®è·µã€‚&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-d67978ca43340817886f5edefc738f21_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1039&quot; data-rawheight=&quot;413&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1039&quot; data-original=&quot;https://pic2.zhimg.com/v2-d67978ca43340817886f5edefc738f21_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-d67978ca43340817886f5edefc738f21_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1039&quot; data-rawheight=&quot;413&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1039&quot; data-original=&quot;https://pic2.zhimg.com/v2-d67978ca43340817886f5edefc738f21_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-d67978ca43340817886f5edefc738f21_b.jpg&quot;&gt;&lt;figcaption&gt;å›¾ 11 ç¬¬ä¸€æœŸ TiDB Talent Plan è¯¾ç¨‹è®¾ç½®&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬è®¡åˆ’åœ¨ 2019 å¹´ä»¥åŒ—äº¬ã€ä¸Šæµ·ã€ç¡…è°·ç­‰ 7 ä¸ªåŸå¸‚/åœ°åŒºä¸ºè½è„šç‚¹ï¼Œæˆç«‹ &lt;b&gt;TiDB User Group &lt;/b&gt;ï¼ŒåŠ›æ±‚ã€Œè®©ç”¨æˆ·é©±åŠ¨ç”¨æˆ·ã€ï¼Œå…±åŒæ‰“é€ æ›´å¥½ã€æ›´å¼ºçš„ TiDB ç”Ÿæ€ã€‚åŒæ—¶ä¹Ÿè®©æ›´å¤šå°ä¼™ä¼´æœ‰æœºä¼š&lt;b&gt;æ·±åº¦å‚ä¸&lt;/b&gt;ç¤¾åŒºåŸ¹è®­è®¡åˆ’çš„è¯¾ç¨‹è®¾è®¡ã€çº¿ä¸Šçº¿ä¸‹åŸ¹è®­ã€ç¤¾ç¾¤æ´»åŠ¨ç»„ç»‡ç­‰ç­‰ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;Moment of Glory&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;å›é¡¾äº† 2018 å¹´ç¤¾åŒºå‘å±•å’Œæœªæ¥è®¡åˆ’ä¹‹åï¼Œæˆ‘ä»¬ä¸º 2018 å¹´åº¦ TiDB ç¤¾åŒºæ´»è·ƒè´¡çŒ®è€…ã€æœ€ä½³è´¡çŒ®ä¸ªäºº&amp;amp;å›¢é˜Ÿé¢å‘äº†è£èª‰å¥–æ¯ï¼Œå¹¶ä¸ºæ–°æ™‹ Committer æˆäºˆè¯ä¹¦ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;2018 TiDB Active Contributors&lt;/b&gt;&lt;/p&gt;&lt;p&gt;ğŸŒŸ bb7133  (TiDB TiKV)&lt;/p&gt;&lt;p&gt;ğŸŒŸ niedhui  (TiKV)&lt;/p&gt;&lt;p&gt;ğŸŒŸ yangwenmai  (TiDB)&lt;/p&gt;&lt;p&gt;ğŸŒŸ andrewdi (TiDB)&lt;/p&gt;&lt;p&gt;ğŸŒŸ mathspanda  (TiDB Operator)&lt;/p&gt;&lt;p&gt;&lt;b&gt;2018 æœ€ä½³ç¤¾åŒºè´¡çŒ®å¥–&lt;/b&gt;&lt;/p&gt;&lt;p&gt;ğŸŒŸ spongedu  (Du Chuan)&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-b45f63861863c5e26f75ee7a24d429ae_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;720&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-b45f63861863c5e26f75ee7a24d429ae_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-b45f63861863c5e26f75ee7a24d429ae_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;720&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-b45f63861863c5e26f75ee7a24d429ae_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-b45f63861863c5e26f75ee7a24d429ae_b.jpg&quot;&gt;&lt;figcaption&gt;å›¾ 10 å´”ç§‹ä¸º spongedu é¢å‘è£èª‰å¥–æ¯&lt;/figcaption&gt;&lt;/figure&gt;&lt;ul&gt;&lt;li&gt;32 PRs (TiDB) 10 PRs (TiKV) &lt;/li&gt;&lt;li&gt;Important Features&lt;/li&gt;&lt;ul&gt;&lt;li&gt;TiDB 2.0 SQL engine refactor&lt;/li&gt;&lt;li&gt;Add chunk support for HashAgg&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;Bug Fixes&lt;/li&gt;&lt;ul&gt;&lt;li&gt;17+ bug fixes (optimizer, executor, parser, expression)&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;å‚åŠ  TiDB Hackathonï¼ˆTBSSQL é˜Ÿï¼‰è·å¾—ä¸€ç­‰å¥–&amp;amp;æœ€ä½³è´¡çŒ®å¥–&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;ğŸŒŸ &lt;/b&gt;ç¾å›¢ç‚¹è¯„åˆ†å¸ƒå¼æ•°æ®åº“é¡¹ç›®ç»„&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-cd5feb9ab35933c6a1cb590425b461d8_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;683&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-cd5feb9ab35933c6a1cb590425b461d8_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-cd5feb9ab35933c6a1cb590425b461d8_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;683&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-cd5feb9ab35933c6a1cb590425b461d8_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-cd5feb9ab35933c6a1cb590425b461d8_b.jpg&quot;&gt;&lt;figcaption&gt;å›¾ 10 å´”ç§‹ä¸ºç¾å›¢ç‚¹è¯„åˆ†å¸ƒå¼æ•°æ®åº“é¡¹ç›®ç»„è´Ÿè´£äººé¢å‘è£èª‰å¥–æ¯&lt;/figcaption&gt;&lt;/figure&gt;&lt;ul&gt;&lt;li&gt;ä¸Šçº¿ 20+ å¥—ä¸šåŠ¡é›†ç¾¤ï¼Œ200+èŠ‚ç‚¹&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//www.pingcap.com/cases-cn/user-case-meituandianping/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;ç¾å›¢ç‚¹è¯„æºæ‰‹ PingCAP å¼€å¯æ–°ä¸€ä»£æ•°æ®åº“æ·±åº¦å®è·µä¹‹æ—…&lt;/a&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;10+ PRs, 50+ issues&lt;/li&gt;&lt;li&gt;10+ Engineers&lt;/li&gt;&lt;ul&gt;&lt;li&gt;zhongleihe / yu34po / guozhulang / zhaoxiaojie0415 / 18610314061 / wu-xiang / andyqzb / nettedfish / iamzhoug37 / Y-Rookie / benmaoer / pengji&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;Important Featues&lt;/li&gt;&lt;ul&gt;&lt;li&gt;SQL Plan Management&lt;/li&gt;&lt;li&gt;Index join optimization (WIP) &lt;/li&gt;&lt;li&gt;Rowid scan optimization (WIP)&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;2018 TiDB New Committers&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;ğŸŒŸ &lt;/b&gt;TiKV New Committer: sunxiaoguangï¼ˆçŸ¥ä¹ï¼‰&lt;/p&gt;&lt;ul&gt;&lt;li&gt;8 PRs&lt;/li&gt;&lt;li&gt;Add Rust client support (Raw API)&lt;/li&gt;&lt;li&gt;Add Batch Raw API support (put/get/delete/scan)&lt;/li&gt;&lt;/ul&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-bce496f1615625a189f752da03cadb2f_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;720&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-bce496f1615625a189f752da03cadb2f_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-bce496f1615625a189f752da03cadb2f_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;720&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-bce496f1615625a189f752da03cadb2f_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-bce496f1615625a189f752da03cadb2f_b.jpg&quot;&gt;&lt;figcaption&gt;å›¾ 11 TiDB Committer æé›¨æ¥ä¸º sunxiaoguang æˆäºˆè¯ä¹¦&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;ğŸŒŸ&lt;/b&gt; TiDB New Committer: dbjoa (Samsung)&lt;/p&gt;&lt;ul&gt;&lt;li&gt;15 PRs&lt;/li&gt;&lt;li&gt;Add prepare plan cache support (Insert / Update / Delete)&lt;/li&gt;&lt;/ul&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-40499dbdc074fddf391fe2a8d2a06112_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;657&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-40499dbdc074fddf391fe2a8d2a06112_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-40499dbdc074fddf391fe2a8d2a06112_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;657&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-40499dbdc074fddf391fe2a8d2a06112_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-40499dbdc074fddf391fe2a8d2a06112_b.jpg&quot;&gt;&lt;figcaption&gt;å›¾ 12 dbjoa ç”±äºè¡Œç¨‹åŸå› æ²¡æœ‰åˆ°åœºï¼Œä»–å½•åˆ¶äº†ä¸€æ®µè§†é¢‘ï¼Œä¸º TiDB ç¤¾åŒºé€ä¸Šç¥ç¦&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;i&gt;å¸Œæœ›æ˜å¹´åœ¨ç¤¾åŒºè£èª‰æ—¶åˆ»ï¼Œä¹Ÿè§åˆ°ä½ çš„ GitHub ID å“¦ï¼&lt;/i&gt;&lt;/p&gt;&lt;p&gt;&lt;i&gt;æ–°çš„ä¸€å¹´ PR ä¹Ÿè¦æ»¡æ»¡å“’ï¼&lt;/i&gt;&lt;/p&gt;</description>
<author>ZoeyZhai</author>
<guid isPermaLink="false">2019-02-13-56624608</guid>
<pubDate>Wed, 13 Feb 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>Titan çš„è®¾è®¡ä¸å®ç°</title>
<link>https://henix.github.io/feeds/zhuanlan.newsql/2019-01-29-55521489.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/55521489&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-579b54e6a23d0d19a9cd2950355a72af_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;ä½œè€…ï¼šéƒ‘å¿—é“¨&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/pingcap/rocksdb/tree/titan-5.15&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Titan&lt;/a&gt; æ˜¯ç”± &lt;a href=&quot;http://link.zhihu.com/?target=https%3A//www.pingcap.com/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;PingCAP&lt;/a&gt; ç ”å‘çš„ä¸€ä¸ªåŸºäº &lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/facebook/rocksdb&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;RocksDB&lt;/a&gt; çš„é«˜æ€§èƒ½å•æœº key-value å­˜å‚¨å¼•æ“ï¼Œå…¶ä¸»è¦è®¾è®¡çµæ„Ÿæ¥æºäº USENIX FAST 2016 ä¸Šå‘è¡¨çš„ä¸€ç¯‡è®ºæ–‡ &lt;a href=&quot;http://link.zhihu.com/?target=https%3A//www.usenix.org/system/files/conference/fast16/fast16-papers-lu.pdf&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;WiscKey&lt;/a&gt;ã€‚&lt;code&gt;WiscKey&lt;/code&gt; æå‡ºäº†ä¸€ç§é«˜åº¦åŸºäº SSD ä¼˜åŒ–çš„è®¾è®¡ï¼Œåˆ©ç”¨ SSD é«˜æ•ˆçš„éšæœºè¯»å†™æ€§èƒ½ï¼Œé€šè¿‡å°† value åˆ†ç¦»å‡º &lt;code&gt;LSM-tree&lt;/code&gt; çš„æ–¹æ³•æ¥è¾¾åˆ°é™ä½å†™æ”¾å¤§çš„ç›®çš„ã€‚&lt;/p&gt;&lt;p&gt;æˆ‘ä»¬çš„åŸºå‡†æµ‹è¯•ç»“æœæ˜¾ç¤ºï¼Œå½“ value è¾ƒå¤§çš„æ—¶å€™ï¼ŒTitan åœ¨å†™ã€æ›´æ–°å’Œç‚¹è¯»ç­‰åœºæ™¯ä¸‹æ€§èƒ½éƒ½ä¼˜äº RocksDBã€‚ä½†æ˜¯æ ¹æ® &lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=http%3A//daslab.seas.harvard.edu/rum-conjecture/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;RUM Conjecture&lt;/a&gt;&lt;/code&gt;ï¼Œé€šå¸¸æŸäº›æ–¹é¢çš„æå‡å¾€å¾€æ˜¯ä»¥ç‰ºç‰²å…¶ä»–æ–¹é¢ä¸ºä»£ä»·è€Œå–å¾—çš„ã€‚Titan ä¾¿æ˜¯ä»¥ç‰ºç‰²ç¡¬ç›˜ç©ºé—´å’ŒèŒƒå›´æŸ¥è¯¢çš„æ€§èƒ½ä¸ºä»£ä»·ï¼Œæ¥å–å¾—æ›´é«˜çš„å†™æ€§èƒ½ã€‚éšç€ SSD ä»·æ ¼çš„é™ä½ï¼Œæˆ‘ä»¬è®¤ä¸ºè¿™ç§å–èˆçš„æ„ä¹‰ä¼šè¶Šæ¥è¶Šæ˜æ˜¾ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;è®¾è®¡ç›®æ ‡&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;Titan ä½œä¸º TiKV çš„ä¸€ä¸ªå­é¡¹ç›®ï¼Œé¦–è¦çš„è®¾è®¡ç›®æ ‡ä¾¿æ˜¯å…¼å®¹ RocksDBã€‚å› ä¸º TiKV ä½¿ç”¨ RocksDB ä½œä¸ºå…¶åº•å±‚çš„å­˜å‚¨å¼•æ“ï¼Œè€Œ TiKV ä½œä¸ºä¸€ä¸ªæˆç†Ÿé¡¹ç›®å·²ç»æ‹¥æœ‰åºå¤§çš„ç”¨æˆ·ç¾¤ä½“ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è€ƒè™‘å·²æœ‰çš„ç”¨æˆ·ä¹Ÿå¯ä»¥å°†å·²æœ‰çš„åŸºäº RocksDB çš„ TiKV å¹³æ»‘åœ°å‡çº§åˆ°åŸºäº Titan çš„ TiKVã€‚&lt;/p&gt;&lt;p&gt;å› æ­¤ï¼Œæˆ‘ä»¬æ€»ç»“äº†å››ç‚¹ä¸»è¦çš„è®¾è®¡ç›®æ ‡ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;æ”¯æŒå°† value ä» &lt;code&gt;LSM-tree&lt;/code&gt; ä¸­åˆ†ç¦»å‡ºæ¥å•ç‹¬å­˜å‚¨ï¼Œä»¥é™ä½å†™æ”¾å¤§ã€‚&lt;/li&gt;&lt;li&gt;å·²æœ‰ RocksDB å®ä¾‹å¯ä»¥å¹³æ»‘åœ°å‡çº§åˆ° Titanï¼Œè¿™æ„å‘³ç€å‡çº§è¿‡ç¨‹ä¸éœ€è¦äººå·¥å¹²é¢„ï¼Œå¹¶ä¸”ä¸ä¼šå½±å“çº¿ä¸ŠæœåŠ¡ã€‚&lt;/li&gt;&lt;li&gt;100% å…¼å®¹ç›®å‰ TiKV æ‰€ä½¿ç”¨çš„æ‰€æœ‰ RocksDB çš„ç‰¹æ€§ã€‚&lt;/li&gt;&lt;li&gt;å°½é‡å‡å°‘å¯¹ RocksDB çš„ä¾µå…¥æ€§æ”¹åŠ¨ï¼Œä¿è¯ Titan æ›´åŠ å®¹æ˜“å‡çº§åˆ°æ–°ç‰ˆæœ¬çš„ RocksDBã€‚&lt;/li&gt;&lt;/ul&gt;&lt;h2&gt;&lt;b&gt;æ¶æ„ä¸å®ç°&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;Titan çš„åŸºæœ¬æ¶æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-65149fdad2e1249dda3e58fb8d9e1490_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1240&quot; data-rawheight=&quot;882&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1240&quot; data-original=&quot;https://pic1.zhimg.com/v2-65149fdad2e1249dda3e58fb8d9e1490_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-65149fdad2e1249dda3e58fb8d9e1490_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1240&quot; data-rawheight=&quot;882&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1240&quot; data-original=&quot;https://pic1.zhimg.com/v2-65149fdad2e1249dda3e58fb8d9e1490_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-65149fdad2e1249dda3e58fb8d9e1490_b.jpg&quot;&gt;&lt;/figure&gt;&lt;blockquote&gt;å›¾ 1ï¼šTitan åœ¨ Flush å’Œ Compaction çš„æ—¶å€™å°† value åˆ†ç¦»å‡º &lt;code&gt;LSM-tree&lt;/code&gt;ï¼Œè¿™æ ·åšçš„å¥½å¤„æ˜¯å†™å…¥æµç¨‹å¯ä»¥å’Œ RockDB ä¿æŒä¸€è‡´ï¼Œå‡å°‘å¯¹ &lt;code&gt;RocksDB&lt;/code&gt; çš„ä¾µå…¥æ€§æ”¹åŠ¨ã€‚&lt;/blockquote&gt;&lt;p&gt;Titan çš„æ ¸å¿ƒç»„ä»¶ä¸»è¦åŒ…æ‹¬ï¼š&lt;code&gt;BlobFile&lt;/code&gt;ã€&lt;code&gt;TitanTableBuilder&lt;/code&gt;ã€&lt;code&gt;Version&lt;/code&gt; å’Œ &lt;code&gt;GC&lt;/code&gt;ï¼Œä¸‹é¢å°†é€ä¸€è¿›è¡Œä»‹ç»ã€‚&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;&lt;code&gt;BlobFile&lt;/code&gt;&lt;/b&gt; &lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;code&gt;BlobFile&lt;/code&gt; æ˜¯ç”¨æ¥å­˜æ”¾ä» &lt;code&gt;LSM-tree&lt;/code&gt; ä¸­åˆ†ç¦»å‡ºæ¥çš„ value çš„æ–‡ä»¶ï¼Œå…¶æ ¼å¼å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-6b4972e3d5e50a18e081a2eedef51867_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1240&quot; data-rawheight=&quot;1327&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1240&quot; data-original=&quot;https://pic4.zhimg.com/v2-6b4972e3d5e50a18e081a2eedef51867_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-6b4972e3d5e50a18e081a2eedef51867_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1240&quot; data-rawheight=&quot;1327&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1240&quot; data-original=&quot;https://pic4.zhimg.com/v2-6b4972e3d5e50a18e081a2eedef51867_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-6b4972e3d5e50a18e081a2eedef51867_b.jpg&quot;&gt;&lt;/figure&gt;&lt;blockquote&gt;å›¾ 2ï¼š&lt;code&gt;BlobFile&lt;/code&gt; ä¸»è¦ç”± blob record ã€meta blockã€meta index block å’Œ footer ç»„æˆã€‚å…¶ä¸­æ¯ä¸ª blob record ç”¨äºå­˜æ”¾ä¸€ä¸ª key-value å¯¹ï¼›meta block æ”¯æŒå¯æ‰©å±•æ€§ï¼Œå¯ä»¥ç”¨æ¥å­˜æ”¾å’Œ &lt;code&gt;BlobFile&lt;/code&gt; ç›¸å…³çš„ä¸€äº›å±æ€§ç­‰ï¼›meta index block ç”¨äºæ£€ç´¢ meta blockã€‚&lt;/blockquote&gt;&lt;p&gt;&lt;code&gt;BlobFile&lt;/code&gt; æœ‰å‡ ç‚¹å€¼å¾—å…³æ³¨çš„åœ°æ–¹ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;code&gt;BlobFile&lt;/code&gt; ä¸­çš„ key-value æ˜¯æœ‰åºå­˜æ”¾çš„ï¼Œç›®çš„æ˜¯åœ¨å®ç° &lt;code&gt;Iterator&lt;/code&gt; çš„æ—¶å€™å¯ä»¥é€šè¿‡ prefetch çš„æ–¹å¼æé«˜é¡ºåºè¯»å–çš„æ€§èƒ½ã€‚&lt;/li&gt;&lt;li&gt;æ¯ä¸ª blob record éƒ½ä¿ç•™äº† value å¯¹åº”çš„ user key çš„æ‹·è´ï¼Œè¿™æ ·åšçš„ç›®çš„æ˜¯åœ¨è¿›è¡Œ GC çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡æŸ¥è¯¢ user key æ˜¯å¦æ›´æ–°æ¥ç¡®å®šå¯¹åº” value æ˜¯å¦å·²ç»è¿‡æœŸï¼Œä½†åŒæ—¶ä¹Ÿå¸¦æ¥äº†ä¸€å®šçš„å†™æ”¾å¤§ã€‚&lt;/li&gt;&lt;li&gt;&lt;code&gt;BlobFile&lt;/code&gt; æ”¯æŒ blob record ç²’åº¦çš„ compressionï¼Œå¹¶ä¸”æ”¯æŒå¤šç§ compression algorithmï¼ŒåŒ…æ‹¬ &lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/google/snappy&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Snappy&lt;/a&gt;&lt;/code&gt;ã€&lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/lz4/lz4&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;LZ4&lt;/a&gt;&lt;/code&gt;å’Œ &lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/facebook/zstd&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Zstd&lt;/a&gt;&lt;/code&gt; ç­‰ï¼Œç›®å‰ Titan é»˜è®¤ä½¿ç”¨çš„ compression algorithm æ˜¯ &lt;code&gt;LZ4&lt;/code&gt; ã€‚&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;code&gt;&lt;b&gt;TitanTableBuilder&lt;/b&gt;&lt;/code&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;code&gt;TitanTableBuilder&lt;/code&gt; æ˜¯å®ç°åˆ†ç¦» key-value çš„å…³é”®ã€‚æˆ‘ä»¬çŸ¥é“ RocksDB æ”¯æŒä½¿ç”¨ç”¨æˆ·è‡ªå®šä¹‰ table builder åˆ›å»º &lt;code&gt;SST&lt;/code&gt;ï¼Œè¿™ä½¿å¾—æˆ‘ä»¬å¯ä»¥ä¸å¯¹ build table æµç¨‹åšä¾µå…¥æ€§çš„æ”¹åŠ¨å°±å¯ä»¥å°† value ä» &lt;code&gt;SST&lt;/code&gt; ä¸­åˆ†ç¦»å‡ºæ¥ã€‚ä¸‹é¢å°†ä»‹ç» &lt;code&gt;TitanTableBuilder&lt;/code&gt; çš„ä¸»è¦å·¥ä½œæµç¨‹ï¼š&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-d52ee86abcc2fa54f32942c787879ca6_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1240&quot; data-rawheight=&quot;777&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1240&quot; data-original=&quot;https://pic3.zhimg.com/v2-d52ee86abcc2fa54f32942c787879ca6_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-d52ee86abcc2fa54f32942c787879ca6_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1240&quot; data-rawheight=&quot;777&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1240&quot; data-original=&quot;https://pic3.zhimg.com/v2-d52ee86abcc2fa54f32942c787879ca6_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-d52ee86abcc2fa54f32942c787879ca6_b.jpg&quot;&gt;&lt;/figure&gt;&lt;blockquote&gt;å›¾ 3ï¼š&lt;code&gt;TitanTableBuilder&lt;/code&gt; é€šè¿‡åˆ¤æ–­ value size çš„å¤§å°æ¥å†³å®šæ˜¯å¦å°† value åˆ†ç¦»åˆ° &lt;code&gt;BlobFile&lt;/code&gt; ä¸­å»ã€‚å¦‚æœ value size å¤§äºç­‰äº &lt;code&gt;min_blob_size&lt;/code&gt; åˆ™å°† value åˆ†ç¦»åˆ° &lt;code&gt;BlobFile&lt;/code&gt; ï¼Œå¹¶ç”Ÿæˆ index å†™å…¥ &lt;code&gt;SST&lt;/code&gt;ï¼›å¦‚æœ value size å°äº &lt;code&gt;min_blob_size&lt;/code&gt; åˆ™å°† value ç›´æ¥å†™å…¥ &lt;code&gt;SST&lt;/code&gt;ã€‚&lt;/blockquote&gt;&lt;p&gt;Titan å’Œ &lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/dgraph-io/badger&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Badger&lt;/a&gt;&lt;/code&gt; çš„è®¾è®¡æœ‰å¾ˆå¤§åŒºåˆ«ã€‚&lt;code&gt;Badger&lt;/code&gt; ç›´æ¥å°† &lt;code&gt;WAL&lt;/code&gt; æ”¹é€ æˆ &lt;code&gt;VLog&lt;/code&gt;ï¼Œè¿™æ ·åšçš„å¥½å¤„æ˜¯å‡å°‘ä¸€æ¬¡ Flush çš„å¼€é”€ã€‚è€Œ Titan ä¸è¿™ä¹ˆè®¾è®¡çš„ä¸»è¦åŸå› æœ‰ä¸¤ä¸ªï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;å‡è®¾ &lt;code&gt;LSM-tree&lt;/code&gt; çš„ max level æ˜¯ 5ï¼Œæ”¾å¤§å› å­ä¸º 10ï¼Œåˆ™ &lt;code&gt;LSM-tree&lt;/code&gt; æ€»çš„å†™æ”¾å¤§å¤§æ¦‚ä¸º 1 + 1 + 10 + 10 + 10 + 10ï¼Œå…¶ä¸­ Flush çš„å†™æ”¾å¤§æ˜¯ 1ï¼Œå…¶æ¯”å€¼æ˜¯ 42 : 1ï¼Œå› æ­¤ Flush çš„å†™æ”¾å¤§ç›¸æ¯”äºæ•´ä¸ª LSM-tree çš„å†™æ”¾å¤§å¯ä»¥å¿½ç•¥ä¸è®¡ã€‚&lt;/li&gt;&lt;li&gt;åœ¨ç¬¬ä¸€ç‚¹çš„åŸºç¡€ä¸Šï¼Œä¿ç•™ &lt;code&gt;WAL&lt;/code&gt; å¯ä»¥ä½¿ Titan æå¤§åœ°å‡å°‘å¯¹ RocksDB çš„ä¾µå…¥æ€§æ”¹åŠ¨ï¼Œè€Œè¿™ä¹Ÿæ­£æ˜¯æˆ‘ä»¬çš„è®¾è®¡ç›®æ ‡ä¹‹ä¸€ã€‚ &lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;code&gt;&lt;b&gt;Version&lt;/b&gt;&lt;/code&gt; &lt;/li&gt;&lt;/ul&gt;&lt;p&gt;Titan ä½¿ç”¨ &lt;code&gt;Version&lt;/code&gt; æ¥ä»£è¡¨æŸä¸ªæ—¶é—´ç‚¹æ‰€æœ‰æœ‰æ•ˆçš„ &lt;code&gt;BlobFile&lt;/code&gt;ï¼Œè¿™æ˜¯ä» &lt;code&gt;LevelDB&lt;/code&gt; ä¸­å€Ÿé‰´è¿‡æ¥çš„ç®¡ç†æ•°æ®æ–‡ä»¶çš„æ–¹æ³•ï¼Œå…¶æ ¸å¿ƒæ€æƒ³ä¾¿æ˜¯ &lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//en.wikipedia.org/wiki/Multiversion_concurrency_control&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;MVCC&lt;/a&gt;&lt;/code&gt;ï¼Œå¥½å¤„æ˜¯åœ¨æ–°å¢æˆ–åˆ é™¤æ–‡ä»¶çš„åŒæ—¶ï¼Œå¯ä»¥åšåˆ°å¹¶å‘è¯»å–æ•°æ®è€Œä¸éœ€è¦åŠ é”ã€‚æ¯æ¬¡æ–°å¢æ–‡ä»¶æˆ–è€…åˆ é™¤æ–‡ä»¶çš„æ—¶å€™ï¼Œ&lt;code&gt;Titan&lt;/code&gt; éƒ½ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„ &lt;code&gt;Version&lt;/code&gt; ï¼Œå¹¶ä¸”æ¯æ¬¡è¯»å–æ•°æ®ä¹‹å‰éƒ½è¦è·å–ä¸€ä¸ªæœ€æ–°çš„ &lt;code&gt;Version&lt;/code&gt;ã€‚&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-b7d9e3002bfc4268a4827f6505e1b1bd_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1240&quot; data-rawheight=&quot;380&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1240&quot; data-original=&quot;https://pic2.zhimg.com/v2-b7d9e3002bfc4268a4827f6505e1b1bd_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-b7d9e3002bfc4268a4827f6505e1b1bd_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1240&quot; data-rawheight=&quot;380&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1240&quot; data-original=&quot;https://pic2.zhimg.com/v2-b7d9e3002bfc4268a4827f6505e1b1bd_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-b7d9e3002bfc4268a4827f6505e1b1bd_b.jpg&quot;&gt;&lt;/figure&gt;&lt;blockquote&gt;å›¾ 4ï¼šæ–°æ—§ &lt;code&gt;Version&lt;/code&gt; æŒ‰é¡ºåºé¦–å°¾ç›¸è¿ç»„æˆä¸€ä¸ªåŒå‘é“¾è¡¨ï¼Œ&lt;code&gt;VersionSet&lt;/code&gt; ç”¨æ¥ç®¡ç†æ‰€æœ‰çš„ &lt;code&gt;Version&lt;/code&gt;ï¼Œå®ƒæŒæœ‰ä¸€ä¸ª &lt;code&gt;current&lt;/code&gt; æŒ‡é’ˆç”¨æ¥æŒ‡å‘å½“å‰æœ€æ–°çš„ &lt;code&gt;Version&lt;/code&gt;ã€‚&lt;/blockquote&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;Garbage Collection&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;Garbage Collection (GC) çš„ç›®çš„æ˜¯å›æ”¶ç©ºé—´ï¼Œä¸€ä¸ªé«˜æ•ˆçš„ GC ç®—æ³•åº”è¯¥åœ¨æƒè¡¡å†™æ”¾å¤§å’Œç©ºé—´æ”¾å¤§çš„åŒæ—¶ï¼Œç”¨æœ€å°‘çš„å‘¨æœŸæ¥å›æ”¶æœ€å¤šçš„ç©ºé—´ã€‚åœ¨è®¾è®¡ GC çš„æ—¶å€™æœ‰ä¸¤ä¸ªä¸»è¦çš„é—®é¢˜éœ€è¦è€ƒè™‘ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;ä½•æ—¶è¿›è¡Œ GC&lt;/li&gt;&lt;li&gt;æŒ‘é€‰å“ªäº›æ–‡ä»¶è¿›è¡Œ GC&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;Titan ä½¿ç”¨ RocksDB æä¾›çš„ä¸¤ä¸ªç‰¹æ€§æ¥è§£å†³è¿™ä¸¤ä¸ªé—®é¢˜ï¼Œè¿™ä¸¤ä¸ªç‰¹æ€§åˆ†åˆ«æ˜¯ &lt;code&gt;TablePropertiesCollector&lt;/code&gt; å’Œ&lt;code&gt;EventListener&lt;/code&gt; ã€‚ä¸‹é¢å°†è®²è§£æˆ‘ä»¬æ˜¯å¦‚ä½•é€šè¿‡è¿™ä¸¤ä¸ªç‰¹æ€§æ¥è¾…åŠ© GC å·¥ä½œçš„ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;&lt;code&gt;BlobFileSizeCollector&lt;/code&gt;&lt;/b&gt; &lt;/p&gt;&lt;p&gt;RocksDB å…è®¸æˆ‘ä»¬ä½¿ç”¨è‡ªå®šä¹‰çš„ &lt;code&gt;TablePropertiesCollector&lt;/code&gt; æ¥æœé›† &lt;code&gt;SST&lt;/code&gt; ä¸Šçš„ properties å¹¶å†™å…¥åˆ°å¯¹åº”æ–‡ä»¶ä¸­å»ã€‚&lt;code&gt;Titan&lt;/code&gt; é€šè¿‡ä¸€ä¸ªè‡ªå®šä¹‰çš„ &lt;code&gt;TablePropertiesCollector&lt;/code&gt; â€”â€” &lt;code&gt;BlobFileSizeCollector&lt;/code&gt; æ¥æœé›†æ¯ä¸ª &lt;code&gt;SST&lt;/code&gt; ä¸­æœ‰å¤šå°‘æ•°æ®æ˜¯å­˜æ”¾åœ¨å“ªäº› &lt;code&gt;BlobFile&lt;/code&gt; ä¸Šçš„ï¼Œæˆ‘ä»¬å°†å®ƒæ”¶é›†åˆ°çš„ properties å‘½åä¸º &lt;code&gt;BlobFileSizeProperties&lt;/code&gt;ï¼Œå®ƒçš„å·¥ä½œæµç¨‹å’Œæ•°æ®æ ¼å¼å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-b6966365a68aff1249cf227580b075c3_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1240&quot; data-rawheight=&quot;346&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1240&quot; data-original=&quot;https://pic4.zhimg.com/v2-b6966365a68aff1249cf227580b075c3_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-b6966365a68aff1249cf227580b075c3_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1240&quot; data-rawheight=&quot;346&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1240&quot; data-original=&quot;https://pic4.zhimg.com/v2-b6966365a68aff1249cf227580b075c3_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-b6966365a68aff1249cf227580b075c3_b.jpg&quot;&gt;&lt;/figure&gt;&lt;blockquote&gt;å›¾ 5ï¼šå·¦è¾¹ &lt;code&gt;SST&lt;/code&gt; ä¸­ Index çš„æ ¼å¼ä¸ºï¼šç¬¬ä¸€åˆ—ä»£è¡¨ &lt;code&gt;BlobFile&lt;/code&gt; çš„æ–‡ä»¶ IDï¼Œç¬¬äºŒåˆ—ä»£è¡¨ blob record åœ¨ &lt;code&gt;BlobFile&lt;/code&gt; ä¸­çš„ offsetï¼Œç¬¬ä¸‰åˆ—ä»£è¡¨ blob record çš„ sizeã€‚å³è¾¹ &lt;code&gt;BlobFileSizeProperties&lt;/code&gt; ä¸­çš„æ¯ä¸€è¡Œä»£è¡¨ä¸€ä¸ª &lt;code&gt;BlobFile&lt;/code&gt; ä»¥åŠ &lt;code&gt;SST&lt;/code&gt; ä¸­æœ‰å¤šå°‘æ•°æ®ä¿å­˜åœ¨è¿™ä¸ª &lt;code&gt;BlobFile&lt;/code&gt; ä¸­ï¼Œç¬¬ä¸€åˆ—ä»£è¡¨ &lt;code&gt;BlobFile&lt;/code&gt; çš„æ–‡ä»¶ IDï¼Œç¬¬äºŒåˆ—ä»£è¡¨æ•°æ®å¤§å°ã€‚&lt;/blockquote&gt;&lt;p&gt;&lt;code&gt;&lt;b&gt;EventListener&lt;/b&gt;&lt;/code&gt; &lt;/p&gt;&lt;p&gt;æˆ‘ä»¬çŸ¥é“ RocksDB æ˜¯é€šè¿‡ Compaction æ¥ä¸¢å¼ƒæ—§ç‰ˆæœ¬æ•°æ®ä»¥å›æ”¶ç©ºé—´çš„ï¼Œå› æ­¤æ¯æ¬¡ Compaction å®Œæˆå Titan ä¸­çš„æŸäº› &lt;code&gt;BlobFile&lt;/code&gt; ä¸­ä¾¿å¯èƒ½æœ‰éƒ¨åˆ†æˆ–å…¨éƒ¨æ•°æ®è¿‡æœŸã€‚å› æ­¤æˆ‘ä»¬ä¾¿å¯ä»¥é€šè¿‡ç›‘å¬ Compaction äº‹ä»¶æ¥è§¦å‘ GCï¼Œé€šè¿‡æœé›†æ¯”å¯¹ Compaction ä¸­è¾“å…¥è¾“å‡º &lt;code&gt;SST&lt;/code&gt; çš„ &lt;code&gt;BlobFileSizeProperties&lt;/code&gt; æ¥å†³å®šæŒ‘é€‰å“ªäº› &lt;code&gt;BlobFile&lt;/code&gt; è¿›è¡Œ GCã€‚å…¶æµç¨‹å¤§æ¦‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-e4686b7ee8ae31e83799bef437730e43_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1240&quot; data-rawheight=&quot;652&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1240&quot; data-original=&quot;https://pic4.zhimg.com/v2-e4686b7ee8ae31e83799bef437730e43_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-e4686b7ee8ae31e83799bef437730e43_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1240&quot; data-rawheight=&quot;652&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1240&quot; data-original=&quot;https://pic4.zhimg.com/v2-e4686b7ee8ae31e83799bef437730e43_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-e4686b7ee8ae31e83799bef437730e43_b.jpg&quot;&gt;&lt;/figure&gt;&lt;blockquote&gt;å›¾ 6ï¼šinputs ä»£è¡¨å‚ä¸ Compaction çš„æ‰€æœ‰ &lt;code&gt;SST&lt;/code&gt; çš„ &lt;code&gt;BlobFileSizeProperties&lt;/code&gt;ï¼Œoutputs ä»£è¡¨ Compaction ç”Ÿæˆçš„æ‰€æœ‰ &lt;code&gt;SST&lt;/code&gt; çš„ &lt;code&gt;BlobFileSizeProperties&lt;/code&gt;ï¼Œdiscardable size æ˜¯é€šè¿‡è®¡ç®— inputs å’Œ outputs å¾—å‡ºçš„æ¯ä¸ª &lt;code&gt;BlobFile&lt;/code&gt; è¢«ä¸¢å¼ƒçš„æ•°æ®å¤§å°ï¼Œç¬¬ä¸€åˆ—ä»£è¡¨ &lt;code&gt;BlobFile&lt;/code&gt; çš„æ–‡ä»¶ IDï¼Œç¬¬äºŒåˆ—ä»£è¡¨è¢«ä¸¢å¼ƒçš„æ•°æ®å¤§å°ã€‚&lt;/blockquote&gt;&lt;p&gt;Titan ä¼šä¸ºæ¯ä¸ªæœ‰æ•ˆçš„ &lt;code&gt;BlobFile&lt;/code&gt; åœ¨å†…å­˜ä¸­ç»´æŠ¤ä¸€ä¸ª discardable size å˜é‡ï¼Œæ¯æ¬¡ Compaction ç»“æŸä¹‹åéƒ½å¯¹ç›¸åº”çš„ &lt;code&gt;BlobFile&lt;/code&gt; çš„ discardable size å˜é‡è¿›è¡Œç´¯åŠ ã€‚æ¯æ¬¡ GC å¼€å§‹æ—¶å°±å¯ä»¥é€šè¿‡æŒ‘é€‰ discardable size æœ€å¤§çš„ &lt;code&gt;BlobFile&lt;/code&gt; æ¥ä½œä¸ºä½œä¸ºå€™é€‰çš„æ–‡ä»¶ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;Sample&lt;/b&gt;&lt;/p&gt;&lt;p&gt;æ¯æ¬¡è¿›è¡Œ GC å‰æˆ‘ä»¬éƒ½ä¼šæŒ‘é€‰ä¸€ç³»åˆ—&lt;code&gt;BlobFile&lt;/code&gt;ä½œä¸ºå€™é€‰æ–‡ä»¶ï¼ŒæŒ‘é€‰çš„æ–¹æ³•å¦‚ä¸Šä¸€èŠ‚æ‰€è¿°ã€‚ä¸ºäº†å‡å°å†™æ”¾å¤§ï¼Œæˆ‘ä»¬å¯ä»¥å®¹å¿ä¸€å®šçš„ç©ºé—´æ”¾å¤§ï¼Œæ‰€ä»¥æˆ‘ä»¬åªæœ‰åœ¨&lt;code&gt;BlobFile&lt;/code&gt;å¯ä¸¢å¼ƒçš„æ•°æ®è¾¾åˆ°ä¸€å®šæ¯”ä¾‹ä¹‹åæ‰ä¼šå¯¹å…¶è¿›è¡Œ GCã€‚æˆ‘ä»¬ä½¿ç”¨ Sample ç®—æ³•æ¥è·å–æ¯ä¸ªå€™é€‰æ–‡ä»¶ä¸­å¯ä¸¢å¼ƒæ•°æ®çš„å¤§è‡´æ¯”ä¾‹ã€‚Sample ç®—æ³•çš„ä¸»è¦é€»è¾‘æ˜¯éšæœºå–&lt;code&gt;BlobFile&lt;/code&gt;ä¸­çš„ä¸€æ®µæ•°æ® Aï¼Œè®¡å…¶å¤§å°ä¸º aï¼Œç„¶åéå† A ä¸­çš„ keyï¼Œç´¯åŠ è¿‡æœŸçš„ key æ‰€åœ¨çš„ blob record çš„ size è®¡ä¸º dï¼Œæœ€åè®¡ç®—å¾—å‡º d å  a æ¯”å€¼ ä¸º rï¼Œå¦‚æœ r &amp;gt;=&lt;code&gt;discardable_ratio&lt;/code&gt;åˆ™å¯¹è¯¥&lt;code&gt;BlobFile&lt;/code&gt;è¿›è¡Œ GCï¼Œå¦åˆ™ä¸å¯¹å…¶è¿›è¡Œ GCã€‚ä¸Šä¸€èŠ‚æˆ‘ä»¬å·²ç»çŸ¥é“æ¯ä¸ª&lt;code&gt;BlobFile&lt;/code&gt;éƒ½ä¼šåœ¨å†…å­˜ä¸­ç»´æŠ¤ä¸€ä¸ª discardable sizeï¼Œå¦‚æœè¿™ä¸ª discardable size å æ•´ä¸ª&lt;code&gt;BlobFile&lt;/code&gt;æ•°æ®å¤§å°çš„æ¯”å€¼å·²ç»å¤§äºæˆ–ç­‰äº&lt;code&gt;discardable_ratio&lt;/code&gt;åˆ™ä¸éœ€è¦å¯¹å…¶è¿›è¡Œ Sampleã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;åŸºå‡†æµ‹è¯•&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;æˆ‘ä»¬ä½¿ç”¨&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/pingcap/go-ycsb&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;go-ycsb&lt;/a&gt;æµ‹è¯•äº† TiKV åœ¨ Txn Mode ä¸‹åˆ†åˆ«ä½¿ç”¨ RocksDB å’Œ Titan çš„æ€§èƒ½è¡¨ç°ï¼Œæœ¬èŠ‚æˆ‘ä¼šç®€è¦è¯´æ˜ä¸‹æˆ‘ä»¬çš„æµ‹è¯•æ–¹æ³•å’Œæµ‹è¯•ç»“æœã€‚ç”±äºç¯‡å¹…çš„åŸå› ï¼Œæˆ‘ä»¬åªæŒ‘é€‰ä¸¤ä¸ªå…¸å‹çš„ value size åšè¯´æ˜ï¼Œæ›´è¯¦ç»†çš„æµ‹è¯•åˆ†ææŠ¥å‘Šå°†ä¼šæ”¾åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;æµ‹è¯•ç¯å¢ƒ&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;CPUï¼šIntelÂ® XeonÂ® CPU E5-2630 v4 @ 2.20GHzï¼ˆ40ä¸ªæ ¸å¿ƒï¼‰&lt;/li&gt;&lt;li&gt;Memoryï¼š128GBï¼ˆæˆ‘ä»¬é€šè¿‡ Cgroup é™åˆ¶ TiKV è¿›ç¨‹ä½¿ç”¨å†…å­˜ä¸è¶…è¿‡ 32GBï¼‰&lt;/li&gt;&lt;li&gt;Diskï¼šSATA SSD 1.5TBï¼ˆ&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//linux.die.net/man/1/fio&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;fio&lt;/a&gt; æµ‹è¯•ï¼š4KB block size æ··åˆéšæœºè¯»å†™æƒ…å†µä¸‹è¯»å†™ IOPS åˆ†åˆ«ä¸º 43.8K å’Œ 18.7Kï¼‰&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;æµ‹è¯•è®¡åˆ’&lt;/b&gt;&lt;/p&gt;&lt;p&gt;æ•°æ®é›†é€‰å®šçš„åŸºæœ¬åŸåˆ™æ˜¯åŸå§‹æ•°æ®å¤§å°ï¼ˆä¸ç®—ä¸Šå†™æ”¾å¤§å› ç´ ï¼‰è¦æ¯”å¯ç”¨å†…å­˜å¤§ï¼Œè¿™æ ·å¯ä»¥é˜²æ­¢æ‰€æœ‰æ•°æ®è¢«ç¼“å­˜åˆ°å†…å­˜ä¸­ï¼Œå‡å°‘ Cache æ‰€å¸¦æ¥çš„å½±å“ã€‚è¿™é‡Œæˆ‘ä»¬é€‰ç”¨çš„æ•°æ®é›†å¤§å°æ˜¯ 64GBï¼Œè¿›ç¨‹çš„å†…å­˜ä½¿ç”¨é™åˆ¶æ˜¯ 32GBã€‚&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-654eb07d1a8074029fdff9da40502dd7_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1238&quot; data-rawheight=&quot;294&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1238&quot; data-original=&quot;https://pic4.zhimg.com/v2-654eb07d1a8074029fdff9da40502dd7_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-654eb07d1a8074029fdff9da40502dd7_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1238&quot; data-rawheight=&quot;294&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1238&quot; data-original=&quot;https://pic4.zhimg.com/v2-654eb07d1a8074029fdff9da40502dd7_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-654eb07d1a8074029fdff9da40502dd7_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;æˆ‘ä»¬ä¸»è¦æµ‹è¯• 5 ä¸ªå¸¸ç”¨çš„åœºæ™¯ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Data Loading Performanceï¼šä½¿ç”¨é¢„å…ˆè®¡ç®—å¥½çš„ key æ•°é‡å’Œå›ºå®šçš„ value å¤§å°ï¼Œä»¥ä¸€å®šçš„é€Ÿåº¦å¹¶å‘å†™å…¥ã€‚&lt;/li&gt;&lt;li&gt;Update Performanceï¼šç”±äº Titan åœ¨çº¯å†™å…¥åœºæ™¯ä¸‹ä¸éœ€è¦ GCï¼ˆ&lt;code&gt;BlobFile&lt;/code&gt; ä¸­æ²¡æœ‰å¯ä¸¢å¼ƒæ•°æ®ï¼‰ï¼Œå› æ­¤æˆ‘ä»¬è¿˜éœ€è¦é€šè¿‡æ›´æ–°æ¥æµ‹è¯• &lt;code&gt;GC&lt;/code&gt; å¯¹æ€§èƒ½çš„å½±å“ã€‚&lt;/li&gt;&lt;li&gt;Output Sizeï¼šè¿™ä¸€æ­¥æˆ‘ä»¬ä¼šæµ‹é‡æ›´æ–°åœºæ™¯å®Œæˆåå¼•æ“æ‰€å ç”¨çš„ç¡¬ç›˜ç©ºé—´å¤§å°ï¼Œä»¥æ­¤åæ˜  GC çš„ç©ºé—´å›æ”¶æ•ˆæœã€‚&lt;/li&gt;&lt;li&gt;Random Key Lookup Performanceï¼šè¿™ä¸€æ­¥ä¸»è¦æµ‹è¯•ç‚¹æŸ¥æ€§èƒ½ï¼Œå¹¶ä¸”ç‚¹æŸ¥æ¬¡æ•°è¦è¿œè¿œå¤§äº key çš„æ•°é‡ã€‚&lt;/li&gt;&lt;li&gt;Sorted Range Iteration Performanceï¼šè¿™ä¸€æ­¥ä¸»è¦æµ‹è¯•èŒƒå›´æŸ¥è¯¢çš„æ€§èƒ½ï¼Œæ¯æ¬¡æŸ¥è¯¢ 2 million ä¸ªç›¸è¿çš„ keyã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;æµ‹è¯•ç»“æœ&lt;/b&gt;&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-dbe299a64478cfd1507390cb4a920938_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1240&quot; data-rawheight=&quot;767&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1240&quot; data-original=&quot;https://pic1.zhimg.com/v2-dbe299a64478cfd1507390cb4a920938_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-dbe299a64478cfd1507390cb4a920938_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1240&quot; data-rawheight=&quot;767&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1240&quot; data-original=&quot;https://pic1.zhimg.com/v2-dbe299a64478cfd1507390cb4a920938_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-dbe299a64478cfd1507390cb4a920938_b.jpg&quot;&gt;&lt;/figure&gt;&lt;blockquote&gt;å›¾ 7 Data Loading Performanceï¼šTitan åœ¨å†™åœºæ™¯ä¸­çš„æ€§èƒ½è¦æ¯” RocksDB é«˜ 70% ä»¥ä¸Šï¼Œå¹¶ä¸”éšç€ value size çš„å˜å¤§ï¼Œè¿™ç§æ€§èƒ½çš„å·®å¼‚ä¼šæ›´åŠ æ˜æ˜¾ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæ•°æ®åœ¨å†™å…¥ KV Engine ä¹‹å‰ä¼šå…ˆå†™å…¥ Raft Logï¼Œå› æ­¤ Titan çš„æ€§èƒ½æå‡ä¼šè¢«æ‘Šè–„ï¼Œå®é™…ä¸Šè£¸æµ‹ RocksDB å’Œ Titan çš„è¯è¿™ç§æ€§èƒ½å·®å¼‚ä¼šæ›´å¤§ã€‚&lt;/blockquote&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-732c5f9c0ab0b43a7e134c1ad6e74f8f_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1240&quot; data-rawheight=&quot;767&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1240&quot; data-original=&quot;https://pic4.zhimg.com/v2-732c5f9c0ab0b43a7e134c1ad6e74f8f_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-732c5f9c0ab0b43a7e134c1ad6e74f8f_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1240&quot; data-rawheight=&quot;767&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1240&quot; data-original=&quot;https://pic4.zhimg.com/v2-732c5f9c0ab0b43a7e134c1ad6e74f8f_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-732c5f9c0ab0b43a7e134c1ad6e74f8f_b.jpg&quot;&gt;&lt;/figure&gt;&lt;blockquote&gt;å›¾ 8 Update Performanceï¼šTitan åœ¨æ›´æ–°åœºæ™¯ä¸­çš„æ€§èƒ½è¦æ¯” RocksDB é«˜ 180% ä»¥ä¸Šï¼Œè¿™ä¸»è¦å¾—ç›Šäº Titan ä¼˜ç§€çš„è¯»æ€§èƒ½å’Œè‰¯å¥½çš„ GC ç®—æ³•ã€‚&lt;/blockquote&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-fc669dcecc0cf1286ee308292ba4c48e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1240&quot; data-rawheight=&quot;767&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1240&quot; data-original=&quot;https://pic3.zhimg.com/v2-fc669dcecc0cf1286ee308292ba4c48e_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-fc669dcecc0cf1286ee308292ba4c48e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1240&quot; data-rawheight=&quot;767&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1240&quot; data-original=&quot;https://pic3.zhimg.com/v2-fc669dcecc0cf1286ee308292ba4c48e_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-fc669dcecc0cf1286ee308292ba4c48e_b.jpg&quot;&gt;&lt;/figure&gt;&lt;blockquote&gt;å›¾ 9 Output Sizeï¼šTitan çš„ç©ºé—´æ”¾å¤§ç›¸æ¯” RocksDB ç•¥é«˜ï¼Œè¿™ç§å·®è·ä¼šéšç€ Key æ•°é‡çš„å‡å°‘æœ‰ç•¥å¾®çš„ç¼©å°ï¼Œè¿™ä¸»è¦æ˜¯å› ä¸º &lt;code&gt;BlobFile&lt;/code&gt; ä¸­éœ€è¦å­˜å‚¨ Key è€Œé€ æˆçš„å†™æ”¾å¤§ã€‚&lt;/blockquote&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-2988e19ff909924ffd330a4776b0f974_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1240&quot; data-rawheight=&quot;767&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1240&quot; data-original=&quot;https://pic1.zhimg.com/v2-2988e19ff909924ffd330a4776b0f974_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-2988e19ff909924ffd330a4776b0f974_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1240&quot; data-rawheight=&quot;767&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1240&quot; data-original=&quot;https://pic1.zhimg.com/v2-2988e19ff909924ffd330a4776b0f974_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-2988e19ff909924ffd330a4776b0f974_b.jpg&quot;&gt;&lt;/figure&gt;&lt;blockquote&gt;å›¾ 10 Random Key Lookupï¼š Titan æ‹¥æœ‰æ¯” RocksDB æ›´å“è¶Šçš„ç‚¹è¯»æ€§èƒ½ï¼Œè¿™ä¸»è¦å¾—ç›Šä¸å°† value åˆ†ç¦»å‡º &lt;code&gt;LSM-tree&lt;/code&gt;çš„è®¾è®¡ä½¿å¾— &lt;code&gt;LSM-tree&lt;/code&gt; å˜å¾—æ›´å°ï¼Œå› æ­¤ Titan åœ¨ä½¿ç”¨åŒæ ·çš„å†…å­˜é‡æ—¶å¯ä»¥å°†æ›´å¤šçš„ &lt;code&gt;index&lt;/code&gt; ã€&lt;code&gt;filter&lt;/code&gt; å’Œ &lt;code&gt;DataBlock&lt;/code&gt; ç¼“å­˜åˆ° Block Cache ä¸­å»ã€‚è¿™ä½¿å¾—ç‚¹è¯»æ“ä½œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ä»…éœ€è¦ä¸€æ¬¡ IO å³å¯ï¼ˆä¸»è¦æ˜¯ç”¨äºä» &lt;code&gt;BlobFile&lt;/code&gt; ä¸­è¯»å–æ•°æ®ï¼‰ã€‚&lt;/blockquote&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-513126ff72f4ab14270dc383dc625751_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1240&quot; data-rawheight=&quot;767&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1240&quot; data-original=&quot;https://pic2.zhimg.com/v2-513126ff72f4ab14270dc383dc625751_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-513126ff72f4ab14270dc383dc625751_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1240&quot; data-rawheight=&quot;767&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1240&quot; data-original=&quot;https://pic2.zhimg.com/v2-513126ff72f4ab14270dc383dc625751_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-513126ff72f4ab14270dc383dc625751_b.jpg&quot;&gt;&lt;/figure&gt;&lt;blockquote&gt;å›¾ 11 Sorted Range Iterationï¼šTitan çš„èŒƒå›´æŸ¥è¯¢æ€§èƒ½ç›®å‰å’Œ RocksDB ç›¸æ¯”è¿˜æ˜¯æœ‰ä¸€å®šçš„å·®è·ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬æœªæ¥ä¼˜åŒ–çš„ä¸€ä¸ªé‡è¦æ–¹å‘ã€‚&lt;/blockquote&gt;&lt;p&gt;æœ¬æ¬¡æµ‹è¯•æˆ‘ä»¬å¯¹æ¯”äº†ä¸¤ä¸ªå…·æœ‰ä»£è¡¨æ€§çš„ value size åœ¨ 5 ç§ä¸åŒåœºæ™¯ä¸‹çš„æ€§èƒ½å·®å¼‚ï¼Œæ›´å¤šä¸åŒç²’åº¦çš„ value size çš„æµ‹è¯•å’Œæ›´è¯¦ç»†çš„æ€§èƒ½æŠ¥å‘Šæˆ‘ä»¬ä¼šæ”¾åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« å»è¯´æ˜ï¼Œå¹¶ä¸”æˆ‘ä»¬ä¼šä»æ›´å¤šçš„è§’åº¦ï¼ˆä¾‹å¦‚ CPU å’Œå†…å­˜çš„ä½¿ç”¨ç‡ç­‰ï¼‰å»åˆ†æ Titan å’Œ RocksDB çš„å·®å¼‚ã€‚ä»æœ¬æ¬¡æµ‹è¯•æˆ‘ä»¬å¯ä»¥å¤§è‡´å¾—å‡ºç»“è®ºï¼Œåœ¨å¤§ value çš„åœºæ™¯ä¸‹ï¼ŒTitan ä¼šæ¯” RocksDB æ‹¥æœ‰æ›´å¥½çš„å†™ã€æ›´æ–°å’Œç‚¹è¯»æ€§èƒ½ã€‚åŒæ—¶ï¼ŒTitan çš„èŒƒå›´æŸ¥è¯¢æ€§èƒ½å’Œç©ºé—´æ”¾å¤§éƒ½é€Šäº RocksDB ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;å…¼å®¹æ€§&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;ä¸€å¼€å§‹æˆ‘ä»¬ä¾¿å°†å…¼å®¹ RocksDB ä½œä¸ºè®¾è®¡ Titan çš„é¦–è¦ç›®æ ‡ï¼Œå› æ­¤æˆ‘ä»¬ä¿ç•™äº†ç»å¤§éƒ¨åˆ† RocksDB çš„ APIã€‚ç›®å‰ä»…æœ‰ä¸¤ä¸ª API æ˜¯æˆ‘ä»¬æ˜ç¡®ä¸æ”¯æŒçš„ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;code&gt;Merge&lt;/code&gt;&lt;/li&gt;&lt;li&gt;&lt;code&gt;SingleDelete&lt;/code&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;é™¤äº† &lt;code&gt;Open&lt;/code&gt; æ¥å£ä»¥å¤–ï¼Œå…¶ä»– API çš„å‚æ•°å’Œè¿”å›å€¼éƒ½å’Œ RocksDB ä¸€è‡´ã€‚å·²æœ‰çš„é¡¹ç›®åªéœ€è¦å¾ˆå°çš„æ”¹åŠ¨å³å¯ä»¥å°† &lt;code&gt;RocksDB&lt;/code&gt;å®ä¾‹å¹³æ»‘åœ°å‡çº§åˆ° Titanã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ Titan å¹¶ä¸æ”¯æŒå›é€€å› RocksDBã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;å¦‚ä½•ä½¿ç”¨ Titan&lt;/b&gt;&lt;/h2&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;åˆ›å»º DB&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;&lt;span&gt;&lt;/span&gt;#include &amp;lt;assert&amp;gt;
#include &quot;rocksdb/utilities/titandb/db.h&quot;

// Open DB
rocksdb::titandb::TitanDB* db;
rocksdb::titandb::TitanOptions options;
options.create_if_missing = true;
rocksdb::Status status =
  rocksdb::titandb::TitanDB::Open(options, &quot;/tmp/testdb&quot;, &amp;amp;db);
assert(status.ok());
...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æˆ–&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;&lt;span&gt;&lt;/span&gt;#include &amp;lt;assert&amp;gt;
#include &quot;rocksdb/utilities/titandb/db.h&quot;

// open DB with two column families
rocksdb::titandb::TitanDB* db;
std::vector&amp;lt;rocksdb::titandb::TitanCFDescriptor&amp;gt; column_families;
// have to open default column family
column_families.push_back(rocksdb::titandb::TitanCFDescriptor(
    kDefaultColumnFamilyName, rocksdb::titandb::TitanCFOptions()));
// open the new one, too
column_families.push_back(rocksdb::titandb::TitanCFDescriptor(
    &quot;new_cf&quot;, rocksdb::titandb::TitanCFOptions()));
std::vector&amp;lt;ColumnFamilyHandle*&amp;gt; handles;
s = rocksdb::titandb::TitanDB::Open(rocksdb::titandb::TitanDBOptions(), kDBPath,
                                    column_families, &amp;amp;handles, &amp;amp;db);
assert(s.ok());
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;Status&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;å’Œ RocksDB ä¸€æ ·ï¼ŒTitan ä½¿ç”¨ &lt;code&gt;rocksdb::Status&lt;/code&gt; æ¥ä½œä¸ºç»å¤§å¤šæ•° API çš„è¿”å›å€¼ï¼Œä½¿ç”¨è€…å¯ä»¥é€šè¿‡å®ƒæ£€æŸ¥æ‰§è¡Œç»“æœæ˜¯å¦æˆåŠŸï¼Œä¹Ÿå¯ä»¥é€šè¿‡å®ƒæ‰“å°é”™è¯¯ä¿¡æ¯ï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;&lt;span&gt;&lt;/span&gt;rocksdb::Status s = ...;
if (!s.ok()) cerr &amp;lt;&amp;lt; s.ToString() &amp;lt;&amp;lt; endl;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;é”€æ¯ DB&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;&lt;span&gt;&lt;/span&gt;std::string value;
rocksdb::Status s = db-&amp;gt;Get(rocksdb::ReadOptions(), key1, &amp;amp;value);
if (s.ok()) s = db-&amp;gt;Put(rocksdb::WriteOptions(), key2, value);
if (s.ok()) s = db-&amp;gt;Delete(rocksdb::WriteOptions(), key1);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;åœ¨ TiKV ä¸­ä½¿ç”¨ Titan&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;ç›®å‰ Titan åœ¨ TiKV ä¸­æ˜¯é»˜è®¤å…³é—­çš„ï¼Œæˆ‘ä»¬é€šè¿‡ TiKV çš„é…ç½®æ–‡ä»¶æ¥å†³å®šæ˜¯å¦å¼€å¯å’Œè®¾ç½® Titanï¼Œç›¸å…³çš„é…ç½®é¡¹åŒ…æ‹¬ &lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/tikv/tikv/blob/12a1ea8d13b6478c8a4d07f0bb7411f3367dc8f9/etc/config-template.toml%23L375&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;[rocksdb.titan]&lt;/a&gt;&lt;/code&gt; å’Œ &lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/tikv/tikv/blob/12a1ea8d13b6478c8a4d07f0bb7411f3367dc8f9/etc/config-template.toml%23L531&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;[rocksdb.defaultcf.titan]&lt;/a&gt;&lt;/code&gt;ï¼Œ å¼€å¯ Titan åªéœ€è¦è¿›è¡Œå¦‚ä¸‹é…ç½®å³å¯ï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;&lt;span&gt;&lt;/span&gt;[rocksdb.titan]
enabled = true
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ³¨æ„ä¸€æ—¦å¼€å¯ Titan å°±ä¸èƒ½å›é€€å› RocksDB äº†ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;æœªæ¥çš„å·¥ä½œ&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;ä¼˜åŒ– &lt;code&gt;Iterator&lt;/code&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&gt;æˆ‘ä»¬é€šè¿‡æµ‹è¯•å‘ç°ï¼Œç›®å‰ä½¿ç”¨ Titan åšèŒƒå›´æŸ¥è¯¢æ—¶ IO Util å¾ˆä½ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå…¶æ€§èƒ½ä¼šæ¯” RocksDB å·®çš„é‡è¦åŸå› ä¹‹ä¸€ã€‚å› æ­¤æˆ‘ä»¬è®¤ä¸º Titan çš„ &lt;code&gt;Iterator&lt;/code&gt; è¿˜å­˜åœ¨ç€å·¨å¤§çš„ä¼˜åŒ–ç©ºé—´ï¼Œæœ€ç®€å•çš„æ–¹æ³•æ˜¯å¯ä»¥é€šè¿‡æ›´åŠ æ¿€è¿›çš„ prefetch å’Œå¹¶è¡Œ prefetch ç­‰æ‰‹æ®µæ¥è¾¾åˆ°æå‡ &lt;code&gt;Iterator&lt;/code&gt; æ€§èƒ½çš„ç›®çš„ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;&lt;code&gt;GC&lt;/code&gt; é€Ÿåº¦æ§åˆ¶å’Œè‡ªåŠ¨è°ƒèŠ‚&lt;/b&gt;&lt;/p&gt;&lt;p&gt;é€šå¸¸æ¥è¯´ï¼ŒGC çš„é€Ÿåº¦å¤ªæ…¢ä¼šå¯¼è‡´ç©ºé—´æ”¾å¤§ä¸¥é‡ï¼Œè¿‡å¿«åˆä¼šå¯¹æœåŠ¡çš„ QPS å’Œå»¶æ—¶å¸¦æ¥å½±å“ã€‚ç›®å‰ Titan æ”¯æŒè‡ªåŠ¨ GCï¼Œè™½ç„¶å¯ä»¥é€šè¿‡å‡å°å¹¶å‘åº¦å’Œ batch size æ¥è¾¾åˆ°ä¸€å®šç¨‹åº¦é™åˆ¶ GC é€Ÿåº¦çš„ç›®çš„ï¼Œä½†æ˜¯ç”±äºæ¯ä¸ª &lt;code&gt;BlobFile&lt;/code&gt; ä¸­çš„ blob record æ•°ç›®ä¸å®šï¼Œè‹¥ &lt;code&gt;BlobFile&lt;/code&gt; ä¸­çš„ blob record è¿‡äºå¯†é›†ï¼Œå°†å…¶æœ‰æ•ˆçš„ key æ›´æ–°å› &lt;code&gt;LSM-tree&lt;/code&gt; æ—¶ä»ç„¶å¯èƒ½å µå¡ä¸šåŠ¡çš„å†™è¯·æ±‚ã€‚ä¸ºäº†è¾¾åˆ°æ›´åŠ ç²¾ç»†åŒ–çš„æ§åˆ¶ GC é€Ÿåº¦çš„ç›®çš„ï¼Œåç»­æˆ‘ä»¬å°†ä½¿ç”¨ &lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//en.wikipedia.org/wiki/Token_bucket&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Token Bucket&lt;/a&gt;&lt;/code&gt; ç®—æ³•é™åˆ¶ä¸€æ®µæ—¶é—´å†… GC èƒ½å¤Ÿæ›´æ–°çš„ key æ•°é‡ï¼Œä»¥é™ä½ GC å¯¹ QPS å’Œå»¶æ—¶çš„å½±å“ï¼Œä½¿æœåŠ¡æ›´åŠ ç¨³å®šã€‚&lt;/p&gt;&lt;p&gt;å¦ä¸€æ–¹é¢ï¼Œæˆ‘ä»¬ä¹Ÿæ­£åœ¨ç ”ç©¶è‡ªåŠ¨è°ƒèŠ‚ GC é€Ÿåº¦çš„ç®—æ³•ï¼Œè¿™æ ·æˆ‘ä»¬ä¾¿å¯ä»¥ï¼Œåœ¨æœåŠ¡é«˜å³°æœŸçš„æ—¶å€™é™ä½ GC é€Ÿåº¦æ¥æä¾›æ›´é«˜çš„æœåŠ¡è´¨é‡ï¼›åœ¨æœåŠ¡ä½å³°æœŸçš„æ—¶å€™æé«˜ GC é€Ÿåº¦æ¥åŠ å¿«ç©ºé—´çš„å›æ”¶ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;å¢åŠ ç”¨äºåˆ¤æ–­ key æ˜¯å¦å­˜åœ¨çš„ API&lt;/b&gt;&lt;/p&gt;&lt;p&gt;TiKV åœ¨æŸäº›åœºæ™¯ä¸‹ä»…éœ€è¦åˆ¤æ–­æŸä¸ª key æ˜¯å¦å­˜åœ¨ï¼Œè€Œä¸éœ€è¦è¯»å–å¯¹åº”çš„ valueã€‚é€šè¿‡æä¾›ä¸€ä¸ªè¿™æ ·çš„ API å¯ä»¥æå¤§åœ°æé«˜æ€§èƒ½ï¼Œå› ä¸ºæˆ‘ä»¬å·²ç»çœ‹åˆ°å°† value ç§»å‡º &lt;code&gt;LSM-tree&lt;/code&gt; ä¹‹åï¼Œ&lt;code&gt;LSM-tree&lt;/code&gt; æœ¬èº«ä¼šå˜çš„éå¸¸å°ï¼Œä»¥è‡³äºæˆ‘ä»¬å¯ä»¥å°†æ›´å¤šåœ° &lt;code&gt;index&lt;/code&gt;ã€&lt;code&gt;filter&lt;/code&gt; å’Œ &lt;code&gt;DataBlock&lt;/code&gt; å­˜æ”¾åˆ°å†…å­˜å½“ä¸­å»ï¼Œè¿™æ ·å»æ£€ç´¢æŸä¸ª key çš„æ—¶å€™å¯ä»¥åšåˆ°åªéœ€è¦å°‘é‡ç”šè‡³ä¸éœ€è¦ IO ã€‚&lt;/p&gt;&lt;p&gt;&lt;i&gt;&lt;b&gt;æ›´å¤šé˜…è¯»ï¼š&lt;/b&gt;&lt;/i&gt;&lt;/p&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//pingcap.com/blog-cn/&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic2.zhimg.com/v2-60ab5bd867c2434d70c957a02a2169e1_ipico.jpg&quot; data-image-width=&quot;1200&quot; data-image-height=&quot;1200&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;åšå®¢&lt;/a&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>ZoeyZhai</author>
<guid isPermaLink="false">2019-01-29-55521489</guid>
<pubDate>Tue, 29 Jan 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>TiKV æºç è§£æç³»åˆ—æ–‡ç« ï¼ˆä¸€ï¼‰åº</title>
<link>https://henix.github.io/feeds/zhuanlan.newsql/2019-01-28-55903728.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/55903728&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-45344636130df31b6603635f27d9b9c1_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;ä½œè€…ï¼šå”åˆ˜&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/tikv/tikv&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TiKV&lt;/a&gt; æ˜¯ä¸€ä¸ªæ”¯æŒäº‹åŠ¡çš„åˆ†å¸ƒå¼ Key-Value æ•°æ®åº“ï¼Œæœ‰å¾ˆå¤šç¤¾åŒºå¼€å‘è€…åŸºäº TiKV æ¥å¼€å‘è‡ªå·±çš„åº”ç”¨ï¼Œè­¬å¦‚ &lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/meitu/titan&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;titan&lt;/a&gt;ã€&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/yongman/tidis&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;tidis&lt;/a&gt;ã€‚å°¤å…¶æ˜¯åœ¨ TiKV æˆä¸º &lt;a href=&quot;http://link.zhihu.com/?target=https%3A//www.cncf.io/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;CNCF&lt;/a&gt; çš„ &lt;a href=&quot;http://link.zhihu.com/?target=https%3A//www.cncf.io/blog/2018/08/28/cncf-to-host-tikv-in-the-sandbox/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Sandbox&lt;/a&gt; é¡¹ç›®ä¹‹åï¼Œå¸å¼•äº†è¶Šæ¥è¶Šå¤šå¼€å‘è€…çš„ç›®å…‰ï¼Œå¾ˆå¤šåŒå­¦éƒ½æƒ³å‚ä¸åˆ° TiKV çš„ç ”å‘ä¸­æ¥ã€‚è¿™æ—¶å€™ï¼Œå°±ä¼šé‡åˆ°ä¸¤ä¸ªæ¯”è¾ƒå¤§çš„æ‹¦è·¯è™ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//www.rust-lang.org/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Rust&lt;/a&gt; è¯­è¨€ï¼šä¼—æ‰€å‘¨çŸ¥ï¼ŒTiKV æ˜¯ä½¿ç”¨ Rust è¯­è¨€æ¥è¿›è¡Œå¼€å‘çš„ï¼Œè€Œ Rust è¯­è¨€çš„å­¦ä¹ éš¾åº¦ç›¸å¯¹è¾ƒé«˜ï¼Œæœ‰äº›äººè®¤ä¸ºå…¶å­¦ä¹ æ›²çº¿å¤§äº C++ï¼Œæ‰€ä»¥å¾ˆå¤šåŒå­¦åœ¨è¿™ä¸€æ­¥å°±ç›´æ¥æ”¾å¼ƒäº†ã€‚&lt;/li&gt;&lt;li&gt;æ–‡æ¡£ï¼šæœ€å¼€å§‹ TiKV æ˜¯ä½œä¸º HTAP æ•°æ®åº“ &lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/pingcap/tidb&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TiDB&lt;/a&gt; çš„ä¸€ä¸ªåº•å±‚å­˜å‚¨å¼•æ“è®¾è®¡å¹¶å¼€å‘å‡ºæ¥çš„ï¼Œå±äºå†…éƒ¨ç³»ç»Ÿï¼Œç¼ºä¹è¯¦ç»†çš„æ–‡æ¡£ï¼Œä»¥è‡³äºåŒå­¦ä»¬ä¸çŸ¥é“ TiKV æ˜¯æ€ä¹ˆè®¾è®¡çš„ï¼Œä»¥åŠä»£ç ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆå†™ã€‚&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;å¯¹äºç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å†…éƒ¨æ­£åœ¨åˆ¶ä½œä¸€ç³»åˆ—çš„ Rust åŸ¹è®­è¯¾ç¨‹ï¼Œç”± Rust ä½œè€…ä»¥åŠ Rust ç¤¾åŒºçŸ¥åçš„å¼€å‘è€…äº²è‡ªæ“åˆ€ï¼Œé¢„è®¡ä¼šåœ¨ä»Šå¹´ç¬¬ä¸€å­£åº¦å¯¹å¤–å‘å¸ƒã€‚å¸Œæœ›é€šè¿‡è¯¥è¯¾ç¨‹çš„å­¦ä¹ ï¼Œå¤§å®¶èƒ½å¿«é€Ÿå…¥é—¨ Rustï¼Œä½¿ç”¨ Rust å¼€å‘è‡ªå·±çš„åº”ç”¨ã€‚&lt;/p&gt;&lt;p&gt;è€Œå¯¹äºç¬¬äºŒä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬ä¼šå¯åŠ¨ ã€ŠTiKV æºç è§£æç³»åˆ—æ–‡ç« ã€‹ä»¥åŠ ã€ŠDeep Dive TiKV ç³»åˆ—æ–‡ç« ã€‹è®¡åˆ’ï¼Œåœ¨ã€ŠDeep Dive TiKV ç³»åˆ—æ–‡ç« ã€‹ä¸­ï¼Œæˆ‘ä»¬ä¼šè¯¦ç»†ä»‹ç»ä¸è§£é‡Š TiKV æ‰€ä½¿ç”¨æŠ€æœ¯çš„åŸºæœ¬åŸç†ï¼Œè­¬å¦‚ Raft åè®®çš„è¯´æ˜ï¼Œä»¥åŠæˆ‘ä»¬æ˜¯å¦‚ä½•å¯¹ Raft åšæ‰©å±•å’Œä¼˜åŒ–çš„ã€‚è€Œ ã€ŠTiKV æºç è§£æç³»åˆ—æ–‡ç« ã€‹åˆ™æ˜¯ä¼šä»æºç å±‚é¢ç»™å¤§å®¶æŠ½ä¸å‰¥èŒ§ï¼Œè®©å¤§å®¶çŸ¥é“æˆ‘ä»¬å†…éƒ¨åˆ°åº•æ˜¯å¦‚ä½•å®ç°çš„ã€‚æˆ‘ä»¬å¸Œæœ›ï¼Œé€šè¿‡è¿™ä¸¤ä¸ªç³»åˆ—ï¼Œèƒ½è®©å¤§å®¶å¯¹ TiKV æœ‰æ›´æ·±åˆ»çš„ç†è§£ï¼Œå†åŠ ä¸Š Rust åŸ¹è®­ï¼Œèƒ½è®©å¤§å®¶å¾ˆå¥½çš„å‚ä¸åˆ° TiKV çš„å¼€å‘ä¸­æ¥ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;ç»“æ„&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;æœ¬ç¯‡æ–‡ç« æ˜¯ã€ŠTiKV æºç è§£æç³»åˆ—æ–‡ç« ã€‹çš„åºç¯‡ï¼Œä¼šç®€å•çš„ç»™å¤§å®¶è®²ä¸€ä¸‹ TiKV çš„åŸºæœ¬æ¨¡å—ï¼Œè®©å¤§å®¶å¯¹è¿™ä¸ªç³»ç»Ÿæœ‰ä¸€ä¸ªæ•´ä½“çš„äº†è§£ã€‚&lt;/p&gt;&lt;p&gt;è¦ç†è§£ TiKVï¼Œåªæ˜¯äº†è§£ &lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/tikv/tikv&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;github.com/tikv/tikv&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;&lt;/span&gt;&lt;/a&gt; è¿™ä¸€ä¸ªé¡¹ç›®æ˜¯è¿œè¿œä¸å¤Ÿçš„ï¼Œé€šå¸¸ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦äº†è§£å¾ˆå¤šå…¶ä»–çš„é¡¹ç›®ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/pingcap/raft-rs&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;github.com/pingcap/raft&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;-rs&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/pingcap/rust-prometheus&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;github.com/pingcap/rust&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;-prometheus&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/pingcap/rust-rocksdb&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;github.com/pingcap/rust&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;-rocksdb&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/pingcap/fail-rs&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;github.com/pingcap/fail&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;-rs&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/pingcap/rocksdb&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;github.com/pingcap/rock&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;sdb&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/pingcap/grpc-rs&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;github.com/pingcap/grpc&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;-rs&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/pingcap/pd&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;github.com/pingcap/pd&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;åœ¨è¿™ä¸ªç³»åˆ—é‡Œé¢ï¼Œæˆ‘ä»¬é¦–å…ˆä¼šä» TiKV ä½¿ç”¨çš„å‘¨è¾¹åº“å¼€å§‹ä»‹ç»ï¼Œç„¶åä»‹ç» TiKVï¼Œæœ€åä¼šä»‹ç» &lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/pingcap/pd&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;PD&lt;/a&gt;ã€‚ä¸‹é¢ç®€å•æ¥è¯´ä¸‹æˆ‘ä»¬çš„ä¸€äº›ä»‹ç»è®¡åˆ’ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;Storage Engine&lt;/b&gt;&lt;/p&gt;&lt;p&gt;TiKV ç°åœ¨ä½¿ç”¨ &lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/facebook/rocksdb&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;RocksDB&lt;/a&gt; ä½œä¸ºåº•å±‚æ•°æ®å­˜å‚¨æ–¹æ¡ˆã€‚åœ¨ pingcap/rust-rocksdb è¿™ä¸ªåº“é‡Œé¢ï¼Œæˆ‘ä»¬ä¼šç®€å•è¯´æ˜ Rust æ˜¯å¦‚ä½•é€šè¿‡ Foreign Function Interface (FFI) æ¥è·Ÿ C library è¿›è¡Œäº¤äº’ï¼Œä»¥åŠæˆ‘ä»¬æ˜¯å¦‚ä½•å°† RocksDB çš„ C API å°è£…å¥½ç»™ Rust ä½¿ç”¨çš„ã€‚&lt;/p&gt;&lt;p&gt;å¦å¤–ï¼Œåœ¨ pingcap/rocksdb è¿™ä¸ªåº“é‡Œé¢ï¼Œæˆ‘ä»¬ä¼šè¯¦ç»†çš„ä»‹ç»æˆ‘ä»¬è‡ªå·±ç ”å‘çš„ Key-Value åˆ†ç¦»å¼•æ“ - &lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/pingcap/rocksdb/tree/titan-5.15&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Titan&lt;/a&gt;ï¼ŒåŒæ—¶ä¹Ÿä¼šè®©å¤§å®¶çŸ¥é“å¦‚ä½•ä½¿ç”¨ RocksDB å¯¹å¤–æä¾›çš„æ¥å£æ¥æ„å»ºè‡ªå·±çš„ engineã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;Raft&lt;/b&gt;&lt;/p&gt;&lt;p&gt;TiKV ä½¿ç”¨çš„æ˜¯ &lt;a href=&quot;http://link.zhihu.com/?target=https%3A//raft.github.io/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Raft&lt;/a&gt; ä¸€è‡´æ€§åè®®ã€‚ä¸ºäº†ä¿è¯ç®—æ³•çš„æ­£ç¡®æ€§ï¼Œæˆ‘ä»¬ç›´æ¥å°† &lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/etcd-io/etcd&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;etcd&lt;/a&gt; çš„ Go å®ç° port æˆäº† Rustã€‚åœ¨ pingcap/raft-rsï¼Œæˆ‘ä»¬ä¼šè¯¦ç»†ä»‹ç» Raft çš„é€‰ä¸¾ï¼ŒLog å¤åˆ¶ï¼Œsnapshot è¿™äº›åŸºæœ¬çš„åŠŸèƒ½æ˜¯å¦‚ä½•å®ç°çš„ã€‚&lt;/p&gt;&lt;p&gt;å¦å¤–ï¼Œæˆ‘ä»¬è¿˜ä¼šä»‹ç»å¯¹ Raft çš„ä¸€äº›ä¼˜åŒ–ï¼Œè­¬å¦‚ pre-voteï¼Œcheck quorum æœºåˆ¶ï¼Œbatch ä»¥åŠ pipelineã€‚&lt;/p&gt;&lt;p&gt;æœ€åï¼Œæˆ‘ä»¬ä¼šè¯´æ˜å¦‚ä½•å»ä½¿ç”¨è¿™ä¸ª Raft åº“ï¼Œè¿™æ ·å¤§å®¶å°±èƒ½åœ¨è‡ªå·±çš„åº”ç”¨é‡Œé¢é›†æˆ Raft äº†ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;gRPC&lt;/b&gt;&lt;/p&gt;&lt;p&gt;TiKV ä½¿ç”¨çš„æ˜¯ &lt;a href=&quot;http://link.zhihu.com/?target=https%3A//grpc.io/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;gRPC&lt;/a&gt; ä½œä¸ºé€šè®¯æ¡†æ¶ï¼Œæˆ‘ä»¬ç›´æ¥æŠŠ Google &lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/grpc/grpc&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;C gRPC&lt;/a&gt; åº“å°è£…åœ¨ grpc-rs è¿™ä¸ªåº“é‡Œé¢ã€‚æˆ‘ä»¬ä¼šè¯¦ç»†å‘Šè¯‰å¤§å®¶å¦‚ä½•å»å°è£…å’Œæ“ä½œ C gRPC åº“ï¼Œå¯åŠ¨ä¸€ä¸ª gRPC æœåŠ¡ã€‚&lt;/p&gt;&lt;p&gt;å¦å¤–ï¼Œæˆ‘ä»¬è¿˜ä¼šä»‹ç»å¦‚ä½•ä½¿ç”¨ Rust çš„ &lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/rust-lang-nursery/futures-rs&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;futures-rs&lt;/a&gt; æ¥å°†å¼‚æ­¥é€»è¾‘å˜æˆç±»ä¼¼åŒæ­¥çš„æ–¹å¼æ¥å¤„ç†ï¼Œä»¥åŠå¦‚ä½•é€šè¿‡è§£æ protobuf æ–‡ä»¶æ¥ç”Ÿæˆå¯¹åº”çš„ API ä»£ç ã€‚&lt;/p&gt;&lt;p&gt;æœ€åï¼Œæˆ‘ä»¬ä¼šä»‹ç»å¦‚ä½•åŸºäºè¯¥åº“æ„å»ºä¸€ä¸ªç®€å•çš„ gRPC æœåŠ¡ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;Prometheus&lt;/b&gt;&lt;/p&gt;&lt;p&gt;TiKV ä½¿ç”¨ &lt;a href=&quot;http://link.zhihu.com/?target=https%3A//prometheus.io/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Prometheus&lt;/a&gt; ä½œä¸ºå…¶ç›‘æ§ç³»ç»Ÿï¼Œ &lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/pingcap/rust-prometheus&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;rust-prometheus&lt;/a&gt; è¿™ä¸ªåº“æ˜¯ Prometheus çš„ Rust clientã€‚åœ¨è¿™ä¸ªåº“é‡Œé¢ï¼Œæˆ‘ä»¬ä¼šä»‹ç»å¦‚æœæ”¯æŒä¸åŒçš„ Prometheus çš„æ•°æ®ç±»å‹ï¼ˆCoutnerï¼ŒGaugeï¼ŒHistorgramï¼‰ã€‚&lt;/p&gt;&lt;p&gt;å¦å¤–ï¼Œæˆ‘ä»¬ä¼šé‡ç‚¹ä»‹ç»æˆ‘ä»¬æ˜¯å¦‚ä½•é€šè¿‡ä½¿ç”¨ Rust çš„ Macro æ¥æ”¯æŒ Prometheus çš„ Vector metrics çš„ã€‚&lt;/p&gt;&lt;p&gt;æœ€åï¼Œæˆ‘ä»¬ä¼šä»‹ç»å¦‚ä½•åœ¨è‡ªå·±çš„é¡¹ç›®é‡Œé¢é›†æˆ Prometheus clientï¼Œå°†è‡ªå·±çš„ metrics å­˜åˆ° Prometheus é‡Œé¢ï¼Œæ–¹ä¾¿åç»­åˆ†æã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;Fail&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/pingcap/fail-rs&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Fail&lt;/a&gt; æ˜¯ä¸€ä¸ªé”™è¯¯æ³¨å…¥çš„åº“ã€‚é€šè¿‡è¿™ä¸ªåº“ï¼Œæˆ‘ä»¬èƒ½å¾ˆæ–¹ä¾¿çš„åœ¨ä»£ç çš„æŸäº›åœ°æ–¹åŠ ä¸Š hookï¼Œæ³¨å…¥é”™è¯¯ï¼Œç„¶ååœ¨ç³»ç»Ÿè¿è¡Œçš„æ—¶å€™è§¦å‘ç›¸å…³çš„é”™è¯¯ï¼Œçœ‹ç³»ç»Ÿæ˜¯å¦ç¨³å®šã€‚&lt;/p&gt;&lt;p&gt;æˆ‘ä»¬ä¼šè¯¦ç»†çš„ä»‹ç» Fail æ˜¯å¦‚ä½•é€šè¿‡ macro æ¥æ³¨å…¥é”™è¯¯ï¼Œä¼šå‘Šè¯‰å¤§å®¶å¦‚ä½•æ·»åŠ è‡ªå·±çš„ hookï¼Œä»¥åŠåœ¨å¤–é¢è¿›è¡Œè§¦å‘&lt;/p&gt;&lt;p&gt;&lt;b&gt;TiKV&lt;/b&gt;&lt;/p&gt;&lt;p&gt;TiKV æ˜¯ä¸€ä¸ªéå¸¸å¤æ‚çš„ç³»ç»Ÿï¼Œè¿™å—æˆ‘ä»¬ä¼šé‡ç‚¹ä»‹ç»ï¼Œä¸»è¦åŒ…æ‹¬ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Raftstoreï¼Œè¯¥æ¨¡å—é‡Œé¢æˆ‘ä»¬ä¼šä»‹ç» TiKV å¦‚ä½•ä½¿ç”¨ Raftï¼Œå¦‚ä½•æ”¯æŒ Multi-Raftã€‚&lt;/li&gt;&lt;li&gt;Storageï¼Œè¯¥æ¨¡å—é‡Œé¢æˆ‘ä»¬ä¼šä»‹ç» Multiversion concurrency control (MVCC)ï¼ŒåŸºäº &lt;a href=&quot;http://link.zhihu.com/?target=https%3A//storage.googleapis.com/pub-tools-public-publication-data/pdf/36726.pdf&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Percolator&lt;/a&gt; çš„åˆ†å¸ƒå¼äº‹åŠ¡çš„å®ç°ï¼Œæ•°æ®åœ¨ engine é‡Œé¢çš„å­˜å‚¨æ–¹å¼ï¼Œengine æ“ä½œç›¸å…³çš„ API ç­‰ã€‚&lt;/li&gt;&lt;li&gt;Serverï¼Œè¯¥æ¨¡å—æˆ‘ä»¬ä¼šä»‹ç» TiKV çš„ gRPC APIï¼Œä»¥åŠä¸åŒå‡½æ•°æ‰§è¡Œæµç¨‹ã€‚&lt;/li&gt;&lt;li&gt;Coprocessorï¼Œè¯¥æ¨¡å—æˆ‘ä»¬ä¼šè¯¦ç»†ä»‹ç» TiKV æ˜¯å¦‚ä½•å¤„ç† TiDB çš„ä¸‹æ¨è¯·æ±‚çš„ï¼Œå¦‚ä½•é€šè¿‡ä¸åŒçš„è¡¨è¾¾å¼è¿›è¡Œæ•°æ®è¯»å–ä»¥åŠè®¡ç®—çš„ã€‚&lt;/li&gt;&lt;li&gt;PDï¼Œè¯¥æ¨¡å—æˆ‘ä»¬ä¼šä»‹ç» TiKV æ˜¯å¦‚ä½•è·Ÿ PD è¿›è¡Œäº¤äº’çš„ã€‚&lt;/li&gt;&lt;li&gt;Importï¼Œè¯¥æ¨¡å—æˆ‘ä»¬ä¼šä»‹ç» TiKV å¦‚ä½•å¤„ç†å¤§é‡æ•°æ®çš„å¯¼å…¥ï¼Œä»¥åŠå¦‚ä½•è·Ÿ TiDB æ•°æ®å¯¼å…¥å·¥å…· &lt;a href=&quot;http://link.zhihu.com/?target=https%3A//www.pingcap.com/docs/tools/lightning/overview-architecture/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;lightning&lt;/a&gt; äº¤äº’çš„ã€‚&lt;/li&gt;&lt;li&gt;Utilï¼Œè¯¥æ¨¡å—æˆ‘ä»¬ä¼šä»‹ç»ä¸€äº› TiKV ä½¿ç”¨çš„åŸºæœ¬åŠŸèƒ½åº“ã€‚&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;b&gt;PD&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/pingcap/pd&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;PD&lt;/a&gt; ç”¨æ¥è´Ÿè´£æ•´ä¸ª TiKV çš„è°ƒåº¦ï¼Œæˆ‘ä»¬ä¼šè¯¦ç»†çš„ä»‹ç» PD å†…éƒ¨æ˜¯å¦‚ä½•ä½¿ç”¨ etcd æ¥è¿›è¡Œå…ƒæ•°æ®å­˜å–å’Œé«˜å¯ç”¨æ”¯æŒï¼Œä¹Ÿä¼šä»‹ç» PD å¦‚ä½•è·Ÿ TiKV äº¤äº’ï¼Œå¦‚ä½•ç”Ÿæˆå…¨å±€çš„ ID ä»¥åŠ timestampã€‚&lt;/p&gt;&lt;p&gt;æœ€åï¼Œæˆ‘ä»¬ä¼šè¯¦ç»†çš„ä»‹ç» PD æä¾›çš„ schedulerï¼Œä»¥åŠä¸åŒçš„ scheudler æ‰€è´Ÿè´£çš„äº‹æƒ…ï¼Œè®©å¤§å®¶èƒ½é€šè¿‡é…ç½® scheduler æ¥è®©ç³»ç»Ÿæ›´åŠ çš„ç¨³å®šã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;å°ç»“&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;ä¸Šé¢ç®€å•çš„ä»‹ç»äº†æºç è§£ææ¶‰åŠçš„æ¨¡å—ï¼Œè¿˜æœ‰ä¸€äº›æ¨¡å—è­¬å¦‚ &lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/tikv/client-rust&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;github.com/tikv/client-&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;rust&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt; ä»åœ¨å¼€å‘ä¸­ï¼Œç­‰å®Œæˆä¹‹åæˆ‘ä»¬ä¹Ÿä¼šè¿›è¡Œæºç è§£æã€‚&lt;/p&gt;&lt;p&gt;æˆ‘ä»¬å¸Œæœ›é€šè¿‡è¯¥æºç è§£æç³»åˆ—ï¼Œèƒ½è®©å¤§å®¶å¯¹ TiKV æœ‰ä¸€ä¸ªæ›´æ·±åˆ»çš„ç†è§£ã€‚å½“ç„¶ï¼ŒTiKV çš„æºç ä¹Ÿæ˜¯ä¸€ç›´åœ¨ä¸åœçš„æ¼”åŒ–ï¼Œæˆ‘ä»¬ä¹Ÿä¼šå°½é‡ä¿è¯æ–‡æ¡£çš„åŠæ—¶æ›´æ–°ã€‚&lt;/p&gt;&lt;p&gt;æœ€åï¼Œæ¬¢è¿å¤§å®¶å‚ä¸ TiKV çš„å¼€å‘ã€‚&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;i&gt;&lt;b&gt;æ›´å¤šé˜…è¯»ï¼š&lt;/b&gt;&lt;/i&gt;&lt;/p&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//pingcap.com/blog-cn/&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic2.zhimg.com/v2-60ab5bd867c2434d70c957a02a2169e1_ipico.jpg&quot; data-image-width=&quot;1200&quot; data-image-height=&quot;1200&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;åšå®¢&lt;/a&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>ZoeyZhai</author>
<guid isPermaLink="false">2019-01-28-55903728</guid>
<pubDate>Mon, 28 Jan 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>åˆ˜å¥‡ï¼šæˆ‘ä»¬æœ€å–œæ¬¢å¬ç”¨æˆ·è¯´çš„è¯æ˜¯ã€Œä½ ä»¬æå¾—å®šå—ï¼Ÿã€ | TiDB DevCon 2019</title>
<link>https://henix.github.io/feeds/zhuanlan.newsql/2019-01-25-55728943.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/55728943&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-28382092f2192a8a933108bcc8a73c23_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;blockquote&gt;1 æœˆ 19 æ—¥ &lt;b&gt;TiDB DevCon 2019&lt;/b&gt; åœ¨åŒ—äº¬åœ†æ»¡è½å¹•ï¼Œ&lt;b&gt;è¶…è¿‡ 750 ä½&lt;/b&gt;çƒ­æƒ…çš„ç¤¾åŒºä¼™ä¼´å‚åŠ äº†æ­¤æ¬¡å¤§ä¼šã€‚åœ¨æœ¬æ¬¡å¤§ä¼šä¸Šï¼Œæˆ‘ä»¬é¦–æ¬¡å…¨é¢å±•ç¤ºäº†å…¨æ–°å­˜å‚¨å¼•æ“ Titanã€æ–°ç”Ÿæ€å·¥å…· TiFlash ä»¥åŠ TiDB åœ¨äº‘ä¸Šçš„è¿›å±•ï¼ŒåŒæ—¶å®£å¸ƒ TiDB-Lightning Toolset &amp;amp; TiDB-DM ä¸¤å¤§ç”Ÿæ€å·¥å…·å¼€æºï¼Œå¹¶åˆ†äº«äº†  TiDB 3.0 çš„ç‰¹æ€§ä¸æœªæ¥è§„åˆ’ï¼Œæè¿°äº†æˆ‘ä»¬çœ¼ä¸­æœªæ¥æ•°æ®åº“çš„æ¨¡æ ·ã€‚&lt;br&gt;æ­¤å¤–ï¼Œæ›´æœ‰ &lt;b&gt;11 ä½&lt;/b&gt;æ¥è‡ªä¸€çº¿çš„ TiDB ç”¨æˆ·ä¸ºå¤§å®¶åˆ†äº«äº†å®è·µç»éªŒä¸è¸©è¿‡çš„ã€Œå‘ã€ï¼Œè·å¾—äº†ç°åœºè§‚ä¼—çš„é˜µé˜µæŒå£°ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿä¸ºæ–°æ™‹ TiDB Committer æˆäºˆäº†è¯ä¹¦ï¼Œå¹¶ä¸º 2018 å¹´æœ€ä½³ç¤¾åŒºè´¡çŒ®ä¸ªäººã€æœ€ä½³ç¤¾åŒºè´¡çŒ®å›¢é˜Ÿé¢å‘äº†è£èª‰å¥–æ¯ã€‚&lt;br&gt;æˆ‘ä»¬å°†æŒ‘é€‰éƒ¨åˆ†ç²¾å½©å®å½•åˆ†äº«ç»™å¤§å®¶ï¼Œæ•¬è¯·æœŸå¾…å“¦ï½&lt;/blockquote&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-be16a754f66708ffcf2d99eff6b6d586_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1920&quot; data-rawheight=&quot;1280&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1920&quot; data-original=&quot;https://pic3.zhimg.com/v2-be16a754f66708ffcf2d99eff6b6d586_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-be16a754f66708ffcf2d99eff6b6d586_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1920&quot; data-rawheight=&quot;1280&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1920&quot; data-original=&quot;https://pic3.zhimg.com/v2-be16a754f66708ffcf2d99eff6b6d586_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-be16a754f66708ffcf2d99eff6b6d586_b.jpg&quot;&gt;&lt;/figure&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-3b56b71eae061d20cf43f10b381b9db7_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;2000&quot; data-rawheight=&quot;1500&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;2000&quot; data-original=&quot;https://pic4.zhimg.com/v2-3b56b71eae061d20cf43f10b381b9db7_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-3b56b71eae061d20cf43f10b381b9db7_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;2000&quot; data-rawheight=&quot;1500&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;2000&quot; data-original=&quot;https://pic4.zhimg.com/v2-3b56b71eae061d20cf43f10b381b9db7_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-3b56b71eae061d20cf43f10b381b9db7_b.jpg&quot;&gt;&lt;/figure&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-5e2723a6626816bff697648396b4f3d7_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1620&quot; data-rawheight=&quot;1080&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1620&quot; data-original=&quot;https://pic4.zhimg.com/v2-5e2723a6626816bff697648396b4f3d7_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-5e2723a6626816bff697648396b4f3d7_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1620&quot; data-rawheight=&quot;1080&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1620&quot; data-original=&quot;https://pic4.zhimg.com/v2-5e2723a6626816bff697648396b4f3d7_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-5e2723a6626816bff697648396b4f3d7_b.jpg&quot;&gt;&lt;figcaption&gt;å¼€åœºå‰ååˆ†é’Ÿï¼Œåœºå†…åº§ä½å…¨éƒ¨åæ»¡&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;ä»¥ä¸‹ä¸ºæˆ‘å¸ CEO åˆ˜å¥‡åœ¨ TiDB DevCon 2019 ä¸Šçš„ Opening Keynote å®å½•ã€‚&lt;/b&gt;&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-916bc91a394589cc09b1620bda54aff4_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1920&quot; data-rawheight=&quot;1280&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1920&quot; data-original=&quot;https://pic1.zhimg.com/v2-916bc91a394589cc09b1620bda54aff4_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-916bc91a394589cc09b1620bda54aff4_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1920&quot; data-rawheight=&quot;1280&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1920&quot; data-original=&quot;https://pic1.zhimg.com/v2-916bc91a394589cc09b1620bda54aff4_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-916bc91a394589cc09b1620bda54aff4_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;é¦–å…ˆæˆ‘æƒ³ç‰¹åˆ«æ„Ÿè°¢æ¯ä¸€ä½æ¥å‚åŠ  TiDB DevCon 2019 çš„ Contributor å’Œç”¨æˆ·ï¼Œè¿˜æœ‰å¯¹ TiDB ä¿æŒå¥½å¥‡çš„äººã€‚ä»Šå¤©æˆ‘ä¸»è¦æƒ³è·Ÿå¤§å®¶åˆ†äº«ä¸€ä¸‹æˆ‘ä»¬è¿‡å»ä¸€å¹´çš„ä¸€äº›å‘å±•æƒ…å†µï¼Œä»¥åŠæˆ‘ä»¬å¯¹äºæœªæ¥çš„ä¸€äº›æƒ³æ³•ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;Growth&lt;/b&gt;&lt;/h2&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-562624cde1e3bf8264ad479447a87f09_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;375&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic2.zhimg.com/v2-562624cde1e3bf8264ad479447a87f09_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-562624cde1e3bf8264ad479447a87f09_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;375&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic2.zhimg.com/v2-562624cde1e3bf8264ad479447a87f09_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-562624cde1e3bf8264ad479447a87f09_b.jpg&quot;&gt;&lt;figcaption&gt;å›¾ 1 &lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;ä»å›¾ 1 å¤§å®¶å¯ä»¥å¾ˆæ¸…æ¥šçš„çœ‹åˆ° TiDB åœ¨è¿‡å»ä¸€å¹´çš„å¢é•¿ã€‚å¦‚æœå¤§å®¶å»å¯¹æ¯”ä¸€ä¸‹ TiDB å¢é•¿æ›²çº¿å’Œå…¶ä»–åŒç±»äº§å“ã€æˆ–è€…æ˜¯ä¸Šä¸€ä»£ NoSQL äº§å“çš„å¢é•¿æ›²çº¿ä¼šå‘ç°ï¼ŒTiDB æ˜¯é¥é¥é¢†å…ˆçš„ã€‚çœ‹å®Œæˆ‘ä»¬çš„ Contributor å¢é•¿å’Œæˆ‘ä»¬åœ¨ GitHub ä¸Šé¢çš„å„ç§çŠ¶æ€ï¼Œåœ¨è¿™é‡Œä¹Ÿç‰¹åˆ«æ„Ÿè°¢æˆ‘ä»¬æ‰€æœ‰çš„é‚£äº›æ­£åœ¨ä½¿ç”¨ TiDB çš„ç”¨æˆ·ã€‚&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-5d0e398e9ae2f002b0847ebfd6149315_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;372&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic2.zhimg.com/v2-5d0e398e9ae2f002b0847ebfd6149315_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-5d0e398e9ae2f002b0847ebfd6149315_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;372&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic2.zhimg.com/v2-5d0e398e9ae2f002b0847ebfd6149315_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-5d0e398e9ae2f002b0847ebfd6149315_b.jpg&quot;&gt;&lt;figcaption&gt;å›¾ 2&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;å›¾ 2 æ˜¯è¿‡å»ä¸€å¹´ï¼Œæˆ‘ä»¬ç”¨æˆ·è‡ªå·±å»åˆ†äº«è‡ªå·±ä½¿ç”¨ TiDB çš„ä¸€äº›ç»éªŒã€‚æˆ‘è®°å¾—æˆ‘ä»¬åœ¨ç­¹åŠè¿™ä¸ªä¼šçš„æ—¶å€™ï¼Œæˆ‘è¯´æˆ‘æœ‰ç‰¹åˆ«å¤šæƒ³è®²çš„ä¸œè¥¿ï¼Œæå¿ƒçªå­çš„è¯ç‰¹åˆ«å¤šï¼Œèƒ½ä¸èƒ½è®©æˆ‘å¤šè®²è®²ã€‚æˆ‘ä»¬å¸‚åœºçš„åŒå­¦ä¸å¤ªåŒæ„ï¼Œè¯´æˆ‘ä»¬åªæœ‰ä¸€å¤©æ—¶é—´ï¼Œæˆ‘ä»¬åº”è¯¥æŠŠæ›´å¤šçš„æ—¶é—´äº¤ç»™æˆ‘ä»¬ç”¨æˆ·ï¼Œè®©ä»–ä»¬æ¥åˆ†äº«ä»–ä»¬è‡ªå·±çš„ç»éªŒï¼Œäº¤ç»™åœ¨ä¸€çº¿çš„åŒå­¦ã€‚å¤§å®¶å¦‚æœç‰¹åˆ«æœ‰å…´è¶£çš„è¯ï¼Œå¯ä»¥å»ç¿»ä¸€ç¿»æˆ‘ä»¬ç”¨æˆ·ä½¿ç”¨ TiDB çš„ä¸€äº›ç»éªŒï¼ˆ&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//pingcap.com/cases-cn/&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;pingcap.com/cases-cn/&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;&lt;/span&gt;&lt;/a&gt;ï¼‰ï¼Œé‡Œé¢æœ‰ä¸€äº›ä»–ä»¬çš„è¸©å‘ç»éªŒï¼Œä¹Ÿæœ‰ä¸€äº›ä»–ä»¬æ¯”è¾ƒæ¬£æ…°çš„ç‚¹ï¼Œè¿˜æœ‰ä¸€äº›ç”¨æˆ·åæ§½çš„ä¸œè¥¿ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ 2018 å¹´å¹´åº•çš„æ—¶å€™ï¼Œæäº†ä¸€æ¬¡åæ§½å¤§ä¼šï¼Œè¯·å‡ ä¸ªç”¨æˆ·è¿‡å»ç–¯ç‹‚åæ§½ä¸€ä¸‹æˆ‘ä»¬çš„äº§å“ã€‚æˆ‘ä»¬å®šäº†å‡ ä¸ªåŸåˆ™ï¼Œæ¯”å¦‚ï¼Œåªå…è®¸è¯´ç¼ºç‚¹ï¼Œä¸å…è®¸è¯´ä¼˜ç‚¹ã€‚&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-334d3d76c42b5dae0e2b696c37a5cf12_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;372&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic3.zhimg.com/v2-334d3d76c42b5dae0e2b696c37a5cf12_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-334d3d76c42b5dae0e2b696c37a5cf12_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;372&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic3.zhimg.com/v2-334d3d76c42b5dae0e2b696c37a5cf12_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-334d3d76c42b5dae0e2b696c37a5cf12_b.jpg&quot;&gt;&lt;figcaption&gt;å›¾ 3 &lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;è¿™æ˜¯æµ·å¤–çš„ä¸€äº›åª’ä½“å¯¹æˆ‘ä»¬çš„æŠ¥é“ï¼ˆå›¾ 3ï¼‰ï¼Œå¤§å®¶å¯èƒ½ä¹ŸçŸ¥é“ï¼Œæˆ‘ä»¬å»å¹´æ‹¿äº† InfoWorld è¯„é€‰çš„ Bossie Awards æœ€ä½³å¼€æºè½¯ä»¶å¥–ï¼Œæ¥ä¸‹æ¥çš„åˆ†äº« Morgan ä¼šä»‹ç»æˆ‘ä»¬åœ¨æµ·å¤–çš„ä¸€äº›å‘å±•æƒ…å†µå’Œæˆ‘ä»¬çš„æµ·å¤–å›¢é˜Ÿã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;HTAP Rocks!&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;åœ¨è¿‡å»ä¸€å¹´ï¼Œæˆ‘ä»¬æœ€å–œæ¬¢å¬ç”¨æˆ·è®²çš„ä¸€å¥è¯æ˜¯ä»€ä¹ˆï¼Ÿ&lt;b&gt;æˆ‘ä»¬æœ€å–œæ¬¢å¬çš„ä¸€å¥è¯æ˜¯ï¼šä½ ä»¬æå¾—å®šå—ï¼Ÿ&lt;/b&gt;æˆ‘è§‰å¾—è¿™å¥è¯å¤ªå¥½äº†ï¼Œå¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬çªç„¶ä¼šå»è·Ÿç”¨æˆ·å»è®²ï¼Œä½ è¿™æ˜¯ OLAPï¼Œä½ è¿™æ˜¯ OLTPã€‚å…¶å®ç”¨æˆ·å…³å¿ƒçš„æ˜¯ï¼Œä½ èƒ½ä¸èƒ½æå®šæˆ‘çš„é—®é¢˜ï¼Œè€Œä¸æ˜¯è¯´ä½ è¿‡æ¥æ´¾äº†ä¸€å †ä¸“å®¶ï¼Œå‘Šè¯‰æˆ‘è¯¥æ€ä¹ˆå¹²ã€‚&lt;/p&gt;&lt;p&gt;åœ¨è¿‡å»ä¸€å¹´é‡Œï¼Œç”¨æˆ·åœ¨ç”¨ TiDB çš„è¿‡ç¨‹ä¸­ï¼Œä¹Ÿä¼šé‡åˆ°å¾ˆå¤šçš„é—®é¢˜ã€‚æ¯”å¦‚è¯´ï¼ŒOLTP å’Œ OLAP çš„éš”ç¦»æ€ä¹ˆå»åšã€‚&lt;b&gt;æ‰€ä»¥æˆ‘ä»¬åœ¨ä»Šå¹´å¯ç”¨äº†ä¸€ä¸ªå…¨æ–°çš„ Designï¼Œåœ¨è¿™ä¸ª Design é‡Œé¢æ˜¯å½»åº•åœ°éš”ç¦» OLAP å’Œ OLTP çš„ Workloadã€‚&lt;/b&gt;&lt;/p&gt;&lt;p&gt;æˆ‘ä»¬æ›¾ç»è§åˆ°å¾ˆå¤šäº‰è®ºï¼Œä¹Ÿè§åˆ°å¾ˆå¤šè®ºæ–‡ï¼Œè¯´åˆ°åº•æ˜¯è¡Œå­˜å¥½ï¼Œè¿˜æ˜¯åˆ—å­˜å¥½ã€‚å¦‚æœå¤§å®¶å»çœ‹çŸ¥ä¹çš„è¯ï¼Œè¿™ä¸ªè®¨è®ºç°åœ¨è¿˜æ²¡æœ‰ä¼‘æ­¢ï¼šåˆ°åº•æ•°æ®åº“æ˜¯åº”è¯¥ä½¿ç”¨è¡Œå­˜è¿˜æ˜¯ä½¿ç”¨åˆ—å­˜ã€‚è€Œåœ¨æˆ‘ä»¬ç°åœ¨çš„ Design é‡Œé¢ï¼Œæˆ‘ä»¬ä¼šæç½®è¿™ä¸ªäº‰è®®â€”â€”ä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸èƒ½éƒ½æœ‰ï¼Ÿ&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-8fc533e31fab5dd7221912a7dfa451d5_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;372&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic2.zhimg.com/v2-8fc533e31fab5dd7221912a7dfa451d5_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-8fc533e31fab5dd7221912a7dfa451d5_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;372&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic2.zhimg.com/v2-8fc533e31fab5dd7221912a7dfa451d5_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-8fc533e31fab5dd7221912a7dfa451d5_b.jpg&quot;&gt;&lt;figcaption&gt;å›¾ 4 &lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;å¤§å®¶æƒ³ä¸€æƒ³ï¼Œåœ¨å¤šå°‘å¹´å‰ï¼Œæˆ‘ä»¬å®¶é‡Œé¢è¿˜æœ‰å›ºå®šç”µè¯ï¼Œæˆ‘ä»¬è¿˜åœ¨çœ‹çº¸è´¨ä¹¦ï¼Œæˆ‘ä»¬å¬æ­Œç”¨ MP3ï¼Œæˆ‘ä»¬å¯èƒ½æƒ³çœ‹ä¸€ä¸‹è‡ªå·±ä»Šå¤©è·‘äº†å¤šå°‘æ­¥ï¼Œè¿˜å¾—ç”¨ä¸€ä¸ªä¸“é—¨çš„ç¡¬ä»¶æˆ–è€…è¿åŠ¨è®¾å¤‡ã€‚ä½†æ˜¯åˆ°ä»Šå¤©ï¼Œä¸€éƒ¨æ‰‹æœºå°±æå®šè¿™ä¸€åˆ‡ã€‚&lt;/p&gt;&lt;p&gt;åœ¨ä¹‹å‰ï¼Œæˆ‘ä»¬å¯èƒ½çº¿ä¸Šéœ€è¦ç”¨ MySQLï¼Œæˆ–è€…ç”¨ PGï¼Œä¸­é—´æˆ‘ä»¬å¯èƒ½éœ€è¦ç”¨æ¶ˆæ¯é˜Ÿåˆ—ï¼Œå»æŠŠ binlog æˆ–è€… change feeds éƒ½ç»™å¼„å‡ºæ¥ï¼Œç„¶åå†å¼„åˆ°ä¸€ä¸ª Data ware house é‡Œé¢ï¼Œåœ¨ Data ware house é‡Œé¢å»  Runã€‚æœ€ç»ˆæˆ‘ä»¬ä¸§å¤±äº†å®æ—¶æ€§ï¼Œæˆ‘ä»¬ä¸§å¤±äº†ä¸€è‡´æ€§ã€‚ä½†æ˜¯å¦‚æœæˆ‘ä»¬é‡æ–°å»æƒ³ä¸€ä¸‹è¿™ä¸ªäº‹æƒ…ï¼Œè¿™äº‹å„¿å°±åƒå½“åˆçš„æ‰‹æœºå’Œ MP3ã€çº¸è´¨ä¹¦ä¸€æ ·çš„ã€‚&lt;b&gt;åˆ°ä»Šå¤©æŠ€æœ¯è¿›æ­¥åˆ°ä¸€å®šç¨‹åº¦çš„æ—¶å€™ï¼Œä¸ºä»€ä¹ˆæˆ‘ä¸èƒ½ OLTP/OLAP All in one ï¼Œæˆ‘åªæ˜¯ä¸€ä¸ªæ™®é€šçš„ç”¨æˆ·ï¼Œæˆ‘ä¸æƒ³æ¥å—é‚£ä¹ˆä¸€å †ä¸œè¥¿ï¼ŒåŒæ—¶æˆ‘è¦å®æ—¶æ€§ï¼Œæˆ‘ç°åœ¨è¦çš„ï¼Œé©¬ä¸Šå°±è¦ã€‚&lt;/b&gt;&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-77ed7f259a529b5dfc39a329e5e84c57_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;372&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic4.zhimg.com/v2-77ed7f259a529b5dfc39a329e5e84c57_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-77ed7f259a529b5dfc39a329e5e84c57_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;372&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic4.zhimg.com/v2-77ed7f259a529b5dfc39a329e5e84c57_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-77ed7f259a529b5dfc39a329e5e84c57_b.jpg&quot;&gt;&lt;figcaption&gt;å›¾ 5&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;å½“ç„¶å¤§çš„æ°›å›´ä¸‹é¢ï¼Œå¹ç‰›çš„å¾ˆå¤šï¼Œä½†å¦‚æœæˆ‘ä¸çŸ¥é“ä»–æ˜¯æ€ä¹ˆ Work çš„ï¼Œé€šå¸¸æˆ‘æ˜¯ä¸å¤ªæ”¾å¿ƒçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨ä¸€ä¸ªç®€å•çš„å›¾ï¼ˆå›¾ 5ï¼‰è¯´ä¸€ä¸‹ï¼Œåˆ°åº• OLAP å’Œ OLTP çš„ Workload æ˜¯æ€ä¹ˆéš”ç¦»çš„ã€‚ åœ¨æˆ‘ä»¬å…¨æ–°çš„ Design é‡Œé¢ï¼ŒTiDB çš„ engineâ€”â€”TiKV  ï¼Œä½†æ˜¯æˆ‘ä»¬é€šè¿‡ Raft åè®®ï¼Œé€šè¿‡ learner æŠŠæ•°æ®å¤åˆ¶å‡ºæ¥ä¸€ä»½ï¼Œè¿™ä»½åè®®æ˜¯å®æ—¶é€šè¿‡ Raft åšå¤åˆ¶ï¼Œä½†æ˜¯ç”¨åˆ—å¼æ¥å­˜å‚¨ã€‚&lt;b&gt;å¦‚æœæˆ‘ä»¬çš„ä¼˜åŒ–å™¨å˜å¾—æ›´åŠ èªæ˜ï¼Œå½“ä¸€ä¸ªæŸ¥è¯¢è¿‡æ¥çš„æ—¶å€™ï¼Œå®ƒä¸ç”¨å†å»çº ç»“ï¼Œè€Œæ˜¯ä¼šæ ¹æ®è¿™ä¸ª Query çš„ç‰¹ç‚¹ã€è‡ªåŠ¨æ ¹æ®è¿™ä¸ª SQL å»é€‰æ‹©åˆ°åº•æ˜¯ä½¿ç”¨è¡Œå­˜ï¼Œè¿˜æ˜¯ä½¿ç”¨åˆ—å­˜ï¼Œè¿˜æ˜¯ä¸€éƒ¨åˆ†ä½¿ç”¨è¡Œå­˜ï¼Œä¸€éƒ¨åˆ†ä½¿ç”¨åˆ—å­˜ï¼Œè¿™æ ·å°±ä¼šå¸¦æ¥å¾ˆå¤šé¢å¤–çš„å¥½å¤„ã€‚&lt;/b&gt;åœ¨è¿™ä¸ªå›¾ä¸Šï¼ˆå›¾ 5ï¼‰å¯ä»¥çœ‹åˆ°ï¼ŒWorkload æ˜¯æ•´ä¸ªç‰©ç†ä¸Šæ˜¯éš”ç¦»çš„ï¼Œæ˜¯å®Œå…¨è·‘åœ¨ä¸åŒçš„ Server ä¸Šé¢çš„ã€‚&lt;/p&gt;&lt;p&gt;è¿™æ ·å¸¦æ¥çš„å¥½å¤„å°±éå¸¸æ˜æ˜¾ã€‚æˆ‘ä»¬å°±èƒ½å¤ŸåŒæ—¶å» Join ä¸¤ä¸ªä¸åŒæ ¼å¼çš„æ•°æ®ï¼ŒåŒæ—¶èƒ½å¾—åˆ°æ‰€æœ‰çš„ OLAP å’Œ OLTP çš„ç³»ç»Ÿçš„å¥½å¤„ï¼Œèƒ½å¾—åˆ°ä¸€ä¸ªæ›´ç¥å¥‡çš„ç»“æœï¼Œå°±æ˜¯å®ƒå¯ä»¥æ¯” OLTP ç³»ç»Ÿè·‘çš„å¿«ï¼›ä½ å¯ä»¥åœ¨ä¸€ä¸ª OLTP çš„ç³»ç»Ÿï¼Œåœ¨ä¼ ç»Ÿä¸Šé¢ä¸å¯æƒ³è±¡çš„ã€åœ¨ä¸‹é¢å»è·‘ä¸€ä¸ªæŠ¥è¡¨ã€‚&lt;b&gt;æ‰€ä»¥ä»Šå¤©æˆ‘ä»¬ä¹Ÿéå¸¸é«˜å…´çš„å»å‘å¤§å®¶æ¨å‡ºæˆ‘ä»¬æ–°çš„ Design å’Œå¯¹åº”çš„äº§å“ï¼Œè¿™ä¸ªäº§å“å« TiFlash&lt;/b&gt;ã€‚çœ‹è¿‡ç¾å‰§ The Flash çš„åŒå­¦çŸ¥é“é—ªç”µä¾ ï¼Œè¿™ä¸ªåç§°æ˜¯ä¸ºäº†å½¢å®¹å®ƒçš„é€Ÿåº¦ï¼Œå› ä¸ºå®ƒåˆæ˜¯ TiDB çš„ Ti ç³»åˆ—å®¶æ—ä¸­çš„ä¸€å‘˜ï¼Œæ‰€ä»¥æˆ‘ä»¬ç»™ä»–å–åå« TiFlashï¼Œä¸‹åˆä¼šæœ‰ä¸€ä¸ªéå¸¸éå¸¸ Amazing çš„ç¯èŠ‚ä¼šå»å±•ç¤ºæ•´ä¸ª TiFlashã€‚å¤§å®¶å¯ä»¥ä¿æŒæœŸå¾…ï¼Œè¿™ä¸ªä¸€å®šä¸ä¼šè®©å¤§å®¶å¤±æœ›ã€‚æˆ‘æ˜¨å¤©çœ‹äº†ä¸€ä¸‹æ¼”ç¤ºï¼Œéå¸¸éœ‡æ’¼ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;TiDB 3.0 Beta &lt;/b&gt;&lt;/h2&gt;&lt;p&gt;æœ‰å…³æ³¨æˆ‘ä»¬å¾®ä¿¡å…¬ä¼—å·çš„åŒå­¦ä¼šå‘ç°ï¼Œåœ¨ä»Šå¤©æ—©ä¸Šï¼ˆ1 æœˆ 19 æ—¥ï¼‰æˆ‘ä»¬å‘å¸ƒäº† &lt;u&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//www.pingcap.com/docs-cn/releases/3.0beta/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;3.0 Bata ç‰ˆæœ¬&lt;/a&gt;&lt;/u&gt;ï¼Œåœ¨ 3.0 é‡Œé¢ï¼Œæˆ‘ä»¬å‘å¸ƒäº†å¤§é‡çš„æ–°ç‰¹æ€§ï¼Œæ¯”å¦‚å»å¹´åœ¨ DevCon ä¸Šé¢ï¼Œæˆ‘æ‰¿è¯ºç»™å¤§å®¶çš„ï¼Œæˆ‘ä»¬ä¼š&lt;b&gt;æ”¯æŒ Window Fuctionã€æ”¯æŒ Viewã€æ”¯æŒ Partitionï¼Œè¿™äº›ä¸œè¥¿ç°åœ¨ç»Ÿç»Ÿéƒ½æœ‰äº†&lt;/b&gt;ã€‚åŒæ—¶æˆ‘ä»¬è¿˜æœ‰ä¸€äº›æ–°çš„ä¸œè¥¿æ˜¯ä¹‹å‰æ²¡æœ‰çš„ï¼Œæ¯”å¦‚è¯´ &lt;b&gt;Plan binding&lt;/b&gt;ï¼Œå°±æ˜¯ç»‘å®šæ‰§è¡Œè®¡åˆ’ï¼Œè¿™é‡Œä¹Ÿæ˜¯ç‰¹åˆ«æ„Ÿè°¢ç¾å›¢åŒå­¦çš„ Contributionï¼Œè®©æˆ‘ä»¬èƒ½å¤Ÿæ”¯æŒåˆ°æ–°çš„ç‰¹æ€§ã€‚è¿™äº›ç‰¹æ€§ï¼Œç¨åç”³ç ¾è€å¸ˆä¼šç»™å¤§å®¶åˆ†äº«è¯¦ç»†çš„ç»†èŠ‚ï¼Œè¿™è¾¹æˆ‘å°±å…ˆè·³è¿‡ã€‚ï¼ˆç”³ç ¾è€å¸ˆçš„æ¼”è®²å®å½•æ­£åœ¨æ•´ç†ä¸­ï¼Œåç»­ä¼šåˆ†äº«ç»™å¤§å®¶ï½ï¼‰&lt;/p&gt;&lt;p&gt;åŒæ—¶åœ¨ 3.0 é‡Œé¢ï¼Œæˆ‘ä»¬è¿˜åšäº†å¤§é‡çš„æ”¹è¿›ã€‚&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-1e7eb99f2c428056080dca50a970a0d3_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;370&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic4.zhimg.com/v2-1e7eb99f2c428056080dca50a970a0d3_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-1e7eb99f2c428056080dca50a970a0d3_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;370&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic4.zhimg.com/v2-1e7eb99f2c428056080dca50a970a0d3_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-1e7eb99f2c428056080dca50a970a0d3_b.jpg&quot;&gt;&lt;figcaption&gt;å›¾ 6 &lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;å¤§å®¶çŸ¥é“ï¼Œè¿‡å»ä¸€å¹´æœ‰é‚£ä¹ˆå¤š TiDB ç”¨æˆ·ï¼Œå…¶å®ä»–ä»¬ä¹Ÿæœ‰å¤´ç–¼çš„åœ°æ–¹ã€‚å°±æ˜¯ TiDB çš„æ‰§è¡Œè®¡åˆ’è·Ÿ TiDB çš„ç»Ÿè®¡ä¿¡æ¯æ˜¯é«˜åº¦ç›¸å…³çš„ï¼Œæœ‰æ—¶å€™ä¼šé‡åˆ°æ‰§è¡Œè®¡åˆ’äº§ç”Ÿå˜åŒ–ã€‚æ‰€ä»¥ 2019 å¹´çš„ Q1ï¼Œæˆ‘ä»¬å°†ä¼šèŠ±å¤§é‡çš„æ—¶é—´ï¼Œå»è®©è¿™ä¸ªæ‰§è¡Œè®¡åˆ’å˜çš„æ›´åŠ ç¨³å®šã€‚ åŒæ—¶ä¸ºäº†ä¾¿äºå¤§å®¶å»æŸ¥çœ‹è¿™äº›æ…¢æŸ¥è¯¢ï¼Œæˆ‘ä»¬åšäº†ä¸€ä¸ªéå¸¸æ¼‚äº®çš„ &lt;b&gt;Query Tracing&lt;/b&gt; çš„ç•Œé¢ï¼Œä¸Šåˆç”³ç ¾çš„åˆ†äº«ä¹Ÿä¼šå»ä»‹ç»è¿™ä¸ªéå¸¸æ¼‚äº®çš„ç•Œé¢ï¼Œè®©å¤§å®¶çœ‹åˆ°ï¼Œä¸€ä¸ªå¤æ‚çš„ Query ä¸‹å»ï¼Œæœ€ç»ˆåœ¨æ¯ä¸€æ­¥è€—äº†å¤šé•¿æ—¶é—´ï¼Œè¿˜æœ‰ä¸ªéå¸¸æ¼‚äº®çš„æ ‘å½¢å›¾ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;ç„¶åæˆ‘ä»¬ä¹Ÿè§£å†³äº†è¿‡å»ä¸€å¹´ï¼Œæˆ‘ä»¬ Raft Store æ˜¯ä¸€ä¸ªå•çº¿ç¨‹çš„é—®é¢˜ã€‚&lt;/b&gt;æˆ‘è§‰å¾—è¿™ä¸ªéœ€è¦æ¶ˆè€—å¤§é‡çš„æ—¶é—´å’Œç²¾åŠ›ã€‚æˆ‘è®°å¾—æˆ‘ä»¬å½“åˆåš Region split çš„æ—¶å€™å¥½åƒæ²¡èŠ±å¤šä¹…ï¼Œåˆ†è£‚å¯èƒ½åšä¸€ä¸ªæœˆï¼Œç„¶å merge åšäº†ä¸€å¹´ï¼Œå¤šçº¿ç¨‹è¿™ä¸ªä¹Ÿå·®ä¸å¤šåšäº†ä¸€å¹´ã€‚&lt;/p&gt;&lt;p&gt;å‰ä¸€é˜µå¤§å®¶å¯èƒ½ä¹ŸçŸ¥é“ä¸šå†…å‡ºç°è¿‡åˆ åº“è·‘è·¯çš„äº‹æƒ…ã€‚å½“æ—¶æˆ‘ä»¬ä¹Ÿéå¸¸éœ‡æƒŠï¼Œæˆ‘å°±æƒ³ä»æˆ‘ä»¬çš„å±‚é¢ä¸Šèƒ½åšå“ªäº›äº‹æƒ…ï¼Ÿæ‰€ä»¥ï¼Œ&lt;b&gt;æˆ‘ä»¬åœ¨ 3.0 é‡Œé¢æä¾›äº†ä¸€ä¸ªæ–°çš„åŠŸèƒ½ï¼Œå« Admin restore tableï¼Œ&lt;/b&gt;å¦‚æœä½ ä¸€ä¸å°å¿ƒæŠŠä¸€ä¸ªæ•°æ®åº“ï¼Œæˆ–è€…æŠŠä¸€ä¸ª table ç»™åˆ äº†ï¼Œåªè¦è¿˜æ²¡æœ‰å¯¹æ•°æ®åšåƒåœ¾æ”¶é›†ã€æ²¡æœ‰å½»åº•ä¸§å¤±ä¹‹å‰ï¼Œä½ è¿˜å¯ä»¥ä¸€ä¸ªå‘½ä»¤ï¼Œé©¬ä¸Šæ¢å¤è¿™ä¸ªæ•°æ®åº“ã€‚&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-5cd48855a5724e8fd92e3efe0e1ad81d_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;372&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic2.zhimg.com/v2-5cd48855a5724e8fd92e3efe0e1ad81d_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-5cd48855a5724e8fd92e3efe0e1ad81d_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;372&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic2.zhimg.com/v2-5cd48855a5724e8fd92e3efe0e1ad81d_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-5cd48855a5724e8fd92e3efe0e1ad81d_b.jpg&quot;&gt;&lt;figcaption&gt;å›¾ 7 &lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;å½“ç„¶é€šå¸¸èŠåˆ°ä¸€ä¸ªæ–°ç‰ˆæœ¬çš„æ—¶å€™ï¼Œå¤§å®¶æœ€å…³å¿ƒçš„å°±æ˜¯ï¼Œä¸æœè·‘ä¸ªåˆ†ã€‚æ‰€ä»¥å‘¢ï¼Œæˆ‘ä»¬ä¹Ÿåœ¨æœ€ç®€å•æœ€åŸºç¡€çš„ç¯å¢ƒä¸‹è·‘äº†ä¸ªåˆ†ï¼Œå›¾ 7 æ˜¯ 3.0 ç‰ˆæœ¬ä¸ 2.1 ç‰ˆæœ¬çš„å¯¹æ¯”ã€‚å¤§å®¶çŸ¥é“æˆ‘ä»¬åœ¨å‰ä¸ä¹…å‘å¸ƒäº† 2.1ï¼Œå¤§å®¶å¯ä»¥çœ‹åˆ°ï¼Œ&lt;b&gt;æ•´ä½“çš„ Performance çš„æå‡éå¸¸çš„æ˜æ˜¾ï¼ŒåŸºæœ¬ä¸Šç›´æ¥ Double äº†ã€‚&lt;/b&gt;å¤§å®¶åœ¨å®æµ‹çš„è¿‡ç¨‹ä¸­ï¼Œåº”è¯¥ä¼šæµ‹å‡ºæ¯” Double æ›´é«˜çš„æ€§èƒ½ã€‚&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-3e1a1d3e09f428fe70222ca2883b1ae3_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;375&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic4.zhimg.com/v2-3e1a1d3e09f428fe70222ca2883b1ae3_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-3e1a1d3e09f428fe70222ca2883b1ae3_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;375&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic4.zhimg.com/v2-3e1a1d3e09f428fe70222ca2883b1ae3_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-3e1a1d3e09f428fe70222ca2883b1ae3_b.jpg&quot;&gt;&lt;figcaption&gt;å›¾ 8&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;å½“ç„¶è¿™ä¸ª Performance çš„æå‡ï¼Œé‡Œé¢æœ‰å¾ˆå¤§ä¸€éƒ¨åˆ†æ˜¯æˆ‘ä»¬ä¸€ä¸ªæ–°çš„ Storage çš„è´¡çŒ®ã€‚æ–°çš„ Storage å« Titanã€‚&lt;/b&gt;æˆ‘ä»¬ä¹Ÿæ˜¯éå¸¸æœ‰æ„æ€çš„å’Œç¾å›¾åŸºäº TiKV å¼€å‘çš„ä¸€ä¸ª Redis çš„å®ç°ï¼Œä½¿ç”¨äº†ä¸€æ ·çš„åå­—ã€‚å¤§å®¶å¯¹äºè¿™ä¸ªå¸Œè…Šç¥è¯çš„çƒ­çˆ±ï¼Œå…¶å®æ˜¯ä¸€æ ·çš„ã€‚ç¨‹åºå‘˜åœ¨é€‰åå­—çš„æ—¶å€™ï¼Œä¹Ÿéƒ½æœ‰è‡ªå·±çš„ç‰¹ç‚¹ï¼Œæ‰€ä»¥å¤§å®¶å°±é‡åäº†ï¼Œé‡åä¹‹åï¼Œæˆ‘ä»¬è¿˜è®¨è®ºäº†ä¸€ä¸‹ï¼Œè§‰å¾—è¿™ä¸ªåå­—è¦ä¸è¦è€ƒè™‘æ”¹ä¸€ä¸‹ï¼Œåæ¥å¤§å®¶è§‰å¾—æ—¢ç„¶éƒ½æŒºå–œæ¬¢ï¼Œè¦ä¸ç„¶éƒ½ç”¨è¿™ä¸ªå§ï¼Œæˆ‘ä»¬è§‰å¾—è¿™ä¹ŸæŒºå¥½ã€‚&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-61ce2d53a80dd83226c58df58482c7ce_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;375&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic3.zhimg.com/v2-61ce2d53a80dd83226c58df58482c7ce_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-61ce2d53a80dd83226c58df58482c7ce_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;375&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic3.zhimg.com/v2-61ce2d53a80dd83226c58df58482c7ce_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-61ce2d53a80dd83226c58df58482c7ce_b.jpg&quot;&gt;&lt;figcaption&gt;å›¾ 9&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;ç„¶åæ•´ä¸ªæ–°çš„å­˜å‚¨å¼•æ“çš„ Design æ˜¯è¿™æ ·ï¼ˆå›¾ 9ï¼‰ï¼Œæˆ‘ä»¬æŠŠ Key å’Œ Value åšäº†åˆ†ç¦»ã€‚å¤§å®¶çŸ¥é“ï¼Œå»å¹´æˆ‘ä»¬åœ¨åšè®ºæ–‡åˆ†äº«çš„æ—¶å€™ï¼Œæœ‰ä¸€æ¬¡ä¸“é—¨åˆ†äº«äº† ã€Š&lt;u&gt;&lt;a href=&quot;http://link.zhihu.com/?target=http%3A//mp.weixin.qq.com/s%3F__biz%3DMzI3NDIxNTQyOQ%3D%3D%26mid%3D2247486286%26idx%3D1%26sn%3Deb25fa3a77cb8da74f014258396820b8%26chksm%3Deb162c24dc61a5328f373a3a7fde4baf2280cb28e0500f14fa1a653210d4ecefddebdd06cce1%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;WiscKey: Separating Keys from Values in SSD-conscious Storage&lt;/a&gt;&lt;/u&gt;ã€‹ è¿™ç¯‡è®ºæ–‡ï¼Œä¹Ÿæ˜¯éå¸¸æ„Ÿè°¢è¿™ç¯‡è®ºæ–‡ã€‚Titan æ•´ä½“ä¸Šæ˜¯åŸºäº RocksDB å»åšçš„ä¸€ä¸ªä¿®æ”¹æˆ–è€…æ˜¯ä¸€ä¸ªä¼˜åŒ–ï¼Œæ›´å¤šçš„æ˜¯åœ¨ RocksDB çš„å¤–å›´å®ç°äº† Key Value åˆ†ç¦»ï¼Œä¸»è¦æ˜¯é€‚åº”äºæ›´å¤§çš„ Valueã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;ä¸‹é¢æ˜¯ Titan çš„ Performance è·‘åˆ†ã€‚å¤§å®¶çœ‹åˆ°æ•´ä½“çš„æå‡éƒ½ä¼šéå¸¸çš„æ˜æ˜¾ï¼Œä»ä¸¤å€åˆ° N å€å§ï¼Œè¿™ä¸ª N çš„å¤šå°‘ï¼Œå–å†³äº Value æœ€ç»ˆæœ‰å¤šå¤§ï¼ŒValue è¶Šå¤§çš„è¯ï¼ŒN ä¼šè¶Šå¤§&lt;/b&gt;ï¼ˆå»¶ä¼¸é˜…è¯»ï¼šã€Š&lt;u&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//www.pingcap.com/blog-cn/titan-design-and-implementation/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Titan çš„è®¾è®¡ä¸å®ç°&lt;/a&gt;&lt;/u&gt;ã€‹ï¼‰&lt;b&gt;ã€‚&lt;/b&gt;&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-5ee464583a28e2c48a5c71ff357cb18f_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;712&quot; data-rawheight=&quot;283&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;712&quot; data-original=&quot;https://pic4.zhimg.com/v2-5ee464583a28e2c48a5c71ff357cb18f_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-5ee464583a28e2c48a5c71ff357cb18f_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;712&quot; data-rawheight=&quot;283&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;712&quot; data-original=&quot;https://pic4.zhimg.com/v2-5ee464583a28e2c48a5c71ff357cb18f_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-5ee464583a28e2c48a5c71ff357cb18f_b.jpg&quot;&gt;&lt;figcaption&gt;å›¾ 10 Titan Data Loading Performance &lt;/figcaption&gt;&lt;/figure&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-3864cfb47089804ee123411923513bcd_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;760&quot; data-rawheight=&quot;304&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;760&quot; data-original=&quot;https://pic2.zhimg.com/v2-3864cfb47089804ee123411923513bcd_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-3864cfb47089804ee123411923513bcd_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;760&quot; data-rawheight=&quot;304&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;760&quot; data-original=&quot;https://pic2.zhimg.com/v2-3864cfb47089804ee123411923513bcd_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-3864cfb47089804ee123411923513bcd_b.jpg&quot;&gt;&lt;figcaption&gt;å›¾ 11  Titan Update Performance &lt;/figcaption&gt;&lt;/figure&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-36c5f6c982ff3e29c97cf7eee3b931fe_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;375&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic3.zhimg.com/v2-36c5f6c982ff3e29c97cf7eee3b931fe_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-36c5f6c982ff3e29c97cf7eee3b931fe_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;375&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic3.zhimg.com/v2-36c5f6c982ff3e29c97cf7eee3b931fe_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-36c5f6c982ff3e29c97cf7eee3b931fe_b.jpg&quot;&gt;&lt;figcaption&gt;å›¾ 12  Titan Random Key Lookup Performance &lt;/figcaption&gt;&lt;/figure&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-703d920f0b0cb74cb56172aa96df86a5_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;372&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic2.zhimg.com/v2-703d920f0b0cb74cb56172aa96df86a5_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-703d920f0b0cb74cb56172aa96df86a5_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;372&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic2.zhimg.com/v2-703d920f0b0cb74cb56172aa96df86a5_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-703d920f0b0cb74cb56172aa96df86a5_b.jpg&quot;&gt;&lt;figcaption&gt;å›¾ 13  Titan Sorted Range Performance &lt;/figcaption&gt;&lt;/figure&gt;&lt;h2&gt;&lt;b&gt;TiDB on Cloud&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;è¯´äº†è¿™ä¹ˆå¤šï¼Œé‚£ä¹ˆåœ¨ä¸€ä¸ªäº‘çš„æ—¶ä»£æˆ‘ä»¬åˆ°åº•æ˜¯æ€æ ·å»æ‹¥æŠ±äº‘çš„ã€‚&lt;/p&gt;&lt;p&gt;å¤§å®¶çŸ¥é“ TiDB åœ¨æœ€åˆ Design çš„æ—¶å€™ï¼Œå°±æ˜¯ä¸º Cloud åšäº†å¤§é‡çš„ä¼˜åŒ–ï¼ŒåŒæ—¶åœ¨ä¸‰å¹´å‰æˆ‘ä»¬å°±ç›¸ä¿¡ Kubernetes æ˜¯æœªæ¥ï¼Œç„¶å TiDB æ•´ä¸ªå°± All-in Kubernetes äº†ã€‚æ‰€ä»¥æˆ‘ä»¬ä¸€ç›´åœ¨ç­‰ç€ Cloud å‡ºä¸€ä¸ªåŠŸèƒ½ï¼Œå°±æ˜¯ Cloud èƒ½ä¸èƒ½å¤Ÿæ”¯æŒ Native  Kubernetes  Engineï¼Œåæ¥æˆ‘ä»¬çœ‹åˆ°äº† Google å‘å¸ƒäº†ä»–ä»¬çš„ Kubernetes  Engineã€‚&lt;b&gt;æ‰€ä»¥æˆ‘ä»¬ç¬¬ä¸€æ—¶é—´å’Œ Google çš„ K8s åšäº†ä¸€ä¸ªé›†æˆï¼ŒåŒæ—¶å¤§å®¶ç°åœ¨ä¹Ÿå¯ä»¥å»è®¿é—® Google äº‘å¹³å°ï¼ˆGoogle Cloud Platformï¼‰ï¼Œå»è¯•ç”¨æˆ‘ä»¬çš„äº§å“&lt;/b&gt;ï¼ˆ&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//pingcap.com/tidb-cloud/&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;pingcap.com/tidb-cloud/&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;&lt;/span&gt;&lt;/a&gt;ï¼‰&lt;b&gt;ï¼Œåœ¨é‚£ä¸Šé¢çœŸçš„æ˜¯ä¸€é”®å°±å¯ä»¥è·‘èµ·ä¸€ä¸ªé›†ç¾¤ï¼Œç„¶åéƒ½å¯ä»¥ç”±æˆ‘ä»¬æ¥ maintain æ•´ä¸ª TiDBï¼Œç›¸å½“äºæˆ‘ä»¬ç°åœ¨æœ‰ä¸€ä¸ª TiDB On Cloudã€‚&lt;/b&gt;æ¥ä¸‹æ¥ä¹Ÿä¼šæ”¯æŒ AWS å’Œ Azureã€‚&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-40e78b8e8f3cb98dc026845fcbe2b490_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;375&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic1.zhimg.com/v2-40e78b8e8f3cb98dc026845fcbe2b490_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-40e78b8e8f3cb98dc026845fcbe2b490_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;375&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic1.zhimg.com/v2-40e78b8e8f3cb98dc026845fcbe2b490_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-40e78b8e8f3cb98dc026845fcbe2b490_b.jpg&quot;&gt;&lt;figcaption&gt;å›¾ 14&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;å…¶å®ä¹‹å‰æœ‰éƒ¨åˆ†åŒå­¦éƒ½æè¿‡ï¼ŒTiDB  åšå¾—æŒºå¥½çš„ä¸ºä»€ä¹ˆä¸åšä¸€å¥—æ¼‚äº®çš„ç•Œé¢ï¼Œç„¶åå®ƒçš„æ˜“ç”¨æ€§ä¼šæ›´ä½³ï¼Œæ›´é‡è¦çš„æ˜¯æ”¯æŒå¤šç§Ÿæˆ·ã€‚ç¾å›¢ä»Šå¤©ä¹Ÿä¼šåˆ†äº«ä»–ä»¬åœ¨ä½¿ç”¨ TiDB çš„ç»éªŒï¼Œå½“æˆ‘ä»¬ä¸€ä¸ªé›†ç¾¤ï¼Œä¸¤ä¸ªé›†ç¾¤ï¼Œåä¸ªé›†ç¾¤ï¼ŒäºŒåä¸ªé›†ç¾¤ï¼Œä¸€ç™¾ä¸ªé›†ç¾¤çš„æ—¶å€™æ€ä¹ˆåŠï¼Œé‚£ä¹ˆå¤šé›†ç¾¤ï¼Œæˆ‘æ€ä¹ˆç”¨ä¸€ä¸ªç®€å•çš„æ–¹å¼å»ç»´æŠ¤ï¼Œé‚£è¿™ä¸ªæ—¶å€™å°±éœ€è¦ä¸€å¥—&lt;b&gt;Database as Service&lt;/b&gt;çš„ä¸œè¥¿ï¼Œèƒ½å¤Ÿå»å¸®æˆ‘ç®¡ç†æ•´ä¸ªå…¬å¸çš„æ‰€æœ‰ TiDB é›†ç¾¤ã€‚æ‰€ä»¥å¯¹äºå¤šç§Ÿæˆ·çš„æ”¯æŒå°±å˜å¾—éå¸¸æœ‰ç”¨ã€‚åŒæ—¶ä¹Ÿä¼šåšè‡ªåŠ¨çš„ Backup å’Œ Recoverã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;Whatâ€™s Next&lt;/b&gt;&lt;/h2&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-57d2063136de80067aa11f474335a2a4_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;372&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic1.zhimg.com/v2-57d2063136de80067aa11f474335a2a4_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-57d2063136de80067aa11f474335a2a4_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;372&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic1.zhimg.com/v2-57d2063136de80067aa11f474335a2a4_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-57d2063136de80067aa11f474335a2a4_b.jpg&quot;&gt;&lt;figcaption&gt;å›¾ 15&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;é‚£æˆ‘ä»¬ä¸‹ä¸€æ­¥ä¼šæœ‰ä»€ä¹ˆä¸ä¸€æ ·çš„åœ°æ–¹ï¼Ÿæˆ‘ä»¬åˆšæ‰æåˆ° 3.0 ç‰ˆæœ¬æœ‰è¿™ä¹ˆå¤šè®©äººéå¸¸å…´å¥‹çš„åŠŸèƒ½ï¼Œæœ‰è¿™ä¹ˆå¤šçš„å·¨å¤§æ”¹è¿›ï¼Œä»€ä¹ˆæ—¶å€™èƒ½å¤ŸæŠŠä»–ç”¨åˆ°äº§å“é‡Œé¢ï¼Œæ˜¯å¤§å®¶æ¥ä¸‹æ¥å…³å¿ƒçš„ä¸€ä¸ªé—®é¢˜ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;é¦–å…ˆæˆ‘ä»¬ä¼šåœ¨ä»Šå¹´çš„ 6 æœˆä»½å‘å¸ƒç¬¬ä¸€ä¸ª 3.0 çš„ GAã€‚&lt;/b&gt;ç›®å‰æ­£åœ¨ä¸åŒçš„ç”¨æˆ·åœºæ™¯ä¸‹åšå¤§é‡çš„æµ‹è¯•ï¼Œé€šè¿‡ä¸åŒçš„ Workload  åšæµ‹è¯•ã€‚&lt;/p&gt;&lt;p&gt;å¦å¤–ï¼Œå¤§å®¶çŸ¥é“ï¼Œæˆ‘ä»¬å»å¹´å†™äº†ä¸€ä¸ª 24 ç« ç»â€”â€”å°±æ˜¯ &lt;a href=&quot;http://link.zhihu.com/?target=https%3A//pingcap.com/blog-cn/%23%25E6%25BA%2590%25E7%25A0%2581%25E9%2598%2585%25E8%25AF%25BB&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TiDB æºç é˜…è¯»ç³»åˆ—æ–‡ç« &lt;/a&gt;ï¼Œæˆ‘ä»¬å†™äº† 24 ç¯‡ï¼Œå¦‚æœç†Ÿæ‚‰é‡‘åº¸å…ˆç”Ÿçš„è¯åº”è¯¥çŸ¥é“ 42 ç« ç»ï¼Œ&lt;b&gt;ä»Šå¹´æˆ‘ä»¬å¼€å§‹ä¸º TiKV å‡†å¤‡ 24 ç« ç»ï¼Œä¼šå»è¯¦ç»†è§£è¯» TiKV æºç çš„å®ç°ã€‚&lt;/b&gt;è‘—å IT ä½œå®¶ã€è¯‘è€…ä¾¯æ·å¤§å¸ˆè¯´ï¼šã€Œæºç é¢å‰ï¼Œäº†æ— ç§˜å¯†ã€ã€‚æˆ‘å¸Œæœ›å¤§å®¶å¯¹äº TiDB çš„ç†è§£èƒ½å¤Ÿæ·±å…¥éª¨é«“ã€‚èƒ½å¤Ÿè‡ªå·±éšæ„å» Hack æˆ‘ä»¬çš„ä¸œè¥¿ï¼Œèƒ½ä¸ºæ•´ä¸ª TiDB Community è´¡çŒ®æ›´å¤šä¸œè¥¿ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;åŒæ—¶æˆ‘ä»¬ä¹Ÿä¼šæä¾›æ›´åŠ æ™ºèƒ½çš„ã€åŸºäºæœºå™¨å­¦ä¹ çš„åŠŸèƒ½ã€‚&lt;/b&gt;å¦‚æœå¤§å®¶ä¹‹å‰æœ‰å…³æ³¨æˆ‘ä»¬çš„&lt;u&gt;&lt;a href=&quot;http://link.zhihu.com/?target=http%3A//mp.weixin.qq.com/s%3F__biz%3DMzI3NDIxNTQyOQ%3D%3D%26mid%3D2247487370%26idx%3D1%26sn%3D72d9d52558e83eb97cd709c67b5a4149%26chksm%3Deb1628e0dc61a1f60bb99ffe2fe42fafe91570159094fc5e3d46039b5490bd0c391ee500b8d6%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;é»‘å®¢é©¬æ‹‰æ¾&lt;/a&gt;&lt;/u&gt;ï¼Œä¼šå‘ç°æˆ‘ä»¬å®ç°ç¬¬ä¸€ä¸ª prototypeï¼Œæ˜¯ç”¨è´å¶æ–¯æ¨¡å‹åšæ™ºèƒ½çš„çƒ­ç‚¹çš„è°ƒåº¦ã€‚å¤§å®¶ä»¥ååº”è¯¥ä¼šè·Ÿâ€œäººå·¥çœ‹çƒ­ç‚¹è°ƒåº¦ï¼Œå†äººå·¥ split â€è¿™äº‹å„¿ say goodbye äº†ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;æœ€åï¼Œå½“æˆ‘ä»¬æœ‰å¤§é‡çš„ç”¨æˆ·ï¼Œæœ‰å¤§é‡çš„ä½¿ç”¨åœºæ™¯ï¼Œæœ‰å¤§é‡çš„ç»éªŒçš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ›´åŠ å¼ºå¤§çš„ Community å’Œä¸€ä¸ªæ›´åŠ å¼ºå¤§çš„ Ecosystemã€‚&lt;/b&gt;ä»Šå¤©å´”ç§‹è€å¸ˆä¹Ÿä¼šå»è®²æˆ‘ä»¬æ•´ä¸ª Community çš„è¿è½¬å¹¶ä¸ºæ–°æ™‹ Committer æˆäºˆè¯ä¹¦ã€‚&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;blockquote&gt;&lt;b&gt;ç¤¾åŒºçš„ç›¸èšè®©æˆ‘ä»¬åº¦è¿‡äº†å…´å¥‹è€Œå……å®çš„ä¸€å¤©ï¼Œæ„Ÿè°¢å¤§å®¶å¯¹ TiDB ç¤¾åŒºçš„è´¡çŒ®å’Œçƒ­æƒ…ï¼Œæœªæ¥æˆ‘ä»¬ç»§ç»­æºæ‰‹åŒè¡Œï¼ç¤¾åŒºå®è·µä¸“åœºå’Œ Lighting Talk ç¯èŠ‚çš„éƒ¨åˆ† PPT&lt;/b&gt; &lt;b&gt;å¯ä»¥åœ¨å¾®ä¿¡å…¬å·ï¼ˆPingCAPï¼‰åå°å›å¤â€œ2019â€è·å–ã€‚&lt;/b&gt;&lt;br&gt;TiDB DevCon æ˜¯ PingCAP å›¢é˜Ÿé¢å‘ TiDB ç¤¾åŒºæ¨å‡ºçš„æŠ€æœ¯ä¼šè®®ã€‚ æœ¬å±Š TiDB DevCon 2019 ä»¥ â€œPowered by Contributorsâ€ ä¸ºä¸»é¢˜ï¼Œèšç„¦ TiDB é¡¹ç›®æ ¸å¿ƒæŠ€æœ¯çš„æœ€æ–°è¿›å±•å’Œæœªæ¥è§„åˆ’ï¼Œä»¥åŠæ¥è‡ªç¤¾åŒºä¸€çº¿ç”¨æˆ·çš„æœ€ä½³å®è·µç»éªŒï¼Œå±•ç¤º TiDB åœ¨æµ·å†…å¤–çš„æœ€æ–°åŠ¨æ€ã€‚æ—¨åœ¨å¸®åŠ©ç¤¾åŒºæ›´å¥½çš„ç†è§£ TiDB çš„æŠ€æœ¯ç†å¿µï¼Œæ±‡æ€»ç”¨æˆ·ä»æŠ€æœ¯é€‰å‹åˆ°åº”ç”¨è½åœ°å„é˜¶æ®µçš„å®æ“ä¸­æ€»ç»“å‡ºçš„ç»éªŒå’Œå‘ï¼ŒæŒ–æ˜ TiDB åœºæ™¯é€‚é…çš„æ›´å¤šå¯èƒ½æ€§ã€‚&lt;/blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>ZoeyZhai</author>
<guid isPermaLink="false">2019-01-25-55728943</guid>
<pubDate>Fri, 25 Jan 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>Titan çš„è®¾è®¡ä¸å®ç°</title>
<link>https://henix.github.io/feeds/zhuanlan.newsql/2019-01-23-55521489.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/55521489&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-579b54e6a23d0d19a9cd2950355a72af_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;ä½œè€…ï¼šéƒ‘å¿—é“¨&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/pingcap/rocksdb/tree/titan-5.15&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Titan&lt;/a&gt; æ˜¯ç”± &lt;a href=&quot;http://link.zhihu.com/?target=https%3A//www.pingcap.com/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;PingCAP&lt;/a&gt; ç ”å‘çš„ä¸€ä¸ªåŸºäº &lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/facebook/rocksdb&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;RocksDB&lt;/a&gt; çš„é«˜æ€§èƒ½å•æœº key-value å­˜å‚¨å¼•æ“ï¼Œå…¶ä¸»è¦è®¾è®¡çµæ„Ÿæ¥æºäº USENIX FAST 2016 ä¸Šå‘è¡¨çš„ä¸€ç¯‡è®ºæ–‡ &lt;a href=&quot;http://link.zhihu.com/?target=https%3A//www.usenix.org/system/files/conference/fast16/fast16-papers-lu.pdf&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;WiscKey&lt;/a&gt;ã€‚&lt;code&gt;WiscKey&lt;/code&gt; æå‡ºäº†ä¸€ç§é«˜åº¦åŸºäº SSD ä¼˜åŒ–çš„è®¾è®¡ï¼Œåˆ©ç”¨ SSD é«˜æ•ˆçš„éšæœºè¯»å†™æ€§èƒ½ï¼Œé€šè¿‡å°† value åˆ†ç¦»å‡º &lt;code&gt;LSM-tree&lt;/code&gt; çš„æ–¹æ³•æ¥è¾¾åˆ°é™ä½å†™æ”¾å¤§çš„ç›®çš„ã€‚&lt;/p&gt;&lt;p&gt;æˆ‘ä»¬çš„åŸºå‡†æµ‹è¯•ç»“æœæ˜¾ç¤ºï¼Œå½“ value è¾ƒå¤§çš„æ—¶å€™ï¼ŒTitan åœ¨å†™ã€æ›´æ–°å’Œç‚¹è¯»ç­‰åœºæ™¯ä¸‹æ€§èƒ½éƒ½ä¼˜äº RocksDBã€‚ä½†æ˜¯æ ¹æ® &lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=http%3A//daslab.seas.harvard.edu/rum-conjecture/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;RUM Conjecture&lt;/a&gt;&lt;/code&gt;ï¼Œé€šå¸¸æŸäº›æ–¹é¢çš„æå‡å¾€å¾€æ˜¯ä»¥ç‰ºç‰²å…¶ä»–æ–¹é¢ä¸ºä»£ä»·è€Œå–å¾—çš„ã€‚Titan ä¾¿æ˜¯ä»¥ç‰ºç‰²ç¡¬ç›˜ç©ºé—´å’ŒèŒƒå›´æŸ¥è¯¢çš„æ€§èƒ½ä¸ºä»£ä»·ï¼Œæ¥å–å¾—æ›´é«˜çš„å†™æ€§èƒ½ã€‚éšç€ SSD ä»·æ ¼çš„é™ä½ï¼Œæˆ‘ä»¬è®¤ä¸ºè¿™ç§å–èˆçš„æ„ä¹‰ä¼šè¶Šæ¥è¶Šæ˜æ˜¾ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;è®¾è®¡ç›®æ ‡&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;Titan ä½œä¸º TiKV çš„ä¸€ä¸ªå­é¡¹ç›®ï¼Œé¦–è¦çš„è®¾è®¡ç›®æ ‡ä¾¿æ˜¯å…¼å®¹ RocksDBã€‚å› ä¸º TiKV ä½¿ç”¨ RocksDB ä½œä¸ºå…¶åº•å±‚çš„å­˜å‚¨å¼•æ“ï¼Œè€Œ TiKV ä½œä¸ºä¸€ä¸ªæˆç†Ÿé¡¹ç›®å·²ç»æ‹¥æœ‰åºå¤§çš„ç”¨æˆ·ç¾¤ä½“ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è€ƒè™‘å·²æœ‰çš„ç”¨æˆ·ä¹Ÿå¯ä»¥å°†å·²æœ‰çš„åŸºäº RocksDB çš„ TiKV å¹³æ»‘åœ°å‡çº§åˆ°åŸºäº Titan çš„ TiKVã€‚&lt;/p&gt;&lt;p&gt;å› æ­¤ï¼Œæˆ‘ä»¬æ€»ç»“äº†å››ç‚¹ä¸»è¦çš„è®¾è®¡ç›®æ ‡ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;æ”¯æŒå°† value ä» &lt;code&gt;LSM-tree&lt;/code&gt; ä¸­åˆ†ç¦»å‡ºæ¥å•ç‹¬å­˜å‚¨ï¼Œä»¥é™ä½å†™æ”¾å¤§ã€‚&lt;/li&gt;&lt;li&gt;å·²æœ‰ RocksDB å®ä¾‹å¯ä»¥å¹³æ»‘åœ°å‡çº§åˆ° Titanï¼Œè¿™æ„å‘³ç€å‡çº§è¿‡ç¨‹ä¸éœ€è¦äººå·¥å¹²é¢„ï¼Œå¹¶ä¸”ä¸ä¼šå½±å“çº¿ä¸ŠæœåŠ¡ã€‚&lt;/li&gt;&lt;li&gt;100% å…¼å®¹ç›®å‰ TiKV æ‰€ä½¿ç”¨çš„æ‰€æœ‰ RocksDB çš„ç‰¹æ€§ã€‚&lt;/li&gt;&lt;li&gt;å°½é‡å‡å°‘å¯¹ RocksDB çš„ä¾µå…¥æ€§æ”¹åŠ¨ï¼Œä¿è¯ Titan æ›´åŠ å®¹æ˜“å‡çº§åˆ°æ–°ç‰ˆæœ¬çš„ RocksDBã€‚&lt;/li&gt;&lt;/ul&gt;&lt;h2&gt;&lt;b&gt;æ¶æ„ä¸å®ç°&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;Titan çš„åŸºæœ¬æ¶æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-65149fdad2e1249dda3e58fb8d9e1490_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1240&quot; data-rawheight=&quot;882&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1240&quot; data-original=&quot;https://pic1.zhimg.com/v2-65149fdad2e1249dda3e58fb8d9e1490_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-65149fdad2e1249dda3e58fb8d9e1490_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1240&quot; data-rawheight=&quot;882&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1240&quot; data-original=&quot;https://pic1.zhimg.com/v2-65149fdad2e1249dda3e58fb8d9e1490_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-65149fdad2e1249dda3e58fb8d9e1490_b.jpg&quot;&gt;&lt;/figure&gt;&lt;blockquote&gt;å›¾ 1ï¼šTitan åœ¨ Flush å’Œ Compaction çš„æ—¶å€™å°† value åˆ†ç¦»å‡º &lt;code&gt;LSM-tree&lt;/code&gt;ï¼Œè¿™æ ·åšçš„å¥½å¤„æ˜¯å†™å…¥æµç¨‹å¯ä»¥å’Œ RockDB ä¿æŒä¸€è‡´ï¼Œå‡å°‘å¯¹ &lt;code&gt;RocksDB&lt;/code&gt; çš„ä¾µå…¥æ€§æ”¹åŠ¨ã€‚&lt;/blockquote&gt;&lt;p&gt;Titan çš„æ ¸å¿ƒç»„ä»¶ä¸»è¦åŒ…æ‹¬ï¼š&lt;code&gt;BlobFile&lt;/code&gt;ã€&lt;code&gt;TitanTableBuilder&lt;/code&gt;ã€&lt;code&gt;Version&lt;/code&gt; å’Œ &lt;code&gt;GC&lt;/code&gt;ï¼Œä¸‹é¢å°†é€ä¸€è¿›è¡Œä»‹ç»ã€‚&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;&lt;code&gt;BlobFile&lt;/code&gt; &lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;code&gt;BlobFile&lt;/code&gt; æ˜¯ç”¨æ¥å­˜æ”¾ä» &lt;code&gt;LSM-tree&lt;/code&gt; ä¸­åˆ†ç¦»å‡ºæ¥çš„ value çš„æ–‡ä»¶ï¼Œå…¶æ ¼å¼å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-6b4972e3d5e50a18e081a2eedef51867_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1240&quot; data-rawheight=&quot;1327&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1240&quot; data-original=&quot;https://pic4.zhimg.com/v2-6b4972e3d5e50a18e081a2eedef51867_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-6b4972e3d5e50a18e081a2eedef51867_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1240&quot; data-rawheight=&quot;1327&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1240&quot; data-original=&quot;https://pic4.zhimg.com/v2-6b4972e3d5e50a18e081a2eedef51867_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-6b4972e3d5e50a18e081a2eedef51867_b.jpg&quot;&gt;&lt;/figure&gt;&lt;blockquote&gt;å›¾ 2ï¼š&lt;code&gt;BlobFile&lt;/code&gt; ä¸»è¦ç”± blob record ã€meta blockã€meta index block å’Œ footer ç»„æˆã€‚å…¶ä¸­æ¯ä¸ª blob record ç”¨äºå­˜æ”¾ä¸€ä¸ª key-value å¯¹ï¼›meta block æ”¯æŒå¯æ‰©å±•æ€§ï¼Œå¯ä»¥ç”¨æ¥å­˜æ”¾å’Œ &lt;code&gt;BlobFile&lt;/code&gt; ç›¸å…³çš„ä¸€äº›å±æ€§ç­‰ï¼›meta index block ç”¨äºæ£€ç´¢ meta blockã€‚&lt;/blockquote&gt;&lt;p&gt;&lt;code&gt;BlobFile&lt;/code&gt; æœ‰å‡ ç‚¹å€¼å¾—å…³æ³¨çš„åœ°æ–¹ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;code&gt;BlobFile&lt;/code&gt; ä¸­çš„ key-value æ˜¯æœ‰åºå­˜æ”¾çš„ï¼Œç›®çš„æ˜¯åœ¨å®ç° &lt;code&gt;Iterator&lt;/code&gt; çš„æ—¶å€™å¯ä»¥é€šè¿‡ prefetch çš„æ–¹å¼æé«˜é¡ºåºè¯»å–çš„æ€§èƒ½ã€‚&lt;/li&gt;&lt;li&gt;æ¯ä¸ª blob record éƒ½ä¿ç•™äº† value å¯¹åº”çš„ user key çš„æ‹·è´ï¼Œè¿™æ ·åšçš„ç›®çš„æ˜¯åœ¨è¿›è¡Œ GC çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡æŸ¥è¯¢ user key æ˜¯å¦æ›´æ–°æ¥ç¡®å®šå¯¹åº” value æ˜¯å¦å·²ç»è¿‡æœŸï¼Œä½†åŒæ—¶ä¹Ÿå¸¦æ¥äº†ä¸€å®šçš„å†™æ”¾å¤§ã€‚&lt;/li&gt;&lt;li&gt;&lt;code&gt;BlobFile&lt;/code&gt; æ”¯æŒ blob record ç²’åº¦çš„ compressionï¼Œå¹¶ä¸”æ”¯æŒå¤šç§ compression algorithmï¼ŒåŒ…æ‹¬ &lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/google/snappy&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Snappy&lt;/a&gt;&lt;/code&gt;ã€&lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/lz4/lz4&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;LZ4&lt;/a&gt;&lt;/code&gt;å’Œ &lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/facebook/zstd&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Zstd&lt;/a&gt;&lt;/code&gt; ç­‰ï¼Œç›®å‰ Titan é»˜è®¤ä½¿ç”¨çš„ compression algorithm æ˜¯ &lt;code&gt;LZ4&lt;/code&gt; ã€‚&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;code&gt;&lt;b&gt;TitanTableBuilder&lt;/b&gt;&lt;/code&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;code&gt;TitanTableBuilder&lt;/code&gt; æ˜¯å®ç°åˆ†ç¦» key-value çš„å…³é”®ã€‚æˆ‘ä»¬çŸ¥é“ RocksDB æ”¯æŒä½¿ç”¨ç”¨æˆ·è‡ªå®šä¹‰ table builder åˆ›å»º &lt;code&gt;SST&lt;/code&gt;ï¼Œè¿™ä½¿å¾—æˆ‘ä»¬å¯ä»¥ä¸å¯¹ build table æµç¨‹åšä¾µå…¥æ€§çš„æ”¹åŠ¨å°±å¯ä»¥å°† value ä» &lt;code&gt;SST&lt;/code&gt; ä¸­åˆ†ç¦»å‡ºæ¥ã€‚ä¸‹é¢å°†ä»‹ç» &lt;code&gt;TitanTableBuilder&lt;/code&gt; çš„ä¸»è¦å·¥ä½œæµç¨‹ï¼š&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-d52ee86abcc2fa54f32942c787879ca6_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1240&quot; data-rawheight=&quot;777&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1240&quot; data-original=&quot;https://pic3.zhimg.com/v2-d52ee86abcc2fa54f32942c787879ca6_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-d52ee86abcc2fa54f32942c787879ca6_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1240&quot; data-rawheight=&quot;777&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1240&quot; data-original=&quot;https://pic3.zhimg.com/v2-d52ee86abcc2fa54f32942c787879ca6_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-d52ee86abcc2fa54f32942c787879ca6_b.jpg&quot;&gt;&lt;/figure&gt;&lt;blockquote&gt;å›¾ 3ï¼š&lt;code&gt;TitanTableBuilder&lt;/code&gt; é€šè¿‡åˆ¤æ–­ value size çš„å¤§å°æ¥å†³å®šæ˜¯å¦å°† value åˆ†ç¦»åˆ° &lt;code&gt;BlobFile&lt;/code&gt; ä¸­å»ã€‚å¦‚æœ value size å¤§äºç­‰äº &lt;code&gt;min_blob_size&lt;/code&gt; åˆ™å°† value åˆ†ç¦»åˆ° &lt;code&gt;BlobFile&lt;/code&gt; ï¼Œå¹¶ç”Ÿæˆ index å†™å…¥ &lt;code&gt;SST&lt;/code&gt;ï¼›å¦‚æœ value size å°äº &lt;code&gt;min_blob_size&lt;/code&gt; åˆ™å°† value ç›´æ¥å†™å…¥ &lt;code&gt;SST&lt;/code&gt;ã€‚&lt;/blockquote&gt;&lt;p&gt;Titan å’Œ &lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/dgraph-io/badger&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Badger&lt;/a&gt;&lt;/code&gt; çš„è®¾è®¡æœ‰å¾ˆå¤§åŒºåˆ«ã€‚&lt;code&gt;Badger&lt;/code&gt; ç›´æ¥å°† &lt;code&gt;WAL&lt;/code&gt; æ”¹é€ æˆ &lt;code&gt;VLog&lt;/code&gt;ï¼Œè¿™æ ·åšçš„å¥½å¤„æ˜¯å‡å°‘ä¸€æ¬¡ Flush çš„å¼€é”€ã€‚è€Œ Titan ä¸è¿™ä¹ˆè®¾è®¡çš„ä¸»è¦åŸå› æœ‰ä¸¤ä¸ªï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;å‡è®¾ &lt;code&gt;LSM-tree&lt;/code&gt; çš„ max level æ˜¯ 5ï¼Œæ”¾å¤§å› å­ä¸º 10ï¼Œåˆ™ &lt;code&gt;LSM-tree&lt;/code&gt; æ€»çš„å†™æ”¾å¤§å¤§æ¦‚ä¸º 1 + 1 + 10 + 10 + 10 + 10ï¼Œå…¶ä¸­ Flush çš„å†™æ”¾å¤§æ˜¯ 1ï¼Œå…¶æ¯”å€¼æ˜¯ 42 : 1ï¼Œå› æ­¤ Flush çš„å†™æ”¾å¤§ç›¸æ¯”äºæ•´ä¸ª LSM-tree çš„å†™æ”¾å¤§å¯ä»¥å¿½ç•¥ä¸è®¡ã€‚&lt;/li&gt;&lt;li&gt;åœ¨ç¬¬ä¸€ç‚¹çš„åŸºç¡€ä¸Šï¼Œä¿ç•™ &lt;code&gt;WAL&lt;/code&gt; å¯ä»¥ä½¿ Titan æå¤§åœ°å‡å°‘å¯¹ RocksDB çš„ä¾µå…¥æ€§æ”¹åŠ¨ï¼Œè€Œè¿™ä¹Ÿæ­£æ˜¯æˆ‘ä»¬çš„è®¾è®¡ç›®æ ‡ä¹‹ä¸€ã€‚ &lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;code&gt;&lt;b&gt;Version&lt;/b&gt;&lt;/code&gt; &lt;/li&gt;&lt;/ul&gt;&lt;p&gt;Titan ä½¿ç”¨ &lt;code&gt;Version&lt;/code&gt; æ¥ä»£è¡¨æŸä¸ªæ—¶é—´ç‚¹æ‰€æœ‰æœ‰æ•ˆçš„ &lt;code&gt;BlobFile&lt;/code&gt;ï¼Œè¿™æ˜¯ä» &lt;code&gt;LevelDB&lt;/code&gt; ä¸­å€Ÿé‰´è¿‡æ¥çš„ç®¡ç†æ•°æ®æ–‡ä»¶çš„æ–¹æ³•ï¼Œå…¶æ ¸å¿ƒæ€æƒ³ä¾¿æ˜¯ &lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//en.wikipedia.org/wiki/Multiversion_concurrency_control&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;MVCC&lt;/a&gt;&lt;/code&gt;ï¼Œå¥½å¤„æ˜¯åœ¨æ–°å¢æˆ–åˆ é™¤æ–‡ä»¶çš„åŒæ—¶ï¼Œå¯ä»¥åšåˆ°å¹¶å‘è¯»å–æ•°æ®è€Œä¸éœ€è¦åŠ é”ã€‚æ¯æ¬¡æ–°å¢æ–‡ä»¶æˆ–è€…åˆ é™¤æ–‡ä»¶çš„æ—¶å€™ï¼Œ&lt;code&gt;Titan&lt;/code&gt; éƒ½ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„ &lt;code&gt;Version&lt;/code&gt; ï¼Œå¹¶ä¸”æ¯æ¬¡è¯»å–æ•°æ®ä¹‹å‰éƒ½è¦è·å–ä¸€ä¸ªæœ€æ–°çš„ &lt;code&gt;Version&lt;/code&gt;ã€‚&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-b7d9e3002bfc4268a4827f6505e1b1bd_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1240&quot; data-rawheight=&quot;380&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1240&quot; data-original=&quot;https://pic2.zhimg.com/v2-b7d9e3002bfc4268a4827f6505e1b1bd_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-b7d9e3002bfc4268a4827f6505e1b1bd_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1240&quot; data-rawheight=&quot;380&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1240&quot; data-original=&quot;https://pic2.zhimg.com/v2-b7d9e3002bfc4268a4827f6505e1b1bd_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-b7d9e3002bfc4268a4827f6505e1b1bd_b.jpg&quot;&gt;&lt;/figure&gt;&lt;blockquote&gt;å›¾ 4ï¼šæ–°æ—§ &lt;code&gt;Version&lt;/code&gt; æŒ‰é¡ºåºé¦–å°¾ç›¸è¿ç»„æˆä¸€ä¸ªåŒå‘é“¾è¡¨ï¼Œ&lt;code&gt;VersionSet&lt;/code&gt; ç”¨æ¥ç®¡ç†æ‰€æœ‰çš„ &lt;code&gt;Version&lt;/code&gt;ï¼Œå®ƒæŒæœ‰ä¸€ä¸ª &lt;code&gt;current&lt;/code&gt; æŒ‡é’ˆç”¨æ¥æŒ‡å‘å½“å‰æœ€æ–°çš„ &lt;code&gt;Version&lt;/code&gt;ã€‚&lt;/blockquote&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;Garbage Collection&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;Garbage Collection (GC) çš„ç›®çš„æ˜¯å›æ”¶ç©ºé—´ï¼Œä¸€ä¸ªé«˜æ•ˆçš„ GC ç®—æ³•åº”è¯¥åœ¨æƒè¡¡å†™æ”¾å¤§å’Œç©ºé—´æ”¾å¤§çš„åŒæ—¶ï¼Œç”¨æœ€å°‘çš„å‘¨æœŸæ¥å›æ”¶æœ€å¤šçš„ç©ºé—´ã€‚åœ¨è®¾è®¡ GC çš„æ—¶å€™æœ‰ä¸¤ä¸ªä¸»è¦çš„é—®é¢˜éœ€è¦è€ƒè™‘ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;ä½•æ—¶è¿›è¡Œ GC&lt;/li&gt;&lt;li&gt;æŒ‘é€‰å“ªäº›æ–‡ä»¶è¿›è¡Œ GC&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;Titan ä½¿ç”¨ RocksDB æä¾›çš„ä¸¤ä¸ªç‰¹æ€§æ¥è§£å†³è¿™ä¸¤ä¸ªé—®é¢˜ï¼Œè¿™ä¸¤ä¸ªç‰¹æ€§åˆ†åˆ«æ˜¯ &lt;code&gt;TablePropertiesCollector&lt;/code&gt; å’Œ&lt;code&gt;EventListener&lt;/code&gt; ã€‚ä¸‹é¢å°†è®²è§£æˆ‘ä»¬æ˜¯å¦‚ä½•é€šè¿‡è¿™ä¸¤ä¸ªç‰¹æ€§æ¥è¾…åŠ© GC å·¥ä½œçš„ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;&lt;code&gt;BlobFileSizeCollector&lt;/code&gt; &lt;/b&gt;&lt;/p&gt;&lt;p&gt;RocksDB å…è®¸æˆ‘ä»¬ä½¿ç”¨è‡ªå®šä¹‰çš„ &lt;code&gt;TablePropertiesCollector&lt;/code&gt; æ¥æœé›† &lt;code&gt;SST&lt;/code&gt; ä¸Šçš„ properties å¹¶å†™å…¥åˆ°å¯¹åº”æ–‡ä»¶ä¸­å»ã€‚&lt;code&gt;Titan&lt;/code&gt; é€šè¿‡ä¸€ä¸ªè‡ªå®šä¹‰çš„ &lt;code&gt;TablePropertiesCollector&lt;/code&gt; â€”â€” &lt;code&gt;BlobFileSizeCollector&lt;/code&gt; æ¥æœé›†æ¯ä¸ª &lt;code&gt;SST&lt;/code&gt; ä¸­æœ‰å¤šå°‘æ•°æ®æ˜¯å­˜æ”¾åœ¨å“ªäº› &lt;code&gt;BlobFile&lt;/code&gt; ä¸Šçš„ï¼Œæˆ‘ä»¬å°†å®ƒæ”¶é›†åˆ°çš„ properties å‘½åä¸º &lt;code&gt;BlobFileSizeProperties&lt;/code&gt;ï¼Œå®ƒçš„å·¥ä½œæµç¨‹å’Œæ•°æ®æ ¼å¼å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-b6966365a68aff1249cf227580b075c3_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1240&quot; data-rawheight=&quot;346&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1240&quot; data-original=&quot;https://pic4.zhimg.com/v2-b6966365a68aff1249cf227580b075c3_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-b6966365a68aff1249cf227580b075c3_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1240&quot; data-rawheight=&quot;346&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1240&quot; data-original=&quot;https://pic4.zhimg.com/v2-b6966365a68aff1249cf227580b075c3_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-b6966365a68aff1249cf227580b075c3_b.jpg&quot;&gt;&lt;/figure&gt;&lt;blockquote&gt;å›¾ 5ï¼šå·¦è¾¹ &lt;code&gt;SST&lt;/code&gt; ä¸­ Index çš„æ ¼å¼ä¸ºï¼šç¬¬ä¸€åˆ—ä»£è¡¨ &lt;code&gt;BlobFile&lt;/code&gt; çš„æ–‡ä»¶ IDï¼Œç¬¬äºŒåˆ—ä»£è¡¨ blob record åœ¨ &lt;code&gt;BlobFile&lt;/code&gt; ä¸­çš„ offsetï¼Œç¬¬ä¸‰åˆ—ä»£è¡¨ blob record çš„ sizeã€‚å³è¾¹ &lt;code&gt;BlobFileSizeProperties&lt;/code&gt; ä¸­çš„æ¯ä¸€è¡Œä»£è¡¨ä¸€ä¸ª &lt;code&gt;BlobFile&lt;/code&gt; ä»¥åŠ &lt;code&gt;SST&lt;/code&gt; ä¸­æœ‰å¤šå°‘æ•°æ®ä¿å­˜åœ¨è¿™ä¸ª &lt;code&gt;BlobFile&lt;/code&gt; ä¸­ï¼Œç¬¬ä¸€åˆ—ä»£è¡¨ &lt;code&gt;BlobFile&lt;/code&gt; çš„æ–‡ä»¶ IDï¼Œç¬¬äºŒåˆ—ä»£è¡¨æ•°æ®å¤§å°ã€‚&lt;/blockquote&gt;&lt;p&gt;&lt;code&gt;&lt;b&gt;EventListener&lt;/b&gt;&lt;/code&gt; &lt;/p&gt;&lt;p&gt;æˆ‘ä»¬çŸ¥é“ RocksDB æ˜¯é€šè¿‡ Compaction æ¥ä¸¢å¼ƒæ—§ç‰ˆæœ¬æ•°æ®ä»¥å›æ”¶ç©ºé—´çš„ï¼Œå› æ­¤æ¯æ¬¡ Compaction å®Œæˆå Titan ä¸­çš„æŸäº› &lt;code&gt;BlobFile&lt;/code&gt; ä¸­ä¾¿å¯èƒ½æœ‰éƒ¨åˆ†æˆ–å…¨éƒ¨æ•°æ®è¿‡æœŸã€‚å› æ­¤æˆ‘ä»¬ä¾¿å¯ä»¥é€šè¿‡ç›‘å¬ Compaction äº‹ä»¶æ¥è§¦å‘ GCï¼Œé€šè¿‡æœé›†æ¯”å¯¹ Compaction ä¸­è¾“å…¥è¾“å‡º &lt;code&gt;SST&lt;/code&gt; çš„ &lt;code&gt;BlobFileSizeProperties&lt;/code&gt; æ¥å†³å®šæŒ‘é€‰å“ªäº› &lt;code&gt;BlobFile&lt;/code&gt; è¿›è¡Œ GCã€‚å…¶æµç¨‹å¤§æ¦‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-e4686b7ee8ae31e83799bef437730e43_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1240&quot; data-rawheight=&quot;652&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1240&quot; data-original=&quot;https://pic4.zhimg.com/v2-e4686b7ee8ae31e83799bef437730e43_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-e4686b7ee8ae31e83799bef437730e43_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1240&quot; data-rawheight=&quot;652&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1240&quot; data-original=&quot;https://pic4.zhimg.com/v2-e4686b7ee8ae31e83799bef437730e43_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-e4686b7ee8ae31e83799bef437730e43_b.jpg&quot;&gt;&lt;/figure&gt;&lt;blockquote&gt;å›¾ 6ï¼šinputs ä»£è¡¨å‚ä¸ Compaction çš„æ‰€æœ‰ &lt;code&gt;SST&lt;/code&gt; çš„ &lt;code&gt;BlobFileSizeProperties&lt;/code&gt;ï¼Œoutputs ä»£è¡¨ Compaction ç”Ÿæˆçš„æ‰€æœ‰ &lt;code&gt;SST&lt;/code&gt; çš„ &lt;code&gt;BlobFileSizeProperties&lt;/code&gt;ï¼Œdiscardable size æ˜¯é€šè¿‡è®¡ç®— inputs å’Œ outputs å¾—å‡ºçš„æ¯ä¸ª &lt;code&gt;BlobFile&lt;/code&gt; è¢«ä¸¢å¼ƒçš„æ•°æ®å¤§å°ï¼Œç¬¬ä¸€åˆ—ä»£è¡¨ &lt;code&gt;BlobFile&lt;/code&gt; çš„æ–‡ä»¶ IDï¼Œç¬¬äºŒåˆ—ä»£è¡¨è¢«ä¸¢å¼ƒçš„æ•°æ®å¤§å°ã€‚&lt;/blockquote&gt;&lt;p&gt;Titan ä¼šä¸ºæ¯ä¸ªæœ‰æ•ˆçš„ &lt;code&gt;BlobFile&lt;/code&gt; åœ¨å†…å­˜ä¸­ç»´æŠ¤ä¸€ä¸ª discardable size å˜é‡ï¼Œæ¯æ¬¡ Compaction ç»“æŸä¹‹åéƒ½å¯¹ç›¸åº”çš„ &lt;code&gt;BlobFile&lt;/code&gt; çš„ discardable size å˜é‡è¿›è¡Œç´¯åŠ ã€‚æ¯æ¬¡ GC å¼€å§‹æ—¶å°±å¯ä»¥é€šè¿‡æŒ‘é€‰ discardable size æœ€å¤§çš„ &lt;code&gt;BlobFile&lt;/code&gt; æ¥ä½œä¸ºä½œä¸ºå€™é€‰çš„æ–‡ä»¶ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;Sample&lt;/b&gt;&lt;/p&gt;&lt;p&gt;æ¯æ¬¡è¿›è¡Œ GC å‰æˆ‘ä»¬éƒ½ä¼šæŒ‘é€‰ä¸€ç³»åˆ—&lt;code&gt;BlobFile&lt;/code&gt;ä½œä¸ºå€™é€‰æ–‡ä»¶ï¼ŒæŒ‘é€‰çš„æ–¹æ³•å¦‚ä¸Šä¸€èŠ‚æ‰€è¿°ã€‚ä¸ºäº†å‡å°å†™æ”¾å¤§ï¼Œæˆ‘ä»¬å¯ä»¥å®¹å¿ä¸€å®šçš„ç©ºé—´æ”¾å¤§ï¼Œæ‰€ä»¥æˆ‘ä»¬åªæœ‰åœ¨&lt;code&gt;BlobFile&lt;/code&gt;å¯ä¸¢å¼ƒçš„æ•°æ®è¾¾åˆ°ä¸€å®šæ¯”ä¾‹ä¹‹åæ‰ä¼šå¯¹å…¶è¿›è¡Œ GCã€‚æˆ‘ä»¬ä½¿ç”¨ Sample ç®—æ³•æ¥è·å–æ¯ä¸ªå€™é€‰æ–‡ä»¶ä¸­å¯ä¸¢å¼ƒæ•°æ®çš„å¤§è‡´æ¯”ä¾‹ã€‚Sample ç®—æ³•çš„ä¸»è¦é€»è¾‘æ˜¯éšæœºå–&lt;code&gt;BlobFile&lt;/code&gt;ä¸­çš„ä¸€æ®µæ•°æ® Aï¼Œè®¡å…¶å¤§å°ä¸º aï¼Œç„¶åéå† A ä¸­çš„ keyï¼Œç´¯åŠ è¿‡æœŸçš„ key æ‰€åœ¨çš„ blob record çš„ size è®¡ä¸º dï¼Œæœ€åè®¡ç®—å¾—å‡º d å  a æ¯”å€¼ ä¸º rï¼Œå¦‚æœ r &amp;gt;=&lt;code&gt;discardable_ratio&lt;/code&gt;åˆ™å¯¹è¯¥&lt;code&gt;BlobFile&lt;/code&gt;è¿›è¡Œ GCï¼Œå¦åˆ™ä¸å¯¹å…¶è¿›è¡Œ GCã€‚ä¸Šä¸€èŠ‚æˆ‘ä»¬å·²ç»çŸ¥é“æ¯ä¸ª&lt;code&gt;BlobFile&lt;/code&gt;éƒ½ä¼šåœ¨å†…å­˜ä¸­ç»´æŠ¤ä¸€ä¸ª discardable sizeï¼Œå¦‚æœè¿™ä¸ª discardable size å æ•´ä¸ª&lt;code&gt;BlobFile&lt;/code&gt;æ•°æ®å¤§å°çš„æ¯”å€¼å·²ç»å¤§äºæˆ–ç­‰äº&lt;code&gt;discardable_ratio&lt;/code&gt;åˆ™ä¸éœ€è¦å¯¹å…¶è¿›è¡Œ Sampleã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;åŸºå‡†æµ‹è¯•&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;æˆ‘ä»¬ä½¿ç”¨&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/pingcap/go-ycsb&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;go-ycsb&lt;/a&gt;æµ‹è¯•äº† TiKV åœ¨ Txn Mode ä¸‹åˆ†åˆ«ä½¿ç”¨ RocksDB å’Œ Titan çš„æ€§èƒ½è¡¨ç°ï¼Œæœ¬èŠ‚æˆ‘ä¼šç®€è¦è¯´æ˜ä¸‹æˆ‘ä»¬çš„æµ‹è¯•æ–¹æ³•å’Œæµ‹è¯•ç»“æœã€‚ç”±äºç¯‡å¹…çš„åŸå› ï¼Œæˆ‘ä»¬åªæŒ‘é€‰ä¸¤ä¸ªå…¸å‹çš„ value size åšè¯´æ˜ï¼Œæ›´è¯¦ç»†çš„æµ‹è¯•åˆ†ææŠ¥å‘Šå°†ä¼šæ”¾åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;æµ‹è¯•ç¯å¢ƒ&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;CPUï¼šIntelÂ® XeonÂ® CPU E5-2630 v4 @ 2.20GHzï¼ˆ40ä¸ªæ ¸å¿ƒï¼‰&lt;/li&gt;&lt;li&gt;Memoryï¼š128GBï¼ˆæˆ‘ä»¬é€šè¿‡ Cgroup é™åˆ¶ TiKV è¿›ç¨‹ä½¿ç”¨å†…å­˜ä¸è¶…è¿‡ 32GBï¼‰&lt;/li&gt;&lt;li&gt;Diskï¼šSATA SSD 1.5TBï¼ˆ&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//linux.die.net/man/1/fio&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;fio&lt;/a&gt; æµ‹è¯•ï¼š4KB block size æ··åˆéšæœºè¯»å†™æƒ…å†µä¸‹è¯»å†™ IOPS åˆ†åˆ«ä¸º 43.8K å’Œ 18.7Kï¼‰&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;æµ‹è¯•è®¡åˆ’&lt;/b&gt;&lt;/p&gt;&lt;p&gt;æ•°æ®é›†é€‰å®šçš„åŸºæœ¬åŸåˆ™æ˜¯åŸå§‹æ•°æ®å¤§å°ï¼ˆä¸ç®—ä¸Šå†™æ”¾å¤§å› ç´ ï¼‰è¦æ¯”å¯ç”¨å†…å­˜å°ï¼Œè¿™æ ·å¯ä»¥é˜²æ­¢æ‰€æœ‰æ•°æ®è¢«ç¼“å­˜åˆ°å†…å­˜ä¸­ï¼Œå‡å°‘ Cache æ‰€å¸¦æ¥çš„å½±å“ã€‚è¿™é‡Œæˆ‘ä»¬é€‰ç”¨çš„æ•°æ®é›†å¤§å°æ˜¯ 64GBï¼Œè¿›ç¨‹çš„å†…å­˜ä½¿ç”¨é™åˆ¶æ˜¯ 32GBã€‚&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-654eb07d1a8074029fdff9da40502dd7_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1238&quot; data-rawheight=&quot;294&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1238&quot; data-original=&quot;https://pic4.zhimg.com/v2-654eb07d1a8074029fdff9da40502dd7_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-654eb07d1a8074029fdff9da40502dd7_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1238&quot; data-rawheight=&quot;294&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1238&quot; data-original=&quot;https://pic4.zhimg.com/v2-654eb07d1a8074029fdff9da40502dd7_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-654eb07d1a8074029fdff9da40502dd7_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;æˆ‘ä»¬ä¸»è¦æµ‹è¯• 5 ä¸ªå¸¸ç”¨çš„åœºæ™¯ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Data Loading Performanceï¼šä½¿ç”¨é¢„å…ˆè®¡ç®—å¥½çš„ key æ•°é‡å’Œå›ºå®šçš„ value å¤§å°ï¼Œä»¥ä¸€å®šçš„é€Ÿåº¦å¹¶å‘å†™å…¥ã€‚&lt;/li&gt;&lt;li&gt;Update Performanceï¼šç”±äº Titan åœ¨çº¯å†™å…¥åœºæ™¯ä¸‹ä¸éœ€è¦ GCï¼ˆ&lt;code&gt;BlobFile&lt;/code&gt; ä¸­æ²¡æœ‰å¯ä¸¢å¼ƒæ•°æ®ï¼‰ï¼Œå› æ­¤æˆ‘ä»¬è¿˜éœ€è¦é€šè¿‡æ›´æ–°æ¥æµ‹è¯• &lt;code&gt;GC&lt;/code&gt; å¯¹æ€§èƒ½çš„å½±å“ã€‚&lt;/li&gt;&lt;li&gt;Output Sizeï¼šè¿™ä¸€æ­¥æˆ‘ä»¬ä¼šæµ‹é‡æ›´æ–°åœºæ™¯å®Œæˆåå¼•æ“æ‰€å ç”¨çš„ç¡¬ç›˜ç©ºé—´å¤§å°ï¼Œä»¥æ­¤åæ˜  GC çš„ç©ºé—´å›æ”¶æ•ˆæœã€‚&lt;/li&gt;&lt;li&gt;Random Key Lookup Performanceï¼šè¿™ä¸€æ­¥ä¸»è¦æµ‹è¯•ç‚¹æŸ¥æ€§èƒ½ï¼Œå¹¶ä¸”ç‚¹æŸ¥æ¬¡æ•°è¦è¿œè¿œå¤§äº key çš„æ•°é‡ã€‚&lt;/li&gt;&lt;li&gt;Sorted Range Iteration Performanceï¼šè¿™ä¸€æ­¥ä¸»è¦æµ‹è¯•èŒƒå›´æŸ¥è¯¢çš„æ€§èƒ½ï¼Œæ¯æ¬¡æŸ¥è¯¢ 2 million ä¸ªç›¸è¿çš„ keyã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;æµ‹è¯•ç»“æœ&lt;/b&gt;&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-dbe299a64478cfd1507390cb4a920938_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1240&quot; data-rawheight=&quot;767&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1240&quot; data-original=&quot;https://pic1.zhimg.com/v2-dbe299a64478cfd1507390cb4a920938_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-dbe299a64478cfd1507390cb4a920938_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1240&quot; data-rawheight=&quot;767&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1240&quot; data-original=&quot;https://pic1.zhimg.com/v2-dbe299a64478cfd1507390cb4a920938_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-dbe299a64478cfd1507390cb4a920938_b.jpg&quot;&gt;&lt;/figure&gt;&lt;blockquote&gt;å›¾ 7 Data Loading Performanceï¼šTitan åœ¨å†™åœºæ™¯ä¸­çš„æ€§èƒ½è¦æ¯” RocksDB é«˜ 70% ä»¥ä¸Šï¼Œå¹¶ä¸”éšç€ value size çš„å˜å¤§ï¼Œè¿™ç§æ€§èƒ½çš„å·®å¼‚ä¼šæ›´åŠ æ˜æ˜¾ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæ•°æ®åœ¨å†™å…¥ KV Engine ä¹‹å‰ä¼šå…ˆå†™å…¥ Raft Logï¼Œå› æ­¤ Titan çš„æ€§èƒ½æå‡ä¼šè¢«æ‘Šè–„ï¼Œå®é™…ä¸Šè£¸æµ‹ RocksDB å’Œ Titan çš„è¯è¿™ç§æ€§èƒ½å·®å¼‚ä¼šæ›´å¤§ã€‚&lt;/blockquote&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-732c5f9c0ab0b43a7e134c1ad6e74f8f_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1240&quot; data-rawheight=&quot;767&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1240&quot; data-original=&quot;https://pic4.zhimg.com/v2-732c5f9c0ab0b43a7e134c1ad6e74f8f_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-732c5f9c0ab0b43a7e134c1ad6e74f8f_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1240&quot; data-rawheight=&quot;767&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1240&quot; data-original=&quot;https://pic4.zhimg.com/v2-732c5f9c0ab0b43a7e134c1ad6e74f8f_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-732c5f9c0ab0b43a7e134c1ad6e74f8f_b.jpg&quot;&gt;&lt;/figure&gt;&lt;blockquote&gt;å›¾ 8 Update Performanceï¼šTitan åœ¨æ›´æ–°åœºæ™¯ä¸­çš„æ€§èƒ½è¦æ¯” RocksDB é«˜ 180% ä»¥ä¸Šï¼Œè¿™ä¸»è¦å¾—ç›Šäº Titan ä¼˜ç§€çš„è¯»æ€§èƒ½å’Œè‰¯å¥½çš„ GC ç®—æ³•ã€‚&lt;/blockquote&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-fc669dcecc0cf1286ee308292ba4c48e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1240&quot; data-rawheight=&quot;767&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1240&quot; data-original=&quot;https://pic3.zhimg.com/v2-fc669dcecc0cf1286ee308292ba4c48e_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-fc669dcecc0cf1286ee308292ba4c48e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1240&quot; data-rawheight=&quot;767&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1240&quot; data-original=&quot;https://pic3.zhimg.com/v2-fc669dcecc0cf1286ee308292ba4c48e_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-fc669dcecc0cf1286ee308292ba4c48e_b.jpg&quot;&gt;&lt;/figure&gt;&lt;blockquote&gt;å›¾ 9 Output Sizeï¼šTitan çš„ç©ºé—´æ”¾å¤§ç›¸æ¯” RocksDB ç•¥é«˜ï¼Œè¿™ç§å·®è·ä¼šéšç€ Key æ•°é‡çš„å‡å°‘æœ‰ç•¥å¾®çš„ç¼©å°ï¼Œè¿™ä¸»è¦æ˜¯å› ä¸º &lt;code&gt;BlobFile&lt;/code&gt; ä¸­éœ€è¦å­˜å‚¨ Key è€Œé€ æˆçš„å†™æ”¾å¤§ã€‚&lt;/blockquote&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-2988e19ff909924ffd330a4776b0f974_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1240&quot; data-rawheight=&quot;767&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1240&quot; data-original=&quot;https://pic1.zhimg.com/v2-2988e19ff909924ffd330a4776b0f974_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-2988e19ff909924ffd330a4776b0f974_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1240&quot; data-rawheight=&quot;767&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1240&quot; data-original=&quot;https://pic1.zhimg.com/v2-2988e19ff909924ffd330a4776b0f974_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-2988e19ff909924ffd330a4776b0f974_b.jpg&quot;&gt;&lt;/figure&gt;&lt;blockquote&gt;å›¾ 10 Random Key Lookupï¼š Titan æ‹¥æœ‰æ¯” RocksDB æ›´å“è¶Šçš„ç‚¹è¯»æ€§èƒ½ï¼Œè¿™ä¸»è¦å¾—ç›Šä¸å°† value åˆ†ç¦»å‡º &lt;code&gt;LSM-tree&lt;/code&gt;çš„è®¾è®¡ä½¿å¾— &lt;code&gt;LSM-tree&lt;/code&gt; å˜å¾—æ›´å°ï¼Œå› æ­¤ Titan åœ¨ä½¿ç”¨åŒæ ·çš„å†…å­˜é‡æ—¶å¯ä»¥å°†æ›´å¤šçš„ &lt;code&gt;index&lt;/code&gt; ã€&lt;code&gt;filter&lt;/code&gt; å’Œ &lt;code&gt;DataBlock&lt;/code&gt; ç¼“å­˜åˆ° Block Cache ä¸­å»ã€‚è¿™ä½¿å¾—ç‚¹è¯»æ“ä½œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ä»…éœ€è¦ä¸€æ¬¡ IO å³å¯ï¼ˆä¸»è¦æ˜¯ç”¨äºä» &lt;code&gt;BlobFile&lt;/code&gt; ä¸­è¯»å–æ•°æ®ï¼‰ã€‚&lt;/blockquote&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-513126ff72f4ab14270dc383dc625751_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1240&quot; data-rawheight=&quot;767&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1240&quot; data-original=&quot;https://pic2.zhimg.com/v2-513126ff72f4ab14270dc383dc625751_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-513126ff72f4ab14270dc383dc625751_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1240&quot; data-rawheight=&quot;767&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1240&quot; data-original=&quot;https://pic2.zhimg.com/v2-513126ff72f4ab14270dc383dc625751_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-513126ff72f4ab14270dc383dc625751_b.jpg&quot;&gt;&lt;/figure&gt;&lt;blockquote&gt;å›¾ 11 Sorted Range Iterationï¼šTitan çš„èŒƒå›´æŸ¥è¯¢æ€§èƒ½ç›®å‰å’Œ RocksDB ç›¸æ¯”è¿˜æ˜¯æœ‰ä¸€å®šçš„å·®è·ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬æœªæ¥ä¼˜åŒ–çš„ä¸€ä¸ªé‡è¦æ–¹å‘ã€‚&lt;/blockquote&gt;&lt;p&gt;æœ¬æ¬¡æµ‹è¯•æˆ‘ä»¬å¯¹æ¯”äº†ä¸¤ä¸ªå…·æœ‰ä»£è¡¨æ€§çš„ value size åœ¨ 5 ç§ä¸åŒåœºæ™¯ä¸‹çš„æ€§èƒ½å·®å¼‚ï¼Œæ›´å¤šä¸åŒç²’åº¦çš„ value size çš„æµ‹è¯•å’Œæ›´è¯¦ç»†çš„æ€§èƒ½æŠ¥å‘Šæˆ‘ä»¬ä¼šæ”¾åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« å»è¯´æ˜ï¼Œå¹¶ä¸”æˆ‘ä»¬ä¼šä»æ›´å¤šçš„è§’åº¦ï¼ˆä¾‹å¦‚ CPU å’Œå†…å­˜çš„ä½¿ç”¨ç‡ç­‰ï¼‰å»åˆ†æ Titan å’Œ RocksDB çš„å·®å¼‚ã€‚ä»æœ¬æ¬¡æµ‹è¯•æˆ‘ä»¬å¯ä»¥å¤§è‡´å¾—å‡ºç»“è®ºï¼Œåœ¨å¤§ value çš„åœºæ™¯ä¸‹ï¼ŒTitan ä¼šæ¯” RocksDB æ‹¥æœ‰æ›´å¥½çš„å†™ã€æ›´æ–°å’Œç‚¹è¯»æ€§èƒ½ã€‚åŒæ—¶ï¼ŒTitan çš„èŒƒå›´æŸ¥è¯¢æ€§èƒ½å’Œç©ºé—´æ”¾å¤§éƒ½é€Šäº RocksDB ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;å…¼å®¹æ€§&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;ä¸€å¼€å§‹æˆ‘ä»¬ä¾¿å°†å…¼å®¹ RocksDB ä½œä¸ºè®¾è®¡ Titan çš„é¦–è¦ç›®æ ‡ï¼Œå› æ­¤æˆ‘ä»¬ä¿ç•™äº†ç»å¤§éƒ¨åˆ† RocksDB çš„ APIã€‚ç›®å‰ä»…æœ‰ä¸¤ä¸ª API æ˜¯æˆ‘ä»¬æ˜ç¡®ä¸æ”¯æŒçš„ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;code&gt;Merge&lt;/code&gt;&lt;/li&gt;&lt;li&gt;&lt;code&gt;SingleDelete&lt;/code&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;é™¤äº† &lt;code&gt;Open&lt;/code&gt; æ¥å£ä»¥å¤–ï¼Œå…¶ä»– API çš„å‚æ•°å’Œè¿”å›å€¼éƒ½å’Œ RocksDB ä¸€è‡´ã€‚å·²æœ‰çš„é¡¹ç›®åªéœ€è¦å¾ˆå°çš„æ”¹åŠ¨å³å¯ä»¥å°† &lt;code&gt;RocksDB&lt;/code&gt;å®ä¾‹å¹³æ»‘åœ°å‡çº§åˆ° Titanã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ Titan å¹¶ä¸æ”¯æŒå›é€€å› RocksDBã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;å¦‚ä½•ä½¿ç”¨ Titan&lt;/b&gt;&lt;/h2&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;åˆ›å»º DB&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;&lt;span&gt;&lt;/span&gt;#include &amp;lt;assert&amp;gt;
#include &quot;rocksdb/utilities/titandb/db.h&quot;

// Open DB
rocksdb::titandb::TitanDB* db;
rocksdb::titandb::TitanOptions options;
options.create_if_missing = true;
rocksdb::Status status =
  rocksdb::titandb::TitanDB::Open(options, &quot;/tmp/testdb&quot;, &amp;amp;db);
assert(status.ok());
...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æˆ–&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;&lt;span&gt;&lt;/span&gt;#include &amp;lt;assert&amp;gt;
#include &quot;rocksdb/utilities/titandb/db.h&quot;

// open DB with two column families
rocksdb::titandb::TitanDB* db;
std::vector&amp;lt;rocksdb::titandb::TitanCFDescriptor&amp;gt; column_families;
// have to open default column family
column_families.push_back(rocksdb::titandb::TitanCFDescriptor(
    kDefaultColumnFamilyName, rocksdb::titandb::TitanCFOptions()));
// open the new one, too
column_families.push_back(rocksdb::titandb::TitanCFDescriptor(
    &quot;new_cf&quot;, rocksdb::titandb::TitanCFOptions()));
std::vector&amp;lt;ColumnFamilyHandle*&amp;gt; handles;
s = rocksdb::titandb::TitanDB::Open(rocksdb::titandb::TitanDBOptions(), kDBPath,
                                    column_families, &amp;amp;handles, &amp;amp;db);
assert(s.ok());
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;Status&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;å’Œ RocksDB ä¸€æ ·ï¼ŒTitan ä½¿ç”¨ &lt;code&gt;rocksdb::Status&lt;/code&gt; æ¥ä½œä¸ºç»å¤§å¤šæ•° API çš„è¿”å›å€¼ï¼Œä½¿ç”¨è€…å¯ä»¥é€šè¿‡å®ƒæ£€æŸ¥æ‰§è¡Œç»“æœæ˜¯å¦æˆåŠŸï¼Œä¹Ÿå¯ä»¥é€šè¿‡å®ƒæ‰“å°é”™è¯¯ä¿¡æ¯ï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;&lt;span&gt;&lt;/span&gt;rocksdb::Status s = ...;
if (!s.ok()) cerr &amp;lt;&amp;lt; s.ToString() &amp;lt;&amp;lt; endl;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;é”€æ¯ DB&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;&lt;span&gt;&lt;/span&gt;std::string value;
rocksdb::Status s = db-&amp;gt;Get(rocksdb::ReadOptions(), key1, &amp;amp;value);
if (s.ok()) s = db-&amp;gt;Put(rocksdb::WriteOptions(), key2, value);
if (s.ok()) s = db-&amp;gt;Delete(rocksdb::WriteOptions(), key1);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;åœ¨ TiKV ä¸­ä½¿ç”¨ Titan&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;ç›®å‰ Titan åœ¨ TiKV ä¸­æ˜¯é»˜è®¤å…³é—­çš„ï¼Œæˆ‘ä»¬é€šè¿‡ TiKV çš„é…ç½®æ–‡ä»¶æ¥å†³å®šæ˜¯å¦å¼€å¯å’Œè®¾ç½® Titanï¼Œç›¸å…³çš„é…ç½®é¡¹åŒ…æ‹¬ &lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/tikv/tikv/blob/12a1ea8d13b6478c8a4d07f0bb7411f3367dc8f9/etc/config-template.toml%23L375&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;[rocksdb.titan]&lt;/a&gt;&lt;/code&gt; å’Œ &lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/tikv/tikv/blob/12a1ea8d13b6478c8a4d07f0bb7411f3367dc8f9/etc/config-template.toml%23L531&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;[rocksdb.defaultcf.titan]&lt;/a&gt;&lt;/code&gt;ï¼Œ å¼€å¯ Titan åªéœ€è¦è¿›è¡Œå¦‚ä¸‹é…ç½®å³å¯ï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;&lt;span&gt;&lt;/span&gt;[rocksdb.titan]
enabled = true
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ³¨æ„ä¸€æ—¦å¼€å¯ Titan å°±ä¸èƒ½å›é€€å› RocksDB äº†ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;æœªæ¥çš„å·¥ä½œ&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;ä¼˜åŒ– &lt;code&gt;Iterator&lt;/code&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&gt;æˆ‘ä»¬é€šè¿‡æµ‹è¯•å‘ç°ï¼Œç›®å‰ä½¿ç”¨ Titan åšèŒƒå›´æŸ¥è¯¢æ—¶ IO Util å¾ˆä½ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå…¶æ€§èƒ½ä¼šæ¯” RocksDB å·®çš„é‡è¦åŸå› ä¹‹ä¸€ã€‚å› æ­¤æˆ‘ä»¬è®¤ä¸º Titan çš„ &lt;code&gt;Iterator&lt;/code&gt; è¿˜å­˜åœ¨ç€å·¨å¤§çš„ä¼˜åŒ–ç©ºé—´ï¼Œæœ€ç®€å•çš„æ–¹æ³•æ˜¯å¯ä»¥é€šè¿‡æ›´åŠ æ¿€è¿›çš„ prefetch å’Œå¹¶è¡Œ prefetch ç­‰æ‰‹æ®µæ¥è¾¾åˆ°æå‡ &lt;code&gt;Iterator&lt;/code&gt; æ€§èƒ½çš„ç›®çš„ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;&lt;code&gt;GC&lt;/code&gt; é€Ÿåº¦æ§åˆ¶å’Œè‡ªåŠ¨è°ƒèŠ‚&lt;/b&gt;&lt;/p&gt;&lt;p&gt;é€šå¸¸æ¥è¯´ï¼ŒGC çš„é€Ÿåº¦å¤ªæ…¢ä¼šå¯¼è‡´ç©ºé—´æ”¾å¤§ä¸¥é‡ï¼Œè¿‡å¿«åˆä¼šå¯¹æœåŠ¡çš„ QPS å’Œå»¶æ—¶å¸¦æ¥å½±å“ã€‚ç›®å‰ Titan æ”¯æŒè‡ªåŠ¨ GCï¼Œè™½ç„¶å¯ä»¥é€šè¿‡å‡å°å¹¶å‘åº¦å’Œ batch size æ¥è¾¾åˆ°ä¸€å®šç¨‹åº¦é™åˆ¶ GC é€Ÿåº¦çš„ç›®çš„ï¼Œä½†æ˜¯ç”±äºæ¯ä¸ª &lt;code&gt;BlobFile&lt;/code&gt; ä¸­çš„ blob record æ•°ç›®ä¸å®šï¼Œè‹¥ &lt;code&gt;BlobFile&lt;/code&gt; ä¸­çš„ blob record è¿‡äºå¯†é›†ï¼Œå°†å…¶æœ‰æ•ˆçš„ key æ›´æ–°å› &lt;code&gt;LSM-tree&lt;/code&gt; æ—¶ä»ç„¶å¯èƒ½å µå¡ä¸šåŠ¡çš„å†™è¯·æ±‚ã€‚ä¸ºäº†è¾¾åˆ°æ›´åŠ ç²¾ç»†åŒ–çš„æ§åˆ¶ GC é€Ÿåº¦çš„ç›®çš„ï¼Œåç»­æˆ‘ä»¬å°†ä½¿ç”¨ &lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//en.wikipedia.org/wiki/Token_bucket&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Token Bucket&lt;/a&gt;&lt;/code&gt; ç®—æ³•é™åˆ¶ä¸€æ®µæ—¶é—´å†… GC èƒ½å¤Ÿæ›´æ–°çš„ key æ•°é‡ï¼Œä»¥é™ä½ GC å¯¹ QPS å’Œå»¶æ—¶çš„å½±å“ï¼Œä½¿æœåŠ¡æ›´åŠ ç¨³å®šã€‚&lt;/p&gt;&lt;p&gt;å¦ä¸€æ–¹é¢ï¼Œæˆ‘ä»¬ä¹Ÿæ­£åœ¨ç ”ç©¶è‡ªåŠ¨è°ƒèŠ‚ GC é€Ÿåº¦çš„ç®—æ³•ï¼Œè¿™æ ·æˆ‘ä»¬ä¾¿å¯ä»¥ï¼Œåœ¨æœåŠ¡é«˜å³°æœŸçš„æ—¶å€™é™ä½ GC é€Ÿåº¦æ¥æä¾›æ›´é«˜çš„æœåŠ¡è´¨é‡ï¼›åœ¨æœåŠ¡ä½å³°æœŸçš„æ—¶å€™æé«˜ GC é€Ÿåº¦æ¥åŠ å¿«ç©ºé—´çš„å›æ”¶ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;å¢åŠ ç”¨äºåˆ¤æ–­ key æ˜¯å¦å­˜åœ¨çš„ API&lt;/b&gt;&lt;/p&gt;&lt;p&gt;TiKV åœ¨æŸäº›åœºæ™¯ä¸‹ä»…éœ€è¦åˆ¤æ–­æŸä¸ª key æ˜¯å¦å­˜åœ¨ï¼Œè€Œä¸éœ€è¦è¯»å–å¯¹åº”çš„ valueã€‚é€šè¿‡æä¾›ä¸€ä¸ªè¿™æ ·çš„ API å¯ä»¥æå¤§åœ°æé«˜æ€§èƒ½ï¼Œå› ä¸ºæˆ‘ä»¬å·²ç»çœ‹åˆ°å°† value ç§»å‡º &lt;code&gt;LSM-tree&lt;/code&gt; ä¹‹åï¼Œ&lt;code&gt;LSM-tree&lt;/code&gt; æœ¬èº«ä¼šå˜çš„éå¸¸å°ï¼Œä»¥è‡³äºæˆ‘ä»¬å¯ä»¥å°†æ›´å¤šåœ° &lt;code&gt;index&lt;/code&gt;ã€&lt;code&gt;filter&lt;/code&gt; å’Œ &lt;code&gt;DataBlock&lt;/code&gt; å­˜æ”¾åˆ°å†…å­˜å½“ä¸­å»ï¼Œè¿™æ ·å»æ£€ç´¢æŸä¸ª key çš„æ—¶å€™å¯ä»¥åšåˆ°åªéœ€è¦å°‘é‡ç”šè‡³ä¸éœ€è¦ IO ã€‚&lt;/p&gt;&lt;p&gt;&lt;i&gt;&lt;b&gt;æ›´å¤šé˜…è¯»ï¼š&lt;/b&gt;&lt;/i&gt;&lt;/p&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//pingcap.com/blog-cn/&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic2.zhimg.com/v2-60ab5bd867c2434d70c957a02a2169e1_ipico.jpg&quot; data-image-width=&quot;1200&quot; data-image-height=&quot;1200&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;åšå®¢&lt;/a&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>ZoeyZhai</author>
<guid isPermaLink="false">2019-01-23-55521489</guid>
<pubDate>Wed, 23 Jan 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>TiDB-Lightning Toolset &amp; TiDB-DM æ­£å¼å¼€æºï¼Œå‰æ’å¼€â€œå‘â€ã€PR èµ°èµ·</title>
<link>https://henix.github.io/feeds/zhuanlan.newsql/2019-01-21-55397024.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/55397024&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-4edef4e37af3792ed09885ebb444570e_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;blockquote&gt;åœ¨åˆšåˆšç»“æŸçš„ TiDB DevCon 2019 ä¸Šï¼Œæˆ‘ä»¬å®£å¸ƒå°†å¤§å®¶&lt;b&gt;æœŸå¾…å·²ä¹…&lt;/b&gt;çš„ TiDB-Ligthning Toolset å’Œ TiDB-DM å¼€æºï¼ˆæƒŠä¸æƒŠå–œã€æ„ä¸æ„å¤–ï¼Ÿï¼ï¼‰ï¼Œæ„Ÿå…´è¶£çš„å°ä¼™ä¼´ä»¬èµ¶ç´§å‰æ’å…³æ³¨ä¸€æ³¢ï¼Œå¼€â€œå‘ï¼ˆissuesï¼‰â€è®¨è®ºï¼ŒPR èµ°èµ·ï¼&lt;/blockquote&gt;&lt;h2&gt;&lt;b&gt;TiDB-Lightning Toolset&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;TiDB-Lightning Toolset æ˜¯ä¸€å¥—å¿«é€Ÿå…¨é‡å¯¼å…¥ SQL dump æ–‡ä»¶åˆ° TiDB é›†ç¾¤çš„å·¥å…·é›†ï¼Œ&lt;/b&gt;è‡ª 2.1.0 ç‰ˆæœ¬èµ·éš TiDB å‘å¸ƒï¼Œæœ€æ–°çš„æµ‹è¯•ç»“æœæ˜¾ç¤ºï¼Œé€Ÿåº¦å¯è¾¾åˆ°ä¼ ç»Ÿæ‰§è¡Œ SQL å¯¼å…¥æ–¹å¼çš„è‡³å°‘ 5 å€ï¼Œå¯¼å…¥ 1T æ•°æ®éœ€è¦ 5 ï½ 6 ä¸ªå°æ—¶ï¼Œé€‚åˆåœ¨ä¸Šçº¿å‰ç”¨ä½œè¿ç§»ç°æœ‰çš„å¤§å‹æ•°æ®åº“åˆ°å…¨æ–°çš„ TiDB é›†ç¾¤ã€‚&lt;/p&gt;&lt;u&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-a2bf35e4f1559fb58731a5935c6ac73e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;451&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-a2bf35e4f1559fb58731a5935c6ac73e_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-a2bf35e4f1559fb58731a5935c6ac73e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;451&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-a2bf35e4f1559fb58731a5935c6ac73e_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-a2bf35e4f1559fb58731a5935c6ac73e_b.jpg&quot;&gt;&lt;/figure&gt;&lt;/u&gt;&lt;p&gt;&lt;b&gt;åŸç†è§£è¯»ï¼š&lt;/b&gt;&lt;u&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//www.pingcap.com/blog-cn/tidb-ecosystem-tools-2/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TiDB-Lightning Toolset ä»‹ç»&lt;/a&gt;&lt;/u&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;é¡¹ç›®åœ°å€ï¼š&lt;/b&gt;&lt;a href=&quot;http://link.zhihu.com/?target=http%3A//github.com/pingcap/tidb-lightning&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;github.com/pingcap/tidb-lightning&lt;/a&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;TiDB-DM&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;TiDB-DMï¼ˆData Migrationï¼‰æ˜¯ç”¨äºå°†æ•°æ®ä» MySQL/MariaDB è¿ç§»åˆ° TiDB çš„å·¥å…·ã€‚&lt;/b&gt;è¯¥å·¥å…·æ—¢æ”¯æŒä»¥å…¨é‡å¤‡ä»½æ–‡ä»¶çš„æ–¹å¼å°† MySQL/MariaDB çš„æ•°æ®å¯¼å…¥åˆ° TiDBï¼Œä¹Ÿæ”¯æŒé€šè¿‡è§£ææ‰§è¡Œ MySQL/MariaDB binlog çš„æ–¹å¼å°†æ•°æ®å¢é‡åŒæ­¥åˆ° TiDBã€‚ç‰¹åˆ«åœ°ï¼Œå¯¹äºæœ‰å¤šä¸ª MySQL/MariaDB å®ä¾‹çš„åˆ†åº“åˆ†è¡¨éœ€è¦åˆå¹¶ååŒæ­¥åˆ°åŒä¸€ä¸ª TiDB é›†ç¾¤çš„åœºæ™¯ï¼ŒDM æä¾›äº†è‰¯å¥½çš„æ”¯æŒã€‚å¦‚æœä½ éœ€è¦ä» MySQL/MariaDB è¿ç§»åˆ° TiDBï¼Œæˆ–è€…éœ€è¦å°† TiDB ä½œä¸º MySQL/MariaDB çš„ä»åº“ï¼ŒDM å°†æ˜¯ä¸€ä¸ªéå¸¸å¥½çš„é€‰æ‹©ã€‚&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-c81491308e3a85cb04da15391950e23e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;457&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-c81491308e3a85cb04da15391950e23e_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-c81491308e3a85cb04da15391950e23e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;457&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-c81491308e3a85cb04da15391950e23e_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-c81491308e3a85cb04da15391950e23e_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;åŸç†è§£è¯»ï¼š&lt;/b&gt;&lt;u&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//www.pingcap.com/blog-cn/tidb-ecosystem-tools-3/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TiDB-DM æ¶æ„è®¾è®¡ä¸å®ç°åŸç†&lt;/a&gt;&lt;/u&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;é¡¹ç›®åœ°å€ï¼š&lt;/b&gt;&lt;a href=&quot;http://link.zhihu.com/?target=http%3A//github.com/pingcap/dm&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;github.com/pingcap/dm&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>ZoeyZhai</author>
<guid isPermaLink="false">2019-01-21-55397024</guid>
<pubDate>Mon, 21 Jan 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>TiDB 3.0 Beta Release Notes</title>
<link>https://henix.github.io/feeds/zhuanlan.newsql/2019-01-21-55348308.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/55348308&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-897efb5b298c75e3f8ece404672f8d6b_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;blockquote&gt;2019 å¹´ 1 æœˆ 19 æ—¥ï¼ŒTiDB å‘å¸ƒ 3.0 Beta ç‰ˆï¼Œå¯¹åº” master branch çš„ TiDB-Ansibleã€‚ç›¸æ¯” 2.1 ç‰ˆæœ¬ï¼Œè¯¥ç‰ˆæœ¬å¯¹ç³»ç»Ÿç¨³å®šæ€§ã€ä¼˜åŒ–å™¨ã€ç»Ÿè®¡ä¿¡æ¯ä»¥åŠæ‰§è¡Œå¼•æ“åšäº†å¾ˆå¤šæ”¹è¿›ã€‚&lt;/blockquote&gt;&lt;h2&gt;&lt;b&gt;TiDB&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;æ–°ç‰¹æ€§&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;æ”¯æŒ View&lt;/li&gt;&lt;li&gt;æ”¯æŒ Window Function&lt;/li&gt;&lt;li&gt;æ”¯æŒ Range Partition&lt;/li&gt;&lt;li&gt;æ”¯æŒ Hash Partition&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;SQL ä¼˜åŒ–å™¨&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;é‡æ–°æ”¯æŒèšåˆæ¶ˆé™¤çš„ä¼˜åŒ–è§„åˆ™&lt;/li&gt;&lt;li&gt;ä¼˜åŒ– &lt;code&gt;NOT EXISTS&lt;/code&gt; å­æŸ¥è¯¢ï¼Œå°†å…¶è½¬åŒ–ä¸º Anti Semi Join&lt;/li&gt;&lt;li&gt;æ·»åŠ  &lt;code&gt;tidb_enable_cascades_planner&lt;/code&gt; å˜é‡ä»¥æ”¯æŒæ–°çš„ Cascades ä¼˜åŒ–å™¨ã€‚ç›®å‰ Cascades ä¼˜åŒ–å™¨å°šæœªå®ç°å®Œå…¨ï¼Œé»˜è®¤å…³é—­&lt;/li&gt;&lt;li&gt;æ”¯æŒåœ¨äº‹åŠ¡ä¸­ä½¿ç”¨ Index Join&lt;/li&gt;&lt;li&gt;ä¼˜åŒ– Outer Join ä¸Šçš„å¸¸é‡ä¼ æ’­ï¼Œä½¿å¾—å¯¹ Join ç»“æœé‡Œå’Œ Outer è¡¨ç›¸å…³çš„è¿‡æ»¤æ¡ä»¶èƒ½å¤Ÿä¸‹æ¨è¿‡ Outer Join åˆ° Outer è¡¨ä¸Šï¼Œå‡å°‘ Outer Join çš„æ— ç”¨è®¡ç®—é‡ï¼Œæå‡æ‰§è¡Œæ€§èƒ½&lt;/li&gt;&lt;li&gt;è°ƒæ•´æŠ•å½±æ¶ˆé™¤çš„ä¼˜åŒ–è§„åˆ™åˆ°èšåˆæ¶ˆé™¤ä¹‹åï¼Œæ¶ˆé™¤æ‰å†—ä½™çš„ &lt;code&gt;Project&lt;/code&gt; ç®—å­&lt;/li&gt;&lt;li&gt;ä¼˜åŒ– &lt;code&gt;IFNULL&lt;/code&gt; å‡½æ•°ï¼Œå½“è¾“å…¥å‚æ•°å…·æœ‰é NULL çš„å±æ€§çš„æ—¶å€™ï¼Œæ¶ˆé™¤è¯¥å‡½æ•°&lt;/li&gt;&lt;li&gt;æ”¯æŒå¯¹ &lt;code&gt;_tidb_rowid&lt;/code&gt; æ„é€ æŸ¥è¯¢çš„ Rangeï¼Œé¿å…å…¨è¡¨æ‰«ï¼Œå‡è½»é›†ç¾¤å‹åŠ›&lt;/li&gt;&lt;li&gt;ä¼˜åŒ– &lt;code&gt;IN&lt;/code&gt; å­æŸ¥è¯¢ä¸ºå…ˆèšåˆååš Inner Join å¹¶ï¼Œæ·»åŠ å˜é‡ &lt;code&gt;tidb_opt_insubq_to_join_and_agg&lt;/code&gt; ä»¥æ§åˆ¶æ˜¯å¦å¼€å¯è¯¥ä¼˜åŒ–è§„åˆ™å¹¶é»˜è®¤æ‰“å¼€&lt;/li&gt;&lt;li&gt;æ”¯æŒåœ¨ &lt;code&gt;DO&lt;/code&gt; è¯­å¥ä¸­ä½¿ç”¨å­æŸ¥è¯¢&lt;/li&gt;&lt;li&gt;æ·»åŠ  Outer Join æ¶ˆé™¤çš„ä¼˜åŒ–è§„åˆ™ï¼Œå‡å°‘ä¸å¿…è¦çš„æ‰«è¡¨å’Œ Join æ“ä½œï¼Œæå‡æ‰§è¡Œæ€§èƒ½&lt;/li&gt;&lt;li&gt;ä¿®æ”¹ &lt;code&gt;TIDB_INLJ&lt;/code&gt; ä¼˜åŒ–å™¨ Hint çš„è¡Œä¸ºï¼Œä¼˜åŒ–å™¨å°†ä½¿ç”¨ Hint ä¸­æŒ‡å®šçš„è¡¨å½“åš Index Join çš„ Inner è¡¨&lt;/li&gt;&lt;li&gt;æ›´å¤§èŒƒå›´çš„å¯ç”¨ &lt;code&gt;PointGet&lt;/code&gt;ï¼Œä½¿å¾—å½“ Prepare è¯­å¥çš„æ‰§è¡Œè®¡åˆ’ç¼“å­˜ç”Ÿæ•ˆæ—¶ä¹Ÿèƒ½åˆ©ç”¨ä¸Šå®ƒ&lt;/li&gt;&lt;li&gt;å¼•å…¥è´ªå¿ƒçš„ Join Reorder ç®—æ³•ï¼Œä¼˜åŒ–å¤šè¡¨ Join æ—¶ Join é¡ºåºé€‰æ‹©çš„é—®é¢˜&lt;/li&gt;&lt;li&gt;æ”¯æŒ View&lt;/li&gt;&lt;li&gt;æ”¯æŒ Window Function&lt;/li&gt;&lt;li&gt;å½“ &lt;code&gt;TIDB_INLJ&lt;/code&gt; æœªç”Ÿæ•ˆæ—¶ï¼Œè¿”å› warning ç»™å®¢æˆ·ç«¯ï¼Œå¢å¼ºæ˜“ç”¨æ€§&lt;/li&gt;&lt;li&gt;æ”¯æŒæ ¹æ®è¿‡æ»¤æ¡ä»¶å’Œè¡¨çš„ç»Ÿè®¡ä¿¡æ¯æ¨å¯¼è¿‡æ»¤åæ•°æ®çš„ç»Ÿè®¡ä¿¡æ¯çš„åŠŸèƒ½&lt;/li&gt;&lt;li&gt;å¢å¼º Range Partition çš„ Partition Pruning ä¼˜åŒ–è§„åˆ™&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;SQL æ‰§è¡Œå¼•æ“&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;ä¼˜åŒ– Merge Join ç®—å­ï¼Œä½¿å…¶æ”¯æŒç©ºçš„ &lt;code&gt;ON&lt;/code&gt; æ¡ä»¶&lt;/li&gt;&lt;li&gt;ä¼˜åŒ–æ—¥å¿—ï¼Œæ‰“å°æ‰§è¡Œ &lt;code&gt;EXECUTE&lt;/code&gt; è¯­å¥æ—¶ä½¿ç”¨çš„ç”¨æˆ·å˜é‡&lt;/li&gt;&lt;li&gt;ä¼˜åŒ–æ—¥å¿—ï¼Œä¸º &lt;code&gt;COMMIT&lt;/code&gt; è¯­å¥æ‰“å°æ…¢æŸ¥è¯¢ä¿¡æ¯&lt;/li&gt;&lt;li&gt;æ”¯æŒ &lt;code&gt;EXPLAIN ANALYZE&lt;/code&gt; åŠŸèƒ½ï¼Œä½¿å¾— SQL è°ƒä¼˜è¿‡ç¨‹æ›´åŠ ç®€å•&lt;/li&gt;&lt;li&gt;ä¼˜åŒ–åˆ—å¾ˆå¤šçš„å®½è¡¨çš„å†™å…¥æ€§èƒ½&lt;/li&gt;&lt;li&gt;æ”¯æŒ &lt;code&gt;admin show next_row_id&lt;/code&gt;&lt;/li&gt;&lt;li&gt;æ·»åŠ å˜é‡ &lt;code&gt;tidb_init_chunk_size&lt;/code&gt; ä»¥æ§åˆ¶æ‰§è¡Œå¼•æ“ä½¿ç”¨çš„åˆå§‹ Chunk å¤§å°&lt;/li&gt;&lt;li&gt;å®Œå–„ &lt;code&gt;shard_row_id_bits&lt;/code&gt;ï¼Œå¯¹è‡ªå¢ ID åšè¶Šç•Œæ£€æŸ¥&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;&lt;code&gt;Prepare&lt;/code&gt;è¯­å¥&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;å¯¹åŒ…å«å­æŸ¥è¯¢çš„ &lt;code&gt;Prepare&lt;/code&gt; è¯­å¥ï¼Œç¦æ­¢å…¶æ·»åŠ åˆ° &lt;code&gt;Prepare&lt;/code&gt; è¯­å¥çš„æ‰§è¡Œè®¡åˆ’ç¼“å­˜ä¸­ï¼Œç¡®ä¿è¾“å…¥ä¸åŒçš„ç”¨æˆ·å˜é‡æ—¶æ‰§è¡Œè®¡åˆ’çš„æ­£ç¡®æ€§&lt;/li&gt;&lt;li&gt;ä¼˜åŒ– &lt;code&gt;Prepare&lt;/code&gt; è¯­å¥çš„æ‰§è¡Œè®¡åˆ’ç¼“å­˜ï¼Œä½¿å¾—å½“è¯­å¥ä¸­åŒ…å«éç¡®å®šæ€§å‡½æ•°çš„æ—¶å€™ï¼Œè¯¥è¯­å¥çš„æ‰§è¡Œè®¡åˆ’ä¹Ÿèƒ½è¢«ç¼“å­˜&lt;/li&gt;&lt;li&gt;ä¼˜åŒ– &lt;code&gt;Prepare&lt;/code&gt; è¯­å¥çš„æ‰§è¡Œè®¡åˆ’ç¼“å­˜ï¼Œä½¿å¾— &lt;code&gt;DELETE&lt;/code&gt;/&lt;code&gt;UPDATE&lt;/code&gt;/&lt;code&gt;INSERT&lt;/code&gt; çš„æ‰§è¡Œè®¡åˆ’ä¹Ÿèƒ½è¢«ç¼“å­˜&lt;/li&gt;&lt;li&gt;ä¼˜åŒ– &lt;code&gt;Prepare&lt;/code&gt; è¯­å¥çš„æ‰§è¡Œè®¡åˆ’ç¼“å­˜ï¼Œå½“æ‰§è¡Œ &lt;code&gt;DEALLOCATE&lt;/code&gt; è¯­å¥æ—¶ä»ç¼“å­˜ä¸­å‰”é™¤å¯¹åº”çš„æ‰§è¡Œè®¡åˆ’&lt;/li&gt;&lt;li&gt;ä¼˜åŒ– &lt;code&gt;Prepare&lt;/code&gt; è¯­å¥çš„æ‰§è¡Œè®¡åˆ’ç¼“å­˜ï¼Œé€šè¿‡æ§åˆ¶å…¶å†…å­˜ä½¿ç”¨ä»¥é¿å…ç¼“å­˜è¿‡å¤šæ‰§è¡Œè®¡åˆ’å¯¼è‡´ TiDB OOM çš„é—®é¢˜&lt;/li&gt;&lt;li&gt;ä¼˜åŒ– &lt;code&gt;Prepare&lt;/code&gt; è¯­å¥ï¼Œä½¿å¾— &lt;code&gt;ORDER BY&lt;/code&gt;/&lt;code&gt;GROUP BY&lt;/code&gt;/&lt;code&gt;LIMIT&lt;/code&gt; å­å¥ä¸­å¯ä»¥ä½¿ç”¨ â€œ?â€ å ä½ç¬¦&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;æƒé™ç®¡ç†&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;å¢åŠ å¯¹ &lt;code&gt;ANALYZE&lt;/code&gt; è¯­å¥çš„æƒé™æ£€æŸ¥&lt;/li&gt;&lt;li&gt;å¢åŠ å¯¹ &lt;code&gt;USE&lt;/code&gt; è¯­å¥çš„æƒé™æ£€æŸ¥&lt;/li&gt;&lt;li&gt;å¢åŠ å¯¹ &lt;code&gt;SET GLOBAL&lt;/code&gt; è¯­å¥çš„æƒé™æ£€æŸ¥&lt;/li&gt;&lt;li&gt;å¢åŠ å¯¹ &lt;code&gt;SHOW PROCESSLIST&lt;/code&gt; è¯­å¥çš„æƒé™æ£€æŸ¥&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;Server&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;æ”¯æŒäº†å¯¹ SQL è¯­å¥çš„ &lt;code&gt;Trace&lt;/code&gt; åŠŸèƒ½&lt;/li&gt;&lt;li&gt;æ”¯æŒäº†æ’ä»¶æ¡†æ¶&lt;/li&gt;&lt;li&gt;æ”¯æŒåŒæ—¶ä½¿ç”¨ &lt;code&gt;unix_socket&lt;/code&gt; å’Œ TCP ä¸¤ç§æ–¹å¼è¿æ¥æ•°æ®åº“&lt;/li&gt;&lt;li&gt;æ”¯æŒäº†ç³»ç»Ÿå˜é‡ &lt;code&gt;interactive_timeout&lt;/code&gt;&lt;/li&gt;&lt;li&gt;æ”¯æŒäº†ç³»ç»Ÿå˜é‡ &lt;code&gt;wait_timeout&lt;/code&gt;&lt;/li&gt;&lt;li&gt;æä¾›äº†å˜é‡ &lt;code&gt;tidb_batch_commit&lt;/code&gt;ï¼Œå¯ä»¥æŒ‰è¯­å¥æ•°å°†äº‹åŠ¡åˆ†è§£ä¸ºå¤šä¸ªäº‹åŠ¡&lt;/li&gt;&lt;li&gt;æ”¯æŒ &lt;code&gt;ADMIN SHOW SLOW&lt;/code&gt; è¯­å¥ï¼Œæ–¹ä¾¿æŸ¥çœ‹æ…¢æ—¥å¿—&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;å…¼å®¹æ€§&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;æ”¯æŒäº† &lt;code&gt;ALLOW_INVALID_DATES&lt;/code&gt; è¿™ç§ SQL mode&lt;/li&gt;&lt;li&gt;æå‡äº† load data å¯¹ CSV æ–‡ä»¶çš„å®¹é”™èƒ½åŠ›&lt;/li&gt;&lt;li&gt;æ”¯æŒäº† MySQL 320 æ¡æ‰‹åè®®&lt;/li&gt;&lt;li&gt;æ”¯æŒå°† unsigned bigint åˆ—å£°æ˜ä¸ºè‡ªå¢åˆ—&lt;/li&gt;&lt;li&gt;æ”¯æŒ &lt;code&gt;SHOW CREATE DATABASE IF NOT EXISTS&lt;/code&gt; è¯­æ³•&lt;/li&gt;&lt;li&gt;å½“è¿‡æ»¤æ¡ä»¶ä¸­åŒ…å«ç”¨æˆ·å˜é‡æ—¶ä¸å¯¹å…¶è¿›è¡Œè°“è¯ä¸‹æ¨çš„æ“ä½œï¼Œæ›´åŠ å…¼å®¹ MySQL ä¸­ä½¿ç”¨ç”¨æˆ·å˜é‡æ¨¡æ‹Ÿ Window Function çš„è¡Œä¸º&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;DDL&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;æ”¯æŒå¿«é€Ÿæ¢å¤è¯¯åˆ é™¤çš„è¡¨&lt;/li&gt;&lt;li&gt;æ”¯æŒåŠ¨æ€è°ƒæ•´ ADD INDEX çš„å¹¶å‘æ•°&lt;/li&gt;&lt;li&gt;æ”¯æŒæ›´æ”¹è¡¨æˆ–è€…åˆ—çš„å­—ç¬¦é›†åˆ° utf8/utf8mb4&lt;/li&gt;&lt;li&gt;é»˜è®¤å­—ç¬¦é›†ä» &lt;code&gt;utf8&lt;/code&gt; å˜ä¸º &lt;code&gt;utf8mb4&lt;/code&gt;&lt;/li&gt;&lt;li&gt;æ”¯æŒ RANGE PARTITION&lt;/li&gt;&lt;/ul&gt;&lt;h2&gt;&lt;b&gt;Tools&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;TiDB-Lightning&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;å¤§å¹…ä¼˜åŒ– SQL è½¬ KV çš„å¤„ç†é€Ÿåº¦&lt;/li&gt;&lt;li&gt;å¯¹å•è¡¨æ”¯æŒ batch å¯¼å…¥ï¼Œæé«˜å¯¼å…¥æ€§èƒ½å’Œç¨³å®šæ€§&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;PD&lt;/b&gt;&lt;/h2&gt;&lt;ul&gt;&lt;li&gt;å¢åŠ  &lt;code&gt;RegionStorage&lt;/code&gt; å•ç‹¬å­˜å‚¨ Region å…ƒä¿¡æ¯&lt;/li&gt;&lt;li&gt;å¢åŠ  shuffle hot region è°ƒåº¦&lt;/li&gt;&lt;li&gt;å¢åŠ è°ƒåº¦å‚æ•°ç›¸å…³ Metrics&lt;/li&gt;&lt;li&gt;å¢åŠ é›†ç¾¤ Label ä¿¡æ¯ç›¸å…³ Metrics&lt;/li&gt;&lt;li&gt;å¢åŠ å¯¼å…¥æ•°æ®åœºæ™¯æ¨¡æ‹Ÿ&lt;/li&gt;&lt;li&gt;ä¿®å¤ Leader é€‰ä¸¾ç›¸å…³çš„ Watch é—®é¢˜&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;TiKV&lt;/b&gt;&lt;/h2&gt;&lt;ul&gt;&lt;li&gt;æ”¯æŒäº†åˆ†å¸ƒå¼ GC&lt;/li&gt;&lt;li&gt;åœ¨ Apply snapshot ä¹‹å‰æ£€æŸ¥ RocksDB level 0 æ–‡ä»¶ï¼Œé¿å…äº§ç”Ÿ Write stall&lt;/li&gt;&lt;li&gt;æ”¯æŒäº†é€†å‘ &lt;code&gt;raw_scan&lt;/code&gt; å’Œ &lt;code&gt;raw_batch_scan&lt;/code&gt;&lt;/li&gt;&lt;li&gt;æ›´å¥½çš„å¤ä»¤æ—¶æ”¯æŒ&lt;/li&gt;&lt;li&gt;æ”¯æŒäº†ä½¿ç”¨ HTTP æ–¹å¼è·å–ç›‘æ§ä¿¡æ¯&lt;/li&gt;&lt;li&gt;æ”¯æŒæ‰¹é‡æ–¹å¼æ¥æ”¶å’Œå‘é€ Raft æ¶ˆæ¯&lt;/li&gt;&lt;li&gt;å¼•å…¥äº†æ–°çš„å­˜å‚¨å¼•æ“ Titan&lt;/li&gt;&lt;li&gt;å‡çº§ gRPC åˆ° v1.17.2&lt;/li&gt;&lt;li&gt;æ”¯æŒæ‰¹é‡æ–¹å¼æ¥æ”¶å®¢æˆ·ç«¯è¯·æ±‚å’Œå‘é€å›å¤&lt;/li&gt;&lt;li&gt;å¤šçº¿ç¨‹ Apply&lt;/li&gt;&lt;li&gt;çº¿ç¨‹ Raftstore&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;è‹±æ–‡ç‰ˆ Release Notes&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/pingcap/docs/blob/master/releases/3.0beta.md&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic3.zhimg.com/v2-2e73d3d3251663decc70dfbbe5be5f6a_ipico.jpg&quot; data-image-width=&quot;283&quot; data-image-height=&quot;283&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;pingcap/docs&lt;/a&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>ZoeyZhai</author>
<guid isPermaLink="false">2019-01-21-55348308</guid>
<pubDate>Mon, 21 Jan 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>TiDB åœ¨è½¬è½¬çš„ä¸šåŠ¡å®æˆ˜</title>
<link>https://henix.github.io/feeds/zhuanlan.newsql/2019-01-16-55026939.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/55026939&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-eb4578b6386a0021b17d7c418e728fbe_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;blockquote&gt;&lt;b&gt;ä½œè€…ä»‹ç»&lt;/b&gt;&lt;br&gt;é™ˆç»´ï¼Œè½¬è½¬ä¼˜å“æŠ€æœ¯éƒ¨ RDã€‚&lt;/blockquote&gt;&lt;p&gt;ä¸–ç•Œçº§çš„å¼€æºåˆ†å¸ƒå¼æ•°æ®åº“ TiDB è‡ª 2016 å¹´ 12 æœˆæ­£å¼å‘å¸ƒç¬¬ä¸€ä¸ªç‰ˆæœ¬ä»¥æ¥ï¼Œä¸šå†…è¯¸å¤šå…¬å¸é€æ­¥å¼•å…¥ä½¿ç”¨ï¼Œå¹¶å–å¾—å¹¿æ³›è®¤å¯ã€‚&lt;/p&gt;&lt;p&gt;å¯¹äºäº’è”ç½‘å…¬å¸ï¼Œæ•°æ®å­˜å‚¨çš„é‡è¦æ€§ä¸è¨€è€Œå–»ã€‚åœ¨ NewSQL æ•°æ®åº“å‡ºç°ä¹‹å‰ï¼Œä¸€èˆ¬é‡‡ç”¨å•æœºæ•°æ®åº“ï¼ˆæ¯”å¦‚ MySQLï¼‰ä½œä¸ºå­˜å‚¨ï¼Œéšç€æ•°æ®é‡çš„å¢åŠ ï¼Œâ€œåˆ†åº“åˆ†è¡¨â€æ˜¯æ—©æ™šé¢ä¸´çš„é—®é¢˜ï¼Œå³ä½¿æœ‰è¯¸å¦‚ MyCatã€ShardingJDBC ç­‰ä¼˜ç§€çš„ä¸­é—´ä»¶ï¼Œâ€œåˆ†åº“åˆ†è¡¨â€è¿˜æ˜¯ç»™ RD å’Œ DBA å¸¦æ¥è¾ƒé«˜çš„æˆæœ¬ï¼›NewSQL æ•°æ®åº“å‡ºç°åï¼Œç”±äºå®ƒä¸ä»…æœ‰ NoSQL å¯¹æµ·é‡æ•°æ®çš„ç®¡ç†å­˜å‚¨èƒ½åŠ›ã€è¿˜æ”¯æŒä¼ ç»Ÿå…³ç³»æ•°æ®åº“çš„ ACID å’Œ SQLï¼Œæ‰€ä»¥å¯¹ä¸šåŠ¡å¼€å‘æ¥è¯´ï¼Œå­˜å‚¨é—®é¢˜å·²ç»å˜å¾—æ›´åŠ ç®€å•å‹å¥½ï¼Œè¿›è€Œå¯ä»¥æ›´ä¸“æ³¨äºä¸šåŠ¡æœ¬èº«ã€‚è€Œ TiDBï¼Œæ­£æ˜¯ NewSQL çš„ä¸€ä¸ªæ°å‡ºä»£è¡¨ï¼&lt;/p&gt;&lt;p&gt;ç«™åœ¨ä¸šåŠ¡å¼€å‘çš„è§†è§’ï¼ŒTiDB æœ€å¸å¼•äººçš„å‡ å¤§ç‰¹æ€§æ˜¯ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;æ”¯æŒ MySQL åè®®ï¼ˆå¼€å‘æ¥å…¥æˆæœ¬ä½ï¼‰ï¼›&lt;/li&gt;&lt;li&gt;100% æ”¯æŒäº‹åŠ¡ï¼ˆæ•°æ®ä¸€è‡´æ€§å®ç°ç®€å•ã€å¯é ï¼‰ï¼›&lt;/li&gt;&lt;li&gt;æ— é™æ°´å¹³æ‹“å±•ï¼ˆä¸å¿…è€ƒè™‘åˆ†åº“åˆ†è¡¨ï¼‰ã€‚&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;åŸºäºè¿™å‡ å¤§ç‰¹æ€§ï¼ŒTiDB åœ¨ä¸šåŠ¡å¼€å‘ä¸­æ˜¯å€¼å¾—æ¨å¹¿å’Œå®è·µçš„ï¼Œä½†æ˜¯ï¼Œå®ƒæ¯•ç«Ÿä¸æ˜¯ä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“ï¼Œä»¥è‡´æˆ‘ä»¬å¯¹å…³ç³»å‹æ•°æ®åº“çš„ä¸€äº›ä½¿ç”¨ç»éªŒå’Œç§¯ç´¯ï¼Œåœ¨ TiDB ä¸­æ˜¯å­˜åœ¨å·®å¼‚çš„ï¼Œç°ä¸»è¦é˜è¿°â€œäº‹åŠ¡â€å’Œâ€œæŸ¥è¯¢â€ä¸¤æ–¹é¢çš„å·®å¼‚ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;TiDB äº‹åŠ¡å’Œ MySQL äº‹åŠ¡çš„å·®å¼‚&lt;/b&gt;&lt;/h2&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;MySQL äº‹åŠ¡å’Œ TiDB äº‹åŠ¡å¯¹æ¯”&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-f0bc66dc787eead6082fb48e978407d1_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;864&quot; data-rawheight=&quot;400&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;864&quot; data-original=&quot;https://pic2.zhimg.com/v2-f0bc66dc787eead6082fb48e978407d1_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-f0bc66dc787eead6082fb48e978407d1_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;864&quot; data-rawheight=&quot;400&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;864&quot; data-original=&quot;https://pic2.zhimg.com/v2-f0bc66dc787eead6082fb48e978407d1_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-f0bc66dc787eead6082fb48e978407d1_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;åœ¨ TiDB ä¸­æ‰§è¡Œçš„äº‹åŠ¡ bï¼Œè¿”å›å½±å“æ¡æ•°æ˜¯ 1ï¼ˆè®¤ä¸ºå·²ç»ä¿®æ”¹æˆåŠŸï¼‰ï¼Œä½†æ˜¯æäº¤åæŸ¥è¯¢ï¼Œstatus å´ä¸æ˜¯äº‹åŠ¡ b ä¿®æ”¹çš„å€¼ï¼Œè€Œæ˜¯äº‹åŠ¡ a ä¿®æ”¹çš„å€¼ã€‚&lt;/p&gt;&lt;p&gt;å¯è§ï¼ŒMySQL äº‹åŠ¡å’Œ TiDB äº‹åŠ¡å­˜åœ¨è¿™æ ·çš„å·®å¼‚ï¼š&lt;/p&gt;&lt;p&gt;MySQL äº‹åŠ¡ä¸­ï¼Œå¯ä»¥é€šè¿‡å½±å“æ¡æ•°ï¼Œä½œä¸ºå†™å…¥ï¼ˆæˆ–ä¿®æ”¹ï¼‰æ˜¯å¦æˆåŠŸçš„ä¾æ®ï¼›è€Œåœ¨ TiDB ä¸­ï¼Œè¿™å´æ˜¯ä¸å¯è¡Œçš„ï¼&lt;/p&gt;&lt;p&gt;ä½œä¸ºå¼€å‘è€…æˆ‘ä»¬éœ€è¦è€ƒè™‘ä¸‹é¢çš„é—®é¢˜ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;åŒæ­¥ RPC è°ƒç”¨ä¸­ï¼Œå¦‚æœéœ€è¦ä¸¥æ ¼ä¾èµ–å½±å“æ¡æ•°ä»¥ç¡®è®¤è¿”å›å€¼ï¼Œé‚£å°†å¦‚ä½•æ˜¯å¥½ï¼Ÿ&lt;/li&gt;&lt;li&gt;å¤šè¡¨æ“ä½œä¸­ï¼Œå¦‚æœéœ€è¦ä¸¥æ ¼ä¾èµ–æŸä¸ªä¸»è¡¨æ•°æ®æ›´æ–°ç»“æœï¼Œä½œä¸ºæ˜¯å¦æ›´æ–°ï¼ˆæˆ–å†™å…¥ï¼‰å…¶ä»–è¡¨çš„åˆ¤æ–­ä¾æ®ï¼Œé‚£åˆå°†å¦‚ä½•æ˜¯å¥½ï¼Ÿ&lt;/li&gt;&lt;/ol&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;åŸå› åˆ†æåŠè§£å†³æ–¹æ¡ˆ&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;å¯¹äº MySQLï¼Œå½“æ›´æ–°æŸæ¡è®°å½•æ—¶ï¼Œä¼šå…ˆè·å–è¯¥è®°å½•å¯¹åº”çš„è¡Œçº§é”ï¼ˆæ’ä»–é”ï¼‰ï¼Œè·å–æˆåŠŸåˆ™è¿›è¡Œåç»­çš„äº‹åŠ¡æ“ä½œï¼Œè·å–å¤±è´¥åˆ™é˜»å¡ç­‰å¾…ã€‚&lt;/p&gt;&lt;p&gt;å¯¹äº TiDBï¼Œä½¿ç”¨ Percolator äº‹åŠ¡æ¨¡å‹ï¼šå¯ä»¥ç†è§£ä¸ºä¹è§‚é”å®ç°ï¼Œäº‹åŠ¡å¼€å¯ã€äº‹åŠ¡ä¸­éƒ½ä¸ä¼šåŠ é”ï¼Œè€Œæ˜¯åœ¨æäº¤æ—¶æ‰åŠ é”ã€‚å‚è§ &lt;u&gt;&lt;a href=&quot;http://link.zhihu.com/?target=http%3A//mp.weixin.qq.com/s%3F__biz%3DMzI3NDIxNTQyOQ%3D%3D%26mid%3D2247484286%26idx%3D2%26sn%3D45b7d9e29af3965567f1743f0c2b536c%26chksm%3Deb162414dc61ad02877378fb97d1790a946c72f4c344260c037d1ae0f9817f2e4d14d1c6233e%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;è¿™ç¯‡æ–‡ç« &lt;/a&gt;&lt;/u&gt;ï¼ˆTiDB äº‹åŠ¡ç®—æ³•ï¼‰ã€‚&lt;/p&gt;&lt;p&gt;å…¶ç®€è¦æµç¨‹å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-480a8128457b1092c4e9df41caf07b69_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;733&quot; data-rawheight=&quot;618&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;733&quot; data-original=&quot;https://pic2.zhimg.com/v2-480a8128457b1092c4e9df41caf07b69_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-480a8128457b1092c4e9df41caf07b69_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;733&quot; data-rawheight=&quot;618&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;733&quot; data-original=&quot;https://pic2.zhimg.com/v2-480a8128457b1092c4e9df41caf07b69_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-480a8128457b1092c4e9df41caf07b69_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;åœ¨äº‹åŠ¡æäº¤çš„ PreWrite é˜¶æ®µï¼Œå½“â€œé”æ£€æŸ¥â€å¤±è´¥æ—¶ï¼šå¦‚æœå¼€å¯å†²çªé‡è¯•ï¼Œäº‹åŠ¡æäº¤å°†ä¼šè¿›è¡Œé‡è¯•ï¼›å¦‚æœæœªå¼€å¯å†²çªé‡è¯•ï¼Œå°†ä¼šæŠ›å‡ºå†™å…¥å†²çªå¼‚å¸¸ã€‚&lt;/p&gt;&lt;p&gt;å¯è§ï¼Œå¯¹äº MySQLï¼Œç”±äºåœ¨å†™å…¥æ“ä½œæ—¶åŠ ä¸Šäº†æ’ä»–é”ï¼Œå˜ç›¸å°†å¹¶è¡Œäº‹åŠ¡ä»é€»è¾‘ä¸Šä¸²è¡ŒåŒ–ï¼›è€Œå¯¹äº TiDBï¼Œå±äºä¹è§‚é”æ¨¡å‹ï¼Œåœ¨äº‹åŠ¡æäº¤æ—¶æ‰åŠ é”ï¼Œå¹¶ä½¿ç”¨äº‹åŠ¡å¼€å¯æ—¶è·å–çš„â€œå…¨å±€æ—¶é—´æˆ³â€ä½œä¸ºâ€œé”æ£€æŸ¥â€çš„ä¾æ®ã€‚&lt;/p&gt;&lt;p&gt;æ‰€ä»¥ï¼Œåœ¨ä¸šåŠ¡å±‚é¢é¿å… TiDB äº‹åŠ¡å·®å¼‚çš„æœ¬è´¨åœ¨äºé¿å…é”å†²çªï¼Œå³ï¼Œå½“å‰äº‹åŠ¡æ‰§è¡Œæ—¶ï¼Œä¸äº§ç”Ÿåˆ«çš„äº‹åŠ¡æ—¶é—´æˆ³ï¼ˆæ— å…¶ä»–äº‹åŠ¡å¹¶è¡Œï¼‰ã€‚å¤„ç†æ–¹å¼ä¸ºäº‹åŠ¡ä¸²è¡ŒåŒ–ã€‚&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;TiDB äº‹åŠ¡ä¸²è¡ŒåŒ–&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;åœ¨ä¸šåŠ¡å±‚ï¼Œå¯ä»¥å€ŸåŠ©åˆ†å¸ƒå¼é”ï¼Œå®ç°ä¸²è¡ŒåŒ–å¤„ç†ï¼Œå¦‚ä¸‹ï¼š&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-4e5f59504ec0e644ff5f2da424de4e65_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;714&quot; data-rawheight=&quot;350&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;714&quot; data-original=&quot;https://pic2.zhimg.com/v2-4e5f59504ec0e644ff5f2da424de4e65_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-4e5f59504ec0e644ff5f2da424de4e65_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;714&quot; data-rawheight=&quot;350&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;714&quot; data-original=&quot;https://pic2.zhimg.com/v2-4e5f59504ec0e644ff5f2da424de4e65_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-4e5f59504ec0e644ff5f2da424de4e65_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;åŸºäº Spring å’Œåˆ†å¸ƒå¼é”çš„äº‹åŠ¡ç®¡ç†å™¨æ‹“å±•&lt;/b&gt;&lt;/p&gt;&lt;p&gt;åœ¨ Spring ç”Ÿæ€ä¸‹ï¼Œspring-tx ä¸­å®šä¹‰äº†ç»Ÿä¸€çš„äº‹åŠ¡ç®¡ç†å™¨æ¥å£ï¼š&lt;code&gt;PlatformTransactionManager&lt;/code&gt;ï¼Œå…¶ä¸­æœ‰è·å–äº‹åŠ¡ï¼ˆgetTransactionï¼‰ã€æäº¤ï¼ˆcommitï¼‰ã€å›æ»šï¼ˆrollbackï¼‰ä¸‰ä¸ªåŸºæœ¬æ–¹æ³•ï¼›ä½¿ç”¨è£…é¥°å™¨æ¨¡å¼ï¼Œäº‹åŠ¡ä¸²è¡ŒåŒ–ç»„ä»¶å¯åšå¦‚ä¸‹è®¾è®¡ï¼š&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-058e6ce48a070e242e7ce42c2eb97cc5_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;800&quot; data-rawheight=&quot;647&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;800&quot; data-original=&quot;https://pic2.zhimg.com/v2-058e6ce48a070e242e7ce42c2eb97cc5_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-058e6ce48a070e242e7ce42c2eb97cc5_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;800&quot; data-rawheight=&quot;647&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;800&quot; data-original=&quot;https://pic2.zhimg.com/v2-058e6ce48a070e242e7ce42c2eb97cc5_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-058e6ce48a070e242e7ce42c2eb97cc5_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;å…¶ä¸­ï¼Œå…³é”®ç‚¹æœ‰ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;è¶…æ—¶æ—¶é—´ï¼šä¸ºé¿å…æ­»é”ï¼Œé”å¿…é¡»æœ‰è¶…æ—¶æ—¶é—´ï¼›ä¸ºé¿å…é”è¶…æ—¶å¯¼è‡´äº‹åŠ¡å¹¶è¡Œï¼Œäº‹åŠ¡å¿…é¡»æœ‰è¶…æ—¶æ—¶é—´ï¼Œè€Œä¸”é”è¶…æ—¶æ—¶é—´å¿…é¡»å¤§äºäº‹åŠ¡è¶…æ—¶æ—¶é—´ï¼ˆæ—¶é—´å·®æœ€å¥½åœ¨ç§’çº§ï¼‰ã€‚&lt;/li&gt;&lt;li&gt;åŠ é”æ—¶æœºï¼šTiDB ä¸­â€œé”æ£€æŸ¥â€çš„ä¾æ®æ˜¯äº‹åŠ¡å¼€å¯æ—¶è·å–çš„â€œå…¨å±€æ—¶é—´æˆ³â€ï¼Œæ‰€ä»¥åŠ é”æ—¶æœºå¿…é¡»åœ¨äº‹åŠ¡å¼€å¯å‰ã€‚&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;b&gt;äº‹åŠ¡æ¨¡æ¿æ¥å£è®¾è®¡&lt;/b&gt;&lt;/p&gt;&lt;p&gt;éšè—å¤æ‚çš„äº‹åŠ¡é‡å†™é€»è¾‘ï¼Œæš´éœ²ç®€å•å‹å¥½çš„ APIï¼š&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-41d1ac47b69b440efa9b5af6646980cf_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;864&quot; data-rawheight=&quot;257&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;864&quot; data-original=&quot;https://pic4.zhimg.com/v2-41d1ac47b69b440efa9b5af6646980cf_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-41d1ac47b69b440efa9b5af6646980cf_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;864&quot; data-rawheight=&quot;257&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;864&quot; data-original=&quot;https://pic4.zhimg.com/v2-41d1ac47b69b440efa9b5af6646980cf_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-41d1ac47b69b440efa9b5af6646980cf_b.jpg&quot;&gt;&lt;/figure&gt;&lt;u&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-2332bab1107b2161a427057787b243b0_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;864&quot; data-rawheight=&quot;213&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;864&quot; data-original=&quot;https://pic1.zhimg.com/v2-2332bab1107b2161a427057787b243b0_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-2332bab1107b2161a427057787b243b0_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;864&quot; data-rawheight=&quot;213&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;864&quot; data-original=&quot;https://pic1.zhimg.com/v2-2332bab1107b2161a427057787b243b0_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-2332bab1107b2161a427057787b243b0_b.jpg&quot;&gt;&lt;/figure&gt;&lt;/u&gt;&lt;h2&gt;&lt;b&gt;TiDB æŸ¥è¯¢å’Œ MySQL çš„å·®å¼‚&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;åœ¨ TiDB ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œå¶å°”ä¼šæœ‰è¿™æ ·çš„æƒ…å†µï¼ŒæŸå‡ ä¸ªå­—æ®µå»ºç«‹äº†ç´¢å¼•ï¼Œä½†æ˜¯æŸ¥è¯¢è¿‡ç¨‹è¿˜æ˜¯å¾ˆæ…¢ï¼Œç”šè‡³ä¸ç»è¿‡ç´¢å¼•æ£€ç´¢ã€‚&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;ç´¢å¼•æ··æ·†å‹ï¼ˆä¸¾ä¾‹ï¼‰&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;è¡¨ç»“æ„ï¼š&lt;/b&gt;&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;&lt;span&gt;&lt;/span&gt;CREATE TABLE `t_test` (
	  `id` bigint(20) NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;ä¸»é”®id&#39;,
	  `a` int(11) NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;a&#39;,
	  `b` int(11) NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;b&#39;,
	  `c` int(11) NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;c&#39;,
	  PRIMARY KEY (`id`),
	  KEY `idx_a_b` (`a`,`b`),
	  KEY `idx_c` (`c`)
	) ENGINE=InnoDB;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;æŸ¥è¯¢ï¼š&lt;/b&gt;å¦‚æœéœ€è¦æŸ¥è¯¢ (a=1 ä¸” b=1ï¼‰æˆ– c=2 çš„æ•°æ®ï¼Œåœ¨ MySQL ä¸­ï¼Œsql å¯ä»¥å†™ä¸ºï¼š&lt;code&gt;SELECT id from t_test where (a=1 and b=1) or (c=2);&lt;/code&gt;ï¼ŒMySQL åšæŸ¥è¯¢ä¼˜åŒ–æ—¶ï¼Œä¼šæ£€ç´¢åˆ° &lt;code&gt;idx_a_b&lt;/code&gt; å’Œ&lt;code&gt;idx_c&lt;/code&gt; ä¸¤ä¸ªç´¢å¼•ï¼›ä½†æ˜¯åœ¨ TiDBï¼ˆv2.0.8-9ï¼‰ä¸­ï¼Œè¿™ä¸ª sql ä¼šæˆä¸ºä¸€ä¸ªæ…¢ SQLï¼Œéœ€è¦æ”¹å†™ä¸ºï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;&lt;span&gt;&lt;/span&gt;SELECT id from t_test where (a=1 and b=1) UNION SELECT id from t_test where (c=2);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å°ç»“ï¼šå¯¼è‡´è¯¥é—®é¢˜çš„åŸå› ï¼Œå¯ä»¥ç†è§£ä¸º TiDB çš„ sql è§£æè¿˜æœ‰ä¼˜åŒ–ç©ºé—´ï¼ˆå®˜æ–¹å›å¤å·²åœ¨ä¼˜åŒ–è®¡åˆ’ä¸­ï¼‰ã€‚&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;å†·çƒ­æ•°æ®å‹ï¼ˆä¸¾ä¾‹ï¼‰&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;è¡¨ç»“æ„ï¼š&lt;/b&gt;&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;&lt;span&gt;&lt;/span&gt;CREATE TABLE `t_job_record` (
	  `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT &#39;ä¸»é”®id&#39;,
	  `job_code` varchar(255) NOT NULL DEFAULT &#39;&#39; COMMENT &#39;ä»»åŠ¡code&#39;,
	  `record_id` bigint(20) NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;è®°å½•id&#39;,
	  `status` tinyint(3) NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;æ‰§è¡ŒçŠ¶æ€:0 å¾…å¤„ç†&#39;,
	  `execute_time` bigint(20) NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;æ‰§è¡Œæ—¶é—´ï¼ˆæ¯«ç§’ï¼‰&#39;,
	  PRIMARY KEY (`id`),
	  KEY `idx_status_execute_time` (`status`,`execute_time`),
	  KEY `idx_record_id` (`record_id`)
	) ENGINE=InnoDB COMMENT=&#39;å¼‚æ­¥ä»»åŠ¡job&#39;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;æ•°æ®è¯´æ˜ï¼š&lt;/b&gt;&lt;/p&gt;&lt;p&gt;a. å†·æ•°æ®ï¼Œ&lt;code&gt;status=1&lt;/code&gt; çš„æ•°æ®ï¼ˆå·²ç»å¤„ç†è¿‡çš„æ•°æ®ï¼‰ï¼›&lt;/p&gt;&lt;p&gt;b. çƒ­æ•°æ®ï¼Œ&lt;code&gt;status=0 å¹¶ä¸” execute_time&amp;lt;= å½“å‰æ—¶é—´&lt;/code&gt; çš„æ•°æ®ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;æ…¢æŸ¥è¯¢&lt;/b&gt;ï¼šå¯¹äºçƒ­æ•°æ®ï¼Œæ•°æ®é‡ä¸€èˆ¬ä¸å¤§ï¼Œä½†æ˜¯æŸ¥è¯¢é¢‘åº¦å¾ˆé«˜ï¼Œå‡è®¾å½“å‰ï¼ˆæ¯«ç§’çº§ï¼‰æ—¶é—´ä¸ºï¼š1546361579646ï¼Œåˆ™åœ¨ MySQL ä¸­ï¼ŒæŸ¥è¯¢ sql ä¸ºï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;&lt;span&gt;&lt;/span&gt;SELECT * FROM t_job_record where status=0 and execute_time&amp;lt;= 1546361579646
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™ä¸ªåœ¨ MySQL ä¸­å¾ˆé«˜æ•ˆçš„æŸ¥è¯¢ï¼Œåœ¨ TiDB ä¸­è™½ç„¶ä¹Ÿå¯ä»ç´¢å¼•æ£€ç´¢ï¼Œä½†å…¶è€—æ—¶å´ä¸å°½äººæ„ï¼ˆç™¾ä¸‡çº§æ•°æ®é‡ï¼Œè€—æ—¶ç™¾æ¯«ç§’çº§ï¼‰ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;åŸå› åˆ†æï¼š&lt;/b&gt;åœ¨ TiDB ä¸­ï¼Œåº•å±‚ç´¢å¼•ç»“æ„ä¸º LSM-Treeï¼Œå¦‚ä¸‹å›¾ï¼š&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-28159187b532d99a7ac34059f1ab04e1_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;864&quot; data-rawheight=&quot;206&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;864&quot; data-original=&quot;https://pic2.zhimg.com/v2-28159187b532d99a7ac34059f1ab04e1_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-28159187b532d99a7ac34059f1ab04e1_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;864&quot; data-rawheight=&quot;206&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;864&quot; data-original=&quot;https://pic2.zhimg.com/v2-28159187b532d99a7ac34059f1ab04e1_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-28159187b532d99a7ac34059f1ab04e1_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;å½“ä»å†…å­˜çº§çš„ C0 å±‚æŸ¥è¯¢ä¸åˆ°æ•°æ®æ—¶ï¼Œä¼šé€å±‚æ‰«æç¡¬ç›˜ä¸­å„å±‚ï¼›ä¸” merge æ“ä½œä¸ºå¼‚æ­¥æ“ä½œï¼Œç´¢å¼•æ•°æ®æ›´æ–°ä¼šå­˜åœ¨ä¸€å®šçš„å»¶è¿Ÿï¼Œå¯èƒ½å­˜åœ¨æ— æ•ˆç´¢å¼•ã€‚ç”±äºé€å±‚æ‰«æå’Œå¼‚æ­¥ mergeï¼Œä½¿å¾—æŸ¥è¯¢æ•ˆç‡è¾ƒä½ã€‚&lt;/p&gt;&lt;p&gt;ä¼˜åŒ–æ–¹å¼ï¼šå°½å¯èƒ½ç¼©å°è¿‡æ»¤èŒƒå›´ï¼Œæ¯”å¦‚ç»“åˆå¼‚æ­¥ job è·å–è®°å½•é¢‘ç‡ï¼Œåœ¨ä¿è¯ä¸é—æ¼æ•°æ®çš„å‰æä¸‹ï¼Œåˆç†è®¾ç½® execute_time ç­›é€‰åŒºé—´ï¼Œä¾‹å¦‚ 1 å°æ—¶ï¼Œsql æ”¹å†™ä¸ºï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;&lt;span&gt;&lt;/span&gt;SELECT * FROM t_job_record  where status=0 and execute_time&amp;gt;1546357979646 and execute_time&amp;lt;= 1546361579646
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;ä¼˜åŒ–æ•ˆæœï¼š&lt;/b&gt;è€—æ—¶ 10 æ¯«ç§’çº§åˆ«ï¼ˆä»¥ä¸‹ï¼‰ã€‚&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;å…³äºæŸ¥è¯¢çš„å¯å‘&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;åœ¨åŸºäº TiDB çš„ä¸šåŠ¡å¼€å‘ä¸­ï¼Œå…ˆæ‘’å¼ƒä¼ ç»Ÿå…³ç³»å‹æ•°æ®åº“å¸¦æ¥çš„å¯¹ sql å…ˆå…¥ä¸ºä¸»çš„ç†è§£æˆ–ç»éªŒï¼Œè°¨æ…è®¾è®¡æ¯ä¸€ä¸ª sqlï¼Œå¦‚ DBA æ‰€æå€¡ï¼šè®¾è®¡ sql æ—¶åŠ¡å¿…å…³æ³¨æ‰§è¡Œè®¡åˆ’ï¼Œå¿…è¦æ—¶è¯·æ•™ DBAã€‚&lt;/p&gt;&lt;p&gt;å’Œ MySQL ç›¸æ¯”ï¼ŒTiDB çš„åº•å±‚å­˜å‚¨å’Œç»“æ„å†³å®šäº†å…¶ç‰¹æ®Šæ€§å’Œå·®å¼‚æ€§ï¼›ä½†æ˜¯ï¼ŒTiDB æ”¯æŒ MySQL åè®®ï¼Œå®ƒä»¬ä¹Ÿå­˜åœ¨ä¸€äº›å…±åŒä¹‹å¤„ï¼Œæ¯”å¦‚åœ¨ TiDB ä¸­ä½¿ç”¨â€œé¢„ç¼–è¯‘â€å’Œâ€œæ‰¹å¤„ç†â€ï¼ŒåŒæ ·å¯ä»¥è·å¾—ä¸€å®šçš„æ€§èƒ½æå‡ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;æœåŠ¡ç«¯é¢„ç¼–è¯‘&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;åœ¨ MySQL ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ &lt;code&gt;PREPARE stmt_name FROM preparable_stm&lt;/code&gt;  å¯¹ sql è¯­å¥è¿›è¡Œé¢„ç¼–è¯‘ï¼Œç„¶åä½¿ç”¨ &lt;code&gt;EXECUTE stmt_name [USING @var_name [, @var_name] ...]&lt;/code&gt; æ‰§è¡Œé¢„ç¼–è¯‘è¯­å¥ã€‚å¦‚æ­¤ï¼ŒåŒä¸€ sql çš„å¤šæ¬¡æ“ä½œï¼Œå¯ä»¥è·å¾—æ¯”å¸¸è§„ sql æ›´é«˜çš„æ€§èƒ½ã€‚&lt;/p&gt;&lt;p&gt;mysql-jdbc æºç ä¸­ï¼Œå®ç°äº†æ ‡å‡†çš„ &lt;code&gt;Statement&lt;/code&gt; å’Œ &lt;code&gt;PreparedStatement&lt;/code&gt; çš„åŒæ—¶ï¼Œè¿˜æœ‰ä¸€ä¸ª&lt;code&gt;ServerPreparedStatement&lt;/code&gt; å®ç°ï¼Œ&lt;code&gt;ServerPreparedStatement&lt;/code&gt; å±äº&lt;code&gt;PreparedStatement&lt;/code&gt;çš„æ‹“å±•ï¼Œä¸‰è€…å¯¹æ¯”å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-7b504d262d5b9e2d941a312f8798e02a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;864&quot; data-rawheight=&quot;320&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;864&quot; data-original=&quot;https://pic3.zhimg.com/v2-7b504d262d5b9e2d941a312f8798e02a_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-7b504d262d5b9e2d941a312f8798e02a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;864&quot; data-rawheight=&quot;320&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;864&quot; data-original=&quot;https://pic3.zhimg.com/v2-7b504d262d5b9e2d941a312f8798e02a_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-7b504d262d5b9e2d941a312f8798e02a_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;å®¹æ˜“å‘ç°ï¼Œ&lt;code&gt;PreparedStatement&lt;/code&gt; å’Œ  &lt;code&gt;Statement&lt;/code&gt;çš„åŒºåˆ«ä¸»è¦åŒºåˆ«åœ¨äºå‚æ•°å¤„ç†ï¼Œè€Œå¯¹äºå‘é€æ•°æ®åŒ…ï¼Œè°ƒç”¨æœåŠ¡ç«¯çš„å¤„ç†é€»è¾‘æ˜¯ä¸€æ ·ï¼ˆæˆ–ç±»ä¼¼ï¼‰çš„ï¼›ç»æµ‹è¯•ï¼ŒäºŒè€…é€Ÿåº¦ç›¸å½“ã€‚å…¶å®ï¼Œ&lt;code&gt;PreparedStatement&lt;/code&gt; å¹¶ä¸æ˜¯æœåŠ¡ç«¯é¢„å¤„ç†çš„ï¼›&lt;code&gt;ServerPreparedStatement&lt;/code&gt; æ‰æ˜¯çœŸæ­£çš„æœåŠ¡ç«¯é¢„å¤„ç†ï¼Œé€Ÿåº¦ä¹Ÿè¾ƒ &lt;code&gt;PreparedStatement&lt;/code&gt; å¿«ï¼›å…¶ä½¿ç”¨åœºæ™¯ä¸€èˆ¬æ˜¯ï¼šé¢‘ç¹çš„æ•°æ®åº“è®¿é—®ï¼Œsql æ•°é‡æœ‰é™ï¼ˆæœ‰ç¼“å­˜æ·˜æ±°ç­–ç•¥ï¼Œä½¿ç”¨ä¸å®œä¼šå¯¼è‡´ä¸¤æ¬¡ IOï¼‰ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;æ‰¹å¤„ç†&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;å¯¹äºå¤šæ¡æ•°æ®å†™å…¥ï¼Œå¸¸ç”¨ sql ä¸º &lt;code&gt;insert â€¦ values(â€¦),(â€¦)&lt;/code&gt;ï¼›è€Œå¯¹äºå¤šæ¡æ•°æ®æ›´æ–°ï¼Œäº¦å¯ä»¥ä½¿ç”¨&lt;code&gt;update â€¦ case â€¦ whenâ€¦ thenâ€¦ end&lt;/code&gt; æ¥å‡å°‘ IO æ¬¡æ•°ã€‚ä½†å®ƒä»¬éƒ½æœ‰ä¸€ä¸ªç‰¹ç‚¹ï¼Œæ•°æ®æ¡æ•°è¶Šå¤šï¼Œsql è¶ŠåŠ å¤æ‚ï¼Œsql è§£ææˆæœ¬ä¹Ÿæ›´é«˜ï¼Œè€—æ—¶å¢é•¿å¯èƒ½é«˜äºçº¿æ€§å¢é•¿ã€‚è€Œæ‰¹å¤„ç†ï¼Œå¯ä»¥å¤ç”¨ä¸€æ¡ç®€å• sqlï¼Œå®ç°æ‰¹é‡æ•°æ®çš„å†™å…¥æˆ–æ›´æ–°ï¼Œä¸ºç³»ç»Ÿå¸¦æ¥æ›´ä½ã€æ›´ç¨³å®šçš„è€—æ—¶ã€‚&lt;/p&gt;&lt;p&gt;å¯¹äºæ‰¹å¤„ç†ï¼Œä½œä¸ºå®¢æˆ·ç«¯ï¼Œ&lt;code&gt;java.sql.Statement&lt;/code&gt; ä¸»è¦å®šä¹‰äº†ä¸¤ä¸ªæ¥å£æ–¹æ³•ï¼Œ&lt;code&gt;addBatch&lt;/code&gt;  å’Œ  &lt;code&gt;executeBatch&lt;/code&gt;  æ¥æ”¯æŒæ‰¹å¤„ç†ã€‚&lt;/p&gt;&lt;p&gt;æ‰¹å¤„ç†çš„ç®€è¦æµç¨‹è¯´æ˜å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-f134ea114f7ac12f6120f484dea108ce_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;864&quot; data-rawheight=&quot;525&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;864&quot; data-original=&quot;https://pic3.zhimg.com/v2-f134ea114f7ac12f6120f484dea108ce_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-f134ea114f7ac12f6120f484dea108ce_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;864&quot; data-rawheight=&quot;525&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;864&quot; data-original=&quot;https://pic3.zhimg.com/v2-f134ea114f7ac12f6120f484dea108ce_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-f134ea114f7ac12f6120f484dea108ce_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;ç»ä¸šåŠ¡ä¸­å®è·µï¼Œä½¿ç”¨æ‰¹å¤„ç†æ–¹å¼çš„å†™å…¥ï¼ˆæˆ–æ›´æ–°ï¼‰ï¼Œæ¯”å¸¸è§„ &lt;code&gt;insert â€¦ values (â€¦),(â€¦)&lt;/code&gt;ï¼ˆæˆ–  &lt;code&gt;update â€¦ case â€¦ whenâ€¦ thenâ€¦ end&lt;/code&gt;ï¼‰æ€§èƒ½æ›´ç¨³å®šï¼Œè€—æ—¶ä¹Ÿæ›´ä½ã€‚&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;i&gt;&lt;b&gt;æœ¬æ–‡è½¬è½½è‡ªâ€œè½¬è½¬æŠ€æœ¯â€ï¼ŒåŸæ–‡é“¾æ¥ï¼š&lt;/b&gt;&lt;/i&gt;&lt;/p&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s/Qyvy_YBIBhZJo1uYHTL93g%3Fscene%3D25%23wechat_redirect&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic1.zhimg.com/v2-4a5821a1189a52c4708ad4a65139e744_180x120.jpg&quot; data-image-width=&quot;470&quot; data-image-height=&quot;200&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TiDBä¸šåŠ¡å®æˆ˜&lt;/a&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>ZoeyZhai</author>
<guid isPermaLink="false">2019-01-16-55026939</guid>
<pubDate>Wed, 16 Jan 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>TiDB æºç é˜…è¯»ç³»åˆ—æ–‡ç« ï¼ˆäºŒåå››ï¼‰TiDB Binlog æºç è§£æ</title>
<link>https://henix.github.io/feeds/zhuanlan.newsql/2019-01-15-54940241.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/54940241&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-d734c2c18de0b1415b4b39a664766a19_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;ä½œè€…ï¼šå§šç»´&lt;/p&gt;&lt;h2&gt;&lt;b&gt;TiDB Binlog Overview&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;è¿™ç¯‡æ–‡ç« ä¸æ˜¯è®² TiDB Binlog ç»„ä»¶çš„æºç ï¼Œè€Œæ˜¯è®² TiDB åœ¨æ‰§è¡Œ DML/DDL è¯­å¥è¿‡ç¨‹ä¸­ï¼Œå¦‚ä½•å°† Binlog æ•°æ® å‘é€ç»™ TiDB Binlog é›†ç¾¤çš„ Pump ç»„ä»¶ã€‚ç›®å‰ TiDB åœ¨ DML ä¸Šçš„ Binlog ç”¨çš„ç±»ä¼¼ &lt;a href=&quot;http://link.zhihu.com/?target=https%3A//dev.mysql.com/doc/refman/5.7/en/binary-log-formats.html&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Row-based&lt;/a&gt; çš„æ ¼å¼ã€‚å…·ä½“ Binlog å…·ä½“çš„æ¶æ„ç»†èŠ‚å¯ä»¥å‚çœ‹è¿™ç¯‡ &lt;a href=&quot;http://link.zhihu.com/?target=https%3A//pingcap.com/blog-cn/tidb-ecosystem-tools-1/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;æ–‡ç« &lt;/a&gt;ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;è¿™é‡Œåªæè¿° TiDB ä¸­çš„ä»£ç å®ç°ã€‚&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;DML Binlog&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;TiDB é‡‡ç”¨ protobuf æ¥ç¼–ç  binlogï¼Œå…·ä½“çš„æ ¼å¼å¯ä»¥è§ &lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/pingcap/tipb/blob/master/proto/binlog/binlog.proto&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;binlog.proto&lt;/a&gt;ã€‚è¿™é‡Œè®¨è®º TiDB å†™ Binlog çš„æœºåˆ¶ï¼Œä»¥åŠ Binlog å¯¹ TiDB å†™å…¥çš„å½±å“ã€‚&lt;/p&gt;&lt;p&gt;TiDB ä¼šåœ¨ DML è¯­å¥æäº¤ï¼Œä»¥åŠ DDL è¯­å¥å®Œæˆçš„æ—¶å€™ï¼Œå‘ pump è¾“å‡º Binlogã€‚&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;Statement æ‰§è¡Œé˜¶æ®µ&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;DML è¯­å¥åŒ…æ‹¬ Insert/Replaceã€Updateã€Deleteï¼Œè¿™é‡ŒæŒ‘ Insert è¯­å¥æ¥é˜è¿°ï¼Œå…¶ä»–çš„è¯­å¥è¡Œä¸ºéƒ½ç±»ä¼¼ã€‚é¦–å…ˆåœ¨ Insert è¯­å¥æ‰§è¡Œå®Œæ’å…¥ï¼ˆæœªæäº¤ï¼‰ä¹‹å‰ï¼Œä¼šæŠŠè‡ªå·±æ–°å¢çš„æ•°æ®è®°å½•åœ¨ &lt;code&gt;binlog.TableMutation&lt;/code&gt; ç»“æ„ä½“ä¸­ã€‚&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;&lt;span&gt;&lt;/span&gt;// TableMutation å­˜å‚¨è¡¨ä¸­æ•°æ®çš„å˜åŒ–
message TableMutation {
	    // è¡¨çš„ idï¼Œå”¯ä¸€æ ‡è¯†ä¸€ä¸ªè¡¨
	    optional int64 table_id      = 1 [(gogoproto.nullable) = false]; 
	    
	    // ä¿å­˜æ’å…¥çš„æ¯è¡Œæ•°æ®
	    repeated bytes inserted_rows = 2;
	    
	    // ä¿å­˜ä¿®æ”¹å‰å’Œä¿®æ”¹åçš„æ¯è¡Œçš„æ•°æ®
	    repeated bytes updated_rows  = 3;
	    
	    // å·²åºŸå¼ƒ
	    repeated int64 deleted_ids   = 4;
	    
	    // å·²åºŸå¼ƒ
	    repeated bytes deleted_pks   = 5;
	     
	    // åˆ é™¤è¡Œçš„æ•°æ®
	    repeated bytes deleted_rows  = 6;
	    
	    // è®°å½•æ•°æ®å˜æ›´çš„é¡ºåº
	    repeated MutationType sequence = 7;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™ä¸ªç»“æ„ä½“ä¿å­˜äºè·Ÿæ¯ä¸ª Session é“¾æ¥ç›¸å…³çš„äº‹åŠ¡ä¸Šä¸‹æ–‡ç»“æ„ä½“ä¸­ &lt;code&gt;TxnState.mutations&lt;/code&gt;ã€‚ ä¸€å¼ è¡¨å¯¹åº”ä¸€ä¸ª &lt;code&gt;TableMutation&lt;/code&gt; å¯¹è±¡ï¼Œ&lt;code&gt;TableMutation&lt;/code&gt; é‡Œé¢ä¿å­˜äº†è¿™ä¸ªäº‹åŠ¡å¯¹è¿™å¼ è¡¨çš„æ‰€æœ‰å˜æ›´æ•°æ®ã€‚Insert ä¼šæŠŠå½“å‰è¯­å¥æ’å…¥çš„è¡Œï¼Œæ ¹æ® &lt;code&gt;RowID&lt;/code&gt; + &lt;code&gt;Row-value&lt;/code&gt; çš„æ ¼å¼ç¼–ç ä¹‹åï¼Œè¿½åŠ åˆ° &lt;code&gt;TableMutation.InsertedRows&lt;/code&gt; ä¸­ï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;&lt;span&gt;&lt;/span&gt;func (t *Table) addInsertBinlog(ctx context.Context, h int64, row []types.Datum, colIDs []int64) error {
	mutation := t.getMutation(ctx)
	pk, err := codec.EncodeValue(ctx.GetSessionVars().StmtCtx, nil, types.NewIntDatum(h))
	if err != nil {
		return errors.Trace(err)
	}
	value, err := tablecodec.EncodeRow(ctx.GetSessionVars().StmtCtx, row, colIDs, nil, nil)
	if err != nil {
		return errors.Trace(err)
	}
	bin := append(pk, value...)
	mutation.InsertedRows = append(mutation.InsertedRows, bin)
	mutation.Sequence = append(mutation.Sequence, binlog.MutationType_Insert)
	return nil
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç­‰åˆ°æ‰€æœ‰çš„è¯­å¥éƒ½æ‰§è¡Œå®Œä¹‹åï¼Œåœ¨ &lt;code&gt;TxnState.mutations&lt;/code&gt; ä¸­å°±ä¿å­˜äº†å½“å‰äº‹åŠ¡å¯¹æ‰€æœ‰è¡¨çš„å˜æ›´æ•°æ®ã€‚&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;Commit é˜¶æ®µ&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;å¯¹äº DML è€Œè¨€ï¼ŒTiDB çš„äº‹åŠ¡é‡‡ç”¨ 2-phase-commit ç®—æ³•ï¼Œä¸€æ¬¡äº‹åŠ¡æäº¤ä¼šåˆ†ä¸º Prewrite é˜¶æ®µï¼Œä»¥åŠ Commit é˜¶æ®µã€‚è¿™é‡Œåˆ†ä¸¤ä¸ªé˜¶æ®µæ¥çœ‹çœ‹ TiDB å…·ä½“çš„è¡Œä¸ºã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;Prewrite Binlog&lt;/b&gt;&lt;/p&gt;&lt;p&gt;åœ¨ &lt;code&gt;session.doCommit&lt;/code&gt; å‡½æ•°ä¸­ï¼ŒTiDB ä¼šæ„é€  &lt;code&gt;binlog.PrewriteValue&lt;/code&gt;ï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;&lt;span&gt;&lt;/span&gt;message PrewriteValue {
    optional int64         schema_version = 1 [(gogoproto.nullable) = false];
    repeated TableMutation mutations      = 2 [(gogoproto.nullable) = false];
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™ä¸ª &lt;code&gt;PrewriteValue&lt;/code&gt; ä¸­åŒ…å«äº†è·Ÿè¿™æ¬¡å˜åŠ¨ç›¸å…³çš„æ‰€æœ‰è¡Œæ•°æ®ï¼ŒTiDB ä¼šå¡«å……ä¸€ä¸ªç±»å‹ä¸º &lt;code&gt;binlog.BinlogType_Prewrite&lt;/code&gt; çš„ Binlogï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;&lt;span&gt;&lt;/span&gt;info := &amp;amp;binloginfo.BinlogInfo{
	Data: &amp;amp;binlog.Binlog{
		Tp:            binlog.BinlogType_Prewrite,
		PrewriteValue: prewriteData,
	},
	Client: s.sessionVars.BinlogClient.(binlog.PumpClient),
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;TiDB è¿™é‡Œç”¨ä¸€ä¸ªäº‹åŠ¡çš„ Option &lt;code&gt;kv.BinlogInfo&lt;/code&gt; æ¥æŠŠ &lt;code&gt;BinlogInfo&lt;/code&gt; ç»‘å®šåˆ°å½“å‰è¦æäº¤çš„ transaction å¯¹è±¡ä¸­ï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;&lt;span&gt;&lt;/span&gt;s.txn.SetOption(kv.BinlogInfo, info)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åœ¨ &lt;code&gt;twoPhaseCommitter.execute&lt;/code&gt; ä¸­ï¼Œåœ¨æŠŠæ•°æ® prewrite åˆ° TiKV çš„åŒæ—¶ï¼Œä¼šè°ƒç”¨ &lt;code&gt;twoPhaseCommitter.prewriteBinlog&lt;/code&gt;ï¼Œè¿™é‡Œä¼šæŠŠå…³è”çš„ &lt;code&gt;binloginfo.BinlogInfo&lt;/code&gt; å–å‡ºæ¥ï¼ŒæŠŠ Binlog çš„ &lt;code&gt;binlog.PrewriteValue&lt;/code&gt; è¾“å‡ºåˆ° Pumpã€‚&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;&lt;span&gt;&lt;/span&gt;binlogChan := c.prewriteBinlog()
err := c.prewriteKeys(NewBackoffer(prewriteMaxBackoff, ctx), c.keys)
if binlogChan != nil {
	binlogErr := &amp;lt;-binlogChan // ç­‰å¾… write prewrite binlog å®Œæˆ
	if binlogErr != nil {
		return errors.Trace(binlogErr)
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™é‡Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨ prewrite é˜¶æ®µï¼Œæ˜¯éœ€è¦ç­‰å¾… write prewrite binlog å®Œæˆä¹‹åï¼Œæ‰èƒ½ç»§ç»­åšæ¥ä¸‹å»çš„æäº¤çš„ï¼Œè¿™é‡Œæ˜¯ä¸ºäº†ä¿è¯ TiDB æˆåŠŸæäº¤çš„äº‹åŠ¡ï¼ŒPump è‡³å°‘ä¸€å®šèƒ½æ”¶åˆ° Prewrite Binlogã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;Commit Binlog&lt;/b&gt;&lt;/p&gt;&lt;p&gt;åœ¨ &lt;code&gt;twoPhaseCommitter.execute&lt;/code&gt; äº‹åŠ¡æäº¤ç»“æŸä¹‹åï¼Œäº‹åŠ¡å¯èƒ½æäº¤æˆåŠŸï¼Œä¹Ÿå¯èƒ½æäº¤å¤±è´¥ã€‚TiDB éœ€è¦æŠŠè¿™ä¸ªçŠ¶æ€å‘ŠçŸ¥ Pumpï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;&lt;span&gt;&lt;/span&gt;err = committer.execute(ctx)
if err != nil {
	committer.writeFinishBinlog(binlog.BinlogType_Rollback, 0)
	return errors.Trace(err)
}
committer.writeFinishBinlog(binlog.BinlogType_Commit, int64(committer.commitTS))
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¦‚æœå‘ç”Ÿäº† errorï¼Œé‚£ä¹ˆè¾“å‡ºçš„ Binlog ç±»å‹å°±ä¸º &lt;code&gt;binlog.BinlogType_Rollback&lt;/code&gt;ï¼Œå¦‚æœæˆåŠŸæäº¤ï¼Œé‚£ä¹ˆè¾“å‡ºçš„ Binlog ç±»å‹å°±ä¸º &lt;code&gt;binlog.BinlogType_Commit&lt;/code&gt;ã€‚&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;&lt;span&gt;&lt;/span&gt;func (c *twoPhaseCommitter) writeFinishBinlog(tp binlog.BinlogType, commitTS int64) {
	if !c.shouldWriteBinlog() {
		return
	}
	binInfo := c.txn.us.GetOption(kv.BinlogInfo).(*binloginfo.BinlogInfo)
	binInfo.Data.Tp = tp
	binInfo.Data.CommitTs = commitTS
	go func() {
		err := binInfo.WriteBinlog(c.store.clusterID)
		if err != nil {
			log.Errorf(&quot;failed to write binlog: %v&quot;, err)
		}
	}()
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œ WriteBinlog æ˜¯å•ç‹¬å¯åŠ¨ goroutine å¼‚æ­¥å®Œæˆçš„ï¼Œä¹Ÿå°±æ˜¯ Commit é˜¶æ®µï¼Œæ˜¯ä¸å†éœ€è¦ç­‰å¾…å†™ binlog å®Œæˆçš„ã€‚è¿™é‡Œå¯ä»¥èŠ‚çœä¸€ç‚¹ commit çš„ç­‰å¾…æ—¶é—´ï¼Œè¿™é‡Œä¸éœ€è¦ç­‰å¾…æ˜¯å› ä¸º Pump å³ä½¿æ¥æ”¶ä¸åˆ°è¿™ä¸ª Commit Binlogï¼Œåœ¨è¶…è¿‡ timeout æ—¶é—´åï¼ŒPump ä¼šè‡ªè¡Œæ ¹æ® Prewrite Binlog åˆ° TiKV ä¸­ç¡®è®¤å½“æ¡äº‹åŠ¡çš„æäº¤çŠ¶æ€ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;DDL Binlog&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;ä¸€ä¸ª DDL æœ‰å¦‚ä¸‹å‡ ä¸ªçŠ¶æ€ï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;&lt;span&gt;&lt;/span&gt;const (
	JobStateNone    		JobState = 0
	JobStateRunning 		JobState = 1
	JobStateRollingback  	JobState = 2
	JobStateRollbackDone 	JobState = 3
	JobStateDone         	JobState = 4
	JobStateSynced 			JobState = 6
	JobStateCancelling 		JobState = 7
)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™äº›çŠ¶æ€ä»£è¡¨äº†ä¸€ä¸ª DDL ä»»åŠ¡æ‰€å¤„çš„çŠ¶æ€ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;code&gt;JobStateNone&lt;/code&gt;ï¼Œä»£è¡¨ DDL ä»»åŠ¡è¿˜åœ¨å¤„ç†é˜Ÿåˆ—ï¼ŒTiDB è¿˜æ²¡æœ‰å¼€å§‹åšè¿™ä¸ª DDLã€‚&lt;/li&gt;&lt;li&gt;&lt;code&gt;JobStateRunning&lt;/code&gt;ï¼Œå½“ DDL Owner å¼€å§‹å¤„ç†è¿™ä¸ªä»»åŠ¡çš„æ—¶å€™ï¼Œä¼šæŠŠçŠ¶æ€è®¾ç½®ä¸º &lt;code&gt;JobStateRunning&lt;/code&gt;ï¼Œä¹‹å DDL ä¼šå¼€å§‹å˜æ›´ï¼ŒTiDB çš„ Schema å¯èƒ½ä¼šæ¶‰åŠå¤šä¸ªçŠ¶æ€çš„å˜æ›´ï¼Œè¿™ä¸­é—´ä¸ä¼šæ”¹å˜ DDL job çš„çŠ¶æ€ï¼Œåªä¼šå˜æ›´ Schema çš„çŠ¶æ€ã€‚&lt;/li&gt;&lt;li&gt;&lt;code&gt;JobStateDone&lt;/code&gt;ï¼Œ å½“ TiDB å®Œæˆè‡ªå·±æ‰€æœ‰çš„ Schema çŠ¶æ€å˜æ›´ä¹‹åï¼Œä¼šæŠŠ Job çš„çŠ¶æ€æ”¹ä¸º Doneã€‚&lt;/li&gt;&lt;li&gt;&lt;code&gt;JobStateSynced&lt;/code&gt;ï¼Œå½“ TiDB æ¯åšä¸€æ¬¡ schema çŠ¶æ€å˜æ›´ï¼Œå°±ä¼šéœ€è¦è·Ÿé›†ç¾¤ä¸­çš„å…¶ä»– TiDB åšä¸€æ¬¡åŒæ­¥ï¼Œä½†æ˜¯å½“ Job çŠ¶æ€ä¸º &lt;code&gt;JobStateDone&lt;/code&gt; ä¹‹åï¼Œåœ¨ TiDB ç­‰åˆ°æ‰€æœ‰çš„ TiDB èŠ‚ç‚¹åŒæ­¥ä¹‹åï¼Œä¼šå°†çŠ¶æ€ä¿®æ”¹ä¸º &lt;code&gt;JobStateSynced&lt;/code&gt;ã€‚&lt;/li&gt;&lt;li&gt;&lt;code&gt;JobStateCancelling&lt;/code&gt;ï¼ŒTiDB æä¾›è¯­æ³• &lt;code&gt;ADMIN CANCEL DDL JOBS job_ids&lt;/code&gt; ç”¨äºå–æ¶ˆæŸä¸ªæ­£åœ¨æ‰§è¡Œæˆ–è€…è¿˜æœªæ‰§è¡Œçš„ DDL ä»»åŠ¡ï¼Œå½“æˆåŠŸæ‰§è¡Œè¿™ä¸ªå‘½ä»¤ä¹‹åï¼ŒDDL ä»»åŠ¡çš„çŠ¶æ€ä¼šå˜ä¸º &lt;code&gt;JobStateCancelling&lt;/code&gt;ã€‚&lt;/li&gt;&lt;li&gt;&lt;code&gt;JobStateRollingback&lt;/code&gt;ï¼Œå½“ DDL Owner å‘ç° Job çš„çŠ¶æ€å˜ä¸º &lt;code&gt;JobStateCancelling&lt;/code&gt; ä¹‹åï¼Œå®ƒä¼šå°† job çš„çŠ¶æ€æ”¹å˜ä¸º &lt;code&gt;JobStateRollingback&lt;/code&gt;ï¼Œä»¥ç¤ºå·²ç»å¼€å§‹å¤„ç† cancel è¯·æ±‚ã€‚&lt;/li&gt;&lt;li&gt;&lt;code&gt;JobStateRollbackDone&lt;/code&gt;ï¼Œåœ¨åš cancel çš„è¿‡ç¨‹ï¼Œä¹Ÿä¼šæ¶‰åŠ Schema çŠ¶æ€çš„å˜æ›´ï¼Œä¹Ÿéœ€è¦ç»å† Schema çš„åŒæ­¥ï¼Œç­‰åˆ°çŠ¶æ€å›æ»šå·²ç»åšå®Œäº†ï¼ŒTiDB ä¼šå°† Job çš„çŠ¶æ€è®¾ç½®ä¸º &lt;code&gt;JobStateRollbackDone&lt;/code&gt;ã€‚&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;å¯¹äº Binlog è€Œè¨€ï¼ŒDDL çš„ Binlog è¾“å‡ºæœºåˆ¶ï¼Œè·Ÿ DML è¯­å¥ä¹Ÿæ˜¯ç±»ä¼¼çš„ï¼Œåªæœ‰å¼€å§‹å¤„ç†äº‹åŠ¡æäº¤é˜¶æ®µï¼Œæ‰ä¼šå¼€å§‹å†™ Binlog å‡ºå»ã€‚é‚£ä¹ˆå¯¹äº DDL æ¥è¯´ï¼Œè·Ÿ DML ä¸ä¸€æ ·ï¼ŒDML æœ‰äº‹åŠ¡çš„æ¦‚å¿µï¼Œå¯¹äº DDL æ¥è¯´ï¼ŒSQL çš„äº‹åŠ¡æ˜¯ä¸å½±å“ DDL è¯­å¥çš„ã€‚ä½†æ˜¯ DDL é‡Œé¢ï¼Œä¸Šé¢æåˆ°çš„ Job çš„çŠ¶æ€å˜æ›´ï¼Œæ˜¯ä½œä¸ºä¸€ä¸ªäº‹åŠ¡æ¥æäº¤çš„ï¼ˆä¿è¯çŠ¶æ€ä¸€è‡´æ€§ï¼‰ã€‚æ‰€ä»¥åœ¨æ¯ä¸ªçŠ¶æ€å˜æ›´ï¼Œéƒ½ä¼šæœ‰ä¸€ä¸ªäº‹åŠ¡ä¸ä¹‹å¯¹åº”ï¼Œä½†æ˜¯ä¸Šé¢æåˆ°çš„ä¸­é—´çŠ¶æ€ï¼ŒDDL å¹¶ä¸ä¼šå¾€å¤–å†™ Binlogï¼Œåªæœ‰ &lt;code&gt;JobStateRollbackDone&lt;/code&gt; ä»¥åŠ &lt;code&gt;JobStateDone&lt;/code&gt; è¿™ä¸¤ç§çŠ¶æ€ï¼ŒTiDB ä¼šè®¤ä¸º DDL è¯­å¥å·²ç»å®Œæˆï¼Œä¼šå¯¹å¤–å‘é€ Binlogï¼Œå‘é€ä¹‹å‰ï¼Œä¼šæŠŠ Job çš„çŠ¶æ€ä» &lt;code&gt;JobStateDone&lt;/code&gt; ä¿®æ”¹ä¸º &lt;code&gt;JobStateSynced&lt;/code&gt;ï¼Œè¿™æ¬¡ä¿®æ”¹ï¼Œä¹Ÿæ¶‰åŠä¸€æ¬¡äº‹åŠ¡æäº¤ã€‚è¿™å—é€»è¾‘çš„ä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;&lt;span&gt;&lt;/span&gt;worker.handleDDLJobQueue():

if job.IsDone() || job.IsRollbackDone() {
		binloginfo.SetDDLBinlog(d.binlogCli, txn, job.ID, job.Query)
		if !job.IsRollbackDone() {
			job.State = model.JobStateSynced
		}
		err = w.finishDDLJob(t, job)
		return errors.Trace(err)
}

type Binlog struct {
	DdlQuery []byte
	DdlJobId         int64
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;DdlQuery&lt;/code&gt; ä¼šè®¾ç½®ä¸ºåŸå§‹çš„ DDL è¯­å¥ï¼Œ&lt;code&gt;DdlJobId&lt;/code&gt; ä¼šè®¾ç½®ä¸º DDL çš„ä»»åŠ¡ IDã€‚&lt;/p&gt;&lt;p&gt;å¯¹äºæœ€åä¸€æ¬¡ Job çŠ¶æ€çš„æäº¤ï¼Œä¼šæœ‰ä¸¤æ¡ Binlog ä¸ä¹‹å¯¹åº”ï¼Œè¿™é‡Œæœ‰å‡ ç§æƒ…å†µï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;å¦‚æœäº‹åŠ¡æäº¤æˆåŠŸï¼Œç±»å‹åˆ†åˆ«ä¸º &lt;code&gt;binlog.BinlogType_Prewrite&lt;/code&gt; å’Œ &lt;code&gt;binlog.BinlogType_Commit&lt;/code&gt;ã€‚&lt;/li&gt;&lt;li&gt;å¦‚æœäº‹åŠ¡æäº¤å¤±è´¥ï¼Œç±»å‹åˆ†åˆ«ä¸º &lt;code&gt;binlog.BinlogType_Prewrite&lt;/code&gt; å’Œ &lt;code&gt;binlog.BinlogType_Rollback&lt;/code&gt;ã€‚&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;æ‰€ä»¥ï¼ŒPumps æ”¶åˆ°çš„ DDL Binlogï¼Œå¦‚æœç±»å‹ä¸º &lt;code&gt;binlog.BinlogType_Rollback&lt;/code&gt; åº”è¯¥åªè®¤ä¸ºå¦‚ä¸‹çŠ¶æ€æ˜¯åˆæ³•çš„ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;code&gt;JobStateDone&lt;/code&gt; ï¼ˆå› ä¸ºä¿®æ”¹ä¸º &lt;code&gt;JobStateSynced&lt;/code&gt; è¿˜æœªæˆåŠŸï¼‰&lt;/li&gt;&lt;li&gt;&lt;code&gt;JobStateRollbackDone&lt;/code&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;å¦‚æœç±»å‹ä¸º &lt;code&gt;binlog.BinlogType_Commit&lt;/code&gt;ï¼Œåº”è¯¥åªè®¤ä¸ºå¦‚ä¸‹çŠ¶æ€æ˜¯åˆæ³•çš„ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;code&gt;JobStateSynced&lt;/code&gt;&lt;/li&gt;&lt;li&gt;&lt;code&gt;JobStateRollbackDone&lt;/code&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;å½“ TiDB åœ¨æäº¤æœ€åä¸€ä¸ª Job çŠ¶æ€çš„æ—¶å€™ï¼Œå¦‚æœäº‹åŠ¡æäº¤å¤±è´¥äº†ï¼Œé‚£ä¹ˆ TiDB Owner ä¼šå°è¯•ç»§ç»­ä¿®æ”¹è¿™ä¸ª Jobï¼Œç›´åˆ°æˆåŠŸã€‚ä¹Ÿå°±æ˜¯å¯¹äºåŒä¸€ä¸ª &lt;code&gt;DdlJobId&lt;/code&gt;ï¼Œåç»­è¿˜å¯èƒ½ä¼šæœ‰å¤šæ¬¡ Binlogï¼Œç›´åˆ°å‡ºç° &lt;code&gt;binlog.BinlogType_Commit&lt;/code&gt;ã€‚&lt;/p&gt;&lt;p&gt;&lt;i&gt;&lt;b&gt;æ›´å¤š TiDB æºç é˜…è¯»ç³»åˆ—æ–‡ç« ï¼š&lt;/b&gt;&lt;/i&gt;&lt;br&gt;&lt;/p&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//www.pingcap.com/blog-cn/%23%25E6%25BA%2590%25E7%25A0%2581%25E9%2598%2585%25E8%25AF%25BB&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic2.zhimg.com/v2-60ab5bd867c2434d70c957a02a2169e1_ipico.jpg&quot; data-image-width=&quot;1200&quot; data-image-height=&quot;1200&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;åšå®¢&lt;/a&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>ZoeyZhai</author>
<guid isPermaLink="false">2019-01-15-54940241</guid>
<pubDate>Tue, 15 Jan 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>TiDB æºç é˜…è¯»ç³»åˆ—æ–‡ç« ï¼ˆäºŒåä¸‰ï¼‰Prepare/Execute è¯·æ±‚å¤„ç†</title>
<link>https://henix.github.io/feeds/zhuanlan.newsql/2019-01-03-53967950.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/53967950&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-44348f6cb008b2c6fef5670d96cda457_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;ä½œè€…ï¼šè‹ç«‹&lt;/p&gt;&lt;blockquote&gt;åœ¨ä¹‹å‰çš„ä¸€ç¯‡æ–‡ç« &lt;a href=&quot;http://link.zhihu.com/?target=https%3A//pingcap.com/blog-cn/tidb-source-code-reading-3/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;ã€ŠTiDB æºç é˜…è¯»ç³»åˆ—æ–‡ç« ï¼ˆä¸‰ï¼‰SQL çš„ä¸€ç”Ÿã€‹&lt;/a&gt;ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº† TiDB åœ¨æ”¶åˆ°å®¢æˆ·ç«¯è¯·æ±‚åŒ…æ—¶ï¼Œæœ€å¸¸è§çš„&lt;code&gt;Command --- COM_QUERY&lt;/code&gt;çš„è¯·æ±‚å¤„ç†æµç¨‹ã€‚æœ¬æ–‡æˆ‘ä»¬å°†ä»‹ç»å¦å¤–ä¸€ç§å¤§å®¶ç»å¸¸ä½¿ç”¨çš„&lt;code&gt;Command --- Prepare/Execute&lt;/code&gt;è¯·æ±‚åœ¨ TiDB ä¸­çš„å¤„ç†è¿‡ç¨‹ã€‚&lt;/blockquote&gt;&lt;h2&gt;&lt;b&gt;Prepare/Execute Statement ç®€ä»‹&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;é¦–å…ˆæˆ‘ä»¬å…ˆç®€å•å›é¡¾ä¸‹å®¢æˆ·ç«¯ä½¿ç”¨ Prepare è¯·æ±‚è¿‡ç¨‹ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;å®¢æˆ·ç«¯å‘èµ· Prepare å‘½ä»¤å°†å¸¦ â€œ?â€ å‚æ•°å ä½ç¬¦çš„ SQL è¯­å¥å‘é€åˆ°æ•°æ®åº“ï¼ŒæˆåŠŸåè¿”å› &lt;code&gt;stmtID&lt;/code&gt;ã€‚&lt;/li&gt;&lt;li&gt;å…·ä½“æ‰§è¡Œ SQL æ—¶ï¼Œå®¢æˆ·ç«¯ä½¿ç”¨ä¹‹å‰è¿”å›çš„ &lt;code&gt;stmtID&lt;/code&gt;ï¼Œå¹¶å¸¦ä¸Šè¯·æ±‚å‚æ•°å‘èµ· Execute å‘½ä»¤æ¥æ‰§è¡Œ SQLã€‚&lt;/li&gt;&lt;li&gt;ä¸å†éœ€è¦ Prepare çš„è¯­å¥æ—¶ï¼Œå…³é—­ &lt;code&gt;stmtID&lt;/code&gt; å¯¹åº”çš„ Prepare è¯­å¥ã€‚&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;ç›¸æ¯”æ™®é€šè¯·æ±‚ï¼ŒPrepare å¸¦æ¥çš„å¥½å¤„æ˜¯ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;å‡å°‘æ¯æ¬¡æ‰§è¡Œç»è¿‡ Parser å¸¦æ¥çš„è´Ÿæ‹…ï¼Œå› ä¸ºå¾ˆå¤šåœºæ™¯ï¼Œçº¿ä¸Šè¿è¡Œçš„ SQL å¤šæ˜¯ç›¸åŒçš„å†…å®¹ï¼Œä»…æ˜¯å‚æ•°éƒ¨åˆ†ä¸åŒï¼Œé€šè¿‡ Prepare å¯ä»¥é€šè¿‡é¦–æ¬¡å‡†å¤‡å¥½å¸¦å ä½ç¬¦çš„ SQLï¼Œåç»­åªéœ€è¦å¡«å……å‚æ•°æ‰§è¡Œå°±å¥½ï¼Œå¯ä»¥åšåˆ°â€œä¸€æ¬¡ Parseï¼Œå¤šæ¬¡ä½¿ç”¨â€ã€‚&lt;/li&gt;&lt;li&gt;åœ¨å¼€å¯ PreparePlanCache åå¯ä»¥è¾¾åˆ°â€œä¸€æ¬¡ä¼˜åŒ–ï¼Œå¤šæ¬¡ä½¿ç”¨â€ï¼Œä¸ç”¨è¿›è¡Œé‡å¤çš„é€»è¾‘å’Œç‰©ç†ä¼˜åŒ–è¿‡ç¨‹ã€‚&lt;/li&gt;&lt;li&gt;æ›´å°‘çš„ç½‘ç»œä¼ è¾“ï¼Œå› ä¸ºå¤šæ¬¡æ‰§è¡Œåªç”¨ä¼ è¾“å‚æ•°éƒ¨åˆ†ï¼Œå¹¶ä¸”è¿”å›ç»“æœ Binary åè®®ã€‚&lt;/li&gt;&lt;li&gt;å› ä¸ºæ˜¯åœ¨æ‰§è¡Œçš„åŒæ—¶å¡«å……å‚æ•°ï¼Œå¯ä»¥é˜²æ­¢ SQL æ³¨å…¥é£é™©ã€‚&lt;/li&gt;&lt;li&gt;æŸäº›ç‰¹æ€§æ¯”å¦‚ serverSideCursor éœ€è¦æ˜¯é€šè¿‡ Prepare statement æ‰èƒ½ä½¿ç”¨ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;TiDB å’Œ &lt;a href=&quot;http://link.zhihu.com/?target=https%3A//dev.mysql.com/doc/refman/5.7/en/sql-syntax-prepared-statements.html&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;MySQL åè®®&lt;/a&gt; ä¸€æ ·ï¼Œå¯¹äºå‘èµ· Prepare/Execute è¿™ç§ä½¿ç”¨è®¿é—®æ¨¡å¼æä¾›ä¸¤ç§æ–¹å¼ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Binary åè®®ï¼šå³ä¸Šè¿°çš„ä½¿ç”¨ &lt;code&gt;COM_STMT_PREPARE&lt;/code&gt;ï¼Œ&lt;code&gt;COM_STMT_EXECUTE&lt;/code&gt;ï¼Œ&lt;code&gt;COM_STMT_CLOSE&lt;/code&gt; å‘½ä»¤å¹¶ä¸”é€šè¿‡ Binary åè®®è·å–è¿”å›ç»“æœï¼Œè¿™æ˜¯ç›®å‰å„ç§åº”ç”¨å¼€å‘å¸¸ä½¿ç”¨çš„æ–¹å¼ã€‚&lt;/li&gt;&lt;li&gt;æ–‡æœ¬åè®®ï¼šä½¿ç”¨ &lt;code&gt;COM_QUERY&lt;/code&gt;ï¼Œå¹¶ä¸”ç”¨ &lt;code&gt;PREPARE&lt;/code&gt;ï¼Œ&lt;code&gt;EXECUTE&lt;/code&gt;ï¼Œ&lt;code&gt;DEALLOCATE PREPARE&lt;/code&gt; ä½¿ç”¨æ–‡æœ¬åè®®è·å–ç»“æœï¼Œè¿™ä¸ªæ•ˆç‡ä¸å¦‚ä¸Šä¸€ç§ï¼Œå¤šç”¨äºéç¨‹åºè°ƒç”¨åœºæ™¯ï¼Œæ¯”å¦‚åœ¨ MySQL å®¢æˆ·ç«¯ä¸­æ‰‹å·¥æ‰§è¡Œã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;ä¸‹é¢æˆ‘ä»¬ä¸»è¦ä»¥ Binary åè®®æ¥çœ‹ä¸‹ TiDB çš„å¤„ç†è¿‡ç¨‹ã€‚æ–‡æœ¬åè®®çš„å¤„ç†ä¸ Binary åè®®å¤„ç†è¿‡ç¨‹æ¯”è¾ƒç±»ä¼¼ï¼Œæˆ‘ä»¬ä¼šåœ¨åé¢ç®€è¦ä»‹ç»ä¸€ä¸‹å®ƒä»¬çš„å·®å¼‚ç‚¹ã€‚&lt;/p&gt;&lt;h2&gt;&lt;code&gt;&lt;b&gt;COM_STMT_PREPARE&lt;/b&gt;&lt;/code&gt;&lt;/h2&gt;&lt;p&gt;é¦–å…ˆï¼Œå®¢æˆ·ç«¯å‘èµ· &lt;code&gt;COM_STMT_PREPARE&lt;/code&gt;ï¼Œåœ¨ TiDB æ”¶åˆ°åä¼šè¿›å…¥ &lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/lysu/tidb/blob/source-read-prepare/server/conn_stmt.go%23L51&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;clientConn#handleStmtPrepare&lt;/a&gt;&lt;/code&gt;ï¼Œè¿™ä¸ªå‡½æ•°ä¼šé€šè¿‡è°ƒç”¨ &lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/lysu/tidb/blob/source-read-prepare/server/driver_tidb.go%23L305&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TiDBContext#Prepare&lt;/a&gt;&lt;/code&gt; æ¥è¿›è¡Œå®é™… Prepare æ“ä½œå¹¶è¿”å› &lt;a href=&quot;http://link.zhihu.com/?target=https%3A//dev.mysql.com/doc/internals/en/com-stmt-prepare-response.html&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;ç»“æœ&lt;/a&gt; ç»™å®¢æˆ·ç«¯ï¼Œå®é™…çš„ Prepare å¤„ç†ä¸»è¦åœ¨ &lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/lysu/tidb/blob/source-read-prepare/session/session.go%23L924&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;session#PrepareStmt&lt;/a&gt;&lt;/code&gt;å’Œ &lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/lysu/tidb/blob/source-read-prepare/executor/prepared.go%23L73&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;PrepareExec&lt;/a&gt;&lt;/code&gt; ä¸­å®Œæˆï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;è°ƒç”¨ Parser å®Œæˆæ–‡æœ¬åˆ° AST çš„è½¬æ¢ï¼Œè¿™éƒ¨åˆ†å¯ä»¥å‚è€ƒ&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//pingcap.com/blog-cn/tidb-source-code-reading-5/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;ã€ŠTiDB æºç é˜…è¯»ç³»åˆ—æ–‡ç« ï¼ˆäº”ï¼‰TiDB SQL Parser çš„å®ç°ã€‹&lt;/a&gt;ã€‚&lt;/li&gt;&lt;li&gt;ä½¿ç”¨åä¸º &lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/lysu/tidb/blob/source-read-prepare/executor/prepared.go%23L57&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;paramMarkerExtractor&lt;/a&gt;&lt;/code&gt; çš„ visitor ä» AST ä¸­æå– â€œ?â€ è¡¨è¾¾å¼ï¼Œå¹¶æ ¹æ®å‡ºç°ä½ç½®ï¼ˆoffsetï¼‰æ„å»ºæ’åº Sliceï¼Œåé¢æˆ‘ä»¬ä¼šçœ‹åˆ°åœ¨ Execute æ—¶ä¼šé€šè¿‡è¿™ä¸ª Slice å€¼æ¥å¿«é€Ÿå®šä½å¹¶æ›¿æ¢ â€œ?â€ å ä½ç¬¦ã€‚&lt;/li&gt;&lt;li&gt;æ£€æŸ¥å‚æ•°ä¸ªæ•°æ˜¯å¦è¶…è¿‡ Uint16 æœ€å¤§å€¼ï¼ˆè¿™ä¸ªæ˜¯ &lt;a href=&quot;http://link.zhihu.com/?target=https%3A//dev.mysql.com/doc/internals/en/com-stmt-prepare-response.html&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;åè®®é™åˆ¶&lt;/a&gt;ï¼Œå¯¹äºå‚æ•°åªæä¾› 2 ä¸ª Byteï¼‰ã€‚&lt;/li&gt;&lt;li&gt;è¿›è¡Œ Preprocessï¼Œ å¹¶ä¸”åˆ›å»º LogicPlanï¼Œ è¿™éƒ¨åˆ†å®ç°å¯ä»¥å‚è€ƒä¹‹å‰å…³äº &lt;a href=&quot;http://link.zhihu.com/?target=https%3A//pingcap.com/blog-cn/tidb-source-code-reading-7/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;é€»è¾‘ä¼˜åŒ–çš„ä»‹ç»&lt;/a&gt;ï¼Œè¿™é‡Œç”Ÿæˆ LogicPlan ä¸»è¦ä¸ºäº†è·å–å¹¶æ£€æŸ¥ç»„æˆ Prepare å“åº”ä¸­éœ€è¦çš„åˆ—ä¿¡æ¯ã€‚&lt;/li&gt;&lt;li&gt;ç”Ÿæˆ &lt;code&gt;stmtID&lt;/code&gt;ï¼Œç”Ÿæˆçš„æ–¹å¼æ˜¯å½“å‰ä¼šè¯ä¸­çš„é€’å¢ intã€‚&lt;/li&gt;&lt;li&gt;ä¿å­˜ &lt;code&gt;stmtID&lt;/code&gt; åˆ° &lt;code&gt;ast.Prepared&lt;/code&gt; (ç”± ASTï¼Œå‚æ•°ç±»å‹ä¿¡æ¯ï¼Œschema ç‰ˆæœ¬ï¼Œæ˜¯å¦ä½¿ç”¨ &lt;code&gt;PreparedPlanCache&lt;/code&gt; æ ‡è®°ç»„æˆ) çš„æ˜ å°„ä¿¡æ¯åˆ° &lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/lysu/tidb/blob/source-read-prepare/sessionctx/variable/session.go%23L185&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;SessionVars#PreparedStmts&lt;/a&gt;&lt;/code&gt; ä¸­ä¾› Execute éƒ¨åˆ†ä½¿ç”¨ã€‚&lt;/li&gt;&lt;li&gt;ä¿å­˜ &lt;code&gt;stmtID&lt;/code&gt; åˆ° &lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/lysu/tidb/blob/source-read-prepare/server/driver_tidb.go%23L57&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TiDBStatement&lt;/a&gt;&lt;/code&gt; ï¼ˆç”± &lt;code&gt;stmtID&lt;/code&gt;ï¼Œå‚æ•°ä¸ªæ•°ï¼ŒSQL è¿”å›åˆ—ç±»å‹ä¿¡æ¯ï¼Œ&lt;code&gt;sendLongData&lt;/code&gt; é¢„ &lt;code&gt;BoundParams&lt;/code&gt; ç»„æˆï¼‰çš„æ˜ å°„ä¿¡æ¯ä¿å­˜åˆ° &lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/lysu/tidb/blob/source-read-prepare/server/driver_tidb.go%23L53&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TiDBContext#stmts&lt;/a&gt;&lt;/code&gt;ã€‚&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;åœ¨å¤„ç†å®Œæˆä¹‹åå®¢æˆ·ç«¯ä¼šæ”¶åˆ°å¹¶æŒæœ‰ &lt;code&gt;stmtID&lt;/code&gt; å’Œå‚æ•°ç±»å‹ä¿¡æ¯ï¼Œè¿”å›åˆ—ç±»å‹ä¿¡æ¯ï¼Œåç»­å³å¯é€šè¿‡ &lt;code&gt;stmtID&lt;/code&gt; è¿›è¡Œæ‰§è¡Œæ—¶ï¼Œserver å¯ä»¥é€šè¿‡ 6ã€7 æ­¥ä¿å­˜æ˜ å°„æ‰¾åˆ°å·²ç» Prepare çš„ä¿¡æ¯ã€‚&lt;/p&gt;&lt;h2&gt;&lt;code&gt;&lt;b&gt;COM_STMT_EXECUTE&lt;/b&gt;&lt;/code&gt;&lt;/h2&gt;&lt;p&gt; Prepare æˆåŠŸä¹‹åï¼Œå®¢æˆ·ç«¯ä¼šé€šè¿‡ &lt;code&gt;COM_STMT_EXECUTE&lt;/code&gt; å‘½ä»¤è¯·æ±‚æ‰§è¡Œï¼ŒTiDB ä¼šè¿›å…¥ &lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/lysu/tidb/blob/source-read-prepare/server/conn_stmt.go%23L108&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;clientConn#handleStmtExecute&lt;/a&gt;&lt;/code&gt;ï¼Œé¦–å…ˆä¼šé€šè¿‡ stmtID åœ¨ä¸ŠèŠ‚ä»‹ç»ä¸­ä¿å­˜çš„ &lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/lysu/tidb/blob/source-read-prepare/server/driver_tidb.go%23L53&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TiDBContext#stmts&lt;/a&gt;&lt;/code&gt; ä¸­è·å–å‰é¢ä¿å­˜çš„ &lt;code&gt;TiDBStatement&lt;/code&gt;ï¼Œå¹¶è§£æå‡ºæ˜¯å¦ä½¿ç”¨ &lt;code&gt;userCursor&lt;/code&gt; å’Œè¯·æ±‚å‚æ•°ä¿¡æ¯ï¼Œå¹¶ä¸”è°ƒç”¨å¯¹åº” &lt;code&gt;TiDBStatement&lt;/code&gt; çš„ Execute è¿›è¡Œå®é™…çš„ Execute é€»è¾‘ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;ç”Ÿæˆ &lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/pingcap/parser/blob/732efe993f70da99fdc18acb380737be33f2333a/ast/misc.go%23L218&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;ast.ExecuteStmt&lt;/a&gt;&lt;/code&gt; å¹¶è°ƒç”¨ &lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/lysu/tidb/blob/source-read-prepare/planner/optimize.go%23L28&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;planer.Optimize&lt;/a&gt;&lt;/code&gt; ç”Ÿæˆ &lt;code&gt;plancore.Execute&lt;/code&gt;ï¼Œå’Œæ™®é€šä¼˜åŒ–è¿‡ç¨‹ä¸åŒçš„æ˜¯ä¼šæ‰§è¡Œ &lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/lysu/tidb/blob/source-read-prepare/planner/optimize.go%23L53&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Exeucte#OptimizePreparedPlan&lt;/a&gt;&lt;/code&gt;ã€‚&lt;/li&gt;&lt;li&gt;ä½¿ç”¨ &lt;code&gt;stmtID&lt;/code&gt; é€šè¿‡ &lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/lysu/tidb/blob/source-read-prepare/sessionctx/variable/session.go%23L190&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;SessionVars#PreparedStmts&lt;/a&gt;&lt;/code&gt; è·å–åˆ°åˆ° Prepare é˜¶æ®µçš„ &lt;code&gt;ast.Prepared&lt;/code&gt; ä¿¡æ¯ã€‚&lt;/li&gt;&lt;li&gt;ä½¿ç”¨ä¸Šä¸€èŠ‚ç¬¬ 2 æ­¥ä¸­å‡†å¤‡çš„ &lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/lysu/tidb/blob/source-read-prepare/planner/core/common_plans.go%23L167&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;prepared.Params&lt;/a&gt;&lt;/code&gt; æ¥å¿«é€ŸæŸ¥æ‰¾å¹¶å¡«å……å‚æ•°å€¼ï¼›åŒæ—¶ä¼šä¿å­˜ä¸€ä»½å‚æ•°åˆ° &lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/lysu/tidb/blob/source-read-prepare/sessionctx/variable/session.go%23L190&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;sessionVars.PreparedParams&lt;/a&gt;&lt;/code&gt; ä¸­ï¼Œè¿™ä¸ªä¸»è¦ç”¨äºæ”¯æŒ &lt;code&gt;PreparePlanCache&lt;/code&gt; å»¶è¿Ÿè·å–å‚æ•°ã€‚&lt;/li&gt;&lt;li&gt;åˆ¤æ–­å¯¹æ¯”åˆ¤æ–­ Prepare å’Œ Execute ä¹‹é—´ schema æ˜¯å¦æœ‰å˜åŒ–ï¼Œå¦‚æœæœ‰å˜åŒ–åˆ™é‡æ–° Preprocessã€‚&lt;/li&gt;&lt;li&gt;ä¹‹åè°ƒç”¨ &lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/lysu/tidb/blob/source-read-prepare/planner/core/common_plans.go%23L188&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Execute#getPhysicalPlan&lt;/a&gt;&lt;/code&gt; è·å–ç‰©ç†è®¡åˆ’ï¼Œå®ç°ä¸­é¦–å…ˆä¼šæ ¹æ®æ˜¯å¦å¯ç”¨ PreparedPlanCache æ¥æŸ¥æ‰¾å·²ç¼“å­˜çš„ Planï¼Œæœ¬æ–‡åé¢æˆ‘ä»¬ä¹Ÿä¼šä¸“é—¨ä»‹ç»è¿™ä¸ªã€‚&lt;/li&gt;&lt;li&gt;åœ¨æ²¡æœ‰å¼€å¯ PreparedPlanCache æˆ–è€…å¼€å¯äº†ä½†æ²¡å‘½ä¸­ cache æ—¶ï¼Œä¼šå¯¹ AST è¿›è¡Œä¸€æ¬¡æ­£å¸¸çš„ Optimizeã€‚&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;åœ¨è·å–åˆ° PhysicalPlan åå°±æ˜¯æ­£å¸¸çš„ &lt;a href=&quot;https://zhuanlan.zhihu.com/p/35134962&quot; class=&quot;internal&quot;&gt;Executing æ‰§è¡Œ&lt;/a&gt;ã€‚&lt;/p&gt;&lt;h2&gt;&lt;code&gt;&lt;b&gt;COM_STMT_CLOSE&lt;/b&gt;&lt;/code&gt;&lt;/h2&gt;&lt;p&gt; åœ¨å®¢æˆ·ä¸å†éœ€è¦æ‰§è¡Œä¹‹å‰çš„ Prepared çš„è¯­å¥æ—¶ï¼Œå¯ä»¥é€šè¿‡&lt;code&gt;COM_STMT_CLOSE&lt;/code&gt;æ¥é‡Šæ”¾æœåŠ¡å™¨èµ„æºï¼ŒTiDB æ”¶åˆ°åä¼šè¿›å…¥&lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/lysu/tidb/blob/source-read-prepare/server/conn_stmt.go%23L501&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;clientConn#handleStmtClose&lt;/a&gt;&lt;/code&gt;ï¼Œä¼šé€šè¿‡&lt;code&gt;stmtID&lt;/code&gt;åœ¨&lt;code&gt;TiDBContext#stmts&lt;/code&gt;ä¸­æ‰¾åˆ°å¯¹åº”çš„&lt;code&gt;TiDBStatement&lt;/code&gt;ï¼Œå¹¶ä¸”æ‰§è¡Œ&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/lysu/tidb/blob/source-read-prepare/server/driver_tidb.go%23L152&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Close&lt;/a&gt;æ¸…ç†ä¹‹å‰çš„ä¿å­˜çš„&lt;code&gt;TiDBContext#stmts&lt;/code&gt;å’Œ&lt;code&gt;SessionVars#PrepareStmts&lt;/code&gt;ï¼Œä¸è¿‡é€šè¿‡ä»£ç æˆ‘ä»¬çœ‹åˆ°ï¼Œå¯¹äºå‰è€…çš„ç¡®ç›´æ¥è¿›è¡Œäº†æ¸…ç†ï¼Œå¯¹äºåè€…ä¸ä¼šåˆ é™¤è€Œæ˜¯åŠ å…¥åˆ°&lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/lysu/tidb/blob/source-read-prepare/session/session.go%23L1020&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;RetryInfo#DroppedPreparedStmtIDs&lt;/a&gt;&lt;/code&gt;ä¸­ï¼Œç­‰å¾…å½“å‰äº‹åŠ¡æäº¤æˆ–å›æ»šæ‰ä¼šä»&lt;code&gt;SessionVars#PrepareStmts&lt;/code&gt;ä¸­æ¸…ç†ï¼Œä¹‹æ‰€ä»¥å»¶è¿Ÿåˆ é™¤æ˜¯ç”±äº TiDB åœ¨äº‹åŠ¡æäº¤é˜¶æ®µé‡åˆ°å†²çªä¼šæ ¹æ®é…ç½®å†³å®šæ˜¯å¦é‡è¯•äº‹åŠ¡ï¼Œå‚ä¸é‡è¯•çš„è¯­å¥å¯èƒ½åªæœ‰ Execute å’Œ Deallocateï¼Œä¸ºäº†ä¿è¯é‡è¯•è¿˜èƒ½é€šè¿‡&lt;code&gt;stmtID&lt;/code&gt;æ‰¾åˆ° prepared çš„è¯­å¥ TiDB ç›®å‰ä½¿ç”¨å»¶è¿Ÿåˆ°äº‹åŠ¡æ‰§è¡Œå®Œæˆåæ‰åšæ¸…ç†ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;å…¶ä»– &lt;code&gt;COM_STMT&lt;/code&gt;&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;br&gt;é™¤äº†ä¸Šé¢ä»‹ç»çš„ 3 ä¸ª &lt;code&gt;COM_STMT&lt;/code&gt;ï¼Œè¿˜æœ‰å¦å¤–å‡ ä¸ª &lt;code&gt;COM_STMT_SEND_LONG_DATA&lt;/code&gt;ï¼Œ&lt;code&gt;COM_STMT_FETCH&lt;/code&gt;ï¼Œ&lt;code&gt;COM_STMT_RESET&lt;/code&gt; ä¹Ÿä¼šåœ¨ Prepare ä¸­ä½¿ç”¨åˆ°ã€‚&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;code&gt;&lt;b&gt;COM_STMT_SEND_LONG_DATA&lt;/b&gt;&lt;/code&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;æŸäº›åœºæ™¯æˆ‘ä»¬ SQL ä¸­çš„å‚æ•°æ˜¯ &lt;code&gt;TEXT&lt;/code&gt;ï¼Œ&lt;code&gt;TINYTEXT&lt;/code&gt;ï¼Œ&lt;code&gt;MEDIUMTEXT&lt;/code&gt;ï¼Œ&lt;code&gt;LONGTEXT&lt;/code&gt; and &lt;code&gt;BLOB&lt;/code&gt;ï¼Œ&lt;code&gt;TINYBLOB&lt;/code&gt;ï¼Œ&lt;code&gt;MEDIUMBLOB&lt;/code&gt;ï¼Œ&lt;code&gt;LONGBLOB&lt;/code&gt; åˆ—æ—¶ï¼Œå®¢æˆ·ç«¯é€šå¸¸ä¸ä¼šåœ¨ä¸€æ¬¡ Execute ä¸­å¸¦å¤§é‡çš„å‚æ•°ï¼Œè€Œæ˜¯å•ç‹¬é€šè¿‡ &lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//dev.mysql.com/doc/internals/en/com-stmt-send-long-data.html&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;COM_SEND_LONG_DATA&lt;/a&gt;&lt;/code&gt; é¢„å…ˆå‘åˆ° TiDBï¼Œæœ€åå†è¿›è¡Œ Executeã€‚&lt;/p&gt;&lt;p&gt;TiDB çš„å¤„ç†åœ¨ &lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/lysu/tidb/blob/source-read-prepare/server/conn_stmt.go%23L514&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;client#handleStmtSendLongData&lt;/a&gt;&lt;/code&gt;ï¼Œé€šè¿‡ &lt;code&gt;stmtID&lt;/code&gt; åœ¨ &lt;code&gt;TiDBContext#stmts&lt;/code&gt; ä¸­æ‰¾åˆ° &lt;code&gt;TiDBStatement&lt;/code&gt; å¹¶æå‰æ”¾ç½® &lt;code&gt;paramID&lt;/code&gt; å¯¹åº”çš„å‚æ•°ä¿¡æ¯ï¼Œè¿›è¡Œè¿½åŠ å‚æ•°åˆ° &lt;code&gt;boundParams&lt;/code&gt;ï¼ˆæ‰€ä»¥å®¢æˆ·ç«¯å…¶å®å¯ä»¥å¤šæ¬¡ send æ•°æ®å¹¶è¿½åŠ åˆ°ä¸€ä¸ªå‚æ•°ä¸Šï¼‰ï¼ŒExecute æ—¶ä¼šé€šè¿‡ &lt;code&gt;stmt.BoundParams()&lt;/code&gt; è·å–åˆ°æå‰ä¼ è¿‡æ¥çš„å‚æ•°å¹¶å’Œ Execute å‘½ä»¤å¸¦çš„å‚æ•° &lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/lysu/tidb/blob/source-read-prepare/server/conn_stmt.go%23L176&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;ä¸€èµ·æ‰§è¡Œ&lt;/a&gt;ï¼Œåœ¨æ¯æ¬¡æ‰§è¡Œå®Œæˆåä¼šé‡ç½® &lt;code&gt;boundParams&lt;/code&gt;ã€‚&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;code&gt;&lt;b&gt;COM_STMT_FETCH&lt;/b&gt;&lt;/code&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;é€šå¸¸çš„ Execute æ‰§è¡Œåï¼ŒTiDB ä¼šå‘å®¢æˆ·ç«¯æŒç»­è¿”å›ç»“æœï¼Œè¿”å›é€Ÿç‡å— &lt;code&gt;max_chunk_size&lt;/code&gt; æ§åˆ¶ï¼ˆè§ã€Š&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//pingcap.com/blog-cn/tidb-source-code-reading-10/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TiDB æºç é˜…è¯»ç³»åˆ—æ–‡ç« ï¼ˆåï¼‰Chunk å’Œæ‰§è¡Œæ¡†æ¶ç®€ä»‹&lt;/a&gt;ã€‹ï¼‰ï¼Œ ä½†å®é™…ä¸­è¿”å›çš„ç»“æœé›†å¯èƒ½éå¸¸å¤§ã€‚å®¢æˆ·ç«¯å—é™äºèµ„æºï¼ˆä¸€èˆ¬æ˜¯å†…å­˜ï¼‰æ— æ³•ä¸€æ¬¡å¤„ç†é‚£ä¹ˆå¤šæ•°æ®ï¼Œå°±å¸Œæœ›æœåŠ¡ç«¯ä¸€æ‰¹æ‰¹è¿”å›ï¼Œ&lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//dev.mysql.com/doc/internals/en/com-stmt-fetch.html&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;COM_STMT_FETCH&lt;/a&gt;&lt;/code&gt; æ­£å¥½è§£å†³è¿™ä¸ªé—®é¢˜ã€‚&lt;/p&gt;&lt;p&gt;å®ƒçš„ä½¿ç”¨é¦–å…ˆè¦å’Œ &lt;code&gt;COM_STMT_EXECUTE&lt;/code&gt; é…åˆï¼ˆä¹Ÿå°±æ˜¯å¿…é¡»ä½¿ç”¨ Prepared è¯­å¥æ‰§è¡Œï¼‰ï¼Œ &lt;code&gt;handleStmtExeucte&lt;/code&gt; è¯·æ±‚åè®® flag ä¸­æœ‰æ ‡è®°è¦ä½¿ç”¨ cursorï¼Œexecute åœ¨å®Œæˆ plan æ‹¿åˆ°ç»“æœé›†åå¹¶ä¸ç«‹å³æ‰§è¡Œè€Œæ˜¯æŠŠå®ƒç¼“å­˜åˆ° &lt;code&gt;TiDBStatement&lt;/code&gt; ä¸­ï¼Œå¹¶ç«‹åˆ»å‘å®¢æˆ·ç«¯å›åŒ…ä¸­å¸¦ä¸Šåˆ—ä¿¡æ¯å¹¶æ ‡è®° &lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//dev.mysql.com/doc/internals/en/status-flags.html&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;ServerStatusCursorExists&lt;/a&gt;&lt;/code&gt;ï¼Œè¿™éƒ¨åˆ†é€»è¾‘å¯ä»¥å‚çœ‹ &lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/lysu/tidb/blob/source-read-prepare/server/conn_stmt.go%23L193&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;handleStmtExecute&lt;/a&gt;&lt;/code&gt;ã€‚&lt;/p&gt;&lt;p&gt;å®¢æˆ·ç«¯çœ‹åˆ° &lt;code&gt;ServerStatusCursorExists&lt;/code&gt; åï¼Œä¼šç”¨ &lt;code&gt;COM_STMT_FETCH&lt;/code&gt; å‘ TiDB æ‹‰å»æŒ‡å®š fetchSize å¤§å°çš„ç»“æœé›†ï¼Œåœ¨ &lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/lysu/tidb/blob/source-read-prepare/server/conn_stmt.go%23L210&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;connClient#handleStmtFetch&lt;/a&gt;&lt;/code&gt; ä¸­ï¼Œä¼šé€šè¿‡ session æ‰¾åˆ° &lt;code&gt;TiDBStatement&lt;/code&gt; è¿›è€Œæ‰¾åˆ°ä¹‹å‰ç¼“å­˜çš„ç»“æœé›†ï¼Œå¼€å§‹å®é™…è°ƒç”¨æ‰§è¡Œå™¨çš„ Next è·å–æ»¡è¶³ fetchSize çš„æ•°æ®å¹¶è¿”å›å®¢æˆ·ç«¯ï¼Œå¦‚æœæ‰§è¡Œå™¨ä¸€æ¬¡ Next è¶…è¿‡äº† fetchSize ä¼šåªè¿”å› fetchSize å¤§å°çš„æ•°æ®å¹¶æŠŠå‰©ä¸‹çš„æ•°æ®ç•™ç€ä¸‹æ¬¡å†ç»™å®¢æˆ·ç«¯ï¼Œæœ€åå¯¹äºç»“æœé›†æœ€åä¸€æ¬¡è¿”å›ä¼šæ ‡è®° &lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//dev.mysql.com/doc/internals/en/status-flags.html&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;ServerStatusLastRowSend&lt;/a&gt;&lt;/code&gt; çš„ flag é€šçŸ¥å®¢æˆ·ç«¯æ²¡æœ‰åç»­æ•°æ®ã€‚&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;code&gt;&lt;b&gt;COM_STMT_RESET&lt;/b&gt;&lt;/code&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;ä¸»è¦ç”¨äºå®¢æˆ·ç«¯ä¸»åŠ¨é‡ç½® &lt;code&gt;COM_SEND_LONG_DATA&lt;/code&gt; å‘æ¥çš„æ•°æ®ï¼Œæ­£å¸¸ &lt;code&gt;COM_STMT_EXECUTE&lt;/code&gt; åä¼šè‡ªåŠ¨é‡ç½®ï¼Œä¸»è¦é’ˆå¯¹å®¢æˆ·ç«¯å¸Œæœ›ä¸»åŠ¨åºŸå¼ƒä¹‹å‰æ•°æ®çš„æƒ…å†µï¼Œå› ä¸º &lt;code&gt;COM_STMT_SEND_LONG_DATA&lt;/code&gt; æ˜¯ä¸€ç›´è¿½åŠ çš„æ“ä½œï¼Œå®¢æˆ·ç«¯æŸäº›åœºæ™¯éœ€è¦ä¸»åŠ¨æ”¾å¼ƒä¹‹å‰é¢„å­˜çš„å‚æ•°ï¼Œè¿™éƒ¨åˆ†é€»è¾‘ä¸»è¦ä½äº &lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/lysu/tidb/blob/source-read-prepare/server/conn_stmt.go%23L531&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;connClient#handleStmtReset&lt;/a&gt;&lt;/code&gt; ä¸­ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;Prepared Plan Cache&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;é€šè¿‡å‰é¢çš„è§£æè¿‡ç¨‹æˆ‘ä»¬çœ‹åˆ°åœ¨ Prepare æ—¶å®Œæˆäº† AST è½¬æ¢ï¼Œåœ¨ä¹‹åçš„ Execute ä¼šé€šè¿‡ &lt;code&gt;stmtID&lt;/code&gt; æ‰¾ä¹‹å‰çš„ AST æ¥è¿›è¡Œ Plan è·³è¿‡æ¯æ¬¡éƒ½è¿›è¡Œ Parse SQL çš„å¼€é”€ã€‚å¦‚æœå¼€å¯äº† Prepare Plan Cacheï¼Œå¯è¿›ä¸€æ­¥åœ¨ Execute å¤„ç†ä¸­é‡ç”¨ä¸Šæ¬¡çš„ PhysicalPlan ç»“æœï¼Œçœæ‰æŸ¥è¯¢ä¼˜åŒ–è¿‡ç¨‹çš„å¼€é”€ã€‚&lt;/p&gt;&lt;p&gt;TiDB å¯ä»¥é€šè¿‡ &lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/lysu/tidb/blob/source-read-prepare/config/config.toml.example%23L167&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;ä¿®æ”¹é…ç½®æ–‡ä»¶&lt;/a&gt; å¼€å¯ Prepare Plan Cacheï¼Œ å¼€å¯åæ¯ä¸ªæ–° Session åˆ›å»ºæ—¶ä¼šåˆå§‹åŒ–ä¸€ä¸ª &lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/lysu/tidb/blob/source-read-prepare/util/kvcache/simple_lru.go%23L38&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;SimpleLRUCache&lt;/a&gt;&lt;/code&gt; ç±»å‹çš„ &lt;code&gt;preparedPlanCache&lt;/code&gt; ç”¨äºä¿å­˜ç”¨äºç¼“å­˜ Plan ç»“æœï¼Œç¼“å­˜çš„ key æ˜¯ &lt;code&gt;pstmtPlanCacheKey&lt;/code&gt;ï¼ˆç”±å½“å‰ DBï¼Œè¿æ¥ IDï¼Œ&lt;code&gt;statementID&lt;/code&gt;ï¼Œ&lt;code&gt;schemaVersion&lt;/code&gt;ï¼Œ &lt;code&gt;snapshotTs&lt;/code&gt;ï¼Œ&lt;code&gt;sqlMode&lt;/code&gt;ï¼Œ&lt;code&gt;timezone&lt;/code&gt; ç»„æˆï¼Œæ‰€ä»¥è¦å‘½ä¸­ plan cache è¿™ä»¥ä¸Šå…ƒç´ å¿…é¡»éƒ½å’Œä¸Šæ¬¡ç¼“å­˜çš„ä¸€è‡´ï¼‰ï¼Œå¹¶æ ¹æ®é…ç½®çš„ç¼“å­˜å¤§å°å’Œå†…å­˜å¤§å°åš LRUã€‚&lt;/p&gt;&lt;p&gt;åœ¨ Execute çš„å¤„ç†é€»è¾‘ &lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/lysu/tidb/blob/source-read-prepare/executor/prepared.go%23L161&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;PrepareExec&lt;/a&gt;&lt;/code&gt; ä¸­é™¤äº†æ£€æŸ¥ &lt;code&gt;PreparePlanCache&lt;/code&gt; æ˜¯å¦å¼€å¯å¤–ï¼Œè¿˜ä¼šåˆ¤æ–­å½“å‰çš„è¯­å¥æ˜¯å¦èƒ½ä½¿ç”¨ &lt;code&gt;PreparePlanCache&lt;/code&gt;ã€‚&lt;/p&gt;&lt;ol&gt;&lt;li&gt;åªæœ‰ &lt;code&gt;SELECT&lt;/code&gt;ï¼Œ&lt;code&gt;INSERT&lt;/code&gt;ï¼Œ&lt;code&gt;UPDATE&lt;/code&gt;ï¼Œ&lt;code&gt;DELETE&lt;/code&gt; æœ‰å¯èƒ½å¯ä»¥ä½¿ç”¨ &lt;code&gt;PreparedPlanCache&lt;/code&gt;	ã€‚&lt;/li&gt;&lt;li&gt;å¹¶è¿›ä¸€æ­¥é€šè¿‡ &lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/lysu/tidb/blob/source-read-prepare/planner/core/cacheable_checker.go%23L43&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;cacheableChecker&lt;/a&gt;&lt;/code&gt; visitor æ£€æŸ¥ AST ä¸­æ˜¯å¦æœ‰å˜é‡è¡¨è¾¾å¼ï¼Œå­æŸ¥è¯¢ï¼Œ&quot;order by ?&quot;ï¼Œ&quot;limit ?ï¼Œ?&quot; å’Œ UnCacheableFunctions çš„å‡½æ•°è°ƒç”¨ç­‰ä¸å¯ä»¥ä½¿ç”¨ PlanCache çš„æƒ…å†µã€‚&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;å¦‚æœæ£€æŸ¥éƒ½é€šè¿‡åˆ™åœ¨ &lt;code&gt;Execute#getPhysicalPlan&lt;/code&gt; ä¸­ä¼šç”¨å½“å‰ç¯å¢ƒæ„å»º cache key æŸ¥æ‰¾ &lt;code&gt;preparePlanCache&lt;/code&gt;ã€‚&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;æœªå‘½ä¸­ Cache&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;æˆ‘ä»¬é¦–å…ˆæ¥çœ‹ä¸‹æ²¡æœ‰å‘½ä¸­ Cache çš„æƒ…å†µã€‚å‘ç°æ²¡æœ‰å‘½ä¸­åä¼šç”¨ &lt;code&gt;stmtID&lt;/code&gt; æ‰¾åˆ°çš„ AST æ‰§è¡Œ &lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/lysu/tidb/blob/source-read-prepare/executor/prepared.go%23L161&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Optimize&lt;/a&gt;ï¼Œä½†å’Œæ­£å¸¸æ‰§è¡Œ Optimize ä¸åŒå¯¹äº Cache çš„ Planï¼Œ æˆ‘éœ€è¦å¯¹ â€œ?â€ åšå»¶è¿Ÿæ±‚å€¼å¤„ç†ï¼Œ å³å°†å ä½ç¬¦è½¬æ¢ä¸ºä¸€ä¸ª function åš Plan å¹¶ Cacheï¼Œ åç»­ä» Cache è·å–å function åœ¨æ‰§è¡Œæ—¶å†ä»å…·ä½“æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­å®é™…è·å–æ‰§è¡Œå‚æ•°ã€‚&lt;/p&gt;&lt;p&gt;å›é¡¾ä¸‹æ„å»º LogicPlan çš„è¿‡ç¨‹ä¸­ä¼šé€šè¿‡ &lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/lysu/tidb/blob/source-read-prepare/planner/core/expression_rewriter.go%23L151&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;expressionRewriter&lt;/a&gt;&lt;/code&gt; å°† AST è½¬æ¢ä¸ºå„ç±» &lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/lysu/tidb/blob/source-read-prepare/expression/expression.go%23L42&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;expression.Expression&lt;/a&gt;&lt;/code&gt;ï¼Œé€šå¸¸å¯¹äº &lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/lysu/tidb/blob/source-read-prepare/types/parser_driver/value_expr.go%23L167&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;ParamMarkerExpr&lt;/a&gt;&lt;/code&gt; ä¼šé‡å†™ä¸º Constant ç±»å‹çš„ expressionï¼Œä½†å¦‚æœè¯¥æ¡ stmt æ”¯æŒ Cache çš„è¯ä¼šé‡å†™ä¸º Constant å¹¶å¸¦ä¸Šä¸€ä¸ªç‰¹æ®Šçš„ &lt;code&gt;DeferredExpr&lt;/code&gt; æŒ‡å‘ä¸€ä¸ª &lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/lysu/tidb/blob/source-read-prepare/expression/builtin_other.go%23L787&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;GetParam&lt;/a&gt;&lt;/code&gt; çš„å‡½æ•°è¡¨è¾¾å¼ï¼Œè€Œè¿™ä¸ªå‡½æ•°ä¼šåœ¨æ‰§è¡Œæ—¶å®é™…ä»å‰é¢ Execute ä¿å­˜åˆ° &lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/lysu/tidb/blob/source-read-prepare/sessionctx/variable/session.go%23L190&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;sessionVars.PreparedParams&lt;/a&gt;&lt;/code&gt; ä¸­è·å–ï¼Œè¿™æ ·å°±åšåˆ°äº† Plan å¹¶ Cache ä¸€ä¸ªå‚æ•°æ— å…³çš„ Planï¼Œç„¶åå®é™…æ‰§è¡Œçš„æ—¶å¡«å……å‚æ•°ã€‚&lt;/p&gt;&lt;p&gt;æ–°è·å– Plan åä¼šä¿å­˜åˆ° &lt;code&gt;preparedPlanCache&lt;/code&gt; ä¾›åç»­ä½¿ç”¨ã€‚&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;å‘½ä¸­ Cache&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;è®©æˆ‘ä»¬å›åˆ° &lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/lysu/tidb/blob/source-read-prepare/planner/core/common_plans.go%23L188&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;getPhysicalPlan&lt;/a&gt;&lt;/code&gt;ï¼Œå¦‚æœ Cache å‘½ä¸­åœ¨è·å– Plan åæˆ‘ä»¬éœ€è¦é‡æ–° build plan çš„ rangeï¼Œå› ä¸ºå‰é¢æˆ‘ä»¬ä¿å­˜çš„ Plan æ˜¯ä¸€ä¸ªå¸¦ &lt;code&gt;GetParam&lt;/code&gt; çš„å‡½æ•°è¡¨è¾¾å¼ï¼Œè€Œå†æ¬¡è·å–åï¼Œå½“å‰å‚æ•°å€¼å·²ç»å˜åŒ–ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®å½“å‰ Execute çš„å‚æ•°æ¥é‡æ–°ä¿®æ­£ rangeï¼Œè¿™éƒ¨åˆ†é€»è¾‘ä»£ç ä½äº &lt;code&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//github.com/lysu/tidb/blob/source-read-prepare/planner/core/common_plans.go%23L214&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Execute#rebuildRange&lt;/a&gt;&lt;/code&gt; ä¸­ï¼Œä¹‹åå°±æ˜¯æ­£å¸¸çš„æ‰§è¡Œè¿‡ç¨‹äº†ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;æ–‡æœ¬åè®®çš„ Prepared&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;å‰é¢ä¸»è¦ä»‹ç»äº†äºŒè¿›åˆ¶åè®®çš„ Prepared æ‰§è¡Œæµç¨‹ï¼Œè¿˜æœ‰ä¸€ç§æ‰§è¡Œæ–¹å¼æ˜¯é€šè¿‡äºŒè¿›åˆ¶åè®®æ¥æ‰§è¡Œã€‚&lt;/p&gt;&lt;p&gt;å®¢æˆ·ç«¯å¯ä»¥é€šè¿‡ &lt;code&gt;COM_QUREY&lt;/code&gt; å‘é€ï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;&lt;span&gt;&lt;/span&gt;PREPARE stmt_name FROM prepareable_stmt;
EXECUTE stmt_name USING @var_name1, @var_name2,...
DEALLOCTE PREPARE stmt_name
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ¥è¿›è¡Œ Preparedï¼ŒTiDB ä¼šèµ°æ­£å¸¸ &lt;a href=&quot;https://zhuanlan.zhihu.com/p/35134962&quot; class=&quot;internal&quot;&gt;æ–‡æœ¬ Query å¤„ç†æµç¨‹&lt;/a&gt;ï¼Œå°† SQL è½¬æ¢ Prepareï¼ŒExecuteï¼ŒDeallocate çš„ Planï¼Œ å¹¶æœ€ç»ˆè½¬æ¢ä¸ºå’ŒäºŒè¿›åˆ¶åè®®ä¸€æ ·çš„ &lt;code&gt;PrepareExec&lt;/code&gt;ï¼Œ&lt;code&gt;ExecuteExec&lt;/code&gt;ï¼Œ&lt;code&gt;DealocateExec&lt;/code&gt; çš„æ‰§è¡Œå™¨è¿›è¡Œæ‰§è¡Œã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;å†™åœ¨æœ€å&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;Prepared æ˜¯æé«˜ç¨‹åº SQL æ‰§è¡Œæ•ˆç‡çš„æœ‰æ•ˆæ‰‹æ®µä¹‹ä¸€ã€‚ç†Ÿæ‚‰ TiDB çš„ Prepared å®ç°ï¼Œå¯ä»¥å¸®åŠ©å„ä½è¯»è€…åœ¨å°†æ¥ä½¿ç”¨ Prepared æ—¶æ›´åŠ å¾—å¿ƒåº”æ‰‹ã€‚å¦å¤–ï¼Œå¦‚æœæœ‰å…´è¶£å‘ TiDB è´¡çŒ®ä»£ç çš„è¯»è€…ï¼Œä¹Ÿå¯ä»¥é€šè¿‡æœ¬æ–‡æ›´å¿«çš„ç†è§£è¿™éƒ¨åˆ†çš„å®ç°ã€‚&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;i&gt;&lt;b&gt;æ›´å¤š TiDB æºç é˜…è¯»ç³»åˆ—æ–‡ç« ï¼š&lt;/b&gt;&lt;/i&gt;&lt;br&gt;&lt;/p&gt;&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//www.pingcap.com/blog-cn/%23%25E6%25BA%2590%25E7%25A0%2581%25E9%2598%2585%25E8%25AF%25BB&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic2.zhimg.com/v2-60ab5bd867c2434d70c957a02a2169e1_ipico.jpg&quot; data-image-width=&quot;1200&quot; data-image-height=&quot;1200&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;åšå®¢&lt;/a&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>ZoeyZhai</author>
<guid isPermaLink="false">2019-01-03-53967950</guid>
<pubDate>Thu, 03 Jan 2019 00:00:00 +0800</pubDate>
</item>
</channel>
</rss>
