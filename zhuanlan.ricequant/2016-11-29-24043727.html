<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>从0到1掌握统计套利</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/24043727">原文</a></p>
<div class="title-image"><img src="https://pic4.zhimg.com/v2-424ed807b72e5c36971c73fb361ab762_r.jpg" alt=""></div><p>首先想到利用配对交易，可能会想到两只股票的相关系数是否会让两只股票的走势有一种特定关系。</p><img src="https://pic4.zhimg.com/v2-c92611fbc46dfc95e38eec03ee9f570e_r.png" data-rawwidth="558" data-rawheight="283"><br><br><img src="https://pic3.zhimg.com/v2-3286246538ed0a88624cda96b823f593_r.png" data-rawwidth="436" data-rawheight="280"><br>从图像上看，数据基本都落在一条直线上那么它们之间的相关性就会很高。 接下来我们来看看两只股票价格之间相关性高长什么样<br><img src="https://pic1.zhimg.com/v2-0b5b3b8f9d5b817dcb9e2ad958d9ebba_r.png" data-rawwidth="577" data-rawheight="321"><br><p>同样数据大多都集中在一条直线上</p><p>找到相关性高的股票对，我们要来研究它们之间的价差，因为这是我们策略套利的关键</p><br><img src="https://pic2.zhimg.com/v2-19329a96f921d1c2b1c986a130e66ebb_r.png" data-rawwidth="662" data-rawheight="414"><img src="https://pic4.zhimg.com/v2-5eb5fdb0c7b4123a720b831cc4e6d847_r.png" data-rawwidth="673" data-rawheight="378"><br><br><p>进一步的我们来看看以均值加减一倍标准差是否包含了大部分的差价区间</p><br><br><img src="https://pic1.zhimg.com/v2-e21abcc83b40a9f9468e9f095e73f881_r.png" data-rawwidth="652" data-rawheight="338"><br><p>可以看到虽然包含了大部分价差区间，但是开仓次数太少，并且在2014年股票的差价都是在上开仓线附近小幅波动，会造成频繁开仓使得成本十分高。 同时观察2015年价差出现极端值，此时如果开仓，价差不收敛，如果没做到好的平仓条件此时会造成大量亏损。 尽管看图像上通过相关系数来做配对交易不太理想，我们还是通过回测来看看具体结果。</p><br><img src="https://pic1.zhimg.com/v2-5edb2909f33a4343958806f025af3b58_r.png" data-rawwidth="808" data-rawheight="447"><br><br><br><p>但是因为中国市场上无法做空，但配对交易需要运用卖空来构建对冲仓位，我们试试在允许做空的情况下策略表现会不会相对较好一点。</p><br><img src="https://pic1.zhimg.com/v2-6aba25030f14ccf21b343a9b8fddbeb1_r.png" data-rawwidth="808" data-rawheight="447"><br><p>中国中冶和中海发展在2014-1-1和2016-11-1的相关性是0.968.让我们计算其60日滚动相关性来看看两者如何变化。</p><img src="https://pic4.zhimg.com/v2-67b1ceb786bbb0b970651171d562e054_r.png" data-rawwidth="511" data-rawheight="306"><br><p>从相关系数的60日滚动相关性来看其实这两只股票相关性高是因为他们在2015年一段时间同时停牌，造成这段时间的相关系数为1，从而拉高了整个时间段内的相关系数，不过两只股票同时停牌也能说明一定问题，比如他们可能会有重组的可能，当然这是后话了。 不过选择股票对时应尽量选取没有停牌的股票。</p><br><p>到了这里你可能会问，</p><br><p>为什么用2014-1-1和2016-11-1计算相关性，回测区间也在这个时间？</p><img src="https://pic3.zhimg.com/v2-a56953ab4a44fbd532f18df5d811426c_r.png" data-rawwidth="266" data-rawheight="246"><br><p>我们知道，以上是错误示范。<br></p><br><p>以样本内得到的结果去回测样本内的数据，会有很大的不真实性。</p><br><p>之前我们谈到了利用两只股票之间的相关系数进行配对交易，但我们能通过两只相关性较高的股票对之间的差价图看出，相关性高他们之间的价差并不一定会是一个平稳序列，简单来说我们无法利用这个不收敛的价差来进行套利。</p><br><p>那么要进行真正统计意义上的套利得需要什么样的条件呢，那么就引出了我们的协整关系。首先谈协整我们得先知道平稳这一个概念，一个平稳序列是指数据的期望不会随时间改变，数据的方差与协方差不会随时间而改变，并且固定一个时间，往前与往后进行回归都是相同的。</p><br><p>所以平稳的股票是有很多统计上的好性质，可以进行套利操作，当股价达到一定高度时就要卖出，当股价低于一定数值时就需要买入，也就是俗称的低买高卖。但是一般在现实生活中不存在平稳的股票，所以很难去预测他在什么地方是高点什么地方是低点，这也就解释了为什么这么多人都是买高卖低了。虽然一般不存在平稳的股票，但是几支股票的线性组合就可能是一个平稳序列，这就是我们一般意义上提到的协整关系，通过一些股票的组合来构造平稳的序列来进行套利。但是这个平稳性也是在一定时间段来说的，我们只能根据以往的数据来判断在这段时间内是协整的，但是无法断言在之后交易的时段也是协整的。</p><br><code lang="text">我们来只管看一下一个平稳的序列长什么样，最简单的一个噪声序列他就是一个平稳的序列。</code><img src="https://pic3.zhimg.com/v2-6b2ef06d361b8bd56b0e74e72ad2d004_r.png" data-rawwidth="655" data-rawheight="407"><img src="https://pic4.zhimg.com/v2-7e1eaf7aacb9eeae7c9801b7c3d28218_r.png" data-rawwidth="664" data-rawheight="345"><br><br><br><p>但是我们怎么在统计学意义上去检验它呢？这里有一个利用 statsmodels.tsa.stattools的方便的测试。我们应该非常低的P值，因为我们创建了两个在实际尽可能存在协整性的序列。</p><p>我们把金融业的一部分股票的p值画出来找找：（201401-201512）</p><img src="https://pic4.zhimg.com/v2-a475e8bf798616268e4b2f4c9ff88cc6_r.png" data-rawwidth="550" data-rawheight="410"><br><br><p>我们发现工商银行和建设银行的配对p值较小，画一下1401-1512的股价：<br></p><img src="https://pic3.zhimg.com/v2-e616f1245b4e1c0f6896d42ef6d0ac69_r.png" data-rawwidth="687" data-rawheight="335"><br><br><p>要利用这组股票对进行配对交易，就得看看他们之间的存在什么样的线性关系。这里我们通过股价进行最小残差平方和（OLS）方法来进行回归。</p><img src="https://pic1.zhimg.com/v2-8e625e8c6890480e85b4ab283eefc540_r.png" data-rawwidth="670" data-rawheight="567"><br><br><p>r-squred为0.978，说明我们拟合的参数解释了97.8%的样本数据，说明拟合结果比较好，AIC与BIC检验较小说明回归效果好，再来看看系数是否统计显著，const的系数的绝对值除标准误差std err明显大于自由度为465的t统计量，说明统计显著。至此，我们能认为我们回归得到的结果是比较好的了。</p><br><p>接下来我们看看线性组合的价差是否是在均值周围波动。</p><img src="https://pic1.zhimg.com/v2-c8eeac04eb4689584adf8d4c6ae63554_r.png" data-rawwidth="667" data-rawheight="300"><br><br><p>至此，我们完成了配对交易的准备步骤，找到了协整股票对之间的线性关系以及股价差满足的模型，我们以'601818.XSHG'的股价减去拟合的系数0.6319倍'601988.XSHG'的股价，线性组合价差服从均值为0.9328标准误差</p><p>为0.072的正态分布。根据这样的线性关系，我们构建这么一个简单的配对交易策略：组合价差超过均值+1倍标准误差即卖出601818，买入601988；低于均值1倍标准误差即买入601818，卖出601988.<br></p><br><p>我们来看一下1601以来的回测情况：</p><p>假设不能做空，只能做多其中一只股票：</p><img src="https://pic4.zhimg.com/v2-a2a863bc94c72a37c933431a1fa33856_r.png" data-rawwidth="801" data-rawheight="454"><br><p>这才是真正的银行股搬砖策略！</p><br><br><p>假设可以做空呢？</p><img src="https://pic1.zhimg.com/v2-c45a1f4964a906f9d1cbc9ceafe33baf_r.png" data-rawwidth="809" data-rawheight="453"><br><p>至此，配对交易就讲完啦！</p><br><p>欢迎来看代码或向我们提问：</p><p><a href="https://www.ricequant.com/community/topic/2039//2" data-editable="true" data-title="统计套利（一）利用相关系数进行配对交易" class="">统计套利（一）利用相关系数进行配对交易</a><br></p><p><a href="https://www.ricequant.com/community/topic/2053//2" data-editable="true" data-title="统计套利（二），利用协整关系进行配对交易">统计套利（二），利用协整关系进行配对交易</a><br></p><p><a href="https://www.ricequant.com/community/topic/2094" data-editable="true" data-title="统计套利 Review and Outlook">统计套利 Review and Outlook</a></p>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
