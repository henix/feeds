<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Barra模型初探，A股市场风格解析</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/69149910">原文</a></p>
<p></p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-ac46bb94b289bc57bcd71adf857a5564_b.gif" data-caption="" data-size="normal" data-rawwidth="600" data-rawheight="133" data-thumbnail="https://pic1.zhimg.com/v2-ac46bb94b289bc57bcd71adf857a5564_b.jpg" class="origin_image zh-lightbox-thumb" width="600" data-original="https://pic1.zhimg.com/v2-ac46bb94b289bc57bcd71adf857a5564_r.jpg"/></noscript><img src="https://pic1.zhimg.com/v2-ac46bb94b289bc57bcd71adf857a5564_b.gif" data-caption="" data-size="normal" data-rawwidth="600" data-rawheight="133" data-thumbnail="https://pic1.zhimg.com/v2-ac46bb94b289bc57bcd71adf857a5564_b.jpg" class="origin_image zh-lightbox-thumb lazy" width="600" data-original="https://pic1.zhimg.com/v2-ac46bb94b289bc57bcd71adf857a5564_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-ac46bb94b289bc57bcd71adf857a5564_b.gif"/></figure><p class="ztext-empty-paragraph"><br/></p><p><b>&gt;&gt;&gt;  引言</b></p><p>本篇内容是参考方正金工研究报告“星火” 多因子系列报告的第一篇《Barra模型初探，A股市场风格解析》，下面将对Barra模型的基本原理进行介绍，对模型的细节部分进行说明，试图构建多因子收益归因模型，并利用风险收益模型对A股市场的风格进行解析，探讨 Barra 模型在 A 股市场上的用武之地。</p><p class="ztext-empty-paragraph"><br/></p><p><b>&gt;&gt;&gt;  多因子模型介绍</b></p><p>多因子模型的基础理论认为：股票的收益是由一些共同的因子来驱动的，不能被这些因子解释的部分被称为股票的“特质收益率”， 而每只股票的特质收益率之间是互不相关的。我们先来看一下共同的部分，这些共同的因子，和股票收益的关系，可以参考下面的内容。</p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-7b5dc27f9a269e8a1b4bd237a3d5de6a_b.jpg" data-caption="" data-size="normal" data-rawwidth="541" data-rawheight="490" class="origin_image zh-lightbox-thumb" width="541" data-original="https://pic3.zhimg.com/v2-7b5dc27f9a269e8a1b4bd237a3d5de6a_r.jpg"/></noscript><img src="https://pic3.zhimg.com/v2-7b5dc27f9a269e8a1b4bd237a3d5de6a_b.jpg" data-caption="" data-size="normal" data-rawwidth="541" data-rawheight="490" class="origin_image zh-lightbox-thumb lazy" width="541" data-original="https://pic3.zhimg.com/v2-7b5dc27f9a269e8a1b4bd237a3d5de6a_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-7b5dc27f9a269e8a1b4bd237a3d5de6a_b.jpg"/></figure><p class="ztext-empty-paragraph"><br/></p><p><b>&gt;&gt;&gt;  结构化因子风险模型的作用</b></p><p>风险因子也称为Beta因子，和 Alpha 因子不同， 风险因子的风险溢价在时间序列上的均值绝对值可以很小，用这个因子来做选股长期可能没有明显超额收益，但在月度横截面上风险因子可以影响显著影响股票收益，方向可正可负，因此因子收益率波动较大。控制组合对风险因子的风险暴露，可以提升组合收益的稳定性。同时，通过因子暴露和因子收益率的计算，分析投资组合历史和当前的风险暴露，可以进行收益分析。</p><p><br/>在组合优化方面，传统样本协方差矩阵估计方法在股票数量较多时，矩阵可能不满秩或者矩阵条件数太大，无法直接用于组合优化过程。结构化因子风险模型通过降维的方式减小了股票收益率协方差矩阵的估计误差，降低了协方差相关计算的复杂度，便于风险预测，下面看下计算处理时的一些细节。</p><p class="ztext-empty-paragraph"><br/></p><p><b>&gt;&gt;&gt;  因子标准化</b></p><p>由于不同因子在数量级上存在差别， 在实际回归中需要对单个因子在横截面上进行标准化， 从而得到均值为 0、标准差为 1 的标准化因子，这里需要特别注意一下的是，为保证全市场基准指数对每个风格因子的暴露程度均为 0，我们需要对每个因子减去其市值加权均值，再除以其标准差，计算方法如下：</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-b883afc724eb302be3277ec73799fcf0_b.jpg" data-caption="" data-size="normal" data-rawwidth="220" data-rawheight="112" class="content_image" width="220"/></noscript><img src="https://pic1.zhimg.com/v2-b883afc724eb302be3277ec73799fcf0_b.jpg" data-caption="" data-size="normal" data-rawwidth="220" data-rawheight="112" class="content_image lazy" width="220" data-actualsrc="https://pic1.zhimg.com/v2-b883afc724eb302be3277ec73799fcf0_b.jpg"/></figure><p>考虑一个由市值加权构成的投资组合， 可以通过如下验证看出，该投资组合对于任意因子的暴露度均为0。<br/></p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-d0272c02ca42bd5da53fa737aa9fbb99_b.jpg" data-caption="" data-size="normal" data-rawwidth="532" data-rawheight="123" class="origin_image zh-lightbox-thumb" width="532" data-original="https://pic2.zhimg.com/v2-d0272c02ca42bd5da53fa737aa9fbb99_r.jpg"/></noscript><img src="https://pic2.zhimg.com/v2-d0272c02ca42bd5da53fa737aa9fbb99_b.jpg" data-caption="" data-size="normal" data-rawwidth="532" data-rawheight="123" class="origin_image zh-lightbox-thumb lazy" width="532" data-original="https://pic2.zhimg.com/v2-d0272c02ca42bd5da53fa737aa9fbb99_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-d0272c02ca42bd5da53fa737aa9fbb99_b.jpg"/></figure><p class="ztext-empty-paragraph"><br/></p><p><b>&gt;&gt;&gt;  加权最小二乘回归</b></p><p>前面提到，在 Barra 模型中我们假设每只股票的特质收益率互不相关，但是每只股票的特质收益率列的方差并不相同，这就导致了回归模型出现异方差性。为解决这一问题，可以采用加权最小二乘WLS 方法进行回归，对不同的股票赋予不同的权重。</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-2939ed789ec65f4ad5e4fb81797b1b44_b.jpg" data-caption="" data-size="normal" data-rawwidth="199" data-rawheight="48" class="content_image" width="199"/></noscript><img src="https://pic1.zhimg.com/v2-2939ed789ec65f4ad5e4fb81797b1b44_b.jpg" data-caption="" data-size="normal" data-rawwidth="199" data-rawheight="48" class="content_image lazy" width="199" data-actualsrc="https://pic1.zhimg.com/v2-2939ed789ec65f4ad5e4fb81797b1b44_b.jpg"/></figure><p>股票特质收益率方差通常与股票的市值规模成反比，即大市值股票的特质收益率方差通常较小，因此在这里的回归公式中，我们将以市值的平方根占比作为每只股票的回归权重，将其带入公式进行计算，然而在我们实际计算的过程中，由于奇异矩阵的出现，并不能顺利求出收益率f，于是我们采用下面介绍的方法进行处理。<br/></p><p><b>&gt;&gt;&gt;  风险收益模型求解</b></p><p>这里先来看下在USE4版本的barra模型下，收益表达式</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-e4621db72a55eae0ebed30c9ce76614c_b.jpg" data-caption="" data-size="normal" data-rawwidth="409" data-rawheight="75" class="content_image" width="409"/></noscript><img src="https://pic1.zhimg.com/v2-e4621db72a55eae0ebed30c9ce76614c_b.jpg" data-caption="" data-size="normal" data-rawwidth="409" data-rawheight="75" class="content_image lazy" width="409" data-actualsrc="https://pic1.zhimg.com/v2-e4621db72a55eae0ebed30c9ce76614c_b.jpg"/></figure><p>截距项因子的加入导致自变量因子之间存在多重共线性， 因此因子的拟合无法直接通过解析解求得，模型的求解转变成一个带约束条件的加权最小二乘法求解：</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-7ccb45fec90a64c0f88ae2995ce8baa9_b.jpg" data-caption="" data-size="normal" data-rawwidth="491" data-rawheight="159" class="origin_image zh-lightbox-thumb" width="491" data-original="https://pic2.zhimg.com/v2-7ccb45fec90a64c0f88ae2995ce8baa9_r.jpg"/></noscript><img src="https://pic2.zhimg.com/v2-7ccb45fec90a64c0f88ae2995ce8baa9_b.jpg" data-caption="" data-size="normal" data-rawwidth="491" data-rawheight="159" class="origin_image zh-lightbox-thumb lazy" width="491" data-original="https://pic2.zhimg.com/v2-7ccb45fec90a64c0f88ae2995ce8baa9_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-7ccb45fec90a64c0f88ae2995ce8baa9_b.jpg"/></figure><p>注意， 此处 w_n 是指单只股票 n 的市值权重，而 w_i 表示的是行业 i 内所有股票的市值占全体样本股票市值的比例。</p><p class="ztext-empty-paragraph"><br/></p><p><b>&gt;&gt;&gt;  市场风格因子</b></p><p>基于研报中对 Barra 模型框架构建及求解过程的介绍，我们参考并构建多因子风险收益模型，并求得每期的因子收益，观察市场风格的变化及投资组合的风险收益来源。这里我们选取的风格因子可以通过聚宽因子库中，<a href="https://link.zhihu.com/?target=http%3A//mp.weixin.qq.com/s%3F__biz%3DMzI2ODAzNzQ0Mw%3D%3D%26mid%3D2650726837%26idx%3D1%26sn%3D5bf665c7e32638fbeb9eb77beaa6ad3f%26chksm%3Df2fffd99c588748f9a956ace6c93ef53658a3481cb81893e718b030baabe3779673035f0e0a7%26scene%3D21%23wechat_redirect" class=" wrap external" target="_blank" rel="nofollow noreferrer">风格因子</a> 获取，具体字段及说明如下：</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-467ac4f3789a755e25846eef4497f9e1_b.jpg" data-caption="" data-size="normal" data-rawwidth="803" data-rawheight="411" class="origin_image zh-lightbox-thumb" width="803" data-original="https://pic2.zhimg.com/v2-467ac4f3789a755e25846eef4497f9e1_r.jpg"/></noscript><img src="https://pic2.zhimg.com/v2-467ac4f3789a755e25846eef4497f9e1_b.jpg" data-caption="" data-size="normal" data-rawwidth="803" data-rawheight="411" class="origin_image zh-lightbox-thumb lazy" width="803" data-original="https://pic2.zhimg.com/v2-467ac4f3789a755e25846eef4497f9e1_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-467ac4f3789a755e25846eef4497f9e1_b.jpg"/></figure><p>此处我们参考给出的 规模因子、Beta 因子、动量因子、波动率因子、非线性规模因子、估值因子、流动性因子、盈利能力因子、成长因子和杠杆因子作为模型的解释变量，进行下面的研究。</p><p>选 定  2016.6.1-2019.6.3  为 样 本 考 察 期 间 ， 以 中 证 500指数（000905.XSHG） 成分股为考察样本，对市场风格因子的表现进行实证研究，在实际计算中还需对数据进行如下处理：</p><p>1） 剔除上市时间小于63天的股票；<br/>2） 剔除标记为ST、*ST的股票；<br/>3） 剔除任意因子为 NaN 的股票；</p><p><br/>参考研报中为检查回归模型中自变量之间多重共线性的情况，而引入相关强度指标RSI，对各风格因子之间的相关程度进行检查，该指标的构造方法如下：</p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-6e9046a3fe513c76c98db500a640ecea_b.jpg" data-caption="" data-size="normal" data-rawwidth="353" data-rawheight="56" class="content_image" width="353"/></noscript><img src="https://pic3.zhimg.com/v2-6e9046a3fe513c76c98db500a640ecea_b.jpg" data-caption="" data-size="normal" data-rawwidth="353" data-rawheight="56" class="content_image lazy" width="353" data-actualsrc="https://pic3.zhimg.com/v2-6e9046a3fe513c76c98db500a640ecea_b.jpg"/></figure><p>其中，Corr_t 是指在截面 t 期，所有股票的 A、 B 因子之间的相关系数。RSI_AB 指标类似于绩效评价中的信息比率 IC_IR，综合考虑了因子的平均相关系数以及相关系数的稳定性大小，下图是展示了研究样本数据 2016年到2019年期间各风格因子之间的相关强度，可以看到，市值因子与杠杆因子之间、残差波动率因子与流动性因子之间存在较强的正相关关系；而市值因子与非线性市值因子之间、杠杆因子与非线性市值之间存在较强的负相关关系。<br/></p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-641953ff7118d51fcb7b182d3560817b_b.jpg" data-caption="" data-size="normal" data-rawwidth="787" data-rawheight="319" class="origin_image zh-lightbox-thumb" width="787" data-original="https://pic4.zhimg.com/v2-641953ff7118d51fcb7b182d3560817b_r.jpg"/></noscript><img src="https://pic4.zhimg.com/v2-641953ff7118d51fcb7b182d3560817b_b.jpg" data-caption="" data-size="normal" data-rawwidth="787" data-rawheight="319" class="origin_image zh-lightbox-thumb lazy" width="787" data-original="https://pic4.zhimg.com/v2-641953ff7118d51fcb7b182d3560817b_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-641953ff7118d51fcb7b182d3560817b_b.jpg"/></figure><p>接下来对行业风格进行观察，A股市场行业特征明显，行业轮动效应显著，Barra USE4 模型中截距项的引入， 可以将市场收益从行业收益中剥离出来， 从而得到纯净的行业因子收益。 然而在实际情况中， 每个行业在不同风险因子上都长期存在特定的暴露，因此行业因子收益与该行业指数的走势未必能保持完全一致。下图展示了申万一级行业在统计期内的因子累计收益率，该数据由每期的行业因子收益率累计计算得到。</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-86246695d23c3b76c1c2ddc3796fce29_b.jpg" data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="456" class="origin_image zh-lightbox-thumb" width="1080" data-original="https://pic2.zhimg.com/v2-86246695d23c3b76c1c2ddc3796fce29_r.jpg"/></noscript><img src="https://pic2.zhimg.com/v2-86246695d23c3b76c1c2ddc3796fce29_b.jpg" data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="456" class="origin_image zh-lightbox-thumb lazy" width="1080" data-original="https://pic2.zhimg.com/v2-86246695d23c3b76c1c2ddc3796fce29_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-86246695d23c3b76c1c2ddc3796fce29_b.jpg"/></figure><p>我们看一下各类风格因子在统计期内的表现情况，下图展示了各类纯净风格因子的净值走势和累计收益。</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-e9205c9a19972d6fe165682114f53445_b.jpg" data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="425" class="origin_image zh-lightbox-thumb" width="1080" data-original="https://pic2.zhimg.com/v2-e9205c9a19972d6fe165682114f53445_r.jpg"/></noscript><img src="https://pic2.zhimg.com/v2-e9205c9a19972d6fe165682114f53445_b.jpg" data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="425" class="origin_image zh-lightbox-thumb lazy" width="1080" data-original="https://pic2.zhimg.com/v2-e9205c9a19972d6fe165682114f53445_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-e9205c9a19972d6fe165682114f53445_b.jpg"/></figure><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-4e72d8ec441e36bb5ac0123954d905e1_b.jpg" data-caption="" data-size="normal" data-rawwidth="997" data-rawheight="463" class="origin_image zh-lightbox-thumb" width="997" data-original="https://pic2.zhimg.com/v2-4e72d8ec441e36bb5ac0123954d905e1_r.jpg"/></noscript><img src="https://pic2.zhimg.com/v2-4e72d8ec441e36bb5ac0123954d905e1_b.jpg" data-caption="" data-size="normal" data-rawwidth="997" data-rawheight="463" class="origin_image zh-lightbox-thumb lazy" width="997" data-original="https://pic2.zhimg.com/v2-4e72d8ec441e36bb5ac0123954d905e1_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-4e72d8ec441e36bb5ac0123954d905e1_b.jpg"/></figure><p>尽管各类风格因子对于收益的影响有正向和反向之分，但投资者总可以选择性地在某些风格因子上进行或多或少的暴露，因此累计收益绝对值异于0的因子（无论是正向收益还是反向收益）都是有效因子。可以看到，在整个统计期内，影响方向为正的因子如Beta因子、动量因子和盈利能力因子、动量因子表现最优；影响方向为负的因子如流动性因子和规模因子。</p><p class="ztext-empty-paragraph"><br/></p><p><b>&gt;&gt;&gt;  组合收益归因模型</b></p><p>在对barra风险模型有了一定了解之后，可以基于模型原理进行投资组合收益归因分析。首先回归得到各纯净因子的日度收益，再根据股票在因子上的暴露即可求得该股票的日度收益，根据股票在投资组合中的市值占比，即可求得该投资组合收益。也就是说，给定任意的投资组合，即可通过多因子收益归因模型，求得该投资组合的日度收益，并观察该投资组合在各项因子上的暴露程度。组合收益计算公式如下，其中X为组合整体的因子暴露。</p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-72376364c1c091abdf7e9602cc086aeb_b.jpg" data-caption="" data-size="normal" data-rawwidth="268" data-rawheight="78" class="content_image" width="268"/></noscript><img src="https://pic4.zhimg.com/v2-72376364c1c091abdf7e9602cc086aeb_b.jpg" data-caption="" data-size="normal" data-rawwidth="268" data-rawheight="78" class="content_image lazy" width="268" data-actualsrc="https://pic4.zhimg.com/v2-72376364c1c091abdf7e9602cc086aeb_b.jpg"/></figure><p>下面我们模拟一个组合进行检验，研报中直接使用了上证50成分股进行验证，考虑到我们计算的因子收益率是基于中证500，与大盘金融股主导的上证50成分股差异较为明显，所以这里是假设投资者持有了一个中证500股票池中50只股票的投资组合（50只股票是按股票代码排序，间隔10只取1只），本示例中，与前面的因子收益率一致，因子收益月度统计，我们取了连续20个月的数据，通过多因子模型计算得到的该投资组合的收益情况如图所示，在散点图上是一条斜向右上方的直线，二者相关性为65%，与研报结果相比，多因子模型的有效性和正确性还有提升空间。</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-930878bc7f615861022a3e2bed0b1fb0_b.jpg" data-caption="" data-size="normal" data-rawwidth="751" data-rawheight="496" class="origin_image zh-lightbox-thumb" width="751" data-original="https://pic1.zhimg.com/v2-930878bc7f615861022a3e2bed0b1fb0_r.jpg"/></noscript><img src="https://pic1.zhimg.com/v2-930878bc7f615861022a3e2bed0b1fb0_b.jpg" data-caption="" data-size="normal" data-rawwidth="751" data-rawheight="496" class="origin_image zh-lightbox-thumb lazy" width="751" data-original="https://pic1.zhimg.com/v2-930878bc7f615861022a3e2bed0b1fb0_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-930878bc7f615861022a3e2bed0b1fb0_b.jpg"/></figure><p>下图绘制了本示例投资组合在每个因子上的暴露度均值，因子暴露程度百分位图，是指该投资组合中的股票在每个因子上的暴露相对于指数所有成分股票的百分位数，中性组合为 50%的暴露度。</p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-e151d2952fbe5beaea847eb9ba611377_b.jpg" data-caption="" data-size="normal" data-rawwidth="727" data-rawheight="357" class="origin_image zh-lightbox-thumb" width="727" data-original="https://pic4.zhimg.com/v2-e151d2952fbe5beaea847eb9ba611377_r.jpg"/></noscript><img src="https://pic4.zhimg.com/v2-e151d2952fbe5beaea847eb9ba611377_b.jpg" data-caption="" data-size="normal" data-rawwidth="727" data-rawheight="357" class="origin_image zh-lightbox-thumb lazy" width="727" data-original="https://pic4.zhimg.com/v2-e151d2952fbe5beaea847eb9ba611377_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-e151d2952fbe5beaea847eb9ba611377_b.jpg"/></figure><p>因为本示例组合是在中证500中选取的50只股票组合，在各个风格暴露接近于50%，与市场中性的结果一致，需要注意的是，这里的测试验证时间范围是在因子收益率统计时间段内，属于样本内的结果，做法不够严谨，注意股票池与时间选择上进行区分。<br/></p><p><b>&gt;&gt;&gt;  最后</b></p><p>本内容是参考方正金工“星火” 多因子系列研究报告的第一篇， 主要对Barra 模型基本框架进行介绍、对模型搭建求解细节进行说明， 并将其运用到 A股市场上进行收益分析， 探索市场风格变化。 这里需要注意的是，研究中用带约束条件的加权最小二乘法对 Barra 模型进行求解。在中证500示例中，2016-2019 年期间规模， 动量、流动性和盈利因子表现较为突出，在组合收益归因模型部分，根据本示例构建的模型，可以对任意给定的投资组合收益进行分解，进而得到投资组合在各大风格因子上的暴露，一方面，通过分析投资组合在每个风格因子上的暴露程度，对投资组合收益的来源提供一定的解释，另一位方面，根据风险因子暴露也可以进行相应的风险控制。</p><p>点击<a href="https://link.zhihu.com/?target=https%3A//www.joinquant.com/view/community/detail/20580" class=" wrap external" target="_blank" rel="nofollow noreferrer">【阅读全文】</a>，查看研究原码。</p>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
