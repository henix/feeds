<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>关于位操作的几个小智力题</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/29758972">原文</a></p>
<div class="title-image"><img src="https://pic4.zhimg.com/v2-ff8fa0881fc65b9980a7bd9e83c2af1f_r.jpg" alt=""></div><p>看！大灰机！Σ( ° △ °|||)︴</p><p>wow~ (´⊙o⊙)ﾉ 看！小灰象！！！</p><p>是的，昨天，在<b>平和友好</b>的气氛中，矮矮胖胖憨态可掬的小飞象同学向我<b>陆陆续续</b>地描述了一个问题。</p><p>今天早上我终于想明白了问题应该是什么样的。</p><p><br></p><p>假设 <equation>f(n)=AND(n,n-1)</equation> ，其中 <equation>AND(a,b)</equation> 表示 <equation>a</equation> 和 <equation>b</equation> 的二进制表示的<b>逐位</b>与。</p><p>给定正整数 <equation>n</equation> 求使得 <equation>f^m(n)=0</equation> 的最小正整数 <equation>m</equation> 。</p><p><br></p><p>例如 <equation>f(9999)=9998</equation> , <equation>f(9998)=9996</equation> ， <equation>f(9996)=9992</equation> ， <equation>f(9992)=9984</equation> ， <equation>f(9984)=9728</equation> ， <equation>f(9728)=9216</equation> ， <equation>f(9216)=8192</equation> ， <equation>f(8192)=0</equation> ，此时<equation>m=8</equation>。</p><p><br></p><p>分析 <equation>n</equation> 和 <equation>n-1</equation> 的二进制表示就发现差别从 <equation>n</equation> 的二进制表示的最右一个“ <equation>1</equation> ”开始，将“ <equation>10...0</equation> ”变为“ <equation>01...1</equation> ”。</p><p>于是 <equation>n</equation> 和 <equation>n-1</equation> 的逐位与的实际效果就是“将 <equation>n</equation> 的<b>二进制表示的最右一个“1”变为“0”</b>！</p><img src="https://pic3.zhimg.com/v2-4a88bf6e5bb98f4f6edf117735df7e71_r.jpg" data-caption="" data-rawwidth="613" data-rawheight="280"><p>所以 <equation>m</equation> 就等于 <equation>n</equation> 的<b>二进制表示中的“1”的个数</b>。</p><img src="https://pic4.zhimg.com/v2-9fc554b0777f22cac7f60d7246fc672c_r.jpg" data-caption="" data-rawwidth="613" data-rawheight="319"><p>于是这个方法可以用来判断“<b>正整数 <equation>n</equation> 是否是 2 的幂?</b>”，只要判断 <equation>f(n)</equation> 是否为0即可。</p><hr><p>于是就联想起来看到过的一些和“位”有关的小题目：</p><p><b>❶</b> 在一个0-1串 <equation>n</equation> 中（图中假设 <equation>n</equation> 是1个字节，8个比特)，希望知道右数第 <equation>i</equation> 个比特是1还是0（从右往左数时从0开始计数）（图中假设 <equation>i=4</equation> ）。</p><p>解答：</p><code lang="c">AND(n,1&lt;&lt;i)</code><p>说明：</p><img src="https://pic3.zhimg.com/v2-3f3bda2559c8e25c0252b98ad646bdb6_r.jpg" data-caption="" data-rawwidth="885" data-rawheight="546"><p>❷在一个0-1串 <equation>n</equation> 中，希望将右数第 <equation>i</equation> 个比特设置为1。</p><p>解答：</p><code lang="c">OR(n,1&lt;&lt;i)</code><p>说明：</p><img src="https://pic3.zhimg.com/v2-e67481edfb78ccab8e11154f6a10a61e_r.jpg" data-caption="" data-rawwidth="840" data-rawheight="483"><p><b>❸ </b>在一个0-1串 <equation>n</equation> 中，希望将右数第 <equation>i</equation> 个比特设置为0。</p><p>解答：</p><code lang="c">AND(n,NOT(1&lt;&lt;i))</code><p>说明：</p><img src="https://pic4.zhimg.com/v2-05da027bef832556c947876b42a05745_r.jpg" data-caption="" data-rawwidth="847" data-rawheight="483"><p><br></p><p><b>❹ </b>给出两个0-1串 <equation>N</equation> 和 <equation>M</equation> ，以及两个二进制位的位置 <equation>i</equation> 和 <equation>j</equation> 。写一个方法来将 <equation>N</equation> 中的第 <equation>i</equation> 到 <equation>j</equation> 位替换为 <equation>M</equation> （假设 <equation>M</equation> 的长度恰好可以填入，结果是<equation>M</equation> 是 <equation>N</equation> 中从第 <equation>i</equation> 位开始到第 <equation>j</equation> 位的子串）。</p><p>解答：先把 <equation>N</equation> 中相应位置都设置为“0”，然后对 <equation>M</equation> 做向左移位，然后逐位或。</p><p><b>❺ </b>数组中，只有一个数出现一次，剩下都出现两次，找出这个出现一次的数。</p><p>解答：将所有数都做逐位异或。</p><p>说明： <equation>\oplus</equation> 表示异或运算（即模2加法）， <equation>0\oplus0=0</equation> ， <equation>0\oplus1=1</equation> ， <equation>1\oplus0=1</equation> ， <equation>1\oplus1=0</equation>。异或运算满足交换律、结合律，且具有一个重要性质 <equation>x\oplus x=0</equation> 。</p><p>此外，还有一些规律如 <equation>OR(a,b)+AND(a,b)=a+b</equation> ， <equation>OR(a,b)-AND(a,b)=a\oplus b</equation> ， <equation>AND(a, b)\oplus AND(a, c)=AND(a, (b\oplus c))</equation> ， <equation>a\oplus AND(a,b)=AND(a, a\oplus b)=AND(a,NOT(b))</equation>，等等。</p><blockquote>事实上，考虑元素数最少的有限域 <equation>\mathbb{F}_2</equation> ，就会发现 <equation>\mathbb{F}_2=(\{0,1\},\oplus,AND)</equation> ，也即“与”是其中的乘法，“异或”是其中的加法。<br>所以交换律、结合律、分配律都是自然的。</blockquote><p><b>❻ </b>数组中，只有两个数出现一次，剩下都出现两次，找出出现一次的数。</p><p>解答： 将所有数都做逐位异或。得到结果是这两个数的异或结果，其中必定有某一位是1。对于原来的数组，根据这个位置是1还是0进行分类。于是这两个数一定不在同一类，而且每一类都是“只有一个数出现一次，剩下都出现两次”。</p><p><b>❼ </b>给定两个0-1串 <equation>a</equation> 和 <equation>b</equation> ，计算需要改变 <equation>a</equation> 的多少位才能得到 <equation>b</equation> 。</p><p>解答：数一数 <equation>a\oplus b</equation> 中“1”的个数。</p><p><b>❽ </b>假设 <equation>a</equation>和 <equation>b</equation> 都是正整数，证明： <equation>a-b\leq a\oplus b</equation> 。</p><p>解答：注意到 <equation>a+b=2AND(a,b)+(a\oplus b)</equation> ，而后 <equation>a-b-a\oplus b=2(AND(a,b)-b)\leq 0</equation>。 </p><p>说明：类似地，可以证明 <equation>a-b+a\oplus b\geq0</equation> 。</p><p>（ <equation>a-b+a\oplus b=2(OR(a,b)-b)</equation> ）</p><p><b>❾</b> 将 <equation>a</equation> ， <equation>b</equation> 两个数的值进行交换，并且不使用任何的中间变量。</p><p>解答： <equation> a = a\oplus b</equation> ， <equation>b = a\oplus b</equation> ， <equation> a = a\oplus b</equation> 。</p><p>其中 <equation>\oplus</equation> 表示异或运算（即模2加法）， <equation>0\oplus0=0</equation> ， <equation>0\oplus1=1</equation> ， <equation>1\oplus0=1</equation> ， <equation>1\oplus1=0</equation>。</p><p>注：主要利用了 <equation>x\oplus x=0</equation> 。</p><p>❿ 最后一个问题：假设 <equation>g(n)=OR(n,n+1)</equation> ，给定正整数 <equation>n</equation> 求使得 <equation>g^m(n)+1</equation> 是2的幂的最小正整数 <equation>m</equation> 。</p><p>（解答留给读者吧）</p><hr><p>最后，还是补充几句吧，网上还有一些据说是笔试题/面试题——例如下面几个，然而我并不喜欢，就列着玩儿玩儿不分析了。</p><ul><li>数组中，只有一个数出现一次，剩下都出现三次，找出出现一次的数。</li><li>假设x和y都是整数，得到其中较小的那个。</li></ul><code lang="c">y^( (x^y)&amp; -(x&lt;y) ) </code><ul><li>将一个int型的数的奇偶位互换，例如6的2进制为0110， 第一位与第二位互换，第三位与第四位互换，得到1001，输出应该为9 。</li></ul><code lang="c">((n&lt;&lt;1)&amp;(0xAAAA))|((n&gt;&gt;1)&amp;(0x5555)) </code><ul><li>给出两个正整数a和b, 求他们的和, 但不能使用任何数学运算符。</li></ul>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
