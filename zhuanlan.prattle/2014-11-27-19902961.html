<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>介绍一本好书：『iOS应用逆向工程』</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/19902961">原文</a></p>
<div class="title-image"><img src="https://pic2.zhimg.com/e7fe6129d5fd5b8990e171dffedfcb93_r.jpg" alt=""></div><p>吴航（@hangcom2010）是我在Juniper的前同事，我做设备端，他做网管端，平时交流不多。后来我俩前后脚离开Juniper，我出去创业，他也开始了他的互联网生涯。后来机缘巧合，从iPad版的知乎月刊这个应用上，我竟然发现了他的大名，和他在微博中多有交流；之后，再见到他的名字出现，就是他和朋友合著的这本沉甸甸，内容翔实的『iOS应用逆向工程』。<br></p><br><p>这书我先是从朋友那里借来看了一阵，不过瘾，又自己买了一本，大致通读一边，感慨颇深。</p><br><h3>逆向工程（Reverse Engineering）</h3><br><p>每个程序员都该有一颗逆向工程的心。作为一个嵌入式系统出身的人，这本书的很多内容把我拉回到刚工作时那激情燃烧的年代。那时对嵌入式设备还懵懵懂懂的我就加入到了Reverse Engineering思科HSRP协议 [<a href="#_footnote_1" data-editable="true" data-title="1" class="">1</a>] 的大军中，从两台设备间的通讯过程中一点点还原协议的原貌。逆向工程需要的能力，就如这本书所表达的，主要是耐性 —— 坚持，再坚持多一点点，也许就能见到曙光。</p><br><p>可惜我这对事物本原好奇和探索的心态，在后来渐渐消失。用tcpdump做协议抓包是为了分析问题，而不是探索未知的领域；GDB查看寄存器状态，细抠各种CPU的aseembly是为了解决coredump，而非分析目标的实现细节。在使用了iPhone近三年来，我甚至都没有看看每天都有什么样的数据从我的指间流入流出，背后是什么样的协议在支撑它们。</p><br><p>对于一个iOS开发者，了解别人的app如何运作非常有助于提高自己的能力。通过逆向工程，你可以回答这些问题：</p><br><ul><li><p>要做聊天，xmpp是否是最佳选择，大厂都在用什么？</p></li><li><p>竞争对手提供了人脸识别功能，使用了什么库，怎么做到的？</p></li></ul><p>等等。</p><br><h3>重新认识iPhone开发</h3><br><p>坦白的说，我从未真正研习过iPhone开发，仅仅做过比hello world略高级一些的应用。所以读整本书的过程中有些iPhone应用开发的概念我会比较吃力。但是，通过这本书我重新认识到了iPhone开发中的种种安全隐患。一个开发者，如果尝试使用一下各种用于逆向工程的工具，以及了解逆向分析的过程，应该能够学到很多日常开发中可能被忽视的教训，比如说：</p><br><ul><li><p>我的sqlite数据库是否应该用sqlcipher加密？（其实不光sqlite，其它本地存储的数据，都该有效保护起来）</p></li><li><p>和服务器通讯的过程我是否应该用https保护？[<a href="#_footnote_2" data-editable="true" data-title="2" class="">2</a>]</p></li><li><p>我的核心代码哪些该放在服务器端以避免反编译，哪些该用c实现以提高反编译的难度？ [<a href="#_footnote_3" data-editable="true" data-title="3" class="">3</a>]</p></li></ul><p>说句题外话，由于没有做加密，以前途客圈的一些产品的数据库很容易被别人拿来使用。当一份数据库是你靠编辑投入大量的人力和时间辛辛苦苦完成，却因自己保护不到位而轻易被竞争对手使用，真是欲哭无泪啊。所以iOS工程师，可以多从逆向工程的角度，审视自己app潜在的风险。</p><br><h3>小结</h3><br><p>就写这么多，书中很多的例子还需要我自己一点点尝试。不过读这本书还是有一些前提的：一颗「钻研」的心加上对iOS应用开发有一定程度的掌握（起码能自己写个简单的app）。此外，越狱的设备请选择低版本的iOS，并且最好是自己淘汰下来不用的设备，否则哪天把自己的天天用的手机搞崩了，恰巧手机里有不得不用，且只能在该手机使用的应用（比如说RSA token），就真的欲哭无泪了。</p><br><p>如果你在这个领域还读过其它不错的书，也欢迎与我分享。谢谢！</p><br><p>如果您觉得这篇文章不错，请点赞。多谢！</p><br><p>欢迎订阅公众号『程序人生』（搜索微信号 programmer_life）。每篇文章都力求原汁原味，早8点与您相会。</p><br><a href="#_footnoteref_1" data-editable="true" data-title="1" class="">1</a>. Cisco的私有协议，Hot Standby Router Protocol<br><a href="#_footnoteref_2" data-editable="true" data-title="2" class="">2</a>. 这样起码tcpdump无法抓取；当然，如果对方采用断点跟踪，撰写tweak，在消息过了SSL层，进入到处理之前将其log下来，还是会被侦听到<br><a href="#_footnoteref_3" data-editable="true" data-title="3" class="">3</a>. object C支持反射，很多工具可以将编译后的目标还原地非常接近源代码
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
