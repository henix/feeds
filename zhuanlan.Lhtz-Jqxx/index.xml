<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:media="http://search.yahoo.com/mrss/">
<channel>
<title>【量化投资与机器学习】微信公众号</title>
<link>https://henix.github.io/feeds/zhuanlan.Lhtz-Jqxx/</link>
<description>在量化投资的道路上，你不是一个人在战斗！ 主要介绍关于量化投资和机器学习的知识和应用。通过研报，论坛，博客，程序等途径全面的为大家带来知识食粮。版块语言分为：Python、Matlab、R，涉及领域有：量化投资、机器学习、深度学习、综合应用、干货分享等。</description>
<language>zh-cn</language>
<lastBuildDate>Fri, 24 Apr 2020 01:21:45 +0800</lastBuildDate>
<item>
<title>Python王牌加速库：奇异期权定价利器</title>
<link>https://henix.github.io/feeds/zhuanlan.Lhtz-Jqxx/2020-04-22-134445362.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/134445362&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-5cbfbac9c287b538a189c5316d4586b3_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;作者：Yi Dong    编译：1+1=6&lt;/p&gt;&lt;h2&gt;​1、&lt;b&gt;前言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;在金融领域，计算效率有时可以直接转化为交易利润。&lt;b&gt;量化分析师面临着在研究效率和计算效率之间进行权衡的挑战&lt;/b&gt;。使用Python可以生成简洁的研究代码，从而提高了研究效率。但是，一般的Python代码速度很慢，不适合用于生产环境。在这篇文章中，我们将探索如何使用&lt;b&gt;Python的GPU库来高性能实现奇异期权定价领域遇到的问题&lt;/b&gt;。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;2、定价计算概述&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;Black-Scholes模型可以有效地用欧洲行权规则为plain vanilla定价。像障碍（Barrier）期权和篮子（Basket ）期权这样的期权具有复杂的结构。蒙特卡罗模拟是一种有效的定价方法。为了得到一个精确的价格和一个小的变动，你需要许多模拟路径，计算十分密集。&lt;/p&gt;&lt;p&gt;幸运的是，每个模拟路径都是独立的，&lt;b&gt;大家可以利用多核NVIDIA GPU在一个节点内加速计算，甚至在必要时将其扩展到多个服务器&lt;/b&gt;。由于独立路径的并行化，使用GPU可以将计算速度提高几个数量级。&lt;/p&gt;&lt;p&gt;传统上，对GPU的蒙特卡罗仿真是在CUDA C/ C++代码中实现的。大家必须明确地管理内存并编写大量样板代码，这对代码维护和生产效率提出了挑战。&lt;/p&gt;&lt;p&gt;最近，Deep Learning Derivatives（Ryan et al，2018）的论文被引入到使用深度神经网络来近似期权定价模型。该方法利用计算时间与推理时间进行定价训练，与GPU上的蒙特卡罗模拟相比，它实现了额外的数量级加速，这使得在生产环境中的实时奇异期权定价成为一个现实目标。&lt;/p&gt;&lt;p&gt;在这篇文章中介绍的方法对奇异期权类型没有任何限制。它适用于任何可以用蒙特卡罗方法模拟的期权定价模型。&lt;/p&gt;&lt;p&gt;在不失一般性的情况下，大家可以使用&lt;b&gt;亚式障碍期权&lt;/b&gt;作为一个示例。亚式障碍期权是亚式期权和障碍期权的混合。衍生品价格取决于标的资产价格S、执行价格K和障碍价格B的平均值。以上下看涨期权离散化亚洲障碍期权为例。&lt;/p&gt;&lt;ul&gt;&lt;li&gt;如果标的资产的平均价格低于这一水平，则该期权无效。&lt;/li&gt;&lt;li&gt;资产现货价格S通常在建模中被认为是属于几何布朗运动，它有三个参数：现货价格、波动率和漂移率。&lt;/li&gt;&lt;li&gt;期权的价格是到期时的预期利润相对于当前价值的折现。&lt;/li&gt;&lt;li&gt;期权的路径依赖性使得对期权价格的解析解成为不可能。&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;这是使用蒙特卡罗模拟定价的一个很好的示例。你需要一个至少16GB的GPU来复现这个结果。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;3、第1部分：使用GPU Python库进行蒙特卡洛定价&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;NVIDIA GPU被设计用来使用大量线程进行并行计算。蒙特卡罗仿真是在GPU中可以很好加速的算法之一。在下面的小节中，大家将看到在传统的CUDA代码中使用蒙特卡罗模拟，然后在Python中使用不同的库实现相同的算法。&lt;/p&gt;&lt;p&gt;&lt;b&gt;CUDA方法&lt;/b&gt;&lt;/p&gt;&lt;p&gt;传统上，蒙特卡罗期权定价是在CUDA C/ C++中实现的。下面的CUDA C/ C++代码示例使用蒙特卡罗方法计算期权价格：&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-c&quot;&gt;&lt;span class=&quot;cp&quot;&gt;#include&lt;/span&gt; &lt;span class=&quot;cpf&quot;&gt;&amp;lt;vector&amp;gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;#include&lt;/span&gt; &lt;span class=&quot;cpf&quot;&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;#include&lt;/span&gt; &lt;span class=&quot;cpf&quot;&gt;&amp;lt;iostream&amp;gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;#include&lt;/span&gt; &lt;span class=&quot;cpf&quot;&gt;&amp;lt;chrono&amp;gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;#include&lt;/span&gt; &lt;span class=&quot;cpf&quot;&gt;&amp;lt;cuda_runtime.h&amp;gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;#include&lt;/span&gt; &lt;span class=&quot;cpf&quot;&gt;&amp;lt;helper_cuda.h&amp;gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;#include&lt;/span&gt; &lt;span class=&quot;cpf&quot;&gt;&amp;lt;curand.h&amp;gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;#define CHECKCURAND(expression)                         \
&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;                                                     \
    &lt;span class=&quot;n&quot;&gt;curandStatus_t&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;status&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;expression&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;                         \
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;status&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CURAND_STATUS_SUCCESS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;                        \
      &lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cerr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#34;Curand Error on line &amp;#34;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__LINE__&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;endl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;     \
      &lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;EXIT_FAILURE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;                                          \
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;                                                                   \
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// atomicAdd is introduced for compute capability &amp;gt;=6.0
&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;#if !defined(__CUDA_ARCH__) || __CUDA_ARCH__ &amp;gt;= 600
&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;#else
&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__device__&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;atomicAdd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;address&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;val&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;device arch &amp;lt;=600&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;address_as_ull&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;address&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
          &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;old&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;address_as_ull&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;assumed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;assumed&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;old&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
                        &lt;span class=&quot;n&quot;&gt;old&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;atomicCAS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;address_as_ull&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;assumed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                                    &lt;span class=&quot;n&quot;&gt;__double_as_longlong&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__longlong_as_double&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;assumed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)));&lt;/span&gt;
                          &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;assumed&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;old&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
              &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;__longlong_as_double&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;old&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;#endif
&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;__global__&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sumPayoffKernel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N_PATHS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mysum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;threadIdx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;blockIdx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;blockDim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stride&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;blockDim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gridDim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tid&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;threadIdx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;extern&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__shared__&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;smdata&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[];&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;smdata&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_PATHS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stride&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;smdata&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d_s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blockDim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;__syncthreads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tid&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;smdata&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;smdata&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tid&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tid&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;atomicAdd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mysum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;smdata&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;__global__&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;barrier_option&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;B&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;S0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sigma&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d_normals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N_STEPS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N_PATHS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;threadIdx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;blockIdx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;blockDim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stride&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;blockDim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gridDim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tmp1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mu&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_STEPS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tmp2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tmp3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_STEPS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;running_average&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_PATHS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stride&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_curr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;S0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N_STEPS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
       &lt;span class=&quot;n&quot;&gt;s_curr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tmp1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_curr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sigma&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_curr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tmp3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_normals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N_PATHS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
       &lt;span class=&quot;n&quot;&gt;running_average&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_curr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;running_average&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
       &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;running_average&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;B&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
           &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
       &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;payoff&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;running_average&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;K&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;running_average&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;K&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;d_s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tmp2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;payoff&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// declare variables and constants
&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;size_t&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N_PATHS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8192000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;size_t&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N_STEPS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;365&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;N_PATHS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;atoi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;N_STEPS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;atoi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.0f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;K&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;110.0f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;B&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;100.0f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;S0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;120.0f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sigma&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.35f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mu&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.1f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.05f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;


    &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gpu_sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;

    &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;devID&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;cudaDeviceProp&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;deviceProps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;checkCudaErrors&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cudaGetDeviceProperties&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;deviceProps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;devID&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;CUDA device [%s]&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;deviceProps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
     &lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;GPU Device %d: &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&amp;#34;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;%s&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&amp;#34;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; with compute capability %d.%d&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;devID&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;deviceProps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;deviceProps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;major&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;deviceProps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;minor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// Generate random numbers on the device
&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;curandGenerator_t&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;curandGenerator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;CHECKCURAND&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;curandCreateGenerator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;curandGenerator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CURAND_RNG_PSEUDO_MTGP32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;CHECKCURAND&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;curandSetPseudoRandomGeneratorSeed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;curandGenerator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1234ULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;size_t&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N_NORMALS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_STEPS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N_PATHS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_normals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;checkCudaErrors&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cudaMalloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_normals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N_NORMALS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;sizeof&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)));&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;CHECKCURAND&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;curandGenerateNormal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;curandGenerator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d_normals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N_NORMALS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.0f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.0f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;cudaDeviceSynchronize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;

      &lt;span class=&quot;c1&quot;&gt;// before kernel launch, check the max potential blockSize
&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;&lt;/span&gt;      &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BLOCK_SIZE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;GRID_SIZE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;checkCudaErrors&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cudaOccupancyMaxPotentialBlockSize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;GRID_SIZE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                                         &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BLOCK_SIZE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                                         &lt;span class=&quot;n&quot;&gt;barrier_option&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                                         &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N_PATHS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;

      &lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cout&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#34;suggested block size &amp;#34;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BLOCK_SIZE&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#34; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;suggested grid size &amp;#34;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;GRID_SIZE&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;endl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

      &lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cout&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#34;Used grid size &amp;#34;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;GRID_SIZE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;endl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

      &lt;span class=&quot;c1&quot;&gt;// Kernel launch
&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;&lt;/span&gt;      &lt;span class=&quot;k&quot;&gt;auto&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chrono&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;high_resolution_clock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;

      &lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;checkCudaErrors&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cudaMalloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N_PATHS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;sizeof&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)));&lt;/span&gt;

      &lt;span class=&quot;k&quot;&gt;auto&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chrono&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;high_resolution_clock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;barrier_option&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;GRID_SIZE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BLOCK_SIZE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;B&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;S0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sigma&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d_normals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N_STEPS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N_PATHS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;cudaDeviceSynchronize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;auto&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chrono&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;high_resolution_clock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;

      &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mySum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;checkCudaErrors&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cudaMallocManaged&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mySum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;sizeof&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)));&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;sumPayoffKernel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;GRID_SIZE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BLOCK_SIZE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BLOCK_SIZE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;sizeof&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N_PATHS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mySum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;cudaDeviceSynchronize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;auto&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chrono&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;high_resolution_clock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;

      &lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cout&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#34;sumPayoffKernel takes &amp;#34;&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chrono&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;duration_cast&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chrono&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;microseconds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1000.f&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#34; ms&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

      &lt;span class=&quot;n&quot;&gt;gpu_sum&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mySum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N_PATHS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

      &lt;span class=&quot;k&quot;&gt;auto&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chrono&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;high_resolution_clock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;

      &lt;span class=&quot;c1&quot;&gt;// clean up
&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;&lt;/span&gt;      &lt;span class=&quot;n&quot;&gt;CHECKCURAND&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;curandDestroyGenerator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;curandGenerator&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;checkCudaErrors&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cudaFree&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;checkCudaErrors&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cudaFree&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_normals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;checkCudaErrors&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cudaFree&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mySum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;

      &lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cout&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#34;price &amp;#34;&lt;/span&gt;
              &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gpu_sum&lt;/span&gt;
              &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#34; time &amp;#34;&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chrono&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;duration_cast&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chrono&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;microseconds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1000.f&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#34; ms&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;catch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;exception&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#34;exception: &amp;#34;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;what&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;这段CUDA代码很长。一般来说，它主要执行以下一系列任务：&lt;/p&gt;&lt;p&gt;1、分配GPU内存来存储随机数和模拟路径结果。&lt;/p&gt;&lt;p&gt;2、调用cuRand库生成随机数。&lt;/p&gt;&lt;p&gt;3、启动障碍期权内核来执行并行模拟。&lt;/p&gt;&lt;p&gt;4、启动sum内核来聚合最终基础资产价格。&lt;/p&gt;&lt;p&gt;5、释放内存。&lt;/p&gt;&lt;p&gt;大家必须显式地执行每个步骤。在这个代码示例中，它计算下表中指定的亚式障碍期权的价格。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-fbd743fbd8c3482dd8448ea8aef88a8f_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;449&quot; data-rawheight=&quot;106&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;449&quot; data-original=&quot;https://pic4.zhimg.com/v2-fbd743fbd8c3482dd8448ea8aef88a8f_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-fbd743fbd8c3482dd8448ea8aef88a8f_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;449&quot; data-rawheight=&quot;106&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;449&quot; data-original=&quot;https://pic4.zhimg.com/v2-fbd743fbd8c3482dd8448ea8aef88a8f_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-fbd743fbd8c3482dd8448ea8aef88a8f_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;亚式障碍期权的参数。K是执行价格，B是障碍价格，S0是现货价格，sigma是波动率百分比，mu是漂移百分比，r是利率。&lt;/p&gt;&lt;p&gt;本研究中，该期权的期限为一年。在V100 GPU上编译和运行这个CUDA代码，可以&lt;b&gt;在26.6 ms内生成正确的期权价格$18.70，8192万条路径，365个步骤&lt;/b&gt;。使用这些数字作为以后比较的参考基准。在实际投资中，量化分析师通常使用更少的路径来进行蒙特卡罗模拟。&lt;/p&gt;&lt;p&gt;可以使用许多技巧来减少模拟所需的路径数，例如&lt;b&gt;重要性采样方法。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;在这五个步骤中，关键的部分是步骤3，大家需要在其中描述详细的蒙特卡罗模拟。理想情况下，大家的努力应该集中在这一步上。幸运的是，在迁移到Python GPU库之后，其他步骤可以自动处理，而不会牺牲其性能。例如：&lt;/p&gt;&lt;p&gt;步骤1：可以通过CuPy数组自动分配和初始化GPU内存。路径结果数组可以通过以下代码示例定义：&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;output&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cupy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_PATHS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cupy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;步骤2：CuPy随机函数引擎下的cuRAND库。分配和随机数生成可以通过以下代码示例定义:&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;randoms_gpu&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cupy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N_PATHS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N_STEPS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cupy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;步骤4：GPU的平均值计算是CuPy库中的一个内置函数。&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;v&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;步骤5：通过 Python 内存管理自动释放 GPU 内存。&lt;/p&gt;&lt;p&gt;在这篇文章的其余部分，我们会将重点介绍第3步，使用Python对亚式障碍期权进行蒙特卡罗模拟。&lt;/p&gt;&lt;p&gt;&lt;b&gt;Numba库方法-单核CPU&lt;/b&gt;&lt;/p&gt;&lt;p&gt;下面的代码示例是一个实现蒙特卡罗模拟优化运行在一个单核CPU：&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;nd&quot;&gt;@njit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fastmath&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;cpu_barrier_option&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;B&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;S0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sigma&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d_normals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N_STEPS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N_PATHS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tmp1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mu&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_STEPS&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tmp2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tmp3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_STEPS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;running_average&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_PATHS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;s_curr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;S0&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_STEPS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;s_curr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tmp1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_curr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sigma&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_curr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tmp3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_normals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N_PATHS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;running_average&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;running_average&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_curr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;running_average&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;running_average&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;B&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;payoff&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;running_average&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;K&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;running_average&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;K&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;d_s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tmp2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;payoff&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;蒙特卡罗仿真有两个嵌套的for-loop。外部循环遍历独立路径。在内部循环中，标的资产价格逐步更新，最终价格设置为结果数组。&lt;/p&gt;&lt;p&gt;我们启用了fastmath编译器优化来加快计算速度。对于相同数量的仿真路径和步骤，需要&lt;b&gt;41.6s&lt;/b&gt;才能产生相同的定价数。&lt;/p&gt;&lt;p&gt;&lt;b&gt;Numba库方法-多核CPU&lt;/b&gt;&lt;/p&gt;&lt;p&gt;为了实现跨多个CPU核的计算，你可以通过&lt;b&gt;将range改为prange来并行化外层for循环：&lt;/b&gt;&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;nd&quot;&gt;@njit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fastmath&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;parallel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;cpu_multiplecore_barrier_option&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;B&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;S0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sigma&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d_normals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N_STEPS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N_PATHS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tmp1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mu&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_STEPS&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tmp2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tmp3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_STEPS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;prange&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_PATHS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;s_curr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;S0&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;running_average&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_STEPS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;s_curr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tmp1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_curr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sigma&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_curr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tmp3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_normals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N_PATHS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;running_average&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;running_average&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_curr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;running_average&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;running_average&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;B&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;payoff&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;running_average&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;K&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;running_average&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;K&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;d_s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tmp2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;payoff&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;这段代码产生了相同的定价结果，现在需要&lt;b&gt;2.34s&lt;/b&gt;才能在32核、超线程化DGX-1 Intel CPU中计算出来。&lt;/p&gt;&lt;p&gt;&lt;b&gt;Numba库方法-单核GPU&lt;/b&gt;&lt;/p&gt;&lt;p&gt;使用Numba可以很容易地从CPU代码转移到GPU代码。在函数装饰中将 njit 改为 cuda.jit。并使用 GPU 线程并行进行外部for-loop计算。&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;nd&quot;&gt;@cuda.jit&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;numba_gpu_barrier_option&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;B&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;S0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sigma&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d_normals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N_STEPS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N_PATHS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# ii - overall thread index&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;ii&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cuda&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;threadIdx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cuda&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blockIdx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cuda&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blockDim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;stride&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cuda&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gridDim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cuda&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blockDim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tmp1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mu&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_STEPS&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tmp2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tmp3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_STEPS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;running_average&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ii&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N_PATHS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stride&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;s_curr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;S0&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_STEPS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;s_curr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tmp1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_curr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sigma&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_curr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tmp3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_normals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N_PATHS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;running_average&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_curr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;running_average&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;running_average&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;B&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;payoff&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;running_average&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;K&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;running_average&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;K&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;d_s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tmp2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;payoff&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;通过在 V100 GPU 上加速这种运算，计算时间可以减少到&lt;b&gt;65ms&lt;/b&gt;，并产生相同的结果。&lt;/p&gt;&lt;p&gt;&lt;b&gt;CuPy库方法-单核GPU&lt;/b&gt;&lt;/p&gt;&lt;p&gt;CuPy提供了一种从原始CUDA源定义GPU内核的简单方法。RawKernel对象允许大家使用CUDA的cuLaunchKernel接口调用内核。下面的代码示例将障碍期权的计算代码封装在RawKernel对象中：&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-c&quot;&gt;&lt;span class=&quot;n&quot;&gt;cupy_barrier_option&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cupy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RawKernel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;extern&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#34;C&amp;#34;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__global__&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;barrier_option&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;B&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;S0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sigma&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d_normals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N_STEPS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N_PATHS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;threadIdx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;blockIdx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;blockDim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stride&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;blockDim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gridDim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tid&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;threadIdx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tmp1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mu&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_STEPS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tmp2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tmp3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_STEPS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;running_average&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_PATHS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stride&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_curr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;S0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N_STEPS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
       &lt;span class=&quot;n&quot;&gt;s_curr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tmp1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_curr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sigma&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_curr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tmp3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_normals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N_PATHS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
       &lt;span class=&quot;n&quot;&gt;running_average&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_curr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;running_average&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
       &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;running_average&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;B&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
           &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
       &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;payoff&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;running_average&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;K&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;running_average&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;K&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;d_s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tmp2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;payoff&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;err&quot;&gt;&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;barrier_option&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;在Python中启动这个GPU内核并运行蒙特卡罗模拟需要&lt;b&gt;29ms&lt;/b&gt;，这与本地CUDA代码的基准测试（26ms）非常接近。&lt;/p&gt;&lt;p&gt;&lt;b&gt;Dask-多核GPU&lt;/b&gt;&lt;/p&gt;&lt;p&gt;为了获得更准确的期权价格估计，需要更多的蒙特卡罗模拟路径。之前使用的NVIDIA V100 GPU只有16GB的内存，几乎达到了运行8M模拟的内存极限。&lt;/p&gt;&lt;p&gt;&lt;b&gt;DASK是RAPIDS在GPU上进行分布式计算的集成组件。大家可以利用它将蒙特卡罗模拟计算分布到跨多个节点的多个GPU。&lt;/b&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-9d722f28b219565ce56d620dc94f4b1d_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;821&quot; data-rawheight=&quot;389&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;821&quot; data-original=&quot;https://pic2.zhimg.com/v2-9d722f28b219565ce56d620dc94f4b1d_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-9d722f28b219565ce56d620dc94f4b1d_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;821&quot; data-rawheight=&quot;389&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;821&quot; data-original=&quot;https://pic2.zhimg.com/v2-9d722f28b219565ce56d620dc94f4b1d_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-9d722f28b219565ce56d620dc94f4b1d_b.jpg&quot;/&gt;&lt;figcaption&gt;https://dask.org/&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;首先，将所有计算封装在一个函数中，以允许在函数调用结束时释放分配给GPU的内存。该函数为随机数种子值添加一个额外的参数，这样每个函数调用都有一个独立的随机数序列。&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;get_option_price&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;B&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;S0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sigma&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N_PATHS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8192000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N_STEPS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;365&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;number_of_threads&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;256&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;number_of_blocks&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_PATHS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;//&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;number_of_threads&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;cupy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;randoms_gpu&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cupy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N_PATHS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N_STEPS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cupy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;cupy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_PATHS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cupy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;cupy_barrier_option&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;number_of_blocks&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,),&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;number_of_threads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,),&lt;/span&gt;
                   &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
                    &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;B&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;S0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
                    &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sigma&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
                    &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;randoms_gpu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N_STEPS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N_PATHS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;v&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;out_df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cudf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataFrame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;out_df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;p&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cudf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()])&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;out_df&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;这个函数将模拟结果返回到一个cudf GPU数据模型中，以便在以后将其聚合到一个dask cuda分布式数据模型中。使用Dask在DGX-中运行1600800万次模拟，代码示例如下：&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dask_cudf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;from_delayed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;delayed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_option_price&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;110.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;B&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;100.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;S0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;120.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sigma&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.35&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mu&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.05&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3000&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt;  &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1600&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;compute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;compute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;这种额外的计算能力产生了一个更精确的定价结果18.71。调用std函数计算有800万条路径的定价的标准偏差为0.0073。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;4、第2部分：基于深度衍生工具的期权定价&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;在这篇文章的第1部分中，Python被用来实现蒙特卡罗模拟，从而在GPU中有效地为奇异的期权定价。&lt;b&gt;在量化金融中，低延迟期权定价在生产环境中对管理投资组合风险非常重要。蒙特卡罗模拟，即使在GPU中加速，有时也不够有效。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;本文提出了一种利用深度神经网络逼近期权定价的模型，并利用蒙特卡罗模拟生成的数据对其进行训练。结果表明，深度神经网络能够生成准确的定价数据，推理时间数量级更快。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-ba5eb023095c8b0f44e381a2e30f42f7_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;782&quot; data-rawheight=&quot;489&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;782&quot; data-original=&quot;https://pic4.zhimg.com/v2-ba5eb023095c8b0f44e381a2e30f42f7_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-ba5eb023095c8b0f44e381a2e30f42f7_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;782&quot; data-rawheight=&quot;489&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;782&quot; data-original=&quot;https://pic4.zhimg.com/v2-ba5eb023095c8b0f44e381a2e30f42f7_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-ba5eb023095c8b0f44e381a2e30f42f7_b.jpg&quot;/&gt;&lt;figcaption&gt;https://arxiv.org/pdf/1809.02233.pdf&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;受这篇文章的启发，我们在今天的推文中使用了类似的方法来建立一个近似的定价模型，并加快了推理延迟。利用一个高阶可微激活函数，证明了该模型可以有效地通过网络反向传递计算期权Greeks。通过使用TensorRT（&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/NVIDIA/TensorRT&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;github.com/NVIDIA/Tenso&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;rRT&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;）对模型进行转换，以提供最快的奇异期权定价速度，进一步提高了推理时间。&lt;/p&gt;&lt;p&gt;&lt;b&gt;神经网络逼近&lt;/b&gt;&lt;/p&gt;&lt;p&gt;深度神经网络是一种很好的函数逼近器，在图像处理和自然语言处理中取得了很大的成功。深度神经网络通常具有良好的泛化能力，当神经网络训练了大量的数据时，泛化能力对不可见的数据集非常有效。由于蒙特卡罗模拟可以用来发现期权的准确价格，因此你可以使用它来生成尽可能多的数据点，给定计算预值。&lt;/p&gt;&lt;p&gt;一个有趣的发现来自《Noise2Noise: Learning Image Restoration without Clean Data》这篇论文。其实，讲到因为蒙特卡罗模拟中的噪声是无偏的，在随机梯度训练中可以消除。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-8b02c32389b25405c65d1bf395eb89d4_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1012&quot; data-rawheight=&quot;579&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1012&quot; data-original=&quot;https://pic1.zhimg.com/v2-8b02c32389b25405c65d1bf395eb89d4_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-8b02c32389b25405c65d1bf395eb89d4_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1012&quot; data-rawheight=&quot;579&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1012&quot; data-original=&quot;https://pic1.zhimg.com/v2-8b02c32389b25405c65d1bf395eb89d4_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-8b02c32389b25405c65d1bf395eb89d4_b.jpg&quot;/&gt;&lt;figcaption&gt;https://arxiv.org/pdf/1803.04189.pdf&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;这一点在《Deeply Learning Derivatives》这篇论文中也得到了证明：&lt;b&gt;在相同路径数的情况下，模型的预测结果要优于蒙特卡罗模拟的结果。&lt;/b&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-02331a12b305e430b8146570a3af4385_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;733&quot; data-rawheight=&quot;300&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;733&quot; data-original=&quot;https://pic2.zhimg.com/v2-02331a12b305e430b8146570a3af4385_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-02331a12b305e430b8146570a3af4385_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;733&quot; data-rawheight=&quot;300&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;733&quot; data-original=&quot;https://pic2.zhimg.com/v2-02331a12b305e430b8146570a3af4385_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-02331a12b305e430b8146570a3af4385_b.jpg&quot;/&gt;&lt;figcaption&gt;预测模型体系结构图&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;上图解释：你生成随机期权参数（X个自变量），将它们输入到GPU的蒙特卡罗模拟中，然后计算出ground truth期权价格（Y个因变量）。然后使用这个生成的大数据集来训练一个深度神经网络，将期权定价作为一个非线性回归问题来学习。&lt;/p&gt;&lt;p&gt;&lt;b&gt;数据生成&lt;/b&gt;&lt;/p&gt;&lt;p&gt;在第1部分中我们使用Dask可以轻松地进行分布式计算。在这里，你可以使用Dask以分布式的方式生成一个大数据集：&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;futures&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;future&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;client&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;submit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gen_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;futures&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;future&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;results&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;client&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gather&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;futures&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;gen_data函数在单个GPU中运行，生成一组数据点并将它们保存在本地存储中。你可以使用第1部分中描述的任何Python GPU蒙特卡罗模拟方法。此示例代码使用不同的种子数运行gen_data100次，并将计算分配到多GPU环境中。&lt;/p&gt;&lt;p&gt;将6个期权参数统一采样到下表中指定的范围内：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-a2e6dbe13042be1cd56c0876dde040e8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;608&quot; data-rawheight=&quot;106&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;608&quot; data-original=&quot;https://pic1.zhimg.com/v2-a2e6dbe13042be1cd56c0876dde040e8_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-a2e6dbe13042be1cd56c0876dde040e8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;608&quot; data-rawheight=&quot;106&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;608&quot; data-original=&quot;https://pic1.zhimg.com/v2-a2e6dbe13042be1cd56c0876dde040e8_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-a2e6dbe13042be1cd56c0876dde040e8_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;总的来说，1000万个训练数据点和500万个验证数据点是通过在分布中运行蒙特卡罗模拟产生的。对于每个蒙特卡罗模拟，大家使用819.2万条路径来计算期权价格。如第1部分所示，819.2万条路径在该特定期权参数设置的价格中的标准差为0.0073。&lt;/p&gt;&lt;p&gt;&lt;b&gt;神经网络模型&lt;/b&gt;&lt;/p&gt;&lt;p&gt;由于我们没有关于这六个期权参数的结构信息，请选择通用的多层感知器神经网络作为定价模型。如下图：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-490517c34f04c08b882e8b7bfe3b1438_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;267&quot; data-rawheight=&quot;536&quot; class=&quot;content_image&quot; width=&quot;267&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-490517c34f04c08b882e8b7bfe3b1438_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;267&quot; data-rawheight=&quot;536&quot; class=&quot;content_image lazy&quot; width=&quot;267&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-490517c34f04c08b882e8b7bfe3b1438_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;与《Deeply Learning Derivatives》论文的不同之处在于使用&lt;b&gt;Elu&lt;/b&gt;作为激活函数，计算参数的高阶微分。如果你在原始的论文中使用ReLu，二阶微分总是0。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-4301d672a9fe23e12207184d810f7d32_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;993&quot; data-rawheight=&quot;896&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;993&quot; data-original=&quot;https://pic3.zhimg.com/v2-4301d672a9fe23e12207184d810f7d32_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-4301d672a9fe23e12207184d810f7d32_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;993&quot; data-rawheight=&quot;896&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;993&quot; data-original=&quot;https://pic3.zhimg.com/v2-4301d672a9fe23e12207184d810f7d32_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-4301d672a9fe23e12207184d810f7d32_b.jpg&quot;/&gt;&lt;figcaption&gt;https://ml-cheatsheet.readthedocs.io/en/latest/activation_functions.html#elu&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;生成的随机期权参数的范围，输入参数首先通过除以[200.0,198.0,200.0,0.4,0.2,0.2]缩小到(0-1)范围。然后它们被投射到1024的隐藏维度上5次。最后一层是线性层，它将隐藏维度映射到预测的期权价格。下面的代码示例是&lt;b&gt;PyTorch&lt;/b&gt;中详细的模型实现：&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torch.nn&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;nn&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torch.nn.functional&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;F&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torch&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Net&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Module&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hidden&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Net&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fc1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Linear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hidden&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fc2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Linear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hidden&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hidden&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fc3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Linear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hidden&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hidden&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fc4&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Linear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hidden&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hidden&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fc5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Linear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hidden&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hidden&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fc6&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Linear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hidden&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;register_buffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;norm&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                             &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;200.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                           &lt;span class=&quot;mf&quot;&gt;198.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                           &lt;span class=&quot;mf&quot;&gt;200.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                           &lt;span class=&quot;mf&quot;&gt;0.4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                           &lt;span class=&quot;mf&quot;&gt;0.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                           &lt;span class=&quot;mf&quot;&gt;0.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;forward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# normalize the parameter to range [0-1] &lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;norm&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;elu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fc1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;elu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fc2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;elu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fc3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;elu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fc4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;elu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fc5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fc6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;神经网络训练&lt;/b&gt;&lt;/p&gt;&lt;p&gt;我们提供了两种方法来训练神经网络，一种是使用Ignite，另一种是使用神经模块（NeMo）。这两个都是高级DL库，可以简化训练模型。实验结果表明，采用混合精度训练和多GPU训练可以有效地提高训练速度。使用MSELoss作为损失函数，Adam作为优化器，CosineAnnealingScheduler作为学习率调度器。&lt;/p&gt;&lt;p&gt;&lt;b&gt;Greeks和隐含波动率计算&lt;/b&gt;&lt;/p&gt;&lt;p&gt;训练收敛后，性能最好的模型保存在本地存储器中。现在你可以加载模型参数，并使用它来运行推断：&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;checkpoint&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;check_points/512/model_best.pth.tar&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Net&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cuda&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load_state_dict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;checkpoint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;state_dict&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;110.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;100.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;120.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.35&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.05&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;start&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cuda&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;end&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;result &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%.4f&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; inference time &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%.6f&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;当你输入与第1部分中相同的期权参数（在训练数据集中没有使用）时，该模型将生成正确的期权价格$18.714。最重要的是，与CUDA的蒙特卡罗法26ms的计算时间相比，它只需要&lt;b&gt;0.8ms&lt;/b&gt;，&lt;b&gt;32倍的加速&lt;/b&gt;。&lt;/p&gt;&lt;p&gt;近似的期权定价模型是完全可微的，这意味着你可以根据输入参数计算任意阶的微分。在金融领域，这被用来计算期权中的&lt;b&gt;Greeks&lt;/b&gt;。&lt;/p&gt;&lt;p&gt;由于价格评估中存在噪声，用蒙特卡罗模拟法计算Greeks是一项具有挑战性的工作。数值差分法可能存在噪声。然而，在你有了神经网络近似模型之后，利用PyTorch中的自动梯度特性来计算微分。&lt;b&gt;由于梯度是通过网络的后向传递计算出来的，因此该算法具有较高的计算效率。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;下面的代码示例展示了一个计算参数K、B、S0、sigma、mu、r’的一阶微分的示例：&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;110.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;100.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;120.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.35&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.05&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cuda&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;requires_grad&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;backward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;first_order_gradient&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;grad&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;对于高阶微分，多次使用PyTorch autograd.grad方法：&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torch&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Tensor&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torch.autograd&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Variable&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torch.autograd&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;grad&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torch&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;110.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;100.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;120.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.35&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.05&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cuda&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;requires_grad&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;loss_grads&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;grad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;create_graph&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;drv&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;grad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loss_grads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;drv&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;你可以生成的&lt;b&gt;delta&lt;/b&gt;和&lt;b&gt;gamma&lt;/b&gt;的Greek图形作为一个函数的基础价格：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-151f47ab39e317bf193659187a02c1ff_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1061&quot; data-rawheight=&quot;668&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1061&quot; data-original=&quot;https://pic4.zhimg.com/v2-151f47ab39e317bf193659187a02c1ff_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-151f47ab39e317bf193659187a02c1ff_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1061&quot; data-rawheight=&quot;668&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1061&quot; data-original=&quot;https://pic4.zhimg.com/v2-151f47ab39e317bf193659187a02c1ff_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-151f47ab39e317bf193659187a02c1ff_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-034e711dfc68cfdcd6475f0c83d49760_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;744&quot; data-rawheight=&quot;478&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;744&quot; data-original=&quot;https://pic1.zhimg.com/v2-034e711dfc68cfdcd6475f0c83d49760_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-034e711dfc68cfdcd6475f0c83d49760_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;744&quot; data-rawheight=&quot;478&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;744&quot; data-original=&quot;https://pic1.zhimg.com/v2-034e711dfc68cfdcd6475f0c83d49760_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-034e711dfc68cfdcd6475f0c83d49760_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;隐含波动率是基于期权报价对标的资产的预测波动率。模型给出的是价格与期权参数的反向映射，用蒙特卡罗模拟法很难做到这一点。但如果你有一个深度学习定价模型，这是一个简单的任务。给定价格P，隐含波动率是函数compute_price的根，如下面的代码所示：&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;compute_price&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sigma&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;110.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;100.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;120.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sigma&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.05&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cuda&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;任何数值求根的方法都可以使用，例如&lt;b&gt;Brent&lt;/b&gt;算法是计算根的有效方法。&lt;/p&gt;&lt;p&gt;&lt;b&gt;TensorRT推理加速&lt;/b&gt;&lt;/p&gt;&lt;p&gt;在对深度学习网络进行训练之后，下一步通常是将模型部署到生产环境中。最直接的方法是将PyTorch模型置于推理模式。推理从输入到输出运行一个正向传递。如前所述，它运行得很快，可以在0.8 ms内获得准确的结果。然而，你可以做得更好。&lt;/p&gt;&lt;p&gt;NVIDIA提供了一个强大的推理模型优化工具TensorRT，其中包括一个深度学习推理优化器和runtime，它为深度学习推理应用程序提供低延迟和高吞吐量。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-54ff9b59db2a0d094e6dace7b800328b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;344&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-54ff9b59db2a0d094e6dace7b800328b_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-54ff9b59db2a0d094e6dace7b800328b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;344&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-54ff9b59db2a0d094e6dace7b800328b_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-54ff9b59db2a0d094e6dace7b800328b_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;在这篇文章中，TensorRT帮助在T4 GPU上将BERT自然语言理解推理加速到2.2 ms。受此启发，大家可以将训练有素的亚式障碍期权模型转换为TensorRT推理引擎，以获得显著的加速。&lt;/p&gt;&lt;p&gt;准备好TensorRT引擎文件后，可以使用它进行推理工作。&lt;/p&gt;&lt;p&gt;1、加载序列化的引擎文件。&lt;/p&gt;&lt;p&gt;2、分配CUDA设备阵列。&lt;/p&gt;&lt;p&gt;3、异步地将输入从主机复制到设备。&lt;/p&gt;&lt;p&gt;4、启动TensorRT引擎来计算结果。&lt;/p&gt;&lt;p&gt;5、异步地将输出从设备复制到主机。&lt;/p&gt;&lt;p&gt;下面的代码示例使用TensorRT引擎运行推理：&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tensorrt&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;trt&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;time&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pycuda&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pycuda.driver&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;cuda&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pycuda.autoinit&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;TRT_LOGGER&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;trt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Logger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;trt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Logger&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;WARNING&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;opt.engine&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;rb&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;trt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Runtime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TRT_LOGGER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;runtime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;engine&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;runtime&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;deserialize_cuda_engine&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;h_input&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cuda&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pagelocked_empty&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;h_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;110.0&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;h_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;100.0&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;h_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;120.0&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;h_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.35&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;h_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;h_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.05&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;h_output&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cuda&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pagelocked_empty&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;d_input&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cuda&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mem_alloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;h_input&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nbytes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;d_output&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cuda&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mem_alloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;h_output&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nbytes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;stream&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cuda&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Stream&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;engine&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;create_execution_context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;start&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;cuda&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;memcpy_htod_async&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;h_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stream&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;input_shape&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_binding_shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;execute_async&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bindings&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stream_handle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;handle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;cuda&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;memcpy_dtoh_async&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;h_output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d_output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stream&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;stream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;synchronize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;end&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;result &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%.4f&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; inference time &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%.6f&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;h_output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;与non-TensorRT方法相比，它可以在四分之一（&lt;b&gt;0.2 ms&lt;/b&gt;）的推断时间内生成准确的结果。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;5、总结&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;在第1部分中，我们向大家展示了在CUDA C/ C++中实现蒙特卡罗期权定价的传统方法，但有点复杂，但它具有最佳的绝对性能。使用Python的GPU库，可以用简洁的Python代码行实现完全相同的蒙特卡罗模拟，而不会带来显著的性能损失。&lt;/p&gt;&lt;p&gt;此外，在将模拟代码迁移到Python之后，大家可以使用其他有用的Python库来改进结果。通过使用RAPIDS/Dask，大规模的蒙特卡罗仿真可以很容易地分布在多个节点和多个GPU上，从而获得更高的精度。&lt;/p&gt;&lt;p&gt;在第2部分中，我们再现了论文的结果。展示了使用神经网络逼近奇异期权价格模型的几个好处。它可以将期权价格的计算速度提高35倍，且结果准确。可微神经网络使得期权Greeks的计算变得容易。大家还可以使用TensorRT进一步改进网络推断时间，并实现最优的性能。&lt;/p&gt;&lt;p&gt;量化投资与机器学习微信公众号，是业内垂直于&lt;b&gt;Quant、MFE、Fintech、AI、ML&lt;/b&gt;等领域的&lt;b&gt;量化类主流自媒体。&lt;/b&gt;公众号拥有来自&lt;b&gt;公募、私募、券商、期货、银行、保险资管、海外&lt;/b&gt;等众多圈内&lt;b&gt;18W+&lt;/b&gt;关注者。每日发布行业前沿研究成果和最新量化资讯。&lt;/p&gt;</description>
<author>Quant最爱</author>
<guid isPermaLink="false">2020-04-22-134445362</guid>
<pubDate>Wed, 22 Apr 2020 00:00:00 +0800</pubDate>
</item>
<item>
<title>文艺复兴进军比特币！币圈割韭菜？</title>
<link>https://henix.github.io/feeds/zhuanlan.Lhtz-Jqxx/2020-04-20-133744760.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/133744760&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-3f26b70b95bb4249195726566a0615bf_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;量化投资与机器学习编辑部独家撰写&lt;/p&gt;&lt;p&gt;&lt;b&gt;未经授权，禁止转载&lt;/b&gt;&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;根据一份监管申报文件披露具，AUM达750亿美元的文艺复兴科技旗舰对冲产品大奖章基金开始涉足比特币，看来老爷子又要玩花样了。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-528877c75f5897d07e0234e0a5409a39_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;801&quot; data-rawheight=&quot;434&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;801&quot; data-original=&quot;https://pic2.zhimg.com/v2-528877c75f5897d07e0234e0a5409a39_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-528877c75f5897d07e0234e0a5409a39_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;801&quot; data-rawheight=&quot;434&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;801&quot; data-original=&quot;https://pic2.zhimg.com/v2-528877c75f5897d07e0234e0a5409a39_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-528877c75f5897d07e0234e0a5409a39_b.jpg&quot;/&gt;&lt;figcaption&gt;*量化投资与机器学习独家整理&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;文艺复兴科技表示将交易限于&lt;b&gt;芝商所（CME）的现金交割比特币期货合约&lt;/b&gt;。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-ce5d227d5412db8b63cc878d09814bfd_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;630&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-ce5d227d5412db8b63cc878d09814bfd_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-ce5d227d5412db8b63cc878d09814bfd_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;630&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-ce5d227d5412db8b63cc878d09814bfd_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-ce5d227d5412db8b63cc878d09814bfd_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;芝加哥商品交易所的比特币期货于2017年推出，以现金结算，无需接收比特币本身。CME 今年早些时候首次发布报告称，在2020年第一季度，交易比特币期货合约的新账户数量有所增加。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-db401d2d1a19f337751cf993428d9be8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;949&quot; data-rawheight=&quot;526&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;949&quot; data-original=&quot;https://pic1.zhimg.com/v2-db401d2d1a19f337751cf993428d9be8_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-db401d2d1a19f337751cf993428d9be8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;949&quot; data-rawheight=&quot;526&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;949&quot; data-original=&quot;https://pic1.zhimg.com/v2-db401d2d1a19f337751cf993428d9be8_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-db401d2d1a19f337751cf993428d9be8_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;根据文艺复兴科技文件的描述：“比特币是这些期货交易的基础商品，是一种相对较新的、投机性很强的资产。同时，比特币和基于比特币的期货非常不稳定，随着时间的推移，投资结果可能会有很大的差异。”&lt;/p&gt;&lt;p&gt;从文件中可以看出，文艺复兴科技在比特币上的活跃程度并不明确，也不清楚它是否购买了任何一种加密货币期货，只知道它现在：&lt;b&gt;被允许参与比特币期货交易&lt;/b&gt;。&lt;br/&gt;&lt;/p&gt;&lt;p&gt;像比特币这样的加密货币仍然处于主流金融行业的边缘，由于渴望交易可能有利可图的新资产，华尔街正逐渐将它们纳入主流金融行业。&lt;/p&gt;&lt;p&gt;我们都知道，比特币的波动性是惊人的。它的价格从2017年初的不到1000美元飙升至当年12月的近2万美元的峰值，然后突然暴跌。自2018年以来，它的价格一直在3000美元到1.2万美元之间波动。&lt;/p&gt;&lt;p&gt;文艺复兴科技列出了加密货币交易涉及的一系列风险，如其有限的历史、波动性、缺乏官方认可的货币、监管以及易受恶意行为者操纵的影响等。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-c5dd8b28ec056e76265c96e3aaef48dd_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;520&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-c5dd8b28ec056e76265c96e3aaef48dd_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-c5dd8b28ec056e76265c96e3aaef48dd_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;520&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-c5dd8b28ec056e76265c96e3aaef48dd_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-c5dd8b28ec056e76265c96e3aaef48dd_b.jpg&quot;/&gt;&lt;figcaption&gt;*量化投资与机器学习独家整理&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;大家看最后一句：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-2924dfd9f98ad6f553a26689f5cc6bf2_b.png&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;119&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-2924dfd9f98ad6f553a26689f5cc6bf2_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-2924dfd9f98ad6f553a26689f5cc6bf2_b.png&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;119&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-2924dfd9f98ad6f553a26689f5cc6bf2_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-2924dfd9f98ad6f553a26689f5cc6bf2_b.png&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;这些因素中的任何一个都可能对该基金的投资价值产生重大而不利的影响。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;根据WSJ报道，大奖章基金今年年初至4月14日上涨了24%。标准普尔500指数在过去12个月（截至4月14日）下跌了11.4%。这远远超出了整个股票市场的涨幅，因新冠病毒的迅速传播以及政府抗疫举措使许多经济体陷入停顿，同期股票市场已经下跌了逾11%。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-b454c29b6a56b5959f7469b85bf8fc71_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;1463&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-b454c29b6a56b5959f7469b85bf8fc71_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-b454c29b6a56b5959f7469b85bf8fc71_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;1463&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-b454c29b6a56b5959f7469b85bf8fc71_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-b454c29b6a56b5959f7469b85bf8fc71_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;报道称，大奖章迄今取得的骄人成绩大部分归功于在3月份9.9%的涨幅。考虑到该基金高昂的投资者费用，收益数字甚至更加令人印象深刻。&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//weixin.qq.com/r/rEhJURrEXUcirV4y9x2_&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;http://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;weixin.qq.com/r/rEhJURr&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;EXUcirV4y9x2_&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt; (二维码自动识别)&lt;/p&gt;&lt;p&gt;据报道，扣除高额投资者费用前，大奖章基金今年迄今涨幅高达约39%。&lt;/p&gt;&lt;p&gt;西蒙斯，今年马上要83岁了，身价超过230亿美元。根据彭博亿万富翁指数的估计，其&lt;b&gt;收入超过10亿美元！&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//weixin.qq.com/r/rEhJURrEXUcirV4y9x2_&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;http://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;weixin.qq.com/r/rEhJURr&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;EXUcirV4y9x2_&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt; (二维码自动识别)&lt;/p&gt;&lt;p&gt;虽然老爷子仍然是文艺复兴的主席，但他主要关注的是慈善事业。今年早些时候。他的儿子成为了文艺复兴的董事长：&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653296607%26idx%3D1%26sn%3D0e23be0ef03e48d53f102c724101d1e7%26chksm%3D802dd5cab75a5cdcbae6bd3fa2491505a386a7bafd7c74b064e3ceb9ee406114c4d189c330ae%26scene%3D21%23wechat_redirect&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic1.zhimg.com/v2-23549dadf84de01b3aafedaa566d6f78_180x120.jpg&quot; data-image-width=&quot;1100&quot; data-image-height=&quot;467&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;​西蒙斯终放手！子承父业，文艺复兴该何去何从？&lt;/a&gt;&lt;p&gt;前段时间编辑部推荐的由Greg Zuckerman撰写的畅销书&lt;i&gt;&lt;b&gt;《The Man Who Solved the Market》&lt;/b&gt;&lt;/i&gt;让我们了解了很多关于西蒙斯和文艺复兴的故事。也在量化圈引起热议，众多达人分享读书心得或评论。&lt;/p&gt;&lt;p&gt;&lt;b&gt;获取此书：&lt;/b&gt;&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s/kQoM6h-044yH118li_0-yA&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic2.zhimg.com/v2-61d487b390e082c13a731ede0368794d_180x120.jpg&quot; data-image-width=&quot;899&quot; data-image-height=&quot;381&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;手慢无！了解文艺复兴的新书有电子版啦！&lt;/a&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;江湖精彩依旧&lt;/b&gt;&lt;/p&gt;&lt;blockquote&gt;往期推荐&lt;/blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653293316%26idx%3D1%26sn%3D1828e486f53b70a21c04b94b020ed5c6%26chksm%3D802dc911b75a4007c02d27551ebdfe712dfc60f8dfb6caf2aa9b6244d5f494741a8923413d6a%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;2019西蒙斯访谈一：量化策略、职业与交易&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653295879%26idx%3D1%26sn%3D682b0863d90682b69b4fc700f31e0c99%26chksm%3D802dd712b75a5e043b3c1d550ca0e256898a870d4906895f7562272928055ca1e02bdbb85f39%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;2019西蒙斯访谈二：数学，一生所爱！&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653295230%26idx%3D1%26sn%3De7db254a56084299d40cff2dc8fbc796%26chksm%3D802dd06bb75a597d019c536a181953e88cf9e493cca776684fe688cc3582b842acd1ff1fa6b1%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;巴菲特+西蒙斯：完美！&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653295088%26idx%3D1%26sn%3D866988471ef6e19cc4375f35f16906fb%26chksm%3D802dd3e5b75a5af3e23ff993be3ca976d4b883182fc576145cb9525fefe783545ab2f7c8aaa9%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;想去文艺复兴？看看西蒙斯给你发多少钱！&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653296499%26idx%3D1%26sn%3Dcee54028e5d93e1375a315a530ef264f%26chksm%3D802dd566b75a5c70659051d01a40d6a223ccf5ea30f134fa805c26d2f7c5d78f87f4afae53f8%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;文艺复兴：西蒙斯的另一面！&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653297105%26idx%3D1%26sn%3D877a0889c6cab876fc924cc06dc55604%26chksm%3D802ddbc4b75a52d2f58e1f03b3e58b1c97f1abcbdb998657dcd0ed87c6a91e01994c0dda1bf0%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;120亿！全球15位顶级对冲基金经理收入揭晓~&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653297437%26idx%3D1%26sn%3D9f00834975468c9731f853fb38cd245d%26chksm%3D802dd908b75a501ed04de3e95b97bc8157f19c751767de7784d30d249f41a0419e330de58ef9%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;全球对冲基金备受疫情煎熬，文艺复兴暴跌7%！&lt;/a&gt;&lt;/p&gt;&lt;p&gt;量化投资与机器学习微信公众号，是业内垂直于&lt;b&gt;Quant、MFE、Fintech、AI、ML&lt;/b&gt;等领域的&lt;b&gt;量化类主流自媒体。&lt;/b&gt;公众号拥有来自&lt;b&gt;公募、私募、券商、期货、银行、保险资管、海外&lt;/b&gt;等众多圈内&lt;b&gt;18W+&lt;/b&gt;关注者。每日发布行业前沿研究成果和最新量化资讯。&lt;/p&gt;</description>
<author>Quant最爱</author>
<guid isPermaLink="false">2020-04-20-133744760</guid>
<pubDate>Mon, 20 Apr 2020 00:00:00 +0800</pubDate>
</item>
<item>
<title>潘石屹与Python</title>
<link>https://henix.github.io/feeds/zhuanlan.Lhtz-Jqxx/2020-04-12-129270921.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/129270921&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-e2449d94e28442a758ae8a3f05d83f74_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;量化投资与机器学习编辑部 | Allen&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;这不是Python推销广告！！！是一篇推文&lt;/b&gt;&lt;/p&gt;&lt;b&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-f49e93164d8cde8d155ea303856dd620_b.png&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;64&quot; data-rawheight=&quot;64&quot; class=&quot;content_image&quot; width=&quot;64&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-f49e93164d8cde8d155ea303856dd620_b.png&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;64&quot; data-rawheight=&quot;64&quot; class=&quot;content_image lazy&quot; width=&quot;64&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-f49e93164d8cde8d155ea303856dd620_b.png&quot;/&gt;&lt;/figure&gt;&lt;/b&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;记得去年潘石屹在56岁生日当天，发布的一条微博宣布进军编程语言Python：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-742c4957b860ff1f046a6aa026505f87_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;280&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-742c4957b860ff1f046a6aa026505f87_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-742c4957b860ff1f046a6aa026505f87_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;280&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-742c4957b860ff1f046a6aa026505f87_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-742c4957b860ff1f046a6aa026505f87_b.jpg&quot;/&gt;&lt;figcaption&gt;*图片来自：微博&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;一半留言都是Python编程机构的营销账号，为了蹭热度也是拼了，毕竟大佬发话了，得抓住机会呀！&lt;/p&gt;&lt;p&gt;在这之后，潘总由连续发了几篇推文，总结下来就是：&lt;/p&gt;&lt;p&gt;&lt;b&gt;在不断发展的社会中，要指挥机器，就需要学习让机器听得懂的语言。而他觉得Python是进化最好的程序语言，也是最值得去学习的语言之一。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;同时，他还创立了一个微博话题，&lt;b&gt;5000+万的阅读量：&lt;/b&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-16971413a0ffcf5db2bcd81d0a2c1973_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;872&quot; data-rawheight=&quot;174&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;872&quot; data-original=&quot;https://pic4.zhimg.com/v2-16971413a0ffcf5db2bcd81d0a2c1973_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-16971413a0ffcf5db2bcd81d0a2c1973_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;872&quot; data-rawheight=&quot;174&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;872&quot; data-original=&quot;https://pic4.zhimg.com/v2-16971413a0ffcf5db2bcd81d0a2c1973_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-16971413a0ffcf5db2bcd81d0a2c1973_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-23eec53c084e76eae1ae930f01f2a674_b.gif&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;240&quot; data-rawheight=&quot;182&quot; data-thumbnail=&quot;https://pic1.zhimg.com/v2-23eec53c084e76eae1ae930f01f2a674_b.jpg&quot; class=&quot;content_image&quot; width=&quot;240&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-23eec53c084e76eae1ae930f01f2a674_b.gif&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;240&quot; data-rawheight=&quot;182&quot; data-thumbnail=&quot;https://pic1.zhimg.com/v2-23eec53c084e76eae1ae930f01f2a674_b.jpg&quot; class=&quot;content_image lazy&quot; width=&quot;240&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-23eec53c084e76eae1ae930f01f2a674_b.gif&quot;/&gt;&lt;/figure&gt;&lt;p&gt;几乎每天一题，目测3个月干完！&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-7583c1a504faf2392a997fa7047418fb_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;1163&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-7583c1a504faf2392a997fa7047418fb_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-7583c1a504faf2392a997fa7047418fb_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;1163&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-7583c1a504faf2392a997fa7047418fb_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-7583c1a504faf2392a997fa7047418fb_b.jpg&quot;/&gt;&lt;figcaption&gt;*图片来自：微博&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;在潘石屹的微博中，有这样一条：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-ff4db0221a71215ea9d00154cce31173_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;443&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-ff4db0221a71215ea9d00154cce31173_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-ff4db0221a71215ea9d00154cce31173_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;443&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-ff4db0221a71215ea9d00154cce31173_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-ff4db0221a71215ea9d00154cce31173_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;我觉得这段话说的很好：&lt;/p&gt;&lt;p&gt;&lt;b&gt;1、勤于思考，多动手&lt;/b&gt;&lt;/p&gt;&lt;p&gt;我们生活在如此发达的网络时代，要寻找想要的信息太便捷了，但是很多人还是填鸭式的。我在工作中也是遇到很多这样的人。一个很简单的问题，第一时间不是自己想办法先解决，&lt;b&gt;可以先百度啊（这也是自己解决问题的表现）&lt;/b&gt;。而是没有经过思考就开始在群里问人，有些问题还很幼稚。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-6b44acd3f979d9b14a5d71721bac58b9_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;580&quot; data-rawheight=&quot;598&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;580&quot; data-original=&quot;https://pic2.zhimg.com/v2-6b44acd3f979d9b14a5d71721bac58b9_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-6b44acd3f979d9b14a5d71721bac58b9_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;580&quot; data-rawheight=&quot;598&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;580&quot; data-original=&quot;https://pic2.zhimg.com/v2-6b44acd3f979d9b14a5d71721bac58b9_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-6b44acd3f979d9b14a5d71721bac58b9_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;2、请掌握一门编程语言&lt;/b&gt;&lt;/p&gt;&lt;p&gt;公众号成立至今，一直致力为国内量化事业贡献一份自己的力量。在这其中，我们也意识到，不管你是否想做量化，掌握一门编程语言对你真的很有帮助，可能直接或间接的影响你的工作和生活。&lt;b&gt;人若有一技之长，走到哪里都不怕&lt;/b&gt;！你们看到的很多招聘、求职加分项等等都现在都在提编程这个事。&lt;b&gt;现如今，Python很火，你必须承认这一点。当然你可以在大环境下逆风前行，但是，有时候顺势而为也是一种智慧！&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;3、终身学习&lt;/b&gt;&lt;/p&gt;&lt;p&gt;这个问题已经满大街的心灵鸡汤了，在这里就不过多说了。我觉得这个问题关键在于：&lt;b&gt;你的执行力（坚持）和态度（对知识的渴求），当然自律也很重要！&lt;/b&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-eed3ffc30ee6bf9e9a3f81c2c1c0e5e0_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;271&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-eed3ffc30ee6bf9e9a3f81c2c1c0e5e0_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-eed3ffc30ee6bf9e9a3f81c2c1c0e5e0_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;271&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-eed3ffc30ee6bf9e9a3f81c2c1c0e5e0_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-eed3ffc30ee6bf9e9a3f81c2c1c0e5e0_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-362068f7d3274e464079a7ae5b616c9c_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;690&quot; data-rawheight=&quot;921&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;690&quot; data-original=&quot;https://pic1.zhimg.com/v2-362068f7d3274e464079a7ae5b616c9c_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-362068f7d3274e464079a7ae5b616c9c_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;690&quot; data-rawheight=&quot;921&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;690&quot; data-original=&quot;https://pic1.zhimg.com/v2-362068f7d3274e464079a7ae5b616c9c_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-362068f7d3274e464079a7ae5b616c9c_b.jpg&quot;/&gt;&lt;figcaption&gt;*图片来自：微博&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;下面的这张图是潘石屹的Python学习笔记，可见有多努力！&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-a07484295102b9721c4c7338636bb990_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;690&quot; data-rawheight=&quot;517&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;690&quot; data-original=&quot;https://pic1.zhimg.com/v2-a07484295102b9721c4c7338636bb990_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-a07484295102b9721c4c7338636bb990_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;690&quot; data-rawheight=&quot;517&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;690&quot; data-original=&quot;https://pic1.zhimg.com/v2-a07484295102b9721c4c7338636bb990_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-a07484295102b9721c4c7338636bb990_b.jpg&quot;/&gt;&lt;figcaption&gt;*图片来自：微博&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;廖雪峰在知乎说道：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-2aacf85605fcbdb91dbbb63c771d8113_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;296&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-2aacf85605fcbdb91dbbb63c771d8113_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-2aacf85605fcbdb91dbbb63c771d8113_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;296&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-2aacf85605fcbdb91dbbb63c771d8113_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-2aacf85605fcbdb91dbbb63c771d8113_b.jpg&quot;/&gt;&lt;figcaption&gt;*图片来自：知乎&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;可能带有调侃的成分，但态度决定一切！&lt;/p&gt;&lt;p&gt;在本周五，潘总的微博又炸了，发布了一则他要&lt;b&gt;参加Python编程考试&lt;/b&gt;的消息（为了不给第三方打广告，把后面的第三方教育机构已隐去）：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-0b09ccb9dae2f1f91cdc37b12e5dd877_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;564&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-0b09ccb9dae2f1f91cdc37b12e5dd877_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-0b09ccb9dae2f1f91cdc37b12e5dd877_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;564&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-0b09ccb9dae2f1f91cdc37b12e5dd877_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-0b09ccb9dae2f1f91cdc37b12e5dd877_b.jpg&quot;/&gt;&lt;figcaption&gt;*图片来自：微博&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;青少年？&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;这个青少年长得有点捉急&lt;/b&gt;&lt;/p&gt;&lt;b&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-d8165e442679dd6eaa7a46937ef6b946_b.png&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;64&quot; data-rawheight=&quot;64&quot; class=&quot;content_image&quot; width=&quot;64&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-d8165e442679dd6eaa7a46937ef6b946_b.png&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;64&quot; data-rawheight=&quot;64&quot; class=&quot;content_image lazy&quot; width=&quot;64&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-d8165e442679dd6eaa7a46937ef6b946_b.png&quot;/&gt;&lt;/figure&gt;&lt;/b&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-bb3f848d612b95bef2f237af9316b611_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;685&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-bb3f848d612b95bef2f237af9316b611_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-bb3f848d612b95bef2f237af9316b611_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;685&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-bb3f848d612b95bef2f237af9316b611_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-bb3f848d612b95bef2f237af9316b611_b.jpg&quot;/&gt;&lt;figcaption&gt;*图片来自：微博&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;有网友调侃：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-9613b0264b08a60b0c7616c3fdc51b7e_b.png&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;134&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-9613b0264b08a60b0c7616c3fdc51b7e_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-9613b0264b08a60b0c7616c3fdc51b7e_b.png&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;134&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-9613b0264b08a60b0c7616c3fdc51b7e_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-9613b0264b08a60b0c7616c3fdc51b7e_b.png&quot;/&gt;&lt;figcaption&gt;*图片来自：微博&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;说起头发，民间有传闻：&lt;/p&gt;&lt;p&gt;&lt;b&gt;程序员的水平高低取决于他的发际线&lt;/b&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-b20ac94cb18ef98d86fe3f94c4fdbbd3_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;778&quot; data-rawheight=&quot;594&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;778&quot; data-original=&quot;https://pic4.zhimg.com/v2-b20ac94cb18ef98d86fe3f94c4fdbbd3_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-b20ac94cb18ef98d86fe3f94c4fdbbd3_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;778&quot; data-rawheight=&quot;594&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;778&quot; data-original=&quot;https://pic4.zhimg.com/v2-b20ac94cb18ef98d86fe3f94c4fdbbd3_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-b20ac94cb18ef98d86fe3f94c4fdbbd3_b.jpg&quot;/&gt;&lt;figcaption&gt;*图片来自：网络&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;这么看的话，&lt;b&gt;潘总的级别起码在专家之上&lt;/b&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-bb764515951c7e67dd48aadfe3002d0c_b.png&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;64&quot; data-rawheight=&quot;64&quot; class=&quot;content_image&quot; width=&quot;64&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-bb764515951c7e67dd48aadfe3002d0c_b.png&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;64&quot; data-rawheight=&quot;64&quot; class=&quot;content_image lazy&quot; width=&quot;64&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-bb764515951c7e67dd48aadfe3002d0c_b.png&quot;/&gt;&lt;/figure&gt;&lt;p&gt;那让我们看看每个编程语言作者的发量，到底是否取决于发际线呢？&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-89c51b855d68a1d6d98d8a19eded99d0_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1066&quot; data-rawheight=&quot;3323&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1066&quot; data-original=&quot;https://pic1.zhimg.com/v2-89c51b855d68a1d6d98d8a19eded99d0_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-89c51b855d68a1d6d98d8a19eded99d0_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1066&quot; data-rawheight=&quot;3323&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1066&quot; data-original=&quot;https://pic1.zhimg.com/v2-89c51b855d68a1d6d98d8a19eded99d0_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-89c51b855d68a1d6d98d8a19eded99d0_b.jpg&quot;/&gt;&lt;figcaption&gt;*图片来自：Python作业辅导员&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;这么看下来也不一定啊，Python的作者Guido van Rossum完胜啊！&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-1c6c9c0525e071061cd8dce3f470997d_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;448&quot; data-rawheight=&quot;540&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;448&quot; data-original=&quot;https://pic2.zhimg.com/v2-1c6c9c0525e071061cd8dce3f470997d_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-1c6c9c0525e071061cd8dce3f470997d_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;448&quot; data-rawheight=&quot;540&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;448&quot; data-original=&quot;https://pic2.zhimg.com/v2-1c6c9c0525e071061cd8dce3f470997d_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-1c6c9c0525e071061cd8dce3f470997d_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;因为潘总和我都是西北人，也算是老乡（都在一个地方长大：天水）。天水人有句俗语叫：&lt;/p&gt;&lt;p&gt;&lt;b&gt;人要能反乱（fàn luan）&lt;/b&gt;&lt;/p&gt;&lt;p&gt;意思就是人这一辈一定要：&lt;/p&gt;&lt;p&gt;&lt;b&gt;能折腾、多闯荡&lt;/b&gt;&lt;/p&gt;&lt;p&gt;才能：&lt;/p&gt;&lt;p&gt;&lt;b&gt;干大事、成大器&lt;/b&gt;&lt;/p&gt;&lt;p&gt;潘总是这样攒劲（zǎn jìn）的人，我们也应该是！各位加油！&lt;/p&gt;&lt;p&gt;欢迎各位读者讨论交流。&lt;/p&gt;&lt;p&gt;量化投资与机器学习微信公众号，是业内垂直于&lt;b&gt;Quant、MFE、Fintech、AI、ML&lt;/b&gt;等领域的&lt;b&gt;量化类主流自媒体。&lt;/b&gt;公众号拥有来自&lt;b&gt;公募、私募、券商、期货、银行、保险资管、海外&lt;/b&gt;等众多圈内&lt;b&gt;18W+&lt;/b&gt;关注者。每日发布行业前沿研究成果和最新量化资讯。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>Quant最爱</author>
<guid isPermaLink="false">2020-04-12-129270921</guid>
<pubDate>Sun, 12 Apr 2020 00:00:00 +0800</pubDate>
</item>
<item>
<title>地球是个球体，那宇宙是个啥？</title>
<link>https://henix.github.io/feeds/zhuanlan.Lhtz-Jqxx/2020-04-10-128561279.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/128561279&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-7085122a71173221dbf0935e4f8dd35b_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;在我们的心目中，宇宙似乎永远存在。但是利用几何学，我们可以探索各种三维形状，为“普通”无限空间提供选择。公众号今天为大家带来一篇别具一格的文章！&lt;/p&gt;&lt;h2&gt;&lt;b&gt;1、前沿&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;当你凝视夜空时，空间似乎永远向四面八方延伸。那是我们对宇宙的心理模型，但这并不一定正确。毕竟，曾有一段时间，每个人都认为地球是平坦的，因为我们的星球的曲率太细微以至于无法探测到，而球形的地球却是深不可测的。&lt;/p&gt;&lt;p&gt;今天，我们知道地球的形状像一个球体。但是我们大多数人很少考虑宇宙的形状。正如球体提供了平坦地球的替代物一样，其他三维形状也提供了“普通”无限空间的替代物。&lt;/p&gt;&lt;p&gt;我们可以问两个关于宇宙形状的独立但相互关联的问题。一个是关于其几何形状：对诸如角度和面积之类的物体进行精细的局部测量。另一个关于他的拓扑结构：如何将这些局部片段缝合在一起形成一个总体形状。&lt;/p&gt;&lt;p&gt;宇宙学证据表明，我们所能看到的宇宙部分是平滑且同质的，至少大致如此。空间的局部结构在每一点和每一个方向上都大同小异。只有三种几何形状符合此描述：平面、球面和双曲。让我们探索这些几何形状，一些拓扑注意事项，以及宇宙学证据中关于哪些形状最能描述我们的宇宙。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;2、平面几何&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;这是我们在学校中学到的几何。三角形的角度加起来为180度，和一个圆的面积是πr^2。平面三维形状最简单的例子是普通的无限空间，数学家称之为欧几里得空间，但也可以考虑其他平面形状。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-8ef76854df69298b2ff84df17149ad4b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;606&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-8ef76854df69298b2ff84df17149ad4b_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-8ef76854df69298b2ff84df17149ad4b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;606&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-8ef76854df69298b2ff84df17149ad4b_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-8ef76854df69298b2ff84df17149ad4b_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;这些形状更难以可视化，但是我们可以通过二维而不是三维思考来建立一些直觉。除了普通的欧几里得平面之外，我们还可以通过切出一部分平面并将其边缘贴在一起来创建其他平面形状。例如，假设我们切出一张矩形纸，然后用胶带将其相对的边缘粘上。将顶部和底部边缘贴上胶带，我们就能得到一个圆柱体：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-ed304163e095d5e16bda397c5e9a4acf_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;723&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-ed304163e095d5e16bda397c5e9a4acf_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-ed304163e095d5e16bda397c5e9a4acf_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;723&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-ed304163e095d5e16bda397c5e9a4acf_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-ed304163e095d5e16bda397c5e9a4acf_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;接下来，我们可以用胶带把在左右两边粘起来，得到一个甜甜圈（数学家称之为环面）：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-d11d820717396c30ec58decb0cb1ad0d_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;631&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-d11d820717396c30ec58decb0cb1ad0d_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-d11d820717396c30ec58decb0cb1ad0d_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;631&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-d11d820717396c30ec58decb0cb1ad0d_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-d11d820717396c30ec58decb0cb1ad0d_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;现在，你可能会想：“在我看来这并不平坦。” 你是对的。如果你真的试图以此方式用一张纸制作一个圆环，那么你会遇到困难。制作圆柱体会很容易，但是用胶带贴住圆柱体的两端是行不通的：纸张会沿着圆环的内圆起皱，并且不会沿着外圆伸展得足够远。你将不得不使用一些可拉伸的材料来代替纸张。但是这种拉伸会扭曲长度和角度，从而改变几何形状。&lt;/p&gt;&lt;p&gt;在普通的三维空间内，无法在不扭曲平面几何形状的情况下，用平面材料构建一个真实、平滑的物理圆环。但是我们可以抽象地推断出生活在扁平圆环内是什么的感觉。&lt;/p&gt;&lt;p&gt;想象你是一个二维生物，其宇宙是一个扁平的圆环。由于该宇宙的几何形状来自一张平坦的纸，因此，我们习惯于使用的所有几何事实至少在小范围内与平常相同：三角形中的角度之和为180度，依此类推。但是，我们通过切割和缠绕对全局拓扑所做的更改意味着，生活在圆环中的体验将与我们过去的感觉大不相同。&lt;/p&gt;&lt;p&gt;对于初学者来说，圆环上有直线路径可以循环并返回到它们的起点：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-05d9a82d1049803e6d78331f7b5b1ed6_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;449&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-05d9a82d1049803e6d78331f7b5b1ed6_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-05d9a82d1049803e6d78331f7b5b1ed6_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;449&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-05d9a82d1049803e6d78331f7b5b1ed6_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-05d9a82d1049803e6d78331f7b5b1ed6_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;这些路径在扭曲的圆环上看起来是弯曲的，但是对于扁平圆环的居民而言，它们感觉是直的。而且由于光沿直线路径传播，因此如果你朝这些方向之一直视前方，你会从后面看到你自己：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-ee8727ce78d465fab81873ffeca02bea_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;746&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-ee8727ce78d465fab81873ffeca02bea_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-ee8727ce78d465fab81873ffeca02bea_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;746&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-ee8727ce78d465fab81873ffeca02bea_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-ee8727ce78d465fab81873ffeca02bea_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;在原纸上，你看到的光好像从你身后一直传到左手边，然后再次出现在右手边，就像你在玩一个环绕式电子游戏一样：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-8a5f93f0016c58bd05a4bbfb03b9b9f8_b.gif&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;638&quot; data-rawheight=&quot;220&quot; data-thumbnail=&quot;https://pic1.zhimg.com/v2-8a5f93f0016c58bd05a4bbfb03b9b9f8_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;638&quot; data-original=&quot;https://pic1.zhimg.com/v2-8a5f93f0016c58bd05a4bbfb03b9b9f8_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-8a5f93f0016c58bd05a4bbfb03b9b9f8_b.gif&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;638&quot; data-rawheight=&quot;220&quot; data-thumbnail=&quot;https://pic1.zhimg.com/v2-8a5f93f0016c58bd05a4bbfb03b9b9f8_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;638&quot; data-original=&quot;https://pic1.zhimg.com/v2-8a5f93f0016c58bd05a4bbfb03b9b9f8_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-8a5f93f0016c58bd05a4bbfb03b9b9f8_b.gif&quot;/&gt;&lt;/figure&gt;&lt;p&gt;考虑这种情况的一种等效方法是，如果你（或一束光）穿过四条边中的一条，你会出现在一个看似新的“房间”中，但实际上是同一个房间，只是从一个新的有利位置看。当你在这个宇宙中漫步时，你可以进入原始房间的无限副本中。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-4272f6a8ddd9440b827ba23c08a89cf1_b.gif&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;638&quot; data-rawheight=&quot;220&quot; data-thumbnail=&quot;https://pic2.zhimg.com/v2-4272f6a8ddd9440b827ba23c08a89cf1_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;638&quot; data-original=&quot;https://pic2.zhimg.com/v2-4272f6a8ddd9440b827ba23c08a89cf1_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-4272f6a8ddd9440b827ba23c08a89cf1_b.gif&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;638&quot; data-rawheight=&quot;220&quot; data-thumbnail=&quot;https://pic2.zhimg.com/v2-4272f6a8ddd9440b827ba23c08a89cf1_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;638&quot; data-original=&quot;https://pic2.zhimg.com/v2-4272f6a8ddd9440b827ba23c08a89cf1_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-4272f6a8ddd9440b827ba23c08a89cf1_b.gif&quot;/&gt;&lt;/figure&gt;&lt;p&gt;这意味着你也可以通过朝不同的方向看到无限多不同副本的自己。这是一种霍氏镜像效应，除了你的副本不是反射：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-eaa507ea31cf4fd518c80a0f2d077a70_b.gif&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;639&quot; data-rawheight=&quot;403&quot; data-thumbnail=&quot;https://pic1.zhimg.com/v2-eaa507ea31cf4fd518c80a0f2d077a70_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;639&quot; data-original=&quot;https://pic1.zhimg.com/v2-eaa507ea31cf4fd518c80a0f2d077a70_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-eaa507ea31cf4fd518c80a0f2d077a70_b.gif&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;639&quot; data-rawheight=&quot;403&quot; data-thumbnail=&quot;https://pic1.zhimg.com/v2-eaa507ea31cf4fd518c80a0f2d077a70_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;639&quot; data-original=&quot;https://pic1.zhimg.com/v2-eaa507ea31cf4fd518c80a0f2d077a70_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-eaa507ea31cf4fd518c80a0f2d077a70_b.gif&quot;/&gt;&lt;/figure&gt;&lt;p&gt;在甜甜圈上，这些对应于许多不同的环，光线可以通过这些环从你身上传播回来：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-96f2b7095025c78ee3c4da420a490021_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;638&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-96f2b7095025c78ee3c4da420a490021_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-96f2b7095025c78ee3c4da420a490021_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;638&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-96f2b7095025c78ee3c4da420a490021_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-96f2b7095025c78ee3c4da420a490021_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;同样，我们可以通过粘贴立方体或其他盒子的相对面来构建一个平坦的三维圆环。我们无法将这个空间可视化为普通无限空间内的一个对象，它根本不适合，但我们可以抽象地推断其中的生活。&lt;/p&gt;&lt;p&gt;就像二维圆环中的生活就像生活在一个由相同的矩形房间的无限二维阵列中一样，三维圆环中的生活就像生活在相同立方体房间中的无限三维阵列中一样。你将无限次看到自己的副本：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-071f2a7b2d714f39a7629ea64cb1ffb6_b.gif&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;640&quot; data-rawheight=&quot;411&quot; data-thumbnail=&quot;https://pic3.zhimg.com/v2-071f2a7b2d714f39a7629ea64cb1ffb6_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;640&quot; data-original=&quot;https://pic3.zhimg.com/v2-071f2a7b2d714f39a7629ea64cb1ffb6_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-071f2a7b2d714f39a7629ea64cb1ffb6_b.gif&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;640&quot; data-rawheight=&quot;411&quot; data-thumbnail=&quot;https://pic3.zhimg.com/v2-071f2a7b2d714f39a7629ea64cb1ffb6_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;640&quot; data-original=&quot;https://pic3.zhimg.com/v2-071f2a7b2d714f39a7629ea64cb1ffb6_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-071f2a7b2d714f39a7629ea64cb1ffb6_b.gif&quot;/&gt;&lt;/figure&gt;&lt;p&gt;三维圆环只是10个不同的平面有限世界中的一个。还有平坦的无限世界，例如无限圆柱体的三维模拟。在上述每个世界中，都有一个不同的镜像阵列供你体验。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;3、我们的宇宙是这些扁平形状之一吗？&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;当我们看向太空时，我们不会无限地看到自己的副本。即使这样，也很难排除这些扁平形状。一方面，它们都具有与欧几里德空间相同的局部几何形状，因此没有局部度量可以区分它们。&lt;/p&gt;&lt;p&gt;而且，如果你确实看到了自己的一个副本，那么那幅遥远的图像将显示你（或你的星系）在遥远的过去是什么样子的，因为光必须传播很长时间才能到达你。也许我们在那里看到自己无法识别的副本。更糟糕的是，你自己的不同副本通常距离你的距离不同，因此它们中的大多数看上去彼此不会相同。也许它们离我们都太遥远了，以至于我们都看不到。&lt;/p&gt;&lt;p&gt;为了绕过这些困难，天文学家通常不是在寻找自己的副本，而是在我们能看到的最远的地方重复这些特征：宇宙大爆炸后不久留下的宇宙微波背景（CMB）辐射。实际上，这意味着在CMB中搜索具有热点和冷点匹配模式的成对的圆，这表明从两个不同的方向看，它们实际上是同一个圆。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-16529e8b4cdeba2cabc34f594ba2ee35_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;495&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-16529e8b4cdeba2cabc34f594ba2ee35_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-16529e8b4cdeba2cabc34f594ba2ee35_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;495&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-16529e8b4cdeba2cabc34f594ba2ee35_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-16529e8b4cdeba2cabc34f594ba2ee35_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;2015年，天文学家使用普朗克太空望远镜的数据进行了这种搜索。他们对数据进行了梳理，寻找我们希望在一个平面三维圆环或另一个称为平板的平面三维形状中看到的匹配圆的种类，但是他们未能找到它们。这意味着如果我们确实生活在一个圆环中，那么它可能是如此之大，以至于任何重复的模式都超出了可观测的宇宙范围。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;4、球面几何&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;我们都熟悉二维球体——一个球或一个橙子或地球的表面。但是，我们的宇宙成为三维球体意味着什么呢？&lt;/p&gt;&lt;p&gt;很难可视化一个三维球体，但是通过简单的类比就可以很容易定义一个。就像二维球体是普通三维空间中距离某个中心点的固定距离的所有点的集合一样，三维球体（或“三球”）是四维空间中距离某个中心点固定距离的所有点的集合。&lt;/p&gt;&lt;p&gt;在三个球体中的生活与在平坦空间中的生活感觉非常不同。为了感受一下，想你您是一个生活在二维球体内的二维人。二维球体是整个宇宙，你无法看到或进入任何周围的三维空间。在这个球形的宇宙中，光沿着最短的路径传播：大圆。对你来说，这些大圆圈感觉像直线。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-610656949acb73a6cc61c6f59630d97f_b.gif&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;640&quot; data-rawheight=&quot;550&quot; data-thumbnail=&quot;https://pic4.zhimg.com/v2-610656949acb73a6cc61c6f59630d97f_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;640&quot; data-original=&quot;https://pic4.zhimg.com/v2-610656949acb73a6cc61c6f59630d97f_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-610656949acb73a6cc61c6f59630d97f_b.gif&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;640&quot; data-rawheight=&quot;550&quot; data-thumbnail=&quot;https://pic4.zhimg.com/v2-610656949acb73a6cc61c6f59630d97f_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;640&quot; data-original=&quot;https://pic4.zhimg.com/v2-610656949acb73a6cc61c6f59630d97f_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-610656949acb73a6cc61c6f59630d97f_b.gif&quot;/&gt;&lt;/figure&gt;&lt;p&gt;现在，想像你和你的二维朋友正在北极闲逛，而你的朋友去散散步。当你的朋友走开时，起初它们会在你的视觉圈中显得越来越小，就像在我们的普通世界中一样（尽管他们的收缩速度不会像我们习惯的那样快）。这是因为随着你的视觉圈子的扩大，你的朋友所占的比例会越来越小：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-75158aabf18fe6d04019b18c07f0bcd7_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;845&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-75158aabf18fe6d04019b18c07f0bcd7_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-75158aabf18fe6d04019b18c07f0bcd7_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;845&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-75158aabf18fe6d04019b18c07f0bcd7_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-75158aabf18fe6d04019b18c07f0bcd7_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;但是一旦你的朋友经过赤道，就会发生一些奇怪的事情：他们离你越远，他们看起来就越大。那是因为他们在你的视觉圈中所占的百分比正在增长：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-e6b36bf2f3c403602cf2c55e063e75c1_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;845&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-e6b36bf2f3c403602cf2c55e063e75c1_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-e6b36bf2f3c403602cf2c55e063e75c1_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;845&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-e6b36bf2f3c403602cf2c55e063e75c1_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-e6b36bf2f3c403602cf2c55e063e75c1_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;当你的朋友距南极10英尺时，他们看起来与离你10英尺时一样大：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-6b3415c5d6f7589f74189f1e2a9adb19_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;845&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-6b3415c5d6f7589f74189f1e2a9adb19_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-6b3415c5d6f7589f74189f1e2a9adb19_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;845&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-6b3415c5d6f7589f74189f1e2a9adb19_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-6b3415c5d6f7589f74189f1e2a9adb19_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;当他们到达南极时，你可以在各个方向看到他们，因此它们充满了你的整个视野：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-8a9216a3576fbf1d9f7d023812b1d5a2_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;949&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-8a9216a3576fbf1d9f7d023812b1d5a2_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-8a9216a3576fbf1d9f7d023812b1d5a2_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;949&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-8a9216a3576fbf1d9f7d023812b1d5a2_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-8a9216a3576fbf1d9f7d023812b1d5a2_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;如果没有人在南极，那么你的视觉地平线甚至会更加奇怪：你自己。那是因为从你身上散发出来的光会一直围绕球体，直到它回到你身边为止。&lt;/p&gt;&lt;p&gt;这直接延续到三维空间中的生活。三个球体上的每个点都有一个相反的点，如果那里有一个物体，我们会将其视为整个背景，就好像它是天空一样。如果那里什么也没有，我们将把自己当作背景，好像我们的外部已经被叠加在一个气球上，然后翻转过来并膨胀成整个地平线。&lt;/p&gt;&lt;p&gt;虽然三球体是球面几何的基本模型，但它不是唯一这样的空间。正如我们通过从欧几里得空间中切出一部分并将其粘合在一起来构建不同的平面空间一样，我们可以通过粘合三个球体的合适块来构建球面空间。这些粘贴形状中的每一个都会像圆环一样具有镜像效果，但是在这些球形形状中，只有有限的几个房间可以穿过。&lt;/p&gt;&lt;p&gt;&lt;b&gt;5、我们的宇宙是球面的吗？&lt;/b&gt;&lt;/p&gt;&lt;p&gt;即使是我们当中最自恋的人，也通常不会将自己视为整个夜空的背景。但是，就像扁平的圆环一样，仅仅因为我们没有看到一个现象，这并不意味着它就不存在。球形宇宙的周长可能大于可观测宇宙的大小，从而使背景看起来离得太远了。&lt;/p&gt;&lt;p&gt;但是与圆环不同，可以通过纯粹的局部测量来探测球形宇宙。球形与无限的欧几里得空间不仅在其全局拓扑结构上而且在其精细几何形状上都不同。例如，由于球面几何中的直线是大圆，所以三角形比其欧几里得对应物更膨胀，并且它们的角度加起来超过180度：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-4a886d05cd8376e15958b8afa66d8a0a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;868&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-4a886d05cd8376e15958b8afa66d8a0a_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-4a886d05cd8376e15958b8afa66d8a0a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;868&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-4a886d05cd8376e15958b8afa66d8a0a_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-4a886d05cd8376e15958b8afa66d8a0a_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;实际上，测量宇宙三角形是宇宙学家测试宇宙是否弯曲的主要方式。对于宇宙微波背景中的每个热点或冷点，已知其直径和与地球的距离，形成了三角形的三条边。我们可以测量星星在夜空中所成的角度——三角形的三个角度之一。然后，我们可以检查边长和角度测量值的组合是否适合于平面、球形或双曲线几何形状（其中三角形的角度之和小于180度）。&lt;/p&gt;&lt;p&gt;大多数此类测试以及其他曲率测量表明，宇宙要么是平坦的，要么非常接近平坦。然而，一个研究团队最近认为，普朗克太空望远镜2018年发布的某些数据指向的是一个球状宇宙，尽管其他研究人员已经反驳说，这一证据很可能是统计上的侥幸。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;6、双曲几何&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;与球体自身弯曲不同，双曲几何体向外打开。这是珊瑚礁和马鞍的几何形状。双曲几何的基本模型是一个无限广阔的空间，就像平面欧几里德空间一样。但是，因为双曲几何比平面几何向外扩展快得多，所以除非我们愿意扭曲其几何图形，否则就无法在普通的欧几里得空间中拟合一个二维双曲平面。例如，下面是一个被称为庞加莱圆盘的双曲平面的变形视图：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-9c552bb33c1b8e3e42b3be31b1284293_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;1080&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-9c552bb33c1b8e3e42b3be31b1284293_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-9c552bb33c1b8e3e42b3be31b1284293_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;1080&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-9c552bb33c1b8e3e42b3be31b1284293_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-9c552bb33c1b8e3e42b3be31b1284293_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;从我们的角度来看，边界圆附近的三角形看起来比中心附近的三角形小得多，但是从双曲几何的角度来看，所有三角形的大小都是相同的。如果我们真的尝试使三角形具有相同的大小，可能是通过使用弹性材料制作圆盘，然后从中心向外依次对每个三角形依次充气，我们的圆盘将开始像一顶软帽，并且随着我们向外展开，会越来越弯曲。当我们接近边界时，这种屈曲将失去控制。&lt;/p&gt;&lt;p&gt;从双曲几何的角度来看，边界圆距离任何内部点都无限远，因为你必须越过无限多个三角形才能到达那里。因此，双曲线平面向四面八方延伸到无穷远，就像欧几里德平面一样。但是就局部几何而言，双曲平面中的生活与我们习惯的生活大不相同。&lt;/p&gt;&lt;p&gt;在普通的欧几里得几何中，圆的周长与其半径成正比，但是在双曲几何中，圆的周长与半径成指数增长。我们可以在双曲线圆盘边界附近的三角形中看到指数堆积。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-f6d593306dd17f56e52f3b4712ad90c8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;841&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-f6d593306dd17f56e52f3b4712ad90c8_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-f6d593306dd17f56e52f3b4712ad90c8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;841&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-f6d593306dd17f56e52f3b4712ad90c8_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-f6d593306dd17f56e52f3b4712ad90c8_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;因为这个特征，数学家喜欢说在双曲空间中很容易迷路。如果你的朋友在普通的欧几里得空间中离开你，他们会开始看起来更小，但速度会变慢，因为你的视线圈并没有增长得那么快。但是在双曲线空间中，你的视觉圈呈指数级增长，因此你的朋友很快就会缩小到成指数级的小斑点。如果你没有仔细跟踪朋友的路线，以后几乎不可能找到通往他们的道路。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-8ef7e064082e9cdd1a934c763e6e8aa8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;419&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-8ef7e064082e9cdd1a934c763e6e8aa8_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-8ef7e064082e9cdd1a934c763e6e8aa8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;419&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-8ef7e064082e9cdd1a934c763e6e8aa8_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-8ef7e064082e9cdd1a934c763e6e8aa8_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;在双曲几何中，三角形的角度之和小于180度，例如，在我们的庞加莱圆盘的平铺中的三角形的角度之和等于165度：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-35b583529cc891dcb5b06be15beae2d7_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;841&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-35b583529cc891dcb5b06be15beae2d7_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-35b583529cc891dcb5b06be15beae2d7_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;841&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-35b583529cc891dcb5b06be15beae2d7_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-35b583529cc891dcb5b06be15beae2d7_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;这些三角形的边看起来不是笔直的，但这是因为我们正在通过变形的透镜查看双曲几何。对于庞加莱圆盘的居民而言，这些曲线是直线，因为从点A到达点B的最快方法是一条通向中心的捷径：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-f9aa444dfcdb659aba3812eacd2ab9a2_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;1080&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-f9aa444dfcdb659aba3812eacd2ab9a2_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-f9aa444dfcdb659aba3812eacd2ab9a2_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;1080&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-f9aa444dfcdb659aba3812eacd2ab9a2_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-f9aa444dfcdb659aba3812eacd2ab9a2_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;有一种自然的方法可以对庞加莱圆盘进行三维模拟，只需制作一个三维球，然后用三维的形状填充它，当它们接近边界球体时，这些形状变得越来越小，就像庞加莱圆盘中的三角形一样。就像平面几何和球面几何一样，我们可以通过切割出三维双曲球的合适块并将其面粘在一起来构成各种其他三维双曲空间。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;7、我们的宇宙是双曲的吗？&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;双曲几何具有狭窄的三角形和呈指数增长的圆，感觉不像是适合我们周围空间的几何形状。事实上，正如我们已经看到的那样，到目前为止，大多数宇宙学测量似乎都倾向于一个平坦的宇宙。&lt;/p&gt;&lt;p&gt;但是我们不能排除我们生活在球面或双曲世界中的可能性，因为这两个世界的小块看上去几乎都是平坦的。例如，球面几何中的小三角形的角度之和仅略大于180度，而双曲几何形状中的小三角形的角度之和仅略小于180度。&lt;/p&gt;&lt;p&gt;这就是为什么早期人们认为地球是平坦的，在他们能够观测到的尺度上，地球的曲率微小到无法探测到。球面或双曲形状越大，它的每个小块就越平坦，因此，如果我们的宇宙是一个非常大的球面或双曲形状，则我们可以观测到的部分可能非常接近于平坦，因此只能通过我们尚未发明的超精密仪器来探测其曲率。&lt;/p&gt;&lt;blockquote&gt;作者：Erica Klarreich、Lucy Reading-Ikkanda&lt;br/&gt;来自：Quanta Magazine&lt;br/&gt;编译：方的馒头&lt;/blockquote&gt;&lt;p&gt;量化投资与机器学习微信公众号，是业内垂直于&lt;b&gt;Quant、MFE、Fintech、AI、ML&lt;/b&gt;等领域的&lt;b&gt;量化类主流自媒体。&lt;/b&gt;公众号拥有来自&lt;b&gt;公募、私募、券商、期货、银行、保险资管、海外&lt;/b&gt;等众多圈内&lt;b&gt;18W+&lt;/b&gt;关注者。每日发布行业前沿研究成果和最新量化资讯。&lt;/p&gt;</description>
<author>Quant最爱</author>
<guid isPermaLink="false">2020-04-10-128561279</guid>
<pubDate>Fri, 10 Apr 2020 00:00:00 +0800</pubDate>
</item>
<item>
<title>瑞幸：就当是一场梦，醒来赶紧把券用！</title>
<link>https://henix.github.io/feeds/zhuanlan.Lhtz-Jqxx/2020-04-03-123969722.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/123969722&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-ef784eec5cc6741b73727714de0029f8_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;量化投资与机器学习编辑部独家&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-134243c3c5f9556a6c2fb1082fe2b0cc_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;589&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-134243c3c5f9556a6c2fb1082fe2b0cc_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-134243c3c5f9556a6c2fb1082fe2b0cc_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;589&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-134243c3c5f9556a6c2fb1082fe2b0cc_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-134243c3c5f9556a6c2fb1082fe2b0cc_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-ef0cc6e1a7c171960fc5bb92cca30f91_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;589&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-ef0cc6e1a7c171960fc5bb92cca30f91_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-ef0cc6e1a7c171960fc5bb92cca30f91_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;589&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-ef0cc6e1a7c171960fc5bb92cca30f91_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-ef0cc6e1a7c171960fc5bb92cca30f91_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-df11752839ae209cbf7ba8a57313b3cc_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;589&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-df11752839ae209cbf7ba8a57313b3cc_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-df11752839ae209cbf7ba8a57313b3cc_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;589&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-df11752839ae209cbf7ba8a57313b3cc_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-df11752839ae209cbf7ba8a57313b3cc_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-a18088fa9192a6e5cddb570b04bb858d_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;589&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-a18088fa9192a6e5cddb570b04bb858d_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-a18088fa9192a6e5cddb570b04bb858d_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;589&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-a18088fa9192a6e5cddb570b04bb858d_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-a18088fa9192a6e5cddb570b04bb858d_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-52cf93a81d0a584a5c9896ec4da3e0ce_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;589&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-52cf93a81d0a584a5c9896ec4da3e0ce_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-52cf93a81d0a584a5c9896ec4da3e0ce_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;589&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-52cf93a81d0a584a5c9896ec4da3e0ce_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-52cf93a81d0a584a5c9896ec4da3e0ce_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-a42133043ae103228af1c66fa22d85da_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;589&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-a42133043ae103228af1c66fa22d85da_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-a42133043ae103228af1c66fa22d85da_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;589&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-a42133043ae103228af1c66fa22d85da_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-a42133043ae103228af1c66fa22d85da_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-d0457e8d6a245fd70b33214d53a3c390_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;589&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-d0457e8d6a245fd70b33214d53a3c390_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-d0457e8d6a245fd70b33214d53a3c390_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;589&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-d0457e8d6a245fd70b33214d53a3c390_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-d0457e8d6a245fd70b33214d53a3c390_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-41cc76aa8c6896deb7c7216dd7a0db1f_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;589&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-41cc76aa8c6896deb7c7216dd7a0db1f_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-41cc76aa8c6896deb7c7216dd7a0db1f_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;589&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-41cc76aa8c6896deb7c7216dd7a0db1f_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-41cc76aa8c6896deb7c7216dd7a0db1f_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-0534016581103fcfa7dc086b424e89d9_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;589&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-0534016581103fcfa7dc086b424e89d9_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-0534016581103fcfa7dc086b424e89d9_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;589&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-0534016581103fcfa7dc086b424e89d9_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-0534016581103fcfa7dc086b424e89d9_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-1885cba2a547be4a6846523ccf4e742c_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;589&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-1885cba2a547be4a6846523ccf4e742c_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-1885cba2a547be4a6846523ccf4e742c_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;589&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-1885cba2a547be4a6846523ccf4e742c_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-1885cba2a547be4a6846523ccf4e742c_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-ad5916f46bbf12acbe866e77311d141b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;589&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-ad5916f46bbf12acbe866e77311d141b_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-ad5916f46bbf12acbe866e77311d141b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;589&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-ad5916f46bbf12acbe866e77311d141b_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-ad5916f46bbf12acbe866e77311d141b_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-a19150a2e96520c86210f09f133710cd_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;589&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-a19150a2e96520c86210f09f133710cd_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-a19150a2e96520c86210f09f133710cd_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;589&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-a19150a2e96520c86210f09f133710cd_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-a19150a2e96520c86210f09f133710cd_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-0eca015d2c24b3b287cb4d8236921d87_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;589&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-0eca015d2c24b3b287cb4d8236921d87_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-0eca015d2c24b3b287cb4d8236921d87_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;589&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-0eca015d2c24b3b287cb4d8236921d87_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-0eca015d2c24b3b287cb4d8236921d87_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-65e200686804125037675245151b6464_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;589&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-65e200686804125037675245151b6464_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-65e200686804125037675245151b6464_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;589&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-65e200686804125037675245151b6464_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-65e200686804125037675245151b6464_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-995c2436c5e222543a3fd488f0e85b24_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;589&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-995c2436c5e222543a3fd488f0e85b24_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-995c2436c5e222543a3fd488f0e85b24_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;589&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-995c2436c5e222543a3fd488f0e85b24_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-995c2436c5e222543a3fd488f0e85b24_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-c53ef6564e0c31c93414996ff1e5ca5b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;589&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-c53ef6564e0c31c93414996ff1e5ca5b_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-c53ef6564e0c31c93414996ff1e5ca5b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;589&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-c53ef6564e0c31c93414996ff1e5ca5b_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-c53ef6564e0c31c93414996ff1e5ca5b_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-77543bb30d78ce4385c2d3815d52a21f_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;589&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-77543bb30d78ce4385c2d3815d52a21f_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-77543bb30d78ce4385c2d3815d52a21f_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;589&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-77543bb30d78ce4385c2d3815d52a21f_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-77543bb30d78ce4385c2d3815d52a21f_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-fcd6a8b28d51a7f308818c25cf1c1ce6_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;589&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-fcd6a8b28d51a7f308818c25cf1c1ce6_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-fcd6a8b28d51a7f308818c25cf1c1ce6_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;589&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-fcd6a8b28d51a7f308818c25cf1c1ce6_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-fcd6a8b28d51a7f308818c25cf1c1ce6_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;资本市场的障眼法：&lt;/p&gt;&lt;p&gt;成功了我们叫：&lt;b&gt;资本运作（eg：神州）&lt;/b&gt;&lt;/p&gt;&lt;p&gt;卖给别人了我们叫：&lt;b&gt;功成身退（eg：摩拜）&lt;/b&gt;&lt;/p&gt;&lt;p&gt;砸了盘子我们叫：&lt;b&gt;骗子（eg：ofo）&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;那么，瑞幸应该叫什么呢？&lt;/b&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-22c3751c457007a63f6e8a3db8dd0ddc_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;589&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-22c3751c457007a63f6e8a3db8dd0ddc_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-22c3751c457007a63f6e8a3db8dd0ddc_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;589&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-22c3751c457007a63f6e8a3db8dd0ddc_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-22c3751c457007a63f6e8a3db8dd0ddc_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;预知后事如何，坐等瑞幸应对。&lt;/p&gt;&lt;p&gt;&lt;b&gt;2020，见证历史，刻骨铭心！&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;精选文章：&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653293436%26idx%3D1%26sn%3D10a9de897ee9e6d0b6712ce31b8fffe5%26chksm%3D802dc969b75a407f1877708aa4d743941f6b63b19c97b76a45f571d8287fc5fd848bfe9f0e50%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;1、算法交易，此篇足矣！&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653291745%26idx%3D1%26sn%3D860c56fb01d0a6277476b06a0db68148%26chksm%3D802dc6f4b75a4fe2e7e202bd278daa413b949e947dac5cfbcb82e9d25ca48e7f0443a899f1cf%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;2、Twitter上的情绪如何预测股价走势&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653293918%26idx%3D1%26sn%3D957c919a3f6446a0dee57b59380cbf17%26chksm%3D802dcf4bb75a465da5159e4a2ab6f4fa52c4ca2cb6f3f526f38c5996755c799254d994a5f7a6%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;3、一顿操作猛如虎，涨跌全看特朗普！&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653290080%26idx%3D1%26sn%3D06c50cefe78a7b24c64c4fdb9739c7f3%26chksm%3D802e3c75b759b563c01495d16a638a56ac7305fc324ee4917fd76c648f670b7f7276826bdaa8%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;4、利用深度学习最新前沿预测股价走势&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653295698%26idx%3D1%26sn%3D8962f70a639c81174400861bec2883de%26chksm%3D802dd647b75a5f517994a266985166ccacb63cac9f5589103d157ae699cdff9d37e4886671de%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;5、华尔街失守：23万交易员被机器人取代&lt;/a&gt;！&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653293065%26idx%3D1%26sn%3D45b6a1db897b5c5c928a2bd87076c5dc%26chksm%3D802dc81cb75a410a049cb6c5f7d1412ecb4ecfbaf46d390e41c5bf5d81add3d21839e2095c36%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;6、所有模型都是错的，但其中有些是有用的！&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653290456%26idx%3D1%26sn%3Db8d2d8febc599742e43ea48e3c249323%26chksm%3D802e3dcdb759b4db9279c689202101b6b154fb118a1c1be12b52e522e1a1d7944858dbd6637e%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;7、用新闻来预测股价走势，带你吊打Kaggle&lt;/a&gt;！&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653290588%26idx%3D1%26sn%3D1d0409ad212ea8627e5d5cedf61953ac%26chksm%3D802dc249b75a4b5fa245433320a4cc9da1a2cceb22df6fb1a28e5b94ff038319ae4e7ec6941f%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;8、严谨解决5种机器学习算法在预测股价的应用&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653293316%26idx%3D1%26sn%3D1828e486f53b70a21c04b94b020ed5c6%26chksm%3D802dc911b75a4007c02d27551ebdfe712dfc60f8dfb6caf2aa9b6244d5f494741a8923413d6a%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;9、2019最新西蒙斯访谈：量化策略、职业与交易&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653295958%26idx%3D1%26sn%3D16a90ff07a8c0d7b2abb1bc5cedc01d4%26chksm%3D802dd743b75a5e557cef55b30a9ea233ee69b2ab0cb85f92bcede3d2e31d880ee27e47789b69%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;10、2020全美MFE权威鄙视链出炉：Quant何去何从？&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653295002%26idx%3D1%26sn%3Dce0ec3c2e22e7bd2dd297199225d500a%26chksm%3D802dd38fb75a5a9937a454e9f9d568a19626f62fcc9a820e9f737a143d1c5d0869426bb13e62%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;11、TensorTrade：基于深度强化学习的Python交易框架&lt;/a&gt;&lt;/p&gt;&lt;p&gt;量化投资与机器学习微信公众号，是业内垂直于&lt;b&gt;Quant、MFE、Fintech、AI、ML&lt;/b&gt;等领域的&lt;b&gt;量化类主流自媒体。&lt;/b&gt;公众号拥有来自&lt;b&gt;公募、私募、券商、期货、银行、保险资管、海外&lt;/b&gt;等众多圈内&lt;b&gt;18W+&lt;/b&gt;关注者。每日发布行业前沿研究成果和最新量化资讯。&lt;/p&gt;</description>
<author>Quant最爱</author>
<guid isPermaLink="false">2020-04-03-123969722</guid>
<pubDate>Fri, 03 Apr 2020 00:00:00 +0800</pubDate>
</item>
<item>
<title>波动率预测：基于CNN的图像识别策略</title>
<link>https://henix.github.io/feeds/zhuanlan.Lhtz-Jqxx/2020-04-02-123318254.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/123318254&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-61810b52280cf0c7255baa055ee5cc38_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;作者：Chuan Bai   编译：1+1=6&lt;/p&gt;&lt;h2&gt;&lt;b&gt;1、前言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;金融市场主要处理时间序列方面的问题，围绕时间序列预测有大量的算法和工具。 今天，我们使用CNN来基于回归进行预测，并与其他一些传统算法进行比较，看看效果如何。&lt;/p&gt;&lt;p&gt;我们这里关注的是&lt;b&gt;市场波动率&lt;/b&gt;，具体来说，就是&lt;b&gt;股市开盘前后的波动率。&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;2、问题&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;我们觉得，开盘前的波动率（vol）可能是一个很好的指标。如果我们能够准确地预测波动率，我们就可以利用它做些事情。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;3、数据准备&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;2016年1月至2020年3月富时100指数合约数据。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-12ddad9a016783838f04bc82b0ce21b0_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;224&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-12ddad9a016783838f04bc82b0ce21b0_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-12ddad9a016783838f04bc82b0ce21b0_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;224&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-12ddad9a016783838f04bc82b0ce21b0_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-12ddad9a016783838f04bc82b0ce21b0_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;可视化：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-b096cf9ee0042a77ca295264be2ba053_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;312&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-b096cf9ee0042a77ca295264be2ba053_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-b096cf9ee0042a77ca295264be2ba053_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;312&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-b096cf9ee0042a77ca295264be2ba053_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-b096cf9ee0042a77ca295264be2ba053_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;我们感兴趣的数据是价格的波动率，本质上就是价格的标准差。我们构造的波动性指标是：用最高价减去最低价（分钟bar），同时应用一个大小为N的移动平均窗口。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-41d80b0ec373bb7560e8dfa3247d0f5c_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;410&quot; data-rawheight=&quot;127&quot; class=&quot;content_image&quot; width=&quot;410&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-41d80b0ec373bb7560e8dfa3247d0f5c_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;410&quot; data-rawheight=&quot;127&quot; class=&quot;content_image lazy&quot; width=&quot;410&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-41d80b0ec373bb7560e8dfa3247d0f5c_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;原则上，当价格大幅波动时，波动率应该变大，为了测试这一点，我们随机选择一个交易日，然后根据当天的vol和价格来确认这一点。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-b29a001b54d3b3db742470a8230fcbfd_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;613&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-b29a001b54d3b3db742470a8230fcbfd_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-b29a001b54d3b3db742470a8230fcbfd_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;613&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-b29a001b54d3b3db742470a8230fcbfd_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-b29a001b54d3b3db742470a8230fcbfd_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;为了比较所有交易日的波动率，我们绘制了基于时序的波动率。波动率是根据5分钟的时间窗口计算的。每个点代表最后5分钟的体积，在1070天内每分钟计算一次。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-3021fe550fece20d5aa606db12002884_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;316&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-3021fe550fece20d5aa606db12002884_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-3021fe550fece20d5aa606db12002884_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;316&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-3021fe550fece20d5aa606db12002884_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-3021fe550fece20d5aa606db12002884_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;可以看到，这些峰值似乎在一小时内重复出现，例如在0000和0100、0700和0800处出现峰值。让我们来画出热力图来检查这些值。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-1fe8c39843d838f246c414ab6f77ae3d_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;1103&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-1fe8c39843d838f246c414ab6f77ae3d_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-1fe8c39843d838f246c414ab6f77ae3d_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;1103&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-1fe8c39843d838f246c414ab6f77ae3d_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-1fe8c39843d838f246c414ab6f77ae3d_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;我们可以看到时间是Daylight Saving Time（夏令时），所以需要将夏令时调整为GMT（格林尼治标准时间），如下所示：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-99d7c4277b8d970f99f65bb2768482aa_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;1099&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-99d7c4277b8d970f99f65bb2768482aa_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-99d7c4277b8d970f99f65bb2768482aa_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;1099&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-99d7c4277b8d970f99f65bb2768482aa_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-99d7c4277b8d970f99f65bb2768482aa_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;在某些时期，波动率很大。贯穿热力图的实线表明，在某些时间，波动性持续较高，这些都是合理的。&lt;/p&gt;&lt;ul&gt;&lt;li&gt;0100：CFD开始进行交易&lt;/li&gt;&lt;li&gt;0700：欧盟股市盘前&lt;/li&gt;&lt;li&gt;0800：英国股市开盘&lt;/li&gt;&lt;li&gt;1200：中午&lt;/li&gt;&lt;li&gt;1430：美国股市开盘&lt;/li&gt;&lt;li&gt;1630：英国股市收盘&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;我们还可以看到，在2020年3月的几天里，波动率很高。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-3b23121529695c10abeefa9371653daa_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;311&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-3b23121529695c10abeefa9371653daa_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-3b23121529695c10abeefa9371653daa_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;311&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-3b23121529695c10abeefa9371653daa_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-3b23121529695c10abeefa9371653daa_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;如果我们想要利用波动率，它应该越高越好，那么最高的时间应该是股市开盘的时候，即0800。如果我们可以用开盘前一小时的波动率来预测开盘后5分钟的波动率（通常这一时间段是一天中波动率最大的时候），那么我们可以围绕这个时间段去进行交易。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-a44caeb9a78c8a25bf669308060df131_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;347&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-a44caeb9a78c8a25bf669308060df131_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-a44caeb9a78c8a25bf669308060df131_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;347&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-a44caeb9a78c8a25bf669308060df131_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-a44caeb9a78c8a25bf669308060df131_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;上图显示了2016年至2020年期间所有交易日的总波动率。我们可以看到，波动率往往在0800点市场开盘后立即回升，几分钟后回落。&lt;/p&gt;&lt;p&gt;我们假设开盘前和开盘后的波动率之间存在相关性。因此，如果我们在开盘前1小时和开盘后5分钟分别画出波动率的平均值，它们应该总体上会有一个上升趋势，确实如此：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-707bad35b6d734b183d6cbae4f1a2f08_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;367&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-707bad35b6d734b183d6cbae4f1a2f08_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-707bad35b6d734b183d6cbae4f1a2f08_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;367&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-707bad35b6d734b183d6cbae4f1a2f08_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-707bad35b6d734b183d6cbae4f1a2f08_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;x轴是开盘前1小时的平均波动率，y轴是开盘后5分钟的平均波动率。两者虽有相关性，但它们之间存在很多变量，因此不是一个可靠的预测因子。例如，根据这个图表，如果开盘前的平均波动率为7.5，我们有理由假设市场开盘后的波动率在5到25之间，这没啥帮助。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;4、进一步讨论&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;我们基本上对开盘前和开盘后的波动率做了线性回归分析。接下来我们加入一些稍微复杂的算法。将1070个样本分为三组：训练、验证和测试。&lt;/p&gt;&lt;ul&gt;&lt;li&gt;训练：0-699（截止2018-10-09）&lt;/li&gt;&lt;li&gt;验证：700-899（截止2019-07-25）&lt;/li&gt;&lt;li&gt;测试：900-1070（截止2020-03-25）&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;▌方法1：线性回归&lt;/b&gt;&lt;/p&gt;&lt;p&gt;由于数据有分组，所以线性回归的统计数据与使用完整数据集生成的统计数据略有不同。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-6c082288e73903a06b216cb23d05929a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;747&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-6c082288e73903a06b216cb23d05929a_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-6c082288e73903a06b216cb23d05929a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;747&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-6c082288e73903a06b216cb23d05929a_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-6c082288e73903a06b216cb23d05929a_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;从上面的图我们可以看出，&lt;b&gt;相关性仍然很强，但可决系数很低&lt;/b&gt;，我们不能用这个方法来解释开盘后的波动率变化。&lt;/p&gt;&lt;p&gt;改进预测的方法之一是增加特征的数量，这就导致了多变量（元）回归。在这种情况下，我们可以利用开盘前一小时的分钟（1min）来预测开盘后的波动率：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-71ead6f5907f8f6c31fbd9d44fb7dc4a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;774&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-71ead6f5907f8f6c31fbd9d44fb7dc4a_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-71ead6f5907f8f6c31fbd9d44fb7dc4a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;774&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-71ead6f5907f8f6c31fbd9d44fb7dc4a_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-71ead6f5907f8f6c31fbd9d44fb7dc4a_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;统计数据上整体有所改善，但仍然不行，这里所有的线性回归都使用statsmodel库中的OLS。&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;statsmodels.api&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sm&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;lingres&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;X_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;900&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;900&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;X&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;700&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;700&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;OLS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;predictions&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plot_out&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;predictions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;title&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39; Train&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;predictions&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plot_out&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;predictions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;title&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39; Test&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;▌方法2：梯度提升法&lt;/b&gt;&lt;/p&gt;&lt;p&gt;在进行预测特别是分类时，梯度增强是标准的方法，它将为我们提供一个非常好的基准，以便后面做进一步改进。&lt;/p&gt;&lt;p&gt;&lt;b&gt;这里我们使用LightGBM&lt;/b&gt;，输入到模型中的特征本质上与多元回归相同。&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;lightgbm&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LGBMRegressor&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.model_selection&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cross_validate&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;regr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LGBMRegressor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;scores&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cross_validate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;regr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cv&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;scoring&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;neg_mean_squared_error&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;r2&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;scores&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#{&amp;#39;fit_time&amp;#39;: array([0.242456, 0.243822, 0.285033, 0.266963, 0.213427]),&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# &amp;#39;score_time&amp;#39;: array([0.003387, 0.003706, 0.004177, 0.003168, 0.003078]),&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# &amp;#39;test_neg_mean_squared_error&amp;#39;: array([ -3.989691, -1.751312, -1.646064, -2.936831, -11.072056]),&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# &amp;#39;test_r2&amp;#39;: array([0.473771, 0.327672, 0.443433, 0.042896, 0.609157])}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;通过5种不同的交叉验证评估，该模型在我们数据样本的不同切面上表现不是很稳定，这表明在我们的数据在不同部分存在某种不平衡的离群样本。尽管当我们更深入地研究预测过程时，这可能是一个问题，但就本文而言，只要我们有相同的训练、验证和测试集，我们就不需要过多担心，因为这是我们的第一次尝试。&lt;/p&gt;&lt;p&gt;如前所述，我们需要在不同的方法中保持样本的一致性，因此我们只训练前700个样本，并预测样本900+个样本 。&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;train_index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;700&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;test_index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;900&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1070&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;regr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;y_hat&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;regr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;y_train_hat&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;regr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;训练集和测试集结果：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-3bc869864f3ea0baeb4ae94f7c764711_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;763&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-3bc869864f3ea0baeb4ae94f7c764711_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-3bc869864f3ea0baeb4ae94f7c764711_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;763&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-3bc869864f3ea0baeb4ae94f7c764711_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-3bc869864f3ea0baeb4ae94f7c764711_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;训练结果比方法1好，R方为0.94，但测试集的预测失败了。虽然它在测试集中表现不是很好，但仍然比我们使用纯线性回归所做的预测要好。&lt;/p&gt;&lt;p&gt;&lt;b&gt;▌方法3：MLP（神经网络）&lt;/b&gt;&lt;/p&gt;&lt;p&gt;当我们在预测中有如此大的方差时，神经网络可能能够描述输入特征之间的复杂关系，并发现它们之间的隐藏关系。&lt;/p&gt;&lt;p&gt;&lt;b&gt;我们使用FastAI作为深度学习库来构建底层网络，目前FastAI是建立在PyTorch之上的&lt;/b&gt;。大家可以描述自定义的PyTorch模型并将其传递到FastAI以获得FastAI提供的训练工具。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-03170ed2029c2cb7114bc2b32054866c_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;571&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-03170ed2029c2cb7114bc2b32054866c_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-03170ed2029c2cb7114bc2b32054866c_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;571&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-03170ed2029c2cb7114bc2b32054866c_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-03170ed2029c2cb7114bc2b32054866c_b.jpg&quot;/&gt;&lt;figcaption&gt;https://www.fast.ai/&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;我们使用与LightGBM相同的输入和输出集，并将数据输入到2个隐层的MLP网络中，每个隐层有300个神经元。&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;fastai.tabular&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;dep_var&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;target&amp;#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dep_var&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;mlp_df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;concat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;procs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Normalize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TabularDataBunch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;from_df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;.&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mlp_df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;900&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dep_var&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;valid_idx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;700&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;900&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;procs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;procs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;learn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tabular_learner&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;300&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;300&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loss_func&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;metrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r2_score&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;explained_variance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;learn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lr_find&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;start_lr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1e-6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_it&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;end_lr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1e-1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;learn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recorder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;learn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit_one_cycle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;slice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;3e-4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;wd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;经过几次迭代训练，我们可以得到类似这样的预测结果。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-c9fe8d5aaaa1c3e5e1c402b143ec8390_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;366&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-c9fe8d5aaaa1c3e5e1c402b143ec8390_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-c9fe8d5aaaa1c3e5e1c402b143ec8390_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;366&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-c9fe8d5aaaa1c3e5e1c402b143ec8390_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-c9fe8d5aaaa1c3e5e1c402b143ec8390_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-680a5c286e909f659284d30122b03608_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;369&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-680a5c286e909f659284d30122b03608_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-680a5c286e909f659284d30122b03608_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;369&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-680a5c286e909f659284d30122b03608_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-680a5c286e909f659284d30122b03608_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-9d3b9c7a23392e33c8166b5d69369c74_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;374&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-9d3b9c7a23392e33c8166b5d69369c74_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-9d3b9c7a23392e33c8166b5d69369c74_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;374&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-9d3b9c7a23392e33c8166b5d69369c74_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-9d3b9c7a23392e33c8166b5d69369c74_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;我们可以看到，由于最近市场的波动，测试集中的波动率最高，因此验证数据集对我们的测试数据不具有代表性。然而，与之前的方法相比，在统计数据方面表现较好。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;5、基于图像识别的回归分析&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;在基于图像的回归之前，我们的目标参数需要做一点修改，因为在转换过程中我们会丢失数值。因为在转换成图像之前，每个时间窗口内的值都被归一化了。&lt;/p&gt;&lt;p&gt;为了弥补这一缺陷， 我们用开盘前后的平均价格比作为我们的目标。通过这种方式，我们向神经网络提出了一个问题：与盘前波动率相比，开盘后的波动率会有多大？例如，如果开盘前的平均波动率是10，而开盘后的波动率是50，我们的目标是预测5而不是原始的50。&lt;/p&gt;&lt;p&gt;为了防避免这种问题的发生，我们训练了一个MLP网络，其与前面的方法具有相同的结构、相同的数据。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-0780871831af437b2fbde0a92ad8d8bc_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;372&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-0780871831af437b2fbde0a92ad8d8bc_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-0780871831af437b2fbde0a92ad8d8bc_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;372&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-0780871831af437b2fbde0a92ad8d8bc_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-0780871831af437b2fbde0a92ad8d8bc_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-3a17b7500cb191227a4bc8961cfef3cb_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;370&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-3a17b7500cb191227a4bc8961cfef3cb_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-3a17b7500cb191227a4bc8961cfef3cb_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;370&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-3a17b7500cb191227a4bc8961cfef3cb_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-3a17b7500cb191227a4bc8961cfef3cb_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-ccc8e54def9a15c5ddef27f5b42665db_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;370&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-ccc8e54def9a15c5ddef27f5b42665db_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-ccc8e54def9a15c5ddef27f5b42665db_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;370&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-ccc8e54def9a15c5ddef27f5b42665db_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-ccc8e54def9a15c5ddef27f5b42665db_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;注：由于在除法计算后出现了巨大的峰值，所以波动率上限为30，如下所示：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-a06fd19fa38e277e783d8af0e3f54ed7_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;351&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-a06fd19fa38e277e783d8af0e3f54ed7_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-a06fd19fa38e277e783d8af0e3f54ed7_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;351&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-a06fd19fa38e277e783d8af0e3f54ed7_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-a06fd19fa38e277e783d8af0e3f54ed7_b.jpg&quot;/&gt;&lt;figcaption&gt;Raw vol_after / vol_before&lt;/figcaption&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-d51ae875e296c61a2f6ee1920cb629f8_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;346&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-d51ae875e296c61a2f6ee1920cb629f8_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-d51ae875e296c61a2f6ee1920cb629f8_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;346&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-d51ae875e296c61a2f6ee1920cb629f8_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-d51ae875e296c61a2f6ee1920cb629f8_b.jpg&quot;/&gt;&lt;figcaption&gt;Capped@30 vol_after / vol_before&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;与原始值的预测相比，MLP的间接预测结果略差，但差别不大。现在我们有了CNN网络可以比较的基准。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;6、图像转换&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;借助Gramian Angular Field和pyts库的帮助下，我们现在可以根据点之间的极坐标关系将任何时间序列转换成图像。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-711894e303f99efbbf9035cc4865acbd_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;825&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-711894e303f99efbbf9035cc4865acbd_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-711894e303f99efbbf9035cc4865acbd_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;825&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-711894e303f99efbbf9035cc4865acbd_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-711894e303f99efbbf9035cc4865acbd_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//arxiv.org/pdf/1506.00327.pdf&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;arxiv.org/pdf/1506.0032&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;7.pdf&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/p&gt;&lt;p&gt;在下面的代码中，其每天创建一个图像，每个图像描述开盘前60分钟的波动率。&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyts.image&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;GramianAngularField&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;multiprocessing&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Pool&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cpu_count&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;gadf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;GramianAngularField&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;method&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;difference&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X_gadf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gadf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit_transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;convert_img&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;fig&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;subplot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;111&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;fname&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;imgs/{idx}.png&amp;#39;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exists&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;except&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;imshow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_gadf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cmap&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;rainbow&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;origin&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;lower&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_xticks&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([])&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_yticks&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([])&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;fig&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;savefig&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bbox_inches&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;tight&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Pool&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cpu_count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;convert_img&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1070&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;对于CNN网络来说，它本质上是使用ResNET34作为底层，然后在顶部加上一个[1024,512]稠密层，并使用一个简单的线性激活节点执行最终的回归。&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ImageList&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;from_csv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;imgs&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;labels.csv&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                 &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split_by_idxs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;700&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)),&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;700&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;900&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
                 &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;label_from_df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
                 &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;databunch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;learner&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cnn_learner&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;models&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;resnet34&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loss_func&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mae&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;metrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r2_score&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;learner&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Sequential(&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# (0): AdaptiveConcatPool2d(&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# (ap): AdaptiveAvgPool2d(output_size=1)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# (mp): AdaptiveMaxPool2d(output_size=1)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# )&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# (1): Flatten()&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# (2): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# (3): Dropout(p=0.25, inplace=False)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# (4): Linear(in_features=1024, out_features=512, bias=True)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# (5): ReLU(inplace=True)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# (6): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# (7): Dropout(p=0.5, inplace=False)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# (8): Linear(in_features=512, out_features=1, bias=True)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# )&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;经过反复的训练，我们得到了这样的结果：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-4246f96527a1ea0a1ff5088e2f00f571_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;765&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-4246f96527a1ea0a1ff5088e2f00f571_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-4246f96527a1ea0a1ff5088e2f00f571_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;765&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-4246f96527a1ea0a1ff5088e2f00f571_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-4246f96527a1ea0a1ff5088e2f00f571_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-8f6ec54272e601a74543da99601f9150_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;378&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-8f6ec54272e601a74543da99601f9150_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-8f6ec54272e601a74543da99601f9150_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;378&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-8f6ec54272e601a74543da99601f9150_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-8f6ec54272e601a74543da99601f9150_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;我们可以看到，即使预测相同的目标，基于图像的回归也比MLP对应的回归表现得好得多。&lt;/p&gt;&lt;p&gt;不通方法的比较：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-e4da7eb1ac075532745b7f86247438c5_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1053&quot; data-rawheight=&quot;354&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1053&quot; data-original=&quot;https://pic2.zhimg.com/v2-e4da7eb1ac075532745b7f86247438c5_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-e4da7eb1ac075532745b7f86247438c5_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1053&quot; data-rawheight=&quot;354&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1053&quot; data-original=&quot;https://pic2.zhimg.com/v2-e4da7eb1ac075532745b7f86247438c5_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-e4da7eb1ac075532745b7f86247438c5_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;我们可以看到，MLP在预测绝对波动率值时的表现优于其他所有方法，而CNN在预测相对波动率时在各个方面都优于同一网络。&lt;/p&gt;&lt;p&gt;&lt;b&gt;因此，在进行时间序列预测时，CNN是一个很好的选择，尽管它确实需要大量的计算能力来进行图像转换和训练。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;量化投资与机器学习微信公众号，是业内垂直于&lt;b&gt;Quant、MFE、Fintech、AI、ML&lt;/b&gt;等领域的&lt;b&gt;量化类主流自媒体。&lt;/b&gt;公众号拥有来自&lt;b&gt;公募、私募、券商、期货、银行、保险资管、海外&lt;/b&gt;等众多圈内&lt;b&gt;18W+&lt;/b&gt;关注者。每日发布行业前沿研究成果和最新量化资讯。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>Quant最爱</author>
<guid isPermaLink="false">2020-04-02-123318254</guid>
<pubDate>Thu, 02 Apr 2020 00:00:00 +0800</pubDate>
</item>
<item>
<title>人人都是「砖」家：from sklearn import *</title>
<link>https://henix.github.io/feeds/zhuanlan.Lhtz-Jqxx/2020-04-01-122364181.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/122364181&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-edb8416cb5994e5a4863ee03eb621211_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;作者：Lazarou   编译：1+1=6&lt;/p&gt;&lt;h2&gt;&lt;b&gt;前言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;今天是4月1日，我们来聊聊所谓的机器学习、数据科学专家！&lt;/p&gt;&lt;p&gt;现今，似乎稍微学点数据科学的人都称自己是数据科学家。有些人几乎没有或根本没有实践经验，甚至连理论基础都没有。这篇文章不是在说那些认真努力自学和有抱负的数据科学的人。事实上，我们认为这个领域尤其适合这样一群充满热情的人，&lt;b&gt;我们今天diss的是那些上了一门网络课程，然后把自己塑造成专家的人！&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;1、不在乎数据探索&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;数据探索是任何机器学习项目的第一步。如果你不花时间去熟悉自己的数据，并充分了解它的特点，那么你就会浪费大量时间。&lt;/p&gt;&lt;p&gt;&lt;b&gt;1.1 未将数据可视化&lt;/b&gt;&lt;/p&gt;&lt;p&gt;探索性数据可视化是启动任何数据相关项目的最佳选择。如果你正在应用机器学习，很可能你正在处理大量的高维数据，查看Excel文件或运行一个df.describe()并不是合适的数据可视化替代方法。Francis Anscombe用他著名的四张图来说明数据可视化的重要性：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-72be654f3c5af4f10ebd84a2c8fa1307_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;766&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-72be654f3c5af4f10ebd84a2c8fa1307_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-72be654f3c5af4f10ebd84a2c8fa1307_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;766&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-72be654f3c5af4f10ebd84a2c8fa1307_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-72be654f3c5af4f10ebd84a2c8fa1307_b.jpg&quot;/&gt;&lt;figcaption&gt;Anscombe’s Quartet&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;每个面板中的数据集都具有本质上相同的统计信息：x和y的均值、x和y的样本方差、相关系数、R方和最佳拟合线都几乎相同。如果你不能将你的数据可视化却依赖于统计数据，你可能会认为这四个数据集具有相同的分布，但粗略地看一下就会发现情况显然并非如此。&lt;/p&gt;&lt;p&gt;数据可视化允许你识别数据中的趋势、异常值和分布；如果你跳过这一步，后面的分析等于白做。&lt;/p&gt;&lt;p&gt;&lt;b&gt;1.2 没有清理数据&lt;/b&gt;&lt;/p&gt;&lt;p&gt;在将模型投入生产之前解决这个问题是非常关键的。记住：&lt;/p&gt;&lt;p&gt;&lt;b&gt;垃圾进⇒垃圾出&lt;/b&gt;&lt;/p&gt;&lt;p&gt;举个例子，人体身高的直方图：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-400033f7a1bc983efdbbcffba671d015_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;561&quot; data-rawheight=&quot;417&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;561&quot; data-original=&quot;https://pic2.zhimg.com/v2-400033f7a1bc983efdbbcffba671d015_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-400033f7a1bc983efdbbcffba671d015_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;561&quot; data-rawheight=&quot;417&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;561&quot; data-original=&quot;https://pic2.zhimg.com/v2-400033f7a1bc983efdbbcffba671d015_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-400033f7a1bc983efdbbcffba671d015_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;用这些数据训练一个模型无疑会导致糟糕的结果。但是，通过检查数据，我们发现这100个异常值的高度实际上是以米而不是厘米为单位输入的。所以，可以通过将这些值乘以100来进行修正。正确地清理数据不仅可以防止对错误数据进行训练，而且在本例中，我们还可以挽救100个数据点，否则这些数据点可能会被丢弃。&lt;/p&gt;&lt;p&gt;&lt;b&gt;1.3 不需要为特性选择、特性工程而烦恼&lt;/b&gt;&lt;/p&gt;&lt;p&gt;神经网络不好的地方是：你可以把所有原始数据扔给它，它会学到一些目标函数的近似值。这的确很方便，但效率低下且易错。最糟糕的是，&lt;b&gt;它让初学数据科学的人依赖于深度学习，而通常情况下，传统的机器学习方法可能更合适&lt;/b&gt;。这会让他们慢慢地陷入一种不确定的状态，没有正确的方法来进行特性选择和工程，但是有几个关键的结果需要努力实现：&lt;/p&gt;&lt;p&gt;&lt;b&gt;降维：&lt;/b&gt;数据多并不总是件好事。通常，你希望在拟合模型之前减少特征的数量。这通常涉及删除不相关和冗余的数据，或者将多个相关字段合并到一个字段中。&lt;/p&gt;&lt;h3&gt;&lt;b&gt;格式化输出数据：&lt;/b&gt;你需要将数据转换成模型容易理解的格式：类似于 -1和1之间的数字的神经网络；分类数据应该是一个One-Hot Encoding；序数数据（可能）不应该表示为单个浮点字段；对指数分布的数据进行转换可能是有益的。&lt;/h3&gt;&lt;p&gt;&lt;b&gt;创建特定领域的特征：&lt;/b&gt;根据数据创建自己的特征通常是很有成效的。如果你有计数数据，可能希望将其转换为相关的二进制阈值字段，例如“≥100”vs“&amp;lt;100”，或“is 0”vs“is not 0”。如果你有连续数据x和z，你可能想要包括字段x²、xz和z²与x和z的特征集。这是一个高度依赖于问题的操作过程，但如果处理得当可以大大改善一些模型性能。&lt;br/&gt;&lt;/p&gt;&lt;p&gt;大多数外行人认为：&lt;/p&gt;&lt;p&gt;&lt;b&gt;机器学习就是从原始数据中神奇地得出结果的黑匣子！&lt;/b&gt;&lt;/p&gt;&lt;p&gt;请不要助长这种误解。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;2、没有选择合适的模型&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;机器学习是一个有着丰富历史的学科领域，在这段历史的大部分时间里，它其实被称为&lt;b&gt;统计学习&lt;/b&gt;。随着易于使用的开源机器学习工具（如Scikit-Learn和TensorFlow）的出现，再加上我们现在收集海量数据的便捷性和无处不在的高性能计算机，尝试不同的机器学习模型从未像现在这样容易。然而，除去那些机器学习从业者的工作需求，大多数机器学习从业者不了解不同类型的模型如何工作，这并不是一个巧合。&lt;/p&gt;&lt;p&gt;有抱负的数据科学家在Github上发布的简历中充斥着Kaggle项目和在线课程学习经历，它们看起来像是这样：&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SGDClassifier&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LogisticRegression&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;KNeighborsClassifier&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
             &lt;span class=&quot;n&quot;&gt;KMeans&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;KNeighborsClassifier&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RandomForestClassifier&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;overfit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;你根本不知道自己做什么！&lt;/p&gt;&lt;p&gt;这是在浪费时间，并且很容易导致不合适的模型被选择，因为它们恰好在验证数据上表现得很好。所使用的模型类型应该基于底层数据和应用程序的需求来选择，并且应该设计数据来匹配所选择的模型。&lt;b&gt;选择模型类型是数据科学过程中的一个重要部分&lt;/b&gt;，可能需要对少数几个合适的模型进行直接比较，但是为了找到所谓的“最优结果”而盲目应用所有工具是一个十分危险的信号。特别地，这掩盖了一个根本问题，那就是：&lt;/p&gt;&lt;p&gt;&lt;b&gt;你实际上并不了解不同类型的模型是如何工作的！&lt;/b&gt;&lt;/p&gt;&lt;p&gt;说白了就是&lt;b&gt;知其然，也要知其所以然！&lt;/b&gt;&lt;/p&gt;&lt;p&gt;这里面更重要的问题不是人们不知道不同的机器学习模型是如何工作的，而是他们不在乎，不关心，同时也对基本的数学毫无兴趣。&lt;b&gt;如果你喜欢机器学习但不喜欢数学，那么你可能并不是真的喜欢机器学习，而是喜欢你感兴趣的那部分&lt;/b&gt;。如果你不关心模型是如何工作的或者是否适合数据，那么当它们不可避免地出错时，你就没有能力对这些问题进行检查与排除。&lt;/p&gt;&lt;p&gt;&lt;b&gt;你不知道你是想要准确率还是可解释性，也不知道你为什么要这样选择。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;所有类型的模型都有其优点和缺点。&lt;b&gt;在机器学习中，一个重要的权衡是准确率和可解释性之间的权衡。&lt;/b&gt;你可以有一个模型，它在预测方面做得很差，但很容易理解，并有效地解释了这个过程；你可以有一个黑匣子，它非常精确，但是它的内部工作原理却是个谜。或者你可以在两者之间找到一个平衡点。&lt;/p&gt;&lt;p&gt;你选择的模型类型应该根据这两个特征中的哪一个对你的项目更重要来决定。如果目的是对数据建模并获得可操作的见解，那么一个可解释的模型，例如决策树或线性回归，是显而易见的选择。如果项目是用于实际工作的，比如图像标注，那么可解释性就会让位于准确率，而随机森林或神经网络可能更合适。&lt;/p&gt;&lt;p&gt;根据经验，那些不理解这种取舍的数据科学家，以及那些甚至没有考虑到可解释性的重要性就直接追求准确率的数据科学家，都很水！&lt;/p&gt;&lt;h2&gt;&lt;b&gt;3、没有使用有效的衡量标准&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;数据科学的“科学”部分往往被忽视。对于装腔作势的数据科学家来说，盲目地在实验环境中应用单一指标作为他们的模型评估并不罕见。不知情的利益相关者很容易被“90%的准确率”所震惊，这种说法在技术上是正确的，但对于当前的任务来说却是极其不恰当的。&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;3.1 没有建立一个基准模型&lt;/b&gt;&lt;/p&gt;&lt;p&gt;我们做了一个胰腺癌检测，准确率超过99%：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-0dedbff32f0342e36e3b1b3abae4aa48_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;280&quot; data-rawheight=&quot;279&quot; class=&quot;content_image&quot; width=&quot;280&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-0dedbff32f0342e36e3b1b3abae4aa48_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;280&quot; data-rawheight=&quot;279&quot; class=&quot;content_image lazy&quot; width=&quot;280&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-0dedbff32f0342e36e3b1b3abae4aa48_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;如果你看到一个有一条线穿过红圈，那么测试结果是阴性的。如果你看到一个绿色的标记，反之。关键是，99%的人没有胰腺癌（实际上，大多数人是没有的，但是为了这个例子，我们假设99%的人都患有胰腺癌），所以我们这个愚蠢的测试在99%的情况下都是准确的。那么任何用于诊断胰腺癌的机器学习模型都应该至少和这个无用的基准模型一样好。 如果你某些人声称他开发的工具有95% 的准确率，将这些结果与基准模型进行比较，确保他的模型比随机模型表现得更好。&lt;/p&gt;&lt;p&gt;&lt;b&gt;3.2 使用了错误的衡量标准&lt;/b&gt;&lt;/p&gt;&lt;p&gt;继续上面的诊断例子，确保使用正确的衡量标准非常重要。对于癌症诊断来说，准确率实际上是一个糟糕的衡量标准；如果降低精度意味着增加灵敏度，那么通常更可取。假阳性的代价是什么？病人的压力，以及浪费的时间和资源。假阴性的代价是什么？死亡……。了解模型的真实含义，并了解这些含义如何控制衡量选择。&lt;/p&gt;&lt;p&gt;&lt;b&gt;3.3 训练/测试模糊不清&lt;/b&gt;&lt;/p&gt;&lt;p&gt;这是问题太常见了。正确地测试一个模型对于数据科学过程是必须的。有很多方法可能会出错：不理解验证和测试数据之间的区别……，否则你的工作就是在浪费时间。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;4、import tensorflow as tf&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;如果你刚刚开始在这个领域，可能很难区分Siraj Ravals和Andrew Ngs（吴恩达）。 &lt;/p&gt;&lt;p&gt;Siraj Ravals：仅仅在Youtube上，他就有仅70万订阅者，包括DeepMind创始人Demis Hassabis也是他的“粉丝”，简直堪称是机器学习界的“papi酱”。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-b5e82583fb99772c4285e9ee5c2ef016_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;900&quot; data-rawheight=&quot;900&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;900&quot; data-original=&quot;https://pic3.zhimg.com/v2-b5e82583fb99772c4285e9ee5c2ef016_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-b5e82583fb99772c4285e9ee5c2ef016_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;900&quot; data-rawheight=&quot;900&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;900&quot; data-original=&quot;https://pic3.zhimg.com/v2-b5e82583fb99772c4285e9ee5c2ef016_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-b5e82583fb99772c4285e9ee5c2ef016_b.jpg&quot;/&gt;&lt;figcaption&gt;Siraj Ravals&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;Siraj称自己的机器学习多靠自学完成&lt;/b&gt;。2012年，他从哥伦比亚大学计算机系退学，开始自学AI技术，并且，利用自己学到的内容，全心运营youtube专栏的视频内容。他在推特上称给自己的任务安排为“每周两个视频”，视频密度之大，质量之高，让业内的人纷纷惊叹地称其为“AI魔术师（wizard）”，而他本身“自学成为大师“的经历，也给了很多圈外小白学习的动力。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-808ed8493fb6b98a48383c0348a00f76_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;603&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-808ed8493fb6b98a48383c0348a00f76_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-808ed8493fb6b98a48383c0348a00f76_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;603&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-808ed8493fb6b98a48383c0348a00f76_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-808ed8493fb6b98a48383c0348a00f76_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;但位油管网红人设忽然崩塌，被曝出视频中有部分内容搬运自Github和一些论文，&lt;b&gt;Ctrl+C、Ctrl+V级别的抄袭！&lt;/b&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-4813f48958185115ed1bc4665f8a2df2_b.png&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;181&quot; data-rawheight=&quot;184&quot; class=&quot;content_image&quot; width=&quot;181&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-4813f48958185115ed1bc4665f8a2df2_b.png&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;181&quot; data-rawheight=&quot;184&quot; class=&quot;content_image lazy&quot; width=&quot;181&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-4813f48958185115ed1bc4665f8a2df2_b.png&quot;/&gt;&lt;/figure&gt;&lt;p&gt;而Andrew Ngs，才是一位&lt;b&gt;真正的学者和布道者！&lt;/b&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-5593cc408f211f22c8b9ae20074a4218_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;580&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-5593cc408f211f22c8b9ae20074a4218_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-5593cc408f211f22c8b9ae20074a4218_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;580&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-5593cc408f211f22c8b9ae20074a4218_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-5593cc408f211f22c8b9ae20074a4218_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;如果你有被上面的任何一个点所触动，我们很欣慰，因为这意味你希望把事情做的更好！&lt;/p&gt;&lt;p&gt;继续学习，继续努力，这样你就可以diss一群装腔作势的&lt;b&gt;砖家&lt;/b&gt;了！&lt;/p&gt;&lt;p&gt;量化投资与机器学习微信公众号，是业内垂直于&lt;b&gt;Quant、MFE、Fintech、AI、ML&lt;/b&gt;等领域的&lt;b&gt;量化类主流自媒体。&lt;/b&gt;公众号拥有来自&lt;b&gt;公募、私募、券商、期货、银行、保险资管、海外&lt;/b&gt;等众多圈内&lt;b&gt;18W+&lt;/b&gt;关注者。每日发布行业前沿研究成果和最新量化资讯。&lt;/p&gt;</description>
<author>Quant最爱</author>
<guid isPermaLink="false">2020-04-01-122364181</guid>
<pubDate>Wed, 01 Apr 2020 00:00:00 +0800</pubDate>
</item>
<item>
<title>达里奥最新雄文：战争经济的运行机制</title>
<link>https://henix.github.io/feeds/zhuanlan.Lhtz-Jqxx/2020-03-31-121159991.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/121159991&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-2ec4ab342c5576b5a39eaceb0d986ea0_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;作者：达里奥&lt;/p&gt;&lt;p&gt;编译：量化投资与机器学习编辑部&lt;/p&gt;&lt;h2&gt;&lt;b&gt;0、前言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;现在发生的事情在不久前是不可想象的。因为这在我们的有生之年从未发生过。然而，如果你研究历史，你会发现它在过去经常发生，以至于他会认为这是不可避免的。&lt;/p&gt;&lt;p&gt;更具体地说，是控制财政政策的政府行政部门和立法部门以及控制货币政策的中央银行。政府宣布了空前规模的财政和货币刺激计划，包括直接向公民派发现金等。其中最引人注目的是美国总统、国会和美联储最近的声明。这场关于金钱和信贷海啸将如何流动的细节是极其重要的，但我现在不想谈这个。我要做的是尝试传达这一观点的宏观含义，关注机制和含义。因为这次海啸比我们有生之年发生过的任何事情都要大得多，我们需要拓宽我们的视野来看待在我们有生之年发生的事情。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;1、我的方法&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;在我开始研究现在发生的事情之前，我想解释一下为什么我要研究这么久远的历史来获得我的观点。虽然很久以前的案例似乎没什么用，但我通过惨痛的教训认识到，事实恰恰相反。我发现，&lt;b&gt;我在市场上犯下的最大、最痛苦的错误，都是因为我没有研究那些发生在我有生之年的时间段&lt;/b&gt;。当我犯了错误，因为我不知道如何判断没有发生在我身上的事情，我总是发现我错过了什么，需要通过看历史来理解。这使我希望我在犯错误之前研究过这些历史案例。这是一个犯错误，反思错误，然后根据学到的东西提高的过程，这就是我的原则：&lt;/p&gt;&lt;p&gt;&lt;b&gt;痛苦+反思=进步&lt;/b&gt;&lt;/p&gt;&lt;p&gt;例如，最近我犯了一个痛苦的错误，没有一个经过深思熟虑应对流行病的策略，这个痛苦的错误迫使我和桥水的合作伙伴回顾历史，研究过去的流行病以及它们在整个历史上对经济和市场的影响。这让我大开眼界。当我深入研究历史的时候，我发现传染病和其他自然现象（如干旱和洪水）对经济和市场的影响比其他其他事物，包括战争和革命对经济和市场的影响都要大，我需要有系统的计划来整理这些。我怎么会忽略流行病呢？当我自责的时候，目前我正在和桥水的小伙伴们建立一个系统的程序，以便在未来处理这些问题。就像我们在许多其他事情上所做的那样。&lt;/p&gt;&lt;p&gt;基于这些原因，我认为理解未来在于理解历史中的教训。&lt;/p&gt;&lt;p&gt;至于我要给你们看的东西，请你们理解，我从来不能肯定我的想法是否正确。我会继续犯错（也会取得成功），我的目标不是让你相信我。我的目标很简单，我的目标仅仅是传递我相信经济机器和市场机制是如何工作的，并把我处理这些机制的最重要的原则传达给你们，你们取其精华去其糟粕。我希望我的所作所为能够帮助你有自己的观点和原则，让你受益匪浅。&lt;/p&gt;&lt;p&gt;与这一目标相一致的是，大约18个月前，我不得不研究是什么导致了储备货币的兴起和衰落以及它们背后的帝国。做这项研究（我还在做）让我大开眼界，而且对于塑造我对现在正在发生的事情的看法非常重要。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;2、与刚刚发生事情相关的历史教训&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;美国（和其他国家）的财政政策制定者（总统和国会）和货币政策制定者（美联储和其他中央银行）刚刚创建一个巨大的财政和货币政策刺激，这将会导致巨大的支持，以及这些巨额预算赤字、债务和这些债务的货币化。虽然这些在我们的有生之年是前所未有的，但在历史上却不是前所未有的。我们先来看看1930-45年的情况。&lt;/p&gt;&lt;p&gt;我认为1930年至1945年是现在最近的类似时期，因为那时，就像现在一样，利率触及0%的底线，货币政策无效，债台高筑，全球经济疲软，存在巨大的财富和政治差距，一个正在崛起的世界大国正在挑战现有的世界大国。作为对这些事情的回应，尤其是在战争年代，大量的财政支出产生了大量的政府债务，需要在没有足够的自由市场需求购买时出售，因此中央银行需要以某种方式将这些债务货币化。 美国政府现在的财政赤字将超过 GDP 的20% ，美联储印钞票和购买债券的数量将使其债务占 GDP 的30% 左右，比二战时期的峰值还要高。&lt;/p&gt;&lt;p&gt;这意味着什么？随着所有这些债务和货币的创造，利率和通货膨胀会上升吗？谁将承担所有这些债务和印刷货币的负担，何时？我们还能期待什么呢？&lt;/p&gt;&lt;p&gt;正如你将看到的，1930年至1945年期间的利率没有上升。你还会看到，在其他情况下，它们并没有上升。你会明白为什么会这样，为什么我认为它们不需要上升。如果你阅读了我的文章《The Changing World Order》，你会发现，虽然眼下不存在显著的风险，但长期风险有所增加，即货币和信贷不会被视为财富的良好备手段。这可能最终会导致一场大规模的撤资运动，使各国央行不得不在提高利率和让本币相对于其它储备财富贬值之间做出选择。在这篇文章中，我不会详细介绍这幅长图，因为专注于汲取海啸的机制是我今天的唯一目标。&lt;/p&gt;&lt;p&gt;我将向你们展示的这些案例将显示，中央政府必须具有强大的刺激力，让中央银行购买这些债务，或者为其他国家购买这些债务提供便利，以保持低利率和经济有序运行。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;3、怎么做到的&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;在1930年至1945年期间，美联储实施了一项收益率曲线控制政策。更具体地说，它做出了购买债券以限制利率的可信承诺（这与日本央行以及欧洲央行目前的做法类似，只是程度较轻）。因此，伴随着政府巨大的借贷需求，美联储无限制的承诺将债券收益率控制在2.5% 。这些行动创造了一种货币和财政政策的半自动协调。&lt;/p&gt;&lt;p&gt;下图显示了美国每次主要冲突期间政府债务和货币基础的大幅增长。请注意，政府债务的增加和中央银行的货币化同样发生在第二次世界大战和内战期间。几乎所有国家的战争时期都是如此。让我们更仔细地研究一下这些案例，因为在这种动荡时期，政府采取了其他形式的控制措施，如果未来的困难时期需要更严格的控制，我们可以考虑采取这些措施。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-00ce44f0bdabe1438964626919802409_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;443&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-00ce44f0bdabe1438964626919802409_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-00ce44f0bdabe1438964626919802409_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;443&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-00ce44f0bdabe1438964626919802409_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-00ce44f0bdabe1438964626919802409_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;h2&gt;&lt;b&gt;4、二战时期&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;战争案例是最适用的类比案例。在这种情况下，随着政府在战争上的支出大幅增加，所有国家的政策制定者都提高了税收，增加了借贷，增加了印钞。在这种情况下，他们总是这么做的。在这种情况下，你应该预料到这一点。&lt;/p&gt;&lt;p&gt;更具体地说，在美国参战之后，政策制定者立即开始提高企业和个人税率，并向公众发行债券。下表显示了美国和其他参战国家的政府资金来源，仅使用了实际战争年份的数据（即1991年至1945年的美国），以及省略数据极其不可靠的年份（1945年的德国和日本）。正如你所看到的，他们都缴税了，借了很多钱，还印了很多钱。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-c9243f33a23036afb4021602f7c7eea3_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;432&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-c9243f33a23036afb4021602f7c7eea3_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-c9243f33a23036afb4021602f7c7eea3_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;432&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-c9243f33a23036afb4021602f7c7eea3_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-c9243f33a23036afb4021602f7c7eea3_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;h2&gt;&lt;b&gt;5、美联储二战时期的收益率曲线控制是如何运作的&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;我们有必要了解美联储是如何在面临加息压力的情况下将利率维持在低位的机制。它是通过控制收益率曲线来实现这一点的，即使在经济增长、通货膨胀和政府债券发行出现重大转变的情况下，收益率曲线也能保持利率稳定。在下图中，你可以看到长期债券收益率是如何在战争的巨大经济波动（伴随着巨大的增长繁荣和防止通货膨胀飙的价格控制）、战后萧条以及随之而来的复苏中，长期债券收益率是如何保持在2%左右的稳定。通货膨胀在1947年达到了接近20%的战后极限，在1949年达到了约-3%的低点，而收益率几乎没有变化。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-09de456ab0f85fb7af7e4313816a82f8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;356&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-09de456ab0f85fb7af7e4313816a82f8_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-09de456ab0f85fb7af7e4313816a82f8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;356&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-09de456ab0f85fb7af7e4313816a82f8_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-09de456ab0f85fb7af7e4313816a82f8_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;以下是这项政策是如何运作的。&lt;/p&gt;&lt;p&gt;首先，美联储对其利率上限制度做出了可信的长期承诺。它在整个曲线上实施了一系列的利率上限；为了简单起见，下面我们将展示曲线上的几个点。正如你所看到的，长期债券的收益率一直高于短期债券。因此，只要投资者认为利率结构将保持不变，就存在一种套利行为，鼓励投资者借入短期资金，借出长期资金。战争期间就是这样。战后，维持联系汇率制的坚定承诺开始受到质疑，尤其是在经济复苏和通胀压力上升的情况下。1947年，美联储提高了长期利率上限，允许短期利率有更大的灵活性小幅上升。联系汇率制逐渐失去了效力，最终在1951年财政部与美联储达成的协议中宣告结束。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-d0d680c50ea3fde708c93da03570d414_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;492&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-d0d680c50ea3fde708c93da03570d414_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-d0d680c50ea3fde708c93da03570d414_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;492&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-d0d680c50ea3fde708c93da03570d414_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-d0d680c50ea3fde708c93da03570d414_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;虽然美联储没有利用其资产负债表购买很多债券，但它在短期债券上印制了大量的钞票，这样就有了寻找收益率的流动性，而收益率可以从收益率更高的债券中获得。尽管在此期间，美联储的资产负债表迅速增长，但美联储持有的几乎都是短期债券，银行购买这些债券是为了提振收益率，从而支撑了利率上限。美联储从私营部门购买票据，为银行提供廉价的流动性，并降低它们的准备金要求。所有这些政策都创造了充足的流动性来寻求收益。下图显示了美联储的资产负债表在战争期间是如何膨胀的，但主要是在曲线的短端。战后，由于不太清楚收益率曲线政策是否会持续(即可信度下降) ，美联储被迫采取更多实际的债券购买行动，以维持其理想的债券收益率。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-7995b797379c229798b2675498c0c006_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;475&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-7995b797379c229798b2675498c0c006_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-7995b797379c229798b2675498c0c006_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;475&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-7995b797379c229798b2675498c0c006_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-7995b797379c229798b2675498c0c006_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;美联储对稳定、向上倾斜的收益率曲线的可信承诺，以及充足的短期流动性，促使私营部门投资者购买政府债券。下图显示了二战期间和战后政府债券持有量的变化。包括银行、爱国家庭和其他长期投资者（如保险公司）在内的众多私营部门投资者纷纷进场购买政府债券。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-fb7f8f08b48d039874992562aa0876f6_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;460&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-fb7f8f08b48d039874992562aa0876f6_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-fb7f8f08b48d039874992562aa0876f6_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;460&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-fb7f8f08b48d039874992562aa0876f6_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-fb7f8f08b48d039874992562aa0876f6_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;与美联储能够支持财政部而不主要依靠直接大规模购买相一致，美元面临的压力相对较小。金价在战争期间基本持平，尽管在战后有所上涨。虽然美国公民持有黄金仍然是非法的，但最终在布雷顿森林货币体系的监管下将金价恢复到战前的水平。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-99284cf683df69490f31e826ae928104_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;489&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-99284cf683df69490f31e826ae928104_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-99284cf683df69490f31e826ae928104_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;489&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-99284cf683df69490f31e826ae928104_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-99284cf683df69490f31e826ae928104_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;美联储二战战略的一个关键部分是依靠银行购买长期债券。银行尤其重要，因为美联储可以通过其政策直接影响它们的流动性状况，而对利率结构的可信承诺，确保了它们将受到激励，利用其流动性购买债券。摘自1942年美联储年度报告:&lt;/p&gt;&lt;p&gt;“正如已经指出的那样，商业银行肯定会被要求在未来两年内承担一部分公共债务，而美联储当局将不得不提供必要的准备金。这可以通过让银行向联邦储备银行借款来实现。为了促进这一点，贴现率已经降低了，特别是对银行短期政府债券的预支。这将鼓励银行自由地充分利用其现有储备，并保证在出现资金短缺的情况下，它们可以以优惠的利率从储备银行获得资金。他们还可以通过以3/8%的利率出售美国国债来获得这些资金。但是，必须通过美联储购买其他政府债券、降低准备金要求或两者结合的方式来提供相当数量的准备金。”&lt;/p&gt;&lt;p&gt;正如我们之前所描述的，一旦利率为零，资产购买已经挤压了整个金融市场的风险溢价，最有效的刺激形式就是让货币政策与财政政策相协调，也就是我们所说的MP3。“为了避免新的流动性被困在现金中，资金被引导到政府债券中，政府的支出可以主动引导到实体经济中，提供有效的刺激。”&lt;/p&gt;&lt;p&gt;通过这种方式，美联储的二战收益率目标制项目间接地为有史以来最大的政府财政赤字扩张提供了资金。虽然这是在改变了经济的全面战争背景下发生的，但是，这种政策在控制产量和支持和振兴经济方面的力量仍然具有指导意义。在二战中，正是这种刺激最终推动经济走出了大萧条时代。你可以看到债券发行是如何为战争提供资金的（左图），比如政府债务在战争结束时上升了约70% 的 GDP（右图）。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-32136a383f7dae52aef8e4d4e6bc6ec1_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;433&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-32136a383f7dae52aef8e4d4e6bc6ec1_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-32136a383f7dae52aef8e4d4e6bc6ec1_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;433&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-32136a383f7dae52aef8e4d4e6bc6ec1_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-32136a383f7dae52aef8e4d4e6bc6ec1_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;当然，这场战争对美国的刺激作用，在很大程度上取决于这样一个事实：绝大多数美国人不是在美国领土上打仗，而美国是一个重要的胜利者——对于战败来说，人力和经济成本是巨大的。在第二次世界大战中，德国和日本的人均国内生产总值至少下降了一半，其货币在战后大幅贬值，如下图所示。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-2c316c270f48b614610cd670df0a8342_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;897&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-2c316c270f48b614610cd670df0a8342_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-2c316c270f48b614610cd670df0a8342_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;897&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-2c316c270f48b614610cd670df0a8342_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-2c316c270f48b614610cd670df0a8342_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;h2&gt;&lt;b&gt;6、法规和税收&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;我们应该讨论各种类型的法规和税收，因为如果这场战争加剧，我们可以看到这些法规和税收的不同版本。&lt;/p&gt;&lt;p&gt;除了大规模的财政支出和大量的债务货币化，二战中的政策制定者还引入了一系列控制措施。这些政策控制了个人和公司的经济行为，以便将所需的资源用于战争，包括配给、生产控制、价格和工资控制以及进出口控制。除了对经济活动的控制，还涉及到没收级别的税收，同时还有外汇管制以防止资金流出，以及限制个人可以持有的资产（例如，在美国和许多其他战斗国，私人持有黄金是非法的）。 对于仍然存在的有限外贸，兑换相关货币仍然几乎不可能。例如，英国要求其贸易伙伴（主要是英联邦国家）持有任何贸易顺差的英镑。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-53353b9fb06ffccdc7818f22b670915d_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;329&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-53353b9fb06ffccdc7818f22b670915d_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-53353b9fb06ffccdc7818f22b670915d_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;329&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-53353b9fb06ffccdc7818f22b670915d_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-53353b9fb06ffccdc7818f22b670915d_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;除了这些限制之外，政府在这些经济体中的直接作用还大幅扩大，为军队提供资金。下图显示了政府支出在战斗人员中的增加程度。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-86ae8cb4ce92384c33c0c9490143739a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;633&quot; data-rawheight=&quot;555&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;633&quot; data-original=&quot;https://pic3.zhimg.com/v2-86ae8cb4ce92384c33c0c9490143739a_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-86ae8cb4ce92384c33c0c9490143739a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;633&quot; data-rawheight=&quot;555&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;633&quot; data-original=&quot;https://pic3.zhimg.com/v2-86ae8cb4ce92384c33c0c9490143739a_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-86ae8cb4ce92384c33c0c9490143739a_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;在美国，为了满足这种巨大的生产需求，罗斯福不得不对经济进行全面重组，以转向战时生产。他制定了一系列政策来促进这一点，甚至在美国正式参战之前就开始了：&lt;/p&gt;&lt;p&gt;起初，美国的政策制定者通过贸易管制来支持盟国。1941年3月，国会通过了租借法案，允许盟国向美国政府申请物资供应，同时将付款时间推迟到战后（或在某些情况下完全避免付款）。此外，它还通过了一系列对日贸易限制措施（包括1940年对日本实施废铁和石油禁运，1941年7月对日本资产的冻结）。&lt;/p&gt;&lt;p&gt;1941年12月珍珠港轰炸后，政府实施了大多数其他经典的战时限制措施，比如价格和工资控制。为了促进经济的重组，罗斯福于1942年1月成立了战时生产委员会，该委员会有权分配稀缺的资源，并下令根据需要对工厂进行改造。战争采购在很大程度上是在成本加固定费用的基础上进行的，而不是在竞争性招标的基础上进行的，目的是明确地鼓励高产量而不是高效率的生产。此外，政府还提供低息贷款，为工厂改造提供资金。&lt;/p&gt;&lt;p&gt;现在让我们看看第一次世界大战的赤字是如何产生和货币化的。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;7、一战时期&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;第一次世界大战的主要参与者的融资类似于第二次世界大战，印钞占了美国和英国融资的五分之一，与第二次世界大战相比，这些国家更倾向于借贷，而不是增加税收。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-0ebd448f83f2cdd0295af59fe030aec2_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1039&quot; data-rawheight=&quot;372&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1039&quot; data-original=&quot;https://pic3.zhimg.com/v2-0ebd448f83f2cdd0295af59fe030aec2_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-0ebd448f83f2cdd0295af59fe030aec2_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1039&quot; data-rawheight=&quot;372&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1039&quot; data-original=&quot;https://pic3.zhimg.com/v2-0ebd448f83f2cdd0295af59fe030aec2_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-0ebd448f83f2cdd0295af59fe030aec2_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;在第一次世界大战期间，税收在政治上是有争议的。许多政府不愿增税，因为政策制定者认为战争将是短暂而廉价的，而且低税收有宣传价值（不增税表明财政实力）。 与和平时期相比，他们也不那么担心印钞和赤字融资，因为基于普法战争的先例，半个世纪前，双方都希望一旦战争结束就迫使对方为战争买单，并计划将新发行的纸币从流通中移除。&lt;/p&gt;&lt;p&gt;由于处于战争状态的欧洲国家无法生产战争所需的全部物资，它们通常会出现严重的贸易逆差，这些逆差是通过向盟国大量借款、消耗黄金储备以及在外国市场出售以本国货币计价的证券来融资的。为了支持这些赤字，所有主要大国都实施了一些形式的控制和限制：所有大国在战争开始时都关闭了市场，以避免贱卖，大多数参战国都暂停了金本位的可兑换性，并对黄金出口有一定的限制。虽然税率没有达到二战期间的最高水平，但在战时高峰期，美国和英国的最高边际税率都超过了50%。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-3c71a5b7a8beeb1bf61889ef28d45389_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;355&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-3c71a5b7a8beeb1bf61889ef28d45389_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-3c71a5b7a8beeb1bf61889ef28d45389_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;355&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-3c71a5b7a8beeb1bf61889ef28d45389_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-3c71a5b7a8beeb1bf61889ef28d45389_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;下面，我们将提供更多关于用于支付战争成本的债务和货币融资的角色。&lt;/p&gt;&lt;p&gt;&lt;b&gt;法国&lt;/b&gt;&lt;/p&gt;&lt;p&gt;这场战争最初被认为是短期的，因此由短期债务提供资金。当很明显它会比预期持续更长的时间时，政府在1915年到1918年间发行了长期贷款。发达的资本市场（法国证券的资本化约占GDP的140%，战前几年发行的证券约占GDP的10%）和对国家的广泛信任使其能够以相对较低的利率借贷。政府银行还依赖法国银行和阿尔及利亚银行的货币融资，这两家银行向国家提供可再生的短期贷款（预付款）。国家还依赖于短期（3个月至1年到期）的“国防债券”，可以通过每年一次的永久上市进行展期和部分合并。&lt;/p&gt;&lt;p&gt;&lt;b&gt;英国&lt;/b&gt;&lt;/p&gt;&lt;p&gt;在战争的头几个星期，政府用短期国库券和英格兰银行的预支方式来支付它的费用，但是这种融资方式仅仅是一种暂时的权宜之计。这场战争的资金主要来自借款。政府在1914年、1915年和1917年发行了三笔长期“战争贷款”，并辅以短期贷款。在第三次战争贷款之后，财政部主要依靠短期（3至6个月期限）和中期（最多10年期限）债券以及从英国央行借款来支付开支。 在主要依靠借贷的同时，政府也通过扩大货币供应来填补赤字，货币供应在战争期间翻了一番。&lt;/p&gt;&lt;p&gt;&lt;b&gt;德国&lt;/b&gt;&lt;/p&gt;&lt;p&gt;为了立即筹集现金，国家向德国国家银行或国内私人金融机构出售短期票据。然后，它每年春秋两季向公众发放长期战争贷款（战争期间总共发放了9笔贷款），用这些钱偿还短期债务。德国央行印制钞票，购买任何德国银行没有购买的此类债券，或投放到不发达的柏林货币市场。虽然这仅占战争总成本的15%左右，但战争成本非常高，这意味着德国货币在战争期间的流通增加了599%（相比之下，英国增加了91%，法国增加了386%）。&lt;/p&gt;&lt;p&gt;&lt;b&gt;美国&lt;/b&gt;&lt;/p&gt;&lt;p&gt;对于美国来说，它是在战争后期才加入战争的，战争的大部分费用是通过向公众借款来支付的。财政部发起了一场大规模的全国性运动，征集著名艺术家和电影明星，鼓励公众购买以爱国主义命名的“自由债券”，以及停战后的“胜利债券”。战争的剩余成本是通过货币创造来筹集的，大约占总成本的20%。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;8、南北战争（美国内战）时期&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;Union和Confederacy都通过税收、印钞和私人借贷的混合方式来资助他们的战争。然而，北方经济的更先进的性质（它有超过70%的人口和超过85%的工厂）帮助它以一种更平衡的方式资助战争，而没有面临失控的通货膨胀。Union经济生产能力的提高（相对而言没有受到战争的影响）也可能减轻了商品短缺的严重程度，缓解了通货膨胀压力。&lt;/p&gt;&lt;blockquote&gt;注：Union：the North America-北方美利坚合众国，Confederacy：the South America-南方美利坚联盟国&lt;/blockquote&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-c77326ae4e6de66726f7c6cbd8642e60_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;784&quot; data-rawheight=&quot;344&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;784&quot; data-original=&quot;https://pic1.zhimg.com/v2-c77326ae4e6de66726f7c6cbd8642e60_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-c77326ae4e6de66726f7c6cbd8642e60_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;784&quot; data-rawheight=&quot;344&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;784&quot; data-original=&quot;https://pic1.zhimg.com/v2-c77326ae4e6de66726f7c6cbd8642e60_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-c77326ae4e6de66726f7c6cbd8642e60_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;下面我们给出一些额外的说明，来告诉大家每个资金来源在这段时间是如何运作的。&lt;/p&gt;&lt;p&gt;&lt;b&gt;税收&lt;/b&gt;&lt;/p&gt;&lt;p&gt;和战争期间一样，税收增加了，但在战争资金中只起了次要的作用。在内战中，税收在战争中的相对作用取决于：&lt;/p&gt;&lt;p&gt;1、是否有流动资产需要征税。&lt;/p&gt;&lt;p&gt;2、征税资产的政治意愿。&lt;/p&gt;&lt;p&gt;因为北方既愿意也有能力征税，所以它通过征税筹集了更多的资金，而且在早些时候就这么做了。北方的政治集权和保护主义倾向意味着税收在Union战争资金中扮演了重要角色。到1861年7月，Union已经提高关税并征收所得税（一个相对有争议的措施）。在整个战争期间，Union将继续扩大并增加所得税和消费税。相比之下，南方提高税收的意愿和能力都较低。结果，他们在战争后期才筹集到有意义的资金，当时（在绝望的驱使下），他们在对人民征税的水平上更加激进，而且在他们接受税收的支付方式上更具创造性。&lt;/p&gt;&lt;p&gt;&lt;b&gt;债券&lt;/b&gt;&lt;/p&gt;&lt;p&gt;现代战争的巨额成本意味着，政府通常被迫大举借债，同时转向非常规手段来保持借款可控——这些手段包括直接向公众呼吁购买债券，以及向银行提供保障增加购买。面对爆炸性的预算赤字，Union的战争资金非常符合这一模式。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-8b1b24f34c4197e84a862f455fe2d288_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;479&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-8b1b24f34c4197e84a862f455fe2d288_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-8b1b24f34c4197e84a862f455fe2d288_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;479&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-8b1b24f34c4197e84a862f455fe2d288_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-8b1b24f34c4197e84a862f455fe2d288_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;起初，Union只依赖于向国家银行出售债券（这些银行随后会转售债券）。然而，这种方法很快遇到了问题，因为银行不愿用其有限的黄金购买他们认为转售机会渺茫的低收益债券。由于正常的资本市场缺乏足够的资金或意愿来满足政府的需求，Union转向了另一种策略。主要有四种形式：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;1861年，Union打破了与黄金的挂钩，允许用新美元购买债券。 这增加了流动性，并允许更多的债券购买，从而压低了收益率，&lt;/li&gt;&lt;li&gt;政府向公众推销债券，称购买债券是一种爱国行为。债券的设计是为了吸引普通百姓：它们以小面额发行，最低只有50美元，并且可以通过支付计划购买。&lt;/li&gt;&lt;li&gt;政府鼓励银行购买政府债券。1863年、1864年和1865年的银行改革为州立银行转换为国有银行创造了条件与动力，这些银行不得不购买Union证券。该法案还对国有银行发行的纸币征税（实际上是将它们赶出流通领域）。相反，国有银行可以发行国家银行票据，由财政部的联合证券存款作为担保。这项立法为购买美国证券提供了重要支持，进一步压低了收益率。&lt;/li&gt;&lt;li&gt;Union还试图在国际市场上出售债券。然而，国际投资者只是在1864年战争接近结束时才愿意提供有意义的贷款，当时Union的胜利似乎是必然的。&lt;/li&gt;&lt;/ul&gt;&lt;h2&gt;&lt;b&gt;8、美国内战时期的印钞机&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;Union对这场新近爆发的激烈冲突毫无准备，计划自筹资金（正如它在二战期间所做的那样）。&lt;/p&gt;&lt;p&gt;通过借钱来解决冲突，用税收来支付日常开支，这些都是美墨战争。事实证明，这场战争的持续时间和激烈程度所造成的费用远远超出了最初的估计。到1861年底，发行债券显然是不够的。人们越来越担心与英国的战争和不断增长的经常账户赤字，这给黄金储备带来了压力。曾向政府提供黄金以换取国库券和债券的银行发现，它们无法在二级市场上转售政府债券，因此面临越来越多的赎回。纽约银行带头暂停现金支付，财政部迅速跟进。由于用于支付联邦士兵的票据变得无法兑现，而且其价值不断恶化，国会争相寻找新的方式为战争筹资。联系汇率制实际上已经被打破，1862年，政府开始印制1.5亿美元的美国钞票，并使这些钞票成为合法货币。&lt;/p&gt;&lt;p&gt;在战争结束前，美元对黄金的比价在战争结束前下跌。最初，美元可以转换成债券，以支付黄金利息（这是为了证明美元的“稳定性”而引入的一种怪癖）。可兑换性的中止和货币供应量的大量增加（到1863年增加到4亿5千万美元）帮助引导了货币的贬值。然而，由于联邦政府承诺以与黄金相当的价格赎回美元，因此每当战争结束时，美元的价值似乎都在上涨。相比之下，随着战争的进行，由于印钞过多和前景渺茫，Confederate货币将持续贬值。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-a130966a7304db0af4d70024de64822d_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;454&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-a130966a7304db0af4d70024de64822d_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-a130966a7304db0af4d70024de64822d_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;454&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-a130966a7304db0af4d70024de64822d_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-a130966a7304db0af4d70024de64822d_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;量化投资与机器学习微信公众号，是业内垂直于&lt;b&gt;Quant、MFE、Fintech、AI、ML&lt;/b&gt;等领域的&lt;b&gt;量化类主流自媒体。&lt;/b&gt;公众号拥有来自&lt;b&gt;公募、私募、券商、期货、银行、保险资管、海外&lt;/b&gt;等众多圈内&lt;b&gt;18W+&lt;/b&gt;关注者。每日发布行业前沿研究成果和最新量化资讯。&lt;/p&gt;</description>
<author>Quant最爱</author>
<guid isPermaLink="false">2020-03-31-121159991</guid>
<pubDate>Tue, 31 Mar 2020 00:00:00 +0800</pubDate>
</item>
<item>
<title>五个经验教训：机器学习应用量化策略的那些坑！</title>
<link>https://henix.github.io/feeds/zhuanlan.Lhtz-Jqxx/2020-03-26-117608047.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/117608047&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-bd1c378c91d744e416e3100057ae3e4f_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;1、前言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;一些研究认为，金融市场对于应用机器学习来说是一个糟糕的选择。这些文章着重于市场或股票收益的预测，并引用这些收益的高斯性质或此类数据的“噪音”作为得出结论的原因。通常，这些都是由数据科学家撰写的，他们毫无疑问对自己的技术有深刻的理解，但是在他们要解决的问题上缺乏专业知识；我相信这些方法在最初构建问题的方式上存在缺陷。&lt;/p&gt;&lt;p&gt;在资产管理中，我们已经有很大一部分和越来越多的资产使用数据驱动的“量化”投资策略进行管理。这应该是讨论投资研究中的机器学习的起点。机器学习应该被量化驱动的金融领域的专家用作工具，使他们的策略更高效，更有利可图。成功引入机器学习的比较基准应该是他们当前独立于机器学习的策略。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;2、在量化研究中引入机器学习&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;无论使用什么软件或系统，建立数据驱动的投资策略都需要执行多个步骤。首先，我们需要收集不同的数据集，如公司财务、经纪人评估、定价和公司行为，集团公司的分类数据以及许多不同类型的深奥或替代数据，以发现隐藏的信号。然后，需要将这些数据集进行组合、标准化、清除异常值，并将其转变为具有经济直观意义的因子。然后，可以使用分析工具来分析这些因子对股价变动的解释程度，以及它们在一段时间内是否具有持续价值。最后，可以使用基于规则的方法或基于风险的优化等更复杂的方法将这些信号转换为投资组合。&lt;/p&gt;&lt;p&gt;机器学习适合在哪里？机器学习擅长查找数据模式。我们可以使用它的一种方法是增强我们传统的数据驱动的投资策略，以发现和利用我们因子中的模式。这使我们能够建立模型来解释各种因子下的股票表现。下图显示了该工作流程。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-d3033625a4f750deac87c5ca68df842e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;481&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-d3033625a4f750deac87c5ca68df842e_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-d3033625a4f750deac87c5ca68df842e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;481&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-d3033625a4f750deac87c5ca68df842e_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-d3033625a4f750deac87c5ca68df842e_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;h2&gt;&lt;b&gt;3、自动化机器学习&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;困难在于如何选择和实现正确类型的机器学习算法。使用如Python或R中可用的那些免费工具，一个新手数据科学家会迅速脱离他/她的深度，更有可能的是失败而不是成功。他们没有经验，无法知道什么类型的算法适用于某个问题或如何有效地训练它们。他们很容易陷入一个尝试使用具有多种不同参数和数据排列的不同算法的永久循环。&lt;/p&gt;&lt;p&gt;另一方面，雇佣经验丰富的数据科学家可能会很昂贵。几乎没有谁具备解决金融市场问题的所有必要技能。您很可能需要三个人：一位测试和验证算法的数据科学家，一位在不同的环境中实现这些算法工程师/程序员，以及一位了解数据并能够智能地定义问题的主题专家。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-a3b1bf87aaea86c68dfbeb3ea93f1858_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;310&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-a3b1bf87aaea86c68dfbeb3ea93f1858_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-a3b1bf87aaea86c68dfbeb3ea93f1858_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;310&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-a3b1bf87aaea86c68dfbeb3ea93f1858_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-a3b1bf87aaea86c68dfbeb3ea93f1858_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;要想在机器学习中取得成功，就需要编程和统计这些更普遍的组件的自动化组件。主题专家需要使用复杂的工具进行授权，使他们能够以产品支持的形式从专业数据科学家那里获得最小的帮助来解决这些问题。为了我们的分析，我们通过FactSet使用DataRobot，这使我们能够在将各种模型集成到实际投资组合之前对其进行研究、构建和自动化。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;4、建立和测试模型&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;为了表明机器学习可用于增强传统的量化因子，我们建立了中国A股的股票预测模型。我们为2012年12月至2019年8月编制了中证800指数的股票表现和各种因子数据的月度概况。我们将目标变量设置为股票的未来一个月收益，并使用原始投资组合模型中的因子。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-32a7af984b1b64d0af81d5f6854fb580_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;567&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-32a7af984b1b64d0af81d5f6854fb580_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-32a7af984b1b64d0af81d5f6854fb580_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;567&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-32a7af984b1b64d0af81d5f6854fb580_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-32a7af984b1b64d0af81d5f6854fb580_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;通过“适者生存”过程，我们针对该问题系统地测试了数十种不同的算法和预处理排列。首先，我们使用一部分历史数据的子集来训练每个模型，然后在之前未发现的数据上测试该模型以确定其有效性。然后，通过不同的方法或优化指标对所有模型进行排序，以确定针对给定问题的最佳模型。&lt;/p&gt;&lt;p&gt;对我们的模型进行评估后，我们从前三个模型中获取了预测，并将其重新纳入了我们的分析模型。我们建立了等权重的投资组合，在其中我们买入预测的前20％，并卖出预测的后20％。然后，我们将这些投资组合与更传统的基于因子的投资组合进行了分析。下图显示了这些不同投资组合的收益。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-bcb4c12fe45af6a15182c1dbdf9446f0_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;600&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-bcb4c12fe45af6a15182c1dbdf9446f0_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-bcb4c12fe45af6a15182c1dbdf9446f0_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;600&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-bcb4c12fe45af6a15182c1dbdf9446f0_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-bcb4c12fe45af6a15182c1dbdf9446f0_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;h2&gt;&lt;b&gt;5、不要混淆样本内和样本外&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;乍一看，我们基于机器学习的策略似乎大大优于传统策略。但这是因为我们专注于整个时期；相反，我们只需要使用尚未经过算法训练或验证的新数据来分析这些模型，以确保该策略将来能够成功。&lt;/p&gt;&lt;p&gt;不幸的是，如果我们将样本内结果与保留（样本外）结果进行比较，则基于机器学习的模型几乎无法胜过其更传统的模型。在一种情况下，它实际上表现很差。因此，机器学习在训练和验证期间非常出色地建模了因子行为，但是这种表现并不能用背后真正的钱持续下去。这使我们回到了有关将机器学习应用于投资的一些最初批评。我们可以通过以下要点精心构建我们的问题来解决这些问题。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-dbde79abc42e571b9cfa5e4a1a15bf51_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1033&quot; data-rawheight=&quot;540&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1033&quot; data-original=&quot;https://pic2.zhimg.com/v2-dbde79abc42e571b9cfa5e4a1a15bf51_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-dbde79abc42e571b9cfa5e4a1a15bf51_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1033&quot; data-rawheight=&quot;540&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1033&quot; data-original=&quot;https://pic2.zhimg.com/v2-dbde79abc42e571b9cfa5e4a1a15bf51_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-dbde79abc42e571b9cfa5e4a1a15bf51_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;6、屏蔽噪音并一次建模&lt;/b&gt;&lt;/p&gt;&lt;p&gt;与机器学习的典型用例（如预测同店销售额或个人银行贷款违约的可能性）不同，股票收益数据是嘈杂的。众所周知，时间序列金融数据受复杂行为困扰，包括异方差性、黑天鹅和尾部相关性。在我们的案例中，我们并不试图预测市场收益，而只是预测要投资的股票。为了最大程度地减少这些现象的影响，我们可以仅关注基准相对或同级相对表现，以将噪声降至最低。&lt;/p&gt;&lt;p&gt;&lt;b&gt;7、简化问题陈述以产生更好的模型&lt;/b&gt;&lt;/p&gt;&lt;p&gt;即使在最小化我们的股票收益中的噪音之后，也无需预测股票收益的连续性。对于典型的多头基金经理来说，只要股票的排名不变，知道实际的股票收益就不会改变他们的行为。如果下个月的股票收益率为10％对11％，你仍然可以购买。转换到基于分类的简单方法，可以使我们在尝试预测实际股票收益时避免过度拟合。&lt;/p&gt;&lt;p&gt;我们试图重新定义这个问题：一只股票会在指数中排名前30％吗？为了找出答案，我们使用这个新目标重新运行了具有相同数据的相同过程。&lt;/p&gt;&lt;p&gt;如下所示，所有三个基于分类的最佳模型在样本期内均优于基于回归的模型。重要的是，它们的样本外表现是稳定的：与所有其他因子相比，它是最佳的，并且每个月都非常一致。看来我们可能已经找到了成功的配方。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-cb049475c539aa2c19e705ad19e4f189_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;573&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-cb049475c539aa2c19e705ad19e4f189_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-cb049475c539aa2c19e705ad19e4f189_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;573&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-cb049475c539aa2c19e705ad19e4f189_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-cb049475c539aa2c19e705ad19e4f189_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;8、解释你的模型与构建模型一样重要&lt;/b&gt;&lt;/p&gt;&lt;p&gt;为了营销你的基金并最终向客户解释投资策略的优点和结果，你必须解释该模型的工作原理。这里的困难在于，无论从理念上还是在实践上，这些机器学习模型都很难理解。&lt;/p&gt;&lt;p&gt;DataRobot为我们提供了告诉我们机器学习模型如何工作的工具。下图表示特征影响，本质上是预测变化对特征值（或自变量）变化的敏感性。在这种情况下，我们的模型对价值、流动性、动量和收益增长因子的变化以及公司是否为国有企业（SOE）最为敏感。图表的比例是最重要特征的函数，因此所有其他因子都是根据价值的影响来衡量的。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-a78be7b70ce7f72f7165eb02b4cf55ec_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;395&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-a78be7b70ce7f72f7165eb02b4cf55ec_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-a78be7b70ce7f72f7165eb02b4cf55ec_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;395&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-a78be7b70ce7f72f7165eb02b4cf55ec_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-a78be7b70ce7f72f7165eb02b4cf55ec_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;此图表解释了特征与预测的关系。这些可以是并且通常是非线性的。就价值而言，公司的风险敞口越高，我们模型中的预测就越高。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-8a9767ffda850f15ad9caf1f0576e77d_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;383&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-8a9767ffda850f15ad9caf1f0576e77d_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-8a9767ffda850f15ad9caf1f0576e77d_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;383&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-8a9767ffda850f15ad9caf1f0576e77d_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-8a9767ffda850f15ad9caf1f0576e77d_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;然后，我们可以从理论到实践的理解，并研究该策略的交易方式。下图显示了该模型推荐的公司的SWS行业。Y轴在1到5的范围内显示一个行业的相对重要性，其中1表示最高，气泡的大小表示观测的频率。我们的模型在收购电子行业的公司时避免了金融和公用事业。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-c6595aceb971df6421cf5f22125f26d5_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;560&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-c6595aceb971df6421cf5f22125f26d5_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-c6595aceb971df6421cf5f22125f26d5_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;560&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-c6595aceb971df6421cf5f22125f26d5_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-c6595aceb971df6421cf5f22125f26d5_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;然后，我们根据之前强调的国有企业标志将预测分为两组。通过分析各组股票收益的相关性，我们发现该模型根据公司是否为国有企业给出了截然不同的建议。对于国有企业，我们的模型更倾向于价值股票，而对于民营企业，我们的模型倾向于对成长型公司进行更多投资。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-4fcbf39b50b27125304f34cdc8abda8e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;584&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-4fcbf39b50b27125304f34cdc8abda8e_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-4fcbf39b50b27125304f34cdc8abda8e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;584&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-4fcbf39b50b27125304f34cdc8abda8e_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-4fcbf39b50b27125304f34cdc8abda8e_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;h2&gt;&lt;b&gt;9、尝试多种方法并快速失败&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;与7、8有关的是：你很有可能需要迭代许多不同的方法来找到有效的和概括的信息；我们看到，最初的问题陈述并没有提供我们所需要的样本外信息，因此我们能够快速重新构建问题以获得更好的结果。在迭代过程中，我们使用了DataRobot和FactSet的组合可解释特征来进一步为我们的建模决策提供依据。举个例子，我们可能会利用我们对模型处理国有企业和非国有企业的不同方式的了解，进一步完善该模型。我们可以说，更多包含关于国有企业作为变量形式的信息，甚至可以为国有企业和非国有企业的股票使用不同的数据字段建立单独的模型。同样，我们可能想尝试不同的训练周期，覆盖更长或更短的时间跨度，或者通过与不同长度的历史范围进行比较来转换我们的一些数据。&lt;/p&gt;&lt;p&gt;在这里，高效建模对多个问题陈述、输入数据集和目标变量的能力变得真正有价值的地方。自动化机器学习不仅通过针对给定的建模问题尝试许多不同的机器学习算法，而且还提高了用户迭代的速度，从而简化了此过程。通过快速构建和评估多个机器学习模型，用户可以集中精力通过测试关于如何进一步改进其模型和策略的假设，来发挥其领域的专长。&lt;/p&gt;&lt;p&gt;只需记住第5——选择关于样本内验证表现的问题说明，并在部署前使用样本外保持表现检查其能否很好地泛化。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;10、结论&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;本文提供的示例显示了机器学习的一个用例，该用例用于增强传统上用于管理投资组合的因子。算法的训练和应用只是该过程中几个步骤之一。当我们进行样本外测试时，我们构建并最终选择的模型非常有利可图，并且明显优于传统模型。毫无疑问，在熟练的从业者手中，机器学习是一种强大的工具。但是，在构建问题时需要仔细考虑，以将噪音数据的影响和过度拟合的危险降至最低。在将机器学习应用于投资组合管理时，理解机器学习模型及由其构建策略是如何工作的也很关键。&lt;/p&gt;&lt;blockquote&gt;作者：IAN J. HISSEY  编译：方的馒头&lt;/blockquote&gt;&lt;p&gt;量化投资与机器学习微信公众号，是业内垂直于&lt;b&gt;Quant、MFE、Fintech、AI、ML&lt;/b&gt;等领域的&lt;b&gt;量化类主流自媒体。&lt;/b&gt;公众号拥有来自&lt;b&gt;公募、私募、券商、期货、银行、保险资管、海外&lt;/b&gt;等众多圈内&lt;b&gt;18W+&lt;/b&gt;关注者。每日发布行业前沿研究成果和最新量化资讯。&lt;/p&gt;</description>
<author>Quant最爱</author>
<guid isPermaLink="false">2020-03-26-117608047</guid>
<pubDate>Thu, 26 Mar 2020 00:00:00 +0800</pubDate>
</item>
<item>
<title>新冠肺炎期间的风险平价</title>
<link>https://henix.github.io/feeds/zhuanlan.Lhtz-Jqxx/2020-03-19-114529989.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/114529989&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-46dd33f0344a85828868ac852d76e553_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;作者：ReSolve       编译：方的馒头&lt;/p&gt;&lt;h2&gt;&lt;b&gt;1、前沿&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;与最近其他市场危机期间表达的误解一致，人们对于当前危机期间风险平价策略的行动和状态进行了一系列令人担忧的猜测。我们认为，重新审视风险平价的概念并大致了解一个典型的全球风险平价策略今年的表现可能会有帮助。&lt;/p&gt;&lt;p&gt;快速回顾一下，风险平价是一种全球资产策略，该策略强调准备胜于预测。这个想法是优先考虑多样性和平衡性： &lt;/p&gt;&lt;ul&gt;&lt;li&gt;多样性是指持有从根本上旨在在不同市场环境中蓬勃发展的市场以及全球增长机会。&lt;/li&gt;&lt;li&gt;平衡性是指确保具有不同风险特征的市场能够对投资组合做出同等贡献。&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;作为一种资产配置模型，风险平价策略重点关注具有长期预期正收益的市场风险敞口：全球股票、债券和大宗商品。这些市场收益率的主要驱动力是对增长和通胀预期的意外变化。不同的资产类别预计会以可预测的方式对这些动态变化做出反应。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-11a92b7859a818bfe4fd6bf893ffd7b5_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;608&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-11a92b7859a818bfe4fd6bf893ffd7b5_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-11a92b7859a818bfe4fd6bf893ffd7b5_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;608&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-11a92b7859a818bfe4fd6bf893ffd7b5_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-11a92b7859a818bfe4fd6bf893ffd7b5_b.jpg&quot;/&gt;&lt;figcaption&gt;图1.资产类别对通货膨胀和增长机制的预期反应。&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;至关重要的是，在为风险平价构建投资组合时，重点是准备而不是预测。该策略旨在表达一种观点，即几乎不可能准确，一致地估计市场和经济的未来状态。预见性的困难意味着我们同样有可能依靠股票、债券和/或大宗商品来获得未来收益。从风险平价的角度来看，对主要全球资产类别进行相应的风险调整后，它们都具有相同的预期收益。&lt;/p&gt;&lt;p&gt;极端多样化使风险平价策略表现出自然的低波动水平是很常见的。为了实现更高的收益目标，投资者可以利用杠杆来增加他们在整个投资组合中的风险敞口。在最受欢迎的风险平价基金中，最常见的是对投资组合进行规模调整，以达到8％至10％的年化标准偏差为目标。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;2、模拟风险平价策略&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;为了便于说明，我们模拟了一种全球风险平价策略，其投资范围包括我们在适应性资产配置期货指令中交易的全球市场，并委托进行外汇期货交易。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-e7582a738fd96326a471f5d443c37e39_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;522&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-e7582a738fd96326a471f5d443c37e39_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-e7582a738fd96326a471f5d443c37e39_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;522&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-e7582a738fd96326a471f5d443c37e39_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-e7582a738fd96326a471f5d443c37e39_b.jpg&quot;/&gt;&lt;figcaption&gt;图2.投资领域&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;形成风险平价投资组合的方法有很多，它们都强调多样性和平衡性是同样合法的。有很多方法可以根据预期投资组合适应市场关系（相关性）和风险变化的速度来指定策略。&lt;/p&gt;&lt;p&gt;我们采用了集合策略，将多种投资组合形成方法与一系列回望视野相结合，以衡量风险和相关性。最终的模拟只是合成产生的最佳每日权重的平均值。&lt;/p&gt;&lt;p&gt;我们根据过去一个月的估计日收益率，将目标投资组合的波动率设定为年化10％（每日标准差约为0.6％）。我们将杠杆率限制为现金价值的3倍，并假设在产生权重后的一天结束时执行。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-ff6798f6467dfc0477bfe7a12de901a4_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;450&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-ff6798f6467dfc0477bfe7a12de901a4_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-ff6798f6467dfc0477bfe7a12de901a4_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;450&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-ff6798f6467dfc0477bfe7a12de901a4_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-ff6798f6467dfc0477bfe7a12de901a4_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;图3.风险平价策略的超额收益（超过现金抵押品）的财富轨迹，从1989年4月12日到2020年3月12日。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-59706814fff4d85caf95daeff9838c9b_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;602&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-59706814fff4d85caf95daeff9838c9b_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-59706814fff4d85caf95daeff9838c9b_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;602&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-59706814fff4d85caf95daeff9838c9b_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-59706814fff4d85caf95daeff9838c9b_b.jpg&quot;/&gt;&lt;figcaption&gt;来源：ReSolve资产管理&lt;/figcaption&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-fb289fa95f48f65f4db0952a5f7f4167_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;450&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-fb289fa95f48f65f4db0952a5f7f4167_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-fb289fa95f48f65f4db0952a5f7f4167_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;450&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-fb289fa95f48f65f4db0952a5f7f4167_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-fb289fa95f48f65f4db0952a5f7f4167_b.jpg&quot;/&gt;&lt;figcaption&gt;图4. 从1989年4月12日至2020年3月12日超额收益的历史最高财富价值轨迹中提取&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;自1990年以来，风险平价策略每年产生8.25％的复合超额收益，实现年化波动率为10.3％，相当于0.82的夏普比率。同期国库券的现金收益率为2％，该策略平均使用了大约15％的保证金，因此包括现金收益率在内的总收益率每年将超过9％。&lt;/p&gt;&lt;p&gt;该策略在2007-2009年金融危机期间承受了31.7％的最大峰谷损失，因为在决策者做出回应以恢复全球资产类别的平衡之前进行了数次尝试。这与同期全球60/40的股票和债券基金所经历的最大跌幅大致一致。 &lt;/p&gt;&lt;h2&gt;&lt;b&gt;3、2020年的风险平价&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;回到最近的危机时期，图5描述了2020日历年风险平价策略的表现。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-252df6511efe8590236b2d303832b35f_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;450&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-252df6511efe8590236b2d303832b35f_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-252df6511efe8590236b2d303832b35f_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;450&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-252df6511efe8590236b2d303832b35f_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-252df6511efe8590236b2d303832b35f_b.jpg&quot;/&gt;&lt;figcaption&gt;图5.2020年1月1日至3月12日风险平价策略和美国均衡投资组合的超额收益（超过现金抵押品）的财富轨迹。&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;尽管风险平价策略在当前危机，面前遭受了损失，但从峰值到谷底仅下降了11.2％。相比之下，先锋平衡基金（VBINX）同期亏损了17.1％。此外，风险平价策略今年仅下降3.9％，而平衡基金则为13.85％。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;4、结论&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;许多受欢迎的投资评论员嘲笑了当前危机中的风险平价策略。他们评论的性质掩盖了对该策略性质的根本误解。&lt;/p&gt;&lt;p&gt;&lt;b&gt;风险平价只是关于多样性和平衡性。不同经济体制的多样性和不同风险特征的市场的平衡性。这种平衡是专门为长期产生弹性收益而设计的，与经济环境无关。 &lt;/b&gt;&lt;/p&gt;&lt;p&gt;通过观察当前代表性风险平价策略的表现时，我们只能得出结论：该方法正在准确地兑现其承诺。我们没有证据表明该策略经历了任何错位或异常风险事件。正如预期的那样，&lt;b&gt;它在通常不利于传统的60/40平衡投资组合的环境中的工作要比传统投资组合更有效。 &lt;/b&gt;&lt;/p&gt;&lt;p&gt;量化投资与机器学习微信公众号，是业内垂直于&lt;b&gt;Quant、MFE、Fintech、AI、ML&lt;/b&gt;等领域的&lt;b&gt;量化类主流自媒体。&lt;/b&gt;公众号拥有来自&lt;b&gt;公募、私募、券商、期货、银行、保险资管、海外&lt;/b&gt;等众多圈内&lt;b&gt;18W+&lt;/b&gt;关注者。每日发布行业前沿研究成果和最新量化资讯。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>Quant最爱</author>
<guid isPermaLink="false">2020-03-19-114529989</guid>
<pubDate>Thu, 19 Mar 2020 00:00:00 +0800</pubDate>
</item>
</channel>
</rss>
