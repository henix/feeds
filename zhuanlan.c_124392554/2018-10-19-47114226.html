<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>“姐姐妹妹站起来”—— Gale-Shapley算法（Part 3）</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/47114226">原文</a></p>
<div class="title-image"><img src="https://pic2.zhimg.com/v2-250102a523c16faf0f7a91807e78bc12_r.jpg" alt=""></div><p>“<a href="https://zhuanlan.zhihu.com/p/47039961">“姐姐妹妹站起来”—— Gale-Shapley算法（Part 1）</a>”和“<a href="https://zhuanlan.zhihu.com/p/47063883">“姐姐妹妹站起来”—— Gale-Shapley算法（Part 2）</a>”两文中所描述的其实就是 <b>Gale-Shapley算法</b>的一个通俗表述。</p><p>“稳定匹配问题”久已有之，例如求职者和用人单位的匹配、实习生和岗位的匹配、教师和课程的匹配等等。</p><p>1962年，David Gale和Lloyd Shapley研究了在甲（男士M）、乙（女士W）双方人数相等情况下的“稳定匹配”问题，证明了必定存在“稳定匹配”并给出了一个构造算法：</p><blockquote><b>Gale-Shapley 算法 (男方最优化)</b><br>         首先将所有人初始化为“自由”状态。<br><b>         while</b> (存在某个元素 <equation>m\in M</equation> 处于“自由”状态——即没有被匹配)<br>                 令 <equation>w\in W</equation> 为在 <equation>m</equation> 的列表中尚存的、最靠前的元素<br> <b>if</b> ( <equation>w</equation> 也处于“自由”状态)<br>                         将 <equation>m</equation> 与 <equation>w</equation> 进行匹配<br> <b>else</b> <b>if</b> ( <equation>w</equation> 已经和 <equation>m'\in M</equation> 进行了匹配，且 <equation>w</equation> 看来， <equation>m</equation> 优于 <equation>m'</equation> )<br>                         将 <equation>m</equation> 与 <equation>w</equation> 进行匹配，并将 <equation>m'</equation> 的状态设置为“自由”，<br> <equation>m'</equation> 在自己的列表中划去 <equation>w</equation><br> <b>else</b><br> <equation>m</equation> 在自己的列表中划去 <equation>w</equation> ，自己仍然保持“自由”状态</blockquote><hr><p>例如：</p><img src="https://pic3.zhimg.com/v2-e58bbd64444085cccbc370f2b2f92680_r.jpg" data-caption="" data-size="normal" data-rawwidth="662" data-rawheight="518" data-watermark="watermark" data-original-src="v2-e58bbd64444085cccbc370f2b2f92680" data-watermark-src="v2-ba5dfcc9cf8b5209ef0faa28dda0cfc8" data-private-watermark-src=""><p>之后，</p><p>Step1——</p><img src="https://pic1.zhimg.com/v2-c586208b27dd29123f5e8a8501a0e258_r.jpg" data-caption="" data-size="normal" data-rawwidth="662" data-rawheight="518" data-watermark="watermark" data-original-src="v2-c586208b27dd29123f5e8a8501a0e258" data-watermark-src="v2-ed67be99d4d1d9eaf963255589ad21c8" data-private-watermark-src=""><p>Step2——</p><img src="https://pic4.zhimg.com/v2-d09c0c7326a69c0ff09e62f771553fd5_r.jpg" data-caption="" data-size="normal" data-rawwidth="662" data-rawheight="518" data-watermark="watermark" data-original-src="v2-d09c0c7326a69c0ff09e62f771553fd5" data-watermark-src="v2-6e8d5b87e21a5b5fccce53f4644b48ac" data-private-watermark-src=""><p>Step3——</p><img src="https://pic2.zhimg.com/v2-61ee9d90822147d11936510c29c705ad_r.jpg" data-caption="" data-size="normal" data-rawwidth="662" data-rawheight="518" data-watermark="watermark" data-original-src="v2-61ee9d90822147d11936510c29c705ad" data-watermark-src="v2-d383cae94550a40243007e09578a2ffb" data-private-watermark-src=""><p>Step4——（尝试匹配失败）</p><img src="https://pic4.zhimg.com/v2-c9b015f3450a6c0cc36cb94d775a1ca6_r.jpg" data-caption="" data-size="normal" data-rawwidth="662" data-rawheight="518" data-watermark="watermark" data-original-src="v2-c9b015f3450a6c0cc36cb94d775a1ca6" data-watermark-src="v2-33d4311f3f6fc06e3086662e1c6f6aa9" data-private-watermark-src=""><p>Step5——（替换掉“1”）</p><img src="https://pic2.zhimg.com/v2-766608520114064c1b975260e36e0657_r.jpg" data-caption="" data-size="normal" data-rawwidth="662" data-rawheight="518" data-watermark="watermark" data-original-src="v2-766608520114064c1b975260e36e0657" data-watermark-src="v2-8d753b558ba6aca87eac033cc5f34d55" data-private-watermark-src=""><p>Step6——</p><img src="https://pic1.zhimg.com/v2-b4a2f081dd33bffc85e1c6b9f1d1ba98_r.jpg" data-caption="" data-size="normal" data-rawwidth="662" data-rawheight="518" data-watermark="original" data-original-src="v2-b4a2f081dd33bffc85e1c6b9f1d1ba98" data-watermark-src="v2-17d0db89cc96a19dd50a5d0305093ffe" data-private-watermark-src=""><p>Step7——（替换掉“2”）</p><img src="https://pic3.zhimg.com/v2-3355b8a59d64d2bc9fb5fcbb20c55bd6_r.jpg" data-caption="" data-size="normal" data-rawwidth="662" data-rawheight="518" data-watermark="watermark" data-original-src="v2-3355b8a59d64d2bc9fb5fcbb20c55bd6" data-watermark-src="v2-f22f17aea750c1fe1bc805aa93faaa49" data-private-watermark-src=""><p>Step8——（替换掉“1”）</p><img src="https://pic3.zhimg.com/v2-e7a739ecd2b240c0596b8aef5917eee7_r.jpg" data-caption="" data-size="normal" data-rawwidth="662" data-rawheight="518" data-watermark="watermark" data-original-src="v2-e7a739ecd2b240c0596b8aef5917eee7" data-watermark-src="v2-1b763aeeee94463ea8e4b8f04bab796f" data-private-watermark-src=""><p>Step9——（算法终止）</p><img src="https://pic4.zhimg.com/v2-bc08ab3c2d91ca8c045ef98a98c71399_r.jpg" data-caption="" data-size="normal" data-rawwidth="662" data-rawheight="518" data-watermark="watermark" data-original-src="v2-bc08ab3c2d91ca8c045ef98a98c71399" data-watermark-src="v2-4ac242d5419d96088030254b5324f58d" data-private-watermark-src=""><hr><p>算法的实现也是简单的，这里就说两点：</p><ol><li>每一个元素的状态可以用0/1表示是否处于“自由”状态；</li><li><equation>w</equation> 需要比较 <equation>m</equation> 和 <equation>m'</equation> 时，可以维护一个反向表，存储的是各个男士在 <equation>w</equation> 的意愿中的排序号。例如下图：</li></ol><img src="https://pic4.zhimg.com/v2-7c2e49f29d237e05c2765fd7af5df7d9_r.jpg" data-caption="" data-size="normal" data-rawwidth="566" data-rawheight="207" data-watermark="watermark" data-original-src="v2-7c2e49f29d237e05c2765fd7af5df7d9" data-watermark-src="v2-5e116eaf7e7416ca129526d5a93407cd" data-private-watermark-src=""><p>之后比较<equation>m</equation> 和 <equation>m'</equation> 在反向列表中对应的值即可。</p><hr><p>如果不是两方的话，那么情况会截然不同。</p><p>假设有四名男羽毛球运动员希望组成两组双打，他们各自的意愿是：</p><img src="https://pic4.zhimg.com/v2-812077b08754cd592317368963154bae_r.jpg" data-caption="" data-size="normal" data-rawwidth="213" data-rawheight="262" data-watermark="watermark" data-original-src="v2-812077b08754cd592317368963154bae" data-watermark-src="v2-a2c668c1a02c449563ccb3dce1f833db" data-private-watermark-src=""><p>那么无论什么样的方案<b>都是不稳定的</b>。</p><img src="https://pic1.zhimg.com/v2-8ae3bf8d732b2e54faac4bfb01a3bc68_r.jpg" data-caption="" data-size="normal" data-rawwidth="815" data-rawheight="118" data-watermark="" data-original-src="" data-watermark-src="" data-private-watermark-src=""><hr><p>最后说一句：2012年诺贝尔经济学奖授予Lloyd S. Shapley与Alvin E. Roth。</p><p></p><p></p>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
