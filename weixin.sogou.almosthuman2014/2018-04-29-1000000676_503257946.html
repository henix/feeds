<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>入门 | 机器学习第一课：决策树学习概述与实现</title>
</head>
<body>
<p><a href="https://mp.weixin.qq.com/s?timestamp=1525750003&amp;src=3&amp;ver=1&amp;signature=DQAX*cUGN0BZgdOVLmP8-20O4Bp6d58IK1ze2iQ-Kw-Feur01E2fN2A-CgiwAFEi3uLMS27*MRERZuAtntp9*wOloOjET4Ndz5XspTkxKXJIuHpSpg6EnkQhv-wdDXNxYy8vdhcLpkPCHwvBtx-h*lHCLoL-yoJdXelWNHOex*s=">原文</a></p>
<div class="rich_media_inner">
                        
        
        <div id="page-content" class="rich_media_area_primary">
            
                        <div id="img-content">
                
                <h2 class="rich_media_title" id="activity-name">
                    入门 | 机器学习第一课：决策树学习概述与实现                                    </h2>
                <div id="meta_content" class="rich_media_meta_list">
                                                            <em id="post-date" class="rich_media_meta rich_media_meta_text">2018-04-29</em>

                                        <a class="rich_media_meta rich_media_meta_link rich_media_meta_nickname" href="##" id="post-user">机器之心</a>
                    <span class="rich_media_meta rich_media_meta_text rich_media_meta_nickname">机器之心</span>


                    <div id="js_profile_qrcode" class="profile_container" style="display:none;">
                        <div class="profile_inner">
                            <strong class="profile_nickname">机器之心</strong>
                            <img class="profile_avatar" id="js_profile_qrcode_img" src="" alt="">

                            <p class="profile_meta">
                            <label class="profile_meta_label">微信号</label>
                            <span class="profile_meta_value">almosthuman2014</span>
                            </p>

                            <p class="profile_meta">
                            <label class="profile_meta_label">功能介绍</label>
                            <span class="profile_meta_value">专业的人工智能媒体和产业服务平台</span>
                            </p>
                            
                        </div>
                        <span class="profile_arrow_wrp" id="js_profile_arrow_wrp">
                            <i class="profile_arrow arrow_out"></i>
                            <i class="profile_arrow arrow_in"></i>
                        </span>
                    </div>
                </div>
                                
                
                
                
                                                
                                                                
                
                <div class="rich_media_content " id="js_content">
                    

                    

                    
                    
                    <section style="max-width: 100%;color: rgb(62, 62, 62);font-size: 16px;white-space: normal;background-color: rgb(255, 255, 255);line-height: 28.4444px;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section data-id="85660" data-custom="rgb(117, 117, 118)" data-color="rgb(117, 117, 118)" style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section data-id="85660" data-custom="rgb(117, 117, 118)" data-color="rgb(117, 117, 118)" style="max-width: 100%;border-width: 0px;border-style: initial;border-color: currentcolor;font-family: 微软雅黑;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="margin-top: 2em;padding-top: 0.5em;padding-bottom: 0.5em;max-width: 100%;border-style: solid none;font-family: inherit;text-decoration: inherit;border-top-color: rgb(204, 204, 204);border-bottom-color: rgb(204, 204, 204);border-top-width: 1px;border-bottom-width: 1px;box-sizing: border-box !important;word-wrap: break-word !important;"><p style="margin-top: -1.2em;max-width: 100%;min-height: 1em;text-align: center;line-height: 1.75em;border-width: initial;border-style: initial;border-color: currentcolor;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(255, 255, 255);background-color: rgb(117, 117, 118);box-sizing: border-box !important;word-wrap: break-word !important;">选自HEARTBEAT</span></p><section data-style="white-space: normal; text-align: left;font-size: 14px;line-height: 1.5em; color: rgb(12, 12, 12);" style="padding: 16px 16px 10px;max-width: 100%;font-family: inherit;box-sizing: border-box !important;word-wrap: break-word !important;"><p style="max-width: 100%;min-height: 1em;text-align: center;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(136, 136, 136);box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">作者：Ishan Sharma</span></strong></span></p><p style="max-width: 100%;min-height: 1em;text-align: center;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(136, 136, 136);box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">机器之心编译</span></strong></span></p></section></section></section></section></section></section></section></section></section></section></section></section><p style="max-width: 100%;min-height: 1em;text-align: justify;line-height: 1.75em;box-sizing: border-box !important;word-wrap: break-word !important;"><br></p><blockquote><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;color: rgb(136, 136, 136);">基于树的学习算法在数据科学竞赛中相当常见。这些算法给预测模型赋予了准确性、稳定性以及易解释性。其中，决策树算法也是引人关注的「随机森林」算法的基础构造模块。本文介绍了决策树的概念和简单实现，使用生动的示例帮助理解，希望能够对你有所帮助。</span></p></blockquote><p><br></p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="0.6665" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gW92DQfG3m5xcgEVp8mAmf7vVmw5AqevpGicicoELtdR4Q8UBYfaSt9m9GibhSQCBhRtJib939EqAO9uxg/640?wx_fmt=png" data-type="png" data-w="2000" style=""></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">从 Kaggle 到课堂，机器学习第一课就是决策树。之所以关注决策树，是因为与其他 ML 方法相比，决策树的数学复杂度不高，同时能为分类问题提供足够的精度。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">对于 ML 的入门者来说，决策树很容易上手。本教程将介绍：</span></p><p><br></p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">决策树是什么</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">如何构建决策树</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">使用 Python 构建决策树</span></p></li></ul><p><br></p><p style="text-align: center;line-height: 1.75em;"><strong><span style="font-size: 16px;">决策树是什么</span></strong></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">我们跳过正式定义，从概念上了解一下决策树。试想你坐在办公室里，感觉自己饿了，想出去吃点东西，但是午餐要下午 1 点才开始。那么你怎么办呢？当然，你会看一下时间，然后决定能否出去。你可以按照以下逻辑进行思考：</span></p><p><br></p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="0.75" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gW92DQfG3m5xcgEVp8mAmf7vrW7WGnuRqNg1Zic8s31IkgvK2nzwiauPX6PBMib90B0bY25JzDbD3LxyQ/640?wx_fmt=png" data-type="png" data-w="1200" style=""></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">我们刚刚搭了一个决策树！这是一个简单的版本，但我们可以通过加入天气、成本等因素构建一个更为复杂的决策树。如果你想和你的朋友 Jon Snow 去一家中餐馆吃午饭，决策逻辑可以这样表示：</span></p><p><br></p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="0.75" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gW92DQfG3m5xcgEVp8mAmf7vpUTQXr6dibicu3Gicekny2Iic6uiao5PNAA9S17Afm7HfYB5A3Wlrk6qwLg/640?wx_fmt=png" data-type="png" data-w="1200" style=""></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">这也是一个决策树。从顶部开始，循着描述当前状况的路线一路向下，直到做出决定。</span></p><p><br></p><p style="text-align: center;line-height: 1.75em;"><span style="font-size: 16px;"><strong>注意事项</strong></span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">我们把场景切换到计算机世界。我们刚刚画的每一个框叫做一个节点。最上面的节点叫做根节点，下面每层的节点叫做叶节点，可以把它想成现实世界中的一棵树，但是根朝上。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">每个节点测试我们的世界（数据集）中的某个属性，从节点引出的每个分支对应于该属性的值。给定一棵决策树，决策过程如下：</span></p><p><br></p><ol class=" list-paddingleft-2" style="list-style-type: decimal;"><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">从根节点开始</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">观察根节点属性的值</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">按照与观察值对应的路径往下走</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">重复以上步骤，直至到达叶节点，这样就能做出决策</span></p></li></ol><p><br></p><p style="text-align: center;line-height: 1.75em;"><span style="font-size: 16px;"><strong>如何构建决策树？</strong></span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">构建决策树不需要从头开始（除非你是一个像我一样的学生）。尽管如此，这也是一个很好的学习经验，你将学到一些有趣的概念。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">构建决策树最常用的算法是 ID3，该算法非常简单。以下是算法伪代码：</span></p><p><br></p><pre class="prettyprint linenums prettyprinted" style="box-sizing: border-box;margin-top: 0px;margin-bottom: 0px;padding: 8px 0px 6px;background-color: rgb(27, 24, 27);border-radius: 0px;overflow-y: auto;color: rgb(80, 97, 109);font-size: 10px;line-height: 12px;"><ol class="linenums list-paddingleft-2" style="list-style-type: none;"><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">ID3 (</span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Examples</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">, </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Target_Attribute</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">, </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Attributes</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">)</span></code></span></p></li><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">    </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Create</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> a root node </span><span class="kwd" style="box-sizing: border-box;color: rgb(123, 89, 192);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">for</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> the tree</span></code></span></p></li><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">    </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">If</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> all examples are positive, </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Return</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> the single-node tree </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Root</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">, </span><span class="kwd" style="box-sizing: border-box;color: rgb(123, 89, 192);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">with</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> label = +.</span></code></span></p></li><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">    </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">If</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> all examples are negative, </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Return</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> the single-node tree </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Root</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">, </span><span class="kwd" style="box-sizing: border-box;color: rgb(123, 89, 192);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">with</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> label = -.</span></code></span></p></li><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">    </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">If</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Atributes</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> list </span><span class="kwd" style="box-sizing: border-box;color: rgb(123, 89, 192);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">is</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> empty, then </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Return</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> the single node tree </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Root</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">,</span></code></span></p></li><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">    </span><span class="kwd" style="box-sizing: border-box;color: rgb(123, 89, 192);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">with</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> label = most common value of the target attribute </span><span class="kwd" style="box-sizing: border-box;color: rgb(123, 89, 192);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">in</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> the examples.</span></code></span></p></li><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">    </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Otherwise</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Begin</span></code></span></p></li><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">        A ← </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">The</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Attribute</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> that best classifies examples.</span></code></span></p></li><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">        </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Decision</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Tree</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> attribute </span><span class="kwd" style="box-sizing: border-box;color: rgb(123, 89, 192);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">for</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Root</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> = A.</span></code></span></p></li><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">        </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">For</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> each possible value, vi, of A,</span></code></span></p></li><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">            </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Add</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> a new tree branch below </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Root</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">, corresponding to the test A = vi.</span></code></span></p></li><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">            </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Let</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Examples</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">(vi) be the subset of examples that have the value vi </span><span class="kwd" style="box-sizing: border-box;color: rgb(123, 89, 192);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">for</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> A</span></code></span></p></li><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">            </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">If</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Examples</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">(vi) </span><span class="kwd" style="box-sizing: border-box;color: rgb(123, 89, 192);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">is</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> empty</span></code></span></p></li><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">                </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Then</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> below this new branch add a leaf node </span><span class="kwd" style="box-sizing: border-box;color: rgb(123, 89, 192);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">with</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> label = most common target value </span><span class="kwd" style="box-sizing: border-box;color: rgb(123, 89, 192);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">in</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> the examples</span></code></span></p></li><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">            </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Else</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> below this new branch add the subtree ID3 (</span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Examples</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">(vi), </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Target_Attribute</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">, </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Attributes</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> – {A})</span></code></span></p></li><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">    </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">End</span></code></span></p></li><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">    </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Return</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Root</span></code></span></p></li></ol></pre><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">你将注意到这样一个细节：在循环开始之后，算法必须选择一个属性，为样本分类选出最佳方案。那么算法会怎么做呢？为了理解这一点，我们必须深入了解一些数学知识。别担心，不会太难。</span></p><p><br></p><p style="text-align: center;line-height: 1.75em;"><strong><span style="font-size: 16px;">信息增益和熵</span></strong></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">信息增益是选择最佳属性常用且容易上手的方法之一。它使用另一种叫做熵的属性计算出来。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">熵是物理学和数学中的概念，指系统的随机性或混乱度。在信息论中，它指的是一组样本的混乱度。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">我们通过一个例子来说明：你有两个装满巧克力的袋子。巧克力有红的也有蓝的。你想通过计算巧克力的数量来测量袋子的熵。所以你坐下来开始数。2 分钟后，你发现第一袋有 50 块巧克力。其中 25 块是红色的，25 块是蓝色的。第二袋也有 50 块巧克力，都是蓝色的。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">在这种情况下，第一个袋子的熵是 1，因为里面的巧克力呈均匀分布。第二个袋子的熵为零，因为里面的巧克力没有随机性。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">我们用下面这个公式计算一个系统的熵：</span></p><p><br></p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="0.2633333333333333" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gW92DQfG3m5xcgEVp8mAmf7vZAs8UURJK4ZGdGC5N3MN3brRq0NfYAMHqEJd8lLLw9yZRsVicSiaDyiaw/640?wx_fmt=png" data-type="png" data-w="600" style=""></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">在这个公式中，c 代表类别或属性的总数，p_i 代表属于第 i 类的样本数量。是不是有点懵？我们通过例子了解一下：</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">让我们回到刚刚的巧克力袋子。我们有两个类别：红色（R）和蓝色（B）。第一个袋子里有 25 块红色巧克力。巧克力总数是 50。因此，p_i=25/50。蓝色类别也是这样处理。把这些值代入熵方程，我们得到以下结果：</span></p><p><br></p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="0.17955801104972377" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gW92DQfG3m5xcgEVp8mAmf7vaf93D09KjjnZ4MiaTFib16H3Q5xFwuicH4cMXNM2odTnYrqV3icujPk8qQ/640?wx_fmt=png" data-type="png" data-w="724" style=""></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">解方程，结果如下：</span></p><p><br></p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="0.7814726840855107" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gW92DQfG3m5xcgEVp8mAmf7vE2qfiaCyOecxZz0cBvWGpfJUIO8gQ2aWBltyOxADQY0YYOiahCVrpLmQ/640?wx_fmt=png" data-type="png" data-w="842" style=""></p><p><br></p><p style="text-align: left;line-height: 1.75em;"><span style="font-size: 15px;">如果想验证结果或尝试其他例子，请移步 Wolfram Alpha：http://www.wolframalpha.com/input/?i=-(25%2F50)log2(25%2F50)+-+(25%2F50)log2(25%2F50)。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">继续计算第二个袋子的熵，里面有 50 块红色巧克力，0 块蓝色巧克力。得到的熵是 0。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">如果你理解这个概念，太好了！我们现在转到信息增益。</span></p><p><br></p><p style="text-align: center;line-height: 1.75em;"><span style="font-size: 16px;"><strong>信息增益</strong></span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">信息增益是由基于给定属性的样本分割导致的熵下降。从数学角度上看，信息增益的定义为：</span></p><p><br></p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="0.16603053435114504" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gW92DQfG3m5xcgEVp8mAmf7v3zyxIZtJADKk7YGFwRwp5jI4GIZda42UiaIczh1FntNSwJGuzqF0NfA/640?wx_fmt=png" data-type="png" data-w="1048" style=""></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">S 代表整个样本集，A 代表我们想要分割的属性。|S| 代表样本数量，|Sv| 表示属性 A 当前值的样本数量。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">仍然很复杂，是不是？那我们举个例子，看看它的工作流程。</span></p><p><br></p><p style="text-align: center;line-height: 1.75em;"><strong><span style="font-size: 16px;">构建决策树</span></strong></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">首先，给巧克力的例子添加一些细节。我们已经知道袋 1 中有 25 块红色巧克力、25 块蓝色巧克力。现在，我们还要考虑巧克力的品牌。红色巧克力中，有 15 块是士力架，10 块是 Kit Kat 牌。蓝色巧克力中，20 块是 Kit Kat 牌，5 块是士力架。假设我们只想吃红色的士力架。那么这里，红色士力架（15）是正例，其他的巧克力（如红色 Kit Kat 和蓝色士力架）都是负例。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">现在，与我们的类别（吃／不吃）相关的数据集的熵是：</span></p><p><br></p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="0.314540059347181" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gW92DQfG3m5xcgEVp8mAmf7v8WVgyxS942zn82O7y1Mxmia6UlFibibefPibSeiaTZUoOfKeu4AGWx5sWeg/640?wx_fmt=png" data-type="png" data-w="337" style=""></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">现在我们来回顾一下，我们有 50 块巧克力。如果只看属性「颜色」，则我们有 25 个红色的、25 个蓝色的。如果看属性「品牌」，则我们有 20 块士力架、30 块 Kit Kat 巧克力。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">为了构建决策树，我们需要选择其中一个属性作为根节点。我们想要选择具备最高信息增益的属性。现在我们来计算这些属性的信息增益。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">颜色相关的信息增益是：</span></p><p><br></p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="0.21978021978021978" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gW92DQfG3m5xcgEVp8mAmf7vELRl6YH7r2aAkvZtoJOgalYKthoL73HMRIOrXgRsVQmiaMFicSclNmGg/640?wx_fmt=png" data-type="png" data-w="728" style=""></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">我们刚才计算了与类别相关的巧克力的熵，是 0.8812。如果我们想吃 15 块士力架而不是 10 块 Kit Kat，则红色巧克力的熵是：</span></p><p><br></p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="0.20871559633027523" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gW92DQfG3m5xcgEVp8mAmf7vYq2VL6zn8rTfgzHwpYNNwQKKX9WtGicBUyBWgNOR3fgxY1fLZzLWZsg/640?wx_fmt=png" data-type="png" data-w="436" style=""></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">如果我们不想吃蓝色巧克力，则熵为 0。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">我们的信息增益计算就变成了：</span></p><p><br></p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="0.11782032400589101" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gW92DQfG3m5xcgEVp8mAmf7voNOe5wXPJZgtML2goMLo5FnBwDs3aMJfgE3P7WUr0GpPWnibx4jMg7Q/640?wx_fmt=png" data-type="png" data-w="679" style=""></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">如果我们分割颜色，则信息增益是 0.3958。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">现在我们来看下品牌。如果我们想吃 15 块士力架（共有 20 块），不想吃 Kit Kat。则士力架的熵是：</span></p><p><br></p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="0.21291866028708134" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gW92DQfG3m5xcgEVp8mAmf7v0GIxlU1NJLKHqkr25ReCWzYSxLvgACGyb6BtGNCyJDh0d1d0OswAKA/640?wx_fmt=png" data-type="png" data-w="418" style=""></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">如果我们不吃 Kit Kat，则熵为 0。信息增益为：</span></p><p><br></p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="0.15764331210191082" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gW92DQfG3m5xcgEVp8mAmf7vHwICJfu1W9Q4chUcrsmkroB2RYXsN3UiaVYFrngQUCWRDbiaBbxVrE3A/640?wx_fmt=png" data-type="png" data-w="628" style=""></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">品牌分割的信息增益是 0.5567。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">由于品牌的信息增益较大，我们将基于品牌进行分割。下一级，我们只要左边的颜色。我们可以轻松地根据颜色进行分割，无需进行任何计算。决策树如下：</span></p><p><br></p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="0.75" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gW92DQfG3m5xcgEVp8mAmf7vmhIwWUokTg5sZsmN3etCbiciaoUb3uW48m3FfiaH0LF6YMQ0sSsQNRruA/640?wx_fmt=png" data-type="png" data-w="1200" style=""></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">谁能想到吃块巧克力这么难呢？</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">现在你应该了解决策树的运行原理了。</span></p><p><br></p><p style="text-align: center;line-height: 1.75em;"><strong><span style="font-size: 16px;">使用 Python 3 实现决策树</span></strong></p><p><br></p><p style="text-align: left;line-height: 1.75em;"><span style="font-size: 15px;">现在我们继续为巧克力数据集构建决策树。</span></p><p style="text-align: left;line-height: 1.75em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">代码和数据地址：https://github.com/ishansharma/decision_trees_tutorial/</span></p><p><br></p><ol class=" list-paddingleft-2" style="list-style-type: decimal;"><li><p style="text-align: left;line-height: 1.75em;"><span style="font-size: 15px;">创建新文件夹。</span></p></li><li><p style="text-align: left;line-height: 1.75em;"><span style="font-size: 15px;">从 GitHub 下载 data.csv（https://github.com/ishansharma/decision_trees_tutorial/blob/master/data.csv）。</span></p></li><li><p style="text-align: left;line-height: 1.75em;"><span style="font-size: 15px;">你可能需要安装 Scipy、Scikit-Learn 和 Pandas，如果没有安装的话。我推荐使用虚拟环境，参见：http://docs.python-guide.org/en/latest/dev/virtualenvs/。从终端运行以下命令行，安装 Pandas 和 Scikit-Learn：</span></p></li></ol><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;background-color: rgb(214, 214, 214);"></span></p><pre class="prettyprint linenums prettyprinted" style="box-sizing: border-box;margin-top: 0px;margin-bottom: 0px;padding: 8px 0px 6px;background-color: rgb(27, 24, 27);border-radius: 0px;overflow-y: auto;color: rgb(80, 97, 109);font-size: 10px;line-height: 12px;"><ol class="linenums list-paddingleft-2" style="list-style-type: none;"><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><span style="box-sizing: border-box;line-height: 22px;display: block;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">pip install scikit</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">-</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">learn</span></code></span></span></p></li><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><span style="box-sizing: border-box;line-height: 22px;display: block;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">pip install scipy</span></code></span></span></p></li><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><span style="box-sizing: border-box;line-height: 22px;display: block;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">pip install pandas</span></code></span></span></p></li></ol></pre><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;background-color: rgb(214, 214, 214);"></span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">4. 安装后，创建新文件 decision_tree.py，并将以下两行添加进去：</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;background-color: rgb(214, 214, 214);"></span></p><pre class="prettyprint linenums prettyprinted" style="box-sizing: border-box;margin-top: 0px;margin-bottom: 0px;padding: 8px 0px 6px;background-color: rgb(27, 24, 27);border-radius: 0px;overflow-y: auto;color: rgb(80, 97, 109);font-size: 10px;line-height: 12px;"><ol class="linenums list-paddingleft-2" style="list-style-type: none;"><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><span style="box-sizing: border-box;line-height: 22px;display: block;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="kwd" style="box-sizing: border-box;color: rgb(123, 89, 192);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">from</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> pandas </span><span class="kwd" style="box-sizing: border-box;color: rgb(123, 89, 192);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">import</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> read_csv</span></code></span></span></p></li><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><span style="box-sizing: border-box;line-height: 22px;display: block;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="kwd" style="box-sizing: border-box;color: rgb(123, 89, 192);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">from</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> sklearn </span><span class="kwd" style="box-sizing: border-box;color: rgb(123, 89, 192);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">import</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> tree</span></code></span></span></p></li></ol></pre><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;background-color: rgb(214, 214, 214);"></span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">5. 使用 Pandas 加载数据：</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;background-color: rgb(214, 214, 214);"></span></p><pre class="prettyprint linenums prettyprinted" style="box-sizing: border-box;margin-top: 0px;margin-bottom: 0px;padding: 8px 0px 6px;background-color: rgb(27, 24, 27);border-radius: 0px;overflow-y: auto;color: rgb(80, 97, 109);font-size: 10px;line-height: 12px;"><ol class="linenums list-paddingleft-2" style="list-style-type: none;"><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><span style="box-sizing: border-box;line-height: 22px;display: block;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">data </span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">=</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> read_csv</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">(</span><span class="str" style="box-sizing: border-box;color: rgb(145, 139, 59);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">"data.csv"</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">)</span></code></span></span></p></li></ol></pre><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;background-color: rgb(214, 214, 214);"></span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">6. Pandas 可以处理大型数据集，且具备大量可视化功能。它在使用 Python 的大数据流程中广泛使用，因此使用 Pandas 是个好主意。在 Pandas 中你可以使用 head() 方法快速查看加载数据：</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;background-color: rgb(214, 214, 214);"></span></p><pre class="prettyprint linenums prettyprinted" style="box-sizing: border-box;margin-top: 0px;margin-bottom: 0px;padding: 8px 0px 6px;background-color: rgb(27, 24, 27);border-radius: 0px;overflow-y: auto;color: rgb(80, 97, 109);font-size: 10px;line-height: 12px;"><ol class="linenums list-paddingleft-2" style="list-style-type: none;"><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><span style="box-sizing: border-box;line-height: 22px;display: block;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="kwd" style="box-sizing: border-box;color: rgb(123, 89, 192);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">print</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">(</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">data</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">.</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">head</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">())</span></code></span></span></p></li></ol></pre><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;background-color: rgb(214, 214, 214);"></span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">下图显示了数据的前 5 行。</span></p><p><br></p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="0.517948717948718" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gW92DQfG3m5xcgEVp8mAmf7vK271hicARzyhThqRXju6CZ1MhKocmwxibVDvc01c2VM8RcgFqE1hMs7g/640?wx_fmt=png" data-type="png" data-w="390" style=""></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">7. 我使用 Class 列来确定我们是否想吃巧克力。1 代表吃，0 代表不吃。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">8. 接下来，我们需要对数据执行一些预处理。Scikit-Learn 默认不支持文本标签，因此我们使用 Pandas 将文本标签转换成数字。只需要添加以下两行：</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;background-color: rgb(214, 214, 214);"></span></p><pre class="prettyprint linenums prettyprinted" style="box-sizing: border-box;margin-top: 0px;margin-bottom: 0px;padding: 8px 0px 6px;background-color: rgb(27, 24, 27);border-radius: 0px;overflow-y: auto;color: rgb(80, 97, 109);font-size: 10px;line-height: 12px;"><ol class="linenums list-paddingleft-2" style="list-style-type: none;"><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><span style="box-sizing: border-box;line-height: 22px;display: block;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">data</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">[</span><span class="str" style="box-sizing: border-box;color: rgb(145, 139, 59);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">'Color'</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">]</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> </span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">=</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> data</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">[</span><span class="str" style="box-sizing: border-box;color: rgb(145, 139, 59);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">'Color'</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">].</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">map</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">({</span><span class="str" style="box-sizing: border-box;color: rgb(145, 139, 59);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">'Red'</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">:</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> </span><span class="lit" style="box-sizing: border-box;color: rgb(166, 89, 38);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">0</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">,</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> </span><span class="str" style="box-sizing: border-box;color: rgb(145, 139, 59);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">'Blue'</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">:</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> </span><span class="lit" style="box-sizing: border-box;color: rgb(166, 89, 38);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">1</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">})</span></code></span></span></p></li><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><span style="box-sizing: border-box;line-height: 22px;display: block;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">data</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">[</span><span class="str" style="box-sizing: border-box;color: rgb(145, 139, 59);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">'Brand'</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">]</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> </span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">=</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> data</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">[</span><span class="str" style="box-sizing: border-box;color: rgb(145, 139, 59);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">'Brand'</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">].</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">map</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">({</span><span class="str" style="box-sizing: border-box;color: rgb(145, 139, 59);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">'Snickers'</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">:</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> </span><span class="lit" style="box-sizing: border-box;color: rgb(166, 89, 38);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">0</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">,</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> </span><span class="str" style="box-sizing: border-box;color: rgb(145, 139, 59);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">'Kit Kat'</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">:</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> </span><span class="lit" style="box-sizing: border-box;color: rgb(166, 89, 38);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">1</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">})</span></code></span></span></p></li></ol></pre><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;background-color: rgb(214, 214, 214);"></span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">9. 刚才我们改变了 Color 属性，用 0 代表红色，1 代表蓝色。类似地，在 Brand 列中，我们用 0 替代士力架，用 1 替换 Kit Kat。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">10. 如果你使用 head() 查看数据集，你将看到品牌和颜色的值已经变成了整数：</span></p><p><br></p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="0.5465116279069767" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gW92DQfG3m5xcgEVp8mAmf7v4XVIjwfSiaz09WZfrNpS50Izz2At2CyPRicXrc6ia6f1pr2tLYCkI1Bqg/640?wx_fmt=png" data-type="png" data-w="344" style=""></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">11. 最后，按惯例用 X 表示训练属性，Y 表示输出类别，因此我们执行以下命令：</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;background-color: rgb(214, 214, 214);"></span></p><pre class="prettyprint linenums prettyprinted" style="box-sizing: border-box;margin-top: 0px;margin-bottom: 0px;padding: 8px 0px 6px;background-color: rgb(27, 24, 27);border-radius: 0px;overflow-y: auto;color: rgb(80, 97, 109);font-size: 10px;line-height: 12px;"><ol class="linenums list-paddingleft-2" style="list-style-type: none;"><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><span style="box-sizing: border-box;line-height: 22px;display: block;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">predictors </span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">=</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> </span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">[</span><span class="str" style="box-sizing: border-box;color: rgb(145, 139, 59);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">'Color'</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">,</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> </span><span class="str" style="box-sizing: border-box;color: rgb(145, 139, 59);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">'Brand'</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">]</span></code></span></span></p></li><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><span style="box-sizing: border-box;line-height: 22px;display: block;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">X </span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">=</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> data</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">[</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">predictors</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">]</span></code></span></span></p></li><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><span style="box-sizing: border-box;line-height: 22px;display: block;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Y </span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">=</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> data</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">.</span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Class</span></code></span></span></p></li></ol></pre><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;background-color: rgb(214, 214, 214);"></span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">12. 差不多完成了。我们现在已经准备好训练决策树了。添加以下两行在我们的数据上训练决策树：</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;background-color: rgb(214, 214, 214);"></span></p><pre class="prettyprint linenums prettyprinted" style="box-sizing: border-box;margin-top: 0px;margin-bottom: 0px;padding: 8px 0px 6px;background-color: rgb(27, 24, 27);border-radius: 0px;overflow-y: auto;color: rgb(80, 97, 109);font-size: 10px;line-height: 12px;"><ol class="linenums list-paddingleft-2" style="list-style-type: none;"><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><span style="box-sizing: border-box;line-height: 22px;display: block;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">decisionTreeClassifier </span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">=</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> tree</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">.</span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">DecisionTreeClassifier</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">(</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">criterion</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">=</span><span class="str" style="box-sizing: border-box;color: rgb(145, 139, 59);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">"entropy"</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">)</span></code></span></span></p></li><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><span style="box-sizing: border-box;line-height: 22px;display: block;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">dTree </span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">=</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> decisionTreeClassifier</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">.</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">fit</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">(</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">X</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">,</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> Y</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">)</span></code></span></span></p></li></ol></pre><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">13. 完成了吗？我们对决策树进行快速可视化。添加下列行，并运行程序：</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;background-color: rgb(214, 214, 214);"></span></p><pre class="prettyprint linenums prettyprinted" style="box-sizing: border-box;margin-top: 0px;margin-bottom: 0px;padding: 8px 0px 6px;background-color: rgb(27, 24, 27);border-radius: 0px;overflow-y: auto;color: rgb(80, 97, 109);font-size: 10px;line-height: 12px;"><ol class="linenums list-paddingleft-2" style="list-style-type: none;"><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><span style="box-sizing: border-box;line-height: 22px;display: block;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">dotData </span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">=</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> tree</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">.</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">export_graphviz</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">(</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">dTree</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">,</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> out_file</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">=</span><span class="kwd" style="box-sizing: border-box;color: rgb(123, 89, 192);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">None</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">)</span></code></span></span></p></li><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><span style="box-sizing: border-box;line-height: 22px;display: block;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="kwd" style="box-sizing: border-box;color: rgb(123, 89, 192);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">print</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">(</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">dotData</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">)</span></code></span></span></p></li></ol></pre><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;background-color: rgb(214, 214, 214);"></span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">14. 输出如下：</span></p><p><br></p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="0.3491773308957952" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gW92DQfG3m5xcgEVp8mAmf7vqickW527b2IfP6a3Wq26WfzNLetEXHD9AuUSL4wKWfKHCnYOgxdIg3Q/640?wx_fmt=png" data-type="png" data-w="1094" style=""></p><p><br></p><p style="text-align: left;line-height: 1.75em;"><span style="font-size: 15px;">15. 复制输出，访问 WebGraphviz (http://www.webgraphviz.com/) 并粘贴输出，点击 Generate Graph。你讲看到一个与上文决策树类似的决策树：</span></p><p><br></p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="1.0127877237851663" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gW92DQfG3m5xcgEVp8mAmf7viaDN1sEw91EicQECmc3AB8eBImkjc9626AFmlX5EQzYx6q0I1gRLiaZ9g/640?wx_fmt=png" data-type="png" data-w="782" style=""></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">16. 这颗树有点难懂，因为有很多额外信息，不过你可以看到它先基于列 1（Brand）进行分割，再基于列 2（Color）进行分割。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">一旦构建处这颗树，那么未来的预测就很简单了。我们来看一下我们是否想吃蓝色的 Kit Kat 巧克力。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">将以下行添加至 decision_tree.py 文件的末尾：</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;background-color: rgb(214, 214, 214);"></span></p><pre class="prettyprint linenums prettyprinted" style="box-sizing: border-box;margin-top: 0px;margin-bottom: 0px;padding: 8px 0px 6px;background-color: rgb(27, 24, 27);border-radius: 0px;overflow-y: auto;color: rgb(80, 97, 109);font-size: 10px;line-height: 12px;"><ol class="linenums list-paddingleft-2" style="list-style-type: none;"><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><span style="box-sizing: border-box;line-height: 22px;display: block;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="kwd" style="box-sizing: border-box;color: rgb(123, 89, 192);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">print</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">(</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">dTree</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">.</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">predict</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">([[</span><span class="lit" style="box-sizing: border-box;color: rgb(166, 89, 38);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">1</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">,</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> </span><span class="lit" style="box-sizing: border-box;color: rgb(166, 89, 38);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">1</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">]]))</span></code></span></span></p></li></ol></pre><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;background-color: rgb(214, 214, 214);"></span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">输出为 [0]，意味着分类是不吃。如果你尝试红色士力架（print(dTree.predict([[0, 0]]))），则输出是 [1]。</span></p><p><br></p><p style="text-align: center;line-height: 1.75em;"><strong><span style="font-size: 16px;">继续研究</span></strong></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">经过以上学习，你应该对决策树有所了解，同时学会了简单的实现。如果希望进一步探索，你可以参考这些资源：</span></p><p><br></p><ol class=" list-paddingleft-2" style="list-style-type: decimal;"><li><p style="text-align: left;line-height: 1.75em;"><span style="font-size: 15px;">Scikit-Learn 上的决策树页面，讨论在更大的数据集和其他度量下分割数据：http://scikit-learn.org/stable/modules/tree.html</span></p></li><li><p style="text-align: left;line-height: 1.75em;"><span style="font-size: 15px;">Kaggle 上的机器学习教程，一个深度教程，教你参与 Kaggle 竞赛，并构建一个住房数据的决策树模型：https://www.kaggle.com/learn/machine-learning</span></p></li><li><p style="text-align: left;line-height: 1.75em;"><span style="font-size: 15px;">Saving your Scikit Models：本教程中，每次运行都会训练一遍模型。这在小数据集中还可以接受，但对于更大的数据集来说最好是一次训练，随后仅使用。这个教程可以教你如何保存自己的模型：http://scikit-learn.org/stable/modules/model_persistence.html</span></p></li><li><p style="text-align: left;line-height: 1.75em;"><span style="font-size: 15px;">将训练好的模型转换为 Core ML：如果你为另一个数据集训练了自己的决策树，并希望在 iOS 设备上运行，那么你就需要将已训练模型转换为 Core ML 框架版本：https://developer.apple.com/documentation/coreml/converting_trained_models_to_core_ml <img class="" data-ratio="0.3287671232876712" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gW8Zfpicd40EribGuaFicDBCRH6IOu1Rnc4T3W3J1wE0j6kQ6GorRSgicib0fmNrj3yzlokup2jia9Z0YVeA/640?wx_fmt=png" data-type="png" data-w="73" style="color: rgb(62, 62, 62);text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);font-size: 14px;box-sizing: border-box !important;word-wrap: break-word !important;visibility: visible !important;width: 48px !important;" width="48px"></span></p></li></ol><p><br></p><p style="line-height: 1.75em;"><span style="color: rgb(136, 136, 136);"><em><span style="font-size: 12px;">原文链接：https://heartbeat.fritz.ai/introduction-to-decision-tree-learning-cd604f85e236</span></em></span></p><p><br></p><p><br></p><p style="max-width: 100%;min-height: 1em;background-color: rgb(255, 255, 255);box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;text-align: justify;line-height: 25.6px;font-family: 微软雅黑;font-size: 14px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(127, 127, 127);box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;color: rgb(62, 62, 62);line-height: 25.6px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(127, 127, 127);box-sizing: border-box !important;word-wrap: break-word !important;">本文为机器之心编译，<strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;">转载请联系本公众号获得授权</span></strong></span></strong>。</span></strong><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></p><p style="margin-bottom: 5px;max-width: 100%;min-height: 1em;background-color: rgb(255, 255, 255);font-size: 18px;line-height: 1.75em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(127, 127, 127);line-height: 25.6px;font-family: 微软雅黑;text-align: justify;box-sizing: border-box !important;word-wrap: break-word !important;">✄------------------------------------------------</span></p><p style="margin-bottom: 5px;max-width: 100%;min-height: 1em;background-color: rgb(255, 255, 255);font-size: 18px;font-family: 微软雅黑;text-align: center;line-height: 1.75em;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(217, 33, 66);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">加入机器之心（全职记者/实习生）：hr@jiqizhixin.com</span></strong></p><p style="max-width: 100%;min-height: 1em;background-color: rgb(255, 255, 255);font-size: 18px;font-family: 微软雅黑;text-align: center;line-height: 1.75em;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(217, 33, 66);line-height: 1.6;font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">投稿或寻求报道：editor@jiqizhixin.com</span></strong></p><p style="max-width: 100%;min-height: 1em;background-color: rgb(255, 255, 255);font-size: 18px;font-family: 微软雅黑;text-align: center;line-height: 1.75em;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 12px;color: rgb(217, 33, 66);line-height: 1.6;box-sizing: border-box !important;word-wrap: break-word !important;">广告&amp;商务合作：bd@jiqizhixin.com</span></strong></p>
                </div>
                <script nonce="158878684" type="text/javascript">
                    var first_sceen__time = (+new Date());

                    if ("" == 1 && document.getElementById('js_content')) {
                        document.getElementById('js_content').addEventListener("selectstart",function(e){ e.preventDefault(); });
                    }

                    
                    (function(){
                        if (navigator.userAgent.indexOf("WindowsWechat") != -1){
                            var link = document.createElement('link');
                            var head = document.getElementsByTagName('head')[0];
                            link.rel = 'stylesheet';
                            link.type = 'text/css';
                            link.href = "//res.wx.qq.com/mmbizwap/zh_CN/htmledition/style/page/appmsg/page_mp_article_improve_winwx3d171e.css";
                            head.appendChild(link);
                        }
                    })();
                </script>
                
                
                                
                <div class="ct_mpda_wrp" id="js_sponsor_ad_area" style="display:none;"></div>

                
                                <div class="reward_area tc" id="js_preview_reward" style="display:none;">
                    <p id="js_preview_reward_wording" class="tips_global reward_tips" style="display:none;"></p>
                    <p>
                        <a class="reward_access" id="js_preview_reward_link" href="##"><span class="icon-reward"></span>赞赏</a>

                    </p>
                </div>
                <div class="reward_qrcode_area reward_area tc" id="js_preview_reward_qrcode" style="display:none;">
                    <p class="tips_global">长按二维码向我转账</p>
                    <p id="js_preview_reward_ios_wording" class="reward_tips" style="display:none;"></p>
                    <span class="reward_qrcode_img_wrp"><img class="reward_qrcode_img" src="//res.wx.qq.com/mmbizwap/zh_CN/htmledition/images/pic/appmsg/pic_reward_qrcode.2x3534dd.png"></span>
                    <p class="tips_global">受苹果公司新规定影响，微信 iOS 版的赞赏功能被关闭，可通过二维码转账支持公众号。</p>
                </div>
                            </div>
                        
            <ul id="js_hotspot_area" class="article_extend_area"></ul>


            
                        <div class="rich_media_tool" id="js_toobar3">
                
                                
                                            <div id="js_read_area3" class="media_tool_meta tips_global meta_primary" style="display:none;">阅读 <span id="readNum3"></span></div>

                <span style="display:none;" class="media_tool_meta meta_primary tips_global meta_praise" id="like3">
                    <i class="icon_praise_gray"></i><span class="praise_num" id="likeNum3"></span>
                </span>

                <a id="js_report_article3" style="display:none;" class="media_tool_meta tips_global meta_extra" href="##">投诉</a>

            </div>


                        <div class="rich_media_tool" id="js_sg_bar">
                
                                
                                
            </div>
                    </div>

        <div class="rich_media_area_primary sougou" id="sg_tj" style="display:none"></div>

        
        <div class="rich_media_area_extra">

            
                        <div class="mpda_bottom_container" id="js_bottom_ad_area"></div>
                        
            <div id="js_iframetest" style="display:none;"></div>
                        
                        
            <div class="rich_media_extra rich_media_extra_discuss" id="js_friend_cmt_area" style="display:none">
              
              
              
            </div>

                        <div class="rich_media_extra rich_media_extra_discuss" id="js_cmt_area" style="display:none">
            </div>
                    </div>

        
        <div id="js_pc_qr_code" class="qr_code_pc_outer" style="display:none;">
            <div class="qr_code_pc_inner">
                <div class="qr_code_pc">
                    <img id="js_pc_qr_code_img" class="qr_code_pc_img">
                    <p>微信扫一扫<br>关注该公众号</p>
                </div>
            </div>
        </div>
    </div><div id="img-content">
                
                <h2 class="rich_media_title" id="activity-name">
                    入门 | 机器学习第一课：决策树学习概述与实现                                    </h2>
                <div id="meta_content" class="rich_media_meta_list">
                                                            <em id="post-date" class="rich_media_meta rich_media_meta_text">2018-04-29</em>

                                        <a class="rich_media_meta rich_media_meta_link rich_media_meta_nickname" href="##" id="post-user">机器之心</a>
                    <span class="rich_media_meta rich_media_meta_text rich_media_meta_nickname">机器之心</span>


                    <div id="js_profile_qrcode" class="profile_container" style="display:none;">
                        <div class="profile_inner">
                            <strong class="profile_nickname">机器之心</strong>
                            <img class="profile_avatar" id="js_profile_qrcode_img" src="" alt="">

                            <p class="profile_meta">
                            <label class="profile_meta_label">微信号</label>
                            <span class="profile_meta_value">almosthuman2014</span>
                            </p>

                            <p class="profile_meta">
                            <label class="profile_meta_label">功能介绍</label>
                            <span class="profile_meta_value">专业的人工智能媒体和产业服务平台</span>
                            </p>
                            
                        </div>
                        <span class="profile_arrow_wrp" id="js_profile_arrow_wrp">
                            <i class="profile_arrow arrow_out"></i>
                            <i class="profile_arrow arrow_in"></i>
                        </span>
                    </div>
                </div>
                                
                
                
                
                                                
                                                                
                
                <div class="rich_media_content " id="js_content">
                    

                    

                    
                    
                    <section style="max-width: 100%;color: rgb(62, 62, 62);font-size: 16px;white-space: normal;background-color: rgb(255, 255, 255);line-height: 28.4444px;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section data-id="85660" data-custom="rgb(117, 117, 118)" data-color="rgb(117, 117, 118)" style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section data-id="85660" data-custom="rgb(117, 117, 118)" data-color="rgb(117, 117, 118)" style="max-width: 100%;border-width: 0px;border-style: initial;border-color: currentcolor;font-family: 微软雅黑;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="margin-top: 2em;padding-top: 0.5em;padding-bottom: 0.5em;max-width: 100%;border-style: solid none;font-family: inherit;text-decoration: inherit;border-top-color: rgb(204, 204, 204);border-bottom-color: rgb(204, 204, 204);border-top-width: 1px;border-bottom-width: 1px;box-sizing: border-box !important;word-wrap: break-word !important;"><p style="margin-top: -1.2em;max-width: 100%;min-height: 1em;text-align: center;line-height: 1.75em;border-width: initial;border-style: initial;border-color: currentcolor;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(255, 255, 255);background-color: rgb(117, 117, 118);box-sizing: border-box !important;word-wrap: break-word !important;">选自HEARTBEAT</span></p><section data-style="white-space: normal; text-align: left;font-size: 14px;line-height: 1.5em; color: rgb(12, 12, 12);" style="padding: 16px 16px 10px;max-width: 100%;font-family: inherit;box-sizing: border-box !important;word-wrap: break-word !important;"><p style="max-width: 100%;min-height: 1em;text-align: center;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(136, 136, 136);box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">作者：Ishan Sharma</span></strong></span></p><p style="max-width: 100%;min-height: 1em;text-align: center;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(136, 136, 136);box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">机器之心编译</span></strong></span></p></section></section></section></section></section></section></section></section></section></section></section></section><p style="max-width: 100%;min-height: 1em;text-align: justify;line-height: 1.75em;box-sizing: border-box !important;word-wrap: break-word !important;"><br></p><blockquote><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;color: rgb(136, 136, 136);">基于树的学习算法在数据科学竞赛中相当常见。这些算法给预测模型赋予了准确性、稳定性以及易解释性。其中，决策树算法也是引人关注的「随机森林」算法的基础构造模块。本文介绍了决策树的概念和简单实现，使用生动的示例帮助理解，希望能够对你有所帮助。</span></p></blockquote><p><br></p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="0.6665" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gW92DQfG3m5xcgEVp8mAmf7vVmw5AqevpGicicoELtdR4Q8UBYfaSt9m9GibhSQCBhRtJib939EqAO9uxg/640?wx_fmt=png" data-type="png" data-w="2000" style=""></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">从 Kaggle 到课堂，机器学习第一课就是决策树。之所以关注决策树，是因为与其他 ML 方法相比，决策树的数学复杂度不高，同时能为分类问题提供足够的精度。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">对于 ML 的入门者来说，决策树很容易上手。本教程将介绍：</span></p><p><br></p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">决策树是什么</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">如何构建决策树</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">使用 Python 构建决策树</span></p></li></ul><p><br></p><p style="text-align: center;line-height: 1.75em;"><strong><span style="font-size: 16px;">决策树是什么</span></strong></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">我们跳过正式定义，从概念上了解一下决策树。试想你坐在办公室里，感觉自己饿了，想出去吃点东西，但是午餐要下午 1 点才开始。那么你怎么办呢？当然，你会看一下时间，然后决定能否出去。你可以按照以下逻辑进行思考：</span></p><p><br></p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="0.75" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gW92DQfG3m5xcgEVp8mAmf7vrW7WGnuRqNg1Zic8s31IkgvK2nzwiauPX6PBMib90B0bY25JzDbD3LxyQ/640?wx_fmt=png" data-type="png" data-w="1200" style=""></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">我们刚刚搭了一个决策树！这是一个简单的版本，但我们可以通过加入天气、成本等因素构建一个更为复杂的决策树。如果你想和你的朋友 Jon Snow 去一家中餐馆吃午饭，决策逻辑可以这样表示：</span></p><p><br></p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="0.75" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gW92DQfG3m5xcgEVp8mAmf7vpUTQXr6dibicu3Gicekny2Iic6uiao5PNAA9S17Afm7HfYB5A3Wlrk6qwLg/640?wx_fmt=png" data-type="png" data-w="1200" style=""></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">这也是一个决策树。从顶部开始，循着描述当前状况的路线一路向下，直到做出决定。</span></p><p><br></p><p style="text-align: center;line-height: 1.75em;"><span style="font-size: 16px;"><strong>注意事项</strong></span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">我们把场景切换到计算机世界。我们刚刚画的每一个框叫做一个节点。最上面的节点叫做根节点，下面每层的节点叫做叶节点，可以把它想成现实世界中的一棵树，但是根朝上。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">每个节点测试我们的世界（数据集）中的某个属性，从节点引出的每个分支对应于该属性的值。给定一棵决策树，决策过程如下：</span></p><p><br></p><ol class=" list-paddingleft-2" style="list-style-type: decimal;"><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">从根节点开始</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">观察根节点属性的值</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">按照与观察值对应的路径往下走</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">重复以上步骤，直至到达叶节点，这样就能做出决策</span></p></li></ol><p><br></p><p style="text-align: center;line-height: 1.75em;"><span style="font-size: 16px;"><strong>如何构建决策树？</strong></span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">构建决策树不需要从头开始（除非你是一个像我一样的学生）。尽管如此，这也是一个很好的学习经验，你将学到一些有趣的概念。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">构建决策树最常用的算法是 ID3，该算法非常简单。以下是算法伪代码：</span></p><p><br></p><pre class="prettyprint linenums prettyprinted" style="box-sizing: border-box;margin-top: 0px;margin-bottom: 0px;padding: 8px 0px 6px;background-color: rgb(27, 24, 27);border-radius: 0px;overflow-y: auto;color: rgb(80, 97, 109);font-size: 10px;line-height: 12px;"><ol class="linenums list-paddingleft-2" style="list-style-type: none;"><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">ID3 (</span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Examples</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">, </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Target_Attribute</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">, </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Attributes</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">)</span></code></span></p></li><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">    </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Create</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> a root node </span><span class="kwd" style="box-sizing: border-box;color: rgb(123, 89, 192);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">for</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> the tree</span></code></span></p></li><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">    </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">If</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> all examples are positive, </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Return</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> the single-node tree </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Root</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">, </span><span class="kwd" style="box-sizing: border-box;color: rgb(123, 89, 192);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">with</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> label = +.</span></code></span></p></li><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">    </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">If</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> all examples are negative, </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Return</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> the single-node tree </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Root</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">, </span><span class="kwd" style="box-sizing: border-box;color: rgb(123, 89, 192);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">with</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> label = -.</span></code></span></p></li><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">    </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">If</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Atributes</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> list </span><span class="kwd" style="box-sizing: border-box;color: rgb(123, 89, 192);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">is</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> empty, then </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Return</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> the single node tree </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Root</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">,</span></code></span></p></li><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">    </span><span class="kwd" style="box-sizing: border-box;color: rgb(123, 89, 192);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">with</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> label = most common value of the target attribute </span><span class="kwd" style="box-sizing: border-box;color: rgb(123, 89, 192);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">in</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> the examples.</span></code></span></p></li><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">    </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Otherwise</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Begin</span></code></span></p></li><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">        A ← </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">The</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Attribute</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> that best classifies examples.</span></code></span></p></li><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">        </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Decision</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Tree</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> attribute </span><span class="kwd" style="box-sizing: border-box;color: rgb(123, 89, 192);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">for</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Root</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> = A.</span></code></span></p></li><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">        </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">For</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> each possible value, vi, of A,</span></code></span></p></li><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">            </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Add</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> a new tree branch below </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Root</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">, corresponding to the test A = vi.</span></code></span></p></li><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">            </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Let</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Examples</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">(vi) be the subset of examples that have the value vi </span><span class="kwd" style="box-sizing: border-box;color: rgb(123, 89, 192);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">for</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> A</span></code></span></p></li><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">            </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">If</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Examples</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">(vi) </span><span class="kwd" style="box-sizing: border-box;color: rgb(123, 89, 192);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">is</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> empty</span></code></span></p></li><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">                </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Then</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> below this new branch add a leaf node </span><span class="kwd" style="box-sizing: border-box;color: rgb(123, 89, 192);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">with</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> label = most common target value </span><span class="kwd" style="box-sizing: border-box;color: rgb(123, 89, 192);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">in</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> the examples</span></code></span></p></li><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">            </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Else</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> below this new branch add the subtree ID3 (</span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Examples</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">(vi), </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Target_Attribute</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">, </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Attributes</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> – {A})</span></code></span></p></li><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">    </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">End</span></code></span></p></li><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">    </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Return</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> </span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Root</span></code></span></p></li></ol></pre><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">你将注意到这样一个细节：在循环开始之后，算法必须选择一个属性，为样本分类选出最佳方案。那么算法会怎么做呢？为了理解这一点，我们必须深入了解一些数学知识。别担心，不会太难。</span></p><p><br></p><p style="text-align: center;line-height: 1.75em;"><strong><span style="font-size: 16px;">信息增益和熵</span></strong></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">信息增益是选择最佳属性常用且容易上手的方法之一。它使用另一种叫做熵的属性计算出来。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">熵是物理学和数学中的概念，指系统的随机性或混乱度。在信息论中，它指的是一组样本的混乱度。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">我们通过一个例子来说明：你有两个装满巧克力的袋子。巧克力有红的也有蓝的。你想通过计算巧克力的数量来测量袋子的熵。所以你坐下来开始数。2 分钟后，你发现第一袋有 50 块巧克力。其中 25 块是红色的，25 块是蓝色的。第二袋也有 50 块巧克力，都是蓝色的。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">在这种情况下，第一个袋子的熵是 1，因为里面的巧克力呈均匀分布。第二个袋子的熵为零，因为里面的巧克力没有随机性。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">我们用下面这个公式计算一个系统的熵：</span></p><p><br></p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="0.2633333333333333" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gW92DQfG3m5xcgEVp8mAmf7vZAs8UURJK4ZGdGC5N3MN3brRq0NfYAMHqEJd8lLLw9yZRsVicSiaDyiaw/640?wx_fmt=png" data-type="png" data-w="600" style=""></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">在这个公式中，c 代表类别或属性的总数，p_i 代表属于第 i 类的样本数量。是不是有点懵？我们通过例子了解一下：</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">让我们回到刚刚的巧克力袋子。我们有两个类别：红色（R）和蓝色（B）。第一个袋子里有 25 块红色巧克力。巧克力总数是 50。因此，p_i=25/50。蓝色类别也是这样处理。把这些值代入熵方程，我们得到以下结果：</span></p><p><br></p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="0.17955801104972377" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gW92DQfG3m5xcgEVp8mAmf7vaf93D09KjjnZ4MiaTFib16H3Q5xFwuicH4cMXNM2odTnYrqV3icujPk8qQ/640?wx_fmt=png" data-type="png" data-w="724" style=""></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">解方程，结果如下：</span></p><p><br></p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="0.7814726840855107" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gW92DQfG3m5xcgEVp8mAmf7vE2qfiaCyOecxZz0cBvWGpfJUIO8gQ2aWBltyOxADQY0YYOiahCVrpLmQ/640?wx_fmt=png" data-type="png" data-w="842" style=""></p><p><br></p><p style="text-align: left;line-height: 1.75em;"><span style="font-size: 15px;">如果想验证结果或尝试其他例子，请移步 Wolfram Alpha：http://www.wolframalpha.com/input/?i=-(25%2F50)log2(25%2F50)+-+(25%2F50)log2(25%2F50)。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">继续计算第二个袋子的熵，里面有 50 块红色巧克力，0 块蓝色巧克力。得到的熵是 0。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">如果你理解这个概念，太好了！我们现在转到信息增益。</span></p><p><br></p><p style="text-align: center;line-height: 1.75em;"><span style="font-size: 16px;"><strong>信息增益</strong></span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">信息增益是由基于给定属性的样本分割导致的熵下降。从数学角度上看，信息增益的定义为：</span></p><p><br></p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="0.16603053435114504" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gW92DQfG3m5xcgEVp8mAmf7v3zyxIZtJADKk7YGFwRwp5jI4GIZda42UiaIczh1FntNSwJGuzqF0NfA/640?wx_fmt=png" data-type="png" data-w="1048" style=""></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">S 代表整个样本集，A 代表我们想要分割的属性。|S| 代表样本数量，|Sv| 表示属性 A 当前值的样本数量。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">仍然很复杂，是不是？那我们举个例子，看看它的工作流程。</span></p><p><br></p><p style="text-align: center;line-height: 1.75em;"><strong><span style="font-size: 16px;">构建决策树</span></strong></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">首先，给巧克力的例子添加一些细节。我们已经知道袋 1 中有 25 块红色巧克力、25 块蓝色巧克力。现在，我们还要考虑巧克力的品牌。红色巧克力中，有 15 块是士力架，10 块是 Kit Kat 牌。蓝色巧克力中，20 块是 Kit Kat 牌，5 块是士力架。假设我们只想吃红色的士力架。那么这里，红色士力架（15）是正例，其他的巧克力（如红色 Kit Kat 和蓝色士力架）都是负例。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">现在，与我们的类别（吃／不吃）相关的数据集的熵是：</span></p><p><br></p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="0.314540059347181" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gW92DQfG3m5xcgEVp8mAmf7v8WVgyxS942zn82O7y1Mxmia6UlFibibefPibSeiaTZUoOfKeu4AGWx5sWeg/640?wx_fmt=png" data-type="png" data-w="337" style=""></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">现在我们来回顾一下，我们有 50 块巧克力。如果只看属性「颜色」，则我们有 25 个红色的、25 个蓝色的。如果看属性「品牌」，则我们有 20 块士力架、30 块 Kit Kat 巧克力。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">为了构建决策树，我们需要选择其中一个属性作为根节点。我们想要选择具备最高信息增益的属性。现在我们来计算这些属性的信息增益。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">颜色相关的信息增益是：</span></p><p><br></p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="0.21978021978021978" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gW92DQfG3m5xcgEVp8mAmf7vELRl6YH7r2aAkvZtoJOgalYKthoL73HMRIOrXgRsVQmiaMFicSclNmGg/640?wx_fmt=png" data-type="png" data-w="728" style=""></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">我们刚才计算了与类别相关的巧克力的熵，是 0.8812。如果我们想吃 15 块士力架而不是 10 块 Kit Kat，则红色巧克力的熵是：</span></p><p><br></p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="0.20871559633027523" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gW92DQfG3m5xcgEVp8mAmf7vYq2VL6zn8rTfgzHwpYNNwQKKX9WtGicBUyBWgNOR3fgxY1fLZzLWZsg/640?wx_fmt=png" data-type="png" data-w="436" style=""></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">如果我们不想吃蓝色巧克力，则熵为 0。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">我们的信息增益计算就变成了：</span></p><p><br></p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="0.11782032400589101" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gW92DQfG3m5xcgEVp8mAmf7voNOe5wXPJZgtML2goMLo5FnBwDs3aMJfgE3P7WUr0GpPWnibx4jMg7Q/640?wx_fmt=png" data-type="png" data-w="679" style=""></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">如果我们分割颜色，则信息增益是 0.3958。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">现在我们来看下品牌。如果我们想吃 15 块士力架（共有 20 块），不想吃 Kit Kat。则士力架的熵是：</span></p><p><br></p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="0.21291866028708134" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gW92DQfG3m5xcgEVp8mAmf7v0GIxlU1NJLKHqkr25ReCWzYSxLvgACGyb6BtGNCyJDh0d1d0OswAKA/640?wx_fmt=png" data-type="png" data-w="418" style=""></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">如果我们不吃 Kit Kat，则熵为 0。信息增益为：</span></p><p><br></p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="0.15764331210191082" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gW92DQfG3m5xcgEVp8mAmf7vHwICJfu1W9Q4chUcrsmkroB2RYXsN3UiaVYFrngQUCWRDbiaBbxVrE3A/640?wx_fmt=png" data-type="png" data-w="628" style=""></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">品牌分割的信息增益是 0.5567。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">由于品牌的信息增益较大，我们将基于品牌进行分割。下一级，我们只要左边的颜色。我们可以轻松地根据颜色进行分割，无需进行任何计算。决策树如下：</span></p><p><br></p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="0.75" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gW92DQfG3m5xcgEVp8mAmf7vmhIwWUokTg5sZsmN3etCbiciaoUb3uW48m3FfiaH0LF6YMQ0sSsQNRruA/640?wx_fmt=png" data-type="png" data-w="1200" style=""></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">谁能想到吃块巧克力这么难呢？</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">现在你应该了解决策树的运行原理了。</span></p><p><br></p><p style="text-align: center;line-height: 1.75em;"><strong><span style="font-size: 16px;">使用 Python 3 实现决策树</span></strong></p><p><br></p><p style="text-align: left;line-height: 1.75em;"><span style="font-size: 15px;">现在我们继续为巧克力数据集构建决策树。</span></p><p style="text-align: left;line-height: 1.75em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">代码和数据地址：https://github.com/ishansharma/decision_trees_tutorial/</span></p><p><br></p><ol class=" list-paddingleft-2" style="list-style-type: decimal;"><li><p style="text-align: left;line-height: 1.75em;"><span style="font-size: 15px;">创建新文件夹。</span></p></li><li><p style="text-align: left;line-height: 1.75em;"><span style="font-size: 15px;">从 GitHub 下载 data.csv（https://github.com/ishansharma/decision_trees_tutorial/blob/master/data.csv）。</span></p></li><li><p style="text-align: left;line-height: 1.75em;"><span style="font-size: 15px;">你可能需要安装 Scipy、Scikit-Learn 和 Pandas，如果没有安装的话。我推荐使用虚拟环境，参见：http://docs.python-guide.org/en/latest/dev/virtualenvs/。从终端运行以下命令行，安装 Pandas 和 Scikit-Learn：</span></p></li></ol><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;background-color: rgb(214, 214, 214);"></span></p><pre class="prettyprint linenums prettyprinted" style="box-sizing: border-box;margin-top: 0px;margin-bottom: 0px;padding: 8px 0px 6px;background-color: rgb(27, 24, 27);border-radius: 0px;overflow-y: auto;color: rgb(80, 97, 109);font-size: 10px;line-height: 12px;"><ol class="linenums list-paddingleft-2" style="list-style-type: none;"><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><span style="box-sizing: border-box;line-height: 22px;display: block;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">pip install scikit</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">-</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">learn</span></code></span></span></p></li><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><span style="box-sizing: border-box;line-height: 22px;display: block;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">pip install scipy</span></code></span></span></p></li><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><span style="box-sizing: border-box;line-height: 22px;display: block;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">pip install pandas</span></code></span></span></p></li></ol></pre><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;background-color: rgb(214, 214, 214);"></span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">4. 安装后，创建新文件 decision_tree.py，并将以下两行添加进去：</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;background-color: rgb(214, 214, 214);"></span></p><pre class="prettyprint linenums prettyprinted" style="box-sizing: border-box;margin-top: 0px;margin-bottom: 0px;padding: 8px 0px 6px;background-color: rgb(27, 24, 27);border-radius: 0px;overflow-y: auto;color: rgb(80, 97, 109);font-size: 10px;line-height: 12px;"><ol class="linenums list-paddingleft-2" style="list-style-type: none;"><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><span style="box-sizing: border-box;line-height: 22px;display: block;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="kwd" style="box-sizing: border-box;color: rgb(123, 89, 192);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">from</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> pandas </span><span class="kwd" style="box-sizing: border-box;color: rgb(123, 89, 192);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">import</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> read_csv</span></code></span></span></p></li><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><span style="box-sizing: border-box;line-height: 22px;display: block;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="kwd" style="box-sizing: border-box;color: rgb(123, 89, 192);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">from</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> sklearn </span><span class="kwd" style="box-sizing: border-box;color: rgb(123, 89, 192);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">import</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> tree</span></code></span></span></p></li></ol></pre><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;background-color: rgb(214, 214, 214);"></span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">5. 使用 Pandas 加载数据：</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;background-color: rgb(214, 214, 214);"></span></p><pre class="prettyprint linenums prettyprinted" style="box-sizing: border-box;margin-top: 0px;margin-bottom: 0px;padding: 8px 0px 6px;background-color: rgb(27, 24, 27);border-radius: 0px;overflow-y: auto;color: rgb(80, 97, 109);font-size: 10px;line-height: 12px;"><ol class="linenums list-paddingleft-2" style="list-style-type: none;"><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><span style="box-sizing: border-box;line-height: 22px;display: block;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">data </span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">=</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> read_csv</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">(</span><span class="str" style="box-sizing: border-box;color: rgb(145, 139, 59);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">"data.csv"</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">)</span></code></span></span></p></li></ol></pre><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;background-color: rgb(214, 214, 214);"></span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">6. Pandas 可以处理大型数据集，且具备大量可视化功能。它在使用 Python 的大数据流程中广泛使用，因此使用 Pandas 是个好主意。在 Pandas 中你可以使用 head() 方法快速查看加载数据：</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;background-color: rgb(214, 214, 214);"></span></p><pre class="prettyprint linenums prettyprinted" style="box-sizing: border-box;margin-top: 0px;margin-bottom: 0px;padding: 8px 0px 6px;background-color: rgb(27, 24, 27);border-radius: 0px;overflow-y: auto;color: rgb(80, 97, 109);font-size: 10px;line-height: 12px;"><ol class="linenums list-paddingleft-2" style="list-style-type: none;"><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><span style="box-sizing: border-box;line-height: 22px;display: block;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="kwd" style="box-sizing: border-box;color: rgb(123, 89, 192);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">print</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">(</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">data</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">.</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">head</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">())</span></code></span></span></p></li></ol></pre><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;background-color: rgb(214, 214, 214);"></span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">下图显示了数据的前 5 行。</span></p><p><br></p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="0.517948717948718" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gW92DQfG3m5xcgEVp8mAmf7vK271hicARzyhThqRXju6CZ1MhKocmwxibVDvc01c2VM8RcgFqE1hMs7g/640?wx_fmt=png" data-type="png" data-w="390" style=""></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">7. 我使用 Class 列来确定我们是否想吃巧克力。1 代表吃，0 代表不吃。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">8. 接下来，我们需要对数据执行一些预处理。Scikit-Learn 默认不支持文本标签，因此我们使用 Pandas 将文本标签转换成数字。只需要添加以下两行：</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;background-color: rgb(214, 214, 214);"></span></p><pre class="prettyprint linenums prettyprinted" style="box-sizing: border-box;margin-top: 0px;margin-bottom: 0px;padding: 8px 0px 6px;background-color: rgb(27, 24, 27);border-radius: 0px;overflow-y: auto;color: rgb(80, 97, 109);font-size: 10px;line-height: 12px;"><ol class="linenums list-paddingleft-2" style="list-style-type: none;"><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><span style="box-sizing: border-box;line-height: 22px;display: block;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">data</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">[</span><span class="str" style="box-sizing: border-box;color: rgb(145, 139, 59);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">'Color'</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">]</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> </span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">=</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> data</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">[</span><span class="str" style="box-sizing: border-box;color: rgb(145, 139, 59);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">'Color'</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">].</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">map</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">({</span><span class="str" style="box-sizing: border-box;color: rgb(145, 139, 59);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">'Red'</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">:</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> </span><span class="lit" style="box-sizing: border-box;color: rgb(166, 89, 38);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">0</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">,</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> </span><span class="str" style="box-sizing: border-box;color: rgb(145, 139, 59);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">'Blue'</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">:</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> </span><span class="lit" style="box-sizing: border-box;color: rgb(166, 89, 38);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">1</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">})</span></code></span></span></p></li><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><span style="box-sizing: border-box;line-height: 22px;display: block;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">data</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">[</span><span class="str" style="box-sizing: border-box;color: rgb(145, 139, 59);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">'Brand'</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">]</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> </span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">=</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> data</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">[</span><span class="str" style="box-sizing: border-box;color: rgb(145, 139, 59);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">'Brand'</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">].</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">map</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">({</span><span class="str" style="box-sizing: border-box;color: rgb(145, 139, 59);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">'Snickers'</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">:</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> </span><span class="lit" style="box-sizing: border-box;color: rgb(166, 89, 38);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">0</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">,</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> </span><span class="str" style="box-sizing: border-box;color: rgb(145, 139, 59);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">'Kit Kat'</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">:</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> </span><span class="lit" style="box-sizing: border-box;color: rgb(166, 89, 38);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">1</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">})</span></code></span></span></p></li></ol></pre><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;background-color: rgb(214, 214, 214);"></span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">9. 刚才我们改变了 Color 属性，用 0 代表红色，1 代表蓝色。类似地，在 Brand 列中，我们用 0 替代士力架，用 1 替换 Kit Kat。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">10. 如果你使用 head() 查看数据集，你将看到品牌和颜色的值已经变成了整数：</span></p><p><br></p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="0.5465116279069767" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gW92DQfG3m5xcgEVp8mAmf7v4XVIjwfSiaz09WZfrNpS50Izz2At2CyPRicXrc6ia6f1pr2tLYCkI1Bqg/640?wx_fmt=png" data-type="png" data-w="344" style=""></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">11. 最后，按惯例用 X 表示训练属性，Y 表示输出类别，因此我们执行以下命令：</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;background-color: rgb(214, 214, 214);"></span></p><pre class="prettyprint linenums prettyprinted" style="box-sizing: border-box;margin-top: 0px;margin-bottom: 0px;padding: 8px 0px 6px;background-color: rgb(27, 24, 27);border-radius: 0px;overflow-y: auto;color: rgb(80, 97, 109);font-size: 10px;line-height: 12px;"><ol class="linenums list-paddingleft-2" style="list-style-type: none;"><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><span style="box-sizing: border-box;line-height: 22px;display: block;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">predictors </span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">=</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> </span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">[</span><span class="str" style="box-sizing: border-box;color: rgb(145, 139, 59);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">'Color'</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">,</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> </span><span class="str" style="box-sizing: border-box;color: rgb(145, 139, 59);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">'Brand'</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">]</span></code></span></span></p></li><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><span style="box-sizing: border-box;line-height: 22px;display: block;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">X </span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">=</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> data</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">[</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">predictors</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">]</span></code></span></span></p></li><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><span style="box-sizing: border-box;line-height: 22px;display: block;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Y </span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">=</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> data</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">.</span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">Class</span></code></span></span></p></li></ol></pre><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;background-color: rgb(214, 214, 214);"></span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">12. 差不多完成了。我们现在已经准备好训练决策树了。添加以下两行在我们的数据上训练决策树：</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;background-color: rgb(214, 214, 214);"></span></p><pre class="prettyprint linenums prettyprinted" style="box-sizing: border-box;margin-top: 0px;margin-bottom: 0px;padding: 8px 0px 6px;background-color: rgb(27, 24, 27);border-radius: 0px;overflow-y: auto;color: rgb(80, 97, 109);font-size: 10px;line-height: 12px;"><ol class="linenums list-paddingleft-2" style="list-style-type: none;"><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><span style="box-sizing: border-box;line-height: 22px;display: block;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">decisionTreeClassifier </span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">=</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> tree</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">.</span><span class="typ" style="box-sizing: border-box;color: rgb(81, 106, 236);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">DecisionTreeClassifier</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">(</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">criterion</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">=</span><span class="str" style="box-sizing: border-box;color: rgb(145, 139, 59);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">"entropy"</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">)</span></code></span></span></p></li><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><span style="box-sizing: border-box;line-height: 22px;display: block;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">dTree </span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">=</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> decisionTreeClassifier</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">.</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">fit</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">(</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">X</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">,</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> Y</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">)</span></code></span></span></p></li></ol></pre><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">13. 完成了吗？我们对决策树进行快速可视化。添加下列行，并运行程序：</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;background-color: rgb(214, 214, 214);"></span></p><pre class="prettyprint linenums prettyprinted" style="box-sizing: border-box;margin-top: 0px;margin-bottom: 0px;padding: 8px 0px 6px;background-color: rgb(27, 24, 27);border-radius: 0px;overflow-y: auto;color: rgb(80, 97, 109);font-size: 10px;line-height: 12px;"><ol class="linenums list-paddingleft-2" style="list-style-type: none;"><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><span style="box-sizing: border-box;line-height: 22px;display: block;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">dotData </span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">=</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> tree</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">.</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">export_graphviz</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">(</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">dTree</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">,</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> out_file</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">=</span><span class="kwd" style="box-sizing: border-box;color: rgb(123, 89, 192);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">None</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">)</span></code></span></span></p></li><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><span style="box-sizing: border-box;line-height: 22px;display: block;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="kwd" style="box-sizing: border-box;color: rgb(123, 89, 192);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">print</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">(</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">dotData</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">)</span></code></span></span></p></li></ol></pre><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;background-color: rgb(214, 214, 214);"></span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">14. 输出如下：</span></p><p><br></p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="0.3491773308957952" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gW92DQfG3m5xcgEVp8mAmf7vqickW527b2IfP6a3Wq26WfzNLetEXHD9AuUSL4wKWfKHCnYOgxdIg3Q/640?wx_fmt=png" data-type="png" data-w="1094" style=""></p><p><br></p><p style="text-align: left;line-height: 1.75em;"><span style="font-size: 15px;">15. 复制输出，访问 WebGraphviz (http://www.webgraphviz.com/) 并粘贴输出，点击 Generate Graph。你讲看到一个与上文决策树类似的决策树：</span></p><p><br></p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="1.0127877237851663" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gW92DQfG3m5xcgEVp8mAmf7viaDN1sEw91EicQECmc3AB8eBImkjc9626AFmlX5EQzYx6q0I1gRLiaZ9g/640?wx_fmt=png" data-type="png" data-w="782" style=""></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">16. 这颗树有点难懂，因为有很多额外信息，不过你可以看到它先基于列 1（Brand）进行分割，再基于列 2（Color）进行分割。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">一旦构建处这颗树，那么未来的预测就很简单了。我们来看一下我们是否想吃蓝色的 Kit Kat 巧克力。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">将以下行添加至 decision_tree.py 文件的末尾：</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;background-color: rgb(214, 214, 214);"></span></p><pre class="prettyprint linenums prettyprinted" style="box-sizing: border-box;margin-top: 0px;margin-bottom: 0px;padding: 8px 0px 6px;background-color: rgb(27, 24, 27);border-radius: 0px;overflow-y: auto;color: rgb(80, 97, 109);font-size: 10px;line-height: 12px;"><ol class="linenums list-paddingleft-2" style="list-style-type: none;"><li><p><span style="box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 14px !important;word-break: inherit !important;"><span style="box-sizing: border-box;line-height: 22px;display: block;word-break: inherit !important;"><code class="python language-python" style="box-sizing: border-box;margin-left: -20px;display: flex;overflow: initial;line-height: 12px;word-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;font-family: inherit !important;white-space: pre !important;"><span class="kwd" style="box-sizing: border-box;color: rgb(123, 89, 192);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">print</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">(</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">dTree</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">.</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">predict</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">([[</span><span class="lit" style="box-sizing: border-box;color: rgb(166, 89, 38);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">1</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">,</span><span class="pln" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;"> </span><span class="lit" style="box-sizing: border-box;color: rgb(166, 89, 38);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">1</span><span class="pun" style="box-sizing: border-box;color: rgb(247, 243, 247);line-height: 20px;font-size: 13px !important;white-space: inherit !important;">]]))</span></code></span></span></p></li></ol></pre><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;background-color: rgb(214, 214, 214);"></span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">输出为 [0]，意味着分类是不吃。如果你尝试红色士力架（print(dTree.predict([[0, 0]]))），则输出是 [1]。</span></p><p><br></p><p style="text-align: center;line-height: 1.75em;"><strong><span style="font-size: 16px;">继续研究</span></strong></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">经过以上学习，你应该对决策树有所了解，同时学会了简单的实现。如果希望进一步探索，你可以参考这些资源：</span></p><p><br></p><ol class=" list-paddingleft-2" style="list-style-type: decimal;"><li><p style="text-align: left;line-height: 1.75em;"><span style="font-size: 15px;">Scikit-Learn 上的决策树页面，讨论在更大的数据集和其他度量下分割数据：http://scikit-learn.org/stable/modules/tree.html</span></p></li><li><p style="text-align: left;line-height: 1.75em;"><span style="font-size: 15px;">Kaggle 上的机器学习教程，一个深度教程，教你参与 Kaggle 竞赛，并构建一个住房数据的决策树模型：https://www.kaggle.com/learn/machine-learning</span></p></li><li><p style="text-align: left;line-height: 1.75em;"><span style="font-size: 15px;">Saving your Scikit Models：本教程中，每次运行都会训练一遍模型。这在小数据集中还可以接受，但对于更大的数据集来说最好是一次训练，随后仅使用。这个教程可以教你如何保存自己的模型：http://scikit-learn.org/stable/modules/model_persistence.html</span></p></li><li><p style="text-align: left;line-height: 1.75em;"><span style="font-size: 15px;">将训练好的模型转换为 Core ML：如果你为另一个数据集训练了自己的决策树，并希望在 iOS 设备上运行，那么你就需要将已训练模型转换为 Core ML 框架版本：https://developer.apple.com/documentation/coreml/converting_trained_models_to_core_ml <img class="" data-ratio="0.3287671232876712" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gW8Zfpicd40EribGuaFicDBCRH6IOu1Rnc4T3W3J1wE0j6kQ6GorRSgicib0fmNrj3yzlokup2jia9Z0YVeA/640?wx_fmt=png" data-type="png" data-w="73" style="color: rgb(62, 62, 62);text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);font-size: 14px;box-sizing: border-box !important;word-wrap: break-word !important;visibility: visible !important;width: 48px !important;" width="48px"></span></p></li></ol><p><br></p><p style="line-height: 1.75em;"><span style="color: rgb(136, 136, 136);"><em><span style="font-size: 12px;">原文链接：https://heartbeat.fritz.ai/introduction-to-decision-tree-learning-cd604f85e236</span></em></span></p><p><br></p><p><br></p><p style="max-width: 100%;min-height: 1em;background-color: rgb(255, 255, 255);box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;text-align: justify;line-height: 25.6px;font-family: 微软雅黑;font-size: 14px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(127, 127, 127);box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;color: rgb(62, 62, 62);line-height: 25.6px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(127, 127, 127);box-sizing: border-box !important;word-wrap: break-word !important;">本文为机器之心编译，<strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;">转载请联系本公众号获得授权</span></strong></span></strong>。</span></strong><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></p><p style="margin-bottom: 5px;max-width: 100%;min-height: 1em;background-color: rgb(255, 255, 255);font-size: 18px;line-height: 1.75em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(127, 127, 127);line-height: 25.6px;font-family: 微软雅黑;text-align: justify;box-sizing: border-box !important;word-wrap: break-word !important;">✄------------------------------------------------</span></p><p style="margin-bottom: 5px;max-width: 100%;min-height: 1em;background-color: rgb(255, 255, 255);font-size: 18px;font-family: 微软雅黑;text-align: center;line-height: 1.75em;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(217, 33, 66);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">加入机器之心（全职记者/实习生）：hr@jiqizhixin.com</span></strong></p><p style="max-width: 100%;min-height: 1em;background-color: rgb(255, 255, 255);font-size: 18px;font-family: 微软雅黑;text-align: center;line-height: 1.75em;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(217, 33, 66);line-height: 1.6;font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">投稿或寻求报道：editor@jiqizhixin.com</span></strong></p><p style="max-width: 100%;min-height: 1em;background-color: rgb(255, 255, 255);font-size: 18px;font-family: 微软雅黑;text-align: center;line-height: 1.75em;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 12px;color: rgb(217, 33, 66);line-height: 1.6;box-sizing: border-box !important;word-wrap: break-word !important;">广告&amp;商务合作：bd@jiqizhixin.com</span></strong></p>
                </div>
                <script nonce="158878684" type="text/javascript">
                    var first_sceen__time = (+new Date());

                    if ("" == 1 && document.getElementById('js_content')) {
                        document.getElementById('js_content').addEventListener("selectstart",function(e){ e.preventDefault(); });
                    }

                    
                    (function(){
                        if (navigator.userAgent.indexOf("WindowsWechat") != -1){
                            var link = document.createElement('link');
                            var head = document.getElementsByTagName('head')[0];
                            link.rel = 'stylesheet';
                            link.type = 'text/css';
                            link.href = "//res.wx.qq.com/mmbizwap/zh_CN/htmledition/style/page/appmsg/page_mp_article_improve_winwx3d171e.css";
                            head.appendChild(link);
                        }
                    })();
                </script>
                
                
                                
                <div class="ct_mpda_wrp" id="js_sponsor_ad_area" style="display:none;"></div>

                
                                <div class="reward_area tc" id="js_preview_reward" style="display:none;">
                    <p id="js_preview_reward_wording" class="tips_global reward_tips" style="display:none;"></p>
                    <p>
                        <a class="reward_access" id="js_preview_reward_link" href="##"><span class="icon-reward"></span>赞赏</a>

                    </p>
                </div>
                <div class="reward_qrcode_area reward_area tc" id="js_preview_reward_qrcode" style="display:none;">
                    <p class="tips_global">长按二维码向我转账</p>
                    <p id="js_preview_reward_ios_wording" class="reward_tips" style="display:none;"></p>
                    <span class="reward_qrcode_img_wrp"><img class="reward_qrcode_img" src="//res.wx.qq.com/mmbizwap/zh_CN/htmledition/images/pic/appmsg/pic_reward_qrcode.2x3534dd.png"></span>
                    <p class="tips_global">受苹果公司新规定影响，微信 iOS 版的赞赏功能被关闭，可通过二维码转账支持公众号。</p>
                </div>
                            </div><ul id="js_hotspot_area" class="article_extend_area"></ul><div class="rich_media_tool" id="js_toobar3">
                
                                
                                            <div id="js_read_area3" class="media_tool_meta tips_global meta_primary" style="display:none;">阅读 <span id="readNum3"></span></div>

                <span style="display:none;" class="media_tool_meta meta_primary tips_global meta_praise" id="like3">
                    <i class="icon_praise_gray"></i><span class="praise_num" id="likeNum3"></span>
                </span>

                <a id="js_report_article3" style="display:none;" class="media_tool_meta tips_global meta_extra" href="##">投诉</a>

            </div><div class="rich_media_tool" id="js_sg_bar">
                
                                
                                
            </div>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
