<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>基于深度学习的高频交易策略</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/22393913">原文</a></p>
<div class="title-image"><img src="https://pic1.zhimg.com/2c9ea2ff86ec626ab9ad756fbc81cabc_r.jpg" alt=""></div><p><i>我们一般只发原创，今天看到一篇很棒的文章就转过来和大家分享，已获得作者授权。</i></p><i>作者：郑明 首发于 对冲笔记，ID:HedgeFundNotes</i><br><h2>1.深度学习简介</h2><br><p>关于深度学习的话题，目前讨论的很火，各种学习资源也充斥网络，这里只是做一个简单介绍。</p><br><p>Deep Learning 本身算是 Machine Learning 的一个分支，简单可以理解为Neural Network的发展。大约二三十年前，Neural Network曾经是ML领域特别火热的一个方向，但是后来确慢慢淡出了，原因包括以下几个方面：</p><p>1）比较容易过拟合，参数比较难tune，而且需要不少trick；</p><p>2）训练速度比较慢，在层次比较少（小于等于3）的情况下效果并不比其它方法更优；</p><br><p>所以中间有大约20多年的时间，神经网络被关注很少，这段时间基本上是SVM和boosting算法的天下。但是，一个痴心的老先生Hinton，他坚持了下来，并最终（和其它人一起Bengio、Yann.lecun等）提成了一个实际可行的Deep Learning框架。</p><br><p>Deep Learning与传统的神经网络之间有相同的地方也有很多不同。二者的相同在于Deep Learning采用了神经网络相似的分层结构，系统由包括输入层、隐层（多层）、输出层组成的多层网络，只有相邻层节点之间有连接，同一层以及跨层节点之间相互无连接，每一层可以看作是一个Logistic Regression模型；这种分层结构，是比较接近人类大脑的结构的。</p><br><img src="https://pic1.zhimg.com/f92033ccb101d719eb5060c973c5bc85_r.png" data-rawwidth="657" data-rawheight="300"><br><p>为了克服神经网络训练中的问题，Deep Learning采用了与神经网络很不同的训练机制。传统神经网络中，采用的是Back Propagation的方式进行，简单来讲就是采用迭代的算法来训练整个网络，随机设定初值，计算当前网络的输出，然后根据当前输出和label之间的差去改变前面各层的参数，直到收敛（整体是一个梯度下降法）。而Deep Learning整体上是一个layer-wise的训练机制。</p><br><h2>2.策略概述</h2><br><p>由交易规则可知，股指期货在每个时刻的成交价格由买价、卖价、买量、卖量等指标决定；由于用户所能获取到的只是一个tick大约500ms的切片数据，而对这个时间段内所发生的交易一无所知，因此成交价格难以通过一个固定的规则来计算。本文基于沪深300股指期货在2013年10月的日内高频交易数据，以tick截面指标为输入变量，建立深度神经网络模型，预测下一个tick的涨跌情况。在样本外测试时间段内，共发出交易信号641次，其中有195次价格发生变化，正确预测168次，错误27次，胜率达86.2%。<br><br></p><h2>3.数据准备</h2><p>选取任意一天（验证表明该模型使用当日数据训练和预测的效果最好）前3个小时大约2万个tick的交易数据作为训练样本，输入变量为前一时刻的指标，并标准化：<img src="https://pic1.zhimg.com/c2744b7b161f240a3af0704a8c8d4b2e_r.png" data-rawwidth="673" data-rawheight="283"></p><p>为了训练数据有良好的区分度，选取下一时刻价格变化0.6以上的数据，选取700个训练样本，将下一时刻上涨的样本标记为“买入”，下一时刻下跌的样本标记为“下跌”。</p><h2>4.多层自编码</h2><br><p>自动编码学习本质是一个无监督的学习过程，又可以称为“特征学习”，这是和传统神经网络的最大区别。具体的，先用无标定数据训练第一层，训练时先学习第一层的参数（这一层可以看作是得到一个使得输出和输入差别最小的三层神经网络的隐层），由于模型capacity的限制以及稀疏性约束，使得得到的模型能够学习到数据本身的结构，从而得到比输入更具有表示能力的特征；在学习得到第n-1层后，将n-1层的输出作为第n层的输入，训练第n层，由此分别得到各层的参数。将最后一层得到的二阶特征作为softmax分类器的输入，训练得到一个能将二阶特征映射到数字标签的模型：</p><br><img src="https://pic2.zhimg.com/33096f0c9836c54982863ad3c83dc238_r.png" data-rawwidth="569" data-rawheight="403"><img src="https://pic2.zhimg.com/7055902c72541bf3f7f8d43b546d1e12_r.png" data-rawwidth="643" data-rawheight="341"><br><br><p>实际训练模型中，采用两个隐藏层，节点数分别为8和6，进行迭代计算，得到各层最优的参数。</p><br><h2>5.微调多层自编码</h2><br><p>微调是深度学习中的常用策略，可以大幅提升一个多层自编码神经网络的性能表现。从更高的视角来讲，微调将多层自编码神经网络的所有层视为一个模型，这样在每次迭代中，网络中所有的权重值都可以被优化。基于第一步得到的各层参数进一步fine-tune整个多层模型的参数，这一步是一个有监督训练过程；第一步类似神经网络的随机初始化初值过程，由于深度学习的第一步不是随机初始化，而是通过学习输入数据的结构得到的，因而这个初值更接近全局最优，从而能够取得更好的效果；所以学习效果好很大程度上归功于第一步的特征学习过程。</p><br><img src="https://pic3.zhimg.com/904a017bd4c1592788e665513e47f646_r.png" data-rawwidth="659" data-rawheight="168"><br><br><p>微调的过程就是传统神经网络中使用的反向传播算法：</p><br><img src="https://pic2.zhimg.com/69296edce81851f613e56f35fab45702_r.png" data-rawwidth="662" data-rawheight="421"><br><h2>6.模型验证</h2><br><p>对当日交易的后8000个tick数据进行样本外测试，每个tick可以计算得到下一秒涨跌的概率值，如图所示：</p><br><img src="https://pic4.zhimg.com/341b21b12dc5b989d3b1c458c0e16d59_r.png" data-rawwidth="358" data-rawheight="368"><br><p>V1表示上涨概率，V2表示下跌概率，Delta.CP表示实际涨跌情况，为了确保交易信号的显著性，只有在V1或者V2至少有一个大于0.75的情况下选择开仓。开平仓手续费为0.23%%，假设在起初拥有1手股指期货对应的权益值，测试结果表明，在8000个tick中，发出交易信号641次，其中有195次价格发生变化，正确预测168次，错误27次，胜率达86.2%，累计收益曲线如图：</p><br><img src="https://pic3.zhimg.com/824ee12a718f80572569cabf00537699_r.png" data-rawwidth="662" data-rawheight="379"><br><p>在大约90分钟的交易时间内，盈利2600元，不加杠杆的情况下，收益率为0.347%。</p><br><h2>7.后续研究</h2><br><p>首先，本文只采用了最简单的深度学习模型，重点在验证模型预测的准确性，以及学术探讨；但是在实际交易中，还有滑点等因素，都会造成成本的增加，对于高频交易的影响尤其严重，如本例中，当把交易手续费提高一倍，最终权益值为-700(Sad)。事实上，现在的市场中根本也无法进行高频交易(Sadder)。</p><br><p>其次，本例只对涨跌做了预测，但是对价格不变的情况没有做出很有效的区分，导致600多次交易信号中，有400多次都是不涨不跌，每次交易的手续费大大降低了最终的收益。</p><br><p>最后，该模型在通过当日的模型来验证当日的涨跌时，效果较好；如果改成用日间策略，预测准确性会受到较大的影响，可能的一个原因是每日的市场高频结构都会有所区别，当日训练的模型在次日有可能失效。</p><br><p>此外，文中还有诸多理论不够严密以及实践环节受限的情况，请各位读者批评指正。</p>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
