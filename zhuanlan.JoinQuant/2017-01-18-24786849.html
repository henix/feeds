<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>【量化课堂】股指期货跨期套利策略</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/24786849">原文</a></p>
<div class="title-image"><img src="https://pic2.zhimg.com/v2-228a1e47c80c1255a3260253ef0f1707_b.jpg" alt=""></div>概述：本文章介绍使用同一标的不同交割日的股指期货的价差进行跨期套利的策略。<p>建议读者掌握<a href="https://link.zhihu.com/?target=https%3A//www.joinquant.com/post/1731%3Ff%3Dzhzl%26m%3D24786849" class=" wrap external" target="_blank" rel="nofollow noreferrer">协整</a>和<a href="https://link.zhihu.com/?target=https%3A//www.joinquant.com/post/1786%3Ff%3Dzhzl%26m%3D24786849" class=" wrap external" target="_blank" rel="nofollow noreferrer">线性回归</a>的相关知识。<br/></p><h4>引言</h4><p>沪深 300 股指期货推出已久，利用它来进行套利交易是相关理论研究者和实际工作者非常关注的问题。N.Burgess 利用协整模型对 FTSE100 指数进行套利取得了良好的效果， Board 和 Sutcliffe 利用协整方法对大阪、新加坡和芝加哥的日经 225 指数合约之间的价差套利研究表明也存在套利交易空间。同时协整分析在股票指数间的长期平稳关系或期货保值中也得到广泛应用。</p><p>股指期货的两个不同期货合约因为对应的同一个股票指数，所以存在着长期协整关系的基础。依据配对交易的思想，基于协整的股指期货套利的核心在于准确发现价差交易出现的时机和概率，而本文可应用协整方法来构建不同到期月份合约价格序列的长期均衡关系，估计价差序列的分布，从而制定恰当的价差交易策略。</p><p>正是由于上述原因，本文利用二元协整的跨期套利策略对沪深 300 指数期货做相关的跨期套利研究，结果表明，本文提供的跨期套利策略具有可以发现更多的套利机会且风险可控等方面的优势。<br/></p><h4>股指期货及跨期套利策略与模型</h4><p>股指期货指以股票价格指数为标的物的期货合约。由已有的金融文献中持有成本定价原理知，股指期货定价公式为:</p><p><figure><noscript><img src="https://pic2.zhimg.com/v2-da32ad8a485e4be587aa993d526b5071_b.png" data-rawwidth="284" data-rawheight="42" class="content_image" width="284"/></noscript><img src="https://pic2.zhimg.com/v2-da32ad8a485e4be587aa993d526b5071_b.png" data-rawwidth="284" data-rawheight="42" class="content_image lazy" width="284" data-actualsrc="https://pic2.zhimg.com/v2-da32ad8a485e4be587aa993d526b5071_b.png"/></figure>其中: F 表示股指期货在时间t时的价格; S表示现货指数在时间t时的价格; r 表示以连续复利计算的无风险利率; q 表示股息收益率; T 表示期货合约到期时间(年); t表示现在的时间(年)。</p><p>一般来说，基于相同标的股票指数的股指期货在市场上会有不同交割月份的合约同时交易。而股指期货的跨期套利，就是指利用基于同一股票指数的两个不同交割月份的股指期货合约之间的价差进行的套利交易。严格来讲，跨期套利不是无风险套利，它实际上属于价差套利交易，所以其操作重点在于判断不同交割月份合约的价差将来是扩大还是缩小。</p><p>依据对不同交割月份合约价差未来走势的判断，可将跨期套利的策略划分为三种:</p><p>牛市(多头)跨期套利:即判断远期合约相对近期合约被低估，（设远期合约价格为 F2， 近期合约价格为 F1，则 F2=S0⋅e^(r(T2−T0))，F1=S0⋅e^(r(T1−T0))， 此时 F2 偏小，则存在套利空间，在套利的驱使下，F2 将回归正常，即 F2 将变大）价差将扩大，我们可以买入远期合约的同时卖出近期合约。<br/></p><p>熊市(空头)跨期套利:即判断近期合约相对远期合约被低估，价差将缩小，我们可以买入近期合约的同时卖出远期合约。</p><p>在本文中讨论多头与空头策略，而上述策略的实现则需要跨期套利模型来提供精确的标准来进行。</p><p>传统的股指期货跨期套利依据股指期货的持有成本定价公式产生的无套利空间确定跨期套利策略。如现有近期合约 F1 和远期合约 F2，则依据式 (1) 有:</p><figure><noscript><img src="https://pic1.zhimg.com/v2-ea875a881c0431826f2f963c30526678_b.png" data-rawwidth="415" data-rawheight="50" class="content_image" width="415"/></noscript><img src="https://pic1.zhimg.com/v2-ea875a881c0431826f2f963c30526678_b.png" data-rawwidth="415" data-rawheight="50" class="content_image lazy" width="415" data-actualsrc="https://pic1.zhimg.com/v2-ea875a881c0431826f2f963c30526678_b.png"/></figure><p>如不考虑交易费用， 则 (r−q)(T2−T1) 是两对数序列的价差的平衡点，则当这两对数序列的价差大于 (r−q)(T2−T1) 时，说明价差偏大，价差将缩小，则实行空头策略，反之，则实行多头策略。然而这一模型存在如下缺陷:</p><p>①基于持有成本理论中的股息收益率 q 不易确定，限制了其应用;</p><p>②基于持有成本理论的套利往往需要经历较长时间才能完成，因为它的价差会一直处于偏高或偏低的状态，只有在合约临近到期时才有回归的压力。</p><h4>使用协整模型</h4><p>基于协整的跨期套利模型则可以避免上面的缺陷，并且可以充分利用已有的市场交易数据所提供的最新信息，从而发现更多的套利机会。其基本思路如下:</p><p>假设现有一段时间内的两期货合约序列分别设为近期合约 F1 和远期合约 F2，本文先将这段时间分成两段(前一段时间较长)，然后以第一段数据建立模型，第二段数据以第一段数据建好的模型为依据来进行交易。</p><p>一、在第一段数据中，先对两合约序列取对数为 ln⁡F1，ln⁡F2，则这两对数序列的协整关系处理可分为两步：首先，检验 ln⁡F1，ln⁡F2是否存在单位根；其次，若这两对数序列都存在单位根，那么就检验它们是否存在协整关系，即对它们建立回归方程（A,B 代表方程回归系数，resid1代表回归残差项）：</p><p><figure><noscript><img src="https://pic3.zhimg.com/v2-74b6d55624806098e141fd545a14779e_b.png" data-rawwidth="386" data-rawheight="54" class="content_image" width="386"/></noscript><img src="https://pic3.zhimg.com/v2-74b6d55624806098e141fd545a14779e_b.png" data-rawwidth="386" data-rawheight="54" class="content_image lazy" width="386" data-actualsrc="https://pic3.zhimg.com/v2-74b6d55624806098e141fd545a14779e_b.png"/></figure>若 resid1 不含单位根为平稳序列，则两对数序列存在协整关系。</p><p>二、接着将这一协整模型结果代入到第二段数据中，并设在这一时点满足上一段时间的回归关系，即：</p><p><figure><noscript><img src="https://pic1.zhimg.com/v2-3916a191692e09cbc975ae11e9f9ff8c_b.png" data-rawwidth="406" data-rawheight="53" class="content_image" width="406"/></noscript><img src="https://pic1.zhimg.com/v2-3916a191692e09cbc975ae11e9f9ff8c_b.png" data-rawwidth="406" data-rawheight="53" class="content_image lazy" width="406" data-actualsrc="https://pic1.zhimg.com/v2-3916a191692e09cbc975ae11e9f9ff8c_b.png"/></figure>而第一段数据中建立的协整模型的残差为 resid1，其样本标准差为 std(resid1)，则再设：<br/></p><figure><noscript><img src="https://pic1.zhimg.com/v2-73248695ea46bd36357265d8a4ccdf1c_b.png" data-rawwidth="386" data-rawheight="43" class="content_image" width="386"/></noscript><img src="https://pic1.zhimg.com/v2-73248695ea46bd36357265d8a4ccdf1c_b.png" data-rawwidth="386" data-rawheight="43" class="content_image lazy" width="386" data-actualsrc="https://pic1.zhimg.com/v2-73248695ea46bd36357265d8a4ccdf1c_b.png"/></figure><p>三、本文可以认为在第一段时间内建立的模型在第二段时间内依然成立，所以以resid2 和 resid1 有相同的分布，且都是均值为 0 的白噪声。由此可知， resid2 时刻存在着向均值 0 回归的内在要求，而不像基于持有成本理论定价的套利策略只有在合约临近到期时价差才有回归的压力，这样的特性使得可以发现更多的套利机会。当 resid2 的绝对值超过一个样本方差时（也就是当 |resid3|&gt;1 时），可以认为是一个较好的套利机会，但当 resid2 的绝对值超过两个样本方差（也就是当 |resid3|&gt;2）这样的小概率事件发生时，则往往意味着这两对数序列的协整关系已经不再成立。综上所述，本文可将开仓平仓的标准如下设定:</p><p>当 resid3 的绝对值超过 1 且小于 2 时开仓;</p><p>开仓后当 resid3 回落到 0 值时平仓;</p><p>开仓后当 resid3 的绝对值超过 2 时认亏平仓。</p><p>这样的开仓平仓标准可以确保两对数序列的价差在可控的范围内，而不像基于持有成本理论的套利策略那样:开仓后价差不在可控范围内，可能会向不利方向发展过大从而导致爆仓。</p><h4>策略交易过程</h4><p>我们以 10 年 7 月 1 日 14:21 这一时间点为例来介绍一下上述策略的执行过程：<br/>（1）我们在每一个分钟数据上取过去 240 分钟的 IF1007 和 IF1008 的收盘数据F1,F2，对上述数据取对数，得到 ln⁡F1 和 ln⁡F2。利用 ADF 检验判断 ln⁡F1 和 ln⁡F2 是否为平稳时间序列：</p><figure><noscript><img src="https://pic1.zhimg.com/v2-7974b39d170ba99e05e1e66fd21a16e0_b.png" data-rawwidth="390" data-rawheight="104" class="content_image" width="390"/></noscript><img src="https://pic1.zhimg.com/v2-7974b39d170ba99e05e1e66fd21a16e0_b.png" data-rawwidth="390" data-rawheight="104" class="content_image lazy" width="390" data-actualsrc="https://pic1.zhimg.com/v2-7974b39d170ba99e05e1e66fd21a16e0_b.png"/></figure><p>由上可知 ln⁡F1 和 ln⁡F2 均为非平稳序列。</p><p>（2）对 ln⁡F2 和 ln⁡F1 做回归可得：</p><p><figure><noscript><img src="https://pic3.zhimg.com/v2-d8b1fba014d40dae8339fd7b236c7b2a_b.png" data-rawwidth="513" data-rawheight="48" class="origin_image zh-lightbox-thumb" width="513" data-original="https://pic3.zhimg.com/v2-d8b1fba014d40dae8339fd7b236c7b2a_r.jpg"/></noscript><img src="https://pic3.zhimg.com/v2-d8b1fba014d40dae8339fd7b236c7b2a_b.png" data-rawwidth="513" data-rawheight="48" class="origin_image zh-lightbox-thumb lazy" width="513" data-original="https://pic3.zhimg.com/v2-d8b1fba014d40dae8339fd7b236c7b2a_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-d8b1fba014d40dae8339fd7b236c7b2a_b.png"/></figure>对 resid1 进行 ADF 检验：<br/></p><figure><noscript><img src="https://pic4.zhimg.com/v2-7e8f77110f6d483cefab7a1286102187_b.png" data-rawwidth="395" data-rawheight="61" class="content_image" width="395"/></noscript><img src="https://pic4.zhimg.com/v2-7e8f77110f6d483cefab7a1286102187_b.png" data-rawwidth="395" data-rawheight="61" class="content_image lazy" width="395" data-actualsrc="https://pic4.zhimg.com/v2-7e8f77110f6d483cefab7a1286102187_b.png"/></figure><p>可以发现残差项此时的 p 值仅为 0.000412，远小于 0.01 的临界值。此时我们认为两个对数序列满足协整关系，接着我们可以利用这一协整关系来进行交易。</p><p>（3）接下来这段时间内我们可以利用上述选择的标准进行交易。首先我们认为这段时间内协整关系依然会保持下去。因此当两股指期货价格出现偏离时，其偏离最终会回归到 0。具体交易思路如下，在每个交易分钟开始时我们取上一分钟的两股指期货的收盘价的对数，记为 ln⁡F1 和 ln⁡F2，将其带入步骤（2）中得到残差项 resid2：</p><p><figure><noscript><img src="https://pic2.zhimg.com/v2-64c3cf17189fe4878b0c131e731e5e9d_b.png" data-rawwidth="518" data-rawheight="41" class="origin_image zh-lightbox-thumb" width="518" data-original="https://pic2.zhimg.com/v2-64c3cf17189fe4878b0c131e731e5e9d_r.jpg"/></noscript><img src="https://pic2.zhimg.com/v2-64c3cf17189fe4878b0c131e731e5e9d_b.png" data-rawwidth="518" data-rawheight="41" class="origin_image zh-lightbox-thumb lazy" width="518" data-original="https://pic2.zhimg.com/v2-64c3cf17189fe4878b0c131e731e5e9d_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-64c3cf17189fe4878b0c131e731e5e9d_b.png"/></figure>将这一残差项标准化为 resid3=resid2/std(resid1)；则 resid3 有向 0 均值回归的特性。根据这一特征我们设计了下面的交易策略：</p><p>1， 在 14:21时，如果 resid3&gt;1 且 resid3&lt;2，说明远期的股指期货相对近期的股指期货价格偏高。因此进入近期期货合约的长头寸同时进入远期期货合约的短头寸。反之，如果 resid3&lt;−1 且 resid3&gt;−2 时，按照和上述相反的头寸进行建仓。由于过大的交易量在实际交易中会造成较大的冲击成本，为了反映现实情况我们将交易量限制在下一分钟两个期货合约交易量的十分之一。</p><p>2， 在 1&lt;resid3&lt;2 的情况下建仓后，如果当 |resid3|&lt;1 时，我们认为 resid3 向均值 0 回归，此时我们将在 (1) 中建立的仓位平仓。当|resid3|&gt;2 时我们认为判断出现错误，resid3 并没有按照预期回归到 0，此时为了避免更大的损失我们提前平仓止损。</p><p>3， 在 15 年 9 月 7 日之后因为交易数量有限制，最多只能交易 10 日，且平今仓手续费变为原来的的 100 倍因此我们此处严格按照这一限制进行仓位操作。</p><h4>回测结果</h4><p>在以下的回测中为了更贴近现实，我们回测中选取中国金融期货交易所中公布的手续费率，保证金比例以及平今仓手续费率。</p><p>首先看一下从 10 年 5 月到 16 年 12 月之间的回测结果：</p><p><figure><noscript><img src="https://pic4.zhimg.com/v2-f5f7e864d4793f743827e7141aafb053_b.png" data-rawwidth="1171" data-rawheight="332" class="origin_image zh-lightbox-thumb" width="1171" data-original="https://pic4.zhimg.com/v2-f5f7e864d4793f743827e7141aafb053_r.jpg"/></noscript><img src="https://pic4.zhimg.com/v2-f5f7e864d4793f743827e7141aafb053_b.png" data-rawwidth="1171" data-rawheight="332" class="origin_image zh-lightbox-thumb lazy" width="1171" data-original="https://pic4.zhimg.com/v2-f5f7e864d4793f743827e7141aafb053_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-f5f7e864d4793f743827e7141aafb053_b.png"/></figure>可以发现，这一股指期货的跨期套利策略还是比较有效的，但 15 年 9 月政策收紧后，套利空间基本不存在了（尤其是由于平今仓手续费过高的原因实际已经接近 T+1 制度）。可以看出这一策略还是能准确的利用股指期货价格的偏离，将风险控制在一个较低的水平。再来分段看下：<br/></p><p><figure><noscript><img src="https://pic1.zhimg.com/v2-311e195ace75a82fe65c72d83bd76b74_b.png" data-rawwidth="1137" data-rawheight="324" class="origin_image zh-lightbox-thumb" width="1137" data-original="https://pic1.zhimg.com/v2-311e195ace75a82fe65c72d83bd76b74_r.jpg"/></noscript><img src="https://pic1.zhimg.com/v2-311e195ace75a82fe65c72d83bd76b74_b.png" data-rawwidth="1137" data-rawheight="324" class="origin_image zh-lightbox-thumb lazy" width="1137" data-original="https://pic1.zhimg.com/v2-311e195ace75a82fe65c72d83bd76b74_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-311e195ace75a82fe65c72d83bd76b74_b.png"/></figure>可以发现随着市场的成熟，在12年1月到12年6月这段时间，套利的空间比较少，并且因为是高频交易产生了很大的手续费，因此出现了一定的回撤。<br/></p><figure><noscript><img src="https://pic3.zhimg.com/v2-42e94ee325b56a7b78dcd1d9a04103f6_b.png" data-rawwidth="1152" data-rawheight="328" class="origin_image zh-lightbox-thumb" width="1152" data-original="https://pic3.zhimg.com/v2-42e94ee325b56a7b78dcd1d9a04103f6_r.jpg"/></noscript><img src="https://pic3.zhimg.com/v2-42e94ee325b56a7b78dcd1d9a04103f6_b.png" data-rawwidth="1152" data-rawheight="328" class="origin_image zh-lightbox-thumb lazy" width="1152" data-original="https://pic3.zhimg.com/v2-42e94ee325b56a7b78dcd1d9a04103f6_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-42e94ee325b56a7b78dcd1d9a04103f6_b.png"/></figure><p>从12年到15年政策收紧之前，整个策略还是有效的，三年间最大回撤为18%，且在15年这段时间内仍然有很大的套利空间存在。</p><p>需要注意的是在本策略中，因为是按分钟数据进行交易，交易的频率偏高，因此对手续费异常敏感，这也是政策收紧调采用调高平今仓手续费的原因之一。<br/></p><h4>函数说明图</h4><figure><noscript><img src="https://pic3.zhimg.com/v2-843ccd78971df6e1cf53737b85a3cf76_b.png" data-rawwidth="1173" data-rawheight="640" class="origin_image zh-lightbox-thumb" width="1173" data-original="https://pic3.zhimg.com/v2-843ccd78971df6e1cf53737b85a3cf76_r.jpg"/></noscript><img src="https://pic3.zhimg.com/v2-843ccd78971df6e1cf53737b85a3cf76_b.png" data-rawwidth="1173" data-rawheight="640" class="origin_image zh-lightbox-thumb lazy" width="1173" data-original="https://pic3.zhimg.com/v2-843ccd78971df6e1cf53737b85a3cf76_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-843ccd78971df6e1cf53737b85a3cf76_b.png"/></figure><p>到JoinQuant查看策略并与作者交流讨论：<a class=" wrap external" href="https://link.zhihu.com/?target=https%3A//www.joinquant.com/post/4296%3Ff%3Dzhzl%26m%3D24786849" target="_blank" rel="nofollow noreferrer">【量化课堂】股指期货跨期套利策略</a></p>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
