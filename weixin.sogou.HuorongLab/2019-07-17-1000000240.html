<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>灰色产业链成病毒传播最大渠道   流量生意或迎来最后的疯狂</title>
</head>
<body>
<p><a href="https://mp.weixin.qq.com/s?timestamp=1563841474&amp;src=3&amp;ver=1&amp;signature=X4*QKRGiQY1*9WCpqMF6-9tRvSwabFiGkEn8bgyyI2RmFuXDxK7-*eD1WB0RhJdIBneQernYC8Z5KmPQe53LpXGKcoeJpIcYrmgW*VcnR4095iD4e0dQf3UEaCcnNAYTGIfRWbcj-aGZfPcsdx-e-xPbQmOS5*5CkJcaW6SADtk=">原文</a></p>
<div id="js_top_ad_area" class="top_banner"></div><div class="rich_media_inner">

        
        
		<div id="page-content" class="rich_media_area_primary">

		  <div class="rich_media_area_primary_inner">

            
                          
                        

            <div id="img-content">

                
                <h2 class="rich_media_title" id="activity-name">
                    
                    
                    
            灰色产业链成病毒传播最大渠道   流量生意或迎来最后的疯狂
                      </h2>
                <div id="meta_content" class="rich_media_meta_list">
                                                            <span id="copyright_logo" class="rich_media_meta rich_media_meta_text meta_tag_text">原创：</span>
                                                            <span class="rich_media_meta rich_media_meta_text">	 
                        	 
                        火绒安全实验室	 
                        	 
                    </span>
                                        
                                        <span class="rich_media_meta rich_media_meta_nickname" id="profileBt">
                      <a href="javascript:void(0);" id="js_name">
                        火绒安全实验室                      </a>
                      <div id="js_profile_qrcode" class="profile_container" style="display:none;">
                          <div class="profile_inner">
                              <strong class="profile_nickname">火绒安全实验室</strong>
                              <img class="profile_avatar" id="js_profile_qrcode_img" src="" alt="">

                              <p class="profile_meta">
                              <label class="profile_meta_label">微信号</label>
                              <span class="profile_meta_value">HuorongLab</span>
                              </p>

                              <p class="profile_meta">
                              <label class="profile_meta_label">功能介绍</label>
                              <span class="profile_meta_value">火绒是一家纯粹的信息安全公司。在这里为大家分享专业的技术报告和安全信息。</span>
                              </p>
                              
                          </div>
                          <span class="profile_arrow_wrp" id="js_profile_arrow_wrp">
                              <i class="profile_arrow arrow_out"></i>
                              <i class="profile_arrow arrow_in"></i>
                          </span>
                      </div>
                    </span>


                    <em id="publish_time" class="rich_media_meta rich_media_meta_text"></em>





                </div>

                
                
                                
                
                
                
                                                
                                                                
                                
                
                <div class="rich_media_content " id="js_content">
                    

                    

                    
                    
                    <p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>【快讯】劫持浏览器、刷取流量等行为是流氓软件常见行为，而随着安全厂商持续打击、普通用户的安全意识提升，让病毒团伙、流氓软件厂商的获利空间被逐渐压缩。近期，“火绒威胁情报系统”监测到，病毒团伙为了获取更多的利润，开始与广告推广平台“合作”暗刷流量，以此欺骗用户和广告主、对抗安全厂商。这种病毒和广告联盟协同暗刷坑害广告主的行为、这种近乎癫狂的传播模式，似乎在宣告“流量生意”的彻底黑化。</span></p><p><br></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>根据“火绒威胁情报系统”监测发现，万能压缩、万能看图、Clover等多款软件正在静默推广后门程序“眼睛的守护神”，截至到目前，已有几十万用户被捆绑安装该后门程序。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>该后门程序被捆绑安装至用户电脑后，会通过远程服务器下载病毒 ，并静默推广鲁大师手机模拟大师等其它多款软件。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>通过查验签名得知，“眼睛守护神”的数字签名与其下发的病毒签名相同，或系同一家病毒软件厂商所为。</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.6090909090909091" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5g4BtK1dKZlnpA2ClstYnydkYkWq7PfgfVEnW4cubAPcqjdGlwibxv92A/640?wx_fmt=png" data-type="png" data-w="880" style=""></p><p style="text-align: justify;"><br><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>用户下载上述软件后，该后门程序即会进入电脑并暗自安装，安装过程中不会出现任何提示，且安装完成后也不会在桌面、开始菜单中创建任何相关快捷方式，用户很难找到软件功能入口。</span></p><p><br></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>安装完毕后，后门程序会通过远程服务器在后台悄悄下载病毒到本地执行。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>病毒可以劫持用户浏览器首页、暗刷流量，甚至会令安全软件部分防御功能失效。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>该病毒更加流氓之处在于，将用来刷取流量的页面广告内容全部设置为不可见，病毒在暗刷流量时用户完全无法察觉。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>此外，该后门程序还会静默推广鲁大师手机模拟大师等其它多款软件。</span></p><p><br></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>值得注意的是，万能压缩等系列软件下载量较大，其推广行为也较为疯狂（2018年双十一期间，火绒就这些软件的流氓推广进行跟踪分析，详情见报告《"双十一"成流氓软件爆发高峰 日均侵权推广1.7亿次》），目前已经造成病毒在短时间内大量传播的影响和危害。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>火绒工程师提醒广大用户小心防范，如果下载过上述软件，请尽快使用安全软件进行排查。</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="1.3846153846153846" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5gtRSt1gCyJ7PrvkYMea7S1j24rxklicswASFFebHzMleM9sKDvqj0E2A/640?wx_fmt=png" data-type="png" data-w="312" style="width: 243px;height: 336px;"></p><p style="text-align: justify;"><br><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>火绒用户使用“火绒安全软件”（个人版4.0与5.0公测版、企业版）最新版即可查杀上述病毒。</span></p><p><br></p><p><span style="font-size: 15px;">附【分析报告】：</span><span style="font-size: 15px;"><strong style='max-width: 100%;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 16px;letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);box-sizing: border-box !important;overflow-wrap: break-word !important;'></strong></span></p><p><br></p><p style="text-align: justify;"><span style="font-size: 16px;"><strong><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>一、病毒分析</span></strong></span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>近期火绒发现一款名为眼睛守护神的软件正在广泛传播，该软件实为伪装成正常软件的后门程序。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>该后门程序会通过C&amp;C服务器配置下载执行的病毒会进行首页劫持、暗刷流量，甚至会使安全软件部分防御功能失效（通过移除正常软件内核回调的方式），除下载执行病毒文件外，该后门程序还会静默推广包括鲁大师手机模拟大师在内的多款软件。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>通过溯源分析，我们发现该后门程序会通过万能压缩、万能看图、Clover等多款软件以静默推广的方式进行传播。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>传播流程，如下图所示：</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-ratio="0.6090909090909091" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5g4BtK1dKZlnpA2ClstYnydkYkWq7PfgfVEnW4cubAPcqjdGlwibxv92A/640?wx_fmt=png" data-type="png" data-w="880" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>传播流程图</span></p><p style="text-align: justify;"><br></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>后门程序安装程序与我们截获的其中一个病毒驱动文件均带有“南京星洪科技有限公司”有效数字签名。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>文件信息，如下图所示：</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-ratio="0.6932907348242812" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5gr7VticfVWibNNyLLl6EYfygKHKw060Qibu2u4QUFYF9nU0H4O1fTxwtIA/640?wx_fmt=png" data-type="png" data-w="939" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>文件信息</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>数字签名信息，如下图所示：</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-ratio="1.3127659574468085" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5gF6KkvhaFqDI8MddNElAv7VchnawL8t7IksMpOcHGyPzspMhcIwCmaw/640?wx_fmt=png" data-type="png" data-w="470" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>数字签名</span></p><p><br></p><p style="text-align: justify;"><strong><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>眼睛守护神</span></strong><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>眼睛守护神安装程序为7z自解压包，安装过程中不会出现任何安装提示，且安装完成后不会在桌面、开始菜单中创建任何相关快捷方式，用户很难找到软件功能入口。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>眼睛守护神传播病毒流程，如下图所示：</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="1.8952879581151831" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5gInK5FibSCkdyreYo39Qq5zxrqtUbo1sxhy6nNNImcY0OYXCp0x8yQcQ/640?wx_fmt=png" data-type="png" data-w="191" style=""></p><p><br></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>眼睛守护神传播病毒流程</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>上图中调用关系中，EPSvcControl虽然被EPTool调用后执行后续病毒传播逻辑，但是EPTool中也存在相同的云控代码，可以独立下载执行其他文件甚至病毒。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>EPTool调用EPSvcControl模块，如下图所示</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="1.7774647887323944" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5gB1PXfFa9pgWTls3icwEHypUnBPuLYToTZA33YS8uKCbHTR3ibNI0vnug/640?wx_fmt=png" data-type="png" data-w="710" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>调用EPSvcControl.exe模块</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>EPSvcControl模块被调用后，会从C&amp;C服务器地址hxxp://biz.chlbiz.com/files/eyepatron/conf/remaintask.dat下载配置文件。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>相关代码，如下图所示：</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.4470284237726098" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5g5LMSPJ64lUskOdo27XtNPeeic7ic4gMasFKA9tG7AuvCCMbNPvAJibPBA/640?wx_fmt=png" data-type="png" data-w="774" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>下载remaintask.dat文件</span></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>下载到文件内容后，通过 BASE64+AES解密(密钥为“xcN2gedfty2iCjkL”)后，得到json格式的推广配置文件。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>相关代码，如下图所示：</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.5441988950276243" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5gv57CfdL0sKiaQ2jlUFANuibYctk9kvVWoH6cCuRk2ibxwOiciacTHFM56Uw/640?wx_fmt=png" data-type="png" data-w="724" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>解密文件</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>解密之后的推广配置文件中包含有推广触发条件，主要包含排除的城市名、触发概率、检测的安全软件进程名和推广程序下载地址。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>经过我们一段时间的跟踪，被下载执行的病毒文件在今年7月之前为acm.exe（释放驱动劫持首页、暗刷流量），在7月份之后被下载执行的病毒文件为InstExe_????.exe（流量暗刷，下文中称其为InstExe），且至今该病毒依然在进行更新。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>病毒传播时间线，如下图所示：</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.5659203980099502" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5gLUg7XHGSDQBdEFJAuK5lgCvcEk7RJmTWt99ic4LGuoJQvic9n8bl4BCQ/640?wx_fmt=png" data-type="png" data-w="804" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>病毒传播时间线</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>下载执行InstExe病毒文件的相关配置内容，如下图所示：</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.7409972299168975" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5ggDN2dAsxniar3njzHl9a6Xx2FpTJia8NG4aIcQz5hBmlFariclcZfBRIA/640?wx_fmt=png" data-type="png" data-w="722" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>配置文件</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>下载执行acm.exe的相关配置，如下图所示：</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.7174479166666666" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5gOc3G8p8nNGkTTVRHbdVMgpO0cJjk0htjlnibFKxHjrelsxywEpicjBoQ/640?wx_fmt=png" data-type="png" data-w="768" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>配置文件</span></p><p style="text-align: justify;"><br></p><p style="text-align: justify;"><strong><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>acm.exe</span></strong><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>acm.exe会释放加载随机名病毒驱动，驱动成功加载后会通过注入进程的方式劫持浏览器首页，并创建浏览器控件窗体进行流量暗刷。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>该病毒进行首页劫持时现象，如下图所示：</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.5597014925373134" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5gxkTZsIRSINicbB9ogVYK4096s3H8kk6JBibd86Km1V1RA1CMaibWqwmnA/640?wx_fmt=png" data-type="png" data-w="1072" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>首页劫持现象</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>现阶段该病毒注入explorer后会在其创建的浏览器控件中显示C&amp;C服务器页面hxxps://whale123.com/stat/corp.html（站长统计）和hxxps://whale123.com/stat/ie.php（流量暗刷），用来刷取用户流量。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>由于病毒创建的浏览器控件所在窗体在用户可视范围之外，所以在刷取流量时用户不会有任何察觉。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>窗体位置相关信息，如下图所示：</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.7462311557788944" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5ggUScfR26SKt7mpluJEUn8NHyibpLDPYLUxHvPLeMx65icO0t5WicVFQuA/640?wx_fmt=png" data-type="png" data-w="398" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>窗体位置相关信息</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>相关窗体，如下图所示：</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.4328824141519251" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5gia73CEaPgC6fLLanoPPB2sc30LgXOz29mPn5Bo7zFoHgiamyaWFM9FjA/640?wx_fmt=png" data-type="png" data-w="961" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>浏览器控件窗体</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><strong><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>随机名驱动</span></strong></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>acm.exe运行后，首先会释放加载随机名病毒驱动。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>该病毒驱动文件同样也带有“南京星洪科技有限公司”有效数字签名，与眼睛守护神后门程序使用的数字签名相同，且该病毒由眼睛守护神后门程序进行传播，所以上述二者具有同源性。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>如下图所示：</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.6879659211927582" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5gQTWV7uv2evic7UkiaEfPZoodjJYj6eq84r7CSc7Pyj4ZBA1k27I8Pgzw/640?wx_fmt=png" data-type="png" data-w="939" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>病毒驱动数字签名信息</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>病毒驱动的主要功能是将恶意代码注入到explorer.exe、iexplore.exe等进程中进行首页劫持和流量暗刷。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>释放注册病毒驱动相关代码，如下图所示：</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="1.1833333333333333" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5gVwJPfAic3aZRte3ZDX9n0tOdOuLBkDvkh57pibo5qYWEXlVBS1GWIXog/640?wx_fmt=png" data-type="png" data-w="600" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>释放加载病毒驱动相关代码</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>病毒驱动主要功能分为两个部分，将恶意代码注入到指定进程、删除其他驱动注册的回调函数。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>该病毒驱动加载后，首先会初始化注入相关的数据，包括需要注入的恶意代码数据、系统版本等。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>有意思的是，该病毒为了提高自身的隐蔽性，病毒安装后的前60天与大于60天后注入的恶意代码内容不是相同的。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>前60天仅会通过C&amp;C服务器中搭建的跳转页面劫持推广计费名，并不会改变最终的访问地址；</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>60天之后，只要是指定的浏览器进程启动，都会将启动参数劫持为带有其自身推广计费名的2345导航链接。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>注入数据相关初始化代码，如下图所示：</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.9107142857142857" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5gMGNNCJiaoBSZckULglFtV7ibmRtE3jbaYiaRGBunwSglKPnkSLVV9kNTA/640?wx_fmt=png" data-type="png" data-w="1064" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>初始化注入数据</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>在注入资源初始化时，会将需要注入的进程名列表进行分割后，逐个计算CRC32，用于后续注入操作。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>相关代码，如下图所示：</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.5519677093844602" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5gWroWLd2mG6fx4dzVKu77qgrntKAIX0QuZ1r8QckrVPhnVsGicI0HShg/640?wx_fmt=png" data-type="png" data-w="991" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>将进程名逐个计算CRC32</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>被恶意代码进程注入的软件列表，如下图所示：</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.19132893496701225" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5gECr2S0mZ6HJueohv96yEJO6CHOQI85aoTz6Fgne9jLRZW1HAzH7GYA/640?wx_fmt=png" data-type="png" data-w="1061" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>软件列表</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>注入功能主要通过进程回调和模块加载回调实现，当进程启动时，病毒注册的进程回调负责将需要注入的进程PID加入到需要注入的数据列表中，之后在模块加载回调中将恶意代码注入到指定进程。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>进程回调相关代码，如下图所示：</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="1.2245098039215687" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5gdzZ1x5EQG5ljejZNibWFbicmfVssq6CHicwr7Yyuvght8ZaH1cYvJfpicw/640?wx_fmt=png" data-type="png" data-w="1020" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>进程回调</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>在记录注入进程时，会判断进程名的CRC32是否在需要注入的进程列表中，之后再根据进程的平台版本（x64/x86）插入到不同的进程列表中。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>相关代码，如下图所示：</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="1.8986666666666667" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5gyayx7tY0JibWreicOPxBTVNicWH0r3GMH2YjaVrrW9icibuVqJEgdzqHXlg/640?wx_fmt=png" data-type="png" data-w="1125" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>将进程PID插入到进程列表</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>在模块加载回调中，如果发现当前加载模块的PID在进程列表中则会根据进程的平台版本（x64/x86）判断需要获取调用LdrLoadDll、Wow64ApcRoutine、LdrGetProcedureAddress、NtProtectVirtualMemory函数地址进行进程注入。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>如下图所示：</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="1.4967948717948718" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5gjyKNkcb7Vthh7icwiameWCibP0B7w3AatkicBr8aN8Md4JJJcC8dbTksDw/640?wx_fmt=png" data-type="png" data-w="936" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>模块加载回调</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>插入APC相关代码，如下图所示：</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="1.0466732869910627" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5gjBchdA6m3icflEytb48WfsUcBa0ia9rJjm3pM89YfL1mAuSKSdB7zCSQ/640?wx_fmt=png" data-type="png" data-w="1007" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>插入APC相关代码</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>除此之外，病毒驱动还会创建内核线程删除其他软件进程回调和模块加载回调。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>首先，病毒代码会获取需要放过的驱动模块基址和模块范围（相当于白名单）。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>之后在PsSetCreateProcessNotifyRoutine函数二进制代码中找到进程回调函数队列，将除白名单以外的所有进程回调移除。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>有意思的是，除系统驱动程序和病毒自身外，相关病毒代码中仅会排除360安全卫士名为“360FsFlt.sys”和“hookport.sys”的驱动程序。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>被排除的驱动白名单，如下图所示：</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.14158504007123776" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5gOM7uopOgQcGSLcfmTwLQG1x6S371wcCI6sgDng0XQC1hwA0gHpkIEw/640?wx_fmt=png" data-type="png" data-w="1123" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>白名单</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>相关代码，如下图所示：</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.7106652587117213" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5glB0zn2u3gsQXOAqibQKp0n4l76xKtUo3ws6atAvV5eAlXtliaqR5xzFQ/640?wx_fmt=png" data-type="png" data-w="947" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>移除进程回调</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>然后再通过PsSetLoadImageNotifyRoutineEx或者PsSetLoadImageNotifyRoutine获取模块加载回调函数队列，将白名单以外的回调移除。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>相关代码，如下图所示：</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.6590198123044838" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5g6xc7IlQKcaKtAAlKcalKYCxLC6zxzAKRaD5E9IP6NYDBzSC16IhxVw/640?wx_fmt=png" data-type="png" data-w="959" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>移除模块加载回调</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: center;"><br></p><p style="text-align: center;"><br></p><p style="text-align: left;"><strong><span style='background-color: rgb(255, 255, 255);font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;'>被注入的恶意代码</span></strong></p><p style="text-align: left;"><span style='text-align: justify;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>被注入的恶意代码中主要包含两部分功能：</span><span style='text-align: justify;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>劫持浏览器启动参数和释放加载corp.dll（用于进行流量暗刷的病毒模块）。</span><span style='text-align: justify;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>受影响的浏览器与前文驱动中内容相同，此处不再进行赘述。</span><span style='text-align: justify;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>当启动进程与劫持列表中情况相符时，即会修改浏览器进程的启动参数。</span><span style='text-align: justify;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>相关代码，如下图所示：</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'></span></p><p style="text-align: center;"><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.7448586118251928" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5gSnKbMKFMkeEg7iaOqSAIzmrM8TDib6y0LyoiadNlKofwTsR8C3qdo1Fyg/640?wx_fmt=png" data-type="png" data-w="1556" style="text-align: center;white-space: normal;"></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>劫持代码</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>被劫持的网址可以通过%APPDATA%\safebrain\conf.ini进行获取，如果获取不到会设置为代码中设置的默认值（默认值代码中所示）。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>相关代码，如下图所示：</span></p><p style="text-align: center;"><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.7244488977955912" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5gQPewDOThI4vzfqlgcP0PicH7X7zL51oEWnMAOAej1IkX5f27SOsZWeQ/640?wx_fmt=png" data-type="png" data-w="998" style="text-align: center;white-space: normal;"></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>获取启动参数</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>释放加载corp.dll相关代码，如下图所示：</span></p><p style="text-align: center;"><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.9004424778761062" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5grotic7FxeEISB895SsYuAscWAVUpgXutFnqmB1kmBSaLicj3M4AxGzrA/640?wx_fmt=png" data-type="png" data-w="452" style="text-align: center;white-space: normal;"></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>释放加载</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><strong><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>corp.dll</span></strong><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>corp.dll动态库加载后会创建浏览器控件窗体，并将起始URL设置为网页链接hxxps://whale123.com/stat/corp.html，之后再将页面跳转到hxxps://whale123.com/stat/ie.php进行流量暗刷。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>www.whale123.com为聚软科技广告投送平台官网地址，有意思的是在该站点下面的ie.php页面中展示的广告内容均不可见。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>创建浏览器控件窗体相关代码，如下图所示：</span></p><p style="text-align: center;"><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="1.4677777777777778" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5g66G6lyYqYX0McxlDHoia4O7oDtMXPJHQyUd2Y1QC1Us1VypYafmrQBg/640?wx_fmt=png" data-type="png" data-w="900" style="text-align: center;white-space: normal;"></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>创建浏览器窗体</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>在窗体创建时会设置timer，在窗体创建300秒后将页面设置为暗刷页面。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>相关代码，如下图所示：</span></p><p><br></p><p style="text-align: center;"><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.35977859778597787" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5gNxSfETQNRvd8f0va3iagq7cT4SGp7t6kHTKGdNY7XGXluojOmicdS84A/640?wx_fmt=png" data-type="png" data-w="542" style="text-align: center;white-space: normal;"></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>设置暗刷页面</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>ie.php是一个跳转页面，会基于一定概率跳转到流量暗刷页面刷取流量。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>除此之外，用来刷取流量的页面对广告内容全部设置了不可见属性，所以即使当用户将窗体移动至可见区域内也依然无法确认该窗体在刷取流量。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>ie.php中的html代码，如下图所示：</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.44541484716157204" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5gJASMLCZopfSgeX4tPicprRcbbnJUib3CmS0CicoYAnR5HtAACcHcyJqhw/640?wx_fmt=png" data-type="png" data-w="916" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>ie.php中的html代码</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>该页面运行后会刷取多个站点的流量，包括《神武3》官网、风行网等。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>刷取流量所访问的网站页面，如下图所示：</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.7849293563579278" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5gdxOtOEUkPnHZeuposzayoTTnInxKIyFfLLVFt76woY34UibiaDwBF2Tw/640?wx_fmt=png" data-type="png" data-w="1274" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>刷取流量所访问的网站页面</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>所以，这个将自己标榜为精准投放的广告投放平台本身就做着流量暗刷的灰色业务和病毒一起“合作”暗刷流量坑害广告主的利益。</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.3714136671883151" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5gD75ggYueIjbDZQAUDEwYj1k9SH7tdLoyWd6L1Wf5oZgqhZvQrorrdg/640?wx_fmt=png" data-type="png" data-w="1917" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>聚软科技广告投放平台首页</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><strong><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>InstExe</span></strong><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>该病毒与acm.exe功能相似，运行后会创建隐藏的浏览器控件窗体暗刷流量，但该病毒还在持续更新中，病毒运行后还会检测本地系统环境后将相关信息上传至C&amp;C服务器（hxxp://192.186.7.71:2001）。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'> 该病毒为了躲避安全软件查杀，其对主要功能模块进行了加密。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>解密相关代码，如下图所示：</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.8226466575716235" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5gHPlM7ibj8ulAW85QPBUPx47skIwORY8gAmJ2hK6jabAYNpZern6GXuw/640?wx_fmt=png" data-type="png" data-w="733" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>解密主要病毒功能模块</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>该病毒为了提高自身隐蔽性，运行后会检测安全软件和安全分析工具，从而躲避安全软件查杀。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>检测内容，如下图所示：</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.42525399129172714" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5gqxznXztoHqcvIJQVTLxYEpibooYPGVjsIW0kY8ny1uNF6rWvibJ3Za8w/640?wx_fmt=png" data-type="png" data-w="689" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>被检测的安全软件</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>被检测的安全分析工具，如下图所示：</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.5192563081009296" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5gVUOibaVFpsXS0TdibYEYsxOgdckI2ZdyZtjXCtacptOsAqWj0s7WBgdA/640?wx_fmt=png" data-type="png" data-w="753" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>被检测的安全分析工具</span></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>该病毒运行后会将本地系统信息（系统版本等）发送至病毒服务器，相关代码如下图所示：</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.5582990397805213" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5goKibV9fyMCClGfYmoqlnXKT8yxOxGrnTM3TZe3icLwiahUlgcLuwzoeow/640?wx_fmt=png" data-type="png" data-w="729" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>发送本地系统数据</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>病毒运行时会访问配置文件，配置文件内容包含有：</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>排除城市、释放动态库时使用的随机文件名、360安全卫士相关信任区信息等。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>相关配置，如下图所示：</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.27411167512690354" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5g3fJYff4pXWmicjiaRQhhOVgPThFC1yODhich9ASExqQuBEAjgkMhZcQMw/640?wx_fmt=png" data-type="png" data-w="1182" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>配置文件</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>病毒会创建浏览器控件窗体暗刷流量，最终意图与前文中acm.exe基本相同。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>相关代码，如下图所示：</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="1.1020689655172413" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5gKGq7UWzEbaPsVYqGgW1r1pVFBW5DaNibllLNsROmBwT8c25434RYX4Q/640?wx_fmt=png" data-type="png" data-w="725" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>注册浏览器窗体类</span></p><p style="text-align: justify;"><br></p><p style="text-align: justify;"><span style="font-size: 16px;"><strong><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>二、传播渠道分析</span></strong><strong><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'></span></strong></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>通过火绒终端威胁情报系统追踪，我们发现万能压缩、万能看图、Clover等多款软件会根据云控数据推广眼睛守护神，并致使病毒大范围传播。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>火绒前期报告《"双十一"成流氓软件爆发高峰 日均侵权推广1.7亿次》中，就曾经对万能压缩、万能看图、Clover等多款软件的流氓广告弹窗进行过分析说明，上述软件在进行流氓推广的同时，已经冲破了法律红线沦落为病毒传播渠道，致使病毒程序使用上述软件大范围传播，已经严重危害到了软件用户的信息安全，希望上述软件厂商抓紧彻查相关病毒威胁，坚守法律红线。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>下文中以Clover为例进行代码溯源分析。</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>当Clover软件安装完成后，点击快捷方式或启动资源管理器时，其主程序模块Clover.exe会启动执行。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>Clover程序执行会装载clover_dll.dll，并执行导出函数CloverMain。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>如下图所示，</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.841715976331361" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5gsyJZyvh3un7NDzKtepzR2QzWicGaPgueWmvlu0Od02PKiaxEIMgvrcibQ/640?wx_fmt=png" data-type="png" data-w="676" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>执行CloverMain导出函数</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>在CloverMain函数中会调用ClvAssist.exe模块，参数为RunAssist，如下图所示：</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.2668213457076566" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5g92aoicHsdoAlelO3cHHWQ0iap5ol77H4tAb1HgRIMUWvP5Utxiad9XGicQ/640?wx_fmt=png" data-type="png" data-w="862" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>调用ClvAssist模块</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>ClvAssist.exe启动后会从hxxp://down.shusw.com/clv/st/tsk.dat 下载配置文件tsk.dat 。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>如下图所示：</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.31851851851851853" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5g1BBMYUwmg0FWMXq3udicu24oFn15ibHzenxtuic1bknhDiaVrVSWNyma5g/640?wx_fmt=png" data-type="png" data-w="810" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>下载配置文件tsk.dat</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>通过“GUANGSU”循环异或解密配置文件数据后，可以得到原始配置数据。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>得到XML格式的配置文件， 如下图所示：</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.29389312977099236" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5gj2j7ucufAykBqr2hPDOR1kXGKodh4iawI5W9nEYSeicDibxrRJAkicSib7A/640?wx_fmt=png" data-type="png" data-w="524" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>解密后的配置文件</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>解密相关代码，如下图所示：</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.33798882681564246" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5gbrq0hKLhCv0GBcRYicia0RT9F4lMbCtRiaRbKeTTX6vaVSribDwReUHDLQ/640?wx_fmt=png" data-type="png" data-w="716" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>解密配置文件</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>根据解密出的配置文件从http://down.shusw.com/clv/st/tsk.gif下载tsk.gif模块。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>如下图所示，</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.45431789737171463" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5gqWLhVH22Ackicu0UMS4QmtnIJ0Nib5xLjOLheIxcGaeoiaJsPHRYHorXw/640?wx_fmt=png" data-type="png" data-w="799" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>下载tsk.gif</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>tsk.gif不是gif图片文件，实际为加密后的dll文件，对其进行解密（DES解密算法，密钥为”万能的主“）并解压缩得到dll。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>相关代码，如下图所示：</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.7012987012987013" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5go4n9Flib69Fo0vJfOp4QLyByVBicdGZoIPsdlyfL5c1B5ygqNcCVfj8w/640?wx_fmt=png" data-type="png" data-w="770" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>解密并解压缩得到dll文件</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>装载dll并调用TaskRunPath等导出函数设置运行参数信息， 最后调用TaskStart进行广告弹窗和推广。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>如下图所示，</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.6452380952380953" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5gz8t86w2gUxo8ERvUpCwpjtcBT4KDtIUWH30AWHiaibQlYPauaZibe6hMA/640?wx_fmt=png" data-type="png" data-w="840" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>调用导出函数</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>TaskStart函数从资源节取出XML配置文件，如下图所示</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.36018957345971564" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5gH5NHExX28GRG6mNsyfFmu9AicpdpdZDDibCyyeBqMJYicfic3R4QqibibeWw/640?wx_fmt=png" data-type="png" data-w="633" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>从资源中获取配置数据</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>相关配置数据，如下图所示：</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.5400313971742543" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5gYFSw0WrodXRW8u3Hib0FOrnuuRjtDPK3PV6ib3RNSd2YLNflz6wEEyHQ/640?wx_fmt=png" data-type="png" data-w="637" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>从资源节取出配置文件</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>根据配置取得地址http://down.shusw.com/clv/st/rpv1.dat下载加密后配置文件rpv1.dat，进行解密（“GUANGSU“循环异或），内容为之后要调用的任务信息。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>如下图所示，</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.5208791208791209" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5gXZIHZDqFm0HiahuUX5W3RNnX7aDCRkrRmXEZic5N9u6ia9Eq7J4O7Wmcw/640?wx_fmt=png" data-type="png" data-w="910" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>任务信息配置文件</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>在多个任务中， 其中有名为“Flush”的任务，会调用Clvhelper模块，参数为RunHP hxxp://downsrf.eastday.com/clv/flush/Flush.gif。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>Clvhelper.exe开始执行后，会从hxxp://downsrf.eastday.com/clv/flush/Flush.gif下载文件（现阶段该链接地址已无法返回有效数据），进行DES解密（密钥为“万能的主”）并解压得到dll文件。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>接着程序装载dll并执行，跳入导出函数run_lib或Run执行。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>如下图所示，</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.594885598923284" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5gZVlusOfBBiauEt3u2929J52xhmzhq2mmIOKLkEbHP9icUMjnswZuwR0Q/640?wx_fmt=png" data-type="png" data-w="743" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>执行导出函数run_lib或Run</span></p><p style="text-align: justify;"><br></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>run_lib函数从hxxp://www.chlbiz.com/file/url请求配置信息。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>如下图所示，</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.48123620309050774" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5gUEEsatQyibcUFRWReV89Jt0rqWDuT6q9AIYlpicfIwngBicK20pvo5zRQ/640?wx_fmt=png" data-type="png" data-w="906" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>请求配置文件</span></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>对配置信息进行Base64+AES解密（密钥为“xcN2gedfty2iCjkL“），且该密钥与前文中眼睛守护神病毒模块中的解密密钥和解密方式完全相同。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>如下图所示，</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.36063708759954494" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5gvQfjVxppIL3zQmmNEib8yJ6KaSZlH4LF13aeTkPWyG77cYBcYdvl8tQ/640?wx_fmt=png" data-type="png" data-w="879" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>解密配置</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>现阶段已经获取不到与上述逻辑相关的有效的配置数据。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>得到配置信息，如下图所示：</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.03926701570680628" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5gnB6R9z7suHb1ib4u3q801AEJZ8vSgPyAkVRkW7Pm5IjNroGROuVDofw/640?wx_fmt=png" data-type="png" data-w="382" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>配置信息</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>并根据解密得到的网址下载dll进行装载，并调用导出函数run_lib进行程序推广。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>相关代码，如下图所示：</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.32476319350473615" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5gI2XKibIqwuswOnq4PriaXyDYpqDqMGaVfxIYSbibLMZ3ZZhbI0ovdfTmQ/640?wx_fmt=png" data-type="png" data-w="739" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>调用run_lib导出函数</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>除此之外，我们在Clover的配置文件中找到了关于其他同源软件的配置信息，经过搜集分析，配置文件中的其他软件中均包含恶意推广模块，且极其相似。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>包含的软件如下：</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.2803738317757009" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5gXVnwBLVIUunvNfVJJ8MpGMbqhNJhee92YoH97ssUiaA23Y8XQsdvjqg/640?wx_fmt=png" data-type="png" data-w="535" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>软件列表</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>相关配置信息，如下图所示：</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="2.07010582010582" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5gsvj4KtHm62J32RicVth5k5tv5RBJLs1GPN4KhHPAmvJTWQ2lGFU7uxA/640?wx_fmt=png" data-type="png" data-w="756" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>配置信息</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>这些软件中的重要推广模块代码具有极高的相似性，包括配置文件的解密算法、配置文件、动态库的解密算法以及动态库中的配置文件，导出函数等。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>从上述的软件中任意挑选几款软件进行举例说明：</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>万能压缩、万能看图、Clover。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>配置文件的解密为简单的循环异或，密钥为“GUANGSU”。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>如下图所示：</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.5245220282626767" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5gOnOdSXXtiaBhOtXqs8AEOvgMz8FL7bicD1NRibdgpibQMpXLc2qxFibLy1A/640?wx_fmt=png" data-type="png" data-w="1203" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>配置文件解密</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>解密出来的配置文件格式相似。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>如下图所示，</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.3507326007326007" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5gcUqMQqUqbfZibibiclP6NUrBZKPfUicpB3c0ibJFiaQe65q2ZZnz6QWbGJ6A/640?wx_fmt=png" data-type="png" data-w="1092" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>配置文件格式相似</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>动态库的解密均采用CBC模式DES算法，密钥为"万能的主”，初始IV为0。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>部分程序解密出的动态库为相同的文件。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>如下图所示：</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.8874788494077834" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5giaqU7YccqjncZugelyrhqhKc1VCxHSDDibzricw4q1xAvgibyIvgzgqDfg/640?wx_fmt=png" data-type="png" data-w="1182" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>解密动态库</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>解密出的dll文件中含有后续任务信息的xml文件。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>格式相同，且多个配置文件里的部分url链接相同。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>如下图所示：</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="1.1776" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5gVwcFGAvnVVr3uOXzWaZnicas24ekwWzAa44nf0CXQouMeWbRSSibiav0g/640?wx_fmt=png" data-type="png" data-w="1250" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>后续任务信息的配置文件地址信息</span></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>解密出的dll的导出函数相同。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>如下图所示：</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.34413407821229053" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5gSR3Jj4RhkicR6TvUwcYB3csX5QzCJOX4R2eXNficibH28HOQ8hbkXialmQ/640?wx_fmt=png" data-type="png" data-w="895" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>导出函数相同</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>综上所述，上述系列软件中均包含有相同的推广逻辑代码，且经过火绒终端威胁情报系统统计万能压缩、万能看图、Clover等软件会推广该后门程序（眼睛守护神），感染终端数量经推算在几十万台量级。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>相关数据，如下图所示：</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.5225225225225225" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5ggsd8p3A3Uk5HcdR0KtdpqGGFYumta4BKDdHezezhMWMTQgZaWRAnWw/640?wx_fmt=png" data-type="png" data-w="666" style=""></p><p style="text-align: center;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>感染数据</span></p><p style="text-align: justify;"><br></p><p style="text-align: justify;"><span style="font-size: 16px;"><strong><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>三、附录</span></strong></span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'></span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'>样本hash：</span></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'><br></span></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.35851183765501693" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4sickCUGIlk5d312fhHID5gAgMDyI0LJR9uIl4WaUsWe3vNn5yLsTuDUNXQ6LziaZMjb1txGLjcCJA/640?wx_fmt=png" data-type="png" data-w="887" style=""></p><p style="text-align: justify;"><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);'></span><br></p><p><br></p>
                </div>
                <script nonce="1024832662" type="text/javascript">
                    var first_sceen__time = (+new Date());

                    if ("" == 1 && document.getElementById('js_content')) {
                        document.getElementById('js_content').addEventListener("selectstart",function(e){ e.preventDefault(); });
                    }

                    
                    (function(){
                        if (navigator.userAgent.indexOf("WindowsWechat") != -1){
                            var link = document.createElement('link');
                            var head = document.getElementsByTagName('head')[0];
                            link.rel = 'stylesheet';
                            link.type = 'text/css';
                            link.href = "//res.wx.qq.com/mmbizwap/zh_CN/htmledition/style/page/appmsg_new/winwx473e11.css";
                            head.appendChild(link);
                        }
                    })();
                </script>

                
  <div class="ct_mpda_wrp" id="js_sponsor_ad_area" style="display: none;"></div>


                
                <div class="read-more__area" id="js_more_read_area" style="display:none;">
                    
                </div>

                
                                <div class="reward_area tc reward_area_primary" id="js_preview_reward_author" style="display:none;">
                    <div class="reward-avatar" style="display: none;" id="js_preview_reward_author_avatar">
                        <img src="" alt="" id="js_preview_reward_author_head">
                    </div>
                    
                                        <div class="reward-author" id="js_preview_reward_author_name">火绒安全实验室</div>
                                        <p class="reward_tips" id="js_preview_reward_author_wording" style="display:none;"></p>
                    <p class="reward_button_wrp">
                    
                      <span class="reward_pop_panel">
                        <img src="https://res.wx.qq.com/mpres/zh_CN/htmledition/pages/home/index/pic_mp_app4290ba.png" alt="">
                        <strong>扫一扫下载订阅号助手，用手机发文章</strong>
                      </span>
                        <a class="reward_button" id="js_preview_reward_author_link" href="##"><span id="js_preview_reward_link_text">赞赏</span></a>
                    </p>
                </div>

                <div class="reward_qrcode_area reward_area tc" id="js_preview_reward_qrcode" style="display:none;">
                    <p class="tips_global">长按二维码向我转账</p>
                    <p id="js_preview_reward_ios_wording" class="reward_tips" style="display:none;"></p>
                    <span class="reward_qrcode_img_wrp"><img class="reward_qrcode_img" src="//res.wx.qq.com/mmbizwap/zh_CN/htmledition/images/pic/appmsg/pic_reward_qrcode.2x42f400.png"></span>
                    <p class="tips_global">受苹果公司新规定影响，微信 iOS 版的赞赏功能被关闭，可通过二维码转账支持公众号。</p>
                </div>
                            </div>
                                    
                        


                        
            <ul id="js_hotspot_area" class="article_extend_area"></ul>


            

            


<div class="rich_media_tool" id="js_toobar3">

  <div class="weui-flex">
    <div class="weui-flex__item">

                              <div id="js_read_area3" class="media_tool_meta tips_global_primary meta_primary" style="display:none;">
        <span id="readTxt">阅读</span>
        <span id="readNum3"></span>
      </div>
          </div>

            <span style="display:none;" class="media_tool_meta meta_extra meta_praise" id="like_old">
          <i class="icon_praise_gray"></i><span class="praise_num" id="likeNum_old"></span>
      </span>

          
    <span class="media_tool_meta meta_extra meta_share" style="display: none;">
      <button class="share_btn" id="js_share_btn">分享</button>
    </span>
    <span style="display:none;" class="media_tool_meta meta_extra meta_like" id="like3">
        <button class="like_btn" id="js_like_btn"> 
          <span id="js_like_wording"> 在看</span><span class="like_num" id="likeNum3"></span>
        </button>
    </span>

          
        </div>
</div>

<div style="display:none">
    <div class="weui-mask"></div>
    <div class="weui-dialog weui-dialog_haokan">
      <div class="weui-dialog__hd"><strong class="weui-dialog__title" id="educate_title">已同步到看一看</strong></div>
      <div class="weui-dialog__bd">
      </div>
      <div class="weui-dialog__ft" id="educate_btn" style="display: none">
        <a href="javascript:;" class="weui-dialog__btn weui-dialog__btn_default" id="js_cancel">取消</a>
        <a href="javascript:;" class="weui-dialog__btn weui-dialog__btn_primary" id="js_confirm">发送</a>
      </div>
      <div class="weui-dialog__ft" id="educate_btn2" style="display: none">
        <a href="javascript:;" class="weui-dialog__btn weui-dialog__btn_primary" id="js_acknowledge">我知道了</a>
      </div>
    </div>
</div>
<div style="display: none;" id="js_like_educate" class="like_skin_primary like_comment_primary_pop">
  <div id="js_like_educate_wrapper" class="like_comment_primary_wrp like_comment_primary_pos_top">
    <div class="like_comment_primary_inner">
      <div class="like_comment_primary_hd">
        <h4 class="like_comment_primary_title">
          朋友会在“发现-看一看”看到你“在看”的内容        </h4>
        <button id="js_b_like_confirm" class="like_comment_primary_btn">确定</button>
      </div>
      <div class="like_comment_primary_bd">
        <img class="pic_haokan" src="//res.wx.qq.com/mmbizwap/zh_CN/htmledition/images/pic/appmsg/pic_haokan4516f7.png">
      </div>
    </div>
  </div>
  <div class="like_comment_primary_mask" id="js_mask_3"></div>
</div>

  
  <div class="like_comment_wrp" id="js_a_like_comment" style="display: none;">
    <div class="like_comment_inner">
      <div class="like_comment_hd" style="display:none" id="js_like_title"></div>
      <div class="like_comment_bd">
        <div class="tips_global_primary like_comment_tips">
          <i class="weui-icon-success"></i><i class="icon-success-primary"></i>已同步到看一看<a href="javascript:;" class="like_comment_share_link" id="js_a_like_comment_share">写下你的想法</a>
        </div>
      </div>
      <div class="like_comment_ft">
        <span id="js_a_like_comment_msg" class="like_comment_msg" style="visibility:hidden">最多200字，当前共<span id="js_a_like_current_cnt"></span>字</span>
        <button class="like_comment_btn" disabled id="js_a_like_confirm">发送</button>
      </div>
    </div>
  </div>

<div id="js_like_toast" style="display: none;">
  <div class="weui-mask_transparent"></div>
  <div class="weui-toast">
    <i class="weui-icon-success-no-circle weui-icon_toast"></i>
    <p class="weui-toast__content" id="js_toast_msg">已发送</p>
  </div>
</div>


<div style="display: none;" id="js_b_comment_panel" class="like_comment_primary_pop">
  <div class="like_comment_primary_wrp" id="js_b_wrp">
    <div class="like_comment_primary_inner">
      <div class="like_comment_primary_hd">
        <h4 class="like_comment_primary_title">
          朋友将在看一看看到        </h4>
        <button id="js_b_like_confirm" class="like_comment_primary_btn">确定</button>
      </div>
      <div id="js_b_comment_text_first" class="like_comment_primary_bd">
        <span class="tips_global_primary">
          写下你的想法...        </span>
      </div>
    </div>
  </div>
  <div class="like_comment_primary_mask" id="js_mask_1"></div>
</div>

<div style="display: none;" id="js_b_comment_final">
  <div class="like_comment_primary_wrp editing" id="js_comment_wrp">
    <div class="like_comment_primary_inner">
      <div class="like_comment_primary_hd">
        <button class="like_comment_primary_cancel" id="js_b_comment_cancel">取消</button>
        <h4 class="like_comment_primary_title"> 发布到看一看 </h4>
        <button class="like_comment_primary_btn" id="js_b_comment_confirm">确定</button>
      </div>
      <div class="like_comment_primary_bd">
        <textarea class="like_comment_textarea weui-textarea" placeholder="写下你的想法..." id="js_b_comment_text_second"></textarea>
      </div>
      <span class="like_comment_msg" id="js_b_like_comment_msg" style="visibility: hidden;">最多200字，当前共<span id="js_b_like_current_cnt"></span>字</span>
    </div>
  </div>
  <div class="like_comment_primary_mask" id="js_mask_2"></div>
</div>

<div id="js_loading" style=" display: none;">
    <div class="weui-mask_transparent"></div>
    <div class="weui-toast">
        <i class="weui-loading weui-icon_toast"></i>
        <p class="weui-toast__content">发送中</p>
    </div>
</div>



                        <div class="rich_media_tool" id="js_sg_bar">

                                
            </div>
                      </div>
        </div>

        <div class="rich_media_area_primary sougou" id="sg_tj" style="display:none"></div>


        
        <div class="rich_media_area_extra">
          <div class="rich_media_area_extra_inner">
              
              <div id="js_share_appmsg">
              </div>

              
  
      <div class="mpda_bottom_container" id="js_bottom_ad_area"></div>
                
              <div id="js_iframetest" style="display:none;"></div>
                            
                            
              <div class="rich_media_extra rich_media_extra_discuss" id="js_cmt_container" style="display:none">
                

                
                <div class="discuss_mod" id="js_friend_cmt_area" style="display:none">
                  
                  
                  
                </div>

                                <div class="discuss_mod" id="js_cmt_area" style="display:none">
                </div>
                              </div>
          </div>
        </div>

        
        <div id="js_pc_qr_code" class="qr_code_pc_outer" style="display:none;">
            <div class="qr_code_pc_inner">
                <div class="qr_code_pc">
                    <img id="js_pc_qr_code_img" class="qr_code_pc_img">
                    <p>微信扫一扫<br>关注该公众号</p>
                </div>
            </div>
        </div>
    </div>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
