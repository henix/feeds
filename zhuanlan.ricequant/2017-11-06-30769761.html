<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>虚拟交易员HS300指数择时-使用A3C训练卷积网络逼近函数</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/30769761">原文</a></p>
<div class="title-image"><img src="https://pic1.zhimg.com/v2-6308f6aa43b494db55f39681d05677ec_r.jpg" alt=""></div><p>对<a href="https://github.com/AlphaSmartDog/DeepLearningNotes/tree/master/Note-6%20A3CNet/Note-6.2%20A3C%E4%B8%8EHS300%E6%8C%87%E6%95%B0%E6%8B%A9%E6%97%B6">Note-6.2 A3C与HS300指数择时</a> 代码简述</p><p>使用asynchronous advantage actor-critic 框架优化两个神经网络近似函数，训练一个虚拟的指数择时交易员。</p><p><i>A3C</i> 的计算框架简单说就是多个<i>AC</i> （Actor-Critic）同步进行工作，并且每个一段时间交流一下修正方向。简单的使用一个课题组进行比喻，设某课题有导师一人，学生N人，对一项课题进行研究。每周学生找导师交流一次，或每次学生卡壳找导师交流一次。这样所有的探索经验都会上传到导师处，导师综合所有的探索，同时了解多方向的进展和问题，修正课题组研究路线。学生获得导师的经验，可以从导师处获得技巧或者杀招，加速自己这一周研究进程。</p><p>具体到代码，优化器放在Access中，在每t_max时间步后N个Worker探索获得梯度上传到Access中通过优化器更新Access中神经网络逼近函数的权重，并将Access中使用梯度修正的权重取回初始化本地的Worker神经网络权重。所有的可训练变量全部定义在Trainable Net中。</p><h2><b>forward network</b></h2><p>actor network</p><ul><li>conv swich</li><li>conv swich</li><li>linear swich</li><li>linear num_action</li></ul><p>critic network</p><ul><li>conv swich</li><li>conv swich</li><li>linear swich</li><li>linear 1</li></ul><p>注由于估值函数误差较大，这里选择使用两个训练网络</p><p><br></p><hr><p><br></p><p>出于简单考虑，这里假设指数交易训练是马尔可夫决策过程，并且使用有限的市场行情回溯窗口。</p><p>具体，交易员训练环境设计为：Environment 简单的使用日线HS300指数bar数据，在每交易日交易员发出交易指令，如沽空，environment 使用当日开盘价做空，使用当日收盘价评价这次交易行为的价值， 使用收盘价+账户现金存余-当日交易摩擦成本为当日账户总值。</p><p>对于虚拟交易员（Agent）使用32交易日reward折现值为target进行优化。</p><p><br></p><hr><p><br></p><p>虚拟交易员样本外交易账户净值走势</p><img src="https://pic2.zhimg.com/v2-9fd146133321e7b7587dd8ab40a85220_r.jpg" data-caption="" data-rawwidth="947" data-rawheight="356"><p></p>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
