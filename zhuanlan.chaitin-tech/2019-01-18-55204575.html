<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>洞鉴（X-Ray）手记之二 | 以攻击者视角智能探测漏洞</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/55204575">原文</a></p>
<div class="title-image"><img src="https://pic4.zhimg.com/v2-b0eee306b34e541c1bbef7db764bdeb6_b.jpg" alt=""></div><blockquote>“漏洞就如同雨后蘑菇，永远都摘不完，一场大雨之后，新的蘑菇又冒出来了。”</blockquote><p>随着国家对网络安全的重视，公众对 Web 安全的关注聚焦，越来越多的行业领域开始将扫描器作为首选的企业安全评估系统，比如检测院所等政府机构、联通移动等大型运营商、银行证券等金融行业……然而网站环境的复杂和差异，让扫描器很难自如应对各种场景，比如： </p><p>* 认证使用 JWT 的网站</p><p>* 前端技术为主的单页应用</p><p>* 伪静态 Web 应用</p><p>* 前端路由加后端渲染模板的应用</p><p>* 利用 iframe 嵌套的应用</p><p>所以，如何智能地识别场景，帮助企业用户快速发现漏洞、识别漏洞、定位漏洞，并验证漏洞是否真实存在，成了当下亟待解决的问题。</p><p>而国内外主流漏扫产品均存在误报率和漏报率高、安全评估不准、扫描效率低下、不适用于复杂的网站环境等缺陷。为了解决实际场景问题，洞鉴（X-Ray）从攻击者的视角出发，智能判断场景，对漏洞进行探测和验证，从而大大提高了扫描准确率，真正起到防微杜渐的作用。</p><h2><b>洞鉴(X-Ray)智能探测工作模式</b></h2><p>扫描器在做漏洞探测时，一般都是分为以下几步进行：</p><p>1. 确认探测目标，建立 TCP 连接</p><p>2. 从数据库中提取待检测的漏洞</p><p>3. 根据特定扫描策略检测目标</p><p>4. 根据目标服务器返回的信息判断漏洞是否存在，以及给出漏洞说明、验证信息和修复建议等</p><p>而所谓的攻击者视角智能探测，主要体现在了两个方面，一是探测目标的收集，二是漏洞探测的匹配。这些在人工渗透测试的过程中都是凭借个人经验来进行探测的。在这里，我们赋予洞鉴（X-Ray）智能算法，以攻击者的角度从外网环境黑盒的视角智能发现攻击点。</p><p>以 Web 扫描为例，对于普通应用界面和伪静态界面，洞鉴（X-Ray）会采用普通爬虫进行 Web 扫描，其中在对伪静态界面扫描期间，会智能加入去重算法，对信息采集过程进行优化。而对于单页应用界面各种复杂的情况，洞鉴（X-Ray）可以采用模拟浏览器的方式进行主动扫描，或者人工触发的方式进行被动扫描，最终将采集到的目标作为扫描目标，进入漏洞探测阶段。工作原理如下图所示：</p><figure><noscript><img src="https://pic2.zhimg.com/v2-c8a5baf0296640edbb2d4f44c4917d0d_b.jpg" data-caption="" data-size="normal" data-rawwidth="1272" data-rawheight="988" class="origin_image zh-lightbox-thumb" width="1272" data-original="https://pic2.zhimg.com/v2-c8a5baf0296640edbb2d4f44c4917d0d_r.jpg"></noscript><img src="https://pic2.zhimg.com/v2-c8a5baf0296640edbb2d4f44c4917d0d_b.jpg" data-caption="" data-size="normal" data-rawwidth="1272" data-rawheight="988" class="origin_image zh-lightbox-thumb lazy" width="1272" data-original="https://pic2.zhimg.com/v2-c8a5baf0296640edbb2d4f44c4917d0d_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-c8a5baf0296640edbb2d4f44c4917d0d_b.jpg"></figure><h2><b>特色优势</b></h2><p><b>适用场景丰富</b></p><p>支持对业界主流的 Web 安全攻防靶场的扫描，比如 DVWA、WebGoat、Benchmark、PentesterLab；在覆盖传统扫描器适用的场景外，洞鉴（X-Ray）也支持以下网站环境（不限于此）的扫描：</p><p>- 用 React、Vue 等动态生成页面的技术框架开发的网站</p><p>- 单页应用</p><p>- 利用 iframe 嵌套的应用</p><p>- 基于 JWT 认证网站，例如：JWT 认证一般 Token 不一定存在 Cookie 中，而是放在 Authorization 这个头中的，会定时刷新</p><p>- 基于 HTTP 请求头的特殊场景：token 和一个 random number 在 cookie 中，每次动态请求，服务器都会返回 Set Cookie，设置新的 token 和 random number</p><p>下面是洞鉴对单页 Web 应用靶场的扫描结果展示，单页应用采用 JWT 认证，网站开发涉及 React、Vue、Bootstrap 技术框架的应用，存在的漏洞有 SQL 注入、XSS、命令注入等主流漏洞。</p><figure><noscript><img src="https://pic3.zhimg.com/v2-2d0f63bb2774952d536bd6d1b5e80b1e_b.jpg" data-caption="" data-size="normal" data-rawwidth="1151" data-rawheight="886" class="origin_image zh-lightbox-thumb" width="1151" data-original="https://pic3.zhimg.com/v2-2d0f63bb2774952d536bd6d1b5e80b1e_r.jpg"></noscript><img src="https://pic3.zhimg.com/v2-2d0f63bb2774952d536bd6d1b5e80b1e_b.jpg" data-caption="" data-size="normal" data-rawwidth="1151" data-rawheight="886" class="origin_image zh-lightbox-thumb lazy" width="1151" data-original="https://pic3.zhimg.com/v2-2d0f63bb2774952d536bd6d1b5e80b1e_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-2d0f63bb2774952d536bd6d1b5e80b1e_b.jpg"></figure><p><b>验证性漏洞，准确率高</b></p><p>洞鉴（X-Ray）扫描出的每个漏洞都是真实验证的，货真价实。每个漏洞详情，都会给出漏洞位置、验证方式和利用方式的详细说明。既满足了没有任何技术基础的人可以读懂漏洞、验证漏洞的要求，还进一步证实了洞鉴探测漏洞的准确性。</p><p>洞鉴（X-Ray）支持对 DVWA 不同安全等级进行探测，探测结果如下图所示： </p><figure><noscript><img src="https://pic3.zhimg.com/v2-bc8a7006c9765ab19b3135b699463a2a_b.jpg" data-caption="" data-size="normal" data-rawwidth="1252" data-rawheight="576" class="origin_image zh-lightbox-thumb" width="1252" data-original="https://pic3.zhimg.com/v2-bc8a7006c9765ab19b3135b699463a2a_r.jpg"></noscript><img src="https://pic3.zhimg.com/v2-bc8a7006c9765ab19b3135b699463a2a_b.jpg" data-caption="" data-size="normal" data-rawwidth="1252" data-rawheight="576" class="origin_image zh-lightbox-thumb lazy" width="1252" data-original="https://pic3.zhimg.com/v2-bc8a7006c9765ab19b3135b699463a2a_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-bc8a7006c9765ab19b3135b699463a2a_b.jpg"></figure><p><br></p><p><b>安全可靠，无害验证</b></p><p>这个时候，可能有人会有疑问，直接验证漏洞、利用漏洞，难道不会对网站或服务器造成什么危害吗？ 比如比较典型的危害就是误删、误改业务数据等。其实针对可能会造成危害的情形，在洞鉴（X-Ray）系统中都针对性地做了特殊处理，可以说我们的 POC 在验证漏洞时是对正常业务完全无害的。类似的处理比如 ：</p><p>- 在探测 delete、drop 类型的 sql 注入漏洞时，我们虽然会验证漏洞，但是不会添加类似把用户信息删掉的 payload</p><p>- 在探测 DOS 漏洞时，洞鉴不存在 DOS 客户服务的 POC，而是通过其他维度来探测 DOS 漏洞 </p><h2><b>总结</b></h2><p>作为一家以技术为核心的网络安全公司，长亭科技将时刻关注业界动态，以前瞻性的技术格局和敏锐的攻击者思维去探索企业安全的新问题，发现网络安全世界的新规律，赋予洞鉴（X-Ray）更加智能的探测方法，以防微杜渐的安全思路，保证企业网站业务的安全可靠运行，更好地为各行各业保驾护航。</p>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
