<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>【量化课堂】多头趋势回踩策略</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/21827203">原文</a></p>
<p>导语：雪球文章《多头趋势回撤点：一个好懂又好用的均线策略》介绍了一个择时选股的辅助判断方法。这篇文章将根据这个思路构建一个交易策略，并使用历史回测来检验它的效果。感谢佰股精 。<br/></p><div class="highlight"><pre><code class="language-text">作者：肖睿
编辑：宏观经济算命师

本文由JoinQuant量化课堂推出，难度为进阶上，理解深度为level-0
</code></pre></div><p>到原文阅读体验更佳，而且还能查看代码，回测数据，克隆策略哦！</p><p>连接在此,谁敢点我！<a href="https://link.zhihu.com/?target=https%3A//www.joinquant.com/post/1901%3Ff%3Dzh" class=" wrap external" target="_blank" rel="nofollow noreferrer">╭(╯^╰)╮</a></p><h4>多头趋势回撤点</h4><p>多头趋势回撤的思路，是根据若干条均线呈现出的形态判断一支股票是否处于强势状态，并抓住回调的时机低位买入。顾名思义，这个策略的要点分为两部分：多头趋势和回撤点。<br/><br/><b>多头趋势</b></p><p>如果天数从短到长的移动均线呈从上到下排列的态势，我们判断股价处于多头趋势。</p><p>我们可以将较短的均线视为短线投资者的意向，较长的均线视为长线投资者的意向。那么当股价处于多头趋势时，表示短、中、长线投资者一致看多，即股票价格处于一个强势阶段。</p><p>相应的，同样是利用多根均线，如果天数从短到长的均线呈从下到上排列状态，那么股价则处于空头趋势，这时股价倾向于下跌。如果我们发现几根均线在一段时间里反复交叉，纠缠在一起，那说明股价正处于震荡的阶段。</p><p>举例来说。在下图的情况中，5、10、20、60、120 五根均线为从上至下依次排序，由此判定股价处于多头趋势。<br/><figure><noscript><img src="https://pic4.zhimg.com/46a8e4fb85254e089479313f7d1a58b7_b.png" data-rawwidth="588" data-rawheight="465" class="origin_image zh-lightbox-thumb" width="588" data-original="https://pic4.zhimg.com/46a8e4fb85254e089479313f7d1a58b7_r.jpg"/></noscript><img src="https://pic4.zhimg.com/46a8e4fb85254e089479313f7d1a58b7_b.png" data-rawwidth="588" data-rawheight="465" class="origin_image zh-lightbox-thumb lazy" width="588" data-original="https://pic4.zhimg.com/46a8e4fb85254e089479313f7d1a58b7_r.jpg" data-actualsrc="https://pic4.zhimg.com/46a8e4fb85254e089479313f7d1a58b7_b.png"/></figure></p><p>下图里均线呈完全相反的排列顺序，是空头趋势。<br/></p><figure><noscript><img src="https://pic4.zhimg.com/83e079f473942f040272e6aa1f614343_b.png" data-rawwidth="451" data-rawheight="460" class="origin_image zh-lightbox-thumb" width="451" data-original="https://pic4.zhimg.com/83e079f473942f040272e6aa1f614343_r.jpg"/></noscript><img src="https://pic4.zhimg.com/83e079f473942f040272e6aa1f614343_b.png" data-rawwidth="451" data-rawheight="460" class="origin_image zh-lightbox-thumb lazy" width="451" data-original="https://pic4.zhimg.com/83e079f473942f040272e6aa1f614343_r.jpg" data-actualsrc="https://pic4.zhimg.com/83e079f473942f040272e6aa1f614343_b.png"/></figure><p>再如下图中均线反复交叉的情况，则为震荡趋势。<br/></p><figure><noscript><img src="https://pic1.zhimg.com/a014b4970f1a5beaf0b5d6916f7bbfb0_b.png" data-rawwidth="622" data-rawheight="389" class="origin_image zh-lightbox-thumb" width="622" data-original="https://pic1.zhimg.com/a014b4970f1a5beaf0b5d6916f7bbfb0_r.jpg"/></noscript><img src="https://pic1.zhimg.com/a014b4970f1a5beaf0b5d6916f7bbfb0_b.png" data-rawwidth="622" data-rawheight="389" class="origin_image zh-lightbox-thumb lazy" width="622" data-original="https://pic1.zhimg.com/a014b4970f1a5beaf0b5d6916f7bbfb0_r.jpg" data-actualsrc="https://pic1.zhimg.com/a014b4970f1a5beaf0b5d6916f7bbfb0_b.png"/></figure><p>我们要做的是追随趋势，买入呈现出多头态势股票。问题在于，这些股票都是处于上涨阶段，我们该如何选择合适的点位入场呢？<br/></p><h2>回撤点</h2><p>假设股票处于多头趋势中。如果价格回撤到某一根均线，并且不破坏多头趋势的格局，我们将其称为一个回撤点。</p><p>股价在上涨过程中，短线投资者获利了结会造成股价向下调整，属于正常现象。如果在调整中依然没有破坏多头趋势的形态，那意味着股票依然处于强势阶段并且会继续上涨，那么这个回撤正是适合入场的时机。<br/><figure><noscript><img src="https://pic3.zhimg.com/ee5ee7620dec2b713f42056d7354369a_b.png" data-rawwidth="592" data-rawheight="516" class="origin_image zh-lightbox-thumb" width="592" data-original="https://pic3.zhimg.com/ee5ee7620dec2b713f42056d7354369a_r.jpg"/></noscript><img src="https://pic3.zhimg.com/ee5ee7620dec2b713f42056d7354369a_b.png" data-rawwidth="592" data-rawheight="516" class="origin_image zh-lightbox-thumb lazy" width="592" data-original="https://pic3.zhimg.com/ee5ee7620dec2b713f42056d7354369a_r.jpg" data-actualsrc="https://pic3.zhimg.com/ee5ee7620dec2b713f42056d7354369a_b.png"/></figure>如上图所示，股票的均线呈现出多头趋势。在红圈标明处，股价收盘于 10 日均线之下，并且没有打乱五根均线的多头排列，我们将其视为入场信号。</p><p>当然，任何方法都不是万能的，不是所有的回撤点都会保证收益。举例来说，<br/><br/>在上图中有两个 10 日回撤点，其中的第一个在买入后的确产生了收益，但第二个却持续下跌。为了避免这种情况，我们可以结合其他的方法和思路来强化分析判断的结论。另外，也应该设置判断错误时的止损方案，可以按照百分比止损，也可以根据均线的形态止损：比如当 5日均线交叉 20 日均线，或者当价格跌破 20 日均线时，止损卖出。<br/></p><h4>交易策略</h4><p>仅仅运用多头趋势回撤的思路，我们构建策略如下：</p><p>一、选定一股票池，并且选定一系列系数：<br/>二、一组均线天数 [N1,N2,N3,…,Nk]：总数量 k 限制，按照从小到大 N1≤N2≤⋯≤Nk 排列。当相应天数的移动均线是从大到小排列时，是多头排列的格局；<br/>三、趋势天数 T： 当上面指定的移动均线在 T 天内都处于多头排列时，我们才判断价格处于多头趋势；<br/>四、回撤均线 M：当前一天的最收盘价低于 M 日均线时时判断为回撤；<br/>五、持有股票上限 num_stocks：同时最多持仓 num_stocks 支股票。<br/>六、止损比例 d 和止盈比例 u：当股票价格搞出买入价的 u 倍，或低于买入价的 d 倍时，卖出股票。</p><p>每日执行以下操作<br/>产生信号：<br/>一、选出股票池中所有在过去的 T 个交易日内，[N1,N2,N3,…,Nk] 日均线组按照多头排列的股票，判定为多头趋势；<br/>二、在处于多头趋势的股票中选出前一日收盘价低于 M 日均线的股票，判定为发生回撤点；<br/>三、在所有出现多头趋势回撤点的股票中，去掉已持仓的股票，其余的发出买入信号。<br/>调换仓位：<br/>一、全仓卖出所有达到止盈或止损线的股票；<br/>二、在有现金的情况下，买入所有发出信号的股票，每支股票的买入总值为总资产净值除以 num_stocks。<br/></p><h4>回测结果</h4><p>以下的回测股票池为沪深300成分股。我们多头排列考虑 5、10、20、60、120 日移动均线，将 T=7 天以内都保持多头排列的股票筛选出来；前一日收盘价低于 M=10 日均线的情况判定为发生回撤。最大持有股票为 15 支。并且止损和止盈点为 u=d=5%，也就是说无论先盈利 5%，还是先亏损 5%，都会触发清仓（这样赚钱的来源就完全取决于信号发出后先触碰正 5% 还是负 5%了，未来可以跟凯利公式结合使用）。回测时间从 2007 到 2016，平均年化收益率 13%，较指数有稳定盈利。<br/><figure><noscript><img src="https://pic1.zhimg.com/623af540fb5c1da252c581a3d6231e54_b.png" data-rawwidth="2209" data-rawheight="1161" class="origin_image zh-lightbox-thumb" width="2209" data-original="https://pic1.zhimg.com/623af540fb5c1da252c581a3d6231e54_r.jpg"/></noscript><img src="https://pic1.zhimg.com/623af540fb5c1da252c581a3d6231e54_b.png" data-rawwidth="2209" data-rawheight="1161" class="origin_image zh-lightbox-thumb lazy" width="2209" data-original="https://pic1.zhimg.com/623af540fb5c1da252c581a3d6231e54_r.jpg" data-actualsrc="https://pic1.zhimg.com/623af540fb5c1da252c581a3d6231e54_b.png"/></figure></p><h4>结语</h4><p>最后也重申一下雪球原文提到的一点，<b>这里介绍的是一个辅助择时和选股的思路，并不能单独作为一个完整的交易体系。</b>上面的策略和回测也是对这个思路的一个尝试和检验，验证了它的有效性。但若想投入实际应用，还必须结合其他的分析判断和交易策略。<br/></p><h4>函数和变量说明书</h4><p>函数说明书（点击放大查看）<br/></p><figure><noscript><img src="https://pic1.zhimg.com/ecce6b95363ebe110aef3d3c3b03b164_b.png" data-rawwidth="990" data-rawheight="584" class="origin_image zh-lightbox-thumb" width="990" data-original="https://pic1.zhimg.com/ecce6b95363ebe110aef3d3c3b03b164_r.jpg"/></noscript><img src="https://pic1.zhimg.com/ecce6b95363ebe110aef3d3c3b03b164_b.png" data-rawwidth="990" data-rawheight="584" class="origin_image zh-lightbox-thumb lazy" width="990" data-original="https://pic1.zhimg.com/ecce6b95363ebe110aef3d3c3b03b164_r.jpg" data-actualsrc="https://pic1.zhimg.com/ecce6b95363ebe110aef3d3c3b03b164_b.png"/></figure><p>全局变量说明书（点击放大查看）<br/><figure><noscript><img src="https://pic4.zhimg.com/52dfd9694651ac6083c22e32d12f090b_b.png" data-rawwidth="726" data-rawheight="448" class="origin_image zh-lightbox-thumb" width="726" data-original="https://pic4.zhimg.com/52dfd9694651ac6083c22e32d12f090b_r.jpg"/></noscript><img src="https://pic4.zhimg.com/52dfd9694651ac6083c22e32d12f090b_b.png" data-rawwidth="726" data-rawheight="448" class="origin_image zh-lightbox-thumb lazy" width="726" data-original="https://pic4.zhimg.com/52dfd9694651ac6083c22e32d12f090b_r.jpg" data-actualsrc="https://pic4.zhimg.com/52dfd9694651ac6083c22e32d12f090b_b.png"/></figure></p><p>本文由JoinQuant量化课堂推出，版权归JoinQuant所有，商业转载请联系我们获得授权，非商业转载请注明出处。<br/></p><p>到原文阅读体验更佳，而且还能查看代码，回测数据，克隆策略哦！</p><p>连接在此,谁敢点我！<a href="https://link.zhihu.com/?target=https%3A//www.joinquant.com/post/1901%3Ff%3Dzh" class=" wrap external" target="_blank" rel="nofollow noreferrer">╭(╯^╰)╮</a></p>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
