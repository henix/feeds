<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>从概念到落地：“伪装者”产品的成熟之路</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/58232413">原文</a></p>
<div class="title-image"><img src="https://pic3.zhimg.com/v2-8542c89d89e1c49bfe16abc6540c92be_b.jpg" alt=""></div><p>“伪装者”比喻，对标网络安全领域的欺骗伪装技术，长年以来最最通俗的常规理解：蜜罐。</p><p> 这其实早已不是一个创新的概念，然而许久以来，在商用产品领域也仅仅多停留在“概念”阶段。今天，我们不提磨出耳茧的米特尼克和蜜罐的故事，落地的看看近几年欺骗伪装技术的演变之路，以及一款伪装型商用安全产品的成熟必经之路。</p><p>不得不佩服国际级咨询机构的嗅觉，2016年9月，Gartner的大佬分析师Lawrence Pingree发布了一篇名为《新兴技术分析：欺骗伪装技巧和技术创造了安全技术商机》（Emerging Technology Analysis: Deception Techniques and Technologies Create Security Technology Business Opportunities），详细阐述了欺骗伪装技术作为一个防守型战略在抵御攻击者时具备的优势。2018年的Gartner十大前沿技术的报告中，欺骗伪装技术的重要性又被再次提及。</p><p> 也不得不佩服长亭我司技术大佬的嗅觉，竟然如此无独有偶，早于报告发布3个月的2016年6月，发布了国内第一款基于欺骗伪装技术的内网威胁感知系统——谛听（D-Sensor）。</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-934308991121d24c742734fe680d332d_b.jpg" data-caption="" data-size="normal" data-rawwidth="414" data-rawheight="98" class="content_image" width="414"></noscript><img src="https://pic2.zhimg.com/v2-934308991121d24c742734fe680d332d_b.jpg" data-caption="" data-size="normal" data-rawwidth="414" data-rawheight="98" class="content_image lazy" width="414" data-actualsrc="https://pic2.zhimg.com/v2-934308991121d24c742734fe680d332d_b.jpg"></figure><p>早在几年前，如果去问大部分的安全采购者，可能对基于这一概念的产品都是生疏的，或者说并不能意识到其价值所在。但其实，基于蜜罐探测的使用由来已早。国际范围来说，某些政府机构可能是使用最久最广的，甚至在一些军事对抗领域，对蜜罐探测技术都不陌生。然而提及商用级别的产品，却是近几年才开始受到关注。因此，做好欺骗伪装类安全产品的关键一步：如何使技术本身具备企业级的商用特征和操作功能？ </p><p>与国际上同类产品相似，谛听（D-Sensor）的设计初衷是帮助减缓攻击者的认知过程，干扰自动化工具，拖延攻击者行为。企业级的网络架构中，攻击者信息搜集的过程势必需要嗅探到网络端口、架构、应用、系统和数据等维度，而欺骗伪装技术可以微妙地破坏攻击者和攻击者使用的工具之间的信任感。因此，这是一款以防守和干扰为目的的一种技术产品，并不是具备攻击基因的产品。</p><p>规模越大的企业机构，对基于欺骗伪装技术的、先进的威胁探测和防御解决方案的需求应该是更强的。网络架构的复杂性+海量安全报警信息同时决定了，对欺骗伪装能够模拟的对象类型、仿真精细度、自动化程度有更高的要求。金融机构、医疗健康、政府、软件等垂直行业，更重视欺骗伪装技术在安全架构中的应用。而这些因素，是谛听（D-Sensor）在设计之初就开始考虑和逐步推进的方向。 </p><p>谛听（D-Sensor）上市近三年来，在与多类客户沟通交流的过程中，总结了使用欺骗伪装类产品产生的“三类担心”，并通过产品功能的不断更新和架构迭代使产品逐渐成熟，来消解客户的顾虑。</p><h2><b>担心一：误报</b></h2><p>误报是很多安全产品会出现的问题，大型机构的安全运维人员一定都有过被误报淹没的感觉。因此，“伪装者”产品，高度逼真的欺骗伪装元素显得尤为重要。</p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-eb585f58faec4c360ad74ca292a1219e_b.jpg" data-size="normal" data-rawwidth="415" data-rawheight="92" class="content_image" width="415"></noscript><img src="https://pic3.zhimg.com/v2-eb585f58faec4c360ad74ca292a1219e_b.jpg" data-size="normal" data-rawwidth="415" data-rawheight="92" class="content_image lazy" width="415" data-actualsrc="https://pic3.zhimg.com/v2-eb585f58faec4c360ad74ca292a1219e_b.jpg"><figcaption>伪装对象及伪装难度</figcaption></figure><p>一个“值得信任”的伪装，必须是使用了多层、多样、多维部署，交叉越精细，细节越逼真，才有可能有用、可信、可被理解。谛听（D-Sensor）在这一点上已经可以做到零误报，高度逼真的分布式蜜网，攻击者一旦尝试发送信息或建立初始连接，就一定会被察觉。</p><h2>支持多种探针系统</h2><p>企业用户的业务需求或方向不同，使之使用的服务器操作系统也不尽相同。谛听（D-Sensor）为满足多样用户的业务需求，支持 Windows 32位、Windows 64位、Linux 32位、Linux 64位四种探针的操作系统，覆盖了市面上主流的操作系统。</p><h2>捕获数据更加精准</h2><p>Web 类蜜罐升级优化实现更加精确的识别攻击类型，包括 SQL 注入、 XSS 攻击、SSRF等36种攻击类型，判断和记录入侵及探测行为。</p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-1f64a66eef2d6bf07f38aa3ad5b53b0a_b.jpg" data-size="normal" data-rawwidth="210" data-rawheight="523" class="content_image" width="210"></noscript><img src="https://pic3.zhimg.com/v2-1f64a66eef2d6bf07f38aa3ad5b53b0a_b.jpg" data-size="normal" data-rawwidth="210" data-rawheight="523" class="content_image lazy" width="210" data-actualsrc="https://pic3.zhimg.com/v2-1f64a66eef2d6bf07f38aa3ad5b53b0a_b.jpg"><figcaption>谛听（D-Sensor）可识别的部分攻击列表</figcaption></figure><h2>虚拟机蜜罐</h2><p>虚拟机作为蜜罐迷惑性更高，谛听（D-Sensor）引入基于虚拟化的沙箱技术，系统级别的沙箱，即构建虚拟机蜜罐。</p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-69269bba9ec6fd0e99021ecc80460937_b.jpg" data-size="normal" data-rawwidth="455" data-rawheight="228" class="origin_image zh-lightbox-thumb" width="455" data-original="https://pic4.zhimg.com/v2-69269bba9ec6fd0e99021ecc80460937_r.jpg"></noscript><img src="https://pic4.zhimg.com/v2-69269bba9ec6fd0e99021ecc80460937_b.jpg" data-size="normal" data-rawwidth="455" data-rawheight="228" class="origin_image zh-lightbox-thumb lazy" width="455" data-original="https://pic4.zhimg.com/v2-69269bba9ec6fd0e99021ecc80460937_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-69269bba9ec6fd0e99021ecc80460937_b.jpg"><figcaption>虚拟机蜜罐图解</figcaption></figure><h2><b>担心二：欺骗伪装的可信度</b></h2><p>通俗来说，既“伪装者”的可信度，以及更重要的——会不会阻断业务？</p><p> 一个好的“伪装者”，会让攻击者相信他们眼睛看到的。因此，理解攻击者，是欺骗伪装类产品间产生区别的第二大要素，也是谛听（D-Sensor）在用户的网络环境中能有出色表现的原因。如：在规划和部署节点时，能否结合客户网络架构中的各类威胁信息和其他安全产品进行布局，从而平衡整个网络架构的安全生态？</p><p> Gartner在2015年提出的Deceptive-Response Kill Chain概念，系统的总结了攻击者路径和欺骗伪装类产品如何在各环节发挥作用。</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-d7ac6ff536995bfe5e35f7b29583fe4c_b.jpg" data-caption="" data-size="normal" data-rawwidth="400" data-rawheight="216" class="content_image" width="400"></noscript><img src="https://pic1.zhimg.com/v2-d7ac6ff536995bfe5e35f7b29583fe4c_b.jpg" data-caption="" data-size="normal" data-rawwidth="400" data-rawheight="216" class="content_image lazy" width="400" data-actualsrc="https://pic1.zhimg.com/v2-d7ac6ff536995bfe5e35f7b29583fe4c_b.jpg"></figure><p>同类的逻辑思路可在谛听（D-Sensor）的部署结构和分析呈现维度中找到呼应。让攻击者入“陷阱网”而不自知，才是高质量的“伪装者”。</p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-1b99e8a92167165c80021ade580744b3_b.jpg" data-size="normal" data-rawwidth="400" data-rawheight="410" class="content_image" width="400"></noscript><img src="https://pic4.zhimg.com/v2-1b99e8a92167165c80021ade580744b3_b.jpg" data-size="normal" data-rawwidth="400" data-rawheight="410" class="content_image lazy" width="400" data-actualsrc="https://pic4.zhimg.com/v2-1b99e8a92167165c80021ade580744b3_b.jpg"><figcaption>谛听（D-Sensor）部署结构</figcaption></figure><p>这些是长亭科技基于多年渗透测试服务的积累，以及在国际黑客大赛中实时更新的攻击者技能/技巧知识，融会贯通的赋能产品设计，从而更理解客户的需求。</p><h2><b>担心三：欺骗伪装产品的成熟度</b></h2><p>一款成熟的“伪装者”产品才能对客户起到真实可用的作用。谛听（D-Sensor）作为国内最早发布的一款欺骗伪装类产品，目前已在市场历练近3年的时间，服务过公安、政府、银行、证券、互联网等一众行业用户，在实战中不断丰富提升，比如：</p><h2>基于角色的访问控制：多租户</h2><p>谛听（D-Sensor）的多租户技术实现了在多用户的环境下共用相同的系统或程序组件，并且仍可确保各用户间数据的隔离性。每个租户在共享资源的同时，还可将各自的探针日志、报告等信息分隔开来，大大减少了企业的开销，并且有效的降低了环境建置的成本。</p><h2>自定义查看攻击和探测数据</h2><p>随着企业用户多样性的提升，繁杂多元的攻击方式涌现，客户对产品的数据分析和留存功能也有了更精细化的要求。谛听（D-Sensor）对攻击和探测数据的总览支持自定义查看方式，使用者可根据自身需求选择查看某个时间段的总览数据来进行分析，数据的展示更是支持折线图、环形图等多种形式。</p><h2>灵活配置白名单</h2><p>传统安全产品的白名单配置只支持将单一的 IP 列入白名单，这样处理的弊端是：一旦企业内部有进行日常活动的访问情况，将会产生大量的日志数据，同时还会向告警接收邮箱、syslog 信息接收服务器发送大量的告警信息，显然这些信息无益于分析真正的攻击探测数据，还会与有价值的数据抢占内存与磁盘资源。</p><p>谛听（D-Sensor）支持将源 IP 和目标 IP 分别放入白名单，并实现了两方端口的自由组合。白名单活动的记录方式配置也更加灵活，发送告警邮件、发送 syslog、是否记录日志可进行多选的自由组合，企业在进行日常的业务活动时大大消除干扰信息。</p><h2>大型架构下稳定性增强</h2><p>当企业网络架构复杂，业务量巨大时，意味着需要部署分布式蜜网的结构也更加复杂，探针的数量也会相应较大，随之可能会造成系统不稳定等诸多问题。谛听（D-Sensor）的优势在于面对探针数量增多后系统稳定性，包括前台列表页面展示以及后台运行性能，对探针流量有着很强的承载能力。</p><h2><b>最佳实践案例</b></h2><h2><b>某上市证券公司</b></h2><h2><b>用户需求</b></h2><p>某上市证券公司在规划网络安全防护体系过程中，决定采用网络欺骗技术来提升整体防护能力，改善攻防双方情报不对等的现状，结合第三方威胁情报、安全集中管理平台和网络防护设备，积极应对不同攻击者的挑战。</p><p>该用户下辖多个服务网点，拥有多个对外服务系统，用户计划在真实环境部署监测节点，识别恶意访问并将其引入布设好的蜜网环境中，实现混淆攻击者视线、保护真实资产、追踪攻击者源头的业务目标。</p><h2><b>解决方案</b></h2><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-c1e704f5a6135b9ee37e0f6b19748c34_b.jpg" data-size="normal" data-rawwidth="326" data-rawheight="162" class="content_image" width="326"></noscript><img src="https://pic1.zhimg.com/v2-c1e704f5a6135b9ee37e0f6b19748c34_b.jpg" data-size="normal" data-rawwidth="326" data-rawheight="162" class="content_image lazy" width="326" data-actualsrc="https://pic1.zhimg.com/v2-c1e704f5a6135b9ee37e0f6b19748c34_b.jpg"><figcaption>某证券公司谛听部署示意图</figcaption></figure><p>通过在多个交易互联区和网点办公区部署谛听监测节点，实现对用户全网的安全威胁感知，在不改变用户原有网络架构基础上，实现了对攻击威胁的实时预警。</p><h2><b>建设成效</b></h2><p>该用户利用谛听捕获到多次内外部人员违规扫描行为，并在该单位定期组织的红蓝对抗中成功迷惑攻击方，为安全人员提供了实时的防护预警和安全情报。</p><h2><b>某高校信息中心</b></h2><h2><b>用户需求</b></h2><p>某高校已建设较为完善的安全防护体系，并建设了集中的安全日志分析平台。该高校为理工类高校，时常有学生在校园网中嗅探、扫描信息资产，发生过若干起恶作剧攻击事件。该高校信息中心计划通过部署谛听系统，识别校园网内的攻击事件，并记录攻击源IP和MAC地址，找出相关人员并进行教育处理。</p><h2><b>解决方案</b></h2><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-0e7e486c934f9cc609918a24d5ebafb0_b.jpg" data-size="normal" data-rawwidth="264" data-rawheight="181" class="content_image" width="264"></noscript><img src="https://pic1.zhimg.com/v2-0e7e486c934f9cc609918a24d5ebafb0_b.jpg" data-size="normal" data-rawwidth="264" data-rawheight="181" class="content_image lazy" width="264" data-actualsrc="https://pic1.zhimg.com/v2-0e7e486c934f9cc609918a24d5ebafb0_b.jpg"><figcaption>某高校谛听部署示意图</figcaption></figure><p>通过将监测节点部署至学校信息中心机房、实验室和图书馆等位置，监听校园网内的嗅探扫描行为，记录攻击方IP信息，结合校方内部IP地址表、学生信息、教务系统日志等，综合分析溯源，达到追踪攻击者，减少攻击事件的目标。 </p><p>………………………………………………………………………………………………………………</p><p>“谛听”，名起中国古典文学，地藏菩萨经案下伏着的通灵神兽，可以通过听来辨认世间万物，尤其善于听人的心，《西游记》中曾描述了谛听辨别真假美猴王的故事。</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-c6da7f578d33e2967b865eeae5acd959_b.jpg" data-caption="" data-size="normal" data-rawwidth="434" data-rawheight="379" class="origin_image zh-lightbox-thumb" width="434" data-original="https://pic2.zhimg.com/v2-c6da7f578d33e2967b865eeae5acd959_r.jpg"></noscript><img src="https://pic2.zhimg.com/v2-c6da7f578d33e2967b865eeae5acd959_b.jpg" data-caption="" data-size="normal" data-rawwidth="434" data-rawheight="379" class="origin_image zh-lightbox-thumb lazy" width="434" data-original="https://pic2.zhimg.com/v2-c6da7f578d33e2967b865eeae5acd959_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-c6da7f578d33e2967b865eeae5acd959_b.jpg"></figure><p>大胆推测，套用一句互联网大佬的句式，2018年并不是“伪装者”产品在过去十年最差的一年，但也许是在未来十年更好的第一年。</p><p>…………………………………………………………………………………………………………………………</p><p>2019年的RSAC下周即将到来，相信现场能看到更多的基于欺骗伪装技术的产品，长亭科技也将如约亮相，带来更多创新产品和技术思考，Welcome on board!</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-4c80fdf08d27fb208fa8e7a4496a5c8c_b.jpg" data-caption="" data-size="normal" data-rawwidth="411" data-rawheight="205" class="content_image" width="411"></noscript><img src="https://pic1.zhimg.com/v2-4c80fdf08d27fb208fa8e7a4496a5c8c_b.jpg" data-caption="" data-size="normal" data-rawwidth="411" data-rawheight="205" class="content_image lazy" width="411" data-actualsrc="https://pic1.zhimg.com/v2-4c80fdf08d27fb208fa8e7a4496a5c8c_b.jpg"></figure><p> 点击<a href="http://link.zhihu.com/?target=https%3A//www.chaitin.cn/zh/dsensor" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">https://www.</span><span class="visible">chaitin.cn/zh/dsensor</span><span class="invisible"></span></a></p><p><br>申请试用谛听（D-Sensor）内网威胁感知系统 </p>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
