<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>中国剩余定理（CRT ）</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/44591114">原文</a></p>
<div class="title-image"><img src="https://pic4.zhimg.com/v2-749a14807cb3f0a0400742d9807367d5_r.jpg" alt=""></div><p>题图如有侵权请告知，将道歉并删除。</p><p>这次我决定简单粗暴地引入主题，因为要介绍的是我认为非常重要的、我非常喜欢的——<b>中国剩余定理(Chinese remainder theorem, CRT) </b>！</p><hr><p>《孙子算经》是中国古代重要的数学著作，共三卷，成书约在四、五世纪，作者生平和具体编写年不详。</p><p>其卷下的第26题为：</p><blockquote>今有物不知其数，三三数之剩二，五五数之剩三，七七数之剩二，问物几何？<br>答曰：‘二十三’。<br>术曰：三三数之剩二，置一百四十；五五数之剩三，置六十三，七七数之剩二，置三十，并之。得二百三十三，以二百一十减之，即得。凡三三数之剩一，则置七十；五五数之剩一，则置二十一；七七数之剩一，则置十五；一百六以上以一百五减之即得。</blockquote><img src="https://pic3.zhimg.com/v2-3b96142704ee1adae2f5b7de4a2105d8_r.jpg" data-caption="" data-size="small" data-rawwidth="1653" data-rawheight="2191" data-watermark="watermark" data-original-src="v2-3b96142704ee1adae2f5b7de4a2105d8" data-watermark-src="v2-77ea0e0aa8a6542442a5296ac7a66255" data-private-watermark-src=""><p>（即——</p><blockquote>一个整数除以3余2、除以5余3、除以7余2，求这个整数。<br>答案：23<br>解法：由于除以3余2，因此加上一个140；由于除以5余3，因此加上一个63；由于除以7余2，因此加上一个30；这三个数的和是140+63+30=233，再减去210，就得到了23了。<br>这么说吧，只要是除以3余了一个1，就加上一个70；只要是除以5余了一个1，就加上一个21；只要是除以7余了一个1，就加上一个15。然后累加。超过了106就减去105就行了。</blockquote><p>）</p><p>该问题称之为“<b>物不知数</b>”问题。</p><hr><p>在中国民间还有所谓“<b>韩信点兵</b>”等类似问题：</p><p>（先插播一下所谓“<b>韩信将兵多多益善</b>”）</p><blockquote>上尝从容与信言诸将能不，各有差。上问曰：“如我，能将几何？”信曰：“陛下不过能将十万。”上曰：“如公何如？”曰：“如臣，多多益善耳。”上笑曰：“多多益善，何为为我禽？” 信曰：“陛下不能将兵，而善将将，此乃信之所以为陛下禽也。”<br>——《汉史·韩彭英卢吴传第四》</blockquote><p>“<b>韩信点兵</b>”问题的描述（之一）是：韩信让士兵排队，站3人一排，多出2人；站5人一排，多出4人；站7人一排，多出6人。于是他没有数就说出了士兵的数目。</p><hr><p>南宋，秦九韶在《数书九章》中明确地系统地叙述了求解一次同余组的一般计算步骤。在卷一“大衍总术”中详载了计算乘率的方法——“大衍求一术”。</p><img src="https://pic4.zhimg.com/v2-a7e402f164f0f4c435bd3887e6f17831_r.jpg" data-caption="" data-size="normal" data-rawwidth="375" data-rawheight="539" data-watermark="watermark" data-original-src="v2-a7e402f164f0f4c435bd3887e6f17831" data-watermark-src="v2-3f5387ced226137ae01567f6001ff875" data-private-watermark-src=""><p>然而我看不懂= =</p><p>（<a href="http://yuedu.163.com/book_reader/42fe434f7bd048a284378b05a54757c9_4/b1c568b0109c443f863e6243347a0217_5">数学九章-【宋】秦九韶-免费电子书-在线阅读-网易云阅读</a>）</p><hr><p>明代，程大位在他的著作《直指算法统宗》（简称《算法统宗》）卷五中，提出了“孙子歌”——“<b>三人同行七十稀，五树梅花廿一枝， 七子团圆正半月，除百令五便得知</b>。”。</p><img src="https://pic1.zhimg.com/v2-cfb3228dd7b058c16631f54e848102ea_r.jpg" data-caption="" data-size="normal" data-rawwidth="320" data-rawheight="458" data-watermark="watermark" data-original-src="v2-cfb3228dd7b058c16631f54e848102ea" data-watermark-src="v2-9ee7334e4e3f59da212566f68c9f9b31" data-private-watermark-src=""><p>实际上说的就是前文的：只要是除以3余了一个1，就加上一个70；只要是除以5余了一个1，就加上一个21；只要是除以7余了一个1，就加上一个15。然后累加。</p><p>再加上一句：计算这个总和除以105的余数。</p><hr><p>而我只会用现代的数学语言来解释：</p><p>先考虑问题的分解：</p><p><b>问题1：</b>计算一个整数 <equation>x</equation> ，使得它满足除以3余2、除以5余3、除以7余2。</p><p>如果能够找到三个整数 <equation>x_1,x_2,x_3</equation> ，使得：</p><p><equation>x_1</equation> 除以3余2、除以5余0、除以7余0；</p><p><equation>x_2</equation> 除以3余0、除以5余3、除以7余0；</p><p><equation>x_3</equation> 除以3余0、除以5余0、除以7余2；</p><p>那么令 <equation>x= x_1+x_2+x_3</equation> ，就很容易验证这时的 <equation>x</equation> 就满足除以3余2、除以5余3、除以7余2。</p><p>分别称找到整数 <equation>x_1,x_2,x_3</equation> 的问题为<b>问题1-1</b>、<b>问题1-2</b>、<b>问题1-3</b>。可以看出这三个问题本质上是类似的。</p><p>下面对<b>问题1-1</b>继续分解，如果能够找到一个整数 <equation>y_1</equation> 满足 <equation>y_1</equation> 除以3余1、除以5余0、除以7余0，那么令 <equation>x_1= 2\times y_1</equation> ，就很容易验证这时的 <equation>x_1</equation> 就满足除以3余2、除以5余0、除以7余0。</p><p>因此定义</p><p><b>问题1-1-1</b>为：寻找整数 <equation>y_1</equation> 满足 <equation>y_1</equation> 除以3余1、除以5余0、除以7余0；</p><p><b>问题1-2-1</b>为：寻找整数 <equation>y_2</equation> 满足 <equation>y_2</equation> 除以3余0、除以5余1、除以7余0；</p><p><b>问题1-3-1</b>为：寻找整数 <equation>y_3</equation> 满足 <equation>y_3</equation> 除以3余0、除以5余0、除以7余1。</p><p>这三个问题本质上是相同的。</p><p>如果找到了 <equation>y_1,y_2,y_3</equation> ，那么就可以取 <equation>x=2\times y_1+3\times y_2+2\times y_3</equation> 。</p><hr><p>下面就以<b>问题1-1-1</b>为例：寻找整数 <equation>z</equation> 使得 <equation>z</equation> 除以3余1、除以5余0、除以7余0。</p><p>于是 <equation>z</equation> 一定是 <equation>5\times7=35</equation> 的倍数，假设 <equation>z=35k</equation> 。</p><p>那么就有 <equation>35k\equiv 1\pmod 3</equation> ，而这时的 <equation>k</equation> 就是 <equation>5\times7</equation> 模3的逆（参看“<a href="https://zhuanlan.zhihu.com/p/44523169">5÷2=6？——是的，模7意义下</a>”），将这个 <equation>k</equation> 记作 <equation>\left[ 35^{-1} \right]_{3}</equation> ，那么 <equation>z</equation> 就等于 <equation>5\times7\times\left[ \left( 5\times7 \right)^{-1} \right]_{3}</equation> ，恰好就是 <equation>5\times7\times2=70</equation> ，对应“凡三三数之剩一，则置七十”一句及“三人同行七十稀”一句。</p><p>于是类推得到，</p><p><b>问题1-1-2</b>的解答是 <equation>3\times7\times\left[ \left( 3\times7 \right)^{-1} \right]_{5}</equation> ，恰好就是 <equation>3\times7\times1=21</equation> ，对应“五五数之剩一，则置二十一”一句及“五树梅花廿一枝”一句；</p><p><b>问题1-1-3</b>的解答是 <equation>3\times5\times\left[ \left( 3\times5 \right)^{-1} \right]_{7}</equation> ，恰好就是 <equation>3\times5\times1=15</equation> ，对应“七七数之剩一，则置十五”一句及“七子团圆月正半”一句。</p><p>所以将分解的问题复原，可得：</p><p><equation>x=2\times\left( 5\times7\times\left[ \left( 5\times7 \right)^{-1} \right]_{3} \right)+3\times \left(3\times7\times\left[ \left( 3\times7 \right)^{-1} \right]_{5} \right)+2\times \left( 3\times5\times\left[ \left( 3\times5 \right)^{-1} \right]_{7} \right)</equation> 。</p><p>最后 ，注意到，如果 <equation>x</equation> 满足除以3余2、除以5余3、除以7余2，那么 <equation>x+3\times5\times7</equation> 也同样满足。</p><p>因此要计算满足要求的最小的非负整数，就只需要计算总和除以105的余数即可。——对应“除百零五便得知”一句。</p><hr><p>下面要讨论的是：如果有多个满足要求的整数，那么<b>它们之间有什么关系</b>呢？</p><p>假设 <equation>X,Y</equation> 都满足“除以3余a、除以5余b、除以7余c”。</p><p>观察 <equation>X-Y</equation> 会发现， <equation>X-Y</equation> 满足“除以3余0、除以5余0、除以7余0”。因此 <equation>X-Y</equation> 一定是 <equation>3\times5\times7=105</equation> 的倍数。</p><p>这也就是说，在“模105同余”的意义下，之前通过分解问题、组合解答的方法所得到的 <equation>x</equation> 恰恰就是<b>唯一解</b>。</p><hr><p>下面把这个问题一般化：假设整数 <equation>m_1,m_2, ... ,m_n</equation> 两两互素，则对于任意的整数 <equation>a_1,a_2, ... ,a_n</equation> ，方程组</p><p><equation>      \begin{equation}     \begin{cases}     x\equiv a_1\pmod {m_1}\\     x\equiv a_2\pmod {m_2}\\     \cdots \\     x\equiv a_n\pmod {m_n}\\     \end{cases}     \end{equation}</equation> </p><p>都存在整数解，且若<equation>X,Y</equation> 都满足该方程组，则必有 <equation>X\equiv Y\pmod N</equation> ，其中 <equation>N=\prod_{i=1}^{n}m_i</equation> 。</p><p>具体而言， <equation>x\equiv\sum_{i=1}^{n}{a_i\times\frac{N}{m_i}\times\left[ \left( \frac{N}{m_i} \right)^{-1} \right]_{m_i}}\pmod N</equation> 。</p><p>——这就是我非常看重和喜欢的<b>中国剩余定理(Chinese remainder theorem, CRT)</b>。</p><hr><p>最后，中国剩余定理有<b>很多重要</b>的应用！我将在后续文章里慢慢介绍。</p>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
