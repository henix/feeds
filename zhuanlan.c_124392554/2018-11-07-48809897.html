<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>多项式也有CRT么？</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/48809897">原文</a></p>
<div class="title-image"><img src="https://pic4.zhimg.com/v2-5b430a11c39f0863501bf404dfd797fb_r.jpg" alt=""></div><p>在“<a href="https://zhuanlan.zhihu.com/p/44591114">中国剩余定理（CRT ）</a>”中有人问及，我就简单写一下。</p><hr><p>首先，我不想在这篇文章中着急引入“环”和“域”的概念；也不想严格定义“多项式”——我希望这只是做为一篇<b>入门的科普文章</b>。</p><p>其次，我们假定讨论的一元多项式的<b>系数都是有理数</b>。</p><blockquote>事实上，只要多项式的系数取自的集合可以做“加减乘除（不能除以0）”就可以了。<br>更严谨的说法是，系数取自一个域（field）。</blockquote><p>例如： <equation>f(x)=2 + 3 x + 3 x^2 + x^3</equation> 、 <equation>g(x)=2 + 3 x - x^2 + x^3 + x^4</equation> 都是有理数系数的多项式。</p><hr><p>下面要做一个（<b>不严谨但是方便</b>的）技术处理，就是若存在非零有理数 <equation>k</equation> 使得 <equation>k\times f_1(x)=f_2(x)</equation> ，那么就认为多项式 <equation>f_1(x)</equation> 和 <equation>f_2(x)</equation> 是不涉及同余式时是“<b>相同的</b>”。</p><p>例如 <equation>x^2+\frac{1}{3}x+\frac{5}{6}</equation> 、 <equation>3x^2+x+\frac{5}{2}</equation> 、 <equation>6x^2+2x+5</equation> 都认为是“相同的”多项式。</p><hr><p>在整数的世界里有“带余除法”，例如： <equation>15\div2=7\dots1</equation> 、 <equation>15\div3=5\dots0</equation> 、 <equation>15\div(-4)=(-3)\dots3</equation> 、 <equation>(-15)\div2=(-8)\dots1</equation> 等等，这里的“余数”都是大于或等于0、小于除数的绝对值的。</p><p>类似地，有理数系数的多项式之间也可以做<b>带余除法</b>，例如：</p><p>➊ <equation>(2 + 3 x - x^2 + x^3 + x^4) \div (2 + 3 x + 3 x^2 + x^3)=(-2+x)\dots(6+7x+2x^2)</equation> ，换言之 <equation>(2 + 3 x - x^2 + x^3 + x^4)=(2 + 3 x + 3 x^2 + x^3)\times(-2+x)+(6+7x+2x^2)</equation> ；</p><p>➋ <equation>(2 + 3 x + 3 x^2 + x^3) \div (6+7x+2x^2)=(-\frac{1}{4}+\frac{1}{2}x)\dots(\frac{7}{2}+\frac{7}{4}x) </equation> ，也即 <equation>(2 + 3 x + 3 x^2 + x^3) = (6+7x+2x^2)\times(-\frac{1}{4}+\frac{1}{2}x)+(\frac{7}{2}+\frac{7}{4}x)</equation> ；</p><p>➌ <equation>(6+7x+2x^2) \div (2+x)=(3+2x)\dots0</equation>，表明 <equation>(6+7x+2x^2) = (2+x)\times(3+2x)</equation> 。</p><p>可以表示为： <equation>f(x)=q(x)\times g(x)+r(x)</equation> 。</p><p>这里的“<b>余</b>” 不是一个数了，而是一个多项式 <equation>r(x)</equation> ，余多项式 <equation>r(x)</equation> 的要求是：或者为零、或者次数低于除多项式 <equation>g(x)</equation> 。</p><hr><p>在此基础上，有理数系数的多项式之间也可以定义“整除”、“因式”、“倍式”、“模”和“同余”。</p><p>例如由 <equation>(6+7x+2x^2) = (2+x)\times(3+2x)</equation> ，我们</p><ul><li>称 <equation>(6+7x+2x^2) </equation> 可以被 <equation> (2+x)</equation> 整除、或称 <equation> (2+x)</equation> 可以整除 <equation>(6+7x+2x^2) </equation> ，记作 <equation> (2+x)|(6+7x+2x^2) </equation> ；</li><li>称 <equation>(6+7x+2x^2) </equation> 是 <equation> (2+x)</equation> 的倍式；</li><li>称 <equation> (2+x)</equation> 是 <equation>(6+7x+2x^2) </equation> 的因式；</li><li>称 <equation>(6+7x+2x^2) </equation> 模 <equation> (2+x)</equation> 与0同余，记作 <equation>(6+7x+2x^2) \equiv 0\pmod {2+x}</equation>。</li></ul><p>而由于 <equation>(2 + 3 x - x^2 + x^3 + x^4) \div (2 + 3 x + 3 x^2 + x^3)=(-2+x)\dots(6+7x+2x^2)</equation> ，可知 <equation>(2 + 3 x - x^2 + x^3 + x^4) </equation> 不能被 <equation> (2 + 3 x + 3 x^2 + x^3)</equation> 整除、 <equation>(2 + 3 x - x^2 + x^3 + x^4) </equation> 与 <equation>(6+7x+2x^2)</equation> 模 <equation> (2 + 3 x + 3 x^2 + x^3)</equation> 同余，记作 <equation>(2 + 3 x - x^2 + x^3 + x^4) \equiv(6+7x+2x^2)\pmod{2 + 3 x + 3 x^2 + x^3}</equation> 。</p><hr><p>于是呢，类似于“素数”，我们也可以定义“<b>不可约多项式</b>”——在“相同”的意义下，如果多项式的因子只有自身和1，就称之为是一个<b>不可约多项式</b>。</p><p>例如，在有理数系数的多项式内， <equation>1+x+x^2</equation> 就是一个不可约多项式，而 <equation>1+2x+x^2=(1+x)(1+x)</equation> 则不是。</p><p>注意：多项式是否“可约”是<b>跟系数的取决范围相关</b>的！</p><p>例如同样是多项式 <equation>1+x+x^2</equation> ，在有理数系数的多项式范围内是不可约的；但是在实数系数的多项式世界里面是可约的， <equation>(1+x+x^2)=\left( x-\frac{-1+\sqrt{-3}}{2} \right)\left( x -\frac{-1-\sqrt{-3}}{2}\right)</equation> 。</p><hr><p>接下来，就可以定义两个有理数系数 <equation>f(x),g(x)</equation> 的多项式的“<b>最大公因式</b>” <equation>GCD(f(x),g(x))</equation> 了——所有公因式中次数最高者。</p><p>仍然可以采用“欧几里得算法（辗转相除法）”来计算，例如：</p><img src="https://pic2.zhimg.com/v2-49f1725bb5bde6972e7430759d6f91a4_r.jpg" data-caption="" data-size="normal" data-rawwidth="1624" data-rawheight="940" data-watermark="watermark" data-original-src="v2-49f1725bb5bde6972e7430759d6f91a4" data-watermark-src="v2-2e759d76ad296329b88a0d0fd751a743" data-private-watermark-src=""><p><equation>(2 + 3 x - x^2 + x^3 + x^4)</equation> 和 <equation>(2 + 3 x + 3 x^2 + x^3)</equation> 最大公因式是 <equation>(2+x)</equation> 。</p><p>由此也可以定义有理数系数的多项式之间的“<b>互素</b>”。</p><hr><p>那么，也就有有理数系数的多项式的<b>裴蜀（Bezout）等式</b>或<b>贝祖等式</b>（参看“<a href="https://zhuanlan.zhihu.com/p/32504576">凑邮资问题</a>”）：</p><p>对于不全为0的有理数系数的多项式 <equation>f(x), g(x)</equation> 和 <equation>d(x)</equation> ，方程 <equation>s(x)f(x)+t(x)g(x)=d(x)</equation> 存在有理数系数的多项式解 <equation>s(x)</equation> 和 <equation>t(x)</equation> <b>当且仅当</b><equation>GCD(f(x), g(x))|d(x)</equation> 。</p><p>例如：</p><p><equation>\left( 6 - 5x + 2x^2 \right)\left( 2 + 3 x + 3 x^2 + x^3 \right)+(1-2x)\left( 2 + 3 x - x^2 + x^3 + x^4 \right)=7(2+x)</equation> 。</p><hr><p>下面就该讨论“模的逆”了：存在有理数系数的多项式 <equation>F(x)</equation> 使得 <equation>F(x)f(x)\equiv 1\pmod{g(x)}</equation> 当且仅当 <equation>F(x)</equation> 与 <equation>g(x)</equation> 互素。此时称 <equation>F(x)</equation> 是 <equation>f(x)</equation> 模 <equation>g(x)</equation> 的逆多项式，记作 <equation>F(x)=\left[ \left( f(x) \right)^{-1} \right]_{g(x)}</equation> 。</p><p>例如 <equation>f(x)=(1+x+x^2)</equation> 与 <equation>g(x)=(1+x-x^2+x^3)</equation> 互素，于是存在多项式  <equation>F(x)=(6-5x+x^2 )</equation> ，使得 <equation>(1 + x + x^2)(6 - 5 x + 2 x^2) + (1 - 2 x)(1 + x - x^2 + x^3)=7</equation> ，即得 <equation>(1 + x + x^2)(6 - 5 x + 2 x^2) \equiv1\pmod{(1+x-x^2+x^3)}</equation> 。称 <equation>F(x)/7=\frac{1}{7}(6-5x+x^2 )</equation> 是 <equation>f(x)=(1+x+x^2)</equation> 模 <equation>g(x)=(1+x-x^2+x^3)</equation> 的逆多项式。</p><hr><p>剩下的事情就和“<a href="https://zhuanlan.zhihu.com/p/44591114">中国剩余定理（CRT ）</a>”中所讲的基本相同了：</p><p>假设有理数系数的多项式 <equation>m_1(x),m_2(x), ... ,m_n(x)</equation> 两两互素，则对于任意的有理数系数的多项式 <equation>a_1(x),a_2(x), ... ,a_n(x)</equation> ，方程组</p><p><equation>      \begin{equation}     \begin{cases}     f(x)\equiv a_1(x)\pmod {m_1(x)}\\     f(x)\equiv a_2(x)\pmod {m_2(x)}\\     \cdots \\     f(x)\equiv a_n(x)\pmod {m_n(x)}\\     \end{cases}     \end{equation}</equation> </p><p>都存在有理数系数的多项式解，且若<equation>A(x),B(x)</equation> 都满足该方程组，则必有 <equation>A(x)\equiv B(x)\pmod {N(x)}</equation> ，其中 <equation>N(x)=\prod_{i=1}^{n}{m_i(x)}</equation> 。</p><p>具体而言， <equation>f(x)\equiv\sum_{i=1}^{n}{a_i(x)\times\frac{N(x)}{m_i(x)}\times\left[ \left( \frac{N(x)}{m_i(x)} \right)^{-1} \right]_{m_i(x)}}\pmod {N(x)}</equation> 。</p><p>——这就是<b>中国剩余定理(Chinese remainder theorem, CRT)</b>的有理数系数的多项式版本。</p><p>例如：</p><p><equation>\begin{equation}      \begin{cases}      f(x)\equiv 1-x\pmod {1+x+x^2}\\      f(x)\equiv 2\pmod {1+x^2}\\     \end{cases}      \end{equation}</equation> ，</p><p>可得 <equation>\left[ \left( 1+x^2 \right)^{-1} \right]_{1+x+x^2}=(1+x)</equation> 及 <equation>\left[ \left( 1+x+x^2 \right)^{-1} \right]_{1+x^2}=(-x)</equation> ，</p><p>于是 <equation>f(x)\equiv (1-x)(1+x^2)(1+x)+2(1+x+x^2)(-x)\equiv 1 - 2 x - 2 x^2 - 2 x^3 - x^4 \pmod {(1+x^2)(1+x+x^2)}  </equation> 。</p><p></p>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
