<h2><b>研究范围：</b></h2><p class="ztext-empty-paragraph"><br/></p><p>研究试图基于弱密钥的使用来定位以太坊地址，并研究这些地址的使用情况。虽然不太可能在正常的环境下使用适当的代码生成弱密钥，但仍然假设可能由编码错误或操作系统、设备和执行环境错误生成弱私钥，并且这些问题很常见。除了密钥截断，其他一些可能削弱256位密钥的常见错误包括:</p><p class="ztext-empty-paragraph"><br/></p><ul><li><b>代码逻辑错误</b></li><li><b>类型混淆</b></li><li><b>熵的错误</b></li><li><b>随机策略错误</b></li><li><b>处理异常</b></li><li><b>内存引用错误</b></li><li><b>内存泄露</b></li><li><b>种子重用</b></li><li><b>对恶意软件的妥协</b></li></ul><p class="ztext-empty-paragraph"><br/></p><p class="ztext-empty-paragraph"><br/></p><p>由于计算资源有限，即使在更小的64位密钥空间中枚举所有密钥也是不可行的。</p><p class="ztext-empty-paragraph"><br/></p><p>因此，转而关注可实现的目标:枚举将出现在256位私钥的更小的32位子集中的密钥。这相当于4,294,967,295个私钥，需要为其计算相应的公开的以太坊地址并查询区块链。</p><p class="ztext-empty-paragraph"><br/></p><h2><br/></h2><p><b>方法：</b></p><p class="ztext-empty-paragraph"><br/></p><p>要对可能的以太坊地址执行批量扫描，查询Etherscan之类的在线服务是不切实际的，甚至会滥用资源。</p><p class="ztext-empty-paragraph"><br/></p><p>取而代之，在内存中生成一个所有公开的以太坊地址的的哈希映射，并在这个内存中查询每个枚举密钥的数据结构。</p><p class="ztext-empty-paragraph"><br/></p><p>在一个中档笔记本上，其性能约为每个CPU每核每秒约生成15,000个密钥及其查询，瓶颈是ECDSA私钥到公钥的生成。</p><p class="ztext-empty-paragraph"><br/></p><p>将重点放在256位密钥空间中的8个32位“子区域”上，在这些子区域中，可能会观察到正在使用的以太坊地址是由弱私钥导出的。</p><p class="ztext-empty-paragraph"><br/></p><p>预期密文空间的下32位部分最有可能包含弱密钥。为了考虑到字节顺序，还扫描了较高的32位部分，为了彻底起见，使用一个可能产生密钥的32位窗口测试了256位密钥空间的每个不同部分。</p><p class="ztext-empty-paragraph"><br/></p><p>为了说明扫描的区域，下面的图4描述了为枚举标识的每个区域。在枚举每个区域(A到H)的32位密钥空间时，将256位密钥的其余224位设置为0x00。</p><p class="ztext-empty-paragraph"><br/></p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-c11d20a86b92eda03490023f84c4a627_b.jpg" data-caption="" data-size="normal" data-rawwidth="589" data-rawheight="75" class="origin_image zh-lightbox-thumb" width="589" data-original="https://pic4.zhimg.com/v2-c11d20a86b92eda03490023f84c4a627_r.jpg"/></noscript><img src="https://pic4.zhimg.com/v2-c11d20a86b92eda03490023f84c4a627_b.jpg" data-caption="" data-size="normal" data-rawwidth="589" data-rawheight="75" class="origin_image zh-lightbox-thumb lazy" width="589" data-original="https://pic4.zhimg.com/v2-c11d20a86b92eda03490023f84c4a627_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-c11d20a86b92eda03490023f84c4a627_b.jpg"/></figure><p class="ztext-empty-paragraph"><br/></p><p>图4：256位密钥空间由H到A部分表示。</p><p class="ztext-empty-paragraph"><br/></p><p>这给了8个可能的区域，每个区域的组合数为2的32次方减一 (大约 43亿)。将区域定义转换为明确的私钥范围，扫描并测试了以太坊区块链上交易活动的这些密钥范围：</p><p class="ztext-empty-paragraph"><br/></p><p>组A：</p><p>0000000000000000000000000000000000000000000000000000000000000001 到</p><p>00000000000000000000000000000000000000000000000000000000FFFFFFFF</p><p class="ztext-empty-paragraph"><br/></p><p>组B：</p><p>0000000000000000000000000000000000000000000000000000000100000000 到</p><p>000000000000000000000000000000000000000000000000FFFFFFFF00000000</p><p class="ztext-empty-paragraph"><br/></p><p>组 C：</p><p>0000000000000000000000000000000000000000000000010000000000000000 到0000000000000000000000000000000000000000FFFFFFFF0000000000000000</p><p class="ztext-empty-paragraph"><br/></p><p>组 D：</p><p>0000000000000000000000000000000000000001000000000000000000000000 到</p><p>00000000000000000000000000000000FFFFFFFF000000000000000000000000</p><p class="ztext-empty-paragraph"><br/></p><p>组 E：</p><p>0000000000000000000000000000000100000000000000000000000000000000 到000000000000000000000000FFFFFFFF00000000000000000000000000000000</p><p class="ztext-empty-paragraph"><br/></p><p>组 F：</p><p>0000000000000000000000010000000000000000000000000000000000000000 到0000000000000000FFFFFFFF0000000000000000000000000000000000000000</p><p class="ztext-empty-paragraph"><br/></p><p>组 G：</p><p>0000000000000001000000000000000000000000000000000000000000000000到00000000FFFFFFFF000000000000000000000000000000000000000000000000</p><p class="ztext-empty-paragraph"><br/></p><p>组 H：</p><p>0000000100000000000000000000000000000000000000000000000000000000 到FFFFFFFF00000000000000000000000000000000000000000000000000000000</p><p class="ztext-empty-paragraph"><br/></p><p>上面的密文空间范围虽然构成256位密文空间的无穷小部分，但由于错误或其他因素影响了256位密文的随机性，因此私钥可能存在于这些区域。</p><p class="ztext-empty-paragraph"><br/></p><a href="https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzU3MTYzMjMzNA%3D%3D%26mid%3D2247484991%26idx%3D1%26sn%3D8066593f3c387111f65049e25b90fe6f%26chksm%3Dfcdc799ecbabf0886853f0a7ed6917ea1b50ca67239c98272ac4639865ed5b0598ad484e803b%26token%3D570261722%26lang%3Dzh_CN%23rd" data-draft-node="block" data-draft-type="link-card" data-image="https://pic3.zhimg.com/v2-2d9ceed78978badf52f685b50ced44c6_ipico.jpg" data-image-width="358" data-image-height="358" class=" wrap external" target="_blank" rel="nofollow noreferrer">如何窃取以太坊钱包的密钥-2</a><p class="ztext-empty-paragraph"><br/></p><p>==========================================================================</p><p><b>文章首发在微信公众号：btc201800</b><br/><b>知识星球ID：28018093</b></p><p><br/><b>音频发布在喜马拉雅上“区块链杂谈 (第2季)”</b> <b><u><a href="https://link.zhihu.com/?target=http%3A//xima.tv/Bjq4se" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">http://</span><span class="visible">xima.tv/Bjq4se</span><span class="invisible"></span></a></u></b></p><p><b>解读区块链白皮书</b> <u><a href="https://link.zhihu.com/?target=http%3A//xima.tv/RNU1Q8" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">http://</span><span class="visible">xima.tv/RNU1Q8</span><span class="invisible"></span></a></u></p><p><br/><b>宁波格密链网络科技有限公司，专注于区块链上的密码技术研发。</b></p>