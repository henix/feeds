<div class="title-image"><img src="https://pic1.zhimg.com/v2-3c28650fab8d9ef163e85c6f249416f7_b.jpg" alt=""></div><p><b>更新20180814，</b>建议零基础新手直接看这个最新的</p><p><a href="https://link.zhihu.com/?target=https%3A//s.growingio.com/nKd20M" class=" wrap external" target="_blank" rel="nofollow noreferrer">量化交易零基础入门教程</a></p><h2><b>特点</b></h2><ul><li><b>从零开始教编程。</b> 靠谱的量化交易学习资源稀少，且具有不讲编程、代码较难、过多等不适合新手等问题，本教程中则会从零开始教编程，解决量化入门过难过编程门槛这一问题。</li><li><b>量化与编程相结合。</b>本教程不仅会教编程，而且会尽量结合量化情景，减少“我要做量化交易为什么要看这些用来培训程序员的东西”的愤懑。</li><li><b>简易精炼，快速入门。</b>尽量只讲最核心最常用的知识，助你快速摆脱想学习量化却处处陌生不知所措的茫然的新手阶段。</li></ul><p>------</p><p>【更新】新手入门系列文章：特点是通过一个个简单的策略为例，手把手教你实践，并在过程中介绍基础的编程与量化知识，在知乎上累计获赞3500+（本文章加上一个同内容的2500+回答）。强烈推荐。</p><p><a href="https://link.zhihu.com/?target=https%3A//www.joinquant.com/post/3616" class=" wrap external" target="_blank" rel="nofollow noreferrer">【新手入门教程】十行代码带你量化交易入门 - JoinQuant-TWist</a></p><p><a href="https://link.zhihu.com/?target=https%3A//www.joinquant.com/post/5388" class=" wrap external" target="_blank" rel="nofollow noreferrer">【新手入门教程】多股票策略 - JoinQuant-TWist</a></p><p><a href="https://link.zhihu.com/?target=https%3A//www.joinquant.com/post/6596" class=" wrap external" target="_blank" rel="nofollow noreferrer">【新手入门教程】简单市值轮动策略 - JoinQuant-TWist</a></p><p><a href="https://link.zhihu.com/?target=https%3A//www.joinquant.com/post/9578" class=" wrap external" target="_blank" rel="nofollow noreferrer">【新手入门教程】市值轮动策略2.0 - JoinQuant-TWist</a></p><p><a href="https://link.zhihu.com/?target=https%3A//www.joinquant.com/post/9612" class=" wrap external" target="_blank" rel="nofollow noreferrer">【新手入门教程】市值轮动策略3.0 - JoinQuant-TWist</a></p><p>-------------------</p><p>说起量化交易入门，很多时候得到的答案都是长长的书单，让人望而却步。</p><p>这里，就为新手准备了这篇文章--十行代码带你量化交易入门</p><p>数据获取，策略回测，行情链接，交易信号，直接体验整个量化交易的<b>核心流程</b>，立刻学会并跟着做起来！</p><p>这里，就为新手准备了这篇文章--<b>十行代码带你量化交易入门</b> </p><blockquote>学习内容：</blockquote><ul><li>学会写一个简单的量化交易策略</li><li>理解策略的基本框架</li><li>学会建立连接实盘的模拟交易，并使其自动发送交易的信号到微信</li></ul><p class="ztext-empty-paragraph"><br/></p><p>首先，进入<a href="https://link.zhihu.com/?target=https%3A//www.joinquant.com/%3Ff%3Dzhzl%26m%3D23367387" class=" wrap external" target="_blank" rel="nofollow noreferrer">JoinQuant</a>，点击导航栏我的策略，新建策略，进入策略编辑画面，如图。 <br/>左侧是编写策略代码，右侧是策略运行结果。我们就在左侧写策略代码。</p><p class="ztext-empty-paragraph"><br/></p><p class="ztext-empty-paragraph"><br/></p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-438ea6a395bc682784e4062cae2d4028_b.jpg" data-caption="" data-size="normal" data-rawwidth="1301" data-rawheight="678" class="origin_image zh-lightbox-thumb" width="1301" data-original="https://pic1.zhimg.com/v2-438ea6a395bc682784e4062cae2d4028_r.jpg"/></noscript><img src="https://pic1.zhimg.com/v2-438ea6a395bc682784e4062cae2d4028_b.jpg" data-caption="" data-size="normal" data-rawwidth="1301" data-rawheight="678" class="origin_image zh-lightbox-thumb lazy" width="1301" data-original="https://pic1.zhimg.com/v2-438ea6a395bc682784e4062cae2d4028_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-438ea6a395bc682784e4062cae2d4028_b.jpg"/></figure><p>下面教你用10行代码写个量化交易策略——单股票均线策略</p><p class="ztext-empty-paragraph"><br/></p><h2>1 确定策略内容与框架</h2><p>若昨日收盘价高出过去20日平均价今天开盘买入股票 <br/>若昨日收盘价低于过去20日平均价今天开盘卖出股票</p><p>只操作一只股票，很简单对吧，但怎么用代码说给计算机听呢？</p><p>想想人是怎么操作的，应该包括这样两个部分</p><ol><li>既然是单股票策略，事先决定好交易哪一个股票。</li><li><b>每天</b>看看昨日收盘价是否高出过去20日平均价，是的话开盘就买入，不是开盘就卖出。<b>每天都这么做，循环下去</b>。</li></ol><p>对应代码也是这两个部分</p><div class="highlight"><pre><code class="language-text">def initialize(context):
    用来写最开始要做什么的地方
def handle_data(context,data):
    用来写每天循环要做什么的地方
</code></pre></div><blockquote>答疑与延伸：</blockquote><ul><li>def后面的空格和最后的冒号不能少！</li><li>符号都要用英文输入法！</li><li><b>为什么这么写？</b>就这么规定的，先别管了。</li><li>handle_data 按天循环时，如此处，其中的操作都是在9:30执行。</li><li><b>毫无编程基础？</b>，丝毫不懂变量，函数，if else的，还是先到<a href="https://link.zhihu.com/?target=https%3A//www.joinquant.com/study%3Ff%3Dzhzl%26m%3D23367387" class=" wrap external" target="_blank" rel="nofollow noreferrer">量化课堂</a>的编程部分学习下python语言吧。</li></ul><p><b>几乎所有策略都基于这个基本的策略框架：先初始化，然后循环操作</b><br/>1 <b>初始化</b>，即最开始要做的事情，如选定股票，设置变量、参数等等 <br/>2 <b>周期循环</b>：即每个周期要做的事情，如计算指标，买入卖出等，周期可能是分钟，天等，本文策略的周期是一天。当你要做一些盘中短线操作的时候，周期就要调成分钟，先别着急会遇到的。</p><h2>2 初始化</h2><p>我们要写设置要交易的股票的代码，比如 兔宝宝（002043）</p><div class="highlight"><pre><code class="language-text">def initialize(context):
    g.security = &#39;002043.XSHE&#39;# 存入兔宝宝的股票代码
</code></pre></div><blockquote>答疑与延伸：</blockquote><ul><li><b>“g.”是什么？</b>全局变量前都要写”g.”，全局变量就是全局都能用的变量，一般变量只能在该函数下使用。如security不加”g.”,只能在第一部分即initialize里用，不能在第二部分handle_data里用。不懂什么是变量的，到量化课堂的python编程里学习下基础内容，或者问问度娘。</li><li><b>“XSHE”是什么？</b> 股票代码使用时要加后缀，深交所股票代码后缀为 “.XSHE “，上交所股票代码后缀为 “.XSHG”。</li><li><b>代码中“#”是什么？</b>”#“后的内容都是注释，是为代码做说明的，不会被计算机当做代码处理。</li></ul><h2>3 获取收盘价与均价</h2><p>首先，获取昨日股票的收盘价</p><div class="highlight"><pre><code class="language-text"># 用法：变量 = data[股票代码].close
last_price = data[g.security].close# 取得最近日收盘价，命名为last_price
</code></pre></div><p>然后，获取近二十日股票收盘价的平均价</p><div class="highlight"><pre><code class="language-text"># 用法：变量 = data[股票代码].mavg(天数，‘close’)
# 获取近二十日股票收盘价的平均价，命名为average_price
average_price = data[g.security].mavg(20, &#39;close&#39;)
</code></pre></div><blockquote>答疑与延伸：</blockquote><ul><li><a href="https://link.zhihu.com/?target=https%3A//www.joinquant.com/api%23handle_data" class=" wrap external" target="_blank" rel="nofollow noreferrer">data是什么？</a></li><li><a href="https://link.zhihu.com/?target=https%3A//www.joinquant.com/api%23securityunitdata" class=" wrap external" target="_blank" rel="nofollow noreferrer">data[股票代码]后面除了平均价.mavg还能接什么?</a></li></ul><h2>4 判断是否买卖</h2><p>数据都获取完，该做买卖判断了</p><div class="highlight"><pre><code class="language-text"># 如果昨日收盘价高出二十日平均价, 则买入，否则卖出
if last_price &gt; average_price:
    买入
elif last_price &lt; average_price:
    卖出
</code></pre></div><p>问题来了，现在该写买卖下单了，但是拿多少钱去买我们还没有告诉计算机，所以每天还要获取账户里现金量。</p><div class="highlight"><pre><code class="language-text"># 用法：变量 = context.portfolio.cash
cash = context.portfolio.cash# 取得当前的现金量，命名为cash
</code></pre></div><blockquote>答疑与延伸：</blockquote><ul><li><a href="https://link.zhihu.com/?target=https%3A//www.joinquant.com/api%23context" class=" wrap external" target="_blank" rel="nofollow noreferrer">context.portfolio 是什么？</a></li></ul><p>这句看着有点复杂，先记住吧。然后我们看看买入卖出怎么写。</p><h2>5 买入卖出</h2><div class="highlight"><pre><code class="language-text"># 用法：order_value(要买入股票股票的股票代码，要多少钱去买）
order_value(g.security, cash)# 用当前所有资金买入股票
# 用法：order_target(要买卖股票的股票代码，目标持仓金额）
order_target(g.security, 0)# 将股票仓位调整到0，即全卖出
</code></pre></div><blockquote>答疑与延伸：</blockquote><ul><li><b>为什么没有指定交易价格？</b>此策略是按天回测进行的且使用的较为简单的市价单下单方法，交易价格为开盘价(加上滑点)</li><li><b>无法交易的情况？</b>涨跌停，停牌，T+1制度等无法交易的情况，系统会自动使下单不成交并在日志中发出警告。</li><li><a href="https://link.zhihu.com/?target=https%3A//www.joinquant.com/api%23%25E6%25BB%2591%25E7%2582%25B9" class=" wrap external" target="_blank" rel="nofollow noreferrer">滑点是什么？</a></li><li><a href="https://link.zhihu.com/?target=https%3A//www.joinquant.com/api%23%25E4%25B8%258B%25E5%258D%2595%25E5%2587%25BD%25E6%2595%25B0" class=" wrap external" target="_blank" rel="nofollow noreferrer">下单方法有哪些？</a></li></ul><p class="ztext-empty-paragraph"><br/></p><h2>6 策略代码写完，进行回测</h2><p>把买入卖出的代码写好，策略就写完了，如下</p><div class="highlight"><pre><code class="language-python"><span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">context</span><span class="p">):</span><span class="c1">#初始化</span>
    <span class="n">g</span><span class="o">.</span><span class="n">security</span> <span class="o">=</span> <span class="s1">&#39;002043.XSHE&#39;</span><span class="c1"># 股票名:兔宝宝</span>
<span class="k">def</span> <span class="nf">handle_data</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span><span class="c1">#每日循环</span>
    <span class="n">last_price</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">security</span><span class="p">]</span><span class="o">.</span><span class="n">close</span><span class="c1"># 取得最近日收盘价</span>
    <span class="c1"># 取得过去二十天的平均价格</span>
    <span class="n">average_price</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">security</span><span class="p">]</span><span class="o">.</span><span class="n">mavg</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="s1">&#39;close&#39;</span><span class="p">)</span>
    <span class="n">cash</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">portfolio</span><span class="o">.</span><span class="n">cash</span><span class="c1"># 取得当前的现金</span>
    <span class="c1"># 如果昨日收盘价高出二十日平均价, 则买入，否则卖出。</span>
    <span class="k">if</span> <span class="n">last_price</span> <span class="o">&gt;</span> <span class="n">average_price</span><span class="p">:</span>
        <span class="n">order_value</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">security</span><span class="p">,</span> <span class="n">cash</span><span class="p">)</span><span class="c1"># 用当前所有资金买入股票</span>
    <span class="k">elif</span> <span class="n">last_price</span> <span class="o">&lt;</span> <span class="n">average_price</span><span class="p">:</span>
        <span class="n">order_target</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">security</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="c1"># 将股票仓位调整到0，即全卖出</span>
</code></pre></div><p>现在，在策略回测界面右上部，设置回测时间从20140101到20160601，设置初始资金100000，设置回测频率，然后点击运行回测。 </p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-fca32e14dea7f716d425d337a4f201f5_b.jpg" data-caption="" data-size="normal" data-rawwidth="718" data-rawheight="160" class="origin_image zh-lightbox-thumb" width="718" data-original="https://pic2.zhimg.com/v2-fca32e14dea7f716d425d337a4f201f5_r.jpg"/></noscript><img src="https://pic2.zhimg.com/v2-fca32e14dea7f716d425d337a4f201f5_b.jpg" data-caption="" data-size="normal" data-rawwidth="718" data-rawheight="160" class="origin_image zh-lightbox-thumb lazy" width="718" data-original="https://pic2.zhimg.com/v2-fca32e14dea7f716d425d337a4f201f5_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-fca32e14dea7f716d425d337a4f201f5_b.jpg"/></figure><blockquote>答疑与延伸：</blockquote><ul><li><b>什么是回测？</b>回测是量化交易策略研究中的关键，是指给定一段时间的历史数据（如此处是20140101到20160601的每日数据），计算机按照所编写的策略进行模拟仿真交易，以测试策略效果好坏。</li></ul><p>如果你代码没有问题，就会顺利的进行回测，回测结果如下图： </p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-2796def4c8e40c069417d7f39c9f4b36_b.jpg" data-caption="" data-size="normal" data-rawwidth="1289" data-rawheight="666" class="origin_image zh-lightbox-thumb" width="1289" data-original="https://pic3.zhimg.com/v2-2796def4c8e40c069417d7f39c9f4b36_r.jpg"/></noscript><img src="https://pic3.zhimg.com/v2-2796def4c8e40c069417d7f39c9f4b36_b.jpg" data-caption="" data-size="normal" data-rawwidth="1289" data-rawheight="666" class="origin_image zh-lightbox-thumb lazy" width="1289" data-original="https://pic3.zhimg.com/v2-2796def4c8e40c069417d7f39c9f4b36_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-2796def4c8e40c069417d7f39c9f4b36_b.jpg"/></figure><p>至此，你就完成了一个简单策略的回测了。</p><blockquote>答疑与延伸：</blockquote><ul><li><b>如何根据回测结果评价策略好坏？</b>很初级地讲，有三： </li></ul><ol><li>盈利能力：策略收益与年化收益高，则说明盈利能力强。盈利能力不行说啥都没用。</li><li>盈利稳定性：最大回撤要低。最大回撤是指最大亏损幅度，50%则意味着历史上看最大亏损率为50%。</li><li>回测可靠性：交易次数要多。交易次数越多意味着经历了越多次的检验，回测的结果也越可靠。 <br/>更多说明见：<a href="https://link.zhihu.com/?target=https%3A//www.joinquant.com/api%23%25E9%25A3%258E%25E9%2599%25A9%25E6%258C%2587%25E6%25A0%2587" class=" wrap external" target="_blank" rel="nofollow noreferrer">风险指标说明</a></li></ol><ul><li>这个策略回撤大，交易次数少，只交易一只股票，并不靠谱。但是结构简单适合新手入门理解整个流程。</li></ul><p class="ztext-empty-paragraph"><br/></p><h2>7 建立模拟交易，使策略和行情实时连接自动运行</h2><p>策略写好，回测完成，点击回测结果界面（如上图）右上部红色模拟交易按钮，新建模拟交易如下图。 </p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-54bad5f1e8807a783dd8d235ceb1deea_b.jpg" data-caption="" data-size="normal" data-rawwidth="1280" data-rawheight="516" class="origin_image zh-lightbox-thumb" width="1280" data-original="https://pic3.zhimg.com/v2-54bad5f1e8807a783dd8d235ceb1deea_r.jpg"/></noscript><img src="https://pic3.zhimg.com/v2-54bad5f1e8807a783dd8d235ceb1deea_b.jpg" data-caption="" data-size="normal" data-rawwidth="1280" data-rawheight="516" class="origin_image zh-lightbox-thumb lazy" width="1280" data-original="https://pic3.zhimg.com/v2-54bad5f1e8807a783dd8d235ceb1deea_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-54bad5f1e8807a783dd8d235ceb1deea_b.jpg"/></figure><p>写好交易名称，设置初始资金，数据频率，此处是每天，设置好后点提交。</p><blockquote>答疑与延伸：</blockquote><ul><li>模拟交易创建成功后，需要等待A股至少开盘一次，才能查看模拟交易结果。</li></ul><h2>8 开启微信通知，接收交易信号</h2><p>点击聚宽导航栏我的交易，可以看到创建的模拟交易，如下图。 </p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-0025f1cbf8af44e9b979bddfacf20ff2_b.jpg" data-caption="" data-size="normal" data-rawwidth="1264" data-rawheight="213" class="origin_image zh-lightbox-thumb" width="1264" data-original="https://pic3.zhimg.com/v2-0025f1cbf8af44e9b979bddfacf20ff2_r.jpg"/></noscript><img src="https://pic3.zhimg.com/v2-0025f1cbf8af44e9b979bddfacf20ff2_b.jpg" data-caption="" data-size="normal" data-rawwidth="1264" data-rawheight="213" class="origin_image zh-lightbox-thumb lazy" width="1264" data-original="https://pic3.zhimg.com/v2-0025f1cbf8af44e9b979bddfacf20ff2_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-0025f1cbf8af44e9b979bddfacf20ff2_b.jpg"/></figure><p>点击右边的微信通知开关，将OFF调到ON，按照指示扫描二维码，绑定微信，就能微信接收交易信号了。 <br/>当策略买卖操作，微信会收到信号提醒类似下图。 </p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-47be83acf4d7752c9ff2d6981d3519c5_b.jpg" data-caption="" data-size="normal" data-rawwidth="384" data-rawheight="682" class="content_image" width="384"/></noscript><img src="https://pic2.zhimg.com/v2-47be83acf4d7752c9ff2d6981d3519c5_b.jpg" data-caption="" data-size="normal" data-rawwidth="384" data-rawheight="682" class="content_image lazy" width="384" data-actualsrc="https://pic2.zhimg.com/v2-47be83acf4d7752c9ff2d6981d3519c5_b.jpg"/></figure><blockquote>答疑与延伸：</blockquote><ul><li><b>能不能自动下单？</b>【重磅】聚宽和一创、广发、国君都对接了实盘交易，实现全自动量化交易！目前自动化实盘已开放使用，添加小助手微信18141907163 领取实盘开启指引。</li></ul><p class="ztext-empty-paragraph"><br/></p><p>自测与自学</p><ol><li>能否理解整个策略框架。</li><li>能否成功编写单股票均线策略，成功回测，建立模拟，开启微信通知。</li><li>能否理解年化收益，最大回撤。</li><li>浏览JoinQuant 导航栏-帮助-<a href="https://link.zhihu.com/?target=https%3A//www.joinquant.com/faq%3Ff%3Dzhzl%26m%3D23367387" class=" wrap external" target="_blank" rel="nofollow noreferrer">常见问题</a></li></ol><p><b>之后的文章，将在本文的基础上，进行深入和扩展，比如多股票，指标获取，大盘择时等，旨在帮助对量化交易有兴趣的人快速入门，能够自主实现自己心中的想法与策略。</b></p><p>本篇文章和后续将收录到 <a href="https://zhuanlan.zhihu.com/JoinQuant" class="internal">量化交易&amp;宽客 - 知乎专栏</a> ， 敬请关注：）</p><p>更多进阶内容可以到 <a href="https://link.zhihu.com/?target=https%3A//www.joinquant.com/study%3Ff%3Dzhzl%26m%3D23367387" class=" wrap external" target="_blank" rel="nofollow noreferrer">量化课堂 - JoinQuant</a> 学习，特点是讲解细致，代码规范，可以在聚宽实践演练。</p><p><b>都看到这里了，不点个赞嘛：）</b></p><p class="ztext-empty-paragraph"><br/></p><p><b>推荐阅读：</b></p><p><a href="https://link.zhihu.com/?target=https%3A//www.joinquant.com/post/4589%3Ff%3Dzh" class=" wrap external" target="_blank" rel="nofollow noreferrer">聚宽新手指南  - JoinQuant</a>，干货，答疑，指路，一应俱全。</p>