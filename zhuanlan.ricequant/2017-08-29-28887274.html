<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>米筐社区数据面面观</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/28887274">原文</a></p>
<div class="title-image"><img src="https://pic1.zhimg.com/v2-2a8eb0e4a868c00dc455b630d91eecef_r.jpg" alt=""></div><p>最近看完了《利用 Python 进行数据分析》，苦于屠龙大技无处施展，于是瞄上了米筐社区：开放的社区数据，都好好地摆在那，于是。。。从数据的爬取储存、清洗整理，到分析汇总、可视化，最终写成本文，整整搭上了三天时间（别问我为啥效率这么低，后面会讲道）。</p><h2><b>爬取储存</b></h2><p>作为一个爬虫弱渣，还好米筐社区没有反爬机制（但容我吐槽一句，社区网页源码可真不是那么容易能理得清的），靠着 requests 和 bs4 的文档，跌跌撞撞地爬取了所有数据，包括所有主题帖的标题、地址、发帖时间、再次编辑时间、跟帖量、浏览量、点赞量、是否带有回测分享、是否带有研究分享，以及分享的克隆次数。代码和原始数据就不放出来了，先说一说思路。首先进入<a href="https://www.ricequant.com/community/category/all">社区主页</a>，一共 170+ 页的所有信息都在网页源码里。用 requests 请求后再用 bs4 解析（必要的时候可以暴力一点，自己目测解析），基本就能拿到大部分数据了。而发帖时间和再次编辑时间，需要进入每一个主题帖，再在其中找到所需要的数据。</p><p>关于数据储存，我是直接用 scv 格式了(3389 rows × 10 columns)，至于数据库，等我学习一波 MongoDB 之后再来重新搞一搞。</p><h2><b>清洗整理</b></h2><p>对爬下来的数据进行清洗和整理是另一个吃力不讨好的活，无用数据的删除，数据格式的整理，以及对数据进行二次加工，都是费脑子的事情。不过整理好的数据，每看一眼就很有成就感啊。</p><h2><b>分析汇总</b></h2><p>除了 DataFrame 的合并（merge），还涉及到重采样（resample）、分组聚合（groupby），以及时间轴本身的处理，都是一些常规的东西（然而我还是要时不时翻翻书才会做，嚯嚯嚯）。</p><h2><b>可视化</b></h2><h2><b>概览</b></h2><h2><b>平均数和中位数</b></h2><p>一共爬取 3389 个主题帖，其中 19% 带有策略分享，10% 带有研究分享。每个主题帖平均被浏览了 1777 次（中位数 633 次），得到 5.5 个跟帖。在那些带有策略分享或研究分享的策略中，平均每个分享被克隆 73.3 次（注意下图中的克隆次数是除了所有的主题帖个数）。</p><img src="https://pic2.zhimg.com/v2-45b616573d531cf71ad096c5f0703539_r.png" data-rawwidth="1030" data-rawheight="536"><p><br></p><h2><b>极值</b></h2><p>社区共有两篇帖子浏览量超过十万，分别是<a href="https://www.ricequant.com/community/topic/544">《小伙伴们，你最希望Ricequant加入什么样的功能呢？》</a>和<a href="https://www.ricequant.com/community/topic/394">《【高收益低回撤】【止损】【夏普率4.0】改进版小盘股策略》</a>，top50 均超过 1.5 万次浏览：</p><img src="https://pic3.zhimg.com/v2-e8d0a9e94df4c5ebb37c8132c9d92c54_r.png" data-rawwidth="969" data-rawheight="416"><p><br></p><p>跟帖量 top50 如下：</p><img src="https://pic3.zhimg.com/v2-396a25e08f95b97f94a95738c2465e7d_r.png" data-rawwidth="950" data-rawheight="416"><p><br></p><p>至于克隆次数，不得不说社区大神很多，动不动就几百上千次克隆了。其中 top3 分别是<a href="https://www.ricequant.com/community/topic/2652">《【期货】商品期货跨品种套利研究——稳住！》</a>，<a href="https://www.ricequant.com/community/topic/394">《【高收益低回撤】【止损】【夏普率4.0】改进版小盘股策略》</a>,以及<a href="https://www.ricequant.com/community/topic/285">《Graham number 格雷厄姆数字价值投资法》</a>。top50 如下：</p><img src="https://pic4.zhimg.com/v2-65e834314ded716c93e916618b5d7e8f_r.png" data-rawwidth="957" data-rawheight="416"><p><br></p><h2><b>词云</b></h2><p>词云用了 wordcloud 和 jieba，然而水平太差，做不出好看的图来，将就下：</p><img src="https://pic4.zhimg.com/v2-22363cf7bede1b9672400cd1db626c43_r.png" data-rawwidth="805" data-rawheight="415"><p><br></p><p>另辟捷径，用 Mathematica 做的词云：</p><img src="https://pic3.zhimg.com/v2-f8593b65414a04427774dc0c89885961_r.jpg" data-rawwidth="720" data-rawheight="718"><p><br></p><h2><b>详情</b></h2><p>来看看社区的发帖量，按周合计，comment 指跟帖量，discussion 指主题帖量：</p><img src="https://pic3.zhimg.com/v2-a46c94220079785636361a4904bee3f7_r.png" data-rawwidth="950" data-rawheight="453"><p><br></p><p>折线图看不出啥，换个按月合计的柱状图：</p><img src="https://pic4.zhimg.com/v2-6feab8b7f96ab750b26ee8d6ae624637_r.png" data-rawwidth="957" data-rawheight="473"><p><br></p><p>再看看回测分享（share1）和研究分享（share2）：</p><img src="https://pic2.zhimg.com/v2-bba819da287097512aee6d618d11f6ec_r.png" data-rawwidth="944" data-rawheight="473"><p><br></p><h2><b>彩蛋</b></h2><p>拿着发帖时间，于是统计了一下社区发帖的时间分布：</p><p><br></p><img src="https://pic3.zhimg.com/v2-ae6ca7e2ee5739b1f8fe61aaa8e09cb5_r.png" data-rawwidth="684" data-rawheight="686"><p><br></p><p>饼状图还没什么直观的概念，看看这个：</p><img src="https://pic1.zhimg.com/v2-9aeb730bf8abd3c581a700e03da6241a_r.png" data-rawwidth="956" data-rawheight="441"><p><br></p><h2><b>结语</b></h2><p>三天的成果大概三分钟就能浏览完了，想想代价还是挺高的。从爬取、存储、清洗、整理、分析，一直到可视化，一条龙全是 Python 搞定的，所以说 Python 确实是个好东西。这也算是最近的一个总结，毕竟学了这么些杂七杂八的东西。</p>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
