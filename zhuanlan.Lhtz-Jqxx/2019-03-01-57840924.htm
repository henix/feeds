<div class="title-image"><img src="https://pic1.zhimg.com/v2-6963a417a69dce147e440290af93215a_b.jpg" alt=""></div><p><b>写在前面</b></p><p>这一篇是基于上篇文章提出的方法的实证部分：</p><a data-draft-node="block" data-draft-type="link-card" href="https://zhuanlan.zhihu.com/p/41270521" data-image="https://pic4.zhimg.com/v2-951dbd993c11fea2498a25ff765ff3f7_180x120.jpg" data-image-width="720" data-image-height="263" class="internal">Wu Kevin：策略篇——残差项的均值回归</a><p>之前承诺的对于上篇的实证现在才兑现，主要原因是我前期一直忙于秋招，无瑕顾及更新了。目前总算是定下来了，庆幸的是我还在量化这条路上，只不过今后的研究会更加偏向宏观层面，以后的分享也是偏宏观一些的量化研究，这篇研究也算是我原创性的job market research之一，特此分享。</p><p>这篇文章的一大贡献是，提供了（实证了）均值回复建模的一个参考方法，对于任何具有均值回复特征（全局均值回复或局部均值回复）的序列都可以套用。</p><p><a href="https://zhuanlan.zhihu.com/p/57840924/edit" class="internal">摘要</a></p><p>在已知股票价格序列本身不平稳的前提下，本文通过线性回归得到股票收益的“残差项”后，重新构造了一个新的价格序列。在假设这个价格序列符合平稳特征，用时间序列方法OU过程对其建模。识别其渐进均值和方差后建立置信区间，当价格偏离置信区间时，对个股持有相反头寸，构建了一个A股多空组合。回测来看，组合年化Sharpe 达3.22，最大回撤仅3.2%(不考虑手续费)。该方法的面临的问题是A股做空的限制和达28倍的年化换手率。继续发现，本文OU过程建模方法优于布林带方法。</p><p><b>一、 前言</b></p><p>均值回归广泛存在于金融市场，均值回复在行为金融学上的解释为：投资者的过度反应（De Bondt and Thaler 1984）</p><p>技术面指标中，布林带就有应用：当股价偏离上带或者下带时，认为股价会回复。布林带由于简单（回看定长区间计算均值和标准差）和实用性自1980年提出以来广受欢迎。</p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-9745f07c95c1d19afc29aa728b0df3c3_b.jpg" data-rawwidth="443" data-rawheight="354" data-size="normal" class="origin_image zh-lightbox-thumb" width="443" data-original="https://pic4.zhimg.com/v2-9745f07c95c1d19afc29aa728b0df3c3_r.jpg"/></noscript><img src="https://pic4.zhimg.com/v2-9745f07c95c1d19afc29aa728b0df3c3_b.jpg" data-rawwidth="443" data-rawheight="354" data-size="normal" class="origin_image zh-lightbox-thumb lazy" width="443" data-original="https://pic4.zhimg.com/v2-9745f07c95c1d19afc29aa728b0df3c3_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-9745f07c95c1d19afc29aa728b0df3c3_b.jpg"/><figcaption>图1：标普500指数20日移动平均和移动两倍标准差构造布林带，来源维基百科</figcaption></figure><p>但是布林带存在的问题是：价格序列并不平稳<a href="https://zhuanlan.zhihu.com/p/57840924/edit#_ftn1" class="internal">[1]</a>，这导致简单样本平均和取标准差的做法缺乏严格的统计意义。</p><p>构建平稳价格序列的一种方法是对两个价格序列做差分，对差分序列均值回归（配对交易）：Elliott et al (2005) 应用了OU过程（Ornstein–Uhlenbeck Process），提出了对一组协整的价格序列建模的方法。</p><p>股价的非平稳原因之一是市场风格的持续性，自然想到个股的特质收益率（剔除掉市场的解释后个股剩下的收益，也即“误差项”）</p><p>个股的“误差项”是本文研究的对象，“误差项”即为在套利定价理论（arbitrage pricing theory）框架下的个股特质收益率，或者说线性模型假设下的误差项：</p><p><img src="https://www.zhihu.com/equation?tex=r_j%3Da_j%2Bb_%7Bji%7DF_1%2Bb_%7Bj2%7DF2%2B...%2Bb_%7Bjn%7DF_n%2B%5Cvarepsilon_%7Bj%7D%5C%5C" alt="r_j=a_j+b_{ji}F_1+b_{j2}F2+...+b_{jn}F_n+\varepsilon_{j}\\" eeimg="1"/> </p><p>其中 <img src="https://www.zhihu.com/equation?tex=r_j+" alt="r_j " eeimg="1"/> 为个股 <img src="https://www.zhihu.com/equation?tex=j" alt="j" eeimg="1"/> 的收益， <img src="https://www.zhihu.com/equation?tex=F_j" alt="F_j" eeimg="1"/> 为横截面定价因子， <img src="https://www.zhihu.com/equation?tex=%5Cvarepsilon_t" alt="\varepsilon_t" eeimg="1"/> 为我们的研究对象：“误差项”。</p><p>误差项在线性模型中外生于解释变量，在个股定价模型中，被称为“特质收益率”。很自然的，特质收益率对应了价格，设特质收益率的价格为 <img src="https://www.zhihu.com/equation?tex=X_%7Bi%2Ct%7D" alt="X_{i,t}" eeimg="1"/> ，那么<img src="https://www.zhihu.com/equation?tex=X_%7Bi%2Ct%7D%3DX_%7Bi%2Ct-1%7D%281%2B%5Chat%7B%5Cvarepsilon%7D_%7Bi%2Ct%7D%29%2C%5Cforall+t%5Cne1%3BX_%7Bi%2C0%7D%3D1" alt="X_{i,t}=X_{i,t-1}(1+\hat{\varepsilon}_{i,t}),\forall t\ne1;X_{i,0}=1" eeimg="1"/> 。</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-37c19fe1d8c1eaf4f670c377387bd2d9_b.jpg" data-rawwidth="480" data-rawheight="288" data-size="normal" class="origin_image zh-lightbox-thumb" width="480" data-original="https://pic2.zhimg.com/v2-37c19fe1d8c1eaf4f670c377387bd2d9_r.jpg"/></noscript><img src="https://pic2.zhimg.com/v2-37c19fe1d8c1eaf4f670c377387bd2d9_b.jpg" data-rawwidth="480" data-rawheight="288" data-size="normal" class="origin_image zh-lightbox-thumb lazy" width="480" data-original="https://pic2.zhimg.com/v2-37c19fe1d8c1eaf4f670c377387bd2d9_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-37c19fe1d8c1eaf4f670c377387bd2d9_b.jpg"/><figcaption>图2：贵州茅台（600519.SH）股价净值和特质收益率净值	</figcaption></figure><p>图2中蓝线是贵州茅台的根据真实收益率绘制的净值曲线，红线为根据特质收益率（误差项）绘制的净值曲线。可以看出，即使股价自14年开始一直是趋势效应，特质收益率净值却依然很平稳。</p><p>Yeo and Papanicolaou (2017)用了多个公共因子对个股进行线性回归获得残差项，利用了OU过程对残差价格曲线建模，对标普500成分股从2005年到2014年进行择时并构建组合，回测结果显示该策略可以获得年年正收益且年华收益平均近10%。但文章组合优化的参数过多。</p><p>本文采用OU过程对特质收益率价格序建模，构建识别序列上下界的类“布林带”的择时指标。并在A股市场实证。</p><p><br/> <br/><b> 二、 模型设定</b></p><p><b>2.1 OU过程</b><br/> OU过程的正式表达式为：</p><p><img src="https://www.zhihu.com/equation?tex=dX_t%3D%5Ctheta%28%5Cmu-X_%7Bt%7D%29dt%2B%5Cdelta+dW_t%5C%5C" alt="dX_t=\theta(\mu-X_{t})dt+\delta dW_t\\" eeimg="1"/> </p><p>其中：</p><ul><li><img src="https://www.zhihu.com/equation?tex=%5Cmu%3E0" alt="\mu&gt;0" eeimg="1"/> 为随机变量 <img src="https://www.zhihu.com/equation?tex=X_t" alt="X_t" eeimg="1"/> 的渐进均值</li><li><img src="https://www.zhihu.com/equation?tex=%5Ctheta%3E0" alt="\theta&gt;0" eeimg="1"/> 为随机变量 <img src="https://www.zhihu.com/equation?tex=X_t+" alt="X_t " eeimg="1"/> 的回归速度</li><li><img src="https://www.zhihu.com/equation?tex=%5Csigma%3E0" alt="\sigma&gt;0" eeimg="1"/> 为维纳过程增量的标准差</li><li><img src="https://www.zhihu.com/equation?tex=W_t" alt="W_t" eeimg="1"/> 为维纳过程</li></ul><p>OU过程描述了这样一个过程：当 <img src="https://www.zhihu.com/equation?tex=X_t" alt="X_t" eeimg="1"/> 大于 <img src="https://www.zhihu.com/equation?tex=%5Cmu" alt="\mu" eeimg="1"/> ，在不考虑随机项 <img src="https://www.zhihu.com/equation?tex=W_t" alt="W_t" eeimg="1"/> 的情况下, <img src="https://www.zhihu.com/equation?tex=dX_%7Bt%7D%3C0" alt="dX_{t}&lt;0" eeimg="1"/> ，使得 <img src="https://www.zhihu.com/equation?tex=X_t" alt="X_t" eeimg="1"/> 在那一瞬间有一个向下的斜率，符合均值回复的直觉。</p><p>下面展示三组不同参数下的OU过程的模拟：</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-721ba6dc8315fdbec5d27bf1d06c7ff8_b.jpg" data-rawwidth="625" data-rawheight="150" data-size="normal" class="origin_image zh-lightbox-thumb" width="625" data-original="https://pic1.zhimg.com/v2-721ba6dc8315fdbec5d27bf1d06c7ff8_r.jpg"/></noscript><img src="https://pic1.zhimg.com/v2-721ba6dc8315fdbec5d27bf1d06c7ff8_b.jpg" data-rawwidth="625" data-rawheight="150" data-size="normal" class="origin_image zh-lightbox-thumb lazy" width="625" data-original="https://pic1.zhimg.com/v2-721ba6dc8315fdbec5d27bf1d06c7ff8_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-721ba6dc8315fdbec5d27bf1d06c7ff8_b.jpg"/><figcaption>图3：OU过程在不同参数下的模拟</figcaption></figure><p>图3的第一和第二幅图可以看出：在随机项的波动率一样的情况，回归速度 <img src="https://www.zhihu.com/equation?tex=%5Ctheta" alt="\theta" eeimg="1"/> 越小（子图（1）），回归的周期越长。</p><p>由于真实世界的价格信息是离散的，所以可以考虑OU过程的离散形式（更重要的原因是离散情况下更简单）：</p><p><img src="https://www.zhihu.com/equation?tex=X_t-X_%7Bt-1%7D%3D%5Ctheta%28%5Cmu-X_%7Bt-1%7D%29%2B%5Csigma%28W_%7Bt%7D-W_%7Bt-1%7D%29%5C%5C%283%29" alt="X_t-X_{t-1}=\theta(\mu-X_{t-1})+\sigma(W_{t}-W_{t-1})\\(3)" eeimg="1"/> </p><p>（需要注意的是：在离散的情况下 <img src="https://www.zhihu.com/equation?tex=%5Ctheta%28%5Cmu-X_%7Bt-1%7D%29" alt="\theta(\mu-X_{t-1})" eeimg="1"/> 里面的 <img src="https://www.zhihu.com/equation?tex=X_t+" alt="X_t " eeimg="1"/> 应该为 <img src="https://www.zhihu.com/equation?tex=X_%7Bt-1%7D" alt="X_{t-1}" eeimg="1"/> , 因为离散情况下没有办法通过求导刻画“瞬时”状态，只有通过前后期的差分体现）。</p><p>离散的维纳过程描述了这样一个情景： <img src="https://www.zhihu.com/equation?tex=W_1...W_%7Bt%7D" alt="W_1...W_{t}" eeimg="1"/> 时间序列的每一个增量 （increment） <img src="https://www.zhihu.com/equation?tex=W_%7Bt%7D-W_%7Bt-1%7D%2C%5Cforall+t" alt="W_{t}-W_{t-1},\forall t" eeimg="1"/> 都是独立同分布的（服从 <img src="https://www.zhihu.com/equation?tex=N%280%2Cs%5E2%29" alt="N(0,s^2)" eeimg="1"/> 的正太分布，本文中 <img src="https://www.zhihu.com/equation?tex=s%3D1" alt="s=1" eeimg="1"/>）。</p><p>所以（3）式可以化简为</p><p><img src="https://www.zhihu.com/equation?tex=X_t-X_%7Bt-1%7D%3D%5Ctheta%28%5Cmu-X_%7Bt-1%7D%29%2B%5Cvarepsilon_t%5C%5C+%284%29" alt="X_t-X_{t-1}=\theta(\mu-X_{t-1})+\varepsilon_t\\ (4)" eeimg="1"/> </p><p>（4）式中 <img src="https://www.zhihu.com/equation?tex=X_%7Bt%7D" alt="X_{t}" eeimg="1"/> 由上一期值 <img src="https://www.zhihu.com/equation?tex=X_%7Bt-1%7D" alt="X_{t-1}" eeimg="1"/> 与均值的偏离度 <img src="https://www.zhihu.com/equation?tex=%5Cmu-X_%7Bt-1%7D" alt="\mu-X_{t-1}" eeimg="1"/> ，和回归速度 <img src="https://www.zhihu.com/equation?tex=%5Ctheta" alt="\theta" eeimg="1"/> 决定。</p><p>进一步可以化简成AR(1)过程：</p><p><img src="https://www.zhihu.com/equation?tex=X_t%3D%5Calpha_0%2B%5Calpha_1X_%7Bt-1%7D%2B%5Cvarepsilon_t%5C%5C%285%29" alt="X_t=\alpha_0+\alpha_1X_{t-1}+\varepsilon_t\\(5)" eeimg="1"/> </p><p>其中 <img src="https://www.zhihu.com/equation?tex=%5Calpha_0%3D%5Ctheta%5Cmu%2C%5Calpha_1%3D1-%5Ctheta%2C%5Cvarepsilon%5Csim+N%280%2C%5Csigma%5E2%29%2C%5Cforall+t" alt="\alpha_0=\theta\mu,\alpha_1=1-\theta,\varepsilon\sim N(0,\sigma^2),\forall t" eeimg="1"/> </p><p>可以证明 <img src="https://www.zhihu.com/equation?tex=X_t" alt="X_t" eeimg="1"/> 为弱平稳过程， <img src="https://www.zhihu.com/equation?tex=X_t%5Csim+N%28%5Cmu%2C%5Cfrac%7B%5Csigma%7D%7B%5Csqrt%7B2%5Ctheta-%5Ctheta%5E2%7D%7D%29" alt="X_t\sim N(\mu,\frac{\sigma}{\sqrt{2\theta-\theta^2}})" eeimg="1"/> （证明见附录1）</p><p>值得注意的是： 当假设了 <img src="https://www.zhihu.com/equation?tex=%5Cvarepsilon_t" alt="\varepsilon_t" eeimg="1"/> 的正态性后， <img src="https://www.zhihu.com/equation?tex=%5Cvarepsilon_1%2C%5Cvarepsilon_2%2C...%2C%5Cvarepsilon_n" alt="\varepsilon_1,\varepsilon_2,...,\varepsilon_n" eeimg="1"/> 的独立同分布性质与序列白噪声（white noise）或者是鞅差分序列（Martingale difference sequence）是等价的，所以独立同分布在这儿可以放松到最弱的白噪声过程。</p><p><b>2.2 误差项的构建</b></p><p>误差项通过回归以下线性模型得到：</p><p><img src="https://www.zhihu.com/equation?tex=r_%7Bi%2Ct%7D%3D%5Calpha+%2B%5Cbeta_mMKT_t%2B%5Cbeta_sSMB_%7Bt%7D%2B%5Cbeta_hHML_%7Bt%7D%2B%5Cbeta_rRMW_t%2B%5Cbeta_cCMA_%7Bt%7D%2B%5Cbeta_%7Bu%7DUMD_%7Bt%7D%2B%5Cbeta_%7Bu%7DUMD_%7Bt%7D%2B%5Cbeta_iIndustry+Return%2B%5Cepsilon_t%5C%5C%286%29" alt="r_{i,t}=\alpha +\beta_mMKT_t+\beta_sSMB_{t}+\beta_hHML_{t}+\beta_rRMW_t+\beta_cCMA_{t}+\beta_{u}UMD_{t}+\beta_{u}UMD_{t}+\beta_iIndustry Return+\epsilon_t\\(6)" eeimg="1"/> </p><p>自变量为Fama-French 6因子加一个行业因子一共7个因子。行业因子由于和市场因子存在共线性，遂将行业收益与市场收益回归得到的残差项作为正交化的行业收益率。</p><p>我们研究的对象是误差项本身，任何的市场风格都会干扰的误差项的纯度，所以需要尽可能多的因子来控制市场风格。虽然多解释变量会而增大估计量的方差，但是我认为这种牺牲是有必要的。</p><p>(注：以上回归是时间序列回归，也可以用截面回归，对于到底控制多少变量是个值得讨论的话题)</p><p><b>三、 数据描述和可视化</b></p><p><b>3.1 数据来源</b></p><p>个股数据来源于wind数据，样本包括自2008年1月至2018年8月的全A股约3500支个股日行情数据，中信一级行业日收益率；Fama-French 6因子数据来源于中央财经大学官网<a href="https://zhuanlan.zhihu.com/p/57840924/edit#_ftn1" class="internal">[1]</a>，国泰安数据库，因子构建的过程见附录2</p><p>由于行业风格必须要得到控制，我剔除掉不能被中信一级行业归类的和上市不足一年（日历日365天）的股票，剩下2629支个股作为样本池。</p><p>图4为6因子从09年开始的净值曲线。<br/> </p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-834e3336cef7010aca9d686047b71186_b.jpg" data-rawwidth="524" data-rawheight="320" data-size="normal" class="origin_image zh-lightbox-thumb" width="524" data-original="https://pic3.zhimg.com/v2-834e3336cef7010aca9d686047b71186_r.jpg"/></noscript><img src="https://pic3.zhimg.com/v2-834e3336cef7010aca9d686047b71186_b.jpg" data-rawwidth="524" data-rawheight="320" data-size="normal" class="origin_image zh-lightbox-thumb lazy" width="524" data-original="https://pic3.zhimg.com/v2-834e3336cef7010aca9d686047b71186_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-834e3336cef7010aca9d686047b71186_b.jpg"/><figcaption>图4：6因子净值	</figcaption></figure><p><b>3.2 构建残差净值</b></p><p>残差项净值序列 <img src="https://www.zhihu.com/equation?tex=X_t" alt="X_t" eeimg="1"/> 的构建如下：</p><p>1. 对于任意一个时期t，回看125个交易日OLS回归模型（6）得到参数估计量（ <img src="https://www.zhihu.com/equation?tex=%5Chat%7B%5Calpha%7D%2C%5Chat%7B%5Cbeta%7D_m%2C...%2C%5Chat%7B%5Cbeta%7D_i" alt="\hat{\alpha},\hat{\beta}_m,...,\hat{\beta}_i" eeimg="1"/> ），继而计算“残差项”：</p><p><img src="https://www.zhihu.com/equation?tex=%5Chat%7B%5Cepsilon%7D_%7Bi%2Ct%7D%3Dr_%7Bi%2Ct%7D-%5Chat%7B%5Calpha%7D-%5Chat%7B%5Cbeta%7D%5Ctimes+MKT_t-...-%5Chat%7B%5Cbeta%7D_iIndustryReturn_t%5C%5C" alt="\hat{\epsilon}_{i,t}=r_{i,t}-\hat{\alpha}-\hat{\beta}\times MKT_t-...-\hat{\beta}_iIndustryReturn_t\\" eeimg="1"/> </p><p>2. 根据估计得到的特质收益率 <img src="https://www.zhihu.com/equation?tex=%5Chat%7B%5Cepsilon%7D_%7Bi%2Ct%7D" alt="\hat{\epsilon}_{i,t}" eeimg="1"/> ，按照累计复利计算 <img src="https://www.zhihu.com/equation?tex=X_%7Bi%2Ct%7D" alt="X_{i,t}" eeimg="1"/> , <img src="https://www.zhihu.com/equation?tex=X_%7Bi%2Ct%7D%3DX_%7Bi%2Ct-1%7D%281%2B%5Chat%7B%5Cepsilon%7D_%7Bi%2Ct%7D%29" alt="X_{i,t}=X_{i,t-1}(1+\hat{\epsilon}_{i,t})" eeimg="1"/> </p><p>选择125个交易日的原因如下：我认为回归的时间窗口过长（1年）会导致估计量滞后，不能及时反映当前市场变化；时间窗口太短（3个月）导致估计量不稳定，所以<b>考虑半年的时间窗口是合意的</b>。 </p><p>通过计算：平均来看7因子对个股回归的调整R方达0.4以上，具有较高的解释力度。</p><p>由于误差项是通过（5）式子OLS回归得到，在经典的线性模型假设下，（5）式的误差项是独立同分布的。把误差项（特质收益率）做成价格的做法类似于把误差项累计求和（对数收益率求和为累计收益率），那么独立正态分布的随机变量的求和序列是随机游走的，似乎和均值回复的特征相矛盾。</p><p>但是现实是：截面定价的残差项（不再是理论上的误差项）彼此并不是独立的，而是存在序列相关性，此相关性来源于被解释变量也就是个股收益率在时间序列上的相关性，所以该相关性导致随机游走的说法不成立。在已知特质收益率价格序列不是随机游走的情况下，我们不关心特质收益率的任何性质，只需要关注误差项合成的价格序列 <img src="https://www.zhihu.com/equation?tex=X_t" alt="X_t" eeimg="1"/> 的性质。</p><p>这里需要引用一篇启发本文的文章， <a class="member_mention" href="https://www.zhihu.com/people/65c35f508b1bd677362f91e2313b5771" data-hash="65c35f508b1bd677362f91e2313b5771" data-hovercard="p$b$65c35f508b1bd677362f91e2313b5771">@石川</a> 在文章<a href="https://zhuanlan.zhihu.com/p/38821733" class="internal">次世代均值回归策略</a>中提到：</p><p><i>“‘价格呈现均值回归’等价于‘收益率呈现序列负相关性’。这是一种非常好的、可以被拿来构建优秀策略的特性。 ‘收益率呈现均值回归（即收益率围绕 0 随机的上下波动）’等价于‘价格呈现随机游走’。这是投资品最差的一种形态（不幸的是，这也恰恰是实际中的情况），在这种情况下不存在有效的赚钱策略（运气除外）。”</i></p><p>所以我认为：均值回复策略只能建立在价格序列上。</p><p><b>3.3 检验</b></p><p>由于对 <img src="https://www.zhihu.com/equation?tex=X_t" alt="X_t" eeimg="1"/> 的弱平稳的协方差的推导中，使用了 <img src="https://www.zhihu.com/equation?tex=cov%28%5Cvarepsilon_t%2C%5Cvarepsilon_%7Bs%7D%29%3D0%2C%5Cforall+t%5Cne+s" alt="cov(\varepsilon_t,\varepsilon_{s})=0,\forall t\ne s" eeimg="1"/> 这个条件，也即 <img src="https://www.zhihu.com/equation?tex=%5Cvarepsilon_t" alt="\varepsilon_t" eeimg="1"/> 和 <img src="https://www.zhihu.com/equation?tex=%5Cvarepsilon_s" alt="\varepsilon_s" eeimg="1"/> 不存在线性相关性，满足白噪声过程。要认为模型是正确的，需要对 <img src="https://www.zhihu.com/equation?tex=%5Chat%7B%5Cvarepsilon%7D_t" alt="\hat{\varepsilon}_t" eeimg="1"/> 进行白噪声检验。当证明了线性无关性，在给定正太的假设下，同时证明了独立性</p><p>另一个事实是：特质收益与市场收益依然存在相关性，原因如下：</p><ol><li>滚动时序回归的方法不能完全剔除市场效应（参数估计存在滞后性）；</li><li>截面定价模型并不能刻画被解释变量和误差项的时间序列上的自相关性，而自相关性与市场环境相关。</li></ol><p>以上原因导致 <img src="https://www.zhihu.com/equation?tex=X_%7Bi%2Ct%7D" alt="X_{i,t}" eeimg="1"/> 的分布是和时间相关的，所以对 <img src="https://www.zhihu.com/equation?tex=X_%7Bi%2Ct%7D" alt="X_{i,t}" eeimg="1"/> 的参数的样本选取也要随时间变化，这导致我们的白噪声检验也是发生在局部而不是全局。</p><p>于是我在样本窗口内随机抽取个股连续252个交易日做Box-ljung白噪声检验，发现<b>全样本2629支股票中有2049支不能拒绝白噪声原假设</b>。</p><p>总的来说：大部分个股特质波动率建模后的  局部来看还是能够满足白噪声过程。一个正式的表达如下：</p><p><b>根据过去估计出来关于</b> <img src="https://www.zhihu.com/equation?tex=X_%7Bi%2Ct%7D" alt="X_{i,t}" eeimg="1"/> <b>的参数：渐进均值</b> <img src="https://www.zhihu.com/equation?tex=%5Chat%7B%5Cmu%7D" alt="\hat{\mu}" eeimg="1"/> <b>，回归速度</b> <img src="https://www.zhihu.com/equation?tex=%5Chat%7B%5Ctheta%7D" alt="\hat{\theta}" eeimg="1"/> <b>和随机项的波动率</b> <img src="https://www.zhihu.com/equation?tex=%5Chat%7B%5Csigma%7D" alt="\hat{\sigma}" eeimg="1"/> <b>和时间相关，变为</b> <img src="https://www.zhihu.com/equation?tex=%5Chat%7B%5Cmu%7D_t" alt="\hat{\mu}_t" eeimg="1"/> <b>，</b> <img src="https://www.zhihu.com/equation?tex=%5Chat%7B%5Ctheta%7D_t" alt="\hat{\theta}_t" eeimg="1"/> <b>和</b> <img src="https://www.zhihu.com/equation?tex=%5Chat%7B%5Csigma%7D_t" alt="\hat{\sigma}_t" eeimg="1"/> <b>，并且具有一定的稳定性，可以据此对未来短期内做统计推断。</b></p><p><b>3.4 建立置信区间</b></p><p>当序列满足模型的假设时，便可以建立置信区间用来刻画序列运动的预期通道。</p><p>对每一支个股站在t时刻回看252个交易日滚动做如下的操作：</p><ol><li>采用OLS估计 <img src="https://www.zhihu.com/equation?tex=%5Calpha_%7B0%2Ct%7D%2C%5Calpha_%7B1%2Ct%7D%2C%5Chat%7B%5Csigma%7D_t" alt="\alpha_{0,t},\alpha_{1,t},\hat{\sigma}_t" eeimg="1"/>，并计算渐进均值 <img src="https://www.zhihu.com/equation?tex=%5Chat%7B%5Cmu%7D_t" alt="\hat{\mu}_t" eeimg="1"/> 和回归速度 <img src="https://www.zhihu.com/equation?tex=%5Chat%7B%5Ctheta%7D_t" alt="\hat{\theta}_t" eeimg="1"/><img src="https://www.zhihu.com/equation?tex=%5Chat%7B%5Cmu%7D%3D%5Cfrac%7B%5Chat%7B%5Calpha%7D_%7B0%2Cj%7D%7D%7B1-%5Chat%7B%5Calpha_%7Bi%2Ct%7D%7D%7D%3B%5Chat%7B%5Ctheta%7D%3D1-%5Chat%7B%5Calpha%7D_%7B1%2Ct%7D" alt="\hat{\mu}=\frac{\hat{\alpha}_{0,j}}{1-\hat{\alpha_{i,t}}};\hat{\theta}=1-\hat{\alpha}_{1,t}" eeimg="1"/> ；  </li><li>建立置信区间: <img src="https://www.zhihu.com/equation?tex=%5Chat%7B%5Cmu%7D_t%5Cpm2%5Cfrac%7B%5Chat%7B%5Csigma_t%7D%7D%7B%5Csqrt%7B2%5Chat%7B%5Ctheta%7D_t-%5Chat%7B%5Ctheta%7D_t%5E2%7D%7D" alt="\hat{\mu}_t\pm2\frac{\hat{\sigma_t}}{\sqrt{2\hat{\theta}_t-\hat{\theta}_t^2}}" eeimg="1"/> </li></ol><p>这里的数字2表示：当一个服从正太分布的随机变量偏离原假设期望（可正可负）的2倍（严格为1.96，文章实证采用1.96）标准差时，在5%的显著性水平下拒绝原假设期望。5%的显著性水平也是在实证计量经济学公认的显著性水平，<b>将其固定后不再是一个参数。</b></p><p>下面对比布林带方法，试图将置信区间可视化。</p><p>布林带方法构造如下：</p><ol><li>计算252个交易日移动均值和移动标准差（布林带构造方法）</li><li>建立置信区间: 20日移动平均 <img src="https://www.zhihu.com/equation?tex=%5Cpm" alt="\pm" eeimg="1"/> 2倍20日移动标准差</li></ol><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-6dae9733438793668eed0d69b01f6d76_b.jpg" data-rawwidth="1713" data-rawheight="481" data-size="normal" class="origin_image zh-lightbox-thumb" width="1713" data-original="https://pic3.zhimg.com/v2-6dae9733438793668eed0d69b01f6d76_r.jpg"/></noscript><img src="https://pic3.zhimg.com/v2-6dae9733438793668eed0d69b01f6d76_b.jpg" data-rawwidth="1713" data-rawheight="481" data-size="normal" class="origin_image zh-lightbox-thumb lazy" width="1713" data-original="https://pic3.zhimg.com/v2-6dae9733438793668eed0d69b01f6d76_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-6dae9733438793668eed0d69b01f6d76_b.jpg"/><figcaption>图6：OU过程（左）布林带（右）建立置信区间方法的对比：贵州茅台（600519.SH）</figcaption></figure><p>可以看出：用简单移动平均的建立的置信区间虽然平稳，但是滞后性太强，对当前价格变动不敏感，而OU过程置信区间克服了这一缺点。</p><p>由于模型设定中 <img src="https://www.zhihu.com/equation?tex=%5Calpha_%7B0%2Ct%7D%3E0%2C%5Calpha_%7B1%2Ct%7D%3C1" alt="\alpha_{0,t}&gt;0,\alpha_{1,t}&lt;1" eeimg="1"/> , 当 <img src="https://www.zhihu.com/equation?tex=%5Calpha_%7B1%2Ct%7D%3E1" alt="\alpha_{1,t}&gt;1" eeimg="1"/> （ <img src="https://www.zhihu.com/equation?tex=%5Chat%7B%5Ctheta%7D_t%3C0" alt="\hat{\theta}_t&lt;0" eeimg="1"/> ，意味着回归速度为负）会导致方差识别失败（ <img src="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Chat%7B%5Csigma%7D%7D%7B%5Csqrt%7B2%5Chat%7B%5Ctheta%7D-%5Chat%7B%5Ctheta%7D%5E2%7D%7D" alt="\frac{\hat{\sigma}}{\sqrt{2\hat{\theta}-\hat{\theta}^2}}" eeimg="1"/> 分母根号内为负），举个例子:</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-68992ecf7f4437381d426a81d6875c90_b.jpg" data-rawwidth="881" data-rawheight="471" data-size="normal" data-caption="" class="origin_image zh-lightbox-thumb" width="881" data-original="https://pic1.zhimg.com/v2-68992ecf7f4437381d426a81d6875c90_r.jpg"/></noscript><img src="https://pic1.zhimg.com/v2-68992ecf7f4437381d426a81d6875c90_b.jpg" data-rawwidth="881" data-rawheight="471" data-size="normal" data-caption="" class="origin_image zh-lightbox-thumb lazy" width="881" data-original="https://pic1.zhimg.com/v2-68992ecf7f4437381d426a81d6875c90_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-68992ecf7f4437381d426a81d6875c90_b.jpg"/></figure><p>从图7中可以看到在12年至13年间价格急升和13年至14年的明显趋势价格下，方差识别失败，说明样本并不满足均值回复的特征，这时对其做均值回复策略的时候需要谨慎。</p><p><b>四、 回测</b></p><p><b>4.1 开平仓信号</b></p><p>构建这样的投资组合：每天根据昨天产生的多/空/平信号，在今天的收盘价做多/做空/平仓构建一个投资组合，该投资组合的每支个股开平仓信号产生如下：</p><ol><li>股票的样本池为全样本2629支股票按照市值剔除前后10%的股票<a href="https://zhuanlan.zhihu.com/p/57840924/edit#_ftn1" class="internal">[1]</a></li><li>开仓：当特质收益率价格向上偏离置信区间，产生卖空信号；向下偏离，产生买多信号</li><li>平仓：当特质收益率价格回到0.67倍标注差时产生平仓信号</li></ol><p>第3步中：0.67倍标准差的含义是：<b>一个服从正态分布的随机变量偏离均值0.67倍标注差以内的概率为0.5。</b></p><p>也就是当我们只有50%的把握认为特质收益率净值偏离均值时，平仓。这里的0.67倍固定下来<b>不再是参数。</b></p><p><i> (  </i><a href="https://zhuanlan.zhihu.com/p/57840924/edit#_ftnref1" class="internal">[1]</a><i> 为了得到不同参数下的稳健性，往往需要做市值控制。即使控制其他条件不变，剔除市值排前后1%的个股，回测年化夏普比仍可达到2.91。为了前后一致性，选择前后10%)</i></p><p><b>4.2 开仓信号限定</b><br/> <br/> 由于样本池为全A股，同时我们需要对组合规模有所掌控。所以在每次开仓时，需要对进入组合的个股进行限制：</p><ol><li>在产生开仓信号的个股中， <img src="https://www.zhihu.com/equation?tex=%5Chat%7B%5Ctheta%7D_%7Bi%2Ct%7D" alt="\hat{\theta}_{i,t}" eeimg="1"/> 如果排在横截面上所有个股90以外，不开仓</li><li>1. 3个月内存在长达5个交易日的回归速度 <img src="https://www.zhihu.com/equation?tex=%5Chat%7B%5Ctheta%7D_%7Bi%2Ct%7D" alt="\hat{\theta}_{i,t}" eeimg="1"/> 为负的不开仓</li></ol><p>第1步中的 <img src="https://www.zhihu.com/equation?tex=%5Chat%7B%5Ctheta%7D_%7Bi%2Ct%7D" alt="\hat{\theta}_{i,t}" eeimg="1"/> 是回复速度，我认为回复速度越快的，在未来有更大的概率做均值回复;第2步：回忆图中的置信区间缺失部分，置信区间缺失表面当前特质收益率价格以趋势为主，均值回复的概率小。</p><p><b>4.3 回测结果</b></p><p>回测设定如下：</p><ol><li>每天按照收盘价计算个股加权平均收益率，每天调整权重使得总多空头寸持平，多/空内部等权</li><li>分别考虑不算手续费和手续费双边0.002(千二)，手续费包括<b>开平仓手续费</b>和<b>权重调整费用</b></li><li>计算每天的组合收益率，设定初始投资额为1按照累计复利计算组合净值</li></ol><p>回测结果如下：</p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-a194f9a4f16c562023ce55cb47bb9a7b_b.jpg" data-rawwidth="1332" data-rawheight="436" data-size="normal" class="origin_image zh-lightbox-thumb" width="1332" data-original="https://pic4.zhimg.com/v2-a194f9a4f16c562023ce55cb47bb9a7b_r.jpg"/></noscript><img src="https://pic4.zhimg.com/v2-a194f9a4f16c562023ce55cb47bb9a7b_b.jpg" data-rawwidth="1332" data-rawheight="436" data-size="normal" class="origin_image zh-lightbox-thumb lazy" width="1332" data-original="https://pic4.zhimg.com/v2-a194f9a4f16c562023ce55cb47bb9a7b_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-a194f9a4f16c562023ce55cb47bb9a7b_b.jpg"/><figcaption>图8：组合净值和同期沪深300净值(左为0手续费，右为千二手续费)</figcaption></figure><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-a95400cc5fa19f499cd0c89e70e9b0d1_b.png" data-rawwidth="1232" data-rawheight="162" data-size="normal" class="origin_image zh-lightbox-thumb" width="1232" data-original="https://pic2.zhimg.com/v2-a95400cc5fa19f499cd0c89e70e9b0d1_r.jpg"/></noscript><img src="https://pic2.zhimg.com/v2-a95400cc5fa19f499cd0c89e70e9b0d1_b.png" data-rawwidth="1232" data-rawheight="162" data-size="normal" class="origin_image zh-lightbox-thumb lazy" width="1232" data-original="https://pic2.zhimg.com/v2-a95400cc5fa19f499cd0c89e70e9b0d1_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-a95400cc5fa19f499cd0c89e70e9b0d1_b.png"/><figcaption>表1：组合表现统计量</figcaption></figure><p>图8中的蓝线是组合的绝对收益净值（不是超额），红线为沪深300从2010-7-28开始的净值。可以看到构建的组合可以实现年年正回报，回测期8年内(2010-7-28至2018-7-5)跑赢沪深300（超额125.0%）。最大回撤仅3.3%！但是由于策略本身的个股择时的属性，导致其年化换手率高。</p><p>目前的疑问是：我们建模的对象是特质收益率价格，并不是股价，这种关系是怎么对应上去的呢？</p><p>以为鄂武商A（000501.SZ）为例：</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-fe238d99e2e754d0b561d25cfd20f551_b.jpg" data-rawwidth="602" data-rawheight="586" data-size="normal" class="origin_image zh-lightbox-thumb" width="602" data-original="https://pic2.zhimg.com/v2-fe238d99e2e754d0b561d25cfd20f551_r.jpg"/></noscript><img src="https://pic2.zhimg.com/v2-fe238d99e2e754d0b561d25cfd20f551_b.jpg" data-rawwidth="602" data-rawheight="586" data-size="normal" class="origin_image zh-lightbox-thumb lazy" width="602" data-original="https://pic2.zhimg.com/v2-fe238d99e2e754d0b561d25cfd20f551_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-fe238d99e2e754d0b561d25cfd20f551_b.jpg"/><figcaption>图9：鄂武商A（000501.SZ）特质收益率价格择时、开平仓信号对应股价净值，择时个股净值曲线	</figcaption></figure><p>其中图9第一幅子图是特质收益率价格（蓝线），均值（中间红线），置信区间（浅红色区间），择时信号产生的持有头寸（红色：买；绿色：卖），中间的空白区域为均值回复平仓区域（0.67倍标准差）；第二幅子图是对应到用个股收盘价收益算出来的净值上的头寸分布情况；第三幅图是根据信号择时的股票净值。</p><p>这种策略的有效性源于线性模型中误差项 <img src="https://www.zhihu.com/equation?tex=%5Cepsilon_t" alt="\epsilon_t" eeimg="1"/> 与被解释变量 <img src="https://www.zhihu.com/equation?tex=r_%7Bi%2Ct%7D" alt="r_{i,t}" eeimg="1"/> 的相关性，我的策略仅仅是抓住了个股本身的特质波动率，所以从个股上来看（鄂武商A，000501.SZ）没有抓住14年后半年到15年年初的市场收益；从组合上来看，在14年10月份开始的牛市也跑输了市场。但是beta收益不是任何时候都有的，残差项的收益却是时时刻刻都存在的。</p><p><b>4.4截面验证</b></p><p>从组合净值曲线可以看出：组合收益最大的是在15年到16年第一季度（泡沫期和泡沐破裂期）</p><p>我认为是由于在泡沫期动量效应明显，在能够识别动量方向的时候，能够获得相比非泡沫期更高的收益，而我们构建的置信区间或多或少地抓住了个股动量的方向。</p><p>还可以从截面相关性来进一步验证，动量期的收益依然来源于均值回复效应。</p><p>在因子投资里IC被用来检验横截面个股因子值和下一期收益的相关性，于是我构建一个因子：这个因子用来刻画当前特质收益率价格偏离了多少倍标准差<a href="https://zhuanlan.zhihu.com/p/57840924/edit#_ftn1" class="internal">[1]</a>，偏离的倍数就是因子值。该因子值是有方向性的，比如向上偏离了两倍标注差，因子值为2；向下偏离了两倍标注差，因子值为-2。所以预期因子值和下期收益率存在负相关</p><p>我借助Quantopian平台下的模块Alphalens来计算IC（Information Coefficient）</p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-1eacb4b4a00a35a1bb740580ddac7386_b.jpg" data-rawwidth="643" data-rawheight="243" data-size="normal" class="origin_image zh-lightbox-thumb" width="643" data-original="https://pic3.zhimg.com/v2-1eacb4b4a00a35a1bb740580ddac7386_r.jpg"/></noscript><img src="https://pic3.zhimg.com/v2-1eacb4b4a00a35a1bb740580ddac7386_b.jpg" data-rawwidth="643" data-rawheight="243" data-size="normal" class="origin_image zh-lightbox-thumb lazy" width="643" data-original="https://pic3.zhimg.com/v2-1eacb4b4a00a35a1bb740580ddac7386_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-1eacb4b4a00a35a1bb740580ddac7386_b.jpg"/><figcaption>图10：标准差偏离度因子以持有22个交易日的IC值时间序列分布	</figcaption></figure><p>图10描述了当期个股当期因子值和22个交易日后累计收益的相关性（IC值）。可以看到在15年至16年第一季度一个月移动平均IC值稳定为负，且连续为负的持续时间也是其他时间段不具备的。</p><p>所以可以认为15年的高收益也是由于残差项的均值回复导致的，泡沫期和泡沫破裂期的市场环境使得均值回复的效果更加稳定。</p><p><b>五、 对照组合表现</b></p><p>我用布林带的方法来构建一个对照组合：</p><p>控制其他条件不变，置信区间通过简单计算移动平均和移动样本标注差来建立。</p><p>考虑两组滚动时间窗口：</p><ol><li>252个交易日。为了和我们的组合识别窗口一致</li><li>22个交易日。这个是普遍认为的布林带最优窗口期</li></ol><p>布林带官方建议采用2倍标注差构建置信区间，为了和我们的识别方法可比较，仍采用1.96倍标注差作为开仓条件（0.67倍标准差平仓），不考虑手续费；由于布林带方法不存在 <img src="https://www.zhihu.com/equation?tex=%5Ctheta" alt="\theta" eeimg="1"/> 这个参数，所以关于 <img src="https://www.zhihu.com/equation?tex=%5Ctheta" alt="\theta" eeimg="1"/>  的组合控制方法都不考虑，下面是以上两组参数的布林带方法回测表现：</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-d9b6f34fdd91f0c943c6345047f82731_b.jpg" data-rawwidth="828" data-rawheight="380" data-size="normal" class="origin_image zh-lightbox-thumb" width="828" data-original="https://pic2.zhimg.com/v2-d9b6f34fdd91f0c943c6345047f82731_r.jpg"/></noscript><img src="https://pic2.zhimg.com/v2-d9b6f34fdd91f0c943c6345047f82731_b.jpg" data-rawwidth="828" data-rawheight="380" data-size="normal" class="origin_image zh-lightbox-thumb lazy" width="828" data-original="https://pic2.zhimg.com/v2-d9b6f34fdd91f0c943c6345047f82731_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-d9b6f34fdd91f0c943c6345047f82731_b.jpg"/><figcaption>图11：布林带方法对照组合净值和同期沪深300净值</figcaption></figure><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-b8bac541f9789e203fece8529eb5bec5_b.png" data-rawwidth="1560" data-rawheight="220" data-size="normal" class="origin_image zh-lightbox-thumb" width="1560" data-original="https://pic2.zhimg.com/v2-b8bac541f9789e203fece8529eb5bec5_r.jpg"/></noscript><img src="https://pic2.zhimg.com/v2-b8bac541f9789e203fece8529eb5bec5_b.png" data-rawwidth="1560" data-rawheight="220" data-size="normal" class="origin_image zh-lightbox-thumb lazy" width="1560" data-original="https://pic2.zhimg.com/v2-b8bac541f9789e203fece8529eb5bec5_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-b8bac541f9789e203fece8529eb5bec5_b.png"/><figcaption>表2：布林带方法组合表现统计量</figcaption></figure><p>图11和表2显示：布林带方法在两个参数下能获得的年化夏普比最大只有1.50，且最大回撤为4.8%，也比我们的组合高出不少，但年化换手率更低。总的来说布林带方法构建的组合在表现上远不如OU过程组合。</p><p><b>六、 稳健性检查</b></p><p><b>6.1 参数有哪些？</b></p><p>到目前为止还没有讨论过参数优化的问题，梳理一下所有的参数：</p><ol><li>滚动建立置信区间的天数（252个交易日）</li><li>产生开仓信号时：按照均值回归速 <img src="https://www.zhihu.com/equation?tex=%5Chat%7B%5Ctheta%7D_t" alt="\hat{\theta}_t" eeimg="1"/> 度排序选取最大的多少支个股（90支）</li><li>产生信号时：过去三个月内存在累计多少个交易日置信区间识别失败（均值回归速度 <img src="https://www.zhihu.com/equation?tex=%5Chat%7B%5Ctheta%7D_t%3C0" alt="\hat{\theta}_t&lt;0" eeimg="1"/> ），即使产生信号也不开仓（10个交易日）</li></ol><p>对于（1）滚动天数的设定上，我认为1年是一个合意的时间区间，所以不再考虑对252这个数字的参数问题。</p><p>对于（2）选取前多少支股票这个要根据具体实盘上组合规模的限制，和基金经理认为合适股票数量的股票池来选择，但是组合规模确实会影响策略收益，是一个参数。</p><p>（3）对个股的均值回复“质量”进行把关：过去一段时间特质收益率价格存在趋势特征：那么就不应该开仓，但是判断的天数却是一个典型的参数。</p><p>所以现在只剩下2个参数：</p><p>1. 产生信号时 <img src="https://www.zhihu.com/equation?tex=%5Chat%7B%5Ctheta%7D_t" alt="\hat{\theta}_t" eeimg="1"/> 从大到小排序取前n支股票中的n；</p><p>2. 三个月内k天或以上 <img src="https://www.zhihu.com/equation?tex=%5Chat%7B%5Ctheta%7D_t%3C0" alt="\hat{\theta}_t&lt;0" eeimg="1"/> 不开仓的k</p><p>本文不对参数优化做更多的深究。</p><p><b>6.2 网格参数稳健性检查</b></p><p>我对n和k设一个上下界：n设置为从30到120(间隔为5)，k设置为从1到22（间隔为1），稳健性的评价指标选取年化夏普比。</p><p>n、k的值从小到大是一个开仓条件逐渐放宽的过程。</p><p>下面在保持其他条件不变，计算每一个n，k对应的年化夏普比，并画出网格图：</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-8bf0a24ccac95df4b3fa256973fc50b1_b.jpg" data-rawwidth="642" data-rawheight="300" data-size="normal" class="origin_image zh-lightbox-thumb" width="642" data-original="https://pic2.zhimg.com/v2-8bf0a24ccac95df4b3fa256973fc50b1_r.jpg"/></noscript><img src="https://pic2.zhimg.com/v2-8bf0a24ccac95df4b3fa256973fc50b1_b.jpg" data-rawwidth="642" data-rawheight="300" data-size="normal" class="origin_image zh-lightbox-thumb lazy" width="642" data-original="https://pic2.zhimg.com/v2-8bf0a24ccac95df4b3fa256973fc50b1_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-8bf0a24ccac95df4b3fa256973fc50b1_b.jpg"/><figcaption>图12：不同n（30到120）、k（1到22）值对应的回测年化夏普比	</figcaption></figure><p>图12可以看出：</p><p>1. 当n值大于60的时候，年化夏普对于n的变动不再敏感。具体的区间范围还有依股票样本池的容量而定。</p><p>2. 年化夏普比在k取1到2时变动十分剧烈，由于k=1意味着过去三个月只要存在一天                    ，就不开仓，是一个非常严格的约束，反而会损害组合表现。k从1到2年化夏普比陡增是由于边际约束的放松在前期更明显，所以随着k逐渐增大，在后期年化夏普比的边际贡献逐渐减小，在k=4时为极大值，之后年化夏普比随着k增大平稳地降低直至收敛。</p><p>3. 在网格图的最右上端的年华夏普比对n和k的变动敏感度几乎为0。因为右上端n、k数值最大，代表着几乎不对个股过去一段时间是否是趋势态和进入样本容量进行限制，也就是0参数。即便如此，年化夏普比依然接近2.7！</p><p>4. 总的来看，夏普比曲面十分平整，我们的组合对参数不敏感，结论稳健！</p><p><b>七、 总结</b></p><p>本文的直觉源于个股特质收益率的外生性质，策略成功的关键也在于特质收益率的时间序列上的相关性。我将特质收益率合成新的价格，假设其均值回复并建模，通过并识别渐进均值和渐进标注差建立置信区间。认为当特质收益率价格突破置信区间时，在未来短期会回复。我于是构建一个个股择时的组合，组合表现上：年化夏普比高达2.90，最大回测仅3.3%。</p><p>我发现15年至16年第一季度的组合表现（年化收益47%）远优于其他时间，我进一步进行截面验证，通过构造因子并计算IC值发现该时间段因子与收益的截面相关性相比其他时间更加稳定，说明了均值回复策略在动量期反而有更好的表现。</p><p>我认为策略表现的原因除了均值回复假设成立之外，还要归功于模型（OU过程）能够准确地估计序列的置信区间，我进一步采用简单样本均值和样本标注差的方法（布林带方法）来估计置信区间，在控制其他条件不变的情况下来构建组合，发现布林带方法组合表现（年化夏普比1.5）远逊于OU过程建模方法。</p><p>组合网格参数方法显示：组合的夏普比对参数的不敏感，结论稳健。</p><p><b>OU过程建模优于布林带方法建模</b></p><p>布林带方法对股价本身简单样本均值和样本标注差的置信区间构建完全不顾及股价的非平稳特性，即使把该方法用在符合均值回复假设的特质收益率价格序列上，其构建方法忽略序列的自相关性导致表现平平。可见OU过程和其他时间序列模型在A股的应用大有可为。</p><p><b>基于大样本的组合构建是策略稳定的关键</b></p><p>如果仅仅从单只个股择时的角度去做回测，结果有时候往往不如一直持有（buy and hold）。但是在大样本（我把满足条件的全A股（2629支个股）纳入我们的选股样本池）和组合管理下（在资金分配方面多空头寸持平，每日调整），组合收益持续稳定。</p><p><b>复杂的组合控制方法反而会损害组合表现</b></p><p>我也考虑过其他的组合控制方法：包括，在个股产生开仓信号时，该个股的当日滚动回归的调整R方只有到达一定的阈值才纳入开仓股里；当开仓后超过一个星期特质收益率站在置信区间外提前平仓；个股收益的止损和止盈；当识别的均值和当前特质收益率价格偏差过大不开仓等。但是这些组合控制方法不仅不会提高组合表现，反而会因为“风险控制”降低组合表现。</p><p><b>基于此模型的其他应用场景</b></p><p>我们的择时策略也可以用于在指数成分股里择股择时，进行指数增强，但是某些指数无法满足对于大样本的需求，比如上证50（000016.SH）；OU过程建模方法也有想象空间，可应用于任何具有均值回复属性的序列，比如日内高频股价序列；正如我在截面验证提到的一样，还可以从因子的角度来审视残差项的均值回复特性，这样可以避免个股择时频繁开平仓导致的高换手率，也是一个值得研究的方向。</p><p><b>参考文献</b></p><p>Box, G. E. P.; Pierce, D. A. (1970). &#34;Distribution of Residual Autocorrelations in Autoregressive-Integrated Moving Average Time Series Models&#34;. Journal of the American Statistical Association. 65: 1509–1526</p><p>De Bondt, W. F. M. and R. Thaler (1984). Does the stock market overreact? The Journal of Finance, Vol. 40(3), 793 – 805.</p><p>Elliott, R., van der Hoek, J. and Malcolm, W. (2005) “Pairs Trading”, Quantitative Finance, Vol. 5(3), pp. 271-276.</p><p>G. M. Ljung; G. E. P. Box (1978). &#34;On a Measure of a Lack of Fit in Time Series Models&#34;. Biometrika. 65 (2): 297–303.</p><p>&#34;Python: Ljung-Box Tests&#34;. statsmodels.org.</p><p>Uhlenbeck, G. E.; Ornstein, L. S. (1930). &#34;On the theory of Brownian Motion&#34;. Phys. Rev. 36: 823–841.</p><p>Yeo, J. and G. Papanicolaou (2017). Risk control of mean-reversion time in statistical arbitrage.Risk and Decision Analysis, Vol. 6(4), 263 – 290.</p><p>Alphalens官网：<a href="https://link.zhihu.com/?target=https%3A//www.quantopian.com/posts/alphalens-a-new-tool-for-analyzing-alpha-factors" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">https://www.</span><span class="visible">quantopian.com/posts/al</span><span class="invisible">phalens-a-new-tool-for-analyzing-alpha-factors</span><span class="ellipsis"></span></a></p><p>布林带维基百科：<a href="https://link.zhihu.com/?target=https%3A//en.wikipedia.org/wiki/Bollinger_Bands" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">https://</span><span class="visible">en.wikipedia.org/wiki/B</span><span class="invisible">ollinger_Bands</span><span class="ellipsis"></span></a></p><p>中央财经大学金融学院官网下载页：<a href="https://link.zhihu.com/?target=http%3A//sf.cufe.edu.cn/kxyj/kyjg/zgzcglyjzx/zlxzzq/index.htm" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">http://</span><span class="visible">sf.cufe.edu.cn/kxyj/kyj</span><span class="invisible">g/zgzcglyjzx/zlxzzq/index.htm</span><span class="ellipsis"></span></a></p><p><b>附录：</b></p><p>1. 证明 <img src="https://www.zhihu.com/equation?tex=X_t" alt="X_t" eeimg="1"/> 为弱平稳过程，  <img src="https://www.zhihu.com/equation?tex=X_t%5Csim+N%28%5Cmu%2C%5Cfrac%7B%5Csigma%7D%7B%5Csqrt%7B2%5Ctheta-%5Ctheta%5E2%7D%7D%29" alt="X_t\sim N(\mu,\frac{\sigma}{\sqrt{2\theta-\theta^2}})" eeimg="1"/> </p><p>证明： </p><p> 均值：<img src="https://www.zhihu.com/equation?tex=E%28X_t%29+%3D+%5Calpha_0+%2B+%5Calpha_1E%28X_%7Bt-1%7D%29%5C%5C+%3D+%5Calpha_0+%2B+%5Calpha_1%28%5Calpha_0+%2B+%5Calpha_1%5Calpha_0+%2B+%5Calpha_1%5E2E%28X_%7Bt-2%7D%29%29%5C%5C+%3D+...%5C%5C+%3D+%5Calpha_0+%2B+%5Calpha_0%5Calpha_1%2B+%5Calpha_0%5Calpha_1%5E2+%2B+...+%2B+%5Calpha_1%5EtE%28X_0%29%5C%5C+%3D+%5Calpha_0%7B%5Cfrac%7B1-%5Calpha_1%5E%7Bt-1%7D%7D%7B1-%5Calpha_1%7D%7D%5C%5C+%28%5Calpha_1%3C1%2Ct%5Crightarrow%5Cinfty%2CX_0%29%5C%5C+%3D+%5Cfrac%7B%5Calpha_0%7D%7B1-%5Calpha_1%7D+%3D+%5Cmu%5C%5C" alt="E(X_t) = \alpha_0 + \alpha_1E(X_{t-1})\\ = \alpha_0 + \alpha_1(\alpha_0 + \alpha_1\alpha_0 + \alpha_1^2E(X_{t-2}))\\ = ...\\ = \alpha_0 + \alpha_0\alpha_1+ \alpha_0\alpha_1^2 + ... + \alpha_1^tE(X_0)\\ = \alpha_0{\frac{1-\alpha_1^{t-1}}{1-\alpha_1}}\\ (\alpha_1&lt;1,t\rightarrow\infty,X_0)\\ = \frac{\alpha_0}{1-\alpha_1} = \mu\\" eeimg="1"/> </p><p>方差</p><p><img src="https://www.zhihu.com/equation?tex=Var%28X_t%29+%3D+Var%28%5Calpha_0+%2B+%5Calpha_1X_%7Bt-1%7D+%2B+%5Cepsilon_t%29%5C%5C+%3D%5Calpha_1%5E2Var%28X_%7Bt-1%7D%29+%2B+%5Csigma%5E2%5C%5C+%3D%5Calpha_1%5E2%28b%5E2Var%28X_%7Bt-2%7D%29+%2B+%5Csigma%5E2%29+%2B+%5Ctheta%5E2%5C%5C+%28%5Calpha_1%3C1%2Ct%5Crightarrow%5Cinfty%2CX_0%29%5C%5C+%3D0+%2B+%5Cfrac%7B%5Csigma%5E2%7D%7B1-%5Calpha_1%5E2%7D+%3D+%5Cfrac%7B%5Csigma%5E2%7D%7B2%5Ctheta-%5Ctheta%5E2%7D" alt="Var(X_t) = Var(\alpha_0 + \alpha_1X_{t-1} + \epsilon_t)\\ =\alpha_1^2Var(X_{t-1}) + \sigma^2\\ =\alpha_1^2(b^2Var(X_{t-2}) + \sigma^2) + \theta^2\\ (\alpha_1&lt;1,t\rightarrow\infty,X_0)\\ =0 + \frac{\sigma^2}{1-\alpha_1^2} = \frac{\sigma^2}{2\theta-\theta^2}" eeimg="1"/> </p><p>协方差</p><p><img src="https://www.zhihu.com/equation?tex=Cov%28X_t%2CX_%7Bt-h%7D%29%3DE%5BX_t-E%28X_t%29%5D%5B%28X_%7Bt-h%7D+-+E%28X_%7Bt-h%7D%29%29%5D%5C%5C+%3DE%28X_tX_%7Bt-h%7D%29+-+%5Cmu+E%28X_t+%2B+X_%7Bt-h%7D%29+%2B+%5Cmu%5E2%5C%5C+%3DE%5B%28%5Calpha_0+%2B+bX_%7Bt%2Bh-1%7D%29X_t%5D+-+2%5Cmu%5E2+%2B+%5Cmu%5E2%5C%5C+%3DE%5B%28%5Calpha_0+%2B+ab+%2B+%5Calpha_1%5E2X_%7Bt-h-2%7D%29X_t%5D+-+%5Cmu%5E2%5C%5C+%3D...%5C%5C+%3DE%5B%28%5Calpha_0+%2B+ab+%2B+ab%5E2+%2B+ab%5E3+%2B+...+%2B+ab%5E%7Bh-1%7D+%2B+%5Calpha_1%5E%7Bh%7DX_t%29X_t%5D+-+%5Cmu%5E2%5C%5C+%3DE%5B%28a%5Cfrac%7B1-%5Calpha_1%5Eh%7D%7B1-%5Calpha_1%7D+%2B+%5Calpha_1%5EhX_t%29X_t%5D+-+%5Cmu%5E2%5C%5C+%3D%5Cfrac%7Ba%7D%7B1-%5Calpha_1%7D%281-%5Calpha_1%29%5EhE%28X_t%29+%2B+%5Calpha_1%5EhE%28X_2%29+-+%5Cmu%5E2%5C%5C+%3D%5Cmu%5E2%281-%281-%5Ctheta%29%5Eh%29+%2B+%5Cfrac%7B%281-%5Ctheta%29%5Eh%7D%7B2%5Ctheta+-+%5Ctheta%5E2%7D%5Csigma%5E2-+%5Cmu%5E2%5C%5C+%3D%281-%5Ctheta%29%5Eh%28%5Cfrac%7B%5Csigma%5E2%7D%7B2%5Ctheta-%5Ctheta%5E2%7D+-+%5Cmu%5E2%29" alt="Cov(X_t,X_{t-h})=E[X_t-E(X_t)][(X_{t-h} - E(X_{t-h}))]\\ =E(X_tX_{t-h}) - \mu E(X_t + X_{t-h}) + \mu^2\\ =E[(\alpha_0 + bX_{t+h-1})X_t] - 2\mu^2 + \mu^2\\ =E[(\alpha_0 + ab + \alpha_1^2X_{t-h-2})X_t] - \mu^2\\ =...\\ =E[(\alpha_0 + ab + ab^2 + ab^3 + ... + ab^{h-1} + \alpha_1^{h}X_t)X_t] - \mu^2\\ =E[(a\frac{1-\alpha_1^h}{1-\alpha_1} + \alpha_1^hX_t)X_t] - \mu^2\\ =\frac{a}{1-\alpha_1}(1-\alpha_1)^hE(X_t) + \alpha_1^hE(X_2) - \mu^2\\ =\mu^2(1-(1-\theta)^h) + \frac{(1-\theta)^h}{2\theta - \theta^2}\sigma^2- \mu^2\\ =(1-\theta)^h(\frac{\sigma^2}{2\theta-\theta^2} - \mu^2)" eeimg="1"/> </p>