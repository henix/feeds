<div class="title-image"><img src="https://pic4.zhimg.com/eb9bbdc659478c8a68c35078c05aa503_b.jpg" alt=""></div><p><b>导语: 本文结合CAPM和APT模型的思路，通过CAPM模型计算股票收益的α，再通过</b><a class=" wrap external" href="https://link.zhihu.com/?target=https%3A//www.joinquant.com/post/1474%3Ff%3Dzh" target="_blank" rel="nofollow noreferrer">《多因子策略-APT模型》</a><b>一文中的方法分析多因子对α的影响，并以此为标准进行选股。</b></p><p>阅读本文前请掌握：</p><p>基本金融概念。<br/><a class=" wrap external" href="https://link.zhihu.com/?target=https%3A//www.joinquant.com/post/1786%3Ff%3Dzh" target="_blank" rel="nofollow noreferrer">线性回归模型</a>，理解深度level-0<br/><a class=" wrap external" href="https://link.zhihu.com/?target=https%3A//www.joinquant.com/post/1474%3Ff%3Dzh" target="_blank" rel="nofollow noreferrer">APT模型</a>，理解深度level-0<br/>CAPM模型，理解深度level-0</p><h4><b>CAPM模型概述</b></h4><p>大部分投资者都是风险厌恶型的，也就是说，对于高风险的股票，投资者要求的期望收益率会更加高。分散投资组合可以分散风险。但有一些风险是不能被分散的，比如市场风险、国家风险等。</p><p>美国学者夏普、林特尔、特里诺和莫辛等人于1964年在资产组合理论的基础上发展出来了一个资本资产定价模型（简称CAPM模型）。这个模型根据股票本身的风险和市场风险的相关性估算出单个股票的期望收益率。</p><p>市场的风险通常用大盘指数的波动率来衡量（波动即风险），由于风险的存在，大盘期望的收益率rM要比无风险利率rf要高一些，其超额收益率（作为对风险的补偿）记为RM=rM−rf，对于单个股票，采用类似的方法，记为Ri=ri−rf，那么，第i个股票的预期收益率记为</p><figure><noscript><img data-rawheight="58" data-rawwidth="191" src="https://pic3.zhimg.com/b5a2eeed1068e162720fc13e483e3856_b.png" class="content_image" width="191"/></noscript><img data-rawheight="58" data-rawwidth="191" src="https://pic3.zhimg.com/b5a2eeed1068e162720fc13e483e3856_b.png" class="content_image lazy" width="191" data-actualsrc="https://pic3.zhimg.com/b5a2eeed1068e162720fc13e483e3856_b.png"/></figure><p><br/>或者更常见地，写成</p><p><figure><noscript><img data-rawheight="41" data-rawwidth="297" src="https://pic2.zhimg.com/4a4dd952501e49f30e730680f919ab41_b.png" class="content_image" width="297"/></noscript><img data-rawheight="41" data-rawwidth="297" src="https://pic2.zhimg.com/4a4dd952501e49f30e730680f919ab41_b.png" class="content_image lazy" width="297" data-actualsrc="https://pic2.zhimg.com/4a4dd952501e49f30e730680f919ab41_b.png"/></figure><br/>用图像来表示就是<br/></p><figure><noscript><img data-rawheight="334" data-rawwidth="536" src="https://pic3.zhimg.com/6840955d19723c03e08bd1914d8515c6_b.png" class="origin_image zh-lightbox-thumb" width="536" data-original="https://pic3.zhimg.com/6840955d19723c03e08bd1914d8515c6_r.jpg"/></noscript><img data-rawheight="334" data-rawwidth="536" src="https://pic3.zhimg.com/6840955d19723c03e08bd1914d8515c6_b.png" class="origin_image zh-lightbox-thumb lazy" width="536" data-original="https://pic3.zhimg.com/6840955d19723c03e08bd1914d8515c6_r.jpg" data-actualsrc="https://pic3.zhimg.com/6840955d19723c03e08bd1914d8515c6_b.png"/></figure>由上图可知，在β=0的时候，为无风险收益，没有市场风险，也没有超额收益。β越大，超额收益也越大，资产风险和市场风险的相关程度也随之升高。作为补偿的期望超额收益也越大。<br/>不完美的CAPM<br/>但是，CAPM模型是不是完美的呢？显然不是，CAPM首先就假设了市场风险是唯一风险因子。但在现实中，仅仅由市场风险是不足以解释资产回报的，因此，人们对CAPM做了改进，认为资产的收益率中的一部分是资产内秉特性，记为α，那么有<br/><figure><noscript><img data-rawheight="57" data-rawwidth="373" src="https://pic2.zhimg.com/ae8aee87786686613e5d3339f77a2031_b.png" class="content_image" width="373"/></noscript><img data-rawheight="57" data-rawwidth="373" src="https://pic2.zhimg.com/ae8aee87786686613e5d3339f77a2031_b.png" class="content_image lazy" width="373" data-actualsrc="https://pic2.zhimg.com/ae8aee87786686613e5d3339f77a2031_b.png"/></figure>或者等价于<br/><figure><noscript><img data-rawheight="54" data-rawwidth="361" src="https://pic1.zhimg.com/5f8e33878e59a1044f30123ed509fa8c_b.png" class="content_image" width="361"/></noscript><img data-rawheight="54" data-rawwidth="361" src="https://pic1.zhimg.com/5f8e33878e59a1044f30123ed509fa8c_b.png" class="content_image lazy" width="361" data-actualsrc="https://pic1.zhimg.com/5f8e33878e59a1044f30123ed509fa8c_b.png"/></figure><br/>再次强调一下。CAPM模型本身是没有alpha的，我们引入这个αi目的是要把股票的收益率归结为两个方面，一个是大盘的因素，用beta系数表示，一个是个股的因素，用α表示。比如广为人知的市值因素，动量因素，各种财务因素，等等。<br/>CAPM+APT选股应用<br/>根据上文，我们有：<br/><figure><noscript><img data-rawheight="50" data-rawwidth="338" src="https://pic3.zhimg.com/6f3d5faad8b0372162371f241884e30e_b.png" class="content_image" width="338"/></noscript><img data-rawheight="50" data-rawwidth="338" src="https://pic3.zhimg.com/6f3d5faad8b0372162371f241884e30e_b.png" class="content_image lazy" width="338" data-actualsrc="https://pic3.zhimg.com/6f3d5faad8b0372162371f241884e30e_b.png"/></figure><br/>这个公式把单一资产的收益率分解成三部分：无风险收益率rfrf，与整体市场相关的部分βi(rM−rf)，以及个股内秉因素αi<p>这个αi怎么刻画呢？还请大家回顾一下量化课堂文章《多因子策略-APT模型》，同那篇文章的思想，我们有相信α与公司的财务指标密切相关，故我们可以通过历史的财务指标和历史α进行线性回归，并用计算出的回归系数结合当期的财务指标预测下一期的α。</p><p>下面的图来自于APT模型的原文，我们要把过去几个时期的财务数据和α值进行统计和回归分析。</p><figure><noscript><img data-rawheight="315" data-rawwidth="1298" src="https://pic2.zhimg.com/14171da9bc88f3049907e28e82748ba1_b.png" class="origin_image zh-lightbox-thumb" width="1298" data-original="https://pic2.zhimg.com/14171da9bc88f3049907e28e82748ba1_r.jpg"/></noscript><img data-rawheight="315" data-rawwidth="1298" src="https://pic2.zhimg.com/14171da9bc88f3049907e28e82748ba1_b.png" class="origin_image zh-lightbox-thumb lazy" width="1298" data-original="https://pic2.zhimg.com/14171da9bc88f3049907e28e82748ba1_r.jpg" data-actualsrc="https://pic2.zhimg.com/14171da9bc88f3049907e28e82748ba1_b.png"/></figure><p>和上篇文章的方法类似，对于单只股票 i 的所有财务因子，t1日的因子值和t1~today期间的超额收益αi1组成了一组观测值；t2日的因子值和t2~t1时期的超额收益αi2组成了一组观测值；一直到t4日的因子值和t4~t3时期的超额收益αi4组成了一组观测值。</p><p>我们取N支股票，按照财报周期向前获取4期的财务因子和期间内的α，以此获得4N组观测值，数据结构如下。</p><figure><noscript><img data-rawheight="530" data-rawwidth="1035" src="https://pic2.zhimg.com/dbf2eadb45d68b414b94438f36e521a1_b.png" class="origin_image zh-lightbox-thumb" width="1035" data-original="https://pic2.zhimg.com/dbf2eadb45d68b414b94438f36e521a1_r.jpg"/></noscript><img data-rawheight="530" data-rawwidth="1035" src="https://pic2.zhimg.com/dbf2eadb45d68b414b94438f36e521a1_b.png" class="origin_image zh-lightbox-thumb lazy" width="1035" data-original="https://pic2.zhimg.com/dbf2eadb45d68b414b94438f36e521a1_r.jpg" data-actualsrc="https://pic2.zhimg.com/dbf2eadb45d68b414b94438f36e521a1_b.png"/></figure><br/><p>我们实际选取的财务因子有：市盈率、扣除非经常损益后的净利润、净资产收益率等九个指标，具体的因子选取方法请参见APT模型的文章。</p><p>我们将获取的数据组放入回归模型进行线性回归计算。如果用F1,F2,…,Fn表示我们考虑的因子的话，回归的模型就是</p><br/><figure><noscript><img data-rawheight="58" data-rawwidth="378" src="https://pic3.zhimg.com/63fef31e022b8113f90446866ec4437e_b.png" class="content_image" width="378"/></noscript><img data-rawheight="58" data-rawwidth="378" src="https://pic3.zhimg.com/63fef31e022b8113f90446866ec4437e_b.png" class="content_image lazy" width="378" data-actualsrc="https://pic3.zhimg.com/63fef31e022b8113f90446866ec4437e_b.png"/></figure><br/>我们估算出回归系数b1,b2,…,bn。在这之后，我们可以将现期的财务因子和计算出的回归系数，代入上面线性函数计算出未来一段时间的α的预估，并调仓持有α预估值最高的股票。<br/><h4><b>策略和回测</b></h4><p>我们构建策略如下：<br/>第一步：根据CAPM模型计算得到股票池中每只股票对应财报季度的α值。<br/>第二步：将对应季度的财报因子数据和α值进行多元线性回归<br/>第三步：利用第二步中得到的回归参数对下一期的股票α值进行预测<br/>第四步：将所得的预期α值进行排序，选择N支α最大的股票（若不足N支α大于0，则取所有α大于0的股票），并且将资产平均配置到股票组合中</p><p>在实际操作中，可以通过买入预期alpha&gt;0的股票组合卖空沪深300指数进行操作。实现的方法只需要在聚宽社区的回测方法的基础上把日均收益率换成同期的alpha观测值就行了。</p><p>如下图所示，使用股票池为沪深300，股票数量N=0，回测周期是2006-01-01到2016-06-06，策略收益率是545.56%。</p><figure><noscript><img data-rawheight="317" data-rawwidth="1303" src="https://pic3.zhimg.com/5d60d55858a60591b6025f7d2d5076ce_b.png" class="origin_image zh-lightbox-thumb" width="1303" data-original="https://pic3.zhimg.com/5d60d55858a60591b6025f7d2d5076ce_r.jpg"/></noscript><img data-rawheight="317" data-rawwidth="1303" src="https://pic3.zhimg.com/5d60d55858a60591b6025f7d2d5076ce_b.png" class="origin_image zh-lightbox-thumb lazy" width="1303" data-original="https://pic3.zhimg.com/5d60d55858a60591b6025f7d2d5076ce_r.jpg" data-actualsrc="https://pic3.zhimg.com/5d60d55858a60591b6025f7d2d5076ce_b.png"/></figure><p>从这个图中我们可以看出，策略的收益率总体上比大盘略高，在最近一两年尤为明显，因此如果结合对冲的策略，收益应该会更好。</p><p>这里使用策略净值/大盘净值的方法来描述超额收益率：</p><p>这进一步证实了之前的猜想，这个策略总体上08年以后就有效了，在牛市期间表现比较好，但是在熊市的时候还是会略有回撤。也许有的读者注意到了，虽然看似15年以后超额收益率回撤挺大，但这是由于比例尺放大了造成的。因为在你资产价值已经是开始的好几倍的情况下，而沪深300指数期货只使用原来资产价值对应的仓位进行对冲，当然对冲效果不好了。<br/>解决这个问题的一个方法是动态调仓。就是根据当前的资产价值来更新沪深300指数对冲的仓位，还请读者期待股指期货的回测上线。<br/></p><h4><b>函数和变量说明书</b></h4><p>函数说明书：</p><p><figure><noscript><img data-rawheight="551" data-rawwidth="1318" src="https://pic1.zhimg.com/f9d39f9421ea0f3e9c7746f1d874cf2c_b.png" class="origin_image zh-lightbox-thumb" width="1318" data-original="https://pic1.zhimg.com/f9d39f9421ea0f3e9c7746f1d874cf2c_r.jpg"/></noscript><img data-rawheight="551" data-rawwidth="1318" src="https://pic1.zhimg.com/f9d39f9421ea0f3e9c7746f1d874cf2c_b.png" class="origin_image zh-lightbox-thumb lazy" width="1318" data-original="https://pic1.zhimg.com/f9d39f9421ea0f3e9c7746f1d874cf2c_r.jpg" data-actualsrc="https://pic1.zhimg.com/f9d39f9421ea0f3e9c7746f1d874cf2c_b.png"/></figure>变量说明书：</p><figure><noscript><img data-rawheight="750" data-rawwidth="1083" src="https://pic3.zhimg.com/22fa51ec338273bf3c0828a9027c8eae_b.png" class="origin_image zh-lightbox-thumb" width="1083" data-original="https://pic3.zhimg.com/22fa51ec338273bf3c0828a9027c8eae_r.jpg"/></noscript><img data-rawheight="750" data-rawwidth="1083" src="https://pic3.zhimg.com/22fa51ec338273bf3c0828a9027c8eae_b.png" class="origin_image zh-lightbox-thumb lazy" width="1083" data-original="https://pic3.zhimg.com/22fa51ec338273bf3c0828a9027c8eae_r.jpg" data-actualsrc="https://pic3.zhimg.com/22fa51ec338273bf3c0828a9027c8eae_b.png"/></figure><p>到JoinQuant查看代码并与作者交流讨论：<a class=" wrap external" href="https://link.zhihu.com/?target=https%3A//www.joinquant.com/post/1955%3Ff%3Dzh" target="_blank" rel="nofollow noreferrer">【量化课堂】CAPM+APT多因子模型</a></p>