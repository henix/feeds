<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>内存碎片的一些必备知识</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/20144784">原文</a></p>
对应用程序来说，内存碎片与操作系统无关，因为操作系统提供的内存分配函数（如HeapAlloc）只能用来分配大块内存。小块内存只能靠用户级的内存分配器（如malloc）。而内存碎片的罪魁祸首就是小块内存的频繁分配。<br><br>对付内存碎片有三种办法：<br>1. 不要动态分配内存，尽量使用栈。<br>2. 根据使用场景定制内存分配策略。比如如果你发现你常常分配同一种大小的数据结构，那么就一次分配一个数组从里面挨个取，用完了扔回旁视列表里以备重用。再如你发现内存分配具有周期性，那么你可以周期性的分配大块内存，用完了释放整块内存。<br>3. 不手动管理内存，改用具有分代内存管理、增量垃圾收集和内存整理功能的垃圾收集器。比如你要是用了Java，那么你就再也不用操心内存碎片了（代价是你的程序占用的内存会比用C语言时翻几倍）。
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
