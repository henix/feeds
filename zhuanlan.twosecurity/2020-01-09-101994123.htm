<div class="title-image"><img src="https://pic2.zhimg.com/v2-8eec1bba32fd0da619e3282f391992b4_b.jpg" alt=""></div><h2>CanHackMe🎯</h2><p>一个基于 php 的 CTF 开源平台。</p><p>官网：<a href="https://link.zhihu.com/?target=https%3A//canhack.me/" class=" wrap external" target="_blank" rel="nofollow noreferrer">ht</a>tps://canhack.me/</p><p>项目地址：<a href="https://link.zhihu.com/?target=https%3A//github.com/safflower/canhackme" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">https://</span><span class="visible">github.com/safflower/ca</span><span class="invisible">nhackme</span><span class="ellipsis"></span></a></p><h2>搭建环境📐</h2><p><b>环境（Ubuntu 16.04+Apache 2.4+PHP 7.3）</b></p><p><b>安装 Apache 2.4</b></p><p>命令：</p><div class="highlight"><pre><code class="language-text">sudo apt update
sudo apt install apache2</code></pre></div><p>然后检查是否成功：</p><div class="highlight"><pre><code class="language-text">apache2 -v</code></pre></div><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-3715489f4a091937442405ef8bab17df_b.jpg" data-caption="" data-size="normal" data-rawwidth="444" data-rawheight="89" class="origin_image zh-lightbox-thumb" width="444" data-original="https://pic4.zhimg.com/v2-3715489f4a091937442405ef8bab17df_r.jpg"/></noscript><img src="https://pic4.zhimg.com/v2-3715489f4a091937442405ef8bab17df_b.jpg" data-caption="" data-size="normal" data-rawwidth="444" data-rawheight="89" class="origin_image zh-lightbox-thumb lazy" width="444" data-original="https://pic4.zhimg.com/v2-3715489f4a091937442405ef8bab17df_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-3715489f4a091937442405ef8bab17df_b.jpg"/></figure><p><b>安装 PHP 7.3</b></p><p>命令：</p><div class="highlight"><pre><code class="language-text">sudo apt-get install software-properties-common
sudo add-apt-repository ppa:ondrej/php
sudo apt-get update
sudo apt-get install -y php7.3</code></pre></div><p>检查是否成功：</p><div class="highlight"><pre><code class="language-text">php -v</code></pre></div><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-0614cbe2c15f07977b1385af62d47e3d_b.jpg" data-caption="" data-size="normal" data-rawwidth="1053" data-rawheight="142" class="origin_image zh-lightbox-thumb" width="1053" data-original="https://pic2.zhimg.com/v2-0614cbe2c15f07977b1385af62d47e3d_r.jpg"/></noscript><img src="https://pic2.zhimg.com/v2-0614cbe2c15f07977b1385af62d47e3d_b.jpg" data-caption="" data-size="normal" data-rawwidth="1053" data-rawheight="142" class="origin_image zh-lightbox-thumb lazy" width="1053" data-original="https://pic2.zhimg.com/v2-0614cbe2c15f07977b1385af62d47e3d_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-0614cbe2c15f07977b1385af62d47e3d_b.jpg"/></figure><p><b>安装 Sqlite3</b></p><div class="highlight"><pre><code class="language-text">sudo apt install sqlite3</code></pre></div><blockquote>SQLite 是一个软件库，实现了自给自足的、无服务器的、零配置的、事务性的 SQL 数据库引擎。SQLite 是在世界上最广泛部署的 SQL 数据库引擎。SQLite 源代码不受版权限制。</blockquote><p><b>安装 php-sqlite3 模块</b></p><p>命令：</p><div class="highlight"><pre><code class="language-text">sudo apt install php7.3-sqlite3</code></pre></div><p>这里需要注意，要修改 php.ini 文件 /etc/php/7.3/apache2/php.ini，把前面的分号去掉</p><div class="highlight"><pre><code class="language-text">extension=sqlite3</code></pre></div><p><b>安装 php-mbstring 模块</b></p><div class="highlight"><pre><code class="language-text">sudo apt install php-mbstring</code></pre></div><p>同样的，需要修改 php.ini 文件 /etc/php/7.3/apache2/php.ini，把前面的分号去掉</p><div class="highlight"><pre><code class="language-text">extension=mbstring</code></pre></div><h2>项目搭建</h2><p><b>下载</b></p><p>先下载项目，直接下载上传：</p><p>下载地址：<a href="https://link.zhihu.com/?target=https%3A//github.com/safflower/canhackme" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">https://</span><span class="visible">github.com/safflower/ca</span><span class="invisible">nhackme</span><span class="ellipsis"></span></a></p><p>git 方式下载：</p><div class="highlight"><pre><code class="language-text">git clone https://github.com/safflower/canhackme</code></pre></div><p><b>配置路由</b></p><p>先配置路由，修改 apache2 配置文件</p><div class="highlight"><pre><code class="language-text">vim /etc/apache2/apache2.conf</code></pre></div><p>把路径改成你实际的网站根目录，AllowOverride None 改为 AllowOverride ALL</p><div class="highlight"><pre><code class="language-text">&lt;Directory /var/www/html&gt;
        Options Indexes FollowSymLinks
        AllowOverride ALL
        Require all granted
&lt;/Directory&gt;</code></pre></div><p><b>开启 mod_rewrite 模块</b></p><p>命令：</p><div class="highlight"><pre><code class="language-text">sudo a2enmod rewrite</code></pre></div><p>然后重启 apache2</p><div class="highlight"><pre><code class="language-text">service apache2 restart</code></pre></div><p><b>导入 .sql 数据库文件</b></p><p>进入到 @import/confs/ 目录下，导入 init.sql 文件到 sqlite3</p><div class="highlight"><pre><code class="language-text">sqlite3 .common.db &lt; init.sql
root@linuz:/var/www/html/@import/confs# sqlite3 .common.db
SQLite version 3.11.0 2016-02-15 17:29:24
Enter &#34;.help&#34; for usage hints.
sqlite&gt; .dump
PRAGMA foreign_keys=OFF;
BEGIN TRANSACTION;
CREATE TABLE `users` (
        `user_no` INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
        `user_name` TEXT NOT NULL UNIQUE,
        `user_email` TEXT NOT NULL UNIQUE,
        `user_password` TEXT NOT NULL,
        `user_comment` TEXT NOT NULL,
        `user_score` INTEGER NOT NULL,
        `user_signed_up_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP
);
......
sqlite&gt; .exit</code></pre></div><p>然后更改 confs 目录权限为 www-data</p><div class="highlight"><pre><code class="language-text">sudo chown -R www-data:www-data confs/</code></pre></div><p><b>设置 recaptcha</b></p><p>recaptcha 地址：<a href="https://link.zhihu.com/?target=https%3A//www.google.com/recaptcha" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">https://www.</span><span class="visible">google.com/recaptcha</span><span class="invisible"></span></a></p><p>在上面注册你的平台网站（选择 recaptcha 第3版）</p><figure data-size="small"><noscript><img src="https://pic1.zhimg.com/v2-6e504dd8151d5921a780114ea4369bd4_b.jpg" data-caption="" data-size="small" data-rawwidth="939" data-rawheight="1174" class="origin_image zh-lightbox-thumb" width="939" data-original="https://pic1.zhimg.com/v2-6e504dd8151d5921a780114ea4369bd4_r.jpg"/></noscript><img src="https://pic1.zhimg.com/v2-6e504dd8151d5921a780114ea4369bd4_b.jpg" data-caption="" data-size="small" data-rawwidth="939" data-rawheight="1174" class="origin_image zh-lightbox-thumb lazy" width="939" data-original="https://pic1.zhimg.com/v2-6e504dd8151d5921a780114ea4369bd4_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-6e504dd8151d5921a780114ea4369bd4_b.jpg"/></figure><p>然后获取秘钥：</p><figure data-size="small"><noscript><img src="https://pic1.zhimg.com/v2-d5b745c9c61a55ee1963cb58be17bf50_b.jpg" data-caption="" data-size="small" data-rawwidth="1409" data-rawheight="667" class="origin_image zh-lightbox-thumb" width="1409" data-original="https://pic1.zhimg.com/v2-d5b745c9c61a55ee1963cb58be17bf50_r.jpg"/></noscript><img src="https://pic1.zhimg.com/v2-d5b745c9c61a55ee1963cb58be17bf50_b.jpg" data-caption="" data-size="small" data-rawwidth="1409" data-rawheight="667" class="origin_image zh-lightbox-thumb lazy" width="1409" data-original="https://pic1.zhimg.com/v2-d5b745c9c61a55ee1963cb58be17bf50_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-d5b745c9c61a55ee1963cb58be17bf50_b.jpg"/></figure><p>在平台的配置文件common.php里面，修改一些网站的基本信息，包括网站URL、作者信息等</p><figure data-size="small"><noscript><img src="https://pic1.zhimg.com/v2-847438c2653cca3548f01d1b0f557c50_b.jpg" data-caption="" data-size="small" data-rawwidth="858" data-rawheight="685" class="origin_image zh-lightbox-thumb" width="858" data-original="https://pic1.zhimg.com/v2-847438c2653cca3548f01d1b0f557c50_r.jpg"/></noscript><img src="https://pic1.zhimg.com/v2-847438c2653cca3548f01d1b0f557c50_b.jpg" data-caption="" data-size="small" data-rawwidth="858" data-rawheight="685" class="origin_image zh-lightbox-thumb lazy" width="858" data-original="https://pic1.zhimg.com/v2-847438c2653cca3548f01d1b0f557c50_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-847438c2653cca3548f01d1b0f557c50_b.jpg"/></figure><p><b>更换秘钥</b></p><p>第一个密钥替换 common.php 文件里的 recaptcha_sitekey 内容</p><p>第二个密钥编辑成 .recaptcha_secretkey.txt 文件，放到 @import/confs 路径下</p><h2>创建题目</h2><p>平台没有后台，所以只能直接访问 sqlite3 数据库添加题目</p><p>添加题目命令：</p><div class="highlight"><pre><code class="language-text">sqlite&gt; INSERT INTO &#34;chals&#34; VALUES(1,&#39;name&#39;,&#39;title&#39;,&#39;contents&#39;,100,&#39;CanHackMe{xxxxxxxxxxxx}&#39;,&#39;web&#39;,&#39;1&#39;,&#39;2019-09-12&#39;);</code></pre></div><p>查看题目：</p><figure data-size="small"><noscript><img src="https://pic1.zhimg.com/v2-389c954a050d187e4eaa68318159c578_b.jpg" data-caption="" data-size="small" data-rawwidth="1602" data-rawheight="663" class="origin_image zh-lightbox-thumb" width="1602" data-original="https://pic1.zhimg.com/v2-389c954a050d187e4eaa68318159c578_r.jpg"/></noscript><img src="https://pic1.zhimg.com/v2-389c954a050d187e4eaa68318159c578_b.jpg" data-caption="" data-size="small" data-rawwidth="1602" data-rawheight="663" class="origin_image zh-lightbox-thumb lazy" width="1602" data-original="https://pic1.zhimg.com/v2-389c954a050d187e4eaa68318159c578_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-389c954a050d187e4eaa68318159c578_b.jpg"/></figure><p>发送公告：</p><div class="highlight"><pre><code class="language-text">sqlite&gt; INSERT INTO &#34;notis&#34; VALUES(1,&#39;xxx&#39;,1,&#39;2020-01-09&#39;);</code></pre></div><figure data-size="small"><noscript><img src="https://pic1.zhimg.com/v2-cc79cf771cf800bbed34d235ef819458_b.jpg" data-caption="" data-size="small" data-rawwidth="1319" data-rawheight="398" class="origin_image zh-lightbox-thumb" width="1319" data-original="https://pic1.zhimg.com/v2-cc79cf771cf800bbed34d235ef819458_r.jpg"/></noscript><img src="https://pic1.zhimg.com/v2-cc79cf771cf800bbed34d235ef819458_b.jpg" data-caption="" data-size="small" data-rawwidth="1319" data-rawheight="398" class="origin_image zh-lightbox-thumb lazy" width="1319" data-original="https://pic1.zhimg.com/v2-cc79cf771cf800bbed34d235ef819458_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-cc79cf771cf800bbed34d235ef819458_b.jpg"/></figure><p><b>设置 flag</b></p><p>flag 的默认的格式为 CanHackMe{...} 且长度不小于 10 位数，可以在 init.php 文件中修改。</p><p>把 CanHackMe 修改成你想要的格式：</p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-a4d5e1c9ffd744591355f70842c3498e_b.jpg" data-caption="" data-size="normal" data-rawwidth="1001" data-rawheight="76" class="origin_image zh-lightbox-thumb" width="1001" data-original="https://pic3.zhimg.com/v2-a4d5e1c9ffd744591355f70842c3498e_r.jpg"/></noscript><img src="https://pic3.zhimg.com/v2-a4d5e1c9ffd744591355f70842c3498e_b.jpg" data-caption="" data-size="normal" data-rawwidth="1001" data-rawheight="76" class="origin_image zh-lightbox-thumb lazy" width="1001" data-original="https://pic3.zhimg.com/v2-a4d5e1c9ffd744591355f70842c3498e_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-a4d5e1c9ffd744591355f70842c3498e_b.jpg"/></figure><h2>PS：</h2><p><a href="https://link.zhihu.com/?target=https%3A//www.baidu.com/link%3Furl%3DOcGTJIGtwpNYrGru7tSszpEf10ZQ0xIE7SvER9ejNcCar00KI-fG2lu214M4WKPc%26wd%3D%26eqid%3Da24dabb2002f492b000000065e13d46a" class=" wrap external" target="_blank" rel="nofollow noreferrer">二向箔安全</a>的网络安全技能包更新了！无需登录、无需扫描，只需点击下方链接即可畅玩技能包。（CISP-PTE 技能包、CTF 技能包即将上线，敬请关注！）</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-41a1365ee0d9566c882af75894478f08_b.jpg" data-caption="" data-size="normal" data-rawwidth="2560" data-rawheight="1192" class="origin_image zh-lightbox-thumb" width="2560" data-original="https://pic1.zhimg.com/v2-41a1365ee0d9566c882af75894478f08_r.jpg"/></noscript><img src="https://pic1.zhimg.com/v2-41a1365ee0d9566c882af75894478f08_b.jpg" data-caption="" data-size="normal" data-rawwidth="2560" data-rawheight="1192" class="origin_image zh-lightbox-thumb lazy" width="2560" data-original="https://pic1.zhimg.com/v2-41a1365ee0d9566c882af75894478f08_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-41a1365ee0d9566c882af75894478f08_b.jpg"/></figure><a href="https://link.zhihu.com/?target=https%3A//lelge.exeye.run/skill_library_o" data-draft-node="block" data-draft-type="link-card" class=" wrap external" target="_blank" rel="nofollow noreferrer">新手入门 | 梦境穿越 - 主题技能包</a><p>更多有关渗透测试的内容请前往<a href="https://link.zhihu.com/?target=https%3A//www.baidu.com/link%3Furl%3DOcGTJIGtwpNYrGru7tSszpEf10ZQ0xIE7SvER9ejNcCar00KI-fG2lu214M4WKPc%26wd%3D%26eqid%3Da24dabb2002f492b000000065e13d46a" class=" wrap external" target="_blank" rel="nofollow noreferrer">二向箔安全</a>进行学习，最近推出了“挖洞”班，想了解更多资讯的，可咨询客服微信 <b>twosecurity02</b></p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-2222e29c6decda168e1be1f049d93ccf_b.jpg" data-caption="" data-size="normal" data-rawwidth="3041" data-rawheight="2000" class="origin_image zh-lightbox-thumb" width="3041" data-original="https://pic4.zhimg.com/v2-2222e29c6decda168e1be1f049d93ccf_r.jpg"/></noscript><img src="https://pic4.zhimg.com/v2-2222e29c6decda168e1be1f049d93ccf_b.jpg" data-caption="" data-size="normal" data-rawwidth="3041" data-rawheight="2000" class="origin_image zh-lightbox-thumb lazy" width="3041" data-original="https://pic4.zhimg.com/v2-2222e29c6decda168e1be1f049d93ccf_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-2222e29c6decda168e1be1f049d93ccf_b.jpg"/></figure>