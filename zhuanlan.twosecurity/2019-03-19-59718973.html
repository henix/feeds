<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>国内外最新漏洞分析之 Burpsuite “权限提升”攻击</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/59718973">原文</a></p>
<div class="title-image"><img src="https://pic1.zhimg.com/v2-369b0b6d80af80b9ff25a669ea90764a_b.jpg" alt=""></div><p>Burpsuite 作为集成平台，包含了多种工具，其可用于攻击web应用程序，因此在web安全领域，一直被行业人士广泛使用。最近的一个公开报告中指出，Burpsuite出现了一个新的漏洞，即低权限的用户可利用不存在的路径来进行权限升级，从而对Burpsuit进行恶意攻击。让我们来看一下，这个漏洞究竟是如何产生的。</p><p>漏洞模拟步骤（Pro版本测试）：</p><p>1、首先，以低权限的账号登入系统，且该系统已安装了Burpsuite软件。（如下图所示）</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-f446cd20ba11ca22385e86bcf82dbb48_b.png" data-caption="" data-size="normal" data-rawwidth="263" data-rawheight="288" class="content_image" width="263"></noscript><img src="https://pic1.zhimg.com/v2-f446cd20ba11ca22385e86bcf82dbb48_b.png" data-caption="" data-size="normal" data-rawwidth="263" data-rawheight="288" class="content_image lazy" width="263" data-actualsrc="https://pic1.zhimg.com/v2-f446cd20ba11ca22385e86bcf82dbb48_b.png"></figure><p>2、之后，在C:\Program%20Files下创建递归目录，如下图所示：</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-90ff65cae7a1b91ad4819331707c63bd_b.png" data-caption="" data-size="normal" data-rawwidth="297" data-rawheight="183" class="content_image" width="297"></noscript><img src="https://pic2.zhimg.com/v2-90ff65cae7a1b91ad4819331707c63bd_b.png" data-caption="" data-size="normal" data-rawwidth="297" data-rawheight="183" class="content_image lazy" width="297" data-actualsrc="https://pic2.zhimg.com/v2-90ff65cae7a1b91ad4819331707c63bd_b.png"></figure><p>3、然后在最底层目录中，复制一个名为“sunec.dll”的dll文件。</p><p>4、最后，登录进入“特权账号”，并运行Burpsuite软件，即会出现如下消息。</p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-f5a9c5a55166ec67232e514fdd6fe652_b.png" data-caption="" data-size="normal" data-rawwidth="260" data-rawheight="132" class="content_image" width="260"></noscript><img src="https://pic3.zhimg.com/v2-f5a9c5a55166ec67232e514fdd6fe652_b.png" data-caption="" data-size="normal" data-rawwidth="260" data-rawheight="132" class="content_image lazy" width="260" data-actualsrc="https://pic3.zhimg.com/v2-f5a9c5a55166ec67232e514fdd6fe652_b.png"></figure><p>通过上述步骤以及最后的结果来看，我们可以发现，“特权用户”在运行Burpsuite的时候，执行了原低权限用户所留下来的dll文件，而该权限本不应该是低权限用户所具备的。这也就意味着，如果该低权限用户存在恶意攻击行为，其可以通过上述步骤，来进行“越权攻击”，从而威胁系统的信息安全。</p><p>已知漏洞产生的方式，那么漏洞产生的原因又在哪里呢？这是由于，Burpsuite在运行过程中，它会去尝试在C:\Program%20Files路径下加载一些dll文件。由于文件夹本身并不存在，且可以由低权限用户来进行创建。在这给个加载过程中，也就产生了漏洞。</p><p>即低权限用户在该系统下，可以在路径C:\Program%20Files下创建递归文件夹，并且在文件夹中放入带有目的性的dll文件，这也就埋下了“伏笔”。当“特权用户”运行Burpsuite之时，也就会顺带运行低权限用户留下的dll文件。</p><p>我们可以把低权限的用户比作“杜鹃”，它自己不会孵蛋，就把蛋产在其他鸟类的巢中，让其帮助“义务”孵化。这种“杜鹃”式的攻击，存在明显的越权行为，确实是Burpsuite的漏洞之一。</p><p>在报告公开之前，工作人员已经对该漏洞已经进行了修补，不过在工作人员看来，这并不是安全问题，只是一个普通的错误罢了，因为Burpsuite本身就无法在已被侵入的系统上安全的运行，即其无法防范已经存在的本地恶意用户。</p><p>换句话说，是否可以认为，过来下蛋的杜鹃，本身就有家里的钥匙，并且是主人亲自给他的。门本身的质量没有问题，它只是无法识别是谁开的门，让原本不能开门的人把门打开了。而现在，这个问题也得到了解决。</p>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
</body>
</html>
