<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>汉诺塔杂谈（六）——变体之“循环移动”</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/36124436">原文</a></p>
<div class="title-image"><img src="https://pic3.zhimg.com/v2-0526c4c14869c7ff79bb6efd32e77b9d_r.jpg" alt=""></div><p>（抱歉更新速度很慢，因为学生的毕业季有很多事情要处理。）</p><p>所谓“循环移动” 就是在原始的汉诺塔问题（参看“<a href="http://zhuanlan.zhihu.com/p/36075202">汉诺塔杂谈（一）</a>”）上增加一个要求：</p><p>设A柱、B柱、C柱（及A柱）构成一个顺时针方向的三角形，</p><img src="https://pic4.zhimg.com/v2-6a9f4cb7f4ce28b6f69ec9e9a5e5ecc8_r.jpg" data-caption="" data-size="normal" data-rawwidth="489" data-rawheight="488" data-watermark="watermark" data-original-src="v2-6a9f4cb7f4ce28b6f69ec9e9a5e5ecc8" data-watermark-src="v2-aab6711aa2ae182ac9b4399572636321" data-private-watermark-src=""><p>所有的移动<b>必须</b>是顺时针方向，即只能：或从A柱到B柱；或从B柱到C柱；或从C柱到A柱（如下图所示）。</p><img src="https://pic1.zhimg.com/v2-db5228c95b545529e80cc12221708662_r.jpg" data-caption="" data-size="normal" data-rawwidth="791" data-rawheight="326" data-watermark="watermark" data-original-src="v2-db5228c95b545529e80cc12221708662" data-watermark-src="v2-e7aed970707b8adc67d90611be0a53ae" data-private-watermark-src=""><p>目标是将原来都处于A柱的 <equation>n</equation> 个盘子都移到C柱。</p><img src="https://pic2.zhimg.com/v2-41f52f9e8b39c61386c4b5224999fe48_r.jpg" data-caption="" data-size="normal" data-rawwidth="832" data-rawheight="477" data-watermark="watermark" data-original-src="v2-41f52f9e8b39c61386c4b5224999fe48" data-watermark-src="v2-fff2f0aa5a63bf6473330520910c2a32" data-private-watermark-src=""><hr><p>只有1个盘子时，那么需要两步：1号盘A→B、1号盘B→C。</p><hr><p>有2个盘子时，那么需要将2号盘从A“移到”（不止一步）C，就必须先后经历将2号盘从A移到B、将2号盘从B移到C。</p><p>而要将2号盘从A移到B，就得先<b>把1号盘从A移到C</b>；要将2号盘从B移到C，就得先<b>把1号盘再从C移到A</b>；最后再把1号盘从A移到C。</p><p>但是这时要注意的是："把1号盘从A移到C"和“把1号盘再从C移到A”是<b>不同</b>的问题！！！通俗地讲，前者是要“跨过”B柱的、是不“相邻”的移动，而后者则不然。</p><p>所以，有2个盘子时，可以采用下表方式分析（写的有点粗略，应该能看懂吧= =），黄色部分可以看作类似原问题的子问题，而粉色部分和黄色部分是不同的。</p><img src="https://pic1.zhimg.com/v2-e23badcddf7753f58ae54fc514ab42de_r.jpg" data-caption="" data-size="normal" data-rawwidth="484" data-rawheight="352" data-watermark="watermark" data-original-src="v2-e23badcddf7753f58ae54fc514ab42de" data-watermark-src="v2-9d0c032a2d925d932d4f0ce5a736ac53" data-private-watermark-src=""><hr><p>更一般性地讲，有 <equation>n</equation> 个盘子时，要采用如下的移动步骤：</p><ol><li>先将A柱上的 <equation>1\sim n-1</equation> 号盘子移到C柱上（这是一个类似于自己的子问题）;</li><li>接着将最大的盘子（ <equation>n</equation> 号）从A柱移到B柱；</li><li>之后再将C柱上的 <equation>1\sim n-1</equation> 号盘子移到A柱上（注意，这不是一个类似于自己的子问题！！！）；</li><li>接着将最大的盘子（ <equation>n</equation> 号）从B柱移到C柱；</li><li>最后再将A柱上的 <equation>1\sim n-1</equation> 号盘子移到C柱上（这还是一个类似于自己的子问题）。</li></ol><img src="https://pic3.zhimg.com/v2-7991a9e345fa0f33270da29cf720300e_r.jpg" data-caption="" data-size="normal" data-rawwidth="348" data-rawheight="296" data-watermark="watermark" data-original-src="v2-7991a9e345fa0f33270da29cf720300e" data-watermark-src="v2-dd98fc7dcd9beb4f5da12bd94be39699" data-private-watermark-src=""><hr><p>因此我们需要定义一个“附属问题”：设所有的移动<b>必须</b>是顺时针方向，即只能：或从A柱到B柱；或从B柱到C柱；或从C柱到A柱。目标是将原来都处于A柱的 <equation>n</equation> 个盘子都移到B柱。</p><img src="https://pic4.zhimg.com/v2-db751b3e5363a942c259f9419510f198_r.jpg" data-caption="" data-size="normal" data-rawwidth="832" data-rawheight="477" data-watermark="watermark" data-original-src="v2-db751b3e5363a942c259f9419510f198" data-watermark-src="v2-86dfac592428192b10c0b28c8fef0c78" data-private-watermark-src=""><p>可以分析这时的解法是：</p><ol><li>先将A柱上的 <equation>1\sim n-1</equation> 号盘子移到C柱上;</li><li>接着将最大的盘子（ <equation>n</equation> 号）从A柱移到B柱；</li><li>之后再将C柱上的 <equation>1\sim n-1</equation> 号盘子移到B柱上。</li></ol><p>如果用表格表示的话就是：</p><img src="https://pic3.zhimg.com/v2-002985ab7a279d1c469e17c62ee53827_r.jpg" data-caption="" data-size="normal" data-rawwidth="348" data-rawheight="188" data-watermark="watermark" data-original-src="v2-002985ab7a279d1c469e17c62ee53827" data-watermark-src="v2-011c3cd220dc4b4b267b25e3d86a9dc4" data-private-watermark-src=""><hr><p>下面来计算移动步数：</p><p>假设最初的“循环移动”问题的解法的步数为 <equation>G(n)</equation> ，而“循环移动”问题的“附属问题”解法的步数为 <equation>F(n)</equation>。</p><img src="https://pic4.zhimg.com/v2-326fb43211415615d43a4dcc9af4a514_r.jpg" data-caption="" data-size="normal" data-rawwidth="1827" data-rawheight="477" data-watermark="watermark" data-original-src="v2-326fb43211415615d43a4dcc9af4a514" data-watermark-src="v2-e39edf8d63afbc7d78f986d871ac9a94" data-private-watermark-src=""><p>则由解法描述有：</p><p><equation> \begin{equation} \left\{ \begin{aligned} G(n)&amp;=G(n-1)+1+F(n-1)+1+G(n-1)\\ F(n)&amp;=G(n-1)+1+G(n-1)\\ \end{aligned} \right. \end{equation}</equation> ， <equation>G(1)=2</equation> ， <equation>F(1)=1</equation> 。</p><p>我将采用两种方法来求解。</p><hr><p>（一） 基于“2阶常系数线性齐次递推关系”的解法。</p><p>将 <equation>F(n)</equation> 代入 <equation>G(n)</equation> ，得到：</p><p><equation> \begin{equation} \begin{aligned} G(n)&amp;=2G(n-1)+F(n-1)+2\\ &amp;=2G(n-1)+(2G(n-2)+1)+2\\ &amp;=2G(n-1)+2G(n-2)+3 \end{aligned} \end{equation}</equation> 。</p><p>之后类似于“<a href="https://zhuanlan.zhihu.com/p/36075202">汉诺塔杂谈（一）</a>”和“<a href="https://zhuanlan.zhihu.com/p/36124427">汉诺塔杂谈（五）——变体之“临近移动”</a>”的方法，处理一下常数“3”：令 <equation>g(n)=G(n)+1</equation> ，则得到 <equation>g(n)=2g(n-1)+2g(n-2) </equation> 。</p><p>——这就是一个“<b>2阶常系数线性齐次递推关系</b>”：</p><p>假设序列 <equation>a(n)</equation> 满足递推关系 <equation>a(n)=c_1a(n-1)+c_2a(n-2)</equation> ，其中 <equation>c_1,c_2</equation> 为已知常数，又 <equation>a(0),a(1)</equation> 均已知（或者<equation>a(1),a(2)</equation> 均已知，可由递推关系逆推出 <equation>a(0)</equation> ）。</p><p>称 <equation>x^2-c_1x-c_2=0</equation> 为该递推关系的特征方程，假设它的两个根为 <equation>\alpha,\beta</equation> （允许 <equation>\alpha=\beta</equation> 情况，即为二重根）。</p><p>可以很容易验证 <equation>a(n)=(\alpha+\beta)a(n-1)-(\alpha \times \beta)a(n-2)</equation> ，及 <equation>a(n)-\alpha\times a(n-1)=\beta\times(a(n-1)-\alpha\times a(n-2))</equation> 。</p><p>递推可以得到：</p><p><equation> \begin{equation} \begin{aligned} a(n)-\alpha\times a(n-1) &amp;=\beta(a(n-1)-\alpha\times a(n-2))\\ &amp;=\beta^2(a(n-2)-\alpha\times a(n-3))\\ &amp;=\dots\\ &amp;=\beta ^{n-1}(a(1)-\alpha\times a(0)) \end{aligned} \end{equation} </equation> 。</p><p>由此再使用<b>倒推法</b>得到： </p><p><equation>a(n)-\alpha^na(0)=(\beta^{n-1}+\alpha\beta^{n-2}+\alpha^2\beta^{n-3}+...+\alpha^{n-1})(a(1)-\alpha\times a(0))</equation> 。</p><p>于是</p><ul><li>当 <equation>\alpha\neq\beta</equation> 时， <equation>a(n)-\alpha^na(0)=\frac{{{\alpha }^{n}}-{{\beta }^{n}}}{\alpha -\beta }(a(1)-\alpha\times a(0))</equation> ，即 <equation>{a(n)}=\frac{\left( {{a}_{1}}-\beta {{a}_{0}} \right)}{\alpha -\beta }{{\alpha }^{n}}+\frac{\left( {{a}_{1}}-\alpha {{a}_{0}} \right)}{\beta -\alpha }{{\beta }^{n}}</equation> ；</li><li>当 <equation>\alpha=\beta</equation> 时， <equation>a(n)-\alpha^na(0)=n\times\alpha^{n-1}\times(a(1)-\alpha\times a(0))</equation> ，即 <equation>a(n)=a(0)\times\alpha^n+(a(1)-\alpha\times a(0))×n×\alpha^{n-1}</equation> 。</li></ul><p>回到递推关系 <equation>g(n)=2g(n-1)+2g(n-2)</equation> 。</p><p>特征方程为 <equation>x^2-2x-2=0</equation> ，两个特征根为 <equation>\alpha,\beta=1\pm\sqrt{3}</equation> ， <equation>g(1)=G(1)+1=3</equation> ， <equation>g(2)=G(2)+1=8</equation> ，可逆推得到 <equation>g(0)=1</equation> 。解得</p><p><equation>g(n)=\frac{3+2\sqrt{3}}{6}(1+\sqrt{3})^n+\frac{3-2\sqrt{3}}{6}(1-\sqrt{3})^n</equation> ，即得 <equation>G(n)=g(n)-1</equation> 。</p><hr><p>（二） 基于“矩阵递推关系”的解法。</p><p>假设 <equation>X(n)=\left( \begin{matrix} G(n)\\ F(n)\end{matrix}\right)</equation> ， <equation>A=\left( \begin{matrix} 2 &amp;&amp; 1\\ 2 &amp;&amp; 0\\ \end{matrix}\right)</equation> ， <equation>B=\left( \begin{matrix} 2\\ 1\end{matrix}\right)</equation> 。则得到矩阵递推关系：</p><p><equation>X(n)=A\times X(n-1)+B</equation> 。</p><p>可以进一步递推得到</p><p><equation> \begin{equation} \begin{aligned} X(n) &amp;=AX(n-1)+B\\ &amp;=A(AX(n-2)+B)+B=A^2X(n-2)+AB+B\\ &amp;=A^2(AX(n-3)+B)+AB+B=A^3X(n-3)+A^2B+AB+B\\ &amp;=\dots\\ &amp;=A^nX(0)+(A^{n-1}+A^{n-2}+\dots+A+I)B \end{aligned} \end{equation}</equation> ，</p><p>其中 <equation>I</equation> 是单位矩阵。</p><p>下面介绍一般性解法：</p><p>（首先我们假设 <equation>A</equation> 可以对角化，否则可以使用Jordan分解，过程类似，但是复杂点儿）</p><ul><li>假设<equation>A</equation> 可以对角化为 <equation>A=P\Lambda P^{-1}</equation> ，那么 <equation>A^n=P\Lambda^nP^{-1}</equation> ；</li><li>注意到 <equation>(A-I)(A^{n-1}+A^{n-2}+\dots+A+I)=A^n-I</equation> ，于是如果 <equation>A-I</equation> 可逆的话，则 <equation>(A^{n-1}+A^{n-2}+\dots+A+I)=(A-I)^{-1}(A^n-I)</equation> ；</li><li>综合这两者，得到 <equation>X(n) =P\Lambda^nP^{-1}X(0)+(A-I)^{-1}(P\Lambda^nP^{-1}-I)B</equation> 。 </li></ul><p>回到具体问题， <equation>\left( \begin{matrix} 2 &amp;&amp; 1\\ 2 &amp;&amp; 0\\ \end{matrix}\right)=A=P\Lambda P^{-1} </equation> ，其中 <equation>P=\left( \begin{matrix} \frac{1-\sqrt{3}}{2} &amp;&amp; \frac{1+\sqrt{3}}{2}\\ 1 &amp;&amp; 1\\ \end{matrix}\right)</equation> ， <equation>\Lambda=\left( \begin{matrix} 1-\sqrt{3} &amp;&amp; 0\\ 0 &amp;&amp; 1+\sqrt{3}\\ \end{matrix}\right)</equation> ， <equation>P^{-1}=\left( \begin{matrix} -\frac{1}{\sqrt{3}} &amp;&amp; \frac{1}{6}\left(3+\sqrt{3}\right)\\ \frac{1}{\sqrt{3}} &amp;&amp; \frac{1}{6}\left(3-\sqrt{3}\right)\\ \end{matrix}\right)</equation> ， <equation>(A-I)^{-1}=\left( \begin{matrix} \frac{1}{3} &amp;&amp; \frac{1}{3}\\ \frac{2}{3} &amp;&amp; -\frac{1}{3}\\ \end{matrix}\right)</equation> ，由 <equation>X(1)=\left( \begin{matrix} G(1)\\ F(1)\end{matrix}\right)=\left( \begin{matrix} 2\\ 1\end{matrix}\right)</equation> 可以逆推得到 <equation>X(0)=\left( \begin{matrix} 0\\ 0\end{matrix}\right)</equation> 。</p><p>代入 <equation>X(n) =P\Lambda^nP^{-1}X(0)+(A-I)^{-1}(P\Lambda^nP^{-1}-I)B</equation> ，整理得到 </p><p><equation>X(n) =\left( \begin{matrix}\frac{2+\sqrt{3}}{2\sqrt{3}}(1+\sqrt{3})^n-\frac{2-\sqrt{3}}{2\sqrt{3}}(1-\sqrt{3})^n-1\\ \frac{1+\sqrt{3}}{2\sqrt{3}}(1+\sqrt{3})^n-\frac{1-\sqrt{3}}{2\sqrt{3}}(1-\sqrt{3})^n-1\end{matrix}\right)</equation> 。</p><hr><p>最后看一下“汉诺塔图”，此时变成了有向图，红色有向边形成了解：</p><img src="https://pic1.zhimg.com/v2-c845bb4464375b56cf2d908e5a90427f_r.jpg" data-caption="" data-size="normal" data-rawwidth="275" data-rawheight="230" data-watermark="watermark" data-original-src="v2-c845bb4464375b56cf2d908e5a90427f" data-watermark-src="v2-024dd9c4657a7762d28b41044de998b9" data-private-watermark-src=""><p><br></p><img src="https://pic4.zhimg.com/v2-a617a0be01cfe6ef6f99693efb5f6930_r.jpg" data-caption="" data-size="normal" data-rawwidth="678" data-rawheight="542" data-watermark="watermark" data-original-src="v2-a617a0be01cfe6ef6f99693efb5f6930" data-watermark-src="v2-350c0303affcfdbcb3ad14a6c8f62eb0" data-private-watermark-src=""><img src="https://pic1.zhimg.com/v2-47a710c4c06f1b30b1ff8ed8a0d6bdf1_r.jpg" data-caption="" data-size="normal" data-rawwidth="608" data-rawheight="592" data-watermark="watermark" data-original-src="v2-47a710c4c06f1b30b1ff8ed8a0d6bdf1" data-watermark-src="v2-55f40071e54694ef721b9a994c55e91b" data-private-watermark-src=""><p></p><p></p><p></p>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
