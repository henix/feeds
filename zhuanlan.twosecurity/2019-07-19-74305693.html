<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>破解特斯拉的挡风玻璃赚取10000美元</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/74305693">原文</a></p>
<div class="title-image"><img src="https://pic4.zhimg.com/v2-b52d04eb14b255989f662735cdbd35e5_b.jpg" alt=""></div><p>我生活中的一大乐趣就是破解我的Tesla Model 3。它有内置的网络浏览器，有免费的高级LTE（可以4G上网），能自动更新软件。它是一台运行在轮胎上的电脑，而且驱动速度非常快。</p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-6e1c0fd2fc28639f802bf4d69706ce9b_b.jpg" data-caption="" data-size="normal" data-rawwidth="554" data-rawheight="369" class="origin_image zh-lightbox-thumb" width="554" data-original="https://pic4.zhimg.com/v2-6e1c0fd2fc28639f802bf4d69706ce9b_r.jpg"/></noscript><img src="https://pic4.zhimg.com/v2-6e1c0fd2fc28639f802bf4d69706ce9b_b.jpg" data-caption="" data-size="normal" data-rawwidth="554" data-rawheight="369" class="origin_image zh-lightbox-thumb lazy" width="554" data-original="https://pic4.zhimg.com/v2-6e1c0fd2fc28639f802bf4d69706ce9b_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-6e1c0fd2fc28639f802bf4d69706ce9b_b.jpg"/></figure><p>我是在今年年初购买的，无论是渗透测试还是日常使用，我都能从其中获得极大的乐趣。我曾花很长时间坐在车内试图让它做一些它“不应该”做的事。幸运的是，我最终得到了我想要的东西。</p><h2>2019年4月</h2><p>拿到车的第一件事就是给汽车命名，你可以为你的汽车设置昵称并将信息保存到帐户，这样利于在推送通知（例如充电完成）时查看信息。</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-2b69c0230f8c7027e94f73b6f7d926b5_b.jpg" data-size="normal" data-rawwidth="554" data-rawheight="269" class="origin_image zh-lightbox-thumb" width="554" data-original="https://pic2.zhimg.com/v2-2b69c0230f8c7027e94f73b6f7d926b5_r.jpg"/></noscript><img src="https://pic2.zhimg.com/v2-2b69c0230f8c7027e94f73b6f7d926b5_b.jpg" data-size="normal" data-rawwidth="554" data-rawheight="269" class="origin_image zh-lightbox-thumb lazy" width="554" data-original="https://pic2.zhimg.com/v2-2b69c0230f8c7027e94f73b6f7d926b5_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-2b69c0230f8c7027e94f73b6f7d926b5_b.jpg"/><figcaption>右上角的“命名你的车辆”按钮</figcaption></figure><p>最初，我把我的车命名为“<code><b>%x.%x.%x.%x</b></code>”，以测试它是否像2011 BMW 330i一样易受到格式字符串攻击（如下图），但遗憾的是，攻击没有成功。</p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-c3c51c0e8efa96f21bd8734295665d0f_b.jpg" data-caption="" data-size="normal" data-rawwidth="453" data-rawheight="432" class="origin_image zh-lightbox-thumb" width="453" data-original="https://pic4.zhimg.com/v2-c3c51c0e8efa96f21bd8734295665d0f_r.jpg"/></noscript><img src="https://pic4.zhimg.com/v2-c3c51c0e8efa96f21bd8734295665d0f_b.jpg" data-caption="" data-size="normal" data-rawwidth="453" data-rawheight="432" class="origin_image zh-lightbox-thumb lazy" width="453" data-original="https://pic4.zhimg.com/v2-c3c51c0e8efa96f21bd8734295665d0f_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-c3c51c0e8efa96f21bd8734295665d0f_b.jpg"/></figure><p>在花了更多的时间研究后，我发现它允许输入很长的内容。于是我决定将 Tesla 命名为我的XSS Hunter 中的 payload 并继续研究汽车上的其他功能。、</p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-5760131e2b9ec0478d99ec94eecf204e_b.jpg" data-size="normal" data-rawwidth="554" data-rawheight="269" class="origin_image zh-lightbox-thumb" width="554" data-original="https://pic3.zhimg.com/v2-5760131e2b9ec0478d99ec94eecf204e_r.jpg"/></noscript><img src="https://pic3.zhimg.com/v2-5760131e2b9ec0478d99ec94eecf204e_b.jpg" data-size="normal" data-rawwidth="554" data-rawheight="269" class="origin_image zh-lightbox-thumb lazy" width="554" data-original="https://pic3.zhimg.com/v2-5760131e2b9ec0478d99ec94eecf204e_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-5760131e2b9ec0478d99ec94eecf204e_b.jpg"/><figcaption>我设置此名称的想法是，它可能出现在某个内部的特斯拉网站上，用于车辆管理或可能来自我帐户中的功能</figcaption></figure><p>接下来，我花了很多时间去研究内置的Web浏览器。我控制它能做的“坏事”很少，但我仍不断尝试用它去加载奇怪的文件和URI。</p><p>那天我没找到任何漏洞，于是我把汽车熄火，无意留下了那个汽车姓名处的XSS。</p><h2>2019年6月</h2><p>在一次公路旅行中，一块巨石从天而降，砸碎了我的挡风玻璃。</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-9d6bedfd5d2676c58326762fad7381fc_b.jpg" data-caption="" data-size="normal" data-rawwidth="554" data-rawheight="269" class="origin_image zh-lightbox-thumb" width="554" data-original="https://pic1.zhimg.com/v2-9d6bedfd5d2676c58326762fad7381fc_r.jpg"/></noscript><img src="https://pic1.zhimg.com/v2-9d6bedfd5d2676c58326762fad7381fc_b.jpg" data-caption="" data-size="normal" data-rawwidth="554" data-rawheight="269" class="origin_image zh-lightbox-thumb lazy" width="554" data-original="https://pic1.zhimg.com/v2-9d6bedfd5d2676c58326762fad7381fc_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-9d6bedfd5d2676c58326762fad7381fc_b.jpg"/></figure><p>于是，我使用Tesla的应用预约了维修，并继续驾驶。</p><p>第二天，我收到一条关于这个预约的短信，说已有人在处理流程。此时我查了一下我的XSS hunter，发现了一些非常有趣的东西。</p><div class="highlight"><pre><code class="language-text">Vulnerable Page URL
https://garage.vn.teslamotors.com/vehicles/695057517/vitals
 
Execution Origin
https://garage.vn.teslamotors.com
 
Referer
https://garage.vn.teslamotors.com/vehicles/5YJ31337</code></pre></div><p>现在一个负责修复挡风玻璃的工作人员触发了这个XSS。所涉及的域名是<code><b>http://garage.vn.teslamotors.com</b></code>。</p><p>这太令人激动了。</p><p>而且XSS Hunter中的屏幕截图显示，触发XSS的网页用于查看车辆的重要统计信息，而URL中ID代表车辆（貌似可访问其他车辆）。而referer将我的车辆的识别号码作为参数。</p><p>一个管理特斯拉汽车敏感信息的网站成功被 XSS 了。</p><p>XSS Hunter屏幕截图显示了很多有关我汽车的信息，例如速度、温度、版本号、轮胎压力、是否被锁定、警报以及其他信息。</p><div class="highlight"><pre><code class="language-text">车辆识别号：5YJ3E13374KF2313373  
车辆型号：3 P74D  
生日：2019年3月11日 周一 16:31:37  
车辆版本：develop-2019.20.1-203-991337d  
车载电脑：ice  
SOE/USOE:48.9，48.9%  
荷电状态：54.2%  
剩余电量：37.2 kWh  
行驶范围：151.7英里  
里程表：4813.7英里  
档位：D  
速度：81英里/小时  
当地时间：2019年6月19日 星期三 15:09:06  
UTC偏移量：-21600  
时区：夏令时  
BMS状态：DRIVE  
12伏电池电压：13.881 V  
12伏电池电流：0.13A  
锁定状态：锁定  
用户界面模式：舒适  
语言：英语  
服务警报：0x0</code></pre></div><p>此外，还有一些关于固件、CAN总线查看器、地理位置、配置和内部代码名称的信息，有些听起来很有趣。</p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-bde77e670bfecbd67423e93a7c7499d3_b.jpg" data-size="normal" data-rawwidth="554" data-rawheight="437" class="origin_image zh-lightbox-thumb" width="554" data-original="https://pic4.zhimg.com/v2-bde77e670bfecbd67423e93a7c7499d3_r.jpg"/></noscript><img src="https://pic4.zhimg.com/v2-bde77e670bfecbd67423e93a7c7499d3_b.jpg" data-size="normal" data-rawwidth="554" data-rawheight="437" class="origin_image zh-lightbox-thumb lazy" width="554" data-original="https://pic4.zhimg.com/v2-bde77e670bfecbd67423e93a7c7499d3_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-bde77e670bfecbd67423e93a7c7499d3_b.jpg"/><figcaption>应用程序的一些功能</figcaption></figure><p>我尝试浏览<code>garage.vn.teslamotors.com</code>，但显示超时了。这可能是一个内部应用程序。</p><p>非常有趣的是，我还可以通过实时代理向汽车发送控制请求，貌似能修改车辆配置。我猜想这个应用程序具有基于DOM内不同超链接的功能。</p><p>我没有尝试进行如上攻击，但其他攻击者很可能通过遍历端点处的ID去提取和修改其他车辆的信息。</p><p>如果我是一个真实的攻击者，我可能进行更多的攻击尝试，通过查看DOM和JavaScript来了解他们的环境，或许真的能对特斯拉的其他车辆进行破坏性攻击。</p><h2>报告</h2><p>在凌晨2点左右，我给特斯拉的漏洞赏金计划提交了一份漏洞报告。他们将其分类为P1（最高严重等级），并在12小时内推出了一个热补丁。</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-9ab50adf4437e572a9adfd34465164f9_b.jpg" data-caption="" data-size="normal" data-rawwidth="554" data-rawheight="151" class="origin_image zh-lightbox-thumb" width="554" data-original="https://pic2.zhimg.com/v2-9ab50adf4437e572a9adfd34465164f9_r.jpg"/></noscript><img src="https://pic2.zhimg.com/v2-9ab50adf4437e572a9adfd34465164f9_b.jpg" data-caption="" data-size="normal" data-rawwidth="554" data-rawheight="151" class="origin_image zh-lightbox-thumb lazy" width="554" data-original="https://pic2.zhimg.com/v2-9ab50adf4437e572a9adfd34465164f9_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-9ab50adf4437e572a9adfd34465164f9_b.jpg"/></figure><p>虽然我再也无法复制漏洞，但在大约两周后，他们给了我1万美元的赏金，这证实漏洞确实存在，且问题很严重。</p><p>现在想想，虽然我不确定这个漏洞的确切影响，但它至少可以让攻击者窥探到车辆及其客户的敏感信息。</p><h2>时间线</h2><p>2019年6月20日 06:27:30 UTC ——漏洞报告完成</p><p>2019年6月20日 20:35:35 UTC ——热补丁上线</p><p>2019年7月11日 16:07:59 UTC ——发放漏洞赏金</p><p>最后，我要感谢特斯拉的漏洞奖励计划。它们为那些善意地想要“测试”汽车的研究人员提供了一个安全的避风港。如果你不小心弄坏了汽车，他们甚至会提供帮助来修复它。</p><p class="ztext-empty-paragraph"><br/></p><p>来源：<a href="https://link.zhihu.com/?target=https%3A//samcurry.net/cracking-my-windshield-and-earning-10000-on-the-tesla-bug-bounty-program/" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">https://</span><span class="visible">samcurry.net/cracking-m</span><span class="invisible">y-windshield-and-earning-10000-on-the-tesla-bug-bounty-program/</span><span class="ellipsis"></span></a></p>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
