<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Burpsuite 插件之 reflector</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/30750491">原文</a></p>
<div class="title-image"><img src="https://pic2.zhimg.com/v2-7e5987aef351cdef9bf0eded7fb2dc45_r.jpg" alt=""></div><h2><b>概述 </b></h2><p>此插件能够在浏览网页时实时的发现反射型 XSS 漏洞，包括以下几个特点： </p><ol><li>在响应标签中高亮显示存在反射型 XSS 的位置 </li><li>测试在该反射型 XSS 中允许哪些标签符号 </li><li>分析反射的上下文 </li><li>设置 contentType 的白名单 </li></ol><h2><b>如何使用 </b></h2><p>安装好这个扩展之后就可以开始测试你的 web 应用程序了。每当找到一个反射型 XSS 后，reflector 就会定义它的严重性并在 burpsuite 中生成 issue，显示出发现的问题。 </p><img src="https://pic2.zhimg.com/v2-8976c91a0afe199585ef9fedd732b599_r.gif" data-caption="" data-rawwidth="1246" data-rawheight="832" data-thumbnail="https://pic2.zhimg.com/v2-8976c91a0afe199585ef9fedd732b599_b.jpg"><p>每个 issue 都涵盖了反射参数的详细信息，如： </p><ol><li>该种反射允许使用的特殊符号 </li><li>在响应中高亮存在反射的值 </li><li>反射 XSS 处上下文的分析</li></ol><h2><b>分析允许的符号 </b></h2><img src="https://pic2.zhimg.com/v2-186a41d21bd8ae7ceb7b8fe697d6d3e7_r.jpg" data-caption="" data-rawwidth="984" data-rawheight="375"><p>当一个反射型漏洞被找到，并且 option 选项卡的 “aggressive mode” 是激活状态时，reflector会从漏洞参数中检查哪些特殊符号会被显示在页面上。对于此操作，reflector 会为每一个漏洞参数构造一个请求。比如说，我们用 refletor 测试 elkokc.ml 这个站点，发现了3个搜索处存在反射型 XSS，并且每一处都通过了特殊符号的测试，所以 issue 的 Severity 属性值被定为High。每次 reflector 检测到一处反射型 XSS 就会定义 Severity 的等级，并在 burpsuite 中报告一个 issue。 </p><h2><b>上下文分析 </b></h2><p>在 ”Check context” 模式中，reflector 不仅会显示反射到页面中的特殊字符而且还会找出能够跳出当前语法限制的字符。比如，当搜索参数带上 payload  ”p@y&lt;”’”  发往服务器时，你能看到服务器对这个特殊请求的响应，然而在不同的上下文中却有所不同。 </p><ol><li>当上下文出现 ‘ , ” 时，使用 &lt; 和双引号可以逃离当前的上下文限制插入 HTML 代码； </li><li>当上下文出现  ”  时，使用 &lt; 和括号可以注入 HTML 标签； </li><li>当上下文出现 ’ , “  时，使用 &lt;和单引号可以结束 js 上下文写入恶意代码。 </li></ol><img src="https://pic1.zhimg.com/v2-1a43b10b130c209a9bcd27310745302d_r.jpg" data-caption="" data-rawwidth="687" data-rawheight="282"><p>issue 信息被标记为如下： </p><ol><li>上下文字符——可以跳出当前语法限制； </li><li>其他字符——可逃离上下文被反射出来。</li></ol><img src="https://pic1.zhimg.com/v2-a248cd023f252a03d0466eac38522326_r.jpg" data-caption="" data-rawwidth="1074" data-rawheight="461"><h2><b>反射位置定位 </b></h2><p>可以通过响应页面的箭头按钮来进行定位到不同的反射处。</p><img src="https://pic4.zhimg.com/v2-4bcc4d7ac99e70a2bad46d138bfe76c4_r.gif" data-caption="" data-rawwidth="807" data-rawheight="684" data-thumbnail="https://pic1.zhimg.com/v2-4bcc4d7ac99e70a2bad46d138bfe76c4_b.jpg"><h2><b>设置 </b></h2><ol><li>Scope only——reflector 仅作用于被添加的站点； </li><li>Aggressive mode——reflector 生成测试 payload 从而产生额外的请求； </li><li>Check context——激活上下文检测模式。 </li></ol><p>还可以通过管理 content-Type 白名单来让不同的 reflector 插件工作，但是如果使用除了text/html 之外的其他类型可能会导致运行速度变缓。 </p><img src="https://pic3.zhimg.com/v2-8c55c5a09de594681f38beb462f1bd76_r.jpg" data-caption="" data-rawwidth="725" data-rawheight="619"><h2><b>如何编译 </b></h2><p>Jdk 1.7 </p><p>步骤： </p><code lang="js">javac.exe -d build src/burp/*.java 
jar.exe cf plugin.jar -C build burp </code><p><br></p><p>作者 </p><ol><li>hvetsov Alexandr (GitHub:<a href="https://github.com/shvetsovalex">shvetsovalex</a>) </li><li>Dimitrenko Egor (GitHub: <a href="https://github.com/elkokc">elkokc</a>) </li></ol><p>原文：<a href="https://github.com/elkokc/reflector">https://github.com/elkokc/reflector</a> </p><p></p>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
