<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:media="http://search.yahoo.com/mrss/">
<channel>
<title>【量化投资与机器学习】微信公众号</title>
<link>https://henix.github.io/feeds/zhuanlan.Lhtz-Jqxx/</link>
<description>在量化投资的道路上，你不是一个人在战斗！ 主要介绍关于量化投资和机器学习的知识和应用。通过研报，论坛，博客，程序等途径全面的为大家带来知识食粮。版块语言分为：Python、Matlab、R，涉及领域有：量化投资、机器学习、深度学习、综合应用、干货分享等。</description>
<language>zh-cn</language>
<lastBuildDate>Fri, 10 May 2019 12:02:11 +0800</lastBuildDate>
<item>
<title>真的！独家！ | 关于Quant/Trader求职分享（附真实试题）</title>
<link>https://henix.github.io/feeds/zhuanlan.Lhtz-Jqxx/2019-05-04-64560074.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/64560074&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-460f58052c3b4fb9dbae2a2b1929e924_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;作者：辰 | 公众号特约作者&lt;/p&gt;&lt;p&gt;未经允许，禁止转载！&lt;/p&gt;&lt;h2&gt;&lt;b&gt;前言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;本文来自纽约大学金融数学2018级毕业的宽客，也是公众号一位特别可爱的、特别nice的忠实粉丝。为我们独家分享关于Quant/Trader求职经验，包括大神级的买方2 sigma一类。&lt;/p&gt;&lt;p&gt;真的很干哦，也希望对大家在未来的求职中有所帮助！&lt;/p&gt;&lt;h2&gt;&lt;b&gt;正文&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;从2018暑假接到第一个来自Jane Street的面试，我找工作这场仗，一直打到了2019的4月，终于签了一个小quant shop的全职。持续一年多的生存之战中，我面过大大小小一系列专项不同的岗位：traditional trader，marketmaker，quant trader，quant researcher（front desk &amp;amp; risk），甚至quant developer。从面试说话紧张结巴、一被问算法题会蒙蔽的状态，（对方：Just start from brutal force solution.. then wecan talk about optimization）我逐渐学会了和电话线那一端的听众分享我的思路，甚至期待与面试官聊天（友道：“有面试是好事！”）。这个过程中，我不断接到拒信不断地碰壁，一次、两次失败的时候，我觉得不合适罢了，是一个一个的学习机会，没什么不自信的。次数多了，心理阴影面积也幂次数增长了。事后通常会反省自己，好抓住下一个机会：绿书还是没好好掌握，说话应该要沉稳、语速放慢，简历就像分享故事一样说出来。过程中学习的各种知识点多起来了，面试被问到的问题重复的概率也大了。&lt;br/&gt;&lt;/p&gt;&lt;p&gt;我面了~30来家买方卖方，整理部分问题出来。满满都是干货。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;1. 基础知识&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;买方卖方侧重点不同。&lt;b&gt;比如卖方侧重定价和结构化产品，买方会问机器学习和brainteaser&lt;/b&gt;。概率都是重点。题目包括：stochastic calculus，统计题，regression，econometrics，finance包括options和对Black Scholes理解，portfolio management，machinelearning等等方面。大多从绿书，150题和glassdoor上可以找到。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;2. 简历&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;第一个实习经历特别重要。跟面试官说的时候，先是big picture first：做了什么，为什么做这个project（model），解释模型的input output，最后公司怎么用这个模型。还有深入的细节，比如建模型时候遇到什么困难，怎么克服的，处理了什么数据。最好说说business和technical上遇到的挑战、具体的例子。&lt;/p&gt;&lt;h2&gt;&lt;br/&gt;&lt;b&gt;3. Project涉及的理论知识和业界理解&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;比如monte carlo simulation的variancereduction techniques，具体应该怎么做；SABR怎么调参的，数据是什么，还有SABR 怎么运用在金融产品中。准备时候多问问自己为什么，为什么这么做/涉及到的model的优劣势一类的。&lt;br/&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;4. 和面试官的沟通真的非常非常重要&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;他从中可以了解你的性格，是不是一个好的，他喜欢的合作伙伴，想问题时候是不是思维敏捷，说话是不是有条理，能不能把他说懂（口头表达能力），以及对业界的了解（是不是有热情真想干这行）。Behavioral喜欢问职业规划和teamwork。&lt;br/&gt;&lt;/p&gt;&lt;p&gt;平等交流最重要，你也在面试这家公司，看企业文化、岗位、同事合不合得来。&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;5. Interview的功利性刷题和实际的功力有不同&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;比如针对性地学习 “ Python面试大全“，“Java常见面试题”的概念，和刷常问的算法（二分，sort search，数据结构常问题）。可能并不能真正体现编程能力。但面试官测试你能力，也只能用这种应试方式。绿书可以面试前两天狂刷刷，很多还靠平时积累，比如怎么处理数据的问题。我主要针对绿书涉及的知识点，上google搜资料，补充学习。比如一些小的知识点decompose matrix和uniform random variable transform 到normalrandom variable。&lt;br/&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;6. 临场发挥很重要&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;问到接触过、掌握的东西，和面试官正好聊的来，他想找你这样的人，就是运气好。有的trading firm，和HR聊的很好。他说“get back to you”，却一直没get回来。这时候我就给自己分析原因。很可能有更合适的人，比如本科毕业背景更好有交易经验的，或者校友内推，并不一定是自己的个人问题。而当遇到知识点盲区，我觉得谦虚和展现有一定的基础都很重要。&lt;/p&gt;&lt;p&gt;比如和Barclays聊天，面试官问到我有没有用过KB test BP test，是用来测试homoskedasticity的，我反应说不太有印象，但在R package里曾经用过；后面她提及logistic model，我说我学过，是binary classification model，是判断0和1的，这时面试官说严格的说，你要是学过logistic model，就知道output是（0，1），而不是0、1。我说对，你说的对，我的意思是这个模型判断是0、1，但区间是在（0，1）之间。这时我感觉到我们之间聊天就不是很融洽，我当时的态度是不想犯错误，但真诚度和谦逊程度在面试官看来可能就不够了。Candidates众多的情况下，她就倾向于回答满分、同时聊天也其乐融融的candidate。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;真题集&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;JaneStreet:&lt;/b&gt; Operation（career ladder up to trader）&lt;br/&gt;&lt;/p&gt;&lt;p&gt;Five coin tosses, the probability that you get three headsupward?&lt;/p&gt;&lt;p&gt;Forall numbers from 1-100, how many 9s are there in tens and digits?&lt;/p&gt;&lt;p&gt;时钟夹角问题&lt;/p&gt;&lt;p&gt;简历： machine learning&lt;/p&gt;&lt;p&gt;&lt;b&gt;DRW:&lt;/b&gt; Quantitative Researcher&lt;/p&gt;&lt;p&gt;绿书的篮球问题，绿书上Markov Chain的问题，feature selection（特征工程，与简历有关）&lt;/p&gt;&lt;p&gt;&lt;b&gt;GroupOne Trading:&lt;/b&gt; Junior Trader (NYU on campus)&lt;/p&gt;&lt;p&gt;先是一轮速算，包括二位数乘法，小数加减等等。&lt;/p&gt;&lt;p&gt;Introduction, Why group one, why trader, hobby, firstinternship experience, what if that company gives you offer?&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;Radix Trading:&lt;/b&gt; Quantitative Research(onsite)&lt;/p&gt;&lt;p&gt;Twocoding questions: 简历上概念（比如VaR）,leetcode的题目&lt;/p&gt;&lt;p&gt;Given a collection of boxes, find the biggest chain of them thatcan be nested one inside another in order.&lt;/p&gt;&lt;p&gt;找一个array中最大和最小值&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;SIG:&lt;/b&gt; Trader&lt;/p&gt;&lt;p&gt;Introduction, Whysig&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;Background:&lt;/b&gt; GPA,GRE&lt;/p&gt;&lt;p&gt;What do you valuethe most in your job?&lt;/p&gt;&lt;p&gt;First Internshipexperience, hobby, strategies game&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;Optiver: &lt;/b&gt; Trader(passedtest, phone screening: 说话抖音了)&lt;/p&gt;&lt;p&gt;First internship experience, introduction, what if give youreturn offer? Why optiver? Why trading? Teamwork and how you split the work?&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;FlowsTrader:&lt;/b&gt; Trader(passedtest, phone screening)&lt;/p&gt;&lt;p&gt;Internship experiences, What courses take, hobby, why flowstrader(how did you know), challenge, enjoy pressure environment? Receivecriticism and improve?&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;HudsonRiver Trading:&lt;/b&gt; Quant Researcher&lt;/p&gt;&lt;p&gt;Monte Carlo simulation tech: antithetic variates&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;Statistics problems：&lt;/b&gt;toss a coin for 1000 times, what is the probability that 600heads upward?&lt;/p&gt;&lt;p&gt;…..记不清题目了&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;Crossriver bank: Quantitative Researcher&lt;/p&gt;&lt;p&gt;Transition matrix，how to perform decomposition&lt;/p&gt;&lt;p&gt;ABS的问题，关于poolingand tranche&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;Bond：duration meaning，convexity，which one influenced by small change of interest rate more?&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;Bermuda：&lt;/b&gt;Quantitative Researcher&lt;/p&gt;&lt;p&gt;Explain greeks, swaps, monte carlo simulation&lt;/p&gt;&lt;p&gt;linear regression, ols, mle and Bayseian&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;MIO: Trader&lt;/b&gt;&lt;/p&gt;&lt;p&gt;HR经典问题，GPA，why MIO，do you follow the market：30 year bond yield?&lt;/p&gt;&lt;p&gt;CBOE(Onsite@NYC)&lt;/p&gt;&lt;p&gt;Options:&lt;/p&gt;&lt;p&gt;UseMonte Carlo Simulation:&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;Application：&lt;/b&gt;&lt;/p&gt;&lt;p&gt;I think in theindustry, for option pricing people tend to use the numerical method: MonteCarlo simulation. It’s good for high-dimension. For path-dependent’s exoticoptions and multiasset options, it is effective. In monte carlo, pathssimulated are independent and can be calculated using multithreading, so it canproduce precise results.&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;The other model: Black Scholes model has a weakness ofconstant volatility. It assumes the volatility to be constant, and there is nojump in the asset price, which is not so realistic. It also cannot captureearly exercise feature of American style option, so BS is better used forEuropean style options and American options that will be not early exercised (like All Ordinaries Share Price Index options on futures, because of its marginrequirement and non-dividend paying).&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;BS gives a goodway for getting implied vol, and Greeks for hedging: e.g. a delta neutralportfolio.&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;Inreality,price of options are determined by demand and supply under no-arbitrageconditions, (also influenced by implied vol). Models are a way for prediction,and can be adjusted according to historical data.&lt;/p&gt;&lt;p&gt;&lt;b&gt;Futures:&lt;/b&gt; describe a trading strategy&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;1 million Futurestrading strategy:&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;As I mentioned, Iwill look at the term structure offutures and market conditions(contango or backwardation). I would like to do acalendar rolling strategy.&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;I would like tolong VIX futures when prices are low because VIX usually has a bottom of howlow it can be, but there is no limitation of how high it can be(even though itcan not stay long at high level):&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;For the calendar rolling strategy, Irebalance the strategy at the end of each month to sell to open thesecond-month contract and buy to close the position at the end of next month. Ican size VIX futures strategy to have equity like volatility with -100 basispoints of vega notional per dollar of capital( = -10 contracts for every$1,000,000 of capital).&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;I can also holdthe first-month contract and rolls its intra-month and rebalanced only atmonth-end to target the desired vega notional.&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;If multiplefutures are allowed in my portfolio, I can use VXX(two month VIX futures) andVIX futures for long and short.&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;I can also short UVXY and short SPX for &lt;a href=&quot;https://link.zhihu.com/?target=http%3A//hedging.In&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;http://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;hedging.In&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;&lt;/span&gt;&lt;/a&gt; history, there is a negative correlation between VIX futures and returns ofSP500. The issue is VIX index and SPX index is not linearly related. When Ishort UVXY, and when UVXY goes up high, I probably need to short large amountsof SP500 to cover loss.&lt;/p&gt;&lt;p&gt;&lt;b&gt;Howdid you calibrate SABR?&lt;/b&gt;&lt;/p&gt;&lt;p&gt;Makingproducts with SABR:&lt;/p&gt;&lt;p&gt;It is a stochasticvolatility model and can fit the volatility smile. It expressed the impliedvolatility in terms of the model’s parameters. So the model is more consistentwith entire volatility surface.&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;Howto imbed it into pricing: gives different volatilities fordifferent maturities, so it can be used to fit to the volatility smile foroptions with different maturities.&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;Practitionerscan buy SABR model: give them the flexibility to useintuition regarding market dynamics. Financial institutions can manage risksentailed by positions in derivatives. It treats Vol as a function of time, sopeople can use the model to know the vol smile and skew for options withdifferent maturities. as I mentioned, I think it has tractable pricing abilityto capture the correct shape of the smile and dynamic of the vol smile(assetprice is not log-normal distributed as assumed. So the model can capture thefat tail of the distribution, and the probability of people exercising OTM andITM options, so the pricing of options at the both end can be more accurate ).&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;CalibrationSABR:&lt;/b&gt;&lt;/p&gt;&lt;p&gt; (Spline mentioned in the interview: I guess itis a way to get linear interpolation between calculated volatilities?)&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;In my project, Iused market data for EURUSD from 15-Jan-2016. ATM: delta-neutral straddle,market RR and BF, the spot rate is 1.1 USD per EUR. Use a constant USD interestrate of 0.4%.&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;Given a fixedvalue of Beta, changing other parameters will yield different option valuesacross different tenors/expired and across different valuation dates.&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;Basically Iminimized the error between points as observed implied volatilities and thepoints that are fitted by SAR model for corresponding strikes. I pre-determinedbeta, that depend on a priori belief about the forward process, and set beta tobe 0.5. So the volatility term is multiplied by the square root of the currentlevel of forward(stochastic CIR model). &lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;Then I estimatealpha, rho and vega use Newton-Raphson method by minimizing errors(volatilitiesare calculated using Hetson model).&lt;/p&gt;&lt;p&gt;&lt;b&gt;VIXproducts:&lt;/b&gt;&lt;/p&gt;&lt;p&gt;VIX futuresprovide clean exposure to future implied volatility of SP 500.&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;Short volatilityon SP 500 has a positive risk premium, as implied volatility has a strongtendency to be higher than realized volatility. I think some products includinginverse volatility ETFs are very interesting, such as SVXY, VMIN and ZIV.&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;I mentionednotional in our conversation, and I noticed mini-VIX futures has a veganotional of 100 but it currently traded with very little volume compared withthe bigger contract.&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;JPMorgan machine learning(Test)：&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;背包硬币问题&lt;/li&gt;&lt;li&gt;JP JavaDeveloper(passed first round, onsite):&lt;/li&gt;&lt;li&gt;Google到的java的面试题，数据结构&lt;/li&gt;&lt;li&gt;Stringbuilder，stringbuffer&lt;/li&gt;&lt;li&gt;Swap two elements（绿书）&lt;/li&gt;&lt;li&gt;Private constructor怎么call object&lt;/li&gt;&lt;li&gt;Detect circular linkedlist&lt;/li&gt;&lt;li&gt;Final finally finalize&lt;/li&gt;&lt;li&gt;Multithreading多线程保证安全性&lt;/li&gt;&lt;li&gt;怎么让class static，解释staticfunction&lt;/li&gt;&lt;li&gt;Decorator pattern&lt;/li&gt;&lt;li&gt;Overload&lt;/li&gt;&lt;li&gt;Immutable的数据结构&lt;/li&gt;&lt;li&gt;Generic&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;MSCI&lt;/b&gt;&lt;/p&gt;&lt;p&gt;Give you ten yearsof equity prices, how to analyze the data? Give specific steps.&lt;/p&gt;&lt;p&gt;Time seriesanalysis.&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;Probability ofarranging 26 letters so that letters x, y, z is in this order but not need tobe consecutive.&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;Career ladder: What quant：price quant, trader？&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;What kind of Person：science person or art person？&lt;/p&gt;&lt;p&gt;&lt;b&gt;2sigma data analysis&lt;/b&gt;&lt;/p&gt;&lt;p&gt;Fivenormal standard random variables, any two of them has the same correlation, sowe want to know the range of the correlation?&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;Answer:  The problem can be solved using the positivesemidefiniteness property of the correlation matrix.&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;Let thecorrelation between x1, x2; x1, x3; x1, x4…. be .&lt;/p&gt;&lt;p&gt;Thenthe correlation matrix for x1, x2, x3, x4, x5 is&lt;/p&gt;&lt;p&gt;M =   &lt;/p&gt;&lt;p&gt;Add allthe rest columns to the first column to get M1, which has the same determinantas M:&lt;/p&gt;&lt;p&gt;M1 =    &lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;Det(M1)=(&lt;/p&gt;&lt;p&gt;M2 =    &lt;/p&gt;&lt;p&gt;Subtractthe first row from the rest of rows:&lt;/p&gt;&lt;p&gt;M3=   &lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;Thendet(M3) =&lt;/p&gt;&lt;p&gt;Det(M2)= det(M3)=&lt;/p&gt;&lt;p&gt;Det(M1)=(1+4)&lt;/p&gt;&lt;p&gt;So 1+4&lt;/p&gt;&lt;p&gt;When1+4&lt;/p&gt;&lt;p&gt;So theminimum is -0.25.&lt;/p&gt;&lt;p&gt;Also,any principal submatrix of M is semipositive definite：&lt;/p&gt;&lt;p&gt;1-，（1+3）, （1+2）, （1+）&lt;/p&gt;&lt;p&gt;So,-0.25&lt;/p&gt;&lt;p&gt;Twotime series daily return, we calculated annual correlation, which is positive;and their monthly correlation. Is it possible for all monthly correlationnegative?&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;Yes.&lt;/p&gt;&lt;p&gt;If wedefine the monthly correlation as the correlation between monthly returns, notaccumulated returns between each day returns in a month.&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;Consider:&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;where  is the sum of month return(annual return), and is the sum of month return(annual return). &lt;/p&gt;&lt;p&gt; =  &amp;gt;0&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;Consideran example, x1 = 10%, y1 = -20%; x2= -5%, y2 = 10%;  x3 = 4%, y3 = -6%; x4 = -3%, y4 = 5%; x5=-2%, y5 = 12% ...x1, y1; x2, y2; x3, y3; x4, y4, and x5, y5 are negativelycorrelated,&lt;/p&gt;&lt;p&gt;X6 =-2%, y6 = 5%; x7= 1%, y7 = -5%;  x8= 3%,y8= -4%; x9= 5%, y9 = 3%; x10 =-2%, y10 =&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;3%...x1, y1; x2, y2; x3, y3; x4, y4, and x5, y5 are negatively correlated but&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;X =(X1,X2) and Y=(Y1, Y2) are positively correlated.&lt;/p&gt;&lt;p&gt;The same argumentholds for 12 month. It is possible for pairwise returns to be negativelycorrelated for each individual months, but in annual terms, the totalcovariance to be positive (the denominator should be positive) and socorrelation to be positive.&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;Hong Kong Symmetry Investments&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;Projects, numerical methods, programming&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;Monte carlo simulation&lt;/p&gt;&lt;p&gt;Expected payoff of options iscalculated by taking average of these payoffs at the maturity date, thendiscounted back to present.&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;Three interfaces:&lt;/p&gt;&lt;p&gt;One receives uniform randomvariables from random variable generator and changes it to normal random variables.&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;One receives the normal randomvariable, and returns a path(make it more generic, not to stick with the GBMassumption in this project).&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;One for payouts: receives a stockpath, and returns a payout for the option (for Vanilla and for Asian options).&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;Importance sampling: (change ofmeasure): is use to estimate properties of aparticular distribution, h(x) To get E(h(x)), not draw x from the distributionof interest f(x), but draw x from g(x) and estimate E(ℎ(𝑥)𝑓(𝑥)𝑔(𝑥)).&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;In our example, for out of themoney European call option with strike price K and maturity T. If we samplevalues for the underlying asset price at T in the usual way, most paths willlead to zero payoff.&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;Research done on NumericalMethod for many parameters:&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;I mentioned Powell method, which isa bi-directional line search along each search vector.&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;For n search vectors, we passed aninitial point x0, and ai is the scalar determined during search along eachsearch vector. The update x with 𝑥1=𝑥0+Σ𝑎𝑖𝑠𝑖𝑁𝑖=1, and Σ𝑎𝑖𝑠𝑖𝑁𝑖=1 is a new search vector added to the original n search vectors.The search vector that contributes the most to Σ𝑎𝑖𝑠𝑖𝑁𝑖=1 delete from the original list. The algo iterates until noimprovement is done.&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;Other root finding algos includebisection method, Brent’s method, secant method and inverse quadraticinterpolation. I think in industry, people use secant method a lot:&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;Let 0=𝑓(𝑥1)−𝑓(𝑥2)𝑥1−𝑥0(𝑥−𝑥1)+𝑓(𝑥1)&lt;/p&gt;&lt;p&gt;Solution is: 𝑥𝑖=𝑥𝑖−1−𝑓(𝑥𝑖−1)𝑥𝑖−1−𝑥𝑖−2𝑓(𝑥𝑖−1)−𝑓(𝑥𝑖−2)&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;Other numerical methods to minimizethe function (such as the difference between the real value and estimated valueas a function of parameters ) including descent algorithm, linear search,second order optimization methods including Newton’s method, quasi-newtonmethod(which updates the approximation to the Hessian, I think it is lessexpensive to compute this way for many parameters),&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;Programming challenges:&lt;/p&gt;&lt;p&gt;A perfect number is defined as: n = 𝑎3+𝑏3=𝑐3+𝑑3&lt;/p&gt;&lt;p&gt;Prime numbers in arange&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;UBS:&lt;/p&gt;&lt;p&gt;Futures andforward&lt;/p&gt;&lt;p&gt;Programming: adataframe with a colume called “a”, now want to use method and lambda functionto let every element of column “a” plus 1.&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;What is OOP? Datastructure: list and arraylist&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;What’s binarysearch and it’s time cost&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;If the underlyingstocks have dividends, impact on future price?&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;Wienner processand usefulness in finance.&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;Useof Brownian motion:&lt;/p&gt;&lt;p&gt;可以根据W(t)构造martingale（鞅），比如是个鞅。根据鞅的停时定律，判断W(t)是那么时候达到一定的值. 它是一个股价模型中的random source, 在资产定价基本定理中可运用，当股价是一个布朗运动，存在一个独特的风险中性测度。这个市场理论上没有套利活动。&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;一维布朗运动走势和价格曲线走势相似，在任意长度为t是分布均值为0方差为t的正态分布。当前值包含对未来做预测所需要的全部信息。&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;1. 轨迹穿越时间轴t。&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;2. B(t)不会偏离B(0)+-&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;3.M(t) 为0到t的布朗运动最大值，M（t）不小于任意值等于B(t)不小于任意值概率的两倍。可以量化股价极值的概率分布。&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;4. 连续不可微分。&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;1.2：股价很大概率在开盘价上下波动，随着交易时间推移，在t时刻股票价格不会偏离开盘价+-*价格波动标准差。&lt;/p&gt;&lt;p&gt;几何布朗运动：&lt;/p&gt;&lt;p&gt;股票价格的连续复利收益率近似服从正态分布。走势主要由漂移向控制，即在慢牛中我们可以考虑价值投资，长期持股。衍生品价格，是股票价格的函数，可利用伊藤引理来定价。&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;股票可以用布朗运动描述，衍生品价格是随机过程的函数.&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;Optimization:&lt;/p&gt;&lt;p&gt;在mean-variance optimization中运用，常用线性代数进行矩阵分解（市场的协方差矩阵）。&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;Optimization还包括了一些iterative methods，比如EM algorithm，gradient descent&lt;/p&gt;&lt;p&gt;Difference betweenR^2 and adjust R^2&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;Avoid overfittingin machine learning? Validation set&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;Pick top largest100 stocks in SP, use 30-year historical data to get alpha, is it good to tradealpha?&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;100 data pointsfor regression, if replicate 100 data points and use this 200 for regression,what’s difference between results?&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;What’s meanvariance optimization? If we have 100 stocks, given a specified risk level, howto construct the portfolio to maximize the return?&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;Machine learningproject, linear products: delta one&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;Future and forward prices: 期货高于现货，市场状况是期货升水和现货贴水（contango），应该是市场预期有关。是各期货投机者之问相互对赌的结果，像我们讨论的套利机会不会存在很久，因为套利很快让价格均衡。做空期货卖开仓只有在买家看涨的情况下愿意签订合约，不容易借到，期货价格和现货价格差别我觉得还跟场上参与者、庄家控制走势有关。另外期货和现货两者的关系还依赖于股指本身和市场上的利息变动。&lt;/p&gt;&lt;p&gt;Citiphone&lt;/p&gt;&lt;p&gt;1. Girsanov theorem&lt;/p&gt;&lt;p&gt;Whychange of measure&lt;/p&gt;&lt;p&gt;Risk&lt;/p&gt;&lt;p&gt;How toprice options, etc.&lt;/p&gt;&lt;p&gt;2. F-K equation&lt;/p&gt;&lt;p&gt;3. Forward measure&lt;/p&gt;&lt;p&gt;4. Ways to get BS differential equations(riskneutral and heat equation)&lt;/p&gt;&lt;p&gt;5. Quadratic variation&lt;/p&gt;&lt;p&gt;6. Dynamic binding&lt;/p&gt;&lt;p&gt;7. Shallow copy deep copy&lt;/p&gt;&lt;p&gt;8. Monte carlo variance reduction&lt;/p&gt;&lt;p&gt;9. Finite difference methods&lt;/p&gt;&lt;p&gt;Dynamic binding. Itmeans the codes that will be executed with reference to a method call is onlyknown during running time. When multiple classes contain differentimplementations of same method, a function will be selected from multiplefunction alternatives. In java, we usually declares object and in cpp we usevirtual function.&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;I have used it in method overriding--inpricing options with Monte Carlo simulation, I built a class for Europeanoptions by extending a payOff interface with a Price function. I wrote thePrice function differently with certain formula in the European options class.Later when I want to get the price of European options at a certain time, thefunction in European option class will be called. Doing so allows me to pricedifferent types of options with different payoff functions. &lt;/p&gt;&lt;p&gt;Citi Onsite&lt;/p&gt;&lt;p&gt;FX:interest rate parity&lt;/p&gt;&lt;p&gt;Currencyconversion&lt;/p&gt;&lt;p&gt;Decideforeign exchange rate&lt;/p&gt;&lt;p&gt;Python: List and tuple&lt;/p&gt;&lt;p&gt;Multithreading&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;Seed: setthe initial integer value at the start of algorithm that generates randomnumbers. Once set, we can generate the same random numbers each time. If notset, then the system will choose the value automatically and so random numberswill be different based on different times.&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;Static:non-access modifier in java for blocks, variables, methods, and nested classes.It means there will be only one instance of that object in the class. When avariable is static, it is a class variable, and gets memory only once in theclass area at the time of class loading. If any object changes the value of thevariable, it will retain its value. Similarly, a static method belongs to theclass rather than the object of a class, can access static data member and canchange the value of it.&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;VaR&lt;/p&gt;&lt;p&gt;Put call parity&lt;/p&gt;&lt;p&gt;Implied vol andwhy&lt;/p&gt;&lt;p&gt;Martingale, superand submartingale&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;Statistics：you toss a dice,initial have $2, gets 6 can toss again, gets other numbers lose money, how muchare you willing to toss?&lt;/p&gt;&lt;p&gt;Socks: pigeon holequestion.&lt;/p&gt;&lt;p&gt;Taylor expansion:&lt;/p&gt;&lt;p&gt;Finra:&lt;/p&gt;&lt;p&gt;Euclidean distanceand manhattan&lt;/p&gt;&lt;p&gt;Lasso and ridgeregression&lt;/p&gt;&lt;p&gt;Decision Tree&lt;/p&gt;&lt;p&gt;Logisticregression&lt;/p&gt;&lt;p&gt;kaggle&lt;/p&gt;&lt;p&gt;Axioma: Client Supportrole(Quantitative Financial Solutions).&lt;/p&gt;&lt;p&gt;Replicateportfolio, and report&lt;/p&gt;&lt;p&gt;Factor models andoptimization&lt;/p&gt;&lt;p&gt;Chicago Trading Company&lt;/p&gt;&lt;p&gt;Behavioralquestions:&lt;/p&gt;&lt;p&gt;Solve challengesin a team&lt;/p&gt;&lt;p&gt;Conflict withteammates&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;OOPin python:&lt;/p&gt;&lt;p&gt;Inheritance:subclass inherits superclass, as I mentioned in our conversation that overridea method can be an example. Subclass use methods of superclass and makemodifications of it to behave differently.&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;There are alsopolymorphism and encapsulation. For encapsulation, we can restrict access tomethods and variables. In my projects in java, I have built private, public andprotected classes; in python, I used underscore such as single “_” or double“__”.&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;For polymorphism,I used classes to implement interfaces.&lt;/p&gt;&lt;p&gt;Mergetwo files with keys&lt;/p&gt;&lt;p&gt;Listand tuple, when to use&lt;/p&gt;&lt;p&gt;Generatorand example&lt;/p&gt;&lt;p&gt;Largedataset read and shut down&lt;/p&gt;&lt;p&gt;Environmentof python, problem using the notebook&lt;/p&gt;&lt;p&gt;Readtype of data except for csv&lt;/p&gt;&lt;p&gt;Problemwhen output files are messy&lt;/p&gt;&lt;p&gt;Packagesin python, numpy, pandas, Dataframe&lt;/p&gt;&lt;p&gt;Sqlin python&lt;/p&gt;&lt;p&gt;Whento use np array and dataframe&lt;/p&gt;&lt;p&gt;Decorator:wrapper&lt;/p&gt;&lt;p&gt;老东家（不透露名字了）&lt;/p&gt;&lt;p&gt;Internship:machine learning&lt;/p&gt;&lt;p&gt;Stochasticgradient descent v.s. gradient descent&lt;/p&gt;&lt;p&gt;KKN, Kmeans, PCAprinciple&lt;/p&gt;&lt;p&gt;Linear regressionand assumptions&lt;/p&gt;&lt;p&gt;Monte Carlosimulation: accuracy&lt;/p&gt;&lt;p&gt;VAR: three waysand disadvantages and advantages&lt;/p&gt;&lt;p&gt;Statistics方面:&lt;/p&gt;&lt;p&gt;Poisson process,exponential distribution&lt;/p&gt;&lt;p&gt;conditionalvariance and variance&lt;/p&gt;&lt;p&gt;GARCH, ARCH&lt;/p&gt;&lt;p&gt;homoskedasticity&lt;/p&gt;&lt;p&gt;autoregression&lt;/p&gt;&lt;p&gt;jointdistribution: p(x,y) = kxy, x can be 1, 2, 3, and y can be 1, 2, 3, P(x +y)&amp;gt;=5&lt;/p&gt;&lt;p&gt;Sharpe ratio&lt;/p&gt;&lt;p&gt;Binomial tree&lt;/p&gt;&lt;p&gt;和Trader 聊天：&lt;/p&gt;&lt;p&gt;Introduction,internship: how markov chain works, many states: initial values S andindependent transient probability&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;Implementation ofmodel for SVM: what if price goes up 10bps many times, but ends up the day at -30bps&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;Options:American options and European options; values of American options always largerthan European options, never early exercise options: intrinsic values + timevalues&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;When will you exerciseAmerican options early&lt;/p&gt;&lt;p&gt;Convexity: mu E(X)&amp;gt; E(mu X)&lt;/p&gt;&lt;p&gt;Straddle: what isthat?&lt;/p&gt;&lt;p&gt;Statistics: howlong it decays, how many lasers decay in a certain time period use what models&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;Expectation ofrolling a die and get values on it. Roll it twice and roll it three times&lt;/p&gt;&lt;p&gt;Number of rolls toget HH (犯了弱智错误，少了一个state，给了hint，很快反应过来)，HHH… distributionof times of rolling(exponential distribution).&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;Brainteasers（反应迅速很重要，感谢我有段时间狂练二位数乘法）&lt;/p&gt;&lt;p&gt;0’s in 100!,depends on # of 5（我说：我可以写个algo吗，trader：comeon，you don’t evenneed a paper）&lt;/p&gt;&lt;p&gt;0‘s in 800!&lt;/p&gt;&lt;p&gt;Drop eggs（150题）&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;请给小姐姐打赏吧！&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;i&gt;—End—&lt;/i&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;量化投资与机器学习微信公众号，是业内垂直于&lt;b&gt;Quant&lt;/b&gt;、&lt;b&gt;MFE&lt;/b&gt;、&lt;b&gt;CST&lt;/b&gt;等专业的主流自媒体。公众号拥有来自&lt;b&gt;公募、私募、券商、银行、海外&lt;/b&gt;等众多圈内&lt;b&gt;10W+&lt;/b&gt;关注者。每日发布行业前沿研究成果和最新资讯。&lt;/p&gt;</description>
<author>量化投资机器学习</author>
<guid isPermaLink="false">2019-05-04-64560074</guid>
<pubDate>Sat, 04 May 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>详细报道 | 关于高盛在Github开源背后的真相！</title>
<link>https://henix.github.io/feeds/zhuanlan.Lhtz-Jqxx/2019-04-16-62646830.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/62646830&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-a5128b45a3a5a032bec3000e26e840de_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;公众号独家整理报道&lt;/p&gt;&lt;p&gt;编辑：Allen&lt;/p&gt;&lt;blockquote&gt;&lt;b&gt;开源改变了人们对&lt;/b&gt;&lt;br/&gt;&lt;b&gt;软件和硬件的思考方式！&lt;/b&gt;&lt;/blockquote&gt;&lt;h2&gt;&lt;b&gt;前言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;本月初，GitHub CEO Nat Friedman 在Twitter上发布了一条消息：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-4df74c448c074d72edf6c755a3f0b973_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;1369&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-4df74c448c074d72edf6c755a3f0b973_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-4df74c448c074d72edf6c755a3f0b973_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;1369&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-4df74c448c074d72edf6c755a3f0b973_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-4df74c448c074d72edf6c755a3f0b973_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;解读：&lt;/b&gt;本月晚些时候，高盛计划在GitHub上发布一些代码，高盛自己的交易员和工程师将利用这些代码为证券定价、分析和做风险管理。&lt;/p&gt;&lt;p&gt;下面的评论区的读者也是也是一片好评：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-9915c7d1c4bee0e023cc288181678b41_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;1094&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-9915c7d1c4bee0e023cc288181678b41_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-9915c7d1c4bee0e023cc288181678b41_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;1094&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-9915c7d1c4bee0e023cc288181678b41_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-9915c7d1c4bee0e023cc288181678b41_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;与此同时，《华尔街日报》也报道了这个消息：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-aab0d1394426db996d249f2425ac0bae_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;474&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-aab0d1394426db996d249f2425ac0bae_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-aab0d1394426db996d249f2425ac0bae_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;474&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-aab0d1394426db996d249f2425ac0bae_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-aab0d1394426db996d249f2425ac0bae_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;高盛在Github上发布代码已经至少两年了，但《华尔街日报》表示，即将发布的代码有点&lt;b&gt;特别&lt;/b&gt;：&lt;b&gt;它将允许用户直接与SecDB的新web应用进行Marquee交互，包括数据提取、定价引擎和其他功能&lt;/b&gt;。除此之外，高盛每年还为其提供10万美元的年度资金，资助工程师开发使用其代码构建的应用。&lt;/p&gt;&lt;p&gt;如果一切按计划进行，每个拥有GitHub账户的人都可以修改公司的代码行。然而，由此产生的知识产权将完全由高盛拥有。&lt;/p&gt;&lt;p&gt;报告称：高盛将放弃部分商标保密措施，分享其一度受到严密保护的技术。&lt;/p&gt;&lt;p&gt;在此之前，高盛在GitHub上发布了几个开源项目：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-c4196f8037246819faac088c9c3be394_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;553&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-c4196f8037246819faac088c9c3be394_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-c4196f8037246819faac088c9c3be394_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;553&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-c4196f8037246819faac088c9c3be394_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-c4196f8037246819faac088c9c3be394_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;h2&gt;&lt;b&gt;Reladomo&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;高盛在GitHub和Maven Central上正式发布了最新的Apache 2.0授权Java框架Reladomo。&lt;/p&gt;&lt;p&gt;三个开源项目——Jrpip、Obevo和Tablasco。&lt;/p&gt;&lt;h3&gt;&lt;b&gt;JRPIP&lt;/b&gt;&lt;/h3&gt;&lt;p&gt;Jrpip实现了远程接口方法调用，允许不同的Java进程彼此交互。该产品旨在通过提供有用的功能来提高开发人员的效率，例如在任何servlet容器中部署的能力、不需要RemoteException的接口实现和使用一次执行语义的自动重试。此外，Jrpip使用高效的二进制协议进行流处理，减少了内存消耗和垃圾收集器问题。“我们希望开源社区发现Jrpip是一个有用的Java库”。技术部门的副总裁兼技术研究员Mohammad说。“使用Jrpip，开发人员可以专注于他们的代码，而不必担心网络管道和TCP错误。”&lt;/p&gt;&lt;h3&gt;&lt;b&gt;OBEVO&lt;/b&gt;&lt;/h3&gt;&lt;p&gt;Obevo是一个数据库部署工具，帮助团队管理软件开发生命周期（SDLC）过程中的数据库更改。除了处理生产部署之外，Obevo还通过定义一个干净的结构来维护DB对象代码来辅助开发阶段，并使用内存中数据库转换等特性来帮助测试阶段。值得注意的是，Obevo是为企业规模和复杂性的系统设计的，可以在一个模式中管理数百个DB对象，同时仍然以一种简单的方式处理新模式。“我们觉得，我们有能力搭载一个大型的、长期使用的系统，实现一个干净的SDLC流程，这是开源领域的一个关键区别”。技术部副总裁Shant说“。”通过将其发布到开放源码社区，我们希望帮助其他人在他们自己的DB部署环境中进行部署，同时围绕该工具发展一个强大的社区。”&lt;/p&gt;&lt;h3&gt;&lt;b&gt;TABLASCO&lt;/b&gt;&lt;/h3&gt;&lt;p&gt;Tablasco是一个JUnit规则，它将表验证添加到单元测试中。对于生成大量数据的软件产品，此工具可以帮助创建全面且易于维护的自动化测试。用户只需将现有数据调整为Tablasco能够理解的表格式。“每次测试都会生成一个彩色编码的HTML break报告，帮助用户快速识别问题”。技术部门副总裁Barry说。此外，Tablasco具有自动化基线管理功能，允许用户轻松地更新失败测试的基线文件。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-d93da883b17790bf69fa001c33fbd775_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;992&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-d93da883b17790bf69fa001c33fbd775_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-d93da883b17790bf69fa001c33fbd775_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;992&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-d93da883b17790bf69fa001c33fbd775_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-d93da883b17790bf69fa001c33fbd775_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;高盛正寻求与谷歌和Facebook等硅谷科技公司走同样的道路。这些公司通过开放技术来源，显著改善了业务。&lt;/p&gt;&lt;p&gt;通过这一大胆的步骤，高盛希望为其技术获得新的用例，并赢得计算机驱动的量化交易员的青睐。&lt;/p&gt;&lt;p&gt;据报道，在2008年全球金融危机之前，高盛的自营交易引擎SecDB将该公司的交易员打造成了华尔街最聪明的专业人士，甚至被认为使高盛比竞争对手更好地缓冲了金融危机的影响。&lt;/p&gt;&lt;p&gt;然而，由于金融危机后对自营交易系统的全面禁令，高盛此后将SecDB变成了一个名为Marquee的网络应用程序，目前已吸引了约1.3万名用户，其中包括其员工和客户。&lt;/p&gt;&lt;p&gt;随着Marquee在GitHub上的上线，用户将能够直接与它的数据提要、定价引擎等进行交互。&lt;/p&gt;&lt;p&gt;值得注意的是，高盛的新举措可能预示着更伟大的事情即将到来，因为该公司最近一直对分散的区块链技术世界表现出兴趣。&lt;/p&gt;&lt;p&gt;2018年8月，BTCManager获悉，作为在传统金融行业部署区块链解决方案的更广泛计划的一部分，高盛参与了区块链创业公司Axoni的B轮融资。&lt;/p&gt;&lt;p&gt;看来顶尖投行也在GitHub上开源一些内容啦。很值得期待！&lt;/p&gt;&lt;p&gt;下面我们来具体看看高盛这一路的历程。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;Marquee&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;据报道，高盛正计划&lt;b&gt;发布API&lt;/b&gt;，使人们能够在GitHub上访问名为 &lt;b&gt;Marquee&lt;/b&gt; 的平台。&lt;/p&gt;&lt;p&gt;Marquee是一个&lt;b&gt;基于web的平台，建立在风险和定价引擎SecDB之上&lt;/b&gt;。高盛计划发布API（应用程序编程接口），以便通过web与Marquee平台进行交互。&lt;/p&gt;&lt;p&gt;所谓Marquee，是高盛近年来的重磅科技产品，其目的是为了将大宗股票交易电子化而创立的开源平台，允许接入多种投资应用。&lt;/p&gt;&lt;p&gt;Marquee的大宗交易算法执行交易只须数秒，而人工交易则以分钟或小时计。&lt;/p&gt;&lt;p&gt;大宗交易涉及1万股或价值20万美元的股票，如果客户希望买入和卖出大宗股票，他们愿意多付费用来保证流动性和亲自操作。&lt;/p&gt;&lt;p&gt;这是华尔街银行进行自动大宗交易的又一最新尝试，对股票业务而言是一个亮点，因为目前绝大多数股票业务都是人工实现的，而非专业化的计算机程序。&lt;/p&gt;&lt;p&gt;高盛也曾在声明中表示，将致力于把Marquee平台打造成世界级的金融服务与风险管理平台，而赚钱与否是次要的关注点。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-04ff70caa6563731ea3c1f5473438e9c_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;900&quot; data-rawheight=&quot;537&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;900&quot; data-original=&quot;https://pic1.zhimg.com/v2-04ff70caa6563731ea3c1f5473438e9c_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-04ff70caa6563731ea3c1f5473438e9c_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;900&quot; data-rawheight=&quot;537&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;900&quot; data-original=&quot;https://pic1.zhimg.com/v2-04ff70caa6563731ea3c1f5473438e9c_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-04ff70caa6563731ea3c1f5473438e9c_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;James Blackha，前高盛担任数字结构主管。他负责设计、规划、实施、交付和推出Marquee。&lt;/p&gt;&lt;p&gt;他表示：“在最初阶段，Marquee致力于让客户与银行进行电子互动。”&lt;/p&gt;&lt;p&gt;Marquee还开放了高盛的各个部门，并把他们带到了一个平台上来。&lt;/p&gt;&lt;p&gt;James Blackha表示：“Marquee本质上是一个平台，允许高盛的不同业务以安全和一致的方式向客户开放”。&lt;/p&gt;&lt;p&gt;它还允许客户在不与高盛销售团队沟通的情况下自学并快速做出决定。这个应用程序的一个例子是SIMON（结构化投资市场Online）。这让客户能够了解结构性产品，并通过一个应用程序执行交易。在此之前，他们必须与高盛的结构性产品专家沟通，才能了解其交易内容。&lt;/p&gt;&lt;p&gt;这一举措意义重大，因为目前&lt;b&gt;只有高盛（Goldman Sachs）、摩根大通（J.P.Morgan）和摩根士丹利（Morgan Stanley）这三家顶级投行拥有GitHub账户&lt;/b&gt;。瑞银（UBS）、瑞士信贷（Credit Suisse）、巴克莱（Barclays）、美国银行（Bank of America）和德意志银行（Deutsche）等投行要么没有GitHub账户，要么什么都没有。对于这样做的公司，除了摩根大通的法定人数外，所有项目本质上都是非财务性质的：它们只是软件工程工具和实用程序。因此，对于一家银行来说，发布代码直接链接到定价引擎等服务是迈向21世纪的重要一步。这也是他们在校招中可以称道的事情。&lt;/p&gt;&lt;p&gt;&lt;b&gt;高盛此举真的有这么大的影响吗？&lt;/b&gt;客户已经能够通过第三方系统（如TradeWeb）或具有API的单一交易商平台与高盛这样的银行进行价格发现（Price Discovery）。SecDB的报价请求（RFQ）通常会自动定价，但它们是隐藏在平台背后的黑盒子。我们认为，高盛将努力为量化研究人员和交易员提供工具和服务，让他们融入自己的工作流程，然后鼓励他们在此基础上进行交易。&lt;/p&gt;&lt;blockquote&gt;&lt;b&gt;知识点&lt;/b&gt;&lt;/blockquote&gt;&lt;p&gt;价格发现（Price Discovery）是指买卖双方在给定的时间和地方对一种商品的质量和数量达成交易价格的过程。&lt;/p&gt;&lt;p&gt;它涉及市场结构、市场行为、市场信息、期货市场和风险管理。价格发现并不混同于一般意义上的价格决定（Price Determination）。”价格发现是期货市场的一个重要的经济功能，也是期货市场存在和发展的基础。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;SecDB&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;众所周知，证券数据库是高盛的特殊优势。这个系统也被称为SecDB，允许高盛定价交易并评估每日280万交易头寸的风险，是竞争优势的巨大来源，也是其他银行正在努力效仿的东西。&lt;/p&gt;&lt;p&gt;一位前高盛内部人士表示：“你必须知道，SecDB是一个拥有大量天才创意令人惊叹的平台，但它只有26年或27年的历史。”。“在上世纪90年代和本世纪头十年，有很多技术选择对该行业非常有利，但现在情况不同了。例如，当时，你可能每天有几十万笔交易，但现在，在电子外汇交易中，你可能每天有100万笔交易。你如何将一个可以处理10万笔交易的系统扩展到数百万笔？”&lt;/p&gt;&lt;p&gt;了解SecDB需要了解高盛的历史。SecDB高盛1981年收购的外汇和大宗商品经纪公司J Aron创立。直到21世纪初，J Aron才被高盛完全吸收，得以继续开发自己的技术。 J Aron在1992年左右开始使用SecDB。也许是在2006年或2007年，整个公司才开始运营它。每次出现像1998年亚洲危机或2002年互联网泡沫破裂这样的危机时，J Aron的SecDB系统都会进一步扩展。&lt;/p&gt;&lt;p&gt;从一开始，SecDB就J Aron的“战略”团队及其技术人员的合作成果。目前负责高盛资产管理量化交易业务的Armen Avanessians负责该公司的策略。技术部门由Mike Dubno、Glenn Gribble和Kevin Lundeen管理。他们都是非常有才华的技术人员，但这是在1991年。今天的许多编程语言根本不存在。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;Slang &lt;/b&gt;&lt;/h2&gt;&lt;p&gt;在没有Python的情况下，高盛的技术人员发明了他们自己的语言：&lt;b&gt;Slang&lt;/b&gt; &lt;/p&gt;&lt;p&gt;人们意识到，像C++这样的语言有利于提高执行速度，它运行得非常快,但它是一种复杂的语言，需要很长时间来开发。技术人员认为他们需要一种更容易使用的语言，一种可以在Windows、Solaris和Unix系统上运行的解释性语言。所以他们想出了Slang。&lt;/p&gt;&lt;p&gt;如今，高盛仍然用Slang来编码SecDB。根据各种估计，这个系统是建立在1500万到4000万行Slang代码之上的。Slang曾对高盛有好处，但现在有了更好的东西：&lt;b&gt;Python&lt;/b&gt;。&lt;/p&gt;&lt;p&gt;其他正在开发SecDB这样系统的银行现在都在使用Python。使用Python，你可以利用TensorFlow之类的东西。高盛做不到这一点，因为Slang，它被困在了公司内部。使用Slang，你不能从其他地方传播思想。最终，这将减缓高盛的创新步伐。&lt;/p&gt;&lt;p&gt;那么，为什么现在不把Slang移开呢？这并不容易：1500多万行代码不可能在一夜之间被替换掉。这可能需要十年甚至更长时间。&lt;/p&gt;&lt;p&gt;高盛其他内部人士说：”公司意识到了这些问题，多年来一直在解决这些问题。高盛一位前合伙人表示，17年前，当SecDB在股票领域推出时，可扩展性问题得到了解决。这是电子交易兴起的开始。所以我们解决了可扩展性的问题”。其他人表示，高盛已经拥有 &amp;#34;JSI&amp;#34; 或Java Slang集成一种使用Java代码访问SecDB的方法，并开发了Python包装器。&lt;/p&gt;&lt;p&gt;这种向Java的转变被认为与雇佣Java程序员相对容易有关。这也是Slang的另一个问题：除非你在高盛长大，否则你不会熟悉它。如果你在高盛从事Slang工作，你就会落后于Python等语言的所有创新。高盛一位技术内部人士承认：“这加大了横向招聘的难度”。这是高盛需要雇佣这么多STEM学生的一个很好的理由：它必须自下而上地培训Slang程序员。&lt;/p&gt;&lt;p&gt;学习Slang也不是那么繁重。一个好的程序员很容易学会俚语。你不用Python并不重要。SecDB有它的局限性，但它已经维持了25年，所以它一定很好。&lt;/p&gt;&lt;p&gt;随着高盛以招牌形式向客户推出SecDB，摩根大通等银行正在紧追高盛。摩根大通还聘请了微软的一位顶级人工智能专家来开发一个新的全球机器学习部门等等。&lt;/p&gt;&lt;p&gt;不过，让我们明确一下这一点。这不是秘诀。从历史上看，SecDB和更新的Marquee并不是高盛历来成为交易大佬的唯一原因。&lt;b&gt;SecDB是一个风险管理平台，它根据理论模型对衍生品合约进行有效定价的能力，但并不能产生Alpha值&lt;/b&gt;，只有当交易部门的头寸、客户盈利能力和成本/佣金等额外数据被加入时，它才会变得有趣。显然，&lt;b&gt;这些数据不会通过这些API公开&lt;/b&gt;。&lt;/p&gt;&lt;p&gt;如果你是客户，通过Marquee API访问SecDB可能会降低你的基础设施开销，并根据提供的服务减少投放市场的时间。&lt;b&gt;但这是有代价的：高盛将知道你在做什么，而且可能会为更有用的功能收取高昂的费用。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;最终，我们怀疑高盛会想要像亚马逊那样将其平台货币化。从长远来看，它在这个过程中获得的数据无疑将具有巨大的价值。&lt;/p&gt;&lt;p&gt;高盛工程师Andy Phillips表示：“我们希望成为量化投融资的一员，就像Amazon成为计算能力的一员一样“。亚马逊在成立之初就意识到，它可以出售额外的服务器容量；去年，亚马逊网络服务贡献了该公司四分之三的利润。&lt;/p&gt;&lt;p&gt;据报道，摩根大通在Athena平台的外部可用性方面并没有落后太多，但高盛Github的努力表明，它将更进一步。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;推荐阅读&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289074%26idx%3D1%26sn%3De859d363eef9249236244466a1af41b6%26chksm%3D802e3867b759b1717f77e07a51ee5671e8115130c66562577280ba1243cba08218add04f1f00%26token%3D449379994%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;01、经过多年交易之后你应该学到的东西（深度分享）&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289050%26idx%3D1%26sn%3D60043a5c95b877dd329a5fd150ddacc4%26chksm%3D802e384fb759b1598e500087374772059aa21b31ae104b3dca04331cf4b63a233c5e04c1945a%26token%3D449379994%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;02、监督学习标签在股市中的应用（代码+书籍）&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289018%26idx%3D1%26sn%3D8c411f676c2c0d92b0dd218f041bee4b%26chksm%3D802e382fb759b139ffebf633ac14cdd0f21938e4613fe632d5d9231dab3d2aca95a11628378a%26token%3D449379994%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;03、全球投行顶尖机器学习团队全面分析&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289014%26idx%3D1%26sn%3D3762d405e332c599a21b48a7dc4df587%26chksm%3D802e3823b759b135928d55044c2729aea9690f86752b680eb973d1a376dc53cfa18287d0060b%26token%3D449379994%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;04、使用Tensorflow预测股票市场变动&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289238%26idx%3D1%26sn%3D3144f5792f84455dd53c27a78e8a316c%26chksm%3D802e3903b759b015da88acde4fcbc8547ab3e6acbb5a0897404bbefe1d8a414265d5d5766ee4%26token%3D2020206794%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;05、使用LSTM预测股票市场基于Tensorflow&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289314%26idx%3D1%26sn%3D87c5a12b23a875966db7be50d11f09cd%26chksm%3D802e3977b759b061675d1988168c1fec06c602e8583fbcc9b76f87008e0c10b702acc85467a0%26token%3D1972390229%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;06、美丽的回测——教你定量计算过拟合概率&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289347%26idx%3D1%26sn%3Dbf5d7899bc4a854d4ba9046fdc6fe0d6%26chksm%3D802e3996b759b080287213840987bb0a0c02e4e1d4d7aae23f10a225a92ef6dd922d8006123d%26token%3D290397496%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;07、利用动态深度学习预测金融时间序列基于Python&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289394%26idx%3D1%26sn%3D24a836136d730aa268605628e683d629%26chksm%3D802e39a7b759b0b1dcf7aaa560699130a907716b71fc9c45ff0e5d236c5ae8ef80ebdb09dbb6%26token%3D290397496%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;08、Facebook开源神器Prophet预测时间序列基于Python&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289437%26idx%3D1%26sn%3Df0dca7da8e69e7ba736992cb3d034ce7%26chksm%3D802e39c8b759b0de5bce401c580623d0729ecca69d13926479d36e19aff8c9c9e8a20265afff%26token%3D290397496%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;09、Facebook开源神器Prophet预测股市行情基于Python&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289358%26idx%3D1%26sn%3Ddb6e8ab85b08f6e67790ec0e401e586e%26chksm%3D802e399bb759b08d6eec855f9901ea856d0da68c7425cba62791b8948da6ad761a3d88543dad%26token%3D290397496%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;10、2018第三季度最受欢迎的券商金工研报前50（附下载）&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289447%26idx%3D1%26sn%3Df2948715bf82569a6556d518e56c1f9e%26chksm%3D802e39f2b759b0e4502d1aaac562b87789573b55c76b3c85897d8c9d88dbf9a0b7ee34d86a4e%26token%3D290397496%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;11、实战交易策略的精髓（公众号深度呈现）&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289478%26idx%3D1%26sn%3Df8e01a641be021993d8ef2d84e94a299%26chksm%3D802e3e13b759b7055cf27a280c672371008a5564c97c658eee89ce8481396a28d254836ff9af%26token%3D290397496%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;12、Markowitz有效边界和投资组合优化基于Python&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289495%26idx%3D1%26sn%3Dc4eeaa2e9f9c10995be9ea0c56d29ba7%26chksm%3D802e3e02b759b7148227675c23c403fb9a543b733e3d27fa237b53840e030bf387a473d83e3c%26token%3D1260956004%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;13、使用LSTM模型预测股价基于Keras&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289507%26idx%3D1%26sn%3Df0ca71aa07531bbbdbd33213f0bab89f%26chksm%3D802e3e36b759b720138b3b17a4dd0e198e054b9de29a038fdd50805f824effa55831111ad026%26token%3D1936245282%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;14、量化金融导论1：资产收益的程式化介绍基于Python&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289533%26idx%3D1%26sn%3D4ef964834e84a9995111bb057b0fc5dd%26chksm%3D802e3e28b759b73e0618eb1262c53aa0601fbf5805525a7c7ff40dc3db62c7704496611bdbf1%26token%3D1950551577%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;15、预测股市崩盘基于统计机器学习与神经网络（Python+文档）&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289609%26idx%3D1%26sn%3Dc7f0b3e47025862d10bb53b6ab88bcda%26chksm%3D802e3e9cb759b78abf6b8b049c59bf18ccfb2ead7580d1f557d36de2292f59dcbd94dcd41910%26token%3D2085008037%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;16、实现最优投资组合有效前沿基于Python（附代码）&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289615%26idx%3D1%26sn%3D1cdc89afb997d0c580bf0cef296d946c%26chksm%3D802e3e9ab759b78ce9f0cd152a680d4a413d6c8dcb02a7a296f4091993a7e4137e7520394575%26token%3D2085008037%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;17、精心为大家整理了一些超级棒的机器学习资料（附链接）&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289623%26idx%3D1%26sn%3D28a3600fd7a72d7be00b066ca0f98244%26chksm%3D802e3e82b759b7943f43a4f6ef4a91e4153fa6b8210de9590235fa8ee66eb9811ce177054dbc%26token%3D1389401983%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;18、海量Wind数据，与全网用户零距离邂逅！&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289640%26idx%3D1%26sn%3D34e94fcbe99052b8e7381ecc48a36dc0%26chksm%3D802e3ebdb759b7ab897cd329a680715b6f8294e63550ddf0c57b9e1320b2b7d1408c6fdca0c7%26token%3D1389401983%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;19、机器学习、深度学习、量化金融、Python等最新书籍汇总下载&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289725%26idx%3D1%26sn%3D4b65cd1fb8331438e4c0b3d0eae6b51f%26chksm%3D802e3ee8b759b7fe1b94e84d54cc23b0ab05853d5cd227812574b350e9fc2cce9e5f1bc6cb7a%26token%3D1389401983%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;20、各大卖方2019年A股策略报告，都是有故事的人！&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;i&gt;&lt;b&gt;—End—&lt;/b&gt;&lt;/i&gt;&lt;/p&gt;&lt;p&gt;量化投资与机器学习微信公众号，是业内垂直于&lt;b&gt;Quant&lt;/b&gt;、&lt;b&gt;MFE&lt;/b&gt;、&lt;b&gt;CST&lt;/b&gt;等专业的主流自媒体。公众号拥有来自&lt;b&gt;公募、私募、券商、银行、海外&lt;/b&gt;等众多圈内&lt;b&gt;10W+&lt;/b&gt;关注者。每日发布行业前沿研究成果和最新资讯。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>量化投资机器学习</author>
<guid isPermaLink="false">2019-04-16-62646830</guid>
<pubDate>Tue, 16 Apr 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>​机器学习分类算法在因子投资中的应用</title>
<link>https://henix.github.io/feeds/zhuanlan.Lhtz-Jqxx/2019-04-14-62408392.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/62408392&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-ff075b369fda5aacc519479b10a055a5_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;▎编译：shan | 公众号翻译部&lt;/p&gt;&lt;p&gt;▎作者：Druce Vertes&lt;/p&gt;&lt;h2&gt;&lt;b&gt;第一部分：分类算法介绍&lt;/b&gt;&lt;/h2&gt;&lt;h3&gt;&lt;b&gt;什么是分类算法？&lt;/b&gt;&lt;/h3&gt;&lt;p&gt;回归预测了连续的值，比如一个资产的收益，而分类算法预测了一个离散的值，比如，这个股票下一段时间的表现是否比现在要好？这就是个二分问题，需要一个是或者否的答案，另一个例子：如果将一只股票的业绩区间分成四份，那么这支股票的下个月业绩会落在那块，这就是个多项分类问题，会得到4个可能的结果。在这篇文章中，我们将给分类问题进行高屋建瓴的解析，并在组合上应用分类算法预测收益。分类算法本身是深度学习的一种，最开始是用于手写识别或者图像识别，分类算法是机器学习中的基础算法，在它的基础上可以做出很多有意思的东西。&lt;/p&gt;&lt;p&gt;代码链接：&lt;/p&gt;&lt;p&gt;&lt;i&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/druce/Machine-learning-for-financial-market-prediction/blob/master/Classification%2520Mad%2520Science.ipynb&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;github.com/druce/Machin&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;e-learning-for-financial-market-prediction/blob/master/Classification%20Mad%20Science.ipynb&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/i&gt;&lt;/p&gt;&lt;h3&gt;&lt;b&gt;分类算法要素&lt;/b&gt;&lt;/h3&gt;&lt;p&gt;首先，我们在二维坐标上生成一些红色和蓝色的点，整个坐标系在0-100中间。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-2ecf6a083c5da0a92bc60a7a03f621d2_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1064&quot; data-rawheight=&quot;998&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1064&quot; data-original=&quot;https://pic3.zhimg.com/v2-2ecf6a083c5da0a92bc60a7a03f621d2_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-2ecf6a083c5da0a92bc60a7a03f621d2_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1064&quot; data-rawheight=&quot;998&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1064&quot; data-original=&quot;https://pic3.zhimg.com/v2-2ecf6a083c5da0a92bc60a7a03f621d2_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-2ecf6a083c5da0a92bc60a7a03f621d2_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;测试数据中：&lt;/p&gt;&lt;p&gt;2000个红色点以坐标（25,25）为中心，标准差为50，设置label=0；&lt;/p&gt;&lt;p&gt;2000个蓝色点以坐标（80,80）为中心，标准差为20，设置label=1。&lt;/p&gt;&lt;p&gt;我们希望寻找的一个函数，输入x和y就能得出是在红色区还是蓝色区，逻辑回归是一个简单且流行的分类算法。&lt;/p&gt;&lt;p&gt;我们展示一下如何应用逻辑回归。&lt;/p&gt;&lt;p&gt;1、首先我们设定z(x,y)=ax+by+c&lt;/p&gt;&lt;p&gt;2、然后我们用squashing激活函数把正数映射到1，负数映射到0&lt;/p&gt;&lt;p&gt;3、然后我们使用损失函数去度量预测误差，这个误差项应该在预测正确的时候趋近为0&lt;/p&gt;&lt;p&gt;4、最后我们算出参数a,b,c来最小化这个损失函数&lt;/p&gt;&lt;p&gt;如果我们能训练这个分类器，使其的误差趋近于0，那么我们就能得到一个函数能够尽量的匹配预测值和观察值。&lt;/p&gt;&lt;p&gt;我们通过使用梯度下降方法来降低误差，先随机选择参数值a，b和c，确定这些值的移动方向以使整个函数的误差缩小，然后更新a，b和c的值使最终的误差最小。&lt;/p&gt;&lt;p&gt;我们得到一个红点和蓝点的分类如下：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-328e931bb928ca3e888bea4ad1739e5f_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1046&quot; data-rawheight=&quot;990&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1046&quot; data-original=&quot;https://pic4.zhimg.com/v2-328e931bb928ca3e888bea4ad1739e5f_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-328e931bb928ca3e888bea4ad1739e5f_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1046&quot; data-rawheight=&quot;990&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1046&quot; data-original=&quot;https://pic4.zhimg.com/v2-328e931bb928ca3e888bea4ad1739e5f_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-328e931bb928ca3e888bea4ad1739e5f_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;让我们仔细看看隐藏在背后的这四个步骤。&lt;/p&gt;&lt;p&gt;决策函数Z(x,y): = ax + by + c与ax + by + c = 0的欧式距离成正比，它代表了到分类边界的距离。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-176faa97f2551d096c408d8b1e29aebc_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;1006&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-176faa97f2551d096c408d8b1e29aebc_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-176faa97f2551d096c408d8b1e29aebc_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;1006&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-176faa97f2551d096c408d8b1e29aebc_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-176faa97f2551d096c408d8b1e29aebc_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;Squashing函数&lt;/b&gt;：在逻辑回归里，squashing函数式逻辑回归函数为  这种类型的函数称作激活函数，函数形状很像’S’，因此用S(X)来表示，可以将负无穷到正无穷的数据映射到[0,1]区间之内，直观的解释是它将对数几率映射到了0-1之间。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-00213ef112d2b32b75c99a3032cfc580_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;719&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-00213ef112d2b32b75c99a3032cfc580_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-00213ef112d2b32b75c99a3032cfc580_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;719&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-00213ef112d2b32b75c99a3032cfc580_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-00213ef112d2b32b75c99a3032cfc580_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;损失函数：假设我们预测是蓝色点的概率为0.8，那么如何判断预测的准确性，对于二分分类问题来说，我们想要尽量缩小误差。V = - log(p)y - log(1-p)(1-y) 在这个式子中，y是我们的预测结果，p是我们预测为篮点区域的概率。&lt;/p&gt;&lt;p&gt;一个好的方法来可视化log loss是用-log(correctness)，如果我们确定预测是100%准确的，则log(loss)=0，如果我们的预测是100%错误的，则log(loss)将得到正无穷。&lt;/p&gt;&lt;p&gt;我们继续分解这个问题，我们的预测结果是0或者1，那么我们的预测的概率就在0和1 之间。如果我们的预测值是1（蓝色点），并且我们的预测准确率为p(假设为0.8)，那么V=-log(0.8). V = - log(p)y - log(1-p)(1-y) 等式的第二项为0因为1-y=0。当一个预测接近1时，log loss趋近于0，如果一个预测趋近于0时，log loss则非常大。相反，如果预测值为0（红色点区域），那么损失函数V = -log(1-p)，第一项为0因为y=0，如果我们的预测接近于0，那么log loss为0，如果预测趋近于1，那么log loss则非常大。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-bd501e7895f561f501f2fa4c71ddd623_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;735&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-bd501e7895f561f501f2fa4c71ddd623_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-bd501e7895f561f501f2fa4c71ddd623_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;735&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-bd501e7895f561f501f2fa4c71ddd623_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-bd501e7895f561f501f2fa4c71ddd623_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;在以上四步中，我们用以下方法来分解二分分类问题：&lt;/p&gt;&lt;p&gt;1、寻找到合适的参数a,b,c&lt;/p&gt;&lt;p&gt;2、最小化损失函数V(S(ax + by + c)) = J(a,b,c)…&lt;/p&gt;&lt;p&gt;3、训练所有的训练集&lt;/p&gt;&lt;p&gt;这些就是二分分类方法的要素：寻找一个函数和满足函数的参数（a,b和c），使其预测概率为1，并且最小化损失函数，我们可以借助计算机来实现它。&lt;/p&gt;&lt;h3&gt;&lt;b&gt;最后一点&lt;/b&gt;&lt;/h3&gt;&lt;p&gt;当预测概率超过一个概率阈值时，我们预测蓝色类。一般来说，我们不应该假设我们的决策边界必须在50%概率线上。在实际问题中，我们应该考虑假阳性与假阴性的成本。当我们提高概率阈值时，我们减少了误报的数量，增加了误报的数量。ROC曲线可以帮助我们可视化。我们想要选择一个决策边界阈值来最大化真实世界的性能，如果我们增加一个正预测的阈值，那么更少的假阳性的边际收益等于额外的假阴性的成本。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-9c216f93f898cc0420d22aff454ecb91_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;724&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-9c216f93f898cc0420d22aff454ecb91_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-9c216f93f898cc0420d22aff454ecb91_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;724&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-9c216f93f898cc0420d22aff454ecb91_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-9c216f93f898cc0420d22aff454ecb91_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;h3&gt;&lt;b&gt;分类算法Overview&lt;/b&gt;&lt;/h3&gt;&lt;p&gt;那么在如此多的分类算法中，我们如何找到试用的分类算法呢？&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-a80897b7a6a3b57e7102cca74cb2c3d9_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;986&quot; data-rawheight=&quot;1420&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;986&quot; data-original=&quot;https://pic2.zhimg.com/v2-a80897b7a6a3b57e7102cca74cb2c3d9_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-a80897b7a6a3b57e7102cca74cb2c3d9_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;986&quot; data-rawheight=&quot;1420&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;986&quot; data-original=&quot;https://pic2.zhimg.com/v2-a80897b7a6a3b57e7102cca74cb2c3d9_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-a80897b7a6a3b57e7102cca74cb2c3d9_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;那么应该明确的问题：&lt;/p&gt;&lt;p&gt;1、x和y符合什么分布。&lt;/p&gt;&lt;p&gt;2、决策边界的图形是什么样子的？是线性还是非线性。&lt;/p&gt;&lt;p&gt;3、确定损失函数，并且如何最小化损失函数，常用的损失函数有 均方根误差（mean-squared-error），交叉熵损失（cross-entropy loss），折页损失（hinge loss）等。&lt;/p&gt;&lt;p&gt;4、如何在过拟合和提升预测效果之间权衡。&lt;/p&gt;&lt;p&gt;5、最后，看下这个算法如何训练数据，如何根据x找到确定的y，这个算法的复杂度是多少，比如逻辑回归比较简单效率较高，而神经网络则需要较长的时间去训练数据，这个分类器是离散的还是连续的，连续的分类器试用任意的x和y。而离散的分类器是一个略完备的模型。逻辑回归用于离散变量的分类，即它的输出y的取值范围是一个离散的集合，因此是离散型分类器。&lt;/p&gt;&lt;p&gt;上图中的前五个分类器都是线性的，这些分类器预测的结果相近，只在前提条件，适用的分布，损失函数和如何缩小过拟合有些许不同。&lt;/p&gt;&lt;p&gt;其他分类器有的有非线性的决策边界：如Quadratic Discriminant Analysis, Multi-Layer Perceptron, Gaussian Naive Bayes, 和 Keras NN。剩下的分类器可能是分段线性的，如KNN, Trees, Bagging, Boosting，比如K近邻(KNN)算法是找到最近的k个邻居来进行分类的，而K是在交叉验证中得到的。应用Boosting模型最近在Kaggle机器学习大赛中获得了很多奖，它主要用的是集成学习的思路，即对新的实例进行分类的时候，把多个单分类器的结果进行某种组合，来对最终的结果进行分类。&lt;/p&gt;&lt;p&gt;下面简单介绍下其他的分类算法：&lt;/p&gt;&lt;p&gt;&lt;b&gt;决策树算法：&lt;/b&gt;决策树是一种简单但广泛使用的分类器，它通过训练数据构建决策树，对未知的数据进行分类。决策树的每个内部节点表示在一个属性上的测试，每个分枝代表该测试的一个输出，而每个树叶结点存放着一个类标号。&lt;/p&gt;&lt;p&gt;&lt;b&gt;Bagging算法：&lt;/b&gt;bootstrap aggregating的缩写。让该学习算法训练多轮，每轮的训练集由从初始的训练集中随机取出的n个训练倒组成，初始训练例在某轮训练集中可以出现多次或根本不出现训练之后可得到一个预测函数序列h．，… …h 最终的预测函数H对分类问题采用投票方式，对回归问题采用简单平均方法对新示例进行判别。&lt;/p&gt;&lt;p&gt;&lt;b&gt;决策森林：&lt;/b&gt;随机森林指通过多颗决策树联合组成的预测模型，可以对样本或者特征取bagging。&lt;/p&gt;&lt;p&gt;&lt;b&gt;Boosting算法：&lt;/b&gt;其中主要的是AdaBoost（Adaptive Boosting）。初始化时对每一个训练例赋相等的权重1／n，然后用该学算法对训练集训练t轮，每次训练后，对训练失败的训练例赋以较大的权重，也就是让学习算法在后续的学习中集中对比较难的训练铡进行学习，从而得到一个预测函数序列h 一…h其中h有一定的权重，预测效果好的预测函数权重较大，反之较小。最终的预测函数H对分类问题采用有权重的投票方式，对回归问题采用加权平均的方法对新示例进行判别。( 类似Bagging方法，但是训练是串行进行的，第k个分类器训练时关注对前k-1分类器中错分的文档，即不是随机取，而是加大取这些文档的概率)。&lt;/p&gt;&lt;p&gt;&lt;b&gt;集成算法：&lt;/b&gt;在运行了很多分类算法之后，我们可以选择最终的分类器模型。在上面的例子中，我们使用Voting Classifier模型，相比逻辑回归来说获得了85.9%的准确率和更好的AUC。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-abfef1c60310215a129162773f17bf2a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;1102&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-abfef1c60310215a129162773f17bf2a_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-abfef1c60310215a129162773f17bf2a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;1102&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-abfef1c60310215a129162773f17bf2a_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-abfef1c60310215a129162773f17bf2a_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;我们现在有了足够多的工具来对数据进行分类，收集和清洗以得到一个好的数据集，找到一个合适的模型就能解决80%的问题。&lt;/p&gt;&lt;p&gt;总结一下，在分类算法中，我们学到了&lt;/p&gt;&lt;p&gt;1、分类算法的基础&lt;/p&gt;&lt;p&gt;2、如何应用逻辑回归&lt;/p&gt;&lt;p&gt;3、不同分类算法的区别&lt;/p&gt;&lt;p&gt;4、如何组合分类算法以得到更好的结果&lt;/p&gt;&lt;p&gt;分类算法是机器学习算法的基础，很多机器学习问题的解决都始于分类算法，如语音识别、无人驾驶汽车等。在第二部分，我们将用分类算法建立一个价值投资和趋势投资的组合。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;第二部分：分类算法在投资的应用&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;下面我们将分析下分类算法在投资中的应用，我们先简述一些基础概念：&lt;/p&gt;&lt;h3&gt;&lt;b&gt;价值与动量&lt;/b&gt;&lt;/h3&gt;&lt;p&gt;价值投资策略核心是寻找高性价比的股票，通常我们使用PB(price/bookvalue)来衡量一个股票的性价比。我们将股票按照PB分成5个区间，逐月记录这五组股票的收益，这些是从1973到2017的结果。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-03a0c6a83441bf922203ee1f4b5ead02_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;772&quot; data-rawheight=&quot;912&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;772&quot; data-original=&quot;https://pic3.zhimg.com/v2-03a0c6a83441bf922203ee1f4b5ead02_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-03a0c6a83441bf922203ee1f4b5ead02_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;772&quot; data-rawheight=&quot;912&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;772&quot; data-original=&quot;https://pic3.zhimg.com/v2-03a0c6a83441bf922203ee1f4b5ead02_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-03a0c6a83441bf922203ee1f4b5ead02_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;从结果中我们可以得到，价值投资确实能赚钱。&lt;/p&gt;&lt;h3&gt;&lt;b&gt;趋势投资&lt;/b&gt;&lt;/h3&gt;&lt;p&gt;我们还可以用趋势策略，即挑选最近长势喜人的股票，这只股票可能最近有利好。利好可能包括：&lt;br/&gt;1、好的信息逐渐披露出来，比如公司前景喜人，开始可能只是内部人员了解，之后大众逐渐了解，利润增加，股票市场价格逐渐增长；&lt;/p&gt;&lt;p&gt;2、公司被低估，公司在招聘，市场，媒体上等各种表现超过大家预期，股价也会增长；&lt;/p&gt;&lt;p&gt;3、近期政策层利好等都会使股价近期提高；&lt;/p&gt;&lt;p&gt;趋势策略是市场形成的，那么如何用数据证明趋势策略有用，我们将股票按过去一年涨幅分成5个区间，走势图如下所示。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-1c03abcf793ed474c381afbce2dee4ae_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;768&quot; data-rawheight=&quot;918&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;768&quot; data-original=&quot;https://pic3.zhimg.com/v2-1c03abcf793ed474c381afbce2dee4ae_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-1c03abcf793ed474c381afbce2dee4ae_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;768&quot; data-rawheight=&quot;918&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;768&quot; data-original=&quot;https://pic3.zhimg.com/v2-1c03abcf793ed474c381afbce2dee4ae_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-1c03abcf793ed474c381afbce2dee4ae_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;价值策略和趋势策略相结合&lt;/b&gt;&lt;/p&gt;&lt;p&gt;为了给我们之后的分类算法一个比较的标准，我们按价值策略和趋势策略中的表现分别为每一只股票打分，把股票集合按分数进行排序形成组合，表现如下图：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-6722527c3c12676b00418c326e3f2f74_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;762&quot; data-rawheight=&quot;924&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;762&quot; data-original=&quot;https://pic1.zhimg.com/v2-6722527c3c12676b00418c326e3f2f74_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-6722527c3c12676b00418c326e3f2f74_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;762&quot; data-rawheight=&quot;924&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;762&quot; data-original=&quot;https://pic1.zhimg.com/v2-6722527c3c12676b00418c326e3f2f74_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-6722527c3c12676b00418c326e3f2f74_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;这样就给我们的模型一个比较的基准，这个组合的sharp ratio为0.47，让我们看看用机器学习的方式是不是能得到更好的结果。&lt;/p&gt;&lt;h3&gt;&lt;b&gt;分类算法是否有效&lt;/b&gt;&lt;/h3&gt;&lt;p&gt;首先，我们用个非常简单的分类方式，将股票按value/momentum的比值进行分类，对最好的那一类进行投资。对投资的组合每个月进行rebalance。&lt;/p&gt;&lt;p&gt;另外一个稍微复杂的方法，用逻辑回归进行预测，看看那只股票会在最好的投资区间，然后对最好的那一类进行投资。预测银子选择(P/B)和趋势因子，我们选择3个月的收益来看整个结果，以防止某个月的收益有扰动。&lt;/p&gt;&lt;p&gt;但是我们看到结果并不好，这个结果和我们最开始的基准差不太多，那么到底是什么原因？我们怎么才能得到更好的结果。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-87651d44730d427b1572c285bcf4545b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;778&quot; data-rawheight=&quot;916&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;778&quot; data-original=&quot;https://pic4.zhimg.com/v2-87651d44730d427b1572c285bcf4545b_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-87651d44730d427b1572c285bcf4545b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;778&quot; data-rawheight=&quot;916&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;778&quot; data-original=&quot;https://pic4.zhimg.com/v2-87651d44730d427b1572c285bcf4545b_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-87651d44730d427b1572c285bcf4545b_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;我们可以看到在这个逻辑回归中，随时函数用的是log loss损失函数，但是log loss损失函数把所有损失看成相同的。比如如果在第五区间的预测结果落到了第一区间，其实它的error是远比落在第四区间要大的多的。&lt;/p&gt;&lt;p&gt;另外一个问题是，如果我们得到一只股票在五个区间的概率0.30, 0.09, 0.11, 0.21, 0.29，第零区间和第四区间只有1%的差距，那么我们是否能确定落在第一区间呢？那么如果我们每次都把股票分到概率最高的区间可能会导致预测不准。我们把预测的结果画图，发现大部分都是落在表现最不好的两个区间内的。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-436eeb45e22dbe808a9eb0d5052adbb1_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;812&quot; data-rawheight=&quot;520&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;812&quot; data-original=&quot;https://pic2.zhimg.com/v2-436eeb45e22dbe808a9eb0d5052adbb1_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-436eeb45e22dbe808a9eb0d5052adbb1_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;812&quot; data-rawheight=&quot;520&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;812&quot; data-original=&quot;https://pic2.zhimg.com/v2-436eeb45e22dbe808a9eb0d5052adbb1_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-436eeb45e22dbe808a9eb0d5052adbb1_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;h3&gt;&lt;b&gt; 可以确定分类吗？&lt;/b&gt;&lt;/h3&gt;&lt;p&gt;0.30 x 0 + 0.09 x 1 + 0.11 x 2 + 0.21 x 3 + 0.29 x 4 = 2.1&lt;/p&gt;&lt;p&gt;为了使分类更有效，我将预测结果做了个加权平均，因此本来分给第零个区间的，被分给了第二个区间，用这个方式优化后，我们的结果为：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-c658d3890ecd6f54d8864abcc9afe558_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;788&quot; data-rawheight=&quot;924&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;788&quot; data-original=&quot;https://pic1.zhimg.com/v2-c658d3890ecd6f54d8864abcc9afe558_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-c658d3890ecd6f54d8864abcc9afe558_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;788&quot; data-rawheight=&quot;924&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;788&quot; data-original=&quot;https://pic1.zhimg.com/v2-c658d3890ecd6f54d8864abcc9afe558_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-c658d3890ecd6f54d8864abcc9afe558_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;好消息是我们的结果连续性更好了，并且收益和sharp ratio都有提高；坏消息是我们最好的区间sharp ratio为0.46，比最早做的逻辑回归还稍微差一点。&lt;/p&gt;&lt;p&gt;现实是残酷的，这可能是因为我们在最好的区间放了20%的股票，之前的逻辑回归，我们选了更少的股票，优中选优从而得到了更好的结果。&lt;/p&gt;&lt;h3&gt;&lt;b&gt;优化分类算法&lt;/b&gt;&lt;/h3&gt;&lt;p&gt;所以我们应该是选择对了方向，但是是否可以用更好的分类器来解决这个问题呢？&lt;/p&gt;&lt;p&gt;Gradient boosting models 是非常好的分类算法，我们可以尝试XGBoost分类算法来判别哪些股票会落入最好的投资区间。&lt;/p&gt;&lt;p&gt;结果如下：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-716b43334efc7de39efbc1d72468d917_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;760&quot; data-rawheight=&quot;908&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;760&quot; data-original=&quot;https://pic4.zhimg.com/v2-716b43334efc7de39efbc1d72468d917_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-716b43334efc7de39efbc1d72468d917_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;760&quot; data-rawheight=&quot;908&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;760&quot; data-original=&quot;https://pic4.zhimg.com/v2-716b43334efc7de39efbc1d72468d917_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-716b43334efc7de39efbc1d72468d917_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;分类是否是个好选择？&lt;/b&gt;&lt;/p&gt;&lt;p&gt;XGBoost分类算法得到的结果非常好，下面说下这个方法的缺点：&lt;/p&gt;&lt;p&gt;1、用三个1月的return要比一个月的return结果更平滑，降低过拟合，但是可能丢失了部分信息；&lt;/p&gt;&lt;p&gt;2、用log loss作为评价函数，容易使差不多概率的分类出错，如最好的区间概率0.3，最差区间概率0.29这种情况；&lt;/p&gt;&lt;p&gt;但是我们也有使用分类的理由：组合构建类似分类问题，选股票就是在做分类。但是我不建议直接应用分类算法，分类算法在预测收益和是否有default风险上很好用，在组合构建上也许有更好的方式。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;结论&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;我们学到了什么：&lt;/p&gt;&lt;p&gt;1、单独的价值策略或者趋势策略结果不错；&lt;/p&gt;&lt;p&gt;2、单纯的使用分类算法并不能得到好的收益；&lt;/p&gt;&lt;p&gt;3、Gradient boosting 分类算法能显著的提高结果；&lt;/p&gt;&lt;p&gt;4、直接进行逻辑回归也许是个更好的解决方法。&lt;/p&gt;&lt;p&gt;&lt;i&gt;—End—&lt;/i&gt;&lt;/p&gt;&lt;p&gt;量化投资与机器学习微信公众号，是业内垂直于&lt;b&gt;Quant&lt;/b&gt;、&lt;b&gt;MFE&lt;/b&gt;、&lt;b&gt;CST&lt;/b&gt;等专业的主流自媒体。公众号拥有来自&lt;b&gt;公募、私募、券商、银行、海外&lt;/b&gt;等众多圈内&lt;b&gt;10W+&lt;/b&gt;关注者。每日发布行业前沿研究成果和最新资讯。&lt;/p&gt;</description>
<author>量化投资机器学习</author>
<guid isPermaLink="false">2019-04-14-62408392</guid>
<pubDate>Sun, 14 Apr 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>独家 | 定制股票交易OpenAI Gym强化学习环境（附代码）</title>
<link>https://henix.github.io/feeds/zhuanlan.Lhtz-Jqxx/2019-04-14-62408172.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/62408172&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-61c8d4db7605b80d08f42959b31d99fc_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;▎作者：Adam King&lt;/p&gt;&lt;p&gt;&lt;b&gt;▎&lt;/b&gt;编译：公众号翻译部&lt;/p&gt;&lt;h2&gt;&lt;b&gt;前言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;OpenAI&lt;/b&gt; 的 gym 是一个很棒的软件包，允许你创建自定义强化学习agents。它提供了相当多的预构建环境，如CartPole、MountainCar，以及大量免费的Atari游戏供用户体验。&lt;/p&gt;&lt;p&gt;这些环境非常适合学习，但最终你将需要设置一个agent来解决自定义问题。为此，你需要创建一个关于你特定问题域的自定义环境。之后，我们将创建一个自定义股票市场环境来模拟股票交易。&lt;/p&gt;&lt;blockquote&gt;&lt;b&gt;代码在文末获取&lt;/b&gt;&lt;/blockquote&gt;&lt;p&gt;首先，让我们了解一下环境到底是什么。环境包含运行agent并允许其学习的所有必要功能。每个环境必须实现下gym界面：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-727b4021e0916b9fb99799e62b24bb17_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1058&quot; data-rawheight=&quot;1054&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1058&quot; data-original=&quot;https://pic4.zhimg.com/v2-727b4021e0916b9fb99799e62b24bb17_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-727b4021e0916b9fb99799e62b24bb17_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1058&quot; data-rawheight=&quot;1054&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1058&quot; data-original=&quot;https://pic4.zhimg.com/v2-727b4021e0916b9fb99799e62b24bb17_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-727b4021e0916b9fb99799e62b24bb17_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;在构造函数中，我们首先定义 action_space 的类型和大小，它将包含agent在环境中可能采取的所有操作。类似地，我们将定义 observation_space，它包含agent要观察的所有环境数据。&lt;/p&gt;&lt;p&gt;我们的重置方法将被调用，以周期性地将环境重置为初始状态。在此之后，将在环境中执行许多步骤，其中模型将提供一个操作，并且必须执行该操作，然后返回下一个观察结果。这也是计算奖励的地方，稍后会详细介绍。&lt;/p&gt;&lt;p&gt;最后，可以定期调用render方法来打印再现的环境。这可以像打印语句一样简单，也可以像使用openGL渲染3D环境一样复杂。对于本例，我们将坚持使用print语句。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;股票交易环境&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;我们将创建一个股票交易环境。然后，我们将训练agent成为一个有利可图的贸易环境。&lt;/p&gt;&lt;p&gt;我们需要考虑的第一件事是人工交易者如何感知他们所处的环境。&lt;b&gt;在决定交易之前，他们会观察到什么?&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;交易员很可能会看一些股票价格走势的图表，或许还会加上一些技术指标。在此基础上，他们将把这些视觉信息与他们之前对类似价格走势的了解相结合，从而对股票可能的走势做出明智的决定。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;所以让我们把这转换成我们的agent应该如何感知它的环境。&lt;/p&gt;&lt;p&gt;observation_space包含我们希望agent在进行交易之前或不进行交易之前考虑的所有输入变量。在本例中，我们希望agent查看过去五天股票的数据（开、高、低、收和日成交量），以及其他一些数据，如帐户余额、当前股票头寸和当前利润。&lt;/p&gt;&lt;p&gt;这里的直觉是，对于每个时间步骤，我们希望我们的agent考虑导致当前价格价格变动的行为，以及它们自己的投资组合的状态，以便为下一步行动做出明智的决策。&lt;/p&gt;&lt;p&gt;一旦交易者感知到了他们所处的环境，他们就需要采取行动。在我们的agent例子中，它的action_space将包含三种可能性：&lt;b&gt;买进股票、卖出股票或什么都不做&lt;/b&gt;。&lt;/p&gt;&lt;p&gt;但这还不，我们需要知道每次买入或卖出的股票数量。使用gym的Box space，我们可以创建一个动作空间，其中包含离散数量的动作类型（买进、卖出和持有），以及连续的买进/卖出金额（分别为：账户余额/头寸大小的0-100%）。&lt;/p&gt;&lt;p&gt;你将注意到这个金额对于hold操作是不必要的，但是无论如何都会提供。我们的agent最初并不知道这一点，但随着时间的推移，应该会知道这个金额与此操作无关。&lt;/p&gt;&lt;p&gt;在实现我们的环境之前，最后要考虑的是激励。我们想激励长期持续的利润。在每个步骤，我们将把激励设置为账户余额乘以到目前为止的时间步数的一部分。&lt;/p&gt;&lt;p&gt;&lt;b&gt;这样做的目的是在早期阶段推迟对agent的过快奖励，并允许它在过于深入地优化单个策略之前进行充分的探索。它还将奖励那些长期维持较高平衡的agent，而不是那些使用不可持续策略快速赚钱的agent。&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;实现&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;现在我们已经定义了我们的观察空间、行动空间和激励，是时候实现我们的环境了。首先，我们需要在环境的构造函数中定义action_space和observation_space。环境期望传入一个pandas的dataframe，其中包含要学习的股票数据。类似这样的数据格式：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-32a9416aa6bb4f0c140c2ad167ed876b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;438&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-32a9416aa6bb4f0c140c2ad167ed876b_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-32a9416aa6bb4f0c140c2ad167ed876b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;438&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-32a9416aa6bb4f0c140c2ad167ed876b_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-32a9416aa6bb4f0c140c2ad167ed876b_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-466153cb451005ffa6e210cc212e1720_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;449&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-466153cb451005ffa6e210cc212e1720_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-466153cb451005ffa6e210cc212e1720_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;449&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-466153cb451005ffa6e210cc212e1720_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-466153cb451005ffa6e210cc212e1720_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;接下来，我们将编写reset方法，在创建新环境或重置现有环境的状态时调用该方法。在这里，我们将设置每个agent的初始余额，并将其打开位置初始化为空列表。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-e275e5e66988b571f772a2bb82f53adb_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;421&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-e275e5e66988b571f772a2bb82f53adb_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-e275e5e66988b571f772a2bb82f53adb_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;421&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-e275e5e66988b571f772a2bb82f53adb_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-e275e5e66988b571f772a2bb82f53adb_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;我们将当前步骤设置为dataframe中的一个随机点，因为我们的许多agent经常在训练中重置环境。nextObservation方法编译最后五个时间步骤的股票数据，附加agent的帐户信息，并将所有值缩放到0到1之间。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-6e3dddc20c37427be73fc8ad3fc60aa9_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;716&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-6e3dddc20c37427be73fc8ad3fc60aa9_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-6e3dddc20c37427be73fc8ad3fc60aa9_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;716&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-6e3dddc20c37427be73fc8ad3fc60aa9_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-6e3dddc20c37427be73fc8ad3fc60aa9_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;接下来，我们的环境需要能够迈出一步。在每一步，我们将采取指定的行动（由我们的模型选择），计算激励，并返回下一个观察结果。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-e638cd2ce8a7781d070b8bf678e91f91_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;446&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-e638cd2ce8a7781d070b8bf678e91f91_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-e638cd2ce8a7781d070b8bf678e91f91_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;446&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-e638cd2ce8a7781d070b8bf678e91f91_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-e638cd2ce8a7781d070b8bf678e91f91_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;现在，我们的_takeAction方法需要执行模型提供的操作，并购买、出售或持有股票。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-8884248261fe1094439486ff019a22a1_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;986&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-8884248261fe1094439486ff019a22a1_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-8884248261fe1094439486ff019a22a1_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;986&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-8884248261fe1094439486ff019a22a1_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-8884248261fe1094439486ff019a22a1_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;现在唯一要做的就是将环境呈现到屏幕上。为了简单起见，我们将呈现到目前为止的利润和一些其他有趣的指标。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-121d71ae5917a1c4f6afc1a22994f97d_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;484&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-121d71ae5917a1c4f6afc1a22994f97d_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-121d71ae5917a1c4f6afc1a22994f97d_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;484&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-121d71ae5917a1c4f6afc1a22994f97d_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-121d71ae5917a1c4f6afc1a22994f97d_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;我们的环境是完整的。现在，我们可以使用dataframe实例化StockTradingEnv环境，并使用来自stable-baselines的模型对其进行测试。&lt;/p&gt;&lt;p&gt;&lt;i&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/hill-a/stable-baselines&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;github.com/hill-a/stabl&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;e-baselines&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/i&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-150ff0bb293e1a2e22cf77f0cc9f720b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;737&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-150ff0bb293e1a2e22cf77f0cc9f720b_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-150ff0bb293e1a2e22cf77f0cc9f720b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;737&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-150ff0bb293e1a2e22cf77f0cc9f720b_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-150ff0bb293e1a2e22cf77f0cc9f720b_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-9fd4013033a9e0276d724298096c648b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;708&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-9fd4013033a9e0276d724298096c648b_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-9fd4013033a9e0276d724298096c648b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;708&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-9fd4013033a9e0276d724298096c648b_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-9fd4013033a9e0276d724298096c648b_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;当然，我们先做了个简单的测试，如果真的想通过使用深度学习对股市进行应用，那将需要更多的时间和精力。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;推荐阅读&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289074%26idx%3D1%26sn%3De859d363eef9249236244466a1af41b6%26chksm%3D802e3867b759b1717f77e07a51ee5671e8115130c66562577280ba1243cba08218add04f1f00%26token%3D449379994%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;01、经过多年交易之后你应该学到的东西（深度分享）&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289050%26idx%3D1%26sn%3D60043a5c95b877dd329a5fd150ddacc4%26chksm%3D802e384fb759b1598e500087374772059aa21b31ae104b3dca04331cf4b63a233c5e04c1945a%26token%3D449379994%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;02、监督学习标签在股市中的应用（代码+书籍）&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289018%26idx%3D1%26sn%3D8c411f676c2c0d92b0dd218f041bee4b%26chksm%3D802e382fb759b139ffebf633ac14cdd0f21938e4613fe632d5d9231dab3d2aca95a11628378a%26token%3D449379994%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;03、全球投行顶尖机器学习团队全面分析&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289014%26idx%3D1%26sn%3D3762d405e332c599a21b48a7dc4df587%26chksm%3D802e3823b759b135928d55044c2729aea9690f86752b680eb973d1a376dc53cfa18287d0060b%26token%3D449379994%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;04、使用Tensorflow预测股票市场变动&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289238%26idx%3D1%26sn%3D3144f5792f84455dd53c27a78e8a316c%26chksm%3D802e3903b759b015da88acde4fcbc8547ab3e6acbb5a0897404bbefe1d8a414265d5d5766ee4%26token%3D2020206794%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;05、使用LSTM预测股票市场基于Tensorflow&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289314%26idx%3D1%26sn%3D87c5a12b23a875966db7be50d11f09cd%26chksm%3D802e3977b759b061675d1988168c1fec06c602e8583fbcc9b76f87008e0c10b702acc85467a0%26token%3D1972390229%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;06、美丽的回测——教你定量计算过拟合概率&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289347%26idx%3D1%26sn%3Dbf5d7899bc4a854d4ba9046fdc6fe0d6%26chksm%3D802e3996b759b080287213840987bb0a0c02e4e1d4d7aae23f10a225a92ef6dd922d8006123d%26token%3D290397496%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;07、利用动态深度学习预测金融时间序列基于Python&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289394%26idx%3D1%26sn%3D24a836136d730aa268605628e683d629%26chksm%3D802e39a7b759b0b1dcf7aaa560699130a907716b71fc9c45ff0e5d236c5ae8ef80ebdb09dbb6%26token%3D290397496%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;08、Facebook开源神器Prophet预测时间序列基于Python&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289437%26idx%3D1%26sn%3Df0dca7da8e69e7ba736992cb3d034ce7%26chksm%3D802e39c8b759b0de5bce401c580623d0729ecca69d13926479d36e19aff8c9c9e8a20265afff%26token%3D290397496%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;09、Facebook开源神器Prophet预测股市行情基于Python&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289358%26idx%3D1%26sn%3Ddb6e8ab85b08f6e67790ec0e401e586e%26chksm%3D802e399bb759b08d6eec855f9901ea856d0da68c7425cba62791b8948da6ad761a3d88543dad%26token%3D290397496%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;10、2018第三季度最受欢迎的券商金工研报前50（附下载）&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289447%26idx%3D1%26sn%3Df2948715bf82569a6556d518e56c1f9e%26chksm%3D802e39f2b759b0e4502d1aaac562b87789573b55c76b3c85897d8c9d88dbf9a0b7ee34d86a4e%26token%3D290397496%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;11、实战交易策略的精髓（公众号深度呈现）&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289478%26idx%3D1%26sn%3Df8e01a641be021993d8ef2d84e94a299%26chksm%3D802e3e13b759b7055cf27a280c672371008a5564c97c658eee89ce8481396a28d254836ff9af%26token%3D290397496%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;12、Markowitz有效边界和投资组合优化基于Python&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289495%26idx%3D1%26sn%3Dc4eeaa2e9f9c10995be9ea0c56d29ba7%26chksm%3D802e3e02b759b7148227675c23c403fb9a543b733e3d27fa237b53840e030bf387a473d83e3c%26token%3D1260956004%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;13、使用LSTM模型预测股价基于Keras&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289507%26idx%3D1%26sn%3Df0ca71aa07531bbbdbd33213f0bab89f%26chksm%3D802e3e36b759b720138b3b17a4dd0e198e054b9de29a038fdd50805f824effa55831111ad026%26token%3D1936245282%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;14、量化金融导论1：资产收益的程式化介绍基于Python&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289533%26idx%3D1%26sn%3D4ef964834e84a9995111bb057b0fc5dd%26chksm%3D802e3e28b759b73e0618eb1262c53aa0601fbf5805525a7c7ff40dc3db62c7704496611bdbf1%26token%3D1950551577%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;15、预测股市崩盘基于统计机器学习与神经网络（Python+文档）&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289609%26idx%3D1%26sn%3Dc7f0b3e47025862d10bb53b6ab88bcda%26chksm%3D802e3e9cb759b78abf6b8b049c59bf18ccfb2ead7580d1f557d36de2292f59dcbd94dcd41910%26token%3D2085008037%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;16、实现最优投资组合有效前沿基于Python（附代码）&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289615%26idx%3D1%26sn%3D1cdc89afb997d0c580bf0cef296d946c%26chksm%3D802e3e9ab759b78ce9f0cd152a680d4a413d6c8dcb02a7a296f4091993a7e4137e7520394575%26token%3D2085008037%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;17、精心为大家整理了一些超级棒的机器学习资料（附链接）&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289623%26idx%3D1%26sn%3D28a3600fd7a72d7be00b066ca0f98244%26chksm%3D802e3e82b759b7943f43a4f6ef4a91e4153fa6b8210de9590235fa8ee66eb9811ce177054dbc%26token%3D1389401983%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;18、海量Wind数据，与全网用户零距离邂逅！&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289640%26idx%3D1%26sn%3D34e94fcbe99052b8e7381ecc48a36dc0%26chksm%3D802e3ebdb759b7ab897cd329a680715b6f8294e63550ddf0c57b9e1320b2b7d1408c6fdca0c7%26token%3D1389401983%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;19、机器学习、深度学习、量化金融、Python等最新书籍汇总下载&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289725%26idx%3D1%26sn%3D4b65cd1fb8331438e4c0b3d0eae6b51f%26chksm%3D802e3ee8b759b7fe1b94e84d54cc23b0ab05853d5cd227812574b350e9fc2cce9e5f1bc6cb7a%26token%3D1389401983%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;20、各大卖方2019年A股策略报告，都是有故事的人！&lt;/a&gt;&lt;/p&gt;&lt;h3&gt;&lt;b&gt;如何获取代码&lt;/b&gt;&lt;/h3&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s/_A0q8DFAsIclaofVgZfjMA&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic3.zhimg.com/v2-b27bd1b689d0289f1dff01388574ae46_180x120.jpg&quot; data-image-width=&quot;1280&quot; data-image-height=&quot;544&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;独家 | 定制股票交易OpenAI Gym强化学习环境（附代码）&lt;/a&gt;&lt;p&gt;&lt;i&gt;—End—&lt;/i&gt;&lt;/p&gt;&lt;p&gt;量化投资与机器学习微信公众号，是业内垂直于&lt;b&gt;Quant&lt;/b&gt;、&lt;b&gt;MFE&lt;/b&gt;、&lt;b&gt;CST&lt;/b&gt;等专业的主流自媒体。公众号拥有来自&lt;b&gt;公募、私募、券商、银行、海外&lt;/b&gt;等众多圈内&lt;b&gt;10W+&lt;/b&gt;关注者。每日发布行业前沿研究成果和最新资讯。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>量化投资机器学习</author>
<guid isPermaLink="false">2019-04-14-62408172</guid>
<pubDate>Sun, 14 Apr 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>超级干货 | ML、DL预测股市模型汇总（史上最全，没有之一）</title>
<link>https://henix.github.io/feeds/zhuanlan.Lhtz-Jqxx/2019-04-14-62407696.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/62407696&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-b84c7b82eeb0a5ee32cac2628d2eb3d3_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;前言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;今天给大家分享一个超级干货：机器学习、深度学习预测股票的所有模型大汇总。&lt;/p&gt;&lt;p&gt;全程代码分享！！！！！！！！！！！&lt;/p&gt;&lt;blockquote&gt;&lt;b&gt;代码在文末获取&lt;/b&gt;&lt;/blockquote&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-b3998cebc88e7e49e7590fc9a486027c_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;406&quot; data-rawheight=&quot;442&quot; class=&quot;content_image&quot; width=&quot;406&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-b3998cebc88e7e49e7590fc9a486027c_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;406&quot; data-rawheight=&quot;442&quot; class=&quot;content_image lazy&quot; width=&quot;406&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-b3998cebc88e7e49e7590fc9a486027c_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;h2&gt;&lt;b&gt;Stacking models&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;1、Deep Feed-forward Auto-Encoder Neural Network to reduce dimension + Deep Recurrent Neural Network + ARIMA + Extreme Boosting Gradient Regressor&lt;/p&gt;&lt;p&gt;2、Adaboost + Bagging + Extra Trees + Gradient Boosting + Random Forest + XGB&lt;/p&gt;&lt;h2&gt;&lt;b&gt;Deep-learning models&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;1、LSTM Recurrent Neural Network&lt;/p&gt;&lt;p&gt;2、ncoder-Decoder Feed-forward + LSTM Recurrent Neural Network&lt;/p&gt;&lt;p&gt;3、LSTM Bidirectional Neural Network&lt;/p&gt;&lt;p&gt;4、2-Path LSTM Recurrent Neural Network&lt;/p&gt;&lt;p&gt;5、GRU Recurrent Neural Network&lt;/p&gt;&lt;p&gt;6、Encoder-Decoder Feed-forward + GRU Recurrent Neural Network&lt;/p&gt;&lt;p&gt;7、GRU Bidirectional Neural Network&lt;/p&gt;&lt;p&gt;8、2-Path GRU Recurrent Neural Network&lt;/p&gt;&lt;p&gt;9、Vanilla Recurrent Neural Network&lt;/p&gt;&lt;p&gt;10、Encoder-Decoder Feed-forward + Vanilla Recurrent Neural Network&lt;/p&gt;&lt;p&gt;11、Vanilla Bidirectional Neural Network&lt;/p&gt;&lt;p&gt;12、2-Path Vanilla Recurrent Neural Network&lt;/p&gt;&lt;p&gt;13、LSTM Sequence-to-Sequence Recurrent Neural Network&lt;/p&gt;&lt;p&gt;14、LSTM with Attention Recurrent Neural Network&lt;/p&gt;&lt;p&gt;15、LSTM Sequence-to-Sequence with Attention Recurrent Neural Network&lt;/p&gt;&lt;p&gt;16、LSTM Sequence-to-Sequence Bidirectional Recurrent Neural Network&lt;/p&gt;&lt;p&gt;17、LSTM Sequence-to-Sequence with Attention Bidirectional Recurrent Neural Network&lt;/p&gt;&lt;p&gt;18、LSTM with Attention Scaled-Dot Recurrent Neural Network&lt;/p&gt;&lt;p&gt;19、LSTM with Dilated Recurrent Neural Network&lt;/p&gt;&lt;p&gt;20、Only Attention Neural Network&lt;/p&gt;&lt;p&gt;21、Multihead Attention Neural Network&lt;/p&gt;&lt;p&gt;22、LSTM with Bahdanau Attention&lt;/p&gt;&lt;p&gt;23、LSTM with Luong Attention&lt;/p&gt;&lt;p&gt;24、LSTM with Bahdanau + Luong Attention&lt;/p&gt;&lt;p&gt;25、DNC Recurrent Neural Network&lt;/p&gt;&lt;p&gt;26、Residual LSTM Recurrent Neural Network&lt;/p&gt;&lt;p&gt;27、Byte-net&lt;/p&gt;&lt;p&gt;28、Attention is all you need&lt;/p&gt;&lt;p&gt;29、Fairseq&lt;/p&gt;&lt;h2&gt;&lt;b&gt;Agents&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;1、Turtle-trading agent&lt;/p&gt;&lt;p&gt;2、Moving-average agent&lt;/p&gt;&lt;p&gt;3、Signal rolling agent&lt;/p&gt;&lt;p&gt;4、Policy-gradient agent&lt;/p&gt;&lt;p&gt;5、Q-learning agent&lt;/p&gt;&lt;p&gt;6、Evolution-strategy agent&lt;/p&gt;&lt;p&gt;7、Double Q-learning agent&lt;/p&gt;&lt;p&gt;8、Recurrent Q-learning agent&lt;/p&gt;&lt;p&gt;9、Double Recurrent Q-learning agent&lt;/p&gt;&lt;p&gt;10、Duel Q-learning agent&lt;/p&gt;&lt;p&gt;11、Double Duel Q-learning agent&lt;/p&gt;&lt;p&gt;12、Duel Recurrent Q-learning agent&lt;/p&gt;&lt;p&gt;13、Double Duel Recurrent Q-learning agent&lt;/p&gt;&lt;p&gt;14、Actor-critic agent&lt;/p&gt;&lt;p&gt;15、Actor-critic Duel agent&lt;/p&gt;&lt;p&gt;16、Actor-critic Recurrent agent&lt;/p&gt;&lt;p&gt;17、Actor-critic Duel Recurrent agent&lt;/p&gt;&lt;p&gt;18、Curiosity Q-learning agent&lt;/p&gt;&lt;p&gt;19、Recurrent Curiosity Q-learning agent&lt;/p&gt;&lt;p&gt;20、Duel Curiosity Q-learning agent&lt;/p&gt;&lt;p&gt;21、Neuro-evolution agent&lt;/p&gt;&lt;p&gt;22、Neuro-evolution with Novelty search agent&lt;/p&gt;&lt;p&gt;23、ABCD strategy agent&lt;/p&gt;&lt;h2&gt;&lt;b&gt;Data Explorations&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;1、stock market study on TESLA stock&lt;/p&gt;&lt;p&gt;2、fashion trending prediction with cross-validatio&lt;/p&gt;&lt;p&gt;3、Bitcoin analysis with LSTM predictionOutliers study using K-means, SVM, and Gaussian on TESLA stock &lt;/p&gt;&lt;p&gt;4、Kijang Emas Bank Negara&lt;/p&gt;&lt;h2&gt;&lt;b&gt;Simulations&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;1、Stock market simulation using Monte Carlo&lt;br/&gt;2、Stock market simulation using Monte Carlo Markov Chain Metropolis-Hasting&lt;/p&gt;&lt;h2&gt;&lt;b&gt;Tensorflow-js&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;LSTM Recurrent Neural Network and Simple signal rolling agent inside &lt;br/&gt;&lt;/p&gt;&lt;h3&gt;&lt;b&gt;部分结果展示&lt;/b&gt;&lt;/h3&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-2af5dfe40f39cd0bd4d4d89a27e8305b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;894&quot; data-rawheight=&quot;321&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;894&quot; data-original=&quot;https://pic4.zhimg.com/v2-2af5dfe40f39cd0bd4d4d89a27e8305b_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-2af5dfe40f39cd0bd4d4d89a27e8305b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;894&quot; data-rawheight=&quot;321&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;894&quot; data-original=&quot;https://pic4.zhimg.com/v2-2af5dfe40f39cd0bd4d4d89a27e8305b_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-2af5dfe40f39cd0bd4d4d89a27e8305b_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-fc98ed83694eafe63fc7a965191bb3c8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;540&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-fc98ed83694eafe63fc7a965191bb3c8_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-fc98ed83694eafe63fc7a965191bb3c8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;540&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-fc98ed83694eafe63fc7a965191bb3c8_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-fc98ed83694eafe63fc7a965191bb3c8_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-729ba4b666b45167892e1c2e31d14c2b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;883&quot; data-rawheight=&quot;582&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;883&quot; data-original=&quot;https://pic4.zhimg.com/v2-729ba4b666b45167892e1c2e31d14c2b_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-729ba4b666b45167892e1c2e31d14c2b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;883&quot; data-rawheight=&quot;582&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;883&quot; data-original=&quot;https://pic4.zhimg.com/v2-729ba4b666b45167892e1c2e31d14c2b_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-729ba4b666b45167892e1c2e31d14c2b_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-d1fe0c625db9bcbe47bddae1b47ae09c_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;883&quot; data-rawheight=&quot;582&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;883&quot; data-original=&quot;https://pic1.zhimg.com/v2-d1fe0c625db9bcbe47bddae1b47ae09c_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-d1fe0c625db9bcbe47bddae1b47ae09c_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;883&quot; data-rawheight=&quot;582&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;883&quot; data-original=&quot;https://pic1.zhimg.com/v2-d1fe0c625db9bcbe47bddae1b47ae09c_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-d1fe0c625db9bcbe47bddae1b47ae09c_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-d5501deea27d4517abc297dc099963c8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;883&quot; data-rawheight=&quot;373&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;883&quot; data-original=&quot;https://pic1.zhimg.com/v2-d5501deea27d4517abc297dc099963c8_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-d5501deea27d4517abc297dc099963c8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;883&quot; data-rawheight=&quot;373&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;883&quot; data-original=&quot;https://pic1.zhimg.com/v2-d5501deea27d4517abc297dc099963c8_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-d5501deea27d4517abc297dc099963c8_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;h2&gt;&lt;b&gt;推荐阅读&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289074%26idx%3D1%26sn%3De859d363eef9249236244466a1af41b6%26chksm%3D802e3867b759b1717f77e07a51ee5671e8115130c66562577280ba1243cba08218add04f1f00%26token%3D449379994%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;01、经过多年交易之后你应该学到的东西（深度分享）&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289050%26idx%3D1%26sn%3D60043a5c95b877dd329a5fd150ddacc4%26chksm%3D802e384fb759b1598e500087374772059aa21b31ae104b3dca04331cf4b63a233c5e04c1945a%26token%3D449379994%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;02、监督学习标签在股市中的应用（代码+书籍）&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289018%26idx%3D1%26sn%3D8c411f676c2c0d92b0dd218f041bee4b%26chksm%3D802e382fb759b139ffebf633ac14cdd0f21938e4613fe632d5d9231dab3d2aca95a11628378a%26token%3D449379994%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;03、全球投行顶尖机器学习团队全面分析&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289014%26idx%3D1%26sn%3D3762d405e332c599a21b48a7dc4df587%26chksm%3D802e3823b759b135928d55044c2729aea9690f86752b680eb973d1a376dc53cfa18287d0060b%26token%3D449379994%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;04、使用Tensorflow预测股票市场变动&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289238%26idx%3D1%26sn%3D3144f5792f84455dd53c27a78e8a316c%26chksm%3D802e3903b759b015da88acde4fcbc8547ab3e6acbb5a0897404bbefe1d8a414265d5d5766ee4%26token%3D2020206794%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;05、使用LSTM预测股票市场基于Tensorflow&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289314%26idx%3D1%26sn%3D87c5a12b23a875966db7be50d11f09cd%26chksm%3D802e3977b759b061675d1988168c1fec06c602e8583fbcc9b76f87008e0c10b702acc85467a0%26token%3D1972390229%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;06、美丽的回测——教你定量计算过拟合概率&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289347%26idx%3D1%26sn%3Dbf5d7899bc4a854d4ba9046fdc6fe0d6%26chksm%3D802e3996b759b080287213840987bb0a0c02e4e1d4d7aae23f10a225a92ef6dd922d8006123d%26token%3D290397496%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;07、利用动态深度学习预测金融时间序列基于Python&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289394%26idx%3D1%26sn%3D24a836136d730aa268605628e683d629%26chksm%3D802e39a7b759b0b1dcf7aaa560699130a907716b71fc9c45ff0e5d236c5ae8ef80ebdb09dbb6%26token%3D290397496%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;08、Facebook开源神器Prophet预测时间序列基于Python&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289437%26idx%3D1%26sn%3Df0dca7da8e69e7ba736992cb3d034ce7%26chksm%3D802e39c8b759b0de5bce401c580623d0729ecca69d13926479d36e19aff8c9c9e8a20265afff%26token%3D290397496%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;09、Facebook开源神器Prophet预测股市行情基于Python&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289358%26idx%3D1%26sn%3Ddb6e8ab85b08f6e67790ec0e401e586e%26chksm%3D802e399bb759b08d6eec855f9901ea856d0da68c7425cba62791b8948da6ad761a3d88543dad%26token%3D290397496%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;10、2018第三季度最受欢迎的券商金工研报前50（附下载）&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289447%26idx%3D1%26sn%3Df2948715bf82569a6556d518e56c1f9e%26chksm%3D802e39f2b759b0e4502d1aaac562b87789573b55c76b3c85897d8c9d88dbf9a0b7ee34d86a4e%26token%3D290397496%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;11、实战交易策略的精髓（公众号深度呈现）&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289478%26idx%3D1%26sn%3Df8e01a641be021993d8ef2d84e94a299%26chksm%3D802e3e13b759b7055cf27a280c672371008a5564c97c658eee89ce8481396a28d254836ff9af%26token%3D290397496%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;12、Markowitz有效边界和投资组合优化基于Python&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289495%26idx%3D1%26sn%3Dc4eeaa2e9f9c10995be9ea0c56d29ba7%26chksm%3D802e3e02b759b7148227675c23c403fb9a543b733e3d27fa237b53840e030bf387a473d83e3c%26token%3D1260956004%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;13、使用LSTM模型预测股价基于Keras&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289507%26idx%3D1%26sn%3Df0ca71aa07531bbbdbd33213f0bab89f%26chksm%3D802e3e36b759b720138b3b17a4dd0e198e054b9de29a038fdd50805f824effa55831111ad026%26token%3D1936245282%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;14、量化金融导论1：资产收益的程式化介绍基于Python&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289533%26idx%3D1%26sn%3D4ef964834e84a9995111bb057b0fc5dd%26chksm%3D802e3e28b759b73e0618eb1262c53aa0601fbf5805525a7c7ff40dc3db62c7704496611bdbf1%26token%3D1950551577%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;15、预测股市崩盘基于统计机器学习与神经网络（Python+文档）&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289609%26idx%3D1%26sn%3Dc7f0b3e47025862d10bb53b6ab88bcda%26chksm%3D802e3e9cb759b78abf6b8b049c59bf18ccfb2ead7580d1f557d36de2292f59dcbd94dcd41910%26token%3D2085008037%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;16、实现最优投资组合有效前沿基于Python（附代码）&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289615%26idx%3D1%26sn%3D1cdc89afb997d0c580bf0cef296d946c%26chksm%3D802e3e9ab759b78ce9f0cd152a680d4a413d6c8dcb02a7a296f4091993a7e4137e7520394575%26token%3D2085008037%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;17、精心为大家整理了一些超级棒的机器学习资料（附链接）&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289623%26idx%3D1%26sn%3D28a3600fd7a72d7be00b066ca0f98244%26chksm%3D802e3e82b759b7943f43a4f6ef4a91e4153fa6b8210de9590235fa8ee66eb9811ce177054dbc%26token%3D1389401983%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;18、海量Wind数据，与全网用户零距离邂逅！&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289640%26idx%3D1%26sn%3D34e94fcbe99052b8e7381ecc48a36dc0%26chksm%3D802e3ebdb759b7ab897cd329a680715b6f8294e63550ddf0c57b9e1320b2b7d1408c6fdca0c7%26token%3D1389401983%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;19、机器学习、深度学习、量化金融、Python等最新书籍汇总下载&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289725%26idx%3D1%26sn%3D4b65cd1fb8331438e4c0b3d0eae6b51f%26chksm%3D802e3ee8b759b7fe1b94e84d54cc23b0ab05853d5cd227812574b350e9fc2cce9e5f1bc6cb7a%26token%3D1389401983%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;20、各大卖方2019年A股策略报告，都是有故事的人！&lt;/a&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;如何获取代码&lt;/b&gt;&lt;/h2&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s/i6a3VimTOi8yQfdTp_npSg&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic1.zhimg.com/v2-9bd54611943d793a918a99b7b857908c_ipico.jpg&quot; data-image-width=&quot;1080&quot; data-image-height=&quot;1080&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;超级干货 | ML、DL预测股市模型汇总（史上最全，没有之一）&lt;/a&gt;&lt;p&gt;&lt;i&gt;—End—&lt;/i&gt;&lt;/p&gt;&lt;p&gt;量化投资与机器学习微信公众号，是业内垂直于&lt;b&gt;Quant&lt;/b&gt;、&lt;b&gt;MFE&lt;/b&gt;、&lt;b&gt;CST&lt;/b&gt;等专业的主流自媒体。公众号拥有来自&lt;b&gt;公募、私募、券商、银行、海外&lt;/b&gt;等众多圈内&lt;b&gt;10W+&lt;/b&gt;关注者。每日发布行业前沿研究成果和最新资讯。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>量化投资机器学习</author>
<guid isPermaLink="false">2019-04-14-62407696</guid>
<pubDate>Sun, 14 Apr 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>打造新一代高频交易 | MIT才女Christina Qi专访</title>
<link>https://henix.github.io/feeds/zhuanlan.Lhtz-Jqxx/2019-04-14-62407470.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/62407470&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-aaaa5cb591b55102879bfb9ff1f295b9_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;公众号导读&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;Christina Qi被誉为业内最受欢迎的女性，实至名归。从麻省理工学院（MIT）毕业后不久，她与其他人共同创立了Domeyard对冲基金。6年后，Christina Qi和他的联合创始人如今已成为对冲基金和金融科技领域的领军人物。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;背景&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;2016年10月，在普林斯顿Quant Trading Conference组委会演讲晚宴上，我遇到了Christina Qi。我和她谈了我在这个行业的经历以及想要追求它的激情。我还主持了她所在的小组，这给了我一个更好的机会去更多地了解她的为人和她的成功。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-9574413f55c6ce6b5f11b979ac660b41_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;640&quot; data-rawheight=&quot;960&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;640&quot; data-original=&quot;https://pic2.zhimg.com/v2-9574413f55c6ce6b5f11b979ac660b41_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-9574413f55c6ce6b5f11b979ac660b41_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;640&quot; data-rawheight=&quot;960&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;640&quot; data-original=&quot;https://pic2.zhimg.com/v2-9574413f55c6ce6b5f11b979ac660b41_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-9574413f55c6ce6b5f11b979ac660b41_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;h2&gt;&lt;b&gt;Christina Qi&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;Domeyard LP合伙人、《福布斯》30位30岁以下富豪。27岁的Christina Qi完成了大多数人一生中可能从未想过要做的事情。在MIT读本科时，她与两位联合创始人共同创建了Domeyard。白天，她会去上课，晚上，她会交易并努力发展公司。Christina Qi在本科期间接触了这个行业，当时她在高盛、UBS、Zions银行和麻省理工学院林肯实验室（MIT Lincoln Laboratory）等几家大型投行实习。除此之外，她还是MIT的客座讲师，与诺贝尔奖得主罗Robert Merton共事。像她这样的女性很少，她的道路是独一无二的，因为她正在做她自己喜欢做的事情，因为她全心全意地热衷于此，而不是因为其他人才这样做。&lt;/p&gt;&lt;p&gt;好了后面的介绍你们要全程看英文啦。不是我们不翻译哈。一是希望原汁原味呈现，二是搞量化的多看看国外文献、论坛啥的很正常啊，英语是要过关的呢！&lt;/p&gt;&lt;p&gt;周末快乐&lt;/p&gt;&lt;h2&gt;&lt;b&gt;What Christina does and how she does it&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;When speaking with Christina, I asked her “what motivated you to start your hedge fund and what was your vision?” In response she told me a long story about how during her student years when she interned for several large investment banks, she felt there wasn’t a lot of use of technology. As a millennial, technology plays a huge role in our everyday lives. She wanted to come up with a way in which firms could utilize and access technology easier and incorporate it into their trading routines. With the growth of technology taking over the space of many investment banks and trading firms, she wanted to bring it to places that needed it the most.&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-28406d2edef4342c5cefa7ed1288c489_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;787&quot; data-rawheight=&quot;525&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;787&quot; data-original=&quot;https://pic2.zhimg.com/v2-28406d2edef4342c5cefa7ed1288c489_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-28406d2edef4342c5cefa7ed1288c489_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;787&quot; data-rawheight=&quot;525&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;787&quot; data-original=&quot;https://pic2.zhimg.com/v2-28406d2edef4342c5cefa7ed1288c489_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-28406d2edef4342c5cefa7ed1288c489_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;Domeyard LP is a Boston-based hedge fund specializes in high frequency trading; specifically, they use strategies such as statistical arbitrage, short term strategies, and they look at overnight data to make their predictions for the next day. Christina says she loves the freedom of being able to carve her own path and have the decision on what she wants to do. She loves being able to essentially do whatever she wants. As a co-founder and Partner at Domeyard, she was able to help start and create a culture that cultivates intelligent minds and brilliant ideas. When coming up with the name Domeyard, her and her co-founders decided to integrate ‘yard’ from Harvard and ‘dome’ from MIT.&lt;/p&gt;&lt;h2&gt;&lt;b&gt;Looking into the future&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;The future of her company is something she frequently thinks about. In the next five years, she hopes to continue creating more amazing ideas and to expand the number of people who work at her company. She said she wants to pursue other things such as venture capital and see where it continues to grow from there. In addition to asking her questions about where she sees potential for her company, I asked her about challenges she faced along the way and how she overcame them. She said that as a woman, there is excessive pressure about fitting in or you will be outcasted. Discrimination exists subconsciously in the field, where men may do and say things they don’t really mean or don’t understand may be sexist. She believes it is incredibly important to not take these types of comments personally and to, instead, address them more head-on. She gave me an example of a time when she was at a dinner event and once it was over, a guy came up to her and told her they were done with their plates. She said that this instance surprised her and she was shocked about the comment, but she learned to laugh it off.&lt;/p&gt;&lt;h2&gt;&lt;b&gt;Success and getting there&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;In terms of some of the greatest instances of success to happen for her company, they were featured in Forbes in an article entitled “The Three Quants In Their 20s Running a Hedge Fund Making $1 Billion of Trades Daily.” Harvard performed a case study on the company when it was first started, and soon after that, the word spread about Domeyard and more people began reaching out. Christina is the most sought after woman in the industry. She has received so much attention that she is not particularly sure how to respond to her success. At times, she mentioned, she was not really sure how she got to where she was and if she even deserved it. She mentioned how amazing it is that after you become famous, people who ignored you in the past suddenly want to associate with you. She told me how when she was working on a trading desk in Japan as an intern, she sat next to a door in the back of the room and was basically ignored a vast majority of the day. There was a guy in particular who never talked to her but once she started Domeyard, that exact same company reached out and wanted to invest in it.&lt;/p&gt;&lt;h2&gt;&lt;b&gt;Christina outside of work&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;When Christina is not working, she likes to engage in different types of activities such as reading books, watching anime and TV, and hanging out with her friends. She told me her friends are of all different ages, even teenagers. She said she enjoys hanging out with people of all age groups. She frequently brought up how she enjoys living the ‘millennial life’ where she always is on her phone and meeting up with different people. When you speak with Christina, she is very easy-going and personable. In every interaction I have had with her, I feel at ease because, although she is really successful, she knows how to connect with nearly anyone she is speaking with.&lt;/p&gt;&lt;p&gt;The advice Christina would give to students aspiring to enter the industry is to always interview your interviewer. She says it’s crucial to ask as many questions as possible in order to make sure something is for you. She also said that companies check their candidates’ social media profiles and that it’s important to always present yourself professionally, even if it’s just a random profile online. She also said that when you are at an interview, one way to make sure something is for you is to observe the culture and atmosphere. Every place has a different vibe and some workers may all be older or all younger, so it’s important to make sure you can actually picture yourself at these companies and be realistico on whether or not you can picture yourself there. A few last pieces of advice Christina gave was to be open-minded with opportunities you’re given. The industry is constantly changing and it is definitely alright to change jobs and industries where necessary. Also, she mentioned that you won’t enjoy your job 100% of the time, but be happy at least 80% of the time you are working.&lt;/p&gt;&lt;h2&gt;&lt;b&gt;Conclusion&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;As a young finance fanatic and engineer, I look up to Christina and all that she has done. Since meeting her at the Princeton Quant Trading Conference and having dinner with her and the rest of my fellow committee members, I knew she was someone I could trust. Since speaking with Christina on the phone about her career, I am even more inspired and motivated to continue down my current path in finance. Though Christina said she didn’t really have a role model when pursuing the industry, I regard her as one of mine.&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;By Katelyn Schoenberger&lt;/i&gt;&lt;/blockquote&gt;&lt;h2&gt;&lt;b&gt;推荐阅读&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289074%26idx%3D1%26sn%3De859d363eef9249236244466a1af41b6%26chksm%3D802e3867b759b1717f77e07a51ee5671e8115130c66562577280ba1243cba08218add04f1f00%26token%3D449379994%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;01、经过多年交易之后你应该学到的东西（深度分享）&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289050%26idx%3D1%26sn%3D60043a5c95b877dd329a5fd150ddacc4%26chksm%3D802e384fb759b1598e500087374772059aa21b31ae104b3dca04331cf4b63a233c5e04c1945a%26token%3D449379994%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;02、监督学习标签在股市中的应用（代码+书籍）&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289018%26idx%3D1%26sn%3D8c411f676c2c0d92b0dd218f041bee4b%26chksm%3D802e382fb759b139ffebf633ac14cdd0f21938e4613fe632d5d9231dab3d2aca95a11628378a%26token%3D449379994%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;03、全球投行顶尖机器学习团队全面分析&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289014%26idx%3D1%26sn%3D3762d405e332c599a21b48a7dc4df587%26chksm%3D802e3823b759b135928d55044c2729aea9690f86752b680eb973d1a376dc53cfa18287d0060b%26token%3D449379994%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;04、使用Tensorflow预测股票市场变动&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289238%26idx%3D1%26sn%3D3144f5792f84455dd53c27a78e8a316c%26chksm%3D802e3903b759b015da88acde4fcbc8547ab3e6acbb5a0897404bbefe1d8a414265d5d5766ee4%26token%3D2020206794%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;05、使用LSTM预测股票市场基于Tensorflow&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289314%26idx%3D1%26sn%3D87c5a12b23a875966db7be50d11f09cd%26chksm%3D802e3977b759b061675d1988168c1fec06c602e8583fbcc9b76f87008e0c10b702acc85467a0%26token%3D1972390229%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;06、美丽的回测——教你定量计算过拟合概率&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289347%26idx%3D1%26sn%3Dbf5d7899bc4a854d4ba9046fdc6fe0d6%26chksm%3D802e3996b759b080287213840987bb0a0c02e4e1d4d7aae23f10a225a92ef6dd922d8006123d%26token%3D290397496%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;07、利用动态深度学习预测金融时间序列基于Python&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289394%26idx%3D1%26sn%3D24a836136d730aa268605628e683d629%26chksm%3D802e39a7b759b0b1dcf7aaa560699130a907716b71fc9c45ff0e5d236c5ae8ef80ebdb09dbb6%26token%3D290397496%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;08、Facebook开源神器Prophet预测时间序列基于Python&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289437%26idx%3D1%26sn%3Df0dca7da8e69e7ba736992cb3d034ce7%26chksm%3D802e39c8b759b0de5bce401c580623d0729ecca69d13926479d36e19aff8c9c9e8a20265afff%26token%3D290397496%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;09、Facebook开源神器Prophet预测股市行情基于Python&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289358%26idx%3D1%26sn%3Ddb6e8ab85b08f6e67790ec0e401e586e%26chksm%3D802e399bb759b08d6eec855f9901ea856d0da68c7425cba62791b8948da6ad761a3d88543dad%26token%3D290397496%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;10、2018第三季度最受欢迎的券商金工研报前50（附下载）&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289447%26idx%3D1%26sn%3Df2948715bf82569a6556d518e56c1f9e%26chksm%3D802e39f2b759b0e4502d1aaac562b87789573b55c76b3c85897d8c9d88dbf9a0b7ee34d86a4e%26token%3D290397496%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;11、实战交易策略的精髓（公众号深度呈现）&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289478%26idx%3D1%26sn%3Df8e01a641be021993d8ef2d84e94a299%26chksm%3D802e3e13b759b7055cf27a280c672371008a5564c97c658eee89ce8481396a28d254836ff9af%26token%3D290397496%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;12、Markowitz有效边界和投资组合优化基于Python&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289495%26idx%3D1%26sn%3Dc4eeaa2e9f9c10995be9ea0c56d29ba7%26chksm%3D802e3e02b759b7148227675c23c403fb9a543b733e3d27fa237b53840e030bf387a473d83e3c%26token%3D1260956004%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;13、使用LSTM模型预测股价基于Keras&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289507%26idx%3D1%26sn%3Df0ca71aa07531bbbdbd33213f0bab89f%26chksm%3D802e3e36b759b720138b3b17a4dd0e198e054b9de29a038fdd50805f824effa55831111ad026%26token%3D1936245282%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;14、量化金融导论1：资产收益的程式化介绍基于Python&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289533%26idx%3D1%26sn%3D4ef964834e84a9995111bb057b0fc5dd%26chksm%3D802e3e28b759b73e0618eb1262c53aa0601fbf5805525a7c7ff40dc3db62c7704496611bdbf1%26token%3D1950551577%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;15、预测股市崩盘基于统计机器学习与神经网络（Python+文档）&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289609%26idx%3D1%26sn%3Dc7f0b3e47025862d10bb53b6ab88bcda%26chksm%3D802e3e9cb759b78abf6b8b049c59bf18ccfb2ead7580d1f557d36de2292f59dcbd94dcd41910%26token%3D2085008037%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;16、实现最优投资组合有效前沿基于Python（附代码）&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289615%26idx%3D1%26sn%3D1cdc89afb997d0c580bf0cef296d946c%26chksm%3D802e3e9ab759b78ce9f0cd152a680d4a413d6c8dcb02a7a296f4091993a7e4137e7520394575%26token%3D2085008037%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;17、精心为大家整理了一些超级棒的机器学习资料（附链接）&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289623%26idx%3D1%26sn%3D28a3600fd7a72d7be00b066ca0f98244%26chksm%3D802e3e82b759b7943f43a4f6ef4a91e4153fa6b8210de9590235fa8ee66eb9811ce177054dbc%26token%3D1389401983%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;18、海量Wind数据，与全网用户零距离邂逅！&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289640%26idx%3D1%26sn%3D34e94fcbe99052b8e7381ecc48a36dc0%26chksm%3D802e3ebdb759b7ab897cd329a680715b6f8294e63550ddf0c57b9e1320b2b7d1408c6fdca0c7%26token%3D1389401983%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;19、机器学习、深度学习、量化金融、Python等最新书籍汇总下载&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653289725%26idx%3D1%26sn%3D4b65cd1fb8331438e4c0b3d0eae6b51f%26chksm%3D802e3ee8b759b7fe1b94e84d54cc23b0ab05853d5cd227812574b350e9fc2cce9e5f1bc6cb7a%26token%3D1389401983%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;20、各大卖方2019年A股策略报告，都是有故事的人！&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;i&gt;—End—&lt;/i&gt;&lt;/p&gt;&lt;p&gt;量化投资与机器学习微信公众号，是业内垂直于&lt;b&gt;Quant&lt;/b&gt;、&lt;b&gt;MFE&lt;/b&gt;、&lt;b&gt;CST&lt;/b&gt;等专业的主流自媒体。公众号拥有来自&lt;b&gt;公募、私募、券商、银行、海外&lt;/b&gt;等众多圈内&lt;b&gt;10W+&lt;/b&gt;关注者。每日发布行业前沿研究成果和最新资讯。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>量化投资机器学习</author>
<guid isPermaLink="false">2019-04-14-62407470</guid>
<pubDate>Sun, 14 Apr 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>干货 | Python优化技巧：bowl、plate 和valley函数（附代码）</title>
<link>https://henix.github.io/feeds/zhuanlan.Lhtz-Jqxx/2019-04-09-61875176.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/61875176&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-097d913d09ea6e62fde21b75440270e8_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s/h7YMMU95ya9fu8hrKLrtYQ&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic4.zhimg.com/v2-b0d5d85b26e2d7780d75357bd2c30aff_180x120.jpg&quot; data-image-width=&quot;1080&quot; data-image-height=&quot;459&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;干货 | Python优化技巧：bowl、plate 和valley函数（附代码）&lt;/a&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>量化投资机器学习</author>
<guid isPermaLink="false">2019-04-09-61875176</guid>
<pubDate>Tue, 09 Apr 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>算法交易系统开发，揭开Developer的神秘面纱（代码+核心思路）</title>
<link>https://henix.github.io/feeds/zhuanlan.Lhtz-Jqxx/2019-04-08-61747659.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/61747659&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-976e6d0607f0dcb2d37e4e334e10ef32_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;▎作者：Roman Paolucci&lt;/p&gt;&lt;p&gt;&lt;b&gt;▎&lt;/b&gt;编译：yana | 公众号翻译部&lt;/p&gt;&lt;h2&gt;&lt;b&gt;量化开发&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;通常量化研究员会用Python或R开发交易模型。然后把这些模型交给量化开发人员，用java或C++在交易系统中使用。量化交易员通常在这些系统的帮助下执行交易。作为一个研究员、开发人员和交易员，多年与Interactive Broker 的 Java API打交道。在这篇文章中，我们会建立一个算法交易系统，用于基于模型的自动交易执行。在开发交易系统时，在概念上有无限的设计模式可以遵循。但是，&lt;b&gt;本文的目的是为最常见的开发阶段提供简单的解决方案&lt;/b&gt;。这篇文章分成三个部分：&lt;/p&gt;&lt;p&gt;&lt;b&gt;• 连接Interactive Broker交易站（TWS）&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;• 创建实时市场数据流&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;• 实现自动交易执行模型&lt;/b&gt;&lt;/p&gt;&lt;p&gt;安装Interactive Brokers TWS：&lt;/p&gt;&lt;p&gt;&lt;i&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//www.interactivebrokers.com.hk/en/index.php%3Ff%3D16040&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://www.&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;interactivebrokers.com.hk&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;/en/index.php?f=16040&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/i&gt;&lt;/p&gt;&lt;p&gt;安装API：&lt;/p&gt;&lt;p&gt;&lt;i&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//www.interactivebrokers.com.hk/en/index.php%3Ff%3D5041&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://www.&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;interactivebrokers.com.hk&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;/en/index.php?f=5041&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/i&gt;&lt;/p&gt;&lt;p&gt;查看API文档：&lt;/p&gt;&lt;p&gt;&lt;i&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//interactivebrokers.github.io/tws-api/index.html&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;interactivebrokers.github.io&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;/tws-api/index.html&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/i&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-c75d324e47267297f56d0480b41b139b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;764&quot; data-rawheight=&quot;700&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;764&quot; data-original=&quot;https://pic4.zhimg.com/v2-c75d324e47267297f56d0480b41b139b_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-c75d324e47267297f56d0480b41b139b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;764&quot; data-rawheight=&quot;700&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;764&quot; data-original=&quot;https://pic4.zhimg.com/v2-c75d324e47267297f56d0480b41b139b_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-c75d324e47267297f56d0480b41b139b_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;重点&lt;/b&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;• &lt;b&gt;项目代码可以在文末下载。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;• 如果您没有Interactive Brokers的账户，你可以使用模拟账户【用户名：edemo，密码：demouser】来跟随并免费建立一个交易系统。&lt;/p&gt;&lt;p&gt;• 假设你有中级Java编程经验。&lt;/p&gt;&lt;p&gt;• 假设你具有使用API的一些知识，并且能够在IDE中进行安装过程和设置。&lt;/p&gt;&lt;p&gt;• 在真实账户进行交易时，某些证券的实时市场数据流需要一级市场数据订阅，更多信息可在此处找到：&lt;/p&gt;&lt;p&gt;&lt;i&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//www.interactivebrokers.com/en/software/am3/am/settings/marketdatasubscriptions.htm&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://www.&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;interactivebrokers.com/&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;en/software/am3/am/settings/marketdatasubscriptions.htm&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/i&gt;&lt;br/&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;连接&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;本节介绍用Java连接TWS以及该过程的几个特性。&lt;/p&gt;&lt;h3&gt;&lt;b&gt;配置TWS&lt;/b&gt;&lt;/h3&gt;&lt;p&gt;第一步是配置您TWS。首先使用上面的模拟帐户或个人帐户登录，然后执行以下操作：&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;选择 “Classic TWS” → 选择 “Conbgure” &lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;选择 “API” → 启用 ActiveX 和 Client Sockets &lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;禁用只读API → Apply → Ok&lt;/b&gt;&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-8e7159b1bea196b75ae1f1b22be7a0fd_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;900&quot; data-rawheight=&quot;458&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;900&quot; data-original=&quot;https://pic2.zhimg.com/v2-8e7159b1bea196b75ae1f1b22be7a0fd_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-8e7159b1bea196b75ae1f1b22be7a0fd_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;900&quot; data-rawheight=&quot;458&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;900&quot; data-original=&quot;https://pic2.zhimg.com/v2-8e7159b1bea196b75ae1f1b22be7a0fd_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-8e7159b1bea196b75ae1f1b22be7a0fd_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;我们现在允许从127.0.0.1:7497进行API连接。&lt;/p&gt;&lt;p&gt;我们还允许Java通过禁用只读API来执行交易。&lt;/p&gt;&lt;p&gt;如果连接不成功，则可能需要转发端口。有关端口的更多信息，请参阅：主机和端口文档。&lt;i&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//ibkr.info/node/2816&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;ibkr.info/node/2816&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/i&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;连接处理&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;到目前为止，假设您已经从Interactive Brokers安装了API，并在首选IDE中设置它的工作空间。我们将创建IConnectionHandler接口，来处理服务器和客户端之间的连接事件，从而实现Java和TWS之间建立连接：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-4c99c7a0034fd3ccbcbdb1050c012fad_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1056&quot; data-rawheight=&quot;1244&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1056&quot; data-original=&quot;https://pic2.zhimg.com/v2-4c99c7a0034fd3ccbcbdb1050c012fad_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-4c99c7a0034fd3ccbcbdb1050c012fad_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1056&quot; data-rawheight=&quot;1244&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1056&quot; data-original=&quot;https://pic2.zhimg.com/v2-4c99c7a0034fd3ccbcbdb1050c012fad_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-4c99c7a0034fd3ccbcbdb1050c012fad_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;接下来，需要创建ILogger接口的实现：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-b08026b1125cb1ba27fdf8f9673ebf2d_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;402&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-b08026b1125cb1ba27fdf8f9673ebf2d_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-b08026b1125cb1ba27fdf8f9673ebf2d_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;402&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-b08026b1125cb1ba27fdf8f9673ebf2d_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-b08026b1125cb1ba27fdf8f9673ebf2d_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;既然我们知道如何处理连接和记录信息（使用我们的接口实现），就可以建立与TWS的连接。在项目的主要类Demo中连接到TWS：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-9e5a0b8864f136a6f3a639d56ae0c1b3_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;652&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-9e5a0b8864f136a6f3a639d56ae0c1b3_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-9e5a0b8864f136a6f3a639d56ae0c1b3_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;652&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-9e5a0b8864f136a6f3a639d56ae0c1b3_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-9e5a0b8864f136a6f3a639d56ae0c1b3_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;主控制器是&lt;b&gt;ApiController&lt;/b&gt;，通过它发送请求并从TWS接收响应。&lt;/p&gt;&lt;p&gt;连接成功，可以在终端中看到：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-c01f3713732a0630031c8021bc341daa_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;987&quot; data-rawheight=&quot;439&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;987&quot; data-original=&quot;https://pic3.zhimg.com/v2-c01f3713732a0630031c8021bc341daa_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-c01f3713732a0630031c8021bc341daa_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;987&quot; data-rawheight=&quot;439&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;987&quot; data-original=&quot;https://pic3.zhimg.com/v2-c01f3713732a0630031c8021bc341daa_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-c01f3713732a0630031c8021bc341daa_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;现在已成功连接到TWS，我们可以创建实时市场数据流来处理实时数据。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;实时数据流&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;本节介绍设置市场数据流的过程。&lt;/p&gt;&lt;h3&gt;&lt;b&gt;市场数据句柄&lt;/b&gt;&lt;/h3&gt;&lt;p&gt;与连接处理程序类似，必须创建ITopMktDataHandler接口的实例，以便处理服务器响应的数据。通过给实例方法传递参数的方式，从服务器接收数据。在数据发生变化时服务器对其进行响应，因此Price, Volume，Bid_Size，Ask_Size等功能的更改会发送给ITopMktDataHandler的实例方法。要在下一节中实现任何类型的交易模型，我们需要一种方法来捕获这些数据。现在把最新修改价格存储在ArrayList顶部：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-45137435e5514747a287216794755abd_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;1067&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-45137435e5514747a287216794755abd_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-45137435e5514747a287216794755abd_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;1067&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-45137435e5514747a287216794755abd_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-45137435e5514747a287216794755abd_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;简而言之，在TopMktDataHandlerImplementation的新类中实现ITopMktDataHandler接口，处理服务器响应的数据。 tickPrice方法会在服务器更改时从服务器接收数据。当服务器响应最新价格的变化时，我们将其添加到ArrayList价格。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;可视化 Price ArrayList 的行为&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;我们正在改变将新项添加到ArrayList的方式。以下是其工作原理的图形表示：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-b82d2c930e925fcda01182265cc44aa9_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;695&quot; data-rawheight=&quot;439&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;695&quot; data-original=&quot;https://pic2.zhimg.com/v2-b82d2c930e925fcda01182265cc44aa9_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-b82d2c930e925fcda01182265cc44aa9_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;695&quot; data-rawheight=&quot;439&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;695&quot; data-original=&quot;https://pic2.zhimg.com/v2-b82d2c930e925fcda01182265cc44aa9_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-b82d2c930e925fcda01182265cc44aa9_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;新价格到达时，我们将其插入到ArrayList的顶部，可以通过语句 &lt;b&gt;price.get（0）&lt;/b&gt;获得最新价格。在建模和交易执行部分会更具相关性。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;创建合约对象&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;这个过程最重要的部分是建立一个NewContract对象作为参数传递给请求。为此，我们使用流式传输的安全性的参数初始化NewContract对象。我将使用期货合约作为例子：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-334ab6954b9a00c63d397ac70da141ed_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;387&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-334ab6954b9a00c63d397ac70da141ed_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-334ab6954b9a00c63d397ac70da141ed_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;387&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-334ab6954b9a00c63d397ac70da141ed_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-334ab6954b9a00c63d397ac70da141ed_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;请求实时市场数据流&lt;/b&gt;&lt;/p&gt;&lt;p&gt;现在有办法处理数据流，并定义了流的安全性，接下来看下并细分请求方法：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-8d19bf270ed36b87814e0c496fcef6b3_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;72&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-8d19bf270ed36b87814e0c496fcef6b3_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-8d19bf270ed36b87814e0c496fcef6b3_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;72&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-8d19bf270ed36b87814e0c496fcef6b3_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-8d19bf270ed36b87814e0c496fcef6b3_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;第一个参数是合约，简单地传递初始化契约的方法。&lt;/p&gt;&lt;p&gt;第二个参数可以保留为空字符串。&lt;/p&gt;&lt;p&gt;第三个参数确定是否正在请求快照，我们显然希望将此请求建立为流。&lt;/p&gt;&lt;p&gt;最后一个参数是ITopMktDataHandler。这允许我们使用服务器的响应数据来处理事务。&lt;/p&gt;&lt;p&gt;以下是主类Demo建立数据流的更新：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-6016714c5bcd96cf77f224d6890b6286_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;808&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-6016714c5bcd96cf77f224d6890b6286_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-6016714c5bcd96cf77f224d6890b6286_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;808&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-6016714c5bcd96cf77f224d6890b6286_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-6016714c5bcd96cf77f224d6890b6286_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;运行此操作后，可以在终端中获得以下输出：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-8543942366ec1de9a03a0622d642d3d6_b.gif&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;600&quot; data-rawheight=&quot;402&quot; data-thumbnail=&quot;https://pic3.zhimg.com/v2-8543942366ec1de9a03a0622d642d3d6_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;600&quot; data-original=&quot;https://pic3.zhimg.com/v2-8543942366ec1de9a03a0622d642d3d6_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-8543942366ec1de9a03a0622d642d3d6_b.gif&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;600&quot; data-rawheight=&quot;402&quot; data-thumbnail=&quot;https://pic3.zhimg.com/v2-8543942366ec1de9a03a0622d642d3d6_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;600&quot; data-original=&quot;https://pic3.zhimg.com/v2-8543942366ec1de9a03a0622d642d3d6_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-8543942366ec1de9a03a0622d642d3d6_b.gif&quot;/&gt;&lt;/figure&gt;&lt;p&gt;我们已成功为特定合约创建了市场数据流。&lt;br/&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;自动交易执行模型&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;可能是算法交易系统开发中最迷人的部分&lt;/b&gt;。本节是关于实现模型和自动订单执行的全部内容。&lt;/p&gt;&lt;h3&gt;&lt;b&gt;模型开发&lt;/b&gt;&lt;/h3&gt;&lt;p&gt;&lt;b&gt;这是我们交易系统中最重要的部分&lt;/b&gt;。如果模型没有盈利，就不会赚钱。虽然我们在本文中不会过多谈论模型开发过程，但想稍微谈谈它。 &lt;/p&gt;&lt;p&gt;正如我在介绍中简要提到的，&lt;b&gt;通常模型开发是一个不同的角色，属于定量研究员的职责。研究人员用Python或R开发模型，开发人员用Java或C ++实现它，交易者负责交易执行。大多数研究人员使用某种形式的机器学习来协助开发他们的模型。就是掌握Python中的数据科学库，如Pandas，ScikitLearn，Numpy和R中的包，如quantmod。如果您希望在模型开发中了解有关机器学习应用程序的更多信息。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;虽然有几种方法可以开发交易模型，但显然它绝不是一门精确的科学。&lt;b&gt;一些模型设计具有遗传能力，以不断适应市场条件，而其他模型设置有损失限制，因此当它们停止执行时，它们会被废弃。&lt;/b&gt;对于定量研究，高级金融，数学和统计知识是必不可少的。这些技能与创造力和坚持不懈相媲美，从而推动了建模过程。&lt;/p&gt;&lt;p&gt;一般模型设计过程可以看作如下：&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;阅读博士论文或其他相关信息 → 草拟模型创意 → 回测模型（评估绩效的一些关键指标）→ 废弃不良模型（通常约为所有模型创意的70％-90％）→ 继续开发和审查剩余模型 → 查看生产潜力 → 重复过程。&lt;/b&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;任意实施模式&lt;/b&gt;&lt;/p&gt;&lt;p&gt;我们将使用&lt;b&gt;基于价格变化阈值的简单策略来构建期货合约&lt;/b&gt;。以下是进入策略的直观表示：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-5dd3c6dabf185f06eb75c2313e12c040_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;800&quot; data-rawheight=&quot;439&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;800&quot; data-original=&quot;https://pic1.zhimg.com/v2-5dd3c6dabf185f06eb75c2313e12c040_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-5dd3c6dabf185f06eb75c2313e12c040_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;800&quot; data-rawheight=&quot;439&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;800&quot; data-original=&quot;https://pic1.zhimg.com/v2-5dd3c6dabf185f06eb75c2313e12c040_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-5dd3c6dabf185f06eb75c2313e12c040_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;下一步是制定退场策略。为简单起见，我们的退场策略只是一个限制，并分别停止1点和0.5点（费用后保持相同的费用）&lt;/p&gt;&lt;p&gt;此模型的目的是展示基于模型的自动订单执行的简单解决方案。不建议在真实账户上实施此策略。&lt;br/&gt;&lt;/p&gt;&lt;h3&gt;&lt;b&gt;模型开发&lt;/b&gt;&lt;/h3&gt;&lt;p&gt;我们将从TopMktDataHandlerImplementation中的价格ArrayList获取信息。在获得价格之后，我们将要开发一个类来处理（基于模型的）进入信号，然后开发一个类来处理发送订单。我将使用EntrySignalA类作为我的主要信号：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-86aab41eb4535d0d06bb37918df64bfb_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;962&quot; data-rawheight=&quot;560&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;962&quot; data-original=&quot;https://pic4.zhimg.com/v2-86aab41eb4535d0d06bb37918df64bfb_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-86aab41eb4535d0d06bb37918df64bfb_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;962&quot; data-rawheight=&quot;560&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;962&quot; data-original=&quot;https://pic4.zhimg.com/v2-86aab41eb4535d0d06bb37918df64bfb_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-86aab41eb4535d0d06bb37918df64bfb_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;既然我们有办法让价格符合我们的信号，以确定买入或卖出，我们需要创建一个类来处理订单。我们将创建一个类来实现自定义订单和处理活动订单。&lt;/p&gt;&lt;p&gt;现在我们可以在信号类中使用placeBracketOrder方法：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-924b0e5407c3582930147736d75ef324_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;938&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-924b0e5407c3582930147736d75ef324_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-924b0e5407c3582930147736d75ef324_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;938&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-924b0e5407c3582930147736d75ef324_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-924b0e5407c3582930147736d75ef324_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-6b0687eca910a1f3782d47ff386c8dd3_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;959&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-6b0687eca910a1f3782d47ff386c8dd3_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-6b0687eca910a1f3782d47ff386c8dd3_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;959&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-6b0687eca910a1f3782d47ff386c8dd3_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-6b0687eca910a1f3782d47ff386c8dd3_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-c2e375e7573cb4ee430ddcd7f488cae2_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;960&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-c2e375e7573cb4ee430ddcd7f488cae2_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-c2e375e7573cb4ee430ddcd7f488cae2_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;960&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-c2e375e7573cb4ee430ddcd7f488cae2_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-c2e375e7573cb4ee430ddcd7f488cae2_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-3450b940122ee9cebded4f6a85bc1ed3_b.png&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;61&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-3450b940122ee9cebded4f6a85bc1ed3_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-3450b940122ee9cebded4f6a85bc1ed3_b.png&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;61&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-3450b940122ee9cebded4f6a85bc1ed3_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-3450b940122ee9cebded4f6a85bc1ed3_b.png&quot;/&gt;&lt;/figure&gt;&lt;h3&gt;&lt;b&gt;要点&lt;/b&gt;&lt;/h3&gt;&lt;p&gt;在此例中，使用1000和2000作为parentOrderId。如果交易没有唯一的订单ID，则不会发送交易。但是，如果在TWS中重置订单ID API序列，则将重置所有现有订单ID，并且可以重复使用。有许多方法可以生成唯一的订单ID，例如将当前日期/时间转换为整数。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;全放在一起&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;如果我们从逻辑上考虑这个问题，有一个非常简单的方法可以将它实现。只需在服务器响应的方法底部添加信号类的实例，以获得价格的每次变化：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-5ea5882d758d2b6ab1a0f792c9a9c71d_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;977&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-5ea5882d758d2b6ab1a0f792c9a9c71d_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-5ea5882d758d2b6ab1a0f792c9a9c71d_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;977&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-5ea5882d758d2b6ab1a0f792c9a9c71d_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-5ea5882d758d2b6ab1a0f792c9a9c71d_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;我们现在有一个简单的系统，可以根据我们的模型自动执行交易。这是我们的模型执行买入订单时的样子：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-74cfdf00fa00f825c7d39c61fe3c9d13_b.gif&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;600&quot; data-rawheight=&quot;276&quot; data-thumbnail=&quot;https://pic4.zhimg.com/v2-74cfdf00fa00f825c7d39c61fe3c9d13_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;600&quot; data-original=&quot;https://pic4.zhimg.com/v2-74cfdf00fa00f825c7d39c61fe3c9d13_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-74cfdf00fa00f825c7d39c61fe3c9d13_b.gif&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;600&quot; data-rawheight=&quot;276&quot; data-thumbnail=&quot;https://pic4.zhimg.com/v2-74cfdf00fa00f825c7d39c61fe3c9d13_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;600&quot; data-original=&quot;https://pic4.zhimg.com/v2-74cfdf00fa00f825c7d39c61fe3c9d13_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-74cfdf00fa00f825c7d39c61fe3c9d13_b.gif&quot;/&gt;&lt;/figure&gt;&lt;h2&gt;&lt;b&gt;量化开发人员 - 系统开发&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;作为量化开发人员，你的工作通常是创建基于经过严格测试的oi模型的交易系统。&lt;/b&gt;在这个例子中，我们引导你完成算法交易系统的开发，并为关键的开发阶段提供了简单的解决方案。有很多方法来改进这个系统（显然是模型），例如：&lt;/p&gt;&lt;p&gt;&lt;b&gt;• 在交易执行系统中添加安全标志&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;• 未能以非最优价格执行订单&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;• 当前模型性能的分析库&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;• 等等&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;如何获取代码&lt;/b&gt;&lt;/h2&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s/Vy2jKfUKumfCo0xYUUu0RA&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic4.zhimg.com/v2-86c99c2ff42d04bccf01bee78aa6ed83_180x120.jpg&quot; data-image-width=&quot;1280&quot; data-image-height=&quot;545&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;算法交易系统开发，揭开Developer的神秘面纱（代码+核心思路）&lt;/a&gt;&lt;p&gt;&lt;i&gt;—End—&lt;/i&gt;&lt;/p&gt;&lt;p&gt;量化投资与机器学习微信公众号，是业内垂直于&lt;b&gt;Quant&lt;/b&gt;、&lt;b&gt;MFE&lt;/b&gt;、&lt;b&gt;CST&lt;/b&gt;等专业的主流自媒体。公众号拥有来自&lt;b&gt;公募、私募、券商、银行、海外&lt;/b&gt;等众多圈内&lt;b&gt;10W+&lt;/b&gt;关注者。每日发布行业前沿研究成果和最新资讯。&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-781e4b70c99e97eb46045eefdd07923a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;1080&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-781e4b70c99e97eb46045eefdd07923a_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-781e4b70c99e97eb46045eefdd07923a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;1080&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-781e4b70c99e97eb46045eefdd07923a_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-781e4b70c99e97eb46045eefdd07923a_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>量化投资机器学习</author>
<guid isPermaLink="false">2019-04-08-61747659</guid>
<pubDate>Mon, 08 Apr 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>使用Prophet预测股价并进行多策略交易（附代码）</title>
<link>https://henix.github.io/feeds/zhuanlan.Lhtz-Jqxx/2019-04-08-61746724.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/61746724&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-068ad39bdc4ce5c6eb81b264b987a987_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;▎作者：Mike&lt;/p&gt;&lt;p&gt;&lt;b&gt;▎&lt;/b&gt;编译：公众号翻译部&lt;/p&gt;&lt;p&gt;在这篇文章中，我们将使用Prophet来预测时间序列。使用的数据是SA&amp;amp;P500历史调整收盘价。先建立一个3年的预测，然后模拟1980年以来的历史月度预测。最后，将创建多样的交易策略。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-8a14e3bd44e3ff2cbb67956fa3588cbb_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;765&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-8a14e3bd44e3ff2cbb67956fa3588cbb_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-8a14e3bd44e3ff2cbb67956fa3588cbb_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;765&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-8a14e3bd44e3ff2cbb67956fa3588cbb_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-8a14e3bd44e3ff2cbb67956fa3588cbb_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//facebook.github.io/prophet/&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;facebook.github.io/prop&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;het/&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;库的导入&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;导入Python标准库。还将从 functools 中导入 Prophet 和 reduce。&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pandas&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pd&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;fbprophet&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Prophet&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;functools&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;reduce&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;matplotlib&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inline&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;warnings&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;warnings&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filterwarnings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ignore&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;style&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;use&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;seaborn-deep&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;display&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float_format&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;{:,.2f}&amp;#34;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;数据获取&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;使用的数据是1980年以来的标准普尔500指数历史数据。&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;describe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-24575f3fd6032445b8c18274d133d743_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;538&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-24575f3fd6032445b8c18274d133d743_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-24575f3fd6032445b8c18274d133d743_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;538&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-24575f3fd6032445b8c18274d133d743_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-24575f3fd6032445b8c18274d133d743_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;h2&gt;&lt;b&gt;数据准备&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;要使prophet用起来，我们需要将日期和Adj close列的名称更改为ds和y。 在大多数机器学习项目中，术语y通常用于目标列（要测试的内容）。&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Date&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Adj Close&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;columns&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;y&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-c109a8dbd1656a9be5332f8d679d373c_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;364&quot; data-rawheight=&quot;708&quot; class=&quot;content_image&quot; width=&quot;364&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-c109a8dbd1656a9be5332f8d679d373c_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;364&quot; data-rawheight=&quot;708&quot; class=&quot;content_image lazy&quot; width=&quot;364&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-c109a8dbd1656a9be5332f8d679d373c_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;h2&gt;&lt;b&gt;Prophet&lt;/b&gt;&lt;/h2&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-416740735fff7ee48ff9c40221a0ced1_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;719&quot; data-rawheight=&quot;354&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;719&quot; data-original=&quot;https://pic2.zhimg.com/v2-416740735fff7ee48ff9c40221a0ced1_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-416740735fff7ee48ff9c40221a0ced1_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;719&quot; data-rawheight=&quot;354&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;719&quot; data-original=&quot;https://pic2.zhimg.com/v2-416740735fff7ee48ff9c40221a0ced1_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-416740735fff7ee48ff9c40221a0ced1_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;在使用Prophet创建预测之前，先将数据可视化。直观的来感受数据。&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Prophet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fbprophet&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;forecaster&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Prophet&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;at&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x21216301c18&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;要激活Prophet模型，我们只需调用Prophet()并将其分配给一个名为Model的变量。接下来，我们通过调用fit方法将股票数据匹配到模型中。&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;future = model.make_future_dataframe(1095, freq=&amp;#39;d&amp;#39;)

future_boolean = future[&amp;#39;ds&amp;#39;].map(lambda x : True if x.weekday() in range(0, 5) else False)
future = future[future_boolean] 

future.tail()&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-109e18281a1162a8d4817f4d435e420d_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;314&quot; data-rawheight=&quot;390&quot; class=&quot;content_image&quot; width=&quot;314&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-109e18281a1162a8d4817f4d435e420d_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;314&quot; data-rawheight=&quot;390&quot; class=&quot;content_image lazy&quot; width=&quot;314&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-109e18281a1162a8d4817f4d435e420d_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;我们需要创建一些未来的日期。Prophet为我们提供了一个名为make_future_dataframe的函数。传入未来周期和频率的数量。以上是我们对未来1095天或3年的预测。&lt;/p&gt;&lt;p&gt;由于股票只能在交易日操作，我们需要将预测数据从周末中删除。为此，我们创建一个布尔表达式，如果一天不等于0-4，则返回False。“0 =星期一，6=星期六，等等。”&lt;/p&gt;&lt;p&gt;然后我们将布尔表达式传递给dataframe，它只返回True值。我们现在有一个包含未来3年交易日的预测数据。&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;forecast&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;future&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;forecast&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tail&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-76c9ee4e56ab44ddff2065e1be54e66a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;363&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-76c9ee4e56ab44ddff2065e1be54e66a_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-76c9ee4e56ab44ddff2065e1be54e66a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;363&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-76c9ee4e56ab44ddff2065e1be54e66a_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-76c9ee4e56ab44ddff2065e1be54e66a_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;我们从模型中调用predict的预测，并在前面创建的future的dataframe中传递该预测。我们在一个名为forecast的新dataframe中返回结果。&lt;/p&gt;&lt;p&gt;当我们查看预测数据时，会看到一堆新术语。我们最感兴趣的是yhat，它是我们的预测值。（yhat是y的预测）&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-3ac5c9099150ae7957fd5dc0e9b81e13_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;712&quot; data-rawheight=&quot;424&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;712&quot; data-original=&quot;https://pic4.zhimg.com/v2-3ac5c9099150ae7957fd5dc0e9b81e13_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-3ac5c9099150ae7957fd5dc0e9b81e13_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;712&quot; data-rawheight=&quot;424&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;712&quot; data-original=&quot;https://pic4.zhimg.com/v2-3ac5c9099150ae7957fd5dc0e9b81e13_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-3ac5c9099150ae7957fd5dc0e9b81e13_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot_components&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;forecast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-e6e1d121e46df4f3a6a05c21832e475f_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;640&quot; data-rawheight=&quot;640&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;640&quot; data-original=&quot;https://pic4.zhimg.com/v2-e6e1d121e46df4f3a6a05c21832e475f_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-e6e1d121e46df4f3a6a05c21832e475f_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;640&quot; data-rawheight=&quot;640&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;640&quot; data-original=&quot;https://pic4.zhimg.com/v2-e6e1d121e46df4f3a6a05c21832e475f_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-e6e1d121e46df4f3a6a05c21832e475f_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;Prophet提供了两个方便的可视化助手，plot和plot_components。plot函数创建了实际/预测的图表，plot_components提供了趋势/季节性的图表。&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;stock_price_forecast&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;forecast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;yhat&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;yhat_lower&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;yhat_upper&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;merge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stock_price_forecast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;how&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;right&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;royalblue&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;#34495e&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;#e74c3c&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;#e74c3c&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-ec1f34b5c3c56f77b492e6b6e2bf5246_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;942&quot; data-rawheight=&quot;451&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;942&quot; data-original=&quot;https://pic3.zhimg.com/v2-ec1f34b5c3c56f77b492e6b6e2bf5246_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-ec1f34b5c3c56f77b492e6b6e2bf5246_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;942&quot; data-rawheight=&quot;451&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;942&quot; data-original=&quot;https://pic3.zhimg.com/v2-ec1f34b5c3c56f77b492e6b6e2bf5246_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-ec1f34b5c3c56f77b492e6b6e2bf5246_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;可视化助手只是使用我们的预测dataframe中的数据。我们可以重新创建相同的图表。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;模拟预测&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;虽然我们在上面创建的3年预测非常酷，但我们不想在没有使用交易策略对业绩进行反向测试的情况下就对其做出任何交易决定。&lt;/p&gt;&lt;p&gt;在本节中，我们将模拟Prophet在1980年就已经存在，并使用它来创建到2019年的月度预测。然后，我们将在下一节中使用这些数据来模拟各种交易策略对我们刚刚购买并持有该股票的效果。&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;dayname&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;day_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;month&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;year&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month/year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;/&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; 

&lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;merge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
&lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month/year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;drop_duplicates&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;drop&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month/year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;how&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;left&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;columns&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month/year_index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tail&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-76fb4468f5ff6606a0744645e484fb14_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;336&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-76fb4468f5ff6606a0744645e484fb14_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-76fb4468f5ff6606a0744645e484fb14_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;336&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-76fb4468f5ff6606a0744645e484fb14_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-76fb4468f5ff6606a0744645e484fb14_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;在模拟月度预测之前，我们需要向stock_price dataframe添加一些列，这是我们在这个项目开始时创建的，目的是使它更容易使用。添加month、year、month/year和month/year_index。&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;loop_list&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month/year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;unique&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tolist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;max_num&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loop_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;forecast_frames&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;item&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loop_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_num&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;pass&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month/year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loop_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]][&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;\
        &lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month/year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()]&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()[[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;y&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Prophet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;future&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month/year_index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)][[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;forecast&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;future&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;forecast_frames&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;forecast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;stock_price_forecast&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;reduce&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;lambda&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;top&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bottom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;concat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;top&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bottom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sort&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;forecast_frames&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;stock_price_forecast&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stock_price_forecast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;yhat&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;yhat_lower&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;yhat_upper&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;stock_price_forecast&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to_csv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;stock_price_forecast.csv&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;基本上我们在stock_price中循环每个月/年，并将预测模型与该时期可用的股票数据进行拟合，然后提前一个月预测。继续这样做，直到最后一个月/年。最后，将这些预测合并到一个名为stock_price_forecast的数据框中。将结果保存在csv文件中，这样如果需要重置数据，就不必再次运行模型。&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;stock_price_forecast&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read_csv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;stock_price_forecast.csv&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;parse_dates&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;merge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stock_price&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;y&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;month/year_index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stock_price_forecast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Percent Change&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;y&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pct_change&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;y&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;yhat&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;yhat_lower&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;yhat_upper&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;royalblue&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;#34495e&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;#e74c3c&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;#e74c3c&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-fcd13149db737b375f4e83ea12ed214a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;942&quot; data-rawheight=&quot;451&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;942&quot; data-original=&quot;https://pic3.zhimg.com/v2-fcd13149db737b375f4e83ea12ed214a_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-fcd13149db737b375f4e83ea12ed214a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;942&quot; data-rawheight=&quot;451&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;942&quot; data-original=&quot;https://pic3.zhimg.com/v2-fcd13149db737b375f4e83ea12ed214a_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-fcd13149db737b375f4e83ea12ed214a_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-0421851ac9849b522a5a0957284e994d_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;310&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-0421851ac9849b522a5a0957284e994d_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-0421851ac9849b522a5a0957284e994d_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;310&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-0421851ac9849b522a5a0957284e994d_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-0421851ac9849b522a5a0957284e994d_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;最后，我们将预测与实际价格结合起来，创建一个百分比变化列，将在下面的交易算法中使用。最后，将预测与实际情况作图，以查看它的表现如何。正如你所看到的，有一点延迟。它的行为很像移动平均线。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;交易算法&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;创建了四个初始交易算法:&lt;/p&gt;&lt;p&gt;&lt;b&gt;Hold：&lt;/b&gt;这是一种买入并持有的策略。也就是说，我们买股票并持有到最后一段时间。&lt;/p&gt;&lt;p&gt;&lt;b&gt;Prophet：&lt;/b&gt;这种策略是当我们的预测显示下跌趋势时卖出，当我的预测显示上涨趋势时买进&lt;/p&gt;&lt;p&gt;&lt;b&gt;Prophet Thresh：&lt;/b&gt;这个策略是只有当股票价格跌破我们的yhat_lower边界时才卖出。&lt;/p&gt;&lt;p&gt;&lt;b&gt;Seasonality：&lt;/b&gt;这一策略是在8月退出市场，重新进入Ocober。这是基于上面的季节性图表。&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dropna&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Hold&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Prophet&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Prophet Thresh&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Seasonality&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Hold = {df[&amp;#39;Hold&amp;#39;].iloc[-1]*1000:,.0f}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Prophet = {df[&amp;#39;Prophet&amp;#39;].iloc[-1]*1000:,.0f}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Prophet Thresh = {df[&amp;#39;Prophet Thresh&amp;#39;].iloc[-1]*1000:,.0f}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Seasonality = {df[&amp;#39;Seasonality&amp;#39;].iloc[-1]*1000:,.0f}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Hold = 24,396&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;Prophet&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;13&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;366&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Prophet&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Thresh&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;17&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;087&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Seasonality&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;861&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-ad538c9b61d3505281065ccb1568b64c_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;949&quot; data-rawheight=&quot;451&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;949&quot; data-original=&quot;https://pic1.zhimg.com/v2-ad538c9b61d3505281065ccb1568b64c_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-ad538c9b61d3505281065ccb1568b64c_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;949&quot; data-rawheight=&quot;451&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;949&quot; data-original=&quot;https://pic1.zhimg.com/v2-ad538c9b61d3505281065ccb1568b64c_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-ad538c9b61d3505281065ccb1568b64c_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;br/&gt;&lt;br/&gt;我们绘制了初始资金为1000美元初始模拟策略结果。你可以看到季节性做得最好，持有策略其次。两种基于Prophet的策略都做得不太好。让我们看看是否可以通过优化阈值来改进Prophet Thresh。&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;performance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;linspace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;99&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;y&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;yhat_lower&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shift&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Percent Change&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cumprod&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;performance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;best_yhat&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataFrame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;performance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;idxmax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataFrame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;performance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Best Yhat = {best_yhat:,.2f}&amp;#39;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-c3da8947278b18c32ba9ec2fc3cebf64_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;930&quot; data-rawheight=&quot;469&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;930&quot; data-original=&quot;https://pic1.zhimg.com/v2-c3da8947278b18c32ba9ec2fc3cebf64_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-c3da8947278b18c32ba9ec2fc3cebf64_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;930&quot; data-rawheight=&quot;469&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;930&quot; data-original=&quot;https://pic1.zhimg.com/v2-c3da8947278b18c32ba9ec2fc3cebf64_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-c3da8947278b18c32ba9ec2fc3cebf64_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;br/&gt;上面我们循环遍历不同百分比的thresh以找到最优的thresh。最佳阈值是当前yhat_lower值的92%。&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Optimized Prophet Thresh&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;y&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;yhat_lower&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;best_yhat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shift&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; 
&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Percent Change&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cumprod&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dropna&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Hold&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Prophet&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Prophet Thresh&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;&amp;#39;Seasonality&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Optimized Prophet Thresh&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Hold = {df[&amp;#39;Hold&amp;#39;].iloc[-1]*1000:,.0f}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Prophet = {df[&amp;#39;Prophet&amp;#39;].iloc[-1]*1000:,.0f}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Prophet Thresh = {df[&amp;#39;Prophet Thresh&amp;#39;].iloc[-1]*1000:,.0f}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Seasonality = {df[&amp;#39;Seasonality&amp;#39;].iloc[-1]*1000:,.0f}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Optimized Prophet Thresh = {df[&amp;#39;Optimized Prophet Thresh&amp;#39;].iloc[-1]*1000:,.0f}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;Hold&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;24&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;396&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Prophet&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;13&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;366&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Prophet&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Thresh&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;17&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;087&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Seasonality&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;861&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Optimized&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Prophet&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Thresh&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;36&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;375&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-0ad0a24f068be2d35b99f1cc76ff2b2d_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;949&quot; data-rawheight=&quot;451&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;949&quot; data-original=&quot;https://pic2.zhimg.com/v2-0ad0a24f068be2d35b99f1cc76ff2b2d_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-0ad0a24f068be2d35b99f1cc76ff2b2d_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;949&quot; data-rawheight=&quot;451&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;949&quot; data-original=&quot;https://pic2.zhimg.com/v2-0ad0a24f068be2d35b99f1cc76ff2b2d_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-0ad0a24f068be2d35b99f1cc76ff2b2d_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;以上我们看到的是新的最佳交易策略。不幸的是，无论是优化的ProphetThresh都在有问题，&lt;b&gt;因为他们使用的数据有未来函数存在，而这些数据在我们交易的时候是不可用的&lt;/b&gt;。我们将需要为我们预测的每个当前时间点创建一个优化的Thresh。&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;fcst_thresh&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;index&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month/year_index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;unique&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()):&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;temp_df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month/year_index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month/year_index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;unique&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]][&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;\
        &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month/year_index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()]&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;performance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;thresh&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;linspace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;99&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;percent&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;temp_df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;y&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;temp_df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;yhat_lower&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;thresh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shift&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;temp_df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Percent Change&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cumprod&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;performance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;thresh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;percent&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;best_thresh&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataFrame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;performance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;idxmax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month/year_index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;unique&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;pass&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fcst_thresh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month/year_index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;unique&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;best_thresh&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fcst_thresh&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataFrame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fcst_thresh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;columns&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month/year_index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Fcst Thresh&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fcst_thresh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Fcst Thresh&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-277d239e051fb896a52146f5a9d92301_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;933&quot; data-rawheight=&quot;469&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;933&quot; data-original=&quot;https://pic2.zhimg.com/v2-277d239e051fb896a52146f5a9d92301_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-277d239e051fb896a52146f5a9d92301_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;933&quot; data-rawheight=&quot;469&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;933&quot; data-original=&quot;https://pic2.zhimg.com/v2-277d239e051fb896a52146f5a9d92301_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-277d239e051fb896a52146f5a9d92301_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;循环遍历数据，并为当前时间点找到到目前为止的最佳阈值百分比。正如你所看到的，随着时间的推移（1980年1月1日- 2019年3月18日），当前的thresh的百分比会跳跃。&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;yhat_optimized&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;merge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fcst_thresh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month/year_index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;how&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;left&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Fcst Thresh&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shift&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;yhat_lower&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Prophet Fcst Thresh&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;y&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;yhat_optimized&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shift&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Percent Change&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cumprod&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dropna&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Hold&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Prophet&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Prophet Thresh&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Prophet Fcst Thresh&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Hold = {df[&amp;#39;Hold&amp;#39;].iloc[-1]*1000:,.0f}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Prophet = {df[&amp;#39;Prophet&amp;#39;].iloc[-1]*1000:,.0f}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Prophet Thresh = {df[&amp;#39;Prophet Thresh&amp;#39;].iloc[-1]*1000:,.0f}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# print(f&amp;#34;Seasonality = {df[&amp;#39;Seasonality&amp;#39;].iloc[-1]*1000:,.0f}&amp;#34;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Prophet Fcst Thresh = {df[&amp;#39;Prophet Fcst Thresh&amp;#39;].iloc[-1]*1000:,.0f}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Hold&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;24&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;396&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Prophet&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;13&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;366&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Prophet&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Thresh&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;17&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;087&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Prophet&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Fcst&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Thresh&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;620&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-d155b463825af5986d9a4ece4eadb611_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;949&quot; data-rawheight=&quot;451&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;949&quot; data-original=&quot;https://pic2.zhimg.com/v2-d155b463825af5986d9a4ece4eadb611_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-d155b463825af5986d9a4ece4eadb611_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;949&quot; data-rawheight=&quot;451&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;949&quot; data-original=&quot;https://pic2.zhimg.com/v2-d155b463825af5986d9a4ece4eadb611_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-d155b463825af5986d9a4ece4eadb611_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;就像我们在创建新的交易策略并绘制图表所做的那样。不幸的是，结果变得更糟，但我们做得比我们最初的ProphetThresh更好。我们不使用到目前为止的整个周期来计算thresh，而是像移动平均线（30、60、90等等），尝试各种滚动窗口的时间。&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;rolling_thresh&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;index&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month/year_index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;unique&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()):&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;rolling_performance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;roll&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;400&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;temp_df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month/year_index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DateOffset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;months&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;roll&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;\
            &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month/year_index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()]&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;performance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;thresh&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;linspace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;99&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;percent&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;temp_df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;y&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;temp_df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;yhat_lower&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;thresh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shift&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;temp_df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Percent Change&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cumprod&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;performance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;thresh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;percent&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;per_df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataFrame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;performance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;best_thresh&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;per_df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;idxmax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;percents&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;per_df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;best_thresh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;rolling_performance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;best_thresh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;percents&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;per_df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataFrame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rolling_performance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;best_rolling_thresh&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;per_df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;idxmax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month/year_index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;unique&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;pass&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;rolling_thresh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month/year_index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;unique&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;best_rolling_thresh&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;rolling_thresh&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataFrame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rolling_thresh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;columns&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month/year_index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Fcst Thresh&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;rolling_thresh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Fcst Thresh&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-d71538707faa3a62600bc9e7cfba0774_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;933&quot; data-rawheight=&quot;469&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;933&quot; data-original=&quot;https://pic1.zhimg.com/v2-d71538707faa3a62600bc9e7cfba0774_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-d71538707faa3a62600bc9e7cfba0774_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;933&quot; data-rawheight=&quot;469&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;933&quot; data-original=&quot;https://pic1.zhimg.com/v2-d71538707faa3a62600bc9e7cfba0774_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-d71538707faa3a62600bc9e7cfba0774_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;上面和以前很相似，但是现在我们尝试了不同的移动窗口和不同的阈值百分比。这变得相当复杂。从上面可以看到，随着时间的推移，阈值百分比随时间而变化。现在让我们看看我们是怎么做的。&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;yhat_optimized&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;merge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rolling_thresh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month/year_index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;how&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;left&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Fcst Thresh&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fillna&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shift&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;yhat_lower&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Prophet Rolling Thresh&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;y&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;yhat_optimized&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shift&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Percent Change&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cumprod&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dropna&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Hold&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Prophet&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Prophet Thresh&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Prophet Fcst Thresh&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Prophet Rolling Thresh&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Hold = {df[&amp;#39;Hold&amp;#39;].iloc[-1]*1000:,.0f}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Prophet = {df[&amp;#39;Prophet&amp;#39;].iloc[-1]*1000:,.0f}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Prophet Thresh = {df[&amp;#39;Prophet Thresh&amp;#39;].iloc[-1]*1000:,.0f}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# print(f&amp;#34;Seasonality = {df[&amp;#39;Seasonality&amp;#39;].iloc[-1]*1000:,.0f}&amp;#34;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Prophet Fcst Thresh = {df[&amp;#39;Prophet Fcst Thresh&amp;#39;].iloc[-1]*1000:,.0f}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Prophet Rolling Thresh = {df[&amp;#39;Prophet Rolling Thresh&amp;#39;].iloc[-1]*1000:,.0f}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;Hold&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;24&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;396&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Prophet&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;13&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;366&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Prophet&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Thresh&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;17&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;087&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Prophet&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Fcst&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Thresh&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;620&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Prophet&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Rolling&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Thresh&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;23&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;621&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-5758d5567355ff6af5249f4b073d8efd_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;949&quot; data-rawheight=&quot;451&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;949&quot; data-original=&quot;https://pic2.zhimg.com/v2-5758d5567355ff6af5249f4b073d8efd_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-5758d5567355ff6af5249f4b073d8efd_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;949&quot; data-rawheight=&quot;451&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;949&quot; data-original=&quot;https://pic2.zhimg.com/v2-5758d5567355ff6af5249f4b073d8efd_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-5758d5567355ff6af5249f4b073d8efd_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;正如你所看到的，仍然没有击败最简单买入持有策略。也许&lt;b&gt;&lt;i&gt;&amp;#34;Time in the Market is better then Timing the Market&amp;#34;&lt;/i&gt;&lt;/b&gt;这句话有一定道理。&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Time Traveler&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;y&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shift&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;yhat&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shift&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Percent Change&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cumprod&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dropna&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Hold&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Prophet&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Prophet Thresh&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Prophet Fcst Thresh&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Prophet Rolling Thresh&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Time Traveler&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Hold = {df[&amp;#39;Hold&amp;#39;].iloc[-1]*1000:,.0f}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Prophet = {df[&amp;#39;Prophet&amp;#39;].iloc[-1]*1000:,.0f}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Prophet Thresh = {df[&amp;#39;Prophet Thresh&amp;#39;].iloc[-1]*1000:,.0f}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# print(f&amp;#34;Seasonality = {df[&amp;#39;Seasonality&amp;#39;].iloc[-1]*1000:,.0f}&amp;#34;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Prophet Fcst Thresh = {df[&amp;#39;Prophet Fcst Thresh&amp;#39;].iloc[-1]*1000:,.0f}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Prophet Rolling Thresh = {df[&amp;#39;Prophet Rolling Thresh&amp;#39;].iloc[-1]*1000:,.0f}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Time Traveler = {df[&amp;#39;Time Traveler&amp;#39;].iloc[-1]*1000:,.0f}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;Hold&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;24&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;396&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Prophet&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;13&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;366&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Prophet&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Thresh&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;17&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;087&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Prophet&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Fcst&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Thresh&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;620&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Prophet&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Rolling&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Thresh&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;23&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;621&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Time&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Traveler&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;288&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;513&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-0f9c4d18e75b18e515b0062412e9d5bb_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;955&quot; data-rawheight=&quot;451&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;955&quot; data-original=&quot;https://pic4.zhimg.com/v2-0f9c4d18e75b18e515b0062412e9d5bb_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-0f9c4d18e75b18e515b0062412e9d5bb_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;955&quot; data-rawheight=&quot;451&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;955&quot; data-original=&quot;https://pic4.zhimg.com/v2-0f9c4d18e75b18e515b0062412e9d5bb_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-0f9c4d18e75b18e515b0062412e9d5bb_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;上面是Time Traveler策略。这当然是一个完美的交易策略，因为我们事先知道当市场上下波动。你最多能从1000美元中赚到288,513美元。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;总结&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;时间序列预测是非常复杂的，但Prophet使它非常容易创建稳健的预测，只需很少的努力。虽然它并没有使我们对股票市场的预测变得丰富，但是它仍然非常有用，并且可以快速地来解决不同领域的许多问题。&lt;i&gt;原文：&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//www.gardnmi.com/post/forecasting-stock-perfomance-with-prophet%23Simulating-Forecasts&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://www.&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;gardnmi.com/post/foreca&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;sting-stock-perfomance-with-prophet#Simulating-Forecasts&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/i&gt;&lt;/p&gt;&lt;p&gt;&lt;i&gt;—End—&lt;/i&gt;&lt;/p&gt;&lt;p&gt;量化投资与机器学习微信公众号，是业内垂直于&lt;b&gt;Quant&lt;/b&gt;、&lt;b&gt;MFE&lt;/b&gt;、&lt;b&gt;CST&lt;/b&gt;等专业的主流自媒体。公众号拥有来自&lt;b&gt;公募、私募、券商、银行、海外&lt;/b&gt;等众多圈内&lt;b&gt;10W+&lt;/b&gt;关注者。每日发布行业前沿研究成果和最新资讯。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>量化投资机器学习</author>
<guid isPermaLink="false">2019-04-08-61746724</guid>
<pubDate>Mon, 08 Apr 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>干货 | 如何用一行代码在多CPU环境下高效并行Pandas</title>
<link>https://henix.github.io/feeds/zhuanlan.Lhtz-Jqxx/2019-04-08-61746020.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/61746020&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-4f467d15a0b6c9cba5345ca6b0406c01_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;▎作者：Manu NALEPA&lt;/p&gt;&lt;p&gt;&lt;b&gt;▎&lt;/b&gt;编译：公众号翻译部&lt;/p&gt;&lt;p&gt;本文中介绍的&lt;b&gt;库只支持Linux&lt;/b&gt;和&lt;b&gt;MacOS&lt;/b&gt;。&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;安装文件文末下载&lt;/b&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-f7d3a12c6cd5494f3efb20eb28c99c14_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;310&quot; data-rawheight=&quot;228&quot; class=&quot;content_image&quot; width=&quot;310&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-f7d3a12c6cd5494f3efb20eb28c99c14_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;310&quot; data-rawheight=&quot;228&quot; class=&quot;content_image lazy&quot; width=&quot;310&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-f7d3a12c6cd5494f3efb20eb28c99c14_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;h2&gt;&lt;b&gt;什么问题困扰着我们?&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;对于Pandas，当你运行以下代码行时：&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;apply&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-41a8929271ebf00fa11d84837b9d8305_b.gif&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;699&quot; data-rawheight=&quot;159&quot; data-thumbnail=&quot;https://pic2.zhimg.com/v2-41a8929271ebf00fa11d84837b9d8305_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;699&quot; data-original=&quot;https://pic2.zhimg.com/v2-41a8929271ebf00fa11d84837b9d8305_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-41a8929271ebf00fa11d84837b9d8305_b.gif&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;699&quot; data-rawheight=&quot;159&quot; data-thumbnail=&quot;https://pic2.zhimg.com/v2-41a8929271ebf00fa11d84837b9d8305_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;699&quot; data-original=&quot;https://pic2.zhimg.com/v2-41a8929271ebf00fa11d84837b9d8305_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-41a8929271ebf00fa11d84837b9d8305_b.gif&quot;/&gt;&lt;figcaption&gt;只使用一个CPU&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;即使你的计算机有多个CPU，也只有一个CPU是完全用于计算的。&lt;/p&gt;&lt;p&gt;我们希望用一种简单的方法来代替CPU的使用：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-ccd581d0b1cc4660349369d7aca42033_b.gif&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;699&quot; data-rawheight=&quot;159&quot; data-thumbnail=&quot;https://pic4.zhimg.com/v2-ccd581d0b1cc4660349369d7aca42033_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;699&quot; data-original=&quot;https://pic4.zhimg.com/v2-ccd581d0b1cc4660349369d7aca42033_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-ccd581d0b1cc4660349369d7aca42033_b.gif&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;699&quot; data-rawheight=&quot;159&quot; data-thumbnail=&quot;https://pic4.zhimg.com/v2-ccd581d0b1cc4660349369d7aca42033_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;699&quot; data-original=&quot;https://pic4.zhimg.com/v2-ccd581d0b1cc4660349369d7aca42033_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-ccd581d0b1cc4660349369d7aca42033_b.gif&quot;/&gt;&lt;figcaption&gt;所有CPU齐上阵&lt;/figcaption&gt;&lt;/figure&gt;&lt;h2&gt;&lt;b&gt;Pandaral·lel如何解决这个问题？&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;Pandaral·lel的理念是将Pandas计算分配到计算机上所有可用的CPU上，以获得显著的速度提升。&lt;/p&gt;&lt;p&gt;&lt;b&gt;▍安装&lt;/b&gt;&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pip&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pandarallel&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;▍初始化&lt;/b&gt;&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Import&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pandarallel&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pandarallel&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Initialization&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pandarallel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;initialize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;▍用法&lt;/b&gt;&lt;/p&gt;&lt;p&gt;对于一个带有Pandas DataFrame df的简单用例和一个应用func的函数，只需用parallel_apply替换经典的apply。&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Standard pandas apply&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;apply&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Parallel apply&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parallel_apply&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;注意，如果不想并行化计算，仍然可以使用经典的apply方法。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-8c9b6df16ab6fbc7250bf00cd9ca7587_b.gif&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;758&quot; data-rawheight=&quot;76&quot; data-thumbnail=&quot;https://pic4.zhimg.com/v2-8c9b6df16ab6fbc7250bf00cd9ca7587_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;758&quot; data-original=&quot;https://pic4.zhimg.com/v2-8c9b6df16ab6fbc7250bf00cd9ca7587_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-8c9b6df16ab6fbc7250bf00cd9ca7587_b.gif&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;758&quot; data-rawheight=&quot;76&quot; data-thumbnail=&quot;https://pic4.zhimg.com/v2-8c9b6df16ab6fbc7250bf00cd9ca7587_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;758&quot; data-original=&quot;https://pic4.zhimg.com/v2-8c9b6df16ab6fbc7250bf00cd9ca7587_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-8c9b6df16ab6fbc7250bf00cd9ca7587_b.gif&quot;/&gt;&lt;/figure&gt;&lt;p&gt;你还可以通过在initialize函数中传递progress_bar=True来显示每个工作CPU的一个进度条。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-d89300ae2d13ccde85b67da1cde4c94a_b.gif&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;728&quot; data-rawheight=&quot;238&quot; data-thumbnail=&quot;https://pic3.zhimg.com/v2-d89300ae2d13ccde85b67da1cde4c94a_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;728&quot; data-original=&quot;https://pic3.zhimg.com/v2-d89300ae2d13ccde85b67da1cde4c94a_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-d89300ae2d13ccde85b67da1cde4c94a_b.gif&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;728&quot; data-rawheight=&quot;238&quot; data-thumbnail=&quot;https://pic3.zhimg.com/v2-d89300ae2d13ccde85b67da1cde4c94a_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;728&quot; data-original=&quot;https://pic3.zhimg.com/v2-d89300ae2d13ccde85b67da1cde4c94a_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-d89300ae2d13ccde85b67da1cde4c94a_b.gif&quot;/&gt;&lt;/figure&gt;&lt;p&gt;在一个更加复杂的Pandas DataFrame df用例中，DataFrame column1和column2的两列，以及一个函数用于func：&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Standard pandas apply&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;groupby&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;column1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;column2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rolling&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;apply&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Parallel apply&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;groupby&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;column1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;column2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rolling&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parallel_apply&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;基准&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;以下是其中四个例子的配置：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;操作系统：Linux Ubuntu 16.04&lt;/li&gt;&lt;li&gt;硬件：Intel Core i7 @ 3.40 GHz - 4核&lt;/li&gt;&lt;/ul&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load_ext&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;autoreload&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;autoreload&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pandas&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pd&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;time&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pandarallel&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pandarallel&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;math&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;▍DataFrame.apply&lt;/b&gt;&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;f_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;5e6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataFrame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;dict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;apply&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res_parallel&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parallel_apply&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;equals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;res_parallel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;▍DataFrame.applymap&lt;/b&gt;&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;df_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1e7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataFrame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;dict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;applymap&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res_parallel&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parallel_applymap&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;equals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;res_parallel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;▍DataFrame.groupby.apply&lt;/b&gt;&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;df_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;3e7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataFrame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;dict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;


&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;dum&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;item&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;dum&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;log10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dum&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;groupby&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;a&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;apply&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res_parallel&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;groupby&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;a&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parallel_apply&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;equals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;res_parallel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;▍DataFrame.groupby.rolling.apply&lt;/b&gt;&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;df_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1e6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataFrame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;dict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;300&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;groupby&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rolling&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;apply&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;raw&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res_parallel&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;groupby&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rolling&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parallel_apply&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;raw&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;equals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;res_parallel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-17cc5af8933e3f513c0bc10edd9b1cb7_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;954&quot; data-rawheight=&quot;507&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;954&quot; data-original=&quot;https://pic4.zhimg.com/v2-17cc5af8933e3f513c0bc10edd9b1cb7_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-17cc5af8933e3f513c0bc10edd9b1cb7_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;954&quot; data-rawheight=&quot;507&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;954&quot; data-original=&quot;https://pic4.zhimg.com/v2-17cc5af8933e3f513c0bc10edd9b1cb7_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-17cc5af8933e3f513c0bc10edd9b1cb7_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;h2&gt;标准 vs 并行四核（越低越好）&lt;/h2&gt;&lt;p&gt;除了df.groupby.col_name.rolling。如果应用程序的速度只增加了x3.2倍，那么平均速度就会增加大约x4倍，即使用的计算机上的内核数量。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;▍Series.map&lt;/b&gt;&lt;/h2&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;df_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;5e7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataFrame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;dict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;log10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res_parallel&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parallel_map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;equals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;res_parallel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;▍Series.apply&lt;/b&gt;&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;df_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;3.5e7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataFrame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;dict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;power&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bias&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;log10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;power&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bias&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;apply&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bias&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res_parallel&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parallel_apply&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bias&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;equals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;res_parallel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;▍Series.rolling.apply&lt;/b&gt;&lt;/h2&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;df_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1e6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataFrame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;dict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))))&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rolling&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;apply&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;raw&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res_parallel&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rolling&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parallel_apply&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;raw&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;equals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;res_parallel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;警告&lt;/b&gt;&lt;/p&gt;&lt;p&gt;1、进度条是一项实验性功能。这可能导致相当大的性能损失。parallel_apply不能用于DataFrameGroupy.parallel_apply。&lt;/p&gt;&lt;p&gt;2、使用df一个Pandas DataFrame，series 一个 Pandas Series，func一个函数来应用/ map，args1，args2一些参数＆col_name一个列名：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-84500b949460f3003e71f86116a2f75a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;952&quot; data-rawheight=&quot;606&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;952&quot; data-original=&quot;https://pic3.zhimg.com/v2-84500b949460f3003e71f86116a2f75a_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-84500b949460f3003e71f86116a2f75a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;952&quot; data-rawheight=&quot;606&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;952&quot; data-original=&quot;https://pic3.zhimg.com/v2-84500b949460f3003e71f86116a2f75a_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-84500b949460f3003e71f86116a2f75a_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-66e42399020f09072ade303483560baa_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;601&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-66e42399020f09072ade303483560baa_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-66e42399020f09072ade303483560baa_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;601&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-66e42399020f09072ade303483560baa_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-66e42399020f09072ade303483560baa_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;h2&gt;&lt;b&gt;具体如何操作的？&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;调用parallel_apply时，Pandaral·lel：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;实例化Pyarrow Plasma shared memory。&lt;/li&gt;&lt;/ul&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//arrow.apache.org/docs/python/plasma.html&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;The Plasma In-Memory Object Store&lt;/a&gt;&lt;ul&gt;&lt;li&gt;为每个CPU创建一个子进程，并要求每个CPU处理DataFrame的一个子部分。&lt;/li&gt;&lt;li&gt;在父进程中组合所有结果。&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;与其他进程间通信媒介相比，使用共享内存的主要优点是不存在序列化/反序列化，这可能会导致CPU开销过大。&lt;/p&gt;&lt;p&gt;&lt;b&gt;警告&lt;/b&gt;&lt;/p&gt;&lt;p&gt;1、&lt;b&gt;并行化是有条件的&lt;/b&gt;（实现新进程，通过共享内存发送数据等等），所以&lt;b&gt;只有当并行化的计算量足够高时，并行化才有效&lt;/b&gt;。对于很少的数据，使用parallezation并不总是有效的。&lt;/p&gt;&lt;p&gt;2、应用的函数不应该是lambda函数。&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pandarallel&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pandarallel&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;math&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sin&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;pandarallel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;initialize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# FORBIDDEN&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parallel_apply&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;lambda&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# ALLOWED&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parallel_apply&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;问题排除&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;我有8个CPU，但是 &lt;i&gt;parallel_apply&lt;/i&gt; 只加快了大约x4的计算速度。为什么?&lt;/p&gt;&lt;p&gt;实际上，Pandarallel 只能加快计算速度，直到你计算机有大约核心的数量。最近大多数CPU（如Intel core-i7）都使用超线程。例如，一个4核的超线程CPU将向操作系统显示8个CPU，但实际上只有4个物理计算单元。&lt;/p&gt;&lt;p&gt;在Ubuntu上，你可以用如下获得内核的数量：&lt;/p&gt;&lt;p&gt;&lt;i&gt;$ grep - m1 &amp;#39;cpu core &amp;#39; /proc/cpuinfo.&lt;/i&gt;&lt;/p&gt;&lt;p&gt;当我运行如下时：&lt;/p&gt;&lt;p&gt;&lt;i&gt;from pandarallel import pandarallel&lt;/i&gt;&lt;/p&gt;&lt;p&gt;我得到：&lt;/p&gt;&lt;p&gt;&lt;i&gt;ModuleNotFoundError: No module named &amp;#39;pyarrow._plasma。&lt;/i&gt;&lt;/p&gt;&lt;p&gt;为什么?&lt;/p&gt;&lt;p&gt;目前，Pyarrow Plasma只在Linux和macOS上工作（不支持Windows）&lt;/p&gt;&lt;h2&gt;&lt;b&gt;如何获取代码&lt;/b&gt;&lt;/h2&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s/2-Ayzmzo8tydDLoKpz1Ezw&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic1.zhimg.com/v2-d1a7a1925a8fd1a1f884a8f891f8f7e0_180x120.jpg&quot; data-image-width=&quot;1280&quot; data-image-height=&quot;543&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;干货 | 如何用一行代码在多CPU环境下高效并行Pandas&lt;/a&gt;&lt;p&gt;&lt;i&gt;—End—&lt;/i&gt;&lt;/p&gt;&lt;p&gt;量化投资与机器学习微信公众号，是业内垂直于&lt;b&gt;Quant&lt;/b&gt;、&lt;b&gt;MFE&lt;/b&gt;、&lt;b&gt;CST&lt;/b&gt;等专业的&lt;b&gt;主流自媒体&lt;/b&gt;。公众号拥有来自&lt;b&gt;公募、私募、券商、银行、海外&lt;/b&gt;等众多圈内&lt;b&gt;10W+&lt;/b&gt;关注者。每日发布行业前沿研究成果和最新资讯。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>量化投资机器学习</author>
<guid isPermaLink="false">2019-04-08-61746020</guid>
<pubDate>Mon, 08 Apr 2019 00:00:00 +0800</pubDate>
</item>
</channel>
</rss>
