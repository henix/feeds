<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>入门 | 从PCC到MIC，一文教你如何计算变量之间的相关性</title>
</head>
<body>
<p><a href="https://mp.weixin.qq.com/s?timestamp=1522504540&amp;src=3&amp;ver=1&amp;signature=ssOiy3io7mPgGP3Gz0YG7n255le*VUX5zHD3lIHUNgzye11oGSjNdzjHgO27ciqtav1nH8GBrHQXjFBHmINzhQxPQBMKRNmR3avlAAdUT9g2meiE3iJdFLoCIlnalPH6*IEttyMOEUbw71kRJSFG89WCmhAc*W-n6mERRhsDCOY=">原文</a></p>
<div id="img-content">
                
                <h2 class="rich_media_title" id="activity-name">
                    入门 | 从PCC到MIC，一文教你如何计算变量之间的相关性                                    </h2>
                <div id="meta_content" class="rich_media_meta_list">
                                                            <em id="post-date" class="rich_media_meta rich_media_meta_text">2018-03-22</em>

                                        <a class="rich_media_meta rich_media_meta_link rich_media_meta_nickname" href="##" id="post-user">机器之心</a>
                    <span class="rich_media_meta rich_media_meta_text rich_media_meta_nickname">机器之心</span>


                    <div id="js_profile_qrcode" class="profile_container" style="display:none;">
                        <div class="profile_inner">
                            <strong class="profile_nickname">机器之心</strong>
                            <img class="profile_avatar" id="js_profile_qrcode_img" src="" alt="">

                            <p class="profile_meta">
                            <label class="profile_meta_label">微信号</label>
                            <span class="profile_meta_value">almosthuman2014</span>
                            </p>

                            <p class="profile_meta">
                            <label class="profile_meta_label">功能介绍</label>
                            <span class="profile_meta_value">专业的人工智能媒体和产业服务平台</span>
                            </p>
                            
                        </div>
                        <span class="profile_arrow_wrp" id="js_profile_arrow_wrp">
                            <i class="profile_arrow arrow_out"></i>
                            <i class="profile_arrow arrow_in"></i>
                        </span>
                    </div>
                </div>
                
                
                
                
                                                
                                                                
                
                <div class="rich_media_content " id="js_content">
                    

                    

                    
                    
                    <section style="font-size: 16px;white-space: normal;max-width: 100%;color: rgb(62, 62, 62);background-color: rgb(255, 255, 255);line-height: 28.4444px;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section data-id="85660" data-custom="rgb(117, 117, 118)" data-color="rgb(117, 117, 118)" style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section data-id="85660" data-custom="rgb(117, 117, 118)" data-color="rgb(117, 117, 118)" style="max-width: 100%;border-width: 0px;border-style: initial;border-color: currentcolor;font-family: 微软雅黑;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="margin-top: 2em;padding-top: 0.5em;padding-bottom: 0.5em;max-width: 100%;border-style: solid none;font-family: inherit;text-decoration: inherit;border-top-color: rgb(204, 204, 204);border-bottom-color: rgb(204, 204, 204);border-top-width: 1px;border-bottom-width: 1px;box-sizing: border-box !important;word-wrap: break-word !important;"><p style="margin-top: -1.2em;max-width: 100%;min-height: 1em;text-align: center;line-height: 1.75em;border-width: initial;border-style: initial;border-color: currentcolor;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(255, 255, 255);background-color: rgb(117, 117, 118);box-sizing: border-box !important;word-wrap: break-word !important;">选自<span style="max-width: 100%;font-size: 14px;">FreeCoderCamp</span></span></p><section data-style="white-space: normal; text-align: left;font-size: 14px;line-height: 1.5em; color: rgb(12, 12, 12);" style="padding: 16px 16px 10px;max-width: 100%;font-family: inherit;box-sizing: border-box !important;word-wrap: break-word !important;"><p style="max-width: 100%;min-height: 1em;text-align: center;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 12px;color: rgb(136, 136, 136);box-sizing: border-box !important;word-wrap: break-word !important;">作者：Peter Gleeson</span></strong></p><p style="max-width: 100%;min-height: 1em;text-align: center;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 12px;color: rgb(136, 136, 136);box-sizing: border-box !important;word-wrap: break-word !important;">机器之心编译</span></strong></p><p style="max-width: 100%;min-height: 1em;text-align: center;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 12px;color: rgb(136, 136, 136);box-sizing: border-box !important;word-wrap: break-word !important;">参与：陈韵竹、程耀彤、刘晓坤</span></strong></p></section></section></section></section></section></section></section></section></section></section></section></section><p style="white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"></span><br></p><blockquote style="white-space: normal;"><p style="text-align: justify;line-height: 1.75em;"><span style="color: rgb(136, 136, 136);font-size: 14px;">本文介绍了几个重要的变量相关性的度量，包括皮尔逊相关系数、距离相关性和最大信息系数等，并用简单的代码和示例数据展示了这些度量的适用性对比。</span></p></blockquote><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"><br></span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">从信号的角度来看，这个世界是一个嘈杂的地方。为了弄清楚所有的事情，我们必须有选择地把注意力集中到有用的信息上。</span><br></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">通过数百万年的自然选择过程，我们人类已经变得非常擅长过滤背景信号。我们学会将特定的信号与特定的事件联系起来。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">例如，假设你正在繁忙的办公室中打乒乓球。为了回击对手的击球，你需要进行大量复杂的计算和判断，将多个相互竞争的感官信号考虑进去。为了预测球的运动，你的大脑必须重复采样球的位置并估计它未来的轨迹。更厉害的球员还会将对手击球时施加的旋转考虑进去。最后，为了击球，你需要考虑对手的位置、自己的位置、球的速度，以及你打算施加的旋转。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">所有这些都涉及到了大量的潜意识微分学。一般来说，我们理所当然的认为，我们的神经系统可以自动做到这些（至少经过一些练习之后）。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">同样令人印象深刻的是，人类大脑是如何区别对待它所接收到的无数竞争信号的重要性的。例如，球的位置被认为比你身后发生的对话或你面前打开的门更重要。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">这听起来似乎不值得一提，但实际上这证明了可以多大程度上学习从噪声数据中做出准确预测。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">当然，一个被给予连续的视听数据流的空白状态机将会面临一个困难的任务，即确定哪些信号能够最好地预测最佳行动方案。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">幸运的是，有统计和计算方法可以用来识别带噪声和复杂的数据中的模式。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: center;line-height: 1.75em;"><span style="font-size: 16px;"><strong>相关性</strong></span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">一般来说，当我们谈到两个变量之间的「相关性（correlation）」时，在某种意义上，我们是指它们的「关系（relatedness）」。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">相关变量是包含彼此信息的变量。两个变量的相关性越强，其中一个变量告诉我们的关于另一个变量的信息就越多。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"></span></p><p style="white-space: normal;"><img class="" data-copyright="0" data-ratio="0.3253333333333333" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWicxEuZ91UfMutRlK2nY2vW5jt6wDhrW4zM7eUAQ8WbeJmI0B0P0XrkwD9h3eVNJPFuDOicnJ9k7I2Q/640?wx_fmt=png" data-type="png" data-w="1500"></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 12px;"><em><span style="color: rgb(136, 136, 136);">你可能之前就看过：正相关、零相关、负相关</span></em></span><br><span style="font-size: 14px;"></span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">你可能已经对相关性、它的作用和它的局限性有了一定了解。事实上，这是一个数据科学的老生常谈：</span></p><blockquote style="white-space: normal;"><p style="margin-bottom: 20px;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;color: rgb(136, 136, 136);">「相关性不意味着因果关系」</span></p></blockquote><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">这当然是正确的——有充分的理由说明，即使是两个变量之间有强相关性也不保证存在因果关系。观察到的相关性可能是由于隐藏的第三个变量的影响，或者完全是偶然的。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">也就是说，相关性确实允许基于另一个变量来预测一个变量。有几种方法可以用来估计线性和非线性数据的相关性。我们来看看它们是如何工作的。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">我们将用 Python 和 R 来进行数学和代码实现。本文示例的代码可以在这里找到：</span></p><p style="margin-bottom: 20px;white-space: normal;line-height: 1.75em;"><span style="font-size: 14px;">GitHub 地址：https://gist.github.com/anonymous/fabecccf33f9c3feb568384f626a2c07</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: center;line-height: 1.75em;"><span style="font-size: 16px;"><strong>皮尔逊相关系数</strong></span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">皮尔逊相关系数（PCC, 或者 Pearson's r）是一种广泛使用的线性相关性的度量，它通常是很多初级统计课程的第一课。从数学角度讲，它被定义为「两个向量之间的协方差，通过它们标准差的乘积来归一化」。</span></p><p style="white-space: normal;line-height: 1.75em;"><span style="font-size: 14px;">两个成对的向量之间的协方差是它们在均值上下波动趋势的一种度量。也就是说，衡量一对向量是否倾向于在各自平均值的同侧或相反。</span></p><p style="white-space: normal;"><br></p><p style="white-space: normal;"><img class="" data-copyright="0" data-ratio="0.20833333333333334" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWicxEuZ91UfMutRlK2nY2vW5ectwZ9s0m42Xk1rwZ5OZTNqLA7lUJ7lNgeSUWq5gG2DjH302ibILuEg/640?wx_fmt=png" data-type="png" data-w="1200" style="height: 92px;width: 440px;"></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">让我们看看在 Python 中的实现：</span></p><pre style="margin-top: 0px;margin-bottom: 0px;padding: 0px;background-color: rgb(255, 255, 255);font-size: 16px;box-sizing: border-box;color: rgb(62, 62, 62);line-height: inherit;"><code class="python language-python hljs" style="margin-right: 2px;margin-left: 2px;padding: 0.5em;box-sizing: border-box;font-size: 14px;color: rgb(169, 183, 198);line-height: 18px;border-radius: 0px;background-color: rgb(40, 43, 46);font-family: Consolas, Inconsolata, Courier, monospace;display: block;overflow-x: auto;letter-spacing: 0px;word-wrap: normal !important;word-break: normal !important;overflow-y: auto !important;"><span class="hljs-function" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"><span class="hljs-keyword" style="word-wrap: inherit !important;word-break: inherit !important;">def</span> <span class="hljs-title" style="line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">mean(x)</span>:</span><br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">    <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">return</span> sum(x)/len(x)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"><span class="hljs-function" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"><span class="hljs-keyword" style="word-wrap: inherit !important;word-break: inherit !important;">def</span> <span class="hljs-title" style="line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">covariance(x,y)</span>:</span><br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">    calc = []<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">    <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">for</span> i <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">in</span> range(len(x)):<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">        xi = x[i] - mean(x)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">        yi = y[i] - mean(y)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">        calc.append(xi * yi)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">    <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">return</span> sum(calc)/(len(x) - <span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">1</span>)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">a = [<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">1</span>,<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">2</span>,<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">3</span>,<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">4</span>,<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">5</span>] ; b = [<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">5</span>,<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">4</span>,<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">3</span>,<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">2</span>,<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">1</span>]<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">print(covariance(a,b))</code></pre><p style="white-space: normal;"><br></p><p style="white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">协方差的计算方法是从每一对变量中减去各自的均值。然后，将这两个值相乘。</span></p><p style="white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"><br></span></p><ul class=" list-paddingleft-2" style=""><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">如果都高于（或都低于）均值，那么结果将是一个正数，因为正数 × 正数 = 正数；同样的，负数 × 负数 = 负数。</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">如果在均值的不同侧，那么结果将是一个负数（因为正数 × 负数 = 负数）。</span></p></li></ul><p style="white-space: normal;"><br></p><p style="white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">一旦我们为每一对变量都计算出这些值，将它们加在一起，并除以 n-1，其中 n 是样本大小。这就是样本协方差。</span></p><p style="white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"><br></span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">如果这些变量都倾向于分布在各自均值的同一侧，协方差将是一个正数；反之，协方差将是一个负数。这种倾向越强，协方差的绝对值就越大。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">如果不存在整体模式，那么协方差将会接近于零。这是因为正值和负值会相互抵消。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">最初，协方差似乎是两个变量之间「关系」的充分度量。但是，请看下面的图：</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"></span></p><p style="white-space: normal;"><img class="" data-copyright="0" data-ratio="0.5916666666666667" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWicxEuZ91UfMutRlK2nY2vW5KxBd5Mo4UfCBONPP88o3ElMbVgMyTpvfia7ZHw6jEmn6VicYRbVIKRrw/640?wx_fmt=png" data-type="png" data-w="1200"></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="color: rgb(136, 136, 136);font-size: 12px;"><em>协方差 = 0.00003</em></span><br><span style="font-size: 14px;"></span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">看起来变量之间有很强的关系，对吧？那为什么协方差这么小呢（大约是 0.00003）？</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">这里的关键是要认识到协方差是依赖于比例的。看一下 x 和 y 坐标轴——几乎所有的数据点都落在了 0.015 和 0.04 之间。协方差也将接近于零，因为它是通过从每个个体观察值中减去平均值来计算的。</span></p><p style="white-space: normal;line-height: 1.75em;"><span style="font-size: 14px;">为了获得更有意义的数字，归一化协方差是非常重要的。方法是将其除以两个向量标准差的乘积。</span></p><p style="white-space: normal;"><br></p><p style="white-space: normal;"><img class="" data-copyright="0" data-ratio="0.30583333333333335" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWicxEuZ91UfMutRlK2nY2vW5rI7XEy4SwESE8mkOp9G8qnF4v9ZyW5BNLf2QUy6FvkS2swa03McAibg/640?wx_fmt=png" data-type="png" data-w="1200" style="height: 74px;width: 241px;"></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 12px;"><em><span style="color: rgb(136, 136, 136);">在希腊字母中 ρ 常用来表示皮尔逊相关系数</span></em></span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">在 Python 中：</span></p><pre style="margin-top: 0px;margin-bottom: 0px;padding: 0px;background-color: rgb(255, 255, 255);font-size: 16px;box-sizing: border-box;color: rgb(62, 62, 62);line-height: inherit;"><code class="python language-python hljs" style="margin-right: 2px;margin-left: 2px;padding: 0.5em;box-sizing: border-box;font-size: 14px;color: rgb(169, 183, 198);line-height: 18px;border-radius: 0px;background-color: rgb(40, 43, 46);font-family: Consolas, Inconsolata, Courier, monospace;display: block;overflow-x: auto;letter-spacing: 0px;word-wrap: normal !important;word-break: normal !important;overflow-y: auto !important;"><span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">import</span> math<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"><span class="hljs-function" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"><span class="hljs-keyword" style="word-wrap: inherit !important;word-break: inherit !important;">def</span> <span class="hljs-title" style="line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">stDev(x)</span>:</span><br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">    variance = <span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">0</span><br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">    <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">for</span> i <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">in</span> x:<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">        variance += (i - mean(x) ** <span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">2</span>) / len(x)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">    <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">return</span> math.sqrt(variance)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"><span class="hljs-function" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"><span class="hljs-keyword" style="word-wrap: inherit !important;word-break: inherit !important;">def</span> <span class="hljs-title" style="line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">Pearsons(x,y)</span>:</span><br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">    cov = covariance(x,y)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">    <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">return</span> cov / (stDev(x) * stDev(y))</code></pre><p style="white-space: normal;"><br></p><p style="white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">这样做的原因是因为向量的标准差是是其方差的平方根。这意味着如果两个向量是相同的，那么将它们的标准差相乘就等于它们的方差。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"></span></p><p style="white-space: normal;"><img class="" data-copyright="0" data-ratio="0.23333333333333334" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWicxEuZ91UfMutRlK2nY2vW5OticHDcyKS1xPKdhdaAl58ekwqvLT2vG1tf4zkiaic4cwUEFFq12diaBIw/640?wx_fmt=png" data-type="png" data-w="1200" style="height: 60px;width: 259px;"></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">有趣的是，两个相同向量的协方差也等于它们的方差。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">因此，两个向量之间协方差的最大值等于它们标准差的乘积（当向量完全相关时会出现这种情况）。这将相关系数限制在 -1 到 +1 之间。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><strong><span style="font-size: 14px;">箭头指向哪个方向？</span></strong></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">顺便说一下，一个定义两个向量的 PCC 的更酷的方法来自线性代数。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">首先，我们通过从向量各自的值中减去其均值的方法来「集中」向量。</span></p><pre style="margin-top: 0px;margin-bottom: 0px;padding: 0px;background-color: rgb(255, 255, 255);font-size: 16px;box-sizing: border-box;color: rgb(62, 62, 62);line-height: inherit;"><code class="python language-python hljs" style="margin-right: 2px;margin-left: 2px;padding: 0.5em;box-sizing: border-box;font-size: 14px;color: rgb(169, 183, 198);line-height: 18px;border-radius: 0px;background-color: rgb(40, 43, 46);font-family: Consolas, Inconsolata, Courier, monospace;display: block;overflow-x: auto;letter-spacing: 0px;word-wrap: normal !important;word-break: normal !important;overflow-y: auto !important;">a = [<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">1</span>,<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">2</span>,<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">3</span>,<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">4</span>,<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">5</span>] ; b = [<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">5</span>,<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">4</span>,<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">3</span>,<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">2</span>,<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">1</span>]<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">a_centered = [i - mean(a) <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">for</span> i <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">in</span> a]<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">b_centered = [j - mean(b) <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">for</span> j <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">in</span> b]</code></pre><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><br></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">现在，我们可以利用向量可以看做指向特定方向的「箭头」的事实。</span></p><p style="white-space: normal;line-height: 1.75em;"><span style="font-size: 14px;">例如，在 2-D 空间中，向量 [1,3] 可以代表一个沿 x 轴 1 个单位，沿 y 轴 3 个单位的箭头。同样，向量 [2,1] 可以代表一个沿 x 轴 2 个单位，沿 y 轴 1 个单位的箭头。</span></p><p style="white-space: normal;"><br></p><p style="white-space: normal;"><img class="" data-copyright="0" data-ratio="0.4533333333333333" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWicxEuZ91UfMutRlK2nY2vW51icXW4YQ5ic6M2InBFNXu7K250KiboRCDE8lNEWQN9YZxUR2ictetKiaOiaA/640?wx_fmt=png" data-type="png" data-w="1200"></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 12px;"><em><span style="color: rgb(136, 136, 136);">两个向量 (1,3) 和 (2,1) 如箭头所示。</span></em></span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">类似地，我们可以将数据向量表示为 n 维空间中的箭头（尽管当 n &gt; 3 时不能尝试可视化）。</span></p><p style="white-space: normal;"><span style="font-size: 14px;">这些箭头之间的角度 ϴ 可以使用两个向量的点积来计算。定义为：</span></p><p style="white-space: normal;"><br></p><p style="white-space: normal;"><img class="" data-copyright="0" data-ratio="0.16083333333333333" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWicxEuZ91UfMutRlK2nY2vW5ZURYibtO7pzbIbcDZtSqT90MCvpNEhhg4485gKvIbOiaE5Wb5TPUOBBg/640?wx_fmt=png" data-type="png" data-w="1200"></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">或者，在 Python 中：</span></p><pre style="margin-top: 0px;margin-bottom: 0px;padding: 0px;background-color: rgb(255, 255, 255);font-size: 16px;box-sizing: border-box;color: rgb(62, 62, 62);line-height: inherit;"><code class="python language-python hljs" style="margin-right: 2px;margin-left: 2px;padding: 0.5em;box-sizing: border-box;font-size: 14px;color: rgb(169, 183, 198);line-height: 18px;border-radius: 0px;background-color: rgb(40, 43, 46);font-family: Consolas, Inconsolata, Courier, monospace;display: block;overflow-x: auto;letter-spacing: 0px;word-wrap: normal !important;word-break: normal !important;overflow-y: auto !important;"><span class="hljs-function" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"><span class="hljs-keyword" style="word-wrap: inherit !important;word-break: inherit !important;">def</span> <span class="hljs-title" style="line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">dotProduct(x,y)</span>:</span><br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">    calc = <span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">0</span><br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">    <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">for</span> i <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">in</span> range(len(x)):<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">        calc += x[i] * y[i]<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">    <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">return</span> calc</code></pre><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><br></p><p style="white-space: normal;"><span style="font-size: 14px;">点积也可以被定义为：</span></p><p style="white-space: normal;"><br></p><p style="white-space: normal;"><img class="" data-copyright="0" data-ratio="0.155" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWicxEuZ91UfMutRlK2nY2vW5brys1lxick1u7X3EyTIA2Thiboib5PmG3VjNGdmZcgYBstYCDU5APzQxA/640?wx_fmt=png" data-type="png" data-w="1200"></p><p style="white-space: normal;"><span style="font-size: 14px;">其中 || x || 是向量 x 的大小（或「长度」）（参考勾股定理），ϴ 是箭头向量之间的角度。</span></p><p style="white-space: normal;"><br></p><p style="white-space: normal;"><img class="" data-copyright="0" data-ratio="0.20166666666666666" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWicxEuZ91UfMutRlK2nY2vW5zpEZAhfP2pQVl7m6oNH4oQ0ziaOlYNBmjaanoltAObmLPawQI7rvpqg/640?wx_fmt=png" data-type="png" data-w="1200"></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">正如一个 Python 函数：</span></p><pre style="margin-top: 0px;margin-bottom: 0px;padding: 0px;background-color: rgb(255, 255, 255);font-size: 16px;box-sizing: border-box;color: rgb(62, 62, 62);line-height: inherit;"><code class="python language-python hljs" style="margin-right: 2px;margin-left: 2px;padding: 0.5em;box-sizing: border-box;font-size: 14px;color: rgb(169, 183, 198);line-height: 18px;border-radius: 0px;background-color: rgb(40, 43, 46);font-family: Consolas, Inconsolata, Courier, monospace;display: block;overflow-x: auto;letter-spacing: 0px;word-wrap: normal !important;word-break: normal !important;overflow-y: auto !important;"><span class="hljs-function" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"><span class="hljs-keyword" style="word-wrap: inherit !important;word-break: inherit !important;">def</span> <span class="hljs-title" style="line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">magnitude(x)</span>:</span><br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">    x_sq = [i ** <span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">2</span> <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">for</span> i <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">in</span> x]<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">    <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">return</span> math.sqrt(sum(x_sq))</code></pre><p style="white-space: normal;"><br></p><p style="white-space: normal;"><span style="font-size: 14px;">我们通过将点积除以两个向量大小的乘积的方法得到 cos(ϴ)。</span></p><p style="white-space: normal;"><br></p><p style="white-space: normal;"><img class="" data-copyright="0" data-ratio="0.19166666666666668" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWicxEuZ91UfMutRlK2nY2vW5wmMhWzXgM29vOsM4xktS4ICvtAQ75vzQd0Dwqo84zegdxeEP75Biaow/640?wx_fmt=png" data-type="png" data-w="1200"></p><pre style="margin-top: 0px;margin-bottom: 0px;padding: 0px;background-color: rgb(255, 255, 255);font-size: 16px;box-sizing: border-box;color: rgb(62, 62, 62);line-height: inherit;"><code class="python language-python hljs" style="margin-right: 2px;margin-left: 2px;padding: 0.5em;box-sizing: border-box;font-size: 14px;color: rgb(169, 183, 198);line-height: 18px;border-radius: 0px;background-color: rgb(40, 43, 46);font-family: Consolas, Inconsolata, Courier, monospace;display: block;overflow-x: auto;letter-spacing: 0px;word-wrap: normal !important;word-break: normal !important;overflow-y: auto !important;"><span class="hljs-function" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"><span class="hljs-keyword" style="word-wrap: inherit !important;word-break: inherit !important;">def</span> <span class="hljs-title" style="line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">cosTheta(x,y)</span>:</span><br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">    mag_x = magnitude(x)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">    mag_y = magnitude(y)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">    <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">return</span> dotProduct(x,y) / (mag_x * mag_y)</code></pre><p style="white-space: normal;"><br></p><p style="white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">现在，如果你对三角学有一定了解，你可能会记得，余弦函数产生一个在 +1 和 -1 之间震荡的图形。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"></span></p><p style="white-space: normal;"><img class="" data-copyright="0" data-ratio="0.2742857142857143" src="https://mmbiz.qpic.cn/mmbiz_gif/KmXPKA19gWicxEuZ91UfMutRlK2nY2vW5J7icJeia8MqGxmXDDqglUFZciaumgwyuYZryGGF7COOFiaq07hF1RZI29Q/640?wx_fmt=gif" data-type="gif" data-w="700"></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"></span><br></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">cos(ϴ) 的值将根据两个箭头向量之间的角度而发生变化。</span></p><ul class=" list-paddingleft-2" style=""><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">当角度为零时（即两个向量指向完全相同的方向），cos(ϴ) 等于 1。</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">当角度为 -180°时（两个向量指向完全相反的方向），cos(ϴ) 等于 -1。</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">当角度为 90°时（两个向量指向完全不相关的方向），cos(ϴ) 等于 0。</span></p></li></ul><p style="white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"><br></span></p><p style="white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">这可能看起来很熟悉——一个介于 +1 和 -1 之间的衡量标准似乎描述了两个向量之间的关系？那不是 Pearson’s r 吗？</span></p><p style="white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"><br></span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">那么——这正是它的解释！通过将数据视为高维空间中的箭头向量，我们可以用它们之间的角度 ϴ 作为相似度的衡量。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"></span></p><p style="white-space: normal;"><img class="" data-copyright="0" data-ratio="0.31266666666666665" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWicxEuZ91UfMutRlK2nY2vW5wJMHtLpSEfEozOtH5ENOgYRaM08icalAQLUibFrTxEz6UyThZ6A7sAWQ/640?wx_fmt=png" data-type="png" data-w="1500"></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 12px;"><em><span style="color: rgb(136, 136, 136);">A) 正相关向量； B) 负相关向量； C) 不相关向量</span></em></span><br><span style="font-size: 14px;"></span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">该角度 ϴ 的余弦在数学上与皮尔逊相关系数相等。当被视为高维箭头时，正相关向量将指向一个相似的方向。负相关向量将指向相反的方向。而不相关向量将指向直角。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">就我个人而言，我认为这是一个理解相关性的非常直观的方法。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><strong><span style="font-size: 14px;">统计显著性？</span></strong></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">正如频率统计一样，重要的是询问从给定样本计算的检验统计量实际上有多重要。Pearson's r 也不例外。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">不幸的是，PCC 估计的置信区间不是完全直接的。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">这是因为 Pearson's r 被限制在 -1 和 +1 之间，因此不是正态分布的。而估计 PCC，例如 +0.95 之上只有很少的容错空间，但在其之下有大量的容错空间。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">幸运的是，有一个解决方案——用一个被称为 Fisher 的 Z 变换的技巧：</span></p><ol class=" list-paddingleft-2" style=""><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">像平常一样计算 Pearson's r 的估计值。</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">用 Fisher 的 Z 变换将 r→z，用公式 z = arctanh(r) 完成。</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">现在计算 z 的标准差。幸运的是，这很容易计算，由 SDz = 1/sqrt(n-3) 给出，其中 n 是样本大小。</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">选择显著性阈值，alpha，并检查与此对应的平均值有多少标准差。如果取 alpha = 0.95，用 1.96。</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">通过计算 z +(1.96 × SDz) 找到上限，通过计算 z - (1.96 × SDz) 找到下限。</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">用 r = tanh(z) 将这些转换回 r。</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">如果上限和下限都在零的同一侧，则有统计显著性！</span></p></li></ol><p style="white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"><br></span></p><p style="white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">这里是在 Python 中的实现：</span></p><p style="white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"><br></span></p><pre style="margin-top: 0px;margin-bottom: 0px;padding: 0px;background-color: rgb(255, 255, 255);font-size: 16px;box-sizing: border-box;color: rgb(62, 62, 62);line-height: inherit;"><code class="python language-python hljs" style="margin-right: 2px;margin-left: 2px;padding: 0.5em;box-sizing: border-box;font-size: 14px;color: rgb(169, 183, 198);line-height: 18px;border-radius: 0px;background-color: rgb(40, 43, 46);font-family: Consolas, Inconsolata, Courier, monospace;display: block;overflow-x: auto;letter-spacing: 0px;word-wrap: normal !important;word-break: normal !important;overflow-y: auto !important;">r = Pearsons(x,y)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">z = math.atanh(r)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">SD_z = <span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">1</span> / math.sqrt(len(x) - <span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">3</span>)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">z_upper = z + <span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">1.96</span> * SD_z<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">z_lower = z - <span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">1.96</span> * SD_z<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">r_upper = math.tanh(z_upper)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">r_lower = math.tanh(z_lower)</code></pre><p style="white-space: normal;text-align: justify;line-height: 1.75em;"><br></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">当然，当给定一个包含许多潜在相关变量的大数据集时，检查每对的相关性可能很吸引人。这通常被称为「数据疏浚」——在数据集中查找变量之间的任何明显关系。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">如果确实采用这种多重比较方法，则应该用适当的更严格的显著性阈值来降低发现错误相关性的风险（即找到纯粹偶然相关的无关变量）。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">一种方法是使用 Bonferroni correction。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><strong><span style="font-size: 14px;">小结</span></strong></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">到现在为止还好。我们已经看到 Pearson's r 如何用来计算两个变量之间的相关系数，以及如何评估结果的统计显著性。给定一组未知的数据，用于开始挖掘变量之间的重要关系是很有可能的。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">但是，有一个重要的陷阱——Pearson's r 只适用于线性数据。</span></p><p style="white-space: normal;"><span style="font-size: 14px;">看下面的图。它们清楚地展示了一种看似非随机的关系，但是 Pearson's r 非常接近于零。</span></p><p style="white-space: normal;"><br></p><p style="white-space: normal;"><img class="" data-copyright="0" data-ratio="0.41" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWicxEuZ91UfMutRlK2nY2vW55bTKU5X8hNxrbl6hQbiaysNF1vxHGna8ibhgQFJ0Ixia8Lj3J68YeWfjw/640?wx_fmt=png" data-type="png" data-w="1200"></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">原因是因为这些图中的变量具有非线性关系。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">我们通常可以将两个变量之间的关系描绘成一个点云，分散在一条线的两侧。点云的分散度越大，数据越「嘈杂」，关系越弱。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">然而，由于它将每个单独的数据点与整体平均值进行比较，所以 Pearson's r 只考虑直线。这意味着检测非线性关系并不是很好。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">在上面的图中，Pearson's r 并没有显示研究对象的相关性。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">然而，这些变量之间的关系很显然是非随机的。幸运的是，我们有不同的相关性方法。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">让我们来看看其中几个。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: center;line-height: 1.75em;"><span style="font-size: 16px;"><strong>距离相关性</strong></span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">距离相关性与 Pearson's r 有一些相似之处，但是实际上是用一个相当不同的协方差概念来计算的。该方法通过用「距离」类似物替代常用的协方差和标准差（如上所定义）的概念。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">类似 Pearson's r，「距离相关性」被定义为「距离协方差」，由「距离标准差」来归一化。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">距离相关性不是根据它们与各自平均值的距离来估计两个变量如何共同变化，而是根据与其他点的距离来估计它们是如何共同变化的，从而能更好捕捉变量之间非线性依赖关系。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><strong><span style="font-size: 14px;">深入细节</span></strong></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">出生于 1773 年的 Robert Brown 是一名苏格兰植物学家。当布朗在显微镜下研究植物花粉时，注意到液面上有随机运动的有机颗粒。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">他没有想到，这一观察竟使他名垂千古——他成为了布朗运动的（重新）发现者。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">他更不会知道，近一个世纪的时间后爱因斯坦才对这种现象做出了解释，从而证实了原子的存在。同年，爱因斯坦发表了关于狭义相对论的论文（E=MC²），并打开了量子理论的大门。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">布朗运动是这样一个物理过程：由于与周围粒子的碰撞，微小粒子随机运动。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">布朗运动背后的数学原理可以被推广为维纳过程（Weiner process），维纳过程在数学金融中最著名的模型 Black-Scholes 中也扮演着重要的角色。</span></p><p style="white-space: normal;line-height: 1.75em;"><span style="font-size: 14px;">有趣的是，Gabor Szekely 在 20 世纪中期的研究表明，布朗运动和维纳过程和一个非线性关联度量相关。</span></p><p style="white-space: normal;"><br></p><p style="white-space: normal;"><img class="" data-copyright="0" data-ratio="0.185" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWicxEuZ91UfMutRlK2nY2vW5gbfoUhfDrL6gRKSILNSNOmSU7lMY7DeoBfibGfoTgyNXHibl13NWT4VQ/640?wx_fmt=png" data-type="png" data-w="1200" style="height: 85px;width: 458px;"></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">让我们来看看如何由长度为 N 的向量 x 和 y 计算这个量。</span></p><p style="white-space: normal;line-height: 1.75em;"><span style="font-size: 14px;">1. 首先，我们对每个向量构建 N×N 的距离矩阵。距离矩阵和地图中的道路距离表非常类似——每行、每列的交点显示了相应城市间的距离。在距离矩阵中，行 i 和列 j 的交点给出了向量的第 i 个元素和第 j 个元素之间的距离。</span></p><p style="white-space: normal;"><br></p><p style="white-space: normal;"><img class="" data-copyright="0" data-ratio="0.15666666666666668" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWicxEuZ91UfMutRlK2nY2vW5FicIb46jlibHZaOR1x6GSfxbO9RYibUBtpbg7Faicuq2LCIGERB7DkbUTg/640?wx_fmt=png" data-type="png" data-w="1200" style="height: 70px;width: 450px;"></p><p style="white-space: normal;line-height: 1.75em;"><span style="font-size: 14px;">2. 第二，矩阵是「双中心」的。也就是说，对于每个元素，我们减去了它的行平均值和列平均值。然后，我们再加上整个矩阵的总平均值。</span></p><p style="white-space: normal;"><br></p><p style="white-space: normal;"><img class="" data-copyright="0" data-ratio="0.29" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWicxEuZ91UfMutRlK2nY2vW5mkGLZru77ffeWMicbkDG2joBic7c3VANB6DYjPIbssNetkem9ocJ8kuQ/640?wx_fmt=png" data-type="png" data-w="1200" style="height: 119px;width: 410px;"></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">上述公式中，加「^」表示「双中心」，加「-」表示「平均值」。</span></p><p style="white-space: normal;line-height: 1.75em;"><span style="font-size: 14px;">3. 在两个双中心矩阵的基础上，将 X 中每个元素的均值乘以 Y 中相应元素的均值，则可计算出距离协方差的平方。</span></p><p style="white-space: normal;"><br></p><p style="white-space: normal;"><img class="" data-copyright="0" data-ratio="0.1875" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWicxEuZ91UfMutRlK2nY2vW5NqDsVxqT0qw2fAsBKGMEKj3SNWAv1lz2ue568rcxYtO5JM5mnVCfTg/640?wx_fmt=png" data-type="png" data-w="1200" style="height: 78px;width: 416px;"></p><p style="white-space: normal;line-height: 1.75em;"><span style="font-size: 14px;">4. 现在，我们可以用类似的办法找到「距离方差」。请记住，若两个向量相同，其协方差与其方差相等。因此，距离方差可表示如下：</span></p><p style="white-space: normal;"><br></p><p style="white-space: normal;"><img class="" data-copyright="0" data-ratio="0.11655405405405406" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWicxEuZ91UfMutRlK2nY2vW5cbEibiczeccEmyrn3nicSWQb1F1SibbJGNZQGeNADxLaoU4j1cic4J3BvIg/640?wx_fmt=png" data-type="png" data-w="1184" style="height: 49px;width: 417px;"></p><p style="white-space: normal;line-height: 1.75em;"><span style="font-size: 14px;">5. 最后，我们利用上述公式计算距离相关性。请记住，（距离）标准差与（距离）方差的平方根相等。</span></p><p style="white-space: normal;"><br></p><p style="white-space: normal;"><img class="" data-copyright="0" data-ratio="0.185" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWicxEuZ91UfMutRlK2nY2vW5gbfoUhfDrL6gRKSILNSNOmSU7lMY7DeoBfibGfoTgyNXHibl13NWT4VQ/640?wx_fmt=png" data-type="png" data-w="1200" style="height: 76px;width: 409px;"></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">如果你更喜欢代码实现而非数学符号，那么请看下面的 R 语言实现：</span></p><pre style="margin-top: 0px;margin-bottom: 0px;padding: 0px;background-color: rgb(255, 255, 255);font-size: 16px;box-sizing: border-box;color: rgb(62, 62, 62);line-height: inherit;"><code class="python language-python hljs" style="margin-right: 2px;margin-left: 2px;padding: 0.5em;box-sizing: border-box;font-size: 14px;color: rgb(169, 183, 198);line-height: 18px;border-radius: 0px;background-color: rgb(40, 43, 46);font-family: Consolas, Inconsolata, Courier, monospace;display: block;overflow-x: auto;letter-spacing: 0px;word-wrap: normal !important;word-break: normal !important;overflow-y: auto !important;">set.seed(<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">1234</span>)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">doubleCenter &lt;- function(x){<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  centered &lt;- x<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">for</span>(i <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">in</span> <span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">1</span>:dim(x)[<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">1</span>]){<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">    <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">for</span>(j <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">in</span> <span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">1</span>:dim(x)[<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">2</span>]){<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">      centered[i,j] &lt;- x[i,j] - mean(x[i,]) - mean(x[,j]) + mean(x)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">    }<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  }<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">return</span>(centered)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">}<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">distanceCovariance &lt;- function(x,y){<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  N &lt;- length(x)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  distX &lt;- <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">as</span>.matrix(dist(x))<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  distY &lt;- <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">as</span>.matrix(dist(y))<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  centeredX &lt;- doubleCenter(distX)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  centeredY &lt;- doubleCenter(distY)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  calc &lt;- sum(centeredX * centeredY)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">return</span>(sqrt(calc/(N^<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">2</span>)))<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">}<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">distanceVariance &lt;- function(x){<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">return</span>(distanceCovariance(x,x))<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">}<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">distanceCorrelation &lt;- function(x,y){<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  cov &lt;- distanceCovariance(x,y)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  sd &lt;- sqrt(distanceVariance(x)*distanceVariance(y))<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">return</span>(cov/sd)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">}<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"><span class="hljs-comment" style="box-sizing: border-box;font-size: inherit;color: rgb(128, 128, 128);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"># Compare with Pearson's r</span><br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">x &lt;- <span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">-10</span>:<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">10</span><br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">y &lt;- x^<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">2</span> + rnorm(<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">21</span>,<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">0</span>,<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">10</span>)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">cor(x,y) <span class="hljs-comment" style="box-sizing: border-box;font-size: inherit;color: rgb(128, 128, 128);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"># --&gt; 0.057</span><br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">distanceCorrelation(x,y) <span class="hljs-comment" style="box-sizing: border-box;font-size: inherit;color: rgb(128, 128, 128);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"># --&gt; 0.509</span></code></pre><p style="margin-top: 10px;margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">任意两变量的距离相关性都在 0 和 1 之间。其中，0 代表两变量相互独立，而接近于 1 则表明变量间存在依赖关系。</span><br></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">如果你不想从头开始编写距离相关方法，你可以安装 R 语言的 energy 包（https://cran.r-project.org/web/packages/energy/index.html），设计此方案的研究者提供了本代码。在该程序包中，各类可用方案调用的是 C 语言编写的函数，因此有着很大的速度优势。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><strong><span style="font-size: 14px;">物理解释</span></strong></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">关于距离相关性的表述，有着一个更令人惊讶的结果——它与布朗关联（Brownian correlation）有着确切的等价关系。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">布朗关联指的是两个布朗过程之间的独立性（或依赖性）。相互依赖的布朗过程将会表现出彼此「跟随」的趋势。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">让我们用一个简单的比喻来把握距离相关性的概念——请看下图中漂浮在湖面上的小纸船。</span></p><p style="white-space: normal;"><span style="font-size: 14px;">如果没有盛行风向，那么每艘船都将进行随机漂流——这与布朗运动类似。</span></p><p style="white-space: normal;"><br></p><p style="white-space: normal;"><img class="" data-copyright="0" data-ratio="0.62375" src="https://mmbiz.qpic.cn/mmbiz_gif/KmXPKA19gWicxEuZ91UfMutRlK2nY2vW58Qlutx4viaVHicnTTDgulG8ofkQR5rbcK1eJGwTQo5tUW5pic43rqdPVA/640?wx_fmt=gif" data-type="gif" data-w="800"></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="color: rgb(136, 136, 136);font-size: 12px;"><em>无盛行风向时，小船随机漂流</em></span><br><span style="font-size: 14px;"></span></p><p style="white-space: normal;"><span style="font-size: 14px;">如果存在盛行风向，那么小船漂流的方向将依赖于风的强度。风力越强，依赖性越显著。</span></p><p style="white-space: normal;"><br></p><p style="white-space: normal;"><img class="" data-copyright="0" data-ratio="0.625" src="https://mmbiz.qpic.cn/mmbiz_gif/KmXPKA19gWicxEuZ91UfMutRlK2nY2vW5vxich8pPrm945mNcm91U8LbfoGvC7YwFYgkENdr7ic77r5TRsicmzMcWw/640?wx_fmt=gif" data-type="gif" data-w="800"></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="color: rgb(136, 136, 136);font-size: 12px;"><em>有盛行风向时，小船倾向于同向漂流</em></span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">与之类似，无关变量可以被看作无盛行风向时随机漂流的小船；相关变量可以被看作在盛行风向影响下漂流的小船。在这个比喻中，风的强弱就代表着两个变量之间相关性的强弱。</span></p><p style="white-space: normal;"><span style="font-size: 14px;">如果我们允许盛行风向在湖面的不同位置有所不同，那么我们就可以引入非线性的概念。距离相关性利用「小船」之间的距离推断盛行风的强度。</span></p><p style="white-space: normal;"><br></p><p style="white-space: normal;"><img class="" data-copyright="0" data-ratio="0.62375" src="https://mmbiz.qpic.cn/mmbiz_gif/KmXPKA19gWicxEuZ91UfMutRlK2nY2vW5qTcdnLULiaHt0HYg6NZRAHLOpeAMERQiaibEkSKWKEZTdIaF2DlVcRqnA/640?wx_fmt=gif" data-type="gif" data-w="800"></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"></span><br></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><strong><span style="font-size: 14px;">置信区间？</span></strong></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">我们可以采取「重采样（resampling）」方法为距离相关性估计建立置信区间。一个简单的例子是 bootstrap 重采样。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">这是一个巧妙的统计技巧，需要我们从原始数据集中随机抽样（替换）以「重建」数据。这个过程将重复多次（例如 1000 次），每次都计算感兴趣的统计量。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">这将为我们感兴趣的统计量产生一系列不同的估计值。我们可以通过它们估计在给定置信水平下的上限和下限。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">请看下面的 R 语言代码，它实现了简单的 bootstrap 函数：</span></p><pre style="margin-top: 0px;margin-bottom: 0px;padding: 0px;background-color: rgb(255, 255, 255);font-size: 16px;box-sizing: border-box;color: rgb(62, 62, 62);line-height: inherit;"><code class="python language-python hljs" style="margin-right: 2px;margin-left: 2px;padding: 0.5em;box-sizing: border-box;font-size: 14px;color: rgb(169, 183, 198);line-height: 18px;border-radius: 0px;background-color: rgb(40, 43, 46);font-family: Consolas, Inconsolata, Courier, monospace;display: block;overflow-x: auto;letter-spacing: 0px;word-wrap: normal !important;word-break: normal !important;overflow-y: auto !important;">set.seed(<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">1234</span>)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">bootstrap &lt;- function(x,y,reps,alpha){<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  estimates &lt;- c()<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  original &lt;- data.frame(x,y)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  N &lt;- dim(original)[<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">1</span>]<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">for</span>(i <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">in</span> <span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">1</span>:reps){<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">    S &lt;- original[sample(<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">1</span>:N, N, replace = TRUE),]<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">    estimates &lt;- append(estimates, distanceCorrelation(S$x, S$y))<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  }<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  u &lt;- alpha/<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">2</span> ; l &lt;- <span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">1</span>-u<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  interval &lt;- quantile(estimates, c(l, u))<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">return</span>(<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">2</span>*(dcor(x,y)) - <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">as</span>.numeric(interval[<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">1</span>:<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">2</span>]))<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">}<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"><span class="hljs-comment" style="box-sizing: border-box;font-size: inherit;color: rgb(128, 128, 128);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"># Use with 1000 reps and threshold alpha = 0.05</span><br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">x &lt;- <span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">-10</span>:<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">10</span><br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">y &lt;- x^<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">2</span> + rnorm(<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">21</span>,<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">0</span>,<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">10</span>)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">bootstrap(x,y,<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">1000</span>,<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">0.05</span>) <span class="hljs-comment" style="box-sizing: border-box;font-size: inherit;color: rgb(128, 128, 128);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"># --&gt; 0.237 to 0.546</span></code></pre><p style="margin-top: 10px;margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">如果你想建立统计显著性，还有另一个重采样技巧，名为「排列检验（permutation test）」。</span><br></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">排列检验与上述 bootstrap 方法略有不同。在排列检验中，我们保持一个向量不变，并通过重采样对另一个变量进行「洗牌」。这接近于零假设（null hypothesis）——即，在变量之间不存在依赖关系。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">这个经「洗牌」打乱的变量将被用于计算它和常变量间的距离相关性。这个过程将被执行多次，然后，结果的分布将与实际距离相关性（从未被「洗牌」的数据中获得）相比较。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">然后，大于或等于「实际」结果的经「洗牌」的结果的比例将被定为 P 值，并与给定的显著性阈值（如 0.05）进行比较。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">以下是上述过程的代码实现：</span></p><pre style="margin-top: 0px;margin-bottom: 0px;padding: 0px;background-color: rgb(255, 255, 255);font-size: 16px;box-sizing: border-box;color: rgb(62, 62, 62);line-height: inherit;"><code class="python language-python hljs" style="margin-right: 2px;margin-left: 2px;padding: 0.5em;box-sizing: border-box;font-size: 14px;color: rgb(169, 183, 198);line-height: 18px;border-radius: 0px;background-color: rgb(40, 43, 46);font-family: Consolas, Inconsolata, Courier, monospace;display: block;overflow-x: auto;letter-spacing: 0px;word-wrap: normal !important;word-break: normal !important;overflow-y: auto !important;">permutationTest &lt;- function(x,y,reps){<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  estimates &lt;- c()<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  observed &lt;- distanceCorrelation(x,y)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  N &lt;- length(x)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">for</span>(i <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">in</span> <span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">1</span>:reps){<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">    y_i &lt;- sample(y, length(y), replace = T)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">    estimates &lt;- append(estimates, distanceCorrelation(x, y_i))<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  }<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  p_value &lt;- mean(estimates &gt;= observed)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">return</span>(p_value)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">}<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"><span class="hljs-comment" style="box-sizing: border-box;font-size: inherit;color: rgb(128, 128, 128);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"># Use with 1000 reps</span><br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">x &lt;- <span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">-10</span>:<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">10</span><br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">y &lt;- x^<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">2</span> + rnorm(<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">21</span>,<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">0</span>,<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">10</span>)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">permutationTest(x,y,<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">1000</span>) <span class="hljs-comment" style="box-sizing: border-box;font-size: inherit;color: rgb(128, 128, 128);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"># --&gt; 0.036</span></code></pre><p style="margin-bottom: 20px;white-space: normal;text-align: center;line-height: 1.75em;"><span style="font-size: 16px;"><strong><br></strong></span></p><p style="margin-bottom: 20px;white-space: normal;text-align: center;line-height: 1.75em;"><span style="font-size: 16px;"><strong>最大信息系数</strong></span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">最大信息系数（MIC）于 2011 年提出，它是用于检测变量之间非线性相关性的最新方法。用于进行 MIC 计算的算法将信息论和概率的概念应用于连续型数据。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><strong><span style="font-size: 14px;">深入细节</span></strong></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">由克劳德·香农于 20 世纪中叶开创的信息论是数学中一个引人注目的领域。</span></p><p style="white-space: normal;line-height: 1.75em;"><span style="font-size: 14px;">信息论中的一个关键概念是熵——这是一个衡量给定概率分布的不确定性的度量。概率分布描述了与特定事件相关的一系列给定结果的概率。</span></p><p style="white-space: normal;"><img class="" data-copyright="0" data-ratio="0.2075" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWicxEuZ91UfMutRlK2nY2vW5BtI1W0hWZQ3vkia397ggZBnZiabjbgkIs7kAoeltAykFHqzicROECbtNQ/640?wx_fmt=png" data-type="png" data-w="1200" style="height: 83px;width: 402px;"></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 12px;"><em><span style="color: rgb(136, 136, 136);">概率分布的熵是「每个可能结果的概率乘以其对数后的和」的负值</span></em></span></p><p style="white-space: normal;"><span style="font-size: 14px;">为了理解其工作原理，让我们比较下面两个概率分布：</span></p><p style="white-space: normal;"><img class="" data-copyright="0" data-ratio="0.3025" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWicxEuZ91UfMutRlK2nY2vW5yiaVy7tpeERFFmkBKN5sQN3hfcMicT9o5HKHzF13jqfib2s6KcIgZK4Vg/640?wx_fmt=png" data-type="png" data-w="1200"></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 12px;color: rgb(136, 136, 136);"><em>X 轴标明了可能的结果；Y 轴标明了它们各自的概率</em></span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">左侧是一个常规六面骰子结果的概率分布；而右边的六面骰子不那么均匀。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">从直觉上来说，你认为哪个的熵更高呢？哪个骰子结果的不确定性更大？让我们来计算它们的熵，看看答案是什么。</span></p><pre style="margin-top: 0px;margin-bottom: 0px;padding: 0px;background-color: rgb(255, 255, 255);font-size: 16px;box-sizing: border-box;color: rgb(62, 62, 62);line-height: inherit;"><code class="python language-python hljs" style="margin-right: 2px;margin-left: 2px;padding: 0.5em;box-sizing: border-box;font-size: 14px;color: rgb(169, 183, 198);line-height: 18px;border-radius: 0px;background-color: rgb(40, 43, 46);font-family: Consolas, Inconsolata, Courier, monospace;display: block;overflow-x: auto;letter-spacing: 0px;word-wrap: normal !important;word-break: normal !important;overflow-y: auto !important;">entropy &lt;- function(x){<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  pr &lt;- prop.table(table(x))<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  H &lt;- sum(pr * log(pr,<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">2</span>))<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">return</span>(-H)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">}<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">dice1 &lt;- <span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">1</span>:<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">6</span><br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">dice2 &lt;- c(<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">1</span>,<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">1</span>,<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">1</span>,<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">1</span>,<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">2</span>:<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">6</span>)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">entropy(dice1) <span class="hljs-comment" style="box-sizing: border-box;font-size: inherit;color: rgb(128, 128, 128);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"># --&gt; 2.585</span><br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">entropy(dice2) <span class="hljs-comment" style="box-sizing: border-box;font-size: inherit;color: rgb(128, 128, 128);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"># --&gt; 2.281</span></code></pre><p style="margin-top: 10px;margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">不出所料，常规骰子的熵更高。这是因为每种结果的可能性都一样，所以我们不会提前知道结果偏向哪个。但是，非常规的骰子有所不同——某些结果的发生概率远大于其它结果——所以它的结果的不确定性也低一些。</span><br></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">这么一来，我们就能明白，当每种结果的发生概率相同时，它的熵最高。而这种概率分布也就是传说中的「均匀」分布。</span></p><p style="white-space: normal;line-height: 1.75em;"><span style="font-size: 14px;">交叉熵是熵的一个拓展概念，它引入了第二个变量的概率分布。</span></p><p style="white-space: normal;"><br></p><p style="white-space: normal;"><img class="" data-copyright="0" data-ratio="0.22" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWicxEuZ91UfMutRlK2nY2vW55M44pyV2GytyeVzGNIQ4SBc1dAvmxAIdyAYtuoL44zDsgdCBNwUxZw/640?wx_fmt=png" data-type="png" data-w="1200" style="height: 74px;width: 336px;"></p><pre style="margin-top: 0px;margin-bottom: 0px;padding: 0px;background-color: rgb(255, 255, 255);font-size: 16px;box-sizing: border-box;color: rgb(62, 62, 62);line-height: inherit;"><code class="python language-python hljs" style="margin-right: 2px;margin-left: 2px;padding: 0.5em;box-sizing: border-box;font-size: 14px;color: rgb(169, 183, 198);line-height: 18px;border-radius: 0px;background-color: rgb(40, 43, 46);font-family: Consolas, Inconsolata, Courier, monospace;display: block;overflow-x: auto;letter-spacing: 0px;word-wrap: normal !important;word-break: normal !important;overflow-y: auto !important;">crossEntropy &lt;- function(x,y){<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  prX &lt;- prop.table(table(x))<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  prY &lt;- prop.table(table(y))<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  H &lt;- sum(prX * log(prY,<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">2</span>))<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">return</span>(-H)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">}<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"></code></pre><p style="margin-top: 10px;margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">两个相同概率分布之间的交叉熵等于其各自单独的熵。但是对于两个不同的概率分布，它们的交叉熵可能跟各自单独的熵有所不同。</span><br></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">这种差异，或者叫「散度」可以通过 KL 散度（Kullback-Leibler divergence）量化得出。</span></p><p style="white-space: normal;"><span style="font-size: 14px;">两概率分布 X 与 Y 的 KL 散度如下：</span></p><p style="white-space: normal;"><br></p><p style="white-space: normal;"><img class="" data-copyright="0" data-ratio="0.165" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWicxEuZ91UfMutRlK2nY2vW5xxKl16l6OGrW8VrGkVZQmqa2LZBudRVr0I7hhDVXhQzuBbxCNMCHrg/640?wx_fmt=png" data-type="png" data-w="1200" style="height: 67px;width: 408px;"></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 12px;"><em><span style="color: rgb(136, 136, 136);">概率分布 X 与 Y 的 KL 散度等于它们的交叉熵减去 X 的熵</span></em></span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">KL 散度的最小值为 0，仅当两个分布相同。</span></p><pre style="margin-top: 0px;margin-bottom: 0px;padding: 0px;background-color: rgb(255, 255, 255);font-size: 16px;box-sizing: border-box;color: rgb(62, 62, 62);line-height: inherit;"><code class="python language-python hljs" style="margin-right: 2px;margin-left: 2px;padding: 0.5em;box-sizing: border-box;font-size: 14px;color: rgb(169, 183, 198);line-height: 18px;border-radius: 0px;background-color: rgb(40, 43, 46);font-family: Consolas, Inconsolata, Courier, monospace;display: block;overflow-x: auto;letter-spacing: 0px;word-wrap: normal !important;word-break: normal !important;overflow-y: auto !important;">KL_divergence &lt;- function(x,y){<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  kl &lt;- crossEntropy(x,y) - entropy(x)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">return</span>(kl)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">}</code></pre><p style="margin-top: 10px;margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">为了发现变量具有相关性，KL 散度的用途之一是计算两个变量的互信息（MI）。</span><br></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">互信息可以定义为「两个随机变量的联合分布和边缘分布之间的 KL 散度」。如果二者相同，MI 值取 0。如若不同，MI 值就为一个正数。二者之间的差异越大，MI 值就越大。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">为了加深理解，我们首先简单回顾一些概率论的知识。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">变量 X 和 Y 的联合概率就是二者同时发生的概率。例如，如果你抛掷两枚硬币 X 和 Y，它们的联合分布将反映抛掷结果的概率。假设你抛掷硬币 100 次，得到「正面、正面」的结果 40 次。联合分布将反映如下：</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">P(X=H, Y=H) = 40/100 = 0.4</span></p><pre style="margin-top: 0px;margin-bottom: 0px;padding: 0px;background-color: rgb(255, 255, 255);font-size: 16px;box-sizing: border-box;color: rgb(62, 62, 62);line-height: inherit;"><code class="python language-python hljs" style="margin-right: 2px;margin-left: 2px;padding: 0.5em;box-sizing: border-box;font-size: 14px;color: rgb(169, 183, 198);line-height: 18px;border-radius: 0px;background-color: rgb(40, 43, 46);font-family: Consolas, Inconsolata, Courier, monospace;display: block;overflow-x: auto;letter-spacing: 0px;word-wrap: normal !important;word-break: normal !important;overflow-y: auto !important;">jointDist &lt;- function(x,y){<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  N &lt;- length(x)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  u &lt;- unique(append(x,y))<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  joint &lt;- c()<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">for</span>(i <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">in</span> u){<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">    <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">for</span>(j <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">in</span> u){<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">      f &lt;- x[paste0(x,y) == paste0(i,j)]<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">      joint &lt;- append(joint, length(f)/N)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">    }<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  }<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">return</span>(joint)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">}</code></pre><p style="margin-top: 10px;margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">边缘分布是指不考虑其它变量而只关注某一特定变量的概率分布。假设两变量独立，二者边缘概率的乘积即为二者同时发生的概率。仍以抛硬币为例，假如抛掷结果是 50 次正面和 50 次反面，它们的边缘分布如下：</span><br></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"></span></p><p style="white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">P(X=H) = 50/100 = 0.5 ; P(Y=H) = 50/100 = 0.5</span></p><p style="white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">P(X=H) × P(Y=H) = 0.5 × 0.5 = 0.25</span></p><p style="white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"><br></span></p><pre style="margin-top: 0px;margin-bottom: 0px;padding: 0px;background-color: rgb(255, 255, 255);font-size: 16px;box-sizing: border-box;color: rgb(62, 62, 62);line-height: inherit;"><code class="python language-python hljs" style="margin-right: 2px;margin-left: 2px;padding: 0.5em;box-sizing: border-box;font-size: 14px;color: rgb(169, 183, 198);line-height: 18px;border-radius: 0px;background-color: rgb(40, 43, 46);font-family: Consolas, Inconsolata, Courier, monospace;display: block;overflow-x: auto;letter-spacing: 0px;word-wrap: normal !important;word-break: normal !important;overflow-y: auto !important;">marginalProduct &lt;- function(x,y){<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  N &lt;- length(x)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  u &lt;- unique(append(x,y))<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  marginal &lt;- c()<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">for</span>(i <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">in</span> u){<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">    <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">for</span>(j <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">in</span> u){<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">      fX &lt;- length(x[x == i]) / N<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">      fY &lt;- length(y[y == j]) / N<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">      marginal &lt;- append(marginal, fX * fY)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">    }<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  }<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">return</span>(marginal)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">}<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"></code></pre><p style="white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"><br></span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">现在让我们回到抛硬币的例子。如果两枚硬币相互独立，边缘分布的乘积表示每个结果可能发生的概率，而联合分布则为实际得到的结果的概率。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">如果两硬币完全独立，它们的联合概率在数值上（约）等于边缘分布的乘积。若只是部分独立，此处就存在散度。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">这个例子中，P(X=H,Y=H) &gt; P(X=H) × P(Y=H)。这表明两硬币全为正面的概率要大于它们的边缘分布之积。</span></p><p style="white-space: normal;line-height: 1.75em;"><span style="font-size: 14px;">联合分布和边缘分布乘积之间的散度越大，两个变量之间相关的可能性就越大。两个变量的互信息定义了散度的度量方式。</span></p><p style="white-space: normal;"><br></p><p style="white-space: normal;"><img class="" data-copyright="0" data-ratio="0.14916666666666667" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWicxEuZ91UfMutRlK2nY2vW5kMjtLN3BYoNmgR9RwlqMpUQrzQn5D39jJlPzh26ueRSCxMBt2h3e8g/640?wx_fmt=png" data-type="png" data-w="1200"></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 12px;"><em><span style="color: rgb(136, 136, 136);">X 和 Y 的互信息等于「二者边缘分布积和的联合分布的 KL 散度」</span></em></span></p><pre style="margin-top: 0px;margin-bottom: 0px;padding: 0px;background-color: rgb(255, 255, 255);font-size: 16px;box-sizing: border-box;color: rgb(62, 62, 62);line-height: inherit;"><code class="python language-python hljs" style="margin-right: 2px;margin-left: 2px;padding: 0.5em;box-sizing: border-box;font-size: 14px;color: rgb(169, 183, 198);line-height: 18px;border-radius: 0px;background-color: rgb(40, 43, 46);font-family: Consolas, Inconsolata, Courier, monospace;display: block;overflow-x: auto;letter-spacing: 0px;word-wrap: normal !important;word-break: normal !important;overflow-y: auto !important;">mutualInfo &lt;- function(x,y){<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  joint &lt;- jointDist(x,y)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  marginal &lt;- marginalProduct(x,y)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  Hjm &lt;- - sum(joint[marginal &gt; <span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">0</span>] * log(marginal[marginal &gt; <span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">0</span>],<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">2</span>))<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  Hj &lt;- - sum(joint[joint &gt; <span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">0</span>] * log(joint[joint &gt; <span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">0</span>],<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">2</span>))<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">return</span>(Hjm - Hj)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">}</code></pre><p style="margin-top: 10px;margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">此处的一个重要假设就是概率分布是离散的。那么我们如何把这些概念应用到连续的概率分布呢？</span><br></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><strong><span style="font-size: 14px;">分箱算法</span></strong></p><p style="white-space: normal;line-height: 1.75em;"><span style="font-size: 14px;">其中一种方法是量化数据（使变量离散化）。这是通过分箱算法（bining）实现的，它能将连续的数据点分配对应的离散类别。</span></p><p style="white-space: normal;"><br></p><p style="white-space: normal;"><img class="" data-copyright="0" data-ratio="0.3908333333333333" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWicxEuZ91UfMutRlK2nY2vW5NVjfMPqBQnKDzUGogLh2Y0NRVLZAkgzBcXibC9ibfs8Zpd7SibyC9YtqA/640?wx_fmt=png" data-type="png" data-w="1200"></p><p style="margin-top: 10px;margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">此方法的关键问题是到底要使用多少「箱子（bin）」。幸运的是，首次提出 MIC 的论文给出了建议：穷举！</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">也就是说，去尝试不同的「箱子」个数并观测哪个会在变量间取到最大的互信息值。不过，这提出了两个挑战：</span></p><ol class=" list-paddingleft-2" style=""><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">要试多少个箱子呢？理论上你可以将变量量化到任意间距值，可以使箱子尺寸越来越小。</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">互信息对所用的箱子数很敏感。你如何公平比较不同箱子数目之间的 MI 值？</span></p></li></ol><p style="white-space: normal;text-align: justify;line-height: 1.75em;"><br></p><p style="white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">第一个挑战从理论上讲是不能做到的。但是，论文作者提供了一个启发式解法（也就是说，解法不完美，但是十分接近完美解法）。他们也给出了可试箱子个数的上限。</span></p><p style="white-space: normal;"><img class="" data-copyright="0" data-ratio="0.18199233716475097" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWicxEuZ91UfMutRlK2nY2vW52PON1Ir7oq4Xiania1QQFogLC4vxHctnLZczZ3Ajzl3EAfsdKYpASPDw/640?wx_fmt=png" data-type="png" data-w="1044" style="height: 75px;width: 410px;"></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 12px;"><em><span style="color: rgb(136, 136, 136);">最大可用箱子个数由样本数 N 决定</span></em></span></p><p style="white-space: normal;line-height: 1.75em;"><span style="font-size: 14px;">至于如何公平比较取不同箱子数对 MI 值的影响，有一个简单的做法……就是归一化！这可以通过将每个 MI 值除以在特定箱子数组合上取得的理论最大值来完成。我们要采用的是产生最大归一化 MI 总值的箱子数组合。</span></p><p style="white-space: normal;"><br></p><p style="white-space: normal;"><img class="" data-copyright="0" data-ratio="0.19" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWicxEuZ91UfMutRlK2nY2vW5SZziazSzMK8L0cvLhJT8ZzJgZIByvf1TnvynvXdyzzmlhtr2rLISpXg/640?wx_fmt=png" data-type="png" data-w="1200" style="height: 72px;width: 378px;"></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 12px;"><em><span style="color: rgb(136, 136, 136);">互信息可以通过除以最小的箱子数的对数来归一化</span></em></span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">最大的归一化互信息就是 X 和 Y 的最大信息系数（MIC）。我们来看看一些估算两个连续变量的 MIC 的代码。</span></p><pre style="margin-top: 0px;margin-bottom: 0px;padding: 0px;background-color: rgb(255, 255, 255);font-size: 16px;box-sizing: border-box;color: rgb(62, 62, 62);line-height: inherit;"><code class="python language-python hljs" style="margin-right: 2px;margin-left: 2px;padding: 0.5em;box-sizing: border-box;font-size: 14px;color: rgb(169, 183, 198);line-height: 18px;border-radius: 0px;background-color: rgb(40, 43, 46);font-family: Consolas, Inconsolata, Courier, monospace;display: block;overflow-x: auto;letter-spacing: 0px;word-wrap: normal !important;word-break: normal !important;overflow-y: auto !important;">MIC &lt;- function(x,y){<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  N &lt;- length(x)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  maxBins &lt;- ceiling(N ** <span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">0.6</span>)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  MI &lt;- c()<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">for</span>(i <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">in</span> <span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">2</span>:maxBins) {<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">    <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">for</span> (j <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">in</span> <span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">2</span>:maxBins){<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">      <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">if</span>(i * j &gt; maxBins){<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">        next<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">      }<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">      Xbins &lt;- i; Ybins &lt;- j<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">      binnedX &lt;-cut(x, breaks=Xbins, labels = <span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">1</span>:Xbins)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">      binnedY &lt;-cut(y, breaks=Ybins, labels = <span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">1</span>:Ybins)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">      MI_estimate &lt;- mutualInfo(binnedX,binnedY) <br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">      MI_normalized &lt;- MI_estimate / log(min(Xbins,Ybins),<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">2</span>)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">      MI &lt;- append(MI, MI_normalized)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  }<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">}<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">return</span>(max(MI))<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">}<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">x &lt;- runif(<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">100</span>,<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">-10</span>,<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">10</span>)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">y &lt;- x**<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">2</span> + rnorm(<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">100</span>,<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">0</span>,<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">10</span>)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">MIC(x,y) <span class="hljs-comment" style="box-sizing: border-box;font-size: inherit;color: rgb(128, 128, 128);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"># --&gt; 0.751</span><br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"></code><p><span class="hljs-comment" style="box-sizing: border-box;font-size: inherit;color: rgb(128, 128, 128);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"><br></span></p></pre><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">以上代码是对原论文中方法的简化。更接近原作的算法实现可以参考 R package minerva（https://cran.r-project.org/web/packages/minerva/index.html）。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">在 Python 中的实现请参考 minepy module（https://minepy.readthedocs.io/en/latest/）。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">MIC 能够表示各种线性和非线性的关系，并已得到广泛应用。它的值域在 0 和 1 之间，值越高表示相关性越强。</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><strong><span style="font-size: 14px;">置信区间？</span></strong></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">为了建立 MIC 估计值的置信区间，你可以简单地使用一个像我们之前介绍过的 bootstrap 函数。我们可以利用 R 语言的函数式编程，通过传递我们想要用作参数的函数来泛化 bootstrap 函数。</span></p><pre style="margin-top: 0px;margin-bottom: 0px;padding: 0px;background-color: rgb(255, 255, 255);font-size: 16px;box-sizing: border-box;color: rgb(62, 62, 62);line-height: inherit;"><code class="python language-python hljs" style="margin-right: 2px;margin-left: 2px;padding: 0.5em;box-sizing: border-box;font-size: 14px;color: rgb(169, 183, 198);line-height: 18px;border-radius: 0px;background-color: rgb(40, 43, 46);font-family: Consolas, Inconsolata, Courier, monospace;display: block;overflow-x: auto;letter-spacing: 0px;word-wrap: normal !important;word-break: normal !important;overflow-y: auto !important;">bootstrap &lt;- function(x,y,func,reps,alpha){<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  estimates &lt;- c()<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  original &lt;- data.frame(x,y)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  N &lt;- dim(original)[<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">1</span>]<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">for</span>(i <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">in</span> <span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">1</span>:reps){<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">    S &lt;- original[sample(<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">1</span>:N, N, replace = TRUE),]<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">    estimates &lt;- append(estimates, func(S$x, S$y))<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  }<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  l &lt;- alpha/<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">2</span> ; u &lt;- <span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">1</span> - l<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  interval &lt;- quantile(estimates, c(u, l))<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">  <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">return</span>(<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">2</span>*(func(x,y)) - <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">as</span>.numeric(interval[<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">1</span>:<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">2</span>]))<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">}<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">bootstrap(x,y,MIC,<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">100</span>,<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">0.05</span>) <span class="hljs-comment" style="box-sizing: border-box;font-size: inherit;color: rgb(128, 128, 128);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"># --&gt; 0.594 to 0.88</span></code></pre><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><br></p><p style="margin-bottom: 20px;white-space: normal;text-align: center;line-height: 1.75em;"><span style="font-size: 16px;"><strong>总结</strong></span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">为了总结相关性这一主题，我们来测试下各算法在人工生成数据上的处理能力。</span></p><p style="margin-bottom: 20px;white-space: normal;line-height: 1.75em;"><span style="font-size: 14px;color: rgb(123, 12, 0);">完整代码：https://gist.github.com/anonymous/fabecccf33f9c3feb568384f626a2c07</span></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><strong><span style="font-size: 14px;">噪声函数</span></strong></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><strong><span style="font-size: 14px;"></span></strong></p><p style="white-space: normal;"><img class="" data-copyright="0" data-ratio="0.4066666666666667" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWicxEuZ91UfMutRlK2nY2vW5Mq47HYFymnk7IwTAvibpxnlBK0qiabWTJBs2v8UCyGUdrlenicfuLQq7g/640?wx_fmt=png" data-type="png" data-w="1200"></p><p style="white-space: normal;"><br></p><pre style="margin-top: 0px;margin-bottom: 0px;padding: 0px;background-color: rgb(255, 255, 255);font-size: 16px;box-sizing: border-box;color: rgb(62, 62, 62);line-height: inherit;"><code class="python language-python hljs" style="margin-right: 2px;margin-left: 2px;padding: 0.5em;box-sizing: border-box;font-size: 14px;color: rgb(169, 183, 198);line-height: 18px;border-radius: 0px;background-color: rgb(40, 43, 46);font-family: Consolas, Inconsolata, Courier, monospace;display: block;overflow-x: auto;letter-spacing: 0px;word-wrap: normal !important;word-break: normal !important;overflow-y: auto !important;">set.seed(<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">123</span>)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"><span class="hljs-comment" style="box-sizing: border-box;font-size: inherit;color: rgb(128, 128, 128);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"># Noise</span><br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">x0 &lt;- rnorm(<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">100</span>,<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">0</span>,<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">1</span>)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">y0 &lt;- rnorm(<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">100</span>,<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">0</span>,<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">1</span>)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">plot(y0~x0, pch = <span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">18</span>)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">cor(x0,y0)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">distanceCorrelation(x0,y0)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">MIC(x0,y0)</code></pre><ul class=" list-paddingleft-2" style=""><li><p style="margin-top: 5px;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">Pearson's r = - 0.05</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">距离相关性 = 0.157</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">MIC = 0.097</span></p></li></ul><p style="white-space: normal;"><br></p><p style="white-space: normal;text-align: justify;line-height: 1.75em;"><strong><span style="font-size: 14px;">简单线性函数</span></strong><br></p><p style="margin-bottom: 20px;white-space: normal;text-align: justify;line-height: 1.75em;"><strong><span style="font-size: 14px;"></span></strong></p><p style="white-space: normal;"><img class="" data-copyright="0" data-ratio="0.4083333333333333" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWicxEuZ91UfMutRlK2nY2vW5CP5714Q35kh5MdaoGmYPRErk0vjVVvfC9vgKn2ZWiaC1yhagHeqXlHw/640?wx_fmt=png" data-type="png" data-w="1200"></p><pre style="margin-top: 0px;margin-bottom: 0px;padding: 0px;background-color: rgb(255, 255, 255);font-size: 16px;box-sizing: border-box;color: rgb(62, 62, 62);line-height: inherit;"><code class="python language-python hljs" style="margin-right: 2px;margin-left: 2px;padding: 0.5em;box-sizing: border-box;font-size: 14px;color: rgb(169, 183, 198);line-height: 18px;border-radius: 0px;background-color: rgb(40, 43, 46);font-family: Consolas, Inconsolata, Courier, monospace;display: block;overflow-x: auto;letter-spacing: 0px;word-wrap: normal !important;word-break: normal !important;overflow-y: auto !important;"><span class="hljs-comment" style="box-sizing: border-box;font-size: inherit;color: rgb(128, 128, 128);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"># Simple linear relationship</span><br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">x1 &lt;- <span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">-20</span>:<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">20</span><br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">y1 &lt;- x1 + rnorm(<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">41</span>,<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">0</span>,<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">4</span>)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">plot(y1~x1, pch =<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">18</span>)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">cor(x1,y1)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">distanceCorrelation(x1,y1)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">MIC(x1,y1)</code></pre><ul class=" list-paddingleft-2" style=""><li><p style="margin-top: 5px;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">Pearson's r =+0.95</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">距离相关性 = 0.95</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">MIC = 0.89</span></p></li></ul><p style="white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"><br></span></p><p style="white-space: normal;text-align: justify;line-height: 1.75em;"><strong><span style="font-size: 14px;">简单二次函数</span></strong></p><p style="white-space: normal;text-align: justify;line-height: 1.75em;"><strong><span style="font-size: 14px;"></span></strong></p><p style="white-space: normal;"><img class="" data-copyright="0" data-ratio="0.4033333333333333" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWicxEuZ91UfMutRlK2nY2vW5cLwDsn93wiaXYS39sENVZ5picfKEokgxF0I9xLzwFdXzshjq5PibaDMng/640?wx_fmt=png" data-type="png" data-w="1200"></p><pre style="margin-top: 0px;margin-bottom: 0px;padding: 0px;background-color: rgb(255, 255, 255);font-size: 16px;box-sizing: border-box;color: rgb(62, 62, 62);line-height: inherit;"><code class="python language-python hljs" style="margin-right: 2px;margin-left: 2px;padding: 0.5em;box-sizing: border-box;font-size: 14px;color: rgb(169, 183, 198);line-height: 18px;border-radius: 0px;background-color: rgb(40, 43, 46);font-family: Consolas, Inconsolata, Courier, monospace;display: block;overflow-x: auto;letter-spacing: 0px;word-wrap: normal !important;word-break: normal !important;overflow-y: auto !important;"><span class="hljs-comment" style="box-sizing: border-box;font-size: inherit;color: rgb(128, 128, 128);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"># y ~ x**2</span><br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">x2 &lt;- <span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">-20</span>:<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">20</span><br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">y2 &lt;- x2**<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">2</span> + rnorm(<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">41</span>,<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">0</span>,<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">40</span>)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">plot(y2~x2, pch = <span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">18</span>)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">cor(x2,y2)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">distanceCorrelation(x2,y2)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">MIC(x2,y2)</code></pre><p style="white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"><br></span></p><ul class=" list-paddingleft-2" style=""><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">Pearson's r =+0.003</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">距离相关性 = 0.474</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">MIC = 0.594</span></p></li></ul><p style="white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"><br></span></p><p style="white-space: normal;text-align: justify;line-height: 1.75em;"><strong><span style="font-size: 14px;">三次函数</span></strong></p><p style="white-space: normal;text-align: justify;line-height: 1.75em;"><strong><span style="font-size: 14px;"></span></strong></p><p style="white-space: normal;"><img class="" data-copyright="0" data-ratio="0.42333333333333334" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWicxEuZ91UfMutRlK2nY2vW5qYG7gO7Eaw86F5gib6PaWSWUcEXZibFqtOSwkN3cQ3Fl87EwiahCLYm0g/640?wx_fmt=png" data-type="png" data-w="1200"></p><pre style="margin-top: 0px;margin-bottom: 0px;padding: 0px;background-color: rgb(255, 255, 255);font-size: 16px;box-sizing: border-box;color: rgb(62, 62, 62);line-height: inherit;"><code class="python language-python hljs" style="margin-right: 2px;margin-left: 2px;padding: 0.5em;box-sizing: border-box;font-size: 14px;color: rgb(169, 183, 198);line-height: 18px;border-radius: 0px;background-color: rgb(40, 43, 46);font-family: Consolas, Inconsolata, Courier, monospace;display: block;overflow-x: auto;letter-spacing: 0px;word-wrap: normal !important;word-break: normal !important;overflow-y: auto !important;"><span class="hljs-comment" style="box-sizing: border-box;font-size: inherit;color: rgb(128, 128, 128);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"># Cosine</span><br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">x3 &lt;- <span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">-20</span>:<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">20</span><br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">y3 &lt;- cos(x3/<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">4</span>) + rnorm(<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">41</span>,<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">0</span>,<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">0.2</span>)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">plot(y3~x3, type=<span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">'p'</span>, pch=<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">18</span>)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">cor(x3,y3)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">distanceCorrelation(x3,y3)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">MIC(x3,y3)</code></pre><p style="white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"><br></span></p><ul class=" list-paddingleft-2" style=""><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">Pearson's r =- 0.035</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">距离相关性 = 0.382</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">MIC = 0.484</span></p></li></ul><p style="white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"><br></span></p><p style="white-space: normal;text-align: justify;line-height: 1.75em;"><strong><span style="font-size: 14px;">圆函数</span></strong></p><p style="white-space: normal;text-align: justify;line-height: 1.75em;"><strong><span style="font-size: 14px;"></span></strong></p><p style="white-space: normal;"><img class="" data-copyright="0" data-ratio="0.5505050505050505" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWicxEuZ91UfMutRlK2nY2vW5ah4TfTiav0yVVP1LCicUjiarVic6pvzpWrRpXPicPoyu0sCHJcFr2r7QHUg/640?wx_fmt=png" data-type="png" data-w="1188"></p><pre style="margin-top: 0px;margin-bottom: 0px;padding: 0px;background-color: rgb(255, 255, 255);font-size: 16px;box-sizing: border-box;color: rgb(62, 62, 62);line-height: inherit;"><code class="python language-python hljs" style="margin-right: 2px;margin-left: 2px;padding: 0.5em;box-sizing: border-box;font-size: 14px;color: rgb(169, 183, 198);line-height: 18px;border-radius: 0px;background-color: rgb(40, 43, 46);font-family: Consolas, Inconsolata, Courier, monospace;display: block;overflow-x: auto;letter-spacing: 0px;word-wrap: normal !important;word-break: normal !important;overflow-y: auto !important;"><span class="hljs-comment" style="box-sizing: border-box;font-size: inherit;color: rgb(128, 128, 128);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"># Circle</span><br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">n &lt;- <span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">50</span><br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">theta &lt;- runif (n, <span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">0</span>, <span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">2</span>*pi) <br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">x4 &lt;- append(cos(theta), cos(theta))<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">y4 &lt;- append(sin(theta), -sin(theta))<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">plot(x4,y4, pch=<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">18</span>)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">cor(x4,y4)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">distanceCorrelation(x4,y4)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">MIC(x4,y4)</code></pre><p style="white-space: normal;text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"><br></span></p><ul class=" list-paddingleft-2" style=""><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">Pearson's r &lt; 0.001</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">距离相关性 = 0.234</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">MIC = 0.218</span></p></li></ul><p style="white-space: normal;"><br></p><p style="white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><em style="color: rgb(136, 136, 136);font-size: 12px;text-align: justify;">原文链接：https://medium.freecodecamp.org/how-machines-make-predictions-finding-correlations-in-complex-data-dfd9f0d87889</em></p><p style="white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><em style="color: rgb(136, 136, 136);font-size: 12px;text-align: justify;"><br></em></p><p style="white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><br></p><p style="margin-bottom: 20px;white-space: normal;max-width: 100%;min-height: 1em;line-height: 1.75em;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;text-align: justify;line-height: 25.6px;font-family: 微软雅黑;font-size: 14px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(127, 127, 127);box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;color: rgb(62, 62, 62);line-height: 25.6px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(127, 127, 127);box-sizing: border-box !important;word-wrap: break-word !important;">本文为机器之心编译，<strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;">转载请联系本公众号获得授权</span></strong></span></strong>。</span></strong></p><p style="margin-bottom: 5px;white-space: normal;max-width: 100%;min-height: 1em;background-color: rgb(255, 255, 255);font-size: 18px;line-height: 1.75em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(127, 127, 127);line-height: 25.6px;font-family: 微软雅黑;text-align: justify;box-sizing: border-box !important;word-wrap: break-word !important;">✄------------------------------------------------</span></p><p style="margin-bottom: 5px;white-space: normal;max-width: 100%;min-height: 1em;background-color: rgb(255, 255, 255);font-size: 18px;font-family: 微软雅黑;text-align: center;line-height: 1.75em;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(217, 33, 66);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">加入机器之心（全职记者/实习生）：hr@jiqizhixin.com</span></strong></p><p style="white-space: normal;max-width: 100%;min-height: 1em;background-color: rgb(255, 255, 255);font-size: 18px;font-family: 微软雅黑;text-align: center;line-height: 1.75em;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(217, 33, 66);line-height: 1.6;font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">投稿或寻求报道：editor@jiqizhixin.com</span></strong></p><p style="white-space: normal;max-width: 100%;min-height: 1em;background-color: rgb(255, 255, 255);font-size: 18px;font-family: 微软雅黑;text-align: center;line-height: 1.75em;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 12px;color: rgb(217, 33, 66);line-height: 1.6;box-sizing: border-box !important;word-wrap: break-word !important;">广告&amp;商务合作：bd@jiqizhixin.com</span></strong></p>
                </div>
                <script nonce="433854672" type="text/javascript">
                    var first_sceen__time = (+new Date());

                    if ("" == 1 && document.getElementById('js_content')) {
                        document.getElementById('js_content').addEventListener("selectstart",function(e){ e.preventDefault(); });
                    }

                    
                    (function(){
                        if (navigator.userAgent.indexOf("WindowsWechat") != -1){
                            var link = document.createElement('link');
                            var head = document.getElementsByTagName('head')[0];
                            link.rel = 'stylesheet';
                            link.type = 'text/css';
                            link.href = "//res.wx.qq.com/mmbizwap/zh_CN/htmledition/style/page/appmsg/page_mp_article_improve_winwx31619e.css";
                            head.appendChild(link);
                        }
                    })();
                </script>
                
                
                                
                <div class="ct_mpda_wrp" id="js_sponsor_ad_area" style="display:none;"></div>

                
                                <div class="reward_area tc" id="js_preview_reward" style="display:none;">
                    <p id="js_preview_reward_wording" class="tips_global reward_tips" style="display:none;"></p>
                    <p>
                        <a class="reward_access" id="js_preview_reward_link" href="##"><span class="icon-reward"></span>赞赏</a>

                    </p>
                </div>
                <div class="reward_qrcode_area reward_area tc" id="js_preview_reward_qrcode" style="display:none;">
                    <p class="tips_global">长按二维码向我转账</p>
                    <p id="js_preview_reward_ios_wording" class="reward_tips" style="display:none;"></p>
                    <span class="reward_qrcode_img_wrp"><img class="reward_qrcode_img" src="//res.wx.qq.com/mmbizwap/zh_CN/htmledition/images/pic/appmsg/pic_reward_qrcode.2x3534dd.png"></span>
                    <p class="tips_global">受苹果公司新规定影响，微信 iOS 版的赞赏功能被关闭，可通过二维码转账支持公众号。</p>
                </div>
                            </div><div class="rich_media_tool" id="js_toobar3">
                
                                
                                            <div id="js_read_area3" class="media_tool_meta tips_global meta_primary" style="display:none;">阅读 <span id="readNum3"></span></div>

                <span style="display:none;" class="media_tool_meta meta_primary tips_global meta_praise" id="like3">
                    <i class="icon_praise_gray"></i><span class="praise_num" id="likeNum3"></span>
                </span>

                <a id="js_report_article3" style="display:none;" class="media_tool_meta tips_global meta_extra" href="##">投诉</a>

            </div><div class="rich_media_tool" id="js_sg_bar">
                
                                
                                
            </div>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
