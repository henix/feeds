<div class="title-image"><img src="https://pic4.zhimg.com/v2-7f13f2e74fd71937298e3b54584c0601_b.jpg" alt=""></div><p><b>编者按：</b>吴军在《<b>数学之美</b>》一书中提到很多数学方法（算法）在信息技术行业的应用之美，里面的数据分析工具现在越来越多运用到投资上（书中就提到了很多算法（改进）设计者到对冲基金的事例，大家有兴趣可以去参阅）。国内这两年量化投资中表现优异的股票高频Alpha以及T+0策略，就有很多投顾提到用了文本挖掘信息。今天分享的一篇基于新闻文本数据构建市场情绪预测个股收益率的文章，希望大家从中有所裨益。</p><p class="ztext-empty-paragraph"><br/></p><p>金融科技时代下大数据在投资中的应用逐渐成为潮流。公司财务指标、股票量价关系等传统数据固然是主流方向，但从社交媒体新闻到卫星监测图像的另类数据正在异军突起，并在股票和大宗商品投资中得到了广泛的使用。Alternative Data网站上数据表明截至2017年全球已有约800支基金利用另类数据做投资决策，2017年投资机构对另类数据的投入规模约为4亿美金。财经新闻数据作为一类重要的非结构化另类数据，将其转化得到的分析指标和投资信号，能够有效提升投资机构的产品业绩。</p><p class="ztext-empty-paragraph"><br/></p><h2><b>1、如何对文本数据建模</b></h2><p>传统的数学模型无法直接处理文本数据。为了使用文本数据，首先需要将文本数据转化成数值型数据，这个过程也是挖掘文本信息中至关重要的一个环节。这一过程在自然语言处理（NLP）中被称为词嵌入向量（Word Embedding），即将单个词映射成一个数值向量，进而将一篇新闻报道也转化为向量或矩阵，这样就实现了将文本转化为数字的过程。<b>实现Word Embedding的方法主要可以分为两类：一类是基于频率的方法，一类是基于预测的方法</b>。基于频率的方法顾名思义是使用单词在文本中出现的频率来构建词向量，例如Count Vector方法就是简单地统计文本中单词出现次数来将文本转化为数值向量；TF-IDF则引入了这样的思想：某个单词在某一篇新闻中出现的频率高，而在所有新闻里出现的频率低，那么这个单词对于这篇新闻而言十分重要，其权重将提高；Co-Occurence Vector则进一步考虑了上下文语境，如果两个单词的上下文中经常出现相同的单词，那么这两个单词相似程度越高，其向量表示也更加接近。Co-Occurence Vector虽然能纳入单词的上下文语境特征但它往往使得词向量的维数过大，基于预测的Word Embedding方法则通过神经网络建模的方法解决了维数的问题，同时也很好地纳入单词的语境信息，这一类算法包括CBOW、Skip – Gram等。</p><p>基于预测的方法虽然在某些方面具有更好的效果，但是神经网络方法更像是一个“黑箱”，我们很难判断其预测能力来自于何处，从这种角度而言基于词频方法的Word Embedding模式更容易理解可靠性更高。我们今天介绍的文章《<b>Predicting Returns with Text Data</b>》就是基于财经新闻文本的词频数据，将另类文本数据转化为投资信号的最新研究。<br/></p><h2><b>2、财经文本应用于投资领域的最新研究</b></h2><p>《Predicting Returns with Text Data》提出了一种新的文本挖掘方法，这种方法可以更加高效地挖掘出新闻文本中包含的投资者情绪信息，进一步使得我们可以更好地预测个股收益率。该文的三位作者分别来自耶鲁大学且同时任职于AQR、芝加哥大学Booth商学院、哈佛大学统计学系。</p><p>文章用到了Dow Jones Newswires 1989-2017年所有的新闻文本数据，每条新闻都标注与之关联的股票。为了简便起见，文章只考虑那些只与一支股票相关的新闻，目的是从每一篇新闻文本数据中找到一个情绪指标p（p在0和1之间），<b>p值越大表明该篇文章正面情绪越强，越有可能预示对应股票未来会上涨</b>。</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-6bee38b0171ae89af4d037cd9e86a1c0_b.jpg" data-caption="" data-size="normal" data-rawwidth="554" data-rawheight="329" class="origin_image zh-lightbox-thumb" width="554" data-original="https://pic1.zhimg.com/v2-6bee38b0171ae89af4d037cd9e86a1c0_r.jpg"/></noscript><img src="https://pic1.zhimg.com/v2-6bee38b0171ae89af4d037cd9e86a1c0_b.jpg" data-caption="" data-size="normal" data-rawwidth="554" data-rawheight="329" class="origin_image zh-lightbox-thumb lazy" width="554" data-original="https://pic1.zhimg.com/v2-6bee38b0171ae89af4d037cd9e86a1c0_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-6bee38b0171ae89af4d037cd9e86a1c0_b.jpg"/></figure><h2><b>3、筛选反映情绪的词汇</b></h2><p>文章首先提出了能够筛选出反映投资者情绪、对个股收益率有预测能力的新闻词汇。例如所有新闻中有100条新闻出现了“回购”（Repurchase）字眼，而且这100篇新闻对应的股票中有80家在第二天上涨，这说明出现“回购”字眼后的股票上涨概率为80%，所以我们认为回购是一个代表正面情绪的词汇。同样如果有100条新闻中出现“萧条”字眼，而这些新闻对应的股票有75家在第二天下跌，这说明“萧条”包含负面情绪。除了上述两条筛选标准之外，作者还指出入选的词汇出现的次数都必须足够多，否则例如词“哈哈哈”一共出现了1次，但是这篇新闻报道之后对应的股票上涨了，这说明出现“哈哈哈”之后股票上涨概率为100%，但是这毫无意义。根据上述筛选标准就能得到正面和负面的情绪词表。</p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-4f5c2c0ad198032bec68d948b0a070cb_b.jpg" data-caption="" data-size="normal" data-rawwidth="554" data-rawheight="224" class="origin_image zh-lightbox-thumb" width="554" data-original="https://pic4.zhimg.com/v2-4f5c2c0ad198032bec68d948b0a070cb_r.jpg"/></noscript><img src="https://pic4.zhimg.com/v2-4f5c2c0ad198032bec68d948b0a070cb_b.jpg" data-caption="" data-size="normal" data-rawwidth="554" data-rawheight="224" class="origin_image zh-lightbox-thumb lazy" width="554" data-original="https://pic4.zhimg.com/v2-4f5c2c0ad198032bec68d948b0a070cb_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-4f5c2c0ad198032bec68d948b0a070cb_b.jpg"/></figure><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-463e4a8ddd6f2b8f2dafe848ace73488_b.jpg" data-caption="" data-size="normal" data-rawwidth="554" data-rawheight="288" class="origin_image zh-lightbox-thumb" width="554" data-original="https://pic1.zhimg.com/v2-463e4a8ddd6f2b8f2dafe848ace73488_r.jpg"/></noscript><img src="https://pic1.zhimg.com/v2-463e4a8ddd6f2b8f2dafe848ace73488_b.jpg" data-caption="" data-size="normal" data-rawwidth="554" data-rawheight="288" class="origin_image zh-lightbox-thumb lazy" width="554" data-original="https://pic1.zhimg.com/v2-463e4a8ddd6f2b8f2dafe848ace73488_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-463e4a8ddd6f2b8f2dafe848ace73488_b.jpg"/></figure><p class="ztext-empty-paragraph"><br/></p><h2><b>4、构建情绪词频向量</b></h2><p>按照上一步得到的情绪词表，文章统计了每一篇新闻中情绪词汇出现的次数，并且将其存储在一个情绪词频向量中，假设某篇新闻中“回购”字眼出现了3次，“萧条“出现了1次，该向量可以写成（3，1）。文章进一步假设情绪词频向量的分布满足多项分布，且其参数和该条新闻文包含的情绪指标p相关，即情绪指标p越高时，越容易出现积极正面的词汇，反之则容易出现负面的词汇。</p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-8d7bdcac78fa7c7444a500f55ea6629a_b.png" data-caption="" data-size="normal" data-rawwidth="322" data-rawheight="32" class="content_image" width="322"/></noscript><img src="https://pic3.zhimg.com/v2-8d7bdcac78fa7c7444a500f55ea6629a_b.png" data-caption="" data-size="normal" data-rawwidth="322" data-rawheight="32" class="content_image lazy" width="322" data-actualsrc="https://pic3.zhimg.com/v2-8d7bdcac78fa7c7444a500f55ea6629a_b.png"/></figure><h2><b>5、极大似然估计得出情绪指标</b></h2><p>在给定了情绪词频向量的分布之后我们可以求出情绪词频向量的似然函数值。所谓似然函数（Likelihood Function，是不是发现计量模型很有用）可以理解为一个概率，比如在多项（二项）分布下情绪词频向量为（1，3）的概率为C(1,4)q1(p)q2(p)^3其中q1(p)是“萧条”出现的概率，q2(p)是“回购“出现的概率，都是该段文本的情绪指标p的函数，最大似然法的逻辑是：<b>当我们观测到情绪词频向量为（1，3）时，这一结果的的概率应该尽可能的大（这样我们观察到这一结果才不会是偶然的），所以最大化概率的情绪指标p就最有可能是该段文本的真实情绪指标</b>。（具体公式如下，就是用Maximum Likelihood Estimation方法）</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-62544d8e6dd01cdc54ad12d2b20a6f2d_b.jpg" data-caption="" data-size="normal" data-rawwidth="554" data-rawheight="159" class="origin_image zh-lightbox-thumb" width="554" data-original="https://pic2.zhimg.com/v2-62544d8e6dd01cdc54ad12d2b20a6f2d_r.jpg"/></noscript><img src="https://pic2.zhimg.com/v2-62544d8e6dd01cdc54ad12d2b20a6f2d_b.jpg" data-caption="" data-size="normal" data-rawwidth="554" data-rawheight="159" class="origin_image zh-lightbox-thumb lazy" width="554" data-original="https://pic2.zhimg.com/v2-62544d8e6dd01cdc54ad12d2b20a6f2d_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-62544d8e6dd01cdc54ad12d2b20a6f2d_b.jpg"/></figure><p> 通过上述方法就能得到每篇新闻的一个情绪指标p，由于每篇新闻对应一只股票，该股票也会有对应的情绪指标p（如果在一天中某只股票没有新闻则其情绪指标设定为0.5，如果多条新闻都涉及一只股票，则该股票的情绪指标为这些新闻的情绪指标的平均值）。</p><p class="ztext-empty-paragraph"><br/></p><h2><b>6、基于文本情绪指标的交易策略</b></h2><p>接下来文章使用新闻文本的情绪指标构建交易策略，该策略每天开盘时买入情绪指标最高的50只股票，同时卖出情绪指标最低的50只股票。文章使用1989年到2017年的数据进行回测。</p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-620f3e2c34fbf997fe916aa3249b0917_b.jpg" data-caption="" data-size="normal" data-rawwidth="554" data-rawheight="317" class="origin_image zh-lightbox-thumb" width="554" data-original="https://pic4.zhimg.com/v2-620f3e2c34fbf997fe916aa3249b0917_r.jpg"/></noscript><img src="https://pic4.zhimg.com/v2-620f3e2c34fbf997fe916aa3249b0917_b.jpg" data-caption="" data-size="normal" data-rawwidth="554" data-rawheight="317" class="origin_image zh-lightbox-thumb lazy" width="554" data-original="https://pic4.zhimg.com/v2-620f3e2c34fbf997fe916aa3249b0917_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-620f3e2c34fbf997fe916aa3249b0917_b.jpg"/></figure><p>首先在不考虑交易成本的情况下，该策略收益率曲线如上图所示，可以看到当采用等权重（EW）配置资金时策略收益率效果比采用按市值大小的权重（VW）配置资金的收益率高，这说明该策略在小市值的股票上表现更好。同时该策略的多头收益率显著高于空头收益率。在不考虑交易成本时策略的夏普比率达到了夸张的4.29，但是由于该策略每日调仓，日换手率达到了94.6%。作者进一步指出该策略的收益率不能被Fama-French三因子以及动量因子模型等所解释。</p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-3309fa1e5258197773c21d9869fb6d3f_b.jpg" data-caption="" data-size="normal" data-rawwidth="554" data-rawheight="162" class="origin_image zh-lightbox-thumb" width="554" data-original="https://pic4.zhimg.com/v2-3309fa1e5258197773c21d9869fb6d3f_r.jpg"/></noscript><img src="https://pic4.zhimg.com/v2-3309fa1e5258197773c21d9869fb6d3f_b.jpg" data-caption="" data-size="normal" data-rawwidth="554" data-rawheight="162" class="origin_image zh-lightbox-thumb lazy" width="554" data-original="https://pic4.zhimg.com/v2-3309fa1e5258197773c21d9869fb6d3f_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-3309fa1e5258197773c21d9869fb6d3f_b.jpg"/></figure><p> 在考虑滑点及手续费等交易成本情况下，为了降低换手率，文章指出可以采用指数移动平均（EWMA）的方式平滑情绪信号p：</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-45a206ecc2825e4dbff0760647911d10_b.jpg" data-caption="" data-size="normal" data-rawwidth="217" data-rawheight="49" class="content_image" width="217"/></noscript><img src="https://pic1.zhimg.com/v2-45a206ecc2825e4dbff0760647911d10_b.jpg" data-caption="" data-size="normal" data-rawwidth="217" data-rawheight="49" class="content_image lazy" width="217" data-actualsrc="https://pic1.zhimg.com/v2-45a206ecc2825e4dbff0760647911d10_b.jpg"/></figure><p>采用不同的参数γ得到的夏普比率和换手率如下（考虑滑点、手续费等交易成本）：</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-8e25bd70c6b65664a5c686ae65c98048_b.jpg" data-caption="" data-size="normal" data-rawwidth="554" data-rawheight="261" class="origin_image zh-lightbox-thumb" width="554" data-original="https://pic1.zhimg.com/v2-8e25bd70c6b65664a5c686ae65c98048_r.jpg"/></noscript><img src="https://pic1.zhimg.com/v2-8e25bd70c6b65664a5c686ae65c98048_b.jpg" data-caption="" data-size="normal" data-rawwidth="554" data-rawheight="261" class="origin_image zh-lightbox-thumb lazy" width="554" data-original="https://pic1.zhimg.com/v2-8e25bd70c6b65664a5c686ae65c98048_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-8e25bd70c6b65664a5c686ae65c98048_b.jpg"/></figure><p>当γ=0.6时，在超高日换手率（85%）下，即使考虑交易成本改策略的夏普比率仍然有1.94。此外，作者发现如果将策略应用到低市值、高异质波动率的股票组中收益率将会更高。可能的一个解释是这些股票定价效率较低，其价格更加容易受到媒体报导的影响（<b>俗称的彩票效应(Lottery Effect)</b>）。</p><p>文章还比较了本文提出的SSESTM方法挖掘出的文本情绪指标与其它方法构建的情绪指标对股票收益率的预测能力。LM为Loughran and McDonald 2011提出的文本情绪指标构建方法，Raven Pack则是为新闻文本进行情绪打分的专业机构，其数据为许多对冲基金所采用。从收益率曲线可以看出作者提出的SSESTM方法显著优于其它方法。</p><p class="ztext-empty-paragraph"><br/></p><p><b>参考文献：</b></p><p>[1] Zheng Tracy Ke，Bryan Kelly，Dacheng Xiu，2019，Predicting Returns with Text Data，working paper</p><p>[2] Loughran, Tim, and Bill McDonald, 2011, When is a liability not a liability? textual analysis, dictionaries, and 10-ks, The Journal of Finance 66, 35-65</p><p><b>（如果需要英文电子版的，欢迎公众号或者文章后留言）</b></p><p class="ztext-empty-paragraph"><br/></p><p><b>往期精彩回顾：</b></p><p><b><a href="https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzI4ODA4MTExMg%3D%3D%26mid%3D2647729948%26idx%3D1%26sn%3D0f6d1685e37295baa4662027bf40a620%26scene%3D21%23wechat_redirect" class=" wrap external" target="_blank" rel="nofollow noreferrer">谁是国内量化私募的“黄埔军校”</a></b><br/></p><p><b><a href="https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzI4ODA4MTExMg%3D%3D%26mid%3D2647729840%26idx%3D1%26sn%3D1bcc43ed4afed54e043e6a345c75389d%26scene%3D21%23wechat_redirect" class=" wrap external" target="_blank" rel="nofollow noreferrer">一文读懂量化系统接入及相关平台</a></b><br/></p><p><b><a href="https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzI4ODA4MTExMg%3D%3D%26mid%3D2647729899%26idx%3D1%26sn%3Ddf8f4baf8f78e6f22ca02e68942c57b5%26scene%3D21%23wechat_redirect" class=" wrap external" target="_blank" rel="nofollow noreferrer">一文综述CTA策略及行业发展现状</a></b><br/></p><p><b><a href="https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzI4ODA4MTExMg%3D%3D%26mid%3D2647729910%26idx%3D1%26sn%3D9a42c76fee679467202bdc9ce9be651d%26scene%3D21%23wechat_redirect" class=" wrap external" target="_blank" rel="nofollow noreferrer">股票量化对冲策略的发展与展望</a></b><br/></p><p><b><a href="https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzI4ODA4MTExMg%3D%3D%26mid%3D2647729863%26idx%3D1%26sn%3Da3573c84114ba65ae0a58bd857c98ca4%26scene%3D21%23wechat_redirect" class=" wrap external" target="_blank" rel="nofollow noreferrer">稳健投资风格的背后是什么？</a></b></p><p><b><a href="https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzI4ODA4MTExMg%3D%3D%26mid%3D2647729878%26idx%3D1%26sn%3D045936e3df093f588c3fbbc058a84fb4%26scene%3D21%23wechat_redirect" class=" wrap external" target="_blank" rel="nofollow noreferrer">信息风险被定价了吗？</a></b><br/></p><p><b><a href="https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzI4ODA4MTExMg%3D%3D%26mid%3D2647729914%26idx%3D1%26sn%3Db6be4d7b3894ea9708a88f07d118cc2d%26scene%3D21%23wechat_redirect" class=" wrap external" target="_blank" rel="nofollow noreferrer">他山之石 | 时间序列动量因子</a></b><br/></p><p><b><a href="https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzI4ODA4MTExMg%3D%3D%26mid%3D2647729919%26idx%3D1%26sn%3D1c6ac30411f1d0289446ac1263871a85%26scene%3D21%23wechat_redirect" class=" wrap external" target="_blank" rel="nofollow noreferrer">巴菲特的Alpha | 来自中国市场的实证研究</a></b></p><p class="ztext-empty-paragraph"><br/></p><p>备注：未经许可，严禁转载，欢迎转发。获取更多精彩内容，请关注微信公众号“FICC与资产配置”。</p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-c78332e5d367a7becee74e699abe0b77_b.jpg" data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="308" class="origin_image zh-lightbox-thumb" width="1080" data-original="https://pic4.zhimg.com/v2-c78332e5d367a7becee74e699abe0b77_r.jpg"/></noscript><img src="https://pic4.zhimg.com/v2-c78332e5d367a7becee74e699abe0b77_b.jpg" data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="308" class="origin_image zh-lightbox-thumb lazy" width="1080" data-original="https://pic4.zhimg.com/v2-c78332e5d367a7becee74e699abe0b77_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-c78332e5d367a7becee74e699abe0b77_b.jpg"/></figure><p></p>