<p><b>本文由陈智罡博士撰写</b></p><p>前面（<a href="https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzU3MTYzMjMzNA%3D%3D%26mid%3D2247485233%26idx%3D1%26sn%3Dbdcda1f1ad5e8d9fcae69ea746a29053%26chksm%3Dfcdc7890cbabf186a1b022d8eae25d4df16269cb8e704c038b668e33962392a4e0a59ad8602a%26token%3D1789705526%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect" class=" wrap external" target="_blank" rel="nofollow noreferrer">为什么格上能够构造全同态加密-1</a>）我们说了，通过“抽象解密结构”能够把密文、明文、密钥以及噪音联系起来。</p><p class="ztext-empty-paragraph"><br/></p><p>而全同态加密的本质是反映密文计算空间与明文计算空间之间的关系。如何把这两个空间联系起来，抽象解密结构是最好的工具。</p><p class="ztext-empty-paragraph"><br/></p><p>接下来的问题就是探讨如何衡量获得同态性。</p><p class="ztext-empty-paragraph"><br/></p><h2>一、<b>期盼解密结构</b></h2><p>提醒一下，当说到同态性的时候，本质上就涉及到了计算，没有计算就没有同态性而言。而密文计算结果的解密结构的形式反映了其同态性。</p><p class="ztext-empty-paragraph"><br/></p><p>下面我们定义一个结构：期盼解密结构，如下所示：</p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-a0a6a45cf9478c05a926b4d1879917be_b.jpg" data-caption="" data-size="normal" data-rawwidth="275" data-rawheight="38" class="content_image" width="275"/></noscript><img src="https://pic3.zhimg.com/v2-a0a6a45cf9478c05a926b4d1879917be_b.jpg" data-caption="" data-size="normal" data-rawwidth="275" data-rawheight="38" class="content_image lazy" width="275" data-actualsrc="https://pic3.zhimg.com/v2-a0a6a45cf9478c05a926b4d1879917be_b.jpg"/></figure><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-6546d528a8dfb3e01da4c570932f9f11_b.jpg" data-caption="" data-size="normal" data-rawwidth="282" data-rawheight="32" class="content_image" width="282"/></noscript><img src="https://pic2.zhimg.com/v2-6546d528a8dfb3e01da4c570932f9f11_b.jpg" data-caption="" data-size="normal" data-rawwidth="282" data-rawheight="32" class="content_image lazy" width="282" data-actualsrc="https://pic2.zhimg.com/v2-6546d528a8dfb3e01da4c570932f9f11_b.jpg"/></figure><p>期盼解密结构为我们揭示了，<b>密文计算结果具有什么样的密文解密结构才可能获得同态性</b>。</p><p class="ztext-empty-paragraph"><br/></p><p>因此将获得同态性的问题转化为   →  构造期盼解密结构 →密文计算形式。</p><p class="ztext-empty-paragraph"><br/></p><p>上述分析，为我们提供了技术路线，构造同态性可以从密文计算形式入手。</p><p class="ztext-empty-paragraph"><br/></p><p>上篇文章说了，抽象解密结构的定义适用于所有格上的加密方案。</p><p class="ztext-empty-paragraph"><br/></p><p>根据目前LWE以及环LWE上的已知加密方案，将其归类为3种类型的解密结构：</p><figure data-size="small"><noscript><img src="https://pic4.zhimg.com/v2-8b5da8b5b0a30149d2356ce9bfdecec7_b.jpg" data-caption="" data-size="small" data-rawwidth="723" data-rawheight="44" class="origin_image zh-lightbox-thumb" width="723" data-original="https://pic4.zhimg.com/v2-8b5da8b5b0a30149d2356ce9bfdecec7_r.jpg"/></noscript><img src="https://pic4.zhimg.com/v2-8b5da8b5b0a30149d2356ce9bfdecec7_b.jpg" data-caption="" data-size="small" data-rawwidth="723" data-rawheight="44" class="origin_image zh-lightbox-thumb lazy" width="723" data-original="https://pic4.zhimg.com/v2-8b5da8b5b0a30149d2356ce9bfdecec7_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-8b5da8b5b0a30149d2356ce9bfdecec7_b.jpg"/></figure><figure data-size="small"><noscript><img src="https://pic4.zhimg.com/v2-8a6193a12b59aa915d2bd73142e50a5b_b.jpg" data-caption="" data-size="small" data-rawwidth="639" data-rawheight="46" class="origin_image zh-lightbox-thumb" width="639" data-original="https://pic4.zhimg.com/v2-8a6193a12b59aa915d2bd73142e50a5b_r.jpg"/></noscript><img src="https://pic4.zhimg.com/v2-8a6193a12b59aa915d2bd73142e50a5b_b.jpg" data-caption="" data-size="small" data-rawwidth="639" data-rawheight="46" class="origin_image zh-lightbox-thumb lazy" width="639" data-original="https://pic4.zhimg.com/v2-8a6193a12b59aa915d2bd73142e50a5b_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-8a6193a12b59aa915d2bd73142e50a5b_b.jpg"/></figure><figure data-size="small"><noscript><img src="https://pic2.zhimg.com/v2-52a6026a2a381d5741cabb4a3c693831_b.jpg" data-caption="" data-size="small" data-rawwidth="627" data-rawheight="47" class="origin_image zh-lightbox-thumb" width="627" data-original="https://pic2.zhimg.com/v2-52a6026a2a381d5741cabb4a3c693831_r.jpg"/></noscript><img src="https://pic2.zhimg.com/v2-52a6026a2a381d5741cabb4a3c693831_b.jpg" data-caption="" data-size="small" data-rawwidth="627" data-rawheight="47" class="origin_image zh-lightbox-thumb lazy" width="627" data-original="https://pic2.zhimg.com/v2-52a6026a2a381d5741cabb4a3c693831_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-52a6026a2a381d5741cabb4a3c693831_b.jpg"/></figure><p>前两种存在于LWE或环LWE上的加密，最后一种存在于环LWE上的NTRU加密。</p><p class="ztext-empty-paragraph"><br/></p><p>那么问题来了，对于上述三种解密结构，通过什么样的密文计算形式才能够获得期盼解密结构呢？</p><p class="ztext-empty-paragraph"><br/></p><h2>二、<b>密文乘法期盼解密结构的构造</b></h2><p>这里要说明一点，格上的加密方案天生具有加法同态性的，所以加法同态性我们不需要考虑。<b>关键是研究乘法同态性</b>。</p><p class="ztext-empty-paragraph"><br/></p><p>同态性与两个因素有关，一是期盼解密结构，二是噪音的大小。</p><p class="ztext-empty-paragraph"><br/></p><p>其实，噪音并不影响同态性的具有，只是如果噪音大了让方案无法获得具有的同态性。因为噪音大了导致无法解密，就算具有同态性，方案也没有意义了。</p><p class="ztext-empty-paragraph"><br/></p><p>为了研究密文乘法期盼解密结构的构造，假设密文中的噪音是小的，这样研究的重点就聚焦在密文乘法上。</p><p class="ztext-empty-paragraph"><br/></p><p>可以通过以下<b>两种形式构造密文乘法的期盼解密结构</b>：</p><p class="ztext-empty-paragraph"><br/></p><p>第1种形式：(c1⊙s) · (c2⊙s)</p><p>第2种形式：c1 ·c2 · s</p><p class="ztext-empty-paragraph"><br/></p><ul><li><b><u>第1种形式产生的结果</u></b></li></ul><p>如果采用(<i>c</i>1⊙<i>s</i>) · (<i>c</i>2⊙<i>s</i>)形式构造密文乘法的期盼解密结构，则<b>上述三种类型的解密结构都可通过该形式获得期盼解密结构</b>，并且该形式构造密文乘法期盼解密结构的一个共同特征是<b>密钥长度在计算过程中是改变并且增长的</b>。</p><p class="ztext-empty-paragraph"><br/></p><p>采用(<i>c</i>1⊙<i>s</i>) · (<i>c</i>2⊙<i>s</i>)角度出发构造密文乘法的同态性，适用于上述三种解密结构，因此具有通用性。但是其特征是会引起密钥长度的增长。所以为了获得更多的乘法次数，每次乘法后需要使用密钥交换约减密文长度。</p><p class="ztext-empty-paragraph"><br/></p><p>尽管密钥交换操作是构造全同态加密的基石，但是影响了计算的效率，而且使得密文乘法非常复杂。因此，一个自然的想法就是如何能够在密文计算过程中保持密钥长度不变，从而密文的长度也不变。</p><p class="ztext-empty-paragraph"><br/></p><ul><li><b><u>第2种形式产生的结果</u></b></li></ul><p>如果采用</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-8682ed0d75b9786417aded9d6104bf51_b.jpg" data-caption="" data-size="normal" data-rawwidth="126" data-rawheight="34" class="content_image" width="126"/></noscript><img src="https://pic2.zhimg.com/v2-8682ed0d75b9786417aded9d6104bf51_b.jpg" data-caption="" data-size="normal" data-rawwidth="126" data-rawheight="34" class="content_image lazy" width="126" data-actualsrc="https://pic2.zhimg.com/v2-8682ed0d75b9786417aded9d6104bf51_b.jpg"/></figure><p>形式构造密文乘法的期盼解密结构，则上述三种类型的解密结构中，<b>只有第3种类型的解密结构通过该形式可获得期盼解密结构</b>，并且该形式构造密文乘法期盼解密结构的一个共同特征是在<b>计算过程中密钥长度是保持不变的</b>。</p><p class="ztext-empty-paragraph"><br/></p><p>上述分析清晰的给出了从解密结构出发构造期盼解密结构的方法，即构造同态性的方法，但是有个前提是密文计算的<b>噪音是小的才能够保证同态性的获得</b>。下面研究解密结构与噪音增长之间的关系。</p><p>感兴趣的朋友可以参考陈智罡博士的论文：</p><p class="ztext-empty-paragraph"><br/></p><p>论文长文版：<a href="https://link.zhihu.com/?target=https%3A//share.weiyun.com/5Qb4cyd" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">https://</span><span class="visible">share.weiyun.com/5Qb4cy</span><span class="invisible">d</span><span class="ellipsis"></span></a></p><p class="ztext-empty-paragraph"><br/></p><p>1.    A General Design Method of Constructing Fully Homomorphic Encryption with Ciphertext Matrix. KSII Transactions on Internet and Information Systems, 2019,Vol.13(5)：2629-2650.</p><p>2.    基于抽象解密结构的全同态加密构造方法分析[J]. 电子与信息学报, 2018, 40(7): 1669-1675.</p><a href="https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzU3MTYzMjMzNA%3D%3D%26mid%3D2247485238%26idx%3D1%26sn%3D4d9cab706dc79bc5d269aa24e2b2e11a%26chksm%3Dfcdc7897cbabf1812a76a4cefee9504e3faf9cb1eb0ee869fad057efc5da2a47048f68f22386%26token%3D168742298%26lang%3Dzh_CN%23rd" data-draft-node="block" data-draft-type="link-card" data-image="https://pic3.zhimg.com/v2-4e76bc4e534db0da08917f72bc9298aa_180x120.jpg" data-image-width="600" data-image-height="254" class=" wrap external" target="_blank" rel="nofollow noreferrer">为什么格上能够构造全同态加密-2</a><hr/><p><b>文章首发在微信公众号：btc201800</b><br/><b>知识星球ID：28018093</b><br/><br/><b>音频发布在喜马拉雅上“区块链杂谈 (第2季)”</b> <b><u><a href="https://link.zhihu.com/?target=http%3A//xima.tv/Bjq4se" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">http://</span><span class="visible">xima.tv/Bjq4se</span><span class="invisible"></span></a></u></b><br/><b>解读区块链白皮书</b> <u><a href="https://link.zhihu.com/?target=http%3A//xima.tv/RNU1Q8" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">http://</span><span class="visible">xima.tv/RNU1Q8</span><span class="invisible"></span></a></u><br/><br/><b>宁波格密链网络科技有限公司，专注于区块链上的密码技术研发。</b></p>