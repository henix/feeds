<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Libor Market Model 简介2 ——分离波动率函数和校准（一部分）</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/34664049">原文</a></p>
<div class="title-image"><img src="https://pic1.zhimg.com/v2-b5ecf8eaaba4995357bb3f78a80ec73e_r.jpg" alt=""></div><p><b>前言：</b></p><p>对，这个问题离说完还差很远。建模，校准，产品，风险，这些东西是一套的。当然继续写下去是有契机的。 那天刚刚写完上一篇，本专栏联合编辑之一 <a class="member_mention" href="https://www.zhihu.com/people/06e1c0cadfaab8dae2fca66aaa30d65f" data-hash="06e1c0cadfaab8dae2fca66aaa30d65f" data-hovercard="p$b$06e1c0cadfaab8dae2fca66aaa30d65f">@消毒纸巾</a> 同学提到了Cap波动率的校准问题。虽然已经被业界大佬精辟地给出了方向，然而这个问题还是要写一些的。</p><p><br></p><p><b>正文：</b></p><p><b>what&why：</b></p><p>在上文构造tenor structure的Libor 率过程的时候我们仅仅给出了Libor过程约化形态的测度变化：</p><p><img src="https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+%26dL%28t%2CT%29+%3D+%7E%5Csigma_TdW%5E%7BT%2B%5Ctau%7D_t+%5C%5C%26dW%5ET_t+%3D+%7EdW%5E%7BT%2B%5Ctau%7D_t+-+%5Cfrac%7B%5Ctau%5Csigma_T%7D%7B1%2B%5Ctau+L%28t%2CT%29%7Ddt+%5Cend%7Balign%7D" alt="\begin{align} &dL(t,T) = ~\sigma_TdW^{T+\tau}_t \\&dW^T_t = ~dW^{T+\tau}_t - \frac{\tau\sigma_T}{1+\tau L(t,T)}dt \end{align}" eeimg="1"> </p><p>问题出在这个 <img src="https://www.zhihu.com/equation?tex=%5Csigma_T" alt="\sigma_T" eeimg="1"> 是个什么鬼？ 为了回答这个问题，我们需要回到HJM框架下寻找这个（堆）约化参数所对应的结构模型。由此可见HJM框架的重要性，他能保证各类产品之间结构的一致性。（ 题外话，Q系有两大内功：“手术刀”（分解资产），“搭积木”（资产结构）。接下来这套属于“搭积木”的内容）：</p><p>还是回到<a href="https://www.zhihu.com/question/59120463" class="internal">HJM 模型框架（又称元模型）和一般的利率过程有什么本质区别？</a>这个问题下猫那个答案。我们一直了Bond Price在HJM下的dynamic：</p><p><img src="https://www.zhihu.com/equation?tex=dP%28t%2CT%29%3Dr_tP%28t%2CT%29dt-%5Csigma%5E%2A%28t%2CT%29P%28t%2CT%29dW_t" alt="dP(t,T)=r_tP(t,T)dt-\sigma^*(t,T)P(t,T)dW_t" eeimg="1"> </p><p>我们把当初Libor率定义的右半部份定义为“远期债”：</p><p><img src="https://www.zhihu.com/equation?tex=P%28t%2CT%2CT%2B%5Ctau%29+%3D+P%28t%2CT%2B%5Ctau%29%2FP%28t%2CT%29+" alt="P(t,T,T+\tau) = P(t,T+\tau)/P(t,T) " eeimg="1"> </p><p>那么这个远期债的dynamic为（对 <img src="https://www.zhihu.com/equation?tex=1%2FP%28t%2CT%29" alt="1/P(t,T)" eeimg="1"> 使用伊藤定理后用伊藤乘法）：</p><p><img src="https://www.zhihu.com/equation?tex=dP%28t%2CT%2CT%2B%5Ctau%29+%2FP%28t%2CT%2CT%2B%5Ctau%29+%3D+-%5B%5Csigma%5E%2A%28t%2CT%2B%5Ctau%29+-+%5Csigma%5E%2A%28t%2CT%29%5D%5Csigma%5E%2A%28t%2CT%29dt+-+%5B%5Csigma%5E%2A%28t%2CT%2B%5Ctau%29+-+%5Csigma%5E%2A%28t%2CT%29%5DdW_t" alt="dP(t,T,T+\tau) /P(t,T,T+\tau) = -[\sigma^*(t,T+\tau) - \sigma^*(t,T)]\sigma^*(t,T)dt - [\sigma^*(t,T+\tau) - \sigma^*(t,T)]dW_t" eeimg="1"> </p><p>熟悉HJM框架的童鞋会看出来这是个 <img src="https://www.zhihu.com/equation?tex=Q%5ET+" alt="Q^T " eeimg="1"> 鞅，于是： </p><p><img src="https://www.zhihu.com/equation?tex=dP%28t%2CT%2CT%2B%5Ctau%29+%2FP%28t%2CT%2CT%2B%5Ctau%29+%3D+-+%5B%5Csigma%5E%2A%28t%2CT%2B%5Ctau%29+-+%5Csigma%5E%2A%28t%2CT%29%5DdW%5E%7BT%7D_t" alt="dP(t,T,T+\tau) /P(t,T,T+\tau) = - [\sigma^*(t,T+\tau) - \sigma^*(t,T)]dW^{T}_t" eeimg="1"> </p><p>那么跟Libor定义（其中 <img src="https://www.zhihu.com/equation?tex=L%28t%2CT%29+" alt="L(t,T) " eeimg="1"> 沿用上一篇远期单利的定义：</p><p><img src="https://www.zhihu.com/equation?tex=1%2B%5Ctau+L%28t%2CT%29+%3D%5Cfrac%7BP%28t%2CT%29%7D%7BP%28t%2CT%2B%5Ctau%29%7D" alt="1+\tau L(t,T) =\frac{P(t,T)}{P(t,T+\tau)}" eeimg="1"> </p><p>我们有：</p><p><img src="https://www.zhihu.com/equation?tex=dL%28t%2CT%29%3D+%5Cfrac%7B1%2B%5Ctau+L%28t%2CT%29%7D%7B%5Ctau%7D+%5Csigma%5E%2A%28T%2CT%2B%5Ctau%29dW%5ET" alt="dL(t,T)= \frac{1+\tau L(t,T)}{\tau} \sigma^*(T,T+\tau)dW^T" eeimg="1"> </p><p>这个波动率部分就是 <img src="https://www.zhihu.com/equation?tex=%5Csigma_T+%2B%5Cfrac%7B%5Ctau%5Csigma_T%7D%7B1%2B%5Ctau+L%28t%2CT%29%7Ddt" alt="\sigma_T +\frac{\tau\sigma_T}{1+\tau L(t,T)}dt" eeimg="1"> (想想为什么）</p><p>其实邪道第三部的时候问题就很明显了，累计波动率 <img src="https://www.zhihu.com/equation?tex=%5Csigma%5E%2A" alt="\sigma^*" eeimg="1"> 是短期率波动率的积分，而短期率的波动率是不可观测到的。这个问题LMM和HJM下都会遇到。因此我们需要一套特殊的参数化方法去“伪造”一个波动率函数。否则根本无法校准（或者只能校准到约化的模型上，不要再问为什么仅仅是约化不行，去读上篇）</p><p><br></p><p><br></p><p><b>可分离函数：</b></p><p>为了技术上校准的方便AP中采用了如下形式：</p><p><img src="https://www.zhihu.com/equation?tex=%5Csigma_T+%3D%5Clambda%28t%29+%5Cvarphi%28L%28t%2CT%29%29" alt="\sigma_T =\lambda(t) \varphi(L(t,T))" eeimg="1"> </p><p>AP中表示，对于 <img src="https://www.zhihu.com/equation?tex=%5Cvarphi" alt="\varphi" eeimg="1"> 不要纠结这些技术细节，这些东西就是为了结果校准方便。只需要满足一些非常基本的条件比如李普希兹连续(这不是什么”虚假的假设“，一个利率的波动率要是不李普希兹连续了，那想想都可怕），使用者就可以用自己的经验函数。AP中给出了一组常用经验函数，比如lognormal就用x，CEV用x^p等。</p><p><br></p><p>接下来为了引用方便，猫选会选用AP当中的notation。 我们把第n期远期单利表示为：</p><p><img src="https://www.zhihu.com/equation?tex=L_n%28t%29+%3DL%28t%2CT_n%2CT_n%2B%5Ctau%29" alt="L_n(t) =L(t,T_n,T_n+\tau)" eeimg="1"> </p><p>那么我们试算一下两个不同期之间远期单利的方差（交互变差）：</p><p><img src="https://www.zhihu.com/equation?tex=d%3CL_k%28t%29%2CL_j%28t%29%3E+%3Dz%28t%29%5Cvarphi%28L_k%28t%29%29%5Cvarphi%28L_j%28t%29%29%5Clambda_k%28t%29%5Clambda_j%28t%29dt" alt="d<L_k(t),L_j(t)> =z(t)\varphi(L_k(t))\varphi(L_j(t))\lambda_k(t)\lambda_j(t)dt" eeimg="1"> </p><p>其中 <img src="https://www.zhihu.com/equation?tex=z%28t%29" alt="z(t)" eeimg="1"> 可以是任何一种波动率过程，所以上述分离函数可以套进任何随机波动率模型下</p><p>那么自然的相关性就有：</p><p><img src="https://www.zhihu.com/equation?tex=corr%28dL_k%28t%29%2CdL_j%28t%29%29+%3D%5Cfrac%7B%3CdL_k%28t%29%2CdL_j%28t%29%3E%7D%7B%5Csqrt%7B%3CdL_k%28t%29%3E%2C%3CdL_j%28t%29%3E%7D%7D" alt="corr(dL_k(t),dL_j(t)) =\frac{<dL_k(t),dL_j(t)>}{\sqrt{<dL_k(t)>,<dL_j(t)>}}" eeimg="1"> </p><p>由于波动率被我们分离掉了，而随机乘数部分不影响相关性，所以我们有：</p><p><img src="https://www.zhihu.com/equation?tex=corr%28dL_k%28t%29%2CdL_j%28t%29%29%3D%5Cfrac%7B%5Clambda_k%28t%29%5Clambda_j%28t%29%7D%7B%7C%7C%5Clambda_k%28t%29%7C%7C%7E%7C%7C+%5Clambda_j%28t%29%7C%7C%7D" alt="corr(dL_k(t),dL_j(t))=\frac{\lambda_k(t)\lambda_j(t)}{||\lambda_k(t)||~|| \lambda_j(t)||}" eeimg="1"> </p><p><b>波动率校准问题在这个时候被巧妙转化成了估计不同期限结构下相关性的问题。</b></p><p><br></p><p><br></p><p><b>处理相关性：</b></p><p>一般我们在获得贴现率曲线后（这个所有利率产品的标准校准依据，当然也是最优先的校准目标。我们的LMM需要用到这些先期的校准结果），我们可以根据价格和LIBOR的关系画出远期率曲线（也就是libor curve）。我们需要在这个tenor structure上校准出相关性的参数。</p><p>(题外话，关于是先对贴现率曲线插值再转LIBOR曲线，还是先求出LIBOR曲线点再对其插值这个猫并不清楚）</p><p>一般处理期限结构的相关性有两种方法：参数和非参</p><p><br></p><p>参数法：</p><p>一些结果如Coffey[2000], Jong[2001] ，Rebonato[2002]给出了一些光滑期限结构估计方法，其中一种是假设了如下函数：</p><p><img src="https://www.zhihu.com/equation?tex=Corr%28dL_k%28t%29%2C+dL_j%28t%29%29+%3Dq_1%28T_k-t%2C+T_j-t%29" alt="Corr(dL_k(t), dL_j(t)) =q_1(T_k-t, T_j-t)" eeimg="1"> </p><p>其中q函数为：</p><p><img src="https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+q_2%28x%2Cy%29%26+%3D%5Crho_%5Cinfty%28min%28x%2Cy%29%29+%2B%281-%5Crho_%5Cinfty%28min%28x%2Cy%29%29%29exp%28-a%28min%28x%2Cy%29%29%7Cy-x%7C%29+%5C%5Ca%28z%29%26+%3Da_%5Cinfty+%2B%28a_0+-a_%5Cinfty%29e%5E%7B-kz%7D+%5Cend%7Balign%7D" alt="\begin{align} q_2(x,y)& =\rho_\infty(min(x,y)) +(1-\rho_\infty(min(x,y)))exp(-a(min(x,y))|y-x|) \\a(z)& =a_\infty +(a_0 -a_\infty)e^{-kz} \end{align}" eeimg="1"> </p><p>我们令\theta为全部参数，那么校准的目标函数为：</p><p><img src="https://www.zhihu.com/equation?tex=%5Ctheta%5E%2A+%3Dargmin_%5Ctheta+%5Cleft%5C%7Btr%5B%28R-R_2%28%5Ctheta%29%29R-R_2%28%5Ctheta%29%29%5ET%5D+%5Cright%5C%7D+" alt="\theta^* =argmin_\theta \left\{tr[(R-R_2(\theta))R-R_2(\theta))^T] \right\} " eeimg="1"> </p><p>其中R<i>2为q_</i>2计算出的模型相关矩阵，R样本相关性矩阵</p><p>关于参数法的缺点，就是传统那些过拟合，欠拟合，这里不多表述。（实际上6个参数想过拟合很难，一般会欠拟合。不过考率到LIBOR曲线也不是那么复杂，6个参数拟合的结果不会太坏）</p><p><br></p><p>非参法：</p><p>对高度相关的期限结构相估计的一个传统方法是使用PCA（主成分分析）对期限结构进行聚类，在Hull里利率一章提到过，在这里因为tenor structure也是一种期限结构，所以可以采用相同的方法。</p><p>对于一条足够光滑的远期曲线，已经可以使用PCA了，步骤就是标准那套：</p><p>1.中心化</p><p>2.svd</p><p>3.取前几个成分（正交的线性组合）</p><p>完成之后，取前m个主成分来解释大部分方差。</p><p><br></p><p><b>PCA在此处的两种使用方法：</b></p><p>在这之后第一种利用上面结果处理相关性的方法就是：不处理。 因为主成分之间互相正交，所以但我们去LIBOR的线性组合主成分进行估计是，可以不用处理相关性。</p><p><b>是的，主成分分析法的一个最大优点就是巧妙的避免了处理相关性的参数。</b></p><p>此外，其金融上也有明显意义，因为一般对期限结构的前三个主成分都代表了明确的利率曲线变化方式，如“平动”（shifting），“撬动”（twisting），“弯曲”（bowing）。因此该方法被大量应用在期限结构的降维和解释上。</p><p>但其缺点有，1.我们只是采用了几个成分，他们并不能完全代表所有tenor structure； 2.LIBOR的线性组合不一定适用于上文的 <img src="https://www.zhihu.com/equation?tex=%5Cvarphi+" alt="\varphi " eeimg="1"> ,除非在一些简单的假设下比如lognormal。</p><p><br></p><p>第二种利用方法称为correlation PCA，我们先对相关性矩阵R做如下分解：</p><p><img src="https://www.zhihu.com/equation?tex=R%3DE%28YY%5ET%29+" alt="R=E(YY^T) " eeimg="1"> </p><p>其中Y服从标准正态分布的变量（注意并没有以要求一定是chol分解）</p><p>然后我们做如下近似分解：</p><p><img src="https://www.zhihu.com/equation?tex=Y+%5Capprox+DX" alt="Y \approx DX" eeimg="1"> </p><p>其中D是p×m(p为变量数，m<p）矩阵，X为m×1，元素服从标准正态的向量。 这一步相当于对相关性矩阵做了一个降维。 AP里给出了如下优化技术结果，令：</p><p><img src="https://www.zhihu.com/equation?tex=h%28D%3BR%29+%3Dtr%5Cleft%5C%7B+%28R-DD%5ET%29%28R-DD%5ET%29%5ET+%5Cright%5C%7D" alt="h(D;R) =tr\left\{ (R-DD^T)(R-DD^T)^T \right\}" eeimg="1"> </p><p>为优化目标函数，则最优D矩阵为：</p><p><img src="https://www.zhihu.com/equation?tex=D%5E%2A+%3Dargmin_D+h%28D%EF%BC%9BR%29+%2C%7E%7Esubject%7Eto+%7Ediag%28DD%5ET%29%3D1+" alt="D^* =argmin_D h(D；R) ,~~subject~to ~diag(DD^T)=1 " eeimg="1"> </p><p>由于X和Y都是标准正态分布矩阵，这里的DD^T达到了一种对R很好的近似，并且降低了相关性矩阵的维度。</p><p>AP中还给出，如果给出方程： <img src="https://www.zhihu.com/equation?tex=diag%28D_%5Cmu+D_%5Cmu%5ET%29+-1+%3D0" alt="diag(D_\mu D_\mu^T) -1 =0" eeimg="1"> 的向量解 <img src="https://www.zhihu.com/equation?tex=%5Cmu%5E%2A" alt="\mu^*" eeimg="1"> 。 则满足该解的的最优 <img src="https://www.zhihu.com/equation?tex=D_%7B%5Cmu%5E%2A%7D+" alt="D_{\mu^*} " eeimg="1"> 可通过优化：</p><p><img src="https://www.zhihu.com/equation?tex=D_%5Cmu+%3Dargmin_D+h%28D%3B+R%2Bdiag%28%5Cmu%29%29" alt="D_\mu =argmin_D h(D; R+diag(\mu))" eeimg="1"> 给出。</p><p>由于猫优化不懂，不会，没学过，所以这里有望高人指点。</p><p>如果有一个或多个续集，将继续介绍具体在产品在LMM下的建模和更加多的校准细节</p><p><br></p><p>正文结束</p><p><br></p><p><b>吐槽和骂人：</b></p><p>文中反复提及的书AP名叫《Interest Rate Modeling》，AP是作者的缩写。文中所有内容都是第二册第十四章LMM部分的。这（三）本书被视为利率建模的百科全书，可入门，可进阶，可深入，可前沿。什么前沿？没错，因为利率方面建模其实已经非常完善了，近几年真的没有出现什么特别新的成果了。更多的是些choice of collateral这类特定业务相关的东西。也而这本书内容很全面，所以可以认为是前沿了。</p><p>所以对于这部分内容黑猫不想骂什么，校准本身就是一个模型得以应用的最重要的一部分，如果这都有人叫”理论“，那基本跟猫一样，甚至比猫还小学生了。</p><p><br></p><p><br></p><p>最后，按照惯例，希望这些”被时代淘汰的虚假理论"能帮助一些从业者和学习者。</p>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
