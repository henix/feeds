<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:media="http://search.yahoo.com/mrss/">
<channel>
<title>Rustç¼–ç¨‹</title>
<link>https://henix.github.io/feeds/zhuanlan.rust-lang/</link>
<description>In Rust We Trust ä¸ Rust è¯­è¨€ç›¸å…³çš„æ–¹æ–¹é¢é¢</description>
<language>zh-cn</language>
<lastBuildDate>Fri, 28 Feb 2020 00:05:18 +0800</lastBuildDate>
<item>
<title>å®‰è£…RuståŠVSCodeç¯å¢ƒè®¾ç½®ï¼ˆWin 10ï¼‰</title>
<link>https://henix.github.io/feeds/zhuanlan.rust-lang/2020-02-27-92172591.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/92172591&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-5a71f121dd779465a7d67a2f5710608e_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;&lt;i&gt;2020å¹´2æœˆ27æ—¥æ›´æ–°&lt;/i&gt;&lt;/b&gt;&lt;/p&gt;&lt;blockquote&gt;&lt;a href=&quot;https://www.zhihu.com/people/dcjanus&quot; class=&quot;internal&quot;&gt;DCjanus&lt;/a&gt;å’Œ&lt;a href=&quot;https://www.zhihu.com/people/crlf0710&quot; class=&quot;internal&quot;&gt;CrLF0710&lt;/a&gt;çš„å¸®åŠ©è®©è¿™ä¸€ç¯‡æ•™ç¨‹æˆä¸ºå¯èƒ½ï¼Œåœ¨æ­¤è‡´ä»¥çœŸæŒšåœ°æ„Ÿè°¢ğŸ™&lt;/blockquote&gt;&lt;h2&gt;ç›®å½•ï¼š&lt;/h2&gt;&lt;ol&gt;&lt;li&gt;å®‰è£…rust&lt;/li&gt;&lt;li&gt;å®‰è£…VScodeç¼–è¾‘å™¨åŠè¯­è¨€æœåŠ¡å™¨&lt;/li&gt;&lt;li&gt;å®‰è£…è°ƒè¯•å·¥å…·å’Œæ’ä»¶&lt;/li&gt;&lt;li&gt;å»ºç«‹é¡¹ç›®å¹¶è¿›è¡Œè°ƒè¯•è®¾ç½®&lt;/li&gt;&lt;li&gt;é™„å½•ï¼šrustlingsçš„ä½¿ç”¨&lt;/li&gt;&lt;/ol&gt;&lt;hr/&gt;&lt;h2&gt;ä¸€ã€å®‰è£…Rust&lt;/h2&gt;&lt;ol&gt;&lt;li&gt;&lt;i&gt;ä¸‹è½½Rustå®‰è£…å·¥å…·&lt;/i&gt;&lt;/li&gt;&lt;li&gt;&lt;i&gt;ä½¿ç”¨é•œåƒåŠ é€ŸRustå®‰è£…&lt;/i&gt;&lt;/li&gt;&lt;li&gt;&lt;i&gt;å®‰è£…Rustï¼ˆä¸¤ç§å·¥å…·é“¾å¯ä¾›é€‰æ‹©ï¼‰&lt;/i&gt;&lt;/li&gt;&lt;li&gt;&lt;i&gt;å®‰è£…æ ‡å‡†åº“æºç &lt;/i&gt;&lt;/li&gt;&lt;li&gt;&lt;i&gt;ä½¿ç”¨é•œåƒåŠ é€ŸRuståŒ…ä¸‹è½½&lt;/i&gt;&lt;/li&gt;&lt;li&gt;&lt;i&gt;è®¾ç½®RuståŒ…ç¯å¢ƒå˜é‡&lt;/i&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;b&gt;1.ä¸‹è½½rustup-init.exeï¼ˆRustå®‰è£…å·¥å…·ï¼‰&lt;/b&gt;&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//win.rustup.rs/x86_64&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;ç‚¹å‡»ä¸‹è½½rustup-init&lt;/a&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;2. ä½¿ç”¨é•œåƒåŠ é€Ÿrustupå®‰è£…&lt;/b&gt;&lt;/p&gt;&lt;p&gt;æ‰“å¼€Powershell(Win+X +A)æ‰§è¡Œï¼ˆæ‰§è¡Œå®Œä¸è¦å…³é—­ï¼Œåé¢è¿˜ä¼šå¤šæ¬¡ç”¨åˆ°ï¼‰ï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot;&gt;&lt;span class=&quot;no&quot;&gt;[environment]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SetEnvironmentvariable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;RUSTUP_DIST_SERVER&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;https://mirrors.ustc.edu.cn/rust-static&amp;#34;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;User&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;no&quot;&gt;[environment]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SetEnvironmentvariable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;RUSTUP_UPDATE_ROOT&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;https://mirrors.ustc.edu.cn/rust-static/
&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;rustup&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;User&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;blockquote&gt;å‚è€ƒé“¾æ¥ï¼š&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//lug.ustc.edu.cn/wiki/mirrors/help/rust-static&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;lug.ustc.edu.cn/wiki/mi&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;rrors/help/rust-static&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;b&gt;3. å®‰è£…Rustï¼š&lt;/b&gt;æ‰“å¼€rustup-init.exe&lt;/p&gt;&lt;p&gt;å¦‚æœå‡ºç°å®‰è£…ç¨‹åºæœªç»å¾®è½¯éªŒè¯ï¼Œç‚¹å‡»install anywayï¼ˆç«‹å³å®‰è£…ï¼‰å³å¯ã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-074080926471ad7622cfd97da9c36548_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;389&quot; data-rawheight=&quot;432&quot; class=&quot;content_image&quot; width=&quot;389&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-074080926471ad7622cfd97da9c36548_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;389&quot; data-rawheight=&quot;432&quot; class=&quot;content_image lazy&quot; width=&quot;389&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-074080926471ad7622cfd97da9c36548_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;å®‰è£…æœ‰2ç§é€‰æ‹©ï¼Œgnuæˆ–è€…msvcå·¥å…·é“¾&lt;/p&gt;&lt;ul&gt;&lt;li&gt;gnuï¼ˆæœ¬æ–‡ä½¿ç”¨MinGW-w64ï¼‰å ç”¨ç©ºé—´å°ï¼ˆ500Mï¼‰ï¼Œå¯¹äºåˆæ­¥çš„rustä½¿ç”¨è¶³å¤Ÿäº†ã€‚&lt;/li&gt;&lt;li&gt;msvcï¼ˆæœ¬æ–‡ä½¿ç”¨Visual Studio Build Toolsï¼ŒåŒ…å«msvcï¼Œclangç­‰ï¼‰å ç”¨ç©ºé—´å¤§ï¼ˆ2Gï¼‰ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;å·²ç»å®‰è£…äº†Visual Studioçš„é€‰æ‹©msvcï¼Œå·²ç»æœ‰MinGW-w64æˆ–è€…msys2ï¼Œæˆ–è€…ä¸æƒ³å ç”¨å¤ªå¤šç©ºé—´çš„ä½¿ç”¨gnuã€‚&lt;/p&gt;&lt;p&gt;æ›´å¤šåŒºåˆ«è§è¿™ä¸ªè®¨è®º&lt;/p&gt;&lt;a href=&quot;https://www.zhihu.com/question/23789676&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; class=&quot;internal&quot;&gt;GCC/G++ã€ICCã€Clangã€MSVCã€BCCç­‰C/C++ç¼–è¯‘å™¨æœ‰ä»€ä¹ˆç‰¹é•¿å’Œä¸è¶³ï¼Ÿ&lt;/a&gt;&lt;p&gt;&lt;b&gt;gnu&lt;/b&gt;ä¾æ¬¡è¾“å…¥ï¼ˆæ³¨æ„æ¯è¡Œéœ€å›è½¦æ‰§è¡Œï¼‰ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;2&lt;/li&gt;&lt;li&gt;x86_64-pc-windows-gnu&lt;/li&gt;&lt;li&gt;nightlyï¼ˆæƒ³ç”¨æœ€æ–°çš„åŠŸèƒ½å°±ç”¨nightlyï¼ˆæ¯å¤œç‰ˆï¼‰ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©stableï¼ˆç¨³å®šç‰ˆï¼‰ï¼‰&lt;/li&gt;&lt;li&gt;ä¸€è·¯å›è½¦å³å¯ï¼Œç›´åˆ°çœ‹åˆ°æ­£åœ¨ä¸‹è½½ä¸­ï¼ˆæœ‰kb/sçš„å­—æ ·ï¼‰&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;msvc&lt;/b&gt;ä¾æ¬¡è¾“å…¥ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;2&lt;/li&gt;&lt;li&gt;x86_64-pc-windows-msvc&lt;/li&gt;&lt;li&gt;nightlyï¼ˆæƒ³ç”¨æœ€æ–°çš„åŠŸèƒ½å°±ç”¨nightlyï¼ˆæ¯å¤œç‰ˆï¼‰ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©stableï¼ˆç¨³å®šç‰ˆï¼‰ï¼‰&lt;/li&gt;&lt;li&gt;ä¸€è·¯å›è½¦å³å¯ï¼Œç›´åˆ°çœ‹åˆ°æ­£åœ¨ä¸‹è½½ä¸­ï¼ˆæœ‰kb/sçš„å­—æ ·ï¼‰&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;è¿™é‡Œåªæ˜¯å®‰è£…äº†Rustï¼Œè¿™ä¸¤ç§å·¥å…·é“¾åˆ°ç¬¬ä¸‰éƒ¨åˆ†å†ä¸‹è½½å®‰è£…ã€‚&lt;/p&gt;&lt;blockquote&gt;Rustå¸è½½ï¼š              &lt;code&gt;rustup self uninstall&lt;/code&gt;&lt;br/&gt;æ‰“å¼€Rustæœ¬åœ°æ–‡æ¡£ï¼š &lt;code&gt;rustup doc&lt;/code&gt;&lt;br/&gt;Rustä¸­æ–‡æ–‡æ¡£åœ°å€ï¼š&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//120.78.128.153/rustbook/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Rust ç¨‹åºè®¾è®¡è¯­è¨€ ç®€ä½“ä¸­æ–‡ç‰ˆ&lt;/a&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;b&gt;4. å®‰è£…æ ‡å‡†åº“æºç &lt;/b&gt;&lt;/p&gt;&lt;p&gt;è¯­è¨€æœåŠ¡å™¨éœ€è¦æºç ï¼Œæ‰“å¼€powershellæ‰§è¡Œï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt; rustup component add rust-src 

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;5. ä½¿ç”¨é•œåƒåŠ é€ŸcargoåŒ…ä¸‹è½½ï¼š&lt;/b&gt;&lt;/p&gt;&lt;p&gt;æ‰“å¼€Powershellæ‰§è¡Œï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;&amp;#34;[source.crates-io]
registry = &amp;#39;https://github.com/rust-lang/crates.io-index&amp;#39;
replace-with = &amp;#39;ustc&amp;#39;
[source.ustc]
registry = &amp;#39;https://mirrors.ustc.edu.cn/crates.io-index/&amp;#39;
&amp;#34;|Out-File -Encoding utf8 $home\.cargo\config


&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;blockquote&gt;è„šæœ¬åœ¨ç”¨æˆ·ç›®å½•.cargoç›®å½•ä¸‹æ–°å»ºäº†æ–‡ä»¶configï¼Œç”¨ä¸­ç§‘å¤§é•œåƒåŠ å¿«cargoåŒ…ä¸‹è½½ã€‚&lt;br/&gt;cargoç±»ä¼¼äºnpmï¼Œæ˜¯ Rust çš„æ„å»ºç³»ç»Ÿå’ŒåŒ…ç®¡ç†å™¨ã€‚&lt;br/&gt;å‚è€ƒé“¾æ¥ï¼š&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//lug.ustc.edu.cn/wiki/mirrors/help/rust-crates&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;lug.ustc.edu.cn/wiki/mi&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;rrors/help/rust-crates&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/blockquote&gt;&lt;p&gt;6. è®¾ç½®cargoç¯å¢ƒå˜é‡ï¼ˆä»¥åçš„rustupå¯èƒ½ä¼šè‡ªåŠ¨è®¾ç½®ï¼‰&lt;/p&gt;&lt;p&gt;æ‰“å¼€Powershellæ‰§è¡Œï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$path&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;[environment]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;GetEnvironmentvariable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Path&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;User&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$cargo_path&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$env:USERPROFILE&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;\.cargo\bin&amp;#34;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$path&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$cargo_path&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;;&amp;#34;&lt;/span&gt;
&lt;span class=&quot;no&quot;&gt;[environment]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SetEnvironmentvariable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Path&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;User&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr/&gt;&lt;h2&gt;äºŒã€å®‰è£…VScodeç¼–è¾‘å™¨åŠè¯­è¨€æœåŠ¡å™¨&lt;/h2&gt;&lt;ol&gt;&lt;li&gt;&lt;i&gt;å®‰è£…VSCode&lt;/i&gt;&lt;/li&gt;&lt;li&gt;&lt;i&gt;å®‰è£…è¯­è¨€æœåŠ¡å™¨ï¼ˆæœ‰ä¸¤ç§å¯ä¾›é€‰æ‹©ï¼‰&lt;/i&gt;&lt;/li&gt;&lt;li&gt;&lt;i&gt;å®‰è£…äººå·¥æ™ºèƒ½è¡¥å…¨æ’ä»¶TabNine&lt;/i&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;b&gt;1ï¸âƒ£. å®‰è£…VSCode&lt;/b&gt;&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//code.visualstudio.com/&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;code.visualstudio.com/&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;p&gt;2ï¸âƒ£. å®‰è£…è¯­è¨€æœåŠ¡å™¨&lt;/p&gt;&lt;p&gt;æœ‰2ç§é€‰æ‹©&lt;/p&gt;&lt;ul&gt;&lt;li&gt;rlsï¼ˆrust language serverï¼‰å®‰è£…ç®€å•ï¼Œæˆç†Ÿ&lt;/li&gt;&lt;li&gt;rust-analyzerï¼ˆå®˜æ–¹ç»´æŠ¤çš„rls 2.0ï¼‰å®‰è£…ä¼šå¤šå‡ ä¸ªæ­¥éª¤ï¼ŒåŠŸèƒ½å…ˆè¿›ï¼Œä½†è¿˜ä¸å¤Ÿæˆç†Ÿ&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;å¯ä»¥å‚è€ƒ&lt;/p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/76599587&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic2.zhimg.com/v2-f359cb0dd4e941463157dee22e3b1029_180x120.jpg&quot; data-image-width=&quot;2880&quot; data-image-height=&quot;1800&quot; class=&quot;internal&quot;&gt;PrivateRookieï¼šVSCode ä½¿ç”¨ rust-analyzer&lt;/a&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//cloud.tencent.com/developer/news/579920&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Rust Analyzerï¼šä¸€æ¬¾æ—¨åœ¨å¸¦æ¥ä¼˜ç§€IDEä½“éªŒçš„ç¼–è¯‘å™¨&lt;/a&gt;&lt;p&gt;&lt;b&gt;ï¼ˆä¸€ï¼‰è·¯çº¿ï¼šrls&lt;/b&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;b&gt;å®‰è£…rls&lt;/b&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;å®‰è£…è¯­è¨€æœåŠ¡å™¨ï¼Œæ‰§è¡Œ&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;rustup component add rls rust-analysis 

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;2.å®‰è£…Rust(rls)æ’ä»¶&lt;/b&gt;&lt;/p&gt;&lt;p&gt;ç‚¹å‡»ä¸‹é¢çš„é“¾æ¥ï¼Œæ‰“å¼€ç½‘é¡µåç‚¹å‡»installæŒ‰é’®ï¼Œè¿™ä¼šæ‰“å¼€vscodeï¼Œç„¶åinstallå³å¯&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//marketplace.visualstudio.com/items%3FitemName%3Drust-lang.rust&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;marketplace.visualstudio.com&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;/items?itemName=rust-lang.rust&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;p&gt;&lt;b&gt;ï¼ˆäºŒï¼‰è·¯çº¿ï¼šrust-analyzer&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;1. å®‰è£…node.js&lt;/b&gt;&lt;/p&gt;&lt;p&gt;åç»­çš„rust-analyzeréœ€è¦å®‰è£…node.jsï¼Œä¸‹è½½åœ°å€ï¼š&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//nodejs.org/dist/v12.16.0/node-v12.16.0-x64.msi&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;nodejs.org/dist/v12.16.&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;0/node-v12.16.0-x64.msi&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;p&gt;&lt;b&gt;2. ä¸‹è½½rust-analyzer&lt;/b&gt;&lt;/p&gt;&lt;p&gt;ç‚¹å‡»é“¾æ¥ä¸‹è½½è¯­è¨€æœåŠ¡å™¨rust-analyzer-windows.exe&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/rust-analyzer/rust-analyzer/releases&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;rust-analyzer release&lt;/a&gt;&lt;p&gt;ä¸‹è½½é€Ÿåº¦æ…¢çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨2020å¹´2æœˆ17æ—¥çš„ç‰ˆæœ¬ï¼ˆä½¿ç”¨ç™¾åº¦ç½‘ç›˜ä¸‹è½½ï¼‰ï¼Œç„¶åå†æ…¢æ…¢ä¸‹è½½æ–°ç‰ˆæœ¬&lt;/p&gt;&lt;p&gt;é“¾æ¥: &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pan.baidu.com/s/1jY0qhtxu0lSrerdpCSdDiw&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;pan.baidu.com/s/1jY0qht&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;xu0lSrerdpCSdDiw&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt; æå–ç : v3py&lt;/p&gt;&lt;blockquote&gt;å®‰è£…å’Œä½¿ç”¨è¯´æ˜è¿˜å¯ä»¥å‚è€ƒï¼ˆæ¨èå®Œæ•´å®Œæˆåè§‚çœ‹ï¼Œæœ‰å¾ˆå¤šæœ‰ç”¨çš„åŠŸèƒ½ï¼Œæ–‡æœ«ä¹Ÿæœ‰é“¾æ¥ï¼‰ï¼š &lt;br/&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/rust-analyzer/rust-analyzer/blob/master/docs/user/features.md&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;github.com/rust-analyze&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;r/rust-analyzer/blob/master/docs/user/features.md&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;br/&gt; &lt;a href=&quot;https://zhuanlan.zhihu.com/p/76599587&quot; class=&quot;internal&quot;&gt;PrivateRookieï¼šVSCode ä½¿ç”¨ rust-analyzer&lt;/a&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;b&gt;3. å®‰è£…&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/rust-analyzer/rust-analyzer/releases&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;rust-analyzer&lt;/a&gt;æ’ä»¶&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;a. ç§»åŠ¨ rust-analyzer-windows.exe&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;æŠŠå‰é¢ä¸‹è½½çš„rust-analyzer-windows.exeæ”¾åˆ°&amp;#34;C:/Users/ä½ çš„ç”¨æˆ·å/.cargo/bin/æ–‡ä»¶å¤¹ä¸‹ï¼ˆæ³¨æ„ï¼šæ›¿æ¢ä½ çš„ç”¨æˆ·åã€‚ï¼‰&lt;/p&gt;&lt;ul&gt;&lt;li&gt;b. å®‰è£…rust-analyzeræ’ä»¶&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;ç‚¹å‡»ä¸‹é¢çš„é“¾æ¥ï¼Œæ‰“å¼€ç½‘é¡µåç‚¹å‡»installæŒ‰é’®ï¼Œè¿™ä¼šæ‰“å¼€vscodeï¼Œç„¶åinstallå³å¯&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//marketplace.visualstudio.com/items%3FitemName%3Dmatklad.rust-analyzer&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic3.zhimg.com/v2-dab5bad492793d84fe0440ae1828eba2_ipico.jpg&quot; data-image-width=&quot;600&quot; data-image-height=&quot;600&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;rust-analyzer - Visual Studio Marketplace&lt;/a&gt;&lt;p&gt;å®‰è£…åå‡ºç°ï¼šæ²¡æœ‰æ‰¾åˆ°è¯­è¨€æœåŠ¡å™¨ï¼Œæ˜¯å¦ä¸‹è½½ï¼Ÿç‚¹å‡»Cancelï¼ˆä¸‹ä¸€æ­¥æ‰‹åŠ¨è®¾ç½®ï¼‰&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-c6443b16e99fa5932c77ff330645a702_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;448&quot; data-rawheight=&quot;106&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;448&quot; data-original=&quot;https://pic3.zhimg.com/v2-c6443b16e99fa5932c77ff330645a702_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-c6443b16e99fa5932c77ff330645a702_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;448&quot; data-rawheight=&quot;106&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;448&quot; data-original=&quot;https://pic3.zhimg.com/v2-c6443b16e99fa5932c77ff330645a702_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-c6443b16e99fa5932c77ff330645a702_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;ul&gt;&lt;li&gt;c. æ’ä»¶è®¾ç½®è¯­è¨€æœåŠ¡å™¨è·¯å¾„&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;vscodeä¸­æŒ‰ä¸‹F1ï¼Œè¾“å…¥open settingsï¼Œé€‰æ‹©å›¾ä¸­æ— Defaultå­—æ ·çš„&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-4ace4905c2a4b351e6c50a6190e3ff81_b.png&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;606&quot; data-rawheight=&quot;93&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;606&quot; data-original=&quot;https://pic2.zhimg.com/v2-4ace4905c2a4b351e6c50a6190e3ff81_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-4ace4905c2a4b351e6c50a6190e3ff81_b.png&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;606&quot; data-rawheight=&quot;93&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;606&quot; data-original=&quot;https://pic2.zhimg.com/v2-4ace4905c2a4b351e6c50a6190e3ff81_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-4ace4905c2a4b351e6c50a6190e3ff81_b.png&quot;/&gt;&lt;/figure&gt;&lt;p&gt;åœ¨setting.jsonæœ€åä¸€è¡Œæ·»åŠ è¯­è¨€æœåŠ¡å™¨çš„è·¯å¾„ï¼Œæ³¨æ„æ›¿æ¢[ä½ çš„ç”¨æˆ·å]&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-9e566f295a2fabb5b8a7c6c357ae17c3_b.png&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;704&quot; data-rawheight=&quot;46&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;704&quot; data-original=&quot;https://pic4.zhimg.com/v2-9e566f295a2fabb5b8a7c6c357ae17c3_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-9e566f295a2fabb5b8a7c6c357ae17c3_b.png&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;704&quot; data-rawheight=&quot;46&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;704&quot; data-original=&quot;https://pic4.zhimg.com/v2-9e566f295a2fabb5b8a7c6c357ae17c3_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-9e566f295a2fabb5b8a7c6c357ae17c3_b.png&quot;/&gt;&lt;/figure&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-json&quot;&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;rust-analyzer.serverPath&amp;#34;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;C:/Users/ä½ çš„ç”¨æˆ·å/.cargo/bin/rust-analyzer-windows.exe&amp;#34;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;,&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;3ï¸âƒ£. å®‰è£…TabNineæ’ä»¶(rlså’Œrust-analyzeréƒ½æ¨èå®‰è£…)&lt;/b&gt;&lt;/p&gt;&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªäººå·¥æ™ºèƒ½è¡¥å…¨å·¥å…·ï¼ŒåŠŸèƒ½éå¸¸å¼ºå¤§&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//marketplace.visualstudio.com/items%3FitemName%3DTabNine.tabnine-vscode&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic2.zhimg.com/v2-72fb9fafaecc159d816e9d0c2d22067d_ipico.jpg&quot; data-image-width=&quot;256&quot; data-image-height=&quot;256&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TabNine - Visual Studio Marketplace&lt;/a&gt;&lt;p&gt;åé¢å››.2éƒ¨åˆ†ä¼šè®²åˆ°å¦‚ä½•æ¿€æ´»Rustçš„äººå·¥æ™ºèƒ½è¡¥å…¨ã€‚ &lt;/p&gt;&lt;hr/&gt;&lt;h2&gt;ä¸‰ã€å®‰è£…è°ƒè¯•å·¥å…·å’Œæ’ä»¶&lt;/h2&gt;&lt;blockquote&gt;å¦‚æœä½ ä¸è¿›è¡Œæ–­ç‚¹è°ƒè¯•ï¼Œè¿™ä¸¤ç±»å·¥å…·å’Œæ’ä»¶æ˜¯ä¸éœ€è¦å®‰è£…çš„ã€‚å¯ä»¥ç•¥è¿‡ç¬¬ä¸‰éƒ¨åˆ†å’Œç¬¬å››éƒ¨åˆ†çš„3, 4ä¸¤å°èŠ‚ã€‚&lt;br/&gt;åé¢å››.5éƒ¨åˆ†è®²äº†ä¸ä½¿ç”¨æ–­ç‚¹è°ƒè¯•ï¼Œè€Œæ˜¯è®¾ç½®F5ä¸€é”®è¿è¡Œcargo runå‘½ä»¤ã€‚&lt;/blockquote&gt;&lt;ol&gt;&lt;li&gt;&lt;i&gt;gnuè°ƒè¯•å·¥å…·å’Œæ’ä»¶&lt;/i&gt;&lt;/li&gt;&lt;li&gt;&lt;i&gt;msvcè°ƒè¯•å·¥å…·å’Œæ’ä»¶&lt;/i&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;æ ¹æ®å®‰è£…rustæ—¶çš„é€‰é¡¹ï¼Œgnuå’Œmsvcå·¥å…·é“¾äºŒé€‰ä¸€ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;ï¼ˆä¸€ï¼‰è·¯çº¿ï¼šgnuå·¥å…·é“¾&lt;/b&gt;&lt;/p&gt;&lt;p&gt;è¿™é‡Œæˆ‘ä»¬é€‰æ‹©ç®€å•çš„mingw-w64ï¼Œè¿˜å¯ä»¥é€‰æ‹©&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//www.msys2.org/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;msys2&lt;/a&gt;ç­‰ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;1. å®‰è£…MinGW-w64&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;ä¸‹è½½MinGW-w64&lt;/li&gt;&lt;/ul&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//nchc.dl.sourceforge.net/project/mingw-w64/Toolchains%2520targetting%2520Win32/Personal%2520Builds/mingw-builds/installer/mingw-w64-install.exe&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;ç‚¹å‡»ä¸‹è½½MinGW-w64&lt;/a&gt;&lt;ul&gt;&lt;li&gt;è®¾ç½®é€‰é¡¹ï¼ˆ64ä½ï¼‰&lt;/li&gt;&lt;/ul&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-ea07d041f23aff95cfe385bdcc5888f3_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;267&quot; data-rawheight=&quot;125&quot; class=&quot;content_image&quot; width=&quot;267&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-ea07d041f23aff95cfe385bdcc5888f3_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;267&quot; data-rawheight=&quot;125&quot; class=&quot;content_image lazy&quot; width=&quot;267&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-ea07d041f23aff95cfe385bdcc5888f3_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;ul&gt;&lt;li&gt;å®‰è£…å¹¶è®¾ç½®ç¯å¢ƒå˜é‡ï¼ˆï¼è¯·ä½¿ç”¨é»˜è®¤è·¯å¾„å®‰è£…ï¼Œå¦åˆ™è¯·æ‰‹åŠ¨è®¾ç½®ç¯å¢ƒå˜é‡ï¼‰&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;ä½¿ç”¨powershellè®¾ç½®ç¯å¢ƒå˜é‡&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$path&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;[environment]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;GetEnvironmentvariable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Path&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;User&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$mingw_path&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$env:programfiles&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mingw-w64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;\*\&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mingw64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bin&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$mingw_path&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$mingw_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$path&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$mingw_path&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;;&amp;#34;&lt;/span&gt;
&lt;span class=&quot;no&quot;&gt;[environment]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SetEnvironmentvariable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Path&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;User&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;blockquote&gt;æˆ‘ä»¬è¦ç”¨çš„æ˜¯MinGW-w64ä¸­çš„gdbè°ƒè¯•å·¥å…·&lt;br/&gt;&lt;b&gt;32ä½&lt;/b&gt;æˆ–è¯¦ç»†è®¾ç½®è¯·å‚è€ƒæ­¤æ–‡ï¼š&lt;a href=&quot;https://zhuanlan.zhihu.com/p/76613134&quot; class=&quot;internal&quot;&gt;Cè¯­è¨€å…³æ³¨ï¼šMinGW-w64å®‰è£…æ•™ç¨‹â€”â€”è‘—åC/C++ç¼–è¯‘å™¨GCCçš„Windowsç‰ˆæœ¬&lt;/a&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;b&gt;2. å®‰è£…æ’ä»¶Native Debugï¼ˆgnuå·¥å…·é“¾ï¼‰&lt;/b&gt;&lt;/p&gt;&lt;p&gt;å®‰è£…æ­¥éª¤åŒrust-analyzeræ’ä»¶&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//marketplace.visualstudio.com/items%3FitemName%3Dwebfreak.debug&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;marketplace.visualstudio.com&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;/items?itemName=webfreak.debug&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;p&gt;&lt;b&gt;ï¼ˆäºŒï¼‰è·¯çº¿ï¼šmsvcå·¥å…·é“¾&lt;/b&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;b&gt;ä¸‹è½½å®‰è£…Visual Studio 2019 ç”Ÿæˆå·¥å…·ï¼ˆbuild toolsï¼‰&lt;/b&gt;&lt;/li&gt;&lt;/ol&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//visualstudio.microsoft.com/thank-you-downloading-visual-studio/%3Fsku%3DBuildTools%26rel%3D16&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Thank you for downloading Visual Studio - Visual Studio&lt;/a&gt;&lt;p&gt;è¿è¡Œåï¼Œé€‰æ‹©c++ ç”Ÿæˆå·¥å…·ï¼Œå®‰è£…å³å¯&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-bcb5e77c7e4c973b0c74ad6f865677bd_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;423&quot; data-rawheight=&quot;182&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;423&quot; data-original=&quot;https://pic2.zhimg.com/v2-bcb5e77c7e4c973b0c74ad6f865677bd_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-bcb5e77c7e4c973b0c74ad6f865677bd_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;423&quot; data-rawheight=&quot;182&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;423&quot; data-original=&quot;https://pic2.zhimg.com/v2-bcb5e77c7e4c973b0c74ad6f865677bd_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-bcb5e77c7e4c973b0c74ad6f865677bd_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;å¦‚æœä½ å·²ç»å®‰è£…äº†Visual Studioï¼Œå°±æ— éœ€å®‰è£…build toolsï¼Œ&lt;/p&gt;&lt;p&gt;ç›´æ¥åœ¨å·¥å…·â€”â€”è·å–å·¥å…·å’ŒåŠŸèƒ½ä¸­ï¼Œå‹¾é€‰c++æ¡Œé¢å¼€å‘ï¼Œå®‰è£…å³å¯&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-d7e7f58cda2317537c2ca59f7da54192_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;418&quot; data-rawheight=&quot;100&quot; class=&quot;content_image&quot; width=&quot;418&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-d7e7f58cda2317537c2ca59f7da54192_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;418&quot; data-rawheight=&quot;100&quot; class=&quot;content_image lazy&quot; width=&quot;418&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-d7e7f58cda2317537c2ca59f7da54192_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;2. å®‰è£…æ’ä»¶C/C++&lt;/b&gt;&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//marketplace.visualstudio.com/items%3FitemName%3Dms-vscode.cpptools&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic2.zhimg.com/v2-6eb859650c118358e52746c25c4e603d_ipico.jpg&quot; data-image-width=&quot;128&quot; data-image-height=&quot;128&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;C/C++ - Visual Studio Marketplace&lt;/a&gt;&lt;hr/&gt;&lt;h2&gt;å››ã€å»ºç«‹é¡¹ç›®å¹¶è¿›è¡Œè°ƒè¯•è®¾ç½®&lt;/h2&gt;&lt;ol&gt;&lt;li&gt;&lt;i&gt;åˆ›å»ºé¡¹ç›®å¹¶æ‰“å¼€&lt;/i&gt;&lt;/li&gt;&lt;li&gt;&lt;i&gt;æ¿€æ´»TabNineå¯¹Rustçš„è¡¥å…¨&lt;/i&gt;&lt;/li&gt;&lt;li&gt;&lt;i&gt;è¿›è¡Œé¡¹ç›®çš„è°ƒè¯•è®¾ç½®ï¼ˆä½¿ç”¨æ–­ç‚¹è°ƒè¯•ï¼‰&lt;/i&gt;&lt;/li&gt;&lt;li&gt;&lt;i&gt;è¯•éªŒè°ƒè¯•åŠŸèƒ½ï¼ˆä½¿ç”¨æ–­ç‚¹è°ƒè¯•ï¼‰&lt;/i&gt;&lt;/li&gt;&lt;li&gt;F5ä¸€é”®è¿è¡Œ&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;b&gt;1 .åˆ›å»ºé¡¹ç›®å¹¶åœ¨VSCodeé‡Œæ‰“å¼€&lt;/b&gt;&lt;/p&gt;&lt;p&gt;æ¯”å¦‚hello_worldï¼Œä»¥æµ‹è¯•è°ƒè¯•åŠŸèƒ½&lt;/p&gt;&lt;ul&gt;&lt;li&gt;åœ¨vscodeä¸­æŒ‰ä¸‹ &lt;b&gt;Ctrl + ` &lt;/b&gt;ï¼ˆé”®ç›˜Tabä¸Šé¢çš„é”®ï¼‰æ‰“å¼€powershel&lt;/li&gt;&lt;li&gt;åˆ‡æ¢åˆ°ä½ æƒ³åˆ›å»ºé¡¹ç›®çš„ç›®å½•(æ¯”å¦‚D:)&lt;/li&gt;&lt;li&gt;ä½¿ç”¨cargoåˆ›å»ºé¡¹ç›®ï¼ˆå¦åˆ™vscodeä¼šæç¤ºç¼ºå°‘Cargo.tomlæ–‡ä»¶ï¼‰&lt;/li&gt;&lt;/ul&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot;&gt;&lt;span class=&quot;n&quot;&gt;cd&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;:&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;cargo&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hello_world&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;&lt;li&gt;ä½¿ç”¨Open FolderæŒ‰é’®æ‰“å¼€ä½ çš„hello_worldç›®å½•&lt;/li&gt;&lt;li&gt;å•å‡»åˆ—è¡¨ä¸­çš„main.rsæ–‡ä»¶ï¼Œæ‰“å¼€å®ƒ&lt;/li&gt;&lt;/ul&gt;&lt;a class=&quot;video-box&quot; href=&quot;https://link.zhihu.com/?target=https%3A//www.zhihu.com/video/1180629229510811648&quot; target=&quot;_blank&quot; data-video-id=&quot;&quot; data-video-playable=&quot;true&quot; data-name=&quot;ç¬¬1éƒ¨åˆ†æ“ä½œ&quot; data-poster=&quot;https://pic4.zhimg.com/v2-e1eb04cc80cd25bc83b83d54272c1f23.jpg&quot; data-lens-id=&quot;1180629229510811648&quot;&gt;&lt;img class=&quot;thumbnail&quot; src=&quot;https://pic4.zhimg.com/v2-e1eb04cc80cd25bc83b83d54272c1f23.jpg&quot;/&gt;&lt;span class=&quot;content&quot;&gt;&lt;span class=&quot;title&quot;&gt;ç¬¬1éƒ¨åˆ†æ“ä½œ&lt;span class=&quot;z-ico-extern-gray&quot;&gt;&lt;/span&gt;&lt;span class=&quot;z-ico-extern-blue&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;url&quot;&gt;&lt;span class=&quot;z-ico-video&quot;&gt;&lt;/span&gt;https://www.zhihu.com/video/1180629229510811648&lt;/span&gt;&lt;/span&gt;&lt;/a&gt;&lt;p&gt;&lt;b&gt;2. æ¿€æ´»TabNineå¯¹Rustçš„è¡¥å…¨&lt;/b&gt;&lt;/p&gt;&lt;p&gt;TabNineçš„äººå·¥æ™ºèƒ½è¡¥å…¨ï¼Œéœ€è¦åœ¨ç›¸åº”ç¼–ç¨‹è¯­è¨€çš„æ–‡ä»¶é‡Œç¼–è¾‘æ¨¡å¼ä¸‹è¾“å…¥TabNine::semæ‰“å¼€&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-3dada63553431da1b9336fda78efa617_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;826&quot; data-rawheight=&quot;212&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;826&quot; data-original=&quot;https://pic4.zhimg.com/v2-3dada63553431da1b9336fda78efa617_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-3dada63553431da1b9336fda78efa617_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;826&quot; data-rawheight=&quot;212&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;826&quot; data-original=&quot;https://pic4.zhimg.com/v2-3dada63553431da1b9336fda78efa617_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-3dada63553431da1b9336fda78efa617_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;è¿™æ ·.rsä¸­æ–‡ä»¶è¾“å…¥åï¼Œä¼šæ‰“å¼€Rustçš„äººå·¥æ™ºèƒ½è¡¥å…¨&lt;/p&gt;&lt;p&gt;å¦‚æœå½±å“æ€§èƒ½ï¼Œå¯ä»¥è¾“å…¥TabNine::nosemå…³é—­&lt;/p&gt;&lt;blockquote&gt;å¦‚æœä½ ä½¿ç”¨çš„æ˜¯rust-analyzerï¼ŒTabNineè¿˜ä¼šè‡ªåŠ¨å®‰è£…rlså’Œracerç­‰ &lt;/blockquote&gt;&lt;p&gt;&lt;b&gt;3. è¿›è¡Œé¡¹ç›®çš„è°ƒè¯•è®¾ç½®&lt;/b&gt;&lt;i&gt;ï¼ˆä½¿ç”¨æ–­ç‚¹è°ƒè¯•ï¼‰&lt;/i&gt;&lt;b&gt;ï¼š&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;æ‰“å¼€è°ƒè¯•çª—å£ï¼ˆå·¦ä¾§æ˜†è™«å›¾æ ‡ï¼‰&lt;/li&gt;&lt;li&gt;ç‚¹å‡»è®¾ç½®å›¾æ ‡ï¼ˆé½¿è½®ï¼‰&lt;/li&gt;&lt;li&gt;é€‰æ‹©å¼¹å‡ºçš„GDBï¼ˆmsvcä¸ºï¼‰&lt;/li&gt;&lt;li&gt;ä¿®æ”¹&lt;b&gt;launch.json&lt;/b&gt;ä¸­çš„&lt;i&gt;target&lt;/i&gt;é¡¹ï¼ˆmsvcä¸ºprogramé¡¹ï¼‰ï¼Œå¹¶æ·»åŠ  &lt;i&gt;preLaunchTaské¡¹&lt;/i&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;a. è·¯çº¿ï¼šgnu&lt;/p&gt;&lt;ul&gt;&lt;li&gt;é€‰æ‹©å¼¹å‡ºçš„GDB&lt;/li&gt;&lt;li&gt;ä¿®æ”¹&lt;b&gt;launch.json&lt;/b&gt;ä¸­çš„&lt;i&gt;target&lt;/i&gt;é¡¹ï¼Œå¹¶æ·»åŠ  &lt;i&gt;preLaunchTaské¡¹&lt;/i&gt;&lt;/li&gt;&lt;/ul&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-json&quot;&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;target&amp;#34;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;./target/debug/${workspaceFolderBasename}.exe&amp;#34;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;,&lt;/span&gt; 
&lt;span class=&quot;s2&quot;&gt;&amp;#34;preLaunchTask&amp;#34;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;build&amp;#34;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;,&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;b. è·¯çº¿ï¼šmsvc&lt;/p&gt;&lt;ul&gt;&lt;li&gt;é€‰æ‹©å¼¹å‡ºçš„c++ windows&lt;/li&gt;&lt;li&gt;ä¿®æ”¹&lt;b&gt;launch.json&lt;/b&gt;ä¸­çš„&lt;i&gt;program&lt;/i&gt;é¡¹ï¼Œå¹¶æ·»åŠ  &lt;i&gt;preLaunchTaské¡¹&lt;/i&gt;&lt;br/&gt;&lt;/li&gt;&lt;/ul&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-json&quot;&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;program&amp;#34;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;./target/debug/${workspaceFolderBasename}.exe&amp;#34;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;,&lt;/span&gt; 
&lt;span class=&quot;s2&quot;&gt;&amp;#34;preLaunchTask&amp;#34;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;build&amp;#34;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;,&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¸¤ç§è·¯çº¿éƒ½éœ€è¦VSCodeè‡ªåŠ¨ç”Ÿæˆtasks.json(é€‰æ‹©ä»templateç”Ÿæˆâ€”&amp;gt;others)&lt;/p&gt;&lt;ul&gt;&lt;li&gt;ä¿®æ”¹&lt;b&gt;tasks.json&lt;/b&gt;ä¸­çš„&lt;i&gt;label&lt;/i&gt;é¡¹å’Œcommandé¡¹ä¸º&lt;/li&gt;&lt;/ul&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-json&quot;&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;label&amp;#34;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;build&amp;#34;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&amp;#34;command&amp;#34;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;cargo build&amp;#34;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;,&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;a class=&quot;video-box&quot; href=&quot;https://link.zhihu.com/?target=https%3A//www.zhihu.com/video/1180776456249159680&quot; target=&quot;_blank&quot; data-video-id=&quot;&quot; data-video-playable=&quot;true&quot; data-name=&quot;ç¬¬2éƒ¨åˆ†æ“ä½œ&quot; data-poster=&quot;https://pic3.zhimg.com/v2-4b4a6c5889c37303d48728502863f06a.jpg&quot; data-lens-id=&quot;1180776456249159680&quot;&gt;&lt;img class=&quot;thumbnail&quot; src=&quot;https://pic3.zhimg.com/v2-4b4a6c5889c37303d48728502863f06a.jpg&quot;/&gt;&lt;span class=&quot;content&quot;&gt;&lt;span class=&quot;title&quot;&gt;ç¬¬2éƒ¨åˆ†æ“ä½œ&lt;span class=&quot;z-ico-extern-gray&quot;&gt;&lt;/span&gt;&lt;span class=&quot;z-ico-extern-blue&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;url&quot;&gt;&lt;span class=&quot;z-ico-video&quot;&gt;&lt;/span&gt;https://www.zhihu.com/video/1180776456249159680&lt;/span&gt;&lt;/span&gt;&lt;/a&gt;&lt;p&gt;&lt;b&gt;4. ä¿®æ”¹main.rsçš„å†…å®¹ï¼Œå¹¶åœ¨æ¯è¡Œå‰ç‚¹å‡»å‡ºçº¢ç‚¹ï¼ˆæ–­ç‚¹ï¼‰ï¼Œä»¥æ–¹ä¾¿è§‚å¯Ÿè°ƒè¯•åŠŸèƒ½&lt;/b&gt;&lt;i&gt;ï¼ˆä½¿ç”¨æ–­ç‚¹è°ƒè¯•ï¼‰&lt;/i&gt;&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-rust&quot;&gt;&lt;span class=&quot;k&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;Hello, world!&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;a class=&quot;video-box&quot; href=&quot;https://link.zhihu.com/?target=https%3A//www.zhihu.com/video/1180631885650321408&quot; target=&quot;_blank&quot; data-video-id=&quot;&quot; data-video-playable=&quot;true&quot; data-name=&quot;ç¬¬3éƒ¨åˆ†æ“ä½œ&quot; data-poster=&quot;https://pic2.zhimg.com/v2-d30a0a751ba9f8035d0fe3b5afe2ce15.jpg&quot; data-lens-id=&quot;1180631885650321408&quot;&gt;&lt;img class=&quot;thumbnail&quot; src=&quot;https://pic2.zhimg.com/v2-d30a0a751ba9f8035d0fe3b5afe2ce15.jpg&quot;/&gt;&lt;span class=&quot;content&quot;&gt;&lt;span class=&quot;title&quot;&gt;ç¬¬3éƒ¨åˆ†æ“ä½œ&lt;span class=&quot;z-ico-extern-gray&quot;&gt;&lt;/span&gt;&lt;span class=&quot;z-ico-extern-blue&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;url&quot;&gt;&lt;span class=&quot;z-ico-video&quot;&gt;&lt;/span&gt;https://www.zhihu.com/video/1180631885650321408&lt;/span&gt;&lt;/span&gt;&lt;/a&gt;&lt;blockquote&gt;Tipï¼šVSCodeè°ƒè¯•æ—¶ï¼ŒæŠŠé¼ æ ‡æŒªåŠ¨åˆ°å˜é‡ä¸Šé¢ï¼Œå¯ä»¥æ˜¾ç¤ºå½“å‰å˜é‡å€¼ã€‚&lt;br/&gt;&lt;br/&gt;æƒ³è¦ä¸ç¼–è¯‘ç›´æ¥è¿è¡Œæ—¶ï¼Œåœ¨å½“å‰ç›®å½•ä¸‹ä¸­è¿è¡Œ&lt;code&gt;cargo run&lt;/code&gt;å‘½ä»¤å³å¯&lt;br/&gt;å¯ä»¥ä½¿ç”¨rustçš„gdb_rust_pretty_printingï¼Œåœ¨è°ƒè¯•ä¸­enums, slices, vectorsç­‰ç»“æ„ä¼šæ›´å¥½åœ°æ˜¾ç¤ºï¼Œä½†ä¹Ÿæœ‰äººè§‰å¾—åœ¨windowsä¸Šä½¿ç”¨è¿™ä¸ªåŠŸèƒ½ä¸å¥½ï¼Œæœ‰æ—¶ä¼šå¯¼è‡´é•¿æ—¶é—´çš„æš‚åœæˆ–å¡æ­»å…·ä½“å‚è€ƒ&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//stackoverflow.com/questions/33570021/how-to-set-up-gdb-for-debugging-rust-programs-in-windows&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;how-to-set-up-gdb-for-debugging-rust-programs-in-windows&lt;/a&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;b&gt;5. F5ä¸€é”®è¿è¡Œ&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;å¦‚æœä½ æ„Ÿè§‰æ¯æ¬¡éƒ½å»ç‚¹åˆ‡æ¢debugçª—å£æ¯”è¾ƒéº»çƒ¦ï¼Œè€Œä¸”ä¹Ÿæš‚æ—¶ä¸éœ€è¦æ–­ç‚¹è°ƒè¯•ã€‚&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;å¦‚æœä½ è¿˜æ²¡æœ‰tasks.jsonæ–‡ä»¶ï¼Œè¯·åœ¨é¡¹ç›®æ ¹ç›®å½•ï¼ˆå›¾ä¸­ä¸ºhelloï¼‰ä¸‹æ–°å»º.vscodeæ–‡ä»¶å¤¹ï¼Œå†åˆ›å»ºtasks.jsonæ–‡ä»¶ï¼Œé¡¹ç›®ç»“æ„ç±»ä¼¼ä¸‹å›¾ã€‚&lt;/b&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-c4a1dd9a6ff35e19dc989e7cff647a01_b.png&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;176&quot; data-rawheight=&quot;167&quot; class=&quot;content_image&quot; width=&quot;176&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-c4a1dd9a6ff35e19dc989e7cff647a01_b.png&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;176&quot; data-rawheight=&quot;167&quot; class=&quot;content_image lazy&quot; width=&quot;176&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-c4a1dd9a6ff35e19dc989e7cff647a01_b.png&quot;/&gt;&lt;/figure&gt;&lt;p&gt;ä¿®æ”¹tasks.jsonå†…å®¹ä¸ºï¼ˆä¹Ÿå¯ä»¥æœ‰å¤šä¸ªtaskï¼Œè¿è¡Œæ—¶æ ¹æ®labelï¼ˆæ ‡ç­¾ï¼‰è¿›è¡ŒåŒºåˆ†ï¼‰&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-json&quot;&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
 &lt;span class=&quot;err&quot;&gt;//&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;See&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;https://go.microsoft.com/fwlink/?LinkId=733558&lt;/span&gt;
 &lt;span class=&quot;err&quot;&gt;//&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;the&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;documentation&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;about&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;the&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;tasks.json&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;format&lt;/span&gt;
 &lt;span class=&quot;nt&quot;&gt;&amp;#34;version&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;2.0.0&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
 &lt;span class=&quot;nt&quot;&gt;&amp;#34;tasks&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
 &lt;span class=&quot;nt&quot;&gt;&amp;#34;label&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;run&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
 &lt;span class=&quot;nt&quot;&gt;&amp;#34;command&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;cargo run&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
 &lt;span class=&quot;nt&quot;&gt;&amp;#34;type&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;shell&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ‰“å¼€å¿«æ·é”®è®¾ç½®ï¼ˆKeyboard Shortcutsï¼‰&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-32f43bf3ff6cb1d93f854de413cf8762_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;308&quot; data-rawheight=&quot;355&quot; class=&quot;content_image&quot; width=&quot;308&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-32f43bf3ff6cb1d93f854de413cf8762_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;308&quot; data-rawheight=&quot;355&quot; class=&quot;content_image lazy&quot; width=&quot;308&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-32f43bf3ff6cb1d93f854de413cf8762_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;è¾“å…¥taskï¼Œå‡ºç°ä¸‹å›¾&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-052f713565e5b4db74ad6cb28eef4b2b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;698&quot; data-rawheight=&quot;558&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;698&quot; data-original=&quot;https://pic4.zhimg.com/v2-052f713565e5b4db74ad6cb28eef4b2b_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-052f713565e5b4db74ad6cb28eef4b2b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;698&quot; data-rawheight=&quot;558&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;698&quot; data-original=&quot;https://pic4.zhimg.com/v2-052f713565e5b4db74ad6cb28eef4b2b_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-052f713565e5b4db74ad6cb28eef4b2b_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;æ‰¾åˆ°å›¾ä¸­çš„Tasks:Rerun Last Taskï¼Œç»™å®ƒè®¾ç½®å¿«æ·é”®F5ã€‚å…·ä½“æ–¹æ³•æ˜¯åŒå‡»è¯¥æ¡ç›®ï¼Œå‡ºç°æç¤ºæ¡†åæŒ‰ä¸‹F5ï¼Œç„¶åå†æŒ‰å›è½¦ã€‚&lt;/p&gt;&lt;p&gt;åœ¨è¯¥æ¡ç›®ä¸Šç‚¹å³é”®ï¼Œé€‰æ‹©Change When Expression&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-fab4d1a7d02c201bcea89eb4fec473f5_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1031&quot; data-rawheight=&quot;272&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1031&quot; data-original=&quot;https://pic2.zhimg.com/v2-fab4d1a7d02c201bcea89eb4fec473f5_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-fab4d1a7d02c201bcea89eb4fec473f5_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1031&quot; data-rawheight=&quot;272&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1031&quot; data-original=&quot;https://pic2.zhimg.com/v2-fab4d1a7d02c201bcea89eb4fec473f5_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-fab4d1a7d02c201bcea89eb4fec473f5_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;å¤åˆ¶ç²˜è´´editorTextFocus &amp;amp;&amp;amp; editorLangId == &amp;#39;rust&amp;#39;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-d146b78f77d2a2f73f1d980416f309b5_b.png&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1083&quot; data-rawheight=&quot;63&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1083&quot; data-original=&quot;https://pic2.zhimg.com/v2-d146b78f77d2a2f73f1d980416f309b5_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-d146b78f77d2a2f73f1d980416f309b5_b.png&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1083&quot; data-rawheight=&quot;63&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1083&quot; data-original=&quot;https://pic2.zhimg.com/v2-d146b78f77d2a2f73f1d980416f309b5_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-d146b78f77d2a2f73f1d980416f309b5_b.png&quot;/&gt;&lt;/figure&gt;&lt;p&gt;è¿™æ ·å°±åªæœ‰rustè¯­è¨€ä¸­æŒ‰ä¸‹F5æ‰æ˜¯è¿™ä¸ªåŠŸèƒ½ã€‚&lt;/p&gt;&lt;p&gt;æˆ‘ä»¬å†æ¥è¯´è¯´è¿™ä¸ªåŠŸèƒ½æ€ä¹ˆç”¨ã€‚æ‰“å¼€main.rsï¼Œç„¶åæŒ‰ä¸‹F5ï¼Œä¼šå‡ºç°runï¼ˆæˆ‘ä»¬å®šä¹‰çš„taskï¼‰+é¡¹ç›®åï¼Œå†æŒ‰ä¸¤ä¸‹å›è½¦é€‰æ‹©å°±è¡Œäº†ã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-e109aa763738aaedcfd2a7d5083524be_b.png&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1029&quot; data-rawheight=&quot;99&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1029&quot; data-original=&quot;https://pic3.zhimg.com/v2-e109aa763738aaedcfd2a7d5083524be_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-e109aa763738aaedcfd2a7d5083524be_b.png&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1029&quot; data-rawheight=&quot;99&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1029&quot; data-original=&quot;https://pic3.zhimg.com/v2-e109aa763738aaedcfd2a7d5083524be_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-e109aa763738aaedcfd2a7d5083524be_b.png&quot;/&gt;&lt;/figure&gt;&lt;p&gt;è¿™æ ·æ§åˆ¶å°ä¼šè‡ªåŠ¨è¿è¡Œcargo runè¿™ä¸ªå‘½ä»¤ï¼Œvscodeæ²¡æœ‰å…³é—­å‰ï¼Œä¸‹æ¬¡æŒ‰ä¸‹F5ä¼šç›´æ¥è¿è¡Œï¼Œä¸å†éœ€è¦å›è½¦é€‰æ‹©ã€‚&lt;/p&gt;&lt;p&gt;è¿™æ ·æˆ‘ä»¬èƒ½å¿«é€Ÿçš„è¿è¡Œè¯¥å‘½ä»¤æŸ¥çœ‹è¾“å‡ºï¼Œä¸éœ€è¦æ‰‹åŠ¨åˆ‡æ¢åˆ°debugç•Œé¢ã€‚&lt;/p&gt;&lt;blockquote&gt;å¦‚æœä½ å®‰è£…çš„æ˜¯rust-analyzerï¼Œå®ƒé™„å¸¦ä¸€ä¸ªå‘½ä»¤&lt;code&gt;rust-analyzer:run&lt;/code&gt;ï¼Œä¹Ÿå¯ä»¥åœ¨å‘½ä»¤é¢æ¿ï¼ˆCtrl+Shift + Pï¼‰è¿è¡Œæˆ–è€…è®¾ç½®å¿«æ·é”®ï¼š&lt;br/&gt;å®ƒä¼šæ˜¾ç¤ºæç¤ºçª—å£ï¼Œå¹¶è¿è¡Œå½“å‰ä½ç½®çš„äºŒè¿›åˆ¶æˆ–è€…æµ‹è¯•. åœ¨è¿è¡Œé‡å¤çš„å•ä¸ªæµ‹è¯•æ—¶éå¸¸æœ‰ç”¨ï¼Œè¯·æŠŠè¿™ä¸ªç»‘å®šåˆ°å¿«æ·é”®ï¼&lt;/blockquote&gt;&lt;hr/&gt;&lt;h2&gt;äº”ã€é™„å½•ï¼šrustlingsçš„ä½¿ç”¨(å¼ºçƒˆæ¨è)&lt;/h2&gt;&lt;ol&gt;&lt;li&gt;&lt;i&gt;å®‰è£…rustlings&lt;/i&gt;&lt;/li&gt;&lt;li&gt;&lt;i&gt;ä½¿ç”¨rustlings&lt;/i&gt;&lt;/li&gt;&lt;li&gt;&lt;i&gt;æ ¹æ®ç¼–è¯‘é”™è¯¯ä¿®æ”¹æ–‡ä»¶ä»¥é€šå…³&lt;/i&gt;&lt;/li&gt;&lt;li&gt;&lt;i&gt;æ€»ç»“ä¸Tip&lt;/i&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/rust-lang/rustlings&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;rustlings&lt;/a&gt;æ˜¯å®˜æ–¹çš„æ•™å­¦æ¸¸æˆï¼Œå®ƒçš„ç©æ³•ç±»ä¼¼è§£å¯†æ¸¸æˆã€‚é€šè¿‡è§£å†³ç¨‹åºä¸­çš„é”™è¯¯é€šè¿‡å…³å¡ã€‚&lt;/p&gt;&lt;p&gt;å®ƒä½œä¸ºå’Œæ–‡æ¡£ã€&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//rustwiki.org/zh-CN/rust-by-example/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;rust-by-example&lt;/a&gt;ä¸‰è¶³é¼åŠ›çš„æ–°æ‰‹å…¥é—¨æ•™ç¨‹ï¼Œç¡®å®è®©äººæ„Ÿè§‰åˆ°å¥½ç©ã€æƒŠè‰³ã€‚&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;b&gt;å®‰è£…rustlings&lt;/b&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;åœ¨powershellä¸­æ‰§è¡Œï¼Œé€‰æ‹©y&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;set-executionpolicy remotesigned

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ¥ç€æ‰§è¡Œï¼ˆæ³¨æ„cdåˆ°ä½ æƒ³æ”¾é¡¹ç›®çš„æ–‡ä»¶å¤¹ï¼‰&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot;&gt;&lt;span class=&quot;n&quot;&gt;cd&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$home&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;/.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rustup&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;/&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;Invoke-WebRequest&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;https&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;git&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;io&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rustlings-win&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Select-Object&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;-ExpandProperty&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Content&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Out-File&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$env:TMP&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;install_rustlings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ps1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Unblock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-File&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$env:TMP&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;install_rustlings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ps1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Invoke-Expression&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$env:TMP&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;install_rustlings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ps1&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¦‚æœå¤±è´¥çš„è¯ï¼Œè¯·æ‰‹åŠ¨ä¸‹è½½å®‰è£…&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot;&gt;&lt;span class=&quot;n&quot;&gt;git&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;clone&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;https&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;github&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rust-lang&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rustlings&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;cd&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rustlings&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;git&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;checkout&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tags&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# or whatever the latest version is (find out at https://github.com/rust-lang/rustlings/releases/latest)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;cargo&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;-force&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;-path&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¦‚æœæœ‰å®‰è£…é”™è¯¯ï¼Œç¡®ä¿å·¥å…·é“¾æ˜¯æœ€æ–°çš„:&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;rustup update

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;2. ä½¿ç”¨rustlings&lt;/b&gt;&lt;/p&gt;&lt;p&gt;éœ€è¦åœ¨rustlingsç›®å½•ä¸‹æ‰§è¡Œ&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;rustlings watch

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å»ºè®®åœ¨vscodeä¸­æ‰“å¼€è¿™ä¸ªæ–‡ä»¶å¤¹ï¼Œç„¶åæ¯æ¬¡åœ¨powershellä¸­è¿è¡Œã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-363b7c67f2b6e69a85b10dd5bcc35c8d_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;421&quot; data-rawheight=&quot;210&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;421&quot; data-original=&quot;https://pic2.zhimg.com/v2-363b7c67f2b6e69a85b10dd5bcc35c8d_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-363b7c67f2b6e69a85b10dd5bcc35c8d_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;421&quot; data-rawheight=&quot;210&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;421&quot; data-original=&quot;https://pic2.zhimg.com/v2-363b7c67f2b6e69a85b10dd5bcc35c8d_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-363b7c67f2b6e69a85b10dd5bcc35c8d_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;3. æ ¹æ®å¼¹å‡ºçš„ç¼–è¯‘é”™è¯¯ä¿®æ”¹exercisesä¸­çš„æ–‡ä»¶&lt;/b&gt;&lt;/p&gt;&lt;p&gt;rustlingsä¼šæ ¹æ®æ¦‚å¿µéš¾æ˜“çš„é¡ºåºé€ä¸ªç¼–è¯‘æ–‡ä»¶ï¼Œå½“ç¼–è¯‘é”™è¯¯çš„æ—¶å€™ï¼Œä½ éœ€è¦å»ä¿®æ­£è¯¥é”™è¯¯æ–‡ä»¶å¹¶ä¿å­˜ã€‚&lt;/p&gt;&lt;blockquote&gt;æ³¨æ„ï¼šä¸è¦å…³é—­rustlings watchè¿è¡Œçš„çª—å£ï¼Œå®ƒä¼šè‡ªåŠ¨æ£€æµ‹ä½ ä¿®æ”¹ä¿å­˜çš„æ–‡ä»¶&lt;/blockquote&gt;&lt;p&gt;ä¿®æ”¹å®Œæˆä¹‹åï¼Œå¦‚æœè¦è·³è‡³ä¸‹ä¸€å…³ï¼Œåˆ™éœ€è¦æŠŠå½“å‰å…³æ–‡ä»¶ä¸­çš„è¯¥è¡Œæ³¨é‡Šåˆ é™¤ä¿å­˜ã€‚&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-rust&quot;&gt;&lt;span class=&quot;c1&quot;&gt;//I AM NOT DONE
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;4. æµç¨‹æ€»ç»“ä¸Tip&lt;/b&gt;&lt;/p&gt;&lt;p&gt;æµç¨‹å°±æ˜¯ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;çœ‹æ–‡æ¡£&lt;/li&gt;&lt;li&gt;å†çœ‹example&lt;/li&gt;&lt;li&gt;å†åˆ·rustlingsé€šå…³&lt;/li&gt;&lt;/ul&gt;&lt;blockquote&gt;æ³¨æ„ï¼šåœ¨exercisesæ–‡ä»¶å¤¹çš„æ¯ä¸ªåˆ†ç±»ä¸­ï¼Œéƒ½æœ‰ä¸€ä¸ªREADMEï¼Œé‡Œé¢æœ‰å½“å‰åˆ†ç±»å¯¹åº”çš„&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//rustwiki.org/zh-CN/rust-by-example/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;rust-by-example&lt;/a&gt;çš„åœ°å€ï¼Œæ¨èå…ˆçœ‹å†åšé¢˜ã€‚&lt;br/&gt;Rustä¸­æ–‡æ–‡æ¡£åœ°å€ï¼š&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//120.78.128.153/rustbook/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Rust ç¨‹åºè®¾è®¡è¯­è¨€ ç®€ä½“ä¸­æ–‡ç‰ˆ&lt;/a&gt;&lt;br/&gt;æç¤ºï¼šå¼¹å‡ºç¼–è¯‘é”™è¯¯æ—¶ï¼Œåœ¨VSCodeä¸­æŒ‰ä½Ctrlç‚¹å‡»è¯¥æ–‡ä»¶åï¼Œä¼šç›´æ¥æ‰“å¼€è¯¥æ–‡ä»¶&lt;/blockquote&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-4d29bd12bec90e68a3ea28fee8f10cdc_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;615&quot; data-rawheight=&quot;115&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;615&quot; data-original=&quot;https://pic1.zhimg.com/v2-4d29bd12bec90e68a3ea28fee8f10cdc_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-4d29bd12bec90e68a3ea28fee8f10cdc_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;615&quot; data-rawheight=&quot;115&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;615&quot; data-original=&quot;https://pic1.zhimg.com/v2-4d29bd12bec90e68a3ea28fee8f10cdc_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-4d29bd12bec90e68a3ea28fee8f10cdc_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;å¦‚æœ‰é”™è¯¯ï¼Œè¯·ä¸åå‘ŠçŸ¥ï¼&lt;/b&gt;&lt;/h2&gt;&lt;h2&gt;&lt;b&gt;è§‰å¾—å¥½çš„è¯ï¼Œè¯·&lt;/b&gt;ç‚¹èµæ”¶è—&lt;b&gt;ï¼è®©çŸ¥ä¹å‘ˆç°æ›´å¤šä½ å–œæ¬¢çš„ä¸œè¥¿ã€‚&lt;/b&gt;&lt;/h2&gt;&lt;h2&gt;&lt;b&gt;å¦‚æœä½ æ˜¯åˆå­¦è€…çš„è¯ï¼Œå»ºè®®æŠŠæœ¬ç½‘é¡µæ·»åŠ åˆ°æµè§ˆå™¨ä¹¦ç­¾ï¼ˆCtrl+ Dï¼‰ï¼Œå¯ä»¥ç»å¸¸æµè§ˆä¸‹é¢çš„å¸¸ç”¨é“¾æ¥ã€‚&lt;/b&gt;&lt;/h2&gt;&lt;hr/&gt;&lt;h2&gt;å¸¸ç”¨é“¾æ¥ï¼š&lt;/h2&gt;&lt;p&gt;                             è‹±æ–‡æ–‡æ¡£ï¼š&lt;code&gt;rustup doc&lt;/code&gt; &lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//120.78.128.153/rustbook/&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Rust ç¨‹åºè®¾è®¡è¯­è¨€ ä¸­æ–‡ç‰ˆï¼ˆæ·±åœ³åŠ é€Ÿç«™ï¼‰&lt;/a&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//rustwiki.org/zh-CN/rust-by-example/&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Rust By Example ä¸­æ–‡ç‰ˆ&lt;/a&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//cargo.budshome.com/index.html&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Cargo - Cargo ä¸­æ–‡æ–‡æ¡£&lt;/a&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/rust-analyzer/rust-analyzer/blob/master/docs/user/features.md&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;rust-analyzer features&lt;/a&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/76599587&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic2.zhimg.com/v2-f359cb0dd4e941463157dee22e3b1029_180x120.jpg&quot; data-image-width=&quot;2880&quot; data-image-height=&quot;1800&quot; class=&quot;internal&quot;&gt;PrivateRookieï¼šVSCode ä½¿ç”¨ rust-analyzer&lt;/a&gt;&lt;h2&gt;å‚è€ƒæ–‡ç« ï¼š&lt;/h2&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/27910168&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic1.zhimg.com/v2-d5a4e7af5aad6e908d26c2c09a90ed68_180x120.jpg&quot; data-image-width=&quot;800&quot; data-image-height=&quot;425&quot; class=&quot;internal&quot;&gt;DCjanusï¼šã€æ–°æ‰‹å‘ã€‘ä»é›¶å¼€å§‹é…ç½®Windowsä¸‹Rustå¼€å‘ç¯å¢ƒå›¾è§£&lt;/a&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/27782375&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; class=&quot;internal&quot;&gt;CrLF0710ï¼šRust ç¯å¢ƒé…ç½®äº‹é¡¹ä¸€è§ˆ&lt;/a&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//www.cnblogs.com/kileyi/p/11367866.html&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic4.zhimg.com/v2-75446c6c352b21ac414abe074b014cab_180x120.jpg&quot; data-image-width=&quot;510&quot; data-image-height=&quot;400&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Win7 VSCode ç¦»çº¿å®‰è£…Rustè¯­è¨€åŠç¯å¢ƒé…ç½®&lt;/a&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/64344775&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; class=&quot;internal&quot;&gt;Matrixï¼šRustå’ŒWindowsä¸å¾—ä¸è¯´çš„äº‹å„¿&lt;/a&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>é›¾è‰²</author>
<guid isPermaLink="false">2020-02-27-92172591</guid>
<pubDate>Thu, 27 Feb 2020 00:00:00 +0800</pubDate>
</item>
<item>
<title>Rustä¸­çš„é›¶æˆæœ¬æŠ½è±¡ï¼ˆä¸€ï¼‰ï¼ˆè¯‘ï¼‰</title>
<link>https://henix.github.io/feeds/zhuanlan.rust-lang/2020-02-27-109517672.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/109517672&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;åŸæ–‡åœ°å€&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//boats.gitlab.io/blog/post/zero-cost-abstractions/&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Zero Cost Abstractions&lt;/a&gt;&lt;p&gt;é›¶æˆæœ¬æŠ½è±¡å¯¹äºC++å’ŒRustæ˜¯éå¸¸é‡è¦çš„ï¼Œå› ä¸ºå®ƒä»¬æƒ³è®©ç¨‹åºå‘˜ä»¥ç›¸å¯¹è¾ƒå°‘çš„åŠªåŠ›å°±èƒ½å†™å‡ºæœ‰ä¼˜ç§€æ€§èƒ½çš„ä»£ç ã€‚å› ä¸ºè¿™æ˜¯Rustè®¾è®¡åŠæˆ‘å·¥ä½œçš„åŸºç¡€ï¼Œæˆ‘æƒ³ä»‹ç»ä¸‹é›¶æˆæœ¬æŠ½è±¡æ˜¯ä»€ä¹ˆã€‚&lt;br/&gt;&lt;/p&gt;&lt;p&gt;é›¶æˆæœ¬æŠ½è±¡æ¥è‡ªC++ï¼Œç”±C++åˆ›å§‹äººBjarne Stroustrupå®šä¹‰ï¼š&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;é€šå¸¸ï¼ŒC++çš„å®ç°éµå¾ªé›¶å¼€é”€åŸåˆ™ï¼šä½ ä¸ä½¿ç”¨çš„ï¼Œä½ ä¸è´Ÿæ‹…æˆæœ¬ã€‚æ›´è¿›ä¸€æ­¥ï¼šä½ ä½¿ç”¨çš„ï¼Œä½ ä¹Ÿæ²¡æ³•æ›´ä¼˜åŒ–ã€‚&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;å®šä¹‰æœ‰ä¸¤ä¸ªå…³é”®ï¼š&lt;br/&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;æ²¡æœ‰æ•´ä½“å¼€é”€:&lt;/b&gt; é›¶æˆæœ¬æŠ½è±¡ä¸åº”è¯¥å¯¹ä¸ä½¿ç”¨çš„ç¨‹åºçš„äº§ç”Ÿå¼€é”€ã€‚æ¯”å¦‚ï¼Œå®ƒä¸èƒ½è¿è¡Œæ‰€æœ‰çš„ç¨‹åºã€è´Ÿæ‹…æ²‰é‡çš„è¿è¡Œæ—¶å¼€é”€ï¼Œå´ä»…ä»…åªä¸ºä½¿ç”¨å…¶ä¸­ä¸€äº›åŠŸèƒ½æ—¶å—ç›Šã€‚ï¼ˆè¯‘è€…æ³¨ï¼šæŠ½è±¡ä¸­çš„æ‰€æœ‰éƒ¨åˆ†éƒ½æ˜¯ä½ ä¼šç”¨åˆ°çš„ï¼Œä½ ç”¨ä¸åˆ°çš„å°±ä¸ä¼šåŒ…å«åœ¨è¿™ä¸ªæŠ½è±¡ä¸­ï¼‰&lt;/li&gt;&lt;li&gt;&lt;b&gt;ä¼˜åŒ–æ€§èƒ½:&lt;/b&gt; é›¶æˆæœ¬æŠ½è±¡ç¼–è¯‘çš„æœºå™¨ä»£ç ï¼Œåº”è¯¥æ˜¯æ‰‹å†™æ— æ³•è¶…è¶Šçš„ç‰ˆæœ¬ã€‚å®ƒä¸èƒ½å¼•å…¥æ­¤ç§æŠ½è±¡å¯ä»¥é¿å…çš„å¼€é”€ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;å¿…é¡»çŸ¥é“é›¶æˆæœ¬æŠ½è±¡æœ‰ç¬¬ä¸‰ä¸ªå…³é”®ã€‚ç„¶è€Œï¼Œå› ä¸ºå®ƒåŒæ ·æ˜¯æ‰€æœ‰å¥½æŠ½è±¡ï¼ˆæ— è®ºæ˜¯å¦é›¶æˆæœ¬ï¼‰çš„å…³é”®ï¼Œæ‰€ä»¥ç»å¸¸è¢«å¿½ç•¥ï¼š&lt;br/&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;æå‡ç¨‹åºå‘˜ä½“éªŒ:&lt;/b&gt; æŠ½è±¡ï¼Œæ˜¯ä¸ºäº†åŒ…è£…ä½å±‚ä»£ç ï¼Œä½¿ç¨‹åºå‘˜æ›´å®¹æ˜“åœ°å†™å‡ºä»–ä»¬æ‰€æƒ³ã€‚é›¶æˆæœ¬æŠ½è±¡ï¼ˆåŠæ‰€æœ‰çš„æŠ½è±¡ï¼‰å¿…é¡»æä¾›æ¯”ä»»ä½•æ›¿ä»£æŠ½è±¡æ›´å¥½çš„ä½“éªŒã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;è¿™3ä¸ªæ˜¯æ°¸è¿œä¹Ÿå®ç°ä¸äº†çš„ç†æƒ³è§‚å¿µï¼Œç‰¹åˆ«æ˜¯ç¬¬3ç‚¹ï¼Œä¸ä¸ªäººåå¥½æ²¡æœ‰å…³ç³»ã€‚ä½†æ˜¯å¯¹é›¶æˆæœ¬æŠ½è±¡ï¼Œç¬¬ä¸‰ç‚¹å®é™…ä¸Šç‰¹åˆ«é‡è¦ã€‚å› ä¸ºé›¶æˆæœ¬æŠ½è±¡é€šå¸¸è¦åœ¨è¿™ä¸‰ç‚¹ä¹‹é—´æƒè¡¡ã€‚&lt;/p&gt;&lt;p&gt;ä¸€æ–¹é¢ï¼Œå®ƒå¿…é¡»è‡³å°‘å’Œæ‰‹å†™ä»£ç æœ‰ä¸€æ ·çš„æ€§èƒ½ï¼Œè¿™ç‚¹ç›¸å½“æ¸…æ™°ã€‚ä½†æ˜¯å¦ä¸€æ–¹é¢ï¼Œå®ƒä¹Ÿè‚¯å®šæ¯”æœ‰é¢å¤–å¼€é”€å¹¶ä½¿ç”¨éé›¶æˆæœ¬æŠ½è±¡çš„ç‰ˆæœ¬æ›´å¥½ã€‚è¿™å¹¶ä¸æ„å‘³ç€æˆ‘ä»¬å¿…é¡»æ¯”éé›¶æˆæœ¬æŠ½è±¡æ›´ä¸¥æ ¼ï¼Œå› ä¸ºæ€§èƒ½æˆæœ¬åªæ˜¯ä¸€ä¸ªå› ç´ ï¼Œæˆ‘ä»¬å¿…é¡»åœ¨å¹¿ä¹‰ä¸Šï¼Œä½¿ç¨‹åºå‘˜æ‰¿æ‹…çš„æ‰€æœ‰é¢å¤–å¼€é”€éƒ½æˆä¸ºâ€œé›¶æˆæœ¬â€ï¼Œè¿™ä¹Ÿæ˜¯å€¼å¾—çš„ã€‚ï¼ˆæˆ‘è®¤ä¸ºï¼ŒRustçš„æŸäº›è®¾è®¡ä¸ºäº†å–å¾—æ›´é«˜ä¸€ç‚¹çš„æ€§èƒ½ï¼Œè®©ç”¨æˆ·é€šè¿‡ä¸æ„‰å¿«çš„æ–¹å¼å»ç¼–ç¨‹ï¼Œè¯•å›¾è®©äººæ„Ÿè§‰é›¶æˆæœ¬æŠ½è±¡æ›´å¥½ã€‚æˆ‘è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªé”™è¯¯ï¼ŒæŸå®³äº†è¯­è¨€çš„æ•´ä½“ç”¨æˆ·ä½“éªŒï¼Œå¯èƒ½è®©ä¸€äº›ç”¨æˆ·æ ¹æœ¬æ— æ³•ä½¿ç”¨å®ƒï¼Œä»è€ŒæŸå®³äº†æˆ‘ä»¬çš„æ€»ä½“ç›®æ ‡ã€‚ï¼‰&lt;/p&gt;&lt;p&gt;(I think to some extent Rust has tried to cheat this by making non-zero cost abstractions actively unpleasant to write, making it &lt;i&gt;feel&lt;/i&gt; like the zero cost abstraction is better. I think this is a mistake that hurts the overall UX of the language and probably just keeps some people from using it at all, hurting our overall goals.)&lt;/p&gt;&lt;p&gt;æˆ‘è¿˜è¦è¯´ï¼Œå®é™…ä¸Šå®ç°æ»¡è¶³è¿™ä¸‰ä¸ªå…³é”®çš„é›¶æˆæœ¬æŠ½è±¡å›°éš¾åœ°è®©äººéš¾ä»¥ç½®ä¿¡ã€‚ &lt;/p&gt;&lt;p&gt;Rustç¡®å®åšäº†å‡ æ¬¡å‡ºè‰²çš„å·¥ä½œï¼ˆæ‰€æœ‰è¿™äº›éƒ½äº§ç”Ÿäº†æé«˜çš„å½±å“ï¼‰ï¼Œå¹¶ä¸”å‚ä¸äº†æˆ‘è®¤ä¸ºå°†æˆä¸ºæˆåŠŸæ¡ˆä¾‹ä¹‹ä¸€çš„å·¥ä½œ-å½“ç„¶æ˜¯å¼‚æ­¥/ç­‰å¾…-æ„Ÿè§‰å°±åƒåœ¨æ¡ç€ä½ çš„æ‰‹ã€‚å»å¹´9æœˆï¼Œæˆ‘å‘ä¸€ä½æœ‹å‹è¯„è®ºè¯´ï¼Œæˆ‘æ‹…å¿ƒè‡ªå·±åšçš„ä»»ä½•äº‹æƒ…éƒ½ä¸ä¼šåƒæˆ‘åˆšåˆšåšçš„é‚£æ ·å¥½ï¼ˆå‚è€ƒPin APIï¼‰ï¼Œæˆ‘ç¡®å®æ„Ÿåˆ°äº†ã€‚&lt;/p&gt;&lt;p&gt;ä½†æ˜¯æˆ‘ä»¬å¾ˆå°‘èƒ½å–å¾—å¦‚æ­¤å‡ºè‰²çš„æˆå°±ï¼Œå› ä¸ºå®ƒæå…¶å›°éš¾ï¼Œå¹¶ä¸”è¿˜æ¶‰åŠå¾ˆå¤šè¿æ°”ï¼ˆå¾ˆå¤šé—®é¢˜å¯èƒ½è¿˜æ²¡æœ‰çœŸæ­£æ„ä¹‰ä¸Šçš„é›¶æˆæœ¬æŠ½è±¡ï¼Œä½†è‡³å°‘åœ¨è®¾è®¡çº¦æŸèŒƒå›´å†…ï¼Œä¹‹å‰çš„å†å²å†³ç­–å·²ç»è¢«è€ƒè™‘åœ¨å†…ï¼‰ã€‚&lt;/p&gt;&lt;p&gt;ä¸ºäº†æ˜ç¡®æˆ‘çš„æ„æ€ï¼Œæˆ‘å°†åˆ—å‡ºRustä¸­ä¸€äº›çœŸæ­£å¾ˆæ£’çš„é›¶æˆæœ¬æŠ½è±¡ï¼š&lt;br/&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;Ownership and borrowingï¼ˆ æ‰€æœ‰æƒå’Œå€Ÿç”¨ï¼‰&lt;/b&gt;å½“ç„¶è¿™æ˜¯æœ€æ£’çš„ä¸€ä¸ªï¼Œä¸ä½¿ç”¨åƒåœ¾æ”¶é›†å¹¶ä¿è¯å†…å­˜å’Œçº¿ç¨‹å®‰å…¨ï¼Œæ˜¯Rustæœ€åˆä¹Ÿæ˜¯æœ€å¤§çš„æˆåŠŸç‚¹ã€‚&lt;/li&gt;&lt;li&gt;&lt;b&gt;Iterator and closure APIs.ï¼ˆè¿­ä»£ï¼‰&lt;/b&gt;è¿™æ˜¯å¦å¤–ä¸€ä¸ªç»å…¸ã€‚å°½ç®¡åœ¨æŸäº›æƒ…å†µä¸‹å¯èƒ½ä¼šæ›´å¥½åœ°ä¼˜åŒ–å†…éƒ¨è¿­ä»£ï¼Œä½†æ˜¯æ‚¨å¯ä»¥åœ¨åˆ‡ç‰‡ä¸Šç¼–å†™mapï¼Œfilterï¼Œè¿­ä»£å¾ªç¯ç­‰ï¼Œå¹¶ä½¿å…¶ä¼˜åŒ–åˆ°ä¸æŸäº›æ‰‹å†™Cç›¸å½“çš„ç¨‹åº¦ï¼Œè¿™ç¡®å®ä»¤äººéœ‡æƒŠã€‚&lt;/li&gt;&lt;li&gt;&lt;b&gt;Async/await and Futures.ï¼ˆ&lt;/b&gt;å¼‚æ­¥/ç­‰å¾…å’ŒFutures&lt;b&gt;ï¼‰&lt;/b&gt; Future APIæ˜¯ä¸€ä¸ªé‡è¦çš„ç¤ºä¾‹ï¼Œå› ä¸ºFutureçš„æ—©æœŸç‰ˆæœ¬ç¡®å®å¾ˆå¥½åœ°å®ç°äº†é›¶æˆæœ¬æŠ½è±¡çš„â€œé›¶æˆæœ¬â€éƒ¨åˆ†ï¼Œä½†å®é™…ä¸Šå¹¶æ²¡æœ‰æä¾›è¶³å¤Ÿå¥½çš„ç”¨æˆ·ä½“éªŒæ¥æ¨åŠ¨ç”¨æˆ·ä½¿ç”¨å®ƒã€‚é€šè¿‡æ·»åŠ è¡¥ä¸ä»¥æ”¯æŒå¼‚æ­¥/ç­‰å¾…ï¼Œè·¨ç­‰å¾…çš„å¼•ç”¨ç­‰ç­‰ï¼Œæˆ‘ä»¬å¼€å‘å‡ºäº†ä¸€ç§æˆ‘è®¤ä¸ºç¡®å®å¯ä»¥è§£å†³ç”¨æˆ·é—®é¢˜å¹¶ä½¿Rustæ›´é€‚åˆç¼–å†™é«˜æ€§èƒ½ç½‘ç»œæœåŠ¡çš„äº§å“ã€‚&lt;/li&gt;&lt;li&gt;&lt;b&gt;Unsafe and the module boundary.ï¼ˆä¸å®‰å…¨æ¨¡å¼å’Œæ¨¡å—è¾¹ç•Œï¼‰&lt;/b&gt;æ‰€æœ‰è¿™äº›ä»¥åŠRustçš„æ¯ä¸€ä¸ªæˆåŠŸæ•…äº‹çš„åŸºç¡€éƒ½æ˜¯Unsafeå—å’Œç§æœ‰çš„æ¦‚å¿µï¼Œè¿™äº›æ¦‚å¿µä½¿æˆ‘ä»¬èƒ½å¤ŸæŠ•å…¥åŸå§‹æŒ‡é’ˆæ“ä½œæ¥æ„å»ºè¿™äº›é›¶æˆæœ¬çš„æŠ½è±¡ã€‚å¦‚æœæ²¡æœ‰è¿™ç§çœŸæ­£çš„åŸºæœ¬èƒ½åŠ›ï¼ŒRustçš„å‡ºè‰²åŠŸèƒ½å°±ä¸å¯èƒ½å®ç°ï¼Œå®ƒæ‰“ç ´è§„åˆ™ï¼Œè®©ç³»ç»Ÿè¶…è¶Šäº†ç±»å‹æ£€æŸ¥å™¨çš„å¤„ç†èŒƒå›´ã€‚è¿™æ˜¯é›¶æˆæœ¬æŠ½è±¡â€”â€”Rustä¸­æ‰€æœ‰å…¶ä»–é›¶æˆæœ¬æŠ½è±¡çš„æºæ³‰ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br/&gt;åœ¨å…¶ä»–é¢†åŸŸï¼Œæˆ‘ä»¬ä»ç„¶æ²¡æœ‰æˆåŠŸæ‰¾åˆ°é›¶æˆæœ¬çš„æŠ½è±¡æ¦‚å¿µã€‚ä¸€ä¸ªä¾‹å­æ˜¯trait objectï¼Œå®ƒæ˜¯åŠ¨æ€åˆ†é…å¤šæ€æ€§çš„ä¸€ç§è§£å†³æ–¹æ¡ˆã€‚ ï¼ˆè¿™é‡Œè¦æ³¨æ„ï¼ŒåŠ¨æ€è°ƒåº¦æ˜¯ç›®æ ‡çš„ä¸€éƒ¨åˆ†ï¼Œå› æ­¤è™šæ‹Ÿè°ƒç”¨å¹¶ééé›¶æˆæœ¬ã€‚ï¼‰é—®é¢˜åœ¨äºå¯¹è±¡å®‰å…¨æ€§çš„æ¦‚å¿µï¼Œä»¥åŠå›ºå®šå¤§å°æˆ–æœªçŸ¥å¤§å°çš„ç±»å‹ï¼Œå¯èƒ½è¿˜æœ‰äº›ä¸å¥½çš„ergonomics around the coercionsï¼Œä½¿å¾—trait objectå˜å¾—éå¸¸ç¬¨æ‹™ï¼›é€šå¸¸æˆ‘ä¸å¾—ä¸ä½¿ç”¨å®ƒä»¬æ—¶ä¼šå¾ˆç”Ÿæ°”ã€‚è‡³å°‘åœ¨18ä¸ªæœˆçš„æ—¶é—´é‡Œï¼Œæˆ‘ä¸€ç›´æƒ³æ·±å…¥ç ”ç©¶è¿™ä¸ªé—®é¢˜ç©ºé—´ï¼Œä½†æ˜¯å…¶ä»–äº‹æƒ…å§‹ç»ˆæ˜¯ä¼˜å…ˆäº‹é¡¹ã€‚&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;ä¸‹æ–‡ç¬¬äºŒç¯‡æ˜¯å¦å¤–ä¸€ä¸ªäººå†™çš„ã€‚&lt;/p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/109189186&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; class=&quot;internal&quot;&gt;é›¾è‰²ï¼šRustä¸­çš„é›¶æˆæœ¬æŠ½è±¡ï¼ˆéƒ¨åˆ†ç¿»è¯‘ï¼‰&lt;/a&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>é›¾è‰²</author>
<guid isPermaLink="false">2020-02-27-109517672</guid>
<pubDate>Thu, 27 Feb 2020 00:00:00 +0800</pubDate>
</item>
<item>
<title>Rustä¸­çš„é›¶æˆæœ¬æŠ½è±¡ï¼ˆäºŒï¼‰ï¼ˆéƒ¨åˆ†ç¿»è¯‘ï¼‰</title>
<link>https://henix.github.io/feeds/zhuanlan.rust-lang/2020-02-27-109189186.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/109189186&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ—¶é—´æœ‰é™ï¼Œç¿»è¯‘äº†å…³é”®çš„éƒ¨åˆ†&lt;/p&gt;&lt;p&gt;å¤§æ„æ˜¯ï¼ŒRustä¸­çš„æŠ½è±¡çš„å¯è¯»æ€§é«˜çš„ä»£ç å’Œæ‰‹åŠ¨ä¼˜åŒ–ä»£ç åœ¨è°ƒè¯•æ—¶æ˜¯æœ‰åŒºåˆ«çš„ï¼Œä½†æ˜¯åœ¨å‘å¸ƒæ—¶æ²¡æœ‰åŒºåˆ«ã€‚å½“ç„¶æ‰‹åŠ¨ä¼˜åŒ–çš„ç¼–è¯‘æ›´å¿«ã€‚&lt;/p&gt;&lt;p&gt;åŸæ–‡è¯‘è‡ª&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//carette.xyz/posts/zero_cost_abstraction/&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;carette.xyz/posts/zero_&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;cost_abstraction/&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//carette.xyz/posts/zero_cost_abstraction/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Zero-cost abstractions in Rust&lt;/a&gt;&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//carette.xyz/posts/zero_cost_abstraction/&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Zero-cost abstractions in Rust&lt;/a&gt;&lt;p&gt;ä¸Šä¸€å‘¨, &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//idursun.com/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Ibrahim Dursun&lt;/a&gt;å‘å¸ƒäº†ä¸€ç¯‡å…³äºRusté›¶æˆæœ¬æŠ½è±¡çš„æ–‡ç« ã€‚&lt;br/&gt;ä¸å¹¸çš„æ˜¯ï¼Œé™¤äº†æ–‡ç« çš„ä¸€å°éƒ¨åˆ†, è¿™ç¯‡æ–‡ç« å¹¶æ²¡æœ‰æ­£ç¡®åœ°ä½“ç°ï¼ˆæˆ‘çš„æ‹™è§ï¼‰ä»€ä¹ˆæ˜¯é›¶æŠ½è±¡ã€‚&lt;/p&gt;&lt;p&gt;ç¡®å®ï¼Œé›¶æˆæœ¬æŠ½è±¡ï¼ˆzero-cost abstractionï¼‰æˆ–è€…é›¶å¼€é”€åŸåˆ™ï¼ˆzero-overheadï¼‰ï¼Œæ˜¯å¾ˆéš¾ç†è§£ï¼Œå¹¶ä¸ç¼–è¯‘ä¼˜åŒ–åˆ†ç¦»ï¼Œè¿™å¯¼è‡´å®ƒå¾ˆå®¹æ˜“è¢«è¯¯è§£ã€‚&lt;/p&gt;&lt;p&gt;åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä¼šè®¨è®ºå®ƒï¼Œå¹¶ä¸”ç»™å‡ºRustå¦‚ä½•å¯¹æŠ½è±¡è¿‡çš„é¡¹ç›®è¿›è¡Œä¼˜åŒ–çš„ä¾‹å­ã€‚&lt;/p&gt;&lt;p&gt;æ³¨æ„ï¼šå»å¹´å…³äºé›¶æˆæœ¬æŠ½è±¡å·²ç»æœ‰ç¯‡å¥½æ–‡ï¼ˆ&lt;a href=&quot;https://zhuanlan.zhihu.com/p/109517672&quot; class=&quot;internal&quot;&gt;é›¶æˆæœ¬æŠ½è±¡ï¼Œä½œè€…ï¼šwithoutboats&lt;/a&gt;ï¼‰ï¼Œæœ¬æ–‡ä½œä¸ºå®ƒçš„è¡¥å……ã€‚&lt;/p&gt;&lt;h2&gt;ä»€ä¹ˆæ˜¯é›¶æˆæœ¬æŠ½è±¡&lt;/h2&gt;&lt;p&gt;å½“ä½ ç¼–ç¨‹çš„æ—¶å€™ï¼Œé¡¹ç›®è¶Šæ¥è¶Šå¤æ‚ï¼Œé€šå¸¸ä½ ä¼šå¢åŠ æŠ½è±¡æ¥è®©é¡¹ç›®å®¹æ˜“ç»´æŠ¤å¹¶å¢åŠ åŠŸèƒ½ã€‚ä½ è‚¯å®šå¸Œæœ›ä½ çš„æŠ½è±¡ä¸è¦åœ¨è¿è¡Œæ—¶å¢åŠ æˆæœ¬ã€‚&lt;/p&gt;&lt;p&gt;æ‰€ä»¥ï¼Œä½ çš„2ä¸ªåŸåˆ™æ˜¯ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;é¡¹ç›®çš„å¯è¯»æ€§å’Œæ˜“ç®¡ç†æ€§æ¯”å¤æ‚çš„æ‰‹å†™ä¼˜åŒ–æ›´é‡è¦&lt;/li&gt;&lt;li&gt;ä½†è‡³å°‘èƒ½åœ¨è¿è¡Œæ—¶å‘æŒ¥éå¸¸è‰¯å¥½çš„æ€§èƒ½&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;ç¡®å®ï¼Œæ”¹è¿›ä»£ç å¯è¯»æ€§ä¼šé™åˆ¶ä¼˜åŒ–å’Œå†…å­˜å¼€é”€ï¼Œå¹¶é—´æ¥è¿Ÿæ»è¿è¡Œæ—¶çš„æ€§èƒ½ã€‚&lt;/p&gt;&lt;p&gt;é›¶æˆæœ¬æŠ½è±¡æ¥è‡ªC++ï¼Œç”±C++åˆ›å§‹äººBjarne Stroustrupå®šä¹‰ï¼š&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;é€šå¸¸ï¼ŒC++çš„å®ç°éµå¾ªé›¶å¼€é”€åŸåˆ™ï¼šä½ ä¸ä½¿ç”¨çš„ï¼Œä½ ä¸è´Ÿæ‹…æˆæœ¬ã€‚æ›´è¿›ä¸€æ­¥ï¼šä½ ä½¿ç”¨çš„ï¼Œä½ ä¹Ÿæ²¡æ³•æ›´ä¼˜åŒ–ã€‚&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;æ€»ç»“ä»–è¯´çš„ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;ä½ ä¸ä½¿ç”¨çš„åŠŸèƒ½ï¼Œä½ ä¸æ‰¿æ‹…é¢å¤–å¼€é”€&lt;/li&gt;&lt;li&gt;é«˜å±‚çš„æŠ½è±¡ä¼šè¢«ç¼–è¯‘æˆæœºå™¨ä»£ç ï¼Œè¿™äº›ä»£ç å¾ˆéš¾æ›´è¿›ä¸€æ­¥ä¼˜åŒ–&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;Rustæœ€ä¸»è¦çš„æŠ½è±¡ï¼ˆæˆ–è€…è¯´æ ‡å‡†åº“ï¼‰ä¸ä¼šå¢åŠ è¿è¡Œæ—¶æˆæœ¬ã€‚&lt;/p&gt;&lt;p&gt;åœ¨Rustä¸­ï¼Œé›¶æˆæœ¬æŠ½è±¡æ˜¯ä¸€ç§æ ¸å¿ƒåŸåˆ™ï¼Œå°¤å…¶å¯¹ä¸‹é¢çš„è¿™äº›ç‰¹æ€§ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;ç¼–è¯‘æ—¶å†…å­˜æ£€æŸ¥å’Œé™æ€åƒåœ¾å›æ”¶ï¼ˆå€Ÿç”¨å’Œæ‰€æœ‰æƒï¼‰ - ä½œä¸ºæé†’, Rust åœ¨è¿è¡Œæ—¶ä¸é€šè¿‡å¼•ç”¨è®¡æ•°æ£€æŸ¥å’Œå›æ”¶å†…å­˜ï¼Œè€Œæ˜¯åœ¨ç¼–è¯‘æ—¶é€šè¿‡ç”Ÿå‘½å‘¨æœŸæ£€æŸ¥&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//blog.rust-lang.org/2015/05/11/traits.html&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;traits&lt;/a&gt;, æ˜¯éå¸¸è®©äººå°è±¡æ·±åˆ»çš„åŠŸèƒ½ï¼Œæ¥æ‹“å±•ä½ çš„ç±»å‹&lt;/li&gt;&lt;li&gt;genericsï¼ˆæ³›å‹ï¼‰,&lt;/li&gt;&lt;li&gt;iteratorsï¼ˆè¿­ä»£å™¨ï¼‰,&lt;/li&gt;&lt;li&gt;etcï¼ˆå…¶å®ƒï¼‰.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;This can explain why &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//diesel.rs/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Diesel&lt;/a&gt;, a famous Rust ORM, &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//www.reddit.com/r/Rust/comments/5hmya5/diesel_is_30_faster_than_Rustpostgres_in/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;was 30% faster than the raw postgres solution for Rust&lt;/a&gt;, using more abstractions.&lt;/p&gt;&lt;h2&gt;ä¸¤ä¸ªä¾‹å­&lt;/h2&gt;&lt;p&gt;æˆ‘ä»¬ç”¨ä¸¤ä¸ªä¾‹å­æ¥è§£é‡ŠRustä¸­çš„é›¶æˆæœ¬æŠ½è±¡ã€‚&lt;/p&gt;&lt;p&gt;ä»1å¼€å§‹ã€å°äºè‡ªç„¶æ•°nçš„ï¼Œæ‰€æœ‰çš„å¥‡æ•°çš„å’Œã€‚&lt;/p&gt;&lt;p&gt;ä¸¤ä¸ªç‰ˆæœ¬çš„ä»£ç &lt;/p&gt;&lt;p&gt;ç¬¬ä¸€ä¸ªæ˜¯é€šå¸¸çš„æŠ½è±¡ç‰ˆæœ¬&lt;/p&gt;&lt;p&gt;ç¬¬äºŒä¸ªæ˜¯æ‰‹å†™ä¼˜åŒ–ç‰ˆæœ¬&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;fn sum_odd_numbers(n: u64) -&amp;gt; u64 {
    let mut acc = 0;
    for element in 0.. {
        if element &amp;gt;= n {
            break;
        }
        if element.is_odd() {
            acc += element;
        }
    }
    acc
}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;, or&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;fn sum_odd_numbers(n: u64) -&amp;gt; u64 {
    (0..)
        .take_while(|element| element &amp;lt; &amp;amp;n)
        .filter(|n| n.is_odd())
        .fold(0, |sum, element| sum + element)
}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¸‹é¢ä¸€æ®µè§£é‡Šäº†ç¬¬äºŒä¸ªä»£ç ä½¿ç”¨äº†å‡½æ•°å¼ç¼–ç¨‹ï¼Œéƒ½å¹²äº†ä»€ä¹ˆï¼š&lt;/p&gt;&lt;p&gt;The second code sample borrows functional programming concepts to compute the sum, and is seems more â€œcompactâ€ (and easier to understand) than the first one.&lt;br/&gt;However, if we decompose this second sample, we can make wrong assumptions here:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;create an iterator that begins with a zero value,&lt;/li&gt;&lt;li&gt;take all elements lower than &lt;code&gt;n&lt;/code&gt;, a number passed as parameter by the user - as a reminder, if we explicit the final of the iterator, the compiler could decide to compute the final number at compile time, and store it in the executable -, and store the result in another array,&lt;/li&gt;&lt;li&gt;loop all over the last array of elements to get only the odds, and store the result in another array,&lt;/li&gt;&lt;li&gt;loop over the odds array to compute the sum, and return finaly return the value.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;So, multiple array allocations just to compute a simple sumâ€¦&lt;/p&gt;&lt;p&gt;Fortunately, &lt;b&gt;Rust does not do that&lt;/b&gt;: instead, the compiler writes as great code as the first solution provided here, by itself!&lt;/p&gt;&lt;p&gt;Letâ€™s demonstrate it using benchmarks.&lt;/p&gt;&lt;h3&gt;æ€§èƒ½å¯¹æ¯”ï¼ˆBenchmarksï¼‰&lt;/h3&gt;&lt;p&gt;ä»¥ä¸‹çš„æ€§èƒ½å¯¹æ¯”ä½¿ç”¨Intel Core i5 (3 GHz, 6 cores * 2 threads / core), å¯¹äºæ‰‹å†™ä¼˜åŒ–å’ŒæŠ½è±¡ç‰ˆä½¿ç”¨ä¸åŒçš„néƒ½è¿è¡Œäº†10æ¬¡ï¼Œç„¶åå–ä¸­é—´æ•°ã€‚&lt;/p&gt;&lt;p&gt;&lt;br/&gt;I used the &lt;code&gt;time&lt;/code&gt; program to measure the user + system execution times each time, and computed the median of those values.&lt;/p&gt;&lt;p&gt;åŒ…æ‹¬ç¼–è¯‘å’Œå‘å¸ƒè¿è¡Œæ—¶é—´å¯¹æ¯”ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;å‘å¸ƒæ˜¯ä½¿ç”¨&lt;/b&gt;&lt;code&gt;cargo build --release&lt;/code&gt;çš„ç‰ˆæœ¬ï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;cargo build --release # in the root of your cargo project&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä»£ç åº“è§ &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/k0pernicus/Rust_zero_cost_abstraction_illustration&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;github.com/k0pernicus/R&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;ust_zero_cost_abstraction_illustration&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;æ€§èƒ½å¯¹æ¯”&lt;/b&gt;&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-a0a832c2c89d838d82dce7b38a9cfd0b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;796&quot; data-rawheight=&quot;381&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;796&quot; data-original=&quot;https://pic4.zhimg.com/v2-a0a832c2c89d838d82dce7b38a9cfd0b_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-a0a832c2c89d838d82dce7b38a9cfd0b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;796&quot; data-rawheight=&quot;381&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;796&quot; data-original=&quot;https://pic4.zhimg.com/v2-a0a832c2c89d838d82dce7b38a9cfd0b_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-a0a832c2c89d838d82dce7b38a9cfd0b_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;æŠ½è±¡ç‰ˆæœ¬åœ¨å‘å¸ƒæ—¶è¢«å¤§å¤§ä¼˜åŒ–äº†ï¼Œä»¥è‡³äºå’Œæ‰‹å†™ä¼˜åŒ–æ²¡æœ‰åŒºåˆ«ã€‚ï¼ˆè¯‘è€…æ³¨ï¼šæ ‡å‡†åº“ä¸­çš„åŠŸèƒ½å¯èƒ½å¤§å¤šæ•°å¦‚æ­¤ï¼‰&lt;/p&gt;&lt;h2&gt;ç¼–è¯‘æ—¶é—´&lt;/h2&gt;&lt;p&gt;Unfortunately, zero-cost abstractions has a consequence: as the compiler has more work to do to optimize itself the abstracted code, it will run more longer.&lt;/p&gt;&lt;p&gt;If you take a look at the compile time of each versions below, you can observe that the abstracted version compiles more slower than the hand-written version, even for a simple program like thisâ€¦&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-ce32aca2e8f1dc614e64450ad9e6b6ab_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;802&quot; data-rawheight=&quot;156&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;802&quot; data-original=&quot;https://pic4.zhimg.com/v2-ce32aca2e8f1dc614e64450ad9e6b6ab_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-ce32aca2e8f1dc614e64450ad9e6b6ab_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;802&quot; data-rawheight=&quot;156&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;802&quot; data-original=&quot;https://pic4.zhimg.com/v2-ce32aca2e8f1dc614e64450ad9e6b6ab_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-ce32aca2e8f1dc614e64450ad9e6b6ab_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;h2&gt;æ€»ç»“&lt;/h2&gt;&lt;p&gt;å½“ä½ éœ€è¦æŠ½è±¡çš„æ—¶å€™ï¼Œä¸è¦çŠ¹è±«ã€‚åœ¨Rustä¸­ï¼Œä½ æ°¸è¿œä¸éœ€è¦é¦–å…ˆè¿›è¡Œæ‰‹å†™ä¼˜åŒ–ï¼Œè€Œåº”è¯¥è€ƒè™‘æŠ½è±¡æ€§ã€æ¶æ„å’Œè®¾è®¡ã€ä»£ç å¯è¯»æ€§ã€‚å³ä½¿ä½ ååˆ†åœ¨æ„è¿è¡Œæ—¶æ€§èƒ½ã€‚&lt;br/&gt;å½“ç„¶ï¼Œæ‰‹å†™ä¼˜åŒ–çš„ç‰ˆæœ¬ç¼–è¯‘èµ·æ¥è¦å¿«å¾ˆå¤šï¼ˆå³ä½¿è¿™ä¹ˆç®€å•çš„ç¨‹åºéƒ½èƒ½å·®è¿™ä¹ˆå¤šï¼‰ã€‚&lt;/p&gt;&lt;p&gt;Thanks to Robert Syme &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/k0pernicus/website/pull/1&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;for his contribution&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/109517672&quot; class=&quot;internal&quot;&gt;é›¾è‰²ï¼šRustä¸­çš„é›¶æˆæœ¬æŠ½è±¡ï¼ˆä¸€ï¼‰ï¼ˆè¯‘ï¼‰&lt;/a&gt;ï¼ˆå¦å¤–ä¸€äººå†™çš„ï¼‰&lt;/p&gt;</description>
<author>é›¾è‰²</author>
<guid isPermaLink="false">2020-02-27-109189186</guid>
<pubDate>Thu, 27 Feb 2020 00:00:00 +0800</pubDate>
</item>
<item>
<title>Rustä¸­çš„é›¶æˆæœ¬æŠ½è±¡ï¼ˆéƒ¨åˆ†ç¿»è¯‘ï¼‰</title>
<link>https://henix.github.io/feeds/zhuanlan.rust-lang/2020-02-26-109189186.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/109189186&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ—¶é—´æœ‰é™ï¼Œç¿»è¯‘äº†å…³é”®çš„éƒ¨åˆ†&lt;/p&gt;&lt;p&gt;å¤§æ„æ˜¯ï¼ŒRustä¸­çš„æŠ½è±¡çš„å¯è¯»æ€§é«˜çš„ä»£ç å’Œæ‰‹åŠ¨ä¼˜åŒ–ä»£ç åœ¨è°ƒè¯•æ—¶æ˜¯æœ‰åŒºåˆ«çš„ï¼Œä½†æ˜¯åœ¨å‘å¸ƒæ—¶æ²¡æœ‰åŒºåˆ«ã€‚å½“ç„¶æ‰‹åŠ¨ä¼˜åŒ–çš„ç¼–è¯‘æ›´å¿«ã€‚&lt;/p&gt;&lt;p&gt;åŸæ–‡è¯‘è‡ª&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//carette.xyz/posts/zero_cost_abstraction/&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;carette.xyz/posts/zero_&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;cost_abstraction/&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//carette.xyz/posts/zero_cost_abstraction/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Zero-cost abstractions in Rust&lt;/a&gt;&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//carette.xyz/posts/zero_cost_abstraction/&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Zero-cost abstractions in Rust&lt;/a&gt;&lt;p&gt;ä¸Šä¸€å‘¨, &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//idursun.com/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Ibrahim Dursun&lt;/a&gt;å‘å¸ƒäº† &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//idursun.com/posts/Rust_zero_cost_abstractions_in_action/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;ä¸€ç¯‡å…³äºRusté›¶æˆæœ¬æŠ½è±¡çš„æ–‡ç« &lt;/a&gt;ã€‚&lt;br/&gt;ä¸å¹¸çš„æ˜¯ï¼Œé™¤äº†æ–‡ç« çš„ä¸€å°éƒ¨åˆ†, è¿™ç¯‡æ–‡ç« å¹¶æ²¡æœ‰æ­£ç¡®åœ°ä½“ç°ï¼ˆæˆ‘çš„æ‹™è§ï¼‰ä»€ä¹ˆæ˜¯é›¶æŠ½è±¡ã€‚&lt;/p&gt;&lt;p&gt;ç¡®å®ï¼Œé›¶æˆæœ¬æŠ½è±¡ï¼ˆzero-cost abstractionï¼‰æˆ–è€…é›¶å¼€é”€åŸåˆ™ï¼ˆzero-overheadï¼‰ï¼Œæ˜¯å¾ˆéš¾ç†è§£ï¼Œå¹¶ä¸ç¼–è¯‘ä¼˜åŒ–åˆ†ç¦»ï¼Œè¿™å¯¼è‡´å®ƒå¾ˆå®¹æ˜“è¢«è¯¯è§£ã€‚&lt;/p&gt;&lt;p&gt;åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä¼šè®¨è®ºå®ƒï¼Œå¹¶ä¸”ç»™å‡ºRustå¦‚ä½•å¯¹æŠ½è±¡è¿‡çš„é¡¹ç›®è¿›è¡Œä¼˜åŒ–çš„ä¾‹å­ã€‚&lt;/p&gt;&lt;p&gt;æ³¨æ„ï¼šå»å¹´å…³äºé›¶æˆæœ¬æŠ½è±¡å·²ç»æœ‰ç¯‡å¥½æ–‡ï¼ˆ&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//boats.gitlab.io/blog/post/zero-cost-abstractions/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;é›¶æˆæœ¬æŠ½è±¡ï¼Œä½œè€…ï¼šwithoutboats&lt;/a&gt;ï¼‰ï¼Œæ­¤æ–‡ä½œä¸ºè¡¥å……ã€‚&lt;/p&gt;&lt;h2&gt;ä»€ä¹ˆæ˜¯é›¶æˆæœ¬æŠ½è±¡&lt;/h2&gt;&lt;p&gt;å½“ä½ ç¼–ç¨‹çš„æ—¶å€™ï¼Œé¡¹ç›®è¶Šæ¥è¶Šå¤æ‚ï¼Œé€šå¸¸ä½ ä¼šå¢åŠ æŠ½è±¡æ¥è®©é¡¹ç›®å®¹æ˜“ç»´æŠ¤å¹¶å¢åŠ åŠŸèƒ½ã€‚ä½ è‚¯å®šå¸Œæœ›ä½ çš„æŠ½è±¡ä¸è¦åœ¨è¿è¡Œæ—¶å¢åŠ æˆæœ¬ã€‚&lt;/p&gt;&lt;p&gt;æ‰€ä»¥ï¼Œä½ çš„2ä¸ªåŸåˆ™æ˜¯ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;é¡¹ç›®çš„å¯è¯»æ€§å’Œæ˜“ç®¡ç†æ€§æ¯”å¤æ‚çš„æ‰‹å†™ä¼˜åŒ–æ›´é‡è¦&lt;/li&gt;&lt;li&gt;ä½†è‡³å°‘èƒ½åœ¨è¿è¡Œæ—¶å‘æŒ¥éå¸¸è‰¯å¥½çš„æ€§èƒ½&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;ç¡®å®ï¼Œæ”¹è¿›ä»£ç å¯è¯»æ€§ä¼šé™åˆ¶ä¼˜åŒ–å’Œå†…å­˜å¼€é”€ï¼Œå¹¶é—´æ¥è¿Ÿæ»è¿è¡Œæ—¶çš„æ€§èƒ½ã€‚&lt;/p&gt;&lt;p&gt;é›¶æˆæœ¬æŠ½è±¡æ¥è‡ªC++ï¼Œç”±C++åˆ›å§‹äººBjarne Stroustrupå®šä¹‰ï¼š&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;é€šå¸¸ï¼ŒC++çš„å®ç°éµå¾ªé›¶å¼€é”€åŸåˆ™ï¼šä½ ä¸ä½¿ç”¨çš„ï¼Œä½ ä¸è´Ÿæ‹…æˆæœ¬ã€‚æ›´è¿›ä¸€æ­¥ï¼šä½ ä½¿ç”¨çš„ï¼Œä½ ä¹Ÿæ²¡æ³•æ›´ä¼˜åŒ–ã€‚&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;æ€»ç»“ä»–è¯´çš„ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;ä½ ä¸ä½¿ç”¨çš„åŠŸèƒ½ï¼Œä½ ä¸è´Ÿæ‹…æˆæœ¬&lt;/li&gt;&lt;li&gt;é«˜å±‚çš„æŠ½è±¡ä¼šè¢«ç¼–è¯‘æˆæœºå™¨ä»£ç ï¼Œè¿™äº›ä»£ç å³ä½¿ä½ æ‰‹åŠ¨ä¼˜åŒ–ä¹Ÿå¾ˆéš¾æ›´å¥½&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;Rustæœ€ä¸»è¦çš„æŠ½è±¡ï¼ˆæˆ–è€…è¯´æ ‡å‡†åº“ï¼‰ä¸ä¼šå¢åŠ è¿è¡Œæ—¶æˆæœ¬ã€‚&lt;/p&gt;&lt;p&gt;åœ¨Rustä¸­ï¼Œé›¶æˆæœ¬æŠ½è±¡æ˜¯ä¸€ç§æ ¸å¿ƒåŸåˆ™ï¼Œå°¤å…¶å¯¹ä¸‹é¢çš„è¿™äº›ç‰¹æ€§ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;ç¼–è¯‘æ—¶å†…å­˜æ£€æŸ¥å’Œé™æ€åƒåœ¾å›æ”¶ï¼ˆå€Ÿç”¨å’Œæ‰€æœ‰æƒï¼‰ - ä½œä¸ºæé†’, Rust åœ¨è¿è¡Œæ—¶ä¸é€šè¿‡å¼•ç”¨è®¡æ•°æ£€æŸ¥å’Œå›æ”¶å†…å­˜ï¼Œè€Œæ˜¯åœ¨ç¼–è¯‘æ—¶é€šè¿‡ç”Ÿå‘½å‘¨æœŸæ£€æŸ¥&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//blog.rust-lang.org/2015/05/11/traits.html&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;traits&lt;/a&gt;, æ˜¯éå¸¸è®©äººå°è±¡æ·±åˆ»çš„åŠŸèƒ½ï¼Œæ¥æ‹“å±•ä½ çš„ç±»å‹&lt;/li&gt;&lt;li&gt;genericsï¼ˆæ³›å‹ï¼‰,&lt;/li&gt;&lt;li&gt;iteratorsï¼ˆè¿­ä»£å™¨ï¼‰,&lt;/li&gt;&lt;li&gt;etcï¼ˆå…¶å®ƒï¼‰.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;This can explain why &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//diesel.rs/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Diesel&lt;/a&gt;, a famous Rust ORM, &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//www.reddit.com/r/Rust/comments/5hmya5/diesel_is_30_faster_than_Rustpostgres_in/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;was 30% faster than the raw postgres solution for Rust&lt;/a&gt;, using more abstractions.&lt;/p&gt;&lt;h2&gt;ä¸¤ä¸ªä¾‹å­&lt;/h2&gt;&lt;p&gt;æˆ‘ä»¬ç”¨ä¸¤ä¸ªä¾‹å­æ¥è§£é‡ŠRustä¸­çš„é›¶æˆæœ¬æŠ½è±¡ã€‚&lt;/p&gt;&lt;p&gt;ä»1å¼€å§‹ï¼Œå°äºè‡ªç„¶æ•°nï¼Œæ‰€æœ‰çš„å¥‡æ•°çš„å’Œã€‚&lt;/p&gt;&lt;p&gt;ä¸¤ä¸ªç‰ˆæœ¬çš„ä»£ç &lt;/p&gt;&lt;p&gt;ç¬¬ä¸€ä¸ªæ˜¯é€šå¸¸çš„ç‰ˆæœ¬&lt;/p&gt;&lt;p&gt;ç¬¬äºŒä¸ªæ˜¯æ‰‹å†™ä¼˜åŒ–ç‰ˆæœ¬&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;fn sum_odd_numbers(n: u64) -&amp;gt; u64 {
    let mut acc = 0;
    for element in 0.. {
        if element &amp;gt;= n {
            break;
        }
        if element.is_odd() {
            acc += element;
        }
    }
    acc
}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;, or&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;fn sum_odd_numbers(n: u64) -&amp;gt; u64 {
    (0..)
        .take_while(|element| element &amp;lt; &amp;amp;n)
        .filter(|n| n.is_odd())
        .fold(0, |sum, element| sum + element)
}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¸‹é¢ä¸€æ®µè§£é‡Šäº†ç¬¬äºŒä¸ªä»£ç ä½¿ç”¨äº†å‡½æ•°å¼ç¼–ç¨‹ï¼Œéƒ½å¹²äº†ä»€ä¹ˆï¼š&lt;/p&gt;&lt;p&gt;The second code sample borrows functional programming concepts to compute the sum, and is seems more â€œcompactâ€ (and easier to understand) than the first one.&lt;br/&gt;However, if we decompose this second sample, we can make wrong assumptions here:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;create an iterator that begins with a zero value,&lt;/li&gt;&lt;li&gt;take all elements lower than &lt;code&gt;n&lt;/code&gt;, a number passed as parameter by the user - as a reminder, if we explicit the final of the iterator, the compiler could decide to compute the final number at compile time, and store it in the executable -, and store the result in another array,&lt;/li&gt;&lt;li&gt;loop all over the last array of elements to get only the odds, and store the result in another array,&lt;/li&gt;&lt;li&gt;loop over the odds array to compute the sum, and return finaly return the value.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;So, multiple array allocations just to compute a simple sumâ€¦&lt;/p&gt;&lt;p&gt;Fortunately, &lt;b&gt;Rust does not do that&lt;/b&gt;: instead, the compiler writes as great code as the first solution provided here, by itself!&lt;/p&gt;&lt;p&gt;Letâ€™s demonstrate it using benchmarks.&lt;/p&gt;&lt;h3&gt;æ€§èƒ½å¯¹æ¯”ï¼ˆBenchmarksï¼‰&lt;/h3&gt;&lt;p&gt;ä»¥ä¸‹çš„æ€§èƒ½å¯¹æ¯”ä½¿ç”¨Intel Core i5 (3 GHz, 6 cores * 2 threads / core), å¯¹äºæ‰‹å†™ä¼˜åŒ–å’ŒæŠ½è±¡ç‰ˆä½¿ç”¨ä¸åŒçš„néƒ½è¿è¡Œäº†10æ¬¡ï¼Œç„¶åå–ä¸­é—´æ•°ã€‚&lt;/p&gt;&lt;p&gt;&lt;br/&gt;I used the &lt;code&gt;time&lt;/code&gt; program to measure the user + system execution times each time, and computed the median of those values.&lt;/p&gt;&lt;p&gt;åŒ…æ‹¬ç¼–è¯‘å’Œå‘å¸ƒè¿è¡Œæ—¶é—´å¯¹æ¯”ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;å‘å¸ƒæ˜¯ä½¿ç”¨&lt;/b&gt;&lt;code&gt;cargo build --release&lt;/code&gt;çš„ç‰ˆæœ¬ï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;cargo build --release # in the root of your cargo project&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä»£ç åº“è§ &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/k0pernicus/Rust_zero_cost_abstraction_illustration&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;github.com/k0pernicus/R&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;ust_zero_cost_abstraction_illustration&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;æ€§èƒ½å¯¹æ¯”&lt;/b&gt;&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-a0a832c2c89d838d82dce7b38a9cfd0b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;796&quot; data-rawheight=&quot;381&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;796&quot; data-original=&quot;https://pic4.zhimg.com/v2-a0a832c2c89d838d82dce7b38a9cfd0b_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-a0a832c2c89d838d82dce7b38a9cfd0b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;796&quot; data-rawheight=&quot;381&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;796&quot; data-original=&quot;https://pic4.zhimg.com/v2-a0a832c2c89d838d82dce7b38a9cfd0b_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-a0a832c2c89d838d82dce7b38a9cfd0b_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;æŠ½è±¡ç‰ˆæœ¬åœ¨å‘å¸ƒæ—¶è¢«å¤§å¤§ä¼˜åŒ–äº†ï¼Œä»¥è‡³äºå’Œæ‰‹å†™ä¼˜åŒ–æ²¡æœ‰åŒºåˆ«ã€‚ï¼ˆè¯‘è€…æ³¨ï¼šæ ‡å‡†åº“ä¸­çš„åŠŸèƒ½å¯èƒ½å¤§å¤šæ•°å¦‚æ­¤ï¼‰&lt;/p&gt;&lt;h2&gt;ç¼–è¯‘æ—¶é—´&lt;/h2&gt;&lt;p&gt;Unfortunately, zero-cost abstractions has a consequence: as the compiler has more work to do to optimize itself the abstracted code, it will run more longer.&lt;/p&gt;&lt;p&gt;If you take a look at the compile time of each versions below, you can observe that the abstracted version compiles more slower than the hand-written version, even for a simple program like thisâ€¦&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-ce32aca2e8f1dc614e64450ad9e6b6ab_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;802&quot; data-rawheight=&quot;156&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;802&quot; data-original=&quot;https://pic4.zhimg.com/v2-ce32aca2e8f1dc614e64450ad9e6b6ab_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-ce32aca2e8f1dc614e64450ad9e6b6ab_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;802&quot; data-rawheight=&quot;156&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;802&quot; data-original=&quot;https://pic4.zhimg.com/v2-ce32aca2e8f1dc614e64450ad9e6b6ab_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-ce32aca2e8f1dc614e64450ad9e6b6ab_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;h2&gt;æ€»ç»“&lt;/h2&gt;&lt;p&gt;å½“ä½ éœ€è¦æŠ½è±¡çš„æ—¶å€™ï¼Œä¸è¦çŠ¹è±«ã€‚åœ¨Rustä¸­ï¼Œä½ æ°¸è¿œä¸éœ€è¦é¦–å…ˆè¿›è¡Œæ‰‹å†™ä¼˜åŒ–ï¼Œè€Œåº”è¯¥è€ƒè™‘æŠ½è±¡æ€§ã€æ¶æ„å’Œè®¾è®¡ã€ä»£ç å¯è¯»æ€§ã€‚å³ä½¿ä½ ååˆ†åœ¨æ„è¿è¡Œæ—¶æ€§èƒ½ã€‚&lt;br/&gt;å½“ç„¶ï¼Œæ‰‹å†™ä¼˜åŒ–çš„ç‰ˆæœ¬ç¼–è¯‘èµ·æ¥è¦å¿«å¾ˆå¤šï¼ˆå³ä½¿è¿™ä¹ˆç®€å•çš„ç¨‹åºéƒ½èƒ½å·®è¿™ä¹ˆå¤šï¼‰ã€‚&lt;/p&gt;&lt;p&gt;Thanks to Robert Syme &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/k0pernicus/website/pull/1&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;for his contribution&lt;/a&gt;.&lt;/p&gt;</description>
<author>é›¾è‰²</author>
<guid isPermaLink="false">2020-02-26-109189186</guid>
<pubDate>Wed, 26 Feb 2020 00:00:00 +0800</pubDate>
</item>
<item>
<title>å®‰è£…RuståŠVSCodeç¯å¢ƒè®¾ç½®ï¼ˆWin 10ï¼‰</title>
<link>https://henix.github.io/feeds/zhuanlan.rust-lang/2020-02-25-92172591.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/92172591&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-5a71f121dd779465a7d67a2f5710608e_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;&lt;i&gt;2020å¹´2æœˆ25æ—¥æ›´æ–°&lt;/i&gt;&lt;/b&gt;&lt;/p&gt;&lt;blockquote&gt;&lt;a href=&quot;https://www.zhihu.com/people/dcjanus&quot; class=&quot;internal&quot;&gt;DCjanus&lt;/a&gt;å’Œ&lt;a href=&quot;https://www.zhihu.com/people/crlf0710&quot; class=&quot;internal&quot;&gt;CrLF0710&lt;/a&gt;çš„å¸®åŠ©è®©è¿™ä¸€ç¯‡æ•™ç¨‹æˆä¸ºå¯èƒ½ï¼Œåœ¨æ­¤è‡´ä»¥çœŸæŒšåœ°æ„Ÿè°¢ğŸ™&lt;/blockquote&gt;&lt;h2&gt;ç›®å½•ï¼š&lt;/h2&gt;&lt;ol&gt;&lt;li&gt;å®‰è£…rust&lt;/li&gt;&lt;li&gt;å®‰è£…VScodeç¼–è¾‘å™¨åŠè¯­è¨€æœåŠ¡å™¨&lt;/li&gt;&lt;li&gt;å®‰è£…è°ƒè¯•å·¥å…·å’Œæ’ä»¶&lt;/li&gt;&lt;li&gt;å»ºç«‹é¡¹ç›®å¹¶è¿›è¡Œè°ƒè¯•è®¾ç½®&lt;/li&gt;&lt;li&gt;é™„å½•ï¼šrustlingsçš„ä½¿ç”¨&lt;/li&gt;&lt;/ol&gt;&lt;hr/&gt;&lt;h2&gt;ä¸€ã€å®‰è£…Rust&lt;/h2&gt;&lt;ol&gt;&lt;li&gt;&lt;i&gt;ä¸‹è½½Rustå®‰è£…å·¥å…·&lt;/i&gt;&lt;/li&gt;&lt;li&gt;&lt;i&gt;ä½¿ç”¨é•œåƒåŠ é€ŸRustå®‰è£…&lt;/i&gt;&lt;/li&gt;&lt;li&gt;&lt;i&gt;å®‰è£…Rustï¼ˆä¸¤ç§å·¥å…·é“¾å¯ä¾›é€‰æ‹©ï¼‰&lt;/i&gt;&lt;/li&gt;&lt;li&gt;&lt;i&gt;å®‰è£…æ ‡å‡†åº“æºç &lt;/i&gt;&lt;/li&gt;&lt;li&gt;&lt;i&gt;ä½¿ç”¨é•œåƒåŠ é€ŸRuståŒ…ä¸‹è½½&lt;/i&gt;&lt;/li&gt;&lt;li&gt;&lt;i&gt;è®¾ç½®RuståŒ…ç¯å¢ƒå˜é‡&lt;/i&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;b&gt;1.ä¸‹è½½rustup-init.exeï¼ˆRustå®‰è£…å·¥å…·ï¼‰&lt;/b&gt;&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//win.rustup.rs/x86_64&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;ç‚¹å‡»ä¸‹è½½rustup-init&lt;/a&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;2. ä½¿ç”¨é•œåƒåŠ é€Ÿrustupå®‰è£…&lt;/b&gt;&lt;/p&gt;&lt;p&gt;æ‰“å¼€Powershell(Win+X +A)æ‰§è¡Œï¼ˆæ‰§è¡Œå®Œä¸è¦å…³é—­ï¼Œåé¢è¿˜ä¼šå¤šæ¬¡ç”¨åˆ°ï¼‰ï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot;&gt;&lt;span class=&quot;no&quot;&gt;[environment]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SetEnvironmentvariable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;RUSTUP_DIST_SERVER&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;https://mirrors.ustc.edu.cn/rust-static&amp;#34;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;User&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;no&quot;&gt;[environment]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SetEnvironmentvariable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;RUSTUP_UPDATE_ROOT&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;https://mirrors.ustc.edu.cn/rust-static/
&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;rustup&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;User&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;blockquote&gt;å‚è€ƒé“¾æ¥ï¼š&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//lug.ustc.edu.cn/wiki/mirrors/help/rust-static&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;lug.ustc.edu.cn/wiki/mi&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;rrors/help/rust-static&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;b&gt;3. å®‰è£…Rustï¼š&lt;/b&gt;æ‰“å¼€rustup-init.exe&lt;/p&gt;&lt;p&gt;å¦‚æœå‡ºç°å®‰è£…ç¨‹åºæœªç»å¾®è½¯éªŒè¯ï¼Œç‚¹å‡»install anywayï¼ˆç«‹å³å®‰è£…ï¼‰å³å¯ã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-074080926471ad7622cfd97da9c36548_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;389&quot; data-rawheight=&quot;432&quot; class=&quot;content_image&quot; width=&quot;389&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-074080926471ad7622cfd97da9c36548_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;389&quot; data-rawheight=&quot;432&quot; class=&quot;content_image lazy&quot; width=&quot;389&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-074080926471ad7622cfd97da9c36548_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;å®‰è£…æœ‰2ç§é€‰æ‹©ï¼Œgnuæˆ–è€…msvcå·¥å…·é“¾&lt;/p&gt;&lt;ul&gt;&lt;li&gt;gnuï¼ˆæœ¬æ–‡ä½¿ç”¨MinGW-w64ï¼‰å ç”¨ç©ºé—´å°ï¼ˆ500Mï¼‰ï¼Œå¯¹äºåˆæ­¥çš„rustä½¿ç”¨è¶³å¤Ÿäº†ã€‚&lt;/li&gt;&lt;li&gt;msvcï¼ˆæœ¬æ–‡ä½¿ç”¨Visual Studio Build Toolsï¼ŒåŒ…å«msvcï¼Œclangç­‰ï¼‰å ç”¨ç©ºé—´å¤§ï¼ˆ2Gï¼‰ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;å·²ç»å®‰è£…äº†Visual Studioçš„é€‰æ‹©msvcï¼Œå·²ç»æœ‰MinGW-w64æˆ–è€…msys2ï¼Œæˆ–è€…ä¸æƒ³å ç”¨å¤ªå¤šç©ºé—´çš„ä½¿ç”¨gnuã€‚&lt;/p&gt;&lt;p&gt;æ›´å¤šåŒºåˆ«è§è¿™ä¸ªè®¨è®º&lt;/p&gt;&lt;a href=&quot;https://www.zhihu.com/question/23789676&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; class=&quot;internal&quot;&gt;GCC/G++ã€ICCã€Clangã€MSVCã€BCCç­‰C/C++ç¼–è¯‘å™¨æœ‰ä»€ä¹ˆç‰¹é•¿å’Œä¸è¶³ï¼Ÿ&lt;/a&gt;&lt;p&gt;&lt;b&gt;gnu&lt;/b&gt;ä¾æ¬¡è¾“å…¥ï¼ˆæ³¨æ„æ¯è¡Œéœ€å›è½¦æ‰§è¡Œï¼‰ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;2&lt;/li&gt;&lt;li&gt;x86_64-pc-windows-gnu&lt;/li&gt;&lt;li&gt;nightlyï¼ˆæƒ³ç”¨æœ€æ–°çš„åŠŸèƒ½å°±ç”¨nightlyï¼ˆæ¯å¤œç‰ˆï¼‰ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©stableï¼ˆç¨³å®šç‰ˆï¼‰ï¼‰&lt;/li&gt;&lt;li&gt;ä¸€è·¯å›è½¦å³å¯ï¼Œç›´åˆ°çœ‹åˆ°æ­£åœ¨ä¸‹è½½ä¸­ï¼ˆæœ‰kb/sçš„å­—æ ·ï¼‰&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;msvc&lt;/b&gt;ä¾æ¬¡è¾“å…¥ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;2&lt;/li&gt;&lt;li&gt;x86_64-pc-windows-msvc&lt;/li&gt;&lt;li&gt;nightlyï¼ˆæƒ³ç”¨æœ€æ–°çš„åŠŸèƒ½å°±ç”¨nightlyï¼ˆæ¯å¤œç‰ˆï¼‰ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©stableï¼ˆç¨³å®šç‰ˆï¼‰ï¼‰&lt;/li&gt;&lt;li&gt;ä¸€è·¯å›è½¦å³å¯ï¼Œç›´åˆ°çœ‹åˆ°æ­£åœ¨ä¸‹è½½ä¸­ï¼ˆæœ‰kb/sçš„å­—æ ·ï¼‰&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;è¿™é‡Œåªæ˜¯å®‰è£…äº†Rustï¼Œè¿™ä¸¤ç§å·¥å…·é“¾åˆ°ç¬¬ä¸‰éƒ¨åˆ†å†ä¸‹è½½å®‰è£…ã€‚&lt;/p&gt;&lt;blockquote&gt;Rustå¸è½½ï¼š              rustup self uninstall&lt;br/&gt;æ‰“å¼€Rustæœ¬åœ°æ–‡æ¡£ï¼š rustup doc&lt;br/&gt;Rustä¸­æ–‡æ–‡æ¡£åœ°å€ï¼š&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//kaisery.github.io/trpl-zh-cn/foreword.html&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;kaisery.github.io/trpl-&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;zh-cn/foreword.html&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;b&gt;4. å®‰è£…æ ‡å‡†åº“æºç &lt;/b&gt;&lt;/p&gt;&lt;p&gt;è¯­è¨€æœåŠ¡å™¨éœ€è¦æºç ï¼Œæ‰“å¼€powershellæ‰§è¡Œï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt; rustup component add rust-src 

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;5. ä½¿ç”¨é•œåƒåŠ é€ŸcargoåŒ…ä¸‹è½½ï¼š&lt;/b&gt;&lt;/p&gt;&lt;p&gt;æ‰“å¼€Powershellæ‰§è¡Œï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;&amp;#34;[source.crates-io]
registry = &amp;#39;https://github.com/rust-lang/crates.io-index&amp;#39;
replace-with = &amp;#39;ustc&amp;#39;
[source.ustc]
registry = &amp;#39;https://mirrors.ustc.edu.cn/crates.io-index/&amp;#39;
&amp;#34;|Out-File -Encoding utf8 $home\.cargo\config


&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;blockquote&gt;è„šæœ¬åœ¨ç”¨æˆ·ç›®å½•.cargoç›®å½•ä¸‹æ–°å»ºäº†æ–‡ä»¶configï¼Œç”¨ä¸­ç§‘å¤§é•œåƒåŠ å¿«cargoåŒ…ä¸‹è½½ã€‚&lt;br/&gt;cargoç±»ä¼¼äºnpmï¼Œæ˜¯ Rust çš„æ„å»ºç³»ç»Ÿå’ŒåŒ…ç®¡ç†å™¨ã€‚&lt;br/&gt;å‚è€ƒé“¾æ¥ï¼š&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//lug.ustc.edu.cn/wiki/mirrors/help/rust-crates&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;lug.ustc.edu.cn/wiki/mi&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;rrors/help/rust-crates&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/blockquote&gt;&lt;p&gt;6. è®¾ç½®cargoç¯å¢ƒå˜é‡ï¼ˆä»¥åçš„rustupå¯èƒ½ä¼šè‡ªåŠ¨è®¾ç½®ï¼‰&lt;/p&gt;&lt;p&gt;æ‰“å¼€Powershellæ‰§è¡Œï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$path&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;[environment]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;GetEnvironmentvariable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Path&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;User&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$cargo_path&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$env:USERPROFILE&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;\.cargo\bin&amp;#34;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$path&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$cargo_path&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;;&amp;#34;&lt;/span&gt;
&lt;span class=&quot;no&quot;&gt;[environment]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SetEnvironmentvariable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Path&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;User&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr/&gt;&lt;h2&gt;äºŒã€å®‰è£…VScodeç¼–è¾‘å™¨åŠè¯­è¨€æœåŠ¡å™¨&lt;/h2&gt;&lt;ol&gt;&lt;li&gt;&lt;i&gt;å®‰è£…VSCode&lt;/i&gt;&lt;/li&gt;&lt;li&gt;&lt;i&gt;å®‰è£…è¯­è¨€æœåŠ¡å™¨ï¼ˆæœ‰ä¸¤ç§å¯ä¾›é€‰æ‹©ï¼‰&lt;/i&gt;&lt;/li&gt;&lt;li&gt;&lt;i&gt;å®‰è£…äººå·¥æ™ºèƒ½è¡¥å…¨æ’ä»¶TabNine&lt;/i&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;b&gt;1ï¸âƒ£. å®‰è£…VSCode&lt;/b&gt;&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//code.visualstudio.com/&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;code.visualstudio.com/&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;p&gt;2ï¸âƒ£. å®‰è£…è¯­è¨€æœåŠ¡å™¨&lt;/p&gt;&lt;p&gt;æœ‰2ç§é€‰æ‹©&lt;/p&gt;&lt;ul&gt;&lt;li&gt;rlsï¼ˆrust language serverï¼‰å®‰è£…ç®€å•ï¼Œæˆç†Ÿ&lt;/li&gt;&lt;li&gt;rust-analyzerï¼ˆå®˜æ–¹ç»´æŠ¤çš„rls 2.0ï¼‰å®‰è£…ä¼šå¤šå‡ ä¸ªæ­¥éª¤ï¼ŒåŠŸèƒ½å…ˆè¿›ï¼Œä½†è¿˜ä¸å¤Ÿæˆç†Ÿ&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;å¯ä»¥å‚è€ƒ&lt;/p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/76599587&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic2.zhimg.com/v2-f359cb0dd4e941463157dee22e3b1029_180x120.jpg&quot; data-image-width=&quot;2880&quot; data-image-height=&quot;1800&quot; class=&quot;internal&quot;&gt;PrivateRookieï¼šVSCode ä½¿ç”¨ rust-analyzer&lt;/a&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//cloud.tencent.com/developer/news/579920&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Rust Analyzerï¼šä¸€æ¬¾æ—¨åœ¨å¸¦æ¥ä¼˜ç§€IDEä½“éªŒçš„ç¼–è¯‘å™¨&lt;/a&gt;&lt;p&gt;&lt;b&gt;ï¼ˆä¸€ï¼‰è·¯çº¿ï¼šrls&lt;/b&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;b&gt;å®‰è£…rls&lt;/b&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;å®‰è£…è¯­è¨€æœåŠ¡å™¨ï¼Œæ‰§è¡Œ&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;rustup component add rls rust-analysis 

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;2.å®‰è£…Rust(rls)æ’ä»¶&lt;/b&gt;&lt;/p&gt;&lt;p&gt;ç‚¹å‡»ä¸‹é¢çš„é“¾æ¥ï¼Œæ‰“å¼€ç½‘é¡µåç‚¹å‡»installæŒ‰é’®ï¼Œè¿™ä¼šæ‰“å¼€vscodeï¼Œç„¶åinstallå³å¯&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//marketplace.visualstudio.com/items%3FitemName%3Drust-lang.rust&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;marketplace.visualstudio.com&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;/items?itemName=rust-lang.rust&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;p&gt;&lt;b&gt;ï¼ˆäºŒï¼‰è·¯çº¿ï¼šrust-analyzer&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;1. å®‰è£…node.js&lt;/b&gt;&lt;/p&gt;&lt;p&gt;åç»­çš„rust-analyzeréœ€è¦å®‰è£…node.jsï¼Œä¸‹è½½åœ°å€ï¼š&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//nodejs.org/dist/v12.16.0/node-v12.16.0-x64.msi&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;nodejs.org/dist/v12.16.&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;0/node-v12.16.0-x64.msi&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;p&gt;&lt;b&gt;2. ä¸‹è½½rust-analyzer&lt;/b&gt;&lt;/p&gt;&lt;p&gt;ç‚¹å‡»é“¾æ¥ä¸‹è½½è¯­è¨€æœåŠ¡å™¨rust-analyzer-windows.exe&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/rust-analyzer/rust-analyzer/releases&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;rust-analyzer release&lt;/a&gt;&lt;p&gt;ä¸‹è½½é€Ÿåº¦æ…¢çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨2020å¹´2æœˆ17æ—¥çš„ç‰ˆæœ¬ï¼ˆä½¿ç”¨ç™¾åº¦ç½‘ç›˜ä¸‹è½½ï¼‰ï¼Œç„¶åå†æ…¢æ…¢ä¸‹è½½æ–°ç‰ˆæœ¬&lt;/p&gt;&lt;p&gt;é“¾æ¥: &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pan.baidu.com/s/1jY0qhtxu0lSrerdpCSdDiw&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;pan.baidu.com/s/1jY0qht&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;xu0lSrerdpCSdDiw&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt; æå–ç : v3py&lt;/p&gt;&lt;blockquote&gt;å®‰è£…å’Œä½¿ç”¨è¯´æ˜è¿˜å¯ä»¥å‚è€ƒï¼ˆæ¨èå®Œæ•´å®Œæˆåè§‚çœ‹ï¼Œæœ‰å¾ˆå¤šæœ‰ç”¨çš„åŠŸèƒ½ï¼Œæ–‡æœ«ä¹Ÿæœ‰é“¾æ¥ï¼‰ï¼š &lt;br/&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/rust-analyzer/rust-analyzer/blob/master/docs/user/features.md&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;github.com/rust-analyze&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;r/rust-analyzer/blob/master/docs/user/features.md&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;br/&gt; &lt;a href=&quot;https://zhuanlan.zhihu.com/p/76599587&quot; class=&quot;internal&quot;&gt;PrivateRookieï¼šVSCode ä½¿ç”¨ rust-analyzer&lt;/a&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;b&gt;3. å®‰è£…&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/rust-analyzer/rust-analyzer/releases&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;rust-analyzer&lt;/a&gt;æ’ä»¶&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;a. ç§»åŠ¨ rust-analyzer-windows.exe&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;æŠŠå‰é¢ä¸‹è½½çš„rust-analyzer-windows.exeæ”¾åˆ°&amp;#34;C:/Users/ä½ çš„ç”¨æˆ·å/.cargo/bin/æ–‡ä»¶å¤¹ä¸‹ï¼ˆæ³¨æ„ï¼šæ›¿æ¢ä½ çš„ç”¨æˆ·åã€‚ï¼‰&lt;/p&gt;&lt;ul&gt;&lt;li&gt;b. å®‰è£…rust-analyzeræ’ä»¶&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;ç‚¹å‡»ä¸‹é¢çš„é“¾æ¥ï¼Œæ‰“å¼€ç½‘é¡µåç‚¹å‡»installæŒ‰é’®ï¼Œè¿™ä¼šæ‰“å¼€vscodeï¼Œç„¶åinstallå³å¯&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//marketplace.visualstudio.com/items%3FitemName%3Dmatklad.rust-analyzer&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic3.zhimg.com/v2-dab5bad492793d84fe0440ae1828eba2_ipico.jpg&quot; data-image-width=&quot;600&quot; data-image-height=&quot;600&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;rust-analyzer - Visual Studio Marketplace&lt;/a&gt;&lt;p&gt;å®‰è£…åå‡ºç°ï¼šæ²¡æœ‰æ‰¾åˆ°è¯­è¨€æœåŠ¡å™¨ï¼Œæ˜¯å¦ä¸‹è½½ï¼Ÿç‚¹å‡»Cancelï¼ˆä¸‹ä¸€æ­¥æ‰‹åŠ¨è®¾ç½®ï¼‰&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-c6443b16e99fa5932c77ff330645a702_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;448&quot; data-rawheight=&quot;106&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;448&quot; data-original=&quot;https://pic3.zhimg.com/v2-c6443b16e99fa5932c77ff330645a702_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-c6443b16e99fa5932c77ff330645a702_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;448&quot; data-rawheight=&quot;106&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;448&quot; data-original=&quot;https://pic3.zhimg.com/v2-c6443b16e99fa5932c77ff330645a702_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-c6443b16e99fa5932c77ff330645a702_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;ul&gt;&lt;li&gt;c. æ’ä»¶è®¾ç½®è¯­è¨€æœåŠ¡å™¨è·¯å¾„&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;vscodeä¸­æŒ‰ä¸‹F1ï¼Œè¾“å…¥open settingsï¼Œé€‰æ‹©å›¾ä¸­æ— Defaultå­—æ ·çš„&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-4ace4905c2a4b351e6c50a6190e3ff81_b.png&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;606&quot; data-rawheight=&quot;93&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;606&quot; data-original=&quot;https://pic2.zhimg.com/v2-4ace4905c2a4b351e6c50a6190e3ff81_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-4ace4905c2a4b351e6c50a6190e3ff81_b.png&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;606&quot; data-rawheight=&quot;93&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;606&quot; data-original=&quot;https://pic2.zhimg.com/v2-4ace4905c2a4b351e6c50a6190e3ff81_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-4ace4905c2a4b351e6c50a6190e3ff81_b.png&quot;/&gt;&lt;/figure&gt;&lt;p&gt;åœ¨setting.jsonæœ€åä¸€è¡Œæ·»åŠ è¯­è¨€æœåŠ¡å™¨çš„è·¯å¾„ï¼Œæ³¨æ„æ›¿æ¢[ä½ çš„ç”¨æˆ·å]&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-9e566f295a2fabb5b8a7c6c357ae17c3_b.png&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;704&quot; data-rawheight=&quot;46&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;704&quot; data-original=&quot;https://pic4.zhimg.com/v2-9e566f295a2fabb5b8a7c6c357ae17c3_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-9e566f295a2fabb5b8a7c6c357ae17c3_b.png&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;704&quot; data-rawheight=&quot;46&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;704&quot; data-original=&quot;https://pic4.zhimg.com/v2-9e566f295a2fabb5b8a7c6c357ae17c3_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-9e566f295a2fabb5b8a7c6c357ae17c3_b.png&quot;/&gt;&lt;/figure&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-json&quot;&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;rust-analyzer.serverPath&amp;#34;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;C:/Users/ä½ çš„ç”¨æˆ·å/.cargo/bin/rust-analyzer-windows.exe&amp;#34;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;,&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;3ï¸âƒ£. å®‰è£…TabNineæ’ä»¶(rlså’Œrust-analyzeréƒ½æ¨èå®‰è£…)&lt;/b&gt;&lt;/p&gt;&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªäººå·¥æ™ºèƒ½è¡¥å…¨å·¥å…·ï¼ŒåŠŸèƒ½éå¸¸å¼ºå¤§&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//marketplace.visualstudio.com/items%3FitemName%3DTabNine.tabnine-vscode&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic2.zhimg.com/v2-72fb9fafaecc159d816e9d0c2d22067d_ipico.jpg&quot; data-image-width=&quot;256&quot; data-image-height=&quot;256&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TabNine - Visual Studio Marketplace&lt;/a&gt;&lt;p&gt;åé¢å››.2éƒ¨åˆ†ä¼šè®²åˆ°å¦‚ä½•æ¿€æ´»Rustçš„äººå·¥æ™ºèƒ½è¡¥å…¨ã€‚ &lt;/p&gt;&lt;hr/&gt;&lt;h2&gt;ä¸‰ã€å®‰è£…è°ƒè¯•å·¥å…·å’Œæ’ä»¶&lt;/h2&gt;&lt;blockquote&gt;å¦‚æœä½ ä¸è¿›è¡Œæ–­ç‚¹è°ƒè¯•ï¼Œè¿™ä¸¤ç±»å·¥å…·å’Œæ’ä»¶æ˜¯ä¸éœ€è¦å®‰è£…çš„ã€‚å¯ä»¥ç•¥è¿‡ç¬¬ä¸‰éƒ¨åˆ†å’Œç¬¬å››éƒ¨åˆ†çš„3, 4ä¸¤å°èŠ‚ã€‚&lt;br/&gt;åé¢å››.5éƒ¨åˆ†è®²äº†ä¸ä½¿ç”¨æ–­ç‚¹è°ƒè¯•ï¼Œè€Œæ˜¯è®¾ç½®F5ä¸€é”®è¿è¡Œcargo runå‘½ä»¤ã€‚&lt;/blockquote&gt;&lt;ol&gt;&lt;li&gt;&lt;i&gt;gnuè°ƒè¯•å·¥å…·å’Œæ’ä»¶&lt;/i&gt;&lt;/li&gt;&lt;li&gt;&lt;i&gt;msvcè°ƒè¯•å·¥å…·å’Œæ’ä»¶&lt;/i&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;æ ¹æ®å®‰è£…rustæ—¶çš„é€‰é¡¹ï¼Œgnuå’Œmsvcå·¥å…·é“¾äºŒé€‰ä¸€ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;ï¼ˆä¸€ï¼‰è·¯çº¿ï¼šgnuå·¥å…·é“¾&lt;/b&gt;&lt;/p&gt;&lt;p&gt;è¿™é‡Œæˆ‘ä»¬é€‰æ‹©ç®€å•çš„mingw-w64ï¼Œè¿˜å¯ä»¥é€‰æ‹©&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//www.msys2.org/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;msys2&lt;/a&gt;ç­‰ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;1. å®‰è£…MinGW-w64&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;ä¸‹è½½MinGW-w64&lt;/li&gt;&lt;/ul&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//nchc.dl.sourceforge.net/project/mingw-w64/Toolchains%2520targetting%2520Win32/Personal%2520Builds/mingw-builds/installer/mingw-w64-install.exe&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;ç‚¹å‡»ä¸‹è½½MinGW-w64&lt;/a&gt;&lt;ul&gt;&lt;li&gt;è®¾ç½®é€‰é¡¹ï¼ˆ64ä½ï¼‰&lt;/li&gt;&lt;/ul&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-ea07d041f23aff95cfe385bdcc5888f3_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;267&quot; data-rawheight=&quot;125&quot; class=&quot;content_image&quot; width=&quot;267&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-ea07d041f23aff95cfe385bdcc5888f3_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;267&quot; data-rawheight=&quot;125&quot; class=&quot;content_image lazy&quot; width=&quot;267&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-ea07d041f23aff95cfe385bdcc5888f3_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;ul&gt;&lt;li&gt;å®‰è£…å¹¶è®¾ç½®ç¯å¢ƒå˜é‡ï¼ˆï¼è¯·ä½¿ç”¨é»˜è®¤è·¯å¾„å®‰è£…ï¼Œå¦åˆ™è¯·æ‰‹åŠ¨è®¾ç½®ç¯å¢ƒå˜é‡ï¼‰&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;ä½¿ç”¨powershellè®¾ç½®ç¯å¢ƒå˜é‡&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$path&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;[environment]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;GetEnvironmentvariable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Path&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;User&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$mingw_path&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$env:programfiles&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mingw-w64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;\*\&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mingw64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bin&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$mingw_path&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$mingw_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$path&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$mingw_path&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;;&amp;#34;&lt;/span&gt;
&lt;span class=&quot;no&quot;&gt;[environment]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SetEnvironmentvariable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;Path&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;User&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;blockquote&gt;æˆ‘ä»¬è¦ç”¨çš„æ˜¯MinGW-w64ä¸­çš„gdbè°ƒè¯•å·¥å…·&lt;br/&gt;&lt;b&gt;32ä½&lt;/b&gt;æˆ–è¯¦ç»†è®¾ç½®è¯·å‚è€ƒæ­¤æ–‡ï¼š&lt;a href=&quot;https://zhuanlan.zhihu.com/p/76613134&quot; class=&quot;internal&quot;&gt;Cè¯­è¨€å…³æ³¨ï¼šMinGW-w64å®‰è£…æ•™ç¨‹â€”â€”è‘—åC/C++ç¼–è¯‘å™¨GCCçš„Windowsç‰ˆæœ¬&lt;/a&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;b&gt;2. å®‰è£…æ’ä»¶Native Debugï¼ˆgnuå·¥å…·é“¾ï¼‰&lt;/b&gt;&lt;/p&gt;&lt;p&gt;å®‰è£…æ­¥éª¤åŒrust-analyzeræ’ä»¶&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//marketplace.visualstudio.com/items%3FitemName%3Dwebfreak.debug&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;marketplace.visualstudio.com&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;/items?itemName=webfreak.debug&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;p&gt;&lt;b&gt;ï¼ˆäºŒï¼‰è·¯çº¿ï¼šmsvcå·¥å…·é“¾&lt;/b&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;b&gt;ä¸‹è½½å®‰è£…Visual Studio 2019 ç”Ÿæˆå·¥å…·ï¼ˆbuild toolsï¼‰&lt;/b&gt;&lt;/li&gt;&lt;/ol&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//visualstudio.microsoft.com/thank-you-downloading-visual-studio/%3Fsku%3DBuildTools%26rel%3D16&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Thank you for downloading Visual Studio - Visual Studio&lt;/a&gt;&lt;p&gt;è¿è¡Œåï¼Œé€‰æ‹©c++ ç”Ÿæˆå·¥å…·ï¼Œå®‰è£…å³å¯&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-bcb5e77c7e4c973b0c74ad6f865677bd_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;423&quot; data-rawheight=&quot;182&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;423&quot; data-original=&quot;https://pic2.zhimg.com/v2-bcb5e77c7e4c973b0c74ad6f865677bd_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-bcb5e77c7e4c973b0c74ad6f865677bd_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;423&quot; data-rawheight=&quot;182&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;423&quot; data-original=&quot;https://pic2.zhimg.com/v2-bcb5e77c7e4c973b0c74ad6f865677bd_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-bcb5e77c7e4c973b0c74ad6f865677bd_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;å¦‚æœä½ å·²ç»å®‰è£…äº†Visual Studioï¼Œå°±æ— éœ€å®‰è£…build toolsï¼Œ&lt;/p&gt;&lt;p&gt;ç›´æ¥åœ¨å·¥å…·â€”â€”è·å–å·¥å…·å’ŒåŠŸèƒ½ä¸­ï¼Œå‹¾é€‰c++æ¡Œé¢å¼€å‘ï¼Œå®‰è£…å³å¯&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-d7e7f58cda2317537c2ca59f7da54192_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;418&quot; data-rawheight=&quot;100&quot; class=&quot;content_image&quot; width=&quot;418&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-d7e7f58cda2317537c2ca59f7da54192_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;418&quot; data-rawheight=&quot;100&quot; class=&quot;content_image lazy&quot; width=&quot;418&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-d7e7f58cda2317537c2ca59f7da54192_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;2. å®‰è£…æ’ä»¶C/C++&lt;/b&gt;&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//marketplace.visualstudio.com/items%3FitemName%3Dms-vscode.cpptools&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic2.zhimg.com/v2-6eb859650c118358e52746c25c4e603d_ipico.jpg&quot; data-image-width=&quot;128&quot; data-image-height=&quot;128&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;C/C++ - Visual Studio Marketplace&lt;/a&gt;&lt;hr/&gt;&lt;h2&gt;å››ã€å»ºç«‹é¡¹ç›®å¹¶è¿›è¡Œè°ƒè¯•è®¾ç½®&lt;/h2&gt;&lt;ol&gt;&lt;li&gt;&lt;i&gt;åˆ›å»ºé¡¹ç›®å¹¶æ‰“å¼€&lt;/i&gt;&lt;/li&gt;&lt;li&gt;&lt;i&gt;æ¿€æ´»TabNineå¯¹Rustçš„è¡¥å…¨&lt;/i&gt;&lt;/li&gt;&lt;li&gt;&lt;i&gt;è¿›è¡Œé¡¹ç›®çš„è°ƒè¯•è®¾ç½®ï¼ˆä½¿ç”¨æ–­ç‚¹è°ƒè¯•ï¼‰&lt;/i&gt;&lt;/li&gt;&lt;li&gt;&lt;i&gt;è¯•éªŒè°ƒè¯•åŠŸèƒ½ï¼ˆä½¿ç”¨æ–­ç‚¹è°ƒè¯•ï¼‰&lt;/i&gt;&lt;/li&gt;&lt;li&gt;F5ä¸€é”®è¿è¡Œ&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;b&gt;1 .åˆ›å»ºé¡¹ç›®å¹¶åœ¨VSCodeé‡Œæ‰“å¼€&lt;/b&gt;&lt;/p&gt;&lt;p&gt;æ¯”å¦‚hello_worldï¼Œä»¥æµ‹è¯•è°ƒè¯•åŠŸèƒ½&lt;/p&gt;&lt;ul&gt;&lt;li&gt;åœ¨vscodeä¸­æŒ‰ä¸‹ &lt;b&gt;Ctrl + ` &lt;/b&gt;ï¼ˆé”®ç›˜Tabä¸Šé¢çš„é”®ï¼‰æ‰“å¼€powershel&lt;/li&gt;&lt;li&gt;åˆ‡æ¢åˆ°ä½ æƒ³åˆ›å»ºé¡¹ç›®çš„ç›®å½•(æ¯”å¦‚D:)&lt;/li&gt;&lt;li&gt;ä½¿ç”¨cargoåˆ›å»ºé¡¹ç›®ï¼ˆå¦åˆ™vscodeä¼šæç¤ºç¼ºå°‘Cargo.tomlæ–‡ä»¶ï¼‰&lt;/li&gt;&lt;/ul&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot;&gt;&lt;span class=&quot;n&quot;&gt;cd&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;:&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;cargo&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hello_world&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;&lt;li&gt;ä½¿ç”¨Open FolderæŒ‰é’®æ‰“å¼€ä½ çš„hello_worldç›®å½•&lt;/li&gt;&lt;li&gt;å•å‡»åˆ—è¡¨ä¸­çš„main.rsæ–‡ä»¶ï¼Œæ‰“å¼€å®ƒ&lt;/li&gt;&lt;/ul&gt;&lt;a class=&quot;video-box&quot; href=&quot;https://link.zhihu.com/?target=https%3A//www.zhihu.com/video/1180629229510811648&quot; target=&quot;_blank&quot; data-video-id=&quot;&quot; data-video-playable=&quot;true&quot; data-name=&quot;ç¬¬1éƒ¨åˆ†æ“ä½œ&quot; data-poster=&quot;https://pic4.zhimg.com/v2-e1eb04cc80cd25bc83b83d54272c1f23.jpg&quot; data-lens-id=&quot;1180629229510811648&quot;&gt;&lt;img class=&quot;thumbnail&quot; src=&quot;https://pic4.zhimg.com/v2-e1eb04cc80cd25bc83b83d54272c1f23.jpg&quot;/&gt;&lt;span class=&quot;content&quot;&gt;&lt;span class=&quot;title&quot;&gt;ç¬¬1éƒ¨åˆ†æ“ä½œ&lt;span class=&quot;z-ico-extern-gray&quot;&gt;&lt;/span&gt;&lt;span class=&quot;z-ico-extern-blue&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;url&quot;&gt;&lt;span class=&quot;z-ico-video&quot;&gt;&lt;/span&gt;https://www.zhihu.com/video/1180629229510811648&lt;/span&gt;&lt;/span&gt;&lt;/a&gt;&lt;p&gt;&lt;b&gt;2. æ¿€æ´»TabNineå¯¹Rustçš„è¡¥å…¨&lt;/b&gt;&lt;/p&gt;&lt;p&gt;TabNineçš„äººå·¥æ™ºèƒ½è¡¥å…¨ï¼Œéœ€è¦åœ¨ç›¸åº”ç¼–ç¨‹è¯­è¨€çš„æ–‡ä»¶é‡Œç¼–è¾‘æ¨¡å¼ä¸‹è¾“å…¥TabNine::semæ‰“å¼€&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-3dada63553431da1b9336fda78efa617_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;826&quot; data-rawheight=&quot;212&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;826&quot; data-original=&quot;https://pic4.zhimg.com/v2-3dada63553431da1b9336fda78efa617_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-3dada63553431da1b9336fda78efa617_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;826&quot; data-rawheight=&quot;212&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;826&quot; data-original=&quot;https://pic4.zhimg.com/v2-3dada63553431da1b9336fda78efa617_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-3dada63553431da1b9336fda78efa617_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;è¿™æ ·.rsä¸­æ–‡ä»¶è¾“å…¥åï¼Œä¼šæ‰“å¼€Rustçš„äººå·¥æ™ºèƒ½è¡¥å…¨&lt;/p&gt;&lt;p&gt;å¦‚æœå½±å“æ€§èƒ½ï¼Œå¯ä»¥è¾“å…¥TabNine::nosemå…³é—­&lt;/p&gt;&lt;blockquote&gt;å¦‚æœä½ ä½¿ç”¨çš„æ˜¯rust-analyzerï¼ŒTabNineè¿˜ä¼šè‡ªåŠ¨å®‰è£…rlså’Œracerç­‰ &lt;/blockquote&gt;&lt;p&gt;&lt;b&gt;3. è¿›è¡Œé¡¹ç›®çš„è°ƒè¯•è®¾ç½®&lt;/b&gt;&lt;i&gt;ï¼ˆä½¿ç”¨æ–­ç‚¹è°ƒè¯•ï¼‰&lt;/i&gt;&lt;b&gt;ï¼š&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;æ‰“å¼€è°ƒè¯•çª—å£ï¼ˆå·¦ä¾§æ˜†è™«å›¾æ ‡ï¼‰&lt;/li&gt;&lt;li&gt;ç‚¹å‡»è®¾ç½®å›¾æ ‡ï¼ˆé½¿è½®ï¼‰&lt;/li&gt;&lt;li&gt;é€‰æ‹©å¼¹å‡ºçš„GDBï¼ˆmsvcä¸ºï¼‰&lt;/li&gt;&lt;li&gt;ä¿®æ”¹&lt;b&gt;launch.json&lt;/b&gt;ä¸­çš„&lt;i&gt;target&lt;/i&gt;é¡¹ï¼ˆmsvcä¸ºprogramé¡¹ï¼‰ï¼Œå¹¶æ·»åŠ  &lt;i&gt;preLaunchTaské¡¹&lt;/i&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;a. è·¯çº¿ï¼šgnu&lt;/p&gt;&lt;ul&gt;&lt;li&gt;é€‰æ‹©å¼¹å‡ºçš„GDB&lt;/li&gt;&lt;li&gt;ä¿®æ”¹&lt;b&gt;launch.json&lt;/b&gt;ä¸­çš„&lt;i&gt;target&lt;/i&gt;é¡¹ï¼Œå¹¶æ·»åŠ  &lt;i&gt;preLaunchTaské¡¹&lt;/i&gt;&lt;/li&gt;&lt;/ul&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-json&quot;&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;target&amp;#34;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;./target/debug/${workspaceFolderBasename}.exe&amp;#34;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;,&lt;/span&gt; 
&lt;span class=&quot;s2&quot;&gt;&amp;#34;preLaunchTask&amp;#34;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;build&amp;#34;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;,&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;b. è·¯çº¿ï¼šmsvc&lt;/p&gt;&lt;ul&gt;&lt;li&gt;é€‰æ‹©å¼¹å‡ºçš„c++ windows&lt;/li&gt;&lt;li&gt;ä¿®æ”¹&lt;b&gt;launch.json&lt;/b&gt;ä¸­çš„&lt;i&gt;program&lt;/i&gt;é¡¹ï¼Œå¹¶æ·»åŠ  &lt;i&gt;preLaunchTaské¡¹&lt;/i&gt;&lt;br/&gt;&lt;/li&gt;&lt;/ul&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-json&quot;&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;program&amp;#34;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;./target/debug/${workspaceFolderBasename}.exe&amp;#34;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;,&lt;/span&gt; 
&lt;span class=&quot;s2&quot;&gt;&amp;#34;preLaunchTask&amp;#34;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;build&amp;#34;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;,&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¸¤ç§è·¯çº¿éƒ½éœ€è¦VSCodeè‡ªåŠ¨ç”Ÿæˆtasks.json(é€‰æ‹©ä»templateç”Ÿæˆâ€”&amp;gt;others)&lt;/p&gt;&lt;ul&gt;&lt;li&gt;ä¿®æ”¹&lt;b&gt;tasks.json&lt;/b&gt;ä¸­çš„&lt;i&gt;label&lt;/i&gt;é¡¹å’Œcommandé¡¹ä¸º&lt;/li&gt;&lt;/ul&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-json&quot;&gt;&lt;span class=&quot;s2&quot;&gt;&amp;#34;label&amp;#34;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;build&amp;#34;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&amp;#34;command&amp;#34;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;cargo build&amp;#34;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;,&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;a class=&quot;video-box&quot; href=&quot;https://link.zhihu.com/?target=https%3A//www.zhihu.com/video/1180776456249159680&quot; target=&quot;_blank&quot; data-video-id=&quot;&quot; data-video-playable=&quot;true&quot; data-name=&quot;ç¬¬2éƒ¨åˆ†æ“ä½œ&quot; data-poster=&quot;https://pic3.zhimg.com/v2-4b4a6c5889c37303d48728502863f06a.jpg&quot; data-lens-id=&quot;1180776456249159680&quot;&gt;&lt;img class=&quot;thumbnail&quot; src=&quot;https://pic3.zhimg.com/v2-4b4a6c5889c37303d48728502863f06a.jpg&quot;/&gt;&lt;span class=&quot;content&quot;&gt;&lt;span class=&quot;title&quot;&gt;ç¬¬2éƒ¨åˆ†æ“ä½œ&lt;span class=&quot;z-ico-extern-gray&quot;&gt;&lt;/span&gt;&lt;span class=&quot;z-ico-extern-blue&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;url&quot;&gt;&lt;span class=&quot;z-ico-video&quot;&gt;&lt;/span&gt;https://www.zhihu.com/video/1180776456249159680&lt;/span&gt;&lt;/span&gt;&lt;/a&gt;&lt;p&gt;&lt;b&gt;4. ä¿®æ”¹main.rsçš„å†…å®¹ï¼Œå¹¶åœ¨æ¯è¡Œå‰ç‚¹å‡»å‡ºçº¢ç‚¹ï¼ˆæ–­ç‚¹ï¼‰ï¼Œä»¥æ–¹ä¾¿è§‚å¯Ÿè°ƒè¯•åŠŸèƒ½&lt;/b&gt;&lt;i&gt;ï¼ˆä½¿ç”¨æ–­ç‚¹è°ƒè¯•ï¼‰&lt;/i&gt;&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-rust&quot;&gt;&lt;span class=&quot;k&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;Hello, world!&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;a class=&quot;video-box&quot; href=&quot;https://link.zhihu.com/?target=https%3A//www.zhihu.com/video/1180631885650321408&quot; target=&quot;_blank&quot; data-video-id=&quot;&quot; data-video-playable=&quot;true&quot; data-name=&quot;ç¬¬3éƒ¨åˆ†æ“ä½œ&quot; data-poster=&quot;https://pic2.zhimg.com/v2-d30a0a751ba9f8035d0fe3b5afe2ce15.jpg&quot; data-lens-id=&quot;1180631885650321408&quot;&gt;&lt;img class=&quot;thumbnail&quot; src=&quot;https://pic2.zhimg.com/v2-d30a0a751ba9f8035d0fe3b5afe2ce15.jpg&quot;/&gt;&lt;span class=&quot;content&quot;&gt;&lt;span class=&quot;title&quot;&gt;ç¬¬3éƒ¨åˆ†æ“ä½œ&lt;span class=&quot;z-ico-extern-gray&quot;&gt;&lt;/span&gt;&lt;span class=&quot;z-ico-extern-blue&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;url&quot;&gt;&lt;span class=&quot;z-ico-video&quot;&gt;&lt;/span&gt;https://www.zhihu.com/video/1180631885650321408&lt;/span&gt;&lt;/span&gt;&lt;/a&gt;&lt;blockquote&gt;Tipï¼šVSCodeè°ƒè¯•æ—¶ï¼ŒæŠŠé¼ æ ‡æŒªåŠ¨åˆ°å˜é‡ä¸Šé¢ï¼Œå¯ä»¥æ˜¾ç¤ºå½“å‰å˜é‡å€¼ã€‚&lt;br/&gt;&lt;br/&gt;æƒ³è¦ä¸ç¼–è¯‘ç›´æ¥è¿è¡Œæ—¶ï¼Œåœ¨å½“å‰ç›®å½•ä¸‹ä¸­è¿è¡Œcargo runå‘½ä»¤å³å¯&lt;br/&gt;å¯ä»¥ä½¿ç”¨rustçš„gdb_rust_pretty_printingï¼Œåœ¨è°ƒè¯•ä¸­enums, slices, vectorsç­‰ç»“æ„ä¼šæ›´å¥½åœ°æ˜¾ç¤ºï¼Œä½†ä¹Ÿæœ‰äººè§‰å¾—åœ¨windowsä¸Šä½¿ç”¨è¿™ä¸ªåŠŸèƒ½ä¸å¥½ï¼Œæœ‰æ—¶ä¼šå¯¼è‡´é•¿æ—¶é—´çš„æš‚åœæˆ–å¡æ­»å…·ä½“å‚è€ƒ&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//stackoverflow.com/questions/33570021/how-to-set-up-gdb-for-debugging-rust-programs-in-windows&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;how-to-set-up-gdb-for-debugging-rust-programs-in-windows&lt;/a&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;b&gt;5. F5ä¸€é”®è¿è¡Œ&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;å¦‚æœä½ æ„Ÿè§‰æ¯æ¬¡éƒ½å»ç‚¹åˆ‡æ¢debugçª—å£æ¯”è¾ƒéº»çƒ¦ï¼Œè€Œä¸”ä¹Ÿæš‚æ—¶ä¸éœ€è¦æ–­ç‚¹è°ƒè¯•ã€‚&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;å¦‚æœä½ è¿˜æ²¡æœ‰tasks.jsonæ–‡ä»¶ï¼Œè¯·åœ¨é¡¹ç›®æ ¹ç›®å½•ï¼ˆå›¾ä¸­ä¸ºhelloï¼‰ä¸‹æ–°å»º.vscodeæ–‡ä»¶å¤¹ï¼Œå†åˆ›å»ºtasks.jsonæ–‡ä»¶ï¼Œé¡¹ç›®ç»“æ„ç±»ä¼¼ä¸‹å›¾ã€‚&lt;/b&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-c4a1dd9a6ff35e19dc989e7cff647a01_b.png&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;176&quot; data-rawheight=&quot;167&quot; class=&quot;content_image&quot; width=&quot;176&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-c4a1dd9a6ff35e19dc989e7cff647a01_b.png&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;176&quot; data-rawheight=&quot;167&quot; class=&quot;content_image lazy&quot; width=&quot;176&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-c4a1dd9a6ff35e19dc989e7cff647a01_b.png&quot;/&gt;&lt;/figure&gt;&lt;p&gt;ä¿®æ”¹tasks.jsonå†…å®¹ä¸ºï¼ˆä¹Ÿå¯ä»¥æœ‰å¤šä¸ªtaskï¼Œè¿è¡Œæ—¶æ ¹æ®labelï¼ˆæ ‡ç­¾ï¼‰è¿›è¡ŒåŒºåˆ†ï¼‰&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-json&quot;&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
 &lt;span class=&quot;err&quot;&gt;//&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;See&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;https://go.microsoft.com/fwlink/?LinkId=733558&lt;/span&gt;
 &lt;span class=&quot;err&quot;&gt;//&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;the&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;documentation&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;about&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;the&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;tasks.json&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;format&lt;/span&gt;
 &lt;span class=&quot;nt&quot;&gt;&amp;#34;version&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;2.0.0&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
 &lt;span class=&quot;nt&quot;&gt;&amp;#34;tasks&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
 &lt;span class=&quot;nt&quot;&gt;&amp;#34;label&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;run&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
 &lt;span class=&quot;nt&quot;&gt;&amp;#34;command&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;cargo run&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
 &lt;span class=&quot;nt&quot;&gt;&amp;#34;type&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;#34;shell&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ‰“å¼€å¿«æ·é”®è®¾ç½®ï¼ˆKeyboard Shortcutsï¼‰&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-32f43bf3ff6cb1d93f854de413cf8762_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;308&quot; data-rawheight=&quot;355&quot; class=&quot;content_image&quot; width=&quot;308&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-32f43bf3ff6cb1d93f854de413cf8762_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;308&quot; data-rawheight=&quot;355&quot; class=&quot;content_image lazy&quot; width=&quot;308&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-32f43bf3ff6cb1d93f854de413cf8762_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;è¾“å…¥taskï¼Œå‡ºç°ä¸‹å›¾&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-052f713565e5b4db74ad6cb28eef4b2b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;698&quot; data-rawheight=&quot;558&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;698&quot; data-original=&quot;https://pic4.zhimg.com/v2-052f713565e5b4db74ad6cb28eef4b2b_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-052f713565e5b4db74ad6cb28eef4b2b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;698&quot; data-rawheight=&quot;558&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;698&quot; data-original=&quot;https://pic4.zhimg.com/v2-052f713565e5b4db74ad6cb28eef4b2b_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-052f713565e5b4db74ad6cb28eef4b2b_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;æ‰¾åˆ°å›¾ä¸­çš„Tasks:Rerun Last Taskï¼Œç»™å®ƒè®¾ç½®å¿«æ·é”®F5ã€‚å…·ä½“æ–¹æ³•æ˜¯åŒå‡»è¯¥æ¡ç›®ï¼Œå‡ºç°æç¤ºæ¡†åæŒ‰ä¸‹F5ï¼Œç„¶åå†æŒ‰å›è½¦ã€‚&lt;/p&gt;&lt;p&gt;åœ¨è¯¥æ¡ç›®ä¸Šç‚¹å³é”®ï¼Œé€‰æ‹©Change When Expression&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-fab4d1a7d02c201bcea89eb4fec473f5_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1031&quot; data-rawheight=&quot;272&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1031&quot; data-original=&quot;https://pic2.zhimg.com/v2-fab4d1a7d02c201bcea89eb4fec473f5_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-fab4d1a7d02c201bcea89eb4fec473f5_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1031&quot; data-rawheight=&quot;272&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1031&quot; data-original=&quot;https://pic2.zhimg.com/v2-fab4d1a7d02c201bcea89eb4fec473f5_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-fab4d1a7d02c201bcea89eb4fec473f5_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;å¤åˆ¶ç²˜è´´editorTextFocus &amp;amp;&amp;amp; editorLangId == &amp;#39;rust&amp;#39;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-d146b78f77d2a2f73f1d980416f309b5_b.png&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1083&quot; data-rawheight=&quot;63&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1083&quot; data-original=&quot;https://pic2.zhimg.com/v2-d146b78f77d2a2f73f1d980416f309b5_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-d146b78f77d2a2f73f1d980416f309b5_b.png&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1083&quot; data-rawheight=&quot;63&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1083&quot; data-original=&quot;https://pic2.zhimg.com/v2-d146b78f77d2a2f73f1d980416f309b5_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-d146b78f77d2a2f73f1d980416f309b5_b.png&quot;/&gt;&lt;/figure&gt;&lt;p&gt;è¿™æ ·å°±åªæœ‰rustè¯­è¨€ä¸­æŒ‰ä¸‹F5æ‰æ˜¯è¿™ä¸ªåŠŸèƒ½ã€‚&lt;/p&gt;&lt;p&gt;æˆ‘ä»¬å†æ¥è¯´è¯´è¿™ä¸ªåŠŸèƒ½æ€ä¹ˆç”¨ã€‚æ‰“å¼€main.rsï¼Œç„¶åæŒ‰ä¸‹F5ï¼Œä¼šå‡ºç°runï¼ˆæˆ‘ä»¬å®šä¹‰çš„taskï¼‰+é¡¹ç›®åï¼Œå†æŒ‰ä¸¤ä¸‹å›è½¦é€‰æ‹©å°±è¡Œäº†ã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-e109aa763738aaedcfd2a7d5083524be_b.png&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1029&quot; data-rawheight=&quot;99&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1029&quot; data-original=&quot;https://pic3.zhimg.com/v2-e109aa763738aaedcfd2a7d5083524be_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-e109aa763738aaedcfd2a7d5083524be_b.png&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1029&quot; data-rawheight=&quot;99&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1029&quot; data-original=&quot;https://pic3.zhimg.com/v2-e109aa763738aaedcfd2a7d5083524be_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-e109aa763738aaedcfd2a7d5083524be_b.png&quot;/&gt;&lt;/figure&gt;&lt;p&gt;è¿™æ ·æ§åˆ¶å°ä¼šè‡ªåŠ¨è¿è¡Œcargo runè¿™ä¸ªå‘½ä»¤ï¼Œvscodeæ²¡æœ‰å…³é—­å‰ï¼Œä¸‹æ¬¡æŒ‰ä¸‹F5ä¼šç›´æ¥è¿è¡Œï¼Œä¸å†éœ€è¦å›è½¦é€‰æ‹©ã€‚&lt;/p&gt;&lt;p&gt;è¿™æ ·æˆ‘ä»¬èƒ½å¿«é€Ÿçš„è¿è¡Œè¯¥å‘½ä»¤æŸ¥çœ‹è¾“å‡ºï¼Œä¸éœ€è¦æ‰‹åŠ¨åˆ‡æ¢åˆ°debugç•Œé¢ã€‚&lt;/p&gt;&lt;hr/&gt;&lt;h2&gt;äº”ã€é™„å½•ï¼šrustlingsçš„ä½¿ç”¨(å¼ºçƒˆæ¨è)&lt;/h2&gt;&lt;ol&gt;&lt;li&gt;&lt;i&gt;å®‰è£…rustlings&lt;/i&gt;&lt;/li&gt;&lt;li&gt;&lt;i&gt;ä½¿ç”¨rustlings&lt;/i&gt;&lt;/li&gt;&lt;li&gt;&lt;i&gt;æ ¹æ®ç¼–è¯‘é”™è¯¯ä¿®æ”¹æ–‡ä»¶ä»¥é€šå…³&lt;/i&gt;&lt;/li&gt;&lt;li&gt;&lt;i&gt;æ€»ç»“ä¸Tip&lt;/i&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/rust-lang/rustlings&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;rustlings&lt;/a&gt;æ˜¯å®˜æ–¹çš„æ•™å­¦æ¸¸æˆï¼Œå®ƒçš„ç©æ³•ç±»ä¼¼è§£å¯†æ¸¸æˆã€‚é€šè¿‡è§£å†³ç¨‹åºä¸­çš„é”™è¯¯é€šè¿‡å…³å¡ã€‚&lt;/p&gt;&lt;p&gt;å®ƒä½œä¸ºå’Œæ–‡æ¡£ã€&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//doc.rust-lang.org/rust-by-example/index.html&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;rust-by-example&lt;/a&gt;ä¸‰è¶³é¼åŠ›çš„æ–°æ‰‹å…¥é—¨æ•™ç¨‹ï¼Œç¡®å®è®©äººæ„Ÿè§‰åˆ°å¥½ç©ã€æƒŠè‰³ã€‚&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;b&gt;å®‰è£…rustlings&lt;/b&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;åœ¨powershellä¸­æ‰§è¡Œï¼Œé€‰æ‹©y&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;set-executionpolicy remotesigned

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ¥ç€æ‰§è¡Œï¼ˆæ³¨æ„cdåˆ°ä½ æƒ³æ”¾é¡¹ç›®çš„æ–‡ä»¶å¤¹ï¼‰&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot;&gt;&lt;span class=&quot;n&quot;&gt;cd&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$home&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;/.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rustup&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;/&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;Invoke-WebRequest&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;https&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;git&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;io&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rustlings-win&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Select-Object&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;-ExpandProperty&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Content&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Out-File&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$env:TMP&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;install_rustlings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ps1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Unblock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-File&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$env:TMP&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;install_rustlings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ps1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Invoke-Expression&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$env:TMP&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;install_rustlings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ps1&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¦‚æœå¤±è´¥çš„è¯ï¼Œè¯·æ‰‹åŠ¨ä¸‹è½½å®‰è£…&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-powershell&quot;&gt;&lt;span class=&quot;n&quot;&gt;git&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;clone&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;https&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;github&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rust-lang&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rustlings&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;cd&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rustlings&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;git&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;checkout&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tags&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# or whatever the latest version is (find out at https://github.com/rust-lang/rustlings/releases/latest)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;cargo&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;-force&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;-path&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¦‚æœæœ‰å®‰è£…é”™è¯¯ï¼Œç¡®ä¿å·¥å…·é“¾æ˜¯æœ€æ–°çš„:&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;rustup update

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;2. ä½¿ç”¨rustlings&lt;/b&gt;&lt;/p&gt;&lt;p&gt;éœ€è¦åœ¨rustlingsç›®å½•ä¸‹æ‰§è¡Œ&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;rustlings watch

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å»ºè®®åœ¨vscodeä¸­æ‰“å¼€è¿™ä¸ªæ–‡ä»¶å¤¹ï¼Œç„¶åæ¯æ¬¡åœ¨powershellä¸­è¿è¡Œã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-363b7c67f2b6e69a85b10dd5bcc35c8d_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;421&quot; data-rawheight=&quot;210&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;421&quot; data-original=&quot;https://pic2.zhimg.com/v2-363b7c67f2b6e69a85b10dd5bcc35c8d_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-363b7c67f2b6e69a85b10dd5bcc35c8d_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;421&quot; data-rawheight=&quot;210&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;421&quot; data-original=&quot;https://pic2.zhimg.com/v2-363b7c67f2b6e69a85b10dd5bcc35c8d_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-363b7c67f2b6e69a85b10dd5bcc35c8d_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;3. æ ¹æ®å¼¹å‡ºçš„ç¼–è¯‘é”™è¯¯ä¿®æ”¹exercisesä¸­çš„æ–‡ä»¶&lt;/b&gt;&lt;/p&gt;&lt;p&gt;rustlingsä¼šæ ¹æ®æ¦‚å¿µéš¾æ˜“çš„é¡ºåºé€ä¸ªç¼–è¯‘æ–‡ä»¶ï¼Œå½“ç¼–è¯‘é”™è¯¯çš„æ—¶å€™ï¼Œä½ éœ€è¦å»ä¿®æ­£è¯¥é”™è¯¯æ–‡ä»¶å¹¶ä¿å­˜ã€‚&lt;/p&gt;&lt;blockquote&gt;æ³¨æ„ï¼šä¸è¦å…³é—­rustlings watchè¿è¡Œçš„çª—å£ï¼Œå®ƒä¼šè‡ªåŠ¨æ£€æµ‹ä½ ä¿®æ”¹ä¿å­˜çš„æ–‡ä»¶&lt;/blockquote&gt;&lt;p&gt;ä¿®æ”¹å®Œæˆä¹‹åï¼Œå¦‚æœè¦è·³è‡³ä¸‹ä¸€å…³ï¼Œåˆ™éœ€è¦æŠŠå½“å‰å…³æ–‡ä»¶ä¸­çš„è¯¥è¡Œæ³¨é‡Šåˆ é™¤ä¿å­˜ã€‚&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-rust&quot;&gt;&lt;span class=&quot;c1&quot;&gt;//I AM NOT DONE
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;4. æµç¨‹æ€»ç»“ä¸Tip&lt;/b&gt;&lt;/p&gt;&lt;p&gt;æµç¨‹å°±æ˜¯ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;çœ‹æ–‡æ¡£&lt;/li&gt;&lt;li&gt;å†çœ‹example&lt;/li&gt;&lt;li&gt;å†åˆ·rustlingsé€šå…³&lt;/li&gt;&lt;/ul&gt;&lt;blockquote&gt;æ³¨æ„ï¼šåœ¨exercisesæ–‡ä»¶å¤¹çš„æ¯ä¸ªåˆ†ç±»ä¸­ï¼Œéƒ½æœ‰ä¸€ä¸ªREADMEï¼Œé‡Œé¢æœ‰å½“å‰åˆ†ç±»å¯¹åº”çš„&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//doc.rust-lang.org/rust-by-example/index.html&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;rust-by-example&lt;/a&gt;çš„åœ°å€ï¼Œæ¨èå…ˆçœ‹å†åšé¢˜ã€‚&lt;br/&gt;Rustä¸­æ–‡æ–‡æ¡£åœ°å€ï¼š&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//kaisery.github.io/trpl-zh-cn/foreword.html&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;kaisery.github.io/trpl-&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;zh-cn/foreword.html&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;br/&gt;æç¤ºï¼šå¼¹å‡ºç¼–è¯‘é”™è¯¯æ—¶ï¼Œåœ¨VSCodeä¸­æŒ‰ä½Ctrlç‚¹å‡»è¯¥æ–‡ä»¶åï¼Œä¼šç›´æ¥æ‰“å¼€è¯¥æ–‡ä»¶&lt;/blockquote&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-4d29bd12bec90e68a3ea28fee8f10cdc_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;615&quot; data-rawheight=&quot;115&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;615&quot; data-original=&quot;https://pic1.zhimg.com/v2-4d29bd12bec90e68a3ea28fee8f10cdc_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-4d29bd12bec90e68a3ea28fee8f10cdc_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;615&quot; data-rawheight=&quot;115&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;615&quot; data-original=&quot;https://pic1.zhimg.com/v2-4d29bd12bec90e68a3ea28fee8f10cdc_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-4d29bd12bec90e68a3ea28fee8f10cdc_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;å¦‚æœ‰é”™è¯¯ï¼Œè¯·ä¸åå‘ŠçŸ¥ï¼&lt;/b&gt;&lt;/h2&gt;&lt;h2&gt;&lt;b&gt;è§‰å¾—å¥½çš„è¯ï¼Œè¯·&lt;/b&gt;ç‚¹èµæ”¶è—&lt;b&gt;ï¼è®©çŸ¥ä¹å‘ˆç°æ›´å¤šä½ å–œæ¬¢çš„ä¸œè¥¿ã€‚&lt;/b&gt;&lt;/h2&gt;&lt;h2&gt;&lt;b&gt;å¦‚æœä½ æ˜¯åˆå­¦è€…çš„è¯ï¼Œå»ºè®®æŠŠæœ¬ç½‘é¡µæ·»åŠ åˆ°æµè§ˆå™¨ä¹¦ç­¾ï¼ˆCtrl+ Dï¼‰ï¼Œå¯ä»¥ç»å¸¸æµè§ˆä¸‹é¢çš„å¸¸ç”¨é“¾æ¥ã€‚&lt;/b&gt;&lt;/h2&gt;&lt;hr/&gt;&lt;h2&gt;å¸¸ç”¨é“¾æ¥ï¼š&lt;/h2&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//kaisery.github.io/trpl-zh-cn/foreword.html&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Rust ä¸­æ–‡æ–‡æ¡£&lt;/a&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//doc.rust-lang.org/rust-by-example/index.html&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Introduction - Rust By Example&lt;/a&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//cargo.budshome.com/index.html&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Cargo - Cargo ä¸­æ–‡æ–‡æ¡£&lt;/a&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/rust-analyzer/rust-analyzer/blob/master/docs/user/features.md&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;rust-analyzer features&lt;/a&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/76599587&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic2.zhimg.com/v2-f359cb0dd4e941463157dee22e3b1029_180x120.jpg&quot; data-image-width=&quot;2880&quot; data-image-height=&quot;1800&quot; class=&quot;internal&quot;&gt;PrivateRookieï¼šVSCode ä½¿ç”¨ rust-analyzer&lt;/a&gt;&lt;h2&gt;å‚è€ƒæ–‡ç« ï¼š&lt;/h2&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/27910168&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic1.zhimg.com/v2-d5a4e7af5aad6e908d26c2c09a90ed68_180x120.jpg&quot; data-image-width=&quot;800&quot; data-image-height=&quot;425&quot; class=&quot;internal&quot;&gt;DCjanusï¼šã€æ–°æ‰‹å‘ã€‘ä»é›¶å¼€å§‹é…ç½®Windowsä¸‹Rustå¼€å‘ç¯å¢ƒå›¾è§£&lt;/a&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/27782375&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; class=&quot;internal&quot;&gt;CrLF0710ï¼šRust ç¯å¢ƒé…ç½®äº‹é¡¹ä¸€è§ˆ&lt;/a&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//www.cnblogs.com/kileyi/p/11367866.html&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic4.zhimg.com/v2-75446c6c352b21ac414abe074b014cab_180x120.jpg&quot; data-image-width=&quot;510&quot; data-image-height=&quot;400&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Win7 VSCode ç¦»çº¿å®‰è£…Rustè¯­è¨€åŠç¯å¢ƒé…ç½®&lt;/a&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/64344775&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; class=&quot;internal&quot;&gt;Matrixï¼šRustå’ŒWindowsä¸å¾—ä¸è¯´çš„äº‹å„¿&lt;/a&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>é›¾è‰²</author>
<guid isPermaLink="false">2020-02-25-92172591</guid>
<pubDate>Tue, 25 Feb 2020 00:00:00 +0800</pubDate>
</item>
<item>
<title>Rust + Flutter é«˜æ€§èƒ½çš„è·¨ç«¯å°è¯•</title>
<link>https://henix.github.io/feeds/zhuanlan.rust-lang/2020-02-21-108308284.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/108308284&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-3dfc36e0e68d4715ec042b5f3f8562a9_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;ç¨ä½œé…ç½®ï¼ŒåŒä¸€ä»½ä»£ç æ¨ªè·¨ Android &amp;amp; IOSï¼Œç›¸æ¯”äº React Native æ–¹æ¡ˆæ›´åŠ é«˜æ€§èƒ½ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œå¾—ç›Šäº Rust è·¨å¹³å°åŠ æŒï¼ŒRust éƒ¨åˆ†çš„ä»£ç å¯åœ¨ç§ç§åœºåˆå¤ç”¨ã€‚&lt;/p&gt;&lt;p&gt;è¿™ç¯‡æ–‡ç« æ—¨åœ¨è®°å½•ä½œè€…å°è¯•ç»“åˆ Rust å’Œ Flutter çš„è¿‡ç¨‹ï¼Œä¸”ä»…ä¸ºåˆæ­¥å°è¯•ã€‚ä¸ä¼šæ¶‰åŠè¯¸å¦‚ï¼š&lt;/p&gt;&lt;p&gt; å¦‚ä½•æ­å»ºä¸€ä¸ª Flutter å¼€å‘ç¯å¢ƒï¼Œä»¥åŠ Dart è¯­è¨€æ€ä¹ˆç”¨ &lt;/p&gt;&lt;p&gt; å¦‚ä½•æ­å»ºä¸€ä¸ª Rust å¼€å‘ç¯å¢ƒï¼Œä»¥åŠ Rust è¯­è¨€æ€ä¹ˆå­¦&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;å¼€å¤´ç»™è‡ªå·±åšå®¢æ‰“æ³¢å¹¿å‘ŠğŸ‘‡&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//blog.idx0.dev/2020/02/15/flutter-rust-1/&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic2.zhimg.com/v2-3dfc36e0e68d4715ec042b5f3f8562a9_180x120.jpg&quot; data-image-width=&quot;1356&quot; data-image-height=&quot;1070&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Rust + Flutter é«˜æ€§èƒ½çš„è·¨ç«¯å°è¯•&lt;/a&gt;&lt;h2&gt;Environment&lt;/h2&gt;&lt;ul&gt;&lt;li&gt;Flutter: Android, IOS å·¥å…·é…ç½®å¦¥å½“   &lt;/li&gt;&lt;/ul&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-c58477665a91f3af41629d66930fb2e2_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1344&quot; data-rawheight=&quot;420&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1344&quot; data-original=&quot;https://pic3.zhimg.com/v2-c58477665a91f3af41629d66930fb2e2_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-c58477665a91f3af41629d66930fb2e2_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1344&quot; data-rawheight=&quot;420&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1344&quot; data-original=&quot;https://pic3.zhimg.com/v2-c58477665a91f3af41629d66930fb2e2_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-c58477665a91f3af41629d66930fb2e2_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Rust: Stable å°±å¥½   &lt;/li&gt;&lt;/ul&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-0370ff9fd40521e643ed14fa41c7186e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1026&quot; data-rawheight=&quot;204&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1026&quot; data-original=&quot;https://pic3.zhimg.com/v2-0370ff9fd40521e643ed14fa41c7186e_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-0370ff9fd40521e643ed14fa41c7186e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1026&quot; data-rawheight=&quot;204&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1026&quot; data-original=&quot;https://pic3.zhimg.com/v2-0370ff9fd40521e643ed14fa41c7186e_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-0370ff9fd40521e643ed14fa41c7186e_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;h2&gt;Rust Part&lt;/h2&gt;&lt;h3&gt;Prepare cross-platform toolchains &amp;amp; deps&lt;/h3&gt;&lt;h3&gt;IOS&lt;/h3&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;# Download targets for IOS ( 64 bit targets (real device &amp;amp; simulator) )
rustup target add aarch64-apple-ios x86_64-apple-ios 

# Install cargo-lipo to generate the iOS universal library
cargo install cargo-lipo&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3&gt;Android&lt;/h3&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/kennytm/rust-ios-android&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;è¿™é‡Œ&lt;/a&gt;æœ‰ä¸€äº›è¡Œä¹‹æœ‰æ•ˆçš„è¾…åŠ©è„šæœ¬ç”¨äºæ›´åŠ å¿«æ·é…ç½®äº¤å‰ç¼–è¯‘å·¥å…·ã€‚&lt;/p&gt;&lt;ol&gt;&lt;li&gt; è·å– Android NDK&lt;br/&gt; &lt;code&gt;sh sdkmanager --verbose ndk-bundle&lt;/code&gt; å¦‚æœå·²ç»å‡†å¤‡å¥½äº† Android NDK ï¼Œåˆ™è®¾ç½®ç¯å¢ƒå˜é‡ &lt;code&gt;$ANDROID_NDK_HOME&lt;/code&gt; ```sh&lt;br/&gt; example:&lt;br/&gt; export ANDROID_NDK_HOME=/Users/yinsiwei/Downloads/android-ndk-r20b &lt;code&gt;2. Create the standalone NDK&lt;/code&gt;sh&lt;br/&gt; $(pwd) == ~/Downloads&lt;br/&gt; git clone &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/kennytm/rust-ios-android.git&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;github.com/kennytm/rust&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;-ios-android.git&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt; cd rust-ios-android ./create-ndk-standalone.sh &lt;code&gt;3. åœ¨ Cargo default config VS é…ç½® Android äº¤å‰ç¼–è¯‘å·¥å…·&lt;/code&gt;sh cat cargo-config.toml &amp;gt;&amp;gt; ~/.cargo/config &lt;code&gt;æ‰§è¡Œä¸Šè¿°å‘½ä»¤åä¼šåœ¨ Cargo é»˜è®¤é…ç½®ä¸­ï¼Œå¢åŠ æœ‰å…³ Android è·¨å¹³å°ç›®æ ‡ (targets, `aarch64-linux-android`, `armv7-linux-androideabi`, `i686-linux-android`) çš„å·¥å…·ä¿¡æ¯ï¼ŒæŒ‡å‘åˆšåˆšåˆ›å»ºçš„ `standalone NDK`ã€‚&lt;/code&gt;ini [target.aarch64-linux-android] ar = ... linker = ..&lt;br/&gt; [target.armv7-linux-androideabi] ...&lt;br/&gt; [target.i686-linux-android] .. &lt;code&gt;4. ä¸‹è½½ Rust æ”¯æŒ Android äº¤å‰ç¼–è¯‘çš„ä¾èµ–&lt;/code&gt;sh rustup target add aarch64-linux-android armv7-linux-androideabi i686-linux-android ```&lt;br/&gt; &lt;/li&gt;&lt;/ol&gt;&lt;h3&gt;Start a simple rust library&lt;/h3&gt;&lt;ol&gt;&lt;li&gt; åˆ›å»ºä¸€ä¸ª Rust é¡¹ç›®&lt;br/&gt; &lt;code&gt;sh  cargo init my-app-base --lib&lt;/code&gt;&lt;br/&gt; &lt;/li&gt;&lt;li&gt; ç¼–è¾‘ &lt;code&gt;Cargo.toml&lt;/code&gt; ä¿®æ”¹ &lt;code&gt;crate-type&lt;/code&gt;&lt;br/&gt; &lt;code&gt;ini [lib] name = &amp;#34;my_app_base&amp;#34; crate-type = [&amp;#34;staticlib&amp;#34;, &amp;#34;cdylib&amp;#34;]&lt;/code&gt; Rust æ„å»ºå‡ºæ¥çš„äºŒè¿›åˆ¶åº“ï¼Œåœ¨ IOS ä¸­æ˜¯é™æ€é“¾æ¥è¿›æœ€ç»ˆçš„ç¨‹åºä¹‹ä¸­ï¼Œéœ€è¦å¯¹æ„å»º &lt;code&gt;staticlib&lt;/code&gt; çš„æ”¯æŒï¼›åœ¨ Android æ˜¯é€šè¿‡åŠ¨æ€é“¾æ¥åœ¨è¿è¡Œæ—¶è£…åœ¨è¿›ç¨‹åºè¿è¡Œç©ºé—´çš„ï¼Œéœ€è¦å¯¹æ„å»º &lt;code&gt;cdylib&lt;/code&gt; çš„æ”¯æŒã€‚&lt;br/&gt; &lt;/li&gt;&lt;li&gt; å†™ä¸€äº›ç¬¦åˆ C ABI çš„å‡½æ•° &lt;code&gt;src/lib.rs&lt;/code&gt;&lt;br/&gt; ```rust use std::os::raw::c_char; use std::ffi::CString;&lt;br/&gt; [no_mangle]&lt;br/&gt; pub unsafe extern fn hello() -&amp;gt; *const c_char {     let s = CString::new(&amp;#34;world&amp;#34;).unwrap();     s.into_raw() } ```&lt;br/&gt; åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œæ¯æ¬¡å½“å¤–éƒ¨è°ƒç”¨ &lt;code&gt;hello&lt;/code&gt; å‡½æ•°æ—¶ï¼Œä¼šåœ¨æ™‹åŸå †ç©ºé—´ä¸­åˆ›å»ºä¸€ä¸ªå­—ç¬¦ä¸² ( &lt;code&gt;CString&lt;/code&gt; )ï¼Œå¹¶å°†æ‰€æœ‰æƒ ( é‡Šæ”¾è¯¥å­—ç¬¦ä¸²æ‰€å å †ç©ºé—´çš„æƒåˆ© ) ç§»äº¤ç»™&lt;b&gt;è°ƒç”¨è€…&lt;/b&gt;ã€‚&lt;br/&gt; &lt;/li&gt;&lt;/ol&gt;&lt;h3&gt;Build libraries&lt;/h3&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;# IOS
cargo lipo --release

# Android
cargo build --target aarch64-linux-android --release
cargo build --target armv7-linux-androideabi --release
cargo build --target i686-linux-android --release&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç„¶ååœ¨ &lt;code&gt;target&lt;/code&gt; ç›®å½•ä¸‹ä¼šå¾—åˆ°ä»¥ä¸‹æœ‰ç”¨çš„ç‰©æ–™ã€‚&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;target
    â”œâ”€â”€ aarch64-linux-android
    â”‚   â””â”€â”€ release
    â”‚       â”œâ”€â”€ libmy_app_base.a
    â”‚       â””â”€â”€ libmy_app_base.so
    â”œâ”€â”€ armv7-linux-androideabi
    â”‚   â””â”€â”€ release
    â”‚       â”œâ”€â”€ libmy_app_base.a
    â”‚       â””â”€â”€ libmy_app_base.so
    â”œâ”€â”€ i686-linux-android
    â”‚   â””â”€â”€ release
    â”‚       â”œâ”€â”€ libmy_app_base.a
    â”‚       â””â”€â”€ libmy_app_base.so
    â”œâ”€â”€ universal
    â”‚   â””â”€â”€ release
    â”‚       â””â”€â”€ libmy_app_base.a&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è‡³æ­¤ï¼Œ &lt;code&gt;Rust&lt;/code&gt; éƒ¨åˆ†å°±å‘Šäºæ®µè½äº†ã€‚&lt;/p&gt;&lt;h2&gt;Flutter Part&lt;/h2&gt;&lt;h3&gt;Copy build artifacts to flutter project&lt;/h3&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;from: target/universal/release/libmy_app_base.a 
to: ios/

from: target/aarch64-linux-android/release/libmy_app_base.so 
to: android/app/src/main/jniLibs/arm64-v8a/

from: target/armv7-linux-androideabi/release/libmy_app_base.so 
to: android/app/src/main/jniLibs/armeabi-v7a/

from: target/i686-linux-android/release/libmy_app_base.so 
to: android/app/src/main/jniLibs/x86/&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3&gt;Call FFI function in Dart&lt;/h3&gt;&lt;ol&gt;&lt;li&gt; æ·»åŠ ä¾èµ–&lt;br/&gt; &lt;code&gt;pubspec.yaml&lt;/code&gt; -&amp;gt; &lt;code&gt;dev_dependencies:&lt;/code&gt; += &lt;code&gt;ffi: ^0.1.3&lt;/code&gt;&lt;br/&gt; &lt;/li&gt;&lt;li&gt; æ·»åŠ ä»£ç &lt;br/&gt; (ç›´æ¥åœ¨ç”Ÿæˆçš„é¡¹ç›®ä¸Šä¿®æ”¹ï¼Œæš‚ä¸è€ƒè™‘ä»£ç è®¾è®¡é—®é¢˜ï¼Œå°±ç®€ç®€å•å•çš„å…ˆæŠŠé¡¹ç›®è·‘èµ·æ¥ ) ```dart import &amp;#39;dart:ffi&amp;#39;; import &amp;#39;package:ffi/ffi.dart&amp;#39;;&lt;br/&gt; // ... final dylib = Platform.isAndroid ? DynamicLibrary.open(&amp;#39;libmy_app_base.so&amp;#39;) :DynamicLibrary.process(); var hello = dylib.lookupFunction Function(),Pointer Function()&amp;gt;(&amp;#39;hello&amp;#39;);&lt;br/&gt; // ... hello();  // -&amp;gt; world ```&lt;br/&gt; &lt;/li&gt;&lt;/ol&gt;&lt;h3&gt;Build Android Project&lt;/h3&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;flutter run # å¦‚æœè¿æ¥ç€ Android è®¾å¤‡å°±ç›´æ¥è¿è¡Œäº†èµ·æ¥&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3&gt;Build IOS Project&lt;/h3&gt;&lt;p&gt;( å¤æ‚äº†è®¸å¤š )&lt;/p&gt;&lt;ol&gt;&lt;li&gt;è·Ÿéš &lt;code&gt;Flutter&lt;/code&gt; &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//flutter.dev/docs/get-started/install/macos%23ios-setup&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;å®˜æ–¹æ–‡æ¡£&lt;/a&gt;ï¼Œé…ç½® &lt;code&gt;XCode&lt;/code&gt; é¡¹ç›®ã€‚&lt;/li&gt;&lt;li&gt;åœ¨ &lt;code&gt;Build Phases&lt;/code&gt; ä¸­ &lt;code&gt;Link Binary With Libraries&lt;/code&gt; æ·»åŠ  &lt;code&gt;libmy_app_base.a&lt;/code&gt; æ–‡ä»¶     (æŒ‰ç…§å›¾ä¸Šç®­å¤´ç‚¹...)     &lt;/li&gt;&lt;/ol&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-62c13d1d4d69a0722b905ee192e71d27_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;2280&quot; data-rawheight=&quot;854&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;2280&quot; data-original=&quot;https://pic4.zhimg.com/v2-62c13d1d4d69a0722b905ee192e71d27_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-62c13d1d4d69a0722b905ee192e71d27_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;2280&quot; data-rawheight=&quot;854&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;2280&quot; data-original=&quot;https://pic4.zhimg.com/v2-62c13d1d4d69a0722b905ee192e71d27_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-62c13d1d4d69a0722b905ee192e71d27_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;åœ¨ &lt;code&gt;Build Settings&lt;/code&gt; ä¸­ &lt;code&gt;Other Linker Flags&lt;/code&gt; ä¸­æ·»åŠ  &lt;code&gt;force_load&lt;/code&gt; çš„å‚æ•°ã€‚     &lt;/li&gt;&lt;/ol&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-042670ee855d25046ec7f98b8d0ed5cc_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1710&quot; data-rawheight=&quot;680&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1710&quot; data-original=&quot;https://pic1.zhimg.com/v2-042670ee855d25046ec7f98b8d0ed5cc_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-042670ee855d25046ec7f98b8d0ed5cc_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1710&quot; data-rawheight=&quot;680&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1710&quot; data-original=&quot;https://pic1.zhimg.com/v2-042670ee855d25046ec7f98b8d0ed5cc_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-042670ee855d25046ec7f98b8d0ed5cc_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;è¿™æ˜¯ç”±äºåœ¨ Dart ä¸­é€šè¿‡åŠ¨æ€çš„æ–¹å¼è°ƒç”¨äº†è¯¥åº“çš„ç›¸å…³å‡½æ•°ï¼Œä½†åœ¨ç¼–è¯‘æœŸé—´é™æ€åˆ†æçš„æ—¶å€™ï¼Œè¿™äº›éƒ½æ˜¯æœªæ›¾è¢«è°ƒç”¨è¿‡çš„æ— ç”¨å‡½æ•°ï¼Œå°±è¢«å‰ªè£æ‰äº†ã€‚è¦é€šè¿‡ &lt;code&gt;force_load&lt;/code&gt; æ–¹å¼è§£å†³è¿™ä¸ªé—®é¢˜ã€‚&lt;/p&gt;&lt;h2&gt;Result&lt;/h2&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-5dbdfd2f43bf2186abe37c802bee0815_b.gif&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;904&quot; data-rawheight=&quot;1710&quot; data-thumbnail=&quot;https://pic2.zhimg.com/v2-5dbdfd2f43bf2186abe37c802bee0815_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;904&quot; data-original=&quot;https://pic2.zhimg.com/v2-5dbdfd2f43bf2186abe37c802bee0815_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-5dbdfd2f43bf2186abe37c802bee0815_b.gif&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;904&quot; data-rawheight=&quot;1710&quot; data-thumbnail=&quot;https://pic2.zhimg.com/v2-5dbdfd2f43bf2186abe37c802bee0815_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;904&quot; data-original=&quot;https://pic2.zhimg.com/v2-5dbdfd2f43bf2186abe37c802bee0815_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-5dbdfd2f43bf2186abe37c802bee0815_b.gif&quot;/&gt;&lt;/figure&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-cac9f12ced5e34e3c14a8d5406fcea89_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1032&quot; data-rawheight=&quot;1342&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1032&quot; data-original=&quot;https://pic2.zhimg.com/v2-cac9f12ced5e34e3c14a8d5406fcea89_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-cac9f12ced5e34e3c14a8d5406fcea89_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1032&quot; data-rawheight=&quot;1342&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1032&quot; data-original=&quot;https://pic2.zhimg.com/v2-cac9f12ced5e34e3c14a8d5406fcea89_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-cac9f12ced5e34e3c14a8d5406fcea89_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;h2&gt;Troubleshooting&lt;/h2&gt;&lt;h3&gt;XCode &amp;amp; IOS&lt;/h3&gt;&lt;h3&gt;Error getting attached iOS device: ideviceinfo could not find device&lt;/h3&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;sudo xattr -d com.apple.quarantine ~/flutter/bin/cache/artifacts/libimobiledevice/ideviceinfo&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å°†åé¢çš„è·¯å¾„æ›¿æ¢æˆä½ çš„&lt;/p&gt;&lt;h3&gt;dyld: Library not loaded&lt;/h3&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;dyld: Library not loaded: /b/s/w/ir/k/homebrew/Cellar/libimobiledevice-flutter/HEAD-398c120_3/lib/libimobiledevice.6.dylib
  Referenced from: /Users/hey/flutter/bin/cache/artifacts/libimobiledevice/idevice_id
  Reason: image not found&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åˆ é™¤&amp;amp;é‡æ–°ä¸‹è½½&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;rm -rf /Users/hey/flutter/bin/cache &amp;amp;&amp;amp; flutter doctor -v&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3&gt;çœŸæœºæ— æ³•å¯åŠ¨ Flutter ç¨‹åº&lt;/h3&gt;&lt;p&gt;å‚è§ &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/flutter/flutter/issues/49504%23issuecomment-581554697&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;github.com/flutter/flut&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;ter/issues/49504#issuecomment-581554697&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt; ä¸è¦å‡çº§åˆ° IOS 13.3.1 ç³»ç»Ÿ&lt;/p&gt;&lt;h2&gt;What&amp;#39;s next&lt;/h2&gt;&lt;ul&gt;&lt;li&gt; å¦‚ä½•é«˜æ•ˆçš„å®ç° Rust &amp;amp; Dart éƒ¨åˆ†çš„é€šä¿¡&lt;br/&gt; æˆ‘ä»¬çŸ¥é“ Flutter å’Œå¹¿å¤§ GUI åº“ç±»ä¼¼ï¼Œå±äºå•çº¿ç¨‹æ¨¡å‹ç»“åˆäº‹ä»¶ç³»ç»Ÿï¼Œå› æ­¤åœ¨ä¸»çº¿ç¨‹ä¸­ä½¿ç”¨ FFI è°ƒç”¨ Rust éƒ¨åˆ†çš„ä»£ç ä¸èƒ½é˜»å¡çº¿ç¨‹ã€‚Dart è¯­è¨€æä¾› async/await è¯­æ³•ç‰¹æ€§ç”¨äºåœ¨ Flutter ä¸­å¤„ç†ç½‘ç»œè¯·æ±‚ç­‰é˜»å¡ä»»åŠ¡ã€‚è€Œ Rust ä¹Ÿåœ¨æœ€è¿‘ç‰ˆæœ¬ä¸­æä¾›äº† async/await è¯­æ³•æ”¯æŒï¼Œå¦‚ä½•ä¼˜é›…çš„æŠŠä¸¤éƒ¨åˆ†ç»“åˆèµ·æ¥ï¼Œè¿™æ˜¯ä¸€ä¸ªé—®é¢˜ã€‚&lt;br/&gt; &lt;/li&gt;&lt;li&gt; å¯¹ MacOS Windows Linux æ¡Œé¢ç«¯çš„æ”¯æŒ&lt;br/&gt; Flutter å·²ç»æœ‰äº†å¯¹æ¡Œé¢ç«¯çš„å®éªŒæ€§æ”¯æŒï¼Œå¯ä»¥ç ”ç©¶ä¸‹å¦‚ä½•ç»“åˆåœ¨ä¸€èµ·ï¼Œå®ç°è·¨ 6 ä¸ªç«¯å…±äº«ä»£ç ã€‚&lt;br/&gt; &lt;/li&gt;&lt;/ul&gt;&lt;h2&gt;References&lt;/h2&gt;&lt;ul&gt;&lt;li&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/kennytm/rust-ios-android&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;github.com/kennytm/rust&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;-ios-android&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;ä»‹ç»äº†å¦‚ä½•æ„å»ºå‡º Android, IOS åº“ï¼Œå¹¶æä¾›äº†ä¾‹å­ - &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/TimNN/cargo-lipo&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;github.com/TimNN/cargo-&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;lipo&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/p&gt;&lt;p&gt;ç”¨äºæ„å»º universal library - &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/hanabi1224/flutter_native_extensions&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;github.com/hanabi1224/f&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;lutter_native_extensions&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/p&gt;</description>
<author>å°¹æ€ç»´</author>
<guid isPermaLink="false">2020-02-21-108308284</guid>
<pubDate>Fri, 21 Feb 2020 00:00:00 +0800</pubDate>
</item>
<item>
<title>Rust search extension--åœ¨åœ°å€æ å¿«é€Ÿæœç´¢Rustæ–‡æ¡£ã€å±æ€§å’Œåº“çš„æµè§ˆå™¨æ’ä»¶</title>
<link>https://henix.github.io/feeds/zhuanlan.rust-lang/2020-02-05-105169885.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/105169885&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-ab05e086264f39cf83e8109fcdb2fb42_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;å¤§å®¶å¥½ï¼Œ&lt;/p&gt;&lt;p&gt;&lt;b&gt;Rust Search Extension&lt;/b&gt;æ˜¯æˆ‘ä»2018å¹´å¼€å§‹å¼€å‘çš„æµè§ˆå™¨æ’ä»¶ï¼Œæ–¹ä¾¿å¤§å®¶åœ¨æµè§ˆå™¨åœ°å€æ å¿«é€Ÿæœç´¢å®˜æ–¹æ–‡æ¡£ã€å†…ç½®å±æ€§ã€crateså’Œé”™è¯¯ç ã€‚ç›®å‰å‘å¸ƒäº†v0.7ç‰ˆï¼&lt;/p&gt;&lt;p&gt;ç›®å‰åœ¨Redditä¸Šè·å¾—äº†å°†è¿‘200ä¸ªèµï¼Œæ¬¢è¿å¤§å®¶ä¸‹è½½ä½“éªŒã€‚&lt;/p&gt;&lt;blockquote&gt;Redditå¸–å­ï¼š&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//www.reddit.com/r/rust/comments/eymfxu/announcing_rustsearchextension_v07_search_std/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Announcing rust-search-extension v0.7! Search std docs, crates, error codes, and attributes in your address bar instantly!&lt;/a&gt;&lt;/blockquote&gt;&lt;p&gt;ä¸»è¦åŠŸèƒ½å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;h3&gt;å®æ—¶æœç´¢å®˜æ–¹æ–‡æ¡£&lt;/h3&gt;&lt;ul&gt;&lt;li&gt;ç›®å‰æ”¯æŒæœç´¢å®˜æ–¹æ–‡æ¡£ä¸Šstdï¼Œproc_macroï¼Œtestä¸‰ä¸ªcrateçš„æ–‡æ¡£ï¼›&lt;/li&gt;&lt;li&gt;æ”¯æŒç¦»çº¿æ¨¡å¼æœç´¢æœ¬åœ°æ–‡æ¡£&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-04ea68a89c1606261bd03e11439e2a56_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1280&quot; data-rawheight=&quot;800&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1280&quot; data-original=&quot;https://pic3.zhimg.com/v2-04ea68a89c1606261bd03e11439e2a56_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-04ea68a89c1606261bd03e11439e2a56_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1280&quot; data-rawheight=&quot;800&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1280&quot; data-original=&quot;https://pic3.zhimg.com/v2-04ea68a89c1606261bd03e11439e2a56_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-04ea68a89c1606261bd03e11439e2a56_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;h3&gt;å®æ—¶æœç´¢top 10Kçš„crates&lt;/h3&gt;&lt;p&gt;è¾“å…¥å…³é”®å­—å°±èƒ½æœç´¢ä¸‹è½½é‡æ’åå‰10Kçš„cratesï¼ˆ&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//crates.io&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;http://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;crates.io&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;&lt;/span&gt;&lt;/a&gt;ä¸Šæ€»å…±35+Kä¸ªcrateï¼‰ï¼Œå¹¶ä¸”æ¯ä¸€ä¸ªå°æ—¶ä¼šæä¾›æœ€æ–°çš„cratesç´¢å¼•æ–‡ä»¶ã€‚æ‰“å¼€æ’ä»¶çš„popupé¡µé¢å°±èƒ½è‡ªåŠ¨æ›´æ–°åˆ°æœ€æ–°çš„cratesç´¢å¼•ã€‚&lt;/p&gt;&lt;p&gt;åœ¨å…³é”®å­—å‰é¢æ‹¼æ¥&lt;code&gt;!&lt;/code&gt;ï¼ˆè‹±æ–‡å¹å·ï¼‰å³å¯åªæœç´¢cratesã€‚&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-8fe8a53a507c2df176b3373f7155d4e2_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1280&quot; data-rawheight=&quot;800&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1280&quot; data-original=&quot;https://pic3.zhimg.com/v2-8fe8a53a507c2df176b3373f7155d4e2_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-8fe8a53a507c2df176b3373f7155d4e2_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1280&quot; data-rawheight=&quot;800&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1280&quot; data-original=&quot;https://pic3.zhimg.com/v2-8fe8a53a507c2df176b3373f7155d4e2_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-8fe8a53a507c2df176b3373f7155d4e2_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;h3&gt;æ”¯æŒåœ¨å‰é¢æ‹¼æ¥typeæ¥åªæœç´¢è¯¥ç±»å‹çš„æ–‡æ¡£&lt;/h3&gt;&lt;p&gt;è¿™äº›typeåŒ…æ‹¬ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;mod&lt;/li&gt;&lt;li&gt;struct&lt;/li&gt;&lt;li&gt;enum&lt;/li&gt;&lt;li&gt;fn&lt;/li&gt;&lt;li&gt;trait&lt;/li&gt;&lt;li&gt;type&lt;/li&gt;&lt;li&gt;static&lt;/li&gt;&lt;li&gt;macro&lt;/li&gt;&lt;li&gt;const&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;æ¯”å¦‚, è¾“å…¥&lt;code&gt;fn:asref&lt;/code&gt; åªæœç´¢å‡½æ•°é‡Œé¢åŒ…å«&lt;code&gt;asref&lt;/code&gt;çš„ç»“æœï¼Œæˆ–è€…è¾“å…¥&lt;code&gt;trait:iterator&lt;/code&gt;åªæœç´¢traitååŒ…æ‹¬iteratorçš„ç»“æœã€‚&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-246e7392f966725c06cf15ba5abd0a3e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1280&quot; data-rawheight=&quot;800&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1280&quot; data-original=&quot;https://pic3.zhimg.com/v2-246e7392f966725c06cf15ba5abd0a3e_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-246e7392f966725c06cf15ba5abd0a3e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1280&quot; data-rawheight=&quot;800&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1280&quot; data-original=&quot;https://pic3.zhimg.com/v2-246e7392f966725c06cf15ba5abd0a3e_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-246e7392f966725c06cf15ba5abd0a3e_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;h3&gt;æœç´¢å†…ç½®rustå±æ€§&lt;/h3&gt;&lt;p&gt;&lt;code&gt;#[derive]&lt;/code&gt;, &lt;code&gt;#[non_exhaustive]&lt;/code&gt;ç­‰è¿™äº›å†…ç½®å±æ€§ä¹Ÿèƒ½è¢«æœç´¢ï¼Œä½†æ˜¯æœç´¢çš„ç»“æœä¼šå’Œæ–‡æ¡£æˆ–cratesæ··åœ¨ä¸€èµ·ï¼Œå¯ä»¥åœ¨æœ€å‰é¢æ‹¼æ¥&lt;code&gt;#&lt;/code&gt;ï¼ˆäº•å·ï¼‰è¿‡æ»¤æ‰å…¶ä»–ç»“æœã€‚&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-c6211785206a99fb2c254d0bd6fb5b47_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1280&quot; data-rawheight=&quot;800&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1280&quot; data-original=&quot;https://pic4.zhimg.com/v2-c6211785206a99fb2c254d0bd6fb5b47_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-c6211785206a99fb2c254d0bd6fb5b47_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1280&quot; data-rawheight=&quot;800&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1280&quot; data-original=&quot;https://pic4.zhimg.com/v2-c6211785206a99fb2c254d0bd6fb5b47_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-c6211785206a99fb2c254d0bd6fb5b47_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;h3&gt;æœç´¢Rustå®˜æ–¹é”™è¯¯ç &lt;/h3&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-e7976301a4fe8b5639542386061bb529_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1280&quot; data-rawheight=&quot;800&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1280&quot; data-original=&quot;https://pic2.zhimg.com/v2-e7976301a4fe8b5639542386061bb529_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-e7976301a4fe8b5639542386061bb529_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1280&quot; data-rawheight=&quot;800&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1280&quot; data-original=&quot;https://pic2.zhimg.com/v2-e7976301a4fe8b5639542386061bb529_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-e7976301a4fe8b5639542386061bb529_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;h3&gt;å…¨æ–°çš„å®˜ç½‘&lt;/h3&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//rust-search-extension.now.sh/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;https://rust-search-extension.now.sh&lt;/a&gt; å®˜ç½‘ä¸Šè¯¦ç»†åˆ—ä¸¾äº†å„ä¸ªåŠŸèƒ½ï¼Œå¹¶é…å¤‡äº†GIFå›¾ç‰‡ç¤ºä¾‹ã€‚&lt;/p&gt;&lt;h3&gt;Github&lt;/h3&gt;&lt;p&gt;&lt;b&gt;rust-search-extension&lt;/b&gt;åœ¨Github &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/Folyd/rust-search-extension&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;github.com/Folyd/rust-s&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;earch-extension&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;å¼€æºï¼Œæ¬¢è¿å¤§å®¶æissueæˆ–PRï¼&lt;/p&gt;</description>
<author>æœ±éœœ</author>
<guid isPermaLink="false">2020-02-05-105169885</guid>
<pubDate>Wed, 05 Feb 2020 00:00:00 +0800</pubDate>
</item>
<item>
<title>ä¸¤ç™¾è¡ŒRustä»£ç è§£æç»¿è‰²çº¿ç¨‹åŸç†ï¼ˆå››ï¼‰ä¸€ä¸ªç»¿è‰²çº¿ç¨‹çš„å®ç°</title>
<link>https://henix.github.io/feeds/zhuanlan.rust-lang/2020-01-09-101061389.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/101061389&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt; åŸæ–‡: Green threads explained in 200 lines of rust language&lt;br/&gt; åœ°å€: &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//cfsamson.gitbook.io/green-threads-explained-in-200-lines-of-rust/&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;cfsamson.gitbook.io/gre&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;en-threads-explained-in-200-lines-of-rust/&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;  &lt;br/&gt; ä½œè€…: Carl Fredrik Samson(cfsamson@Github)&lt;br/&gt; ç¿»è¯‘: è€¿è…¾&lt;br/&gt; &lt;/blockquote&gt;&lt;hr/&gt;&lt;p&gt;åœ¨æˆ‘ä»¬å¼€å§‹ä¹‹å‰ï¼Œæˆ‘å¾—æé†’ä½ æˆ‘ä»¬ç¼–å†™çš„ä»£ç éå¸¸ä¸å®‰å…¨ï¼Œå¹¶ä¸”è¿™ä¹Ÿä¸æ˜¯ç¼–å†™ Rust ä»£ç çš„ â€œæœ€ä½³å®è·µâ€ã€‚æˆ‘å¸Œæœ›åœ¨ä¸å¼•å…¥å¾ˆå¤šä¸å¿…è¦çš„å¤æ‚æ€§çš„å‰æä¸‹ä½¿å…¶å°½å¯èƒ½å®‰å…¨ï¼Œæ‰€ä»¥å¦‚æœä½ å‘ç°äº†æ›´å®‰å…¨æ–¹æ³•ï¼Œåˆä¸ä¼šè®©æˆ‘ä»¬çš„ä»£ç è¿‡äºå¤æ‚ï¼Œé‚£ä¹ˆæˆ‘é¼“åŠ±äº²çˆ±çš„ä½ ä¸ºè¯¥é¡¹ç›®æä¸€ä¸ª RPï¼ˆPull Requestï¼‰ã€‚&lt;/p&gt;&lt;h3&gt;è®©æˆ‘ä»¬å¼€å§‹å§&lt;/h3&gt;&lt;p&gt;æˆ‘ä»¬è¦åšçš„ç¬¬ä¸€ä»¶äº‹å°±æ˜¯åœ¨ &lt;code&gt;main.rs&lt;/code&gt; ä¸­åˆ é™¤æˆ‘ä»¬çš„ç¤ºä¾‹ã€‚æˆ‘ä»¬ä»å¤´å¼€å§‹å¹¶æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-rust&quot;&gt;&lt;span class=&quot;cp&quot;&gt;#![feature(asm)]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;#![feature(naked_functions)]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;use&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;const&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DEFAULT_STACK_SIZE&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;usize&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;const&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MAX_THREADS&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;usize&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;static&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RUNTIME&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;usize&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æˆ‘ä»¬å¯ç”¨äº†ä¸¤ä¸ªç‰¹æ€§ï¼ˆfeatureï¼‰ï¼Œæˆ‘ä»¬ä¹‹å‰ä»‹ç»è¿‡çš„ &lt;code&gt;asm&lt;/code&gt; åŠŸèƒ½ï¼Œä»¥åŠæˆ‘ä»¬éœ€è¦è§£é‡Šçš„ &lt;code&gt;naked_functions&lt;/code&gt; åŠŸèƒ½ã€‚&lt;/p&gt;&lt;h3&gt;naked_functions&lt;/h3&gt;&lt;p&gt;å½“ Rust ç¼–è¯‘ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œå®ƒä¼šä¸ºæ¯ä¸ªå‡½æ•°æ·»åŠ ä¸€ä¸ªå°çš„åºè¨€å’Œå°¾å£°ï¼Œè¿™ä¼šåœ¨æˆ‘ä»¬åˆ‡æ¢ä¸Šä¸‹æ–‡æ—¶ç»™æˆ‘ä»¬å¸¦æ¥ä¸€äº›é—®é¢˜ï¼Œå› ä¸ºæˆ‘ä»¬æœ€ç»ˆå¾—åˆ°äº†ä¸€ä¸ªæœªå¯¹é½çš„æ ˆã€‚è¿™åœ¨æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªç®€å•ç¤ºä¾‹ä¸­è¿è¡Œè‰¯å¥½ï¼Œä½†æ˜¯ä¸€æ—¦æˆ‘ä»¬éœ€è¦å†æ¬¡åˆ‡æ¢å›ç›¸åŒçš„æ ˆï¼Œæˆ‘ä»¬å°±ä¼šé‡åˆ°éº»çƒ¦ã€‚å°†æŸä¸ªå‡½æ•°æ ‡è®°ä¸º &lt;code&gt;#[naked]&lt;/code&gt; ä¼šåˆ é™¤åºè¨€å’Œç»“å°¾ã€‚æ­¤å±æ€§ä¸»è¦ç”¨äºå†…è”æ±‡ç¼–ã€‚&lt;/p&gt;&lt;blockquote&gt; å¦‚æœä½ æœ‰å…´è¶£ï¼Œå¯ä»¥é˜…è¯» &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/rust-lang/rfcs/blob/master/text/1201-naked-fns.md&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;RFC #1201&lt;/a&gt; ä¸­æœ‰å…³ &lt;code&gt;naked_functions&lt;/code&gt; åŠŸèƒ½çš„æ›´å¤šä¿¡æ¯ã€‚&lt;br/&gt; &lt;/blockquote&gt;&lt;p&gt;æˆ‘ä»¬çš„ &lt;code&gt;DEFAULT_STACK_SIZE&lt;/code&gt; è®¾ç½®ä¸º 2 MBï¼Œè¿™è¶³å¤Ÿæˆ‘ä»¬ä½¿ç”¨ã€‚æˆ‘ä»¬è¿˜å°† &lt;code&gt;MAX_THREADS&lt;/code&gt; è®¾ç½®ä¸º 4ï¼Œå› ä¸ºæˆ‘ä»¬çš„ç¤ºä¾‹ä¸éœ€è¦å¤ªå¤§ã€‚&lt;/p&gt;&lt;p&gt;æœ€åä¸€ä¸ªå¸¸é‡ &lt;code&gt;RUNTIME&lt;/code&gt; æ˜¯ä¸€ä¸ªæŒ‡å‘æˆ‘ä»¬è¿è¡Œæ—¶çš„æŒ‡é’ˆï¼ˆæ˜¯çš„ï¼Œæˆ‘çŸ¥é“ï¼Œä¸€ä¸ªå¯å˜çš„å…¨å±€å˜é‡ä¸æ˜¯å¾ˆå¥½ï¼Œä½†æˆ‘ä»¬ç¨åéœ€è¦å®ƒï¼Œæˆ‘ä»¬åªåœ¨è¿è¡Œæ—¶åˆå§‹åŒ–æ—¶è®¾ç½®è¿™ä¸ªå˜é‡ï¼‰ã€‚&lt;/p&gt;&lt;p&gt;æˆ‘ä»¬å¼€å§‹å¡«ä¸Šä¸€äº›ä»£è¡¨æ•°æ®çš„å†…å®¹ï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-rust&quot;&gt;&lt;span class=&quot;k&quot;&gt;pub&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Runtime&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;threads&lt;/span&gt;: &lt;span class=&quot;nb&quot;&gt;Vec&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;current&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;usize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;#[derive(PartialEq, Eq, Debug)]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;enum&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;State&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Available&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Running&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Ready&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;usize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stack&lt;/span&gt;: &lt;span class=&quot;nb&quot;&gt;Vec&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u8&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ctx&lt;/span&gt;: &lt;span class=&quot;nc&quot;&gt;ThreadContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;: &lt;span class=&quot;nc&quot;&gt;State&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;#[derive(Debug, Default)]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;#[repr(C)]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ThreadContext&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rsp&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r15&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r14&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r13&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r12&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rbx&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rbp&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;Runtime&lt;/code&gt; å°†æ˜¯æˆ‘ä»¬çš„ä¸»è¦å…¥å£ã€‚æˆ‘ä»¬ä¼šåˆ›å»ºä¸€ä¸ªéå¸¸å°çš„ã€ç®€å•çš„è¿è¡Œæ—¶æ¥è°ƒåº¦å’Œåˆ‡æ¢æˆ‘ä»¬çš„çº¿ç¨‹ã€‚è¿è¡Œæ—¶åŒ…å«ä¸€ä¸ª &lt;code&gt;Thread&lt;/code&gt; çš„æ•°ç»„å’Œä¸€ä¸ª &lt;code&gt;current&lt;/code&gt; å­—æ®µï¼Œä»¥æŒ‡ç¤ºæˆ‘ä»¬å½“å‰æ­£åœ¨è¿è¡Œçš„çº¿ç¨‹ã€‚&lt;/p&gt;&lt;p&gt;&lt;code&gt;Thread&lt;/code&gt; ä¿å­˜çº¿ç¨‹çš„æ•°æ®ã€‚æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰ä¸€ä¸ª &lt;code&gt;id&lt;/code&gt;ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å°†ä¸åŒçš„çº¿ç¨‹åŒºåˆ†å¼€ã€‚æ ˆç±»ä¼¼äºæˆ‘ä»¬åœ¨å‰é¢ç« èŠ‚ä¸­çš„ç¬¬ä¸€ä¸ªç¤ºä¾‹ä¸­çœ‹åˆ°çš„å†…å®¹ã€‚ &lt;code&gt;ctx&lt;/code&gt; å­—æ®µæ˜¯ä¸€ä¸ªä¸Šä¸‹æ–‡ï¼Œè¡¨ç¤ºæˆ‘ä»¬çš„ CPU éœ€è¦åœ¨æ ˆä¸Šå‰©ä½™çš„ä½ç½®æ¢å¤çš„æ•°æ®ï¼Œä»¥åŠä¸€ä¸ª &lt;code&gt;state&lt;/code&gt;ï¼Œå®ƒæ˜¯æˆ‘ä»¬çš„çº¿ç¨‹çŠ¶æ€ã€‚&lt;/p&gt;&lt;blockquote&gt; è¯‘è€…æ³¨ï¼šè¿™é‡Œçš„ â€œçº¿ç¨‹â€ ä»¥åŠ &lt;code&gt;Thread&lt;/code&gt; æŒ‡çš„å°±æ˜¯æˆ‘ä»¬è¦å®ç°çš„ â€œç»¿è‰²çº¿ç¨‹ï¼ˆGrean Threadï¼‰â€ï¼Œè€Œä¸æ˜¯æ“ä½œç³»ç»Ÿçº¿ç¨‹ã€‚&lt;br/&gt; &lt;/blockquote&gt;&lt;p&gt;&lt;code&gt;State&lt;/code&gt; æ˜¯ä¸€ä¸ªæšä¸¾ï¼Œä»£è¡¨æˆ‘ä»¬çš„çº¿ç¨‹æ‰€å¤„çš„çŠ¶æ€ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;code&gt;Available&lt;/code&gt; è¡¨ç¤ºçº¿ç¨‹å¯ç”¨ï¼Œå¹¶ä¸”å¯ä»¥æ ¹æ®éœ€è¦åˆ†é…ä»»åŠ¡ï¼›&lt;br/&gt; &lt;/li&gt;&lt;li&gt;&lt;code&gt;Running&lt;/code&gt; æ„å‘³ç€çº¿ç¨‹æ­£åœ¨è¿è¡Œï¼›&lt;br/&gt; &lt;/li&gt;&lt;li&gt;&lt;code&gt;Ready&lt;/code&gt; æ„å‘³ç€çº¿ç¨‹å·²å‡†å¤‡å¥½ç»§ç»­å‰è¿›å’Œæ¢å¤æ‰§è¡Œã€‚&lt;br/&gt; &lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;code&gt;ThreadContext&lt;/code&gt; ä¿å­˜ CPU éœ€è¦åœ¨æ ˆä¸Šæ¢å¤æ‰§è¡Œçš„å¯„å­˜å™¨çš„æ•°æ®ã€‚&lt;/p&gt;&lt;blockquote&gt; å¦‚æœä½ ä¸è®°å¾—ï¼Œè¯·è¿”å› &lt;b&gt;ç»ªè®ºåŠåŸºæœ¬æ¦‚å¿µ&lt;/b&gt; ä¸€ç« ä»¥äº†è§£å¯„å­˜å™¨ã€‚è¿™äº›æ˜¯ x86-64 ä½“ç³»ç»“æ„è§„èŒƒä¸­æ ‡è®°ä¸º â€œcallee savedâ€ çš„å¯„å­˜å™¨ã€‚&lt;br/&gt; &lt;/blockquote&gt;&lt;p&gt;è®©æˆ‘ä»¬ç»§ç»­ï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-rust&quot;&gt;&lt;span class=&quot;k&quot;&gt;impl&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;usize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&quot;nc&quot;&gt;Self&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stack&lt;/span&gt;: &lt;span class=&quot;nc&quot;&gt;vec&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0_&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;u8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DEFAULT_STACK_SIZE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ctx&lt;/span&gt;: &lt;span class=&quot;nc&quot;&gt;ThreadContext&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;default&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;: &lt;span class=&quot;nc&quot;&gt;State&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;Available&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™éƒ¨åˆ†å¾ˆç®€å•ã€‚æ–°çº¿ç¨‹åœ¨ &lt;code&gt;Available&lt;/code&gt; çŠ¶æ€ä¸‹å¯åŠ¨ï¼Œè¡¨ç¤ºå·²å‡†å¤‡å¥½ä¸ºå…¶åˆ†é…ä»»åŠ¡ã€‚&lt;/p&gt;&lt;p&gt;éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯æˆ‘ä»¬åœ¨è¿™é‡Œåˆ†é…äº†æ ˆå†…å­˜ã€‚è¿™ä¸æ˜¯å¿…éœ€çš„ï¼Œä¹Ÿä¸æ˜¯èµ„æºçš„æœ€ä½³ä½¿ç”¨æ–¹æ³•ï¼Œå› ä¸ºæˆ‘ä»¬æ²¡æœ‰åœ¨é¦–æ¬¡ä½¿ç”¨æ—¶åˆ†é…,ï¼Œè€Œä¸ºä¸€ä¸ªåªæ˜¯å¯èƒ½éœ€è¦çš„çº¿ç¨‹åˆ†é…äº†å†…å­˜ã€‚ä¸è¿‡ï¼Œè¿™é™ä½äº†æˆ‘ä»¬ä»£ç çš„å¤æ‚æ€§ï¼Œè€Œæˆ‘ä»¬çš„ä»£ç æœ‰æ¯”ä¸ºæ ˆåˆ†é…å†…å­˜æ›´é‡è¦çš„å…³æ³¨ç‚¹ã€‚&lt;/p&gt;&lt;blockquote&gt; éœ€è¦ç€é‡æ³¨æ„çš„æ˜¯ï¼Œä¸€æ—¦åˆ†é…äº†æ ˆï¼Œå®ƒå°±ä¸èƒ½ç§»åŠ¨ï¼ˆmoveï¼‰ï¼ä¸åº”ä½¿ç”¨æ•°ç»„çš„ &lt;code&gt;push()&lt;/code&gt; æˆ–ä»»ä½•æ–¹æ³•è§¦å‘å†…å­˜é‡åˆ†é…ã€‚å¦‚æœè¦æŠŠè¿™éƒ¨åˆ†ä»£ç å†™çš„æ›´å¥½ä¸€äº›ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºè‡ªå·±çš„ç±»å‹ï¼Œåªæš´éœ²é‚£äº›æˆ‘ä»¬è®¤ä¸ºå¯ä»¥å®‰å…¨ä½¿ç”¨çš„æ–¹æ³•ã€‚ å€¼å¾—ä¸€æçš„æ˜¯ï¼Œ&lt;code&gt;Vec&amp;lt;T&amp;gt;&lt;/code&gt; æœ‰ä¸€ä¸ªåä¸º &lt;code&gt;into_boxed_slice()&lt;/code&gt; çš„æ–¹æ³•ï¼Œå®ƒè¿”å›ä¸€ä¸ªå †åˆ†é…çš„åˆ‡ç‰‡ &lt;code&gt;Box&amp;lt;[T]&amp;gt;&lt;/code&gt;ã€‚åˆ‡ç‰‡ä¸èƒ½å¢é•¿ï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬æ”¹ä¸ºä½¿ç”¨å®ƒï¼Œæˆ‘ä»¬å¯ä»¥é¿å…é‡æ–°åˆ†é…é—®é¢˜ã€‚&lt;br/&gt; &lt;/blockquote&gt;&lt;h3&gt;å®ç°è¿è¡Œæ—¶&lt;/h3&gt;&lt;p&gt;æ­¤æ®µä¸­çš„æ‰€æœ‰ä»£ç éƒ½åœ¨ &lt;code&gt;impl Runtime&lt;/code&gt; ä»£ç å—ä¸­ï¼Œè¿™æ„å‘³ç€å®ƒä»¬æ˜¯ &lt;code&gt;Runtime&lt;/code&gt; ç»“æ„ä¸Šçš„æ–¹æ³•ã€‚&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-rust&quot;&gt;&lt;span class=&quot;k&quot;&gt;impl&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Runtime&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;pub&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&quot;nc&quot;&gt;Self&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// è¿™å°†æ˜¯æˆ‘ä»¬çš„åŸºæœ¬çº¿ç¨‹, ä¼šè¢«åˆå§‹åŒ–ä¸º
&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// Running çŠ¶æ€
&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;base_thread&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;: &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stack&lt;/span&gt;: &lt;span class=&quot;nc&quot;&gt;vec&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0_&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;u8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DEFAULT_STACK_SIZE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ctx&lt;/span&gt;: &lt;span class=&quot;nc&quot;&gt;ThreadContext&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;default&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;: &lt;span class=&quot;nc&quot;&gt;State&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;Running&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;threads&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vec&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;base_thread&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;available_threads&lt;/span&gt;: &lt;span class=&quot;nb&quot;&gt;Vec&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;..&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MAX_THREADS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Thread&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;collect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;threads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;available_threads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Runtime&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;threads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;current&lt;/span&gt;: &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å½“æˆ‘ä»¬å®ä¾‹åŒ– &lt;code&gt;Runtime&lt;/code&gt; æ—¶ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåŸºç¡€çº¿ç¨‹ã€‚æ­¤çº¿ç¨‹å°†è®¾ç½®ä¸º &lt;code&gt;Running&lt;/code&gt; çŠ¶æ€ï¼Œå¹¶ç¡®ä¿æˆ‘ä»¬ä¿æŒè¿è¡Œæ—¶è¿è¡Œï¼Œç›´åˆ°æ‰€æœ‰ä»»åŠ¡å®Œæˆã€‚&lt;/p&gt;&lt;p&gt;ç„¶åæˆ‘ä»¬å®ä¾‹åŒ–å…¶ä½™çš„çº¿ç¨‹å¹¶å°†å½“å‰çº¿ç¨‹è®¾ç½®ä¸º &lt;code&gt;0&lt;/code&gt;ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„åŸºæœ¬çº¿ç¨‹ã€‚&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-rust&quot;&gt;&lt;span class=&quot;sd&quot;&gt;/// è¿™é‡Œæœ‰ç‚¹ä½œå¼Šï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦ä¸€ä¸ªæŒ‡å‘å­˜å‚¨çš„ Runtime çš„æŒ‡é’ˆ
&lt;/span&gt;&lt;span class=&quot;sd&quot;&gt;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;sd&quot;&gt;/// è¿™æ ·å³ä¾¿æˆ‘ä»¬æ²¡æœ‰å®ƒçš„å¼•ç”¨ï¼Œ
&lt;/span&gt;&lt;span class=&quot;sd&quot;&gt;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;sd&quot;&gt;/// ä¹Ÿå¯ä»¥å¯¹å…¶è°ƒç”¨ yield.
&lt;/span&gt;&lt;span class=&quot;sd&quot;&gt;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;pub&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;unsafe&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r_ptr&lt;/span&gt;: &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;const&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Runtime&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RUNTIME&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r_ptr&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;usize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç„¶åæˆ‘ä»¬éœ€è¦è¿™æ ·ï¼ˆè¯‘è€…æ³¨ï¼šä¸ºé‚£ä¸ªå¯å˜çš„å…¨å±€å˜é‡èµ‹å€¼ï¼‰ï¼Œæ­£å¦‚æˆ‘åœ¨å®šä¹‰å¸¸é‡æ—¶æ‰€æåˆ°çš„ï¼Œæˆ‘ä»¬éœ€è¦ä»¥åèƒ½å¤Ÿè°ƒç”¨ &lt;code&gt;yield&lt;/code&gt;ã€‚ä»£ç æœ‰ç‚¹éš¾çœ‹ï¼Œä½†æˆ‘ä»¬çŸ¥é“åªè¦æœ‰ä»»ä½•çº¿ç¨‹å¯ä»¥ &lt;code&gt;yield&lt;/code&gt;ï¼Œæˆ‘ä»¬çš„è¿è¡Œæ—¶å°±ä¼šå­˜æ´»ï¼Œåªè¦æˆ‘ä»¬ä¸æ»¥ç”¨å®ƒå°±å¯ä»¥å®‰å…¨åœ°è¿è¡Œã€‚&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-rust&quot;&gt;&lt;span class=&quot;k&quot;&gt;pub&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;while&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_yield&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;process&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;exit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™æ˜¯æˆ‘ä»¬å¼€å§‹å¯åŠ¨è¿è¡Œæ—¶çš„åœ°æ–¹ã€‚å®ƒå°†ä¸æ–­è°ƒç”¨ &lt;code&gt;t_yield()&lt;/code&gt; ç›´åˆ°è¿”å› &lt;code&gt;false&lt;/code&gt;ï¼Œ&lt;code&gt;false&lt;/code&gt; æ„å‘³ç€æ²¡æœ‰å·¥ä½œè¦åšäº†ï¼Œæˆ‘ä»¬å¯ä»¥é€€å‡ºè¿›ç¨‹ã€‚&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-rust&quot;&gt;&lt;span class=&quot;k&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;t_return&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;current&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;threads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;current&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;State&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;Available&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_yield&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™æ˜¯æˆ‘ä»¬åœ¨çº¿ç¨‹å®Œæˆæ—¶è°ƒç”¨çš„è¿”å›å‡½æ•°ã€‚ &lt;code&gt;return&lt;/code&gt; æ˜¯ Rust ä¸­çš„å¦ä¸€ä¸ªä¿ç•™å…³é”®å­—ï¼Œå› æ­¤æˆ‘ä»¬å°†æ­¤å‘½åä¸º &lt;code&gt;t_return()&lt;/code&gt;ã€‚è¯·æ³¨æ„æˆ‘ä»¬çš„çº¿ç¨‹ç”¨æˆ·ä¸ä¼šè°ƒç”¨å®ƒï¼Œæˆ‘ä»¬è®¾ç½®æ ˆï¼Œä»¥ä¾¿åœ¨ä»»åŠ¡å®Œæˆæ—¶è°ƒç”¨å®ƒã€‚ å¦‚æœè°ƒç”¨çº¿ç¨‹æ˜¯ &lt;code&gt;base_thread&lt;/code&gt;ï¼ˆå³åŸºç¡€çº¿ç¨‹ï¼‰ï¼Œæˆ‘ä»¬ä»€ä¹ˆéƒ½ä¸åšã€‚æˆ‘ä»¬çš„è¿è¡Œæ—¶å°†åœ¨åŸºç¡€çº¿ç¨‹ä¸Šä¸ºæˆ‘ä»¬è°ƒç”¨ &lt;code&gt;yield&lt;/code&gt;ã€‚å¦‚æœä»ç”Ÿæˆçš„çº¿ç¨‹ä¸­è°ƒç”¨å®ƒï¼Œæˆ‘ä»¬çŸ¥é“å®ƒå·²ç»å®Œæˆï¼Œå› ä¸ºæ‰€æœ‰çº¿ç¨‹éƒ½åœ¨å®ƒä»¬çš„æ ˆé¡¶éƒ¨æœ‰ä¸€ä¸ª &lt;code&gt;guard&lt;/code&gt; å‡½æ•°ï¼ˆæˆ‘ä»¬å°†ä¸‹é¢è¿›ä¸€æ­¥å±•ç¤ºï¼‰ï¼Œå¹¶ä¸”è¿™ä¸ª &lt;code&gt;t_return&lt;/code&gt; å‡½æ•°å”¯ä¸€è¢«è°ƒç”¨çš„åœ°æ–¹å°±æ˜¯æˆ‘ä»¬çš„ &lt;code&gt;guard&lt;/code&gt; å‡½æ•°ã€‚ æˆ‘ä»¬å°†å½“å‰çº¿ç¨‹çŠ¶æ€è®¾ç½®ä¸º &lt;code&gt;Available&lt;/code&gt;ï¼Œè®©è¿è¡Œæ—¶çŸ¥é“å®ƒå·²å‡†å¤‡å¥½æ¥å—æ–°ä»»åŠ¡ï¼Œç„¶åç«‹å³è°ƒç”¨ &lt;code&gt;t_yield&lt;/code&gt;ï¼Œå®ƒå°†è°ƒåº¦æ–°çš„çº¿ç¨‹è¿è¡Œã€‚&lt;/p&gt;&lt;p&gt;æ¥ä¸‹æ¥æ˜¯æˆ‘ä»¬çš„ &lt;code&gt;yield&lt;/code&gt; å‡½æ•°ï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-rust&quot;&gt;&lt;span class=&quot;k&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;t_yield&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&quot;kt&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;current&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;while&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;threads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;State&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;Ready&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;threads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;current&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;threads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;current&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;State&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;Available&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;threads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;current&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;State&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;Ready&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;threads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;State&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;Running&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;old_pos&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;current&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;current&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;unsafe&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;switch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;threads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;old_pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ctx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;threads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ctx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// é˜²æ­¢ Windows çš„ç¼–è¯‘å™¨ä¼˜åŒ–æˆ‘ä»¬çš„ä»£ç ã€‚
&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;threads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™æ˜¯æˆ‘ä»¬è¿è¡Œæ—¶çš„æ ¸å¿ƒã€‚æˆ‘ä»¬å¿…é¡»å°†æ­¤å‘½åä¸º &lt;code&gt;t_yield&lt;/code&gt;ï¼Œå› ä¸º &lt;code&gt;yield&lt;/code&gt; æ˜¯ Rust ä¸­çš„ä¿ç•™å…³é”®å­—ã€‚ åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬éå†æ‰€æœ‰çº¿ç¨‹ï¼Œçœ‹çœ‹æ˜¯å¦æœ‰çº¿ç¨‹å¤„äº &lt;code&gt;Ready&lt;/code&gt; çŠ¶æ€ï¼Œ&lt;code&gt;Ready&lt;/code&gt; è¡¨æ˜å®ƒå·²å‡†å¤‡å¥½æ¢å¤æ‰§è¡Œã€‚åœ¨ç°å®ä¸–ç•Œçš„ç¨‹åºä¸­ï¼Œè¿™å¯èƒ½æ˜¯ä¸€ä¸ªæ•°æ®åº“è°ƒç”¨çš„è¿”å›ã€‚&lt;/p&gt;&lt;p&gt;å¦‚æœæ²¡æœ‰çº¿ç¨‹æ˜¯ &lt;code&gt;Ready&lt;/code&gt; çš„ï¼Œå°±ç›´æ¥è¿”å›ã€‚è¿™æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„è°ƒåº¦ç¨‹åºï¼Œåªä½¿ç”¨è½®è¯¢ç®—æ³•ï¼ŒçœŸæ­£çš„è°ƒåº¦ç¨‹åºå¯èƒ½æœ‰æ›´å¤æ‚çš„æ–¹æ³•æ¥å†³å®šä¸‹ä¸€ä¸ªè¦è¿è¡Œçš„ä»»åŠ¡ã€‚&lt;/p&gt;&lt;blockquote&gt; è¿™æ˜¯ä¸€ä¸ªä¸ºæˆ‘ä»¬çš„ä¾‹å­é‡èº«å®šåˆ¶çš„éå¸¸ç®€å•çš„å®ç°ã€‚å¦‚æœæˆ‘ä»¬çš„çº¿ç¨‹å°šæœªå‡†å¤‡å¥½è¿›è¡Œï¼ˆæœªå¤„äº &lt;code&gt;Ready&lt;/code&gt; çŠ¶æ€ï¼‰å¹¶ä»åœ¨ç­‰å¾…æ¯”å¦‚æ¥è‡ªæ•°æ®åº“çš„å“åº”ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ&lt;br/&gt; è§£å†³è¿™ä¸ªé—®é¢˜å¹¶ä¸å›°éš¾ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹ &lt;code&gt;Ready&lt;/code&gt;æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥è½®è¯¢å®ƒçš„çŠ¶æ€ï¼Œè€Œä¸æ˜¯ç›´æ¥è¿è¡Œæˆ‘ä»¬çš„ä»£ç ï¼Œã€‚æ¯”å¦‚ï¼Œå¦‚æœå®ƒçœŸçš„å‡†å¤‡å¥½è¿è¡Œå®ƒå¯ä»¥è¿”å› &lt;code&gt;IsReady&lt;/code&gt;ï¼Œå¦‚æœä»æ—§åœ¨ç­‰å¾…æŸäº›æ“ä½œå®Œæˆå®ƒå¯ä»¥è¿”å› &lt;code&gt;Pending&lt;/code&gt;ã€‚åœ¨åä¸€ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å®ƒå¤„äº &lt;code&gt;Ready&lt;/code&gt; çŠ¶æ€ï¼Œä»¥ä¾¿ç¨åå†æ¬¡è¿›è¡Œè½®è¯¢ã€‚æ˜¯ä¸æ˜¯å¬èµ·æ¥å¾ˆç†Ÿæ‚‰ï¼Ÿå¦‚æœæ‚¨å·²ç»é˜…è¯»äº†Futureåœ¨Rustä¸­çš„å·¥ä½œæ–¹å¼ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†å¼€å§‹å°±å®ƒä»¬å¦‚ä½•ç»„åˆåœ¨ä¸€èµ·æä¾›ä¸€äº›å»ºè®®ã€‚&lt;br/&gt; &lt;/blockquote&gt;&lt;p&gt;å¦‚æœæˆ‘ä»¬æ‰¾åˆ°ä¸€ä¸ªå‡†å¤‡è¿è¡Œçš„çº¿ç¨‹ï¼Œé‚£å°±å°†å½“å‰çº¿ç¨‹çš„çŠ¶æ€ä» &lt;code&gt;Running&lt;/code&gt; ä¿®æ”¹ä¸º &lt;code&gt;Ready&lt;/code&gt;ã€‚&lt;/p&gt;&lt;p&gt;ç„¶åæˆ‘ä»¬è°ƒç”¨ &lt;code&gt;switch&lt;/code&gt; æ¥ä¿å­˜å½“å‰ä¸Šä¸‹æ–‡ï¼ˆæ—§ä¸Šä¸‹æ–‡ï¼‰å¹¶å°†æ–°ä¸Šä¸‹æ–‡åŠ è½½åˆ° CPU ä¸­ã€‚æ–°ä¸Šä¸‹æ–‡è¦ä¹ˆæ˜¯æ–°ä»»åŠ¡ï¼Œè¦ä¹ˆæ˜¯ CPU åœ¨ç°æœ‰ä»»åŠ¡ä¸Šæ¢å¤å·¥ä½œæ‰€éœ€çš„æ‰€æœ‰ä¿¡æ¯ã€‚&lt;/p&gt;&lt;p&gt;æœ€ç»ˆçš„ &lt;code&gt;self.threads.len() &amp;gt; 0&lt;/code&gt; çš„éƒ¨åˆ†åªæ˜¯é˜»æ­¢ç¼–è¯‘å™¨ä¼˜åŒ–ä»£ç çš„ä¸€ç§æ–¹æ³•ã€‚è¿™ç§æƒ…å†µå‘ç”Ÿåœ¨ Windows ä¸Šï¼Œä½†ä¸å‘ç”Ÿåœ¨ Linux ä¸Šï¼Œä¾‹å¦‚åœ¨è¿è¡Œæ€§èƒ½æµ‹è¯•æ—¶æ˜¯ä¸€ä¸ªå¸¸è§é—®é¢˜ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ &lt;code&gt;std::hint::black_box&lt;/code&gt; æ¥é˜²æ­¢ç¼–è¯‘å™¨ä¸ºäº†æ›´å¿«åœ°æ‰§è¡Œä»£ç è€Œèµ°å¾—å¤ªè¿œå¹¶è·³è¿‡æˆ‘ä»¬éœ€è¦çš„æ­¥éª¤ã€‚æˆ‘é€‰æ‹©äº†å¦å¤–ä¸€ç§æ–¹æ³•ï¼Œåªè¦æ˜¯æœ‰æ³¨é‡Šçš„å°±åº”è¯¥æ²¡é—®é¢˜ï¼Œæ— è®ºå¦‚ä½•ä»£ç æ°¸è¿œä¸ä¼šæ‰§è¡Œåˆ°è¿™é‡Œã€‚&lt;/p&gt;&lt;p&gt;æ¥ä¸‹æ¥æ˜¯æˆ‘ä»¬çš„ &lt;code&gt;spawn()&lt;/code&gt; å‡½æ•°ï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-rust&quot;&gt;&lt;span class=&quot;k&quot;&gt;pub&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;spawn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;: &lt;span class=&quot;nc&quot;&gt;fn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;available&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;threads&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iter_mut&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;find&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;State&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;Available&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;expect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;no available thread.&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;available&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stack&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_ptr&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;available&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stack&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;as_mut_ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;unsafe&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ptr&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;offset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;24&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;isize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;guard&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ptr&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;offset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;isize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;available&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ctx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rsp&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;offset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;isize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;available&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;State&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;Ready&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æˆ‘è®¤ä¸º &lt;code&gt;t_yield&lt;/code&gt; åœ¨é€»è¾‘ä¸Šæ˜¯ä¸ªå¾ˆæœ‰è¶£çš„å‡½æ•°ï¼Œè€Œè¿™ä¸ªå‡½æ•°åœ¨æŠ€æœ¯ä¸Šæœ€æœ‰è¶£ã€‚&lt;/p&gt;&lt;p&gt;å°±åƒæˆ‘ä»¬åœ¨å‰ä¸€ç« ä¸­æ‰€è®¨è®ºçš„é‚£æ ·ï¼Œæˆ‘ä»¬è¦åœ¨è¿™åˆå§‹åŒ–æ ˆï¼Œå¹¶ä¸”è¦ç¡®ä¿æˆ‘ä»¬çš„æ ˆçœ‹èµ·æ¥åƒ psABI æ ˆå¸ƒå±€ä¸­æŒ‡å®šçš„æ ˆã€‚&lt;/p&gt;&lt;p&gt;å½“æˆ‘ä»¬ç”Ÿæˆä¸€ä¸ªæ–°çº¿ç¨‹æ—¶ï¼Œæˆ‘ä»¬é¦–å…ˆè¦æ£€æŸ¥æ˜¯å¦æœ‰ä»»ä½•å¯ç”¨çº¿ç¨‹ï¼ˆçº¿ç¨‹å¤„äº &lt;code&gt;Available&lt;/code&gt; çŠ¶æ€ï¼‰ã€‚å¦‚æœæˆ‘ä»¬çš„çº¿ç¨‹è€—å°½ï¼Œæˆ‘ä»¬ä¼šåœ¨è¿™ç§æƒ…å†µä¸‹ä½¿ç”¨ææ…Œï¼ˆpanicï¼‰æœºåˆ¶ï¼Œä½†æœ‰å‡ ç§ï¼ˆæ›´å¥½çš„ï¼‰æ–¹æ³•å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚æˆ‘ä»¬ç°åœ¨å°±ä¿æŒè¿™ç§ç®€å•çš„å®ç°ã€‚&lt;/p&gt;&lt;p&gt;å½“æˆ‘ä»¬æ‰¾åˆ°ä¸€ä¸ªå¯ç”¨çš„çº¿ç¨‹æ—¶ï¼Œæˆ‘ä»¬å¾—åˆ°æ ˆé•¿åº¦å’ŒæŒ‡å‘æˆ‘ä»¬çš„ u8 å­—èŠ‚æ•°ç»„çš„æŒ‡é’ˆã€‚&lt;/p&gt;&lt;p&gt;æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¿…é¡»ä½¿ç”¨ä¸€äº›ä¸å®‰å…¨çš„åŠŸèƒ½ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬ç¡®ä¿æŒ‡å‘å †æ ˆåº•éƒ¨çš„æŒ‡é’ˆæ˜¯16å­—èŠ‚å¯¹é½çš„ã€‚ç„¶åï¼Œæˆ‘ä»¬å†™å…¥ &lt;code&gt;guard&lt;/code&gt; å‡½æ•°çš„åœ°å€ï¼Œå½“æˆ‘ä»¬æä¾›çš„ä»»åŠ¡å®Œæˆå¹¶ä¸”å‡½æ•°è¿”å›æ—¶ï¼Œå°†è°ƒç”¨è¯¥åœ°å€ã€‚ç„¶åæˆ‘ä»¬å°† &lt;code&gt;f&lt;/code&gt; çš„åœ°å€å†™å…¥ï¼Œè¿™æ˜¯æˆ‘ä»¬é€šè¿‡å‚æ•°ä¼ é€’è¿›æ¥æƒ³è¦è¿è¡Œçš„å‡½æ•°ã€‚&lt;/p&gt;&lt;blockquote&gt; è¿˜è®°å¾—æˆ‘ä»¬åœ¨ &lt;b&gt;æ ˆ&lt;/b&gt; é‚£ä¸€ç« è§£é‡Šçš„æ ˆæ˜¯å¦‚ä½•å·¥ä½œçš„å—ï¼Ÿæˆ‘ä»¬å¸Œæœ› &lt;code&gt;f&lt;/code&gt; å‡½æ•°é¦–å…ˆè¿è¡Œï¼Œå› æ­¤æˆ‘ä»¬å°†åŸºæŒ‡é’ˆè®¾ç½®ä¸º &lt;code&gt;f&lt;/code&gt; å¹¶ç¡®ä¿å®ƒæ˜¯16å­—èŠ‚å¯¹é½çš„ã€‚ç„¶åæˆ‘ä»¬å°† &lt;code&gt;guard&lt;/code&gt; å‡½æ•°çš„åœ°å€å‹å…¥ã€‚å®ƒä¸æ˜¯16å­—èŠ‚å¯¹é½ï¼Œä½†æ˜¯å½“ &lt;code&gt;f&lt;/code&gt; è¿”å›æ—¶ï¼ŒCPU å°†è¯»å–ä¸‹ä¸€ä¸ªåœ°å€ä½œä¸º &lt;code&gt;f&lt;/code&gt; çš„è¿”å›åœ°å€å¹¶åœ¨é‚£é‡Œç»§ç»­æ‰§è¡Œã€‚&lt;br/&gt; &lt;/blockquote&gt;&lt;p&gt;ç„¶åï¼Œæˆ‘ä»¬è®¾ç½® &lt;code&gt;rsp&lt;/code&gt; çš„å€¼ï¼Œå®ƒæ˜¯æŒ‡å‘æˆ‘ä»¬æä¾›çš„å‡½æ•°åœ°å€çš„æ ˆæŒ‡é’ˆï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨è®¡åˆ’è¿è¡Œæ—¶é¦–å…ˆå¼€å§‹æ‰§è¡Œå®ƒã€‚&lt;/p&gt;&lt;p&gt;æœ€åï¼Œæˆ‘ä»¬å°†çŠ¶æ€è®¾ç½®ä¸º &lt;code&gt;Ready&lt;/code&gt;ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬æœ‰å·¥ä½œè¦åšï¼Œå¹¶ä¸”æˆ‘ä»¬å·²ç»å‡†å¤‡å¥½äº†ã€‚è¯·è®°ä½ï¼Œå®é™…å¯åŠ¨æ­¤çº¿ç¨‹å–å†³äºæˆ‘ä»¬çš„â€œè°ƒåº¦ç¨‹åºâ€ã€‚&lt;/p&gt;&lt;p&gt;æˆ‘ä»¬ç°åœ¨å·²ç»å®Œæˆäº† &lt;code&gt;Runtime&lt;/code&gt; çš„å®ç°ï¼Œå¦‚æœä½ æŒæ¡äº†æ‰€æœ‰è¿™äº›ï¼Œä½ åŸºæœ¬ä¸Šå°±èƒ½ç†è§£ç»¿è‰²çº¿ç¨‹æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚ä½†æ˜¯ï¼Œå®ç°å®ƒä»¬ä»ç„¶éœ€è¦ä¸€äº›ç»†èŠ‚ã€‚&lt;/p&gt;&lt;h3&gt;&lt;code&gt;guard&lt;/code&gt; å’Œ &lt;code&gt;switch&lt;/code&gt; å‡½æ•°&lt;/h3&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-rust&quot;&gt;&lt;span class=&quot;k&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;guard&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;unsafe&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rt_ptr&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RUNTIME&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Runtime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rt_ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_return&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¯¥å‡½æ•°æ„å‘³ç€æˆ‘ä»¬ä¼ å…¥çš„å‡½æ•°å·²ç»è¿”å›ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬çš„çº¿ç¨‹å·²å®Œæˆè¿è¡Œå…¶ä»»åŠ¡ï¼Œå› æ­¤æˆ‘ä»¬å–æ¶ˆå¼•ç”¨æˆ‘ä»¬çš„è¿è¡Œæ—¶å¹¶è°ƒç”¨&lt;code&gt;t_return()&lt;/code&gt;ã€‚æˆ‘ä»¬æœ¬å¯ä»¥åˆ›å»ºä¸€ä¸ªå‡½æ•°ï¼Œåœ¨çº¿ç¨‹å®Œæˆæ—¶æ‰§è¡Œä¸€äº›é¢å¤–çš„å·¥ä½œä½†æ˜¯ç°åœ¨æˆ‘ä»¬çš„ &lt;code&gt;t_return()&lt;/code&gt; å‡½æ•°å·²ç»å¯ä»¥æ»¡è¶³æˆ‘ä»¬çš„éœ€è¦äº†ã€‚å®ƒå°†æˆ‘ä»¬çš„çº¿ç¨‹æ ‡è®°ä¸º &lt;code&gt;Available&lt;/code&gt;ï¼ˆå¦‚æœå®ƒä¸æ˜¯æˆ‘ä»¬çš„åŸºæœ¬çº¿ç¨‹ï¼‰å’Œ &lt;code&gt;yield&lt;/code&gt;ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨å¦å¤–ä¸€ä¸ªçº¿ç¨‹ä¸Šæ¢å¤å·¥ä½œã€‚&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-rust&quot;&gt;&lt;span class=&quot;k&quot;&gt;pub&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;yield_thread&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;unsafe&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rt_ptr&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RUNTIME&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Runtime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rt_ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_yield&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™åªæ˜¯ä¸€ä¸ªè¾…åŠ©å‡½æ•°ï¼Œå®ƒå…è®¸æˆ‘ä»¬ä»ä»£ç ä¸­çš„ä»»æ„ä½ç½®è°ƒç”¨ &lt;code&gt;yield&lt;/code&gt;ã€‚ä¸è¿‡è¿™æ˜¯éå¸¸ä¸å®‰å…¨çš„ï¼Œå¦‚æœæˆ‘ä»¬è°ƒç”¨å®ƒå¹¶ä¸”æˆ‘ä»¬çš„ &lt;code&gt;Runtime&lt;/code&gt; å°šæœªåˆå§‹åŒ–æˆ–è¿è¡Œæ—¶è¢«åˆ é™¤ï¼Œåˆ™ä¼šå¯¼è‡´æœªå®šä¹‰çš„è¡Œä¸ºã€‚ç„¶è€Œï¼Œè®©è¿™ä¸ªæ›´å®‰å…¨å¹¶ä¸æ˜¯æˆ‘ä»¬çš„ä¼˜å…ˆäº‹é¡¹ï¼Œæˆ‘ä»¬åªæ˜¯ä¸ºäº†è®©æˆ‘ä»¬çš„ä¾‹å­å¯åŠ¨å¹¶è¿è¡Œã€‚&lt;/p&gt;&lt;p&gt;æˆ‘ä»¬å¾ˆå¿«å°±åˆ°è¾¾ç»ˆç‚¹äº†ï¼Œè¿˜æœ‰æœ€åä¸€ä¸ªå‡½æ•°ã€‚å¦‚æœä½ å·²å®Œæˆå‰é¢çš„ç« èŠ‚ï¼Œé‚£ä¹ˆåœ¨æ²¡æœ‰å¾ˆå¤šè¯„è®ºçš„æƒ…å†µä¸‹åº”è¯¥å¯ä»¥ç†è§£è¿™ä¸ªï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-rust&quot;&gt;&lt;span class=&quot;cp&quot;&gt;#[naked]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;#[inline(never)]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;unsafe&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;switch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;old&lt;/span&gt;: &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ThreadContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new&lt;/span&gt;: &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;const&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ThreadContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;asm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rsp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x00&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x08&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r14&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r13&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x18&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r12&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rbx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x28&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rbp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x00&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rsp&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x08&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r15&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r14&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x18&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r13&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r12&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x28&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rbx&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rbp&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ret&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;:
    :&lt;span class=&quot;s&quot;&gt;&amp;#34;r&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;old&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;r&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;:
    : &lt;span class=&quot;s&quot;&gt;&amp;#34;volatile&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;alignstack&amp;#34;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™å°±æ˜¯æˆ‘ä»¬çš„å†…è”æ±‡ç¼–ã€‚æ­£å¦‚ç¬¬ä¸€ä¸ªä¾‹å­é‚£æ ·ï¼Œæˆ‘ä»¬é¦–å…ˆè¯»å‡ºæˆ‘ä»¬éœ€è¦çš„æ‰€æœ‰å¯„å­˜å™¨çš„å€¼ï¼Œç„¶åå°†æ‰€æœ‰å¯„å­˜å™¨å€¼è®¾ç½®ä¸ºæˆ‘ä»¬åœ¨â€œæ–°â€çº¿ç¨‹ä¸Šæš‚åœæ‰§è¡Œæ—¶ä¿å­˜çš„å¯„å­˜å™¨å€¼ã€‚ è¿™åŸºæœ¬ä¸Šæ˜¯ä¿å­˜å’Œæ¢å¤æ‰§è¡Œæ‰€éœ€è¦åšçš„å…¨éƒ¨å·¥ä½œã€‚ è¿™é‡Œæˆ‘ä»¬çœ‹åˆ°ä½¿ç”¨çš„ &lt;code&gt;#[naked]&lt;/code&gt; å±æ€§ã€‚æˆ‘ä»¬ä¸å¸Œæœ›Rustä¸ºæˆ‘ä»¬çš„å‡½æ•°ç”Ÿæˆåºè¨€å’Œç»“è¯­ï¼Œå› ä¸ºè¿™å°±æ˜¯æ‰€æœ‰çš„æ±‡ç¼–ä»£ç ï¼Œæˆ‘ä»¬å¸Œæœ›è‡ªå·±å¤„ç†æ‰€æœ‰äº‹æƒ…ã€‚å¦‚æœæˆ‘ä»¬ä¸åŠ ä¸Šè¿™ä¸ªï¼Œæˆ‘ä»¬å°†æ— æ³•å†æ¬¡åˆ‡æ¢å›æˆ‘ä»¬çš„æ ˆã€‚&lt;/p&gt;&lt;blockquote&gt; å¤§å¤šæ•°å†…è”æ±‡ç¼–éƒ½åœ¨ &lt;b&gt;ä¸€ä¸ªèƒ½è·‘é€šçš„ä¾‹å­&lt;/b&gt; ä¸€ç« çš„æœ«å°¾è§£é‡Šäº†ï¼Œå¦‚æœè¿™çœ‹èµ·æ¥å¾ˆé™Œç”Ÿï¼Œè¯·é˜…è¯»é‚£ç« çš„ç›¸å…³éƒ¨åˆ†å†å›æ¥ã€‚&lt;br/&gt; &lt;/blockquote&gt;&lt;p&gt;è¿™ä¸ªå‡½æ•°æœ‰ä¸¤å¤„ä¸æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªå‡½æ•°ä¸åŒï¼š&lt;/p&gt;&lt;p&gt;ç¬¬ä¸€ä¸ªæ˜¯å±æ€§ &lt;code&gt;#[inline(never)]&lt;/code&gt;ï¼Œè¯¥å±æ€§é˜»æ­¢ç¼–è¯‘å™¨å†…è”æ­¤å‡½æ•°ã€‚æˆ‘èŠ±äº†ä¸€äº›æ—¶é—´æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬ä¸åŒ…å«å®ƒï¼Œé‚£ä¹ˆåœ¨ä½¿ç”¨ &lt;code&gt;--release&lt;/code&gt; æ¨¡å¼ç¼–è¯‘æ—¶ä»£ç å°†ä¼šè¿è¡Œå¤±è´¥ã€‚&lt;/p&gt;&lt;p&gt;â€œvolatileâ€ é€‰é¡¹æ˜¯æ–°åŠ çš„ã€‚æ­£å¦‚æˆ‘ä¹‹å‰è­¦å‘Šçš„é‚£æ ·ï¼Œå†…è”æ±‡ç¼–å¯èƒ½æœ‰äº›ç²—ç³™ï¼Œä½†è¿™ä¹Ÿè¡¨æ˜æˆ‘ä»¬çš„æ±‡ç¼–æœ‰å‰¯ä½œç”¨ã€‚å½“æˆ‘ä»¬æä¾›å‚æ•°ä½œä¸ºè¾“å…¥æ—¶ï¼Œæˆ‘ä»¬éœ€è¦ç¡®ä¿ç¼–è¯‘å™¨çŸ¥é“æˆ‘ä»¬æ­£åœ¨ä¿®æ”¹å…¶ä¸­ä¸€ä¸ªä¼ å…¥å‚æ•°è€Œä¸ä»…ä»…æ˜¯è¯»å–å®ƒä»¬ã€‚&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-rust&quot;&gt;&lt;span class=&quot;mh&quot;&gt;0x00&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x08&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x18&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;24&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æˆ‘ç®€è¦åœ°æåˆ°è¿‡è¿™ä¸€ç‚¹ï¼Œä½†åœ¨è¿™é‡Œä½ èƒ½çœ‹åˆ°å®ƒçš„å®é™…æ•ˆæœã€‚è¿™äº›æ˜¯åå…­è¿›åˆ¶æ•°å­—ï¼Œè¡¨ç¤ºä»æˆ‘ä»¬æƒ³è¦è¯»/å†™çš„å†…å­˜æŒ‡é’ˆçš„åç§»é‡ã€‚æˆ‘åœ¨æ—è¾¹åŠ äº†åè¿›åˆ¶çš„æ³¨é‡Šï¼Œå› æ­¤ä½ çœ‹åˆ°æˆ‘ä»¬åªä»¥ 8 å­—èŠ‚æ­¥é•¿åç§»æŒ‡é’ˆï¼Œè¿™ä¸ &lt;code&gt;ThreadContext&lt;/code&gt; ç»“æ„ä¸­çš„ &lt;code&gt;u64&lt;/code&gt; å­—æ®µå¤§å°ç›¸åŒã€‚&lt;/p&gt;&lt;p&gt;è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆç”¨ &lt;code&gt;#[repr(C)]&lt;/code&gt; æ³¨é‡Š &lt;code&gt;ThreadContext&lt;/code&gt; å¾ˆé‡è¦çš„åŸå› ï¼Œæ‰€ä»¥æˆ‘ä»¬çŸ¥é“æ•°æ®å°†ä»¥è¿™ç§æ–¹å¼åœ¨å†…å­˜ä¸­è¡¨ç¤ºï¼Œæˆ‘ä»¬å†™å…¥æ­£ç¡®çš„å­—æ®µã€‚ Rust ABI ä¸ä¿è¯å®ƒä»¬åœ¨å†…å­˜ä¸­ä»¥ç›¸åŒçš„é¡ºåºè¡¨ç¤ºï¼Œä½†æ˜¯ C-ABI å¯ä»¥ä¿è¯è¿™ä¸€ç‚¹ã€‚&lt;/p&gt;&lt;h3&gt;&lt;code&gt;main&lt;/code&gt; å‡½æ•°&lt;/h3&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-rust&quot;&gt;&lt;span class=&quot;k&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;runtime&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Runtime&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;runtime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;runtime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;spawn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;THREAD 1 STARTING&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;in&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;..&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;thread: {} counter: {}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;yield_thread&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;THREAD 1 FINISHED&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;runtime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;spawn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;THREAD 2 STARTING&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;in&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;..&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;thread: {} counter: {}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;yield_thread&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;THREAD 2 FINISHED&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;runtime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ­£å¦‚ä½ åœ¨è¿™é‡Œçœ‹åˆ°çš„é‚£æ ·ï¼Œæˆ‘ä»¬åˆå§‹åŒ–æˆ‘ä»¬çš„è¿è¡Œæ—¶å¹¶åˆ›å»ºä¸¤ä¸ªçº¿ç¨‹ï¼Œä¸€ä¸ªè®¡æ•°åˆ° &lt;code&gt;10&lt;/code&gt;ï¼Œä¸€ä¸ªè®¡æ•°åˆ° &lt;code&gt;15&lt;/code&gt;ï¼Œæ¯ä¸¤æ¬¡è®¡æ•°ä¹‹é—´éƒ½ä¼šæ‰§è¡Œ &lt;code&gt;yield&lt;/code&gt;ã€‚å½“æˆ‘ä»¬ä½¿ç”¨ &lt;code&gt;cargo run&lt;/code&gt; å‘½ä»¤è¿è¡Œå·¥ç¨‹æ—¶ï¼Œæˆ‘ä»¬åº”è¯¥ä¼šå¾—åˆ°ä»¥ä¸‹è¾“å‡ºï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;Finished dev [unoptimized + debuginfo] target(s) in 2.17s
Running `target/debug/green_threads`
THREAD 1 STARTING
thread: 1 counter: 0
THREAD 2 STARTING
thread: 2 counter: 0
thread: 1 counter: 1
thread: 2 counter: 1
thread: 1 counter: 2
thread: 2 counter: 2
thread: 1 counter: 3
thread: 2 counter: 3
thread: 1 counter: 4
thread: 2 counter: 4
thread: 1 counter: 5
thread: 2 counter: 5
thread: 1 counter: 6
thread: 2 counter: 6
thread: 1 counter: 7
thread: 2 counter: 7
thread: 1 counter: 8
thread: 2 counter: 8
thread: 1 counter: 9
thread: 2 counter: 9
THREAD 1 FINISHED.
thread: 2 counter: 10
thread: 2 counter: 11
thread: 2 counter: 12
thread: 2 counter: 13
thread: 2 counter: 14
THREAD 2 FINISHED.&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ¼‚äº®ï¼ï¼æˆ‘ä»¬çš„çº¿ç¨‹äº¤æ›¿æ‰§è¡Œï¼Œå› ä¸ºå®ƒä»¬å¯¹æ¯ä¸ªè®¡æ•°äº§ç”Ÿæ§åˆ¶ï¼Œç›´åˆ°çº¿ç¨‹ 1 å®Œæˆå¹¶ä¸”çº¿ç¨‹ 2 åœ¨å®Œæˆä»»åŠ¡ä¹‹å‰æ•°åˆ°æœ€åä¸€ä¸ªæ•°å­—ã€‚&lt;/p&gt;&lt;h3&gt;æ­å–œ&lt;/h3&gt;&lt;p&gt;ä½ ç°åœ¨å·²ç»å®ç°äº†ä¸€ä¸ªéå¸¸ç®€å•ä½†å¯ç”¨çš„ç»¿è‰²çº¿ç¨‹ç¤ºä¾‹ã€‚è¿™æ˜¯æˆ‘ä»¬æ¢ç´¢å®ƒçš„å¿…ç»ä¹‹è·¯ï¼Œä½†å¦‚æœä½ å·²ç»èµ°äº†è¿™ä¹ˆè¿œå¹¶é€šè¯»äº†æ‰€æœ‰å†…å®¹ï¼Œä½ å€¼å¾—ä¼‘æ¯ä¸€ä¸‹ã€‚è°¢è°¢é˜…è¯»ï¼&lt;/p&gt;&lt;blockquote&gt; è¯‘è€…æ³¨ï¼šåŸä¹¦çš„åä¸€ç« å°±æ˜¯å•çº¯çš„200è¡Œå®Œæ•´ä»£ç ï¼Œæˆ‘ç›´æ¥å°±æ”¾åœ¨æœ¬ç« é‡Œäº†:&lt;br/&gt; &lt;/blockquote&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-rust&quot;&gt;&lt;span class=&quot;cp&quot;&gt;#![feature(asm)]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;#![feature(naked_functions)]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;use&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;const&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DEFAULT_STACK_SIZE&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;usize&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;const&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MAX_THREADS&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;usize&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;static&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RUNTIME&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;usize&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;pub&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Runtime&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;threads&lt;/span&gt;: &lt;span class=&quot;nb&quot;&gt;Vec&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;current&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;usize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;#[derive(PartialEq, Eq, Debug)]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;enum&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;State&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Available&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Running&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Ready&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;usize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stack&lt;/span&gt;: &lt;span class=&quot;nb&quot;&gt;Vec&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u8&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ctx&lt;/span&gt;: &lt;span class=&quot;nc&quot;&gt;ThreadContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;: &lt;span class=&quot;nc&quot;&gt;State&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;#[derive(Debug, Default)]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;#[repr(C)]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ThreadContext&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rsp&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r15&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r14&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r13&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r12&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rbx&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rbp&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;impl&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;usize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&quot;nc&quot;&gt;Self&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stack&lt;/span&gt;: &lt;span class=&quot;nc&quot;&gt;vec&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0_&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;u8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DEFAULT_STACK_SIZE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ctx&lt;/span&gt;: &lt;span class=&quot;nc&quot;&gt;ThreadContext&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;default&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;: &lt;span class=&quot;nc&quot;&gt;State&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;Available&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;impl&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Runtime&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;pub&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&quot;nc&quot;&gt;Self&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;base_thread&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;: &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stack&lt;/span&gt;: &lt;span class=&quot;nc&quot;&gt;vec&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0_&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;u8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DEFAULT_STACK_SIZE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ctx&lt;/span&gt;: &lt;span class=&quot;nc&quot;&gt;ThreadContext&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;default&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;: &lt;span class=&quot;nc&quot;&gt;State&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;Running&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;threads&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vec&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;base_thread&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;available_threads&lt;/span&gt;: &lt;span class=&quot;nb&quot;&gt;Vec&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;..&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MAX_THREADS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Thread&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;collect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;threads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;available_threads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Runtime&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;threads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;current&lt;/span&gt;: &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;pub&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;unsafe&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r_ptr&lt;/span&gt;: &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;const&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Runtime&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RUNTIME&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r_ptr&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;usize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;pub&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;while&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_yield&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;process&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;exit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;t_return&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;current&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;threads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;current&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;State&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;Available&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_yield&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;t_yield&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&quot;kt&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;current&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;while&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;threads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;State&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;Ready&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;threads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;current&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;threads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;current&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;State&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;Available&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;threads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;current&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;State&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;Ready&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;threads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;State&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;Running&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;old_pos&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;current&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;current&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;unsafe&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;switch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;threads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;old_pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ctx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;threads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ctx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;threads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;pub&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;spawn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;: &lt;span class=&quot;nc&quot;&gt;fn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;available&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;threads&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iter_mut&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;find&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;State&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;Available&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;expect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;no available thread.&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;available&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stack&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;unsafe&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_ptr&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;available&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stack&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;as_mut_ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;offset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;isize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_ptr&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_ptr&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;usize&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ptr&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;offset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;24&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;guard&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ptr&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;offset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;available&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ctx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rsp&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;offset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;available&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;State&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;Ready&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;guard&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;unsafe&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rt_ptr&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RUNTIME&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Runtime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rt_ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_return&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;pub&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;yield_thread&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;unsafe&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rt_ptr&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RUNTIME&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Runtime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rt_ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_yield&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;#[naked]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;#[inline(never)]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;unsafe&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;switch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;old&lt;/span&gt;: &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ThreadContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new&lt;/span&gt;: &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;const&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ThreadContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;asm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rsp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x00&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x08&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r14&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r13&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x18&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r12&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rbx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x28&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rbp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x00&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rsp&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x08&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r15&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r14&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x18&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r13&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r12&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x28&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rbx&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rbp&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ret&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;:
    :&lt;span class=&quot;s&quot;&gt;&amp;#34;r&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;old&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;r&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;:
    : &lt;span class=&quot;s&quot;&gt;&amp;#34;volatile&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;alignstack&amp;#34;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;runtime&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Runtime&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;runtime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;runtime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;spawn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;THREAD 1 STARTING&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;in&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;..&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;thread: {} counter: {}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;yield_thread&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;THREAD 1 FINISHED&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;runtime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;spawn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;THREAD 2 STARTING&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;in&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;..&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;thread: {} counter: {}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;yield_thread&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;THREAD 2 FINISHED&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;runtime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>ä¸æ˜è§‰ç–¼</author>
<guid isPermaLink="false">2020-01-09-101061389</guid>
<pubDate>Thu, 09 Jan 2020 00:00:00 +0800</pubDate>
</item>
<item>
<title>é›¶æˆæœ¬å¼‚æ­¥I/O</title>
<link>https://henix.github.io/feeds/zhuanlan.rust-lang/2020-01-05-97574385.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/97574385&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt; è¿™æ˜¯ Withoutboats åœ¨ 2019 å¹´ 3 æœˆçš„ Rust Latam ä¸Šæ‰€åšæŠ¥å‘Šçš„ä¸€ä¸ªç¿»è¯‘å’Œæ•´ç†ã€‚è¿™ä¸ªæŠ¥å‘Šä¸»è¦ä»‹ç»ä»–å‚ä¸å¼€å‘äº†ä¸€å¹´åŠçš„è¯­è¨€ç‰¹æ€§ï¼ŒåŒ…æ‹¬ Rust å¼‚æ­¥ I/O çš„å‘å±•å†ç¨‹ï¼Œä»¥åŠç›®å‰å·²ç»ç¨³å®šçš„é›¶æˆæœ¬æŠ½è±¡çš„&lt;code&gt;async&lt;/code&gt;/&lt;code&gt;await&lt;/code&gt; è¯­æ³•çš„å…³é”®å®ç°åŸç†ã€‚&lt;br/&gt;&lt;br/&gt; Withoutboats æ˜¯å°±èŒäº Mozilla çš„ä¸€åç ”ç©¶å‘˜ï¼Œä¸»è¦ä»äº‹ Rust è¯­è¨€å¼€å‘ã€‚ä»–å¼€å‘çš„è¿™ä¸ªè¯­è¨€ç‰¹æ€§å«åš &lt;code&gt;async&lt;/code&gt;/&lt;code&gt;await&lt;/code&gt;ï¼Œè¿™å¯èƒ½æ˜¯æœ¬å¹´åº¦æˆ‘ä»¬åœ¨ Rust è¯­è¨€ä¸Šåšçš„æœ€é‡è¦çš„äº‹ã€‚è¿™è§£å†³äº†å›°æ‰°æˆ‘ä»¬å¾ˆä¹…çš„é—®é¢˜ï¼Œå³æˆ‘ä»¬å¦‚ä½•èƒ½åœ¨ Rust ä¸­æ‹¥æœ‰é›¶æˆæœ¬æŠ½è±¡çš„å¼‚æ­¥IOã€‚&lt;br/&gt;&lt;br/&gt; æ³¨ï¼šæŠ¥å‘Šè§†é¢‘ä¸­çš„å¹»ç¯ç‰‡æ¯”è¾ƒæ¨¡ç³Šï¼Œæˆ‘å¯¹å…¶è¿›è¡Œäº†é‡ç»˜ä¸ç¿»è¯‘ï¼›å› ä¸ªäººæ°´å¹³æœ‰é™ï¼Œç¿»è¯‘å’Œæ•´ç†éš¾å…æœ‰é”™è¯¯æˆ–ç–æ¼ä¹‹å¤„ï¼Œæ¬¢è¿è¯»è€…æ‰¹è¯„æŒ‡æ­£ã€‚&lt;br/&gt; &lt;/blockquote&gt;&lt;h2&gt;&lt;code&gt;async&lt;/code&gt;/&lt;code&gt;await&lt;/code&gt;&lt;/h2&gt;&lt;p&gt;é¦–å…ˆï¼Œä»‹ç»ä¸€ä¸‹ &lt;code&gt;async&lt;/code&gt;/&lt;code&gt;await&lt;/code&gt;ã€‚&lt;/p&gt;&lt;p&gt;&lt;code&gt;async&lt;/code&gt; æ˜¯ä¸€ä¸ªä¿®é¥°ç¬¦ï¼Œå®ƒå¯ä»¥åº”ç”¨åœ¨å‡½æ•°ä¸Šï¼Œè¿™ç§å‡½æ•°ä¸ä¼šåœ¨è°ƒç”¨æ—¶ä¸€å¥å¥è¿è¡Œå®Œæˆï¼Œè€Œæ˜¯ç«‹å³è¿”å›ä¸€ä¸ª &lt;code&gt;Future&lt;/code&gt; å¯¹è±¡ï¼Œè¿™ä¸ª &lt;code&gt;Future&lt;/code&gt; å¯¹è±¡æœ€ç»ˆå°†ç»™å‡ºè¿™ä¸ªå‡½æ•°çš„å®é™…è¿”å›ç»“æœã€‚è€Œåœ¨ä¸€ä¸ªè¿™æ ·çš„ &lt;code&gt;async&lt;/code&gt; å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨awaitè¿ç®—ç¬¦ï¼Œå°†å®ƒç”¨åœ¨å…¶å®ƒä¼šè¿”å› &lt;code&gt;Future&lt;/code&gt; çš„å‡½æ•°ä¸Šï¼Œç›´åˆ°é‚£äº› &lt;code&gt;Future&lt;/code&gt; è¿”å›å®é™…ç»“æœã€‚é€šè¿‡è¿™ç§æ–¹æ³•ï¼Œå¼‚æ­¥å¹¶å‘å¼€å‘æ›´åŠ æ–¹ä¾¿äº†ã€‚&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-rust&quot;&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;await&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;db&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_user&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;withoutboats&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;impl&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Database&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;async&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;get_user&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;user&lt;/span&gt;: &lt;span class=&quot;kp&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&quot;nc&quot;&gt;User&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sql&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;select FROM users WHERE username = {}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;db_response&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;await&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sql&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;User&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;from&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;db_response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™æ˜¯ä¸€æ®µç®€çŸ­çš„ä»£ç æ ·ä¾‹ï¼Œæˆ‘ä»¬å…·ä½“è§£é‡Šä¸€ä¸‹ &lt;code&gt;Future&lt;/code&gt; ã€‚è¿™æ®µä»£ç åŸºæœ¬ä¸Šåšçš„å°±æ˜¯ä¸€ç§ç±»ä¼¼äº ORM æ¡†æ¶æ‰€ä½œçš„äº‹ã€‚ä½ æœ‰ä¸€ä¸ªå« &lt;code&gt;get_user&lt;/code&gt; çš„å‡½æ•°ï¼Œå®ƒæ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹çš„ç”¨æˆ·åå‚æ•°ï¼Œå¹¶é€šè¿‡åœ¨æ•°æ®åº“ä¸­æŸ¥æ‰¾å¯¹åº”ç”¨æˆ·çš„è®°å½•æ¥è¿”å›ä¸€ä¸ªUserå¯¹è±¡ã€‚å®ƒä½¿ç”¨çš„æ˜¯å¼‚æ­¥ I/O ï¼Œè¿™æ„å‘³ç€å®ƒå¾—æ˜¯ä¸€ä¸ªå¼‚æ­¥å‡½æ•°ï¼Œè€Œä¸æ˜¯æ™®é€šå‡½æ•°ï¼Œå› æ­¤å½“ä½ è°ƒç”¨å®ƒæ—¶ï¼Œä½ å¯ä»¥å¼‚æ­¥ç­‰å¾…ï¼ˆ&lt;code&gt;await&lt;/code&gt;ï¼‰å®ƒï¼›ç„¶åæˆ‘ä»¬çœ‹ä¸€ä¸‹å‡½æ•°çš„å®ç°ï¼Œé¦–å…ˆæ˜¯ç”¨ç”¨æˆ·åå‚æ•°æ‹¼æ¥å‡ºè¦æ‰§è¡Œçš„ SQL è¯­å¥ï¼Œç„¶åæ˜¯æŸ¥è¯¢æ•°æ®åº“ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬å®é™…æ‰§è¡Œ I/O çš„åœ°æ–¹ï¼Œæ‰€ä»¥è¿™ä¸ªæŸ¥è¯¢ï¼ˆqueryï¼‰è¿”å›çš„æ˜¯ &lt;code&gt;Future&lt;/code&gt; ï¼Œå› ä¸ºå®ƒä½¿ç”¨çš„æ˜¯å¼‚æ­¥ I/O ã€‚æ‰€ä»¥åœ¨æŸ¥è¯¢æ•°æ®åº“æ—¶ï¼Œä½ åªéœ€è¦ä½¿ç”¨å¼‚æ­¥ç­‰å¾…ï¼ˆ&lt;code&gt;await&lt;/code&gt;ï¼‰æ¥ç­‰å¾…å“åº”ï¼Œåœ¨è·å¾—å“åº”åå°±å¯ä»¥ä»ä¸­è§£æå‡ºç”¨æˆ·ã€‚è¿™ä¸ªå‡½æ•°çœ‹èµ·æ¥åƒä¸ªç©å…·ï¼Œä½†æˆ‘æƒ³å¼ºè°ƒçš„æ˜¯ï¼Œå®ƒä¸ä½¿ç”¨é˜»å¡å¼ I/O çš„å”¯ä¸€åŒºåˆ«å°±æ˜¯è¿™äº›æ³¨è§£ï¼ˆæŒ‡&lt;code&gt;async&lt;/code&gt;/&lt;code&gt;await&lt;/code&gt;ï¼‰äº†ï¼Œä½ åªéœ€å°†å‡½æ•°æ ‡è®°ä¸ºå¼‚æ­¥ï¼ˆ&lt;code&gt;async&lt;/code&gt;ï¼‰ï¼Œå¹¶åœ¨è°ƒç”¨å®ƒä»¬æ—¶åŠ ä¸Š &lt;code&gt;await&lt;/code&gt; å°±è¡Œäº†ï¼Œå¼€å‘çš„å¿ƒæ™ºè´Ÿæ‹…å¾ˆå°ï¼Œä»¥è‡³äºä½ ä¼šå¿˜äº†è‡ªå·±æ˜¯åœ¨å†™å¼‚æ­¥ I/O è€Œä¸æ˜¯é˜»å¡ I/O ã€‚è€Œ Rust çš„è¿™ç§å®ç°è®©æˆ‘å°¤å…¶æ„Ÿåˆ°å…´å¥‹çš„æ˜¯ï¼Œå®ƒçš„ &lt;code&gt;async&lt;/code&gt;/&lt;code&gt;await&lt;/code&gt; å’Œ &lt;code&gt;Future&lt;/code&gt; éƒ½æ˜¯é›¶æˆæœ¬æŠ½è±¡çš„ã€‚&lt;/p&gt;&lt;h2&gt;é›¶æˆæœ¬æŠ½è±¡&lt;/h2&gt;&lt;p&gt;é›¶æˆæœ¬æŠ½è±¡æ˜¯ Rust æ¯”è¾ƒç‹¬ç‰¹çš„ä¸€é¡¹å‡†åˆ™ï¼Œè¿™æ˜¯ä½¿ Rust ä¸å…¶ä»–è®¸å¤šè¯­è¨€ç›¸åŒºåˆ«çš„åŸå› ä¹‹ä¸€ã€‚åœ¨æ·»åŠ æ–°åŠŸèƒ½æ—¶ï¼Œæˆ‘ä»¬éå¸¸å…³å¿ƒè¿™äº›æ–°åŠŸèƒ½æ˜¯ä¸æ˜¯é›¶æˆæœ¬çš„ã€‚ä¸è¿‡è¿™å¹¶ä¸æ˜¯æˆ‘ä»¬æƒ³å‡ºæ¥çš„ç‚¹å­ï¼Œå®ƒåœ¨ C++ ä¸­ä¹Ÿå¾ˆé‡è¦ï¼Œæ‰€ä»¥æˆ‘è®¤ä¸ºæœ€å¥½çš„è§£é‡Šæ˜¯ Bjarne Stroustrup çš„è¿™å¥è¯ï¼š&lt;/p&gt;&lt;blockquote&gt; é›¶æˆæœ¬æŠ½è±¡æ„å‘³ç€ä½ ä¸ä½¿ç”¨çš„ä¸œè¥¿ï¼Œä½ ä¸ç”¨ä¸ºå®ƒä»˜å‡ºä»»ä½•ä»£ä»·ï¼Œè¿›ä¸€æ­¥è®²ï¼Œä½ ä½¿ç”¨çš„ä¸œè¥¿ï¼Œä½ æ— æ³•å†™å‡ºæ¯”è¿™æ›´å¥½çš„ä»£ç ã€‚&lt;br/&gt; Zero Cost Abstractions: What you don&amp;#39;t use, you don&amp;#39;t pay for. And further: What you do use, you couldn&amp;#39;t hand code any better.&lt;br/&gt; &lt;/blockquote&gt;&lt;p&gt;ä¹Ÿå°±æ˜¯è¯´é›¶æˆæœ¬æŠ½è±¡æœ‰ä¸¤ä¸ªæ–¹é¢ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;è¯¥åŠŸèƒ½ä¸ä¼šç»™ä¸ä½¿ç”¨è¯¥åŠŸèƒ½çš„ç”¨æˆ·å¢åŠ æˆæœ¬ï¼Œå› æ­¤æˆ‘ä»¬ä¸èƒ½ä¸ºäº†å¢åŠ æ–°çš„ç‰¹æ€§è€Œå¢åŠ é‚£äº›ä¼šå‡æ…¢æ‰€æœ‰ç¨‹åºè¿è¡Œçš„å…¨å±€æ€§å¼€é”€ã€‚&lt;/li&gt;&lt;li&gt;å½“ä½ ç¡®å®è¦ä½¿ç”¨è¯¥åŠŸèƒ½æ—¶ï¼Œå®ƒçš„é€Ÿåº¦ä¸ä¼šæ¯”ä¸ä½¿ç”¨å®ƒçš„é€Ÿåº¦æ…¢ã€‚å¦‚æœä½ è§‰å¾—ï¼Œæˆ‘æƒ³ä½¿ç”¨è¿™ä¸ªéå¸¸å¥½ç”¨çš„åŠŸèƒ½æŠŠå¼€å‘å·¥ä½œå˜å¾—è½»æ¾ï¼Œä½†æ˜¯å®ƒä¼šä½¿æˆ‘çš„ç¨‹åºå˜æ…¢ï¼Œæ‰€ä»¥æˆ‘æ‰“ç®—è‡ªå·±é€ ä¸€ä¸ªï¼Œé‚£ä¹ˆè¿™å®é™…ä¸Šæ˜¯å¸¦æ¥äº†æ›´å¤§çš„ç—›è‹¦ã€‚&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;æ‰€ä»¥ï¼Œæˆ‘å°†å›é¡¾ä¸€ä¸‹æˆ‘ä»¬å¦‚ä½•å°è¯•è§£å†³å¼‚æ­¥ I/O å’Œ Rust çš„é—®é¢˜ï¼Œä»¥åŠåœ¨æˆ‘ä»¬å®ç°è¿™ä¸€ç›®æ ‡çš„è¿‡ç¨‹ä¸­ï¼ŒæŸäº›æœªèƒ½é€šè¿‡è¿™ä¸¤é¡¹é›¶æˆæœ¬æµ‹è¯•çš„ç‰¹æ€§ã€‚&lt;/p&gt;&lt;h2&gt;ç»¿è‰²çº¿ç¨‹çš„å°è¯•&lt;/h2&gt;&lt;p&gt;æˆ‘ä»¬è¦è§£å†³çš„é—®é¢˜æ˜¯ &lt;b&gt;å¼‚æ­¥ I/O&lt;/b&gt; ã€‚é€šå¸¸ I/O å¤„äºé˜»å¡çŠ¶æ€ï¼Œå› æ­¤å½“ä½ ä½¿ç”¨ I/O æ—¶ï¼Œå®ƒä¼šé˜»å¡çº¿ç¨‹ï¼Œä¸­æ­¢ä½ çš„ç¨‹åºï¼Œç„¶åå¿…é¡»é€šè¿‡æ“ä½œç³»ç»Ÿé‡æ–°è°ƒåº¦ã€‚é˜»å¡å¼ I/O çš„é—®é¢˜æ˜¯å½“ä½ å°è¯•é€šè¿‡åŒä¸€ç¨‹åºæä¾›å¤§é‡è¿æ¥æ—¶ï¼Œå®ƒæ— æ³•çœŸæ­£å®ç°æ‰©å±•ã€‚å› æ­¤å¯¹äºçœŸæ­£çš„å¤§è§„æ¨¡ç½‘ç»œæœåŠ¡ï¼Œä½ éœ€è¦æŸç§å½¢å¼çš„éé˜»å¡çš„æˆ–è€…è¯´å¼‚æ­¥çš„ I/O ã€‚å°¤å…¶æ˜¯ Rust æ˜¯é’ˆå¯¹å…·æœ‰çœŸæ­£çš„é«˜æ€§èƒ½è¦æ±‚è€Œè®¾è®¡çš„è¯­è¨€ï¼Œå®ƒæ˜¯ä¸€ç§ç³»ç»Ÿç¼–ç¨‹è¯­è¨€ï¼Œé¢å‘é‚£äº›çœŸæ­£åœ¨ä¹è®¡ç®—èµ„æºçš„äººã€‚è¦åœ¨ç½‘ç»œçš„ä¸–ç•Œä¸­çœŸæ­£å–å¾—æˆåŠŸï¼Œæˆ‘ä»¬å°±éœ€è¦æŸç§è§£å†³æ–¹æ¡ˆæ¥è§£å†³è¿™ä¸ªå¼‚æ­¥ I/O é—®é¢˜ã€‚&lt;/p&gt;&lt;p&gt;ä½†æ˜¯ &lt;b&gt;å¼‚æ­¥ I/O çš„æœ€å¤§é—®é¢˜æ˜¯å®ƒçš„å·¥ä½œæ–¹å¼&lt;/b&gt; ï¼šåœ¨ä½ è°ƒç”¨ I/O æ—¶ï¼Œç³»ç»Ÿè°ƒç”¨ä¼šç«‹å³è¿”å›ï¼Œç„¶åä½ å¯ä»¥ç»§ç»­è¿›è¡Œå…¶ä»–å·¥ä½œï¼Œä½†ä½ çš„ç¨‹åºéœ€è¦å†³å®šå¦‚ä½•å›åˆ°è°ƒç”¨è¯¥å¼‚æ­¥ I/O æš‚åœçš„é‚£ä¸ªä»»åŠ¡çº¿ä¸Šï¼Œè¿™å°±ä½¿å¾—åœ¨ç¼–ç ä¸Šï¼Œå¼‚æ­¥ I/O çš„ä»£ç è¦æ¯”é˜»å¡ I/O çš„ä»£ç å¤æ‚å¾—å¤šã€‚æ‰€ä»¥ï¼Œå¾ˆå¤šï¼Œå°¤å…¶æ˜¯ä»¥å¯æ‰©å±•çš„ç½‘ç»œæœåŠ¡è¿™ç±»ç‰¹æ€§ä¸ºç›®æ ‡çš„è¯­è¨€ï¼Œä¸€ç›´åœ¨è¯•å›¾è§£å†³è¿™ä¸ªé—®é¢˜ã€‚æ¯”å¦‚ï¼Œè®©å®ƒä¸å†æ˜¯æœ€ç»ˆç”¨æˆ·éœ€è¦è§£å†³çš„é—®é¢˜ï¼Œè€Œæ˜¯ç¼–ç¨‹è¯­è¨€çš„ä¸€éƒ¨åˆ†æˆ–è€…æŸä¸ªåº“çš„ä¸€éƒ¨åˆ†ç­‰ç­‰ã€‚&lt;/p&gt;&lt;p&gt;Rust æœ€åˆä½¿ç”¨çš„ç¬¬ä¸€ä¸ªè§£å†³æ–¹æ¡ˆæ˜¯ &lt;b&gt;ç»¿è‰²çº¿ç¨‹&lt;/b&gt;ï¼Œå®ƒå·²ç»åœ¨è®¸å¤šè¯­è¨€ä¸­è·å¾—æˆåŠŸã€‚ç»¿è‰²çº¿ç¨‹åŸºæœ¬ä¸Šå°±åƒé˜»å¡å¼ I/O ä¸€æ ·ï¼Œä½¿ç”¨çš„æ—¶å€™å°±åƒæ˜¯æ™®é€šçš„çº¿ç¨‹ï¼Œå®ƒä»¬ä¼šåœ¨æ‰§è¡Œ I/O æ—¶é˜»å¡ï¼Œä¸€åˆ‡çœ‹èµ·æ¥å°±è·Ÿä½ åœ¨ä½¿ç”¨æ“ä½œç³»ç»Ÿçš„åŸç”Ÿæ–¹å¼ä¸€æ ·ã€‚ä½†æ˜¯ï¼Œå®ƒä»¬è¢«è®¾è®¡ä¸ºè¯­è¨€è¿è¡Œæ—¶çš„ä¸€éƒ¨åˆ†ï¼Œæ¥å¯¹é‚£äº›éœ€è¦åŒæ—¶è¿è¡Œæˆåƒä¸Šä¸‡ç”šè‡³æ•°ç™¾ä¸‡ä¸ªç»¿è‰²çº¿ç¨‹çš„ç½‘ç»œæœåŠ¡ç”¨ä¾‹è¿›è¡Œä¼˜åŒ–ã€‚ä¸€ä¸ªä½¿ç”¨è¯¥æ¨¡å‹çš„å…¸å‹çš„æˆåŠŸæ¡ˆä¾‹å°±æ˜¯ Go è¯­è¨€ï¼Œå®ƒçš„ç»¿è‰²çº¿ç¨‹è¢«ç§°ä¸º goroutineã€‚å¯¹äº Go ç¨‹åºæ¥è¯´ï¼ŒåŒæ—¶è¿è¡Œæˆåƒä¸Šä¸‡ä¸ª goroutine æ˜¯å¾ˆæ­£å¸¸çš„ï¼Œå› ä¸ºä¸æ“ä½œç³»ç»Ÿçº¿ç¨‹ä¸åŒï¼Œåˆ›å»ºå®ƒä»¬çš„æˆæœ¬å¾ˆä½ã€‚&lt;/p&gt;&lt;p&gt;å³ &lt;b&gt;ç»¿è‰²çº¿ç¨‹çš„ä¼˜ç‚¹&lt;/b&gt; åœ¨äºï¼šäº§ç”Ÿæ“ä½œç³»ç»Ÿçº¿ç¨‹æ—¶çš„å†…å­˜å¼€é”€è¦é«˜å¾—å¤šï¼Œå› ä¸ºæ¯ä¸ªæ“ä½œç³»ç»Ÿçº¿ç¨‹ä¼šåˆ›å»ºä¸€ä¸ªå¾ˆå¤§çš„å †æ ˆï¼Œè€Œç»¿è‰²çº¿ç¨‹é€šå¸¸çš„å·¥ä½œæ–¹å¼æ˜¯ï¼Œä½ å°†äº§ç”Ÿä¸€ä¸ªä»¥å¾ˆå°çš„å †æ ˆï¼Œå®ƒåªä¼šéšç€æ—¶é—´çš„æ¨ç§»è€Œå¢é•¿ï¼Œè€Œäº§ç”Ÿä¸€å †ä¸ä½¿ç”¨å¤§é‡å†…å­˜çš„æ–°çº¿ç¨‹å¹¶ä¸ä¾¿å®œï¼›å¹¶ä¸”ä½¿ç”¨ç±»ä¼¼æ“ä½œç³»ç»ŸåŸè¯­çš„é—®é¢˜è¿˜åœ¨äºä½ ä¾èµ–äºæ“ä½œç³»ç»Ÿè°ƒåº¦ï¼Œè¿™æ„å‘³ç€ä½ å¿…é¡»ä»ç¨‹åºçš„å†…å­˜ç©ºé—´åˆ‡æ¢åˆ°å†…æ ¸ç©ºé—´ï¼Œå¦‚æœæˆåƒä¸Šä¸‡çš„çº¿ç¨‹éƒ½åœ¨å¿«é€Ÿåˆ‡æ¢ï¼Œä¸Šä¸‹æ–‡åˆ‡æ¢å°±ä¼šå¢åŠ å¾ˆå¤šå¼€é”€ã€‚è€Œå°†è°ƒåº¦ä¿æŒåœ¨åŒä¸€ç¨‹åºä¸­ï¼Œä½ å°†é¿å…ä½¿ç”¨è¿™äº›ä¸Šä¸‹æ–‡ï¼Œè¿›è€Œå‡å°‘å¼€é”€ã€‚æ‰€ä»¥æˆ‘ç›¸ä¿¡ç»¿è‰²çº¿ç¨‹æ˜¯ä¸€ä¸ªéå¸¸å¥½çš„æ¨¡å‹ï¼Œé€‚ç”¨äºè®¸å¤šè¯­è¨€ï¼ŒåŒ…æ‹¬ Go å’Œ Javaã€‚&lt;/p&gt;&lt;p&gt;åœ¨å¾ˆé•¿ä¸€æ®µæ—¶é—´å†…ï¼Œ Rust éƒ½æœ‰ç»¿è‰²çº¿ç¨‹ï¼Œä½†æ˜¯åœ¨ 1.0 ç‰ˆæœ¬ä¹‹å‰åˆ æ‰äº†ã€‚æˆ‘ä»¬åˆ æ‰å®ƒæ˜¯å› ä¸ºå®ƒä¸æ˜¯é›¶æˆæœ¬æŠ½è±¡çš„ï¼Œå‡†ç¡®çš„è¯´å°±æ˜¯æˆ‘åœ¨ç¬¬ä¸€ä¸ªé—®é¢˜ä¸­è°ˆåˆ°çš„ï¼Œå®ƒç»™é‚£äº›ä¸éœ€è¦å®ƒçš„äººå¢åŠ äº†æˆæœ¬ã€‚æ¯”å¦‚ä½ åªæƒ³ç¼–å†™ä¸€ä¸ªä¸æ˜¯ç½‘ç»œæœåŠ¡çš„å±å¹•æ‰“å°çš„ Rust ç¨‹åºï¼Œä½ å¿…é¡»å¼•å…¥è´Ÿè´£è°ƒåº¦æ‰€æœ‰ç»¿è‰²çº¿ç¨‹çš„è¯­è¨€è¿è¡Œæ—¶ã€‚è¿™ç§æ–¹æ³•ï¼Œå°¤å…¶æ˜¯å¯¹äºè¯•å›¾æŠŠ Rust é›†æˆåˆ°ä¸€ä¸ªå¤§çš„ C åº”ç”¨ç¨‹åºä¸­çš„äººæ¥è¯´ï¼Œå°±æˆä¸ºä¸€ä¸ªé—®é¢˜ã€‚å¾ˆå¤š Rust çš„é‡‡ç”¨è€…æ‹¥æœ‰ä¸€äº›å¤§å‹Cç¨‹åºï¼Œä»–ä»¬æƒ³å¼€å§‹ä½¿ç”¨ Rust å¹¶å°† Rust é›†æˆåˆ°ä»–ä»¬çš„ç¨‹åºä¸­ï¼Œåªæ˜¯ä¸€å°æ®µ Rust ä»£ç ã€‚é—®é¢˜æ˜¯ï¼Œå¦‚æœä½ å¿…é¡»è®¾ç½®è¿è¡Œæ—¶æ‰èƒ½è°ƒç”¨ Rust ï¼Œé‚£ä¹ˆè¿™ä¸€å°éƒ¨åˆ†çš„ Rust ç¨‹åºçš„æˆæœ¬å°±å¤ªé«˜äº†ã€‚å› æ­¤ä» 1.0 å¼€å§‹ï¼Œæˆ‘ä»¬å°±ä»è¯­è¨€ä¸­åˆ é™¤äº†ç»¿è‰²çº¿ç¨‹ï¼Œå¹¶åˆ é™¤äº†è¯­è¨€çš„è¿è¡Œæ—¶ã€‚ç°åœ¨æˆ‘ä»¬éƒ½çŸ¥é“å®ƒçš„è¿è¡Œæ—¶ä¸ C åŸºæœ¬ä¸Šç›¸åŒï¼Œè¿™å°±ä½¿å¾—åœ¨ Rust å’Œ C ä¹‹é—´è°ƒç”¨éå¸¸å®¹æ˜“ï¼Œè€Œä¸”æˆæœ¬å¾ˆä½ï¼Œè¿™æ˜¯ä½¿ Rust çœŸæ­£æˆåŠŸçš„å…³é”®å› ç´ ä¹‹ä¸€ã€‚åˆ é™¤äº†ç»¿è‰²çº¿ç¨‹ï¼Œæˆ‘ä»¬è¿˜æ˜¯éœ€è¦æŸç§å¼‚æ­¥ I/O è§£å†³æ–¹æ¡ˆï¼›ä½†æ˜¯æˆ‘ä»¬æ„è¯†åˆ° &lt;b&gt;è¿™åº”è¯¥æ˜¯ä¸€ä¸ªåŸºäºåº“çš„è§£å†³æ–¹æ¡ˆï¼Œæˆ‘ä»¬éœ€è¦ä¸ºå¼‚æ­¥ I/O æä¾›è‰¯å¥½çš„æŠ½è±¡ï¼Œå®ƒä¸æ˜¯è¯­è¨€çš„ä¸€éƒ¨åˆ†ï¼Œä¹Ÿä¸æ˜¯æ¯ä¸ªç¨‹åºé™„å¸¦çš„è¿è¡Œæ—¶çš„ä¸€éƒ¨åˆ†ï¼Œåªæ˜¯å¯é€‰çš„å¹¶æŒ‰éœ€ä½¿ç”¨çš„åº“ã€‚&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;Future çš„è§£å†³æ–¹æ¡ˆ&lt;/h2&gt;&lt;p&gt;æœ€æˆåŠŸçš„åº“è§£å†³æ–¹æ¡ˆæ˜¯ä¸€ä¸ªå«åš &lt;code&gt;Future&lt;/code&gt; çš„æ¦‚å¿µï¼Œåœ¨ JavaScript ä¸­ä¹Ÿå«åš &lt;code&gt;Promise&lt;/code&gt;ã€‚&lt;code&gt;Future&lt;/code&gt; è¡¨ç¤ºä¸€ä¸ªå°šæœªå¾—å‡ºçš„å€¼ï¼Œä½ å¯ä»¥åœ¨å®ƒè¢«è§£å†³ï¼ˆresolvedï¼‰ä»¥å¾—å‡ºé‚£ä¸ªå€¼ä¹‹å‰å¯¹å®ƒè¿›è¡Œå„ç§æ“ä½œã€‚åœ¨è®¸å¤šè¯­è¨€ä¸­ï¼Œå¯¹ &lt;code&gt;Future&lt;/code&gt; æ‰€åšçš„å·¥ä½œå¹¶ä¸å¤šï¼Œè¿™ç§å®ç°æ”¯æŒå¾ˆå¤šç‰¹æ€§æ¯”å¦‚ç»„åˆå™¨ï¼ˆCombinatorï¼‰ï¼Œå°¤å…¶æ˜¯èƒ½è®©æˆ‘ä»¬åœ¨æ­¤åŸºç¡€ä¸Šå®ç°æ›´ç¬¦åˆäººä½“å·¥ç¨‹å­¦çš„ &lt;code&gt;async&lt;/code&gt;/&lt;code&gt;await&lt;/code&gt; è¯­æ³•ã€‚&lt;/p&gt;&lt;p&gt;&lt;code&gt;Future&lt;/code&gt; å¯ä»¥è¡¨ç¤ºå„ç§å„æ ·çš„ä¸œè¥¿ï¼Œå°¤å…¶é€‚ç”¨äºè¡¨ç¤ºå¼‚æ­¥ I/O ï¼šå½“ä½ å‘èµ·ä¸€æ¬¡ç½‘ç»œè¯·æ±‚æ—¶ï¼Œä½ å°†ç«‹å³è·å¾—ä¸€ä¸ª &lt;code&gt;Future&lt;/code&gt; å¯¹è±¡ï¼Œè€Œä¸€æ—¦ç½‘ç»œè¯·æ±‚å®Œæˆï¼Œå®ƒå°†è¿”å›ä»»ä½•å“åº”å¯èƒ½åŒ…å«çš„å€¼ï¼›ä½ ä¹Ÿå¯ä»¥è¡¨ç¤ºè¯¸å¦‚â€œè¶…æ—¶â€ä¹‹ç±»çš„ä¸œè¥¿ï¼Œâ€œè¶…æ—¶â€å…¶å®å°±æ˜¯ä¸€ä¸ªåœ¨è¿‡äº†ç‰¹å®šæ—¶é—´åè¢«è§£å†³çš„ &lt;code&gt;Future&lt;/code&gt; ï¼›ç”šè‡³ä¸å±äº I/O çš„å·¥ä½œæˆ–è€…éœ€è¦æ”¾åˆ°æŸä¸ªçº¿ç¨‹æ± ä¸­è¿è¡Œçš„CPUå¯†é›†å‹çš„å·¥ä½œï¼Œä¹Ÿå¯ä»¥é€šè¿‡ä¸€ä¸ª &lt;code&gt;Future&lt;/code&gt; æ¥è¡¨ç¤ºï¼Œè¿™ä¸ª &lt;code&gt;Future&lt;/code&gt; å°†ä¼šåœ¨çº¿ç¨‹æ± å®Œæˆå·¥ä½œåè¢«è§£å†³ã€‚&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-rust&quot;&gt;&lt;span class=&quot;k&quot;&gt;trait&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Future&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;schedule&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;callback&lt;/span&gt;: &lt;span class=&quot;nc&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;where&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;F&lt;/span&gt;: &lt;span class=&quot;nb&quot;&gt;FnOnce&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Self&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;Output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;&lt;code&gt;Future&lt;/code&gt; å­˜åœ¨çš„é—®é¢˜&lt;/b&gt; æ˜¯å®ƒåœ¨å¤§å¤šæ•°è¯­è¨€ä¸­çš„è¡¨ç¤ºæ–¹å¼æ˜¯è¿™ç§åŸºäºå›è°ƒçš„æ–¹æ³•ï¼Œä½¿ç”¨è¿™ç§æ–¹å¼æ—¶ï¼Œä½ å¯ä»¥æŒ‡å®šåœ¨ &lt;code&gt;Future&lt;/code&gt; è¢«è§£å†³ä¹‹åè¿è¡Œä»€ä¹ˆå›è°ƒå‡½æ•°ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ &lt;code&gt;Future&lt;/code&gt; è´Ÿè´£å¼„æ¸…æ¥šä»€ä¹ˆæ—¶å€™è¢«è§£å†³ï¼Œæ— è®ºä½ çš„å›è°ƒæ˜¯ä»€ä¹ˆï¼Œå®ƒéƒ½ä¼šè¿è¡Œï¼›è€Œæ‰€æœ‰çš„ä¸ä¾¿ä¹Ÿéƒ½å»ºç«‹åœ¨æ­¤æ¨¡å‹ä¸Šï¼Œå®ƒéå¸¸éš¾ç”¨ï¼Œå› ä¸ºå·²ç»æœ‰å¾ˆå¤šå¼€å‘è€…è¿›è¡Œäº†å¤§é‡çš„å°è¯•ï¼Œå‘ç°ä»–ä»¬ä¸å¾—ä¸å†™å¾ˆå¤šåˆ†é…æ€§çš„ä»£ç ä»¥åŠä½¿ç”¨åŠ¨æ€æ´¾å‘ï¼›å®é™…ä¸Šï¼Œä½ å°è¯•è°ƒåº¦çš„æ¯ä¸ªå›è°ƒéƒ½å¿…é¡»è·å¾—è‡ªå·±ç‹¬ç«‹çš„å­˜å‚¨ç©ºé—´ï¼Œä¾‹å¦‚ crate å¯¹è±¡ã€å †å†…å­˜åˆ†é…ï¼Œè¿™äº›åˆ†é…ä»¥åŠåŠ¨æ€æ´¾å‘æ— å¤„ä¸åœ¨ã€‚è¿™ç§æ–¹æ³•æ²¡æœ‰æ»¡è¶³é›¶æˆæœ¬æŠ½è±¡çš„ç¬¬äºŒä¸ªåŸåˆ™ï¼Œå¦‚æœä½ è¦ä½¿ç”¨å®ƒï¼Œå®ƒå°†æ¯”ä½ è‡ªå·±å†™è¦æ…¢å¾ˆå¤šï¼Œé‚£ä½ ä¸ºä»€ä¹ˆè¿˜è¦ç”¨å®ƒã€‚&lt;/p&gt;&lt;h2&gt;åŸºäºè½®è¯¢çš„ Future &lt;/h2&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-rust&quot;&gt;&lt;span class=&quot;k&quot;&gt;trait&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Future&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;poll&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;waker&lt;/span&gt;: &lt;span class=&quot;kp&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Waker&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;-&amp;gt; &lt;span class=&quot;nc&quot;&gt;Poll&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Self&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;Output&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;enum&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Poll&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Ready&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Pending&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™ä¸ªéå¸¸å‡ºè‰²çš„åŸºäºè½®è¯¢çš„æ–°æ–¹æ¡ˆâ€”â€”æˆ‘ä»¬ç¼–å†™äº†è¿™ä¸ªæ¨¡å‹ï¼Œæˆ‘å½’åŠŸäº Alex å’Œ Aaron Turonï¼Œæ˜¯ä»–ä»¬æå‡ºäº†è¿™ä¸ªæƒ³æ³•â€”â€”ä¸æ˜¯ç”± &lt;code&gt;Future&lt;/code&gt; æ¥è°ƒåº¦å›è°ƒå‡½æ•°ï¼Œè€Œæ˜¯ç”±æˆ‘ä»¬å»è½®è¯¢ &lt;code&gt;Future&lt;/code&gt;ï¼Œæ‰€ä»¥è¿˜æœ‰å¦ä¸€ä¸ªè¢«ç§°ä¸ºæ‰§è¡Œå™¨ï¼ˆexecutorï¼‰çš„ç»„ä»¶ï¼Œå®ƒè´Ÿè´£å®é™…è¿è¡Œ &lt;code&gt;Future&lt;/code&gt; ï¼›æ‰§è¡Œå™¨çš„å·¥ä½œå°±æ˜¯è½®è¯¢ &lt;code&gt;Future&lt;/code&gt; ï¼Œè€Œ &lt;code&gt;Future&lt;/code&gt; å¯èƒ½è¿”å›â€œå°šæœªå‡†å¤‡å°±ç»ªï¼ˆPendingï¼‰â€ï¼Œä¹Ÿå¯èƒ½è¢«è§£å†³å°±è¿”å›â€œå·²å°±ç»ªï¼ˆReadyï¼‰â€ã€‚&lt;/p&gt;&lt;p&gt;è¯¥æ¨¡å‹æœ‰å¾ˆå¤šä¼˜ç‚¹ã€‚å…¶ä¸­ä¸€ä¸ªä¼˜ç‚¹æ˜¯ï¼Œä½ å¯ä»¥éå¸¸å®¹æ˜“åœ°å–æ¶ˆ &lt;code&gt;Future&lt;/code&gt; ï¼Œå› ä¸ºå–æ¶ˆ &lt;code&gt;Future&lt;/code&gt; åªéœ€è¦åœæ­¢æŒæœ‰ &lt;code&gt;Future&lt;/code&gt;ã€‚è€Œå¦‚æœé‡‡ç”¨åŸºäºå›è°ƒçš„æ–¹æ³•ï¼Œè¦é€šè¿‡è°ƒåº¦æ¥å–æ¶ˆå¹¶ä½¿å…¶åœæ­¢å°±æ²¡è¿™ä¹ˆå®¹æ˜“äº†ã€‚&lt;/p&gt;&lt;p&gt;åŒæ—¶å®ƒè¿˜èƒ½å¤Ÿä½¿æˆ‘ä»¬åœ¨ç¨‹åºçš„ä¸åŒéƒ¨åˆ†ä¹‹é—´å»ºç«‹çœŸæ­£æ¸…æ™°çš„æŠ½è±¡è¾¹ç•Œï¼Œå¤§å¤šæ•° &lt;code&gt;Future&lt;/code&gt; åº“éƒ½å¸¦æœ‰äº‹ä»¶å¾ªç¯ï¼ˆevent loopï¼‰ï¼Œè¿™ä¹Ÿæ˜¯è°ƒåº¦ä½ çš„ &lt;code&gt;Future&lt;/code&gt; æ‰§è¡Œ I/O çš„æ–¹æ³•ï¼Œä½†ä½ å®é™…ä¸Šå¯¹æ­¤æ²¡æœ‰ä»»ä½•æ§åˆ¶æƒã€‚è€Œåœ¨ Rust ä¸­ï¼Œå„ç»„ä»¶ä¹‹é—´çš„è¾¹ç•Œéå¸¸æ•´æ´ï¼Œæ‰§è¡Œå™¨ï¼ˆexecutorï¼‰è´Ÿè´£è°ƒåº¦ä½ çš„ &lt;code&gt;Future&lt;/code&gt; ï¼Œååº”å™¨ï¼ˆreactorï¼‰å¤„ç†æ‰€æœ‰çš„ I/O ï¼Œç„¶åæ˜¯ä½ çš„å®é™…ä»£ç ã€‚å› æ­¤æœ€ç»ˆç”¨æˆ·å¯ä»¥è‡ªè¡Œå†³å®šä½¿ç”¨ä»€ä¹ˆæ‰§è¡Œå™¨ï¼Œä½¿ç”¨ä»–ä»¬æƒ³ä½¿ç”¨çš„ååº”å™¨ï¼Œä»è€Œè·å¾—æ›´å¼ºçš„æ§åˆ¶åŠ›ï¼Œè¿™åœ¨ç³»ç»Ÿç¼–ç¨‹è¯­è¨€ä¸­çœŸçš„å¾ˆé‡è¦ã€‚è€Œæ­¤æ¨¡å‹æœ€é‡è¦çš„çœŸæ­£ä¼˜åŠ¿åœ¨äºï¼Œå®ƒä½¿æˆ‘ä»¬èƒ½å¤Ÿä»¥ä¸€ç§çœŸæ­£é›¶æˆæœ¬çš„å®Œç¾æ–¹å¼å®ç°è¿™ç§çŠ¶æ€æœºå¼çš„ &lt;code&gt;Future&lt;/code&gt; ã€‚ä¹Ÿå°±æ˜¯å½“ä½ ç¼–å†™çš„ &lt;code&gt;Future&lt;/code&gt; ä»£ç è¢«ç¼–è¯‘æˆå®é™…çš„æœ¬åœ°ï¼ˆnativeï¼‰ä»£ç æ—¶ï¼Œå®ƒå°±åƒä¸€ä¸ªçŠ¶æ€æœºï¼›åœ¨è¯¥çŠ¶æ€æœºä¸­ï¼Œæ¯æ¬¡ I/O çš„æš‚åœç‚¹éƒ½æœ‰ä¸€ä¸ªå˜ä½“ï¼ˆvariantï¼‰ï¼Œè€Œæ¯ä¸ªå˜ä½“éƒ½ä¿å­˜äº†æ¢å¤æ‰§è¡Œæ‰€éœ€çš„çŠ¶æ€ã€‚è¿™è¡¨ç¤ºä¸ºä¸€ä¸ªæšä¸¾ï¼ˆenumï¼‰ç»“æ„ï¼Œå³ä¸€ä¸ªåŒ…å«å˜ä½“åˆ¤åˆ«å¼åŠæ‰€æœ‰å¯èƒ½çŠ¶æ€çš„è”åˆä½“ï¼ˆunionï¼‰ã€‚&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-2db492125cda72829cbefdde5c25e216_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;890&quot; data-rawheight=&quot;658&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;890&quot; data-original=&quot;https://pic3.zhimg.com/v2-2db492125cda72829cbefdde5c25e216_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-2db492125cda72829cbefdde5c25e216_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;890&quot; data-rawheight=&quot;658&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;890&quot; data-original=&quot;https://pic3.zhimg.com/v2-2db492125cda72829cbefdde5c25e216_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-2db492125cda72829cbefdde5c25e216_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;ä¸Šé¢çš„å¹»ç¯ç‰‡å°½å¯èƒ½ç›´è§‚åœ°è¡¨ç¤ºäº†è¿™ä¸ªçŠ¶æ€æœºæ¨¡å‹ã€‚å¯ä»¥çœ‹åˆ°ï¼Œä½ æ‰§è¡Œäº†ä¸¤ä¸ª I/O äº‹ä»¶ï¼Œæ‰€ä»¥å®ƒæœ‰è¿™å‡ ä¸ªçŠ¶æ€ã€‚å¯¹äºæ¯ä¸ªçŠ¶æ€å®ƒéƒ½æä¾›äº†æ‰€éœ€çš„å†…å­˜ç©ºé—´ï¼Œè¶³å¤Ÿä½ åœ¨ I/O äº‹ä»¶åæ¢å¤æ‰§è¡Œã€‚&lt;/p&gt;&lt;p&gt;æ•´ä¸ª &lt;code&gt;Future&lt;/code&gt; åªéœ€è¦ä¸€æ¬¡å †å†…å­˜åˆ†é…ï¼Œå…¶å¤§å°å°±æ˜¯ä½ å°†è¿™ä¸ªçŠ¶æ€æœºåˆ†é…åˆ°å †ä¸­çš„å¤§å°ï¼Œå¹¶ä¸”æ²¡æœ‰é¢å¤–çš„å¼€é”€ã€‚ä½ ä¸éœ€è¦è£…ç®±ã€å›è°ƒä¹‹ç±»çš„ä¸œè¥¿ï¼Œåªæœ‰çœŸæ­£é›¶æˆæœ¬çš„å®Œç¾æ¨¡å‹ã€‚è¿™äº›æ¦‚å¿µå¯¹äºå¾ˆå¤šäººæ¥è¯´æ¯”è¾ƒéš¾äºç†è§£ï¼Œæ‰€ä»¥è¿™æ˜¯æˆ‘åŠ›æ±‚åšåˆ°æœ€å¥½çš„å¹»ç¯ç‰‡ï¼Œç›´è§‚åœ°å‘ˆç°è¿™ä¸ªè¿‡ç¨‹ä¸­å‘ç”Ÿäº†ä»€ä¹ˆï¼šä½ åˆ›å»ºä¸€ä¸ª &lt;code&gt;Future&lt;/code&gt;ï¼Œå®ƒè¢«åˆ†é…åˆ°æŸä¸ªå†…å­˜ä¸­ç‰¹å®šçš„ä½ç½®ï¼Œç„¶åä½ å¯ä»¥åœ¨æ‰§è¡Œå™¨ï¼ˆexecutorï¼‰ä¸­å¯åŠ¨å®ƒã€‚&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-b4ec7067068f316149df482749baed99_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1024&quot; data-rawheight=&quot;783&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1024&quot; data-original=&quot;https://pic2.zhimg.com/v2-b4ec7067068f316149df482749baed99_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-b4ec7067068f316149df482749baed99_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1024&quot; data-rawheight=&quot;783&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1024&quot; data-original=&quot;https://pic2.zhimg.com/v2-b4ec7067068f316149df482749baed99_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-b4ec7067068f316149df482749baed99_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;æ‰§è¡Œå™¨ä¼šè½®è¯¢ &lt;code&gt;Future&lt;/code&gt;ï¼Œç›´åˆ°æœ€ç»ˆ &lt;code&gt;Future&lt;/code&gt; éœ€è¦æ‰§è¡ŒæŸç§ I/O ã€‚&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-9e6dd5a637c296fd2b78eb4e67bb0866_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1024&quot; data-rawheight=&quot;783&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1024&quot; data-original=&quot;https://pic3.zhimg.com/v2-9e6dd5a637c296fd2b78eb4e67bb0866_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-9e6dd5a637c296fd2b78eb4e67bb0866_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1024&quot; data-rawheight=&quot;783&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1024&quot; data-original=&quot;https://pic3.zhimg.com/v2-9e6dd5a637c296fd2b78eb4e67bb0866_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-9e6dd5a637c296fd2b78eb4e67bb0866_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¯¥ &lt;code&gt;Future&lt;/code&gt; å°†è¢«ç§»äº¤ç»™å¤„ç† I/O çš„ååº”å™¨ï¼Œå³ &lt;code&gt;Future&lt;/code&gt; ä¼šç­‰å¾…è¯¥ç‰¹å®š I/O ã€‚æœ€ç»ˆï¼Œåœ¨è¯¥ I/O äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œååº”å™¨å°†ä½¿ç”¨ä½ åœ¨è½®è¯¢å®ƒæ—¶ä¼ é€’çš„Waker å‚æ•°å”¤é†’ &lt;code&gt;Future&lt;/code&gt; ï¼Œå°†å…¶ä¼ å›æ‰§è¡Œå™¨ï¼›&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-4a60db9a1fc1ffdff80b915803c4bb9a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1024&quot; data-rawheight=&quot;783&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1024&quot; data-original=&quot;https://pic3.zhimg.com/v2-4a60db9a1fc1ffdff80b915803c4bb9a_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-4a60db9a1fc1ffdff80b915803c4bb9a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1024&quot; data-rawheight=&quot;783&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1024&quot; data-original=&quot;https://pic3.zhimg.com/v2-4a60db9a1fc1ffdff80b915803c4bb9a_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-4a60db9a1fc1ffdff80b915803c4bb9a_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;ç„¶åå½“éœ€è¦å†æ¬¡æ‰§è¡ŒI/Oæ—¶ï¼Œæ‰§è¡Œå™¨å†å°†å…¶æ”¾å›ååº”å™¨ï¼›å®ƒå°†åƒè¿™æ ·æ¥å›ç©¿æ¢­ï¼Œç›´åˆ°æœ€ç»ˆè¢«è§£å†³ï¼ˆresolvedï¼‰ã€‚åœ¨è¢«è§£å†³å¹¶å¾—å‡ºæœ€ç»ˆç»“æœæ—¶ï¼Œæ‰§è¡Œå™¨çŸ¥é“å®ƒå·²ç»å®Œæˆï¼Œå°±ä¼šé‡Šæ”¾å¥æŸ„å’Œæ•´ä¸ª&lt;code&gt;Future&lt;/code&gt;ï¼Œæ•´ä¸ªè°ƒç”¨è¿‡ç¨‹å°±å®Œæˆäº†ã€‚&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-a2d1bdb39189796d63f286fe40965ab8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1024&quot; data-rawheight=&quot;784&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1024&quot; data-original=&quot;https://pic1.zhimg.com/v2-a2d1bdb39189796d63f286fe40965ab8_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-a2d1bdb39189796d63f286fe40965ab8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1024&quot; data-rawheight=&quot;784&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1024&quot; data-original=&quot;https://pic1.zhimg.com/v2-a2d1bdb39189796d63f286fe40965ab8_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-a2d1bdb39189796d63f286fe40965ab8_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;æ€»ç»“ä¸€ä¸‹ï¼šè¿™ç§æ¨¡å‹å½¢æˆäº†ä¸€ç§å¾ªç¯ï¼Œæˆ‘ä»¬è½®è¯¢ &lt;code&gt;Future&lt;/code&gt; ï¼Œç„¶åç­‰å¾… I/O å°†å…¶å”¤é†’ï¼Œç„¶åä¸€æ¬¡åˆä¸€æ¬¡åœ°è½®è¯¢å’Œå”¤é†’ï¼Œç›´åˆ°æœ€ç»ˆæ•´ä¸ªè¿‡ç¨‹å®Œæˆä¸ºæ­¢ã€‚&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-1b3a43e1d072bd76825a9946bd89f042_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;824&quot; data-rawheight=&quot;561&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;824&quot; data-original=&quot;https://pic3.zhimg.com/v2-1b3a43e1d072bd76825a9946bd89f042_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-1b3a43e1d072bd76825a9946bd89f042_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;824&quot; data-rawheight=&quot;561&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;824&quot; data-original=&quot;https://pic3.zhimg.com/v2-1b3a43e1d072bd76825a9946bd89f042_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-1b3a43e1d072bd76825a9946bd89f042_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;å¹¶ä¸”è¿™ç§æ¨¡å‹ç›¸å½“é«˜æ•ˆã€‚&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-72e011276307d3c04b9611565530db4a_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1024&quot; data-rawheight=&quot;559&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1024&quot; data-original=&quot;https://pic3.zhimg.com/v2-72e011276307d3c04b9611565530db4a_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-72e011276307d3c04b9611565530db4a_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1024&quot; data-rawheight=&quot;559&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1024&quot; data-original=&quot;https://pic3.zhimg.com/v2-72e011276307d3c04b9611565530db4a_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-72e011276307d3c04b9611565530db4a_b.jpg&quot;/&gt;&lt;figcaption&gt;æœ‰å…³ Future çš„ç¬¬ä¸€ç¯‡æ–‡ç« ä¸­å‘å¸ƒçš„åŸºå‡†æµ‹è¯•&lt;/figcaption&gt;&lt;/figure&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;è¿™æ˜¯åœ¨æœ‰å…³ &lt;code&gt;Future&lt;/code&gt; çš„ç¬¬ä¸€ç¯‡æ–‡ç« ä¸­å‘å¸ƒçš„åŸºå‡†æµ‹è¯•ï¼Œä¸å…¶ä»–è¯­è¨€çš„è®¸å¤šä¸åŒå®ç°è¿›è¡Œäº†å¯¹æ¯”ã€‚æŸ±å½¢è¶Šé«˜è¡¨ç¤ºæ€§èƒ½è¶Šå¥½ï¼Œæˆ‘ä»¬çš„ &lt;code&gt;Future&lt;/code&gt; æ¨¡å‹åœ¨æœ€å·¦ä¾§ï¼Œæ‰€ä»¥è¯´æˆ‘ä»¬æœ‰äº†éå¸¸å‡ºè‰²çš„é›¶æˆæœ¬æŠ½è±¡ï¼Œå³ä½¿æ˜¯ä¸è®¸å¤šå…¶ä»–è¯­è¨€ä¸­æœ€å¿«çš„å¼‚æ­¥ I/O å®ç°ç›¸æ¯”ä¹Ÿæ˜¯ç›¸å½“æœ‰ç«äº‰åŠ›çš„ã€‚&lt;/p&gt;&lt;p&gt;ä½†æ˜¯ï¼Œé—®é¢˜åœ¨äºï¼Œä½ å¹¶ä¸å¸Œæœ›æ‰‹åŠ¨ç¼–å†™è¿™äº›çŠ¶æ€æœºï¼ŒæŠŠæ•´ä¸ªåº”ç”¨ç¨‹åºæ‰€æœ‰çŠ¶æ€å†™æˆä¸€ä¸ªçŠ¶æ€æœºå¹¶ä¸æ˜¯ä»¶è½»æ¾æ„‰å¿«çš„äº‹ã€‚è€Œè¿™ç§ &lt;code&gt;Future&lt;/code&gt; æŠ½è±¡çš„çœŸæ­£æœ‰ç”¨ä¹‹å¤„åœ¨äºï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å…¶ä¹‹ä¸Šæ„å»ºå…¶ä»– API ã€‚&lt;/p&gt;&lt;h2&gt;å…¶å®ƒAPI&lt;/h2&gt;&lt;h3&gt;ç»„åˆå™¨ï¼ˆCombinatorï¼‰&lt;/h3&gt;&lt;p&gt;æˆ‘ä»¬èƒ½ä½¿ç”¨çš„ç¬¬ä¸€ä¸ªè§£å†³æ–¹æ¡ˆæ˜¯ &lt;code&gt;Future&lt;/code&gt; ç»„åˆå™¨ï¼ˆCombinatorï¼‰ã€‚ä½ å¯ä»¥é€šè¿‡å°†è¿™äº›ç»„åˆå™¨æ–¹æ³•åº”ç”¨äº &lt;code&gt;Future&lt;/code&gt; æ¥æ„å»ºçŠ¶æ€æœºï¼Œå®ƒä»¬çš„å·¥ä½œæ–¹å¼ç±»ä¼¼äºè¿­ä»£å™¨ï¼ˆ&lt;code&gt;Iterator&lt;/code&gt;ï¼‰çš„é€‚é…å™¨ï¼ˆå¦‚ &lt;code&gt;filter&lt;/code&gt;ã€&lt;code&gt;map&lt;/code&gt;ï¼‰ã€‚&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-rust&quot;&gt;&lt;span class=&quot;k&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;fetch_rust_lang&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;client&lt;/span&gt;: &lt;span class=&quot;nc&quot;&gt;Client&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;-&amp;gt; &lt;span class=&quot;nc&quot;&gt;impl&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Future&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Output&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;client&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;rust-lang.org&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;and_then&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;response&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;concat_body&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;String&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;from_utf8_lossy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™ä¸ªå‡½æ•°çš„ä½œç”¨æ˜¯è¯·æ±‚ â€œrust-lang.orgâ€ï¼Œç„¶åå°†å“åº”è½¬æ¢ä¸ºå­—ç¬¦ä¸²ã€‚å®ƒå¹¶ä¸è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²çš„ &lt;code&gt;Future&lt;/code&gt; ï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ªå¼‚æ­¥å‡½æ•°ã€‚å‡½æ•°ä½“ä¸­æœ‰è¿™æ ·ä¸€ä¸ª &lt;code&gt;Future&lt;/code&gt;ï¼Œå®ƒåŒ…å«ä¸€äº›ä¼šè¢«è°ƒç”¨çš„ I/O æ“ä½œï¼Œç”¨ &lt;code&gt;and_then&lt;/code&gt; å’Œ &lt;code&gt;map&lt;/code&gt; ä¹‹ç±»çš„ç»„åˆå™¨å°†è¿™äº›æ“ä½œå…¨éƒ¨ç»„åˆåœ¨ä¸€èµ·ã€‚æˆ‘ä»¬æ„å»ºäº†æ‰€æœ‰è¿™äº›ç”¨å¤„å„å¼‚çš„ç»„åˆå™¨ï¼Œä¾‹å¦‚ï¼Œ&lt;code&gt;and_then&lt;/code&gt;ï¼Œ&lt;code&gt;map&lt;/code&gt;ï¼Œ&lt;code&gt;filter&lt;/code&gt;ï¼Œ&lt;code&gt;map_error&lt;/code&gt;ç­‰ç­‰ã€‚æˆ‘ä»¬å·²ç»çŸ¥é“è¿™ç§æ–¹å¼æ˜¯æœ‰ä¸€äº›ç¼ºç‚¹çš„ï¼Œå°¤å…¶æ˜¯è¯¸å¦‚åµŒå¥—å›è°ƒä¹‹ç±»ï¼Œå¯è¯»æ€§éå¸¸å·®ã€‚&lt;/p&gt;&lt;h3&gt;&lt;code&gt;async&lt;/code&gt; / &lt;code&gt;await&lt;/code&gt; çš„å®ç°&lt;/h3&gt;&lt;p&gt;å› ä¸ºç»„åˆå™¨æœ‰è¿™æ ·çš„ç¼ºç‚¹ï¼Œæ‰€ä»¥æˆ‘ä»¬å¼€å§‹å°è¯•å®ç° &lt;code&gt;async&lt;/code&gt; / &lt;code&gt;await&lt;/code&gt;ã€‚&lt;code&gt;async&lt;/code&gt; / &lt;code&gt;await&lt;/code&gt; çš„ç¬¬ä¸€ä¸ªç‰ˆæœ¬å¹¶ä¸æ˜¯ Rust è¯­è¨€çš„ä¸€éƒ¨åˆ†ï¼Œè€Œæ˜¯ç”±è¯¥åº“åƒè¯­æ³•æ’ä»¶ä¸€æ ·æä¾›çš„ã€‚&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-rust&quot;&gt;&lt;span class=&quot;cp&quot;&gt;#[async]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;fetch_rust_lang&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;client&lt;/span&gt;: &lt;span class=&quot;nc&quot;&gt;Client&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&quot;nb&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;response&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;await&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;client&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;rust-lang.org&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;await&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;concat_body&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;());&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;String&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;from_utf9_lossy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™ä¸ªå‡½æ•°ä¸ä¹‹å‰é‚£ä¸ªç‰ˆæœ¬çš„ä¸€æ ·ï¼Œå®ƒåªæ˜¯è·å– Rust å®˜ç½‘å¹¶å°†å…¶è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼›ä½†æ˜¯å®ƒä½¿ç”¨ &lt;code&gt;async&lt;/code&gt; / &lt;code&gt;await&lt;/code&gt; æ¥å®ç°ï¼Œæ‰€ä»¥æ›´åƒæ˜¯é¡ºåºæ‰§è¡Œï¼Œçœ‹èµ·æ¥æ›´åƒæ™®é€šçš„é˜»å¡ I/O çš„å·¥ä½œæ–¹å¼ï¼›å°±åƒå¼€å¤´é‚£ä¸ªå®ä¾‹ä¸­å‘ˆç°çš„ä¸€æ ·ï¼Œå®ƒä»¬å”¯ä¸€åŒºåˆ«æ˜¯æ³¨è§£ï¼ˆæŒ‡ &lt;code&gt;async&lt;/code&gt; / &lt;code&gt;await&lt;/code&gt;ï¼‰ã€‚æˆ‘ä»¬å·²ç»çŸ¥é“ï¼Œ&lt;code&gt;async&lt;/code&gt; æ³¨è§£ä¼šå°†æ­¤å‡½æ•°è½¬æ¢ä¸ºä¸€ä¸ªè¿”å› &lt;code&gt;Future&lt;/code&gt; çš„å‡½æ•°ï¼Œè€Œä¸æ˜¯ç«‹å³è¿”å›ç»“æœï¼Œå¹¶ä¸”æˆ‘ä»¬éœ€è¦å¼‚æ­¥ç­‰å¾…ï¼ˆ&lt;code&gt;await&lt;/code&gt;ï¼‰è¿™äº›åœ¨å‡½æ•°å†…éƒ¨æ„é€ çš„ &lt;code&gt;Future&lt;/code&gt;ã€‚&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-rust&quot;&gt;&lt;span class=&quot;n&quot;&gt;await&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$future&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;loop&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$future&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;poll&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Poll&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;Pending&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;yield&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Poll&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;Pending&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Poll&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;Ready&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åœ¨æˆ‘ä»¬çš„è½®è¯¢æ¨¡å‹ä¸­ï¼Œ&lt;code&gt;await&lt;/code&gt; æ˜¯ä¸€ç§è¯­æ³•ç³–ï¼›å®ƒä¼šè¿›å…¥ä¸Šé¢è¿™ç§å¾ªç¯ï¼Œä½ è¦åšçš„å°±æ˜¯åœ¨å¾ªç¯ä¸­è½®è¯¢ï¼Œåœ¨ä¸€æ®µæ—¶é—´å†…ä½ å°†ä¸€ç›´å¾—åˆ°â€œå°šæœªå‡†å¤‡å°±ç»ªï¼ˆPendingï¼‰â€ï¼Œç„¶åä¸€ç›´ç­‰åˆ°å®ƒå†æ¬¡è¢«å”¤é†’ï¼Œç»ˆäºä½ ç­‰å¾…çš„ &lt;code&gt;Future&lt;/code&gt; å®Œæˆäº†ï¼Œç„¶åä½ ä½¿ç”¨è¯¥å€¼è·³å‡ºäº†å¾ªç¯ï¼Œè¿™å°±æ˜¯è¿™äº› &lt;code&gt;await&lt;/code&gt; è¡¨è¾¾å¼çš„è®¡ç®—ç»“æœã€‚&lt;/p&gt;&lt;p&gt;è¿™ä¼¼ä¹æ˜¯ä¸€ä¸ªéå¸¸ä¸é”™çš„è§£å†³æ–¹æ¡ˆï¼Œ&lt;code&gt;async&lt;/code&gt; / &lt;code&gt;await&lt;/code&gt; çš„å†™æ³•ä¼šè¢«ç¼–è¯‘æˆæˆ‘ä»¬è¶…æ£’çš„é›¶æˆæœ¬çš„ &lt;code&gt;Future&lt;/code&gt;ã€‚ä¸è¿‡ä»å·²å‘å¸ƒçš„ &lt;code&gt;Future&lt;/code&gt; çš„ä½¿ç”¨è€…çš„åé¦ˆçœ‹ï¼Œæˆ‘ä»¬è¿˜æ˜¯å‘ç°äº†ä¸€äº›é—®é¢˜ã€‚&lt;/p&gt;&lt;h3&gt;æ–°çš„é—®é¢˜&lt;/h3&gt;&lt;p&gt;åŸºæœ¬ä¸Šæ‰€æœ‰è¯•å›¾ä½¿ç”¨ &lt;code&gt;Future&lt;/code&gt; çš„äººéƒ½ä¼šé‡åˆ°éå¸¸ä»¤äººå›°æƒ‘çš„é”™è¯¯æ¶ˆæ¯ã€‚åœ¨è¿™äº›æ¶ˆæ¯ä¸­ï¼Œç¼–è¯‘å™¨ä¼šæç¤ºä½ çš„&lt;code&gt;Future&lt;/code&gt;çš„ç”Ÿå‘½å‘¨æœŸä¸æ˜¯é™æ€çš„ï¼ˆ&lt;code&gt;&amp;#39;static&lt;/code&gt;ï¼‰æˆ–æ²¡æœ‰å®ç°æŸä¸ª &lt;code&gt;trait&lt;/code&gt; ç­‰ç­‰ï¼›è¿™äº›æç¤ºä½ å¹¶ä¸çœŸæ­£ç†è§£ï¼Œä½†ç¼–è¯‘å™¨æƒ³æå‡ºæœ‰ç”¨çš„å»ºè®®ï¼Œä½ ä¹Ÿå°±è·Ÿç€è¿™ä¸ªå»ºè®®å»åšï¼Œç›´åˆ°ç¼–è¯‘æˆåŠŸï¼›ä½ å¯èƒ½ä¼šç»™é—­åŒ…åŠ ä¸Š &lt;code&gt;move&lt;/code&gt; å…³é”®å­—ï¼Œæˆ–è€…æŠŠæŸäº›å€¼æ”¾åˆ°å¼•ç”¨è®¡æ•°çš„æŒ‡é’ˆï¼ˆ&lt;code&gt;Rc&lt;/code&gt;ï¼‰ä¸­ï¼Œç„¶åå¤åˆ¶ï¼ˆ&lt;code&gt;clone&lt;/code&gt;ï¼‰å®ƒï¼›ä½ å°†æ‰€æœ‰è¿™äº›å¼€é”€æ·»åŠ åˆ°äº†ä¼¼ä¹å¹¶ä¸å¿…è¦çš„äº‹æƒ…ä¸Šï¼Œå´ä¸æ˜ç™½ä¸ºä»€ä¹ˆè¦è¿™æ ·åšï¼Œè€Œå½“ä½ å·²ç»ç–²äºå¤„ç†è¿™äº›æ—¶ï¼Œä»£ç å·²ç»ä¹±æˆä¸€é”…ç²¥äº†ï¼Œæ‰€ä»¥å¾ˆå¤šäººéƒ½è¢« &lt;code&gt;Future&lt;/code&gt; çš„é—®é¢˜å¡ä½äº†ã€‚&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-b1fa5d83cda8788404bb2dc3fd1c927a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;780&quot; data-rawheight=&quot;384&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;780&quot; data-original=&quot;https://pic3.zhimg.com/v2-b1fa5d83cda8788404bb2dc3fd1c927a_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-b1fa5d83cda8788404bb2dc3fd1c927a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;780&quot; data-rawheight=&quot;384&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;780&quot; data-original=&quot;https://pic3.zhimg.com/v2-b1fa5d83cda8788404bb2dc3fd1c927a_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-b1fa5d83cda8788404bb2dc3fd1c927a_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;è€Œä¸”å®ƒå¯¹äºç»„åˆå™¨äº§ç”Ÿè¿™ç§éå¸¸å¤§çš„ç±»å‹ä¹Ÿæ²¡ä»€ä¹ˆåŠæ³•ï¼Œä½ çš„æ•´ä¸ªç»ˆç«¯çª—å£ï¼ˆterminalï¼‰å°†è¢«å…¶ä¸­ä¸€ä¸ªç»„åˆå™¨é“¾çš„ç±»å‹å¡«æ»¡ã€‚ä½ ç”¨äº†&lt;code&gt;and_then&lt;/code&gt;ï¼Œä»¥åŠåˆä¸€ä¸ª &lt;code&gt;and_then&lt;/code&gt;ï¼Œç„¶åæ˜¯ &lt;code&gt;map_err&lt;/code&gt; ç´§è·Ÿä¸€ä¸ª TCP æµç­‰ç­‰ç­‰ç­‰ï¼Œä½ å¿…é¡»ä»”ç»†ç ”ç©¶ä¸€ä¸‹ï¼Œæ‰èƒ½å¼„æ¸…æ¥šæ‰€é‡åˆ°çš„å®é™…é”™è¯¯æ˜¯ä»€ä¹ˆã€‚&lt;/p&gt;&lt;blockquote&gt; â€œWhen using Futures, error messages are inscrutable.â€ â€œå½“ä½¿ç”¨ Future æ—¶ï¼Œé”™è¯¯ä¿¡æ¯éš¾ä»¥ç†è§£ã€‚â€ â€œHaving to use RefCell or clone everything for each future leads to overcomplicated code that makes me wish Rust had garbage collection.â€ â€œä¸å¾—ä¸ä½¿ç”¨ RefCell ä»¥åŠä¸ºæ¯ä¸ª future å…‹éš†æ‰€æœ‰å®ƒéœ€è¦çš„å€¼äº§ç”Ÿäº†è¿‡äºå¤æ‚çš„ä»£ç ï¼Œè¿™è®©æˆ‘å¼€å§‹æœŸå¾… Rust èƒ½å…·å¤‡åƒåœ¾å›æ”¶åŠŸèƒ½äº†ã€‚â€&lt;br/&gt; &lt;/blockquote&gt;&lt;p&gt;æˆ‘åœ¨ reddit ä¸Šå‘ç°äº†è¿™æ¡æ¶ˆæ¯ï¼Œæˆ‘è®¤ä¸ºå®ƒç¡®å®å¾ˆå¥½åœ°æ€»ç»“äº†æ‰€æœ‰æœ‰å…³ &lt;code&gt;Future&lt;/code&gt; çš„æŠ±æ€¨ã€‚ä½¿ç”¨ &lt;code&gt;Future&lt;/code&gt; æ—¶ï¼Œé”™è¯¯æ¶ˆæ¯éš¾ä»¥ç†è§£ï¼›ä¸å¾—ä¸ä½¿ç”¨ RefCell ä»¥åŠä¸ºæ¯ä¸ª future å…‹éš†æ‰€æœ‰å®ƒéœ€è¦çš„å€¼äº§ç”Ÿäº†è¿‡äºå¤æ‚çš„ä»£ç ï¼Œè¿™è®©æˆ‘å¼€å§‹æœŸå¾… Rust èƒ½å…·å¤‡åƒåœ¾å›æ”¶åŠŸèƒ½äº†ï¼ˆè§‚ä¼—ç¬‘ï¼‰ã€‚æ˜¯çš„ï¼Œè¿™ä¸æ˜¯ä»€ä¹ˆå¥½åé¦ˆã€‚&lt;/p&gt;&lt;p&gt;å› æ­¤ï¼Œä»å¤§çº¦ä¸€å¹´åŠå‰çš„æƒ…å†µæ¥çœ‹ï¼Œå¾ˆæ˜æ˜¾ï¼Œæœ‰ä¸¤ä¸ªé—®é¢˜éœ€è¦è§£å†³ï¼Œæ‰èƒ½è®©å¤§å®¶æ›´å®¹æ˜“ä½¿ç”¨ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;é¦–å…ˆ&lt;/b&gt;ï¼Œæˆ‘ä»¬éœ€è¦æ›´å¥½çš„é”™è¯¯æ¶ˆæ¯ï¼Œæœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯å°†è¯­æ³•æ„å»ºåˆ°è¯­è¨€ä¸­ï¼Œç„¶åå®ƒä»¬å°±å¯ä»¥åœ¨ä½ æ‰€æœ‰çš„è¯Šæ–­å’Œé”™è¯¯å¤„ç†ä»£ç ä¸­åŠ å…¥é’©å­ï¼Œä»è€Œä½¿ä½ èƒ½å¤ŸçœŸæ­£æ‹¥æœ‰è‰¯å¥½çš„ &lt;code&gt;async&lt;/code&gt; / &lt;code&gt;await&lt;/code&gt; çš„é”™è¯¯æ¶ˆæ¯ã€‚&lt;b&gt;å…¶æ¬¡&lt;/b&gt;ï¼Œäººä»¬é‡åˆ°çš„å¤§å¤šæ•°é”™è¯¯å®é™…ä¸Šæ˜¯å› ä¸ºä»–ä»¬è¢«ä¸€ä¸ªæ™¦æ¶©éš¾è§£çš„é—®é¢˜å¡ä½äº†â€”â€”å€Ÿç”¨é—®é¢˜ã€‚æ­£æ˜¯å› ä¸º &lt;code&gt;Future&lt;/code&gt; çš„è®¾è®¡æ–¹å¼å­˜åœ¨ç€è¿™ç§æ ¹æœ¬çš„å±€é™æ€§ï¼Œå¯¼è‡´ä¸€äº›å¾ˆæ™®é€šçš„ç¼–ç¨‹èŒƒå¼éƒ½æ— æ³•è¡¨è¾¾ã€‚æ‰€è°“å€Ÿç”¨é—®é¢˜ï¼Œå°±æ˜¯åœ¨æœ€åˆçš„ &lt;code&gt;Future&lt;/code&gt; çš„è®¾è®¡ä¸­ä½ ä¸èƒ½è·¨è¿‡&lt;b&gt;å¼‚æ­¥ç­‰å¾…ç‚¹&lt;/b&gt;ï¼ˆawait pointï¼‰è¿›è¡Œå€Ÿç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä½ è¦å¼‚æ­¥ç­‰å¾…ï¼ˆawaitï¼‰æŸä»¶äº‹ï¼Œä½ å°±ä¸èƒ½åœ¨é‚£ä¸ªæ—¶å€™æŒæœ‰ä»»ä½•å­˜æ´»çš„å¼•ç”¨ã€‚å½“äººä»¬é‡åˆ°äº†è¿™ç§é—®é¢˜ï¼Œä»–ä»¬é€šå¸¸ä¼šè¢«å¡ä½ï¼Œæœ€ç»ˆä»–ä»¬ä¼šå°è¯•åœ¨ &lt;code&gt;await&lt;/code&gt; çš„æ—¶å€™è¿›è¡Œå€Ÿç”¨ç„¶åå‘ç°å®é™…ä¸Šåšä¸åˆ°ã€‚æ‰€ä»¥å¦‚æœæˆ‘ä»¬èƒ½å¤Ÿä½¿è¿™ç§å€Ÿç”¨è¢«å…è®¸ï¼Œé‚£ä¹ˆå¤§å¤šæ•°è¿™äº›é”™è¯¯å°†æ¶ˆå¤±ï¼Œä¸€åˆ‡éƒ½å°†å˜å¾—æ›´æ˜“äºä½¿ç”¨ï¼Œä½ å¯ä»¥ä½¿ç”¨ &lt;code&gt;async&lt;/code&gt; å’Œ &lt;code&gt;await&lt;/code&gt; ç¼–å†™æ™®é€šçš„ Rust ä»£ç ï¼Œå¹¶ä¸”ä¸€åˆ‡éƒ½ä¼šæ­£å¸¸è¿›è¡Œã€‚&lt;/p&gt;&lt;p&gt;è¿™ç§è·¨è¶Š &lt;code&gt;await&lt;/code&gt; çš„å€Ÿç”¨æ˜¯éå¸¸æ™®éçš„ï¼Œå› ä¸º Rust çš„ API å¤©ç„¶å°±å…·æœ‰å¼•ç”¨ã€‚å½“ä½ å®é™…ç¼–è¯‘ &lt;code&gt;Future&lt;/code&gt; æ—¶ï¼Œå®ƒå¿…é¡»èƒ½å¤Ÿæ¢å¤æ‰€æœ‰çŠ¶æ€ï¼Œè€Œå½“ä½ æ‹¥æœ‰æŸäº›ä½äºåŒä¸€æ ˆå¸§ä¸­çš„å…¶å®ƒä¸œè¥¿çš„å¼•ç”¨æ—¶ï¼Œæœ€ç»ˆä½ ä¼šå¾—åˆ°ä¸€ä¸ª&lt;b&gt;è‡ªå¼•ç”¨&lt;/b&gt;çš„ &lt;code&gt;Future&lt;/code&gt; ç»“æ„ï¼ˆSelf-Referential Futureï¼‰ã€‚è¿™æ˜¯å¼€å¤´çš„é‚£ä¸ª &lt;code&gt;get_user&lt;/code&gt; æ–¹æ³•ï¼Œæˆ‘ä»¬æœ‰è¿™æ ·ä¸€ä¸ª SQL å­—ç¬¦ä¸²ï¼Œè€Œåœ¨ä½¿ç”¨ SQL å­—ç¬¦ä¸²è°ƒç”¨ &lt;code&gt;query&lt;/code&gt; æ–¹æ³•æ—¶ï¼Œæˆ‘ä»¬ä¼ é€’çš„æ˜¯ SQL å­—ç¬¦ä¸²çš„å¼•ç”¨ã€‚&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-rust&quot;&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sql&lt;/span&gt;: &lt;span class=&quot;nb&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;SELECT FROM users WHERE username = {}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;db_response&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;await&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sql&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™é‡Œå­˜åœ¨çš„é—®é¢˜æ˜¯ï¼Œå¯¹ SQL å­—ç¬¦ä¸²çš„å¼•ç”¨æ˜¯å¯¹å­˜å‚¨åœ¨ç›¸åŒ &lt;code&gt;Future&lt;/code&gt; çŠ¶æ€ä¸­çš„å…¶ä»–å†…å®¹çš„å¼•ç”¨ï¼Œå› æ­¤å®ƒæˆä¸ºä¸€ç§è‡ªå¼•ç”¨ç»“æ„ã€‚&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-9fbfa65f3218487b457b4ff272f68c96_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;604&quot; data-rawheight=&quot;440&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;604&quot; data-original=&quot;https://pic3.zhimg.com/v2-9fbfa65f3218487b457b4ff272f68c96_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-9fbfa65f3218487b457b4ff272f68c96_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;604&quot; data-rawheight=&quot;440&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;604&quot; data-original=&quot;https://pic3.zhimg.com/v2-9fbfa65f3218487b457b4ff272f68c96_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-9fbfa65f3218487b457b4ff272f68c96_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;å¦‚æœæŠŠè¿™ä¸ª &lt;code&gt;Future&lt;/code&gt; è§†ä½œä¸€ä¸ªçœŸçš„ç»“æ„ä½“çš„è¯ï¼Œè¿™å°±æ˜¯ç†è®ºä¸Šå®ƒæ‰€æ‹¥æœ‰çš„å­—æ®µã€‚é™¤äº†ä»£è¡¨æ•°æ®åº“å¥æŸ„çš„ &lt;code&gt;self&lt;/code&gt; ä¹‹å¤–ï¼Œè¿˜æœ‰ SQL å­—ç¬¦ä¸²ä»¥åŠå¯¹è¿™ä¸ª SQL å­—ç¬¦ä¸²çš„å¼•ç”¨ï¼Œå³ä¸€ä¸ªæœ€ç»ˆæŒ‡å›åŒä¸€ç»“æ„ä½“ä¸­æŸä¸ªå­—æ®µçš„å¼•ç”¨ã€‚&lt;/p&gt;&lt;p&gt;ä¸€äº›æ–°çš„æ½œåœ¨ç»“æ„ä¼šæˆä¸ºéå¸¸æ£˜æ‰‹çš„é—®é¢˜ï¼Œå› ä¸ºæˆ‘ä»¬æ²¡æœ‰é€šç”¨çš„è§£å†³æ–¹æ¡ˆã€‚å½“ä½ ç§»åŠ¨è¯¥ç»“æ„æ—¶ï¼Œæˆ‘ä»¬ä¸å…è®¸ä½ ä½¿ç”¨è‡ªå¼•ç”¨ï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬ä¼šåœ¨æ–°ä½ç½®åˆ›å»ºä¸€ä¸ªåŸæœ‰ç»“æ„çš„æ–°å‰¯æœ¬ï¼Œæ—§å‰¯æœ¬ä¼šå˜ä¸ºæ— æ•ˆï¼Œä½†æ˜¯åœ¨å¤åˆ¶æ—¶ï¼Œæ–°å‰¯æœ¬çš„å¼•ç”¨ä»æŒ‡å‘æ—§å‰¯æœ¬çš„å­—æ®µï¼Œè¯¥æŒ‡é’ˆå°±å˜æˆäº†æ‚¬ç©ºæŒ‡é’ˆï¼ˆdangling pointerï¼‰ï¼Œè€Œè¿™æ­£æ˜¯ Rust å¿…é¡»é¿å…çš„å†…å­˜é—®é¢˜ã€‚&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-a5601cb4bf7ae8092550226cc27fe5a1_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;944&quot; data-rawheight=&quot;480&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;944&quot; data-original=&quot;https://pic2.zhimg.com/v2-a5601cb4bf7ae8092550226cc27fe5a1_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-a5601cb4bf7ae8092550226cc27fe5a1_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;944&quot; data-rawheight=&quot;480&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;944&quot; data-original=&quot;https://pic2.zhimg.com/v2-a5601cb4bf7ae8092550226cc27fe5a1_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-a5601cb4bf7ae8092550226cc27fe5a1_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;æ‰€ä»¥æˆ‘ä»¬ä¸èƒ½ä½¿ç”¨è‡ªå¼•ç”¨ç»“æ„ï¼Œå› ä¸ºå¦‚æœä½ ç§»åŠ¨å®ƒä»¬ï¼Œé‚£ä¹ˆå®ƒä»¬å°†å¤±æ•ˆã€‚ç„¶è€Œï¼Œæˆ‘ä»¬å®é™…ä¸Šå¹¶ä¸éœ€è¦çœŸæ­£ç§»åŠ¨è¿™äº› &lt;code&gt;Future&lt;/code&gt; ã€‚å¦‚æœä½ è¿˜è®°å¾—åœ¨å †ä¸­é€šè¿‡å¥æŸ„ä½¿ç”¨ &lt;code&gt;Future&lt;/code&gt; çš„æ¨¡å‹ï¼Œå®ƒåœ¨ååº”å™¨å’Œæ‰§è¡Œå™¨ä¹‹é—´æ¥å›ä¼ é€’ï¼Œæ‰€ä»¥ &lt;code&gt;Future&lt;/code&gt; æœ¬èº«æ°¸è¿œä¸ä¼šçœŸæ­£ç§»åŠ¨ï¼›è€Œåªè¦ä½ ä¿è¯ä¸ç§»åŠ¨ï¼Œ&lt;code&gt;Future&lt;/code&gt; åŒ…å«è‡ªå¼•ç”¨å°±å®Œå…¨æ²¡é—®é¢˜ã€‚&lt;/p&gt;&lt;p&gt;æ‰€ä»¥æˆ‘ä»¬éœ€è¦é€šè¿‡é‡‡ç”¨æŸç§æ–¹å¼åœ¨ &lt;code&gt;Future&lt;/code&gt; çš„ API ä¸­è¡¨è¾¾ â€œåœ¨ä½ è½®è¯¢æ—¶ï¼Œä½ ä¸å…è®¸éšæ„ç§»åŠ¨å®ƒâ€ æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚å¦‚æœæˆ‘ä»¬èƒ½å¤Ÿè¡¨è¾¾è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å°±å¯ä»¥å…è®¸ &lt;code&gt;Future&lt;/code&gt; ä¸­å‡ºç°è‡ªå¼•ç”¨ï¼Œè¿›è€Œå°±å¯ä»¥åœ¨å¼‚æ­¥å‡½æ•°ä¸­çœŸæ­£ä½¿ç”¨è¿™äº›å¼•ç”¨ï¼Œå¹¶ä¸”ä¸€åˆ‡éƒ½ä¼šæ­£å¸¸å·¥ä½œã€‚å› æ­¤æˆ‘ä»¬ç ”ç©¶äº†è¿™ä¸ªé—®é¢˜ï¼Œæœ€ç»ˆå¼€å‘å‡ºäº†è¢«ç§°ä¸º &lt;code&gt;Pin&lt;/code&gt; çš„æ–° API ã€‚&lt;/p&gt;&lt;h3&gt;&lt;code&gt;Pin&lt;/code&gt;&lt;/h3&gt;&lt;p&gt;&lt;code&gt;Pin&lt;/code&gt; æ˜¯ä¸€ç§å›´ç»•å…¶ä»–æŒ‡é’ˆç±»å‹çš„é€‚é…å™¨ï¼Œå¯ä»¥å°†å…¶å®ƒæŒ‡é’ˆå˜ä¸º &lt;b&gt;å›ºå®šå¼•ç”¨&lt;/b&gt;ï¼ˆpinned referenceï¼‰ã€‚é™¤äº†åŸæœ‰æŒ‡é’ˆçš„ä¿è¯å¤–ï¼Œå®ƒè¿˜ä¿è¯è¿™ä¸ªå¼•ç”¨å†ä¹Ÿä¸ä¼šè¢«ç§»åŠ¨ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç¡®ä¿å®ƒå°†ä¸€ç›´å¤„åœ¨åŒä¸€å†…å­˜ä½ç½®ï¼Œç›´åˆ°æœ€ç»ˆè¢«é‡Šæ”¾ã€‚å¦‚æœä½ çš„ API ä¸­æœ‰ä¸€äº›å†…å®¹å·²è¡¨æ˜å¿…é¡»ä½¿ç”¨ &lt;code&gt;Pin&lt;/code&gt;ï¼Œé‚£ä¹ˆä½ å°±çŸ¥é“äº†å®ƒå†ä¹Ÿä¸ä¼šè¢«ç§»åŠ¨ï¼Œè¿™æ ·å°±ä½ å¯ä»¥ä½¿ç”¨é‚£ç§è‡ªå¼•ç”¨çš„ç»“æ„ä½“äº†ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä¿®æ”¹äº† &lt;code&gt;Future&lt;/code&gt; çš„å·¥ä½œæ–¹å¼ï¼Œç°åœ¨å®ƒå˜æˆäº†ä¸€ä¸ªç»è¿‡è£…ç®±ï¼ˆboxedï¼‰çš„ &lt;code&gt;Future&lt;/code&gt; ï¼Œå®é™…ä¸Šæ˜¯ä¸€ä¸ªç”± &lt;code&gt;Pin&lt;/code&gt; å°è£…çš„ &lt;code&gt;Box&amp;lt;Future&amp;gt;&lt;/code&gt; ï¼›è¿™æ ·æ— è®ºåœ¨å“ªé‡Œè£…ç®±ï¼Œæˆ‘ä»¬æŠŠå®ƒæ”¾åœ¨å †å†…å­˜ä¸­ï¼Œå®ƒå¯ä»¥ä¿è¯æ°¸è¿œä¸ä¼šå†ç§»åŠ¨ï¼›è€Œå½“ä½ è½®è¯¢ &lt;code&gt;Future&lt;/code&gt; æ—¶ï¼Œä¸å†ä½¿ç”¨ä¸€ä¸ªæ™®é€šå¼•ç”¨ï¼Œè€Œæ˜¯ä½¿ç”¨ä¸€ä¸ªå›ºå®šå¼•ç”¨ï¼Œè¿™æ · &lt;code&gt;Future&lt;/code&gt; å°±çŸ¥é“å®ƒä¸ä¼šè¢«ç§»åŠ¨ã€‚è€Œä½¿è¿™ä¸€åˆ‡èµ·ä½œç”¨çš„è¯€çªæ˜¯ï¼Œè¦ä»å›ºå®šå¼•ç”¨ä¸­è·å–éå›ºå®šå¼•ç”¨ï¼Œä½ åªèƒ½ä½¿ç”¨ä¸å®‰å…¨çš„ä»£ç ã€‚&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-rust&quot;&gt;&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Pin&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;P&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;P&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;impl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Pin&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;Box&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;boxed&lt;/span&gt;: &lt;span class=&quot;nb&quot;&gt;Box&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&quot;nc&quot;&gt;Pin&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;Box&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;as_mut&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&quot;nc&quot;&gt;Pin&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;impl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Pin&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;unsafe&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;get_unchecked_mut&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&quot;kp&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ‰€ä»¥ Pin API å¤§è‡´å°±åƒè¿™æ ·ã€‚åœ¨è¿™é‡Œä½ æœ‰ä¸€ä¸ª &lt;code&gt;Pin&lt;/code&gt; ç»“æ„ï¼Œå®ƒåªæ˜¯å¦ä¸€ä¸ªæŒ‡é’ˆç±»å‹çš„å°è£…ï¼Œå®ƒæ²¡æœ‰ä»»ä½•è¿è¡Œæ—¶å¼€é”€æˆ–è€…å…¶å®ƒä¸œè¥¿ï¼Œä»…ä»…æ˜¯å°†å…¶åˆ’åˆ†ä¸ºä¸€ä¸ªå›ºå®šçš„ï¼ˆpinnedï¼‰å¯¹è±¡ï¼Œç„¶åä¸€ä¸ªå›ºå®šçš„ &lt;code&gt;Box&lt;/code&gt; æŒ‡é’ˆå¯ä»¥è½¬æ¢ä¸ºä¸€ä¸ªå›ºå®šå¼•ç”¨ï¼Œä½†æ˜¯å°†ä¸€ä¸ªå›ºå®šå¼•ç”¨è½¬æ¢ä¸ºä¸€ä¸ªéå›ºå®šå¼•ç”¨çš„å”¯ä¸€æ–¹æ³•æ˜¯ä½¿ç”¨ä¸€ä¸ªä¸å®‰å…¨çš„ï¼ˆunsafeï¼‰å‡½æ•°ã€‚&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-rust&quot;&gt;&lt;span class=&quot;k&quot;&gt;trait&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Future&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;poll&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;: &lt;span class=&quot;nc&quot;&gt;Pin&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;waker&lt;/span&gt;: &lt;span class=&quot;kp&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Waker&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;-&amp;gt; &lt;span class=&quot;nc&quot;&gt;Poll&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Self&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;Output&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬è¦åšçš„å°±æ˜¯ä¿®æ”¹ &lt;code&gt;Future&lt;/code&gt; çš„ API ï¼Œå…¶è½®è¯¢æ–¹æ³•å°†ä¸å†æ¥å—ä¸€ä¸ªæ™®é€šå¼•ç”¨ï¼Œè€Œæ˜¯æ¥å—ä¸€ä¸ªå›ºå®šå¼•ç”¨ï¼Œè€Œè¿™å…¶å®å°±æ˜¯æˆ‘ä»¬å°†è¦ç¨³å®šå‘å¸ƒçš„ &lt;code&gt;Future&lt;/code&gt; APIã€‚è€Œåšäº†è¿™ä¸ªä¿®æ”¹ä¹‹åï¼Œç¬¬ä¸€ä¸ªç¤ºä¾‹çš„å†™æ³•å°±èƒ½æ­£å¸¸å·¥ä½œäº†ã€‚è¿™æ ·ä½ å°±å¯ä»¥åƒå†™é˜»å¡ I/O çš„ä»£ç é‚£æ ·ç¼–å†™å¼‚æ­¥ I/O çš„ä»£ç äº†ï¼Œåªéœ€è¦åŠ ä¸Š &lt;code&gt;async&lt;/code&gt; å’Œ &lt;code&gt;await&lt;/code&gt; æ³¨è§£ï¼Œä½ å°±èƒ½å¾—åˆ°è¿™ä¸ªå‡ºè‰²çš„é›¶æˆæœ¬æŠ½è±¡çš„å¼‚æ­¥å®ç°ï¼Œè€Œå³ä¾¿ä½ è‡ªå·±æ‰‹å†™ï¼Œè¿™åŸºæœ¬ä¸Šä¹Ÿæ˜¯ä½ èƒ½å†™å‡ºçš„å¼€é”€æœ€ä½çš„å®ç°äº†ã€‚&lt;/p&gt;&lt;h2&gt;&lt;code&gt;async&lt;/code&gt; / &lt;code&gt;await&lt;/code&gt; çš„ç°çŠ¶åŠæœªæ¥&lt;/h2&gt;&lt;p&gt;ç›®å‰çš„æƒ…å†µæ˜¯ï¼ŒPinning å¤§çº¦åœ¨ä¸€ä¸ªæœˆå‰çš„æœ€æ–°ç‰ˆæœ¬ä¸­ç¨³å®šäº†ï¼Œæˆ‘ä»¬æ­£åœ¨ç¨³å®š &lt;code&gt;Future&lt;/code&gt; çš„ API ï¼Œå› æ­¤å¤§æ¦‚ä¼šåœ¨ 1.35ï¼Œä¹Ÿå¯èƒ½ä¼šæ¨åˆ° 1.36 ç¨³å®šï¼ŒåŸºæœ¬ä¸Šåœ¨ä¸¤ä¸‰ä¸ªæœˆå†…å°±ä¼šçŸ¥é“äº†ã€‚å¹¶ä¸”æˆ‘ä»¬å¸Œæœ›ä»Šå¹´çš„æŸä¸ªæ—¶å€™æˆ‘ä»¬èƒ½å¤Ÿæ‹¥æœ‰ &lt;code&gt;async&lt;/code&gt; / &lt;code&gt;await&lt;/code&gt;ï¼Œå¸Œæœ›ä»Šå¹´å¤æœ«èƒ½å°†å…¶ç¨³å®šä¸‹æ¥ï¼Œè¿™æ ·äººä»¬å°±å¯ä»¥ä½¿ç”¨è¿™ç§ç±»ä¼¼é˜»å¡ I/O çš„è¯­æ³•ç¼–å†™æ— é˜»å¡çš„ I/O ç½‘ç»œæœåŠ¡äº†ã€‚é™¤äº†è¿™äº›ç¨³å®šåŒ–å·¥ä½œï¼Œæˆ‘ä»¬ä¹Ÿå·²ç»å¼€å§‹ç ”ç©¶æŸäº›æ›´é•¿æœŸçš„åŠŸèƒ½ï¼Œæ¯”å¦‚æµï¼ˆStreamï¼‰ï¼Œæˆ‘è®¤ä¸ºå®ƒå¯èƒ½æ˜¯å¼‚æ­¥çš„ä¸‹ä¸€ä¸ªå¤§åŠŸèƒ½ã€‚æˆ‘ä»¬çŸ¥é“ä¸€ä¸ª &lt;code&gt;Future&lt;/code&gt; åªäº§ç”Ÿä¸€ä¸ªå€¼ï¼Œè€Œä¸€ä¸ªæµå¯ä»¥å¼‚æ­¥åœ°äº§ç”Ÿå¾ˆå¤šå€¼ï¼›å¼‚æ­¥åœ°äº§ç”Ÿå€¼æœ¬è´¨ä¸Šå°±åƒæ˜¯ä¸€ä¸ªå¼‚æ­¥è¿­ä»£å™¨ï¼Œä½ èƒ½å¤Ÿåœ¨ä¸€ä¸ªæµä¸Šè¿›è¡Œå¼‚æ­¥çš„å¾ªç¯ï¼›è¿™ä¸ªåŠŸèƒ½å¯¹äºè®¸å¤šç”¨ä¾‹æ¥è¯´éå¸¸é‡è¦ï¼Œæ¯”å¦‚æµå¼ä¼ è¾“HTTPã€WebSocket æ¨é€è¯·æ±‚ä¹‹ç±»çš„ä¸œè¥¿ï¼Œä¸ç”¨åƒæˆ‘ä»¬çš„ RPC æ¨¡å‹é‚£æ ·å‘å‡ºç½‘ç»œè¯·æ±‚ç„¶åè·å¾—å•ä¸ªå“åº”ï¼Œè€Œæ˜¯èƒ½å¤Ÿä½¿ç”¨è¯·æ±‚æµå’Œå“åº”æµï¼Œåœ¨ä¸¤è€…ä¹‹é—´æ¥å›è°ƒç”¨ã€‚&lt;/p&gt;&lt;p&gt;ç›®å‰ä½¿ç”¨å¼‚æ­¥ä»ç„¶å­˜åœ¨ä¸€ä¸ªé™åˆ¶ï¼Œå³ä¸èƒ½åœ¨ &lt;code&gt;trait&lt;/code&gt; ä¸­ä½¿ç”¨ &lt;code&gt;async&lt;/code&gt;ã€‚æœ‰è®¸å¤šç¼–è¯‘å™¨å¼€å‘å·¥ä½œæ­£åœ¨è¿›è¡Œï¼Œä½¿å…¶èƒ½å¤Ÿæ”¯æŒè¿™ä¸ªç‰¹æ€§ã€‚é™¤äº†è¿™äº›åŠŸèƒ½ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬ä¹Ÿå¸Œæœ›èƒ½æ‹¥æœ‰ç”Ÿæˆå™¨ï¼ˆGeneratorï¼‰ï¼Œç±»ä¼¼äº Python æˆ– JavaScript çš„ç”Ÿæˆå™¨ï¼Œé™¤äº†æ‹¥æœ‰å¯ä»¥ &lt;code&gt;return&lt;/code&gt; çš„å‡½æ•°ï¼Œè¿˜èƒ½ä½¿ç”¨å¯ä»¥ &lt;code&gt;yield&lt;/code&gt; çš„å‡½æ•°ï¼Œè¿™æ ·ä½ å°±å¯ä»¥åœ¨ &lt;code&gt;yield&lt;/code&gt; ä¹‹åå†æ¬¡æ¢å¤æ‰§è¡Œï¼›å¹¶ä¸”ä½ å¯ä»¥å°†è¿™äº›å‡½æ•°ä½œä¸ºç¼–å†™è¿­ä»£å™¨å’Œæµçš„æ–¹å¼ï¼Œå°±åƒå¼‚æ­¥å‡½æ•°èƒ½å¤Ÿè®©ä½ åƒç¼–å†™æ™®é€šå‡½æ•°é‚£æ ·ç¼–å†™ &lt;code&gt;Future&lt;/code&gt; ä¸€æ ·ã€‚&lt;/p&gt;&lt;p&gt;æœ€åï¼Œæˆ‘æƒ³å›é¡¾ä¸€ä¸‹æˆå°±è¿™ç§é›¶æˆæœ¬å¼‚æ­¥ I/O çš„å…³é”®ç‚¹ï¼šé¦–å…ˆå°±æ˜¯è¿™ç§åŸºäºè½®è¯¢çš„ &lt;code&gt;Future&lt;/code&gt;ï¼Œå®ƒå°†è¿™äº› &lt;code&gt;Future&lt;/code&gt; ç¼–è¯‘åˆ°è¿™ç§ç›¸å½“ç´§å‡‘çš„çŠ¶æ€æœºä¸­ï¼›å…¶æ¬¡æ˜¯è¿™ç§å®ç° &lt;code&gt;async&lt;/code&gt; / &lt;code&gt;await&lt;/code&gt; è¯­æ³•çš„æ–¹å¼ï¼Œå³å› ä¸ºæœ‰äº† &lt;code&gt;Pin&lt;/code&gt;ï¼Œæˆ‘ä»¬èƒ½å¤Ÿè·¨è¶Šå¼‚æ­¥ç­‰å¾…ç‚¹ä½¿ç”¨å¼•ç”¨ã€‚&lt;/p&gt;&lt;p&gt;è°¢è°¢å¤§å®¶ã€‚&lt;/p&gt;&lt;blockquote&gt; è¯‘è€…æ³¨ï¼šæŠ¥å‘Šä¸­è®¡åˆ’ç¨³å®šçš„ç‰¹æ€§å‡å·²ç¨³å®šå‘å¸ƒï¼Œå‚è§ &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//areweasyncyet.rs/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;areweasyncyet.rs&lt;/a&gt;ã€‚ æŒ‰ç…§ç›®å‰ç¨³å®šçš„ç‰ˆæœ¬ï¼Œ&lt;code&gt;await&lt;/code&gt; å·²æ”¹ä¸ºåç½®è¿ç®—ç¬¦ &lt;code&gt;.await&lt;/code&gt;ï¼Œæ‰€ä»¥æœ¬æ–‡å¼€å¤´çš„ &lt;code&gt;get_user&lt;/code&gt; æ–¹æ³•åº”å½“ä¿®æ”¹ä¸ºï¼š&lt;br/&gt; &lt;/blockquote&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-rust&quot;&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;db&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_user&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;withoutboats&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;await&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;impl&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Database&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;async&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;get_user&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;user&lt;/span&gt;: &lt;span class=&quot;kp&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&quot;nc&quot;&gt;User&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sql&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;select FROM users WHERE username = {}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;db_response&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sql&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;await&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;User&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;from&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;db_response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>ä¸æ˜è§‰ç–¼</author>
<guid isPermaLink="false">2020-01-05-97574385</guid>
<pubDate>Sun, 05 Jan 2020 00:00:00 +0800</pubDate>
</item>
<item>
<title>ä¸¤ç™¾è¡ŒRustä»£ç è§£æç»¿è‰²çº¿ç¨‹åŸç†ï¼ˆäº”ï¼‰é™„å½•ï¼šæ”¯æŒ Windows</title>
<link>https://henix.github.io/feeds/zhuanlan.rust-lang/2020-01-05-101168659.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/101168659&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt; åŸæ–‡: Green threads explained in 200 lines of rust language&lt;br/&gt; åœ°å€: &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//cfsamson.gitbook.io/green-threads-explained-in-200-lines-of-rust/&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;cfsamson.gitbook.io/gre&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;en-threads-explained-in-200-lines-of-rust/&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;  &lt;br/&gt; ä½œè€…: Carl Fredrik Samson(cfsamson@Github)&lt;br/&gt; ç¿»è¯‘: è€¿è…¾&lt;br/&gt; &lt;/blockquote&gt;&lt;hr/&gt;&lt;p&gt;æˆ‘ä»¬çš„ç¤ºä¾‹é€‚ç”¨äº OSXã€Linux å’Œ Windowsï¼Œä½†æˆ‘ä¹‹å‰æ›¾æŒ‡å‡ºï¼Œè™½ç„¶è¿™ä¸ªå®ç°åœ¨ Windows ä¸Šå¯ä»¥è¿è¡Œï¼Œä½†å¹¶ä¸æ­£ç¡®ã€‚å› ä¸ºæˆ‘ä¸€ç›´è‡´åŠ›äºä½¿è¿™ä¸ªå®ç°åœ¨æ‰€æœ‰ä¸‰ä¸ªå¹³å°ä¸Šéƒ½èƒ½æ­£ç¡®è¿è¡Œï¼Œæ‰€ä»¥æˆ‘å°†åœ¨æœ¬ç« ä¸­ä»‹ç»æˆ‘ä»¬è¿˜éœ€è¦åšçš„äº‹æƒ…ã€‚&lt;/p&gt;&lt;p&gt;ä½ å¯èƒ½æƒ³çŸ¥é“ä¸ºä»€ä¹ˆæˆ‘æ²¡æœ‰åœ¨åŸå§‹ä»£ç ä¸­åŒ…å«æ­¤å†…å®¹ï¼Œå…¶åŸå› æ˜¯ï¼Œè¿™å®é™…ä¸Šä¸è§£é‡Šæˆ‘æƒ³æ¢ç´¢çš„ä¸»è¦æ¦‚å¿µæ²¡æœ‰ä»»ä½•å…³ç³»ã€‚&lt;/p&gt;&lt;p&gt;åœ¨è¿™é‡Œï¼Œæˆ‘è¯•å›¾è¿›ä¸€æ­¥æ¢è®¨å¦‚ä½•ä¸º Windows æ­£ç¡®è®¾ç½®æ ˆå¹¶è¿›è¡Œé€‚å½“çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚å³ä½¿æˆ‘ä»¬å¯èƒ½æ— æ³•ä¸€è·¯å†™å‡ºå®Œç¾çš„å®ç°ï¼Œä¹Ÿæœ‰å¤§é‡ä¿¡æ¯å’Œå‚è€ƒä¾›ä½ è¿›ä¸€æ­¥æ¢ç´¢ï¼Œæˆ‘å°†åœ¨è¿™é‡Œåˆ—å‡ºå…¶ä¸­çš„ä¸€äº›ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//docs.microsoft.com/en-us/cpp/build/x64-software-conventions%3Fview%3Dvs-2019&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Microsoft x64 è½¯ä»¶çº¦å®š&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//wiki.lazarus.freepascal.org/Win64/AMD64_API&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Win64 / AMD64 API&lt;/a&gt; - psABi ä¸ Win64 ä¹‹é—´å·®å¼‚çš„ç®€è¦æ¦‚è¿°&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//probablydance.com/2013/02/20/handmade-coroutines-for-windows/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;é€‚ç”¨äº Windows çš„æ‰‹å·¥åç¨‹&lt;/a&gt; - å…³äºåç¨‹å®ç°çš„å¥½è¯»ç‰©&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/boostorg/context/blob/develop/src/asm/ontop_x86_64_ms_pe_gas.asm&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Boost ç¯å¢ƒä¸­çš„æ±‡ç¼–&lt;/a&gt; - ä½¿ç”¨ C++ï¼Œä½†å®ƒæ˜¯è¿›ä¸€æ­¥ç ”ç©¶çš„è‰¯å¥½å‚è€ƒ&lt;/li&gt;&lt;/ul&gt;&lt;h3&gt;Windows çš„ç‰¹æ®Šä¹‹å¤„&lt;/h3&gt;&lt;p&gt;æˆ‘è®¤ä¸ºè¯¥éƒ¨æœ¬å†…å®¹æ²¡æœ‰é‡è¦åˆ°å€¼å¾—å‡ºç°åœ¨å‰æ–‡çš„ä¸€èˆ¬æ€§ç¤ºä¾‹ä¸­çš„ä¸»è¦åŸå› æ˜¯ï¼Œé™¤äº†æˆ‘ä»¬éœ€è¦çš„ä¸€ä¸ªæ–‡æ¡£å¾ˆå°‘è®°è½½çš„å¥‡æ€ªç‰¹æ€§ä¹‹å¤–ï¼ŒWindows åªæ˜¯æœ‰æ›´å¤šçš„â€œç”±è¢«è°ƒç”¨è€…ä¿å­˜çš„å¯„å­˜å™¨â€ï¼Œæˆ–è€…ä¹Ÿæœ‰äººå«å®ƒâ€œéæ˜“å¤±æ€§å¯„å­˜å™¨â€ã€‚æ‰€ä»¥æˆ‘ä»¬çœŸæ­£è¦åšçš„åªæ˜¯åœ¨æ‰§è¡Œä¸Šä¸‹æ–‡åˆ‡æ¢æ—¶ä¿å­˜æ›´å¤šæ•°æ®ï¼Œè€Œè¿™éœ€è¦æ›´å¤šçš„æ¡ä»¶ç¼–è¯‘ã€‚&lt;/p&gt;&lt;blockquote&gt; å³ä¾¿ä¸åœ¨æ»¡è¶³åŸºæœ¬ç†è§£éœ€æ±‚çš„åŸºç¡€ä¸Šå¢åŠ å¤ªå¤šä¸œè¥¿ï¼Œä½¿ç”¨æ¡ä»¶ç¼–è¯‘æ¥æ”¯æŒ Windows è¿˜æ˜¯ä¼šä½¿æˆ‘ä»¬çš„ä»£ç å‡ ä¹è†¨èƒ€ 50%ï¼Œã€‚ ä¸è¿‡è¿™å¹¶ä¸æ„å‘³ç€è¿™é¡¹å·¥ä½œæ²¡æœ‰è¶£ï¼Œä½†æ˜¯ä»å¤´å¼€å§‹åšæ‰€æœ‰äº‹æƒ…æ—¶ï¼Œæˆ‘ä»¬ä¹Ÿä¼šäº²èº«ä½“éªŒæ”¯æŒå¤šä¸ªå¹³å°çš„ä¸€äº›å›°éš¾ã€‚&lt;br/&gt; &lt;/blockquote&gt;&lt;h3&gt;é¢å¤–çš„ç”±è¢«è°ƒç”¨æ–¹ä¿å­˜çš„ï¼ˆéæ˜“å¤±æ€§ï¼‰å¯„å­˜å™¨&lt;/h3&gt;&lt;p&gt;æˆ‘æåˆ°çš„ç¬¬ä¸€ä»¶äº‹æ˜¯ Windows éœ€è¦åœ¨ä¸Šä¸‹æ–‡åˆ‡æ¢æœŸé—´ä¿å­˜æ›´å¤šæ•°æ®ï¼Œå°¤å…¶æ˜¯ XMM6-XMM15 å¯„å­˜å™¨ã€‚è¿™ä¸€ç‚¹å®é™…ä¸Š&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//docs.microsoft.com/en-us/cpp/build/x64-software-conventions%3Fview%3Dvs-2019%23register-usage&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;åœ¨è¿™ä»½å‚è€ƒèµ„æ–™ä¸­è¢«ç‰¹åˆ«æåŠäº†&lt;/a&gt;ï¼Œå› æ­¤åªéœ€è¦å‘æˆ‘ä»¬çš„ &lt;code&gt;ThreadContext&lt;/code&gt; ç»“æ„ä¸­æ·»åŠ äº†æ›´å¤šå­—æ®µã€‚æˆ‘ä»¬ä¹‹å‰å·²ç»åšè¿‡ä¸€æ¬¡ï¼Œæ‰€ä»¥å¾ˆå®¹æ˜“ã€‚&lt;/p&gt;&lt;p&gt;é™¤äº† &lt;code&gt;XMM&lt;/code&gt; å¯„å­˜å™¨ï¼Œ&lt;code&gt;rdi&lt;/code&gt; å’Œ &lt;code&gt;rsi&lt;/code&gt; å¯„å­˜å™¨åœ¨ Windows ä¸Šä¹Ÿæ˜¯éæ˜“å¤±æ€§çš„ï¼Œè¿™æ„å‘³ç€å®ƒä»¬å·²ç”±è¢«è°ƒç”¨è€…ä¿å­˜ï¼ˆåœ¨Linuxä¸Šï¼Œè¿™äº›å¯„å­˜å™¨ç”¨äºç¬¬ä¸€ä¸ªå’Œç¬¬äºŒä¸ªå‡½æ•°å‚æ•°ï¼‰ï¼Œå› æ­¤æˆ‘ä»¬ä¹Ÿéœ€è¦æ·»åŠ å®ƒä»¬ã€‚&lt;/p&gt;&lt;p&gt;ä¸è¿‡æœ‰ä¸€ä¸ªæ³¨æ„äº‹é¡¹ï¼š&lt;code&gt;XMM&lt;/code&gt; å¯„å­˜å™¨æ˜¯ 128 ä½è€Œä¸æ˜¯ 64 ä½çš„ã€‚Rust æœ‰ &lt;code&gt;u128&lt;/code&gt; ç±»å‹ï¼Œä½†æ˜¯æˆ‘ä»¬å°†ä½¿ç”¨ &lt;code&gt;[u64; 2]&lt;/code&gt; æ¥é¿å… &lt;i&gt;å¯èƒ½&lt;/i&gt; å¯¼è‡´çš„æŸäº›å¯¹é½é—®é¢˜ã€‚å…ˆä¸ç”¨æ‹…å¿ƒï¼Œæˆ‘ä¼šåœ¨ä¸‹é¢è¿›ä¸€æ­¥è§£é‡Šã€‚&lt;/p&gt;&lt;p&gt;ä¿®æ”¹ä¹‹åï¼Œæˆ‘ä»¬çš„ &lt;code&gt;ThreadContext&lt;/code&gt; å¦‚ä¸‹æ‰€ç¤ºï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-rust&quot;&gt;&lt;span class=&quot;cp&quot;&gt;#[cfg(target_os=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;windows&amp;#34;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;)]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;#[derive(Debug, Default)]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;#[repr(C)]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; 
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ThreadContext&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rsp&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r15&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r14&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r13&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r12&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rbx&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rbp&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rdi&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rsi&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm6&lt;/span&gt;: &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm7&lt;/span&gt;: &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm8&lt;/span&gt;: &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm9&lt;/span&gt;: &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm10&lt;/span&gt;: &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm11&lt;/span&gt;: &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm12&lt;/span&gt;: &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm13&lt;/span&gt;: &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm14&lt;/span&gt;: &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm15&lt;/span&gt;: &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3&gt;çº¿ç¨‹ä¿¡æ¯å—&lt;/h3&gt;&lt;p&gt;ç¬¬äºŒéƒ¨åˆ†ç›¸å…³æ–‡æ¡£ä¸å¤šã€‚ å®é™…ä¸Šï¼Œæˆ‘ä¸€ç›´åœ¨åŠªåŠ›éªŒè¯åœ¨ç°ä»£ Windows ä¸Šå¦‚æœç›´æ¥è·³è¿‡è¿™ä¸ªé—®é¢˜æ˜¯å¦‚ä½•å¯¼è‡´å¤±è´¥çš„ï¼Œä¸è¿‡å·²ç»æœ‰äº†æ¥è‡ª&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/boostorg/context/blob/develop/src/asm/ontop_x86_64_ms_pe_gas.asm%23L116-L129&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;å€¼å¾—ä¿¡èµ–çš„ä¿¡æ¯æ¥æº&lt;/a&gt;çš„&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//probablydance.com/2013/02/20/handmade-coroutines-for-windows/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;å……è¶³çš„å‚è€ƒèµ„æ–™&lt;/a&gt;ï¼Œæˆ‘æ¯«æ— ç–‘é—®æˆ‘ä»¬éœ€è¦è§£å†³è¿™ä¸€é—®é¢˜ã€‚&lt;/p&gt;&lt;p&gt;ä½ ä¼šçœ‹åˆ°ï¼ŒWindowså¸Œæœ›å°†æœ‰å…³å½“å‰æ­£åœ¨è¿è¡Œçš„çº¿ç¨‹çš„æŸäº›ä¿¡æ¯å­˜å‚¨åœ¨å®ƒç§°ä¸º â€œçº¿ç¨‹ä¿¡æ¯å—ï¼ˆ&lt;code&gt;Thread Information Block&lt;/code&gt;ï¼‰â€ï¼ˆç§°ä¸º NT_TIBï¼‰çš„ç»“æ„ä¸­ã€‚å…·ä½“æ¥è¯´ï¼Œå®ƒå¸Œæœ›è®¿é—® &lt;code&gt;%gs&lt;/code&gt; å¯„å­˜å™¨ä¸­æœ‰å…³ &lt;code&gt;Stack Base&lt;/code&gt; å’Œ &lt;code&gt;Stack Limit&lt;/code&gt; çš„ä¿¡æ¯ã€‚&lt;/p&gt;&lt;blockquote&gt; ä½ å¯èƒ½ä¼šé—® GS å¯„å­˜å™¨æ˜¯ä»€ä¹ˆï¼Ÿ æˆ‘æ‰¾åˆ°çš„ç­”æ¡ˆæœ‰äº›è®©äººå›°æƒ‘ã€‚ æ˜¾ç„¶ï¼Œè¿™äº›æ®µå¯„å­˜å™¨ï¼ˆx64 ä¸Šçš„ GS å’Œ x86 ä¸Šçš„ FSï¼‰æ˜¯ Intel æ—¨åœ¨&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//stackoverflow.com/questions/10810203/what-is-the-fs-%2520gs-register-intended-for&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;å…è®¸ç¨‹åºè®¿é—®è®¸å¤šä¸åŒçš„å†…å­˜æ®µ&lt;/a&gt;è€Œè®¾è®¡çš„ï¼Œå®ƒä»¬åŸæœ¬æ‰“ç®—ä½œä¸ºæ°¸ä¹…æ€§è™šæ‹Ÿå­˜å‚¨çš„ä¸€éƒ¨åˆ†ã€‚ç°ä»£æ“ä½œç³»ç»Ÿä¸ä¼šä»¥è¿™ç§æ–¹å¼ä½¿ç”¨è¿™äº›å¯„å­˜å™¨ï¼Œå› ä¸ºæˆ‘ä»¬åªèƒ½è®¿é—®è‡ªå·±çš„è¿›ç¨‹å†…å­˜ï¼ˆå¯¹äºç¨‹åºå‘˜æ¥è¯´ï¼Œå®ƒä»¬çœ‹èµ·æ¥åƒæ˜¯ â€œæ‰å¹³â€ å†…å­˜ï¼‰ã€‚å½“è¿˜ä¸æ¸…æ¥šè¿™å°†æ˜¯ä¸»æµæ¨¡å‹æ—¶ï¼Œè¿™äº›å¯„å­˜å™¨å°†å…è®¸ç”±ä¸åŒçš„æ“ä½œç³»ç»Ÿè¿›è¡Œä¸åŒçš„å®ç°ã€‚å¦‚æœä½ æ„Ÿåˆ°å¥½å¥‡ï¼Œè¯·å‚é˜… &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//en.wikipedia.org/wiki/Multics&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;æœ‰å…³ Multics æ“ä½œç³»ç»Ÿçš„ Wikipedia é¡µ&lt;/a&gt;ã€‚&lt;br/&gt; &lt;/blockquote&gt;&lt;p&gt;è¿™æ„å‘³ç€æ“ä½œç³»ç»Ÿå¯ä»¥è‡ªç”±åœ°å°†è¿™äº›æ®µå¯„å­˜å™¨ç”¨äºå…¶è®¤ä¸ºé€‚å½“çš„ç”¨é€”ã€‚ Windows å°†å½“å‰æ­£åœ¨è¿è¡Œçº¿ç¨‹çš„ç›¸å…³ä¿¡æ¯å­˜å‚¨åœ¨ GS å¯„å­˜å™¨ä¸­ï¼Œè€Œ Linux ä½¿ç”¨è¿™äº›å¯„å­˜å™¨è¿›è¡Œçº¿ç¨‹æœ¬åœ°å­˜å‚¨ã€‚&lt;/p&gt;&lt;p&gt;å½“æˆ‘ä»¬åˆ‡æ¢çº¿ç¨‹æ—¶ï¼Œæˆ‘ä»¬åº”è¯¥æä¾›å…¶æ‰€éœ€çš„å…³äº&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//en.wikipedia.org/wiki/Win32_Thread_Information_Block&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Stack Base å’Œ Stack Limit&lt;/a&gt;çš„ä¿¡æ¯ã€‚&lt;/p&gt;&lt;p&gt;é‚£ä¹ˆæˆ‘ä»¬çš„ &lt;code&gt;ThreadContext&lt;/code&gt; å°±åº”è¯¥æ˜¯è¿™æ ·çš„:&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-rust&quot;&gt;&lt;span class=&quot;cp&quot;&gt;#[cfg(target_os=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;windows&amp;#34;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;)]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;#[derive(Debug, Default)]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;#[repr(C)]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; 
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ThreadContext&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rsp&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r15&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r14&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r13&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r12&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rbx&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rbp&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rdi&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rsi&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm6&lt;/span&gt;: &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm7&lt;/span&gt;: &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm8&lt;/span&gt;: &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm9&lt;/span&gt;: &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm10&lt;/span&gt;: &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm11&lt;/span&gt;: &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm12&lt;/span&gt;: &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm13&lt;/span&gt;: &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm14&lt;/span&gt;: &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm15&lt;/span&gt;: &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stack_start&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stack_end&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;blockquote&gt; è¯·æ³¨æ„ï¼Œæˆ‘ä»¬åœ¨æ‰€æœ‰Windowsç‰¹å®šçš„å‡½æ•°å’Œç»“æ„ä¸Šéƒ½ä½¿ç”¨äº† &lt;code&gt;#[cfg(target_os=&amp;#34;windows&amp;#34;)]&lt;/code&gt; å±æ€§ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬éœ€è¦ä¸ºæœ€åˆçš„ç»“æ„ä½“å®šä¹‰å¢åŠ ä¸€ä¸ªå±æ€§ï¼Œä»¥ç¡®ä¿èƒ½åœ¨æ‰€æœ‰å…¶å®ƒé Windows å¹³å°ä¸Šç¼–è¯‘ï¼š&lt;code&gt;#[cfg(not(target_os=&amp;#34;windows&amp;#34;))]&lt;/code&gt;ã€‚&lt;br/&gt; &lt;/blockquote&gt;&lt;p&gt;æˆ‘å°†å­—æ®µå‘½åä¸º &lt;code&gt;stack_start&lt;/code&gt; å’Œ &lt;code&gt;stack_end&lt;/code&gt;ï¼Œå› ä¸ºæˆ‘å‘ç°è¿™æ ·æ›´å®¹æ˜“è‚‰çœ¼è§£æï¼Œæˆ‘ä»¬éƒ½çŸ¥é“æ ˆä»é¡¶éƒ¨å¼€å§‹ï¼Œç„¶åå‘ä¸‹æ‰©å±•åˆ°åº•éƒ¨ã€‚&lt;/p&gt;&lt;h3&gt;Windows æ ˆ&lt;/h3&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-f16d5530d9159e841ad9b7db06ed9d1f_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;479&quot; data-rawheight=&quot;441&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;479&quot; data-original=&quot;https://pic4.zhimg.com/v2-f16d5530d9159e841ad9b7db06ed9d1f_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-f16d5530d9159e841ad9b7db06ed9d1f_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;479&quot; data-rawheight=&quot;441&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;479&quot; data-original=&quot;https://pic4.zhimg.com/v2-f16d5530d9159e841ad9b7db06ed9d1f_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-f16d5530d9159e841ad9b7db06ed9d1f_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;å› ä¸º Rust ä¸ºæˆ‘ä»¬è®¾ç½®å¥½äº†æ ˆå¸§ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦å…³å¿ƒå°† &lt;code&gt;%rsp&lt;/code&gt; å’Œè¿”å›åœ°å€æ”¾åœ¨å“ªé‡Œï¼Œè¿™ä¸ psABI ä¸­çš„å†…å®¹å‡ ä¹ç›¸åŒã€‚Win64 å’Œ psABI åœ¨å…¶å®ƒæ–¹é¢è¿˜å­˜åœ¨å·®å¼‚ï¼Œè€Œ Rust ä¸ºæˆ‘ä»¬è§£å†³äº†ç›®å‰æ‰€æœ‰å·®å¼‚ã€‚&lt;/p&gt;&lt;p&gt;ç°åœ¨è¦ç»§ç»­å®ç°æˆ‘ä»¬çš„ä»£ç ï¼Œå°±éœ€è¦å¯¹ &lt;code&gt;spawn()&lt;/code&gt; å‡½æ•°è¿›è¡Œæ›´æ”¹ï¼Œæ¥çœŸæ­£æä¾›è¿™äº›æ–°å¢ä¿¡æ¯å¹¶è®¾ç½®æˆ‘ä»¬çš„æ ˆã€‚&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-rust&quot;&gt;&lt;span class=&quot;cp&quot;&gt;#[cfg(target_os = &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;windows&amp;#34;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;)]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;pub&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;spawn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;: &lt;span class=&quot;nc&quot;&gt;fn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;available&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;threads&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iter_mut&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;find&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;State&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;Available&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;expect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;no available thread.&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;available&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stack&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_ptr&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;available&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stack&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;as_mut_ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// å‚è€ƒ: https://docs.microsoft.com/en-us/cpp/build/stack-usage?view=vs-2019#stack-allocation
&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;unsafe&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ptr&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;offset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;24&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;isize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;guard&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ptr&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;offset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;isize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;available&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ctx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rsp&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;offset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;isize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;available&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ctx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stack_start&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;offset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;isize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;available&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ctx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stack_end&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_ptr&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;const&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;available&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;State&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;Ready&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¦‚ä½ æ‰€è§ï¼Œæˆ‘ä»¬æä¾›äº†æŒ‡å‘æ ˆå¼€å§‹çš„æŒ‡é’ˆå’ŒæŒ‡å‘æ ˆç»“æŸçš„æŒ‡é’ˆã€‚&lt;/p&gt;&lt;h3&gt;å¯èƒ½çš„å¯¹é½é—®é¢˜&lt;/h3&gt;&lt;p&gt;å¥½çš„ï¼Œè¿™éƒ¨åˆ†åº”è¯¥å¾ˆéš¾ï¼Œè¿˜è®°å¾—å—ï¼ŸWindows ä»ä¸ä¼šæŠŠäº‹æƒ…å˜å¾—å¤ªç®€å•æ¥è®©æˆ‘ä»¬æ„Ÿåˆ°å¤±æœ›ã€‚ä½ ä¼šçœ‹åˆ°ï¼Œå½“æˆ‘ä»¬ä» 128 ä½å¯„å­˜å™¨ä¸­ç§»å‡ºæ•°æ®æ—¶ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ä¸€äº›ç‰¹æ®Šçš„æ±‡ç¼–æŒ‡ä»¤ã€‚å…¶ä¸­æœ‰å‡ ä¸ª &lt;i&gt;å¤§å¤šæ•°&lt;/i&gt; éƒ½åœ¨åšåŒæ ·çš„äº‹ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;code&gt;movdqa&lt;/code&gt; &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//www.felixcloutier.com/x86/movdqa%3Avmovdqa32%3Avmovdqa64&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;move double quad word aligned&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;code&gt;movdqu&lt;/code&gt; &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//www.felixcloutier.com/x86/movdqu%3Avmovdqu8%3Avmovdqu16%3Avmovdqu32%3Avmovdqu64&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;move double quad word unaligned&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;code&gt;movaps&lt;/code&gt; &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//www.felixcloutier.com/x86/movaps&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;move aligned packed single-precision floating point value&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;code&gt;movups&lt;/code&gt; &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//www.felixcloutier.com/x86/movups&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;move unaligned packed single-precision floating point value&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;å¦‚ä½ æ‰€è§ï¼Œå¤§å¤šæ•°æ–¹æ³•éƒ½æœ‰ &lt;code&gt;aligned&lt;/code&gt; å’Œ &lt;code&gt;unaligned&lt;/code&gt; å˜ä½“ã€‚ åŒºåˆ«åœ¨äºï¼Œ&lt;code&gt;*ps&lt;/code&gt; ç±»å‹çš„æŒ‡ä»¤é’ˆå¯¹æµ®ç‚¹å€¼ï¼Œè€Œ &lt;code&gt;*dq/*dq&lt;/code&gt; ç±»å‹çš„æŒ‡ä»¤é’ˆå¯¹æ•´æ•°ã€‚ ç°åœ¨ä¸¤è€…éƒ½å¯ä»¥ä½¿ç”¨ï¼Œä½†æ˜¯å¦‚æœä½ å•å‡» Microsoft çš„å‚è€ƒèµ„æ–™ï¼Œä½ å¯èƒ½ä¼šæ³¨æ„åˆ° &lt;code&gt;XMM&lt;/code&gt; ç”¨äºæµ®ç‚¹å€¼ï¼Œå› æ­¤ &lt;code&gt;*ps&lt;/code&gt; ç±»å‹çš„æŒ‡ä»¤æ˜¯æˆ‘ä»¬åº”è¯¥ä½¿ç”¨çš„æ­£ç¡®æŒ‡ä»¤ã€‚&lt;/p&gt;&lt;p&gt;ä»å†å²ä¸Šçœ‹ï¼Œ&lt;code&gt;aligned&lt;/code&gt; ç‰ˆæœ¬åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹è¦å¿«ä¸€äº›ï¼Œå› æ­¤åœ¨ä¸Šä¸‹æ–‡åˆ‡æ¢ä¸­ä¼šä¼˜å…ˆä½¿ç”¨ã€‚ä½†æ˜¯ï¼Œæ®æˆ‘äº†è§£çš„æœ€æ–°ä¿¡æ¯æ˜¯ï¼Œ&lt;b&gt;åœ¨æ€§èƒ½æ–¹é¢ï¼Œå®ƒä»¬åœ¨æœ€è¿‘çš„ 6 ä»£ CPU é‡Œå®é™…ä¸Šéƒ½æ˜¯ä¸€æ ·çš„&lt;/b&gt;ã€‚&lt;/p&gt;&lt;blockquote&gt; å¦‚æœä½ æƒ³äº†è§£æœ‰å…³æ–°æ—§å¤„ç†å™¨ä¸Šä¸åŒæŒ‡ä»¤æˆæœ¬çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//www.agner.org/optimize/instruction_tables.pdf&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Agner Fog çš„æŒ‡ä»¤è¡¨&lt;/a&gt;ã€‚&lt;br/&gt; &lt;/blockquote&gt;&lt;p&gt;ä½†æ˜¯ï¼Œç”±äºåœ¨æˆ‘é‡åˆ°çš„æ‰€æœ‰å‚è€ƒå®ç°ä¸­éƒ½ä½¿ç”¨äº†å¯¹é½çš„æŒ‡ä»¤ï¼Œå› æ­¤å°½ç®¡å®ƒä»¬ç»™æˆ‘ä»¬æš´éœ²äº†ä¸€äº›é¢å¤–çš„å¤æ‚æ€§ï¼Œæˆ‘ä»¬è¿˜æ˜¯ä¼šä½¿ç”¨å®ƒä»¬ï¼Œæˆ‘ä»¬ä¹Ÿå­¦åˆ°ä¸œè¥¿äº†ï¼Œä¸æ˜¯å—ï¼Ÿ&lt;/p&gt;&lt;p&gt;ä½¿ç”¨å¯¹é½æŒ‡ä»¤ï¼Œæ˜¯æŒ‡å®ƒä»¬è¯»å†™çš„å†…å­˜æ˜¯ 16 å­—èŠ‚å¯¹é½çš„ã€‚&lt;/p&gt;&lt;p&gt;ç°åœ¨ï¼Œæˆ‘è§£å†³æ­¤é—®é¢˜çš„æ–¹æ³•æ˜¯å°†éœ€è¦å¯¹é½çš„å­—æ®µæ¨é€åˆ°ç»“æ„çš„å¼€å¤´ï¼Œå¹¶æ·»åŠ æ–°å±æ€§ &lt;code&gt;#[repr(align(16))]&lt;/code&gt;ã€‚&lt;/p&gt;&lt;blockquote&gt;&lt;code&gt;#[repr(align(16))]&lt;/code&gt; å±æ€§ç¡®ä¿æˆ‘ä»¬çš„ç»“æ„ä»¥ 16 å­—èŠ‚å¯¹é½çš„å†…å­˜åœ°å€å¼€å§‹ï¼Œå› æ­¤å½“æˆ‘ä»¬åœ¨æ±‡ç¼–ä»£ç ä¸€å¼€å§‹å†™ &lt;code&gt;XMM6&lt;/code&gt; å¯„å­˜å™¨æ—¶ï¼Œå®ƒå·²ç»æ˜¯ 16 å­—èŠ‚å¯¹é½çš„ï¼Œå¹¶ä¸”ç”±äº 128 è¢« 16 æ•´é™¤ï¼Œå…¶ä½™çš„å­—æ®µä¹Ÿæ˜¯å¦‚æ­¤ã€‚ ä½†æ˜¯ï¼ˆè¿™å¯èƒ½å¾ˆé‡è¦ï¼‰ï¼Œå› ä¸ºæˆ‘ä»¬ç°åœ¨æœ‰ä¸¤ç§ä¸åŒå¤§å°çš„å­—æ®µï¼Œæˆ‘ä»¬çš„ç¼–è¯‘å™¨å¯èƒ½ä¼šé€‰æ‹©â€œå¡«å……â€æˆ‘ä»¬çš„å­—æ®µï¼Œä½†ç°åœ¨æš‚æ—¶ä¸ä¼šå‘ç”Ÿè¿™ç§æƒ…å†µï¼Œä½†æ˜¯å°†è¾ƒå¤§çš„å­—æ®µæ”¾åˆ°å‰é¢å°†ä½¿åæœŸå‘ç”Ÿè¿™ç§æƒ…å†µçš„é£é™©é™åˆ°æœ€ä½ã€‚ æˆ‘ä»¬ä¹Ÿè¦é¿å…æ‰‹åŠ¨å°†å¡«å……æˆå‘˜æ·»åŠ åˆ°ç»“æ„ä¸­ï¼Œå› ä¸ºåœ¨ &lt;code&gt;XMM&lt;/code&gt; å­—æ®µä¹‹å‰æœ‰ 7 ä¸ª &lt;code&gt;u64&lt;/code&gt; å­—æ®µå¯ä»¥é˜²æ­¢å®ƒä»¬ä¸ 16 å¯¹é½ï¼ˆè¯·è®°ä½ï¼Œ&lt;code&gt;repr(C)&lt;/code&gt; å±æ€§ç¡®ä¿ç¼–è¯‘å™¨ä¸ä¼šå¯¹æˆ‘ä»¬çš„å­—æ®µè¿›è¡Œé‡æ–°æ’åºï¼‰ã€‚&lt;br/&gt; &lt;/blockquote&gt;&lt;p&gt;ä¿®æ”¹è¿‡åæˆ‘ä»¬çš„ &lt;code&gt;Threadcontext&lt;/code&gt; å°†å˜æˆè¿™æ ·ï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-rust&quot;&gt;&lt;span class=&quot;cp&quot;&gt;#[cfg(target_os = &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;windows&amp;#34;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;)]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;#[derive(Debug, Default)]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;#[repr(C)]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;#[repr(align(16))]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ThreadContext&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm6&lt;/span&gt;: &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm7&lt;/span&gt;: &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm8&lt;/span&gt;: &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm9&lt;/span&gt;: &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm10&lt;/span&gt;: &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm11&lt;/span&gt;: &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm12&lt;/span&gt;: &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm13&lt;/span&gt;: &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm14&lt;/span&gt;: &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm15&lt;/span&gt;: &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rsp&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r15&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r14&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r13&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r12&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rbx&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rbp&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rdi&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rsi&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stack_start&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stack_end&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æœ€åæˆ‘ä»¬éœ€è¦ä¿®æ”¹ &lt;code&gt;switch()&lt;/code&gt; å‡½æ•°å¹¶æ›´æ–°æˆ‘ä»¬çš„æ±‡ç¼–ä»£ç ã€‚ä¸Šæ–‡å·²ç»è§£é‡Šäº†è¿™ä¹ˆå¤šï¼Œåº”è¯¥å¾ˆç®€å•äº†ï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-rust&quot;&gt;&lt;span class=&quot;cp&quot;&gt;#[cfg(target_os = &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;windows&amp;#34;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;)]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;#[naked]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;#[inline(never)]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;unsafe&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;switch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;old&lt;/span&gt;: &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ThreadContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new&lt;/span&gt;: &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;const&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ThreadContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;asm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;movaps&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x00&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;movaps&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;movaps&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;movaps&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;movaps&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x40&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;movaps&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm11&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x50&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;movaps&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm12&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x60&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;movaps&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm13&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x70&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;movaps&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm14&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x80&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;movaps&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x90&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;         &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rsp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xa0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;         &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xa8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;         &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r14&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xb0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;         &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r13&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xb8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;         &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r12&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xc0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;         &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rbx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xc8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;         &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rbp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xd0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;         &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rdi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xd8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;         &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rsi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xe0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;         &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gs&lt;/span&gt;:&lt;span class=&quot;mh&quot;&gt;0x08&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rax&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;         &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xe8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;  
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;         &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gs&lt;/span&gt;:&lt;span class=&quot;mh&quot;&gt;0x10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rax&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;         &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xf0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;  
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;movaps&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x00&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm6&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;movaps&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm7&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;movaps&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm8&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;movaps&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm9&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;movaps&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x40&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm10&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;movaps&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x50&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm11&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;movaps&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x60&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm12&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;movaps&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x70&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm13&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;movaps&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x80&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm14&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;movaps&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x90&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm15&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;         &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xa0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rsp&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;         &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xa8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r15&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;         &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xb0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r14&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;         &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xb8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r13&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;         &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xc0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r12&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;         &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xc8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rbx&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;         &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xd0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rbp&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;         &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xd8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rdi&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;         &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xe0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rsi&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;         &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xe8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rax&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;         &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gs&lt;/span&gt;:&lt;span class=&quot;mh&quot;&gt;0x08&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;  
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;         &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xf0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rax&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; 
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;         &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gs&lt;/span&gt;:&lt;span class=&quot;mh&quot;&gt;0x10&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;  
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ret&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;:
    :&lt;span class=&quot;s&quot;&gt;&amp;#34;r&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;old&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;r&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;:
    : &lt;span class=&quot;s&quot;&gt;&amp;#34;volatile&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;alignstack&amp;#34;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¦‚ä½ æ‰€è§ï¼Œæˆ‘ä»¬çš„ä»£ç å˜å¾—æ›´é•¿äº†ä¸€äº›ã€‚ä¸€æ—¦ç¡®å®šäº†å­˜å‚¨ä½ç½®å°±å¾ˆç®€å•ï¼Œä½†æ˜¯å®ƒç¡®å®å¢åŠ äº†å¾ˆå¤šä»£ç ã€‚&lt;/p&gt;&lt;blockquote&gt; æˆ‘ä»¬çš„å†…è”æ±‡ç¼–ç¨‹åºä¸å…è®¸æˆ‘ä»¬ä»ä¸€ä¸ªå†…å­˜åç§»é‡ &lt;code&gt;mov&lt;/code&gt; åˆ°å¦ä¸€ä¸ªå†…å­˜åç§»é‡ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ç»ç”±ä¸€ä¸ªå¯„å­˜å™¨æ¥å®ç°ã€‚æˆ‘é€‰æ‹©äº† &lt;code&gt;rax&lt;/code&gt; å¯„å­˜å™¨ï¼ˆè¿”å›å€¼çš„é»˜è®¤å¯„å­˜å™¨ï¼‰ï¼Œä½†ä½ å¯ä»¥ä¸ºæ­¤é€‰æ‹©ä»»ä½•é€šç”¨çš„å¯„å­˜å™¨ã€‚&lt;br/&gt; &lt;/blockquote&gt;&lt;h3&gt;ç»“è®º&lt;/h3&gt;&lt;p&gt;æ‰€ä»¥è¿™å°±æ˜¯æˆ‘ä»¬éœ€è¦åšçš„ã€‚å¦‚ä½ æ‰€è§ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œå®é™…ä¸Šå¹¶æ²¡æœ‰åšä»»ä½•æ–°çš„äº‹æƒ…ï¼Œå›°éš¾çš„éƒ¨åˆ†æ˜¯å¼„æ¸…æ¥šWindows çš„å·¥ä½œæ–¹å¼ä»¥åŠå®ƒæœŸæœ›ä½ åšçš„äº‹ï¼Œä¸è¿‡æˆ‘ä»¬å·²ç»æ­£ç¡®å®Œæˆäº†æ”¯æŒ Windows çš„å·¥ä½œï¼Œæˆ‘ä»¬åº”è¯¥ä¸ºæ‰€æœ‰ä¸‰ä¸ªå¹³å°éƒ½æä¾›äº†ç›¸å½“å®Œæ•´çš„ä¸Šä¸‹æ–‡åˆ‡æ¢çš„å®ç°ã€‚&lt;/p&gt;&lt;h3&gt;æœ€ç»ˆçš„ä»£ç &lt;/h3&gt;&lt;p&gt;åœ¨æœ€åæˆ‘åˆå¹¶äº†æˆ‘ä»¬éœ€è¦é’ˆå¯¹ Windows è¿›è¡Œä¸åŒç¼–è¯‘çš„æ‰€æœ‰ä»£ç ï¼Œå› æ­¤ä½ ä¸å¿…é˜…è¯»å‰ 200 è¡Œä»£ç ï¼Œå› ä¸ºä¸å‰å‡ ç« çš„å†…å®¹ç›¸åŒã€‚æˆ‘å¸Œæœ›ä½ èƒ½ç†è§£ä¸ºä»€ä¹ˆæˆ‘é€‰æ‹©ä¸ºæ­¤å•ç‹¬å†™ä¸€ç« ã€‚&lt;/p&gt;&lt;blockquote&gt; ä½ ä¹Ÿå¯ä»¥åœ¨&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/cfsamson/example-greenthreads/tree/windows&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;è¿™ä¸ªä»“åº“çš„Windowsåˆ†æ”¯&lt;/a&gt;æ‰¾åˆ°è¿™ä»½ä»£ç .&lt;br/&gt; &lt;/blockquote&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-rust&quot;&gt;&lt;span class=&quot;cp&quot;&gt;#![feature(asm)]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;#![feature(naked_functions)]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;use&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;const&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DEFAULT_STACK_SIZE&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;usize&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;const&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MAX_THREADS&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;usize&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;static&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RUNTIME&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;usize&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;pub&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Runtime&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;threads&lt;/span&gt;: &lt;span class=&quot;nb&quot;&gt;Vec&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;current&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;usize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;#[derive(PartialEq, Eq, Debug)]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;enum&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;State&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Available&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Running&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Ready&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;usize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stack&lt;/span&gt;: &lt;span class=&quot;nb&quot;&gt;Vec&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u8&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ctx&lt;/span&gt;: &lt;span class=&quot;nc&quot;&gt;ThreadContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;: &lt;span class=&quot;nc&quot;&gt;State&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;#[cfg(not(target_os = &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;windows&amp;#34;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;))]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;#[derive(Debug, Default)]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;#[repr(C)]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ThreadContext&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rsp&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r15&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r14&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r13&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r12&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rbx&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rbp&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;impl&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;usize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&quot;nc&quot;&gt;Self&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stack&lt;/span&gt;: &lt;span class=&quot;nc&quot;&gt;vec&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0_&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;u8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DEFAULT_STACK_SIZE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ctx&lt;/span&gt;: &lt;span class=&quot;nc&quot;&gt;ThreadContext&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;default&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;: &lt;span class=&quot;nc&quot;&gt;State&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;Available&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;impl&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Runtime&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;pub&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&quot;nc&quot;&gt;Self&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;base_thread&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;: &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stack&lt;/span&gt;: &lt;span class=&quot;nc&quot;&gt;vec&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0_&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;u8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DEFAULT_STACK_SIZE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ctx&lt;/span&gt;: &lt;span class=&quot;nc&quot;&gt;ThreadContext&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;default&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;: &lt;span class=&quot;nc&quot;&gt;State&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;Running&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;threads&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vec&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;base_thread&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;available_threads&lt;/span&gt;: &lt;span class=&quot;nb&quot;&gt;Vec&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;..&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MAX_THREADS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Thread&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;collect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;threads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;available_threads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Runtime&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;threads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;current&lt;/span&gt;: &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;pub&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;unsafe&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r_ptr&lt;/span&gt;: &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;const&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Runtime&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RUNTIME&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r_ptr&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;usize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;pub&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;while&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_yield&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;process&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;exit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;t_return&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;current&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;threads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;current&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;State&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;Available&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_yield&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;t_yield&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&quot;kt&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;current&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;while&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;threads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;State&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;Ready&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;threads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;current&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;threads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;current&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;State&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;Available&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;threads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;current&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;State&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;Ready&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;threads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;State&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;Running&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;old_pos&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;current&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;current&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;unsafe&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;switch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;threads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;old_pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ctx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;threads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ctx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// preventing compiler optimizing our code away on windows. Will never be reached anyway.
&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;threads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;#[cfg(not(target_os = &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;windows&amp;#34;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;))]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;pub&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;spawn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;: &lt;span class=&quot;nc&quot;&gt;fn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;available&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;threads&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iter_mut&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;find&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;State&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;Available&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;expect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;no available thread.&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;available&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stack&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_ptr&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;available&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stack&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;as_mut_ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;unsafe&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ptr&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;offset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;24&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;isize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;guard&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ptr&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;offset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;isize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;available&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ctx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rsp&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;offset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;isize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;available&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;State&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;Ready&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;guard&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;unsafe&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rt_ptr&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RUNTIME&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Runtime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rt_ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_return&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;pub&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;yield_thread&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;unsafe&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rt_ptr&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RUNTIME&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Runtime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rt_ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_yield&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;#[cfg(not(target_os = &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;windows&amp;#34;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;))]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;#[naked]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;#[inline(never)]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;unsafe&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;switch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;old&lt;/span&gt;: &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ThreadContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new&lt;/span&gt;: &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;const&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ThreadContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;asm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rsp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x00&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x08&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r14&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r13&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x18&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r12&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rbx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x28&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rbp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x00&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rsp&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x08&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r15&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r14&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x18&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r13&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r12&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x28&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rbx&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rbp&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ret&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;:
    :&lt;span class=&quot;s&quot;&gt;&amp;#34;r&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;old&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;r&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;:
    : &lt;span class=&quot;s&quot;&gt;&amp;#34;volatile&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;alignstack&amp;#34;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;runtime&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Runtime&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;runtime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;runtime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;spawn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;THREAD 1 STARTING&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;in&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;..&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;thread: {} counter: {}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;yield_thread&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;THREAD 1 FINISHED&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;runtime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;spawn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;THREAD 2 STARTING&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;in&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;..&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;thread: {} counter: {}&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;yield_thread&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;THREAD 2 FINISHED&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;runtime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// ===== WINDOWS SUPPORT =====
&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;#[cfg(target_os = &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;windows&amp;#34;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;)]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;#[derive(Debug, Default)]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;#[repr(C)]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ThreadContext&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm6&lt;/span&gt;: &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm7&lt;/span&gt;: &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm8&lt;/span&gt;: &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm9&lt;/span&gt;: &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm10&lt;/span&gt;: &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm11&lt;/span&gt;: &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm12&lt;/span&gt;: &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm13&lt;/span&gt;: &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm14&lt;/span&gt;: &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm15&lt;/span&gt;: &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rsp&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r15&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r14&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r13&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r12&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rbx&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rbp&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rdi&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rsi&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stack_start&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stack_end&lt;/span&gt;: &lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;impl&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Runtime&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;#[cfg(target_os = &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;windows&amp;#34;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;)]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;pub&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;spawn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;: &lt;span class=&quot;nc&quot;&gt;fn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;available&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;threads&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iter_mut&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;find&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;State&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;Available&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;expect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;no available thread.&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;available&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stack&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_ptr&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;available&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stack&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;as_mut_ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// see: https://docs.microsoft.com/en-us/cpp/build/stack-usage?view=vs-2019#stack-allocation
&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;unsafe&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ptr&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;offset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;24&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;isize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;guard&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ptr&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;offset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;isize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;available&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ctx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rsp&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;offset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;isize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;available&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ctx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stack_start&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;offset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;isize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;available&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ctx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stack_end&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_ptr&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;const&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;available&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;State&lt;/span&gt;::&lt;span class=&quot;n&quot;&gt;Ready&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// reference: https://probablydance.com/2013/02/20/handmade-coroutines-for-windows/
&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// Contents of TIB on Windows: https://en.wikipedia.org/wiki/Win32_Thread_Information_Block
&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;#[cfg(target_os = &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;windows&amp;#34;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;)]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;#[naked]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;#[inline(never)]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;unsafe&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;switch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;old&lt;/span&gt;: &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ThreadContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new&lt;/span&gt;: &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;const&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ThreadContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;asm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;movaps&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x00&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;movaps&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;movaps&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;movaps&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;movaps&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x40&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;movaps&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm11&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x50&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;movaps&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm12&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x60&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;movaps&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm13&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x70&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;movaps&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm14&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x80&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;movaps&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x90&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;         &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rsp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xa0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;         &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xa8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;         &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r14&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xb0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;         &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r13&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xb8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;         &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r12&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xc0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;         &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rbx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xc8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;         &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rbp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xd0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;         &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rdi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xd8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;         &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rsi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xe0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;         &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gs&lt;/span&gt;:&lt;span class=&quot;mh&quot;&gt;0x08&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rax&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;         &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xe8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;  
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;         &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gs&lt;/span&gt;:&lt;span class=&quot;mh&quot;&gt;0x10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rax&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;         &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xf0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;  
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;movaps&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x00&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm6&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;movaps&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm7&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;movaps&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm8&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;movaps&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm9&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;movaps&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x40&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm10&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;movaps&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x50&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm11&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;movaps&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x60&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm12&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;movaps&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x70&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm13&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;movaps&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x80&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm14&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;movaps&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x90&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xmm15&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;         &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xa0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rsp&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;         &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xa8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r15&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;         &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xb0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r14&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;         &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xb8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r13&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;         &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xc0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r12&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;         &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xc8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rbx&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;         &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xd0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rbp&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;         &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xd8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rdi&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;         &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xe0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rsi&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;         &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xe8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rax&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;         &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gs&lt;/span&gt;:&lt;span class=&quot;mh&quot;&gt;0x08&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;  
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;         &lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xf0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rax&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; 
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;         &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gs&lt;/span&gt;:&lt;span class=&quot;mh&quot;&gt;0x10&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;  
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ret&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;:
    :&lt;span class=&quot;s&quot;&gt;&amp;#34;r&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;old&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;r&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;:
    : &lt;span class=&quot;s&quot;&gt;&amp;#34;volatile&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#34;alignstack&amp;#34;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>ä¸æ˜è§‰ç–¼</author>
<guid isPermaLink="false">2020-01-05-101168659</guid>
<pubDate>Sun, 05 Jan 2020 00:00:00 +0800</pubDate>
</item>
</channel>
</rss>
