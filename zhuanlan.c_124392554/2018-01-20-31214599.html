<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>波利亚的果园（Polya&#39;s Orchard problem）</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/31214599">原文</a></p>
<div class="title-image"><img src="https://pic3.zhimg.com/v2-ddb27cbd816bdc45d90f483b76035690_r.jpg" alt=""></div><p>这篇主要是转述，因为我<b>非常喜欢</b>这个有趣的题目，而某度“大搜”——</p><img src="https://pic4.zhimg.com/v2-14e816750e4ff5f1f8a6370e081516b6_r.jpg" data-caption="" data-size="normal" data-rawwidth="769" data-rawheight="888"><p>根本搜不到这么有名有趣的问题。言归正传——</p><hr><p>1918年，波利亚（George Polya，1887-1985）介绍了下面这个问题：</p><p>在一个半径为整数 <equation>S</equation> 的圆形的果园中（不妨设果园的中心是原点 <equation>(0,0)</equation> ）。</p><img src="https://pic2.zhimg.com/v2-db09b79f63e4f5f1276f853786c9ab4c_r.jpg" data-caption="" data-size="normal" data-rawwidth="400" data-rawheight="410"><p>在果园内部除了中心点的每个整点（就是横纵坐标都是整数）种植果树（举个小规模的例子）。</p><img src="https://pic2.zhimg.com/v2-4de2eade737f86cfc0783b00739ee975_r.jpg" data-caption="" data-size="normal" data-rawwidth="396" data-rawheight="395"><p>假设所有这些果树都是半径相同的完美圆柱体。</p><p>问题是：果树的树干长到多粗时，才能完全遮住果园中心的视线？——也就是说站在果园的中心点，无论朝哪个方向看，都无法看到果园的边缘。（例如下左图不可以完全遮挡，而下右图可以完全遮挡）</p><img src="https://pic2.zhimg.com/v2-686eac529b0df68aae40b51a13ffc3ef_r.jpg" data-caption="" data-size="normal" data-rawwidth="926" data-rawheight="410"><p>设果树半径为 <equation>r</equation> ，问题就是要确定一个实数 <equation>\rho</equation> ，使得</p><ul><li>当 <equation>r\geq\rho</equation> 时，在果园中心无论朝哪个方向看，都只能看到果树；</li><li>而当 <equation>0&lt;r&lt;\rho</equation> 时，至少存在从果园中心发出的一条射线可以穿出果园而不被果树挡住。</li></ul><p>首先如果果树的半径长到 <equation>1/2</equation> ，那么一定可以全部遮挡（这就不用画图了吧），所以这样的 <equation>\rho</equation> 一定存在。</p><hr><p>Polya证明了 <equation>\frac{1}{\sqrt{S^2+1}}\leq\rho&lt;\frac{1}{S}</equation> ：</p><p><b>㊀ </b>如果在联结 <equation>(0,0)</equation> 和整点 <equation>(p,q)</equation> 的线段上没有其它的整点，则称整点 <equation>(p,q)</equation> 是<b>本原格点</b>。</p><p>例如下图中， <equation>(6,5)</equation> 是本原格点，而 <equation>(6,3)</equation> 和 <equation>(6,4)</equation> 不是本原格点。</p><img src="https://pic3.zhimg.com/v2-dae6d1ac85c75bfebee43a44ef3a2528_r.jpg" data-caption="" data-size="normal" data-rawwidth="484" data-rawheight="377"><p>显然有：格点 <equation>(p,q)</equation> 是本原的当且仅当 <equation>p,q</equation> <b>互素</b>。</p><p><b>㊁ </b>若 <equation>pv-qu=1</equation>，则格点 <equation>(p,q)</equation> 和 <equation>(u,v)</equation> 都是本原的 （由裴蜀等式（见<a href="https://zhuanlan.zhihu.com/p/32504576">凑邮资问题</a>）易知），且它们由一个面积为1的平行四边形相连，这个平行四边形的另外两个顶点是 <equation>(0,0)</equation> 和 <equation>(p+u,q+v)</equation> 。——这是由于 <equation>\left| \begin{matrix} p &amp; u \\ q &amp; v \end{matrix} \right|=1</equation> （可参看<a href="https://zhuanlan.zhihu.com/p/30443024">行列式就是体积/面积？——（一）</a>）。</p><p>这时称 <equation>(u,v)</equation> 是 <equation>(p,q)</equation> 的<b>左邻点</b>（可以看作逆时针）， <equation>(p,q)</equation> 是 <equation>(u,v)</equation>  的<b>右邻点</b>（可以看作顺时针），称<equation>(0,0)</equation> 到 <equation>(p+u,q+v)</equation> 的线段为这个<b>平行四边形的对角线</b>。</p><p>例如下图中<equation>(3,2)</equation> 是 <equation>(2,1)</equation> 的左邻点， <equation>(2,1)</equation> 是 <equation>(3,2)</equation>  的右邻点。</p><img src="https://pic1.zhimg.com/v2-fee16f0ba048bca2ce15d83ec04d5d81_r.jpg" data-caption="" data-size="normal" data-rawwidth="420" data-rawheight="274"><p>下图中 <equation>(1,1)</equation> 、 <equation>(5,3)</equation> 、 <equation>(7,4)</equation> 也都是 <equation>(2,1)</equation> 的左邻点，它们和 <equation>(3,2)</equation> 都在同一条直线上。</p><img src="https://pic4.zhimg.com/v2-d66d50bd0a5b0bf54dbecabbcffef81f_r.jpg" data-caption="" data-size="normal" data-rawwidth="538" data-rawheight="326"><p>下图中<equation>(4,3)</equation> 是 <equation>(3,2)</equation> 的左邻点， <equation>(3,2)</equation> 是 <equation>(4,3)</equation>  的右邻点。</p><img src="https://pic3.zhimg.com/v2-ce033aacaab391a5f68b158f181e86b6_r.jpg" data-caption="" data-size="normal" data-rawwidth="538" data-rawheight="377"><p>如果 <equation>(p,q)</equation> 和 <equation>(u,v)</equation> 的相连平行四边形的对角线长为 <equation>d</equation> ，则 <equation>(p,q)</equation> 和 <equation>(u,v)</equation> 到对角线的距离都是为 <equation>1/d</equation> （由面积为1立得）。</p><p>每个本原格点 <equation>(p,q)</equation> 都有无穷多个左邻点，它们均匀地分布在一条直线上：</p><ul><li>由 <equation>p,q</equation> 互素可知存在 <equation>(u,v)</equation> ，使得 <equation>pv-qu=1</equation> ；</li><li><equation>(u',v')</equation> 满足 <equation>pv'-qu'=1</equation> 当且仅当 <equation>u'=u+kp</equation> ， <equation>v'=v+kq</equation> ，其中 <equation>k</equation> 是某个整数；</li><li>所以<equation>(p,q)</equation> 的无穷多个左邻点都在直线 <equation>qx-py+1=0</equation> 上；</li><li>相邻的两个左邻点之间的距离为 <equation>\sqrt{p^2+q^2}</equation> 。</li></ul><p>（可参看<a href="https://zhuanlan.zhihu.com/p/32504576">凑邮资问题</a>中裴蜀等式的讨论）</p><p><b>㊂ </b><equation>(1,0)</equation> 和 <equation>(S-1,1)</equation> 是相邻的，它们的平行四边形的对角线长度为 <equation>\sqrt{S^2+1}</equation> ，距离<equation>(0,0)</equation> 到 <equation>(S,1)</equation> 的线段的最近的两个整点就是 <equation>(1,0)</equation> 和 <equation>(S-1,1)</equation>，它们到这条线段的距离都是 <equation>\frac{1}{\sqrt{S^2+1}}</equation> ，因此就可以得到要达到遮挡效果，就必须有 <equation>\rho\geq\frac{1}{\sqrt{S^2+1}}</equation> 。</p><img src="https://pic1.zhimg.com/v2-bb48ad0cdcc15651d0ad5b85296e19d6_r.jpg" data-caption="" data-size="normal" data-rawwidth="592" data-rawheight="225"><p><b>㊃</b> 对 <equation>x^2+y^2\leq S^2</equation> 内的任意本原格点 <equation>(p_1,q_1)</equation> ，假设 <equation>(p_2,q_2)</equation> 是它在该圆内<b>最远的左邻点</b>——即 <equation>(p_2+p_1,q_2+q_1)</equation> 已经在圆 <equation>x^2+y^2\leq S^2</equation> 之外。</p><p>例如 <equation>S=4</equation> 时， <equation>(2,1)</equation> 在圆内的最远左邻点是 <equation>(3,2)</equation> 。</p><img src="https://pic3.zhimg.com/v2-4f6d522e30f2f55b7309466472eed4a5_r.jpg" data-caption="" data-size="normal" data-rawwidth="539" data-rawheight="326"><p>那么 <equation>(p_1,q_1)</equation> 和 <equation>(p_2,q_2)</equation> 的相连平行四边形的对角线长为 <equation>\sqrt{(p_2+p_1)^2+(q_2+q_1)^2}</equation> ，由于 <equation>(p_2+p_1,q_2+q_1)</equation> 已经在圆 <equation>x^2+y^2\leq S^2</equation> 之外，因此对角线长大于 <equation>S</equation> 。</p><p>同样地，设 <equation>(p_3,q_3)</equation> 是 <equation>(p_2,q_2)</equation> 在圆内的最远左邻点，设 <equation>(p_4,q_4)</equation>是 <equation>(p_3,q_3)</equation> 的最远的左邻点，等等。</p><p>于是得到 <equation>(p_1,q_1)</equation> 和 <equation>(p_2,q_2)</equation> 的相连平行四边形、 <equation>(p_2,q_2)</equation> 和 <equation>(p_3,q_3)</equation> 的相连平行四边形、……、 <equation>(p_i,q_i)</equation> 和 <equation>(p_{i+1},q_{i+1})</equation> 的相连平行四边形、……等等，每个平行四边形的对角线长都大于 <equation>S</equation> ，所以每个平行四边形的两个相邻格点到对角线的距离都小于 <equation>1/S</equation> 。</p><img src="https://pic3.zhimg.com/v2-373230e91def5329ed47087b4c204c05_r.jpg" data-caption="" data-size="normal" data-rawwidth="568" data-rawheight="568"><p>那么一定会存在某个正整数 <equation>n</equation> 使得：<equation>(p_1,q_1)</equation> 和 <equation>(p_2,q_2)</equation> 的相连平行四边形、 <equation>(p_2,q_2)</equation> 和 <equation>(p_3,q_3)</equation> 的相连平行四边形、……、 <equation>(p_n,q_n)</equation> 和 <equation>(p_{n+1},q_{n+1})</equation> 的相连平行四边形在一起<b>完全覆盖</b>了单位圆 <equation>x^2+y^2\leq 1</equation> 。</p><img src="https://pic2.zhimg.com/v2-026a9ddc942ea6ed25f97dc53e9e2765_r.jpg" data-caption="" data-size="normal" data-rawwidth="1203" data-rawheight="568"><p>那么每一条从 <equation>(0,0)</equation> 发出的射线都在某一个<equation>(p_i,q_i)</equation> 和 <equation>(p_{i+1},q_{i+1})</equation> 的相连平行四边形内部，而这条射线一定被以 <equation>(p_i,q_i)</equation> 为圆心 <equation>1/S</equation> 为半径的圆挡住或者被以 <equation>(p_{i+1},q_{i+1})</equation> 为圆心 <equation>1/S</equation> 为半径的圆挡住。</p><img src="https://pic4.zhimg.com/v2-fb8b8a33e739bb5c2f3a9e70f0bbaf8d_r.jpg" data-caption="" data-size="normal" data-rawwidth="509" data-rawheight="355"><p>所以有 <equation>\rho&lt;\frac{1}{S}</equation> 。</p><hr><p><br></p><p>最后说一下，T.T.Allen在1986年证明： <equation>\rho=1/\sqrt{\lambda}</equation> ，其中 <equation>\lambda</equation> 是第一个大于 <equation>S^2</equation> 且可以写成两个互素整数平方和的整数。</p><p>详细内容可见论文“Allen T T. <a href="http://xueshu.baidu.com/s?wd=paperuri%3A%28847bd05d5617ee2cef1b68ac142556f2%29&amp;filter=sc_long_sign&amp;tn=SE_xueshusource_2kduw22v&amp;sc_vurl=http%3A%2F%2Fwww.jstor.org%2Fstable%2Finfo%2F2322700&amp;ie=utf-8&amp;sc_us=3421991026701123680">Polya's Orchard Problem</a>[J]. American Mathematical Monthly, 1986(2):98-104.”，或者《邮票·自行车·果园·雨中行》中有该论文的中译。</p>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
