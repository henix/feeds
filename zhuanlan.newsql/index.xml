<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:media="http://search.yahoo.com/mrss/">
<channel>
<title>TiDB çš„åèŠ±å›­</title>
<link>https://henix.github.io/feeds/zhuanlan.newsql/</link>
<description></description>
<language>zh-cn</language>
<lastBuildDate>Fri, 01 Nov 2019 06:52:35 +0800</lastBuildDate>
<item>
<title>TiKV æºç è§£æç³»åˆ—æ–‡ç« ï¼ˆåå››ï¼‰Coprocessor æ¦‚è§ˆ</title>
<link>https://henix.github.io/feeds/zhuanlan.newsql/2019-10-31-89518391.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/89518391&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-20f8a3ce333d33a342041949f11ab72d_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;ä½œè€…ï¼šShirly&lt;/p&gt;&lt;p&gt;æœ¬æ–‡å°†ç®€è¦ä»‹ç» TiKV Coprocessor çš„åŸºæœ¬åŸç†ï¼Œé¢å‘æƒ³è¦äº†è§£ TiKV æ•°æ®è¯»å–æ‰§è¡Œè¿‡ç¨‹çš„åŒå­¦ï¼ŒåŒæ—¶ä¹Ÿé¢å‘æƒ³å¯¹è¯¥æ¨¡å—è´¡çŒ®ä»£ç çš„åŒå­¦ã€‚é˜…è¯»æœ¬æ–‡å‰ï¼Œå»ºè®®è¯»è€…å¯¹ TiDB æ•´ä½“æ¶æ„æœ‰æ‰€äº†è§£ï¼Œå…ˆé˜…è¯»ä¸‰ç¯‡æ–‡ç« äº†è§£ TiDB æŠ€æœ¯å†…å¹•ï¼š&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pingcap.com/blog-cn/tidb-internal-1/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;è¯´å­˜å‚¨&lt;/a&gt;ã€&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pingcap.com/blog-cn/tidb-internal-2/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;è¯´è®¡ç®—&lt;/a&gt;ã€&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pingcap.com/blog-cn/tidb-internal-3/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;è°ˆè°ƒåº¦&lt;/a&gt;ã€‚&lt;/p&gt;&lt;h2&gt;ä»€ä¹ˆæ˜¯ Coprocessor&lt;/h2&gt;&lt;p&gt;ç†Ÿæ‚‰ &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pingcap.com/docs-cn/v3.0/overview/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TiDB æ•´ä½“æ¡†æ¶&lt;/a&gt; çš„åŒå­¦å¯èƒ½è®°å¾—ï¼ŒTiDB æ˜¯æ— çŠ¶æ€çš„ï¼Œæ•°æ®å­˜å‚¨åœ¨ TiKV å±‚ã€‚å½“ TiDB åœ¨æ”¶åˆ°ä¸€ä¸ªæ¥è‡ªå®¢æˆ·ç«¯çš„æŸ¥è¯¢è¯·æ±‚æ—¶ï¼Œä¼šå‘ TiKV è·å–å…·ä½“çš„æ•°æ®ä¿¡æ¯ã€‚é‚£ä¹ˆä¸€ä¸ªè¯»è¯·æ±‚æœ€æœ´ç´ çš„å¤„ç†è¿‡ç¨‹å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-aa3dee0694dd1c0d14dc9e380e154ec2_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;516&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic3.zhimg.com/v2-aa3dee0694dd1c0d14dc9e380e154ec2_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-aa3dee0694dd1c0d14dc9e380e154ec2_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;516&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic3.zhimg.com/v2-aa3dee0694dd1c0d14dc9e380e154ec2_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-aa3dee0694dd1c0d14dc9e380e154ec2_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;é¦–å…ˆéœ€è¦è‚¯å®šçš„æ˜¯è¿™ç§æ–¹å¼å›ºç„¶èƒ½è§£å†³é—®é¢˜ï¼Œä½†æ˜¯æ€§èƒ½å¦‚ä½•å‘¢ï¼Ÿæˆ‘ä»¬æ¥ä¸€èµ·åˆ†æä¸€ä¸‹ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;TiKV  å°†æ‰€æœ‰æ•°æ®è¿”å›ï¼Œç½‘ç»œå¼€é”€å¤ªå¤§ã€‚&lt;/li&gt;&lt;li&gt;TiDB éœ€è¦è®¡ç®—æ‰€æœ‰æ•°æ®ï¼ŒCPU æ¶ˆè€—å¾ˆå¤§ï¼Œç›¸å¯¹çš„ï¼ŒTiKV å´å¹¶æ²¡æœ‰ä»€ä¹ˆè®¡ç®—ï¼Œå¾ˆé—²ã€‚&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;çœ‹åˆ°ä»¥ä¸Šé—®é¢˜åï¼Œèªæ˜å¦‚ä½ ï¼Œå¯èƒ½å¾ˆå®¹æ˜“å°±æƒ³åˆ°ï¼Œèƒ½ä¸èƒ½è®© TiKV æŠŠè‡ªå·±è´Ÿè´£çš„é‚£éƒ¨åˆ†æ•°æ®åšä¸€æ¬¡è®¡ç®—ï¼Œå†è¿”å›ç»™ TiDB å‘¢ï¼Ÿ&lt;/p&gt;&lt;p&gt;æœ‰ä½•ä¸å¯å‘¢ï¼Ÿ&lt;/p&gt;&lt;p&gt;TiKV è¯»å–æ•°æ®å¹¶è®¡ç®—çš„æ¨¡å—ï¼Œæˆ‘ä»¬å®šä¹‰ä¸º Coprocessorï¼Œè¯¥æ¦‚å¿µçµæ„Ÿæ¥è‡ªäº HBaseï¼Œç›®å‰åœ¨ TiDB ä¸­çš„å®ç°ç±»ä¼¼äº HBase ä¸­çš„ Coprocessor çš„ Endpoint éƒ¨åˆ†ï¼Œä¹Ÿå¯ç±»æ¯” MySQL å­˜å‚¨è¿‡ç¨‹ã€‚&lt;/p&gt;&lt;p&gt;æœ‰äº† Coprocessor åï¼Œä»å®è§‚çœ‹ä¸€ä¸ªè¯»è¯·æ±‚æ˜¯å¦‚ä½•ä¸‹å‘åˆ° TiKV çš„å‘¢ï¼Ÿä»¥ä¸‹é¢çš„è¯·æ±‚ä¸ºä¾‹ï¼š&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-5182af7a6ac373f61670d3a75f74fbad_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;704&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic2.zhimg.com/v2-5182af7a6ac373f61670d3a75f74fbad_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-5182af7a6ac373f61670d3a75f74fbad_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;704&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic2.zhimg.com/v2-5182af7a6ac373f61670d3a75f74fbad_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-5182af7a6ac373f61670d3a75f74fbad_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;å¦‚å›¾ï¼Œä»¥ä¸ŠæŸ¥è¯¢è¯­å¥åœ¨ TiDB ä¸­å¤„ç†å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;TiDB æ”¶åˆ°æŸ¥è¯¢è¯­å¥ï¼Œå¯¹è¯­å¥è¿›è¡Œåˆ†æï¼Œè®¡ç®—å‡ºç‰©ç†æ‰§è¡Œè®¡åˆ’ï¼Œç»„ç»‡ç§° TiKV çš„ Coprocessor è¯·æ±‚ã€‚&lt;/li&gt;&lt;li&gt;TiDB å°†è¯¥ Coprocessor è¯·æ±‚æ ¹æ®æ•°æ®çš„åˆ†å¸ƒï¼Œåˆ†å‘åˆ°æ‰€æœ‰ç›¸å…³çš„ TiKV ä¸Šã€‚&lt;/li&gt;&lt;li&gt;TiKV åœ¨æ”¶åˆ°è¯¥ Coprocessor è¯·æ±‚åï¼Œæ ¹æ®è¯·æ±‚ç®—å­å¯¹æ•°æ®è¿›è¡Œè¿‡æ»¤èšåˆï¼Œç„¶åè¿”å›ç»™ TiDBã€‚&lt;/li&gt;&lt;li&gt;TiDB åœ¨æ”¶åˆ°æ‰€æœ‰æ•°æ®çš„è¿”å›ç»“æœåï¼Œè¿›è¡ŒäºŒæ¬¡èšåˆï¼Œå¹¶å°†æœ€ç»ˆç»“æœè®¡ç®—å‡ºæ¥ï¼Œè¿”å›ç»™å®¢æˆ·ç«¯ã€‚&lt;/li&gt;&lt;/ol&gt;&lt;h2&gt;ä¸»è¦åŠŸèƒ½åŠå¤„ç†æ¦‚è§ˆ&lt;/h2&gt;&lt;p&gt;TiKV Coprocessor å¤„ç†çš„è¯»è¯·æ±‚ç›®å‰ä¸»è¦åˆ†ç±»ä¸‰ç§ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;DAGï¼šæ‰§è¡Œç‰©ç†ç®—å­ï¼Œä¸º SQL è®¡ç®—å‡ºä¸­é—´ç»“æœï¼Œä»è€Œå‡å°‘ TiDB çš„è®¡ç®—å’Œç½‘ç»œå¼€é”€ã€‚è¿™ä¸ªæ˜¯ç»å¤§å¤šæ•°åœºæ™¯ä¸‹ Coprocessor æ‰§è¡Œçš„ä»»åŠ¡ã€‚&lt;/li&gt;&lt;li&gt;Analyzeï¼šåˆ†æè¡¨æ•°æ®ï¼Œç»Ÿè®¡ã€é‡‡æ ·è¡¨æ•°æ®ä¿¡æ¯ï¼ŒæŒä¹…åŒ–åè¢« TiDB çš„ä¼˜åŒ–å™¨é‡‡ç”¨ã€‚&lt;/li&gt;&lt;li&gt;CheckSumï¼šå¯¹è¡¨æ•°æ®è¿›è¡Œæ ¡éªŒï¼Œç”¨äºå¯¼å…¥æ•°æ®åä¸€è‡´æ€§æ ¡éªŒã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;é‚£ä¹ˆ TiKV åœ¨æ”¶åˆ° Coprocessor è¯·æ±‚åï¼Œä½•æ—¶åŒºåˆ†è¿™ä¸‰ç§è¯·æ±‚çš„å‘¢ï¼Ÿ&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-0b450b6d1c6e8acbc44cd91a5d38e934_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;441&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic1.zhimg.com/v2-0b450b6d1c6e8acbc44cd91a5d38e934_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-0b450b6d1c6e8acbc44cd91a5d38e934_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;441&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic1.zhimg.com/v2-0b450b6d1c6e8acbc44cd91a5d38e934_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-0b450b6d1c6e8acbc44cd91a5d38e934_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;è¯·æ±‚åˆ°äº† TiKV å±‚ï¼Œå¤„ç†è¿‡ç¨‹å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;ç”± gRPC server æ¥æ”¶å¹¶å°†è¯·æ±‚åˆ†å‘ç»™ Coprocessor Endpoint è¿›è¡Œå¤„ç†ã€‚&lt;/li&gt;&lt;li&gt;Endpoint åœ¨æ”¶åˆ°è¯·æ±‚åï¼Œæ ¹æ®è¯·æ±‚çš„ä¼˜å…ˆçº§ï¼Œå°†è¯·æ±‚åˆ†å‘ç»™å¯¹åº”çš„çº¿ç¨‹æ± ã€‚&lt;/li&gt;&lt;li&gt;æ‰€æœ‰è¯·æ±‚ä¼šå…ˆå¼‚æ­¥ä»å­˜å‚¨å±‚è·å– snapshotï¼Œç„¶åå¼€å§‹çœŸæ­£çš„å¤„ç†é˜¶æ®µã€‚&lt;/li&gt;&lt;li&gt;æ ¹æ®è¯·æ±‚çš„ä¸åŒç±»å‹ï¼Œæ„é€ ä¸åŒçš„ Handler è¿›è¡Œæ•°æ®çš„å¤„ç†ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;ç›®å‰ Coprocessor æ”¯æŒçš„ä¸‰ç§æ¥å£ä¸­ï¼Œåé¢ä¸¤ç§æ¥å£ç›¸å¯¹æ¯”è¾ƒç®€å•ï¼Œè€Œ DAG æ˜¯é‡Œé¢æœ€å¤æ‚ä¹Ÿæ˜¯æœ€å¸¸ç”¨çš„ï¼Œæ‰€ä»¥æœ¬æ–‡åç»­å°†é‡ç‚¹ä»‹ç» DAG ç±»è¯·æ±‚ã€‚&lt;/p&gt;&lt;h2&gt;DAG Request æ¦‚è§ˆ&lt;/h2&gt;&lt;p&gt;DAG é¡¾åæ€ä¹‰ï¼Œæ˜¯ç”±ä¸€ç³»åˆ—ç®—å­ç»„æˆçš„æœ‰å‘æ— ç¯å›¾ï¼Œç®—å­åœ¨ä»£ç ä¸­ç§°ä¸º Executorsã€‚&lt;/p&gt;&lt;p&gt;ç›®å‰ DAG è¯·æ±‚ä¸»è¦å®ç°äº†ä¸¤ç§è®¡ç®—æ¨¡å‹ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;ç«å±±æ¨¡å‹ï¼šæ¯ä¸ªç®—å­æŒ‰è¡ŒæŒ‰éœ€åå‡ºï¼Œ3.0 ä¹‹åå¼€å§‹å¼ƒç”¨ã€‚&lt;/li&gt;&lt;li&gt;å‘é‡åŒ–è®¡ç®—æ¨¡å‹ï¼šæ¯ä¸ªç®—å­æ‰¹é‡åŒ–å¤„ç†æ•°æ®ï¼Œ3.0 ä¹‹åå¼€å§‹æ¨å¹¿ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;åœ¨ç›®å‰çš„ TiKV master ä¸Šï¼Œå¤„äºç«å±±æ¨¡å‹å‘å‘é‡åŒ–æ¨¡å‹çš„è¿‡åº¦é˜¶æ®µï¼Œå› è€Œä¸¤ç§è®¡ç®—æ¨¡å‹åŒæ—¶å­˜åœ¨ã€‚TiKV æ”¶åˆ°è¯·æ±‚æ—¶ï¼Œä¼šä¼˜å…ˆæ£€æµ‹æ˜¯å¦å¯èµ°å‘é‡åŒ–æ¨¡å‹ï¼Œè‹¥éƒ¨åˆ†åŠŸèƒ½åœ¨å‘é‡åŒ–æ¨¡å‹ä¸­æ²¡æœ‰å®ç°ï¼Œåˆ™èµ°æ—§çš„è®¡ç®—æ¨¡å‹ï¼Œå…·ä½“å¤„ç†é€»è¾‘æµç¨‹å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-e8396857c846de7980df121bb3b1f9c8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;474&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic1.zhimg.com/v2-e8396857c846de7980df121bb3b1f9c8_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-e8396857c846de7980df121bb3b1f9c8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;474&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic1.zhimg.com/v2-e8396857c846de7980df121bb3b1f9c8_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-e8396857c846de7980df121bb3b1f9c8_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;ç›¸å…³ä»£ç åœ¨ï¼š&lt;code&gt;src/coprocessor/dag/mod.rs&lt;/code&gt;ã€‚&lt;/p&gt;&lt;p&gt;å› ä¸ºç«å±±æ¨¡å‹å·²åœ¨è¢«å¼ƒç”¨ä¸­ï¼Œæ‰€ä»¥ä¸‹æ–‡æˆ‘ä»¬åªè®²å‘é‡åŒ–è®¡ç®—æ¨¡å‹ã€‚&lt;/p&gt;&lt;h2&gt;ç®—å­æ¦‚è§ˆ&lt;/h2&gt;&lt;p&gt;åœ¨å‘é‡åŒ–è®¡ç®—æ¨¡å‹ä¸­ï¼Œæ‰€æœ‰ç®—å­éƒ½å®ç°äº† &lt;code&gt;BatchExecutor&lt;/code&gt;æ¥å£ï¼Œå…¶ä¸»è¦å®šä¹‰äº†ä¸€ä¸ª &lt;code&gt;get_batch&lt;/code&gt; çš„å‡½æ•°ï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;pub trait BatchExecutor: Send {
   fn next_batch(&amp;amp;mut self, scan_rows: usize) -&amp;gt; BatchExecuteResult;
}

pub struct BatchExecuteResult {
   pub physical_columns: LazyBatchColumnVec,
   pub logical_rows: Vec&amp;lt;usize&amp;gt;,
   pub is_drained: Result&amp;lt;bool, Error&amp;gt;,
   ...
}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å‚æ•°è¯´æ˜ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;code&gt;next_batch&lt;/code&gt; ä¸­ &lt;code&gt;scan_rows&lt;/code&gt; ç”±ä¸Šå±‚æ§åˆ¶ï¼Œç”±äºæ‰«çš„æ•°æ®è¿‡å¤šä¼šæ…¢ï¼Œå› æ­¤è¯¥æ•°å­—ä» 32 å€å¢åˆ° 1024ã€‚&lt;/li&gt;&lt;li&gt;è¿”å›å€¼ &lt;code&gt;BatchExecuteResult&lt;/code&gt; ä¸­ï¼Œç”±äºè¿”å›äº†ä¸€æ‰¹ç©ºæ•°æ®ä¸ä»£è¡¨æ‰€æœ‰æ•°æ®éƒ½å¤„ç†å®Œæ¯•äº†ï¼Œä¾‹å¦‚å¯èƒ½åªæ˜¯å…¨è¢«è¿‡æ»¤ï¼Œå› è€Œä½¿ç”¨å•ç‹¬å­—æ®µè¡¨ç¤ºæ‰€æœ‰æ•°æ®å¤„ç†å®Œæ¯•ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;ç›®å‰ TiKV æ”¯æŒçš„ç®—å­ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç±»ã€‚&lt;/p&gt;&lt;h3&gt;TableScan&lt;/h3&gt;&lt;ul&gt;&lt;li&gt;å®šä¹‰ï¼šæ ¹æ®æŒ‡å®šä¸»é”®èŒƒå›´æ‰«è¡¨æ•°æ®ï¼Œå¹¶è¿‡æ»¤å‡ºä¸€éƒ¨åˆ†åˆ—è¿”å›ã€‚å®ƒåªä¼šä½œä¸ºæœ€åº•å±‚ç®—å­å‡ºç°ï¼Œä»åº•å±‚ KV è·å–æ•°æ®ã€‚&lt;/li&gt;&lt;li&gt;æºç è·¯å¾„ï¼š&lt;code&gt;components/tidb_query/src/batch/executors/table_scan_executor.rs&lt;/code&gt;&lt;/li&gt;&lt;li&gt;æ¡ˆä¾‹ï¼š&lt;code&gt;select col from t&lt;/code&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h3&gt;IndexScan&lt;/h3&gt;&lt;ul&gt;&lt;li&gt;å®šä¹‰ï¼šæ ¹æ®æŒ‡å®šç´¢å¼•è¿”å›æ‰«ç´¢å¼•æ•°æ®ï¼Œå¹¶è¿‡æ»¤å‡ºä¸€éƒ¨åˆ†ç´¢å¼•åˆ—è¿”å›ã€‚å®ƒåªä¼šä½œä¸ºæœ€åº•å±‚ç®—å­å‡ºç°ï¼Œä»åº•å±‚ KV è·å–æ•°æ®ã€‚&lt;/li&gt;&lt;li&gt;æºç è·¯å¾„ï¼š&lt;code&gt;components/tidb_query/src/batch/executors/index_scan_executor.rs&lt;/code&gt;&lt;/li&gt;&lt;li&gt;æ¡ˆä¾‹ï¼š&lt;code&gt;select index from t&lt;/code&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h3&gt;Selection&lt;/h3&gt;&lt;ul&gt;&lt;li&gt;å®šä¹‰ï¼šå¯¹åº•å±‚ç®—å­çš„ç»“æœæŒ‰ç…§è¿‡æ»¤æ¡ä»¶è¿›è¡Œè¿‡æ»¤ï¼Œå…¶ä¸­è¿™äº›æ¡ä»¶ç”±å¤šä¸ªè¡¨è¾¾å¼ç»„æˆã€‚&lt;/li&gt;&lt;li&gt;æºç è·¯å¾„ï¼š&lt;code&gt;components/tidb_query/src/batch/executors/selection_executor.rs&lt;/code&gt;&lt;/li&gt;&lt;li&gt;æ¡ˆä¾‹ï¼š&lt;code&gt;select col from t where a+b=10&lt;/code&gt; &lt;/li&gt;&lt;/ul&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-9537e60316ef13101e74f7c99b008f0c_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;177&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic1.zhimg.com/v2-9537e60316ef13101e74f7c99b008f0c_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-9537e60316ef13101e74f7c99b008f0c_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;177&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic1.zhimg.com/v2-9537e60316ef13101e74f7c99b008f0c_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-9537e60316ef13101e74f7c99b008f0c_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;h3&gt;Limit&lt;/h3&gt;&lt;ul&gt;&lt;li&gt;å®šä¹‰ï¼šä»åº•å±‚ç®—å­åå‡ºçš„æ•°æ®ä¸­ï¼Œé™å®šè¿”å›è‹¥å¹²è¡Œã€‚&lt;/li&gt;&lt;li&gt;æºç è·¯å¾„ï¼š&lt;code&gt;components/tidb_query/src/batch/executors/limit_executor.rs&lt;/code&gt;&lt;/li&gt;&lt;li&gt;æ¡ˆä¾‹ï¼š&lt;code&gt;select col from t limit 10&lt;/code&gt; &lt;/li&gt;&lt;/ul&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-a86af3a75066450b0f1f2ffd99d742cd_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;241&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic2.zhimg.com/v2-a86af3a75066450b0f1f2ffd99d742cd_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-a86af3a75066450b0f1f2ffd99d742cd_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;241&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic2.zhimg.com/v2-a86af3a75066450b0f1f2ffd99d742cd_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-a86af3a75066450b0f1f2ffd99d742cd_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;h3&gt;TopN&lt;/h3&gt;&lt;ul&gt;&lt;li&gt;å®šä¹‰ï¼šæŒ‰ç…§ç»™å®šè¡¨è¾¾å¼è¿›è¡Œæ’åºåï¼Œå–å‡ºå‰è‹¥å¹²è¡Œæ•°æ®ã€‚&lt;/li&gt;&lt;li&gt;æºç è·¯å¾„ï¼š&lt;code&gt;components/tidb_query/src/batch/executors/top_n_executor.rs&lt;/code&gt;&lt;/li&gt;&lt;li&gt;æ¡ˆä¾‹ï¼š&lt;code&gt;select col from t order by a+1 limit 10&lt;/code&gt; &lt;/li&gt;&lt;/ul&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-f81a619595326369d12d9259d1773b01_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;172&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic2.zhimg.com/v2-f81a619595326369d12d9259d1773b01_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-f81a619595326369d12d9259d1773b01_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;172&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic2.zhimg.com/v2-f81a619595326369d12d9259d1773b01_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-f81a619595326369d12d9259d1773b01_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;h3&gt;Aggregation&lt;/h3&gt;&lt;ul&gt;&lt;li&gt;å®šä¹‰ï¼šæŒ‰ç…§ç»™å®šè¡¨è¾¾å¼è¿›è¡Œåˆ†ç»„ã€èšåˆã€‚&lt;/li&gt;&lt;li&gt;æºç è·¯å¾„ï¼š&lt;code&gt;components/tidb_query/src/batch/executors/*_aggr_executor.rs&lt;/code&gt;&lt;/li&gt;&lt;li&gt;æ¡ˆä¾‹ï¼š &lt;code&gt;select count(1) from t group by score + 1&lt;/code&gt; &lt;/li&gt;&lt;/ul&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-8669a7a532d4dae1e3ace722d3eb5a5c_b.png&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;133&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic1.zhimg.com/v2-8669a7a532d4dae1e3ace722d3eb5a5c_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-8669a7a532d4dae1e3ace722d3eb5a5c_b.png&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;133&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic1.zhimg.com/v2-8669a7a532d4dae1e3ace722d3eb5a5c_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-8669a7a532d4dae1e3ace722d3eb5a5c_b.png&quot;/&gt;&lt;/figure&gt;&lt;h3&gt;æ··åˆä½¿ç”¨å„ä¸ªç®—å­&lt;/h3&gt;&lt;p&gt;ç»¼ä¸Šï¼Œå„ä¸ªç®—å­ä¹‹é—´å¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ–¹å¼ä»»æ„ç»„åˆï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-5c5b39a2ad24c059413f961ef11470dd_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;905&quot; data-rawheight=&quot;524&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;905&quot; data-original=&quot;https://pic2.zhimg.com/v2-5c5b39a2ad24c059413f961ef11470dd_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-5c5b39a2ad24c059413f961ef11470dd_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;905&quot; data-rawheight=&quot;524&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;905&quot; data-original=&quot;https://pic2.zhimg.com/v2-5c5b39a2ad24c059413f961ef11470dd_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-5c5b39a2ad24c059413f961ef11470dd_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;æ¡ˆä¾‹ï¼š&lt;code&gt;select count(1) from t where age&amp;gt;10&lt;/code&gt; &lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-5b2a0a955e0c4051716a04f1118c7559_b.png&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;124&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic2.zhimg.com/v2-5b2a0a955e0c4051716a04f1118c7559_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-5b2a0a955e0c4051716a04f1118c7559_b.png&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;124&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic2.zhimg.com/v2-5b2a0a955e0c4051716a04f1118c7559_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-5b2a0a955e0c4051716a04f1118c7559_b.png&quot;/&gt;&lt;/figure&gt;&lt;h2&gt;å°ç»“&lt;/h2&gt;&lt;p&gt;ç”±äºç¯‡å¹…åŸå› ï¼Œæœ¬æ–‡åªæ˜¯è®²äº†ä¸€äº› Coprocessor çš„æ¦‚è¦ï¼Œè¯»è€…å¯¹æ­¤æœ‰ä¸ªæ¦‚å¿µå³å¯ã€‚åç»­æˆ‘ä»¬å°†æ¨å‡ºè¯¥æ¨¡å—ç›¸å…³çš„æ›´å¤šæ›´æ·±çš„æºç ç»†èŠ‚åˆ†æï¼Œæ¬¢è¿å¤§å®¶ç»§ç»­é˜…è¯»å¹¶ç»™å‡ºå»ºè®¾æ€§çš„æ”¹è¿›æ„è§ã€‚&lt;/p&gt;&lt;p&gt;åŸæ–‡é˜…è¯»ï¼š&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pingcap.com/blog-cn/tikv-source-code-reading-14/&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic2.zhimg.com/v2-60ab5bd867c2434d70c957a02a2169e1_ipico.jpg&quot; data-image-width=&quot;1200&quot; data-image-height=&quot;1200&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TiKV æºç è§£æç³»åˆ—æ–‡ç« ï¼ˆåå››ï¼‰Coprocessor æ¦‚è§ˆ | PingCAP&lt;/a&gt;&lt;p&gt;æ›´å¤š TiKV æºç é˜…è¯»ï¼š&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pingcap.com/blog-cn/%23TiKV-%25E6%25BA%2590%25E7%25A0%2581%25E8%25A7%25A3%25E6%259E%2590&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic2.zhimg.com/v2-60ab5bd867c2434d70c957a02a2169e1_ipico.jpg&quot; data-image-width=&quot;1200&quot; data-image-height=&quot;1200&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Blog-cns | PingCAP&lt;/a&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>ZoeyZhai</author>
<guid isPermaLink="false">2019-10-31-89518391</guid>
<pubDate>Thu, 31 Oct 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>æ®è¯´ä»Šå¹´é»‘å®¢é©¬æ‹‰æ¾é¡¹ç›®åˆå¤šåˆçŒ›ï¼Ÿ| TiDB Hackathon å›é¡¾</title>
<link>https://henix.github.io/feeds/zhuanlan.newsql/2019-10-31-89438349.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/89438349&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-a1bf6fcf4f4d3255605d213ca373195b_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;blockquote&gt;TiDB Hackathon 2019  åœ¨ 10 æœˆ 27 æ—¥å®Œç¾æ”¶å®˜ï¼åŒ—äº¬ã€ä¸Šæµ·ã€å¹¿å·ä¸‰åœ°å…± &lt;b&gt;39 æ”¯é˜Ÿä¼&lt;/b&gt;å‚èµ›ï¼Œä¸¤å¤©ä¸€å¤œçš„ Hacking Timeï¼Œå¤§å®¶å›´ç»•ç€&lt;b&gt;ã€ŒImproveã€&lt;/b&gt;ä¸»é¢˜ï¼Œä¸º TiDB æ€§èƒ½ã€æ˜“ç”¨æ€§ã€ç¨³å®šæ€§ã€åŠŸèƒ½ç­‰å„æ–¹é¢åšå‡ºæå‡ï¼Œæœ€ç»ˆ 6 æ”¯é˜Ÿä¼ç“œåˆ†äº†ä¸€ã€äºŒã€ä¸‰ç­‰å¥–çš„ 15 ä¸‡å…ƒç°é‡‘å¥–åŠ±ï¼Œå¦æœ‰ 4 æ”¯é˜Ÿä¼åˆ†è·æœ€ä½³è´¡çŒ®å¥–ã€æœ€ä½³åˆ›æ„å¥–ã€æœ€å…·æ½œåŠ›å¥–å’Œ CTO ç‰¹åˆ«å¥–ã€‚&lt;br/&gt;&lt;b&gt;è¯è¯´ï¼Œæœ¬å±Š Hackathon ä¸ç®¡æ˜¯ä»æ¯”èµ›çš„å½¢å¼ã€è§„æ¨¡ï¼Œè¿˜æ˜¯å®Œèµ›é¡¹ç›®çš„è´¨é‡ï¼Œç›¸æ¯”å»å¹´å¯ä»¥è¯´æ˜¯é¢ è¦†æ€§çš„æå‡ã€‚&lt;/b&gt;&lt;/blockquote&gt;&lt;h2&gt;&lt;b&gt;é¡¹ç›®è¶…çŒ›ï¼ŒDemo Show è¶…é•¿&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;ä»Šå¹´æ€»å…± 39 æ”¯é˜Ÿä¼å‚èµ›ï¼Œå‡ ä¹è¾ƒå»å¹´ç¿»å€ã€‚ä»è´¨é‡æ¥çœ‹ï¼Œ&lt;b&gt;ä¼˜ç§€é¡¹ç›®åˆå¤šåˆçŒ›&lt;/b&gt;ï¼Œå¥–é¡¹è§’é€éå¸¸æ¿€çƒˆï¼Œä¸‰åœ°è”åŠ¨ç›´æ’­çš„ Demo Show ä»ä¸‹åˆ 14:30 æŒç»­åˆ° 21:30ï¼ˆæ²¡çœ‹é”™ï¼Œ7 ä¸ªå°æ—¶ï¼‰ï¼Œä½†æ˜¯å¤§å®¶è¶Šçœ‹è¶Šå…´å¥‹â€”â€”å…´å¥‹ç¨‹åº¦å ªæ¯”çœ‹åˆ°ç¼–è¯‘å®Œæ²¡æœ‰æŠ¥é”™å’Œ Warning çš„ç”µè„‘å±å¹•æ”¾å‡ å¼ ï¼ˆè¯„å§” Ed Huang&amp;#34;æ¿€åŠ¨ç›—æ‘„&amp;#34;çš„ï¼‰PPT å¤§å®¶éšæ„æ„Ÿå—ä¸€ä¸‹ï¼š&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-5a3d6e2b5f8e127ae04c64623c027efe_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;1080&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-5a3d6e2b5f8e127ae04c64623c027efe_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-5a3d6e2b5f8e127ae04c64623c027efe_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;1080&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-5a3d6e2b5f8e127ae04c64623c027efe_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-5a3d6e2b5f8e127ae04c64623c027efe_b.jpg&quot;/&gt;&lt;figcaption&gt;ã€ŒImproveã€ä¸æ˜¯è¯´ç€ç©å„¿çš„&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;ç»è¿‡ç´§å¼ è¯„é€‰ï¼Œè¯„å§”å›¢æœ€ç»ˆå…±è¯„å‡ºäº†ä¸€ã€äºŒã€ä¸‰ç­‰å¥–å’Œæœ€ä½³åˆ›æ„ã€æœ€ä½³è´¡çŒ®ã€æœ€ä½³æ½œåŠ›å¥–ã€‚ç”±äºå¥–é¡¹è§’é€å¤ªæ¿€çƒˆï¼Œæœ‰å¾ˆå¤šä¼˜ç§€é¡¹ç›®é—æ†¾è½é€‰ï¼Œæˆ‘å¸ CTO é»„ä¸œæ—­ç°åœºä¸´æ—¶å¢è®¾äº†â€œCTO ç‰¹åˆ«å¥–â€ ï¼Œä»¥ä¸‹æ˜¯å…¨éƒ¨è·å¥–åå•ï¼š&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-0428c4452cfad85a8e6a2288bc65ee45_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;834&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-0428c4452cfad85a8e6a2288bc65ee45_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-0428c4452cfad85a8e6a2288bc65ee45_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;834&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-0428c4452cfad85a8e6a2288bc65ee45_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-0428c4452cfad85a8e6a2288bc65ee45_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;å†æ¬¡æ­å–œå„ä½è·å¥–é€‰æ‰‹ï½ğŸ‰ &lt;/b&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-d55aec35ff71271514d24cc3889e39f5_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;1439&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-d55aec35ff71271514d24cc3889e39f5_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-d55aec35ff71271514d24cc3889e39f5_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;1439&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-d55aec35ff71271514d24cc3889e39f5_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-d55aec35ff71271514d24cc3889e39f5_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-80e31cd113b25356ab37cca5e3b3fcb8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;810&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-80e31cd113b25356ab37cca5e3b3fcb8_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-80e31cd113b25356ab37cca5e3b3fcb8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;810&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-80e31cd113b25356ab37cca5e3b3fcb8_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-80e31cd113b25356ab37cca5e3b3fcb8_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;è¿™äº›é¡¹ç›®æ·±æ·±åˆºæ¿€äº†å¤§å®¶çš„ç¥ç»ï¼Œå°ä¼™ä¼´ä»¬çœ‹å®Œ Demo Show éƒ½å¼€å§‹äº†æ¿€çƒˆçš„è®¨è®ºã€æ‘©æ‹³æ“¦æŒå¼€å§‹æ¨åŠ¨é¡¹ç›®è½åœ°ï¼Œè€Œæœ¬å±Š Hackathon å¯¼å¸ˆã€æˆ‘å¸é¦–å¸­æ¶æ„å¸ˆå”åˆ˜è€å¸ˆï¼Œâ€œå¼€å¿ƒåˆ°é£èµ·â€ï¼Œç«é€Ÿå†™äº†ä¸€ç¯‡çš„ç‚¹è¯„æ–‡ç« ï¼ˆä»¥ä¸‹ä¸ºèŠ‚é€‰å†…å®¹ï¼‰â€”â€”&lt;/p&gt;&lt;p&gt;&lt;b&gt;ä¸€ç­‰å¥–é¡¹ç›®ï¼šUnified Thread Pool&lt;/b&gt;&lt;/p&gt;&lt;p&gt;è¿™ä¸ªé¡¹ç›®ä¸»è¦è§£å†³ TiKV ä¸¤ä¸ªé—®é¢˜ï¼š1ï¼‰çº¿ç¨‹æ± å¤ªå¤šï¼Œé¢‘ç¹çº¿ç¨‹åˆ‡æ¢å¯¼è‡´æ€§èƒ½é—®é¢˜ï¼›2ï¼‰å¤§æŸ¥è¯¢å½±å“å°æŸ¥è¯¢é—®é¢˜ã€‚ä¸€å¼€å§‹æˆ‘å¹¶ä¸çŸ¥é“å¥•éœ–åŒå­¦è¦æŒ‘æˆ˜è¿™ä¸ªé¡¹ç›®ï¼Œçœ‹åˆ°çš„æ—¶å€™çœŸçš„å¾ˆéœ‡æƒŠï¼Œæ¯•ç«Ÿä¹‹å‰æˆ‘ä»¬å†…éƒ¨å°è¯•è¿‡å‡ æ¬¡ï¼Œä½†éƒ½æ— ç–¾è€Œç»ˆã€‚ä¸»è¦é¢ä¸´çš„å›°éš¾æ˜¯åŒä¸€ä¸ªçº¿ç¨‹æ± å¦‚ä½•è°ƒåº¦å¤§å°æŸ¥è¯¢ï¼ŒåŒ…æ‹¬å¤§æŸ¥è¯¢ä¸èƒ½å½±å“å°æŸ¥è¯¢ï¼ŒåŒæ—¶å°æŸ¥è¯¢çš„æ€§èƒ½åˆè¦è¶³å¤Ÿå¥½ã€‚&lt;/p&gt;&lt;p&gt;å¥•éœ–åŒå­¦å‚è€ƒ Linux çš„ Schedule ç®—æ³•ï¼Œä»¥åŠ Rust juliex åº“ï¼Œè·Ÿä»–åŒå­¦ä¸€èµ·å®Œæˆäº† Unified Thread Pool çš„åŸå‹ï¼Œå®é™…çš„æµ‹è¯•æ•ˆæœè®©æˆ‘éå¸¸éœ‡æƒŠï¼Œä¸å…‰æ˜¯çº¯ point select æ€§èƒ½æœ‰å¤§é‡æå‡ï¼Œåœ¨æœ‰å¤§æŸ¥è¯¢çš„æƒ…å†µä¸‹é¢ï¼ŒQPS ä¹Ÿèƒ½ä¿æŒç¨³å®šã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;äºŒç­‰å¥–é¡¹ç›®ï¼štidb-wasm&lt;/b&gt;&lt;/p&gt;&lt;p&gt;ä¸å¾—ä¸è¯´ï¼Œè¿™ä¸ªæ˜¯ä¸€ä¸ªå¤§æ€å™¨ï¼Œå®ƒé€šè¿‡ wasm æŠ€æœ¯ï¼Œè®© TiDB èƒ½è·‘åœ¨æµè§ˆå™¨ä¸Šé¢ï¼Œè¿™ä¸ªå°±å¾ˆæœ‰æ„æ€äº†ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆæ–¹ä¾¿çš„åšä¸€ä¸ª TiDB Playground å‡ºæ¥ï¼Œæ”¾åˆ° PingCAP Universityï¼ˆPUï¼‰è¿™è¾¹ï¼Œæˆ–è€…å¯ä»¥å®˜ç½‘ä¸ŠåµŒå…¥ï¼Œè®©ç”¨æˆ·ç›´æ¥å°è¯•ä½¿ç”¨ã€‚è¿™å¯¹äºè®©ç”¨æˆ·å¿«é€Ÿçš„æ„Ÿå— TiDB éå¸¸é‡è¦ï¼Œå¯ä»¥è¯´æå¤§é™ä½äº†ç”¨æˆ·äº†è§£ TiDB çš„é—¨æ§›ï¼Œæˆ‘ä¸ªäººéå¸¸æœŸæœ›è¿™ä¸ªé¡¹ç›®èƒ½å¤Ÿè½åœ°ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;äºŒç­‰å¥–é¡¹ç›®ï¼šTiDB è·¨æ•°æ®ä¸­å¿ƒçš„è§£å†³æ–¹æ¡ˆ&lt;/b&gt;&lt;/p&gt;&lt;p&gt;è¿™ä¸ªé¡¹ç›®ä¸»è¦æ˜¯è§£å†³è·¨ DC æƒ…å†µä¸‹é¢ TiDB çš„ latency é—®é¢˜ï¼Œä¸»è¦ä» Raft å±‚é¢æ¥è§£å†³çš„ã€‚ä¸¤ä¸ªæ ¸å¿ƒçš„æ€æƒ³ï¼š&lt;/p&gt;&lt;p&gt;1. Follower replication - å¼•å…¥ raft sub-group æ¦‚å¿µï¼Œå°†ä¸€äº›èŠ‚ç‚¹æŒ‰ç…§ DC ç­‰å±æ€§è¿›è¡Œåˆ†ç»„ï¼Œæ¯ä¸ªç»„é‡Œé¢æœ‰ä¸€ä¸ª delegate èŠ‚ç‚¹ï¼Œleader åªä¼šè·Ÿè¿™ä¸ª delegate èŠ‚ç‚¹äº¤äº’ï¼Œç”±è¿™ä¸ª delegate èŠ‚ç‚¹å°†æ•°æ®è½¬å‘ç»™è¿™ä¸ª group é‡Œé¢çš„å…¶ä»–èŠ‚ç‚¹ã€‚&lt;/p&gt;&lt;p&gt;2. å¯¹äºå¼‚åœ° follower readï¼Œå¹¶å‘çš„å‘é€è·å– TSO ä»¥åŠ ReadIndex çš„è¯·æ±‚ï¼Œå‡å°‘ä¸€æ¬¡ RTTã€‚&lt;/p&gt;&lt;p&gt;è¿™ä¸ªé¡¹ç›®æˆ‘ä¸ªäººåœ¨å¼€èµ›ä¹‹å‰éå¸¸çœ‹å¥½ï¼Œåé¢æœç„¶æ‹¿äº†ç¬¬äºŒåçš„å¥½æˆç»©ã€‚&lt;/p&gt;&lt;p&gt;&lt;i&gt;â€¦â€¦æ­¤å¤„çœç•¥å…«åƒå­—é•¿æ–‡ç‚¹è¯„ï¼Œä»¥ä¸Šç‚¹è¯„ä»…ä»£è¡¨é¦–æ¶ä¸ªäººè§‚ç‚¹ã€‚&lt;/i&gt;&lt;/p&gt;&lt;blockquote&gt;æ€»ä¹‹è¿™æ¬¡å®Œèµ›çš„é¡¹ç›®è´¨é‡éƒ½éå¸¸é«˜ï¼Œé™¤äº†è·å¥–é¡¹ç›®ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€äº›å¾ˆæœ‰æ„ä¹‰ã€å®ç”¨æ€§å¾ˆå¼ºåŒæ—¶æå…·æƒ³è±¡åŠ›çš„é¡¹ç›®ï¼Œæˆ‘ä»¬éå¸¸å¸Œæœ›è¿™äº›é¡¹ç›®éƒ½èƒ½åœ¨ç¤¾åŒºçš„ç»´æŠ¤ä¸‹å®Œå–„æˆç†Ÿï½&lt;/blockquote&gt;&lt;h2&gt;&lt;b&gt;è¯„å§”è€å¸ˆå¥½ä¸¥è‚ƒï¼Œå¥½è®¤çœŸ&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;ç¬¬äºŒå¤©å¤§å®¶åƒå®Œæœ€åçš„åˆé¤ï¼Œå°±è¿›å…¥ç´§å¼ çš„ Demo Show ç¯èŠ‚äº†ã€‚è¯„å§”å›¢ä»é¡¹ç›®çš„å®ç”¨æ€§/æ˜“ç”¨æ€§/æ€§èƒ½ï¼ˆ40%ï¼‰ã€å®Œæˆåº¦ï¼ˆ30%ï¼‰ã€åˆ›æ–°æ€§ï¼ˆ20%ï¼‰ã€å±•ç¤ºåº¦ï¼ˆ10%ï¼‰ï¼Œå››ä¸ªæ–¹é¢è¿›è¡Œæ‰“åˆ†ã€‚ç”±äºé¡¹ç›®ä¸€ä¸ªæ¯”ä¸€ä¸ªç²¾å½©ï¼Œç«äº‰éå¸¸æ¿€çƒˆï¼Œè¯„å§”è€å¸ˆä»¬ä¹Ÿå¯è¶³äº†åŠ²ï¼Œèšç²¾ä¼šç¥åœ°çœ‹æ¯ä¸ªç»†èŠ‚ï¼Œç”šè‡³ç”¨ç¬”è®¤çœŸè®°ä¸‹æ¯ä¸ªé¡¹ç›®çš„ä¼˜ç¼ºç‚¹ã€‚åœ¨é€‰æ‰‹æ¼”ç¤ºç»“æŸåï¼Œè¯„å§”è€å¸ˆä»¬ä¹Ÿéšæœºæé—®ï¼Œå½“ç„¶ä¹Ÿä¸ä¹å¯¹é¡¹ç›®å®Œå–„æ–¹å‘çš„å»ºè®®ã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-30bb33226f8a1f265083a39b366cbfd0_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;1080&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-30bb33226f8a1f265083a39b366cbfd0_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-30bb33226f8a1f265083a39b366cbfd0_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;1080&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-30bb33226f8a1f265083a39b366cbfd0_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-30bb33226f8a1f265083a39b366cbfd0_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;å°¤å…¶æ„Ÿè°¢ç¾å›¢æ•°æ®åº“å›¢é˜Ÿè´Ÿè´£äºº&lt;b&gt;æå‡¯&lt;/b&gt;ï¼Œ58 é›†å›¢æ•°æ®åº“é«˜çº§ç»ç†&lt;b&gt;äºä¼¯ä¼Ÿ&lt;/b&gt;ï¼Œäº¬ä¸œäº‘é«˜çº§æ€»ç›‘&lt;b&gt;æé“å…µ&lt;/b&gt;ï¼Œç¾å›¢ç‚¹è¯„åˆ†å¸ƒå¼æ•°æ®åº“å¹³å°å¼€å‘å’Œè¿ç»´è´Ÿè´£äººã€ç ”ç©¶å‘˜&lt;b&gt;èµµåº”é’¢&lt;/b&gt;ï¼Œè´å£³æ‰¾æˆ¿æ•°æ®æŠ€æœ¯æ€»ç›‘&lt;b&gt;ä¾¯åœ£æ–‡&lt;/b&gt;ï¼Œäº”ä½è€å¸ˆè®¤çœŸè´Ÿè´£çš„è¯„å®¡ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;åˆ†å¸ƒå¼èµ›äº‹ä¿éšœ&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;å½“ç„¶ç¡¬æ ¸çš„é»‘å®¢é©¬æ‹‰æ¾å°‘ä¸äº†åƒåƒå–å–å•¦ï¼Œä¸ºäº†ä¿éšœåŒ—ä¸Šå¹¿ä¸‰åœ°åˆ†å¸ƒå¼èµ›äº‹é¡ºåˆ©ï¼ŒTiDB Robot çš„åˆ†èº«ä»¬éƒ½æ‹¼äº†ã€‚å¸Œæœ›æ‰€æœ‰å‚èµ›é€‰æ‰‹å›å¿†èµ· 2019 å¹´å‚åŠ è¿‡æœ€å¥½åƒçš„é©¬æ‹‰æ¾ï¼Œè„‘è¢‹é‡Œä¼šå†’å‡º TiDB Robot åœ¨ä¼šè®®å®¤ç»™å¤§å®¶æ‘†è‡ªåŠ©å¤§é¤ã€å°é¾™è™¾ã€æŠ«è¨ã€å•¤é…’çš„æ ·å­ï¼Œæ¯•ç«Ÿ Robot æ¯é¡¿éƒ½è¦åœ¨ç¾¤é‡Œå‰è…°å¤§å–Šï¼šåƒæ—©é¥­å•¦ï¼Œåƒåˆé¥­å•¦ï¼Œåƒæ™šé¥­å•¦ï¼Œè¶çƒ­åƒï¼è¿˜æœ‰å¤œå®µé›¶é£Ÿéšä¾¿åƒï¼ï¼ˆéƒ½ç»™æˆ‘åƒï¼ï¼‰&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-5594157428b4ae6372ca09622d86e135_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;1080&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-5594157428b4ae6372ca09622d86e135_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-5594157428b4ae6372ca09622d86e135_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;1080&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-5594157428b4ae6372ca09622d86e135_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-5594157428b4ae6372ca09622d86e135_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;ä¸è¿‡æœ€ä»¤ Robot æ„Ÿåˆ°æƒŠæ‚šçš„äº‹æƒ…è«è¿‡äºï¼Œç¬¬äºŒå¤©æ—©ä¸Šçœ‹åˆ°ä¸€ä½åŒå­¦å¤´æœä¸‹ï¼Œçªåœ¨æ²™å‘é‡Œï¼Œ2 å°æ—¶ä¸€åŠ¨ä¸åŠ¨ã€‚Robot å¿ƒé‡Œå’¯å™”äº†ä¸€ä¸‹ï¼Œé™é™è§‚å¯Ÿäº†è¿™ä½åŒå­¦çš„å‘¼å¸èµ·ä¼â€¦â€¦ï¼ˆæ­¤å¤„å°±ä¸é…å›¾äº†ï¼‰&lt;b&gt;å¤§å®¶éƒ½æ˜¯é€šå®µå‹é€‰æ‰‹ï¼Œå—¨èµ·æ¥å…¶å®éƒ½ä¸ç”¨ç¡çš„â€¦â€¦&lt;/b&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-ffc7b4a0aa877407af75bc3b0935099a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;1080&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-ffc7b4a0aa877407af75bc3b0935099a_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-ffc7b4a0aa877407af75bc3b0935099a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;1080&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-ffc7b4a0aa877407af75bc3b0935099a_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-ffc7b4a0aa877407af75bc3b0935099a_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;h2&gt;&lt;b&gt;å®Œèµ›é¡¹ç›®åˆé›†ï¼Œæœ‰ä½ æ„Ÿå…´è¶£çš„å—ï¼Ÿ&lt;/b&gt;&lt;/h2&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-16758e456675d2cf9ac696384dce5411_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;2328&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-16758e456675d2cf9ac696384dce5411_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-16758e456675d2cf9ac696384dce5411_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;2328&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-16758e456675d2cf9ac696384dce5411_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-16758e456675d2cf9ac696384dce5411_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;ä»¥ä¸Šæ˜¯æœ€åå‚ä¸ Demo Show çš„ 37 ä¸ªé¡¹ç›®ï¼Œä¸çŸ¥æœ‰æ²¡æœ‰å¤§å®¶ç‰¹åˆ«æ„Ÿå…´è¶£çš„å‘¢ï¼Ÿ&lt;/p&gt;&lt;p&gt;&lt;b&gt;ä¸ºäº†ç¤¾åŒºå°ä¼™ä¼´ä»¬éƒ½èƒ½å‚ä¸è¿›æ¥ï¼Œä¸€èµ·æ¨åŠ¨è¿™äº›ä¼˜ç§€é¡¹ç›®çš„è½åœ°ï¼Œæˆ‘ä»¬å°†é‚€è¯·éƒ¨åˆ†å‚èµ›é€‰æ‰‹æ’°æ–‡ï¼Œä¸ºå¤§å®¶æ·±å…¥ä»‹ç»ä»–ä»¬çš„é¡¹ç›®è®¾è®¡æ€è·¯ã€å®ç°è¿‡ç¨‹ä»¥åŠæœªæ¥å·¥ä½œæ–¹å‘ï¼Œæ•¬è¯·æœŸå¾…ï¼&lt;/b&gt;&lt;/p&gt;&lt;p&gt;* å®Œæ•´é¡¹ç›®ä»‹ç» &amp;amp; Repo åœ°å€ï¼š&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/pingcap/presentations/blob/master/hackathon-2019/hackathon-2019-projects.md&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;github.com/pingcap/pres&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;entations/blob/master/hackathon-2019/hackathon-2019-projects.md&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;æœ€åï¼Œ&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;æ„Ÿè°¢ UCloud æä¾›äº‘è®¡ç®—åŸºç¡€è®¾æ–½æ”¯æŒï¼Œ&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;æ„Ÿè°¢å¿—æ„¿è€…ä»¬çš„å¥‰çŒ®ï¼&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;æˆ‘ä»¬æ˜å¹´è§ï½&lt;/b&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-08e50ecbec49e3daaab0e04e1ad6eabc_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;1080&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-08e50ecbec49e3daaab0e04e1ad6eabc_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-08e50ecbec49e3daaab0e04e1ad6eabc_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;1080&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-08e50ecbec49e3daaab0e04e1ad6eabc_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-08e50ecbec49e3daaab0e04e1ad6eabc_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>ZoeyZhai</author>
<guid isPermaLink="false">2019-10-31-89438349</guid>
<pubDate>Thu, 31 Oct 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>é«˜æ•ˆç¼–æ’æœ‰çŠ¶æ€åº”ç”¨â€”â€”TiDB çš„äº‘åŸç”Ÿå®è·µä¸æ€è€ƒ</title>
<link>https://henix.github.io/feeds/zhuanlan.newsql/2019-10-29-89037305.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/89037305&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-5a5103695217f561e4e3f24d2152e650_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;ä½œè€…ï¼š &lt;a class=&quot;member_mention&quot; href=&quot;https://www.zhihu.com/people/012515fbeab1b0b61084100a805ecaa0&quot; data-hash=&quot;012515fbeab1b0b61084100a805ecaa0&quot; data-hovercard=&quot;p$b$012515fbeab1b0b61084100a805ecaa0&quot;&gt;@å´å¶ç£Š&lt;/a&gt; &lt;/p&gt;&lt;h2&gt;å¯¼è¯­&lt;/h2&gt;&lt;p&gt;äº‘åŸç”Ÿæ—¶ä»£ä»¥é™ï¼Œæ— çŠ¶æ€åº”ç”¨ä»¥å…¶å¤©ç”Ÿçš„å¯æ›¿æ¢æ€§ç‡å…ˆæˆä¸ºå„ç±»ç¼–æ’ç³»ç»Ÿçš„å® å„¿ã€‚ä»¥ Kubernetes ä¸ºä»£è¡¨çš„ç¼–æ’ç³»ç»Ÿèƒ½å¤Ÿå……åˆ†åˆ©ç”¨äº‘ä¸Šçš„å¯ç¼–ç¨‹åŸºç¡€è®¾æ–½ï¼Œå®ç°æ— çŠ¶æ€åº”ç”¨çš„å¼¹æ€§ä¼¸ç¼©ä¸è‡ªåŠ¨æ•…éšœè½¬ç§»ã€‚è¿™ç§åŸºç¡€èƒ½åŠ›çš„ä¸‹æ²‰æ— ç–‘æ˜¯å¯¹åº”ç”¨å¼€å‘è€…ç”Ÿäº§åŠ›çš„åˆä¸€æ¬¡è§£æ”¾ã€‚ ç„¶è€Œï¼Œåœ¨è½»æ¾åœ°äº¤ä»˜æ— çŠ¶æ€åº”ç”¨æ—¶ï¼Œæˆ‘ä»¬åº”å½“æ³¨æ„åˆ°ï¼ŒçŠ¶æ€æœ¬èº«å¹¶æ²¡æœ‰æ¶ˆå¤±ï¼Œè€Œæ˜¯æŒ‰ç…§å„ç±»æœ€ä½³å®è·µä¸‹æ¨åˆ°äº†åº•å±‚çš„æ•°æ®åº“ã€å¯¹è±¡å­˜å‚¨ç­‰æœ‰çŠ¶æ€åº”ç”¨ä¸Šã€‚é‚£ä¹ˆï¼Œâ€œè´Ÿé‡å‰è¡Œâ€çš„æœ‰çŠ¶æ€åº”ç”¨æ˜¯å¦èƒ½å……åˆ†åˆ©äº‘ä¸ Kubernetes çš„æ½œåŠ›ï¼Œå¤åˆ¶æ— çŠ¶æ€åº”ç”¨çš„æˆåŠŸå‘¢ï¼Ÿ&lt;/p&gt;&lt;p&gt;æˆ–è®¸ä½ å·²ç»çŸ¥é“ï¼ŒOperator æ¨¡å¼å·²ç»æˆä¸ºç¤¾åŒºåœ¨ Kubernetes ä¸Šç¼–æ’æœ‰çŠ¶æ€åº”ç”¨çš„æœ€ä½³å®è·µï¼Œè„šæ‰‹æ¶é¡¹ç›® KubeBuilder å’Œ operator-sdk ä¹Ÿå·²ç»æ„ˆå‘æˆç†Ÿï¼Œè€Œå¯¹ç£ç›˜ IO æœ‰ä¸¥è‹›è¦æ±‚çš„æ•°æ®åº“ç­‰åº”ç”¨æ‰€å¿…é¡»çš„ Local PVï¼ˆæœ¬åœ°æŒä¹…å·ï¼‰ä¹Ÿå·²ç»åœ¨ 1.14 ä¸­ GAã€‚è¿™äº›ç§¯æœ¨ä¼¼ä¹å·²ç»è¶³å¤Ÿæ­å»ºå‡ºæœ‰çŠ¶æ€åº”ç”¨åœ¨å¹³ç¨³è¿è¡Œåœ¨ Kubernetes ä¹‹ä¸Šè¿™ä¸€å’Œè°æ™¯è±¡ã€‚ç„¶è€Œï¼Œä¹¦é¢ä¸Šçš„æœ€ä½³å®è·µä¸ç”Ÿäº§ç¯å¢ƒä¹‹é—´è¿˜æœ‰æ— æ•°å·¥ç¨‹ç»†èŠ‚é€ å°±çš„é¸¿æ²Ÿï¼Œè¦åœ¨ Kubernetes ä¸Šå¯é åœ°è¿è¡Œæœ‰çŠ¶æ€åº”ç”¨ä»éœ€è¦ç›¸å½“å¤šçš„åŠªåŠ›ã€‚ä¸‹é¢æˆ‘å°†ä»¥ TiDB ä¸ Kubernetes çš„â€œçˆ±æ¨æƒ…ä»‡â€ä¸ºä¾‹ï¼Œæ€»ç»“æœ‰çŠ¶æ€åº”ç”¨èµ°å‘äº‘åŸç”Ÿçš„å·¥ç¨‹æœ€ä½³å®è·µã€‚&lt;/p&gt;&lt;h2&gt;TiDB ç®€ä»‹&lt;/h2&gt;&lt;p&gt;é¦–å…ˆè®©æˆ‘ä»¬å…ˆç†Ÿæ‚‰ç†Ÿæ‚‰ç ”ç©¶å¯¹è±¡ã€‚TiDB æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼çš„å…³ç³»å‹æ•°æ®åº“ï¼Œå®ƒé‡‡ç”¨äº†å­˜å‚¨å’Œè®¡ç®—åˆ†ç¦»çš„æ¶æ„ï¼Œå¹¶ä¸”åˆ†å±‚ååˆ†æ¸…æ™°ï¼š&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-8f4eda9feef3eadca9c611672edf88b3_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;525&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic4.zhimg.com/v2-8f4eda9feef3eadca9c611672edf88b3_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-8f4eda9feef3eadca9c611672edf88b3_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;525&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic4.zhimg.com/v2-8f4eda9feef3eadca9c611672edf88b3_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-8f4eda9feef3eadca9c611672edf88b3_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 1 TiDB æ¶æ„&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;å…¶ä¸­ TiDB æ˜¯ SQL è®¡ç®—å±‚ï¼ŒTiDB è¿›ç¨‹æ¥æ”¶ SQL è¯·æ±‚ï¼Œè®¡ç®—æŸ¥è¯¢è®¡åˆ’ï¼Œå†æ ¹æ®æŸ¥è¯¢è®¡åˆ’å»æŸ¥è¯¢å­˜å‚¨å±‚å®ŒæˆæŸ¥è¯¢ã€‚&lt;/p&gt;&lt;p&gt;å­˜å‚¨å±‚å°±æ˜¯å›¾ä¸­çš„ TiKVï¼ŒTiKV ä¼šå°†æ•°æ®æ‹†åˆ†ä¸ºä¸€ä¸ªä¸ªå°çš„æ•°æ®å—ï¼Œæ¯”å¦‚ä¸€å¼  1000000 è¡Œçš„è¡¨ï¼Œåœ¨ TiKV ä¸­å°±æœ‰å¯èƒ½è¢«æ‹†åˆ†ä¸º 200 ä¸ª 5000 è¡Œçš„æ•°æ®å—ã€‚è¿™äº›æ•°æ®å—åœ¨ TiKV ä¸­å«åš Regionï¼Œè€Œä¸ºäº†ç¡®ä¿å¯ç”¨æ€§ï¼Œ æ¯ä¸ª Region éƒ½å¯¹åº”ä¸€ä¸ª Raft Groupï¼Œé€šè¿‡ Raft Log å¤åˆ¶å®ç°æ¯ä¸ª Region è‡³å°‘æœ‰ä¸‰å‰¯æœ¬ã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-5dd409c6382dfa04bf2d726cb9745bf2_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;525&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic3.zhimg.com/v2-5dd409c6382dfa04bf2d726cb9745bf2_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-5dd409c6382dfa04bf2d726cb9745bf2_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;525&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic3.zhimg.com/v2-5dd409c6382dfa04bf2d726cb9745bf2_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-5dd409c6382dfa04bf2d726cb9745bf2_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 2 TiKV Region åˆ†å¸ƒ&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;è€Œ PD åˆ™æ˜¯é›†ç¾¤çš„å¤§è„‘ï¼Œå®ƒæ¥æ”¶ TiKV è¿›ç¨‹ä¸ŠæŠ¥çš„å­˜å‚¨ä¿¡æ¯ï¼Œå¹¶è®¡ç®—å‡ºæ•´ä¸ªé›†ç¾¤ä¸­çš„ Region åˆ†å¸ƒã€‚å€Ÿç”±æ­¤ï¼ŒTiDB ä¾¿èƒ½é€šè¿‡ PD è·çŸ¥è¯¥å¦‚ä½•è®¿é—®æŸå—æ•°æ®ã€‚æ›´é‡è¦çš„æ˜¯ï¼ŒPD è¿˜ä¼šåŸºäºé›†ç¾¤ Region åˆ†å¸ƒä¸è´Ÿè½½æƒ…å†µè¿›è¡Œæ•°æ®è°ƒåº¦ã€‚æ¯”å¦‚ï¼Œå°†è¿‡å¤§çš„ Region æ‹†åˆ†ä¸ºä¸¤ä¸ªå° Regionï¼Œé¿å… Region å¤§å°ç”±äºå†™å…¥è€Œæ— é™æ‰©å¼ ï¼›å°†éƒ¨åˆ† Leader æˆ–æ•°æ®å‰¯æœ¬ä»è´Ÿè½½è¾ƒé«˜çš„ TiKV å®ä¾‹è¿ç§»åˆ°è´Ÿè½½è¾ƒä½çš„ TiKV å®ä¾‹ä¸Šï¼Œä»¥æœ€å¤§åŒ–é›†ç¾¤æ€§èƒ½ã€‚è¿™å¼•å‡ºäº†ä¸€ä¸ªå¾ˆæœ‰è¶£çš„äº‹å®ï¼Œä¹Ÿå°±æ˜¯ TiKV è™½ç„¶æ˜¯å­˜å‚¨å±‚ï¼Œä½†å®ƒå¯ä»¥éå¸¸ç®€å•åœ°è¿›è¡Œæ°´å¹³ä¼¸ç¼©ã€‚è¿™æœ‰ç‚¹æ„æ€å¯¹å§ï¼Ÿåœ¨ä¼ ç»Ÿçš„å­˜å‚¨ä¸­ï¼Œå‡å¦‚æˆ‘ä»¬é€šè¿‡åˆ†ç‰‡æ‰“æ•£æ•°æ®ï¼Œé‚£ä¹ˆåŠ å‡èŠ‚ç‚¹æ•°å¾€å¾€éœ€è¦é‡æ–°åˆ†ç‰‡æˆ–æ‰‹å·¥è¿ç§»å¤§é‡çš„æ•°æ®ã€‚è€Œåœ¨ TiKV ä¸­ï¼Œä»¥ Region ä¸ºæŠ½è±¡çš„æ•°æ®å—è¿ç§»èƒ½å¤Ÿåœ¨ PD çš„è°ƒåº¦ä¸‹å®Œå…¨è‡ªåŠ¨åŒ–åœ°è¿›è¡Œï¼Œè€Œå¯¹äºè¿ç»´è€Œè¨€ï¼Œåªç®¡åŠ æœºå™¨å°±è¡Œäº†ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;äº†è§£æœ‰çŠ¶æ€åº”ç”¨æœ¬èº«çš„æ¶æ„ä¸ç‰¹æ€§æ˜¯è¿›è¡Œç¼–æ’çš„å‰æï¼Œæ¯”å¦‚é€šè¿‡å‰é¢çš„ä»‹ç»æˆ‘ä»¬å°±å¯ä»¥å½’çº³å‡ºï¼ŒTiDB æ˜¯æ— çŠ¶æ€çš„ï¼ŒPD å’Œ TiKV æ˜¯æœ‰çŠ¶æ€çš„ï¼Œå®ƒä»¬ä¸‰è€…å‡èƒ½ç‹¬ç«‹è¿›è¡Œæ°´å¹³ä¼¸ç¼©ã€‚æˆ‘ä»¬ä¹Ÿèƒ½çœ‹åˆ°ï¼ŒTiDB æœ¬èº«çš„è®¾è®¡å°±æ˜¯äº‘åŸç”Ÿçš„â€”â€”å®ƒçš„å®¹é”™èƒ½åŠ›å’Œæ°´å¹³ä¼¸ç¼©èƒ½åŠ›èƒ½å¤Ÿå……åˆ†å‘æŒ¥äº‘åŸºç¡€è®¾æ–½æä¾›çš„å¼¹æ€§ï¼Œæ—¢ç„¶å¦‚æ­¤ï¼Œäº‘åŸç”Ÿâ€œæ“ä½œç³»ç»Ÿâ€ Kubernetes ä¸æ­£æ˜¯äº‘åŸç”Ÿæ•°æ®åº“ TiDB çš„æœ€ä½³è½½ä½“å—ï¼ŸTiDB Operator åº”è¿è€Œç”Ÿã€‚&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;TiDB Operator ç®€ä»‹&lt;/h2&gt;&lt;p&gt;Operator å¤§å®¶éƒ½å¾ˆç†Ÿæ‚‰äº†ï¼Œç›®å‰å‡ ä¹æ¯ä¸ªå¼€æºçš„å­˜å‚¨é¡¹ç›®éƒ½æœ‰è‡ªå·±çš„ Operatorï¼Œæ¯”å¦‚é¼»ç¥– etcd-operator ä»¥åŠåæ¥çš„ prometheus-operatorã€postgres-operatorã€‚Operator çš„çµæ„Ÿå¾ˆç®€å•ï¼ŒKubernetes è‡ªèº«å°±ç”¨ Deploymentã€DaemonSet ç­‰ API å¯¹è±¡æ¥è®°å½•ç”¨æˆ·çš„æ„å›¾ï¼Œå¹¶é€šè¿‡ control loop æ§åˆ¶é›†ç¾¤çŠ¶æ€å‘ç›®æ ‡çŠ¶æ€æ”¶æ•›ï¼Œé‚£ä¹ˆæˆ‘ä»¬å½“ç„¶ä¹Ÿå¯ä»¥å®šä¹‰è‡ªå·±çš„ API å¯¹è±¡ï¼Œè®°å½•è‡ªèº«é¢†åŸŸä¸­çš„ç‰¹å®šæ„å›¾ï¼Œå¹¶é€šè¿‡è‡ªå®šä¹‰çš„ control loop å®ŒæˆçŠ¶æ€æ”¶æ•›ã€‚&lt;/p&gt;&lt;p&gt;åœ¨ Kubernetes ä¸­ï¼Œæ·»åŠ è‡ªå®šä¹‰ API å¯¹è±¡çš„æœ€ç®€å•æ–¹å¼å°±æ˜¯ CustomResourceDefinitionï¼ˆCRDï¼‰ï¼Œè€Œæ·»åŠ è‡ªå®šä¹‰ control loop çš„æœ€ç®€å•æ–¹å¼åˆ™æ˜¯éƒ¨ç½²ä¸€ä¸ªè‡ªå®šä¹‰æ§åˆ¶å™¨ã€‚è‡ªå®šä¹‰æ§åˆ¶å™¨ + CRD å°±æ˜¯ Operatorã€‚å…·ä½“åˆ° TiDB ä¸Šï¼Œç”¨æˆ·å¯ä»¥å‘ Kubernetes æäº¤ä¸€ä¸ª TidbCluster å¯¹è±¡æ¥æè¿° TiDB é›†ç¾¤å®šä¹‰ï¼Œå‡è®¾æˆ‘ä»¬è¿™é‡Œæè¿°è¯´â€œé›†ç¾¤æœ‰ 3 ä¸ª PD èŠ‚ç‚¹ã€3 ä¸ª TiDB èŠ‚ç‚¹å’Œ 3 ä¸ª TiKV èŠ‚ç‚¹â€ï¼Œè¿™æ˜¯æˆ‘ä»¬çš„æ„å›¾ã€‚ è€Œ TiDB Operator ä¸­çš„è‡ªå®šä¹‰æ§åˆ¶å™¨åˆ™ä¼šè¿›è¡Œä¸€ç³»åˆ—çš„ Kubernetes é›†ç¾¤æ“ä½œï¼Œæ¯”å¦‚åˆ†åˆ«åˆ›å»º 3 ä¸ª TiKVã€TiDBã€PD Podï¼Œæ¥è®©çœŸå®çš„é›†ç¾¤ç¬¦åˆæˆ‘ä»¬çš„æ„å›¾ã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-39a45f3e0a57456a64ab8da808bc99be_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;525&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic3.zhimg.com/v2-39a45f3e0a57456a64ab8da808bc99be_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-39a45f3e0a57456a64ab8da808bc99be_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;525&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic3.zhimg.com/v2-39a45f3e0a57456a64ab8da808bc99be_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-39a45f3e0a57456a64ab8da808bc99be_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 3 TiDB Operator&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;TiDB Operator çš„æ„ä¹‰åœ¨äºè®© TiDB èƒ½å¤Ÿæ— ç¼è¿è¡Œåœ¨ Kubernetes ä¸Šï¼Œè€Œ Kubernetes åˆä¸ºæˆ‘ä»¬æŠ½è±¡äº†åŸºç¡€è®¾æ–½ã€‚å› æ­¤ï¼ŒTiDB Operator ä¹Ÿæ˜¯ TiDB å¤šç§äº§å“å½¢æ€çš„å†…æ ¸ã€‚å¯¹äºå¸Œæœ›ç›´æ¥ä½¿ç”¨ TiDB Operator çš„ç”¨æˆ·ï¼Œ TiDB Operator èƒ½åšåˆ°åœ¨æ—¢æœ‰ Kubernetes é›†ç¾¤æˆ–å…¬æœ‰äº‘ä¸Šå¼€ç®±å³ç”¨ï¼›è€Œå¯¹äºä¸å¸Œæœ›æœ‰å¤ªå¤§è¿ç»´è´Ÿè½½ï¼Œåˆéœ€æ±‚ä¸€å¥—å®Œæ•´çš„åˆ†å¸ƒå¼æ•°æ®åº“è§£å†³æ–¹æ¡ˆçš„ç”¨æˆ·ï¼Œæˆ‘ä»¬åˆ™æä¾›äº†æ‰“åŒ… Kubernetes çš„ on-premise éƒ¨ç½²è§£å†³æ–¹æ¡ˆï¼Œç”¨æˆ·å¯ä»¥ç›´æ¥é€šè¿‡æ–¹æ¡ˆä¸­æ‰“åŒ…çš„ GUI æ“ä½œ TiDB é›†ç¾¤ï¼Œä¹Ÿèƒ½é€šè¿‡ OpenAPI å°†é›†ç¾¤ç®¡ç†èƒ½åŠ›æ¥å…¥åˆ°è‡ªå·±ç°æœ‰çš„ PaaS å¹³å°ä¸­ï¼›å¦å¤–ï¼Œå¯¹äºå®Œå…¨ä¸æƒ³è¿ç»´æ•°æ®åº“ï¼Œåªå¸Œæœ›è´­ä¹° SQL è®¡ç®—ä¸å­˜å‚¨èƒ½åŠ›çš„ç”¨æˆ·ï¼Œæˆ‘ä»¬åˆ™åŸºäº TiDB Operator æä¾›æ‰˜ç®¡çš„ TiDB æœåŠ¡ï¼Œä¹Ÿå³ DBaaSï¼ˆDatabase as a Serviceï¼‰ã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-fe4b8106d8ad8b64fc6f59f2653b8345_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;525&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic2.zhimg.com/v2-fe4b8106d8ad8b64fc6f59f2653b8345_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-fe4b8106d8ad8b64fc6f59f2653b8345_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;525&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic2.zhimg.com/v2-fe4b8106d8ad8b64fc6f59f2653b8345_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-fe4b8106d8ad8b64fc6f59f2653b8345_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 4 TiDB Operator çš„å¤šç§ä¸Šå±‚äº§å“å½¢æ€&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;å¤šæ ·çš„äº§å“å½¢æ€å¯¹ä½œä¸ºå†…æ ¸çš„ TiDB Operator æå‡ºäº†æ›´é«˜çš„è¦æ±‚ä¸æŒ‘æˆ˜â€”â€”äº‹å®ä¸Šï¼Œç”±äºæ•°æ®èµ„äº§çš„å®è´µæ€§å’Œå¼•å…¥çŠ¶æ€åå¸¦æ¥çš„å¤æ‚æ€§ï¼Œæœ‰çŠ¶æ€åº”ç”¨çš„å¯é æ€§è¦æ±‚ä¸è¿ç»´å¤æ‚åº¦å¾€å¾€è¿œé«˜äºæ— çŠ¶æ€åº”ç”¨ï¼Œè¿™ä» TiDB Operator æ‰€é¢ä¸´çš„æŒ‘æˆ˜ä¸­å°±å¯è§ä¸€æ–‘ã€‚&lt;/p&gt;&lt;h2&gt;æŒ‘æˆ˜&lt;/h2&gt;&lt;p&gt;æç»˜æ¶æ„æ€»æ˜¯è®©äººè§‰å¾—ç¾å¥½ï¼Œè€Œç”Ÿäº§ä¸­çš„å®é™…æŒ‘æˆ˜åˆ™å°†æˆ‘ä»¬æ‹–å›ç°å®ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;TiDB Operator çš„æœ€å¤§æŒ‘æˆ˜å°±æ˜¯æ•°æ®åº“çš„åœºæ™¯æå…¶ä¸¥è‹›ï¼Œå¤§é‡ç”¨æˆ·çš„æœŸç›¼éƒ½æ˜¯æˆ‘çš„æ•°æ®åº“èƒ½å¤Ÿâ€œæ°¸ä¸åœæœºâ€ï¼Œå¯¹äºæ•°æ®ä¸ä¸€è‡´æˆ–ä¸¢å¤±æ›´æ˜¯é›¶å®¹å¿&lt;/b&gt;ã€‚å¾ˆå¤šæ—¶å€™å¤§å®¶å¯¹äºæ•°æ®åº“ç­‰æœ‰çŠ¶æ€åº”ç”¨çš„å¯ç”¨æ€§è¦æ±‚ç”šè‡³æ˜¯é«˜äºæ‰¿è½½çº¿ä¸ŠæœåŠ¡çš„ Kubernetes é›†ç¾¤çš„ï¼Œè‡³å°‘çº¿ä¸Šé›†ç¾¤å®•æœºè¿˜èƒ½è¡¥æ•‘ï¼Œè€Œæ•°æ®ä¸€æ—¦å‡ºé—®é¢˜ï¼Œå¾€å¾€æ„å‘³ç€å·¨å¤§çš„æŸå¤±å’Œè¡¥æ•‘æˆæœ¬ï¼Œç”šè‡³æœ‰å¯èƒ½â€œå›å¤©ä¹æœ¯â€ã€‚è¿™æœ¬èº«ä¹Ÿä¼šåœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šå½±å“å¤§å®¶æŠŠæœ‰çŠ¶æ€åº”ç”¨æ¨ä¸Š Kubernetes çš„ä¿¡å¿ƒã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;ç¬¬äºŒä¸ªæŒ‘æˆ˜æ˜¯ç¼–æ’åˆ†å¸ƒå¼ç³»ç»Ÿè¿™ä»¶äº‹æƒ…æœ¬èº«çš„å¤æ‚æ€§&lt;/b&gt;ã€‚Kubernetes ä¸»å¯¼çš„ level driven çŠ¶æ€æ”¶æ•›æ¨¡å¼è™½ç„¶å¾ˆå¥½åœ°è§£å†³äº†å‘½ä»¤å¼ç¼–æ’åœ¨ä¸€è‡´æ€§ã€äº‹åŠ¡æ€§ä¸Šçš„ç§ç§é—®é¢˜ï¼Œä½†å®ƒæœ¬èº«çš„å¿ƒæ™ºæ¨¡å‹æ˜¯æ›´ä¸ºæŠ½è±¡çš„ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘æ¯ä¸€ç§å¯èƒ½çš„çŠ¶æ€å¹¶é’ˆå¯¹æ€§åœ°è®¾è®¡æ”¶æ•›ç­–ç•¥ï¼Œè€Œæœ€åçš„å®é™…çŠ¶æ€æ”¶æ•›è·¯å¾„æ˜¯éšç€ç¯å¢ƒè€Œå˜åŒ–çš„ï¼Œæˆ‘ä»¬å¾ˆéš¾å¯¹æ•´ä¸ªè¿‡ç¨‹è¿›è¡Œå‡†ç¡®çš„é¢„æµ‹å’ŒéªŒè¯ã€‚å‡å¦‚æˆ‘ä»¬ä¸èƒ½æœ‰æ•ˆåœ°æ§åˆ¶ç¼–æ’å±‚é¢çš„å¤æ‚åº¦ï¼Œæœ€åçš„ç»“æœå°±æ˜¯æ²¡æœ‰äººèƒ½æ‹èƒ¸è„¯ä¿è¯ TiDB Operator èƒ½å¤Ÿæ»¡è¶³ä¸Šé¢æåˆ°çš„ä¸¥è‹›æŒ‘æˆ˜ï¼Œé‚£ä¹ˆèµ°å‘ç”Ÿäº§ä¹Ÿå°±æ— ä»è°ˆèµ·äº†ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;ç¬¬ä¸‰ä¸ªæŒ‘æˆ˜æ˜¯å­˜å‚¨&lt;/b&gt;ã€‚æ•°æ®åº“å¯¹äºç£ç›˜å’Œç½‘ç»œçš„ IO æ€§èƒ½ç›¸å½“æ•æ„Ÿï¼Œè€Œåœ¨ Kubernetes ä¸Šï¼Œæœ€ä¸»æµçš„å„ç±»ç½‘ç»œå­˜å‚¨å¾ˆéš¾æ»¡è¶³ TiDB å¯¹ç£ç›˜ IO æ€§èƒ½çš„è¦æ±‚ã€‚å‡å¦‚æˆ‘ä»¬ä½¿ç”¨æœ¬åœ°å­˜å‚¨ï¼Œåˆ™ä¸å¾—ä¸é¢å¯¹æœ¬åœ°å­˜å‚¨çš„æ˜“å¤±æ€§é—®é¢˜â€”â€”ç£ç›˜æ•…éšœæˆ–èŠ‚ç‚¹æ•…éšœéƒ½ä¼šå¯¼è‡´æŸå—å­˜å‚¨ä¸å¯ç”¨ï¼Œè€Œè¿™ä¸¤ç§æ•…éšœåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­æ˜¯å®¶å¸¸ä¾¿é¥­ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;æœ€åçš„é—®é¢˜æ˜¯ï¼Œå°½ç®¡ Kubernetes æˆåŠŸæŠ½è±¡äº†åŸºç¡€è®¾æ–½çš„è®¡ç®—èƒ½åŠ›ä¸å­˜å‚¨èƒ½åŠ›ï¼Œä½†åœ¨å®é™…åœºæ™¯çš„æˆæœ¬ä¼˜åŒ–ä¸Šè€ƒè™‘å¾—å¾ˆå°‘&lt;/b&gt;ã€‚å¯¹äºå…¬æœ‰äº‘ã€ç§æœ‰äº‘ã€è£¸é‡‘å±ç­‰ä¸åŒçš„åŸºç¡€è®¾æ–½ç¯å¢ƒï¼ŒTiDB Operator éœ€è¦æ›´é«˜çº§ã€ç‰¹åŒ–çš„è°ƒåº¦ç­–ç•¥æ¥åšæˆæœ¬ä¼˜åŒ–ã€‚å¤§å®¶ä¹ŸçŸ¥é“ï¼Œæˆæœ¬ä¼˜åŒ–æ˜¯æ²¡æœ‰å°½å¤´çš„ï¼Œå¹¶ä¸”å¾€å¾€ä¼´éšç€ä¸€äº›ç‰ºç‰²ï¼Œæ€ä¹ˆæ‰¾åˆ°ä¼˜åŒ–è¿‡ç¨‹ä¸­è¾¹é™…æ”¶ç›Šæœ€å¤§åŒ–çš„ç‚¹ï¼ŒåŒæ ·ä¹Ÿæ˜¯éå¸¸æœ‰æ„æ€çš„é—®é¢˜ä¹‹ä¸€ã€‚&lt;/p&gt;&lt;p&gt;å…¶ä¸­ï¼Œåœºæ™¯ä¸¥è‹›å¯ä»¥ä½œä¸ºä¸€ä¸ªå‰ææ¡ä»¶ï¼Œè€Œé’ˆå¯¹æ€§çš„æˆæœ¬ä¼˜åŒ–åˆ™ä¸å¤Ÿæœ‰æ™®é€‚æ€§ã€‚æˆ‘ä»¬æ¥ä¸‹æ¥å°±ä»ç¼–æ’å’Œå­˜å‚¨ä¸¤å—å…¥æ‰‹ï¼Œä»å®é™…ä¾‹å­æ¥çœ‹ TiDB ä¸ TiDB Operator å¦‚ä½•è§£å†³è¿™äº›é—®é¢˜ï¼Œå¹¶æ¨å¹¿åˆ°ä¸€èˆ¬çš„æœ‰çŠ¶æ€åº”ç”¨ä¸Šã€‚&lt;/p&gt;&lt;h2&gt;æ§åˆ¶å™¨â€”â€”å‰ªä¸æ–­ï¼Œç†è¿˜ä¹±&lt;/h2&gt;&lt;p&gt;TiDB Operator éœ€è¦é©±åŠ¨é›†ç¾¤å‘æœŸæœ›çŠ¶æ€æ”¶æ•›ï¼Œè€Œæœ€ç®€å•çš„é©±åŠ¨æ–¹å¼å°±æ˜¯åˆ›å»ºä¸€ç»„ Pod æ¥ç»„æˆ TiDB é›†ç¾¤ã€‚é€šè¿‡ç›´æ¥æ“ä½œ Podï¼Œæˆ‘ä»¬å¯ä»¥è‡ªç”±åœ°æ§åˆ¶æ‰€æœ‰ç¼–æ’ç»†èŠ‚ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;é€šè¿‡æ›¿æ¢ Pod ä¸­å®¹å™¨çš„ image å­—æ®µå®ŒæˆåŸåœ°å‡çº§ã€‚&lt;/li&gt;&lt;li&gt;è‡ªç”±å†³å®šä¸€ç»„ Pod çš„å‡çº§é¡ºåºã€‚&lt;/li&gt;&lt;li&gt;è‡ªç”±ä¸‹çº¿ä»»æ„ Podã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;äº‹å®ä¸Šæˆ‘ä»¬ä¹Ÿç¡®å®é‡‡ç”¨è¿‡å®Œå…¨æ“ä½œ Pod çš„æ–¹æ¡ˆï¼Œä½†æ˜¯å½“çœŸæ­£æ¨è¿›è¯¥æ–¹æ¡ˆæ—¶æˆ‘ä»¬æ‰å‘ç°ï¼Œè¿™ç§å®Œå…¨â€œè‡ªå·±é€ è½®å­â€çš„æ–¹æ¡ˆä¸ä»…å¼€å‘å¤æ‚ï¼Œè€Œä¸”éªŒè¯æˆæœ¬éå¸¸é«˜ã€‚è¯•æƒ³ï¼Œä¸ºä»€ä¹ˆå¤§å®¶å¯¹ Kubernetes çš„æ¥å—åº¦è¶Šæ¥è¶Šé«˜ï¼Œ å³ä½¿æ˜¯ä¼ ç»Ÿä¸Šè¾ƒä¸ºä¿å®ˆçš„å…¬å¸ç°åœ¨ä¹Ÿæ•¢äºæ‹¥æŠ± Kuberentesï¼Ÿé™¤äº† Kubernetes æœ¬èº«é¡¹ç›®ç´ è´¨è¿‡ç¡¬ä¹‹å¤–ï¼Œæ›´é‡è¦çš„æ˜¯æœ‰æ•´ä¸ªç¤¾åŒºä¸ºå®ƒèƒŒä¹¦ã€‚æˆ‘ä»¬çŸ¥é“ Kubernetes å·²ç»åœ¨å„ç§åœºæ™¯ä¸‹ç»å—è¿‡å¤§é‡çš„ç”Ÿäº§ç¯å¢ƒè€ƒéªŒï¼Œè¿™ç§ä¿¡å¿ƒæ˜¯å„ç±»æµ‹è¯•æ‰‹æ®µéƒ½æ²¡æ³•ç»™åˆ°æˆ‘ä»¬çš„ã€‚å›åˆ° TiDB Operator ä¸Šï¼Œé€‰æ‹©ç›´æ¥æ“ä½œ Pod å°±æ„å‘³ç€æˆ‘ä»¬æŠ›å¼ƒäº†ç¤¾åŒºåœ¨ StatefulSetã€Deployment ç­‰å¯¹è±¡ä¸­æ²‰æ·€çš„ç¼–æ’ç»éªŒï¼Œéšä¹‹å¸¦æ¥çš„å·¨å¤§éªŒè¯æˆæœ¬å¤§å¤§å½±å“äº†æ•´ä¸ªé¡¹ç›®çš„å¼€å‘æ•ˆç‡ã€‚&lt;/p&gt;&lt;p&gt;å› æ­¤ï¼Œåœ¨ç›®å‰çš„ TiDB Operator é¡¹ç›®ä¸­ï¼Œå¤§å®¶å¯ä»¥çœ‹åˆ°æ§åˆ¶å™¨çš„ä¸»è¦æ“ä½œå¯¹è±¡æ˜¯ StatefulSetã€‚StatefulSet èƒ½å¤Ÿæ»¡è¶³æœ‰çŠ¶æ€åº”ç”¨çš„å¤§éƒ¨åˆ†é€šç”¨ç¼–æ’éœ€æ±‚ã€‚å½“ç„¶ï¼ŒStatefulSet ä¸ºäº†åšåˆ°é€šç”¨åŒ–ï¼Œåšäº†å¾ˆå¤šä¸å¿…è¦çš„å‡è®¾ï¼Œæ¯”å¦‚é«˜åºå·çš„ Pod æ˜¯éšå¼ä¾èµ–ä½åºå· Pod çš„ï¼Œè¿™ä¼šç»™æˆ‘ä»¬å¸¦æ¥ä¸€äº›é¢å¤–çš„é™åˆ¶ï¼Œæ¯”å¦‚ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;æ— æ³•æŒ‡å®š Pod è¿›è¡Œä¸‹çº¿ç¼©å®¹ã€‚&lt;/li&gt;&lt;li&gt;æ»šåŠ¨æ›´æ–°é¡ºåºå›ºå®šã€‚&lt;/li&gt;&lt;li&gt;æ»šåŠ¨æ›´æ–°éœ€è¦åé©± Pod å…¨éƒ¨ Readyã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;StatefulSet å’Œ Pod çš„æŠ‰æ‹©ï¼Œæœ€ç»ˆæ˜¯çµæ´»æ€§å’Œå¯é æ€§çš„æƒè¡¡ï¼Œè€Œåœ¨ TiDB é¢ä¸´çš„ä¸¥è‹›åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬åªæœ‰å…ˆåšåˆ°å¯é ï¼Œæ‰èƒ½åšå¼€å‘ã€æ•¢åšå¼€å‘ã€‚æœ€åçš„é€‰æ‹©è‡ªç„¶å°±å‘¼ä¹‹æ¬²å‡ºâ€”â€”StatefulSetã€‚å½“ç„¶ï¼Œè¿™é‡Œå¹¶ä¸æ˜¯è¯´ï¼Œä½¿ç”¨åŸºäºé«˜çº§å¯¹è±¡è¿›è¡Œç¼–æ’çš„æ–¹æ¡ˆè¦æ¯”åŸºäº Pod è¿›è¡Œç¼–æ’çš„æ–¹æ¡ˆæ›´å¥½ï¼Œåªæ˜¯è¯´æˆ‘ä»¬åœ¨å½“æ—¶è®¤ä¸ºé€‰æ‹© StatefulSet æ˜¯ä¸€ä¸ªæ›´å¥½çš„æƒè¡¡ã€‚å½“ç„¶è¿™ä¸ªæ•…äº‹è¿˜æ²¡æœ‰ç»“æŸï¼Œå½“æˆ‘ä»¬åŸºäº StatefulSet æŠŠç¬¬ä¸€ç‰ˆ TiDB Operator åšç¨³å®šåï¼Œæˆ‘ä»¬æ­£åœ¨æ¥ä¸‹æ¥çš„ç‰ˆæœ¬ä¸­å¼€å‘ä¸€ä¸ªæ–°çš„å¯¹è±¡æ¥æ°´å¹³æ›¿æ¢ StatefulSetï¼Œè¿™ä¸ªå¯¹è±¡å¯ä»¥ä½¿ç”¨ç¤¾åŒºç§¯ç´¯çš„ StatefulSet æµ‹è¯•ç”¨ä¾‹è¿›è¡ŒéªŒè¯ï¼ŒåŒæ—¶åˆå¯ä»¥è§£é™¤ä¸Šé¢æåˆ°çš„é¢å¤–é™åˆ¶ï¼Œç»™æˆ‘ä»¬æä¾›æ›´å¥½çš„çµæ´»æ€§ã€‚ å‡å¦‚ä½ ä¹Ÿåœ¨è€ƒè™‘ä»é›¶å¼€å§‹æ­å»ºä¸€ä¸ª Operatorï¼Œæˆ–è®¸ä¹Ÿå¯ä»¥å‚è€ƒâ€œå…ˆåŸºäºæˆç†Ÿçš„åŸç”Ÿå¯¹è±¡å¿«é€Ÿè¿­ä»£ï¼Œåœ¨éªŒè¯äº†ä»·å€¼åå†å¢å¼ºæˆ–æ›¿æ¢åŸç”Ÿå¯¹è±¡æ¥è§£å†³é«˜çº§éœ€æ±‚â€è¿™æ¡è½åœ°è·¯å¾„ã€‚&lt;/p&gt;&lt;p&gt;æ¥ä¸‹æ¥çš„é—®é¢˜æ˜¯æ§åˆ¶å™¨å¦‚ä½•åè°ƒåŸºç¡€è®¾æ–½å±‚çš„çŠ¶æ€ä¸åº”ç”¨å±‚çš„çŠ¶æ€ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œåœ¨æ»šåŠ¨å‡çº§ TiKV æ—¶ï¼Œæ¯æ¬¡é‡å¯ TiKV å®ä¾‹å‰ï¼Œéƒ½è¦å…ˆé©±é€è¯¥å®ä¾‹ä¸Šçš„æ‰€æœ‰ Region Leaderï¼›è€Œåœ¨ç¼©å®¹ TiKV æ—¶ï¼Œåˆ™è¦å…ˆåœ¨ PD ä¸­å°†å¾…ç¼©å®¹çš„ TiKV ä¸‹çº¿ï¼Œç­‰å¾…å¾…ç¼©å®¹çš„ TiKV å®ä¾‹ä¸Šçš„ Region å…¨éƒ¨è¿ç§»èµ°ï¼ŒPD è®¤ä¸º TiKV ä¸‹çº¿å®Œæˆæ—¶ï¼Œå†çœŸæ­£æ‰§è¡Œç¼©å®¹æ“ä½œè°ƒæ•´ Pod ä¸ªæ•°ã€‚è¿™äº›éƒ½æ˜¯åœ¨ç¼–æ’ä¸­åè°ƒåº”ç”¨å±‚çŠ¶æ€çš„ä¾‹å­ï¼Œæˆ‘ä»¬å¯ä»¥æ€ä¹ˆåšè‡ªåŠ¨åŒ–å‘¢ï¼Ÿ&lt;/p&gt;&lt;p&gt;å¤§å®¶ä¹Ÿæ³¨æ„åˆ°äº†ï¼Œä¸Šé¢çš„ä¾‹å­éƒ½å’Œ Pod ä¸‹çº¿æŒ‚é’©ï¼Œå› æ­¤ä¸€ä¸ªç®€å•çš„æ–¹æ¡ˆå°±é€šè¿‡ container lifecycle hookï¼Œåœ¨ preStop æ—¶æ‰§è¡Œä¸€ä¸ªè„šæœ¬è¿›è¡Œåè°ƒã€‚è¿™ä¸ªæ–¹æ¡ˆç¢°åˆ°çš„ç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯ç¼ºä¹å…¨å±€ä¿¡æ¯ï¼Œè„šæœ¬ä¸­æ— æ³•åŒºåˆ†å½“å‰æ˜¯åœ¨æ»šåŠ¨å‡çº§è¿˜æ˜¯ç¼©å®¹ã€‚å½“ç„¶ï¼Œè¿™å¯ä»¥é€šè¿‡åœ¨è„šæœ¬ä¸­æŸ¥è¯¢ apiserver æ¥ç»•è¿‡ã€‚æ›´å¤§çš„é—®é¢˜æ˜¯ preStop hook å­˜åœ¨ grace periodï¼Œkubelet æœ€å¤šç­‰å¾… .spec.terminationGracePeriodSeconds è¿™ä¹ˆé•¿çš„æ—¶é—´ï¼Œå°±ä¼šå¼ºåˆ¶åˆ é™¤ Podã€‚å¯¹äº TiDB çš„åœºæ™¯è€Œè¨€ï¼Œæˆ‘ä»¬æ›´å¸Œæœ›åœ¨è‡ªåŠ¨çš„ä¸‹çº¿é€»è¾‘å¤±è´¥æ—¶è¿›è¡Œç­‰å¾…å¹¶æŠ¥è­¦ï¼Œé€šçŸ¥è¿ç»´äººå‘˜ä»‹å…¥ï¼Œä»¥ä¾¿äºæœ€å°åŒ–å½±å“ï¼Œå› æ­¤åŸºäº container hook æ¥åšæ˜¯ä¸å¯æ¥å—çš„ã€‚&lt;/p&gt;&lt;p&gt;ç¬¬äºŒç§æ–¹æ¡ˆæ˜¯åœ¨æ§åˆ¶å¾ªç¯ä¸­æ¥åè°ƒåº”ç”¨å±‚çš„çŠ¶æ€ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ partition å­—æ®µæ¥æ§åˆ¶ StatefulSet å‡çº§è¿›åº¦ï¼Œå¹¶åœ¨å‡çº§å‰ç¡®ä¿ leader è¿ç§»å®Œæ¯•ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-803d2ddb2796b89e538432f4398c1611_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;525&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic2.zhimg.com/v2-803d2ddb2796b89e538432f4398c1611_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-803d2ddb2796b89e538432f4398c1611_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;525&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic2.zhimg.com/v2-803d2ddb2796b89e538432f4398c1611_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-803d2ddb2796b89e538432f4398c1611_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 5 åœ¨æ§åˆ¶å¾ªç¯ä¸­åè°ƒçŠ¶æ€&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;åœ¨ä¼ªä»£ç ä¸­ï¼Œæ¯æ¬¡æˆ‘ä»¬å› ä¸ºè¦å°†æ‰€æœ‰ Pod æ”¶æ•›åˆ°æ–°ç‰ˆæœ¬è€Œè¿›å…¥è¿™æ®µæ§åˆ¶é€»è¾‘æ—¶ï¼Œéƒ½ä¼šå…ˆæ£€æŸ¥ä¸‹ä¸€ä¸ªè¦å¾…å‡çº§çš„ TiKV å®ä¾‹ä¸Š leader æ˜¯å¦è¿ç§»å®Œæ¯•ï¼Œç›´åˆ°è¿ç§»å®Œæ¯•æ‰ä¼šç»§ç»­å¾€ä¸‹èµ°ï¼Œè°ƒæ•´ partition å‚æ•°ï¼Œå¼€å§‹å‡çº§å¯¹åº”çš„ TiKV å®ä¾‹ã€‚ç¼©å®¹ä¹Ÿæ˜¯ç±»ä¼¼çš„é€»è¾‘ã€‚ä½†ä½ å¯èƒ½å·²ç»æ„è¯†åˆ°ï¼Œç¼©å®¹å’Œæ»šåŠ¨æ›´æ–°ä¸¤ä¸ªæ“ä½œæ˜¯æœ‰å¯èƒ½åŒæ—¶å‡ºç°åœ¨çŠ¶æ€æ”¶æ•›çš„è¿‡ç¨‹ä¸­çš„ï¼Œä¹Ÿå°±æ˜¯åŒæ—¶ä¿®æ”¹ replicas å’Œ image å­—æ®µã€‚è¿™æ—¶å€™ç”±äºæ§åˆ¶å™¨éœ€è¦åŒºåˆ†ç¼©å®¹ä¸æ»šåŠ¨æ›´æ–°ï¼Œè¯¸å¦‚æ­¤ç±»çš„è¾¹ç•Œæ¡ä»¶ä¼šè®©æ§åˆ¶å™¨è¶Šæ¥è¶Šå¤æ‚ã€‚&lt;/p&gt;&lt;p&gt;ç¬¬ä¸‰ç§æ–¹æ¡ˆæ˜¯ä½¿ç”¨ Kubernetes çš„ Admission Webhook å°†ä¸€éƒ¨åˆ†åè°ƒé€»è¾‘ä»æ§åˆ¶å™¨ä¸­æ‹†å‡ºæ¥ï¼Œæ”¾åˆ°æ›´çº¯ç²¹çš„åˆ‡é¢å½“ä¸­ã€‚é’ˆå¯¹è¿™ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å¯ä»¥æ‹¦æˆª Pod çš„ Delete è¯·æ±‚å’Œé’ˆå¯¹ä¸Šå±‚å¯¹è±¡çš„ Update è¯·æ±‚ï¼Œæ£€æŸ¥ç¼©å®¹æˆ–æ»šåŠ¨å‡çº§çš„å‰ç½®æ¡ä»¶ï¼Œå‡å¦‚ä¸æ»¡è¶³ï¼Œåˆ™æ‹’ç»è¯·æ±‚å¹¶è§¦å‘æŒ‡ä»¤è¿›è¡Œåè°ƒï¼Œæ¯”å¦‚é©±é€ leaderï¼Œå‡å¦‚æ»¡è¶³ï¼Œé‚£ä¹ˆå°±æ”¾è¡Œè¯·æ±‚ã€‚æ§åˆ¶å¾ªç¯ä¼šä¸æ–­ä¸‹å‘æŒ‡ä»¤ç›´åˆ°çŠ¶æ€æ”¶æ•›ï¼Œå› æ­¤ webhook å°±ç›¸åº”åœ°ä¼šä¸æ–­è¿›è¡Œæ£€æŸ¥ç›´åˆ°æ¡ä»¶æ»¡è¶³ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-fc1a229e38e2de39b8cf4a4c99c3cc42_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;525&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic3.zhimg.com/v2-fc1a229e38e2de39b8cf4a4c99c3cc42_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-fc1a229e38e2de39b8cf4a4c99c3cc42_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;525&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic3.zhimg.com/v2-fc1a229e38e2de39b8cf4a4c99c3cc42_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-fc1a229e38e2de39b8cf4a4c99c3cc42_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 6 åœ¨ Webhook ä¸­åè°ƒçŠ¶æ€&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;è¿™ç§æ–¹æ¡ˆçš„å¥½å¤„æ˜¯æˆ‘ä»¬æŠŠé€»è¾‘æ‹†åˆ†åˆ°äº†ä¸€ä¸ªä¸æ§åˆ¶å™¨å‚ç›´çš„å•å…ƒä¸­ï¼Œä»è€Œå¯ä»¥æ›´å®¹æ˜“åœ°ç¼–å†™ä¸šåŠ¡ä»£ç å’Œå•å…ƒæµ‹è¯•ã€‚å½“ç„¶ï¼Œè¿™ä¸ªæ–¹æ¡ˆä¹Ÿæœ‰ç¼ºç‚¹ï¼Œä¸€æ˜¯å¼•å…¥äº†æ–°çš„é”™è¯¯æ¨¡å¼ï¼Œå¤„ç† webhook çš„ server å‡å¦‚å®•æœºï¼Œä¼šé€ æˆé›†ç¾¤åŠŸèƒ½é™çº§ï¼›äºŒæ˜¯è¯¥æ–¹æ¡ˆé€‚ç”¨é¢å¹¶ä¸å¹¿ï¼Œåªèƒ½ç”¨äºçŠ¶æ€åè°ƒä¸ç‰¹å®šçš„ Kubernetes API æ“ä½œå¼ºç›¸å…³çš„åœºæ™¯ã€‚åœ¨å®é™…çš„ä»£ç å®è·µä¸­ï¼Œæˆ‘ä»¬ä¼šæŒ‰ç…§å…·ä½“åœºæ™¯é€‰æ‹©æ–¹æ¡ˆäºŒæˆ–æ–¹æ¡ˆä¸‰ï¼Œå¤§å®¶ä¹Ÿå¯ä»¥åˆ°é¡¹ç›®ä¸­ä¸€æ¢ç©¶ç«Ÿã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;ä¸Šé¢çš„ä¸¤ä¸ªä¾‹å­éƒ½æ˜¯å…³äºå¦‚ä½•æ§åˆ¶ç¼–æ’é€»è¾‘å¤æ‚åº¦çš„ï¼Œå…³äº Operator çš„å„ç±»ç§‘æ™®æ–‡ä¸­éƒ½ä¼šç”¨ä¸€å¥â€œåœ¨è‡ªå®šä¹‰æ§åˆ¶å™¨ä¸­ç¼–å†™é¢†åŸŸç‰¹å®šçš„è¿ç»´çŸ¥è¯†â€å°†è¿™ä¸€éƒ¨åˆ†è½»ææ·¡å†™åœ°ä¸€ç¬”å¸¦è¿‡ï¼Œè€Œæˆ‘ä»¬çš„å®è·µå‘Šè¯‰æˆ‘ä»¬ï¼ŒçœŸæ­£ç¼–å†™ç”Ÿäº§çº§ çš„è‡ªå®šä¹‰æ§åˆ¶å™¨å……æ»¡æŒ‘æˆ˜ä¸æŠ‰æ‹©ã€‚&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;Local PV â€”â€” æƒ³è¯´çˆ±ä½ ä¸å®¹æ˜“&lt;/h2&gt;&lt;p&gt;æ¥ä¸‹æ¥æ˜¯å­˜å‚¨çš„é—®é¢˜ã€‚æˆ‘ä»¬ä¸å¦¨çœ‹çœ‹ Kubernetes ä¸ºæˆ‘ä»¬æä¾›äº†å“ªäº›å­˜å‚¨æ–¹æ¡ˆï¼š&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-943080c31fad592402b61e8dc462f044_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;525&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic1.zhimg.com/v2-943080c31fad592402b61e8dc462f044_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-943080c31fad592402b61e8dc462f044_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;525&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic1.zhimg.com/v2-943080c31fad592402b61e8dc462f044_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-943080c31fad592402b61e8dc462f044_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 7 å­˜å‚¨æ–¹æ¡ˆ&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;å…¶ä¸­ï¼Œæœ¬åœ°ä¸´æ—¶å­˜å‚¨ä¸­çš„æ•°æ®ä¼šéšç€ Pod è¢«åˆ é™¤è€Œæ¸…ç©ºï¼Œå› æ­¤ä¸é€‚ç”¨äºæŒä¹…å­˜å‚¨ã€‚&lt;/p&gt;&lt;p&gt;è¿œç¨‹å­˜å‚¨åˆ™é¢ä¸´ä¸¤ä¸ªé—®é¢˜ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;é€šå¸¸æ¥è¯´ï¼Œè¿œç¨‹å­˜å‚¨çš„æ€§èƒ½è¾ƒå·®ï¼Œè¿™å°¤å…¶ä½“ç°åœ¨ IOPS ä¸å¤Ÿç¨³å®šä¸Šï¼Œå› æ­¤å¯¹äºç£ç›˜æ€§èƒ½æœ‰ä¸¥æ ¼è¦æ±‚çš„æœ‰çŠ¶æ€åº”ç”¨ï¼Œå¤§å¤šæ•°è¿œç¨‹å­˜å‚¨æ˜¯ä¸é€‚ç”¨çš„ã€‚&lt;/li&gt;&lt;li&gt;é€šå¸¸æ¥è¯´ï¼Œè¿œç¨‹å­˜å‚¨æœ¬èº«ä¼šåšä¸‰å‰¯æœ¬ï¼Œå› æ­¤å•ä½æˆæœ¬è¾ƒé«˜ï¼Œè¿™å¯¹äºåœ¨å­˜å‚¨å±‚å·²ç»å®ç°ä¸‰å‰¯æœ¬çš„ TiDB æ¥è¯´æ˜¯ä¸å¿…è¦çš„æˆæœ¬å¼€é”€ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;å› æ­¤ï¼Œæœ€é€‚ç”¨äº TiDB çš„æ˜¯æœ¬åœ°æŒä¹…å­˜å‚¨ã€‚è¿™å…¶ä¸­ï¼ŒhostPath çš„ç”Ÿå‘½å‘¨æœŸåˆä¸è¢« Kubernetes ç®¡ç†ï¼Œéœ€è¦ä»˜å‡ºé¢å¤–çš„ç»´æŠ¤æˆæœ¬ï¼Œæœ€ç»ˆçš„é€‰é¡¹å°±åªå‰©ä¸‹äº† Local PVã€‚&lt;/p&gt;&lt;p&gt;Local PV å¹¶éå…è´¹çš„åˆé¤ï¼Œæ‰€æœ‰çš„æ–‡æ¡£éƒ½ä¼šå‘Šè¯‰æˆ‘ä»¬ Local PV æœ‰ä»¥ä¸‹é™åˆ¶ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;æ•°æ®æ˜“å¤±ï¼ˆç›¸æ¯”äºè¿œç¨‹å­˜å‚¨çš„ä¸‰å‰¯æœ¬ï¼‰ã€‚&lt;/li&gt;&lt;li&gt;èŠ‚ç‚¹æ•…éšœä¼šå½±å“æ•°æ®è®¿é—®ã€‚&lt;/li&gt;&lt;li&gt;éš¾ä»¥å‚ç›´æ‰©å±•å®¹é‡ï¼ˆç›¸å½“ä¸€éƒ¨åˆ†è¿œç¨‹å­˜å‚¨å¯ä»¥ç›´æ¥è°ƒæ•´ volume å¤§å°ï¼‰ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;è¿™äº›é—®é¢˜åŒæ ·ä¹Ÿæ˜¯åœ¨ä¼ ç»Ÿçš„è™šæ‹Ÿæœºè¿ç»´åœºæ™¯ä¸‹çš„ç—›ç‚¹ï¼Œå› æ­¤ TiDB æœ¬èº«è®¾è®¡å°±å……åˆ†è€ƒè™‘äº†è¿™äº›é—®é¢˜ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;æœ¬åœ°å­˜å‚¨çš„æ˜“å¤±æ€§è¦æ±‚åº”ç”¨è‡ªèº«å®ç°æ•°æ®å†—ä½™ã€‚&lt;/li&gt;&lt;ul&gt;&lt;li&gt;TiDB çš„å­˜å‚¨å±‚ TiKV é»˜è®¤å°±ä¸ºæ¯ä¸ª Region ç»´æŠ¤è‡³å°‘ä¸‰å‰¯æœ¬ã€‚&lt;/li&gt;&lt;li&gt;å½“å‰¯æœ¬ç¼ºå¤±æ—¶ï¼ŒTiKV èƒ½è‡ªåŠ¨è¡¥é½å‰¯æœ¬æ•°ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;èŠ‚ç‚¹æ•…éšœä¼šå½±å“æœ¬åœ°å­˜å‚¨çš„æ•°æ®è®¿é—®ã€‚&lt;/li&gt;&lt;ul&gt;&lt;li&gt;èŠ‚ç‚¹æ•…éšœåï¼Œç›¸å…³ Region ä¼šé‡æ–°è¿›è¡Œ leader é€‰ä¸¾ï¼Œå°†è¯»å†™è‡ªåŠ¨è¿ç§»åˆ°å¥åº·èŠ‚ç‚¹ä¸Šã€‚&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;æœ¬åœ°å­˜å‚¨çš„å®¹é‡éš¾ä»¥å‚ç›´æ‰©å±•ã€‚&lt;/li&gt;&lt;ul&gt;&lt;li&gt;TiKV çš„è‡ªåŠ¨æ•°æ®åˆ‡åˆ†ä¸è°ƒåº¦èƒ½å¤Ÿå®ç°æ°´å¹³ä¼¸ç¼©ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;p&gt;å­˜å‚¨å±‚çš„è¿™äº›å…³é”®ç‰¹æ€§æ˜¯ TiDB é«˜æ•ˆä½¿ç”¨ Local PV çš„å‰ææ¡ä»¶ï¼Œä¹Ÿæ˜¯ TiDB æ°´å¹³ä¼¸ç¼©çš„å…³é”®æ‰€åœ¨ã€‚å½“ç„¶ï¼Œåœ¨å‘ç”ŸèŠ‚ç‚¹æ•…éšœæˆ–ç£ç›˜æ•…éšœæ—¶ï¼Œç”±äºæ—§ Pod æ— æ³•æ­£å¸¸è¿è¡Œï¼Œæˆ‘ä»¬éœ€è¦è‡ªå®šä¹‰æ§åˆ¶å™¨å¸®åŠ©æˆ‘ä»¬è¿›è¡Œæ¢å¤ï¼ŒåŠæ—¶è¡¥é½å®ä¾‹æ•°ï¼Œç¡®ä¿æœ‰è¶³å¤Ÿçš„å¥åº·å®ä¾‹æ¥æä¾›æ•´ä¸ªé›†ç¾¤æ‰€éœ€çš„å­˜å‚¨ç©ºé—´ã€è®¡ç®—èƒ½åŠ›ä¸ IO èƒ½åŠ›ã€‚è¿™ä¹Ÿå°±æ˜¯è‡ªåŠ¨æ•…éšœè½¬ç§»ã€‚&lt;/p&gt;&lt;p&gt;æˆ‘ä»¬å…ˆçœ‹ä¸€çœ‹ä¸ºä»€ä¹ˆ TiDB çš„å­˜å‚¨å±‚ä¸èƒ½åƒæ— çŠ¶æ€åº”ç”¨æˆ–è€…ä½¿ç”¨è¿œç¨‹å­˜å‚¨çš„ Pod é‚£æ ·è‡ªåŠ¨è¿›è¡Œæ•…éšœè½¬ç§»ã€‚å‡è®¾ä¸‹å›¾ä¸­çš„èŠ‚ç‚¹å‘ç”Ÿäº†æ•…éšœï¼Œç”±äº TiKV-1 ç»‘å®šäº†èŠ‚ç‚¹ä¸Šçš„ PVï¼Œåªèƒ½è¿è¡Œåœ¨è¯¥èŠ‚ç‚¹ä¸Šï¼Œå› æ­¤ åœ¨èŠ‚ç‚¹æ¢å¤å‰ï¼ŒTiKV-1 å°†ä¸€ç›´å¤„äº Pending çŠ¶æ€ï¼š&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-b90337525fa64a1e08842cb95db8ac62_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;525&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic3.zhimg.com/v2-b90337525fa64a1e08842cb95db8ac62_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-b90337525fa64a1e08842cb95db8ac62_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;525&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic3.zhimg.com/v2-b90337525fa64a1e08842cb95db8ac62_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-b90337525fa64a1e08842cb95db8ac62_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 8 èŠ‚ç‚¹æ•…éšœ&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;æ­¤æ—¶ï¼Œå‡å¦‚æˆ‘ä»¬èƒ½å¤Ÿç¡®è®¤ Node å·²ç»å®•æœºå¹¶ä¸”çŸ­æœŸæ— æ³•æ¢å¤ï¼Œé‚£ä¹ˆå°±å¯ä»¥åˆ é™¤ Node å¯¹è±¡ï¼ˆæ¯”å¦‚ NodeController åœ¨å…¬æœ‰ä¸Šä¼šæŸ¥è¯¢å…¬æœ‰äº‘çš„ API æ¥åˆ é™¤å·²ç»é‡Šæ”¾çš„ Nodeï¼‰ã€‚æ­¤æ—¶ï¼Œæ§åˆ¶å™¨é€šè¿‡ Node å¯¹è±¡ä¸å­˜åœ¨è¿™ä¸€äº‹å®ç†è§£äº† Node å·²ç»æ— æ³•æ¢å¤ï¼Œå°±å¯ä»¥ç›´æ¥åˆ é™¤ pvc-1 æ¥è§£ç»‘ PVï¼Œå¹¶å¼ºåˆ¶åˆ é™¤ TiKV-1ï¼Œæœ€ç»ˆè®© TiKV-1 è°ƒåº¦åˆ°å…¶å®ƒèŠ‚ç‚¹ä¸Šã€‚å½“ç„¶ï¼Œæˆ‘ä»¬åŒæ—¶ä¹Ÿè¦åšåº”ç”¨å±‚çŠ¶æ€çš„åè°ƒï¼Œä¹Ÿå°±æ˜¯å…ˆåœ¨ PD ä¸­ä¸‹çº¿ TiKV-1ï¼Œå†å°†æ–°çš„ TiKV-1 ä½œä¸ºä¸€ä¸ªæ–°æˆå‘˜åŠ å…¥é›†ç¾¤ï¼Œæ­¤æ—¶ï¼ŒPD å°±ä¼šé€šçŸ¥ TiKV-1 åˆ›å»º Region å‰¯æœ¬æ¥è¡¥é½é›†ç¾¤ä¸­çš„ Region å‰¯æœ¬æ•°ã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-4def23bf88b88c266c411f25dedcbf3e_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;525&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic3.zhimg.com/v2-4def23bf88b88c266c411f25dedcbf3e_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-4def23bf88b88c266c411f25dedcbf3e_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;525&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic3.zhimg.com/v2-4def23bf88b88c266c411f25dedcbf3e_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-4def23bf88b88c266c411f25dedcbf3e_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 9 èƒ½å¤Ÿç¡®å®šèŠ‚ç‚¹çŠ¶æ€æ—¶çš„æ•…éšœè½¬ç§»&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;å½“ç„¶ï¼Œæ›´å¤šçš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ˜¯æ— æ³•åœ¨è‡ªå®šä¹‰æ§åˆ¶å™¨ä¸­ç¡®å®šèŠ‚ç‚¹çŠ¶æ€çš„ï¼Œæ­¤æ—¶å°±å¾ˆéš¾é’ˆå¯¹æ€§åœ°è¿›è¡ŒåŸåœ°æ¢å¤ï¼Œå› æ­¤æˆ‘ä»¬é€šè¿‡å‘é›†ç¾¤ä¸­æ·»åŠ æ–° Pod æ¥è¿›è¡Œæ•…éšœè½¬ç§»ï¼š&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-a618bf0bde89d5f1a8862aeaf56e3f9a_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;525&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic3.zhimg.com/v2-a618bf0bde89d5f1a8862aeaf56e3f9a_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-a618bf0bde89d5f1a8862aeaf56e3f9a_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;525&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic3.zhimg.com/v2-a618bf0bde89d5f1a8862aeaf56e3f9a_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-a618bf0bde89d5f1a8862aeaf56e3f9a_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 10 æ— æ³•ç¡®å®šèŠ‚ç‚¹çŠ¶æ€æ—¶çš„æ•…éšœè½¬ç§»&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;ä¸Šé¢è®²çš„æ˜¯ TiDB ç‰¹æœ‰çš„æ•…éšœè½¬ç§»ç­–ç•¥ï¼Œä½†å…¶å®å¯ä»¥ç±»æ¨åˆ°å¤§éƒ¨åˆ†çš„æœ‰çŠ¶æ€åº”ç”¨ä¸Šã€‚æ¯”å¦‚å¯¹äº MySQL çš„ slaveï¼Œæˆ‘ä»¬åŒæ ·å¯ä»¥é€šè¿‡æ–°å¢ slave æ¥åš failoverï¼Œè€Œåœ¨ failover æ—¶ï¼Œæˆ‘ä»¬åŒæ ·ä¹Ÿè¦åšåº”ç”¨å±‚çš„ä¸€äº›äº‹æƒ…ï¼Œ æ¯”å¦‚è¯´å» S3 ä¸Šæ‹‰ä¸€ä¸ªå…¨é‡å¤‡ä»½ï¼Œå†é€šè¿‡ binlog æŠŠå¢é‡æ•°æ®è¡¥ä¸Šï¼Œå½“ lag è¾¾åˆ°å¯æ¥å—çš„ç¨‹åº¦ä¹‹åå¼€å§‹å¯¹å¤–æä¾›è¯»æœåŠ¡ã€‚å› æ­¤å¤§å®¶å°±å¯ä»¥å‘ç°ï¼Œå¯¹äºæœ‰çŠ¶æ€åº”ç”¨çš„ failover ç­–ç•¥æ˜¯å…±é€šçš„ï¼Œä¹Ÿéƒ½éœ€è¦åº”ç”¨æœ¬èº«æ”¯æŒæŸç§ failover å½¢å¼ã€‚æ¯”å¦‚å¯¹äº MySQL çš„ masterï¼Œæˆ‘ä»¬åªèƒ½é€šè¿‡ M-M æ¨¡å¼åšä¸€å®šç¨‹åº¦ä¸Šçš„ failoverï¼Œè€Œä¸”è¿˜ä¼šæŸå¤±æ•°æ®ä¸€è‡´æ€§ã€‚è¿™å½“ç„¶ä¸æ˜¯ Kubernetes æˆ–äº‘åŸç”Ÿæœ¬èº«æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œè€Œæ˜¯è¯´ Kubernetes åªæ˜¯æ”¹å˜äº†åº”ç”¨çš„è¿ç»´æ¨¡å¼ï¼Œä½†å¹¶ä¸èƒ½å½±å“åº”ç”¨æœ¬èº«çš„æ¶æ„ç‰¹æ€§ã€‚å‡å¦‚åº”ç”¨æœ¬èº«çš„è®¾è®¡å°±ä¸æ˜¯äº‘åŸç”Ÿçš„ï¼Œé‚£åªèƒ½ä»åº”ç”¨æœ¬èº«å»è§£å†³ã€‚&lt;/p&gt;&lt;h2&gt;æ€»ç»“&lt;/h2&gt;&lt;p&gt;é€šè¿‡ TiDB Operator çš„å®è·µï¼Œæˆ‘ä»¬æœ‰ä»¥ä¸‹å‡ æ¡æ€»ç»“ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Operator æœ¬èº«çš„å¤æ‚åº¦ä¸å¯å¿½è§†ã€‚&lt;/li&gt;&lt;li&gt;Local PV èƒ½æ»¡è¶³é«˜ IO æ€§èƒ½éœ€æ±‚ï¼Œä»£ä»·åˆ™æ˜¯ç¼–æ’ä¸Šé¢å¤–çš„å¤æ‚åº¦ã€‚&lt;/li&gt;&lt;li&gt;åº”ç”¨æœ¬èº«å¿…é¡»è¿ˆå‘äº‘åŸç”Ÿï¼ˆmeets kubernetes part wayï¼‰ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;æœ€åï¼Œè¨€è¯­çš„æè¿°æ€»æ˜¯ä¸å¦‚ä»£ç æœ¬èº«æ¥å¾—ç®€æ´æœ‰åŠ›ï¼ŒTiDB Operator æ˜¯ä¸€ä¸ªå®Œå…¨å¼€æºçš„é¡¹ç›®ï¼Œçœ¼è§ä¸ºå®ï¼Œå¤§å®¶å¯ä»¥å°½æƒ…åˆ° &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/pingcap/tidb-operator&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;é¡¹ç›®ä»“åº“&lt;/a&gt; ä¸­æ‹ç –ï¼Œä¹Ÿæ¬¢è¿å¤§å®¶åŠ å…¥ç¤¾åŒºä¸€èµ·ç©èµ·æ¥ï¼ŒæœŸå¾…ä½ çš„ issue å’Œ PRï¼&lt;/p&gt;&lt;p&gt;å‡å¦‚ä½ å¯¹äºæ–‡ç« æœ‰ä»»ä½•é—®é¢˜æˆ–å»ºè®®ï¼Œæˆ–æ˜¯æƒ³ç›´æ¥åŠ å…¥ PingCAP é¼“æ£ç›¸å…³é¡¹ç›®ï¼Œæ¬¢è¿é€šè¿‡æˆ‘çš„é‚®ç®± wuyelei@pingcap.com è”ç³»æˆ‘ã€‚&lt;/p&gt;&lt;blockquote&gt;æœ¬æ–‡ä¸ºå´å¶ç£Šåœ¨ 2019 QCon å…¨çƒè½¯ä»¶å¼€å‘å¤§ä¼šï¼ˆä¸Šæµ·ï¼‰ä¸Šçš„ä¸“é¢˜æ¼”è®²å®å½•ï¼ŒSlides &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/pingcap/presentations/blob/master/conference/%25E5%2590%25B4%25E5%258F%25B6%25E7%25A3%258A-QCon-2019-%25E9%25AB%2598%25E6%2595%2588%25E7%25BC%2596%25E6%258E%2592%25E6%259C%2589%25E7%258A%25B6%25E6%2580%2581%25E5%25BA%2594%25E7%2594%25A8-TiDB%25E7%259A%2584%25E4%25BA%2591%25E5%258E%259F%25E7%2594%259F%25E5%25AE%259E%25E8%25B7%25B5%25E4%25B8%258E%25E6%2580%259D%25E8%2580%2583.pdf&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;ä¸‹è½½åœ°å€&lt;/a&gt;ã€‚&lt;/blockquote&gt;</description>
<author>ZoeyZhai</author>
<guid isPermaLink="false">2019-10-29-89037305</guid>
<pubDate>Tue, 29 Oct 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>ç½‘æ˜“äº’å¨±çš„æ•°æ®åº“é€‰å‹å’Œ TiDB åº”ç”¨å®è·µ</title>
<link>https://henix.github.io/feeds/zhuanlan.newsql/2019-10-27-87945199.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/87945199&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-c7c2edf92e205ae540dc9e1f3bce5a97_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;blockquote&gt;ä½œè€…ä»‹ç»ï¼šææ–‡æ°ï¼Œç½‘æ˜“äº’å¨±è®¡è´¹ç»„ï¼Œé«˜çº§æ•°æ®åº“ç®¡ç†å·¥ç¨‹å¸ˆï¼ŒTiDB User Group Ambassadorã€‚&lt;/blockquote&gt;&lt;h2&gt;ä¸€ã€ä¸šåŠ¡æ¶æ„ç®€ä»‹&lt;/h2&gt;&lt;p&gt;è®¡è´¹ç»„æ˜¯ä¸ºç½‘æ˜“äº’å¨±äº§å“æä¾›ç»Ÿä¸€ç™»å½•å’Œæ”¯ä»˜é«˜æ•ˆè§£å†³æ–¹æ¡ˆçš„å…¬å…±æ”¯æŒéƒ¨é—¨ï¼Œå¯¹å†…æ˜¯äº’å¨±çš„å„ä¸ªæ¸¸æˆå·¥ä½œå®¤ï¼Œå¯¹å¤–æ˜¯å›½å†…å¤–æ•°ç™¾ä¸ªæ¸ é“ã€‚ç”±äºä¸šåŠ¡åœºæ™¯çš„ç‰¹æ®Šæ€§ï¼Œæˆ‘ä»¬ä¸ºå„ä¸ªæ¸¸æˆäº§å“éƒ¨ç½²äº†ä¸åŒçš„åº”ç”¨æœåŠ¡ï¼Œå…¶ä¸­å¤§äº§å“ç¯å¢ƒç‹¬ç«‹ï¼Œå°äº§å“é›†ä¸­éƒ¨ç½²ã€‚&lt;/p&gt;&lt;p&gt;éšç€éƒ¨é—¨ä¸šåŠ¡é‡çš„æ¿€å¢ï¼Œå•æœº MySQL åœ¨å®¹é‡ã€æ€§èƒ½ã€æ‰©å±•æ€§ç­‰æ–¹é¢éƒ½é‡åˆ°äº†ç“¶é¢ˆï¼Œæˆ‘ä»¬å¼€å§‹å¯¹å…¶ä»–æ•°æ®åº“äº§å“è¿›è¡Œè°ƒç ”é€‰å‹ã€‚æœ¬æ–‡å°†è¯¦ç»†ä»‹ç»ç½‘æ˜“äº’å¨±è®¡è´¹ç»„é’ˆå¯¹è‡ªå·±åœºæ™¯çš„æ•°æ®åº“é€‰å‹å¯¹æ¯”æ–¹æ¡ˆï¼Œä»¥åŠä½¿ç”¨ TiDB åè§£å†³çš„é—®é¢˜ï¼Œå¹¶åˆ†äº«äº†ä½¿ç”¨ TiDB è¿‡ç¨‹ä¸­é›†ç¾¤ç®¡ç†ã€ç›‘æ§å’Œæ•°æ®è¿ç§»ç­‰æ–¹é¢çš„æœ€ä½³å®è·µï¼Œä»¥ä¾›å¤§å®¶å‚è€ƒå’Œäº¤æµã€‚&lt;/p&gt;&lt;h3&gt;1.1 MySQL ä½¿ç”¨æ¶æ„&lt;/h3&gt;&lt;p&gt;ç½‘æ˜“äº’å¨±è®¡è´¹ç»„çº¿ä¸Š MySQL çš„åŸºæœ¬ä½¿ç”¨æ¶æ„ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå…¶ä¸­ç®­å¤´æ–¹å‘è¡¨ç¤ºæ•°æ®æˆ–è¯·æ±‚çš„æŒ‡å‘ï¼š&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-e701bf359f428776beadb051bd789a73_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;527&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic4.zhimg.com/v2-e701bf359f428776beadb051bd789a73_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-e701bf359f428776beadb051bd789a73_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;527&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic4.zhimg.com/v2-e701bf359f428776beadb051bd789a73_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-e701bf359f428776beadb051bd789a73_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 1 ç½‘æ˜“äº’å¨±è®¡è´¹ç»„çº¿ä¸Š MySQL ä½¿ç”¨æ¶æ„&lt;/figcaption&gt;&lt;/figure&gt;&lt;ul&gt;&lt;li&gt;çº¿ä¸Šåº”ç”¨ Application é€šè¿‡ Keepalive + å¤šæœºéƒ¨ç½²ï¼Œæµé‡ç»è¿‡è´Ÿè½½å‡è¡¡ï¼Œå¯ä»¥æœ‰æ•ˆä¿éšœåº”ç”¨æœåŠ¡çš„é«˜å¯ç”¨ï¼›&lt;/li&gt;&lt;li&gt;æ•°æ®åº“å±‚æ¶æ„æ˜¯ Keepalive + ä¸»ä»ç»“æ„ï¼Œåˆ©ç”¨åŠåŒæ­¥å¤åˆ¶ç‰¹æ€§å¯ä»¥æœ‰æ•ˆè§£å†³å»¶è¿Ÿå’Œæ•°æ®ä¸€è‡´æ€§çš„é—®é¢˜ï¼›&lt;/li&gt;&lt;li&gt;Application é€šè¿‡ VIP è®¿é—®åç«¯æ•°æ®åº“ï¼Œåœ¨æ•°æ®åº“ä¸»èŠ‚ç‚¹å®•æœºåé€šè¿‡ VIP é£˜ç§»åˆ°ä»èŠ‚ç‚¹ï¼Œä¿è¯æœåŠ¡æ­£å¸¸å¯¹å¤–æä¾›ï¼›&lt;/li&gt;&lt;li&gt;é€šè¿‡ Slave èŠ‚ç‚¹è¿›è¡Œæ•°æ®å¤‡ä»½å’Œçº¿ä¸Šæ•°æ®é‡‡é›†ï¼Œç»è¿‡å…¨é‡å’Œå¢é‡åŒæ­¥æ–¹å¼å¯¼å‡ºæ•°æ®åˆ°æ•°æ®ä¸­å¿ƒï¼Œç„¶åè¿›è¡Œåœ¨çº¿å’Œç¦»çº¿è®¡ç®—ä»»åŠ¡ï¼›&lt;/li&gt;&lt;li&gt;ç±»ä¼¼è¿™æ ·çš„æ¶æ„ç»„åˆçº¿ä¸Šå¤§æ¦‚æœ‰ 50+ å¥—ï¼Œæ¶‰åŠæœåŠ¡å™¨ 200~400 å°ï¼Œæ—¥å‡æ–°å¢æ•°æ® TB çº§ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;h3&gt;1.2 MySQL ä½¿ç”¨çš„ç°çŠ¶ä¸é—®é¢˜&lt;/h3&gt;&lt;p&gt;éšç€ä¸šåŠ¡çš„å‘å±•ï¼Œéƒ¨é—¨å†…å„åº”ç”¨æœåŠ¡äº§ç”Ÿçš„æ•°æ®é‡ä¹Ÿåœ¨å¿«é€Ÿå¢é•¿ã€‚ä¸šåŠ¡è½åœ°æ•°æ®é‡ä¸æ–­æ¿€å¢ï¼Œå¯¼è‡´å•æœº MySQL ä¸å¯é¿å…åœ°ä¼šå‡ºç°æ€§èƒ½ç“¶é¢ˆã€‚ä¸»è¦ä½“ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;å®¹é‡&lt;/li&gt;&lt;ul&gt;&lt;li&gt;å•æœº MySQL å®ä¾‹å­˜å‚¨ç©ºé—´æœ‰é™ï¼Œæƒ³è¦ç»´æŒç°æœ‰æ¶æ„å°±å¾—åˆ é™¤å’Œè½®è½¬æ—§æ•°æ®ï¼Œè¾¾åˆ°é‡Šæ”¾ç©ºé—´çš„ç›®çš„ï¼›&lt;/li&gt;&lt;li&gt;ç½‘æ˜“äº’å¨±æŸäº›åœºæ™¯å•è¡¨å®¹é‡è¾¾åˆ° 700GB ä»¥ä¸Šï¼Œè®¢å•æ•°æ®éœ€æ°¸ä¹…ä¿å­˜ï¼ŒåŒæ—¶ä¹Ÿéœ€è¦ä¿æŒåœ¨çº¿å®æ—¶æŸ¥è¯¢ï¼ŒæŒ‰ç…§ä¹‹å‰çš„å­˜å‚¨è®¾è®¡ä¼šå‡ºç°æ˜æ˜¾çš„ç“¶é¢ˆã€‚&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;æ€§èƒ½&lt;/li&gt;&lt;ul&gt;&lt;li&gt;æœ€å¤§å•è¡¨ 15 äº¿è¡Œï¼Œè¡Œæ•°è¿‡å¤§ï¼Œå¯¼è‡´è¯»å†™æ€§èƒ½å—åˆ°å½±å“ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;æ‰©å±•æ€§&lt;/li&gt;&lt;ul&gt;&lt;li&gt;MySQL æ— æ³•åœ¨çº¿çµæ´»æ‰©å±•ï¼Œæ— æ³•è§£å†³å­˜å‚¨ç“¶é¢ˆã€‚&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;SQL å¤æ‚&lt;/li&gt;&lt;ul&gt;&lt;li&gt;å¤§è¡¨è½®è½¬åå‡ºç°å¤šä¸ªåˆ†è¡¨ï¼Œè”åˆæŸ¥è¯¢æ—¶éœ€è¦ join å¤šä¸ªåˆ†è¡¨ï¼ŒSQL éå¸¸å¤æ‚å¹¶éš¾ä»¥ç»´æŠ¤ï¼›&lt;/li&gt;&lt;li&gt;å•æœº MySQL ç¼ºä¹å¤§è§„æ¨¡æ•°æ®åˆ†æçš„èƒ½åŠ›ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;æ•°æ®å£å’&lt;/li&gt;&lt;ul&gt;&lt;li&gt;ä¸åŒäº§å“çš„æ•°æ®åº“ç‹¬ç«‹éƒ¨ç½²ï¼›&lt;/li&gt;&lt;li&gt;æ•°æ®ä¸äº’é€šï¼Œå¯¼è‡´æ•°æ®ç›¸å…³éš”ç¦»ï¼Œå½¢æˆæ•°æ®å£å’ï¼›&lt;/li&gt;&lt;li&gt;å½“è¿›è¡Œè·¨äº§å“è®¡ç®—æ—¶ï¼Œéœ€è¦ç»´æŠ¤å¤šä¸ªå¼‚æ„æ•°æ®æºï¼Œè®¿é—®æ–¹å¼å¤æ‚ã€‚æ•°æ®åˆ†æ•£åœ¨ä¸åŒçš„æ•°æ®å­¤å²›ä¸Šä¼šå¢åŠ æ•°æ®åˆ†æéš¾åº¦ï¼Œä¸åˆ©äºå…±æ€§ä»·å€¼çš„æŒ–æ˜ã€‚å¦‚ä¸‹å›¾ï¼š&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-19112c8c75fc02890d7d5fb7c83d082f_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;522&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic4.zhimg.com/v2-19112c8c75fc02890d7d5fb7c83d082f_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-19112c8c75fc02890d7d5fb7c83d082f_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;522&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic4.zhimg.com/v2-19112c8c75fc02890d7d5fb7c83d082f_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-19112c8c75fc02890d7d5fb7c83d082f_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 2 ç°çŠ¶ä¹‹æ•°æ®å­¤å²›&lt;/figcaption&gt;&lt;/figure&gt;&lt;h2&gt;äºŒã€æ•°æ®åº“é€‰å‹&lt;/h2&gt;&lt;h3&gt;2.1 è°ƒç ”ç›®æ ‡&lt;/h3&gt;&lt;p&gt;é’ˆå¯¹ç›®å‰å­˜å‚¨æ¶æ„å­˜åœ¨çš„é—®é¢˜ï¼Œæœ‰éœ€è¦ä½¿ç”¨å…¶ä»–å­˜å‚¨æ–¹æ¡ˆçš„å¯èƒ½ã€‚è€ƒè™‘åˆ°ç›®å‰çš„ä¸šåŠ¡ä¸ MySQL é«˜åº¦è€¦åˆï¼Œå¯¹æ•°æ®åº“é€‰å‹çš„ä¸»è¦è¦æ±‚æœ‰ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;å¿…é¡»å…¼å®¹ MySQL åè®®ï¼›&lt;/li&gt;&lt;li&gt;æ”¯æŒäº‹åŠ¡ï¼Œä¿è¯ä»»åŠ¡ä»¥äº‹åŠ¡ä¸ºç»´åº¦æ¥æ‰§è¡Œæˆ–é‡é”™å›æ»šï¼›&lt;/li&gt;&lt;li&gt;æ”¯æŒç´¢å¼•ï¼Œå°¤å…¶æ˜¯äºŒçº§ç´¢å¼•ï¼›&lt;/li&gt;&lt;li&gt;æ‰©å±•æ€§ï¼Œæ”¯æŒçµæ´»åœ¨çº¿æ‰©å±•èƒ½åŠ›ï¼ŒåŒ…æ‹¬æ€§èƒ½æ‰©å±•å’Œå®¹é‡æ‰©å±•ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;å…¶ä»–è¦æ±‚ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;ç¨³å®šæ€§å’Œå¯é æ€§ï¼›&lt;/li&gt;&lt;li&gt;å¤‡ä»½å’Œæ¢å¤ï¼›&lt;/li&gt;&lt;li&gt;å®¹ç¾ç­‰ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;h3&gt;2.2 å¯é€‰æ–¹æ¡ˆ&lt;/h3&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-4e2c5d05280b41a4559bf6e8e882e5d3_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1072&quot; data-rawheight=&quot;458&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1072&quot; data-original=&quot;https://pic4.zhimg.com/v2-4e2c5d05280b41a4559bf6e8e882e5d3_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-4e2c5d05280b41a4559bf6e8e882e5d3_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1072&quot; data-rawheight=&quot;458&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1072&quot; data-original=&quot;https://pic4.zhimg.com/v2-4e2c5d05280b41a4559bf6e8e882e5d3_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-4e2c5d05280b41a4559bf6e8e882e5d3_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;h3&gt;2.3 æµ‹è¯•&lt;/h3&gt;&lt;h3&gt;2.3.1 åŸºäº MySQL çš„è§£å†³æ–¹æ¡ˆ&lt;/h3&gt;&lt;p&gt;ä¸€å¼€å§‹ä»ç„¶æ˜¯å€¾å‘ä½¿ç”¨åŸºäº MySQL çš„è§£å†³æ–¹æ¡ˆï¼Œæ¯”å¦‚ MySQL InnoDB Cluster æˆ– MySQL + ä¸­é—´ä»¶çš„æ–¹æ¡ˆã€‚&lt;/p&gt;&lt;p&gt;æˆ‘ä»¬æµ‹è¯•äº† MySQL é›†ç¾¤ 5.7.25 ç‰ˆæœ¬å¯¹æ¯” 8.0.12 ç‰ˆæœ¬ï¼Œåœ¨ 128 å¹¶å‘å†™å„ 1000 ä¸‡è¡Œçš„ 10 ä¸ªè¡¨ï¼Œæ¯”è¾ƒå•èŠ‚ç‚¹ã€3 èŠ‚ç‚¹å’Œ 5 èŠ‚ç‚¹ä¸‹çš„æƒ…å†µï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-e043a4e85967a6d57373fab5b129d034_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;462&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic1.zhimg.com/v2-e043a4e85967a6d57373fab5b129d034_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-e043a4e85967a6d57373fab5b129d034_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;462&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic1.zhimg.com/v2-e043a4e85967a6d57373fab5b129d034_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-e043a4e85967a6d57373fab5b129d034_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 3 å¯¹æ¯”ç»“æœ&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;åœ¨æµ‹è¯•ä¸­å‘ç°ï¼Œä½¿ç”¨ MySQL InnoDB é›†ç¾¤çš„æ–¹æ¡ˆå†™æ€§èƒ½æ¯”å•æœº MySQL å·®çº¦ 30%ï¼Œå…¶ä»–çš„è¯»å†™æµ‹è¯•ç»“æœä¹Ÿä¸ç”šæ»¡æ„ã€‚ä¹‹åé™†ç»­æµ‹è¯• MySQL InnoDB Cluster æˆ– MySQL + ä¸­é—´ä»¶çš„æ–¹æ¡ˆï¼Œä¸æ˜¯æµ‹è¯•ç»“æœæ€§èƒ½ä¸è¾¾è¦æ±‚ï¼Œå°±æ˜¯éœ€è¦ä¿®æ”¹å¤§é‡ä»£ç ã€‚&lt;/p&gt;&lt;p&gt;å› æ­¤æˆ‘ä»¬å¾—å‡ºäº†åŸºäº MySQL InnoDB Cluster æˆ– MySQL + ä¸­é—´ä»¶çš„æ–¹æ¡ˆçš„ä¸æ»¡è¶³æˆ‘ä»¬çš„ä¸šåŠ¡åœºæ™¯çš„ç»“è®ºã€‚æ€»ç»“æ¥è¯´ï¼Œæˆ‘ä»¬ä¸ä½¿ç”¨ MySQL åˆ†åº“åˆ†è¡¨ã€ä¸­é—´ä»¶æˆ– MySQL é›†ç¾¤ï¼ŒåŸå› ä¸»è¦æ˜¯ä»¥ä¸‹ä¸¤ç‚¹ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;æ–¹æ¡ˆè¿‡äºå¤æ‚&lt;/li&gt;&lt;li&gt;éœ€è¦æ”¹ä¸šåŠ¡ä»£ç &lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;ä»”ç»†åˆ†ææ¥çœ‹ï¼Œå…¶å®åŸºäº MySQL InnoDB Cluster æˆ– MySQL + ä¸­é—´ä»¶çš„æ–¹æ¡ˆï¼Œæœ¬è´¨ä¸Šæ˜¯ MySQL ä¸»ä»ç»“æ„çš„å»¶ä¼¸ï¼Œå¹¶éçœŸæ­£çš„åˆ†å¸ƒå¼æ‹“å±•ï¼Œåƒæ˜¯ä»¥æ‰“â€œè¡¥ä¸â€çš„æ–¹å¼æ¥å®ç°æ¨ªå‘æ‰©å±•ï¼Œå¾ˆå¤šåŠŸèƒ½ç‰¹æ€§è‡ªç„¶ä¹Ÿéš¾ä»¥è®©äººæ»¡æ„ã€‚&lt;/b&gt;&lt;/p&gt;&lt;h3&gt;2.3.2 CockroachDB VS TiDB&lt;/h3&gt;&lt;p&gt;åœ¨å¼€æºçš„åˆ†å¸ƒå¼ NewSQL é¢†åŸŸï¼ŒçŸ¥åçš„æœ‰ TiDB å’Œ CockroachDBï¼ˆç®€ç§° CRDBï¼‰ï¼ŒäºŒè€…éƒ½æ˜¯åŸºäº Google Spanner è®ºæ–‡çš„å¼€æºå®ç°ã€‚æˆ‘ä»¬å¯¹è¿™ä¸¤ç§æ•°æ®åº“çš„åŠŸèƒ½å’Œæ€§èƒ½åšäº†å¤§é‡çš„è°ƒç ”å’Œæµ‹è¯•ã€‚&lt;/p&gt;&lt;ul&gt;&lt;li&gt;TiDB å¤©ç„¶å…¼å®¹ MySQL åè®®ï¼Œè€Œ CRDB å…¼å®¹ PostgreSQL ï¼›&lt;/li&gt;&lt;li&gt;å¦‚æœä¸šåŠ¡ä»¥ MySQL ä¸ºä¸»ï¼Œé‚£ TiDB å¯èƒ½æ˜¯æ¯”è¾ƒå¥½çš„é€‰æ‹©ï¼›å¦‚æœæ˜¯ PostgreSQLï¼Œé‚£CRDB å¯èƒ½æ˜¯ä¼˜å…ˆçš„é€‰æ‹©ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;æµ‹è¯•æ–¹é¢ï¼Œæˆ‘ä»¬ä¹Ÿè¿›è¡Œäº†å…¨é¢åœ°å¯¹æ¯”å’Œæµ‹è¯•ã€‚è¿™é‡Œè¯´å…¶ä¸­ä¸€ä¸ªæµ‹è¯•æ¡ˆä¾‹ï¼š10 å°æœºå™¨ 5 å­˜å‚¨èŠ‚ç‚¹ï¼Œ160 å¹¶å‘è®¿é—®å•è¡¨ 2 äº¿è¡Œï¼Œæˆ‘ä»¬äº 2018 å¹´ 7 æœˆï¼Œå¯¹ CRDB-v2.1.0 ç‰ˆæœ¬å’Œ TiDB-v2.0.5 ç‰ˆæœ¬è¿›è¡Œäº†è¯»å†™æµ‹è¯•ï¼ˆCRDB å’Œ TiDB é›†ç¾¤å‡ä½¿ç”¨é»˜è®¤é…ç½®ï¼Œæœªè¿›è¡Œè°ƒä¼˜ï¼‰ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;é›†ç¾¤æ‹“æ‰‘&lt;/b&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-b87fcc3484e0ed11b7415194bacca766_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;464&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic3.zhimg.com/v2-b87fcc3484e0ed11b7415194bacca766_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-b87fcc3484e0ed11b7415194bacca766_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;464&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic3.zhimg.com/v2-b87fcc3484e0ed11b7415194bacca766_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-b87fcc3484e0ed11b7415194bacca766_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 4 CockroachDB æµ‹è¯•é›†ç¾¤æ­å»º&lt;/figcaption&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-2df8880a5aadd7b661237be784bd12c0_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;531&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic1.zhimg.com/v2-2df8880a5aadd7b661237be784bd12c0_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-2df8880a5aadd7b661237be784bd12c0_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;531&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic1.zhimg.com/v2-2df8880a5aadd7b661237be784bd12c0_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-2df8880a5aadd7b661237be784bd12c0_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 5 TiDB æµ‹è¯•é›†ç¾¤æ­å»º&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;æµ‹è¯•è¯­å¥&lt;/b&gt;&lt;/p&gt;&lt;p&gt;èŒƒå›´æŸ¥è¯¢ï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;SELECT c FROM sbtest%u WHERE id BETWEEN ? AND ?
SELECT SUM(k) FROM sbtest%u WHERE id BETWEEN ? AND ?
SELECT c FROM sbtest WHERE id BETWEEN ? AND ? ORDER BY c
SELECT DISTINCT c FROM sbtest%u WHERE id BETWEEN ? AND ? ORDER BY c&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;&lt;li&gt;éšæœº IN æŸ¥è¯¢ï¼š&lt;/li&gt;&lt;/ul&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;SELECT id, k, c, pad FROM sbtest1 WHERE k IN (?)&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;&lt;li&gt;éšæœºèŒƒå›´æŸ¥è¯¢ï¼š&lt;/li&gt;&lt;/ul&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;SELECT count(k) FROM sbtest1 WHERE k BETWEEN ? AND ? OR k BETWEEN ? AND ?&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;&lt;li&gt;æ›´æ–°ç´¢å¼•åˆ—ï¼š&lt;/li&gt;&lt;/ul&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;UPDATE sbtest%u SET k=k+1 WHERE id=?&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;&lt;li&gt;æ›´æ–°éç´¢å¼•åˆ—ï¼š&lt;/li&gt;&lt;/ul&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;UPDATE sbtest%u SET c=? WHERE id=?&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;&lt;li&gt;è¯»å†™æ··åˆï¼šèŒƒå›´æŸ¥è¯¢ + æ›´åˆ æ”¹æ··åˆ&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;å…¶ä¸­ä¸€ä¸ªé‡è¦çš„æµ‹è¯•ç»“æœå¦‚ä¸‹ï¼š&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-bcc6cccccdc3e119d41a5e053187f2b7_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;466&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic4.zhimg.com/v2-bcc6cccccdc3e119d41a5e053187f2b7_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-bcc6cccccdc3e119d41a5e053187f2b7_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;466&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic4.zhimg.com/v2-bcc6cccccdc3e119d41a5e053187f2b7_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-bcc6cccccdc3e119d41a5e053187f2b7_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 6 æµ‹è¯•ç»“æœ&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;ç»“è®ºï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;CRDB å’Œ TiDB åœ¨æ€§èƒ½è¡¨ç°ä¸Šä¸ç›¸ä¸Šä¸‹ï¼›&lt;br/&gt;æ³¨ï¼šä¸Šé¢æ˜¯ 2018 å¹´ 7 æœˆçš„åŸºäº TiDB 2.0.5 ç‰ˆæœ¬çš„æµ‹è¯•ç»“æœï¼Œç°åœ¨ &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pingcap.com/docs-cn/v3.0/releases/3.0-ga/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TiDB å·²å‘å¸ƒ 3.0 GA ç‰ˆæœ¬ï¼Œåœ¨æ€§èƒ½ä¸Šæœ‰äº†è´¨çš„æå‡&lt;/a&gt;ï¼Œæˆ‘ä»¬åœ¨è¿‘æœŸè¿›è¡Œäº†è¡¥å……æµ‹è¯•ï¼Œå¤§å¤šæ•°åœºæ™¯ä¸‹ 3.0 ç‰ˆæœ¬è¾ƒ 2.1 ç‰ˆæœ¬æœ‰æ•°å€çš„æ€§èƒ½æå‡ï¼Œæœ€æ–°çš„æµ‹è¯•ç»“æœå›¾å¦‚ä¸‹ï¼š&lt;br/&gt;&lt;/li&gt;&lt;/ol&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-126246b456e76b94f40b965841eebc36_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;452&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic3.zhimg.com/v2-126246b456e76b94f40b965841eebc36_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-126246b456e76b94f40b965841eebc36_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;452&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic3.zhimg.com/v2-126246b456e76b94f40b965841eebc36_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-126246b456e76b94f40b965841eebc36_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 7 TiDB 2.1.15 vs 3.0.3ï¼šOLTP å³°å€¼æ¯”è¾ƒ&lt;/figcaption&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-d6716918375f8a4f1142a803e01dbc0c_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;306&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic1.zhimg.com/v2-d6716918375f8a4f1142a803e01dbc0c_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-d6716918375f8a4f1142a803e01dbc0c_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;306&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic1.zhimg.com/v2-d6716918375f8a4f1142a803e01dbc0c_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-d6716918375f8a4f1142a803e01dbc0c_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 8 TiDB 2.1.15 vs 3.0.3ï¼šTPC-C&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;2. CRDB å…¼å®¹ PostgreSQLï¼Œå¦‚æœéœ€è¦è¿ç§»åˆ™éœ€è¦è½¬åè®®ï¼Œéœ€ MySQL â†’ PostgreSQL  â†’ CRDBã€‚è¿ç§»è¿‡ç¨‹å¤æ‚ï¼Œæˆæœ¬é«˜ï¼›&lt;/p&gt;&lt;p&gt;3. TiDB å…¼å®¹ MySQLï¼Œä»£ç ä¿®æ”¹é‡ä¸å¤šï¼Œè¿ç§»æˆæœ¬ä½ã€‚&lt;/p&gt;&lt;h3&gt;2.3.3 æœ€ç»ˆé€‰å‹&lt;/h3&gt;&lt;p&gt;ç»¼åˆå¯¹æ¯”ç»“æœå¦‚ä¸‹è¡¨ï¼š&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-7f97b461d169b0fd1ca972e1f527e5b7_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;970&quot; data-rawheight=&quot;452&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;970&quot; data-original=&quot;https://pic4.zhimg.com/v2-7f97b461d169b0fd1ca972e1f527e5b7_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-7f97b461d169b0fd1ca972e1f527e5b7_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;970&quot; data-rawheight=&quot;452&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;970&quot; data-original=&quot;https://pic4.zhimg.com/v2-7f97b461d169b0fd1ca972e1f527e5b7_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-7f97b461d169b0fd1ca972e1f527e5b7_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;ç»è¿‡è°¨æ…çš„è€ƒé‡ï¼Œæˆ‘ä»¬é€‰æ‹©äº† TiDBã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-feae600e94813ac3a015f6b923bbeaa1_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;497&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic2.zhimg.com/v2-feae600e94813ac3a015f6b923bbeaa1_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-feae600e94813ac3a015f6b923bbeaa1_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;497&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic2.zhimg.com/v2-feae600e94813ac3a015f6b923bbeaa1_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-feae600e94813ac3a015f6b923bbeaa1_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 9 é€‰æ‹© TiDB çš„é‡è¦ç†ç”±&lt;/figcaption&gt;&lt;/figure&gt;&lt;h2&gt;ä¸‰ã€TiDB åœ¨ç½‘æ˜“äº’å¨±è®¡è´¹ç»„çš„ä½¿ç”¨&lt;/h2&gt;&lt;h3&gt;3.1 TiDB ä½¿ç”¨æ¶æ„&lt;/h3&gt;&lt;p&gt;ç½‘æ˜“äº’å¨±ä½¿ç”¨ TiDB çš„æ¶æ„è®¾è®¡å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-8f6d6f5043b3a90ea15ca410117e07c7_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;479&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic4.zhimg.com/v2-8f6d6f5043b3a90ea15ca410117e07c7_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-8f6d6f5043b3a90ea15ca410117e07c7_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;479&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic4.zhimg.com/v2-8f6d6f5043b3a90ea15ca410117e07c7_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-8f6d6f5043b3a90ea15ca410117e07c7_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 10 åŸºäº TiDB çš„æ¶æ„è®¾è®¡&lt;/figcaption&gt;&lt;/figure&gt;&lt;ul&gt;&lt;li&gt;æ•´ä¸ªé›†ç¾¤åˆ†ä¸º TiDBã€TiKV å’Œ PD 3 ä¸ªæ¨¡å—åˆ†å±‚éƒ¨ç½²ï¼›&lt;/li&gt;&lt;li&gt;ä½¿ç”¨ Nginx ä½œä¸ºå‰ç«¯è´Ÿè½½å‡è¡¡ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;h3&gt;3.2 TiDB è§£å†³äº†å“ªäº›éœ€æ±‚&lt;/h3&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-4bb5735becad11940999f16df0597ad0_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1282&quot; data-rawheight=&quot;456&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1282&quot; data-original=&quot;https://pic1.zhimg.com/v2-4bb5735becad11940999f16df0597ad0_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-4bb5735becad11940999f16df0597ad0_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1282&quot; data-rawheight=&quot;456&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1282&quot; data-original=&quot;https://pic1.zhimg.com/v2-4bb5735becad11940999f16df0597ad0_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-4bb5735becad11940999f16df0597ad0_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;h3&gt;3.3 TiDB ä½¿ç”¨ç°çŠ¶&lt;/h3&gt;&lt;ul&gt;&lt;li&gt;ä¸šåŠ¡&lt;/li&gt;&lt;ul&gt;&lt;li&gt;TiDB ä½œä¸ºçº¿ä¸Š MySQL æ•°æ®é•œåƒï¼Œè´Ÿè´£çº¿ä¸Šæ•°æ®çš„æ”¶é›†å’Œé›†ä¸­ç®¡ç†ï¼Œå½¢æˆæ•°æ®æ¹–æ³Šï¼›&lt;/li&gt;&lt;li&gt;åº”ç”¨äºæ•°æ®å¹³å°æœåŠ¡ï¼ŒåŒ…æ‹¬æŠ¥è¡¨ã€ç›‘æ§ã€è¿è¥ã€ç”¨æˆ·ç”»åƒã€å¤§æ•°æ®è®¡ç®—ç­‰åœºæ™¯ï¼›&lt;/li&gt;&lt;li&gt;HTAPï¼šOLTP + OLAPã€‚&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;é›†ç¾¤&lt;/li&gt;&lt;ul&gt;&lt;li&gt;æµ‹è¯•é›†ç¾¤ï¼šv2.1.15ï¼Œç”¨äºåŠŸèƒ½æµ‹è¯•ã€ç‰¹æ€§å°é²œï¼›&lt;/li&gt;&lt;li&gt;çº¿ä¸Šé›†ç¾¤ï¼šv2.1.15ï¼Œ80% ç¦»çº¿å¤§æ•°æ®è®¡ç®—ä»»åŠ¡ + 20% çº¿ä¸Šä¸šåŠ¡ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;è§„æ¨¡&lt;/li&gt;&lt;ul&gt;&lt;li&gt;41 å°æœåŠ¡å™¨ï¼Œ88 ä¸ªå®ä¾‹èŠ‚ç‚¹ï¼Œ38 ä¸ª Syncer å®æ—¶åŒæ­¥æµï¼ˆå°†å‡çº§ä¸º DMï¼‰ï¼›&lt;/li&gt;&lt;li&gt;å­˜å‚¨ï¼š20TB/æ€» 50TBï¼Œ230 ä¸‡ä¸ª Regionï¼›&lt;/li&gt;&lt;li&gt;QPS å‡å€¼ 4k/sï¼Œé«˜å³°æœŸä¸‡çº§ QPSï¼Œè¯»å†™æ¯”çº¦ 1:5ï¼›&lt;/li&gt;&lt;li&gt;å»¶è¿Ÿæ—¶é—´ï¼š80% åœ¨ 8ms ä»¥å†…ï¼Œ95% åœ¨ 125ms ä»¥ä¸‹ï¼Œ99.9% åœ¨ 500ms ä»¥ä¸‹ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;h2&gt;å››ã€æœ€ä½³å®è·µåˆ†äº«&lt;/h2&gt;&lt;h3&gt;4.1 é›†ç¾¤ç®¡ç†&lt;/h3&gt;&lt;ul&gt;&lt;li&gt;Ansibleï¼ˆæ¨èï¼‰&lt;/li&gt;&lt;ul&gt;&lt;li&gt;ä¸€é”®éƒ¨ç½²ï¼›&lt;/li&gt;&lt;li&gt;å¼¹æ€§ä¼¸ç¼©ï¼Œå¯åœ¨çº¿çµæ´»æ‰©ç¼©å®¹ï¼›&lt;/li&gt;&lt;li&gt;å‡çº§ï¼Œå•èŠ‚ç‚¹è½®è½¬å¹³æ»‘å‡çº§ï¼›&lt;/li&gt;&lt;li&gt;é›†ç¾¤å¯åœå’Œä¸‹çº¿ï¼›&lt;/li&gt;&lt;li&gt;Prometheus ç›‘æ§ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;Docker&lt;/li&gt;&lt;li&gt;K8s&lt;/li&gt;&lt;ul&gt;&lt;li&gt;ä½¿ç”¨ &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/pingcap/tidb-operator&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TiDB Operator&lt;/a&gt; å¯ä»¥åœ¨ç§æœ‰äº‘å’Œå…¬æœ‰äº‘ä¸Šä¸€é”®ç®¡ç†ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;h3&gt;4.2 è¿ç»´å®è·µ&lt;/h3&gt;&lt;h3&gt;4.2.1 Prometheus ç›‘æ§&lt;/h3&gt;&lt;p&gt;å®˜æ–¹é›†æˆäº† Prometheus + Grafana çš„å®æ—¶ç›‘æ§å¹³å°ï¼Œä»é›†ç¾¤çš„å„ä¸ªæ–¹é¢è¿›è¡Œäº†å®Œå–„çš„ç›‘æ§ï¼ŒåŒ…æ‹¬ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;æœåŠ¡å™¨åŸºç¡€èµ„æºçš„ç›‘æ§ï¼šå†…å­˜ã€CPUã€å­˜å‚¨ç©ºé—´ã€IO ç­‰ï¼›&lt;/li&gt;&lt;li&gt;é›†ç¾¤ç»„ä»¶çš„ç›‘æ§ï¼šTiDBã€PDã€TiKV ç­‰ï¼›&lt;/li&gt;&lt;li&gt;æ•°æ®ç›‘æ§ï¼šå®æ—¶åŒæ­¥æµã€ä¸Šä¸‹æ¸¸æ•°æ®ä¸€è‡´æ€§æ£€éªŒç­‰ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;PD ç›‘æ§ç¤ºæ„å›¾å¦‚ä¸‹ï¼Œé›†ç¾¤ç®¡ç†å‘˜å¯ä»¥å¾ˆæ–¹ä¾¿åœ°æŒæ¡é›†ç¾¤çš„æœ€æ–°çŠ¶æ€ï¼ŒåŒ…æ‹¬é›†ç¾¤çš„ç©ºé—´ Region ç­‰æ‰€æœ‰æƒ…å†µã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-8a54da195fdd0a5e3c085dda6c351793_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;525&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic4.zhimg.com/v2-8a54da195fdd0a5e3c085dda6c351793_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-8a54da195fdd0a5e3c085dda6c351793_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;525&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic4.zhimg.com/v2-8a54da195fdd0a5e3c085dda6c351793_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-8a54da195fdd0a5e3c085dda6c351793_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 11 æœ€ä½³è¿ç»´å®è·µï¼šPrometheus å®æ—¶ç›‘æ§&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;å¦‚æœé›†ç¾¤è¿è¡Œè¿‡ç¨‹å‡ºé”™ï¼Œåœ¨ç›‘æ§é¢æ¿ä¸Šå¾ˆå®¹æ˜“å°±å‘ç°ï¼Œä¸‹å›¾æ˜¯ä½¿ç”¨è¿‡ç¨‹ä¸­çš„ä¸€ä¸ªæ¡ˆä¾‹ï¼š&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-21ad70df0265e812b94011451e9cc4fe_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;191&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic3.zhimg.com/v2-21ad70df0265e812b94011451e9cc4fe_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-21ad70df0265e812b94011451e9cc4fe_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;191&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic3.zhimg.com/v2-21ad70df0265e812b94011451e9cc4fe_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-21ad70df0265e812b94011451e9cc4fe_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 12 æœ€ä½³è¿ç»´å®è·µæ¡ˆä¾‹&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;åº”ç”¨è®¿é—® TiDB å†™å…¥æ•°æ®æ—¶å‘ç°ç‰¹åˆ«æ…¢ï¼Œè¯»è¯·æ±‚æ­£å¸¸ã€‚æ’æŸ¥åï¼Œæ ¹æ® TiKV é¢æ¿å‘ç° Raft Store CPU è¿™é¡¹æŒ‡æ ‡å¼‚å¸¸ã€‚æ·±å…¥äº†è§£åŸå› æ˜¯å› ä¸ºæ•°æ®åº“å‰¯æœ¬å¤åˆ¶æ˜¯å•çº¿ç¨‹æ“ä½œï¼Œç›®å‰å·²ç»åˆ°äº†é›†ç¾¤çš„ç“¶é¢ˆã€‚è§£å†³åŠæ³•æœ‰ä»¥ä¸‹ä¸¤ç‚¹ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Region æ•°é‡è¿‡å¤šï¼ŒRaft Store è¿˜è¦å¤„ç† heartbeat messageã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;è§£å†³æ–¹æ³•ï¼šåˆ é™¤è¿‡æœŸæ•°æ®ã€‚&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Raft Store å•çº¿ç¨‹å¤„ç†é€Ÿåº¦è·Ÿä¸ä¸Šé›†ç¾¤å†™å…¥é€Ÿåº¦ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;è§£å†³æ–¹æ³•ï¼šä» 2.1.5 å‡çº§åˆ° 2.1.15ï¼Œå¼€å¯è‡ªåŠ¨ Region Merge åŠŸèƒ½ã€‚&lt;/p&gt;&lt;h3&gt;4.2.2 éƒ¨åˆ†è¿ç»´é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ&lt;/h3&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-645d348684315ec58be5a3569c76122e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1422&quot; data-rawheight=&quot;1314&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1422&quot; data-original=&quot;https://pic3.zhimg.com/v2-645d348684315ec58be5a3569c76122e_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-645d348684315ec58be5a3569c76122e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1422&quot; data-rawheight=&quot;1314&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1422&quot; data-original=&quot;https://pic3.zhimg.com/v2-645d348684315ec58be5a3569c76122e_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-645d348684315ec58be5a3569c76122e_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;h3&gt;4.3 å…¨ç½‘æ•°æ®åº“éå†&lt;/h3&gt;&lt;p&gt;ä»¥å‰éƒ¨åˆ†ä¸šåŠ¡éå†å…¨ç½‘æ•°æ®åº“è·å–æ‰€éœ€æ•°æ®ï¼Œéœ€è¦ç»´æŠ¤å¤šä¸ªæºï¼Œè€Œä¸”æ˜¯å¼‚æ„æºï¼Œéå¸¸å¤æ‚å’Œç¹çã€‚ä½¿ç”¨ TiDB å¾ˆå¥½åœ°è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œåªéœ€è¦è®¿é—®ä¸€ä¸ªæºå°±å¯ä»¥è·å–åˆ°æ‰€æœ‰æƒ³è¦çš„æ•°æ®ã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-64e0713ff4ee564dec1b643c539dbfc2_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;412&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic3.zhimg.com/v2-64e0713ff4ee564dec1b643c539dbfc2_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-64e0713ff4ee564dec1b643c539dbfc2_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;412&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic3.zhimg.com/v2-64e0713ff4ee564dec1b643c539dbfc2_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-64e0713ff4ee564dec1b643c539dbfc2_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 13 å…¨ç½‘æ•°æ®åº“éå†&lt;/figcaption&gt;&lt;/figure&gt;&lt;h3&gt;4.4 æ•°æ®è¿ç§»&lt;/h3&gt;&lt;h3&gt;4.4.1 MySQL åˆ° TiDB&lt;/h3&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-84ca591d0ad68ce644f3a2816018b44c_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;525&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic1.zhimg.com/v2-84ca591d0ad68ce644f3a2816018b44c_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-84ca591d0ad68ce644f3a2816018b44c_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;525&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic1.zhimg.com/v2-84ca591d0ad68ce644f3a2816018b44c_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-84ca591d0ad68ce644f3a2816018b44c_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 14 æ•°æ®ä» MySQL è¿ç§»åˆ° TiDB&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;MySQL æ•°æ®åº“è¿ç§»åˆ° TiDB åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼šå…¨é‡å’Œå¢é‡ã€‚&lt;/p&gt;&lt;ul&gt;&lt;li&gt;å…¨é‡&lt;/li&gt;&lt;ul&gt;&lt;li&gt;ä½¿ç”¨å·¥å…· ï¼ˆMydumper æˆ– MySQL Dump ç­‰ï¼‰ä» MySQL å¯¼å‡ºæ•°æ®ï¼Œå¹¶ä¸”è®°å½•å½“å‰æ•°æ®çš„ binlog ä½ç½®ï¼›&lt;/li&gt;&lt;li&gt;ä½¿ç”¨å·¥å…·ï¼ˆLoader æˆ– Lightning ç­‰ï¼‰å°†æ•°æ®å¯¼å…¥åˆ° TiDB é›†ç¾¤ï¼›&lt;/li&gt;&lt;li&gt;å¯ä»¥ç”¨ä½œæ•°æ®çš„å¤‡ä»½å’Œæ¢å¤æ“ä½œã€‚&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;å¢é‡&lt;/li&gt;&lt;ul&gt;&lt;li&gt;TiDB ä¼ªè£…æˆä¸ºä¸Šæ¸¸ MySQL çš„ä¸€ä¸ª Slaveï¼Œé€šè¿‡å·¥å…·ï¼ˆSyncer æˆ– DMï¼‰å®æ—¶åŒæ­¥ binlog åˆ° TiDB é›†ç¾¤ï¼›&lt;/li&gt;&lt;li&gt;é€šå¸¸æƒ…å†µä¸Šæ¸¸ä¸€æ—¦æœ‰æ•°æ®æ›´æ–°ï¼Œä¸‹æ¸¸å°±ä¼šå®æ—¶åŒæ­¥è¿‡æ¥ã€‚åŒæ­¥é€Ÿåº¦å—ç½‘ç»œå’Œæ•°æ®é‡å¤§å°çš„å½±å“ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;h3&gt;4.4.2 æ•°æ®è¿å‡º TiDB&lt;/h3&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-de4230f3e89b1b8fd0b59cb618fd1329_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;527&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic2.zhimg.com/v2-de4230f3e89b1b8fd0b59cb618fd1329_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-de4230f3e89b1b8fd0b59cb618fd1329_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;527&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic2.zhimg.com/v2-de4230f3e89b1b8fd0b59cb618fd1329_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-de4230f3e89b1b8fd0b59cb618fd1329_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 15 æ•°æ®è¿å‡º TiDB&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;å¦‚æœæ•°æ®éœ€è¦åå‘å¯¼å…¥æˆ–åŒæ­¥ï¼Œå¯ä»¥åˆ©ç”¨ &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pingcap.com/blog-cn/tidb-ecosystem-tools-1/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TiDB Binlog&lt;/a&gt; å·¥å…·å°† TiDB é›†ç¾¤çš„ binlog åŒæ­¥åˆ° MySQLã€‚TiDB Binlog æ”¯æŒä»¥ä¸‹åŠŸèƒ½åœºæ™¯ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;æ•°æ®åŒæ­¥&lt;/b&gt;ï¼šåŒæ­¥ TiDB é›†ç¾¤æ•°æ®åˆ°å…¶ä»–æ•°æ®åº“ï¼›&lt;/li&gt;&lt;li&gt;&lt;b&gt;å®æ—¶å¤‡ä»½å’Œæ¢å¤&lt;/b&gt;ï¼šå¤‡ä»½ TiDB é›†ç¾¤æ•°æ®ï¼ŒåŒæ—¶å¯ä»¥ç”¨äº TiDB é›†ç¾¤æ•…éšœæ—¶æ¢å¤ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;å¯¼å…¥çš„æ–¹å¼ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;å…¨é‡ï¼šTiDB å…¼å®¹ MySQL åè®®ï¼Œåœ¨ MySQL å®¹é‡è¶³å¤Ÿå¤§çš„æƒ…å†µä¸‹ï¼Œä¹Ÿå¯ç”¨å·¥å…·å°†æ•°æ®ä» TiDB å¯¼å‡ºåå†å¯¼å…¥ MySQLã€‚&lt;/li&gt;&lt;li&gt;å¢é‡ï¼šæ‰“å¼€ TiDB çš„ binlog å¼€å…³ï¼Œéƒ¨ç½² binlog æ”¶é›†ç»„ä»¶ï¼ˆPump+Drainerï¼‰ï¼Œå¯ä»¥å°† binlog æ•°æ®åŒæ­¥åˆ°ä¸‹æ¸¸å­˜å‚¨æ¶æ„ï¼ˆMySQLã€TiDBã€Kafkaã€S3 ç­‰ï¼‰ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;h3&gt;4.5 ä¼˜é›…åœ°ã€Œå»åˆ†åº“åˆ†è¡¨ã€&lt;/h3&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-27d611443fcb9818371be07e692cfb61_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;525&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic2.zhimg.com/v2-27d611443fcb9818371be07e692cfb61_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-27d611443fcb9818371be07e692cfb61_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;525&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic2.zhimg.com/v2-27d611443fcb9818371be07e692cfb61_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-27d611443fcb9818371be07e692cfb61_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 16 å»åˆ†åº“åˆ†è¡¨ä¸¾ä¾‹&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;ä¸¾ä¾‹ï¼šä¸€ä¸ªè¶…çº§å¤§è¡¨æŒ‰å¤©åˆ†è¡¨ï¼Œç°åœ¨æ‰“ç®—æŸ¥è¯¢æŸä¸ªè´¦å·ä¸€å¹´é—´çš„ä¿¡æ¯ã€‚&lt;/p&gt;&lt;ul&gt;&lt;li&gt;ä¸Šæ¸¸ MySQL&lt;/li&gt;&lt;/ul&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;SELECT xx FROM HFeeall join HFee20190101 join ... join ...join ... join HFee20190917 WHERE xx;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;éœ€è¦è¿æ¥ N ä¸ª join æ¡ä»¶ï¼ŒæŸ¥è¯¢éœ€è¦ç­‰å¾…è¾ƒé•¿æ—¶é—´ã€‚&lt;/p&gt;&lt;ul&gt;&lt;li&gt;ä¸‹æ¸¸ TiDB&lt;/li&gt;&lt;/ul&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;SELECT xx  FROM SuperHfeeall WHERE xx ;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åº”ç”¨æ­¤æ–¹æ¡ˆï¼Œæœ€å¤§å•è¡¨ 700+GBï¼Œ13+ äº¿è¡Œï¼Œç´¢å¼•æŸ¥è¯¢ç§’è¿”å›ã€‚&lt;/p&gt;&lt;h3&gt;4.6  ä¸šåŠ¡è¿ç§»&lt;/h3&gt;&lt;p&gt;&lt;b&gt;ç›®æ ‡&lt;/b&gt;ï¼šåˆ©ç”¨ TiDB çš„æ°´å¹³æ‰©å±•ç‰¹æ€§ï¼Œè§£å†³å®¹é‡ç“¶é¢ˆå’Œç³»ç»Ÿååé‡ç“¶é¢ˆã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;è¿ç§»åŸåˆ™&lt;/b&gt;ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;æ•°æ®å®Œæ•´å’Œå‡†ç¡®ï¼šæ•°æ®å¾ˆé‡è¦ï¼Œä¿è¯æ•°æ®ä¸é”™ã€ä¸ä¸¢ï¼›&lt;/li&gt;&lt;li&gt;è¿ç§»å¹³æ»‘å’Œè¿…é€Ÿï¼šæœåŠ¡æ•æ„Ÿåº¦é«˜ï¼Œåœæœæ—¶é—´è¦çŸ­ï¼›&lt;/li&gt;&lt;li&gt;å¯å›æ»šï¼šé‡åˆ°é—®é¢˜å¯éšæ—¶åˆ‡å›åˆ° MySQLã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;1ï¼‰æ•°æ®åŒæ­¥&lt;/b&gt;&lt;/p&gt;&lt;p&gt;ä½¿ç”¨ DM æˆ–è€… Syncer å°†ä¸Šæ¸¸ MySQL çš„æ•°æ®åŒæ­¥åˆ° TiDB é›†ç¾¤ã€‚åŒæ­¥æµæ­å»ºåæ³¨æ„éœ€è¦æ£€æŸ¥ä¸Šä¸‹æ¸¸æ•°æ®ä¸€è‡´æ€§ã€‚&lt;/p&gt;&lt;p&gt;è§‚å¯Ÿä¸€æ®µæ—¶é—´ï¼ŒåŒæ­¥æ— è¯¯åï¼Œå¯ä»¥æ ¹æ®ä¸šåŠ¡éœ€è¦è¿ç§»éƒ¨åˆ†è¯»æµé‡åˆ° TiDB é›†ç¾¤ã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-55e50472d089594c5b5be928e744d5ae_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;899&quot; data-rawheight=&quot;831&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;899&quot; data-original=&quot;https://pic3.zhimg.com/v2-55e50472d089594c5b5be928e744d5ae_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-55e50472d089594c5b5be928e744d5ae_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;899&quot; data-rawheight=&quot;831&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;899&quot; data-original=&quot;https://pic3.zhimg.com/v2-55e50472d089594c5b5be928e744d5ae_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-55e50472d089594c5b5be928e744d5ae_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 17 ä¸šåŠ¡è¿ç§»ä¹‹æ•°æ®åŒæ­¥&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;2ï¼‰è¯»å†™éªŒè¯&lt;/b&gt;&lt;/p&gt;&lt;p&gt;è¿™ä¸€é˜¶æ®µæ˜¯éªŒè¯åº”ç”¨è®¿é—® MySQL å’Œè®¿é—® TiDB å¯ä»¥å¾—åˆ°ç›¸åŒçš„ç»“æœï¼ŒéªŒè¯ä¸šåŠ¡è®¿é—®çš„å‡†ç¡®æ€§é—®é¢˜ã€‚&lt;/p&gt;&lt;p&gt;åœæ­¢æ•°æ®åŒæ­¥ï¼Œä½¿ç”¨æµé‡å¤åˆ¶å·¥å…·å°†çº¿ä¸Šæµé‡å®Œå…¨æ‹·è´å‡ºæ¥ï¼ŒåŒæ—¶è¯»å†™ MySQL å’Œ TiDBã€‚å°†ä¸¤è¾¹çš„è®¿é—®ç»“æœè¿›è¡Œå¯¹æ¯”ï¼Œæ ¸æŸ¥ TiDB æ˜¯å¦å¯é å’Œå¯ä¿¡ã€‚æ ¹æ®éœ€è¦ï¼Œè¿™ä¸ªé˜¶æ®µå¯ä»¥æµ‹è¯•è¾ƒé•¿æ—¶é—´ã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-2e337efcdd9782d068cde17c8728c3fd_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;772&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic2.zhimg.com/v2-2e337efcdd9782d068cde17c8728c3fd_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-2e337efcdd9782d068cde17c8728c3fd_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;772&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic2.zhimg.com/v2-2e337efcdd9782d068cde17c8728c3fd_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-2e337efcdd9782d068cde17c8728c3fd_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 18 ä¸šåŠ¡è¿ç§»ä¹‹è¯»å†™éªŒè¯&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;3ï¼‰ç°åº¦åˆ‡æ¢&lt;/b&gt;&lt;/p&gt;&lt;p&gt;å°†æ­¥éª¤ 2 çš„åŒå†™åœæ­¢ï¼Œå³å…³åŒå†™ï¼ŒåŒæ—¶æ‹‰èµ·ä¸Šæ¸¸çš„ DM åŒæ­¥ã€‚&lt;/p&gt;&lt;p&gt;æŠŠè®¿é—®éƒ¨åˆ†éæ ¸å¿ƒä¸šåŠ¡çš„åº“è¡¨å†™æ“ä½œè¿ç§»åˆ° TiDBï¼Œæ‰“å¼€ TiDB çš„ Binlog å¼€å…³å¯¹çº¿ä¸Š MySQL è¿›è¡Œåå‘åŒæ­¥ã€‚è¿™ä¸ªæ“ä½œï¼Œä¿è¯åªå†™ MySQL çš„æ•°æ®åŒæ­¥åˆ° TiDB ï¼Œåªå†™ TiDB çš„æ•°æ®ä¹Ÿå¯ä»¥åå‘åŒæ­¥åˆ° MySQLï¼Œä¿è¯å‡ºäº†é—®é¢˜ï¼Œéšæ—¶å¯ä»¥å›æ»šã€‚å½“ä¸šåŠ¡é•¿æ—¶é—´è®¿é—®æ­£å¸¸ï¼Œå¯ä»¥å¢åŠ åˆ‡æ¢æµé‡ï¼Œè¿›è¡Œç°åº¦åˆ‡æ¢ã€‚å»ºè®®è§‚å¯Ÿä¸€æ®µæ—¶é—´ï¼Œè‡³å°‘ä¸€ä¸ªæœˆã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-b3ab62e04da1be6385b531bb98cb039d_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;854&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic2.zhimg.com/v2-b3ab62e04da1be6385b531bb98cb039d_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-b3ab62e04da1be6385b531bb98cb039d_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;854&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic2.zhimg.com/v2-b3ab62e04da1be6385b531bb98cb039d_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-b3ab62e04da1be6385b531bb98cb039d_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 19 ä¸šåŠ¡è¿ç§»ä¹‹ç°åº¦åˆ‡æ¢&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;4ï¼‰è¿ç§»å®Œæˆ&lt;/b&gt;&lt;/p&gt;&lt;p&gt;å½“æµé‡å®Œå…¨è¿ç§»å®Œæˆï¼Œä¿æŒ TiDB ååŒæ­¥åˆ° MySQL è¿‡ç¨‹ï¼Œç»§ç»­è§‚å¯Ÿä¸€æ®µæ—¶é—´ï¼Œç¡®è®¤æ— è¯¯åï¼Œæ–­å¼€åå‘åŒæ­¥ï¼Œ100% è¿ç§»å®Œæˆã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-8194bf59c99fbcf65acd3617bbf620b7_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;877&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic4.zhimg.com/v2-8194bf59c99fbcf65acd3617bbf620b7_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-8194bf59c99fbcf65acd3617bbf620b7_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;877&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic4.zhimg.com/v2-8194bf59c99fbcf65acd3617bbf620b7_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-8194bf59c99fbcf65acd3617bbf620b7_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 20 å®Œæˆè¿ç§»&lt;/figcaption&gt;&lt;/figure&gt;&lt;h2&gt;äº”ã€æ€»ç»“ä¸å±•æœ›&lt;/h2&gt;&lt;p&gt;TiDB å…¼å®¹ MySQL åè®®ï¼Œæ”¯æŒ TP/AP äº‹åŠ¡ä¸”æ‰©å±•æ€§å¥½ï¼Œèƒ½å¾ˆå¥½åœ°è§£å†³ç½‘æ˜“äº’å¨±è®¡è´¹ç»„ä¸šåŠ¡å¤§å®¹é‡ã€é«˜å¯ç”¨ç­‰é—®é¢˜ã€‚ç›®å‰æˆ‘ä»¬çš„ä¸šåŠ¡åœ¨ä¸æ–­æ·±å…¥å’Œæ‰©å¤§è§„æ¨¡ä½¿ç”¨ TiDBï¼Œå› ä¸ºçœ‹å¥½å®ƒï¼Œæ‰€ä»¥è¿™é‡Œæå‡ºä¸€äº›ä½¿ç”¨ä¸­çš„é—®é¢˜ä»¥å¸®åŠ©åŸå‚æŒç»­æ‰“ç£¨äº§å“ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;é›†ç¾¤æ•°æ®å¤‡ä»½ï¼šå¸Œæœ›æä¾›é›†ç¾¤æ›´é«˜æ•ˆåœ°å¤‡ä»½å’Œæ¢å¤ SST æ–‡ä»¶çš„æ–¹å¼ï¼›&lt;/li&gt;&lt;li&gt;äº‹åŠ¡é™åˆ¶ï¼šå¸Œæœ›å¯ä»¥æ”¾å®½å¤§äº‹åŠ¡çš„é™åˆ¶ï¼Œç°åœ¨ä»éœ€è¦äººå·¥åˆ‡åˆ†å¤§äº‹åŠ¡ï¼Œæ¯”è¾ƒå¤æ‚ï¼›&lt;/li&gt;&lt;li&gt;åŒæ­¥ï¼šå¸Œæœ› DM æ”¯æŒä¸Šä¸‹æ¸¸è¡¨ç»“æ„ä¸ä¸€è‡´çš„åŒæ­¥ï¼›&lt;/li&gt;&lt;li&gt;æ•°æ®çƒ­ç‚¹é—®é¢˜ï¼šå»ºè®®åŠ å¼ºè‡ªåŠ¨æ£€æµ‹å’Œæ¸…é™¤çƒ­ç‚¹åŠŸèƒ½ï¼›&lt;/li&gt;&lt;li&gt;å®¢æˆ·ç«¯é‡è¯•ï¼šç›®å‰å®¢æˆ·ç«¯ä»£ç éœ€è¦å°è£…é‡è¯•é€»è¾‘ï¼Œå¯¹ç”¨æˆ·ä¸å‹å¥½ï¼Œå¸Œæœ›å¯ä»¥æ”¹è¿›ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;æœ€åï¼Œæ ¹æ®ç½‘æ˜“äº’å¨±è®¡è´¹ç»„å·²æœ‰çš„ä½¿ç”¨æƒ…å†µï¼Œæˆ‘ä»¬è®¡åˆ’ç»§ç»­åŠ å¤§ã€åŠ æ·± TiDB çš„ä½¿ç”¨åœºæ™¯ï¼Œä¸°å¯Œä¸šåŠ¡ç±»å‹å’Œä½¿ç”¨è§„æ¨¡ï¼ŒæœŸå¾… TiDB ç»™æˆ‘ä»¬çš„ä¸šåŠ¡å¸¦æ¥æ›´å¤šä¾¿åˆ©ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;é˜…è¯»åŸæ–‡ï¼š&lt;/b&gt;&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pingcap.com/cases-cn/user-case-wangyihuyu/&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic2.zhimg.com/v2-60ab5bd867c2434d70c957a02a2169e1_ipico.jpg&quot; data-image-width=&quot;1200&quot; data-image-height=&quot;1200&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;ç½‘æ˜“äº’å¨±çš„æ•°æ®åº“é€‰å‹å’Œ TiDB åº”ç”¨å®è·µ | PingCAP&lt;/a&gt;&lt;p&gt;&lt;b&gt;æ›´å¤šç²¾å½©æ¡ˆä¾‹ï¼š&lt;/b&gt;&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pingcap.com/cases-cn/&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic2.zhimg.com/v2-60ab5bd867c2434d70c957a02a2169e1_ipico.jpg&quot; data-image-width=&quot;1200&quot; data-image-height=&quot;1200&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;æ¡ˆä¾‹ | PingCAP&lt;/a&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>ZoeyZhai</author>
<guid isPermaLink="false">2019-10-27-87945199</guid>
<pubDate>Sun, 27 Oct 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>TiKV é¡¹ç›®é¦–ä¸ª SIG æˆç«‹ï¼Œä¸€èµ·èµ°ä¸Š Contributor è¿›é˜¶ä¹‹è·¯å§ï¼</title>
<link>https://henix.github.io/feeds/zhuanlan.newsql/2019-10-24-88343561.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/88343561&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-5fb74c191abbf1a382b33b960aac4f32_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;ä½œè€…ï¼šLong Heneg&lt;/p&gt;&lt;p&gt;ç¤¾åŒºæ˜¯ä¸€ä¸ªå¼€æºé¡¹ç›®çš„çµé­‚ï¼Œéšç€ TiDB/TiKV &lt;u&gt;&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//mp.weixin.qq.com/s%3F__biz%3DMzI3NDIxNTQyOQ%3D%3D%26mid%3D2247489956%26idx%3D1%26sn%3D44724f8b262ed562fd8f1f0b5afbd4ba%26chksm%3Deb163ecedc61b7d8af57d867efa7241edc4fc987136c28a2c0f561744d809a465d403923d564%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;æ–°çš„ç¤¾åŒºæ¶æ„å‡çº§&lt;/a&gt;&lt;/u&gt;ï¼Œ TiKV ç¤¾åŒºä¹Ÿè®¡åˆ’é€æ­¥æˆç«‹æ›´å¤šä¸ª Special Interest Groupï¼ˆSIG ï¼‰å¸å¼•æ›´å¤šç¤¾åŒºåŠ›é‡ï¼Œä¸€èµ·æ¥æ”¹è¿›å’Œå®Œå–„ TiKV é¡¹ç›®ã€‚SIG  å°†å›´ç»•ç€ç‰¹å®šçš„æ¨¡å—è¿›è¡Œå¼€å‘å’Œç»´æŠ¤å·¥ä½œï¼Œå¹¶å¯¹è¯¥æ¨¡å—ä»£ç çš„è´¨é‡è´Ÿè´£ã€‚&lt;/p&gt;&lt;p&gt;ä»Šå¤©æ˜¯ 1024 ç¨‹åºå‘˜èŠ‚ï¼Œæˆ‘ä»¬æ­£å¼æˆç«‹  TiKV é¡¹ç›®çš„é¦–ä¸ª SIG â€”â€” Coprocessor SIGï¼Œå¸Œæœ›å¯¹ TiKV é¡¹ç›®ï¼ˆ&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//github.com/tikv/tikv&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;http://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;github.com/tikv/tikv&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;&lt;/span&gt;&lt;/a&gt;ï¼‰ æ„Ÿå…´è¶£çš„å°ä¼™ä¼´ä»¬éƒ½èƒ½åŠ å…¥è¿›æ¥ï¼Œæ¢ç´¢ç¡¬æ ¸çš„å‰æ²¿æŠ€æœ¯ï¼Œäº¤æµåˆ‡ç£‹ï¼Œä¸€èµ·èµ°ä¸Š Contributor çš„è¿›é˜¶ä¹‹è·¯ï¼&lt;/p&gt;&lt;h2&gt;&lt;b&gt;Coprocessor æ¨¡å—æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;ä¸ºäº†æå‡æ•°æ®åº“çš„æ•´ä½“æ€§èƒ½ï¼ŒTiDB ä¼šå°†éƒ¨åˆ†è®¡ç®—ä¸‹æ¨åˆ° TiKV æ‰§è¡Œï¼Œå³ TiKV çš„ Coprocessor æ¨¡å—ã€‚æœ¬æ¬¡æˆç«‹çš„ Coprocessor SIG å°±èšç„¦åœ¨ TiKV é¡¹ç›® Coprocessor æ¨¡å—ã€‚æœ¬ SIG çš„ä¸»è¦èŒè´£æ˜¯å¯¹ Coprocessor æ¨¡å—è¿›è¡Œæœªæ¥å‘å±•çš„è®¨è®ºã€è§„åˆ’ã€å¼€å‘å’Œç»´æŠ¤ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;å¦‚ä½•åŠ å…¥ Coprocessor SIGï¼Ÿ&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;ç¤¾åŒºçš„ Reviewer æˆ–æ›´é«˜çº§çš„è´¡çŒ®è€…ï¼ˆCommitterï¼ŒMaintainerï¼‰å°†æåActive ContributoråŠ å…¥ Coprocessor SIGã€‚Active Contributor æ˜¯å¯¹äº TiKV Coprocessor æ¨¡å—æˆ–è€… TiKV é¡¹ç›®æœ‰æµ“åšå…´è¶£çš„è´¡çŒ®è€…ï¼Œåœ¨è¿‡å» 1 å¹´ä¸º TiKV é¡¹ç›®è´¡çŒ®è¶…è¿‡ 8 ä¸ª PRã€‚&lt;/b&gt;åŠ å…¥ SIG åï¼ŒCoprocessor SIG Tech Lead å°†æŒ‡å¯¼æˆå‘˜å®Œæˆç›®æ ‡ä»»åŠ¡ã€‚åœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œæˆå‘˜å¯ä»¥ä» Active Contributor é€æ­¥æ™‹å‡ä¸º Reviewerã€Committer è§’è‰²ï¼Œè§£é”æ›´å¤šè§’è‰²æƒåˆ©&amp;amp;ä¹‰åŠ¡ã€‚&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;Reviewer&lt;/b&gt;ï¼šä» Active Contributor ä¸­è¯ç”Ÿï¼Œå½“ Active Contributor å¯¹ Coprocessor æ¨¡å—æ‹¥æœ‰æ¯”è¾ƒæ·±åº¦çš„è´¡çŒ®ï¼Œå¹¶ä¸”å¾—åˆ° 2 ä¸ªæˆ– 2 ä¸ªä»¥ä¸Š Committer çš„æåæ—¶ï¼Œå°†è¢«é‚€è¯·æˆä¸ºè¯¥æ¨¡å—çš„ Reviewerï¼Œä¸»è¦æƒåˆ©&amp;amp;ä¹‰åŠ¡ï¼š&lt;/li&gt;&lt;ul&gt;&lt;li&gt;å‚ä¸ Coprocessor PR Review ä¸è´¨é‡æ§åˆ¶ï¼›&lt;/li&gt;&lt;li&gt;å¯¹ Coprocessor æ¨¡å— PR å…·æœ‰æœ‰æ•ˆçš„ Approve / Request Change æƒé™ï¼›&lt;/li&gt;&lt;li&gt;å‚ä¸é¡¹ç›®è®¾è®¡å†³ç­–ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;b&gt;Committer&lt;/b&gt;ï¼šèµ„æ·±çš„ç¤¾åŒºå¼€å‘è€…ï¼Œä» Reviewer ä¸­è¯ç”Ÿã€‚å½“ Reviewer å¯¹ Coprocessor  æ¨¡å—æ‹¥æœ‰éå¸¸æ·±åº¦çš„è´¡çŒ®ï¼Œæˆ–è€…åœ¨ä¿æŒ Coprocessor  æ¨¡å— Reviewer è§’è‰²çš„åŒæ—¶ï¼Œä¹Ÿåœ¨åˆ«çš„æ¨¡å—æ·±åº¦è´¡çŒ®æˆä¸ºäº† Reviewerï¼Œè¿™æ—¶ä»–å°±åœ¨æ·±åº¦æˆ–è€…å¹¿åº¦ä¸Šå…·å¤‡äº†æˆä¸º Committer çš„æ¡ä»¶ï¼Œåªè¦å†å¾—åˆ° 2 ä¸ªæˆ– 2 ä¸ªä»¥ä¸Š Maintainer çš„æåæ—¶ï¼Œå³å¯æˆä¸º Committerï¼Œä¸»è¦æƒåˆ©åŠä¹‰åŠ¡ï¼š&lt;/li&gt;&lt;ul&gt;&lt;li&gt;æ‹¥æœ‰ Reviewer å…·æœ‰çš„æƒåˆ©ä¸ä¹‰åŠ¡ï¼›&lt;/li&gt;&lt;li&gt;æ•´ä½“æŠŠæ§é¡¹ç›®çš„ä»£ç è´¨é‡ï¼›&lt;/li&gt;&lt;li&gt;æŒ‡å¯¼ Contributor ä¸ Reviewerã€‚&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;h2&gt;&lt;b&gt;å·¥ä½œå†…å®¹æœ‰å“ªäº›ï¼Ÿ&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;1. å®Œå–„æµ‹è¯•&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;ä¸ºäº†è¿›ä¸€æ­¥æé«˜ Coprocessor çš„é›†æˆæµ‹è¯•è¦†ç›–ç‡ï¼ŒTiKV ç¤¾åŒºå¼€æºäº† &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/tikv/copr-test&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;copr-test&lt;/a&gt; é›†æˆæµ‹è¯•æ¡†æ¶ï¼Œä¾¿äºç¤¾åŒºä¸º Coprocessor æ·»åŠ æ›´å¤šé›†æˆæµ‹è¯•ï¼›&lt;/li&gt;&lt;li&gt;ä» TiDB port çš„å‡½æ•°éœ€è¦åŒæ—¶ port å•å…ƒæµ‹è¯•ï¼Œå¦‚æœ TiDB çš„å•å…ƒæµ‹è¯•æ²¡æœ‰è¦†ç›–æ‰€æœ‰çš„åˆ†æ”¯ï¼Œéœ€è¦è¡¥å…¨å•å…ƒæµ‹è¯•ï¼›&lt;/li&gt;&lt;li&gt;Expression çš„é›†æˆæµ‹è¯•éœ€è¦æ„é€ ä½¿ç”¨è¿™ä¸ª Expression çš„ç®—å­è¿›è¡Œæµ‹è¯•ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;2. æå‡ä»£ç è´¨é‡&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Framework: è®¡ç®—æ¡†æ¶æ”¹è¿›ï¼ŒåŒ…æ‹¬è¡¨è¾¾å¼è®¡ç®—æ¡†æ¶ã€ç®—å­æ‰§è¡Œæ¡†æ¶ç­‰ï¼›&lt;/li&gt;&lt;li&gt;Executor: æ”¹è¿›ç°æœ‰ç®—å­ã€ä¸ TiDB åä½œç ”å‘æ–°ç®—å­ï¼›&lt;/li&gt;&lt;li&gt;Function: ç»´æŠ¤ç°æœ‰çš„ UDF / AggrFn å®ç°æˆ–ä»  TiDB port æ–°çš„ UDF / AggrFn å®ç°ï¼›&lt;/li&gt;&lt;li&gt;ä»£ç ä½ç½®ï¼š&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//github.com/tikv/tikv/src/tidb_query&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;http://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;github.com/tikv/tikv/sr&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;c/tidb_query&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;3. è®¾è®¡ä¸æ¼”è¿› Proposal&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;4. Review ç›¸å…³é¡¹ç›®ä»£ç &lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;å¦‚ä½•ååŒå·¥ä½œï¼Ÿ&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;1. ä¸ºäº†ååŒæ•ˆç‡ï¼Œæˆ‘ä»¬è¦æ±‚ SIG æˆå‘˜éµå®ˆä¸€è‡´çš„ä»£ç é£æ ¼ã€æäº¤è§„èŒƒã€PR Description ç­‰è§„å®šã€‚&lt;/b&gt;å…·ä½“è¯·å‚è€ƒ&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//github.com/tikv/tikv/blob/master/CONTRIBUTING.md&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;æ–‡æ¡£&lt;/a&gt;ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;2. ä»»åŠ¡åˆ†é…æ–¹å¼&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;SIG Tech Lead åœ¨ &lt;a href=&quot;https://link.zhihu.com/?target=http%3A//github.com/tikv/community&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;http://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;github.com/tikv/communi&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;ty&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt; ç»´æŠ¤å…¬å¼€çš„æˆå‘˜åˆ—è¡¨ä¸ä»»åŠ¡åˆ—è¡¨é“¾æ¥ï¼›&lt;/li&gt;&lt;li&gt;æ–°åŠ å…¥çš„ SIG æˆå‘˜å¯æœ‰ 2 å‘¨æ—¶é—´äº†è§£å„ä¸ªä»»åŠ¡è¯¦æƒ…å¹¶è®¤é¢†ä¸€ä¸ªä»»åŠ¡ï¼Œæˆ–å‚ä¸ä¸€ä¸ªç°æœ‰ä»»åŠ¡çš„å¼€å‘æˆ–æ¨åŠ¨ã€‚è‹¥æœªèƒ½åœ¨è¯¥æ—¶é—´å†…è®¤é¢†ä»»åŠ¡åˆ™ä¼šè¢«ç§»é™¤ SIGï¼›&lt;/li&gt;&lt;li&gt;SIG æˆå‘˜éœ€ç»´æŒæ¯ä¸ªæœˆå‚ä¸å¼€å‘ä»»åŠ¡ï¼Œæˆ–å‚ä¸å…³äºç°æœ‰åŠŸèƒ½æˆ–æœªæ¥è§„åˆ’çš„è®¾è®¡ä¸è®¨è®ºã€‚è‹¥è¿ç»­ä¸€ä¸ªå­£åº¦ä¸å‚ä¸å¼€å‘ä¸è®¨è®ºï¼Œè§†ä¸ºä¸æ´»è·ƒçŠ¶æ€ï¼Œå°†ä¼šè¢«ç§»é™¤ SIGã€‚ä½œä¸º acknowledgmentï¼Œä»ä¼šå¤„äºæˆå‘˜åˆ—è¡¨çš„ã€ŒFormer Memberã€ä¸­ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;3. å®šæœŸåŒæ­¥è¿›åº¦ï¼Œå®šæœŸå‘¨ä¼š&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;æ¯ 2 å‘¨ä»¥æ–‡æ¡£å½¢å¼åŒæ­¥ä¸€æ¬¡å½“å‰å„ä¸ªé¡¹ç›®çš„å¼€å‘è¿›åº¦ï¼›&lt;/li&gt;&lt;li&gt;æ¯ 2 å‘¨å¬å¼€ä¸€æ¬¡å…¨ç»„è¿›åº¦ä¼šè®®ï¼Œæ—¶é—´ä¾æ®å‚ä¼šäººå‘˜å¯ç”¨æ—¶é—´å¦è¡Œåå•†ã€‚ç›®å‰æ²¡æœ‰é¡¹ç›®æ­£åœ¨å¼€å‘çš„æˆå‘˜å¯é€‰æ‹©æ€§å‚åŠ ä»¥ä¾¿äº†è§£å„ä¸ªé¡¹ç›®è¿›åº¦ã€‚è‹¥å‚ä¸å¼€å‘çš„æˆå‘˜ä¸èƒ½å‚åŠ ï¼Œéœ€æå‰è¯·å‡ä¸”æå‰å°†è‡ªå·±çš„æœˆåº¦è¿›åº¦æ›´æ–°è‡³æ–‡æ¡£ï¼›&lt;/li&gt;&lt;li&gt;æ¯æ¬¡ä¼šè®®ç”±ä¸€åæˆå‘˜è¿›è¡Œä¼šè®®è®°å½•ï¼Œåœ¨ä¼šè®®ç»“æŸ 24 å°æ—¶å†…å®Œæˆä¼šè®®è®°å½•å¹¶å…¬å¼€ã€‚ä¼šè®®è®°å½•ç”±å°ç»„æˆå‘˜è½®æµæ‰§è¡Œï¼›&lt;/li&gt;&lt;li&gt;Slack: &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//tikv-wg.slack.com/join/shared_invite/enQtNTUyODE4ODU2MzI0LWVlMWMzMDkyNWE5ZjY1ODAzMWUwZGVhNGNhYTc3MzJhYWE0Y2FjYjliYzY1OWJlYTc4OWVjZWM1NDkwN2QxNDE&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;https://tikv-wg.slack.com&lt;/a&gt; ï¼ˆChannel #copr-sig-chinaï¼‰&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;4. é€šè¿‡æ›´å¤šçº¿ä¸Šã€çº¿ä¸‹æˆå‘˜çš„æ´»åŠ¨è¿›è¡Œäº¤æµåˆä½œã€‚&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;Coprocessor SIG è¿è¥åˆ¶åº¦&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;1. è€ƒæ ¸ &amp;amp; æ™‹å‡åˆ¶åº¦&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;a.&lt;/b&gt; Coprocessor SIG Tech Lead ä»¥æœˆä¸ºå•ä½å¯¹å°ç»„æˆå‘˜è¿›è¡Œè€ƒæ ¸ï¼Œå†³å®šæˆå‘˜æ˜¯å¦å¯ç”± Active Contributor æ™‹å‡ä¸º Reviewerï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;ç†Ÿæ‚‰ä»£ç åº“ï¼›&lt;/li&gt;&lt;li&gt;è·å¾—è‡³å°‘ 2 ä½ TiKV Committer çš„æåï¼›&lt;/li&gt;&lt;li&gt;PR è´¡çŒ®æ»¡è¶³ä»¥ä¸‹ä»»æ„ä¸€ç‚¹ï¼š&lt;/li&gt;&lt;ul&gt;&lt;li&gt;Merge Coprocessor PR æ€»æ•°è¶…è¿‡ 10 ä¸ªï¼›&lt;/li&gt;&lt;li&gt;Merge Coprocessor PR æ€»è¡Œæ•°è¶…è¿‡ 1000 è¡Œï¼›&lt;/li&gt;&lt;li&gt;å·²å®Œæˆä¸€é¡¹éš¾åº¦ä¸º Medium æˆ–ä»¥ä¸Šçš„ä»»åŠ¡ï¼›&lt;/li&gt;&lt;li&gt;æå‡ºè®¾è®¡æƒ³æ³•å¹¶å¾—åˆ°é‡‡çº³æˆä¸ºå¯æ‰§è¡Œä»»åŠ¡è¶…è¿‡ 3 ä¸ªã€‚&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;b. &lt;/b&gt;Coprocessor SIG Tech Lead å’Œ TiKV Maintainer ä»¥å­£åº¦ä¸ºå•ä½å¯¹å°ç»„æˆå‘˜è¿›è¡Œè€ƒæ ¸ï¼Œå†³å®šæˆå‘˜æ˜¯å¦å¯ç”± Reviewer æ™‹å‡ä¸º Committerï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;è¡¨ç°å‡ºè‰¯å¥½çš„æŠ€æœ¯åˆ¤æ–­åŠ›ï¼›&lt;/li&gt;&lt;li&gt;åœ¨ TiKV / PingCAP è‡³å°‘ä¸¤ä¸ªå­é¡¹ç›®ä¸­æ˜¯ Reviewerï¼›&lt;/li&gt;&lt;li&gt;è·å¾—è‡³å°‘ 2 ä½ TiKV Maintainer çš„æåï¼›&lt;/li&gt;&lt;li&gt;è‡³å°‘å®Œæˆä¸¤é¡¹éš¾åº¦ä¸º Medium çš„ä»»åŠ¡ï¼Œæˆ–ä¸€é¡¹éš¾åº¦ä¸º High çš„ä»»åŠ¡ï¼›&lt;/li&gt;&lt;li&gt;PR è´¡çŒ®æ»¡è¶³ä»¥ä¸‹è‡³å°‘ä¸¤ç‚¹ï¼š&lt;/li&gt;&lt;ul&gt;&lt;li&gt;åŠå¹´å†… Merge Coprocessor PR æ€»è¡Œæ•°è¶…è¿‡ 1500 è¡Œï¼›&lt;/li&gt;&lt;li&gt;æœ‰æ•ˆ Review Coprocessor PR æ€»æ•°è¶…è¿‡ 10 ä¸ªï¼›&lt;/li&gt;&lt;li&gt;æœ‰æ•ˆ Review Coprocessor PR æ€»è¡Œæ•°è¶…è¿‡ 1000 è¡Œã€‚&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;2. é€€å‡ºåˆ¶åº¦&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;a.&lt;/b&gt; SIG æˆå‘˜åœ¨ä»¥ä¸‹æƒ…å†µä¸­ä¼šè¢«ç§»é™¤ SIGï¼Œä½†ä¿ç•™ç›¸åº”çš„ Active Contributor / Reviewer / Committer èº«ä»½ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;ä½œä¸ºæ–°æˆå‘˜æœªåœ¨æŒ‡å®šæ—¶é—´å†…è®¤é¢†ä»»åŠ¡ï¼›&lt;/li&gt;&lt;li&gt;è¿ç»­ä¸€ä¸ªå­£åº¦å¤„äºä¸æ´»è·ƒçŠ¶æ€ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;b.&lt;/b&gt; Reviewer æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ä¹‹ä¸€ä¼šè¢«å–æ¶ˆ Reviewer èº«ä»½ä¸”æ”¶å›æƒé™ï¼ˆåç»­é‡æ–°è€ƒæ ¸åå¯æ¢å¤ï¼‰ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;è¶…è¿‡ä¸€ä¸ªå­£åº¦æ²¡æœ‰ review ä»»ä½• Coprocessor ç›¸å…³çš„ PRï¼›&lt;/li&gt;&lt;li&gt;æœ‰ 2 ä½ä»¥ä¸Š Committer è®¤ä¸º Reviewer èƒ½åŠ›ä¸è¶³æˆ–æ´»è·ƒåº¦ä¸è¶³ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;3. Tech Lead é¢å¤–æ‰¿æ‹…çš„èŒè´£&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;SIG æˆå‘˜æå‡ºçš„é—®é¢˜éœ€è¦åœ¨ 2 ä¸ªå·¥ä½œæ—¥ç»™å‡ºå›å¤ï¼›&lt;/li&gt;&lt;li&gt;åŠæ—¶ Review ä»£ç ï¼›&lt;/li&gt;&lt;li&gt;å®šæ—¶å‘å¸ƒä»»åŠ¡ï¼ˆå¦‚æœ SIG æˆå‘˜é€€å‡ºåï¼Œæœªå®Œæˆçš„ä»»åŠ¡éœ€è¦é‡æ–°åˆ†é…ï¼‰ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;blockquote&gt;&lt;i&gt;é€šè¿‡ä¸Šæ–‡ç›¸ä¿¡å¤§å®¶å¯¹äº Coprocessor SIG çš„å·¥ä½œå†…å®¹ã€èŒƒå›´ã€æ–¹å¼ä»¥åŠè¿è¥åˆ¶åº¦æœ‰äº†åˆæ­¥çš„äº†è§£ã€‚å¦‚æœä½ æ˜¯ä¸€ä¸ªå¼€æºçˆ±å¥½è€…ï¼Œæƒ³è¦å‚ä¸åˆ°ä¸€ä¸ªå·¥ä¸šçº§çš„å¼€æºé¡¹ç›®ä¸­æ¥ï¼Œæˆ–è€…æƒ³äº†è§£ç¤¾åŒºçš„è¿è¡Œæœºåˆ¶ï¼Œæƒ³äº†è§£ä½ çš„ä»£ç æ˜¯å¦‚ä½•ä»ä¸€ä¸ªæƒ³æ³•æœ€ç»ˆå‘å¸ƒåˆ°ç”Ÿäº§ç¯å¢ƒä¸­è¿è¡Œï¼Œé‚£ä¹ˆåŠ å…¥ Coprocessor SIG å°±æ˜¯ä¸€ä¸ªç»ä½³çš„æœºä¼šï¼&lt;/i&gt;&lt;br/&gt;&lt;i&gt;&lt;b&gt;å¦‚æœä½ ä»å¯¹ SIG æœ‰äº›ç–‘é—®æˆ–è€…æƒ³è¦äº†è§£æ›´å¤šå­¦ä¹ èµ„æ–™ï¼Œæ¬¢è¿ç‚¹å‡»åŠ å…¥ &lt;/b&gt;&lt;/i&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//tikv-wg.slack.com/join/shared_invite/enQtNTUyODE4ODU2MzI0LWVlMWMzMDkyNWE5ZjY1ODAzMWUwZGVhNGNhYTc3MzJhYWE0Y2FjYjliYzY1OWJlYTc4OWVjZWM1NDkwN2QxNDE&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;tikv-wg.slack.com&lt;/a&gt;&lt;i&gt;&lt;b&gt;å“¦ï½&lt;/b&gt;&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>ZoeyZhai</author>
<guid isPermaLink="false">2019-10-24-88343561</guid>
<pubDate>Thu, 24 Oct 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>TiDB æœ€ä½³å®è·µç³»åˆ—ï¼ˆå››ï¼‰æµ·é‡ Region é›†ç¾¤è°ƒä¼˜</title>
<link>https://henix.github.io/feeds/zhuanlan.newsql/2019-10-24-88236773.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/88236773&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-8c752c14802cae0efd8c3f438dde8246_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;ä½œè€…ï¼šå¼ åšåº·&lt;/p&gt;&lt;p&gt;åœ¨ TiDB çš„æ¶æ„ä¸­ï¼Œæ‰€æœ‰çš„æ•°æ®æŒ‰ç…§ range åˆ’åˆ†æˆä¸€ä¸ªä¸ª Region åˆ†å¸ƒåœ¨å¤šä¸ª TiKV å®ä¾‹ä¸Šã€‚éšç€æ•°æ®çš„å†™å…¥ï¼Œä¸€ä¸ªé›†ç¾¤ä¸­ä¼šäº§ç”Ÿä¸Šç™¾ä¸‡ï¼Œç”šè‡³åƒä¸‡ä¸ª Regionã€‚è€Œé‡å˜å¼•èµ·è´¨å˜ï¼Œå• TiKV å®ä¾‹ä¸Šè¿‡å¤šçš„ Region æ— ç–‘ä¼šå¸¦æ¥æ¯”è¾ƒå¤§çš„è´Ÿæ‹…ï¼Œè¿›è€Œå½±å“æ•´ä¸ªé›†ç¾¤çš„æ€§èƒ½è¡¨ç°ã€‚&lt;/p&gt;&lt;p&gt;æœ¬æ–‡å°†ä»‹ç» TiKV æ ¸å¿ƒæ¨¡å— Raftstore çš„å¤„ç†æµç¨‹ä»¥ä½¿å¤§å®¶æ›´å¥½å¾—ç†è§£æµ·é‡ Region å¯¼è‡´æ€§èƒ½é—®é¢˜çš„æ ¹æºï¼Œä»¥åŠé’ˆå¯¹è¿™ç§æƒ…å†µçš„ä¸€äº›ä¼˜åŒ–æ‰‹æ®µã€‚&lt;/p&gt;&lt;h2&gt;Raftstore çš„å¤„ç†æµç¨‹&lt;/h2&gt;&lt;p&gt;å¤§å®¶éƒ½çŸ¥é“åœ¨ä¸€ä¸ª TiKV å®ä¾‹ä¸Šä¼šæœ‰å¤šä¸ª Regionï¼Œè¿™äº› Region æ¶ˆæ¯å¤„ç†å°±æ˜¯é€šè¿‡ Raftstore è¿™ä¸ªæ¨¡å—æ¥é©±åŠ¨çš„ï¼ŒåŒ…æ‹¬ Region ä¸Šè¯»å†™è¯·æ±‚çš„å¤„ç†ï¼ŒRaft log çš„æŒä¹…åŒ–ä»¥åŠå¤åˆ¶ï¼Œè¿˜æœ‰ Raft çš„å¿ƒè·³å¤„ç†ç­‰ç­‰ã€‚ä¸ºä»€ä¹ˆ Region æ•°å¤šäº†å°±ä¼šå½±å“åˆ°æ•´ä¸ªé›†ç¾¤çš„æ€§èƒ½å‘¢ï¼Ÿä¸ºäº†è§£é‡Šè¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ TiKV çš„æ ¸å¿ƒæ¨¡å— Raftstore æ˜¯æ€æ ·å·¥ä½œçš„ã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-4cfad7b6d0e555d173b880c59bfa06a7_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;547&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic4.zhimg.com/v2-4cfad7b6d0e555d173b880c59bfa06a7_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-4cfad7b6d0e555d173b880c59bfa06a7_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;547&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic4.zhimg.com/v2-4cfad7b6d0e555d173b880c59bfa06a7_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-4cfad7b6d0e555d173b880c59bfa06a7_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 1 Raftstore å¤„ç†æµç¨‹ç¤ºæ„å›¾&lt;/figcaption&gt;&lt;/figure&gt;&lt;blockquote&gt;æ³¨ï¼šè¯¥ç¤ºæ„å›¾ä»…ä»…è¡¨æ„ï¼Œä¸ä»£è¡¨ä»£ç å±‚é¢çš„å®é™…ç»“æ„ã€‚&lt;/blockquote&gt;&lt;p&gt;ä¸Šå›¾æ˜¯ Raftstore å¤„ç†æµç¨‹çš„ç¤ºæ„å›¾ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œä» TiDB å‘æ¥çš„è¯·æ±‚ä¼šé€šè¿‡ gRPC å’Œ storage æ¨¡å—å˜æˆæœ€ç»ˆçš„ KV è¯»å†™æ¶ˆæ¯å‘å¾€ç›¸åº”çš„ Regionï¼Œè€Œè¿™äº›æ¶ˆæ¯å¹¶ä¸ä¼šç«‹å³å¤„ç†è€Œæ˜¯æš‚å­˜ä¸‹æ¥ã€‚è€Œåœ¨ Raftstore ä¸­ä¼šè½®è¯¢æ£€æŸ¥æ¯ä¸ª Region æ˜¯å¦æœ‰éœ€è¦å¤„ç†çš„æ¶ˆæ¯ã€‚å¦‚æœæœ‰æ¶ˆæ¯ï¼Œé‚£ä¹ˆ Raftstore ä¼šé©±åŠ¨ Raft çŠ¶æ€æœºå»å¤„ç†è¿™äº›æ¶ˆæ¯ï¼Œå¹¶æ ¹æ®è¿™äº›æ¶ˆæ¯æ‰€äº§ç”Ÿçš„çŠ¶æ€å˜æ›´å»å®Œæˆä¸€äº›åç»­åŠ¨ä½œã€‚æ¯”å¦‚ï¼Œåœ¨æœ‰å†™è¯·æ±‚æ—¶ï¼ŒRaft çŠ¶æ€æœºéœ€è¦å°†æ—¥å¿—è½ç›˜å¹¶ä¸”å°†æ—¥å¿—å‘é€ç»™å…¶ä»–å‰¯æœ¬ï¼›åœ¨è¾¾åˆ°å¿ƒè·³é—´éš”æ—¶ï¼ŒRaft çŠ¶æ€æœºéœ€è¦å°†å¿ƒè·³ä¿¡æ¯å‘é€ç»™å…¶ä»–å‰¯æœ¬ã€‚&lt;/p&gt;&lt;h2&gt;æ€§èƒ½é—®é¢˜åŠä¼˜åŒ–æ–¹æ³•&lt;/h2&gt;&lt;p&gt;ä»ä¸Šé¢æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¹ˆå¤š Region çš„æ¶ˆæ¯æ˜¯ä¸€ä¸ªæ¥ä¸€ä¸ªåœ°å¤„ç†ã€‚é‚£ä¹ˆåœ¨ Region å¾ˆå¤šçš„æƒ…å†µä¸‹ï¼ŒRaftstore ä¼šéœ€è¦èŠ±è´¹ä¸€äº›æ—¶é—´å¤„ç†å¤§é‡ Region çš„å¿ƒè·³ï¼ŒåŠ¿å¿…ä¼šå¼•å…¥ä¸€äº›å»¶è¿Ÿï¼Œå¯¼è‡´ä¸€äº›è¯»å†™è¯·æ±‚å¾—ä¸åˆ°ç‰¹åˆ«åŠæ—¶çš„å¤„ç†ã€‚å¦‚æœåœ¨è¯»å†™å‹åŠ›å¤§çš„æƒ…å†µä¸‹ï¼Œå¾ˆå®¹æ˜“ä½¿å¾— Raftstore çº¿ç¨‹ CPU è¾¾åˆ°ç“¶é¢ˆï¼Œè€Œå»¶è¿Ÿä¼šè¢«è¿›ä¸€æ­¥æ”¾å¤§ï¼Œè¿›è€Œå½±å“æ€§èƒ½è¡¨ç°ã€‚&lt;/p&gt;&lt;h3&gt;å¸¸è§ç°è±¡&lt;/h3&gt;&lt;p&gt;ä¸€èˆ¬æ¥è¯´ï¼Œåœ¨æœ‰è´Ÿè½½çš„æƒ…å†µä¸‹ï¼Œå¦‚æœ TiKV çš„ Raftstore CPU ä½¿ç”¨ç‡è¾¾åˆ°äº† 85%+ï¼ˆæŒ‡çš„æ˜¯å•çº¿ç¨‹çš„æƒ…å†µï¼Œå¤šçº¿ç¨‹ç­‰æ¯”ä¾‹æ”¾å¤§ï¼‰ï¼Œæˆ‘ä»¬å°±è®¤ä¸º Raftstore å·²ç»è¾¾åˆ°äº†æ¯”è¾ƒç¹å¿™çš„çŠ¶æ€æˆä¸ºäº†ç“¶é¢ˆï¼ˆç”±äº Raftstore çº¿ç¨‹ä¸­æœ‰ IO æ“ä½œï¼Œæ‰€ä»¥ CPU ä½¿ç”¨ç‡ä¸å¯èƒ½è¾¾åˆ° 100%ï¼‰ï¼ŒåŒæ—¶ propose wait duration å¯èƒ½ä¼šè¾¾åˆ°ç™¾æ¯«ç§’çº§åˆ«ã€‚&lt;/p&gt;&lt;p&gt;ç›¸å…³ metrics å¯åœ¨ TiKV grafana é¢æ¿ä¸‹æŸ¥çœ‹ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Thread-CPU ä¸‹çš„ &lt;code&gt;Raft store CPU&lt;/code&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;å‚è€ƒå€¼ï¼šæœ€å¥½ä½äº &lt;code&gt;raftstore.store-pool-size * 85%&lt;/code&gt;ï¼ˆv2.1 ç‰ˆæœ¬ä¸­æ— æ­¤é…ç½®é¡¹ï¼Œå¯è®¤ä¸º &lt;code&gt;raftstore.store-pool-size = 1&lt;/code&gt;ï¼‰ã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-4f3c5145d6658899524033d9c5e50957_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;275&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic4.zhimg.com/v2-4f3c5145d6658899524033d9c5e50957_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-4f3c5145d6658899524033d9c5e50957_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;275&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic4.zhimg.com/v2-4f3c5145d6658899524033d9c5e50957_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-4f3c5145d6658899524033d9c5e50957_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 2 æŸ¥çœ‹ Raft store CPU&lt;/figcaption&gt;&lt;/figure&gt;&lt;ul&gt;&lt;li&gt;Raft Propose ä¸‹çš„ &lt;code&gt;Propose wait duration&lt;/code&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;code&gt;Propose wait duration&lt;/code&gt; æ˜¯å‘é€è¯·æ±‚ç»™ Raftstoreã€åˆ° Raftstore çœŸæ­£å¤„ç†è¯·æ±‚ä¹‹é—´çš„å»¶è¿Ÿã€‚å¦‚æœè¯¥å»¶è¿Ÿæ¯”è¾ƒé•¿ï¼Œè¯´æ˜ Raftstore æ¯”è¾ƒç¹å¿™æˆ–è€… append log æ¯”è¾ƒè€—æ—¶å¯¼è‡´ Raftstore ä¸èƒ½åŠæ—¶å¤„ç†è¯·æ±‚ã€‚&lt;/p&gt;&lt;p&gt;å‚è€ƒå€¼ï¼šæœ€å¥½ä½äº 50-100msã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-476963b7a70656f6625ecca059995a70_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;275&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic1.zhimg.com/v2-476963b7a70656f6625ecca059995a70_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-476963b7a70656f6625ecca059995a70_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;275&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic1.zhimg.com/v2-476963b7a70656f6625ecca059995a70_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-476963b7a70656f6625ecca059995a70_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 3 æŸ¥çœ‹ Propose wait duration&lt;/figcaption&gt;&lt;/figure&gt;&lt;h3&gt;ä¼˜åŒ–æ–¹æ³•&lt;/h3&gt;&lt;p&gt;æ—¢ç„¶æˆ‘ä»¬å·²ç»çŸ¥é“äº†æ€§èƒ½é—®é¢˜çš„æ ¹æºï¼Œé‚£ä¹ˆå°±å¯ä»¥ä»ä¸¤æ–¹é¢å…¥æ‰‹ï¼šå‡å°‘å•ä¸ª TiKV å®ä¾‹çš„ Region æ•°ï¼›å‡å°‘å•ä¸ª Region çš„æ¶ˆæ¯æ•°ã€‚æ ¹æ®ä¸åŒç‰ˆæœ¬ï¼Œå…·ä½“å¯ä»¥å‚è€ƒä»¥ä¸‹ä¼˜åŒ–æ–¹æ³•ï¼š&lt;/p&gt;&lt;h3&gt;v2.1 ç‰ˆæœ¬&lt;/h3&gt;&lt;p&gt;åœ¨ v2.1 ç‰ˆæœ¬ä¸­ Raftstore åªèƒ½æ˜¯å•çº¿ç¨‹ï¼Œå› æ­¤ä¸€èˆ¬åœ¨ Region æ•°è¶…è¿‡ 10 ä¸‡æ—¶å°±ä¼šé€æ¸æˆä¸ºç“¶é¢ˆã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;1. å¢åŠ  TiKV å®ä¾‹&lt;/b&gt;&lt;/p&gt;&lt;p&gt;å¦‚æœ IO èµ„æºå’Œ CPU èµ„æºéƒ½è¿˜æœ‰æ¯”è¾ƒå¤šçš„ç›ˆä½™çš„è¯ï¼Œå¯ä»¥åœ¨å•ä¸ªæœºå™¨ä¸Šéƒ¨ç½²å¤šä¸ª TiKV å®ä¾‹ï¼Œä»¥å‡å°‘å•ä¸ª TiKV å®ä¾‹ä¸Šçš„ Region ä¸ªæ•°ï¼Œæˆ–è€…æ‰©å®¹é›†ç¾¤çš„ TiKV æœºå™¨æ•°ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;2. å¼€å¯ Region Merge&lt;/b&gt;&lt;/p&gt;&lt;p&gt;å¦å¤–ä¸€ç§å¯ä»¥å‡å°‘ Region ä¸ªæ•°çš„åŠæ³•æ˜¯å¼€å¯ Region Mergeã€‚ä¸ Region Split ç›¸åï¼ŒRegion Merge æ˜¯é€šè¿‡è°ƒåº¦æŠŠç›¸é‚»çš„å° Region åˆå¹¶çš„è¿‡ç¨‹ã€‚åœ¨é›†ç¾¤æœ‰åˆ é™¤æ•°æ®æˆ–è€…è¿›è¡Œè¿‡ Drop Table/Truncate Table åï¼Œå¯ä»¥å°†é‚£äº›å° Region ç”šè‡³ç©º Region è¿›è¡Œåˆå¹¶ä»¥å‡å°‘èµ„æºçš„æ¶ˆè€—ã€‚&lt;/p&gt;&lt;p&gt;ç®€å•æ¥è¯´ï¼Œé€šè¿‡ pd-ctl è®¾ç½®ç›¸å…³å‚æ•°å³å¯å¼€å¯ Region Merge&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;&amp;gt;&amp;gt; pd-ctl config set max-merge-region-size 20
&amp;gt;&amp;gt; pd-ctl config set max-merge-region-keys 200000
&amp;gt;&amp;gt; pd-ctl config set merge-schedule-limit 8&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å…³äºæ›´å¤šè¯¦æƒ…è¯·å‚è€ƒè¿™ä¸¤ä¸ªæ–‡æ¡£ &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/tikv/tikv/blob/master/docs/how-to/configure/region-merge.md&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;å¦‚ä½•é…ç½® Region Merge&lt;/a&gt; å’Œ &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pingcap.com/docs-cn/dev/reference/configuration/pd-server/configuration-file/%23schedule&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;PD é…ç½®æ–‡ä»¶æè¿°&lt;/a&gt;ï¼Œåœ¨æ­¤ä¸å†å±•å¼€ã€‚&lt;/p&gt;&lt;p&gt;åŒæ—¶ï¼Œé»˜è®¤é…ç½®çš„ Region Merge é»˜è®¤å‚æ•°è®¾ç½®ç›¸å¯¹ä¿å®ˆï¼Œå¯ä»¥æ ¹æ®éœ€æ±‚å‚è€ƒ &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pingcap.com/blog-cn/best-practice-pd/%235-region-merge-%25E9%2580%259F%25E5%25BA%25A6%25E6%2585%25A2&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;ã€ŠTiDB æœ€ä½³å®è·µç³»åˆ—ï¼ˆäºŒï¼‰PD è°ƒåº¦ç­–ç•¥ã€‹&lt;/a&gt; ä¸­æåŠçš„å…·ä½“æ–¹æ³•åŠ å¿« Region Merge é€Ÿåº¦ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;3. è°ƒæ•´ raft-base-tick-interval&lt;/b&gt;&lt;/p&gt;&lt;p&gt;é™¤äº†å‡å° Region ä¸ªæ•°ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡å°½é‡å‡å°‘ Region å•ä½æ—¶é—´å†…çš„æ¶ˆæ¯æ•°é‡ä»¥å‡å° Raftstore å‹åŠ›ã€‚æ¯”å¦‚ï¼Œåœ¨ TiKV é…ç½®ä¸­é€‚å½“å¢å¤§ &lt;code&gt;raft-base-tick-interval&lt;/code&gt;ï¼š &lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;[raftstore]
raft-base-tick-interval = â€œ2sâ€&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;raft-base-tick-interval&lt;/code&gt; æ˜¯ Raftstore é©±åŠ¨æ¯ä¸ª Region çš„ Raft çŠ¶æ€æœºçš„åŸºæœ¬æ—¶é—´å•ä½ï¼Œä¹Ÿå°±æ˜¯æ¯éš”è¿™ä¹ˆä¹…å°±éœ€è¦å‘ Raft çŠ¶æ€æœºå‘é€ä¸€ä¸ª tick æ¶ˆæ¯ã€‚æ˜¾ç„¶å¢å¤§è¿™ä¸ªæ—¶é—´é—´éš”ï¼Œå¯ä»¥æœ‰æ•ˆå‡å°‘ Raftstore æ¶ˆæ¯æ•°é‡ã€‚&lt;/p&gt;&lt;p&gt;éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ª tick ä¹Ÿå†³å®šäº† election timeout å’Œ heartbeat çš„é—´éš”ã€‚&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;raft-election-timeout = raft-base-tick-interval * raft-election-timeout-ticks
raft-heartbeat-interval = raft-base-tick-interval * raft-heartbeat-ticks&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;follower åœ¨ &lt;code&gt;raft-election-timeout&lt;/code&gt; é—´éš”å†…æœªæ”¶åˆ°æ¥è‡ª leader çš„å¿ƒè·³ä¼šè®¤ä¸º leader å‡ºç°æ•…éšœè€Œå‘èµ·æ–°çš„é€‰ä¸¾ï¼Œè€Œ &lt;code&gt;raft-heartbeat-interval&lt;/code&gt; æ˜¯ leader å‘ follower å‘é€å¿ƒè·³çš„é—´éš”ï¼Œå› æ­¤å¢å¤§ &lt;code&gt;raft-base-tick-interval&lt;/code&gt; å¯ä»¥å‡å°‘å•ä½æ—¶é—´å†… Raft å‘é€çš„ç½‘ç»œæ¶ˆæ¯ï¼Œä½†ä¹Ÿä¼šè®© Raft æ£€æµ‹åˆ° leader æ•…éšœçš„æ—¶é—´æ›´é•¿ã€‚&lt;/p&gt;&lt;h3&gt;v3.0 ç‰ˆæœ¬&lt;/h3&gt;&lt;p&gt;é™¤äº†ä»¥ä¸ŠæåŠçš„ä¼˜åŒ–æ–¹æ³•å¤–ï¼ˆæ³¨ï¼šRegion Merge åœ¨ v3.0 ç‰ˆæœ¬ä¸­é»˜è®¤å¼€å¯ï¼‰ï¼Œv3.0 ç‰ˆæœ¬ä¸­è¿˜å¯ä»¥è¿›è¡Œä»¥ä¸‹ä¼˜åŒ–ï¼š&lt;/p&gt;&lt;p&gt;&lt;b&gt;1. æé«˜ Raftstore å¹¶å‘æ•°&lt;/b&gt;&lt;/p&gt;&lt;p&gt;åœ¨ v3.0 ç‰ˆæœ¬ä¸­ Raftstore å·²ç»æ‰©å±•ä¸ºå¤šçº¿ç¨‹ï¼Œæå¤§é™ä½äº† Raftstore çº¿ç¨‹æˆä¸ºç“¶é¢ˆçš„å¯èƒ½æ€§ã€‚&lt;/p&gt;&lt;p&gt;é»˜è®¤ TiKV é…ç½® &lt;code&gt;raftstore.store-pool-size&lt;/code&gt; ä¸º &lt;code&gt;2&lt;/code&gt;ï¼Œå¦‚æœåœ¨ Raftstore å‡ºç°ç“¶é¢ˆçš„æ—¶å€™å¯ä»¥æ ¹æ®å®é™…æƒ…å†µé€‚å½“æé«˜ï¼Œä½†ä¸å»ºè®®è®¾ç½®è¿‡å¤§ä»¥é˜²å¼•å…¥ä¸å¿…è¦çš„çº¿ç¨‹åˆ‡æ¢å¼€é”€ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;2. å¼€å¯ Hibernate Region&lt;/b&gt;&lt;/p&gt;&lt;p&gt;åœ¨å®é™…æƒ…å†µä¸‹ï¼Œè¯»å†™è¯·æ±‚å¹¶ä¸ä¼šå‡åŒ€çš„æ‰“åœ¨æ¯ä¸ª Region ä¸Šï¼Œè€Œæ˜¯ä¸»è¦é›†ä¸­åœ¨å°‘æ•°çš„ Region ä¸Šï¼Œé‚£ä¹ˆå¯¹äºæš‚æ—¶ç©ºé—²çš„ Region æˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥å°½é‡å‡å°‘å®ƒä»¬çš„æ¶ˆæ¯æ•°é‡ã€‚è¿™ä¹Ÿå°±æ˜¯ Hibernate Region çš„ä¸»è¦æ€æƒ³ï¼Œåœ¨æ— å¿…è¦çš„æ—¶å€™ä¸è¿›è¡Œ &lt;code&gt;raft-base-tick&lt;/code&gt;ï¼Œä¹Ÿå°±æ˜¯ä¸å»é©±åŠ¨é‚£äº›ç©ºé—² Region çš„ Raft çŠ¶æ€æœºï¼Œé‚£ä¹ˆå°±ä¸ä¼šè§¦å‘è¿™äº› Region çš„ Raft å¿ƒè·³ä¿¡æ¯çš„äº§ç”Ÿï¼Œæå¤§å¾—å‡å°äº† Raftstore çš„å·¥ä½œè´Ÿæ‹…ã€‚&lt;/p&gt;&lt;p&gt;æˆªæ­¢å‘ç¨¿æ—¶ Hibernate Region è¿˜æ˜¯ä¸€ä¸ªå®éªŒ featureï¼Œåœ¨ master ä¸Šå·²ç»é»˜è®¤å¼€å¯ã€‚å¦‚æœ‰éœ€è¦ï¼Œå¯é…Œæƒ…å¼€å¯ï¼Œç›¸å…³é…ç½®è¯´æ˜è¯·å‚è€ƒ &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/tikv/tikv/blob/master/docs/reference/configuration/raftstore-config.md%23hibernate-region&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;é…ç½® Hibernate Region&lt;/a&gt;ã€‚&lt;/p&gt;&lt;h2&gt;å…¶ä»–å¯èƒ½å‡ºç°çš„é—®é¢˜&lt;/h2&gt;&lt;h3&gt;PD Leader åˆ‡æ¢æ…¢&lt;/h3&gt;&lt;p&gt;PD éœ€è¦å°† Region Meta ä¿¡æ¯æŒä¹…åŒ–åœ¨ etcd ä»¥ä¿è¯ PD Leader èŠ‚ç‚¹åˆ‡æ¢åèƒ½å¿«é€Ÿç»§ç»­æä¾› Region è·¯ç”±æœåŠ¡ã€‚éšç€ Region æ•°é‡çš„å¢é•¿ï¼ŒEtcd çš„æ€§èƒ½é—®é¢˜ä¼šä½¿å¾— PD åœ¨åˆ‡æ¢ Leader æ—¶ä» etcd è·å–è¿™äº›ä¿¡æ¯æ—¶æ¯”è¾ƒæ…¢ï¼Œåœ¨ç™¾ä¸‡ Region é‡çº§æ—¶å¯èƒ½è¾¾åˆ°åå‡ ç§’ç”šè‡³å‡ åç§’ã€‚&lt;/p&gt;&lt;p&gt;å› æ­¤åœ¨ v3.0 ç‰ˆæœ¬ä¸­ PD å°† Region Meta ä¿¡æ¯å­˜åœ¨æœ¬åœ°çš„ LevelDB ä¸­ï¼Œé€šè¿‡å¦å¤–çš„æœºåˆ¶åŒæ­¥ PD èŠ‚ç‚¹é—´çš„ä¿¡æ¯ã€‚&lt;/p&gt;&lt;p&gt;åœ¨ v3.0 ç‰ˆæœ¬ä¸­ PD å·²ç»é»˜è®¤å¼€å¯é…ç½® &lt;code&gt;use-region-storage&lt;/code&gt;ï¼Œè€Œ v2.1 ç‰ˆæœ¬å¦‚ç¢°åˆ°ç±»ä¼¼é—®é¢˜å»ºè®®å‡çº§åˆ° v3.0ã€‚&lt;/p&gt;&lt;h3&gt;PD è·¯ç”±ä¿¡æ¯æ›´æ–°ä¸åŠæ—¶&lt;/h3&gt;&lt;p&gt;åœ¨ TiKV ä¸­æ˜¯ç”± pd-worker è¿™ä¸ªæ¨¡å—æ¥å°† Region Meta ä¿¡æ¯å®šæœŸä¸ŠæŠ¥ç»™ PDï¼Œåœ¨ TiKV é‡å¯æˆ–è€… Region Leader åˆ‡æ¢æ—¶éœ€è¦é€šè¿‡ç»Ÿè®¡ä¿¡æ¯é‡æ–°è®¡ç®— Region çš„ &lt;code&gt;approximate size/keys&lt;/code&gt;ã€‚é‚£ä¹ˆåœ¨ Region æ•°é‡æ¯”è¾ƒå¤šçš„æƒ…å†µä¸‹ï¼Œpd-worker å•çº¿ç¨‹å¯èƒ½æˆä¸ºç“¶é¢ˆï¼Œé€ æˆä»»åŠ¡çš„å †ç§¯ä¸èƒ½åŠæ—¶å¤„ç†ï¼Œå› æ­¤ PD ä¸èƒ½åŠæ—¶è·å–æŸäº› Region Meta ä¿¡æ¯ä»¥è‡´è·¯ç”±ä¿¡æ¯æ›´æ–°ä¸åŠæ—¶ã€‚è¯¥é—®é¢˜ä¸ä¼šå½±å“å®é™…çš„è¯»å†™ï¼Œä½†å¯èƒ½å¯¼è‡´ PD è°ƒåº¦çš„ä¸å‡†ç¡®ä»¥åŠ TiDB æ›´æ–° region cache æ—¶éœ€è¦å¤šå‡ æ¬¡ round-tripã€‚&lt;/p&gt;&lt;p&gt;å¯ä»¥åœ¨ TiKV grafana é¢æ¿ä¸­æŸ¥çœ‹ Task ä¸‹çš„ Worker pending tasks æ¥ç¡®å®š pd-worker æ˜¯å¦æœ‰ä»»åŠ¡å †ç§¯ï¼Œæ­£å¸¸æ¥è¯´ pending tasks åº”è¯¥ç»´æŒåœ¨ä¸€ä¸ªæ¯”è¾ƒä½çš„å€¼ã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-b63b732c01d613d5a4f856941328c4d5_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;375&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic2.zhimg.com/v2-b63b732c01d613d5a4f856941328c4d5_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-b63b732c01d613d5a4f856941328c4d5_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;375&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic2.zhimg.com/v2-b63b732c01d613d5a4f856941328c4d5_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-b63b732c01d613d5a4f856941328c4d5_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 4 æŸ¥çœ‹ pd-worker&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;æˆ‘ä»¬åœ¨ master ä¸Šå·²ç»å¯¹ pd-worker è¿›è¡Œäº†æ•ˆç‡ä¼˜åŒ–ï¼Œé¢„è®¡ä¼šåœ¨ v2.1.19 å’Œ v3.0.5 ä¸­å¸¦ä¸Šç›¸å…³ä¼˜åŒ–ï¼Œå¦‚ç¢°åˆ°ç±»ä¼¼é—®é¢˜å»ºè®®å‡çº§ã€‚&lt;/p&gt;&lt;h3&gt;Prometheus æŸ¥è¯¢æ…¢&lt;/h3&gt;&lt;p&gt;åœ¨å¤§è§„æ¨¡é›†ç¾¤ä¸­ï¼ŒTiKV å®ä¾‹æ•°çš„å¢åŠ ä¼šè®© Prometheus çš„æŸ¥è¯¢æ—¶çš„è®¡ç®—å‹åŠ›è¾ƒå¤§å¯¼è‡´ Grafana æŸ¥çœ‹ metrics æ—¶è¾ƒæ…¢ï¼Œåœ¨ v3.0 ç‰ˆæœ¬ä¸­é€šè¿‡è®¾ç½®äº†ä¸€äº› metrics çš„é¢„è®¡ç®—æœ‰æ‰€ç¼“è§£ã€‚&lt;/p&gt;&lt;h2&gt;æ€»ç»“&lt;/h2&gt;&lt;p&gt;æœ¬æ–‡ä»‹ç»äº†ç™¾ä¸‡çº§ Region çš„é›†ç¾¤è§„æ¨¡ä¸‹çš„å¸¸è§é—®é¢˜ä»¥åŠç›¸åº”çš„å¤„ç†æ–¹æ³•ã€‚æ€»ä½“æ¥è®²ï¼Œåœ¨ v3.0 ç‰ˆæœ¬ä¸­æˆ‘ä»¬åšäº†æ¯”è¾ƒå¤šçš„ä¼˜åŒ–ï¼Œæµ·é‡ Region å¯¼è‡´çš„æ€§èƒ½é—®é¢˜ä¸Šå·²ç»æœ‰äº†æ˜æ˜¾çš„æ”¹å–„ã€‚å¸Œæœ›æœ¬æ–‡åœ¨é—®é¢˜æ ¹æºçš„è§£é‡Šä¸Šèƒ½å¸®åŠ©è¯»è€…æ›´å¥½çš„ç†è§£ç›¸å…³å‚æ•°è°ƒæ•´èƒŒåçš„é€»è¾‘ï¼Œå¹¶èƒ½ä¸¾ä¸€åä¸‰åœ°åº”ç”¨åœ¨ç±»ä¼¼é—®é¢˜çš„è§£å†³ä¸Šã€‚æœ€åï¼Œâ€œé‡å˜å¼•èµ·è´¨å˜â€ï¼Œå¤§å®¶çš„å‚ä¸æ‰èƒ½è®©æˆ‘ä»¬çš„äº§å“æ›´è¿›ä¸€æ­¥ï¼ŒæœŸå¾…ä½ ä»¬çš„åé¦ˆå’Œå»ºè®®ï¼ˆzhangbokang@pingcap.comï¼‰ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;é˜…è¯»åŸæ–‡ï¼š&lt;/b&gt;&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pingcap.com/blog-cn/best-practice-massive-regions-performance-improvement/&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic2.zhimg.com/v2-60ab5bd867c2434d70c957a02a2169e1_ipico.jpg&quot; data-image-width=&quot;1200&quot; data-image-height=&quot;1200&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TiDB æœ€ä½³å®è·µç³»åˆ—ï¼ˆå››ï¼‰æµ·é‡ Region é›†ç¾¤è°ƒä¼˜ | PingCAP&lt;/a&gt;&lt;p&gt;&lt;b&gt;æ›´å¤šæœ€ä½³å®è·µ&lt;/b&gt;ï¼š&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pingcap.com/blog-cn/%23%25E6%259C%2580%25E4%25BD%25B3%25E5%25AE%259E%25E8%25B7%25B5&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;pingcap.com/blog-cn/#&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>ZoeyZhai</author>
<guid isPermaLink="false">2019-10-24-88236773</guid>
<pubDate>Thu, 24 Oct 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>æ–°æ¶æ„ã€æ–°è§’è‰²ï¼šTiDB Community Upgradeï¼</title>
<link>https://henix.github.io/feeds/zhuanlan.newsql/2019-10-23-88015069.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/88015069&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-c08ea34b4ac5c0903eaf665dd8b6654a_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;ä½œè€…ï¼šJian Zhang&lt;/p&gt;&lt;p&gt;ç»è¿‡å‡ å¹´çš„å‘å±•ï¼ŒTiDB ç¤¾åŒºå·²ç»é€æ¸æˆç†Ÿï¼Œä½†æ˜¯éšç€ç¤¾åŒºçš„å‘å±•å£®å¤§ï¼Œæˆ‘ä»¬é€æ¸æ„Ÿå—åˆ°äº†ç°åœ¨ç¤¾åŒºæ¶æ„ä¸Šçš„ä¸€äº›ä¸è¶³ã€‚ç»è¿‡ä¸€ç³»åˆ—çš„æ€è€ƒå’Œæ€»ç»“ï¼Œæˆ‘ä»¬å†³å®šå‡çº§å’Œè°ƒæ•´ç›®å‰ç¤¾åŒºç»„ç»‡æ¶æ„ï¼Œå¼•å…¥æ›´å¤šçš„ç¤¾åŒºè§’è‰²å’Œç¤¾åŒºç»„ç»‡ï¼Œä»¥ä¾¿æ›´å¥½çš„æ¿€å‘ç¤¾åŒºæ´»åŠ›ï¼Œç»´æŠ¤ç§¯æå¥åº·çš„ç¤¾åŒºç¯å¢ƒã€‚&lt;/p&gt;&lt;h2&gt;è€ç¤¾åŒºæ¶æ„&lt;/h2&gt;&lt;p&gt;ä¸‹å›¾æ˜¯ä¹‹å‰å®˜ç½‘ä¸Šçš„ç¤¾åŒºæ¶æ„å›¾ï¼š&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-872d9336a37bca16b8279cc55368ac69_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1122&quot; data-rawheight=&quot;408&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1122&quot; data-original=&quot;https://pic2.zhimg.com/v2-872d9336a37bca16b8279cc55368ac69_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-872d9336a37bca16b8279cc55368ac69_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1122&quot; data-rawheight=&quot;408&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1122&quot; data-original=&quot;https://pic2.zhimg.com/v2-872d9336a37bca16b8279cc55368ac69_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-872d9336a37bca16b8279cc55368ac69_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 1 è€ç¤¾åŒºæ¶æ„&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;è€ç¤¾åŒºæ¶æ„ä¸»è¦é¢å‘ TiDB å¼€å‘è€…ç¤¾åŒºï¼ˆDeveloper Groupï¼‰ï¼Œä¸»è¦è§’è‰²æœ‰ Maintainerã€Committerã€Contributor ç­‰ï¼Œå…¶ä¸­ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Committerï¼šç”± Maintainer æˆ– PMC æ¨èï¼Œæ˜¯å¯¹ TiDB æœ‰çªå‡ºè´¡çŒ®çš„ Contributorã€‚éœ€è¦ç‹¬ç«‹å®Œæˆè‡³å°‘ä¸€ä¸ª feature æˆ–ä¿®å¤é‡å¤§ bugã€‚&lt;/li&gt;&lt;li&gt;Maintainerï¼šé¡¹ç›®çš„è§„åˆ’å’Œè®¾è®¡è€…ï¼Œæ‹¥æœ‰åˆå¹¶ä¸»å¹²åˆ†æ”¯çš„æƒé™ï¼Œä» Committer ä¸­äº§ç”Ÿã€‚ä»–ä»¬å¿…é¡»å¯¹å­é¡¹ç›®çš„å¥åº·è¡¨ç°å‡ºè‰¯å¥½çš„åˆ¤æ–­åŠ›å’Œè´£ä»»æ„Ÿã€‚ç»´æŠ¤è€…å¿…é¡»ç›´æ¥æˆ–é€šè¿‡å§”æ´¾è¿™äº›èŒè´£æ¥è®¾ç½®æŠ€æœ¯æ–¹å‘å¹¶ä¸ºå­é¡¹ç›®åšå‡ºæˆ–æ‰¹å‡†è®¾è®¡å†³ç­–ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;å¯ä»¥çœ‹åˆ°è€ç¤¾åŒºæ¶æ„å±è”½äº†æ—¥ç›Šå£®å¤§çš„ã€å¯¹äº§å“æ‰“ç£¨å‡çº§è‡³å…³é‡è¦çš„ TiDB ç”¨æˆ·ç¾¤ä½“ï¼Œå¹¶ä¸”è€æ¶æ„ä¸­å¯¹äºå¼€å‘è€…ç¤¾åŒºè§’è‰²çš„èŒè´£ã€è§’è‰²ä¹‹é—´å…³ç³»çš„è¡¨è¿°éƒ½æ¯”è¾ƒç®€å•ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨æ–°ç¤¾åŒºæ¶æ„ä¸­åšäº†ä¸€äº›åŠ æ³•ï¼Œå°† TiDB ç”¨æˆ·ç¤¾åŒºçº³å…¥è¿›æ¥çš„åŒæ—¶ï¼Œå¯¹ TiDB å¼€å‘è€…ç¤¾åŒºçš„æ¯ä¸ªè§’è‰²å®šä¹‰ã€æƒè´£åˆåšäº†æ˜ç¡®çš„ç•Œå®šï¼ŒåŒæ—¶ä¹Ÿå¢åŠ äº†ä¸€äº›æ–°è§’è‰²ã€æ–°ç»„ç»‡ï¼Œä¸‹é¢è®©æˆ‘ä»¬æ¥è¯¦ç»†åœ°çœ‹ä¸€çœ‹ã€‚&lt;/p&gt;&lt;h2&gt;æ–°ç¤¾åŒºæ¶æ„&lt;/h2&gt;&lt;h3&gt;å˜åŒ– 1ï¼šå°† TiDB ç”¨æˆ·ç¤¾åŒºçº³å…¥æ•´ä½“ç¤¾åŒºæ¶æ„&lt;/h3&gt;&lt;p&gt;éšç€ TiDB äº§å“çš„æˆç†Ÿï¼ŒTiDB ç”¨æˆ·ç¾¤ä½“æ„ˆå‘å£®å¤§ï¼Œç”¨æˆ·åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜åé¦ˆåŠå®è·µç»éªŒï¼Œå¯¹äº TiDB äº§å“çš„å®Œå–„åŠåº”ç”¨æ¨å¹¿æœ‰ç€ä¸å¯å¿½è§†çš„é‡è¦ä½œç”¨ã€‚å› æ­¤æˆ‘ä»¬æ­¤æ¬¡æ­£å¼å°† TiDB ç”¨æˆ·ç¤¾åŒºï¼ˆTiDB User Groupï¼Œç®€ç§° TUGï¼‰çº³å…¥æ–°çš„ç¤¾åŒºæ¶æ„ä¸­æ¥ï¼Œå¸Œæœ›ç”¨æˆ·ä¸å¼€å‘è€…æœ‰æ›´å¥½çš„äº¤æµäº’åŠ¨ï¼Œä¸€èµ·æ¨åŠ¨ TiDB ç¤¾åŒºçš„å¥åº·å‘å±•ã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-0c6936dd513abe27678fbd4927b18742_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1090&quot; data-rawheight=&quot;440&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1090&quot; data-original=&quot;https://pic3.zhimg.com/v2-0c6936dd513abe27678fbd4927b18742_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-0c6936dd513abe27678fbd4927b18742_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1090&quot; data-rawheight=&quot;440&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1090&quot; data-original=&quot;https://pic3.zhimg.com/v2-0c6936dd513abe27678fbd4927b18742_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-0c6936dd513abe27678fbd4927b18742_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 2 æ–°ç¤¾åŒºæ¶æ„ä¹‹ User Group&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;TiDB User Groupï¼ˆTUGï¼‰æ˜¯ç”± TiDB ç”¨æˆ·å‘èµ·çš„ç‹¬ç«‹ã€éç›ˆåˆ©çš„ç¬¬ä¸‰æ–¹ç»„ç»‡ï¼Œç”¨æˆ·å®è¡Œè‡ªæˆ‘ç®¡ç†ï¼Œæ—¨åœ¨åŠ å¼º TiDB ç”¨æˆ·ä¹‹é—´çš„äº¤æµå’Œå­¦ä¹ ã€‚TUG çš„å½¢å¼åŒ…æ‹¬ä½†ä¸é™äºçº¿ä¸Šé—®ç­”å’ŒæŠ€æœ¯æ–‡ç« åˆ†äº«ã€çº¿ä¸‹æŠ€æœ¯æ²™é¾™ã€èµ°è¿›åä¼ã€å®˜æ–¹äº’åŠ¨æ´»åŠ¨ç­‰ç­‰ã€‚TUG æˆå‘˜å¯ä»¥é€šè¿‡çº¿ä¸Šã€çº¿ä¸‹çš„æ´»åŠ¨ï¼Œå­¦ä¹ å‰æ²¿æŠ€æœ¯çŸ¥è¯†ï¼Œå‘è¡¨æŠ€æœ¯è§è§£ï¼Œå…±åŒå»ºè®¾ TiDB é¡¹ç›®ã€‚æ›´å¤šä¿¡æ¯å¯ä»¥ç™»é™† TUG é—®ç­”è®ºå› &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//asktug.com/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;asktug.com&lt;/a&gt; æŸ¥çœ‹ã€‚&lt;/p&gt;&lt;h3&gt;å˜åŒ– 2ï¼šActive Contributor å’Œ Reviewer&lt;/h3&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-5a05ddc0ca23390dc5d0fccdcd5be436_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1122&quot; data-rawheight=&quot;452&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1122&quot; data-original=&quot;https://pic3.zhimg.com/v2-5a05ddc0ca23390dc5d0fccdcd5be436_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-5a05ddc0ca23390dc5d0fccdcd5be436_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1122&quot; data-rawheight=&quot;452&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1122&quot; data-original=&quot;https://pic3.zhimg.com/v2-5a05ddc0ca23390dc5d0fccdcd5be436_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-5a05ddc0ca23390dc5d0fccdcd5be436_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 3 æ–°ç¤¾åŒºæ¶æ„ä¹‹ Active Contributorã€Reviewer&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;ä¸Šå›¾åæ˜ äº†è¿™æ¬¡ç¤¾åŒºæ¶æ„å‡çº§çš„ç¬¬ 2 ä¸ªå˜åŒ–ï¼šåœ¨å¼€å‘è€…ç¤¾åŒºä¸­ï¼Œæ–°å¢äº† Reviewer å’Œ Active Contributor çš„è§’è‰²ã€‚&lt;/p&gt;&lt;p&gt;Active Contributor æ˜¯ä¸€å¹´è´¡çŒ®è¶…è¿‡ 8 ä¸ª PR çš„ Contributorã€‚Reviewer ä» Active Contributor ä¸­è¯ç”Ÿï¼Œå…·æœ‰ Review PR çš„ä¹‰åŠ¡ï¼Œå¹¶ä¸”å¯¹ TiDB æˆ–è€… TiKV æŸä¸ªå­æ¨¡å—çš„ PR çš„ç‚¹èµï¼ˆLGTMï¼‰æœ‰æ•ˆã€‚å…³äºè¿™äº›è§’è‰²ï¼Œæˆ‘ä»¬å°†åœ¨åæ–‡ä»‹ç» Special Interest Group æ—¶æ›´è¯¦ç»†åœ°ä»‹ç»ã€‚&lt;/p&gt;&lt;h3&gt;å˜åŒ– 3ï¼šSpecial Interest Group&lt;/h3&gt;&lt;p&gt;è®©æˆ‘ä»¬æŠŠå¼€å‘è€…ç¤¾åŒºæ¶æ„å›¾æ”¾å¤§å†çœ‹çœ‹ï¼š&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-7438105aa7bc9c04b2a515410ac1b3d9_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1122&quot; data-rawheight=&quot;883&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1122&quot; data-original=&quot;https://pic2.zhimg.com/v2-7438105aa7bc9c04b2a515410ac1b3d9_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-7438105aa7bc9c04b2a515410ac1b3d9_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1122&quot; data-rawheight=&quot;883&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1122&quot; data-original=&quot;https://pic2.zhimg.com/v2-7438105aa7bc9c04b2a515410ac1b3d9_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-7438105aa7bc9c04b2a515410ac1b3d9_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 4 æ–°ç¤¾åŒºæ¶æ„ä¹‹ Special Interest Group&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;ä¸Šå›¾å±•ç¤ºäº†ä»¥å‚ç›´çš„è§†è§’æ¥ç»†çœ‹å¼€å‘è€…ç¤¾åŒºçš„æ•´ä½“æ¶æ„ï¼Œåæ˜ äº†è¿™æ¬¡ç¤¾åŒºæ¶æ„å‡çº§çš„ç¬¬ 3 ä¸ªå˜åŒ–ï¼šå¼•å…¥äº† â€œä¸“é¡¹å…´è¶£å°ç»„â€ï¼ˆSpecial Interest Groupï¼Œç®€ç§° SIGï¼‰ã€‚&lt;/p&gt;&lt;p&gt;ä¸“é¡¹å…´è¶£å°ç»„ä¸»è¦è´Ÿè´£ TiDB/TiKV æŸä¸ªæ¨¡å—çš„å¼€å‘å’Œç»´æŠ¤å·¥ä½œï¼Œå¯¹è¯¥æ¨¡å—ä»£ç çš„è´¨é‡è´Ÿè´£ã€‚æˆ‘ä»¬å°†é‚€è¯·æ»¡è¶³æ¡ä»¶çš„ Active Contributor åŠ å…¥ä¸“é¡¹å…´è¶£å°ç»„ï¼Œå¼€å‘è€…ä»¬å°†åœ¨ä¸“é¡¹å…´è¶£å°ç»„ä¸­è·å¾—æ¥è‡ª Tech Lead ä»¬çš„æŒç»­æŒ‡å¯¼ï¼Œä¸€è¾¹é”»ç‚¼æŠ€æœ¯èƒ½åŠ›ï¼Œä¸€è¾¹ä¼˜åŒ–å’Œå®Œå–„è¯¥æ¨¡å—ã€‚ç¤¾åŒºå¼€å‘è€…ä»¬å¯é€šè¿‡ä¸“é¡¹å…´è¶£å°ç»„é€æ¸ä»åˆå§‹çš„ Active Contributor æˆé•¿ä¸ºå—åˆ°ç¤¾åŒºè®¤å¯çš„ Reviewerã€Committer å’Œ Maintainerã€‚ä¸€èˆ¬è€Œè¨€æ¯ä¸ªä¸“é¡¹å…´è¶£å°ç»„éƒ½ä¼šå‘¨æœŸæ€§çš„ç»„ç»‡ä¼šè®®ï¼Œè®¨è®ºæœ€è¿‘è¿›å±•å’Œé‡åˆ°çš„é—®é¢˜ï¼Œæ‰€æœ‰çš„ä¼šè®®è®¨è®ºéƒ½å…¬å¼€åœ¨ç¤¾åŒºä¸Šï¼Œæ–¹ä¾¿æ„Ÿå…´è¶£çš„åŒå­¦ä¸€èµ·å‚ä¸å’Œè®¨è®ºã€‚&lt;/p&gt;&lt;p&gt;å…·ä½“å¯å‚è€ƒç›®å‰æˆ‘ä»¬æ­£åœ¨è¿è¥çš„è¡¨è¾¾å¼ä¸“é¡¹å…´è¶£å°ç»„ï¼š&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/pingcap/community/tree/master/special-interest-groups/sig-expr&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Expression Special Interest Group&lt;/a&gt;ã€‚&lt;/p&gt;&lt;p&gt;å¦å¤–è¿™å¼ å›¾ä¹Ÿåæ˜ äº†ç¤¾åŒºè§’è‰²å’Œä¸“é¡¹å…´è¶£å°ç»„çš„å…³ç³»ï¼Œæˆ‘ä»¬æ¥ä»”ç»†çœ‹çœ‹ SIG ä¸­çš„ç¤¾åŒºè§’è‰²ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Active Contributor&lt;/li&gt;&lt;/ol&gt;&lt;ul&gt;&lt;li&gt;å³ä¸€å¹´è´¡çŒ®è¶…è¿‡ 8 ä¸ª PR çš„ Contributorã€‚&lt;/li&gt;&lt;li&gt;å¦‚æœè¦åŠ å…¥æŸä¸ª SIGï¼ŒæŸä¸ª Contributor éœ€è¦åœ¨ 1 å¹´å†…ä¸ºè¯¥ SIG æ‰€è´Ÿè´£çš„æ¨¡å—è´¡çŒ®è¶…è¿‡ 8 ä¸ªä»¥ä¸Šçš„ PRï¼Œè¿™æ ·å³å¯è·å¾—é‚€è¯·ï¼ŒåŠ å…¥è¯¥ SIG è¿›è¡Œé’ˆå¯¹æ€§çš„å­¦ä¹ å’Œè´¡çŒ®ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;2. Reviewer&lt;/p&gt;&lt;ul&gt;&lt;ul&gt;&lt;li&gt;éš¶å±äºæŸä¸ª SIGï¼Œå…·æœ‰ Review PR çš„ä¹‰åŠ¡ã€‚&lt;/li&gt;&lt;li&gt;Reviewer ä» Active Contributor ä¸­è¯ç”Ÿï¼Œå½“ Active Contributor å¯¹è¯¥æ¨¡å—æ‹¥æœ‰æ¯”è¾ƒæ·±åº¦çš„è´¡çŒ®ï¼Œå¹¶ä¸”å¾—åˆ° 2 ä¸ªæˆ– 2 ä¸ªä»¥ä¸Š Committer çš„æåæ—¶ï¼Œå°†è¢«é‚€è¯·æˆä¸ºè¯¥æ¨¡å—çš„ Reviewerã€‚&lt;/li&gt;&lt;li&gt;Reviewer å¯¹è¯¥æ¨¡å—ä»£ç çš„ç‚¹èµï¼ˆLGTMï¼‰æœ‰æ•ˆï¼ˆæ³¨ï¼šTiDB è¦æ±‚æ¯ä¸ª PR è‡³å°‘æ‹¥æœ‰ 2 ä¸ª LGTM åæ‰èƒ½å¤Ÿåˆå¹¶åˆ°å¼€å‘åˆ†æ”¯ï¼‰ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;p&gt;3. Tech Lead&lt;/p&gt;&lt;ul&gt;&lt;ul&gt;&lt;li&gt;å³ SIG çš„ç»„ç»‡è€…ï¼Œè´Ÿè´£ SIG çš„æ—¥å¸¸è¿è¥ï¼ŒåŒ…æ‹¬ç»„ç»‡ä¼šè®®ï¼Œè§£ç­”ç–‘é—®ç­‰ã€‚&lt;/li&gt;&lt;li&gt;Tech Lead éœ€è¦ä¸º SIG çš„ç®¡ç†å’Œæˆé•¿è´Ÿè´£ï¼Œè´£ä»»é‡å¤§ã€‚ç›®å‰æš‚æ—¶ç”± PingCAP å†…éƒ¨åŒäº‹æ‹…ä»»ï¼Œå°†æ¥å¯ç”±ç¤¾åŒºå¼€å‘è€…ä¸€èµ·æ‹…ä»»ï¼Œå’Œ PingCAP åŒäº‹ä¸€èµ·ä¸º SIG çš„è¿›æ­¥è€ŒåŠªåŠ›ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;p&gt;å†æ¥çœ‹çœ‹å¦å¤–ä¸¤ä¸ªè§’è‰²ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Committer&lt;/li&gt;&lt;/ol&gt;&lt;ul&gt;&lt;li&gt;èµ„æ·±çš„ç¤¾åŒºå¼€å‘è€…ï¼Œä» Reviewer ä¸­è¯ç”Ÿã€‚&lt;/li&gt;&lt;li&gt;å½“ Reviewer å¯¹è¯¥æ¨¡å—æ‹¥æœ‰éå¸¸æ·±åº¦çš„è´¡çŒ®ï¼Œæˆ–è€…åœ¨ä¿æŒå½“å‰æ¨¡å— Reviewer è§’è‰²çš„åŒæ—¶ï¼Œä¹Ÿåœ¨åˆ«çš„æ¨¡å—æ·±åº¦è´¡çŒ®æˆä¸ºäº† Reviewerï¼Œè¿™æ—¶ä»–å°±åœ¨æ·±åº¦æˆ–è€…å¹¿åº¦ä¸Šå…·å¤‡äº†æˆä¸º Committer çš„æ¡ä»¶ï¼Œåªè¦å†å¾—åˆ° 2 ä¸ªæˆ– 2 ä¸ªä»¥ä¸Š Maintainer çš„æåæ—¶ï¼Œå³å¯æˆä¸º Committerã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;2. Maintainer&lt;/p&gt;&lt;ul&gt;&lt;ul&gt;&lt;li&gt;é‡åº¦å‚ä¸ TiDB ç¤¾åŒºçš„å¼€å‘è€…ï¼Œä» Committer ä¸­è¯ç”Ÿï¼Œå¯¹ä»£ç  repo æ‹¥æœ‰å†™æƒé™ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;blockquote&gt;ä»¥ä¸Šç¤¾åŒºè§’è‰²çš„è¯¦ç»†çš„å®šä¹‰å’Œæƒè´£å†…å®¹å¯ä»¥åœ¨ &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pingcap.com/community-cn/developer-group/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;è¿™é‡Œ&lt;/a&gt; æŸ¥çœ‹ã€‚&lt;/blockquote&gt;&lt;h3&gt;å˜åŒ– 4ï¼šWorking Group&lt;/h3&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-ff195685d0159a0cb75bbe7cb3d3e606_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1122&quot; data-rawheight=&quot;660&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1122&quot; data-original=&quot;https://pic3.zhimg.com/v2-ff195685d0159a0cb75bbe7cb3d3e606_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-ff195685d0159a0cb75bbe7cb3d3e606_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1122&quot; data-rawheight=&quot;660&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1122&quot; data-original=&quot;https://pic3.zhimg.com/v2-ff195685d0159a0cb75bbe7cb3d3e606_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-ff195685d0159a0cb75bbe7cb3d3e606_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 5 æ–°ç¤¾åŒºæ¶æ„ä¹‹ Working Group&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;ç¬¬ 4 ä¸ªå˜åŒ–æ˜¯å¼€å‘è€…ç¤¾åŒºæ¶æ„ä¸­å¼•å…¥äº† â€œå·¥ä½œå°ç»„â€ï¼ˆWorking Groupï¼Œç®€ç§° WGï¼‰ã€‚å·¥ä½œå°ç»„æ˜¯ç”±ä¸ºäº†å®ŒæˆæŸä¸ªç‰¹å®šç›®æ ‡è€Œèšé›†åœ¨ä¸€èµ·çš„ç¤¾åŒºå¼€å‘è€…ä¸ PingCAP åŒäº‹ä¸€èµ·æˆç«‹ã€‚ä¸ºäº†å®Œæˆç›®æ ‡ï¼Œæœ‰äº›å·¥ä½œå°ç»„å¯èƒ½è·¨è¶Šå¤šä¸ª SIGï¼Œæœ‰äº›å°ç»„å¯èƒ½åªä¼šä¸“æ³¨åœ¨æŸä¸ªå…·ä½“çš„ SIG ä¸­åšæŸä¸ªå…·ä½“çš„äº‹æƒ…ã€‚&lt;/p&gt;&lt;p&gt;å·¥ä½œå°ç»„å…·æœ‰ç”Ÿå‘½å‘¨æœŸï¼Œä¸€æ—¦ç›®æ ‡å®Œæˆï¼Œå·¥ä½œå°ç»„å³å¯è§£æ•£ã€‚å·¥ä½œå°ç»„è¿è¥å’Œç®¡ç†çš„å”¯ä¸€ç›®æ ‡æ˜¯ç¡®ä¿è¯¥å°ç»„æˆç«‹æ—¶è®¾ç½®çš„ç›®æ ‡åœ¨é€‚å½“çš„æ—¶é—´å†…å®Œæˆã€‚ä¸€èˆ¬è€Œè¨€ï¼Œå·¥ä½œå°ç»„ä¹Ÿä¼šæœ‰å‘¨æœŸæ€§çš„ä¼šè®®ï¼Œç”¨äºæ€»ç»“ç›®å‰é¡¹ç›®è¿›å±•ï¼Œç¡®å®šä¸‹ä¸€æ­¥å®æ–½æ–¹æ¡ˆç­‰ã€‚&lt;/p&gt;&lt;p&gt;å¯å‚è€ƒç›®å‰æˆ‘ä»¬æ­£åœ¨è¿è¥çš„è¡¨è¾¾å¼å·¥ä½œå°ç»„ï¼š&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/pingcap/community/blob/master/working-groups/wg-vec-expr.md&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Vectorized Expression Working Group&lt;/a&gt;ã€‚&lt;/p&gt;&lt;h2&gt;æ€»ç»“å’Œæœªæ¥çš„å·¥ä½œ&lt;/h2&gt;&lt;p&gt;æ€»çš„æ¥è¯´ï¼Œè¿™æ¬¡ç¤¾åŒºæ¶æ„å‡çº§ä¸»è¦æœ‰å¦‚ä¸‹æ”¹è¿›ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;å¼•å…¥äº† TiDB ç”¨æˆ·ç¤¾åŒºï¼ˆTiDB User Groupï¼‰ã€‚&lt;/li&gt;&lt;li&gt;å¼•å…¥äº† Active Contributorã€Reviewer çš„ç¤¾åŒºè§’è‰²ã€‚&lt;/li&gt;&lt;li&gt;å¼•å…¥äº† Special Interest Groupï¼ˆSIGï¼‰ã€‚&lt;/li&gt;&lt;li&gt;å¼•å…¥äº† Working Groupï¼ˆWGï¼‰ã€‚&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;åœ¨ç¤¾åŒºè¿è¥æ–¹é¢ï¼Œæˆ‘ä»¬æœªæ¥è¿˜å°†ç»§ç»­ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;å®Œå–„ç¤¾åŒºæˆå‘˜æ™‹çº§çš„æŒ‡å¯¼æœºåˆ¶ï¼Œè®©ç¤¾åŒºåŒå­¦ä» Contributor æˆé•¿åˆ° Committer æˆ– Maintainer æœ‰è·¯å¯å¾ªã€‚&lt;/li&gt;&lt;li&gt;è®©ç¤¾åŒºä¸Šçš„äº‹æƒ…æ›´åŠ æˆä½“ç³»ï¼Œåšäº‹ä¸ä¹±ã€‚&lt;/li&gt;&lt;li&gt;è®©ç¤¾åŒºåŒå­¦æ›´æœ‰å½’å±æ„Ÿï¼ŒåŠ å¼ºå’Œå…¶ä»–ç¤¾åŒºæˆå‘˜çš„æ²Ÿé€šã€‚&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;åœ¨æœªæ¥ï¼Œæˆ‘ä»¬å°†é™†ç»­å¼€æ”¾æ›´å¤šçš„ä¸“é¡¹å…´è¶£å°ç»„å’Œå·¥ä½œå°ç»„ã€‚åœ¨ä¸“é¡¹å…´è¶£å°ç»„ä¸­ï¼Œè¿˜å°†æŒç»­å‘æ”¾æ›´å¤šæ•°æ®åº“ç›¸å…³çš„èµ„æ–™ï¼Œå¸®åŠ©æˆå‘˜åœ¨ä¸“é¡¹å…´è¶£å°ç»„ä¸­é€æ¸æ·±åº¦å‚ä¸ TiDB çš„å¼€å‘å·¥ä½œã€‚å¸Œæœ›å¤§å®¶éƒ½èƒ½å¤Ÿå¤šå¤šå‚ä¸è¿›æ¥ï¼Œä¸€èµ·å°† TiDB æ‰“é€ æˆå¼€æºåˆ†å¸ƒå¼å…³ç³»å‹æ•°æ®åº“çš„äº‹å®æ ‡å‡†ï¼&lt;/p&gt;&lt;p&gt;&lt;b&gt;é˜…è¯»åŸæ–‡ï¼š&lt;/b&gt;&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pingcap.com/blog-cn/tidb-community-upgrade/&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic4.zhimg.com/v2-6748fc5f8128495a8afbfb40de50dc27_180x120.jpg&quot; data-image-width=&quot;1500&quot; data-image-height=&quot;1000&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;æ–°æ¶æ„ã€æ–°è§’è‰²ï¼šTiDB Community Upgradeï¼ | PingCAP&lt;/a&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>ZoeyZhai</author>
<guid isPermaLink="false">2019-10-23-88015069</guid>
<pubDate>Wed, 23 Oct 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>ç½‘æ˜“äº’å¨±çš„æ•°æ®åº“é€‰å‹å’Œ TiDB åº”ç”¨å®è·µ</title>
<link>https://henix.github.io/feeds/zhuanlan.newsql/2019-10-22-87945199.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/87945199&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-c7c2edf92e205ae540dc9e1f3bce5a97_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;blockquote&gt;ä½œè€…ä»‹ç»ï¼šææ–‡æ°ï¼Œç½‘æ˜“äº’å¨±è®¡è´¹ç»„ï¼Œé«˜çº§æ•°æ®åº“ç®¡ç†å·¥ç¨‹å¸ˆï¼ŒTiDB User Group Ambassadorã€‚&lt;/blockquote&gt;&lt;h2&gt;ä¸€ã€ä¸šåŠ¡æ¶æ„ç®€ä»‹&lt;/h2&gt;&lt;p&gt;è®¡è´¹ç»„æ˜¯ä¸ºç½‘æ˜“äº’å¨±äº§å“æä¾›ç»Ÿä¸€ç™»å½•å’Œæ”¯ä»˜é«˜æ•ˆè§£å†³æ–¹æ¡ˆçš„å…¬å…±æ”¯æŒéƒ¨é—¨ï¼Œå¯¹å†…æ˜¯äº’å¨±çš„å„ä¸ªæ¸¸æˆå·¥ä½œå®¤ï¼Œå¯¹å¤–æ˜¯å›½å†…å¤–æ•°ç™¾ä¸ªæ¸ é“ã€‚ç”±äºä¸šåŠ¡åœºæ™¯çš„ç‰¹æ®Šæ€§ï¼Œæˆ‘ä»¬ä¸ºå„ä¸ªæ¸¸æˆäº§å“éƒ¨ç½²äº†ä¸åŒçš„åº”ç”¨æœåŠ¡ï¼Œå…¶ä¸­å¤§äº§å“ç¯å¢ƒç‹¬ç«‹ï¼Œå°äº§å“é›†ä¸­éƒ¨ç½²ã€‚&lt;/p&gt;&lt;p&gt;éšç€éƒ¨é—¨ä¸šåŠ¡é‡çš„æ¿€å¢ï¼Œå•æœº MySQL åœ¨å®¹é‡ã€æ€§èƒ½ã€æ‰©å±•æ€§ç­‰æ–¹é¢éƒ½é‡åˆ°äº†ç“¶é¢ˆï¼Œæˆ‘ä»¬å¼€å§‹å¯¹å…¶ä»–æ•°æ®åº“äº§å“è¿›è¡Œè°ƒç ”é€‰å‹ã€‚æœ¬æ–‡å°†è¯¦ç»†ä»‹ç»ç½‘æ˜“äº’å¨±è®¡è´¹ç»„é’ˆå¯¹è‡ªå·±åœºæ™¯çš„æ•°æ®åº“é€‰å‹å¯¹æ¯”æ–¹æ¡ˆï¼Œä»¥åŠä½¿ç”¨ TiDB åè§£å†³çš„é—®é¢˜ï¼Œå¹¶åˆ†äº«äº†ä½¿ç”¨ TiDB è¿‡ç¨‹ä¸­é›†ç¾¤ç®¡ç†ã€ç›‘æ§å’Œæ•°æ®è¿ç§»ç­‰æ–¹é¢çš„æœ€ä½³å®è·µï¼Œä»¥ä¾›å¤§å®¶å‚è€ƒå’Œäº¤æµã€‚&lt;/p&gt;&lt;h3&gt;1.1 MySQL ä½¿ç”¨æ¶æ„&lt;/h3&gt;&lt;p&gt;ç½‘æ˜“äº’å¨±è®¡è´¹ç»„çº¿ä¸Š MySQL çš„åŸºæœ¬ä½¿ç”¨æ¶æ„ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå…¶ä¸­ç®­å¤´æ–¹å‘è¡¨ç¤ºæ•°æ®æˆ–è¯·æ±‚çš„æŒ‡å‘ï¼š&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-e701bf359f428776beadb051bd789a73_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;527&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic4.zhimg.com/v2-e701bf359f428776beadb051bd789a73_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-e701bf359f428776beadb051bd789a73_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;527&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic4.zhimg.com/v2-e701bf359f428776beadb051bd789a73_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-e701bf359f428776beadb051bd789a73_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 1 ç½‘æ˜“äº’å¨±è®¡è´¹ç»„çº¿ä¸Š MySQL ä½¿ç”¨æ¶æ„&lt;/figcaption&gt;&lt;/figure&gt;&lt;ul&gt;&lt;li&gt;çº¿ä¸Šåº”ç”¨ Application é€šè¿‡ Keepalive + å¤šæœºéƒ¨ç½²ï¼Œæµé‡ç»è¿‡è´Ÿè½½å‡è¡¡ï¼Œå¯ä»¥æœ‰æ•ˆä¿éšœåº”ç”¨æœåŠ¡çš„é«˜å¯ç”¨ï¼›&lt;/li&gt;&lt;li&gt;æ•°æ®åº“å±‚æ¶æ„æ˜¯ Keepalive + ä¸»ä»ç»“æ„ï¼Œåˆ©ç”¨åŠåŒæ­¥å¤åˆ¶ç‰¹æ€§å¯ä»¥æœ‰æ•ˆè§£å†³å»¶è¿Ÿå’Œæ•°æ®ä¸€è‡´æ€§çš„é—®é¢˜ï¼›&lt;/li&gt;&lt;li&gt;Application é€šè¿‡ VIP è®¿é—®åç«¯æ•°æ®åº“ï¼Œåœ¨æ•°æ®åº“ä¸»èŠ‚ç‚¹å®•æœºåé€šè¿‡ VIP é£˜ç§»åˆ°ä»èŠ‚ç‚¹ï¼Œä¿è¯æœåŠ¡æ­£å¸¸å¯¹å¤–æä¾›ï¼›&lt;/li&gt;&lt;li&gt;é€šè¿‡ Slave èŠ‚ç‚¹è¿›è¡Œæ•°æ®å¤‡ä»½å’Œçº¿ä¸Šæ•°æ®é‡‡é›†ï¼Œç»è¿‡å…¨é‡å’Œå¢é‡åŒæ­¥æ–¹å¼å¯¼å‡ºæ•°æ®åˆ°æ•°æ®ä¸­å¿ƒï¼Œç„¶åè¿›è¡Œåœ¨çº¿å’Œç¦»çº¿è®¡ç®—ä»»åŠ¡ï¼›&lt;/li&gt;&lt;li&gt;ç±»ä¼¼è¿™æ ·çš„æ¶æ„ç»„åˆçº¿ä¸Šå¤§æ¦‚æœ‰ 50+ å¥—ï¼Œæ¶‰åŠæœåŠ¡å™¨ 200~400 å°ï¼Œæ—¥å‡æ–°å¢æ•°æ® TB çº§ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;h3&gt;1.2 MySQL ä½¿ç”¨çš„ç°çŠ¶ä¸é—®é¢˜&lt;/h3&gt;&lt;p&gt;éšç€ä¸šåŠ¡çš„å‘å±•ï¼Œéƒ¨é—¨å†…å„åº”ç”¨æœåŠ¡äº§ç”Ÿçš„æ•°æ®é‡ä¹Ÿåœ¨å¿«é€Ÿå¢é•¿ã€‚ä¸šåŠ¡è½åœ°æ•°æ®é‡ä¸æ–­æ¿€å¢ï¼Œå¯¼è‡´å•æœº MySQL ä¸å¯é¿å…åœ°ä¼šå‡ºç°æ€§èƒ½ç“¶é¢ˆã€‚ä¸»è¦ä½“ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;å®¹é‡&lt;/li&gt;&lt;ul&gt;&lt;li&gt;å•æœº MySQL å®ä¾‹å­˜å‚¨ç©ºé—´æœ‰é™ï¼Œæƒ³è¦ç»´æŒç°æœ‰æ¶æ„å°±å¾—åˆ é™¤å’Œè½®è½¬æ—§æ•°æ®ï¼Œè¾¾åˆ°é‡Šæ”¾ç©ºé—´çš„ç›®çš„ï¼›&lt;/li&gt;&lt;li&gt;ç½‘æ˜“äº’å¨±æŸäº›åœºæ™¯å•è¡¨å®¹é‡è¾¾åˆ° 700GB ä»¥ä¸Šï¼Œè®¢å•æ•°æ®éœ€æ°¸ä¹…ä¿å­˜ï¼ŒåŒæ—¶ä¹Ÿéœ€è¦ä¿æŒåœ¨çº¿å®æ—¶æŸ¥è¯¢ï¼ŒæŒ‰ç…§ä¹‹å‰çš„å­˜å‚¨è®¾è®¡ä¼šå‡ºç°æ˜æ˜¾çš„ç“¶é¢ˆã€‚&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;æ€§èƒ½&lt;/li&gt;&lt;ul&gt;&lt;li&gt;æœ€å¤§å•è¡¨ 15 äº¿è¡Œï¼Œè¡Œæ•°è¿‡å¤§ï¼Œå¯¼è‡´è¯»å†™æ€§èƒ½å—åˆ°å½±å“ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;æ‰©å±•æ€§&lt;/li&gt;&lt;ul&gt;&lt;li&gt;MySQL æ— æ³•åœ¨çº¿çµæ´»æ‰©å±•ï¼Œæ— æ³•è§£å†³å­˜å‚¨ç“¶é¢ˆã€‚&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;SQL å¤æ‚&lt;/li&gt;&lt;ul&gt;&lt;li&gt;å¤§è¡¨è½®è½¬åå‡ºç°å¤šä¸ªåˆ†è¡¨ï¼Œè”åˆæŸ¥è¯¢æ—¶éœ€è¦ join å¤šä¸ªåˆ†è¡¨ï¼ŒSQL éå¸¸å¤æ‚å¹¶éš¾ä»¥ç»´æŠ¤ï¼›&lt;/li&gt;&lt;li&gt;å•æœº MySQL ç¼ºä¹å¤§è§„æ¨¡æ•°æ®åˆ†æçš„èƒ½åŠ›ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;æ•°æ®å£å’&lt;/li&gt;&lt;ul&gt;&lt;li&gt;ä¸åŒäº§å“çš„æ•°æ®åº“ç‹¬ç«‹éƒ¨ç½²ï¼›&lt;/li&gt;&lt;li&gt;æ•°æ®ä¸äº’é€šï¼Œå¯¼è‡´æ•°æ®ç›¸å…³éš”ç¦»ï¼Œå½¢æˆæ•°æ®å£å’ï¼›&lt;/li&gt;&lt;li&gt;å½“è¿›è¡Œè·¨äº§å“è®¡ç®—æ—¶ï¼Œéœ€è¦ç»´æŠ¤å¤šä¸ªå¼‚æ„æ•°æ®æºï¼Œè®¿é—®æ–¹å¼å¤æ‚ã€‚æ•°æ®åˆ†æ•£åœ¨ä¸åŒçš„æ•°æ®å­¤å²›ä¸Šä¼šå¢åŠ æ•°æ®åˆ†æéš¾åº¦ï¼Œä¸åˆ©äºå…±æ€§ä»·å€¼çš„æŒ–æ˜ã€‚å¦‚ä¸‹å›¾ï¼š&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-19112c8c75fc02890d7d5fb7c83d082f_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;522&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic4.zhimg.com/v2-19112c8c75fc02890d7d5fb7c83d082f_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-19112c8c75fc02890d7d5fb7c83d082f_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;522&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic4.zhimg.com/v2-19112c8c75fc02890d7d5fb7c83d082f_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-19112c8c75fc02890d7d5fb7c83d082f_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 2 ç°çŠ¶ä¹‹æ•°æ®å­¤å²›&lt;/figcaption&gt;&lt;/figure&gt;&lt;h2&gt;äºŒã€æ•°æ®åº“é€‰å‹&lt;/h2&gt;&lt;h3&gt;2.1 è°ƒç ”ç›®æ ‡&lt;/h3&gt;&lt;p&gt;é’ˆå¯¹ç›®å‰å­˜å‚¨æ¶æ„å­˜åœ¨çš„é—®é¢˜ï¼Œæœ‰éœ€è¦ä½¿ç”¨å…¶ä»–å­˜å‚¨æ–¹æ¡ˆçš„å¯èƒ½ã€‚è€ƒè™‘åˆ°ç›®å‰çš„ä¸šåŠ¡ä¸ MySQL é«˜åº¦è€¦åˆï¼Œå¯¹æ•°æ®åº“é€‰å‹çš„ä¸»è¦è¦æ±‚æœ‰ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;å¿…é¡»å…¼å®¹ MySQL åè®®ï¼›&lt;/li&gt;&lt;li&gt;æ”¯æŒäº‹åŠ¡ï¼Œä¿è¯ä»»åŠ¡ä»¥äº‹åŠ¡ä¸ºç»´åº¦æ¥æ‰§è¡Œæˆ–é‡é”™å›æ»šï¼›&lt;/li&gt;&lt;li&gt;æ”¯æŒç´¢å¼•ï¼Œå°¤å…¶æ˜¯äºŒçº§ç´¢å¼•ï¼›&lt;/li&gt;&lt;li&gt;æ‰©å±•æ€§ï¼Œæ”¯æŒçµæ´»åœ¨çº¿æ‰©å±•èƒ½åŠ›ï¼ŒåŒ…æ‹¬æ€§èƒ½æ‰©å±•å’Œå®¹é‡æ‰©å±•ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;å…¶ä»–è¦æ±‚ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;ç¨³å®šæ€§å’Œå¯é æ€§ï¼›&lt;/li&gt;&lt;li&gt;å¤‡ä»½å’Œæ¢å¤ï¼›&lt;/li&gt;&lt;li&gt;å®¹ç¾ç­‰ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;h3&gt;2.2 å¯é€‰æ–¹æ¡ˆ&lt;/h3&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-4e2c5d05280b41a4559bf6e8e882e5d3_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1072&quot; data-rawheight=&quot;458&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1072&quot; data-original=&quot;https://pic4.zhimg.com/v2-4e2c5d05280b41a4559bf6e8e882e5d3_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-4e2c5d05280b41a4559bf6e8e882e5d3_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1072&quot; data-rawheight=&quot;458&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1072&quot; data-original=&quot;https://pic4.zhimg.com/v2-4e2c5d05280b41a4559bf6e8e882e5d3_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-4e2c5d05280b41a4559bf6e8e882e5d3_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;h3&gt;2.3 æµ‹è¯•&lt;/h3&gt;&lt;h3&gt;2.3.1 åŸºäº MySQL çš„è§£å†³æ–¹æ¡ˆ&lt;/h3&gt;&lt;p&gt;ä¸€å¼€å§‹ä»ç„¶æ˜¯å€¾å‘ä½¿ç”¨åŸºäº MySQL çš„è§£å†³æ–¹æ¡ˆï¼Œæ¯”å¦‚ MySQL InnoDB Cluster æˆ– MySQL + ä¸­é—´ä»¶çš„æ–¹æ¡ˆã€‚&lt;/p&gt;&lt;p&gt;æˆ‘ä»¬æµ‹è¯•äº† MySQL é›†ç¾¤ 5.7.25 ç‰ˆæœ¬å¯¹æ¯” 8.0.12 ç‰ˆæœ¬ï¼Œåœ¨ 128 å¹¶å‘å†™å„ 1000 ä¸‡è¡Œçš„ 10 ä¸ªè¡¨ï¼Œæ¯”è¾ƒå•èŠ‚ç‚¹ã€3 èŠ‚ç‚¹å’Œ 5 èŠ‚ç‚¹ä¸‹çš„æƒ…å†µï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-e043a4e85967a6d57373fab5b129d034_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;462&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic1.zhimg.com/v2-e043a4e85967a6d57373fab5b129d034_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-e043a4e85967a6d57373fab5b129d034_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;462&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic1.zhimg.com/v2-e043a4e85967a6d57373fab5b129d034_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-e043a4e85967a6d57373fab5b129d034_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 3 å¯¹æ¯”ç»“æœ&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;åœ¨æµ‹è¯•ä¸­å‘ç°ï¼Œä½¿ç”¨ MySQL InnoDB é›†ç¾¤çš„æ–¹æ¡ˆå†™æ€§èƒ½æ¯”å•æœº MySQL å·®çº¦ 30%ï¼Œå…¶ä»–çš„è¯»å†™æµ‹è¯•ç»“æœä¹Ÿä¸ç”šæ»¡æ„ã€‚ä¹‹åé™†ç»­æµ‹è¯• MySQL InnoDB Cluster æˆ– MySQL + ä¸­é—´ä»¶çš„æ–¹æ¡ˆï¼Œä¸æ˜¯æµ‹è¯•ç»“æœæ€§èƒ½ä¸è¾¾è¦æ±‚ï¼Œå°±æ˜¯éœ€è¦ä¿®æ”¹å¤§é‡ä»£ç ã€‚&lt;/p&gt;&lt;p&gt;å› æ­¤æˆ‘ä»¬å¾—å‡ºäº†åŸºäº MySQL InnoDB Cluster æˆ– MySQL + ä¸­é—´ä»¶çš„æ–¹æ¡ˆçš„ä¸æ»¡è¶³æˆ‘ä»¬çš„ä¸šåŠ¡åœºæ™¯çš„ç»“è®ºã€‚æ€»ç»“æ¥è¯´ï¼Œæˆ‘ä»¬ä¸ä½¿ç”¨ MySQL åˆ†åº“åˆ†è¡¨ã€ä¸­é—´ä»¶æˆ– MySQL é›†ç¾¤ï¼ŒåŸå› ä¸»è¦æ˜¯ä»¥ä¸‹ä¸¤ç‚¹ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;æ–¹æ¡ˆè¿‡äºå¤æ‚&lt;/li&gt;&lt;li&gt;éœ€è¦æ”¹ä¸šåŠ¡ä»£ç &lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;ä»”ç»†åˆ†ææ¥çœ‹ï¼Œå…¶å®åŸºäº MySQL InnoDB Cluster æˆ– MySQL + ä¸­é—´ä»¶çš„æ–¹æ¡ˆï¼Œæœ¬è´¨ä¸Šæ˜¯ MySQL ä¸»ä»ç»“æ„çš„å»¶ä¼¸ï¼Œå¹¶éçœŸæ­£çš„åˆ†å¸ƒå¼æ‹“å±•ï¼Œåƒæ˜¯ä»¥æ‰“â€œè¡¥ä¸â€çš„æ–¹å¼æ¥å®ç°æ¨ªå‘æ‰©å±•ï¼Œå¾ˆå¤šåŠŸèƒ½ç‰¹æ€§è‡ªç„¶ä¹Ÿéš¾ä»¥è®©äººæ»¡æ„ã€‚&lt;/b&gt;&lt;/p&gt;&lt;h3&gt;2.3.2 CockroachDB VS TiDB&lt;/h3&gt;&lt;p&gt;åœ¨å¼€æºçš„åˆ†å¸ƒå¼ NewSQL é¢†åŸŸï¼ŒçŸ¥åçš„æœ‰ TiDB å’Œ CockroachDBï¼ˆç®€ç§° CRDBï¼‰ï¼ŒäºŒè€…éƒ½æ˜¯åŸºäº Google Spanner è®ºæ–‡çš„å¼€æºå®ç°ã€‚æˆ‘ä»¬å¯¹è¿™ä¸¤ç§æ•°æ®åº“çš„åŠŸèƒ½å’Œæ€§èƒ½åšäº†å¤§é‡çš„è°ƒç ”å’Œæµ‹è¯•ã€‚&lt;/p&gt;&lt;ul&gt;&lt;li&gt;TiDB å¤©ç„¶å…¼å®¹ MySQL åè®®ï¼Œè€Œ CRDB å…¼å®¹ PostgreSQL ï¼›&lt;/li&gt;&lt;li&gt;å¦‚æœä¸šåŠ¡ä»¥ MySQL ä¸ºä¸»ï¼Œé‚£ TiDB å¯èƒ½æ˜¯æ¯”è¾ƒå¥½çš„é€‰æ‹©ï¼›å¦‚æœæ˜¯ PostgreSQLï¼Œé‚£CRDB å¯èƒ½æ˜¯ä¼˜å…ˆçš„é€‰æ‹©ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;æµ‹è¯•æ–¹é¢ï¼Œæˆ‘ä»¬ä¹Ÿè¿›è¡Œäº†å…¨é¢åœ°å¯¹æ¯”å’Œæµ‹è¯•ã€‚è¿™é‡Œè¯´å…¶ä¸­ä¸€ä¸ªæµ‹è¯•æ¡ˆä¾‹ï¼š10 å°æœºå™¨ 5 å­˜å‚¨èŠ‚ç‚¹ï¼Œ160 å¹¶å‘è®¿é—®å•è¡¨ 2 äº¿è¡Œï¼Œæˆ‘ä»¬äº 2018 å¹´ 7 æœˆï¼Œå¯¹ CRDB-v2.1.0 ç‰ˆæœ¬å’Œ TiDB-v2.0.5 ç‰ˆæœ¬è¿›è¡Œäº†è¯»å†™æµ‹è¯•ï¼ˆCRDB å’Œ TiDB é›†ç¾¤å‡ä½¿ç”¨é»˜è®¤é…ç½®ï¼Œæœªè¿›è¡Œè°ƒä¼˜ï¼‰ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;é›†ç¾¤æ‹“æ‰‘&lt;/b&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-b87fcc3484e0ed11b7415194bacca766_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;464&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic3.zhimg.com/v2-b87fcc3484e0ed11b7415194bacca766_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-b87fcc3484e0ed11b7415194bacca766_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;464&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic3.zhimg.com/v2-b87fcc3484e0ed11b7415194bacca766_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-b87fcc3484e0ed11b7415194bacca766_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 4 CockroachDB æµ‹è¯•é›†ç¾¤æ­å»º&lt;/figcaption&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-2df8880a5aadd7b661237be784bd12c0_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;531&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic1.zhimg.com/v2-2df8880a5aadd7b661237be784bd12c0_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-2df8880a5aadd7b661237be784bd12c0_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;531&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic1.zhimg.com/v2-2df8880a5aadd7b661237be784bd12c0_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-2df8880a5aadd7b661237be784bd12c0_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 5 TiDB æµ‹è¯•é›†ç¾¤æ­å»º&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;æµ‹è¯•è¯­å¥&lt;/b&gt;&lt;/p&gt;&lt;p&gt;èŒƒå›´æŸ¥è¯¢ï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;SELECT c FROM sbtest%u WHERE id BETWEEN ? AND ?
SELECT SUM(k) FROM sbtest%u WHERE id BETWEEN ? AND ?
SELECT c FROM sbtest WHERE id BETWEEN ? AND ? ORDER BY c
SELECT DISTINCT c FROM sbtest%u WHERE id BETWEEN ? AND ? ORDER BY c&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;&lt;li&gt;éšæœº IN æŸ¥è¯¢ï¼š&lt;/li&gt;&lt;/ul&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;SELECT id, k, c, pad FROM sbtest1 WHERE k IN (?)&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;&lt;li&gt;éšæœºèŒƒå›´æŸ¥è¯¢ï¼š&lt;/li&gt;&lt;/ul&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;SELECT count(k) FROM sbtest1 WHERE k BETWEEN ? AND ? OR k BETWEEN ? AND ?&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;&lt;li&gt;æ›´æ–°ç´¢å¼•åˆ—ï¼š&lt;/li&gt;&lt;/ul&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;UPDATE sbtest%u SET k=k+1 WHERE id=?&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;&lt;li&gt;æ›´æ–°éç´¢å¼•åˆ—ï¼š&lt;/li&gt;&lt;/ul&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;UPDATE sbtest%u SET c=? WHERE id=?&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;&lt;li&gt;è¯»å†™æ··åˆï¼šèŒƒå›´æŸ¥è¯¢ + æ›´åˆ æ”¹æ··åˆ&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;å…¶ä¸­ä¸€ä¸ªé‡è¦çš„æµ‹è¯•ç»“æœå¦‚ä¸‹ï¼š&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-bcc6cccccdc3e119d41a5e053187f2b7_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;466&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic4.zhimg.com/v2-bcc6cccccdc3e119d41a5e053187f2b7_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-bcc6cccccdc3e119d41a5e053187f2b7_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;466&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic4.zhimg.com/v2-bcc6cccccdc3e119d41a5e053187f2b7_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-bcc6cccccdc3e119d41a5e053187f2b7_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 6 æµ‹è¯•ç»“æœ&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;ç»“è®ºï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;CRDB å’Œ TiDB åœ¨æ€§èƒ½è¡¨ç°ä¸Šä¸ç›¸ä¸Šä¸‹ï¼›&lt;br/&gt;æ³¨ï¼šä¸Šé¢æ˜¯ 2018 å¹´ 7 æœˆçš„åŸºäº TiDB 2.0.5 ç‰ˆæœ¬çš„æµ‹è¯•ç»“æœï¼Œç°åœ¨ &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pingcap.com/docs-cn/v3.0/releases/3.0-ga/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TiDB å·²å‘å¸ƒ 3.0 GA ç‰ˆæœ¬ï¼Œåœ¨æ€§èƒ½ä¸Šæœ‰äº†è´¨çš„æå‡&lt;/a&gt;ï¼Œæˆ‘ä»¬åœ¨è¿‘æœŸè¿›è¡Œäº†è¡¥å……æµ‹è¯•ï¼Œå¤§å¤šæ•°åœºæ™¯ä¸‹ 3.0 ç‰ˆæœ¬è¾ƒ 2.1 ç‰ˆæœ¬æœ‰æ•°å€çš„æ€§èƒ½æå‡ï¼Œæœ€æ–°çš„æµ‹è¯•ç»“æœå›¾å¦‚ä¸‹ï¼š&lt;br/&gt;&lt;/li&gt;&lt;/ol&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-126246b456e76b94f40b965841eebc36_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;452&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic3.zhimg.com/v2-126246b456e76b94f40b965841eebc36_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-126246b456e76b94f40b965841eebc36_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;452&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic3.zhimg.com/v2-126246b456e76b94f40b965841eebc36_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-126246b456e76b94f40b965841eebc36_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 7 TiDB 2.1.15 vs 3.0.3ï¼šOLTP å³°å€¼æ¯”è¾ƒ&lt;/figcaption&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-d6716918375f8a4f1142a803e01dbc0c_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;306&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic1.zhimg.com/v2-d6716918375f8a4f1142a803e01dbc0c_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-d6716918375f8a4f1142a803e01dbc0c_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;306&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic1.zhimg.com/v2-d6716918375f8a4f1142a803e01dbc0c_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-d6716918375f8a4f1142a803e01dbc0c_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 8 TiDB 2.1.15 vs 3.0.3ï¼šTPC-C&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;2. CRDB å…¼å®¹ PostgreSQLï¼Œå¦‚æœéœ€è¦è¿ç§»åˆ™éœ€è¦è½¬åè®®ï¼Œéœ€ MySQL â†’ PostgreSQL  â†’ CRDBã€‚è¿ç§»è¿‡ç¨‹å¤æ‚ï¼Œæˆæœ¬é«˜ï¼›&lt;/p&gt;&lt;p&gt;3. TiDB å…¼å®¹ MySQLï¼Œä»£ç ä¿®æ”¹é‡ä¸å¤šï¼Œè¿ç§»æˆæœ¬ä½ã€‚&lt;/p&gt;&lt;h3&gt;2.3.3 æœ€ç»ˆé€‰å‹&lt;/h3&gt;&lt;p&gt;ç»¼åˆå¯¹æ¯”ç»“æœå¦‚ä¸‹è¡¨ï¼š&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-7f97b461d169b0fd1ca972e1f527e5b7_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;970&quot; data-rawheight=&quot;452&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;970&quot; data-original=&quot;https://pic4.zhimg.com/v2-7f97b461d169b0fd1ca972e1f527e5b7_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-7f97b461d169b0fd1ca972e1f527e5b7_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;970&quot; data-rawheight=&quot;452&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;970&quot; data-original=&quot;https://pic4.zhimg.com/v2-7f97b461d169b0fd1ca972e1f527e5b7_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-7f97b461d169b0fd1ca972e1f527e5b7_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;ç»è¿‡è°¨æ…çš„è€ƒé‡ï¼Œæˆ‘ä»¬é€‰æ‹©äº† TiDBã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-feae600e94813ac3a015f6b923bbeaa1_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;497&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic2.zhimg.com/v2-feae600e94813ac3a015f6b923bbeaa1_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-feae600e94813ac3a015f6b923bbeaa1_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;497&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic2.zhimg.com/v2-feae600e94813ac3a015f6b923bbeaa1_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-feae600e94813ac3a015f6b923bbeaa1_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 9 é€‰æ‹© TiDB çš„é‡è¦ç†ç”±&lt;/figcaption&gt;&lt;/figure&gt;&lt;h2&gt;ä¸‰ã€TiDB åœ¨ç½‘æ˜“äº’å¨±è®¡è´¹ç»„çš„ä½¿ç”¨&lt;/h2&gt;&lt;h3&gt;3.1 TiDB ä½¿ç”¨æ¶æ„&lt;/h3&gt;&lt;p&gt;ç½‘æ˜“äº’å¨±ä½¿ç”¨ TiDB çš„æ¶æ„è®¾è®¡å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-8f6d6f5043b3a90ea15ca410117e07c7_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;479&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic4.zhimg.com/v2-8f6d6f5043b3a90ea15ca410117e07c7_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-8f6d6f5043b3a90ea15ca410117e07c7_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;479&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic4.zhimg.com/v2-8f6d6f5043b3a90ea15ca410117e07c7_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-8f6d6f5043b3a90ea15ca410117e07c7_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 10 åŸºäº TiDB çš„æ¶æ„è®¾è®¡&lt;/figcaption&gt;&lt;/figure&gt;&lt;ul&gt;&lt;li&gt;æ•´ä¸ªé›†ç¾¤åˆ†ä¸º TiDBã€TiKV å’Œ PD 3 ä¸ªæ¨¡å—åˆ†å±‚éƒ¨ç½²ï¼›&lt;/li&gt;&lt;li&gt;ä½¿ç”¨ Nginx ä½œä¸ºå‰ç«¯è´Ÿè½½å‡è¡¡ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;h3&gt;3.2 TiDB è§£å†³äº†å“ªäº›éœ€æ±‚&lt;/h3&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-4bb5735becad11940999f16df0597ad0_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1282&quot; data-rawheight=&quot;456&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1282&quot; data-original=&quot;https://pic1.zhimg.com/v2-4bb5735becad11940999f16df0597ad0_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-4bb5735becad11940999f16df0597ad0_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1282&quot; data-rawheight=&quot;456&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1282&quot; data-original=&quot;https://pic1.zhimg.com/v2-4bb5735becad11940999f16df0597ad0_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-4bb5735becad11940999f16df0597ad0_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;h3&gt;3.3 TiDB ä½¿ç”¨ç°çŠ¶&lt;/h3&gt;&lt;ul&gt;&lt;li&gt;ä¸šåŠ¡&lt;/li&gt;&lt;ul&gt;&lt;li&gt;TiDB ä½œä¸ºçº¿ä¸Š MySQL æ•°æ®é•œåƒï¼Œè´Ÿè´£çº¿ä¸Šæ•°æ®çš„æ”¶é›†å’Œé›†ä¸­ç®¡ç†ï¼Œå½¢æˆæ•°æ®æ¹–æ³Šï¼›&lt;/li&gt;&lt;li&gt;åº”ç”¨äºæ•°æ®å¹³å°æœåŠ¡ï¼ŒåŒ…æ‹¬æŠ¥è¡¨ã€ç›‘æ§ã€è¿è¥ã€ç”¨æˆ·ç”»åƒã€å¤§æ•°æ®è®¡ç®—ç­‰åœºæ™¯ï¼›&lt;/li&gt;&lt;li&gt;HTAPï¼šOLTP + OLAPã€‚&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;é›†ç¾¤&lt;/li&gt;&lt;ul&gt;&lt;li&gt;æµ‹è¯•é›†ç¾¤ï¼šv2.1.15ï¼Œç”¨äºåŠŸèƒ½æµ‹è¯•ã€ç‰¹æ€§å°é²œï¼›&lt;/li&gt;&lt;li&gt;çº¿ä¸Šé›†ç¾¤ï¼šv2.1.15ï¼Œ80% ç¦»çº¿å¤§æ•°æ®è®¡ç®—ä»»åŠ¡ + 20% çº¿ä¸Šä¸šåŠ¡ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;è§„æ¨¡&lt;/li&gt;&lt;ul&gt;&lt;li&gt;41 å°æœåŠ¡å™¨ï¼Œ88 ä¸ªå®ä¾‹èŠ‚ç‚¹ï¼Œ38 ä¸ª Syncer å®æ—¶åŒæ­¥æµï¼ˆå°†å‡çº§ä¸º DMï¼‰ï¼›&lt;/li&gt;&lt;li&gt;å­˜å‚¨ï¼š20TB/æ€» 50TBï¼Œ230 ä¸‡ä¸ª Regionï¼›&lt;/li&gt;&lt;li&gt;QPS å‡å€¼ 4k/sï¼Œé«˜å³°æœŸä¸‡çº§ QPSï¼Œè¯»å†™æ¯”çº¦ 1:5ï¼›&lt;/li&gt;&lt;li&gt;å»¶è¿Ÿæ—¶é—´ï¼š80% åœ¨ 8ms ä»¥å†…ï¼Œ95% åœ¨ 125ms ä»¥ä¸‹ï¼Œ99.9% åœ¨ 500ms ä»¥ä¸‹ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;h2&gt;å››ã€æœ€ä½³å®è·µåˆ†äº«&lt;/h2&gt;&lt;h3&gt;4.1 é›†ç¾¤ç®¡ç†&lt;/h3&gt;&lt;ul&gt;&lt;li&gt;Ansibleï¼ˆæ¨èï¼‰&lt;/li&gt;&lt;ul&gt;&lt;li&gt;ä¸€é”®éƒ¨ç½²ï¼›&lt;/li&gt;&lt;li&gt;å¼¹æ€§ä¼¸ç¼©ï¼Œå¯åœ¨çº¿çµæ´»æ‰©ç¼©å®¹ï¼›&lt;/li&gt;&lt;li&gt;å‡çº§ï¼Œå•èŠ‚ç‚¹è½®è½¬å¹³æ»‘å‡çº§ï¼›&lt;/li&gt;&lt;li&gt;é›†ç¾¤å¯åœå’Œä¸‹çº¿ï¼›&lt;/li&gt;&lt;li&gt;Prometheus ç›‘æ§ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;Docker&lt;/li&gt;&lt;li&gt;K8s&lt;/li&gt;&lt;ul&gt;&lt;li&gt;ä½¿ç”¨ &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/pingcap/tidb-operator&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TiDB Operator&lt;/a&gt; å¯ä»¥åœ¨ç§æœ‰äº‘å’Œå…¬æœ‰äº‘ä¸Šä¸€é”®ç®¡ç†ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;h3&gt;4.2 è¿ç»´å®è·µ&lt;/h3&gt;&lt;h3&gt;4.2.1 Prometheus ç›‘æ§&lt;/h3&gt;&lt;p&gt;å®˜æ–¹é›†æˆäº† Prometheus + Grafana çš„å®æ—¶ç›‘æ§å¹³å°ï¼Œä»é›†ç¾¤çš„å„ä¸ªæ–¹é¢è¿›è¡Œäº†å®Œå–„çš„ç›‘æ§ï¼ŒåŒ…æ‹¬ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;æœåŠ¡å™¨åŸºç¡€èµ„æºçš„ç›‘æ§ï¼šå†…å­˜ã€CPUã€å­˜å‚¨ç©ºé—´ã€IO ç­‰ï¼›&lt;/li&gt;&lt;li&gt;é›†ç¾¤ç»„ä»¶çš„ç›‘æ§ï¼šTiDBã€PDã€TiKV ç­‰ï¼›&lt;/li&gt;&lt;li&gt;æ•°æ®ç›‘æ§ï¼šå®æ—¶åŒæ­¥æµã€ä¸Šä¸‹æ¸¸æ•°æ®ä¸€è‡´æ€§æ£€éªŒç­‰ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;PD ç›‘æ§ç¤ºæ„å›¾å¦‚ä¸‹ï¼Œé›†ç¾¤ç®¡ç†å‘˜å¯ä»¥å¾ˆæ–¹ä¾¿åœ°æŒæ¡é›†ç¾¤çš„æœ€æ–°çŠ¶æ€ï¼ŒåŒ…æ‹¬é›†ç¾¤çš„ç©ºé—´ Region ç­‰æ‰€æœ‰æƒ…å†µã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-8a54da195fdd0a5e3c085dda6c351793_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;525&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic4.zhimg.com/v2-8a54da195fdd0a5e3c085dda6c351793_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-8a54da195fdd0a5e3c085dda6c351793_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;525&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic4.zhimg.com/v2-8a54da195fdd0a5e3c085dda6c351793_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-8a54da195fdd0a5e3c085dda6c351793_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 11 æœ€ä½³è¿ç»´å®è·µï¼šPrometheus å®æ—¶ç›‘æ§&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;å¦‚æœé›†ç¾¤è¿è¡Œè¿‡ç¨‹å‡ºé”™ï¼Œåœ¨ç›‘æ§é¢æ¿ä¸Šå¾ˆå®¹æ˜“å°±å‘ç°ï¼Œä¸‹å›¾æ˜¯ä½¿ç”¨è¿‡ç¨‹ä¸­çš„ä¸€ä¸ªæ¡ˆä¾‹ï¼š&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-21ad70df0265e812b94011451e9cc4fe_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;191&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic3.zhimg.com/v2-21ad70df0265e812b94011451e9cc4fe_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-21ad70df0265e812b94011451e9cc4fe_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;191&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic3.zhimg.com/v2-21ad70df0265e812b94011451e9cc4fe_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-21ad70df0265e812b94011451e9cc4fe_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 12 æœ€ä½³è¿ç»´å®è·µæ¡ˆä¾‹&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;åº”ç”¨è®¿é—® TiDB å†™å…¥æ•°æ®æ—¶å‘ç°ç‰¹åˆ«æ…¢ï¼Œè¯»è¯·æ±‚æ­£å¸¸ã€‚æ’æŸ¥åï¼Œæ ¹æ® TiKV é¢æ¿å‘ç° Raft Store CPU è¿™é¡¹æŒ‡æ ‡å¼‚å¸¸ã€‚æ·±å…¥äº†è§£åŸå› æ˜¯å› ä¸ºæ•°æ®åº“å‰¯æœ¬å¤åˆ¶æ˜¯å•çº¿ç¨‹æ“ä½œï¼Œç›®å‰å·²ç»åˆ°äº†é›†ç¾¤çš„ç“¶é¢ˆã€‚è§£å†³åŠæ³•æœ‰ä»¥ä¸‹ä¸¤ç‚¹ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Region æ•°é‡è¿‡å¤šï¼ŒRaft Store è¿˜è¦å¤„ç† heartbeat messageã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;è§£å†³æ–¹æ³•ï¼šåˆ é™¤è¿‡æœŸæ•°æ®ã€‚&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Raft Store å•çº¿ç¨‹å¤„ç†é€Ÿåº¦è·Ÿä¸ä¸Šé›†ç¾¤å†™å…¥é€Ÿåº¦ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;è§£å†³æ–¹æ³•ï¼šä» 2.1.5 å‡çº§åˆ° 2.1.15ï¼Œå¼€å¯è‡ªåŠ¨ Region Merge åŠŸèƒ½ã€‚&lt;/p&gt;&lt;h3&gt;4.2.2 éƒ¨åˆ†è¿ç»´é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ&lt;/h3&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-645d348684315ec58be5a3569c76122e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1422&quot; data-rawheight=&quot;1314&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1422&quot; data-original=&quot;https://pic3.zhimg.com/v2-645d348684315ec58be5a3569c76122e_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-645d348684315ec58be5a3569c76122e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1422&quot; data-rawheight=&quot;1314&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1422&quot; data-original=&quot;https://pic3.zhimg.com/v2-645d348684315ec58be5a3569c76122e_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-645d348684315ec58be5a3569c76122e_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;h3&gt;4.3 å…¨ç½‘æ•°æ®åº“éå†&lt;/h3&gt;&lt;p&gt;ä»¥å‰éƒ¨åˆ†ä¸šåŠ¡éå†å…¨ç½‘æ•°æ®åº“è·å–æ‰€éœ€æ•°æ®ï¼Œéœ€è¦ç»´æŠ¤å¤šä¸ªæºï¼Œè€Œä¸”æ˜¯å¼‚æ„æºï¼Œéå¸¸å¤æ‚å’Œç¹çã€‚ä½¿ç”¨ TiDB å¾ˆå¥½åœ°è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œåªéœ€è¦è®¿é—®ä¸€ä¸ªæºå°±å¯ä»¥è·å–åˆ°æ‰€æœ‰æƒ³è¦çš„æ•°æ®ã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-64e0713ff4ee564dec1b643c539dbfc2_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;412&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic3.zhimg.com/v2-64e0713ff4ee564dec1b643c539dbfc2_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-64e0713ff4ee564dec1b643c539dbfc2_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;412&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic3.zhimg.com/v2-64e0713ff4ee564dec1b643c539dbfc2_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-64e0713ff4ee564dec1b643c539dbfc2_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 13 å…¨ç½‘æ•°æ®åº“éå†&lt;/figcaption&gt;&lt;/figure&gt;&lt;h3&gt;4.4 æ•°æ®è¿ç§»&lt;/h3&gt;&lt;h3&gt;4.4.1 MySQL åˆ° TiDB&lt;/h3&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-84ca591d0ad68ce644f3a2816018b44c_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;525&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic1.zhimg.com/v2-84ca591d0ad68ce644f3a2816018b44c_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-84ca591d0ad68ce644f3a2816018b44c_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;525&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic1.zhimg.com/v2-84ca591d0ad68ce644f3a2816018b44c_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-84ca591d0ad68ce644f3a2816018b44c_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 14 æ•°æ®ä» MySQL è¿ç§»åˆ° TiDB&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;MySQL æ•°æ®åº“è¿ç§»åˆ° TiDB åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼šå…¨é‡å’Œå¢é‡ã€‚&lt;/p&gt;&lt;ul&gt;&lt;li&gt;å…¨é‡&lt;/li&gt;&lt;ul&gt;&lt;li&gt;ä½¿ç”¨å·¥å…· ï¼ˆMydumper æˆ– MySQL Dump ç­‰ï¼‰ä» MySQL å¯¼å‡ºæ•°æ®ï¼Œå¹¶ä¸”è®°å½•å½“å‰æ•°æ®çš„ binlog ä½ç½®ï¼›&lt;/li&gt;&lt;li&gt;ä½¿ç”¨å·¥å…·ï¼ˆLoader æˆ– Lightning ç­‰ï¼‰å°†æ•°æ®å¯¼å…¥åˆ° TiDB é›†ç¾¤ï¼›&lt;/li&gt;&lt;li&gt;å¯ä»¥ç”¨ä½œæ•°æ®çš„å¤‡ä»½å’Œæ¢å¤æ“ä½œã€‚&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;å¢é‡&lt;/li&gt;&lt;ul&gt;&lt;li&gt;TiDB ä¼ªè£…æˆä¸ºä¸Šæ¸¸ MySQL çš„ä¸€ä¸ª Slaveï¼Œé€šè¿‡å·¥å…·ï¼ˆSyncer æˆ– DMï¼‰å®æ—¶åŒæ­¥ binlog åˆ° TiDB é›†ç¾¤ï¼›&lt;/li&gt;&lt;li&gt;é€šå¸¸æƒ…å†µä¸Šæ¸¸ä¸€æ—¦æœ‰æ•°æ®æ›´æ–°ï¼Œä¸‹æ¸¸å°±ä¼šå®æ—¶åŒæ­¥è¿‡æ¥ã€‚åŒæ­¥é€Ÿåº¦å—ç½‘ç»œå’Œæ•°æ®é‡å¤§å°çš„å½±å“ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;h3&gt;4.4.2 æ•°æ®è¿å‡º TiDB&lt;/h3&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-de4230f3e89b1b8fd0b59cb618fd1329_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;527&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic2.zhimg.com/v2-de4230f3e89b1b8fd0b59cb618fd1329_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-de4230f3e89b1b8fd0b59cb618fd1329_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;527&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic2.zhimg.com/v2-de4230f3e89b1b8fd0b59cb618fd1329_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-de4230f3e89b1b8fd0b59cb618fd1329_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 15 æ•°æ®è¿å‡º TiDB&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;å¦‚æœæ•°æ®éœ€è¦åå‘å¯¼å…¥æˆ–åŒæ­¥ï¼Œå¯ä»¥åˆ©ç”¨ &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pingcap.com/blog-cn/tidb-ecosystem-tools-1/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TiDB Binlog&lt;/a&gt; å·¥å…·å°† TiDB é›†ç¾¤çš„ binlog åŒæ­¥åˆ° MySQLã€‚TiDB Binlog æ”¯æŒä»¥ä¸‹åŠŸèƒ½åœºæ™¯ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;æ•°æ®åŒæ­¥&lt;/b&gt;ï¼šåŒæ­¥ TiDB é›†ç¾¤æ•°æ®åˆ°å…¶ä»–æ•°æ®åº“ï¼›&lt;/li&gt;&lt;li&gt;&lt;b&gt;å®æ—¶å¤‡ä»½å’Œæ¢å¤&lt;/b&gt;ï¼šå¤‡ä»½ TiDB é›†ç¾¤æ•°æ®ï¼ŒåŒæ—¶å¯ä»¥ç”¨äº TiDB é›†ç¾¤æ•…éšœæ—¶æ¢å¤ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;å¯¼å…¥çš„æ–¹å¼ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;å…¨é‡ï¼šTiDB å…¼å®¹ MySQL åè®®ï¼Œåœ¨ MySQL å®¹é‡è¶³å¤Ÿå¤§çš„æƒ…å†µä¸‹ï¼Œä¹Ÿå¯ç”¨å·¥å…·å°†æ•°æ®ä» TiDB å¯¼å‡ºåå†å¯¼å…¥ MySQLã€‚&lt;/li&gt;&lt;li&gt;å¢é‡ï¼šæ‰“å¼€ TiDB çš„ binlog å¼€å…³ï¼Œéƒ¨ç½² binlog æ”¶é›†ç»„ä»¶ï¼ˆPump+Drainerï¼‰ï¼Œå¯ä»¥å°† binlog æ•°æ®åŒæ­¥åˆ°ä¸‹æ¸¸å­˜å‚¨æ¶æ„ï¼ˆMySQLã€TiDBã€Kafkaã€S3 ç­‰ï¼‰ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;h3&gt;4.5 ä¼˜é›…åœ°ã€Œå»åˆ†åº“åˆ†è¡¨ã€&lt;/h3&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-27d611443fcb9818371be07e692cfb61_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;525&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic2.zhimg.com/v2-27d611443fcb9818371be07e692cfb61_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-27d611443fcb9818371be07e692cfb61_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;525&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic2.zhimg.com/v2-27d611443fcb9818371be07e692cfb61_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-27d611443fcb9818371be07e692cfb61_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 16 å»åˆ†åº“åˆ†è¡¨ä¸¾ä¾‹&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;ä¸¾ä¾‹ï¼šä¸€ä¸ªè¶…çº§å¤§è¡¨æŒ‰å¤©åˆ†è¡¨ï¼Œç°åœ¨æ‰“ç®—æŸ¥è¯¢æŸä¸ªè´¦å·ä¸€å¹´é—´çš„ä¿¡æ¯ã€‚&lt;/p&gt;&lt;ul&gt;&lt;li&gt;ä¸Šæ¸¸ MySQL&lt;/li&gt;&lt;/ul&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;SELECT xx FROM HFeeall join HFee20190101 join ... join ...join ... join HFee20190917 WHERE xx;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;éœ€è¦è¿æ¥ N ä¸ª join æ¡ä»¶ï¼ŒæŸ¥è¯¢éœ€è¦ç­‰å¾…è¾ƒé•¿æ—¶é—´ã€‚&lt;/p&gt;&lt;ul&gt;&lt;li&gt;ä¸‹æ¸¸ TiDB&lt;/li&gt;&lt;/ul&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;SELECT xx  FROM SuperHfeeall WHERE xx ;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åº”ç”¨æ­¤æ–¹æ¡ˆï¼Œæœ€å¤§å•è¡¨ 700+GBï¼Œ13+ äº¿è¡Œï¼Œç´¢å¼•æŸ¥è¯¢ç§’è¿”å›ã€‚&lt;/p&gt;&lt;h3&gt;4.6  ä¸šåŠ¡è¿ç§»&lt;/h3&gt;&lt;p&gt;&lt;b&gt;ç›®æ ‡&lt;/b&gt;ï¼šåˆ©ç”¨ TiDB çš„æ°´å¹³æ‰©å±•ç‰¹æ€§ï¼Œè§£å†³å®¹é‡ç“¶é¢ˆå’Œç³»ç»Ÿååé‡ç“¶é¢ˆã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;è¿ç§»åŸåˆ™&lt;/b&gt;ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;æ•°æ®å®Œæ•´å’Œå‡†ç¡®ï¼šæ•°æ®å¾ˆé‡è¦ï¼Œä¿è¯æ•°æ®ä¸é”™ã€ä¸ä¸¢ï¼›&lt;/li&gt;&lt;li&gt;è¿ç§»å¹³æ»‘å’Œè¿…é€Ÿï¼šæœåŠ¡æ•æ„Ÿåº¦é«˜ï¼Œåœæœæ—¶é—´è¦çŸ­ï¼›&lt;/li&gt;&lt;li&gt;å¯å›æ»šï¼šé‡åˆ°é—®é¢˜å¯éšæ—¶åˆ‡å›åˆ° MySQLã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;1ï¼‰æ•°æ®åŒæ­¥&lt;/b&gt;&lt;/p&gt;&lt;p&gt;ä½¿ç”¨ DM æˆ–è€… Syncer å°†ä¸Šæ¸¸ MySQL çš„æ•°æ®åŒæ­¥åˆ° TiDB é›†ç¾¤ã€‚åŒæ­¥æµæ­å»ºåæ³¨æ„éœ€è¦æ£€æŸ¥ä¸Šä¸‹æ¸¸æ•°æ®ä¸€è‡´æ€§ã€‚&lt;/p&gt;&lt;p&gt;è§‚å¯Ÿä¸€æ®µæ—¶é—´ï¼ŒåŒæ­¥æ— è¯¯åï¼Œå¯ä»¥æ ¹æ®ä¸šåŠ¡éœ€è¦è¿ç§»éƒ¨åˆ†è¯»æµé‡åˆ° TiDB é›†ç¾¤ã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-55e50472d089594c5b5be928e744d5ae_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;899&quot; data-rawheight=&quot;831&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;899&quot; data-original=&quot;https://pic3.zhimg.com/v2-55e50472d089594c5b5be928e744d5ae_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-55e50472d089594c5b5be928e744d5ae_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;899&quot; data-rawheight=&quot;831&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;899&quot; data-original=&quot;https://pic3.zhimg.com/v2-55e50472d089594c5b5be928e744d5ae_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-55e50472d089594c5b5be928e744d5ae_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 17 ä¸šåŠ¡è¿ç§»ä¹‹æ•°æ®åŒæ­¥&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;2ï¼‰è¯»å†™éªŒè¯&lt;/b&gt;&lt;/p&gt;&lt;p&gt;è¿™ä¸€é˜¶æ®µæ˜¯éªŒè¯åº”ç”¨è®¿é—® MySQL å’Œè®¿é—® TiDB å¯ä»¥å¾—åˆ°ç›¸åŒçš„ç»“æœï¼ŒéªŒè¯ä¸šåŠ¡è®¿é—®çš„å‡†ç¡®æ€§é—®é¢˜ã€‚&lt;/p&gt;&lt;p&gt;åœæ­¢æ•°æ®åŒæ­¥ï¼Œä½¿ç”¨æµé‡å¤åˆ¶å·¥å…·å°†çº¿ä¸Šæµé‡å®Œå…¨æ‹·è´å‡ºæ¥ï¼ŒåŒæ—¶è¯»å†™ MySQL å’Œ TiDBã€‚å°†ä¸¤è¾¹çš„è®¿é—®ç»“æœè¿›è¡Œå¯¹æ¯”ï¼Œæ ¸æŸ¥ TiDB æ˜¯å¦å¯é å’Œå¯ä¿¡ã€‚æ ¹æ®éœ€è¦ï¼Œè¿™ä¸ªé˜¶æ®µå¯ä»¥æµ‹è¯•è¾ƒé•¿æ—¶é—´ã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-2e337efcdd9782d068cde17c8728c3fd_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;772&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic2.zhimg.com/v2-2e337efcdd9782d068cde17c8728c3fd_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-2e337efcdd9782d068cde17c8728c3fd_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;772&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic2.zhimg.com/v2-2e337efcdd9782d068cde17c8728c3fd_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-2e337efcdd9782d068cde17c8728c3fd_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 18 ä¸šåŠ¡è¿ç§»ä¹‹è¯»å†™éªŒè¯&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;3ï¼‰ç°åº¦åˆ‡æ¢&lt;/b&gt;&lt;/p&gt;&lt;p&gt;å°†æ­¥éª¤ 2 çš„åŒå†™åœæ­¢ï¼Œå³å…³åŒå†™ï¼ŒåŒæ—¶æ‹‰èµ·ä¸Šæ¸¸çš„ DM åŒæ­¥ã€‚&lt;/p&gt;&lt;p&gt;æŠŠè®¿é—®éƒ¨åˆ†éæ ¸å¿ƒä¸šåŠ¡çš„åº“è¡¨å†™æ“ä½œè¿ç§»åˆ° TiDBï¼Œæ‰“å¼€ TiDB çš„ Binlog å¼€å…³å¯¹çº¿ä¸Š MySQL è¿›è¡Œåå‘åŒæ­¥ã€‚è¿™ä¸ªæ“ä½œï¼Œä¿è¯åªå†™ MySQL çš„æ•°æ®åŒæ­¥åˆ° TiDB ï¼Œåªå†™ TiDB çš„æ•°æ®ä¹Ÿå¯ä»¥åå‘åŒæ­¥åˆ° MySQLï¼Œä¿è¯å‡ºäº†é—®é¢˜ï¼Œéšæ—¶å¯ä»¥å›æ»šã€‚å½“ä¸šåŠ¡é•¿æ—¶é—´è®¿é—®æ­£å¸¸ï¼Œå¯ä»¥å¢åŠ åˆ‡æ¢æµé‡ï¼Œè¿›è¡Œç°åº¦åˆ‡æ¢ã€‚å»ºè®®è§‚å¯Ÿä¸€æ®µæ—¶é—´ï¼Œè‡³å°‘ä¸€ä¸ªæœˆã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-b3ab62e04da1be6385b531bb98cb039d_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;854&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic2.zhimg.com/v2-b3ab62e04da1be6385b531bb98cb039d_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-b3ab62e04da1be6385b531bb98cb039d_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;854&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic2.zhimg.com/v2-b3ab62e04da1be6385b531bb98cb039d_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-b3ab62e04da1be6385b531bb98cb039d_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 19 ä¸šåŠ¡è¿ç§»ä¹‹ç°åº¦åˆ‡æ¢&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;4ï¼‰è¿ç§»å®Œæˆ&lt;/b&gt;&lt;/p&gt;&lt;p&gt;å½“æµé‡å®Œå…¨è¿ç§»å®Œæˆï¼Œä¿æŒ TiDB ååŒæ­¥åˆ° MySQL è¿‡ç¨‹ï¼Œç»§ç»­è§‚å¯Ÿä¸€æ®µæ—¶é—´ï¼Œç¡®è®¤æ— è¯¯åï¼Œæ–­å¼€åå‘åŒæ­¥ï¼Œ100% è¿ç§»å®Œæˆã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-8194bf59c99fbcf65acd3617bbf620b7_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;877&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic4.zhimg.com/v2-8194bf59c99fbcf65acd3617bbf620b7_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-8194bf59c99fbcf65acd3617bbf620b7_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;877&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic4.zhimg.com/v2-8194bf59c99fbcf65acd3617bbf620b7_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-8194bf59c99fbcf65acd3617bbf620b7_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 20 å®Œæˆè¿ç§»&lt;/figcaption&gt;&lt;/figure&gt;&lt;h2&gt;äº”ã€æ€»ç»“ä¸å±•æœ›&lt;/h2&gt;&lt;p&gt;TiDB å…¼å®¹ MySQL åè®®ï¼Œæ”¯æŒ TP/AP äº‹åŠ¡ä¸”æ‰©å±•æ€§å¥½ï¼Œèƒ½å¾ˆå¥½åœ°è§£å†³ç½‘æ˜“äº’å¨±è®¡è´¹ç»„ä¸šåŠ¡å¤§å®¹é‡ã€é«˜å¯ç”¨ç­‰é—®é¢˜ã€‚ç›®å‰æˆ‘ä»¬çš„ä¸šåŠ¡åœ¨ä¸æ–­æ·±å…¥å’Œæ‰©å¤§è§„æ¨¡ä½¿ç”¨ TiDBï¼Œå› ä¸ºçœ‹å¥½å®ƒï¼Œæ‰€ä»¥è¿™é‡Œæå‡ºä¸€äº›ä½¿ç”¨ä¸­çš„é—®é¢˜ä»¥å¸®åŠ©åŸå‚æŒç»­æ‰“ç£¨äº§å“ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;é›†ç¾¤æ•°æ®å¤‡ä»½ï¼šå¸Œæœ›æä¾›é›†ç¾¤æ›´é«˜æ•ˆåœ°å¤‡ä»½å’Œæ¢å¤ SST æ–‡ä»¶çš„æ–¹å¼ï¼›&lt;/li&gt;&lt;li&gt;äº‹åŠ¡é™åˆ¶ï¼šå¸Œæœ›å¯ä»¥æ”¾å®½å¤§äº‹åŠ¡çš„é™åˆ¶ï¼Œç°åœ¨ä»éœ€è¦äººå·¥åˆ‡åˆ†å¤§äº‹åŠ¡ï¼Œæ¯”è¾ƒå¤æ‚ï¼›&lt;/li&gt;&lt;li&gt;åŒæ­¥ï¼šå¸Œæœ› DM æ”¯æŒä¸Šä¸‹æ¸¸è¡¨ç»“æ„ä¸ä¸€è‡´çš„åŒæ­¥ï¼›&lt;/li&gt;&lt;li&gt;æ•°æ®çƒ­ç‚¹é—®é¢˜ï¼šå»ºè®®åŠ å¼ºè‡ªåŠ¨æ£€æµ‹å’Œæ¸…é™¤çƒ­ç‚¹åŠŸèƒ½ï¼›&lt;/li&gt;&lt;li&gt;å®¢æˆ·ç«¯é‡è¯•ï¼šç›®å‰å®¢æˆ·ç«¯ä»£ç éœ€è¦å°è£…é‡è¯•é€»è¾‘ï¼Œå¯¹ç”¨æˆ·ä¸å‹å¥½ï¼Œå¸Œæœ›å¯ä»¥æ”¹è¿›ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;æœ€åï¼Œæ ¹æ®ç½‘æ˜“äº’å¨±è®¡è´¹ç»„å·²æœ‰çš„ä½¿ç”¨æƒ…å†µï¼Œæˆ‘ä»¬è®¡åˆ’ç»§ç»­åŠ å¤§ã€åŠ æ·± TiDB çš„ä½¿ç”¨åœºæ™¯ï¼Œä¸°å¯Œä¸šåŠ¡ç±»å‹å’Œä½¿ç”¨è§„æ¨¡ï¼ŒæœŸå¾… TiDB ç»™æˆ‘ä»¬çš„ä¸šåŠ¡å¸¦æ¥æ›´å¤šä¾¿åˆ©ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;é˜…è¯»åŸæ–‡ï¼š&lt;/b&gt;&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pingcap.com/cases-cn/user-case-wangyihuyu/&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic2.zhimg.com/v2-60ab5bd867c2434d70c957a02a2169e1_ipico.jpg&quot; data-image-width=&quot;1200&quot; data-image-height=&quot;1200&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;ç½‘æ˜“äº’å¨±çš„æ•°æ®åº“é€‰å‹å’Œ TiDB åº”ç”¨å®è·µ | PingCAP&lt;/a&gt;&lt;p&gt;&lt;b&gt;æ›´å¤šç²¾å½©æ¡ˆä¾‹ï¼š&lt;/b&gt;&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pingcap.com/cases-cn/&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic2.zhimg.com/v2-60ab5bd867c2434d70c957a02a2169e1_ipico.jpg&quot; data-image-width=&quot;1200&quot; data-image-height=&quot;1200&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;æ¡ˆä¾‹ | PingCAP&lt;/a&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>ZoeyZhai</author>
<guid isPermaLink="false">2019-10-22-87945199</guid>
<pubDate>Tue, 22 Oct 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>TiDB æœ€ä½³å®è·µç³»åˆ—ï¼ˆä¸‰ï¼‰ä¹è§‚é”äº‹åŠ¡</title>
<link>https://henix.github.io/feeds/zhuanlan.newsql/2019-10-20-87608202.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/87608202&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-9c88b5ce36b4a8fb1354e4e2c1c4a086_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;ä½œè€…ï¼šShirly&lt;/p&gt;&lt;blockquote&gt;TiDB æœ€ä½³å®è·µç³»åˆ—æ˜¯é¢å‘å¹¿å¤§ TiDB ç”¨æˆ·çš„ç³»åˆ—æ•™ç¨‹ï¼Œæ—¨åœ¨æ·±å…¥æµ…å‡ºä»‹ç» TiDB çš„æ¶æ„ä¸åŸç†ï¼Œå¸®åŠ©ç”¨æˆ·åœ¨ç”Ÿäº§ç¯å¢ƒä¸­æœ€å¤§é™åº¦å‘æŒ¥ TiDB çš„ä¼˜åŠ¿ã€‚æˆ‘ä»¬å°†åˆ†äº«ä¸€ç³»åˆ—å…¸å‹åœºæ™¯ä¸‹çš„æœ€ä½³å®è·µè·¯å¾„ï¼Œä¾¿äºå¤§å®¶å¿«é€Ÿä¸Šæ‰‹ï¼Œè¿…é€Ÿå®šä½å¹¶è§£å†³é—®é¢˜ã€‚&lt;/blockquote&gt;&lt;p&gt;åœ¨å‰ä¸¤ç¯‡çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬åˆ†åˆ«ä»‹ç»äº† &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pingcap.com/blog-cn/tidb-in-high-concurrency-scenarios/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TiDB é«˜å¹¶å‘å†™å…¥å¸¸è§çƒ­ç‚¹é—®é¢˜åŠè§„é¿æ–¹æ³•&lt;/a&gt; å’Œ &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pingcap.com/blog-cn/best-practice-pd/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;PD è°ƒåº¦ç­–ç•¥æœ€ä½³å®è·µ&lt;/a&gt;ï¼Œæœ¬æ–‡æˆ‘ä»¬å°†æ·±å…¥æµ…å‡ºä»‹ç» TiDB ä¹è§‚äº‹åŠ¡åŸç†ï¼Œå¹¶ç»™å‡ºå¤šç§åœºæ™¯ä¸‹çš„æœ€ä½³å®è·µï¼Œå¸Œæœ›å¤§å®¶èƒ½å¤Ÿä»ä¸­æ”¶ç›Šã€‚åŒæ—¶ï¼Œä¹Ÿæ¬¢è¿å¤§å®¶ç»™æˆ‘ä»¬æä¾›ç›¸å…³çš„ä¼˜åŒ–å»ºè®®ï¼Œå‚ä¸åˆ°æˆ‘ä»¬çš„ä¼˜åŒ–å·¥ä½œä¸­æ¥ã€‚&lt;/p&gt;&lt;p&gt;å»ºè®®å¤§å®¶åœ¨é˜…è¯»ä¹‹å‰å…ˆäº†è§£ &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pingcap.com/docs-cn/v3.0/architecture/%23tidb-%25E6%2595%25B4%25E4%25BD%2593%25E6%259E%25B6%25E6%259E%2584&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TiDB çš„æ•´ä½“æ¶æ„&lt;/a&gt; å’Œ &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//www.usenix.org/legacy/event/osdi10/tech/full_papers/Peng.pdf&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Percollator&lt;/a&gt; äº‹åŠ¡æ¨¡å‹ã€‚å¦å¤–ï¼Œæœ¬æ–‡é‡ç‚¹å…³æ³¨åŸç†åŠæœ€ä½³å®è·µè·¯å¾„ï¼Œå…·ä½“çš„ TiDB äº‹åŠ¡è¯­å¥å¤§å®¶å¯ä»¥åœ¨ &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pingcap.com/docs-cn/v3.0/reference/transactions/overview/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;å®˜æ–¹æ–‡æ¡£&lt;/a&gt; ä¸­æŸ¥é˜…ã€‚&lt;/p&gt;&lt;h2&gt;TiDB äº‹åŠ¡å®šä¹‰&lt;/h2&gt;&lt;p&gt;TiDB ä½¿ç”¨ Percolator äº‹åŠ¡æ¨¡å‹ï¼Œå®ç°äº†åˆ†å¸ƒå¼äº‹åŠ¡ï¼ˆå»ºè®®æœªè¯»è¿‡è¯¥è®ºæ–‡çš„åŒå­¦å…ˆæµè§ˆä¸€ä¸‹ &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//www.usenix.org/legacy/event/osdi10/tech/full_papers/Peng.pdf&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;è®ºæ–‡&lt;/a&gt; ä¸­äº‹åŠ¡éƒ¨åˆ†å†…å®¹ï¼‰ã€‚&lt;/p&gt;&lt;p&gt;è¯´åˆ°äº‹åŠ¡ï¼Œä¸å¾—ä¸å…ˆæŠ›å‡ºäº‹åŠ¡çš„åŸºæœ¬æ¦‚å¿µã€‚é€šå¸¸æˆ‘ä»¬ç”¨ ACID æ¥å®šä¹‰äº‹åŠ¡ï¼ˆ&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//en.wikipedia.org/wiki/ACID&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;ACID æ¦‚å¿µå®šä¹‰&lt;/a&gt;ï¼‰ã€‚ä¸‹é¢æˆ‘ä»¬ç®€å•è¯´ä¸€ä¸‹ TiDB æ˜¯æ€ä¹ˆå®ç° ACID çš„ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Aï¼ˆåŸå­æ€§ï¼‰ï¼šåŸºäºå•å®ä¾‹çš„åŸå­æ€§æ¥å®ç°åˆ†å¸ƒå¼äº‹åŠ¡çš„åŸå­æ€§ï¼Œå’Œ Percolator è®ºæ–‡ä¸€æ ·ï¼ŒTiDB é€šè¿‡ä½¿ç”¨ Primary Key æ‰€åœ¨ region çš„åŸå­æ€§æ¥ä¿è¯ã€‚&lt;/li&gt;&lt;li&gt;Cï¼ˆä¸€è‡´æ€§ï¼‰ï¼šæœ¬èº« TiDB åœ¨å†™å…¥æ•°æ®ä¹‹å‰ï¼Œä¼šå¯¹æ•°æ®çš„ä¸€è‡´æ€§è¿›è¡Œæ ¡éªŒï¼Œæ ¡éªŒé€šè¿‡æ‰ä¼šå†™å…¥å†…å­˜å¹¶è¿”å›æˆåŠŸã€‚&lt;/li&gt;&lt;li&gt;Iï¼ˆéš”ç¦»æ€§ï¼‰ï¼šéš”ç¦»æ€§ä¸»è¦ç”¨äºå¤„ç†å¹¶å‘åœºæ™¯ï¼ŒTiDB ç›®å‰åªæ”¯æŒä¸€ç§éš”ç¦»çº§åˆ« Repeatable Readï¼Œå³åœ¨äº‹åŠ¡å†…å¯é‡å¤è¯»ã€‚&lt;/li&gt;&lt;li&gt;Dï¼ˆæŒä¹…æ€§ï¼‰ï¼šäº‹åŠ¡ä¸€æ—¦æäº¤æˆåŠŸï¼Œæ•°æ®å…¨éƒ¨æŒä¹…åŒ–åˆ° TiKVï¼Œ æ­¤æ—¶å³ä½¿ TiDB æœåŠ¡å™¨å®•æœºä¹Ÿä¸ä¼šå‡ºç°æ•°æ®ä¸¢å¤±ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;æˆªæ­¢æœ¬æ–‡å‘ç¨¿æ—¶ï¼ŒTiDB ä¸€å…±æä¾›äº†ä¸¤ç§äº‹åŠ¡æ¨¡å¼ï¼šä¹è§‚äº‹åŠ¡å’Œæ‚²è§‚äº‹åŠ¡ã€‚é‚£ä¹ˆä¹è§‚äº‹åŠ¡å’Œæ‚²è§‚äº‹åŠ¡æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿæœ€æœ¬è´¨çš„åŒºåˆ«å°±æ˜¯ä»€ä¹ˆæ—¶å€™æ£€æµ‹å†²çªï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;æ‚²è§‚äº‹åŠ¡ï¼šé¡¾åæ€ä¹‰ï¼Œæ¯”è¾ƒæ‚²è§‚ï¼Œå¯¹äºæ¯ä¸€æ¡ SQL éƒ½ä¼šæ£€æµ‹å†²çªã€‚&lt;/li&gt;&lt;li&gt;ä¹è§‚äº‹åŠ¡ï¼šåªæœ‰åœ¨äº‹åŠ¡æœ€ç»ˆæäº¤ commit æ—¶æ‰ä¼šæ£€æµ‹å†²çªã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;ä¸‹é¢æˆ‘ä»¬å°†ç€é‡ä»‹ç»ä¹è§‚äº‹åŠ¡åœ¨ TiDB ä¸­çš„å®ç°ã€‚å¦å¤–ï¼Œæƒ³è¦äº†è§£ TiDB æ‚²è§‚äº‹åŠ¡æ›´å¤šç»†èŠ‚çš„åŒå­¦ï¼Œå¯ä»¥å…ˆé˜…è¯»æœ¬æ–‡ï¼Œæ€è€ƒä¸€ä¸‹åœ¨ TiDB ä¸­å¦‚ä½•å®ç°æ‚²è§‚äº‹åŠ¡ï¼Œæˆ‘ä»¬åç»­ä¹Ÿä¼šæä¾›ã€Šæ‚²è§‚é”äº‹åŠ¡æœ€ä½³å®è·µã€‹ç»™å¤§å®¶å‚è€ƒã€‚&lt;/p&gt;&lt;h2&gt;ä¹è§‚äº‹åŠ¡åŸç†&lt;/h2&gt;&lt;p&gt;æœ‰äº† Percolator åŸºç¡€åï¼Œä¸‹é¢æˆ‘ä»¬æ¥ä»‹ç» TiDB ä¹è§‚é”äº‹åŠ¡å¤„ç†æµç¨‹ã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-a0be1fb55caf7afe189c1d0f8e2b1c35_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1199&quot; data-rawheight=&quot;1228&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1199&quot; data-original=&quot;https://pic2.zhimg.com/v2-a0be1fb55caf7afe189c1d0f8e2b1c35_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-a0be1fb55caf7afe189c1d0f8e2b1c35_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1199&quot; data-rawheight=&quot;1228&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1199&quot; data-original=&quot;https://pic2.zhimg.com/v2-a0be1fb55caf7afe189c1d0f8e2b1c35_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-a0be1fb55caf7afe189c1d0f8e2b1c35_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;TiDB åœ¨å¤„ç†ä¸€ä¸ªäº‹åŠ¡æ—¶ï¼Œå¤„ç†æµç¨‹å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;å®¢æˆ·ç«¯ begin äº†ä¸€ä¸ªäº‹åŠ¡ã€‚&lt;br/&gt;a. TiDB ä» PD è·å–ä¸€ä¸ªå…¨å±€å”¯ä¸€é€’å¢çš„ç‰ˆæœ¬å·ä½œä¸ºå½“å‰äº‹åŠ¡çš„å¼€å§‹ç‰ˆæœ¬å·ï¼Œè¿™é‡Œæˆ‘ä»¬å®šä¹‰ä¸ºè¯¥äº‹åŠ¡çš„ &lt;code&gt;start_ts&lt;/code&gt;ã€‚&lt;/li&gt;&lt;li&gt;å®¢æˆ·ç«¯å‘èµ·è¯»è¯·æ±‚ã€‚&lt;br/&gt;a. TiDB ä» PD  è·å–æ•°æ®è·¯ç”±ä¿¡æ¯ï¼Œæ•°æ®å…·ä½“å­˜åœ¨å“ªä¸ª TiKV ä¸Šã€‚&lt;br/&gt;b. TiDB å‘ TiKV è·å– &lt;code&gt;start_ts&lt;/code&gt; ç‰ˆæœ¬ä¸‹å¯¹åº”çš„æ•°æ®ä¿¡æ¯ã€‚&lt;/li&gt;&lt;li&gt;å®¢æˆ·ç«¯å‘èµ·å†™è¯·æ±‚ã€‚&lt;br/&gt;a. TiDB å¯¹å†™å…¥æ•°æ®è¿›è¡Œæ ¡éªŒï¼Œå¦‚æ•°æ®ç±»å‹æ˜¯å¦æ­£ç¡®ã€æ˜¯å¦ç¬¦åˆå”¯ä¸€ç´¢å¼•çº¦æŸç­‰ï¼Œç¡®ä¿æ–°å†™å…¥æ•°æ®äº‹åŠ¡ç¬¦åˆä¸€è‡´æ€§çº¦æŸï¼Œ&lt;b&gt;å°†æ£€æŸ¥é€šè¿‡çš„æ•°æ®å­˜æ”¾åœ¨å†…å­˜é‡Œ&lt;/b&gt;ã€‚&lt;/li&gt;&lt;li&gt;å®¢æˆ·ç«¯å‘èµ· commitã€‚&lt;/li&gt;&lt;li&gt;TiDB å¼€å§‹ä¸¤é˜¶æ®µæäº¤å°†äº‹åŠ¡åŸå­åœ°æäº¤ï¼Œæ•°æ®çœŸæ­£è½ç›˜ã€‚&lt;br/&gt;a. TiDB ä»å½“å‰è¦å†™å…¥çš„æ•°æ®ä¸­é€‰æ‹©ä¸€ä¸ª Key ä½œä¸ºå½“å‰äº‹åŠ¡çš„ Primary Keyã€‚&lt;br/&gt;b. TiDB ä» PD è·å–æ‰€æœ‰æ•°æ®çš„å†™å…¥è·¯ç”±ä¿¡æ¯ï¼Œå¹¶å°†æ‰€æœ‰çš„ Key æŒ‰ç…§æ‰€æœ‰çš„è·¯ç”±è¿›è¡Œåˆ†ç±»ã€‚&lt;br/&gt;c. TiDB å¹¶å‘å‘æ‰€æœ‰æ¶‰åŠçš„ TiKV å‘èµ· prewrite è¯·æ±‚ï¼ŒTiKV æ”¶åˆ° prewrite æ•°æ®åï¼Œæ£€æŸ¥æ•°æ®ç‰ˆæœ¬ä¿¡æ¯æ˜¯å¦å­˜åœ¨å†²çªã€è¿‡æœŸï¼Œç¬¦åˆæ¡ä»¶ç»™æ•°æ®åŠ é”ã€‚&lt;br/&gt;d. TiDB æ”¶åˆ°æ‰€æœ‰çš„ prewrite æˆåŠŸã€‚&lt;br/&gt;e. TiDB å‘ PD è·å–ç¬¬äºŒä¸ªå…¨å±€å”¯ä¸€é€’å¢ç‰ˆæœ¬ï¼Œä½œä¸ºæœ¬æ¬¡äº‹åŠ¡çš„ &lt;code&gt;commit_ts&lt;/code&gt;ã€‚&lt;br/&gt;f. TiDB å‘ Primary Key æ‰€åœ¨ TiKV å‘èµ·ç¬¬äºŒé˜¶æ®µæäº¤ commit æ“ä½œï¼ŒTiKV æ”¶åˆ° commit æ“ä½œåï¼Œæ£€æŸ¥æ•°æ®åˆæ³•æ€§ï¼Œæ¸…ç† prewrite é˜¶æ®µç•™ä¸‹çš„é”ã€‚&lt;br/&gt;g. TiDB æ”¶åˆ° f æˆåŠŸä¿¡æ¯ã€‚&lt;/li&gt;&lt;li&gt;TiDB å‘å®¢æˆ·ç«¯è¿”å›äº‹åŠ¡æäº¤æˆåŠŸã€‚&lt;/li&gt;&lt;li&gt;TiDB å¼‚æ­¥æ¸…ç†æœ¬æ¬¡äº‹åŠ¡é—ç•™çš„é”ä¿¡æ¯ã€‚&lt;/li&gt;&lt;/ol&gt;&lt;h3&gt;ä¼˜ç¼ºç‚¹åˆ†æ&lt;/h3&gt;&lt;p&gt;ä»ä¸Šé¢è¿™ä¸ªè¿‡ç¨‹å¯ä»¥çœ‹åˆ°ï¼Œ TiDB äº‹åŠ¡å­˜åœ¨ä»¥ä¸‹ä¼˜ç‚¹ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;ç®€å•ï¼Œå¥½ç†è§£ã€‚&lt;/li&gt;&lt;li&gt;åŸºäºå•å®ä¾‹äº‹åŠ¡å®ç°äº†è·¨èŠ‚ç‚¹äº‹åŠ¡ã€‚&lt;/li&gt;&lt;li&gt;å»ä¸­å¿ƒåŒ–çš„é”ç®¡ç†ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;ç¼ºç‚¹å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;ä¸¤é˜¶æ®µæäº¤ï¼Œç½‘ç»œäº¤äº’å¤šã€‚&lt;/li&gt;&lt;li&gt;éœ€è¦ä¸€ä¸ªä¸­å¿ƒåŒ–çš„ç‰ˆæœ¬ç®¡ç†æœåŠ¡ã€‚&lt;/li&gt;&lt;li&gt;äº‹åŠ¡åœ¨ commit ä¹‹å‰ï¼Œæ•°æ®å†™åœ¨å†…å­˜é‡Œï¼Œæ•°æ®è¿‡å¤§å†…å­˜å°±ä¼šæš´æ¶¨ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;åŸºäºä»¥ä¸Šç¼ºç‚¹çš„åˆ†æï¼Œæˆ‘ä»¬æœ‰äº†ä¸€äº›å®è·µå»ºè®®ï¼Œå°†åœ¨ä¸‹æ–‡è¯¦ç»†ä»‹ç»ã€‚&lt;/p&gt;&lt;h2&gt;äº‹åŠ¡å¤§å°&lt;/h2&gt;&lt;h3&gt;1. å°äº‹åŠ¡&lt;/h3&gt;&lt;p&gt;ä¸ºäº†é™ä½ç½‘ç»œäº¤äº’å¯¹äºå°äº‹åŠ¡çš„å½±å“ï¼Œæˆ‘ä»¬å»ºè®®å°äº‹åŠ¡æ‰“åŒ…æ¥åšã€‚å¦‚åœ¨ auto commit æ¨¡å¼ä¸‹ï¼Œä¸‹é¢æ¯æ¡è¯­å¥æˆä¸ºäº†ä¸€ä¸ªäº‹åŠ¡ï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;# original version with auto_commit
UPDATE my_table SET a=&amp;#39;new_value&amp;#39; WHERE id = 1; 
UPDATE my_table SET a=&amp;#39;newer_value&amp;#39; WHERE id = 2;
UPDATE my_table SET a=&amp;#39;newest_value&amp;#39; WHERE id = 3;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä»¥ä¸Šæ¯ä¸€æ¡è¯­å¥ï¼Œéƒ½éœ€è¦ç»è¿‡ä¸¤é˜¶æ®µæäº¤ï¼Œç½‘ç»œäº¤äº’å°±ç›´æ¥ *3ï¼Œ å¦‚æœæˆ‘ä»¬èƒ½å¤Ÿæ‰“åŒ…æˆä¸€ä¸ªäº‹åŠ¡æäº¤ï¼Œæ€§èƒ½ä¸Šä¼šæœ‰ä¸€ä¸ªæ˜¾è‘—çš„æå‡ï¼Œå¦‚ä¸‹ï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;# improved version
START TRANSACTION;
UPDATE my_table SET a=&amp;#39;new_value&amp;#39; WHERE id = 1; 
UPDATE my_table SET a=&amp;#39;newer_value&amp;#39; WHERE id = 2;
UPDATE my_table SET a=&amp;#39;newest_value&amp;#39; WHERE id = 3;
COMMIT;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åŒç†ï¼Œå¯¹äº insert è¯­å¥ä¹Ÿå»ºè®®æ‰“åŒ…æˆäº‹åŠ¡æ¥å¤„ç†ã€‚&lt;/p&gt;&lt;h3&gt;2. å¤§äº‹åŠ¡&lt;/h3&gt;&lt;p&gt;æ—¢ç„¶å°äº‹åŠ¡æœ‰é—®é¢˜ï¼Œæˆ‘ä»¬çš„äº‹åŠ¡æ˜¯ä¸æ˜¯è¶Šå¤§è¶Šå¥½å‘¢ï¼Ÿ&lt;/p&gt;&lt;p&gt;æˆ‘ä»¬å›è¿‡å¤´æ¥åˆ†æä¸¤é˜¶æ®µæäº¤çš„è¿‡ç¨‹ï¼Œèªæ˜å¦‚ä½ ï¼Œå¾ˆå®¹æ˜“å°±å¯ä»¥å‘ç°ï¼Œå½“äº‹åŠ¡è¿‡å¤§æ—¶ï¼Œä¼šæœ‰ä»¥ä¸‹é—®é¢˜ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;å®¢æˆ·ç«¯ commit ä¹‹å‰å†™å…¥æ•°æ®éƒ½åœ¨å†…å­˜é‡Œé¢ï¼ŒTiDB å†…å­˜æš´æ¶¨ï¼Œä¸€ä¸å°å¿ƒå°±ä¼š OOMã€‚&lt;/li&gt;&lt;li&gt;ç¬¬ä¸€é˜¶æ®µå†™å…¥ä¸å…¶ä»–äº‹åŠ¡å‡ºç°å†²çªçš„æ¦‚ç‡å°±ä¼šæŒ‡æ•°çº§ä¸Šå‡ï¼Œäº‹åŠ¡ä¹‹é—´ç›¸äº’é˜»å¡å½±å“ã€‚&lt;/li&gt;&lt;li&gt;äº‹åŠ¡çš„æäº¤å®Œæˆä¼šå˜å¾—å¾ˆé•¿å¾ˆé•¿ ï½ï½ï½&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯¹äº‹åŠ¡çš„å¤§å°åšäº†ä¸€äº›é™åˆ¶ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;å•ä¸ªäº‹åŠ¡åŒ…å«çš„ SQL è¯­å¥ä¸è¶…è¿‡ 5000 æ¡ï¼ˆé»˜è®¤ï¼‰&lt;/li&gt;&lt;li&gt;æ¯ä¸ªé”®å€¼å¯¹ä¸è¶…è¿‡ 6MB&lt;/li&gt;&lt;li&gt;é”®å€¼å¯¹çš„æ€»æ•°ä¸è¶…è¿‡ 300,000&lt;/li&gt;&lt;li&gt;é”®å€¼å¯¹çš„æ€»å¤§å°ä¸è¶…è¿‡ 100MB&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;å› æ­¤ï¼Œå¯¹äº TiDB ä¹è§‚äº‹åŠ¡è€Œè¨€ï¼Œäº‹åŠ¡å¤ªå¤§æˆ–è€…å¤ªå°ï¼Œéƒ½ä¼šå‡ºç°æ€§èƒ½ä¸Šçš„é—®é¢˜ã€‚æˆ‘ä»¬å»ºè®®æ¯ 100ï½500 è¡Œå†™å…¥ä¸€ä¸ªäº‹åŠ¡ï¼Œå¯ä»¥è¾¾åˆ°ä¸€ä¸ªæ¯”è¾ƒä¼˜çš„æ€§èƒ½ã€‚&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;äº‹åŠ¡å†²çª&lt;/h2&gt;&lt;p&gt;äº‹åŠ¡çš„å†²çªï¼Œä¸»è¦æŒ‡äº‹åŠ¡å¹¶å‘æ‰§è¡Œæ—¶ï¼Œå¯¹ç›¸åŒçš„ Key æœ‰è¯»å†™æ“ä½œï¼Œä¸»è¦åˆ†ä¸¤ç§ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;è¯»å†™å†²çªï¼šå­˜åœ¨å¹¶å‘çš„äº‹åŠ¡ï¼Œéƒ¨åˆ†äº‹åŠ¡å¯¹ç›¸åŒçš„ Key è¯»ï¼Œéƒ¨åˆ†äº‹åŠ¡å¯¹ç›¸åŒçš„ Key è¿›è¡Œå†™ã€‚&lt;/li&gt;&lt;li&gt;å†™å†™å†²çªï¼šå­˜åœ¨å¹¶å‘çš„äº‹åŠ¡ï¼ŒåŒæ—¶å¯¹ç›¸åŒçš„ Key è¿›è¡Œå†™å…¥ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;åœ¨ TiDB çš„ä¹è§‚é”æœºåˆ¶ä¸­ï¼Œå› ä¸ºæ˜¯åœ¨å®¢æˆ·ç«¯å¯¹äº‹åŠ¡ commit æ—¶ï¼Œæ‰ä¼šè§¦å‘ä¸¤é˜¶æ®µæäº¤ï¼Œæ£€æµ‹æ˜¯å¦å­˜åœ¨å†™å†™å†²çªã€‚æ‰€ä»¥ï¼Œåœ¨ä¹è§‚é”ä¸­ï¼Œå­˜åœ¨å†™å†™å†²çªæ—¶ï¼Œå¾ˆå®¹æ˜“åœ¨äº‹åŠ¡æäº¤æ—¶æš´éœ²ï¼Œå› è€Œæ›´å®¹æ˜“è¢«ç”¨æˆ·æ„ŸçŸ¥ã€‚&lt;/p&gt;&lt;h3&gt;é»˜è®¤å†²çªè¡Œä¸º&lt;/h3&gt;&lt;p&gt;å› ä¸ºæˆ‘ä»¬æœ¬æ–‡ç€é‡å°†ä¹è§‚é”çš„æœ€ä½³å®è·µï¼Œé‚£ä¹ˆæˆ‘ä»¬è¿™è¾¹æ¥åˆ†æä¸€ä¸‹ä¹è§‚äº‹åŠ¡ä¸‹ï¼ŒTiDB çš„è¡Œä¸ºã€‚&lt;/p&gt;&lt;p&gt;é»˜è®¤é…ç½®ä¸‹ï¼Œä»¥ä¸‹å¹¶å‘äº‹åŠ¡å­˜åœ¨å†²çªæ—¶ï¼Œç»“æœå¦‚ä¸‹ï¼š&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-179f06f5ef72ab87440529ffe9aeb52e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1400&quot; data-rawheight=&quot;1208&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1400&quot; data-original=&quot;https://pic3.zhimg.com/v2-179f06f5ef72ab87440529ffe9aeb52e_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-179f06f5ef72ab87440529ffe9aeb52e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1400&quot; data-rawheight=&quot;1208&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1400&quot; data-original=&quot;https://pic3.zhimg.com/v2-179f06f5ef72ab87440529ffe9aeb52e_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-179f06f5ef72ab87440529ffe9aeb52e_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;åœ¨è¿™ä¸ª case ä¸­ï¼Œç°è±¡åˆ†æå¦‚ä¸‹ï¼š&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-401a4717b25b742d7df7143752c9745b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;960&quot; data-rawheight=&quot;239&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;960&quot; data-original=&quot;https://pic4.zhimg.com/v2-401a4717b25b742d7df7143752c9745b_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-401a4717b25b742d7df7143752c9745b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;960&quot; data-rawheight=&quot;239&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;960&quot; data-original=&quot;https://pic4.zhimg.com/v2-401a4717b25b742d7df7143752c9745b_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-401a4717b25b742d7df7143752c9745b_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;ul&gt;&lt;li&gt;å¦‚ä¸Šå›¾ï¼Œäº‹åŠ¡ A  åœ¨æ—¶é—´ç‚¹ &lt;code&gt;t1&lt;/code&gt; å¼€å§‹äº‹åŠ¡ï¼Œäº‹åŠ¡ B åœ¨äº‹åŠ¡ &lt;code&gt;t1&lt;/code&gt; ä¹‹åçš„ &lt;code&gt;t2&lt;/code&gt; å¼€å§‹ã€‚&lt;/li&gt;&lt;li&gt;äº‹åŠ¡ Aã€äº‹åŠ¡ B ä¼šåŒæ—¶å»æ›´æ–°åŒä¸€è¡Œæ•°æ®ã€‚&lt;/li&gt;&lt;li&gt;æ—¶é—´ç‚¹ &lt;code&gt;t4&lt;/code&gt; æ—¶ï¼Œäº‹åŠ¡ A æƒ³è¦æ›´æ–° &lt;code&gt;id = 1&lt;/code&gt; çš„è¿™ä¸€è¡Œæ•°æ®ï¼Œè™½ç„¶æ­¤æ—¶è¿™è¡Œæ•°æ®åœ¨ &lt;code&gt;t3&lt;/code&gt; è¿™ä¸ªæ—¶é—´ç‚¹è¢«äº‹åŠ¡ B å·²ç»æ›´æ–°äº†ï¼Œä½†æ˜¯å› ä¸º TiDB ä¹è§‚äº‹åŠ¡åªæœ‰åœ¨äº‹åŠ¡ commit æ—¶æ‰æ£€æµ‹å†²çªï¼Œæ‰€ä»¥æ—¶é—´ç‚¹ &lt;code&gt;t4&lt;/code&gt; çš„æ‰§è¡ŒæˆåŠŸäº†ã€‚&lt;/li&gt;&lt;li&gt;æ—¶é—´ç‚¹ &lt;code&gt;t5&lt;/code&gt;ï¼Œäº‹åŠ¡ B æˆåŠŸæäº¤ï¼Œæ•°æ®è½ç›˜ã€‚&lt;/li&gt;&lt;li&gt;æ—¶é—´ç‚¹ &lt;code&gt;t6&lt;/code&gt;ï¼Œäº‹åŠ¡ A å°è¯•æäº¤ï¼Œæ£€æµ‹å†²çªæ—¶å‘ç° &lt;code&gt;t1&lt;/code&gt; ä¹‹åæœ‰æ–°çš„æ•°æ®å†™å…¥ï¼Œè¿”å›å†²çªï¼Œäº‹åŠ¡ A æäº¤å¤±è´¥ï¼Œæç¤ºå®¢æˆ·ç«¯è¿›è¡Œé‡è¯•ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;æ ¹æ®ä¹è§‚é”çš„å®šä¹‰ï¼Œè¿™æ ·åšå®Œå…¨ç¬¦åˆé€»è¾‘ã€‚&lt;/p&gt;&lt;h3&gt;é‡è¯•æœºåˆ¶&lt;/h3&gt;&lt;p&gt;æˆ‘ä»¬çŸ¥é“äº†ä¹è§‚é”ä¸‹äº‹åŠ¡çš„é»˜è®¤è¡Œä¸ºï¼Œå¯ä»¥çŸ¥é“åœ¨å†²çªæ¯”è¾ƒå¤§çš„æ—¶å€™ï¼ŒCommit å¾ˆå®¹æ˜“å‡ºç°å¤±è´¥ã€‚ç„¶è€Œï¼ŒTiDB çš„å¤§éƒ¨åˆ†ç”¨æˆ·ï¼Œéƒ½æ˜¯æ¥è‡ªäº MySQLï¼›è€Œ MySQL å†…éƒ¨ä½¿ç”¨çš„æ˜¯æ‚²è§‚é”ã€‚å¯¹åº”åˆ°è¿™ä¸ª caseï¼Œå°±æ˜¯äº‹åŠ¡ A åœ¨ &lt;code&gt;t4&lt;/code&gt; æ›´æ–°æ—¶å°±ä¼šæŠ¥å¤±è´¥ï¼Œå®¢æˆ·ç«¯å°±ä¼šæ ¹æ®éœ€æ±‚å»é‡è¯•ã€‚&lt;/p&gt;&lt;p&gt;æ¢è¨€ä¹‹ï¼ŒMySQL çš„å†²çªæ£€æµ‹åœ¨ SQL æ‰§è¡Œè¿‡ç¨‹ä¸­æ‰§è¡Œï¼Œæ‰€ä»¥ commit æ—¶å¾ˆéš¾å‡ºç°å¼‚å¸¸ã€‚è€Œ TiDB ä½¿ç”¨ä¹è§‚é”æœºåˆ¶é€ æˆçš„ä¸¤è¾¹è¡Œä¸ºä¸ä¸€è‡´ï¼Œåˆ™éœ€è¦å®¢æˆ·ç«¯ä¿®æ”¹å¤§é‡çš„ä»£ç ã€‚ ä¸ºäº†è§£å†³å¹¿å¤§ MySQL ç”¨æˆ·çš„è¿™ä¸ªé—®é¢˜ï¼ŒTiDB æä¾›äº†å†…éƒ¨é»˜è®¤é‡è¯•æœºåˆ¶ï¼Œè¿™é‡Œï¼Œä¹Ÿå°±æ˜¯å½“äº‹åŠ¡ A commit å‘ç°å†²çªæ—¶ï¼ŒTiDB å†…éƒ¨é‡æ–°å›æ”¾å¸¦å†™å…¥çš„ SQLã€‚ä¸ºæ­¤ TiDB æä¾›äº†ä»¥ä¸‹å‚æ•°,&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;code&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pingcap.com/docs-cn/v3.0/reference/configuration/tidb-server/tidb-specific-variables/%23tidb_disable_txn_auto_retry&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;tidb_disable_txn_auto_retry&lt;/a&gt;&lt;/code&gt;ï¼šè¿™ä¸ªå‚æ•°æ§åˆ¶æ˜¯å¦è‡ªåŠ¨é‡è¯•ï¼Œé»˜è®¤ä¸º &lt;code&gt;1&lt;/code&gt;ï¼Œå³ä¸é‡è¯•ã€‚&lt;/li&gt;&lt;li&gt;&lt;code&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pingcap.com/docs-cn/v3.0/reference/configuration/tidb-server/tidb-specific-variables/%23tidb_retry_limit&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;tidb_retry_limit&lt;/a&gt;&lt;/code&gt;ï¼šç”¨æ¥æ§åˆ¶é‡è¯•æ¬¡æ•°ï¼Œæ³¨æ„åªæœ‰ç¬¬ä¸€ä¸ªå‚æ•°å¯ç”¨æ—¶è¯¥å‚æ•°æ‰ä¼šç”Ÿæ•ˆã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;å¦‚ä½•è®¾ç½®ä»¥ä¸Šå‚æ•°å‘¢ï¼Ÿæ¨èä¸¤ç§æ–¹å¼è®¾ç½®ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;session çº§åˆ«è®¾ç½®ï¼š&lt;br/&gt;set @@tidb_disable_txn_auto_retry = 0; set @@tidb_retry_limit = 10;&lt;/li&gt;&lt;li&gt;å…¨å±€è®¾ç½®ï¼š&lt;br/&gt;set @@global.tidb_disable_txn_auto_retry = 0; set @@global.tidb_retry_limit = 10;&lt;/li&gt;&lt;/ol&gt;&lt;h3&gt;ä¸‡èƒ½é‡è¯•&lt;/h3&gt;&lt;p&gt;é‚£ä¹ˆé‡è¯•æ˜¯ä¸æ˜¯ä¸‡èƒ½çš„å‘¢ï¼Ÿè¿™è¦ä»é‡è¯•çš„åŸç†å‡ºå‘ï¼Œé‡è¯•çš„æ­¥éª¤ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;é‡æ–°è·å– &lt;code&gt;start_ts&lt;/code&gt;ã€‚&lt;/li&gt;&lt;li&gt;å¯¹å¸¦å†™å…¥çš„ SQL è¿›è¡Œé‡æ”¾ã€‚&lt;/li&gt;&lt;li&gt;ä¸¤é˜¶æ®µæäº¤ã€‚&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;ç»†å¿ƒå¦‚ä½ å¯èƒ½ä¼šå‘ç°ï¼Œæˆ‘ä»¬è¿™è¾¹åªå¯¹å†™å…¥çš„ SQL è¿›è¡Œå›æ”¾ï¼Œå¹¶æ²¡æœ‰æåŠè¯»å– SQLã€‚è¿™ä¸ªè¡Œä¸ºçœ‹ä¼¼å¾ˆåˆç†ï¼Œä½†æ˜¯è¿™ä¸ªä¼šå¼•å‘å…¶ä»–é—®é¢˜ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;code&gt;start_ts&lt;/code&gt; å‘ç”Ÿäº†å˜æ›´ï¼Œå½“å‰è¿™ä¸ªäº‹åŠ¡ä¸­ï¼Œè¯»åˆ°çš„æ•°æ®ä¸äº‹åŠ¡çœŸæ­£å¼€å§‹çš„é‚£ä¸ªæ—¶é—´å‘ç”Ÿäº†å˜åŒ–ï¼Œå†™å…¥çš„ç‰ˆæœ¬ä¹Ÿæ˜¯åŒç†å˜æˆäº†é‡è¯•æ—¶è·å–çš„ &lt;code&gt;start_ts&lt;/code&gt; è€Œä¸æ˜¯äº‹åŠ¡ä¸€å¼€å§‹æ—¶çš„é‚£ä¸ªã€‚&lt;/li&gt;&lt;li&gt;å¦‚æœå½“å‰äº‹åŠ¡ä¸­å­˜åœ¨æ›´æ–°ä¾èµ–äºè¯»åˆ°çš„æ•°æ®ï¼Œç»“æœå˜å¾—ä¸å¯æ§ã€‚&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;æ‰“å¼€äº†é‡è¯•åï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-fdca1934303729678d5445a7ac5076fb_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1490&quot; data-rawheight=&quot;1597&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1490&quot; data-original=&quot;https://pic4.zhimg.com/v2-fdca1934303729678d5445a7ac5076fb_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-fdca1934303729678d5445a7ac5076fb_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1490&quot; data-rawheight=&quot;1597&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1490&quot; data-original=&quot;https://pic4.zhimg.com/v2-fdca1934303729678d5445a7ac5076fb_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-fdca1934303729678d5445a7ac5076fb_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;æˆ‘ä»¬æ¥è¯¦ç»†åˆ†æä»¥ä¸‹è¿™ä¸ª caseï¼š&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-e906a1014eba73dd01016cd55fc0e207_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;891&quot; data-rawheight=&quot;257&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;891&quot; data-original=&quot;https://pic4.zhimg.com/v2-e906a1014eba73dd01016cd55fc0e207_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-e906a1014eba73dd01016cd55fc0e207_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;891&quot; data-rawheight=&quot;257&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;891&quot; data-original=&quot;https://pic4.zhimg.com/v2-e906a1014eba73dd01016cd55fc0e207_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-e906a1014eba73dd01016cd55fc0e207_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;ul&gt;&lt;li&gt;å¦‚å›¾ï¼Œåœ¨ session B åœ¨ &lt;code&gt;t2&lt;/code&gt; å¼€å§‹äº‹åŠ¡ 2ï¼Œ&lt;code&gt;t5&lt;/code&gt; æäº¤æˆåŠŸã€‚session A çš„äº‹åŠ¡ 1 åœ¨äº‹åŠ¡ 2 ä¹‹å‰å¼€å§‹ï¼Œåœ¨äº‹åŠ¡ n2 æäº¤å®Œæˆåæäº¤ã€‚&lt;/li&gt;&lt;li&gt;äº‹åŠ¡ 1ã€äº‹åŠ¡ 2 ä¼šåŒæ—¶å»æ›´æ–°åŒä¸€è¡Œæ•°æ®ã€‚&lt;/li&gt;&lt;li&gt;session A æäº¤äº‹åŠ¡ 1 æ—¶ï¼Œå‘ç°å†²çªï¼Œtidb å†…éƒ¨é‡è¯•äº‹åŠ¡ 1ã€‚&lt;br/&gt;&lt;/li&gt;&lt;ul&gt;&lt;li&gt;é‡è¯•æ—¶ï¼Œé‡æ–°å–å¾—æ–°çš„ &lt;code&gt;start_ts&lt;/code&gt; ä¸º &lt;code&gt;t8â€™&lt;/code&gt;ã€‚&lt;/li&gt;&lt;li&gt;å›æ”¾æ›´æ–°è¯­å¥ &lt;code&gt;update tidb set name=&amp;#39;pd&amp;#39; where id =1 and status=1&lt;/code&gt;ã€‚&lt;br/&gt;i. å‘ç°å½“å‰ç‰ˆæœ¬ &lt;code&gt;t8â€™&lt;/code&gt; ä¸‹å¹¶ä¸å­˜åœ¨ç¬¦åˆæ¡ä»¶çš„è¯­å¥ï¼Œä¸éœ€è¦æ›´æ–°ã€‚&lt;br/&gt;ii. æ²¡æœ‰æ•°æ®æ›´æ–°ï¼Œè¿”å›ä¸Šå±‚æˆåŠŸã€‚&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;tidb è®¤ä¸ºäº‹åŠ¡ 1 é‡è¯•æˆåŠŸï¼Œè¿”å›å®¢æˆ·ç«¯æˆåŠŸã€‚&lt;/li&gt;&lt;li&gt;session A è®¤ä¸ºäº‹åŠ¡æ‰§è¡ŒæˆåŠŸï¼ŒæŸ¥è¯¢ç»“æœï¼Œåœ¨ä¸å­˜åœ¨å…¶ä»–æ›´æ–°çš„æƒ…å†µä¸‹ï¼Œå‘ç°æ•°æ®ä¸é¢„æƒ³çš„ä¸ä¸€è‡´ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå¯¹äºé‡è¯•äº‹åŠ¡ï¼Œå¦‚æœæœ¬èº«äº‹åŠ¡ä¸­æ›´æ–°è¯­å¥éœ€è¦ä¾èµ–æŸ¥è¯¢ç»“æœæ—¶ï¼Œå› ä¸ºé‡è¯•æ—¶ä¼šé‡æ–°å–ç‰ˆæœ¬å·ä½œä¸º &lt;code&gt;start_ts&lt;/code&gt;ï¼Œå› è€Œæ— æ³•ä¿è¯äº‹åŠ¡åŸæœ¬çš„ &lt;code&gt;ReadRepeatable&lt;/code&gt; éš”ç¦»å‹ï¼Œç»“æœä¸é¢„æµ‹å¯èƒ½å‡ºç°ä¸ä¸€è‡´ã€‚&lt;/p&gt;&lt;p&gt;ç»¼ä¸Šæ‰€è¿°ï¼Œå¦‚æœå­˜åœ¨ä¾èµ–æŸ¥è¯¢ç»“æœæ¥æ›´æ–° SQL è¯­å¥çš„äº‹åŠ¡ï¼Œå»ºè®®ä¸è¦æ‰“å¼€ TiDB ä¹è§‚é”çš„é‡è¯•æœºåˆ¶ã€‚&lt;/p&gt;&lt;h3&gt;å†²çªé¢„æ£€&lt;/h3&gt;&lt;p&gt;ä»ä¸Šæ–‡æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œæ£€æµ‹åº•å±‚æ•°æ®æ˜¯å¦å­˜åœ¨å†™å†™å†²çªæ˜¯ä¸€ä¸ªå¾ˆé‡çš„æ“ä½œï¼Œå› ä¸ºè¦è¯»å–åˆ°æ•°æ®è¿›è¡Œæ£€æµ‹ï¼Œè¿™ä¸ªæ“ä½œåœ¨ prewrite æ—¶ TiKV ä¸­å…·ä½“æ‰§è¡Œã€‚ä¸ºäº†ä¼˜åŒ–è¿™ä¸€å—æ€§èƒ½ï¼ŒTiDB é›†ç¾¤ä¼šåœ¨å†…å­˜é‡Œé¢è¿›è¡Œä¸€æ¬¡å†²çªé¢„æ£€æµ‹ã€‚&lt;/p&gt;&lt;p&gt;TiDB ä½œä¸ºä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿï¼Œæˆ‘ä»¬åœ¨å†…å­˜ä¸­çš„å†²çªæ£€æµ‹ä¸»è¦åœ¨ä¸¤ä¸ªæ¨¡å—è¿›è¡Œï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;TiDB å±‚ï¼Œå¦‚æœåœ¨ TiDB å®ä¾‹æœ¬èº«å‘ç°å­˜åœ¨å†™å†™å†²çªï¼Œé‚£ä¹ˆç¬¬ä¸€ä¸ªå†™å…¥å‘å‡ºå»åï¼Œåé¢çš„å†™å…¥å°±å·²ç»èƒ½æ¸…æ¥šåœ°çŸ¥é“è‡ªå·±å†²çªäº†ï¼Œæ²¡å¿…è¦å†å¾€ä¸‹å±‚ TiKV å‘é€è¯·æ±‚å»æ£€æµ‹å†²çªã€‚&lt;/li&gt;&lt;li&gt;TiKV å±‚ï¼Œä¸»è¦å‘ç”Ÿåœ¨ prewrite é˜¶æ®µã€‚å› ä¸º TiDB é›†ç¾¤æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿï¼ŒTiDB å®ä¾‹æœ¬èº«æ— çŠ¶æ€ï¼Œå®ä¾‹ä¹‹é—´æ— æ³•æ„ŸçŸ¥åˆ°å½¼æ­¤çš„å­˜åœ¨ï¼Œä¹Ÿå°±æ— æ³•ç¡®è®¤è‡ªå·±çš„å†™å…¥ä¸åˆ«çš„ TiDB å®ä¾‹æ˜¯å¦å­˜åœ¨å†²çªï¼Œæ‰€ä»¥ä¼šåœ¨ TiKV è¿™ä¸€å±‚æ£€æµ‹å…·ä½“çš„æ•°æ®æ˜¯å¦æœ‰å†²çªã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;å…¶ä¸­ TiDB å±‚çš„å†²çªæ£€æµ‹å¯ä»¥å…³é—­ï¼Œé…ç½®é¡¹å¯ä»¥å¯ç”¨ï¼š&lt;/p&gt;&lt;p&gt;txn-local-latchesï¼šäº‹åŠ¡å†…å­˜é”ç›¸å…³é…ç½®ï¼Œå½“æœ¬åœ°äº‹åŠ¡å†²çªæ¯”è¾ƒå¤šæ—¶å»ºè®®å¼€å¯ã€‚&lt;/p&gt;&lt;ul&gt;&lt;li&gt;enable&lt;/li&gt;&lt;ul&gt;&lt;li&gt;å¼€å¯&lt;/li&gt;&lt;li&gt;é»˜è®¤å€¼ï¼šfalse&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;capacity&lt;/li&gt;&lt;ul&gt;&lt;li&gt;Hash å¯¹åº”çš„ slot æ•°ï¼Œä¼šè‡ªåŠ¨å‘ä¸Šè°ƒæ•´ä¸º 2 çš„æŒ‡æ•°å€ã€‚æ¯ä¸ª slot å  32 Bytes å†…å­˜ã€‚å½“å†™å…¥æ•°æ®çš„èŒƒå›´æ¯”è¾ƒå¹¿æ—¶ï¼ˆå¦‚å¯¼æ•°æ®ï¼‰ï¼Œè®¾ç½®è¿‡å°ä¼šå¯¼è‡´å˜æ…¢ï¼Œæ€§èƒ½ä¸‹é™ã€‚&lt;/li&gt;&lt;li&gt;é»˜è®¤å€¼ï¼š1024000&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;p&gt;ç»†å¿ƒçš„æœ‹å‹å¯èƒ½åˆæ³¨æ„åˆ°ï¼Œè¿™è¾¹æœ‰ä¸ª capacity çš„é…ç½®ï¼Œå®ƒçš„è®¾ç½®ä¸»è¦ä¼šå½±å“åˆ°å†²çªåˆ¤æ–­çš„æ­£ç¡®æ€§ã€‚åœ¨å®ç°å†²çªæ£€æµ‹æ—¶ï¼Œæˆ‘ä»¬ä¸å¯èƒ½æŠŠæ‰€æœ‰çš„ Key éƒ½å­˜åˆ°å†…å­˜é‡Œï¼Œå ç©ºé—´å¤ªå¤§ï¼Œå¾—ä¸å¿å¤±ã€‚æ‰€ä»¥ï¼ŒçœŸæ­£å­˜ä¸‹æ¥çš„æ˜¯æ¯ä¸ª Key çš„ hash å€¼ï¼Œæœ‰ hash ç®—æ³•å°±æœ‰ç¢°æ’ä¹Ÿå°±æ˜¯è¯¯åˆ¤çš„æ¦‚ç‡ï¼Œè¿™é‡Œæˆ‘ä»¬é€šè¿‡ capacity æ¥æ§åˆ¶ hash å–æ¨¡çš„å€¼ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;capacity å€¼è¶Šå°ï¼Œå ç”¨å†…å­˜å°ï¼Œè¯¯åˆ¤æ¦‚ç‡è¶Šå¤§ã€‚&lt;/li&gt;&lt;li&gt;capacity å€¼è¶Šå¤§ï¼Œå ç”¨å†…å­˜å¤§ï¼Œè¯¯åˆ¤æ¦‚ç‡è¶Šå°ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;åœ¨çœŸå®ä½¿ç”¨æ—¶ï¼Œå¦‚æœä¸šåŠ¡åœºæ™¯èƒ½å¤Ÿé¢„åˆ¤æ–­å†™å…¥ä¸å­˜åœ¨å†²çªï¼Œå¦‚å¯¼å…¥æ•°æ®æ“ä½œï¼Œå»ºè®®å…³é—­ã€‚&lt;/p&gt;&lt;p&gt;ç›¸åº”åœ°ï¼ŒTiKV å†…å­˜ä¸­çš„å†²çªæ£€æµ‹ä¹Ÿæœ‰ä¸€å¥—ç±»ä¼¼çš„ä¸œè¥¿ã€‚ä¸åŒçš„æ˜¯ï¼ŒTiKV çš„æ£€æµ‹ä¼šæ›´ä¸¥æ ¼ï¼Œä¸å…è®¸å…³é—­ï¼Œåªæä¾›äº†ä¸€ä¸ª hash å–æ¨¡å€¼çš„é…ç½®é¡¹ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;scheduler-concurrency&lt;/li&gt;&lt;ul&gt;&lt;li&gt;scheduler å†…ç½®ä¸€ä¸ªå†…å­˜é”æœºåˆ¶ï¼Œé˜²æ­¢åŒæ—¶å¯¹ä¸€ä¸ª Key è¿›è¡Œæ“ä½œã€‚æ¯ä¸ª Key hash åˆ°ä¸åŒçš„æ§½ã€‚&lt;/li&gt;&lt;li&gt;é»˜è®¤å€¼ï¼š2048000&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;p&gt;æ­¤å¤–ï¼ŒTiKV æä¾›äº†ç›‘æ§æŸ¥çœ‹å…·ä½“æ¶ˆè€—åœ¨ latch ç­‰å¾…çš„æ—¶é—´ï¼š&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-482cbf21c935f2b5b8e68bafeb9c9510_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;370&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic1.zhimg.com/v2-482cbf21c935f2b5b8e68bafeb9c9510_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-482cbf21c935f2b5b8e68bafeb9c9510_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;370&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic1.zhimg.com/v2-482cbf21c935f2b5b8e68bafeb9c9510_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-482cbf21c935f2b5b8e68bafeb9c9510_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;å¦‚æœå‘ç°è¿™ä¸ª wait duration ç‰¹åˆ«é«˜ï¼Œè¯´æ˜è€—åœ¨ç­‰å¾…é”çš„è¯·æ±‚ä¸Šæ¯”è¾ƒä¹…ï¼Œå¦‚æœä¸å­˜åœ¨åº•å±‚å†™å…¥æ…¢é—®é¢˜çš„è¯ï¼ŒåŸºæœ¬ä¸Šå¯ä»¥åˆ¤æ–­è¿™æ®µæ—¶é—´å†…å†²çªæ¯”è¾ƒå¤šã€‚&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;æ€»ç»“&lt;/h2&gt;&lt;p&gt;ç»¼ä¸Šæ‰€è¿°ï¼ŒPercolator ä¹è§‚äº‹åŠ¡å®ç°åŸç†ç®€å•ï¼Œä½†æ˜¯ç¼ºç‚¹è¯¸å¤šï¼Œä¸ºäº†ä¼˜åŒ–è¿™äº›ç¼ºé™·å¸¦æ¥çš„æ€§èƒ½ä¸Šå’ŒåŠŸèƒ½ä¸Šçš„å¼€é”€ï¼Œæˆ‘ä»¬åšäº†è¯¸å¤šåŠªåŠ›ã€‚ä½†æ˜¯è°ä¹Ÿä¸æ•¢è‡ªä¿¡æ»¡æ»¡åœ°è¯´ï¼šè¿™ä¸€å—çš„æ€§èƒ½å·²ç»è¾¾åˆ°äº†æè‡´ã€‚&lt;/p&gt;&lt;p&gt;æ—¶è‡³ä»Šæ—¥ï¼Œæˆ‘ä»¬è¿˜åœ¨æŒç»­åŠªåŠ›å°†è¿™ä¸€å—åšå¾—æ›´å¥½æ›´è¿œï¼Œå¸Œæœ›èƒ½è®©æ›´å¤šä½¿ç”¨ TiDB çš„å°ä¼™ä¼´èƒ½ä»ä¸­å—ç›Šã€‚ä¸æ­¤åŒæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿéå¸¸æœŸå¾…å¤§å®¶åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­çš„åé¦ˆï¼Œå¦‚æœå¤§å®¶å¯¹ TiDB äº‹åŠ¡æœ‰æ›´å¤šä¼˜åŒ–å»ºè®®ï¼Œæ¬¢è¿è”ç³»æˆ‘ &lt;a href=&quot;mailto:wuxuelian@pingcap.com&quot;&gt;wuxuelian@pingcap.com&lt;/a&gt; ã€‚æ‚¨çœ‹ä¼¼ä¸ç»æ„çš„ä¸€ä¸ªä¸¾åŠ¨ï¼Œéƒ½æœ‰å¯èƒ½ä½¿æ›´å¤šé¥±å—æŠ˜ç£¨çš„äº’è”ç½‘åŒå­¦ä»¬ä»ä¸­äº«å—åˆ°åˆ†å¸ƒå¼äº‹åŠ¡çš„ä¹è¶£ã€‚&lt;/p&gt;&lt;p&gt;åŸæ–‡é˜…è¯»ï¼š&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pingcap.com/blog-cn/best-practice-optimistic-transaction/&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic2.zhimg.com/v2-60ab5bd867c2434d70c957a02a2169e1_ipico.jpg&quot; data-image-width=&quot;1200&quot; data-image-height=&quot;1200&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TiDB æœ€ä½³å®è·µç³»åˆ—ï¼ˆä¸‰ï¼‰ä¹è§‚é”äº‹åŠ¡ | PingCAP&lt;/a&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>ZoeyZhai</author>
<guid isPermaLink="false">2019-10-20-87608202</guid>
<pubDate>Sun, 20 Oct 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>Hands-on! å¦‚ä½•ç»™ TiDB æ·»åŠ æ–°ç³»ç»Ÿè¡¨</title>
<link>https://henix.github.io/feeds/zhuanlan.newsql/2019-10-18-87280459.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/87280459&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-206d9738b5b3622f8c51640f2a38a2e6_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;ä½œè€…ï¼šé»„ä¸œæ—­&lt;/p&gt;&lt;blockquote&gt;â€œTiDBï¼Œä½ å·²ç»æ˜¯ä¸€ä¸ªæˆç†Ÿçš„æ•°æ®åº“äº†ï¼Œè¯¥å­¦ä¼šç”¨è‡ªå·±çš„ SQL æŸ¥è‡ªå·±çš„çŠ¶æ€äº†ã€‚â€&lt;/blockquote&gt;&lt;p&gt;å¯¹äºä¸€ä¸ªæˆç†Ÿçš„æ•°æ®åº“æ¥è¯´ï¼Œé€šè¿‡ SQL æ¥æŸ¥è¯¢ç³»ç»Ÿæœ¬èº«çš„çŠ¶æ€å†æ­£å¸¸ä¸è¿‡ï¼Œå¯¹äº MySQL æ¥è¯´ &lt;code&gt;INFOMATION_SCHEMA&lt;/code&gt; å’Œ &lt;code&gt;PERFORMANCE_SCHEMA&lt;/code&gt; é‡Œé¢æœ‰å¤§é‡çš„ä¿¡æ¯ï¼ŒåŸºæœ¬ä¸Šé€šè¿‡æŸ¥è¯¢äº›ä¿¡æ¯ï¼ŒDBA å°±èƒ½å¯¹æ•´ä¸ªç³»ç»Ÿçš„è¿è¡ŒçŠ¶æ€ä¸€ç›®äº†ç„¶ã€‚æœ€æ£’çš„æ˜¯ï¼ŒæŸ¥è¯¢çš„æ¥å£æ­£æ˜¯ SQLï¼Œä¸éœ€è¦ä¾èµ–å…¶ä»–çš„ç¬¬ä¸‰æ–¹å·¥å…·ï¼Œè¿ç”¨è¡¨è¾¾åŠ›å¼ºå¤§çš„ SQL ç”šè‡³å¯ä»¥å¯¹è¿™äº›ä¿¡æ¯è¿›è¡ŒäºŒæ¬¡åŠ å·¥æˆ–è€…è¿‡æ»¤ï¼Œå¦å¤–æ¥å…¥ç¬¬ä¸‰æ–¹çš„è¿ç»´ç›‘æ§å·¥å…·ä¹Ÿå¾ˆè‡ªç„¶ï¼Œä¸éœ€è¦å¼•å…¥æ–°çš„ä¾èµ–ã€‚&lt;/p&gt;&lt;p&gt;è¿‡å»ç”±äºç§ç§åŸå› ï¼ŒTiDB å¾ˆå¤šçš„å†…éƒ¨çŠ¶æ€ä¿¡æ¯æ˜¯é€šè¿‡ä¸åŒç»„ä»¶æš´éœ² RESTFul API æ¥å®ç°ï¼Œè¿™ä¸ªæ–¹æ¡ˆä¹Ÿä¸æ˜¯ä¸å¥½ï¼Œä½†æ˜¯éšç€ API çš„å¢å¤šï¼Œç®¡ç†æˆæœ¬è¶Šæ¥è¶Šé«˜ï¼Œä¸¾ä¸€ä¸ªä¾‹å­ï¼šåœ¨ä¸å‚è€ƒæ–‡æ¡£çš„å‰æä¸‹ï¼Œç”¨æˆ·æ˜¯å¾ˆéš¾è®°ä½é‚£ä¹ˆå¤š RESTFul API çš„è·¯å¾„çš„ï¼Œåªèƒ½é€šè¿‡å°†è¿™äº› API å°è£…æˆå‘½ä»¤è¡Œå·¥å…·æ¥ä½¿ç”¨ï¼Œä½†æ˜¯å¦‚æœè¿™æ˜¯ä¸€å¼ ç³»ç»Ÿè¡¨ï¼Œåªéœ€è¦ä¸€å¥ &lt;code&gt;SHOW TABLES&lt;/code&gt; å’Œå‡ æ¡ &lt;code&gt;SELECT&lt;/code&gt; å°±èƒ½å¤Ÿäº†ã€‚å½“ç„¶é€‰æ‹© RESTFul API è¿˜æœ‰å…¶ä»–çš„åŸå› ï¼Œä¾‹å¦‚æœ‰äº›æ“ä½œå¹¶ä¸æ˜¯åªè¯»çš„ï¼Œæ˜¯ç±»ä¼¼å‘½ä»¤çš„å½¢å¼ï¼Œä¾‹å¦‚ï¼šæ‰‹åŠ¨ split region è¿™ç±»æ“ä½œï¼Œä½¿ç”¨ RESTFul API ä¼šæ›´å¥½ï¼Œè¿™ä¸¤è€…å…¶å®å¹¶ä¸çŸ›ç›¾ï¼Œç³»ç»Ÿè¡¨å½“ç„¶æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„è¡¥å……ï¼Œè¿™æ˜¯æå‡æ•´ä½“è½¯ä»¶æ˜“ç”¨æ€§çš„ä¸€ä¸ªå¥½ä¾‹å­ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;ä»Šå¤©æ­£å¥½æœ‰ä¸€äº›æ—¶é—´ï¼ŒèŠ±äº†å‡ ååˆ†é’Ÿå®Œæ•´çš„èµ°äº†ä¸€éæµç¨‹ï¼Œç»™ TiDB çš„&lt;/b&gt; &lt;b&gt;&lt;code&gt;INFORMATION_SCHEMA&lt;/code&gt;&lt;/b&gt; &lt;b&gt;æ·»åŠ äº†ä¸€å¼ åä¸º&lt;/b&gt; &lt;b&gt;&lt;code&gt;TIDB_SERVERS_INFO&lt;/code&gt;&lt;/b&gt; &lt;b&gt;çš„è¡¨ï¼Œç”¨æ¥æ˜¾ç¤ºé›†ç¾¤ä¸­æ‰€æœ‰æ´»ç€çš„ tidb-server çš„çŠ¶æ€ä¿¡æ¯ï¼ˆåŸºæœ¬å’Œ&lt;/b&gt; &lt;b&gt;&lt;code&gt;/info/all&lt;/code&gt;&lt;/b&gt; &lt;b&gt;åšçš„äº‹æƒ…å·®ä¸å¤šï¼‰ï¼Œæ„åœ¨æŠ›ç –å¼•ç‰ï¼Œç¤¾åŒºçš„å°ä¼™ä¼´å¯ä»¥å‚ç…§è¿™ç¯‡åšå®¢æ·»åŠ æ–°çš„æœ‰ç”¨çš„ä¿¡æ¯ã€‚&lt;/b&gt;&lt;/p&gt;&lt;p&gt;æœ‰è¿™ä¸ªæƒ³æ³•åï¼Œæˆ‘çš„ç›´è§‰æ˜¯å»æ‰¾ &lt;code&gt;information_schema&lt;/code&gt; çš„ä»£ç çœ‹çœ‹åˆ«çš„ç³»ç»Ÿè¡¨æ˜¯æ€ä¹ˆå®ç°çš„ï¼Œç…§çŒ«ç”»è™å°± OK äº†ï¼ˆğŸ˜æ²¡æ¯›ç—…ï¼‰ã€‚ TiDB çš„ä»£ç ç»„ç»‡è¿˜ç®—æ¯”è¾ƒç›´è§‚ï¼Œåœ¨ tidb repo çš„æ ¹ç›®å½•ä¸‹ç›´æ¥çœ‹åˆ°äº†ä¸€ä¸ªåŒ…å« &lt;code&gt;infoschema&lt;/code&gt;ï¼Œæ„Ÿè§‰å°±æ˜¯å®ƒï¼Œæ‰“å¼€ &lt;code&gt;inforschema/table.go&lt;/code&gt; åç¡®å®åº”è¯äº†æˆ‘çš„çŒœæƒ³ï¼Œæ–‡ä»¶å¼€å¤´é›†ä¸­å®šä¹‰äº†å¾ˆå¤šå­—ç¬¦ä¸²å¸¸é‡ï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;...
tableTiKVStoreStatus                	= &amp;#34;TIKV_STORE_STATUS&amp;#34;
tableAnalyzeStatus                  	= &amp;#34;ANALYZE_STATUS&amp;#34;
tableTiKVRegionStatus               	= &amp;#34;TIKV_REGION_STATUS&amp;#34;
tableTiKVRegionPeers                	= &amp;#34;TIKV_REGION_PEERS&amp;#34;
...&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™äº›å¸¸é‡æ­£æ˜¯ TiDB çš„ &lt;code&gt;INFOMATION_SCHEMA&lt;/code&gt; ä¸­çš„è¡¨åï¼Œæ ¹æ®è¿™äº›å˜é‡é¡ºè—¤æ‘¸ç“œå¯ä»¥æ‰¾åˆ°åŒæ–‡ä»¶é‡Œé¢çš„ &lt;code&gt;tableNameToColumns&lt;/code&gt; è¿™ä¸ª mapï¼Œé¡¾åæ€ä¹‰åº”è¯¥æ˜¯è¿™ä¸ª map é€šè¿‡è¡¨åæ˜ å°„åˆ°è¡¨ç»“æ„å®šä¹‰ï¼Œéšä¾¿æ‰“å¼€ä¸€ä¸ªï¼Œæœç„¶å¦‚æ­¤ï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;var columnStatisticsCols = []columnInfo{
	{&amp;#34;SCHEMA_NAME&amp;#34;, mysql.TypeVarchar, 64, mysql.NotNullFlag, nil, nil}, 
	{&amp;#34;TABLE_NAME&amp;#34;, mysql.TypeVarchar, 64, mysql.NotNullFlag, nil, nil}, 
	{&amp;#34;COLUMN_NAME&amp;#34;, mysql.TypeVarchar, 64, mysql.NotNullFlag, nil, nil}, 
	{&amp;#34;HISTOGRAM&amp;#34;, mysql.TypeJSON, 51, 0, nil, nil}, 
}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¸‹ä¸€æ­¥éœ€è¦å¦‚ä½•å¡«å……æ•°æ®è¿”å›ç»™ TiDB çš„ SQL Engineï¼Œæˆ‘ä»¬æ³¨æ„åˆ° &lt;code&gt;infoschemaTable&lt;/code&gt; è¿™ä¸ªç±»å®ç°äº† &lt;code&gt;table.Table interface&lt;/code&gt;ï¼Œå¾ˆæ˜¾ç„¶è¿™ä¸ª interface å°±æ˜¯ TiDB ä¸­å¯¹äº Table è·å–æ•°æ®/ä¿®æ”¹æ•°æ®çš„æ¥å£ï¼Œæœ‰å…³è·å–æ•°æ®çš„æ–¹æ³•æ˜¯ &lt;code&gt;IterRecords&lt;/code&gt;ï¼Œæˆ‘ä»¬åªéœ€è¦çœ‹åˆ° &lt;code&gt;IterRecords&lt;/code&gt; ä¸­çš„å®ç°å°±èƒ½çŸ¥é“è¿™äº›ç³»ç»Ÿè¡¨çš„æ•°æ®æ˜¯å¦‚ä½•è¿”å›ç»™ SQL Engine çš„ï¼Œæœç„¶åœ¨ &lt;code&gt;IterRecords&lt;/code&gt; é‡Œé¢æœ‰ä¸€ä¸ªæ–¹æ³•ï¼Œ&lt;code&gt;inforschemaTable.getRows()&lt;/code&gt;ï¼Œè¿™ä¸ªæ–¹æ³•çš„å®šä¹‰ä¸­æœ‰ä¸€ä¸ªå·¨å¤§çš„ switch è¯­å¥ï¼Œç”¨äºåˆ¤æ–­æ˜¯åœ¨å“ªä¸ªç³»ç»Ÿè¡¨ä¸Šï¼Œæ ¹æ®è¿™ä¸ªä¿¡æ¯ç„¶åè¿”å›ä¸åŒçš„æ•°æ®ï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;...
switch it.meta.Name.O {
	case tableSchemata:
		fullRows = dataForSchemata(dbs)
	case tableTables:
		fullRows, err = dataForTables(ctx, dbs) 
	case tableTiDBIndexes: 
		fullRows, err = dataForIndexes(ctx, dbs) 
...
}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Bingo! æ„Ÿè§‰å°±æ˜¯æˆ‘ä»¬éœ€è¦çš„ä¸œè¥¿ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;ç°åœ¨æ­¥éª¤å°±å¾ˆæ¸…æ¥šäº†ï¼š&lt;/b&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;åœ¨ &lt;code&gt;infoschema/tables.go&lt;/code&gt; ä¸­æ·»åŠ ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²å¸¸é‡ &lt;code&gt;tableTiDBServersInfo&lt;/code&gt; ç”¨äºå®šä¹‰è¡¨åï¼›&lt;/li&gt;&lt;li&gt;å®šä¹‰ä¸€ä¸ª &lt;code&gt;[]columnInfoï¼štableTiDBServersInfoCols&lt;/code&gt;ï¼Œç”¨äºå®šä¹‰è¿™å¼ ç³»ç»Ÿè¡¨çš„ç»“æ„ï¼›&lt;/li&gt;&lt;li&gt;åœ¨ &lt;code&gt;tableNameToColumns&lt;/code&gt; è¿™ä¸ª map ä¸­æ·»åŠ ä¸€ä¸ªæ–°çš„æ˜ å°„å…³ç³» &lt;code&gt;tableTiDBServersInfo =&amp;gt; tableTiDBServersInfoCols&lt;/code&gt;ï¼›&lt;/li&gt;&lt;li&gt;åœ¨ &lt;code&gt;infoschemaTable.getRows()&lt;/code&gt; æ–¹æ³•ä¸­åŠ å…¥ä¸€ä¸ªæ–°çš„ &lt;code&gt;dataForTableTiDBServersInfo&lt;/code&gt; çš„ swtich caseï¼›&lt;/li&gt;&lt;li&gt;æå®šã€‚&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;ä¸‹ä¸€ä¸ªç›®æ ‡æ˜¯å®ç° &lt;code&gt;dataForTableTiDBServersInfo&lt;/code&gt;ï¼Œå¾ˆæ˜¾ç„¶ï¼Œå¤§è‡´çš„æ€è·¯æ˜¯ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;æ‰¾åˆ°è¿™ä¸ªé›†ç¾¤çš„ PDï¼Œå› ä¸ºè¿™äº›é›†ç¾¤æ‹“æ‰‘ä¿¡æ¯ï¼›&lt;/li&gt;&lt;li&gt;å°†è¿™äº›ä¿¡æ¯å°è£…æˆ &lt;code&gt;tableTiDBServersInfoCols&lt;/code&gt; ä¸­å®šä¹‰çš„å½¢å¼ï¼Œè¿”å›ç»™ &lt;code&gt;getRows&lt;/code&gt; æ–¹æ³•ã€‚&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;é€šè¿‡ä¼ å…¥çš„ ctx å¯¹è±¡ï¼Œè·å–åˆ° Store çš„ä¿¡æ¯ï¼Œ &lt;code&gt;sessionctx.Context&lt;/code&gt; æ˜¯ TiDB ä¸­ä¸€ä¸ªå¾ˆé‡è¦çš„å¯¹è±¡ï¼Œä¹Ÿæ˜¯ TiDB è´¯ç©¿æ•´ä¸ª SQL å¼•æ“çš„ä¸€ä¸ªè®¾è®¡æ¨¡å¼ï¼Œè¿™ä¸ª Context ä¸­é—´å­˜å‚¨åœ¨è¿™ä¸ª session ç”Ÿå‘½å‘¨æœŸä¸­çš„ä¸€äº›é‡è¦ä¿¡æ¯ï¼Œä¾‹å¦‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ &lt;code&gt;sessionctx.Context&lt;/code&gt; è·å–åº•å±‚çš„ Storage å¯¹è±¡ï¼Œæ‹¿åˆ° Storage å¯¹è±¡åï¼Œèƒ½å¹²çš„äº‹æƒ…å°±å¾ˆå¤šäº†ã€‚&lt;/p&gt;&lt;p&gt;æœ¬ç€ç…§çŒ«ç”»è™çš„åŸåˆ™ï¼Œå‚è€ƒäº†ä¸€ä¸‹ &lt;code&gt;dataForTiDBHotRegions&lt;/code&gt; çš„å®ç°ï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;tikvStore, ok := ctx.GetStore().(tikv.Storage) &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å› ä¸ºæˆ‘ä»¬çš„ç›®æ ‡æ˜¯è·å– PD å¯¹è±¡ï¼Œå¿…ç„¶åœ°ï¼Œåªæœ‰ TiKV ä½œä¸º backend çš„æ—¶å€™æ‰æœ‰ PDï¼Œæ‰€ä»¥è¿™é‡Œçš„ç±»å‹è½¬æ¢åˆ¤æ–­æ˜¯å¿…è¦çš„ã€‚&lt;/p&gt;&lt;p&gt;å…¶å®ï¼Œé€šè¿‡ PD è·å–é›†ç¾¤ä¿¡æ¯è¿™æ ·çš„é€»è¾‘å·²ç»åœ¨ TiDB ä¸­å°è£…å¥½äº†ï¼Œæˆ‘å‘ç°åœ¨ &lt;code&gt;domain/info.go&lt;/code&gt; ä¸­çš„è¿™ä¸ªæ–¹æ³•æ­£æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;// GetAllServerInfo gets all servers static information from etcd. func (is *InfoSyncer) 
GetAllServerInfo(ctx context.Context) (map[string]*ServerInfo, error)&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å®é™…ä¸Šï¼ŒTiDB çš„ &lt;code&gt;/info/all&lt;/code&gt; è¿™ä¸ª REST API æ­£æ˜¯é€šè¿‡è°ƒç”¨è¿™ä¸ªå‡½æ•°å®ç°ï¼Œæˆ‘ä»¬åªéœ€è¦è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œå°†è¿”å›å€¼å°è£…å¥½å°±å®Œæˆäº†ã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-5ecb9035e5753574aa3efa1f5119d097_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;974&quot; data-rawheight=&quot;275&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;974&quot; data-original=&quot;https://pic4.zhimg.com/v2-5ecb9035e5753574aa3efa1f5119d097_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-5ecb9035e5753574aa3efa1f5119d097_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;974&quot; data-rawheight=&quot;275&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;974&quot; data-original=&quot;https://pic4.zhimg.com/v2-5ecb9035e5753574aa3efa1f5119d097_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-5ecb9035e5753574aa3efa1f5119d097_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;è‡ªæ­¤ï¼Œæˆ‘ä»¬å°±å®Œæˆäº†ä¸€ä¸ªæ–°çš„ç³»ç»Ÿè¡¨çš„æ·»åŠ ã€‚åœ¨è‡ªå·±æ·»åŠ çš„æ–°è¡¨ä¸Š SELECT ä¸€ä¸‹ï¼Œæ˜¯ä¸æ˜¯å¾ˆæœ‰æˆå°±æ„Ÿ :) æ¬¢è¿å¤§å®¶åœ¨æ­¤åŸºç¡€ä¸Šæ·»åŠ æ›´å¤šæœ‰ç”¨çš„ä¿¡æ¯ã€‚&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;é˜…è¯»åŸæ–‡ï¼š&lt;/b&gt;&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pingcap.com/blog-cn/hands-on-build-a-new-system-table-for-tidb/&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic2.zhimg.com/v2-60ab5bd867c2434d70c957a02a2169e1_ipico.jpg&quot; data-image-width=&quot;1200&quot; data-image-height=&quot;1200&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Hands-on! å¦‚ä½•ç»™ TiDB æ·»åŠ æ–°ç³»ç»Ÿè¡¨ | PingCAP&lt;/a&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>ZoeyZhai</author>
<guid isPermaLink="false">2019-10-18-87280459</guid>
<pubDate>Fri, 18 Oct 2019 00:00:00 +0800</pubDate>
</item>
</channel>
</rss>
