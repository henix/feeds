<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>病毒伪装成“汇丰银行”邮件盗取用户账号 涉及269家银行等机构</title>
</head>
<body>
<p><a href="https://mp.weixin.qq.com/s?timestamp=1529438195&amp;src=3&amp;ver=1&amp;signature=fYCHMLk0rffOER3wz1hCLAQ1-ux107K1rJ87jbfL7qJ3DbHn7ltd5gTJgvrERp-B6ddqr9K0meaLw1cmC2B9EgCbxUPJqRxdgtlgbzjNhYsN-zA*x9tqkrsYaikbrihxAJHRfFOfadxcwdFz*JgyzfMTGO74Jte2ORl1TAZ6BYs=">原文</a></p>
<div class="rich_media_inner">
                        
        
        <div id="page-content" class="rich_media_area_primary">
            
                        <div id="img-content">
                
                <h2 class="rich_media_title" id="activity-name">
                    病毒伪装成“汇丰银行”邮件盗取用户账号 涉及269家银行等机构                                    </h2>
                <div id="meta_content" class="rich_media_meta_list">
                                        <span id="copyright_logo" class="rich_media_meta meta_original_tag">原创</span>
                                                            <em id="post-date" class="rich_media_meta rich_media_meta_text">2018-04-28</em>

                                        <em class="rich_media_meta rich_media_meta_text">火绒安全实验室</em>
                                        <a class="rich_media_meta rich_media_meta_link rich_media_meta_nickname" href="##" id="post-user">火绒安全实验室</a>
                    <span class="rich_media_meta rich_media_meta_text rich_media_meta_nickname">火绒安全实验室</span>


                    <div id="js_profile_qrcode" class="profile_container" style="display:none;">
                        <div class="profile_inner">
                            <strong class="profile_nickname">火绒安全实验室</strong>
                            <img class="profile_avatar" id="js_profile_qrcode_img" src="" alt="">

                            <p class="profile_meta">
                            <label class="profile_meta_label">微信号</label>
                            <span class="profile_meta_value">HuorongLab</span>
                            </p>

                            <p class="profile_meta">
                            <label class="profile_meta_label">功能介绍</label>
                            <span class="profile_meta_value">火绒是一家纯粹的信息安全公司。在这里为大家分享专业的技术报告和安全信息。</span>
                            </p>
                            
                        </div>
                        <span class="profile_arrow_wrp" id="js_profile_arrow_wrp">
                            <i class="profile_arrow arrow_out"></i>
                            <i class="profile_arrow arrow_in"></i>
                        </span>
                    </div>
                </div>
                                
                
                
                
                                                
                                                                
                
                <div class="rich_media_content " id="js_content">
                    

                    

                    
                    
                    <p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 16px;"><strong>一、<span style="white-space: pre;">	</span>概述</strong></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">近日，火绒安全团队发现名为“TrickBot”的后门病毒正在全球范围内通过仿冒邮件发起新一轮网络攻击，世界范围内多家银行和比特币交易平台（共计269家）的使用者都在此次被攻击范围之内。病毒“TrickBot”目的明确，在于盗取用户的银行账户、比特币账户信息，攫取钱财。</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"></span></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><img class="" data-copyright="0" data-ratio="0.34536082474226804" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4SwlPIftFh3OEf8mvx8OX9YIO79t65yL5TnjHSobzawHYkTLCc5TKtic2unOczrsJCAXDe12yLsew/640?wx_fmt=png" data-type="png" data-w="582" style="width: 463px;height: 160px;"></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">图：受到病毒攻击威胁的部分银行、比特币交易平台名称</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">后门病毒“TrickBot”通过伪装成标题为“您的汇丰银行申请文档”的邮件进行传播，并以附件的形式发给用户。其内容极具迷惑性，操作说明、注意事项、客服电话以及办公地址等信息一应俱全，用户很难辨别其真伪。而用户一旦打开该文档，文档内的恶意代码将会自动执行，并通过Office漏洞(CVE-2017-11882)下载后门病毒“TrickBot”。以下为受影响版本：</span></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><img class="" data-copyright="0" data-ratio="0.4418604651162791" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4SwlPIftFh3OEf8mvx8OX9wH0d3icEND9Fw20YicyqdWLHCiafbO1xMltssfDaV83tW0IyRaFf1tu5g/640?wx_fmt=png" data-type="png" data-w="344" style="width: 296px;height: 131px;"></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">病毒“TrickBot”入侵用户电脑后，会盗取其银行账户以及比特币交易平台登录信息。同时还会收集用户计算机内的数据信息，包括系统版本，CPU情况，内存，用户名，系统中的服务项，软件安装情况等。不仅如此，病毒团伙可随时通过远程操控更改病毒代码，进行其他破坏行为。例如：植入挖矿病毒、勒索病毒等。</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">火绒工程师通过技术分析，发现“TrickBot”早在2016年就已经出现，此次火绒安全团队拦截到的为其变种版本。虽然该病毒的新变种层出不穷，但其主要目标都是盗取用户银行账号、密码等信息，攫取钱财。</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">“火绒安全软件”最新版即可查杀后门病毒“TrickBot”，建议近期收到过类似邮件的用户尽快进行排查。此外，目前Microsoft Office已经修复该漏洞，建议用户安装最新补丁，以免遭受不必要的损失。 </span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 16px;"><strong>二、<span style="white-space: pre;">	</span>详细分析</strong></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">近期，火绒截获到一批病毒样本，会利用垃圾邮件配合漏洞文档的形式传播TrickBot病毒。邮件内容将自己伪装成汇丰银行的通知邮件，从而诱骗受害者打开附件中存放的漏洞文档（CVE-2017-11882），文档内容同样将自己伪装成汇丰银行通知内容。漏洞被触发后，病毒会通过访问C&amp;C服务器下载执行TrickBot病毒，TrickBot病毒执行会请求远程的恶意功能模块到本地执行，病毒模块功能包括：盗取用户银行账号信息、收集用户本地操作系统信息、软件安装情况等。病毒传播与执行恶意行为流程图，如下图所示：</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"></span></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><img class="" data-copyright="0" data-ratio="0.8056737588652483" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4SwlPIftFh3OEf8mvx8OX9m2OHH5USJ7RmXUPp7ial3QSWic7lSmnSE9uNeybVK2ickI3IBtNqAbdHA/640?wx_fmt=png" data-type="png" data-w="705" style=""></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"></span></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">病毒传播与执行恶意行为流程图</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">伪造的邮件及文档内容，如下图所示：</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"> </span></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><img class="" data-copyright="0" data-ratio="0.689601250977326" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4SwlPIftFh3OEf8mvx8OX9OUm33uWPUxSpfHc1TCsVdcp13TkDKBSynGISrpWRHnxbx28qe8fK5Q/640?wx_fmt=png" data-type="png" data-w="1279" style=""></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">邮件及文档内容</span><br><span style="font-size: 15px;"></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">文档中所包含的CVE-2017-11882漏洞被触发后，会执行PowerShell脚本从C&amp;C服务器（hxxp:// ccmlongueuil.ca、hxxp://guardtrack.uk）下载执行远程恶意代码。PowerShell代码，如下图所示：</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"></span></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><img class="" data-copyright="0" data-ratio="0.2588757396449704" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4SwlPIftFh3OEf8mvx8OX9DQSND4tDS3y8JFqZdia9MtD59Hiazmnu4A2NgL61IIdFyj8hCwnE5SsQ/640?wx_fmt=png" data-type="png" data-w="676" style=""></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">PowerShell代码内容</span><br><span style="font-size: 15px;"></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">如上图，PowerShell代码执行后会将TrickBot病毒下载至 “%TMP%\bumsiery.exe”位置后进行执行。漏洞触发后的进程关系情况，如下图所示：</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"> </span></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><img class="" data-copyright="0" data-ratio="0.25113739763421294" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4SwlPIftFh3OEf8mvx8OX9Oa3lucZLUZAAKwjBF6zGW6U5Rf7uUEmEIWiabM8NJprpeabPsqzfztQ/640?wx_fmt=png" data-type="png" data-w="1099" style=""></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">进程关系</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">为了对抗安全软件查杀，病毒被混淆器进行了混淆。在混淆器代码通过创建窗体、发送窗体消息的方式对抗虚拟机引擎，在窗体消息处理函数中创建Timer，当Timer消息连续被响应360次后才能触发最终的混淆器解密代码。相关代码，如下图所示：</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"> </span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"></span></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><img class="" data-copyright="0" data-ratio="0.6642105263157895" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4SwlPIftFh3OEf8mvx8OX9kHQCqq5CiabsknGDibRMYMue3oPbIyIHiaA7tReK2cKIFyoY7CQ5QLXibQ/640?wx_fmt=png" data-type="png" data-w="950" style=""></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">混淆器代码</span><br><span style="font-size: 15px;"></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">病毒所使用的字符串数据均被进行过加密处理，在病毒代码使用相关的字符串资源时，会通过解密函数进行临时解密。解密后的数据被存放在栈中，使病毒分析人员很难通过查看进程内存镜像的方法找到与病毒功能相关的数据信息，从而加大对病毒的分析和逆向复杂度。除此之外，病毒所调用的所有系统API全部通过病毒获取的函数地址表进行调用，从而用上述手段对抗安全厂商的分析与查杀。字符串数据解密前后示例，如下图所示：</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><img class="" data-copyright="0" data-ratio="0.9151898734177215" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4SwlPIftFh3OEf8mvx8OX9YjkhzLMFCZxDm0NVqcKIe0krWmg7rgrmckoyCgODFBLkdicxfNRjH6w/640?wx_fmt=png" data-type="png" data-w="790" style=""></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">字符串数据</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">获取API函数地址表相关代码，如下图所示：</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"> </span></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><img class="" data-copyright="0" data-ratio="1.058679706601467" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4SwlPIftFh3OEf8mvx8OX93sEyuloiaeDicJLtJNoppaNK4nDy6tnbRTXRwj1tPNTBEAqXrgSOpADQ/640?wx_fmt=png" data-type="png" data-w="818" style=""></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">获取API函数表</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">病毒执行后，首先会创建计划任务创建启动项，且每隔3分钟就会重复执行一次。如下图所示：</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"> </span></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><img class="" data-copyright="0" data-ratio="0.3366228070175439" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4SwlPIftFh3OEf8mvx8OX9iahsElP6W6iaaoRicV5xQcto7icXXLeEsPDTck3TOKRPKsmRxX5VaPnHSQ/640?wx_fmt=png" data-type="png" data-w="912" style=""></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">计划任务</span><br><span style="font-size: 15px;"></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">在主要病毒代码逻辑执行后，病毒会使用多种不同的命令编号与C&amp;C服务器进行通信，从而获取不同的远端数据（包含病毒模块数据及相关配置数据），并将本地计算机信息和病毒运行状态上传到服务器。主要命令编号及作用，如下图所示：</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"> </span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"></span></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><img class="" data-copyright="0" data-ratio="0.44353518821603927" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4SwlPIftFh3OEf8mvx8OX9hYTul1Br0lD39uz8VmTGVJ1oibicBoOFsCrVFKS8Nfz30NGMLNHb7LhQ/640?wx_fmt=png" data-type="png" data-w="611" style=""></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">主要命令编号与对应功能描述</span><br><span style="font-size: 15px;"></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">C&amp;C服务器返回的数据均被使用AES-256算法进行加密过，数据在受害计算机中也以加密形式进行存放，解密密钥也被存放在回传数据中。从C&amp;C服务器请求到的数据文件及功能描述，如下图所示：</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"> </span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"></span></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><img class="" data-copyright="0" data-ratio="0.44353518821603927" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4SwlPIftFh3OEf8mvx8OX9GOLbUiaJCcmBfN5LR9n2g0qNn3o7dTRux3LMDvvnQRTCicCTmKIqGYQg/640?wx_fmt=png" data-type="png" data-w="611" style=""></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">数据文件及功能描述</span><br><span style="font-size: 15px;"></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">TrickBot病毒具有很强的可扩展性，病毒作者可以随意通过修改C&amp;C服务器返回数据的方式增减病毒模块，执行任意攻击逻辑。病毒在请求到模块数据后，会根据远程返回的配置文件调用不同导出函数执行恶意代码，TrickBot病毒的病毒模块通常的导出函数共有4个，如下图所示：</span></p><p style="text-align: justify;"><br></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><img class="" data-copyright="0" data-ratio="1.123931623931624" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4SwlPIftFh3OEf8mvx8OX9ibcq2p7Hvy3Ra3BqGGLYicBJn9gx67ZYPVicaHkZ7cdyCyceBzgpckLyw/640?wx_fmt=png" data-type="png" data-w="468" style=""></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">病毒模块导出函数</span><br><span style="font-size: 15px;"></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">我们现在可以请求到的功能模块共有两个injectdll和systeminfo，injectdll模块主要用于盗取用户账号，systeminfo模块则用来收集受害者计算机中的系统信息，下文中将按照病毒模块进行逐一说明。用于请求功能模块的远程配置信息，如下图所示：</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"> </span></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><img class="" data-copyright="0" data-ratio="1.6374269005847952" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4SwlPIftFh3OEf8mvx8OX9CxKKObIeqsYAFplvjHnicGSubOqsToeLFzGP2kACZK26uKrXVHtGYeg/640?wx_fmt=png" data-type="png" data-w="342" style=""></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">用于请求功能模块的远程配置信息</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><strong><span style="font-size: 15px;">Injectdll</span></strong></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">该病毒模块首先会被注入到svchost进程进行执行，当通过遍历查找浏览器进程进行远程注入盗取用户账户信息，该病毒只针对IE、Chrome和FireFox进行盗取。通过对病毒配置信息的筛查，我们发现病毒窃取账户范围非常之广，共包含银行站点、比特币交易平台271个。配置中所涉及的个别站点示例，如下图所示：</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"> </span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"></span></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><img class="" data-copyright="0" data-ratio="0.7669902912621359" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4SwlPIftFh3OEf8mvx8OX9aezvLsEMlSzQP0Yoe2dzLQKqeAQgKsia5ZeJia9WnaaibqdLPjiakJf4Fw/640?wx_fmt=png" data-type="png" data-w="412" style=""></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">站点示例</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">病毒在检测到浏览器进行后会对浏览器进行注入，Hook浏览器进程中的网络请求函数，根据病毒配置规则过滤发送向指定网址的数据。浏览器进程被Hook情况，如下图所示：</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"> </span></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><img class="" data-copyright="0" data-ratio="0.6559888579387186" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4SwlPIftFh3OEf8mvx8OX9ch11DewSKKiaeplBMFicRAOiblDYXPfzmJMTWwz1vhTClbvJeBZrLmxdg/640?wx_fmt=png" data-type="png" data-w="1436" style=""></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">浏览器进程被Hook情况</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">盗取账号相关配置信息分别存放在sinj、dinj和dpost中。 sinj解密后配置内容示例，如下图所示：</span></p><p style="margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;text-align: justify;"> </span><br></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><img class="" data-copyright="0" data-ratio="1.7599164926931106" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4SwlPIftFh3OEf8mvx8OX9V88e78Z79q9JMzVX8nn4tKeiaxJF7ICKs8NyqczUicnEDwUDOgia0Qbeg/640?wx_fmt=png" data-type="png" data-w="479" style=""></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">sinj配置示例</span><br><span style="font-size: 15px;"></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"> dinj解密后配置内容示例，如下图所示：</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"> </span></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><img class="" data-copyright="0" data-ratio="1.2546296296296295" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4SwlPIftFh3OEf8mvx8OX9jLFI0M7D5g0WhHZerzYgeNndslZTpLVianxjWbbPm37vaBlNKNWaDeg/640?wx_fmt=png" data-type="png" data-w="648" style=""></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">dinj配置示例</span><br><span style="font-size: 15px;"></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"> dpost解密后配置内容，如下图所示：</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"> </span></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><img class="" data-copyright="0" data-ratio="0.3806646525679758" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4SwlPIftFh3OEf8mvx8OX9lVA4p65xSq44zQclsDtF7FP8GwW9Whpics5ExsPHNs8tGGFrl5A07DA/640?wx_fmt=png" data-type="png" data-w="331" style=""></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">dpost配置内容</span><br><span style="font-size: 15px;"></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><strong><span style="font-size: 15px;">Systeminfo</span></strong></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">systeminfo模块主要用来获取受害者的计算机信息，主要会收集用户系统版本、CPU信息、内存大小信息，系统服务信息，软件安装信息等，收集到的信息最终会拼接成xml文件。收集本地信息代码，如下图所示：</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"> </span></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><img class="" data-copyright="0" data-ratio="0.798581560283688" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4SwlPIftFh3OEf8mvx8OX9IrMs51GaFVohtA34hQwQEBhepxK8jG9IU7r1UibfibnqrsXuziccSnJxA/640?wx_fmt=png" data-type="png" data-w="1410" style=""></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">获取本地系统信息主要逻辑</span><br><span style="font-size: 15px;"></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">利用WMI查询本地系统版本信息，如下图所示：</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"> </span></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><img class="" data-copyright="0" data-ratio="1.5589941972920696" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4SwlPIftFh3OEf8mvx8OX9e3wns6DbNra5JDgsMpNGoX3qQPw7N1BibhetIGsxr1n822mRztwrcpg/640?wx_fmt=png" data-type="png" data-w="1034" style=""></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">通过WMI查询系统信息</span><br><span style="font-size: 15px;"></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">通过遍历注册表的方式获取当前系统中的软件安装信息，如下图所示：</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"> </span></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><img class="" data-copyright="0" data-ratio="0.8503611971104231" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4SwlPIftFh3OEf8mvx8OX91tmGBlAYnHAlygVZIQptD1YTp7dFyANUs040nAt5icIjX5LUVIBiaFVg/640?wx_fmt=png" data-type="png" data-w="969" style=""></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">收集软件安装信息</span><br><span style="font-size: 15px;"></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"> </span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 16px;"><strong>三、<span style="white-space: pre;">	</span>附录</strong></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">文中涉及样本SHA256：</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"> </span></p><p style="margin-bottom: 5px;line-height: 1.5em;"><img class="" data-copyright="0" data-ratio="0.1352405721716515" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4SwlPIftFh3OEf8mvx8OX9YrljSJyVHKicqGZLbGMRQTxiaSsTI2gYA6WctIFxWGMnC3lfa8dmiaxPA/640?wx_fmt=png" data-type="png" data-w="769" style=""></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"></span><br></p><p><br></p>
                </div>
                <script nonce="26841196" type="text/javascript">
                    var first_sceen__time = (+new Date());

                    if ("" == 1 && document.getElementById('js_content')) {
                        document.getElementById('js_content').addEventListener("selectstart",function(e){ e.preventDefault(); });
                    }

                    
                    (function(){
                        if (navigator.userAgent.indexOf("WindowsWechat") != -1){
                            var link = document.createElement('link');
                            var head = document.getElementsByTagName('head')[0];
                            link.rel = 'stylesheet';
                            link.type = 'text/css';
                            link.href = "//res.wx.qq.com/mmbizwap/zh_CN/htmledition/style/page/appmsg/page_mp_article_improve_winwx3d171e.css";
                            head.appendChild(link);
                        }
                    })();
                </script>
                
                
                                
                <div class="ct_mpda_wrp" id="js_sponsor_ad_area" style="display:none;"></div>

                
                                <div class="reward_area tc" id="js_preview_reward" style="display:none;">
                    <p id="js_preview_reward_wording" class="tips_global reward_tips" style="display:none;"></p>
                    <p>
                        <a class="reward_access" id="js_preview_reward_link" href="##"><span class="icon-reward"></span>赞赏</a>

                    </p>
                </div>
                <div class="reward_qrcode_area reward_area tc" id="js_preview_reward_qrcode" style="display:none;">
                    <p class="tips_global">长按二维码向我转账</p>
                    <p id="js_preview_reward_ios_wording" class="reward_tips" style="display:none;"></p>
                    <span class="reward_qrcode_img_wrp"><img class="reward_qrcode_img" src="//res.wx.qq.com/mmbizwap/zh_CN/htmledition/images/pic/appmsg/pic_reward_qrcode.2x3534dd.png"></span>
                    <p class="tips_global">受苹果公司新规定影响，微信 iOS 版的赞赏功能被关闭，可通过二维码转账支持公众号。</p>
                </div>
                            </div>
                        
            <ul id="js_hotspot_area" class="article_extend_area"></ul>


            
                        <div class="rich_media_tool" id="js_toobar3">
                
                                
                                            <div id="js_read_area3" class="media_tool_meta tips_global meta_primary" style="display:none;">阅读 <span id="readNum3"></span></div>

                <span style="display:none;" class="media_tool_meta meta_primary tips_global meta_praise" id="like3">
                    <i class="icon_praise_gray"></i><span class="praise_num" id="likeNum3"></span>
                </span>

                <a id="js_report_article3" style="display:none;" class="media_tool_meta tips_global meta_extra" href="##">投诉</a>

            </div>


                        <div class="rich_media_tool" id="js_sg_bar">
                
                                
                                
            </div>
                    </div>

        <div class="rich_media_area_primary sougou" id="sg_tj" style="display:none"></div>

        
        <div class="rich_media_area_extra">

            
                        <div class="mpda_bottom_container" id="js_bottom_ad_area"></div>
                        
            <div id="js_iframetest" style="display:none;"></div>
                        
                        
            <div class="rich_media_extra rich_media_extra_discuss" id="js_friend_cmt_area" style="display:none">
              
              
              
            </div>

                        <div class="rich_media_extra rich_media_extra_discuss" id="js_cmt_area" style="display:none">
            </div>
                    </div>

        
        <div id="js_pc_qr_code" class="qr_code_pc_outer" style="display:none;">
            <div class="qr_code_pc_inner">
                <div class="qr_code_pc">
                    <img id="js_pc_qr_code_img" class="qr_code_pc_img">
                    <p>微信扫一扫<br>关注该公众号</p>
                </div>
            </div>
        </div>
    </div><div id="img-content">
                
                <h2 class="rich_media_title" id="activity-name">
                    病毒伪装成“汇丰银行”邮件盗取用户账号 涉及269家银行等机构                                    </h2>
                <div id="meta_content" class="rich_media_meta_list">
                                        <span id="copyright_logo" class="rich_media_meta meta_original_tag">原创</span>
                                                            <em id="post-date" class="rich_media_meta rich_media_meta_text">2018-04-28</em>

                                        <em class="rich_media_meta rich_media_meta_text">火绒安全实验室</em>
                                        <a class="rich_media_meta rich_media_meta_link rich_media_meta_nickname" href="##" id="post-user">火绒安全实验室</a>
                    <span class="rich_media_meta rich_media_meta_text rich_media_meta_nickname">火绒安全实验室</span>


                    <div id="js_profile_qrcode" class="profile_container" style="display:none;">
                        <div class="profile_inner">
                            <strong class="profile_nickname">火绒安全实验室</strong>
                            <img class="profile_avatar" id="js_profile_qrcode_img" src="" alt="">

                            <p class="profile_meta">
                            <label class="profile_meta_label">微信号</label>
                            <span class="profile_meta_value">HuorongLab</span>
                            </p>

                            <p class="profile_meta">
                            <label class="profile_meta_label">功能介绍</label>
                            <span class="profile_meta_value">火绒是一家纯粹的信息安全公司。在这里为大家分享专业的技术报告和安全信息。</span>
                            </p>
                            
                        </div>
                        <span class="profile_arrow_wrp" id="js_profile_arrow_wrp">
                            <i class="profile_arrow arrow_out"></i>
                            <i class="profile_arrow arrow_in"></i>
                        </span>
                    </div>
                </div>
                                
                
                
                
                                                
                                                                
                
                <div class="rich_media_content " id="js_content">
                    

                    

                    
                    
                    <p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 16px;"><strong>一、<span style="white-space: pre;">	</span>概述</strong></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">近日，火绒安全团队发现名为“TrickBot”的后门病毒正在全球范围内通过仿冒邮件发起新一轮网络攻击，世界范围内多家银行和比特币交易平台（共计269家）的使用者都在此次被攻击范围之内。病毒“TrickBot”目的明确，在于盗取用户的银行账户、比特币账户信息，攫取钱财。</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"></span></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><img class="" data-copyright="0" data-ratio="0.34536082474226804" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4SwlPIftFh3OEf8mvx8OX9YIO79t65yL5TnjHSobzawHYkTLCc5TKtic2unOczrsJCAXDe12yLsew/640?wx_fmt=png" data-type="png" data-w="582" style="width: 463px;height: 160px;"></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">图：受到病毒攻击威胁的部分银行、比特币交易平台名称</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">后门病毒“TrickBot”通过伪装成标题为“您的汇丰银行申请文档”的邮件进行传播，并以附件的形式发给用户。其内容极具迷惑性，操作说明、注意事项、客服电话以及办公地址等信息一应俱全，用户很难辨别其真伪。而用户一旦打开该文档，文档内的恶意代码将会自动执行，并通过Office漏洞(CVE-2017-11882)下载后门病毒“TrickBot”。以下为受影响版本：</span></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><img class="" data-copyright="0" data-ratio="0.4418604651162791" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4SwlPIftFh3OEf8mvx8OX9wH0d3icEND9Fw20YicyqdWLHCiafbO1xMltssfDaV83tW0IyRaFf1tu5g/640?wx_fmt=png" data-type="png" data-w="344" style="width: 296px;height: 131px;"></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">病毒“TrickBot”入侵用户电脑后，会盗取其银行账户以及比特币交易平台登录信息。同时还会收集用户计算机内的数据信息，包括系统版本，CPU情况，内存，用户名，系统中的服务项，软件安装情况等。不仅如此，病毒团伙可随时通过远程操控更改病毒代码，进行其他破坏行为。例如：植入挖矿病毒、勒索病毒等。</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">火绒工程师通过技术分析，发现“TrickBot”早在2016年就已经出现，此次火绒安全团队拦截到的为其变种版本。虽然该病毒的新变种层出不穷，但其主要目标都是盗取用户银行账号、密码等信息，攫取钱财。</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">“火绒安全软件”最新版即可查杀后门病毒“TrickBot”，建议近期收到过类似邮件的用户尽快进行排查。此外，目前Microsoft Office已经修复该漏洞，建议用户安装最新补丁，以免遭受不必要的损失。 </span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 16px;"><strong>二、<span style="white-space: pre;">	</span>详细分析</strong></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">近期，火绒截获到一批病毒样本，会利用垃圾邮件配合漏洞文档的形式传播TrickBot病毒。邮件内容将自己伪装成汇丰银行的通知邮件，从而诱骗受害者打开附件中存放的漏洞文档（CVE-2017-11882），文档内容同样将自己伪装成汇丰银行通知内容。漏洞被触发后，病毒会通过访问C&amp;C服务器下载执行TrickBot病毒，TrickBot病毒执行会请求远程的恶意功能模块到本地执行，病毒模块功能包括：盗取用户银行账号信息、收集用户本地操作系统信息、软件安装情况等。病毒传播与执行恶意行为流程图，如下图所示：</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"></span></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><img class="" data-copyright="0" data-ratio="0.8056737588652483" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4SwlPIftFh3OEf8mvx8OX9m2OHH5USJ7RmXUPp7ial3QSWic7lSmnSE9uNeybVK2ickI3IBtNqAbdHA/640?wx_fmt=png" data-type="png" data-w="705" style=""></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"></span></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">病毒传播与执行恶意行为流程图</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">伪造的邮件及文档内容，如下图所示：</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"> </span></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><img class="" data-copyright="0" data-ratio="0.689601250977326" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4SwlPIftFh3OEf8mvx8OX9OUm33uWPUxSpfHc1TCsVdcp13TkDKBSynGISrpWRHnxbx28qe8fK5Q/640?wx_fmt=png" data-type="png" data-w="1279" style=""></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">邮件及文档内容</span><br><span style="font-size: 15px;"></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">文档中所包含的CVE-2017-11882漏洞被触发后，会执行PowerShell脚本从C&amp;C服务器（hxxp:// ccmlongueuil.ca、hxxp://guardtrack.uk）下载执行远程恶意代码。PowerShell代码，如下图所示：</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"></span></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><img class="" data-copyright="0" data-ratio="0.2588757396449704" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4SwlPIftFh3OEf8mvx8OX9DQSND4tDS3y8JFqZdia9MtD59Hiazmnu4A2NgL61IIdFyj8hCwnE5SsQ/640?wx_fmt=png" data-type="png" data-w="676" style=""></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">PowerShell代码内容</span><br><span style="font-size: 15px;"></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">如上图，PowerShell代码执行后会将TrickBot病毒下载至 “%TMP%\bumsiery.exe”位置后进行执行。漏洞触发后的进程关系情况，如下图所示：</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"> </span></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><img class="" data-copyright="0" data-ratio="0.25113739763421294" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4SwlPIftFh3OEf8mvx8OX9Oa3lucZLUZAAKwjBF6zGW6U5Rf7uUEmEIWiabM8NJprpeabPsqzfztQ/640?wx_fmt=png" data-type="png" data-w="1099" style=""></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">进程关系</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">为了对抗安全软件查杀，病毒被混淆器进行了混淆。在混淆器代码通过创建窗体、发送窗体消息的方式对抗虚拟机引擎，在窗体消息处理函数中创建Timer，当Timer消息连续被响应360次后才能触发最终的混淆器解密代码。相关代码，如下图所示：</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"> </span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"></span></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><img class="" data-copyright="0" data-ratio="0.6642105263157895" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4SwlPIftFh3OEf8mvx8OX9kHQCqq5CiabsknGDibRMYMue3oPbIyIHiaA7tReK2cKIFyoY7CQ5QLXibQ/640?wx_fmt=png" data-type="png" data-w="950" style=""></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">混淆器代码</span><br><span style="font-size: 15px;"></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">病毒所使用的字符串数据均被进行过加密处理，在病毒代码使用相关的字符串资源时，会通过解密函数进行临时解密。解密后的数据被存放在栈中，使病毒分析人员很难通过查看进程内存镜像的方法找到与病毒功能相关的数据信息，从而加大对病毒的分析和逆向复杂度。除此之外，病毒所调用的所有系统API全部通过病毒获取的函数地址表进行调用，从而用上述手段对抗安全厂商的分析与查杀。字符串数据解密前后示例，如下图所示：</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><img class="" data-copyright="0" data-ratio="0.9151898734177215" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4SwlPIftFh3OEf8mvx8OX9YjkhzLMFCZxDm0NVqcKIe0krWmg7rgrmckoyCgODFBLkdicxfNRjH6w/640?wx_fmt=png" data-type="png" data-w="790" style=""></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">字符串数据</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">获取API函数地址表相关代码，如下图所示：</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"> </span></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><img class="" data-copyright="0" data-ratio="1.058679706601467" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4SwlPIftFh3OEf8mvx8OX93sEyuloiaeDicJLtJNoppaNK4nDy6tnbRTXRwj1tPNTBEAqXrgSOpADQ/640?wx_fmt=png" data-type="png" data-w="818" style=""></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">获取API函数表</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">病毒执行后，首先会创建计划任务创建启动项，且每隔3分钟就会重复执行一次。如下图所示：</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"> </span></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><img class="" data-copyright="0" data-ratio="0.3366228070175439" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4SwlPIftFh3OEf8mvx8OX9iahsElP6W6iaaoRicV5xQcto7icXXLeEsPDTck3TOKRPKsmRxX5VaPnHSQ/640?wx_fmt=png" data-type="png" data-w="912" style=""></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">计划任务</span><br><span style="font-size: 15px;"></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">在主要病毒代码逻辑执行后，病毒会使用多种不同的命令编号与C&amp;C服务器进行通信，从而获取不同的远端数据（包含病毒模块数据及相关配置数据），并将本地计算机信息和病毒运行状态上传到服务器。主要命令编号及作用，如下图所示：</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"> </span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"></span></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><img class="" data-copyright="0" data-ratio="0.44353518821603927" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4SwlPIftFh3OEf8mvx8OX9hYTul1Br0lD39uz8VmTGVJ1oibicBoOFsCrVFKS8Nfz30NGMLNHb7LhQ/640?wx_fmt=png" data-type="png" data-w="611" style=""></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">主要命令编号与对应功能描述</span><br><span style="font-size: 15px;"></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">C&amp;C服务器返回的数据均被使用AES-256算法进行加密过，数据在受害计算机中也以加密形式进行存放，解密密钥也被存放在回传数据中。从C&amp;C服务器请求到的数据文件及功能描述，如下图所示：</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"> </span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"></span></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><img class="" data-copyright="0" data-ratio="0.44353518821603927" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4SwlPIftFh3OEf8mvx8OX9GOLbUiaJCcmBfN5LR9n2g0qNn3o7dTRux3LMDvvnQRTCicCTmKIqGYQg/640?wx_fmt=png" data-type="png" data-w="611" style=""></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">数据文件及功能描述</span><br><span style="font-size: 15px;"></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">TrickBot病毒具有很强的可扩展性，病毒作者可以随意通过修改C&amp;C服务器返回数据的方式增减病毒模块，执行任意攻击逻辑。病毒在请求到模块数据后，会根据远程返回的配置文件调用不同导出函数执行恶意代码，TrickBot病毒的病毒模块通常的导出函数共有4个，如下图所示：</span></p><p style="text-align: justify;"><br></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><img class="" data-copyright="0" data-ratio="1.123931623931624" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4SwlPIftFh3OEf8mvx8OX9ibcq2p7Hvy3Ra3BqGGLYicBJn9gx67ZYPVicaHkZ7cdyCyceBzgpckLyw/640?wx_fmt=png" data-type="png" data-w="468" style=""></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">病毒模块导出函数</span><br><span style="font-size: 15px;"></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">我们现在可以请求到的功能模块共有两个injectdll和systeminfo，injectdll模块主要用于盗取用户账号，systeminfo模块则用来收集受害者计算机中的系统信息，下文中将按照病毒模块进行逐一说明。用于请求功能模块的远程配置信息，如下图所示：</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"> </span></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><img class="" data-copyright="0" data-ratio="1.6374269005847952" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4SwlPIftFh3OEf8mvx8OX9CxKKObIeqsYAFplvjHnicGSubOqsToeLFzGP2kACZK26uKrXVHtGYeg/640?wx_fmt=png" data-type="png" data-w="342" style=""></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">用于请求功能模块的远程配置信息</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><strong><span style="font-size: 15px;">Injectdll</span></strong></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">该病毒模块首先会被注入到svchost进程进行执行，当通过遍历查找浏览器进程进行远程注入盗取用户账户信息，该病毒只针对IE、Chrome和FireFox进行盗取。通过对病毒配置信息的筛查，我们发现病毒窃取账户范围非常之广，共包含银行站点、比特币交易平台271个。配置中所涉及的个别站点示例，如下图所示：</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"> </span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"></span></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><img class="" data-copyright="0" data-ratio="0.7669902912621359" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4SwlPIftFh3OEf8mvx8OX9aezvLsEMlSzQP0Yoe2dzLQKqeAQgKsia5ZeJia9WnaaibqdLPjiakJf4Fw/640?wx_fmt=png" data-type="png" data-w="412" style=""></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">站点示例</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">病毒在检测到浏览器进行后会对浏览器进行注入，Hook浏览器进程中的网络请求函数，根据病毒配置规则过滤发送向指定网址的数据。浏览器进程被Hook情况，如下图所示：</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"> </span></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><img class="" data-copyright="0" data-ratio="0.6559888579387186" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4SwlPIftFh3OEf8mvx8OX9ch11DewSKKiaeplBMFicRAOiblDYXPfzmJMTWwz1vhTClbvJeBZrLmxdg/640?wx_fmt=png" data-type="png" data-w="1436" style=""></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">浏览器进程被Hook情况</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">盗取账号相关配置信息分别存放在sinj、dinj和dpost中。 sinj解密后配置内容示例，如下图所示：</span></p><p style="margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;text-align: justify;"> </span><br></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><img class="" data-copyright="0" data-ratio="1.7599164926931106" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4SwlPIftFh3OEf8mvx8OX9V88e78Z79q9JMzVX8nn4tKeiaxJF7ICKs8NyqczUicnEDwUDOgia0Qbeg/640?wx_fmt=png" data-type="png" data-w="479" style=""></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">sinj配置示例</span><br><span style="font-size: 15px;"></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"> dinj解密后配置内容示例，如下图所示：</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"> </span></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><img class="" data-copyright="0" data-ratio="1.2546296296296295" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4SwlPIftFh3OEf8mvx8OX9jLFI0M7D5g0WhHZerzYgeNndslZTpLVianxjWbbPm37vaBlNKNWaDeg/640?wx_fmt=png" data-type="png" data-w="648" style=""></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">dinj配置示例</span><br><span style="font-size: 15px;"></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"> dpost解密后配置内容，如下图所示：</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"> </span></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><img class="" data-copyright="0" data-ratio="0.3806646525679758" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4SwlPIftFh3OEf8mvx8OX9lVA4p65xSq44zQclsDtF7FP8GwW9Whpics5ExsPHNs8tGGFrl5A07DA/640?wx_fmt=png" data-type="png" data-w="331" style=""></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">dpost配置内容</span><br><span style="font-size: 15px;"></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><strong><span style="font-size: 15px;">Systeminfo</span></strong></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">systeminfo模块主要用来获取受害者的计算机信息，主要会收集用户系统版本、CPU信息、内存大小信息，系统服务信息，软件安装信息等，收集到的信息最终会拼接成xml文件。收集本地信息代码，如下图所示：</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"> </span></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><img class="" data-copyright="0" data-ratio="0.798581560283688" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4SwlPIftFh3OEf8mvx8OX9IrMs51GaFVohtA34hQwQEBhepxK8jG9IU7r1UibfibnqrsXuziccSnJxA/640?wx_fmt=png" data-type="png" data-w="1410" style=""></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">获取本地系统信息主要逻辑</span><br><span style="font-size: 15px;"></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">利用WMI查询本地系统版本信息，如下图所示：</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"> </span></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><img class="" data-copyright="0" data-ratio="1.5589941972920696" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4SwlPIftFh3OEf8mvx8OX9e3wns6DbNra5JDgsMpNGoX3qQPw7N1BibhetIGsxr1n822mRztwrcpg/640?wx_fmt=png" data-type="png" data-w="1034" style=""></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">通过WMI查询系统信息</span><br><span style="font-size: 15px;"></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">通过遍历注册表的方式获取当前系统中的软件安装信息，如下图所示：</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"> </span></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><img class="" data-copyright="0" data-ratio="0.8503611971104231" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4SwlPIftFh3OEf8mvx8OX91tmGBlAYnHAlygVZIQptD1YTp7dFyANUs040nAt5icIjX5LUVIBiaFVg/640?wx_fmt=png" data-type="png" data-w="969" style=""></p><p style="text-align: center;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">收集软件安装信息</span><br><span style="font-size: 15px;"></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"> </span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 16px;"><strong>三、<span style="white-space: pre;">	</span>附录</strong></span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;">文中涉及样本SHA256：</span></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"> </span></p><p style="margin-bottom: 5px;line-height: 1.5em;"><img class="" data-copyright="0" data-ratio="0.1352405721716515" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4SwlPIftFh3OEf8mvx8OX9YrljSJyVHKicqGZLbGMRQTxiaSsTI2gYA6WctIFxWGMnC3lfa8dmiaxPA/640?wx_fmt=png" data-type="png" data-w="769" style=""></p><p style="text-align: justify;margin-bottom: 5px;line-height: 1.5em;"><span style="font-size: 15px;"></span><br></p><p><br></p>
                </div>
                <script nonce="26841196" type="text/javascript">
                    var first_sceen__time = (+new Date());

                    if ("" == 1 && document.getElementById('js_content')) {
                        document.getElementById('js_content').addEventListener("selectstart",function(e){ e.preventDefault(); });
                    }

                    
                    (function(){
                        if (navigator.userAgent.indexOf("WindowsWechat") != -1){
                            var link = document.createElement('link');
                            var head = document.getElementsByTagName('head')[0];
                            link.rel = 'stylesheet';
                            link.type = 'text/css';
                            link.href = "//res.wx.qq.com/mmbizwap/zh_CN/htmledition/style/page/appmsg/page_mp_article_improve_winwx3d171e.css";
                            head.appendChild(link);
                        }
                    })();
                </script>
                
                
                                
                <div class="ct_mpda_wrp" id="js_sponsor_ad_area" style="display:none;"></div>

                
                                <div class="reward_area tc" id="js_preview_reward" style="display:none;">
                    <p id="js_preview_reward_wording" class="tips_global reward_tips" style="display:none;"></p>
                    <p>
                        <a class="reward_access" id="js_preview_reward_link" href="##"><span class="icon-reward"></span>赞赏</a>

                    </p>
                </div>
                <div class="reward_qrcode_area reward_area tc" id="js_preview_reward_qrcode" style="display:none;">
                    <p class="tips_global">长按二维码向我转账</p>
                    <p id="js_preview_reward_ios_wording" class="reward_tips" style="display:none;"></p>
                    <span class="reward_qrcode_img_wrp"><img class="reward_qrcode_img" src="//res.wx.qq.com/mmbizwap/zh_CN/htmledition/images/pic/appmsg/pic_reward_qrcode.2x3534dd.png"></span>
                    <p class="tips_global">受苹果公司新规定影响，微信 iOS 版的赞赏功能被关闭，可通过二维码转账支持公众号。</p>
                </div>
                            </div><ul id="js_hotspot_area" class="article_extend_area"></ul><div class="rich_media_tool" id="js_toobar3">
                
                                
                                            <div id="js_read_area3" class="media_tool_meta tips_global meta_primary" style="display:none;">阅读 <span id="readNum3"></span></div>

                <span style="display:none;" class="media_tool_meta meta_primary tips_global meta_praise" id="like3">
                    <i class="icon_praise_gray"></i><span class="praise_num" id="likeNum3"></span>
                </span>

                <a id="js_report_article3" style="display:none;" class="media_tool_meta tips_global meta_extra" href="##">投诉</a>

            </div><div class="rich_media_tool" id="js_sg_bar">
                
                                
                                
            </div>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
