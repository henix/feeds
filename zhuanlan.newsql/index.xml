<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:media="http://search.yahoo.com/mrss/">
<channel>
<title>TiDB çš„åèŠ±å›­</title>
<link>https://henix.github.io/feeds/zhuanlan.newsql/</link>
<description></description>
<language>zh-cn</language>
<lastBuildDate>Wed, 19 Dec 2018 18:02:23 +0800</lastBuildDate>
<item>
<title>TiDB Ecosystem Tools åŸç†è§£è¯»ä¹‹ TiDB-Lightning Toolset</title>
<link>https://henix.github.io/feeds/zhuanlan.newsql/2018-12-18-52699499.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/52699499&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-8b0bba75055cd143356e76a82064b113_r.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;ç®€ä»‹&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;TiDB-Lightning Toolset æ˜¯ä¸€å¥—å¿«é€Ÿå…¨é‡å¯¼å…¥ SQL dump æ–‡ä»¶åˆ° TiDB é›†ç¾¤çš„å·¥å…·é›†ï¼Œè‡ª 2.1.0 ç‰ˆæœ¬èµ·éš TiDB å‘å¸ƒï¼Œé€Ÿåº¦å¯è¾¾åˆ°ä¼ ç»Ÿæ‰§è¡Œ SQL å¯¼å…¥æ–¹å¼çš„è‡³å°‘ 3 å€ã€å¤§çº¦æ¯å°æ—¶ 100 GBï¼Œé€‚åˆåœ¨ä¸Šçº¿å‰ç”¨ä½œè¿ç§»ç°æœ‰çš„å¤§å‹æ•°æ®åº“åˆ°å…¨æ–°çš„ TiDB é›†ç¾¤ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;è®¾è®¡&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;TiDB ä» 2017 å¹´å¼€å§‹æä¾›å…¨é‡å¯¼å…¥å·¥å…· &lt;a href=&quot;https://pingcap.com/docs-cn/tools/loader/&quot;&gt;Loader&lt;/a&gt;ï¼Œå®ƒä»¥å¤šçº¿ç¨‹æ“ä½œã€é”™è¯¯é‡è¯•ã€æ–­ç‚¹ç»­ä¼ ä»¥åŠä¿®æ”¹ä¸€äº› TiDB ä¸“å±é…ç½®æ¥æå‡æ•°æ®å¯¼å…¥é€Ÿåº¦ã€‚&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-23ac26045113e913212b950ab743d557_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;835&quot; data-rawheight=&quot;458&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-23ac26045113e913212b950ab743d557&quot; data-watermark-src=&quot;v2-9abe9f1df7771b4219e03c60f6924dad&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;ç„¶è€Œï¼Œå½“æˆ‘ä»¬å…¨æ–°åˆå§‹åŒ–ä¸€ä¸ª TiDB é›†ç¾¤æ—¶ï¼ŒLoader è¿™ç§é€æ¡ INSERT æŒ‡ä»¤åœ¨çº¿ä¸Šæ‰§è¡Œçš„æ–¹å¼ä»æ ¹æœ¬ä¸Šæ˜¯æ— æ³•å°½ç”¨æ€§èƒ½çš„ã€‚åŸå› åœ¨äº SQL å±‚çš„æ“ä½œæœ‰å¤ªå¼ºçš„ä¿è¯äº†ã€‚åœ¨æ•´ä¸ªå¯¼å…¥è¿‡ç¨‹ä¸­ï¼ŒTiDB éœ€è¦ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;ä¿è¯ ACID ç‰¹æ€§ï¼Œéœ€è¦æ‰§è¡Œå®Œæ•´çš„äº‹åŠ¡æµç¨‹ã€‚&lt;/li&gt;&lt;li&gt;ä¿è¯å„ä¸ª TiKV æœåŠ¡å™¨æ•°æ®é‡å¹³è¡¡åŠæœ‰è¶³å¤Ÿçš„å‰¯æœ¬ï¼Œåœ¨æ•°æ®å¢é•¿çš„æ—¶å€™éœ€è¦ä¸æ–­çš„åˆ†è£‚ã€è°ƒåº¦ Regionsã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;è¿™äº›åŠ¨ä½œç¡®ä¿ TiDB æ•´æ®µå¯¼å…¥çš„æœŸé—´æ˜¯ç¨³å®šçš„ï¼Œä½†åœ¨å¯¼å…¥å®Œæ¯•å‰æˆ‘ä»¬æ ¹æœ¬ä¸ä¼šå¯¹å¤–æä¾›æœåŠ¡ï¼Œè¿™äº›ä¿è¯å°±å˜æˆå¤šæ­¤ä¸€ä¸¾äº†ã€‚æ­¤å¤–ï¼Œå¤šçº¿ç¨‹çš„çº¿ä¸Šå¯¼å…¥ä¹Ÿä»£è¡¨èµ„æ–™æ˜¯ä¹±åºæ’å…¥çš„ï¼Œæ–°çš„æ•°æ®èŒƒå›´ä¼šä¸æ—§çš„é‡å ã€‚TiKV è¦æ±‚å‚¨å­˜çš„æ•°æ®æ˜¯æœ‰åºçš„ï¼Œå¤§é‡çš„ä¹±åºå†™å…¥ä¼šä»¤ TiKV è¦ä¸æ–­åœ°ç§»åŠ¨åŸæœ‰çš„æ•°æ®ï¼ˆè¿™ç§°ä¸º Compactionï¼‰ï¼Œè¿™ä¹Ÿä¼šæ‹–æ…¢å†™å…¥è¿‡ç¨‹ã€‚&lt;/p&gt;&lt;p&gt;TiKV æ˜¯ä½¿ç”¨ RocksDB ä»¥ KV å¯¹çš„å½¢å¼å‚¨å­˜æ•°æ®ï¼Œè¿™äº›æ•°æ®ä¼šå‹ç¼©æˆä¸€ä¸ªä¸ª SST æ ¼å¼æ–‡ä»¶ã€‚TiDB-Lightning Toolsetä½¿ç”¨æ–°çš„æ€è·¯ï¼Œç»•è¿‡SQLå±‚ï¼Œåœ¨çº¿ä¸‹å°†æ•´ä¸ª SQL dump è½¬åŒ–ä¸º KV å¯¹ã€ç”Ÿæˆæ’å¥½åºçš„ SST æ–‡ä»¶ï¼Œç„¶åç›´æ¥ç”¨ &lt;a href=&quot;https://github.com/facebook/rocksdb/wiki/Creating-and-Ingesting-SST-files&quot;&gt;Ingestion&lt;/a&gt; æ¨é€åˆ° RocksDB é‡Œé¢ã€‚è¿™æ ·æ‰¹é‡å¤„ç†çš„æ–¹æ³•ç•¥è¿‡ ACID å’Œçº¿ä¸Šæ’åºç­‰è€—æ—¶æ­¥éª¤ï¼Œè®©æˆ‘ä»¬æå‡æœ€ç»ˆçš„é€Ÿåº¦ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;æ¶æ„&lt;/b&gt;&lt;/h2&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-55cd8f3a33a4f958cd86d036b5a39dde_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;854&quot; data-rawheight=&quot;625&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-55cd8f3a33a4f958cd86d036b5a39dde&quot; data-watermark-src=&quot;v2-53068d757bfdd30eea0a8589478bf276&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;TiDB-Lightning Toolset åŒ…å«ä¸¤ä¸ªç»„ä»¶ï¼štidb-lightning å’Œ tikv-importerã€‚Lightning è´Ÿè´£è§£æ SQL æˆä¸º KV å¯¹ï¼Œè€Œ Importer è´Ÿè´£å°† KV å¯¹æ’åºä¸è°ƒåº¦ã€ä¸Šä¼ åˆ° TiKV æœåŠ¡å™¨ã€‚&lt;/p&gt;&lt;p&gt;ä¸ºä»€ä¹ˆè¦æŠŠä¸€ä¸ªæµç¨‹æ‹†åˆ†æˆä¸¤ä¸ªç¨‹å¼å‘¢ï¼Ÿ&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Importer ä¸ TiKV å¯†ä¸å¯åˆ†ã€Lightning ä¸ TiDB å¯†ä¸å¯åˆ†ï¼ŒToolset çš„ä¸¤è€…çš†å¼•ç”¨åè€…ä¸ºåº“ï¼Œè€Œè¿™æ · Lightning ä¸ Importer ä¹‹é—´å°±å‡ºç°è¯­è¨€å†²çªï¼šTiKV æ˜¯ä½¿ç”¨ Rust è€Œ TiDB æ˜¯ä½¿ç”¨ Go çš„ã€‚æŠŠå®ƒä»¬æ‹†åˆ†ä¸ºç‹¬ç«‹çš„ç¨‹å¼æ›´æ–¹ä¾¿å¼€å‘ï¼Œè€ŒåŒæ–¹éƒ½éœ€è¦çš„ KV å¯¹å¯ä»¥é€è¿‡ gRPC ä¼ é€’ã€‚&lt;/li&gt;&lt;li&gt;åˆ†å¼€ Importer å’Œ Lightning ä¹Ÿä½¿æ¨ªå‘æ‰©å±•çš„æ–¹å¼æ›´ä¸ºçµæ´»ï¼Œä¾‹å¦‚å¯ä»¥è¿è¡Œå¤šä¸ª Lightningï¼Œä¼ é€ç»™åŒä¸€ä¸ª Importerã€‚&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;ä»¥ä¸‹æˆ‘ä»¬ä¼šè¯¦ç»†åˆ†ææ¯ä¸ªç»„ä»¶çš„æ“ä½œåŸç†ã€‚&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;Lightning&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-9844bda340c571347842d5bd1c945fbf_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;343&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-9844bda340c571347842d5bd1c945fbf&quot; data-watermark-src=&quot;v2-a8e7de501a49d2f57fb1e6ce50ecd95c&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;Lightning ç°æ—¶åªæ”¯æŒç» mydumper å¯¼å‡ºçš„ SQL å¤‡ä»½ã€‚mydumper å°†æ¯ä¸ªè¡¨çš„å†…å®¹åˆ†åˆ«å‚¨å­˜åˆ°ä¸åŒçš„æ–‡ä»¶ï¼Œä¸ mysqldump ä¸åŒã€‚è¿™æ ·ä¸ç”¨è§£ææ•´ä¸ªæ•°æ®åº“å°±èƒ½å¹³è¡Œå¤„ç†æ¯ä¸ªè¡¨ã€‚&lt;/p&gt;&lt;p&gt;é¦–å…ˆï¼ŒLightning ä¼šæ‰«æ SQL å¤‡ä»½ï¼ŒåŒºåˆ†å‡ºç»“æ„æ–‡ä»¶ï¼ˆåŒ…å« CREATE TABLE è¯­å¥ï¼‰å’Œæ•°æ®æ–‡ä»¶ï¼ˆåŒ…å« INSERT è¯­å¥ï¼‰ã€‚ç»“æ„æ–‡ä»¶çš„å†…å®¹ä¼šç›´æ¥å‘é€åˆ° TiDBï¼Œç”¨ä»¥å»ºç«‹æ•°æ®åº“æ„å‹ã€‚&lt;/p&gt;&lt;p&gt;ç„¶å Lightning å°±ä¼šå¹¶å‘å¤„ç†æ¯ä¸€å¼ è¡¨çš„æ•°æ®ã€‚è¿™é‡Œæˆ‘ä»¬åªé›†ä¸­çœ‹ä¸€å¼ è¡¨çš„æµç¨‹ã€‚æ¯ä¸ªæ•°æ®æ–‡ä»¶çš„å†…å®¹éƒ½æ˜¯è§„å¾‹çš„ INSERT è¯­å¥ï¼Œåƒæ˜¯ï¼š&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;INSERT INTO `tbl` VALUES (1, 2, 3), (4, 5, 6), (7, 8, 9);  
INSERT INTO `tbl` VALUES (10, 11, 12), (13, 14, 15), (16, 17, 18);
INSERT INTO `tbl` VALUES (19, 20, 21), (22, 23, 24), (25, 26, 27);&lt;/code&gt;&lt;p&gt;Lightning ä¼šä½œåˆæ­¥åˆ†æï¼Œæ‰¾å‡ºæ¯è¡Œåœ¨æ–‡ä»¶çš„ä½ç½®å¹¶åˆ†é…ä¸€ä¸ªè¡Œå·ï¼Œä½¿å¾—æ²¡æœ‰ä¸»é”®çš„è¡¨å¯ä»¥å”¯ä¸€çš„åŒºåˆ†æ¯ä¸€è¡Œã€‚æ­¤å¤–äº¦åŒæ—¶å°†æ–‡ä»¶åˆ†å‰²ä¸ºå¤§å°å·®ä¸å¤šçš„åŒºå—ï¼ˆé»˜è®¤ 256 MiBï¼‰ã€‚è¿™äº›åŒºå—ä¹Ÿä¼šå¹¶å‘å¤„ç†ï¼Œè®©æ•°æ®é‡å¤§çš„è¡¨ä¹Ÿèƒ½å¿«é€Ÿå¯¼å…¥ã€‚ä»¥ä¸‹çš„ä¾‹å­æŠŠæ–‡ä»¶ä»¥ 20 å­—èŠ‚ä¸ºé™åˆ†å‰²æˆ 5 å—ï¼š&lt;/p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-f671b93f00f67d5a0b3451d8694d7638_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1068&quot; data-rawheight=&quot;180&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-f671b93f00f67d5a0b3451d8694d7638&quot; data-watermark-src=&quot;v2-d8e0c081f70d453289ba24500fd83d70&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;Lightning ä¼šç›´æ¥ä½¿ç”¨ TiDB å®ä¾‹æ¥æŠŠ SQL è½¬æ¢ä¸º KV å¯¹ï¼Œç§°ä¸ºã€ŒKV ç¼–ç å™¨ã€ã€‚ä¸å¤–éƒ¨çš„ TiDB é›†ç¾¤ä¸åŒï¼ŒKV ç¼–ç å™¨æ˜¯å¯„å­˜åœ¨ Lightning è¿›ç¨‹å†…çš„ï¼Œè€Œä¸”ä½¿ç”¨å†…å­˜å­˜å‚¨ï¼Œæ‰€ä»¥æ¯æ‰§è¡Œå®Œä¸€ä¸ª INSERT ä¹‹åï¼ŒLightning å¯ä»¥ç›´æ¥è¯»å–å†…å­˜è·å–è½¬æ¢åçš„ KV å¯¹ï¼ˆè¿™äº› KV å¯¹åŒ…å«æ•°æ®åŠç´¢å¼•ï¼‰ã€‚&lt;/p&gt;&lt;p&gt;å¾—åˆ° KV å¯¹ä¹‹åä¾¿å¯ä»¥å‘é€åˆ° Importerã€‚&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;Importer&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-777753c0442df7718aa158c3333fb52e_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;397&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-777753c0442df7718aa158c3333fb52e&quot; data-watermark-src=&quot;v2-8b1fb35fcb9de6b81fec9a8d35b28afe&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;å› å¼‚æ­¥æ“ä½œçš„ç¼˜æ•…ï¼ŒImporter å¾—åˆ°çš„åŸå§‹ KV å¯¹æ³¨å®šæ˜¯æ— åºçš„ã€‚æ‰€ä»¥ï¼ŒImporter è¦åšçš„ç¬¬ä¸€ä»¶äº‹å°±æ˜¯è¦æ’åºã€‚è¿™éœ€è¦ç»™æ¯ä¸ªè¡¨åˆ’å®šå‡†å¤‡æ’åºçš„å‚¨å­˜ç©ºé—´ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º engine fileã€‚&lt;/p&gt;&lt;p&gt;å¯¹å¤§æ•°æ®æ’åºæ˜¯ä¸ªè§£å†³äº†å¾ˆå¤šéçš„é—®é¢˜ï¼Œæˆ‘ä»¬åœ¨æ­¤ä½¿ç”¨ç°æœ‰çš„ç­”æ¡ˆï¼šç›´æ¥ä½¿ç”¨ RocksDBã€‚ä¸€ä¸ª engine file å°±ç›¸ç­‰äºæœ¬åœ°çš„ RocksDBï¼Œå¹¶è®¾ç½®ä¸ºä¼˜åŒ–å¤§é‡å†™å…¥æ“ä½œã€‚è€Œã€Œæ’åºã€å°±ç›¸ç­‰äºå°† KV å¯¹å…¨å†™å…¥åˆ° engine file é‡Œï¼ŒRocksDB å°±ä¼šå¸®æˆ‘ä»¬åˆå¹¶ã€æ’åºï¼Œå¹¶å¾—åˆ° SST æ ¼å¼çš„æ–‡ä»¶ã€‚&lt;/p&gt;&lt;p&gt;è¿™ä¸ª SST æ–‡ä»¶åŒ…å«æ•´ä¸ªè¡¨çš„æ•°æ®å’Œç´¢å¼•ï¼Œæ¯”èµ· TiKV çš„å‚¨å­˜å•ä½ Regions å®åœ¨å¤ªå¤§äº†ã€‚æ‰€ä»¥æ¥ä¸‹æ¥å°±æ˜¯è¦åˆ‡åˆ†æˆåˆé€‚çš„å¤§å°ï¼ˆé»˜è®¤ä¸º 96 MiBï¼‰ã€‚Importer ä¼šæ ¹æ®è¦å¯¼å…¥çš„æ•°æ®èŒƒå›´é¢„å…ˆæŠŠ Region åˆ†è£‚å¥½ï¼Œç„¶åè®© PD æŠŠè¿™äº›åˆ†è£‚å‡ºæ¥çš„ Region åˆ†æ•£è°ƒåº¦åˆ°ä¸åŒçš„ TiKV å®ä¾‹ä¸Šã€‚&lt;/p&gt;&lt;p&gt;æœ€åï¼ŒImporter å°† SST ä¸Šä¼ åˆ°å¯¹åº” Region çš„æ¯ä¸ªå‰¯æœ¬ä¸Šã€‚ç„¶åé€šè¿‡ Leader å‘èµ· Ingest å‘½ä»¤ï¼ŒæŠŠè¿™ä¸ª SST æ–‡ä»¶å¯¼å…¥åˆ° Raft group é‡Œï¼Œå®Œæˆä¸€ä¸ª Region çš„å¯¼å…¥è¿‡ç¨‹ã€‚&lt;/p&gt;&lt;p&gt;æˆ‘ä»¬ä¼ è¾“å¤§é‡æ•°æ®æ—¶ï¼Œéœ€è¦è‡ªåŠ¨æ£€æŸ¥æ•°æ®å®Œæ•´ï¼Œé¿å…å¿½ç•¥æ‰é”™è¯¯ã€‚Lightning ä¼šåœ¨æ•´ä¸ªè¡¨çš„ Region å…¨éƒ¨å¯¼å…¥åï¼Œå¯¹æ¯”ä¼ é€åˆ° Importer ä¹‹å‰è¿™ä¸ªè¡¨çš„ Checksumï¼Œä»¥åŠåœ¨ TiKV é›†ç¾¤é‡Œé¢æ—¶çš„ Checksumã€‚å¦‚æœä¸¤è€…ä¸€æ ·ï¼Œæˆ‘ä»¬å°±æœ‰ä¿¡å¿ƒè¯´è¿™ä¸ªè¡¨çš„æ•°æ®æ²¡æœ‰é—®é¢˜ã€‚&lt;/p&gt;&lt;p&gt;ä¸€ä¸ªè¡¨çš„ Checksum æ˜¯é€è¿‡è®¡ç®— KV å¯¹çš„å“ˆå¸Œå€¼ï¼ˆHashï¼‰äº§ç”Ÿçš„ã€‚å› ä¸º KV å¯¹åˆ†å¸ƒåœ¨ä¸åŒçš„ TiKV å®ä¾‹ä¸Šï¼Œè¿™ä¸ª Checksum å‡½æ•°åº”è¯¥å…·å¤‡ç»“åˆæ€§ï¼›å¦å¤–ï¼ŒLightning ä¼ é€ KV å¯¹ä¹‹å‰å®ƒä»¬æ˜¯æ— åºçš„ï¼Œæ‰€ä»¥ Checksum ä¹Ÿä¸åº”è¯¥è€ƒè™‘é¡ºåºï¼Œå³æœä»äº¤æ¢å¾‹ã€‚ä¹Ÿå°±æ˜¯è¯´ Checksum ä¸æ˜¯ç®€å•çš„æŠŠæ•´ä¸ª SST æ–‡ä»¶è®¡ç®— SHA-256 è¿™æ ·å°±äº†äº‹ã€‚&lt;/p&gt;&lt;p&gt;æˆ‘ä»¬çš„è§£å†³åŠæ³•æ˜¯è¿™æ ·çš„ï¼šå…ˆè®¡ç®—æ¯ä¸ª KV å¯¹çš„ CRC64ï¼Œç„¶åç”¨ XOR ç»“åˆåœ¨ä¸€èµ·ï¼Œå¾—å‡ºä¸€ä¸ª 64 ä½å…ƒçš„æ ¡éªŒæ•°å­—ã€‚ä¸ºå‡ä½ Checksum å€¼å†²çªçš„æ¦‚ç‡ï¼Œæˆ‘ä»¬ç›®æ—¶ä¼šè®¡ç®— KV å¯¹çš„æ•°é‡å’Œå¤§å°ã€‚è‹¥é€Ÿåº¦å…è®¸ï¼Œå°†æ¥ä¼šåŠ å…¥æ›´å…ˆè¿›çš„ Checksum æ–¹å¼ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;æ€»ç»“å’Œä¸‹ä¸€æ­¥è®¡åˆ’&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;ä»è¿™ç¯‡æ–‡ç« å¤§å®¶å¯ä»¥çœ‹åˆ°ï¼ŒLightning å› ä¸ºè·³è¿‡äº†ä¸€äº›å¤æ‚ã€è€—æ—¶çš„æ­¥éª¤ä½¿å¾—æ•´ä¸ªå¯¼å…¥è¿›ç¨‹æ›´å¿«ï¼Œé€‚åˆå¤§æ•°æ®é‡çš„åˆæ¬¡å¯¼å…¥ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬è¿˜ä¼šåšè¿›ä¸€æ­¥çš„æ”¹è¿›ã€‚&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;æå‡å¯¼å…¥é€Ÿåº¦&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;ç°æ—¶ Lightning ä¼šåŸå°ä¸åŠ¨æŠŠæ•´æ¡ SQL å‘½ä»¤æŠ›ç»™ KV ç¼–ç å™¨ã€‚æ‰€ä»¥å³ä½¿æˆ‘ä»¬çœå»æ‰§è¡Œåˆ†å¸ƒå¼ SQL çš„å¼€é”€ï¼Œä½†ä»éœ€è¦è¿›è¡Œè§£æã€è§„åˆ’åŠä¼˜åŒ–è¯­å¥è¿™äº›ä¸å¿…è¦æˆ–æœªè¢«ä¸“é—¨åŒ–çš„æ­¥éª¤ã€‚Lightning å¯ä»¥è°ƒç”¨æ›´åº•å±‚çš„ TiDB APIï¼Œç¼©çŸ­ SQL è½¬ KV çš„è¡Œç¨‹ã€‚&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;å¹¶è¡Œå¯¼å…¥&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-b3b31a81e0d75bc2783f64ad28f72904_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;279&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-b3b31a81e0d75bc2783f64ad28f72904&quot; data-watermark-src=&quot;v2-da8c69e0cd6f70648ccf994cd7b3adbd&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;å¦ä¸€æ–¹é¢ï¼Œå°½ç®¡æˆ‘ä»¬å¯ä»¥ä¸æ–­çš„ä¼˜åŒ–ç¨‹åºä»£ç ï¼Œå•æœºçš„æ€§èƒ½æ€»æ˜¯æœ‰é™çš„ã€‚è¦çªç ´è¿™ä¸ªç•Œé™å°±éœ€è¦æ¨ªå‘æ‰©å±•ï¼šå¢åŠ æœºå™¨æ¥åŒæ—¶å¯¼å…¥ã€‚å¦‚å‰é¢æ‰€è¿°ï¼Œåªè¦æ¯å¥— TiDB-Lightning Toolset æ“ä½œä¸åŒçš„è¡¨ï¼Œå®ƒä»¬å°±èƒ½å¹³è¡Œå¯¼è¿›åŒä¸€ä¸ªé›†ç¾¤ã€‚å¯æ˜¯ï¼Œç°åœ¨çš„ç‰ˆæœ¬åªæ”¯æŒè¯»å–æœ¬æœºæ–‡ä»¶ç³»ç»Ÿä¸Šçš„ SQL dumpï¼Œè®¾ç½®æˆå¤šæœºç‰ˆå°±æ˜¾å¾—æ¯”è¾ƒéº»çƒ¦äº†ï¼ˆè¦å®‰è£…ä¸€ä¸ªå…±äº«çš„ç½‘ç»œç›˜ï¼Œå¹¶ä¸”æ‰‹åŠ¨åˆ†é…å“ªå°æœºè¯»å–å“ªå¼ è¡¨ï¼‰ã€‚æˆ‘ä»¬è®¡åˆ’è®© Lightning èƒ½ä»ç½‘è·¯è·å– SQL dumpï¼ˆä¾‹å¦‚é€šè¿‡ S3 APIï¼‰ï¼Œå¹¶æä¾›ä¸€ä¸ªå·¥å…·è‡ªåŠ¨åˆ†å‰²æ•°æ®åº“ï¼Œé™ä½è®¾ç½®æˆæœ¬ã€‚&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;åœ¨çº¿å¯¼å…¥&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;TiDB-Lightning åœ¨å¯¼å…¥æ—¶ä¼šæŠŠé›†ç¾¤åˆ‡æ¢åˆ°ä¸€ä¸ªä¸“ä¾› Lightning å†™å…¥çš„æ¨¡å¼ã€‚ç›®å‰æ¥è¯´ Lightning ä¸»è¦ç”¨äºåœ¨è¿›å…¥ç”Ÿäº§ç¯å¢ƒä¹‹å‰å¯¼å…¥å…¨é‡æ•°æ®ï¼Œæ‰€ä»¥åœ¨æ­¤æœŸé—´æš‚åœå¯¹å¤–æä¾›æœåŠ¡è¿˜å¯ä»¥æ¥å—ã€‚ä½†æˆ‘ä»¬å¸Œæœ›æ”¯æŒæ›´å¤šçš„åº”ç”¨åœºæ™¯ï¼Œä¾‹å¦‚å›å¤å¤‡ä»½ã€å‚¨å­˜ OLAP çš„å¤§è§„æ¨¡è®¡ç®—ç»“æœç­‰ç­‰ï¼Œè¿™äº›éƒ½éœ€è¦ç»´æŒé›†ç¾¤åœ¨çº¿ä¸Šã€‚æ‰€ä»¥æ¥ä¸‹æ¥çš„ä¸€å¤§æ–¹å‘æ˜¯è€ƒè™‘æ€æ ·é™ä½ Lightning å¯¹é›†ç¾¤çš„å½±å“ã€‚&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;å»¶ä¼¸é˜…è¯»ï¼š&lt;/p&gt;&lt;a href=&quot;https://pingcap.com/blog-cn/tidb-ecosystem-tools-1/&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;v2-60ab5bd867c2434d70c957a02a2169e1&quot; data-image-width=&quot;1200&quot; data-image-height=&quot;1200&quot; data-image-size=&quot;ipico&quot;&gt;TiDB EcoSystem Tools åŸç†è§£è¯»ï¼ˆä¸€ï¼‰ï¼šTiDB-Binlog æ¶æ„æ¼”è¿›ä¸å®ç°åŸç†&lt;/a&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>ZoeyZhai</author>
<guid isPermaLink="false">2018-12-18-52699499</guid>
<pubDate>Tue, 18 Dec 2018 00:00:00 +0800</pubDate>
</item>
<item>
<title>å¤©çœŸè´å¶æ–¯å­¦ä¹ æœº | TiDB Hackathon ä¼˜ç§€é¡¹ç›®åˆ†äº«</title>
<link>https://henix.github.io/feeds/zhuanlan.newsql/2018-12-18-52647715.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/52647715&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-e3dafb6e9e934bab634b27352ad757cd_r.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;blockquote&gt;TiDB Hackathon 2018 å…±è¯„é€‰å‡ºå…­ä¸ªä¼˜ç§€é¡¹ç›®ï¼Œæœ¬ç³»åˆ—æ–‡ç« å°†ç”±è¿™å…­ä¸ªé¡¹ç›®æˆå‘˜ä¸»ç¬”ï¼Œåˆ†äº«ä»–ä»¬çš„å‚èµ›ç»éªŒå’Œæˆæœã€‚æˆ‘ä»¬éå¸¸å¸Œæœ›æœ¬å±Š Hackathon è¯ç”Ÿçš„ä¼˜ç§€é¡¹ç›®èƒ½å¤Ÿåœ¨ç¤¾åŒºä¸­å»¶ç»­ä¸‹å»ï¼Œæ„Ÿå…´è¶£çš„å°ä¼™ä¼´ä»¬å¯ä»¥åŠ å…¥è¿›æ¥å“¦ï½&lt;br&gt;æœ¬æ–‡ä½œè€…æ˜¯æ¥è‡ª DSG å›¢é˜Ÿçš„æ¨æ–‡åŒå­¦ï¼Œä»–ä»¬çš„é¡¹ç›®ã€ŠPD çƒ­ç‚¹è°ƒåº¦è´å¶æ–¯æ¨¡å‹ã€‹åœ¨æœ¬å±Š Hackathon ä¸­è·å¾—äº†ä¸‰ç­‰å¥–+æœ€ä½³åˆ›æ„å¥–ã€‚&lt;/blockquote&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-e3dafb6e9e934bab634b27352ad757cd_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;2124&quot; data-rawheight=&quot;928&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-e3dafb6e9e934bab634b27352ad757cd&quot; data-watermark-src=&quot;v2-6e73710c0e3a84e11baf80348b95e8ba&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;b&gt;&lt;i&gt;â€œåœ¨ TiDB Hackathon 2018 å­¦ä¹ åˆ°ä¸å°‘ä¸œè¥¿&lt;/i&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;&lt;i&gt;å¸Œæœ›æ˜å¹´å†æ¥â€&lt;/i&gt;&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;ç®€è¿°&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;â€œpd ctl å¤©çœŸå­¦ä¹ æœºâ€&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;å…·ä½“åšæ³•ï¼šç”¨ naive bayes æ¨¡å‹æ¥æ ¹æ®ç³»ç»ŸæŒ‡æ ‡å’Œäººçš„ pd ctl è°ƒç”¨ï¼Œæ¥å¾—åˆ°ä¸€ä¸ªæ¨¡å‹å»æ ¹æ®ç³»ç»ŸæŒ‡æ ‡å»è‡ªåŠ¨æä¾› pd ctl è°ƒç”¨çš„å‘½ä»¤ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;1. è´å¶æ–¯ç®—æ³•ä¸¾ä¾‹&lt;/b&gt;&lt;/p&gt;&lt;p&gt;è´å¶æ–¯æ¨¡å‹å¯ä»¥ç”¨æ¥å¹²è¿™ç§äº‹ï¼š&lt;/p&gt;&lt;p&gt;æ¯”å¦‚ä¸€ä¸ªå¦ˆå¦ˆæ ¹æ®å¤©æ°”é¢„æŠ¥æ¥è·Ÿå„¿å­åœ¨å‡ºä»¬çš„æ—¶å€™å®å˜±ï¼š&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;å¤©æ°”é¢„æŠ¥[ æ™´, æ¸©åº¦: 28, é£åŠ›: ä¸­ ], å¦ˆå¦ˆä¼šè¯´ [å¥½å¥½ç©]
å¤©æ°”é¢„æŠ¥[ é›¨, æ¸©åº¦: 15, é£åŠ›: ä½ ], å¦ˆå¦ˆä¼šè¯´ [å¸¦ä¸Šä¼]
å¤©æ°”é¢„æŠ¥[ é˜´, æ¸©åº¦: 02, é£åŠ›: å¤§ ], å¦ˆå¦ˆä¼šè¯´ [å¤šç©¿ç‚¹]...&lt;/code&gt;&lt;p&gt;æŠŠè¿™äº›è¾“å…¥è¾“å…¥åˆ°è´å¶æ–¯æ¨¡å‹é‡Œä»¥å, æ¨¡å‹å¯ä»¥æ ¹æ®å¤©æ°”é¢„æŠ¥æ¥è¾“å‡ºï¼š&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;å¤©æ°”é¢„æŠ¥[ æ™´, æ¸©åº¦: 00, é£åŠ›ä¸­], æ¨¡å‹ä¼šè¯´ [ å¤šç©¿ç‚¹:0.7, å¥½å¥½ç©0.2, å¸¦ä¸Šä¼0.1]
å¤©æ°”é¢„æŠ¥[ é›¨, æ¸©åº¦: 10, é£åŠ›å¤§], æ¨¡å‹ä¼šè¯´ [ å¸¦ä¸Šä¼:0.8, å¤šç©¿ç‚¹0.1, å¥½å¥½ç©0.1]&lt;/code&gt;&lt;p&gt;è¿™æ ·é€šè¿‡ä¸€ä¸ªå¦ˆå¦ˆçš„å®å˜±å°±å¯ä»¥è®­ç»ƒå‡ºä¸€ä¸ªä¹Ÿä¼šæ ¹æ®å¤©æ°”é¢„æŠ¥ç»™å‡ºå®å˜±çš„æ¨¡å‹ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;2. åˆæ­¥æƒ³æ³•&lt;/b&gt;&lt;/p&gt;&lt;p&gt;æˆ‘ä»¬å¯ä»¥æŠŠä¸€ä¸ªæ¨¡å‹å•ç‹¬çš„éƒ¨ç½²åœ¨ä¸€ä¸ª pod é‡Œ, æš´éœ²ä¸€ä¸ª service ï¼Œç„¶åé›†ç¾¤ä¸Šæ¯æ¬¡æœ‰äººå»è°ƒç”¨ pd_ctl çš„æ—¶å€™å°±åœ¨åå°ç”¨ rest call åˆ°æ¨¡å‹æœåŠ¡ä¸Šè®°å½•ä¸€ä¸‹æ“ä½œï¼ˆå®å˜±ï¼‰å’Œå½“å‰çš„ç³»ç»ŸæŒ‡æ ‡(å¥½æ¯”å¤©æ°”é¢„æŠ¥). è¿™æ ·æ…¢æ…¢ç”¨ä¸€æ®µæ—¶é—´ä»¥åï¼Œç§¯ç´¯çš„æ“ä½œå¤šäº†ä»¥åï¼Œå°±å¯ä»¥æ‰“å¼€æŸä¸ªè‡ªåŠ¨å“åº”ï¼Œæˆ–è€…æ‰“å¼€è‡ªåŠ¨å»ºè®®åº”è¯¥æ‰§è¡Œçš„å‘½ä»¤çš„åŠŸèƒ½ã€‚&lt;/p&gt;&lt;p&gt;è¿™æ ·æ¨¡å‹å¯ä»¥åœ¨æŸä¸€ç»„ç³»ç»ŸæŒ‡æ ‡å‡ºç°ä¹‹å‰ç±»ä¼¼å­¦ä¹ è¿‡çš„çŠ¶æ€ä¹‹åï¼Œç»™å‡ºç›¸åº”çš„å»ºè®®ï¼Œå½“è¿™äº›å»ºè®®éƒ½å¾ˆæ­£ç¡®çš„æ—¶å€™ç›´æ¥è®© pd ç›´æ¥é‡‡çº³ï¼Œå®Œå…¨æ™ºèƒ½çš„è‡ªåŠ¨åŒ–è¿ä½œã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;3. å®é™… Hackathon æ–¹æ¡ˆ&lt;/b&gt;&lt;/p&gt;&lt;p&gt;åœ¨è·Ÿå¯¼å¸ˆäº¤æµæ¢è®¨åå‘ç°ï¼Œç›®å‰ PD å·²ç»æ¯”è¾ƒè‡ªåŠ¨åŒ–äº†ï¼Œå¾ˆå°‘éœ€è¦äººä¸ºä»‹å…¥è¿›è¡Œæ“ä½œï¼Œéœ€è¦çš„æ—¶å€™ä¹Ÿæ˜¯æ¯”è¾ƒå¤æ‚çš„åœºæ™¯ï¼Œæˆ–è€…è‡ªåŠ¨åŒ–è¿ä½œæ¯”è¾ƒæ…¢çš„åœºæ™¯ã€‚&lt;/p&gt;&lt;p&gt;æˆ‘ä»¬å›¢é˜Ÿåœ¨è·Ÿå¤šåå¯¼å¸ˆçš„æ²Ÿé€šäº¤æµä¸‹ï¼Œå°†åˆæ­¥æƒ³æ³•è¿›è¡Œäº†ä¸€äº›è°ƒæ•´ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;ä»çƒ­ç‚¹è°ƒåº¦ç­–ç•¥å…¥æ‰‹ï¼Œç”¨çƒ­ç‚¹è°ƒåº¦ç­–ç•¥çš„æ•°å€¼å»ç”¨ naive bayes æ¨¡å‹å»è®­ç»ƒä»–ä»¬ï¼Œç„¶åå†æ ¹æ®è¿™äº›æ•°å€¼å†å»æ¨¡å‹ä¸­å»è·å–å»ºè®®å€¼ã€‚&lt;/li&gt;&lt;li&gt;ç»Ÿè®¡å»ºè®®å€¼å’Œçƒ­ç‚¹è°ƒåº¦ç­–ç•¥è¿›è¡Œæ¯”è¾ƒï¼›ï¼ˆä»å¼€å§‹çš„æµ‹è¯•ç»“æœæ¥çœ‹ï¼Œå¤§æ¦‚æœ‰ 70% åŒ¹é…ï¼Œä½†æ˜¯æˆ‘ä»¬å®æµ‹å‘ç°ï¼Œä½¿ç”¨æˆ‘ä»¬æ¨¡å‹çš„å»ºè®®å€¼å»çœŸæ­£çš„è°ƒåº¦ï¼Œçƒ­ç‚¹ region è¿˜æ˜¯éå¸¸å‡è¡¡çš„ï¼‰&lt;/li&gt;&lt;li&gt;ä¸‰ç»„å¯¹ç…§è¯•éªŒï¼šä¸è¿›è¡Œè°ƒåº¦ï¼Œåªæ‰“å°è°ƒåº¦æ•°æ®ï¼›æ­£å¸¸ä½¿ç”¨åŸæ¥çš„çƒ­ç‚¹è°ƒåº¦ç­–ç•¥ï¼›ä½¿ç”¨åŸæ¥çš„çƒ­ç‚¹è°ƒåº¦ç­–ç•¥çš„æ•°å€¼ï¼Œä½†æ˜¯ä½¿ç”¨æ¨¡å‹è®­ç»ƒçš„å»ºè®®å€¼è¿›è¡Œå®é™…è°ƒåº¦ï¼›&lt;/li&gt;&lt;/ul&gt;&lt;h2&gt;&lt;b&gt;Hackathon å›é¡¾&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;é¦–å…ˆï¼Œä»‹ç»ä¸€ä¸‹æˆ‘ä»¬å›¢é˜Ÿï¼ˆDSGï¼‰ï¼Œåˆ†åˆ«æ¥è‡ªï¼šä¸¹éº¦ã€åŒ—äº¬ï¼ˆå±±è¥¿ï¼‰ã€å¹¿å·ã€‚&lt;/p&gt;&lt;p&gt;D å…ˆç”Ÿæ˜¯åœ¨æ¯”èµ›å‰ä¸€å¤©æ—©ä¸Šåˆ°è¾¾åŒ—äº¬çš„ï¼Œæˆ‘æ˜¯æ¯”èµ›å‰ä¸€å¤©æ™šä¸Šä»å¹¿å·å‡ºå‘ï¼Œäºæ¯”èµ›å½“æ—¥æ—©ä¸Š 6:38 æ‰æŠµè¾¾åŒ—äº¬çš„ã€‚&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;è¯´å®è¯ï¼Œæ—¶å·®å’Œç–²æƒ«å¯¹äºå‚èµ›è¿˜æ˜¯æœ‰ä¸€ç‚¹å½±å“çš„ã€‚&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;åºŸè¯ä¸å¤šè¯´ï¼Œæˆ‘å°±æ¥å›é¡¾ä¸€ä¸‹æˆ‘çš„æ•´ä¸ªå‚èµ›è¿‡ç¨‹ã€‚&lt;/p&gt;&lt;ul&gt;&lt;li&gt;æ¯”èµ›å‰ä¸€æ—¥ 20:05 ä»å¹¿å·å—ç«™å‡ºå‘ï¼Œæ¬¡æ—¥ 6:38 æŠµè¾¾åŒ—äº¬è¥¿ç«™ã€‚&lt;/li&gt;&lt;li&gt;7:58 æŠµè¾¾åœ°é“è¥¿å°å£&lt;/li&gt;&lt;/ul&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-15e3857dfc8600b934bf1aa6edc63659_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;1917&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-15e3857dfc8600b934bf1aa6edc63659&quot; data-watermark-src=&quot;v2-591490d18ed33c3cb18194f73ac275d6&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;ul&gt;&lt;li&gt;8:06 ç»è¿‡è½¬è½¬&lt;/li&gt;&lt;li&gt;8:12 æŠµè¾¾æ¯”èµ›æ‰€åœ¨åœ°ï¼šä¸œå‡ç§‘æŠ€å›­ C-1 æ¥¼&lt;/li&gt;&lt;li&gt;8:16 ç­¾åˆ°ï¼Œé€› PingCAP&lt;/li&gt;&lt;/ul&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-2f2e7223147d1bd1e5b8a7a867f219bb_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;1154&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-2f2e7223147d1bd1e5b8a7a867f219bb&quot; data-watermark-src=&quot;v2-094e38deefe87c8e62e49ad79ac4d784&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;ul&gt;&lt;li&gt;8:40 è·Ÿ D å…ˆç”Ÿæ±‡åˆï¼Œäº†è§£è´å¶æ–¯æ¨¡å‹&lt;/li&gt;&lt;li&gt;9:20 DSG å›¢é˜Ÿæˆå‘˜å…¨éƒ¨é›†ç»“å®Œæ¯•&lt;/li&gt;&lt;/ul&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-341eeab6fc17ded51af3a4fe8fe9b848_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;733&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-341eeab6fc17ded51af3a4fe8fe9b848&quot; data-watermark-src=&quot;v2-17c83d958e278ed7c96013dba27dae0a&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;ul&gt;&lt;li&gt;10:00 æ¯”èµ›æ­£å¼å¼€å§‹&lt;/li&gt;&lt;li&gt;10:00 Hacking Time: Trello æ„å»ºæ•´ä¸ªæ¯”èµ›åˆ†å·¥ã€å‡†å¤‡å·¥ä½œã€éœ€æ±‚åˆ†æ&lt;/li&gt;&lt;li&gt;æ­å»º TiDB é›†ç¾¤ï¼ˆ2å¥—ï¼‰ã€ç†Ÿæ‚‰ TiDB é›†ç¾¤ï¼Œå®æ“ PD-CTLã€‘&lt;/li&gt;&lt;li&gt;12:17 åˆé¤&lt;/li&gt;&lt;li&gt;13:00 Hacking Time: ç†Ÿæ‚‰ PD Commandï¼Œè´å¶æ–¯æ¨¡å‹ï¼Œå¯¼å¸ˆæŒ‡å¯¼ï¼Œæœ¬åœ° TiDB ç¯å¢ƒæ„å»ºï¼ˆå‘ï¼‰ï¼Œåˆ†æ PD çƒ­ç‚¹è°ƒåº¦ï¼Œå‰–æè°ƒåº¦æµç¨‹ï¼Œæ¨¡æ‹Ÿçƒ­ç‚¹æ•°æ®&lt;/li&gt;&lt;li&gt;18:20 å¤–å‡ºç”¨é¤ï¼ˆèŠ¦æœˆè½©ç¾Šèå­(è¥¿ä¸‰æ——åº—)ï¼‰ã€æ²¾ D å…ˆç”Ÿçš„å…‰ï¼Œè¹­åƒè¹­å–ã€‘&lt;/li&gt;&lt;li&gt;20:40 å›åˆ°ä¸œå‡ç§‘æŠ€å›­&lt;/li&gt;&lt;li&gt;20:50 ~ æ¬¡æ—¥ 1:10 Hacking Time: æ¨¡æ‹Ÿçƒ­ç‚¹æ•°æ®ï¼Œå®æµ‹è°ƒåº¦ä¸ŠæŠ¥å’Œè·å–æ¨¡å‹è¿”å›ç»“æœï¼Œæœ¬åœ°æµ‹é€šè°ƒåº¦å‚æ•°ä¸ŠæŠ¥å’Œå¾—åˆ°æ¨¡å‹è¿”å›å€¼&lt;/li&gt;&lt;li&gt;æ¬¡æ—¥ 1:10 ~ 5:50 ä¼šè®®å®¤ä¼‘æ¯ï¼ˆåœ¨æ­¤æœŸé—´ï¼Œæˆ‘çš„é˜Ÿå‹ D å…ˆç”Ÿï¼Œè°ƒå¥½äº†æ¨¡å‹ï¼Œå¹¶å°†æ­¤æ¨¡å‹é€šè¿‡ Docker æ„å»ºéƒ¨ç½²åˆ° PD æœºå™¨ä¸Šï¼‰&lt;/li&gt;&lt;li&gt;æ¬¡æ—¥ 5:50 Hacking Time: éƒ¨ç½²ä¿®æ”¹è¿‡çš„ PD æœåŠ¡åˆ°çº¿ä¸ŠæœåŠ¡å™¨ï¼Œå¹¶æ‰“é€š rust-nb-serverï¼Œå®æ—¶ä¸ŠæŠ¥å’Œå®æ—¶è·å–æ¨¡å‹è¿”å›ç»“æœ&lt;/li&gt;&lt;li&gt;æ¬¡æ—¥ 7:30 æ—©é¤&lt;/li&gt;&lt;li&gt;æ¬¡æ—¥ 8:00 æ­£å¼è°ƒè¯•&lt;/li&gt;&lt;li&gt;æ¬¡æ—¥ 9:00 æŠ½ç­¾ç¡®å®š Demo æ—¶é—´&lt;/li&gt;&lt;li&gt;æ¬¡æ—¥ 9:00 ~ 12:00 Hacking Time: è°ƒä¼˜&lt;/li&gt;&lt;li&gt;æ¬¡æ—¥ 12:00 ~ 12:30 åˆé¤æ—¶é—´&lt;/li&gt;&lt;li&gt;æ¬¡æ—¥ 13:00 ~ 14:00 Hacking Time:  PPTï¼Œè°ƒä¼˜&lt;/li&gt;&lt;li&gt;æ¬¡æ—¥ 14:30 ~ 18:30 Demo Timeï¼ˆB ç«™ç›´æ’­ï¼‰&lt;/li&gt;&lt;/ul&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-3227038cf7a5c0fceea2cf8dbe7b0ec8_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;810&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-3227038cf7a5c0fceea2cf8dbe7b0ec8&quot; data-watermark-src=&quot;v2-43c58a1dff6f5bf247b2315a873136bf&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-f8d50461f274aab577f0629570103c53_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;503&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-f8d50461f274aab577f0629570103c53&quot; data-watermark-src=&quot;v2-4295925384afa95673a6d0a9eb1a78c7&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-17c0306743ed229a59ad4fca13237e76_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;431&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-17c0306743ed229a59ad4fca13237e76&quot; data-watermark-src=&quot;v2-59b2751df6e57d6ad7639ecda0d31b0d&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;ul&gt;&lt;li&gt;æ¬¡æ—¥ 18:30 ~ 19:00 é¢å¥–ï¼ˆB ç«™ç›´æ’­ï¼‰&lt;/li&gt;&lt;/ul&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-5be44353701d44af3fcfba2562379147_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;608&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-5be44353701d44af3fcfba2562379147&quot; data-watermark-src=&quot;v2-27fe422c71dd698de08e22f7b0e037af&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-3819854910b872e8c8131fbd54bef68d_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;608&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-3819854910b872e8c8131fbd54bef68d&quot; data-watermark-src=&quot;v2-ed6851744c7ee2430773c8e51b143067&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;h2&gt;&lt;b&gt;Hackathon å®æ“&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;1. æ­å»º TiDB é›†ç¾¤&lt;/b&gt;&lt;/p&gt;&lt;p&gt;å®Œå…¨å‚è€ƒ&lt;u&gt;æ–‡æ¡£&lt;/u&gt;ã€‚&lt;/p&gt;&lt;p&gt;æµ‹è¯• TiDB é›†ç¾¤ï¼Œå¯èƒ½é‡åˆ°çš„å‘ï¼ˆMySQL 8 client On MacOSXï¼‰ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;mysql client connect : Unknown charset 255 (MySQL 8 Client ä¸æ”¯æŒå­—ç¬¦é›†ï¼Œéœ€è¦æŒ‡å®šé»˜è®¤å­—ç¬¦é›†ä¸º UTF8) &lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;code class=&quot;inline&quot;&gt;mysql -hx.x.x.x --default-character-set utf8&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;2. å¤©çœŸè´å¶æ–¯çš„æœåŠ¡æ¥å£&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;code class=&quot;inline&quot;&gt;/model/service1&lt;/code&gt; PUT ä¸ŠæŠ¥æ•°æ®ï¼š&lt;/li&gt;&lt;/ul&gt;&lt;code lang=&quot;text&quot;&gt;{
  &quot;updates&quot;: [
    [
      &quot;transfer leader from store 7 to store 2&quot;,
      [
        {
          &quot;feature_type&quot;: &quot;Category&quot;,
          &quot;name&quot;: &quot;hotRegionsCount1&quot;,
          &quot;value&quot;: &quot;true&quot;
        },
        {
          &quot;feature_type&quot;: &quot;Category&quot;,
          &quot;name&quot;: &quot;minRegionsCount1&quot;,
          &quot;value&quot;: &quot;true&quot;
        },
        {
          &quot;feature_type&quot;: &quot;Category&quot;,
          &quot;name&quot;: &quot;hotRegionsCount2&quot;,
          &quot;value&quot;: &quot;true&quot;
        },
        {
          &quot;feature_type&quot;: &quot;Category&quot;,
          &quot;name&quot;: &quot;minRegionsCount2&quot;,
          &quot;value&quot;: &quot;true&quot;
        },
        {
          &quot;feature_type&quot;: &quot;Category&quot;,
          &quot;name&quot;: &quot;srcRegion&quot;,
          &quot;value&quot;: &quot;7&quot;
        }
      ]
    ],
  ]}&lt;/code&gt;&lt;ul&gt;&lt;li&gt;&lt;code class=&quot;inline&quot;&gt;/model/service1&lt;/code&gt; POST è·å–æ¨¡å‹ç»“æœï¼š&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;è¾“å…¥å‚æ•°ï¼šä¸ŠæŠ¥çš„å‚æ•°&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;{
  &quot;predictions&quot;: [
    {
      &quot;transfer leader from store 1 to store 2&quot;: 0.27432775221072137,
      &quot;transfer leader from store 1 to store 7&quot;: 0.6209064350448428,
      &quot;transfer leader from store 2 to store 1&quot;: 0.024587894827775753,
      &quot;transfer leader from store 2 to store 7&quot;: 0.01862719305134528,
      &quot;transfer leader from store 7 to store 1&quot;: 0.02591609468013258,
      &quot;transfer leader from store 7 to store 2&quot;: 0.03563463018518229
    }
  ]} &lt;/code&gt;&lt;p&gt;&lt;b&gt;3. PD é›†ç¾¤éƒ¨ç½²&lt;/b&gt;&lt;/p&gt;&lt;p&gt;é¦–å…ˆå°† pd-server æ›¿æ¢åˆ°é›†ç¾¤æ‰€åœ¨ &lt;code class=&quot;inline&quot;&gt;ansible/resources/bin&lt;/code&gt; ç›®å½•ä¸‹ï¼Œé‚£å¦‚ä½•è®©é›†ç¾¤ä¸Šçš„ PD æ›´æ–°ç”Ÿæ•ˆå‘¢ï¼Ÿ&lt;/p&gt;&lt;p&gt;&lt;b&gt;æ›´æ–°ï¼š&lt;/b&gt;&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;$ ansible-playbook rolling_update.yml --tags=pd&lt;/code&gt;&lt;p&gt;åœ¨å®æ“è¿‡ç¨‹ä¸­ï¼Œ å¦‚æœä½ åœ¨æ›´æ–°åˆ°ä¸€åŠçš„æ—¶å€™å°±å…³é—¨äº†ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ•´ä¸ª PD æŒ‚æ‰ï¼ˆéé›†ç¾¤ç¯å¢ƒï¼‰ï¼Œå¯èƒ½æ˜¯å› ä¸ºé€»è¾‘ä¸ä¸¥è°¨æ‰€å¯¼è‡´çš„é—®é¢˜&lt;/p&gt;&lt;p&gt;ç›´æ¥åœæ­¢äº† ansibleï¼Œå¯¼è‡´ PD é›†ç¾¤æœºå™¨èŠ‚ç‚¹æœ‰åœæ­¢çš„æƒ…å†µï¼Œè¿™ä¸ªæ—¶å€™ä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤å¯åŠ¨å®ƒã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;å¯åŠ¨ï¼š&lt;/b&gt;&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;$ ansible-playbook start.yml --tags=pd&lt;/code&gt;&lt;p&gt;&lt;b&gt;4. PD è°ƒåº¦&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;4.1 å–æ¶ˆçƒ­ç‚¹æ•°æ®è°ƒåº¦&lt;/b&gt;&lt;/p&gt;&lt;p&gt;å¤§å®¶éƒ½ä»¥ä¸ºå¯ä»¥é€šè¿‡é…ç½®æ¥è§£å†³ï¼š(è°ƒåº¦å¼€å…³æ–¹æ³•: ç”¨ config set xxx 0 æ¥å…³é—­è°ƒåº¦)&lt;/p&gt;&lt;p&gt;é…ç½®å¦‚ä¸‹ï¼šï¼ˆè™½ç„¶æ‰¾çš„åœ°æ–¹é”™è¯¯äº†ï¼Œä½†æ˜¯é”™æ‰“é”™ç€ï¼Œæˆ‘ä»¬æ¥åˆ°äº† Demo Timeï¼š&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;config set leader-schedule-limit 0
config set region-schedule-limit 0
scheduler add hot-region-scheduler
config show
config set leader-schedule-limit 4
config set region-schedule-limit 8&lt;/code&gt;&lt;p&gt;å®æµ‹å‘ç°ï¼Œæ ¹æœ¬ä¸ç”Ÿæ•ˆï¼Œå¿…é¡»è¦æ”¹æºä»£ç ã€‚&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;func (h *balanceHotRegionsScheduler) dispatch(typ BalanceType, cluster schedule.Cluster) []*schedule.Operator {
    h.Lock()
    defer h.Unlock()
    switch typ {
    case hotReadRegionBalance:
        h.stats.readStatAsLeader = h.calcScore(cluster.RegionReadStats(), cluster, core.LeaderKind)
        // return h.balanceHotReadRegions(cluster) // å°†è¿™ä¸€è¡Œæ³¨é‡Š
    case hotWriteRegionBalance:
        h.stats.writeStatAsLeader = h.calcScore(cluster.RegionWriteStats(), cluster, core.LeaderKind)
        h.stats.writeStatAsPeer = h.calcScore(cluster.RegionWriteStats(), cluster, core.RegionKind)
        // return h.balanceHotWriteRegions(cluster) // å°†è¿™ä¸€è¡Œæ³¨é‡Š
    }
    return nil
}&lt;/code&gt;&lt;p&gt;ä½†æ˜¯ï¼Œæˆ‘ä»¬è¦çš„ä¸æ˜¯ä¸è°ƒåº¦ï¼Œè€Œåªæ˜¯ä¸ç»™è°ƒåº¦ç»“æœï¼š&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;func (h *balanceHotRegionsScheduler) balanceHotReadRegions(cluster schedule.Cluster) []*schedule.Operator {
    // balance by leader
    srcRegion, newLeader := h.balanceByLeader(cluster, h.stats.readStatAsLeader)
    if srcRegion != nil {
        schedulerCounter.WithLabelValues(h.GetName(), &quot;move_leader&quot;).Inc()
        // step := schedule.TransferLeader{FromStore: srcRegion.GetLeader().GetStoreId(), ToStore: newLeader.GetStoreId()} // ä¿®æ”¹ä¸ºä¸è¿”å›å€¼æˆ–è€…è¿”å› _
        _ = schedule.TransferLeader{FromStore: srcRegion.GetLeader().GetStoreId(), ToStore: newLeader.GetStoreId()}
        // return []*schedule.Operator{schedule.NewOperator(&quot;transferHotReadLeader&quot;, srcRegion.GetID(), srcRegion.GetRegionEpoch(), schedule.OpHotRegion|schedule.OpLeader, step)} // æ³¨é‡Šè¿™ä¸€è¡Œï¼Œå¹¶ return nil
        return nil
    }

    // balance by peer
    srcRegion, srcPeer, destPeer := h.balanceByPeer(cluster, h.stats.readStatAsLeader)
    if srcRegion != nil {
        schedulerCounter.WithLabelValues(h.GetName(), &quot;move_peer&quot;).Inc()
        return []*schedule.Operator{schedule.CreateMovePeerOperator(&quot;moveHotReadRegion&quot;, cluster, srcRegion, schedule.OpHotRegion, srcPeer.GetStoreId(), destPeer.GetStoreId(), destPeer.GetId())}
    }
    schedulerCounter.WithLabelValues(h.GetName(), &quot;skip&quot;).Inc()
    return nil
}

......

func (h *balanceHotRegionsScheduler) balanceHotWriteRegions(cluster schedule.Cluster) []*schedule.Operator {
    for i := 0; i &amp;lt; balanceHotRetryLimit; i++ {
        switch h.r.Int() % 2 {
        case 0:
            // balance by peer
            srcRegion, srcPeer, destPeer := h.balanceByPeer(cluster, h.stats.writeStatAsPeer)
            if srcRegion != nil {
                schedulerCounter.WithLabelValues(h.GetName(), &quot;move_peer&quot;).Inc()
                fmt.Println(srcRegion, srcPeer, destPeer)
                // return []*schedule.Operator{schedule.CreateMovePeerOperator(&quot;moveHotWriteRegion&quot;, cluster, srcRegion, schedule.OpHotRegion, srcPeer.GetStoreId(), destPeer.GetStoreId(), destPeer.GetId())} // æ³¨é‡Šè¿™ä¸€è¡Œï¼Œå¹¶ return nil
                return nil
            }
        case 1:
            // balance by leader
            srcRegion, newLeader := h.balanceByLeader(cluster, h.stats.writeStatAsLeader)
            if srcRegion != nil {
                schedulerCounter.WithLabelValues(h.GetName(), &quot;move_leader&quot;).Inc()
                // step := schedule.TransferLeader{FromStore: srcRegion.GetLeader().GetStoreId(), ToStore: newLeader.GetStoreId()} // ä¿®æ”¹ä¸ºä¸è¿”å›å€¼æˆ–è€…è¿”å› _
                _ = schedule.TransferLeader{FromStore: srcRegion.GetLeader().GetStoreId(), ToStore: newLeader.GetStoreId()}

                // return []*schedule.Operator{schedule.NewOperator(&quot;transferHotWriteLeader&quot;, srcRegion.GetID(), srcRegion.GetRegionEpoch(), schedule.OpHotRegion|schedule.OpLeader, step)} // æ³¨é‡Šè¿™ä¸€è¡Œï¼Œå¹¶ return nil
                return nil
            }
        }
    }

    schedulerCounter.WithLabelValues(h.GetName(), &quot;skip&quot;).Inc()
    return nil
}&lt;/code&gt;&lt;p&gt;å½“ä¿®æ”¹äº† PD å†é‡æ–°ç¼–è¯‘å¾—åˆ° pd-serverï¼Œå°†å…¶æ”¾åˆ° &lt;/p&gt;&lt;p&gt;&lt;code class=&quot;inline&quot;&gt;tidb-ansible/resources/bin/pd-server&lt;/code&gt; å¹¶æ›¿æ¢åŸæ¥çš„æ–‡ä»¶ï¼Œç„¶åæ‰§è¡Œ &lt;/p&gt;&lt;p&gt;&lt;code class=&quot;inline&quot;&gt;ansible-playbook rolling_update.yml --tags=pd&lt;/code&gt;ï¼Œå³å¯é‡å¯ pd-server æœåŠ¡ã€‚&lt;/p&gt;&lt;p&gt;åœ¨è°ƒä¼˜çš„è¿‡ç¨‹ä¸­å‘ç°ï¼Œå½“å‰ &lt;code class=&quot;inline&quot;&gt;hot-region-scheduler&lt;/code&gt; çš„è°ƒåº¦æ—¶å¯¹äºç›®æ ‡æœºå™¨çš„é€‰æ‹©å¹¶ä¸æ˜¯æœ€ä¼˜çš„ï¼Œä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://github.com/pingcap/pd/blob/master/server/schedulers/hot_region.go#L374&quot;&gt;https://github.com/pingcap/pd/blob/master/server/schedulers/hot_region.go#L374&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;ç®€è¿°ï¼šå¾ªç¯éå† candidateStoreIDs çš„æ—¶å€™ï¼Œå¦‚æœæ»¡è¶³æ¡ä»¶æœ‰å¤šå°ï¼Œé‚£ä¹ˆæœ€åä¸€ä¸ªæ€»ä¼šè¦†ç›–å‰é¢å·²ç»å­˜å‚¨åˆ° destStoreID é‡Œé¢çš„æ•°æ®ï¼Œæœ€ç»ˆæˆ‘ä»¬æ‹¿åˆ°çš„ destStoreID æœ‰å¯èƒ½ä¸æ˜¯æœ€ä¼˜çš„ã€‚ï¼ˆ&lt;/b&gt;pd issue: &lt;a href=&quot;https://github.com/pingcap/pd/issues/1359&quot;&gt;https://github.com/pingcap/pd/issues/1359&lt;/a&gt;ï¼‰&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;// selectDestStore selects a target store to hold the region of the source region.
// We choose a target store based on the hot region number and flow bytes of this store.
func (h *balanceHotRegionsScheduler) selectDestStore(candidateStoreIDs []uint64, regionFlowBytes uint64, srcStoreID uint64, storesStat core.StoreHotRegionsStat) (destStoreID uint64) {
    sr := storesStat[srcStoreID]
    srcFlowBytes := sr.TotalFlowBytes
    srcHotRegionsCount := sr.RegionsStat.Len()

    var (
        minFlowBytes    uint64 = math.MaxUint64
        minRegionsCount        = int(math.MaxInt32)
    )
    for _, storeID := range candidateStoreIDs {
        if s, ok := storesStat[storeID]; ok {
            if srcHotRegionsCount-s.RegionsStat.Len() &amp;gt; 1 &amp;amp;&amp;amp; minRegionsCount &amp;gt; s.RegionsStat.Len() {
                destStoreID = storeID
                minFlowBytes = s.TotalFlowBytes
                minRegionsCount = s.RegionsStat.Len()
                continue // è¿™é‡Œ
            }
            if minRegionsCount == s.RegionsStat.Len() &amp;amp;&amp;amp; minFlowBytes &amp;gt; s.TotalFlowBytes &amp;amp;&amp;amp;
                uint64(float64(srcFlowBytes)*hotRegionScheduleFactor) &amp;gt; s.TotalFlowBytes+2*regionFlowBytes {
                minFlowBytes = s.TotalFlowBytes
                destStoreID = storeID
            }
        } else {
            destStoreID = storeID
            return
        }
    }
    return
}&lt;/code&gt;&lt;p&gt;&lt;b&gt;4.2 PD é‡è¦ç›‘æ§æŒ‡æ ‡è¯¦è§£ä¹‹ HotRegionï¼š&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Hot write Region&#39;s leader distributionï¼šæ¯ä¸ª TiKV å®ä¾‹ä¸Šæ˜¯å†™å…¥çƒ­ç‚¹çš„ leader çš„æ•°é‡&lt;/li&gt;&lt;li&gt;Hot write Region&#39;s peer distributionï¼šæ¯ä¸ª TiKV å®ä¾‹ä¸Šæ˜¯å†™å…¥çƒ­ç‚¹çš„ peer çš„æ•°é‡&lt;/li&gt;&lt;li&gt;Hot write Region&#39;s leader written bytesï¼šæ¯ä¸ª TiKV å®ä¾‹ä¸Šçƒ­ç‚¹çš„ leader çš„å†™å…¥å¤§å°&lt;/li&gt;&lt;li&gt;Hot write Region&#39;s peer written bytesï¼šæ¯ä¸ª TiKV å®ä¾‹ä¸Šçƒ­ç‚¹çš„ peer çš„å†™å…¥å¤§å°&lt;/li&gt;&lt;li&gt;Hot read Region&#39;s leader distributionï¼šæ¯ä¸ª TiKV å®ä¾‹ä¸Šæ˜¯è¯»å–çƒ­ç‚¹çš„ leader çš„æ•°é‡&lt;/li&gt;&lt;li&gt;Hot read Region&#39;s peer distributionï¼šæ¯ä¸ª TiKV å®ä¾‹ä¸Šæ˜¯è¯»å–çƒ­ç‚¹çš„ peer çš„æ•°é‡&lt;/li&gt;&lt;li&gt;Hot read Region&#39;s leader read bytesï¼šæ¯ä¸ª TiKV å®ä¾‹ä¸Šçƒ­ç‚¹çš„ leader çš„è¯»å–å¤§å°&lt;/li&gt;&lt;li&gt;Hot read Region&#39;s peer read bytesï¼šæ¯ä¸ª TiKV å®ä¾‹ä¸Šçƒ­ç‚¹çš„ peer çš„è¯»å–å¤§å°&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;æœ¬æ¬¡æˆ‘ä»¬åª hack éªŒè¯äº† Write Region Leader è¿™éƒ¨åˆ†ï¼Œæ‰€ä»¥æˆ‘ä»¬é‡ç‚¹å…³æ³¨ä¸€ä¸‹ç›‘æ§å’Œé—®é¢˜ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Hot write Region&#39;s leader distribution&lt;/li&gt;&lt;/ul&gt;&lt;blockquote&gt;&lt;i&gt;ç›‘æ§æ•°æ®æœ‰ä¸€å®šçš„å»¶æ—¶ï¼ˆç²—ç•¥ä¼°è®¡1-2åˆ†é’Ÿï¼‰&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;b&gt;5. æ¨¡æ‹Ÿçƒ­ç‚¹æ•°æ®&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;ä»æœ¬åœ°å¾€æœåŠ¡å™¨ load æ•°æ®ï¼š&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;ä¿®æ”¹ &lt;code class=&quot;inline&quot;&gt;tidb-bench&lt;/code&gt; çš„ &lt;code class=&quot;inline&quot;&gt;Makefile#load&lt;/code&gt; æ¨¡å—å¯¹åº”çš„ä¸»æœºåœ°å€ï¼Œç„¶åæ‰§è¡Œ &lt;code class=&quot;inline&quot;&gt;make tbl&lt;/code&gt;, &lt;code class=&quot;inline&quot;&gt;make load&lt;/code&gt; å³å¯å¾€æœåŠ¡å™¨ load æ•°æ®äº†ã€‚&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;æ³¨æ„ï¼Œè¿™é‡Œä½ ä¹Ÿéœ€è¦è¿›è¡Œä¸€äº›é…ç½®ä¿®æ”¹ï¼š&lt;/i&gt;&lt;code class=&quot;inline&quot;&gt;--default-character-set utf8&lt;/code&gt;&lt;br&gt;&lt;i&gt;çŠ¯çš„é”™ï¼šå—é™äºæœ¬åœ°-æœåŠ¡å™¨é—´ç½‘ç»œå¸¦å®½ï¼Œå¯¼å…¥æ•°æ®å¾ˆæ…¢ã€‚&lt;/i&gt;&lt;/blockquote&gt;&lt;ul&gt;&lt;li&gt;çº¿ä¸ŠæœåŠ¡å™¨ä¸Šï¼š&lt;/li&gt;&lt;/ul&gt;&lt;code lang=&quot;text&quot;&gt;$ ./go-ycsb run mysql -p mysql.host=10.9.x.x -p mysql.port=4000 -p mysql.db=test1 -P workloads/workloada&lt;/code&gt;&lt;p&gt;æ³¨ï¼š&lt;code class=&quot;inline&quot;&gt;go-ycsb&lt;/code&gt; æ”¯æŒ insertï¼Œä¹Ÿæ”¯æŒ updateï¼Œä½ å¯ä»¥æ ¹æ®ä½ çš„éœ€è¦è¿›è¡Œç›¸å¯¹åº”çš„è°ƒæ•´&lt;code class=&quot;inline&quot;&gt;workloada#recordcount&lt;/code&gt; å’Œ &lt;code class=&quot;inline&quot;&gt;workloada#operationcount&lt;/code&gt; å‚æ•°ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;6.æœ¬åœ°æ„å»º rust-nb-server&lt;/b&gt;&lt;/p&gt;&lt;p&gt;rust ä¸€å¤©é€Ÿæˆâ€¦â€¦&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;Demo Time çš„æ—¶å€™å¬å¥½å‡ ä¸ªå›¢é˜Ÿéƒ½è¯´å¤±è´¥äº†ã€‚æˆ‘ä»¥å‰ä¹Ÿå°è¯•è¿‡ï¼Œä½†æ˜¯è¢«ç¼–è¯‘çš„é€Ÿåº¦ä»¥åŠè€—èƒ½ç»™å‡»è´¥äº†ã€‚&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;ç¯å¢ƒéƒ½å¯ä»¥æŠŠä½  de è‡ªä¿¡å¿ƒå‡»æºƒã€‚&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;rustup install nightly
cargo run
...&lt;/code&gt;&lt;p&gt;Mac æœ¬åœ°æ‰“åŒ… Linux å¤±è´¥ï¼šç¼ºå°‘ std åº“ï¼Œé€šè¿‡ Docker ä¸´æ—¶è§£å†³ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;7. å¯¼å¸ˆæŒ‡å¯¼&lt;/b&gt;&lt;/p&gt;&lt;p&gt;ä»æ¯”èµ›ä¸€å¼€å§‹ï¼Œå¯¼å¸ˆå›¢å°±éå¸¸ç§¯æå’Œä¸»åŠ¨ï¼Œç›´æ¥å»æ¯ä¸ªé¡¹ç›®ç»„ï¼Œç»™äºˆç›´æ¥æŒ‡å¯¼å’Œå»ºè®®ï¼Œæˆ‘ä»¬é‡åˆ°é—®é¢˜å»æ‰¾å¯¼å¸ˆæ—¶ï¼Œä»–ä»¬ä¹Ÿéå¸¸çš„é…åˆã€‚&lt;/p&gt;&lt;p&gt;å¯¼å¸ˆä¸ä»…å¸®æˆ‘ä»¬è§£å†³é—®é¢˜ï¼ˆç‰¹åˆ«æ˜¯çƒ­ç‚¹æ•°æ®æ„å»ºï¼ŒåŒ…æ‹¬å¯¹äºä»£ç çº§åˆ«çš„æŒ‡å¯¼ï¼‰ï¼Œè¿˜è·Ÿæˆ‘ä»¬ä¸€èµ·æ¢è®¨è¯¾é¢˜æ–¹å‘å’Œå®é™…å¯æ“ä½œæ€§ï¼Œä»¥åŠå¯ä»¥è¾¾åˆ°çš„ç›®æ ‡ã€‚&lt;/p&gt;&lt;p&gt;éå¸¸æ„Ÿè°¢ï¼ï¼ï¼&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;æˆ‘ä»¬çš„å‡†å¤‡å’Œä¸»åŠ¨æ€§çœŸçš„ä¸è¶³ï¼Œå€¼å¾—åæ€--ä¹Ÿå¸Œæœ›å¤§å®¶ä»¥åä¸è¦æ€•éº»çƒ¦ï¼Œæœ‰é—®é¢˜å°±å¤§èƒ†çš„å»é—®ã€‚&lt;/i&gt;&lt;/blockquote&gt;&lt;h2&gt;&lt;b&gt;Hackathon Demo&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;æ•´ä¸ª Demo show è¿›è¡Œçš„éå¸¸é¡ºåˆ©ï¼Œä¸ºæ¯ä¸€ä¸ªå›¢é˜Ÿç‚¹èµï¼&lt;/p&gt;&lt;p&gt;å¾ˆå¤šå›¢é˜Ÿçš„ä½œå“éƒ½è®©äººå°–å«ï¼Œå¯æƒ³è€ŒçŸ¥ä»–ä»¬çš„ä½œå“æ˜¯å¤šä¹ˆçš„é…·ç‚«å’Œç‰›é€¼ï¼Œå°è±¡ä¸­åªæœ‰ä¸€ä¸ªå›¢é˜Ÿåœ¨ Demo ç¯å¢ƒå‡ºç°äº†æ¼”ç¤ºæ—¶ç¨‹åºå´©æºƒçš„é—®é¢˜ï¼ˆç”¨Java Netty åŸºäº TiKV åšçš„ memcacheï¼ˆå®ç°äº†å¤§éƒ¨åˆ†çš„åè®®ï¼‰ï¼‰ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;Hackathon é¢å¥–&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;é—æ†¾ï¼ï¼ï¼&lt;/p&gt;&lt;p&gt;æˆ‘ä»¬ DSG å›¢é˜Ÿè£è·ä¸‰ç­‰å¥–+æœ€ä½³åˆ›æ„ä¸¤é¡¹å¤§å¥–ï¼Œä½†æ˜¯å¾ˆé—æ†¾æˆ‘æœªèƒ½è·Ÿå›¢é˜Ÿä¸€èµ·åˆ†äº«è¿™ä¸€åˆ»ã€‚&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;å› ä¸ºæˆ‘è¦èµ¶ç€å»ç«è½¦ç«™ï¼Œæ‰€ä»¥åœ¨å‘¨æ—¥ä¸‹åˆ6ç‚¹çš„æ—¶å€™ï¼Œæˆ‘è·Ÿé˜Ÿå‹å’Œä¸€äº›æœ‹å‹é“åˆ«åï¼Œæˆ‘å°±å»ç«è½¦ç«™äº†ï¼Œåé¢å‡ ç»„çš„ Demo Show ä¹Ÿå¾ˆéå¸¸é—æ†¾æœªèƒ½å‚åŠ ã€‚&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;b&gt;å¾—å¥–æ„Ÿè¨€ï¼š&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;è°¢è°¢ DSG å›¢é˜Ÿï¼Œè°¢è°¢å¯¼å¸ˆï¼Œè°¢è°¢è¯„å§”è€å¸ˆï¼Œè°¢è°¢ PingCAP ç»™å¤§å®¶ç­¹å¤‡äº†è¿™ä¹ˆå¥½çš„ä¸€æ¬¡é»‘å®¢é©¬æ‹‰æ¾æ¯”èµ›æ´»åŠ¨ã€‚&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;TiDB Hackathon 2018 æ€»ç»“&lt;/b&gt;&lt;/h2&gt;&lt;blockquote&gt;&lt;i&gt;æœ¬æ¬¡æ¯”èµ›çš„å„ä¸ªæ–¹é¢éƒ½åšçš„å®Œç¾ï¼Œé™¤äº†&lt;b&gt;ç½‘ç»œ&lt;/b&gt;ã€‚&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;1. ç¯å¢ƒï¼ˆä¸€å®šè¦æå‰å‡†å¤‡ï¼‰----è¿™æ¬¡è¢«å‘äº†ä¸å°‘æ—¶é—´å’Œç²¾åŠ›ï¼›&lt;/p&gt;&lt;p&gt;2. é…ç½®æ–‡æ¡£ä¸­æœ‰ä¸€äº›æ³¨æ„äº‹é¡¹ï¼Œä¸€å®šè¦è®¤çœŸé˜…è¯»ï¼š&lt;i&gt;ext4&lt;/i&gt; å¿…é¡»è¦æ¯å°æœºå™¨éƒ½æ›´æ–°ï¼›&lt;/p&gt;&lt;p&gt;3. [10.9.97.254]: Ansible FAILED! =&amp;gt; playbook: bootstrap.yml; TASK: check_system_optional : Preflight check - Check TiDB server&#39;s RAM; message: {&quot;changed&quot;: false, &quot;msg&quot;: &quot;This machine does not have sufficient RAM to run TiDB, at least 16000 MB.&quot;}  - å†…å­˜ä¸è¶³çš„é—®é¢˜&lt;/p&gt;&lt;ul&gt;&lt;li&gt;å¯ä»¥åœ¨æ‰§è¡Œçš„æ—¶å€™å¢åŠ å‚æ•°æ¥é¿å…&lt;/li&gt;&lt;li&gt;ansible-playbook bootstrap.yml --extra-vars &quot;dev_mode=True&quot;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;4. å¦‚æœç£ç›˜æŒ‚è½½æœ‰é—®é¢˜ï¼Œå¯ä»¥é‡æ–°æ¸…é™¤æ•°æ®åå†é‡æ–°å¯åŠ¨ï¼›&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;code class=&quot;inline&quot;&gt;ansible-playbook unsafe_cleanup_data.yml&lt;/code&gt;  ï¼ˆ&lt;a href=&quot;https://github.com/pingcap/docs/blob/master/op-guide/ansible-operation.md&quot;&gt;https://github.com/pingcap/docs/blob/master/op-guide/ansible-operation.md&lt;/a&gt;ï¼‰&lt;/li&gt;&lt;/ul&gt;&lt;h2&gt;&lt;b&gt;å‚è€ƒèµ„æ–™&lt;/b&gt;&lt;/h2&gt;&lt;ol&gt;&lt;li&gt;&lt;a href=&quot;https://github.com/pingcap/pd&quot;&gt;https://github.com/pingcap/pd&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://github.com/pingcap/tidb-bench/tree/master/tpch&quot;&gt;tidb-bench tpch&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://github.com/pingcap/go-ycsb&quot;&gt;https://github.com/pingcap/go-ycsb&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://github.com/pingcap/docs-cn/blob/master/op-guide/ansible-deployment.md&quot;&gt;Ansible éƒ¨ç½²&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://github.com/pingcap/docs-cn/blob/master/op-guide/dashboard-pd-info.md&quot;&gt;PD é‡è¦ç›‘æ§æŒ‡æ ‡è¯¦è§£&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://pingcap.github.io/docs/op-guide/ansible-deployment-rolling-update/&quot;&gt;ä½¿ç”¨ TiDB-Ansible å‡çº§ TiDB&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;http://tool.oschina.net/codeformat/json&quot;&gt;åœ¨çº¿ä»£ç æ ¼å¼åŒ–&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://github.com/liufuyang/rust-nb-server&quot;&gt;rust-nb-server&lt;/a&gt;&lt;/li&gt;&lt;/ol&gt;&lt;blockquote&gt;TiDB Hackathon 2018 å…±è¯„é€‰å‡ºå…­ä¸ªä¼˜ç§€é¡¹ç›®ï¼Œæœ¬ç³»åˆ—æ–‡ç« å°†ç”±è¿™å…­ä¸ªé¡¹ç›®æˆå‘˜ä¸»ç¬”ï¼Œåˆ†äº«ä»–ä»¬çš„å‚èµ›ç»éªŒå’Œæˆæœã€‚æˆ‘ä»¬éå¸¸å¸Œæœ›æœ¬å±Š Hackathon è¯ç”Ÿçš„ä¼˜ç§€é¡¹ç›®èƒ½å¤Ÿåœ¨ç¤¾åŒºä¸­å»¶ç»­ä¸‹å»ï¼Œæ„Ÿå…´è¶£çš„å°ä¼™ä¼´ä»¬å¯ä»¥åŠ å…¥è¿›æ¥å“¦ã€‚&lt;/blockquote&gt;</description>
<author>ZoeyZhai</author>
<guid isPermaLink="false">2018-12-18-52647715</guid>
<pubDate>Tue, 18 Dec 2018 00:00:00 +0800</pubDate>
</item>
<item>
<title>TiDB DevCon 2019 æŠ¥åå¼€å¯ ï¼šå¹´åº¦æœ€é«˜è§„æ ¼çš„ TiDB æŠ€æœ¯å¤§ä¼š</title>
<link>https://henix.github.io/feeds/zhuanlan.newsql/2018-12-17-52603507.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/52603507&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-6a42d7ca1d0fcdcda28d72e7485505e1_r.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;blockquote&gt;&lt;b&gt;&lt;i&gt;å¹´åº¦æœ€é«˜è§„æ ¼çš„ TiDB æŠ€æœ¯å¤§ä¼š&lt;/i&gt;&lt;/b&gt;&lt;br&gt;&lt;b&gt;&lt;i&gt;æµ·å†…å¤–åŠ¨æ€åŠæˆæœçš„ç»¼åˆå‘ˆç°&lt;/i&gt;&lt;/b&gt;&lt;br&gt;&lt;br&gt;&lt;i&gt;æœ€æ–°æ ¸å¿ƒæŠ€æœ¯è§£è¯»&lt;/i&gt;&lt;br&gt;&lt;i&gt;å¤šä¸ªæˆæœé¦–æ¬¡äº®ç›¸&lt;/i&gt;&lt;br&gt;&lt;i&gt;2019 RoadMap å±•æœ›&lt;/i&gt;&lt;br&gt;&lt;i&gt;14 ä½æµ·å†…å¤–åŸºç¡€æ¶æ„é¢†åŸŸæŠ€æœ¯å¤§å’–&lt;/i&gt;&lt;br&gt;&lt;i&gt;8 ä¸ªè·¨è¡Œä¸šå¤šåœºæ™¯çš„ç”¨æˆ·å®æˆ˜ç»éªŒ&lt;/i&gt;&lt;br&gt;&lt;i&gt;1 å°æ—¶ Demo Show&lt;/i&gt;&lt;br&gt;&lt;br&gt;&lt;i&gt;åªä¸ºå‘ä½ æè¿°å¯ä»¥é¢„è§çš„&lt;/i&gt;&lt;br&gt;&lt;i&gt;æ•°æ®åº“çš„æœªæ¥&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;1970 å¹´å…³ç³»æ¨¡å‹çš„æå‡ºï¼Œåœ¨æ•°æ®åº“é¢†åŸŸå¦‚åŒæ‰“å¼€äº†ä¸€æ‰‡åˆ›ä¸–ä¹‹é—¨ï¼Œè¿‘åŠä¸ªä¸–çºªä»¥æ¥ç›¸å…³äº§å“è¿…é€Ÿè¿­ä»£ï¼Œæ–°æ—§å…±ç”Ÿï¼Œæˆ‘ä»¬è¯•å›¾æ´æ‚‰å…¶ä¸­è§„å¾‹ï¼Œå¯»æ±‚ä¸€ä¸ªé—®é¢˜çš„ç­”æ¡ˆï¼š&lt;b&gt;ä»€ä¹ˆæ˜¯æœªæ¥çš„æ•°æ®åº“ï¼Ÿ&lt;/b&gt;&lt;/p&gt;&lt;p&gt;ç„¶è€Œè°ˆåˆ°â€œæœªæ¥â€éš¾å…æ€»æ˜¯å®è§‚è€Œæ¨¡ç³Šï¼Œæˆ‘ä»¬å°è¯•&lt;b&gt;ç”¨è‡ªå·±çš„æ–¹å¼&lt;/b&gt;æ¥è¡¨è¾¾å¯¹æœªæ¥çš„å®šä¹‰ï¼šå¹´åº¦è§„æ ¼æœ€é«˜çš„ TiDB æŠ€æœ¯å¤§ä¼š&lt;b&gt;#TiDB DevCon 2019&lt;/b&gt; æ­£å¼å¼€å¯ã€‚&lt;/p&gt;&lt;p&gt;æˆ‘ä»¬å°†ä»æŠ€æœ¯ç†å¿µå¼€å§‹ï¼Œå°½æ‰€èƒ½åœ°å‘å‰&lt;b&gt;çœºæœ›&lt;/b&gt;ï¼Œåˆ†äº«æˆ‘ä»¬æ‰€çœ‹åˆ°çš„ï¼Œå’Œå³å°†ä»˜è¯¸è¡ŒåŠ¨çš„ä¸€åˆ‡æ¢ç´¢ã€‚&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;æ—¶é—´ï¼š&lt;/b&gt;2019 å¹´ 1 æœˆ 19 æ—¥&lt;/li&gt;&lt;li&gt;&lt;b&gt;åœ°ç‚¹ï¼š&lt;/b&gt;åŒ—äº¬å¸‚ æœé˜³åŒº æ¨±èŠ±å›­ä¸œè¡—ç”² 2 å· åŒ—äº¬æœè£…å­¦é™¢å†… ä¸­å…³æ‘æ—¶å°šäº§ä¸šåˆ›æ–°å›­ äºŒå±‚&lt;/li&gt;&lt;/ul&gt;&lt;h2&gt;&lt;b&gt;ä¸€ã€è®²å¸ˆä»‹ç»&lt;/b&gt;&lt;/h2&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-2a26fa50a77cf471c140d147c90ae197_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;2132&quot; data-rawheight=&quot;1222&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-2a26fa50a77cf471c140d147c90ae197&quot; data-watermark-src=&quot;v2-a46f637fcb69f4c004b5823f8c894e04&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-398e8319675f83c5a139ad62a1a04736_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;2192&quot; data-rawheight=&quot;1228&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-398e8319675f83c5a139ad62a1a04736&quot; data-watermark-src=&quot;v2-f189a9c9b3c7ed2bc84b78203c5d6eb4&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;h2&gt;&lt;b&gt;äºŒã€ä¼šè®®è®®ç¨‹&lt;/b&gt;&lt;/h2&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;8:40 - 9:30&lt;/b&gt; &lt;/li&gt;&lt;/ul&gt;&lt;p&gt;     å…¥åœºç­¾åˆ°&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;9:30 - 9:50  &lt;/b&gt; &lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;Opening Keynote &lt;/b&gt;&lt;/p&gt;&lt;p&gt;     åˆ˜å¥‡ï¼ŒPingCAP è”åˆåˆ›å§‹äººå…¼ CEO    &lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;9:50 - 10:10    &lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;The Global Scale of TiDB (English)   &lt;/b&gt;&lt;/p&gt;&lt;p&gt;     Morgan Tocker, PingCAP Senior Product and Community Manager&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;10:10 - 11:10   &lt;/b&gt; &lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;ç¤¾åŒºå®è·µä¸“åœº 1    &lt;/b&gt;&lt;/p&gt;&lt;p&gt;     - ç¾å›¢æ•°æ®åº“æ¶æ„æ¼”å˜åŠå±•æœ›&lt;/p&gt;&lt;p&gt;        ç¾å›¢ç‚¹è¯„ - èµµåº”é’¢    &lt;/p&gt;&lt;p&gt;     - æ™ºèƒ½ç‰©è”ç½‘çš„é«˜å†™å…¥åœºæ™¯è§£å†³ä¹‹é“&lt;/p&gt;&lt;p&gt;        å°ç±³ - æ½˜å‹é£    &lt;/p&gt;&lt;p&gt;     - æ–°ä¸œæ–¹æ–°ä¸€ä»£æŠ¥åç³»ç»Ÿæ•°æ®åº“é€‰å‹&lt;/p&gt;&lt;p&gt;        æ–°ä¸œæ–¹ - å‚…å°‘å³°    &lt;/p&gt;&lt;p&gt;     - TiDB åœ¨é“¶è¡Œæ ¸å¿ƒé‡‘èé¢†åŸŸçš„ç ”ç©¶ä¸å®è·µ&lt;/p&gt;&lt;p&gt;       åŒ—äº¬é“¶è¡Œ - äºæŒ¯å    &lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;11:10 - 11:50    &lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;The Way to TiDB 3.0&lt;/b&gt;&lt;/p&gt;&lt;p&gt;     ç”³ç ¾ï¼ŒPingCAP Engineering VP  &lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;11:50 - 13:20  &lt;/b&gt; &lt;/li&gt;&lt;/ul&gt;&lt;p&gt;     åˆé¤    &lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;13:20 - 14:00&lt;/b&gt; &lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;ç¤¾åŒºè£èª‰æ—¶åˆ»  &lt;/b&gt; &lt;/p&gt;&lt;p&gt;     å´”ç§‹,  PingCAP è”åˆåˆ›å§‹äºº  &lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;14:00 - 15:00    &lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;ç¤¾åŒºå®è·µä¸“åœº 2    &lt;/b&gt;&lt;/p&gt;&lt;p&gt;     - TiDB åœ¨å¾®ä¼—é“¶è¡Œçš„å®è·µä¸åº”ç”¨&lt;/p&gt;&lt;p&gt;        å¾®ä¼—é“¶è¡Œ - èƒ¡ç›¼ç›¼    &lt;/p&gt;&lt;p&gt;    - All inï¼è½¬è½¬ TiDB å¤§è§„æ¨¡å®è·µä¹‹æ—…&lt;/p&gt;&lt;p&gt;        è½¬è½¬ - å­™ç„    &lt;/p&gt;&lt;p&gt;    - TiDB åœ¨å°çº¢ä¹¦å®æ—¶é”€å”®æ•°æ®åˆ†æçš„æœ€ä½³å®è·µ  &lt;/p&gt;&lt;p&gt;       å°çº¢ä¹¦ - å¼ ä¿Šéª  &lt;/p&gt;&lt;p&gt;    - How to Add a New Feature to TiDB - From a Contributorâ€™s â€œViewâ€&lt;/p&gt;&lt;p&gt;       æŸé‡‘èæœºæ„ - æ½˜è¿ª&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;15:00 - 15:20    &lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;      èŒ¶æ­‡  &lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;15:20 - 15:40  &lt;/b&gt; &lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;TiKV - A Strong Foundation (English)    &lt;/b&gt;&lt;/p&gt;&lt;p&gt;      Ana Hobdenï¼ŒPingCAP Senior Database Engineer on TiKV&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;15:40 - 16:40    &lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;Demo Session    &lt;/b&gt;&lt;/p&gt;&lt;p&gt;     é»„ä¸œæ—­ï¼ŒPingCAP è”åˆåˆ›å§‹äººå…¼ CTO&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;16:40 - 17:00&lt;/b&gt; &lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;The Future of Database    &lt;/b&gt;&lt;/p&gt;&lt;p&gt;     é»„ä¸œæ—­ï¼ŒPingCAP è”åˆåˆ›å§‹äººå…¼ CTO&lt;/p&gt;&lt;h2&gt;&lt;b&gt;ä¸‰ã€æŠ¥åæ³¨å†Œå¼€å¯&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;TiDB DevCon 2019 å³æ—¥èµ·å¼€æ”¾æŠ¥åæ³¨å†Œï¼Œåˆ†ä¸ºç¤¾åŒºè´¡çŒ®è€…æ³¨å†Œå’Œæ ‡å‡†æ³¨å†Œä¸¤ç§ç±»å‹ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;æŠ¥åé“¾æ¥ğŸ‘‰ï¼š&lt;a href=&quot;https://pingcap.com/community/devcon2019/&quot;&gt;DevCon 2019&lt;/a&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&gt;1. ç¤¾åŒºè´¡çŒ®è€…æ³¨å†Œï¼ˆÂ¥0ï¼‰&lt;/p&gt;&lt;ul&gt;&lt;li&gt;æˆ‘ä»¬å·²ç»å°† TiDB ç¤¾åŒºè´¡çŒ®è€…ä¸“å±&lt;b&gt;ã€éªŒè¯ç ã€‘&lt;/b&gt;å‘é€åˆ°å¤§å®¶åœ¨ GitHub ä¸Šçš„é¢„ç•™ä¸ªäººé‚®ç®±ï¼Œè¯·æ³¨æ„æŸ¥æ”¶ã€‚å¦‚æœæ²¡æœ‰æ”¶åˆ°ï¼Œå¯ä»¥è”ç³» TiDB Robotï¼ˆå¾®ä¿¡å·ï¼štidbaiï¼‰ã€‚&lt;/li&gt;&lt;li&gt;å¤§å®¶å¡«å†™æŠ¥åè¡¨å•æ—¶åŠ¡å¿…å¡«å†™ GitHub ID å’ŒéªŒè¯ç ï¼Œå¦åˆ™æ— æ³•å®¡æ ¸é€šè¿‡ã€‚&lt;/li&gt;&lt;li&gt;å³æ—¥èµ·è‡³ 1 æœˆ 17 æ—¥ 18:00 æœŸé—´æ–°å¢ç¤¾åŒºè´¡çŒ®è€…äº¦å¯æ³¨å†Œã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;2. æ ‡å‡†æ³¨å†Œï¼ˆÂ¥1970ï¼‰&lt;/p&gt;&lt;ul&gt;&lt;li&gt;æ ‡å‡†æ³¨å†Œæ— éœ€å®¡æ ¸ã€‚&lt;/li&gt;&lt;li&gt;å¦å¤–ï¼Œæˆ‘ä»¬ä¸ºæ•™èŒäººå‘˜å’Œåœ¨æ ¡å­¦ç”Ÿæä¾›å­¦æœ¯ä¼˜æƒ ï¼ˆç¥¨ä»· Â¥499ï¼‰ï¼Œä»…é™ä¼˜æƒ ç æ³¨å†Œï¼Œç”³è¯·ææ–™ï¼š &lt;/li&gt;&lt;ul&gt;&lt;li&gt;æ•™èŒäººå‘˜ï¼šæ ¡å›­ç½‘ç«™ä¸ªäººä¿¡æ¯é¡µæˆªå›¾ï¼ˆæˆ–æ•™å¸ˆèµ„æ ¼è¯ï¼‰ + æœ¬äººèº«ä»½è¯æ‰«æä»¶ &lt;/li&gt;&lt;li&gt;åœ¨æ ¡å­¦ç”Ÿï¼šæœ¬äººæœ‰æ•ˆå­¦ç”Ÿè¯ + æœ¬äººèº«ä»½è¯æ‰«æä»¶ &lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;p&gt;è¯·å°†ç”³è¯·ææ–™å‘é€åˆ° &lt;a href=&quot;mailto:%20langyuemeng@pingcap.com&quot;&gt;langyuemeng@pingcap.com&lt;/a&gt;ï¼Œå®¡æ ¸ç»“æœå°†é€šè¿‡é‚®ä»¶é€šçŸ¥ã€‚ä¼˜æƒ ç ç”³è¯·æˆªæ­¢æ—¶é—´ 1 æœˆ 17 æ—¥ 18:00ã€‚&lt;/p&gt;&lt;a href=&quot;https://pingcap.com/community/devcon2019/&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;v2-60ab5bd867c2434d70c957a02a2169e1&quot; data-image-width=&quot;1200&quot; data-image-height=&quot;1200&quot; data-image-size=&quot;ipico&quot;&gt;DevCon 2019&lt;/a&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>ZoeyZhai</author>
<guid isPermaLink="false">2018-12-17-52603507</guid>
<pubDate>Mon, 17 Dec 2018 00:00:00 +0800</pubDate>
</item>
<item>
<title>TiQueryï¼šAll Diagnosis in SQL | TiDB Hackathon é¡¹ç›®åˆ†äº«</title>
<link>https://henix.github.io/feeds/zhuanlan.newsql/2018-12-17-52554018.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/52554018&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-e54c5c646a5e75cff2f65c5e0545b6ab_r.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;blockquote&gt;æœ¬æ–‡ä½œè€…æ˜¯æ¥è‡ª TiNiuB é˜Ÿçš„é»„æ¢¦é¾™åŒå­¦ï¼Œä»–ä»¬çš„é¡¹ç›® TiQuery åœ¨æœ¬å±Š TiDB Hackathon  2018 ä¸­è·å¾—äº†ä¸‰ç­‰å¥–ã€‚ TiQuery å¯ä»¥æœé›†è¯Šæ–­é›†ç¾¤é—®é¢˜æ‰€éœ€è¦çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬é›†ç¾¤æ‹“æ‰‘ï¼ŒRegion åˆ†å¸ƒï¼Œé…ç½®ï¼Œå„ç§ç³»ç»Ÿä¿¡æ¯ï¼Œæ•´ç†æˆç»“æ„åŒ–çš„æ•°æ®ï¼Œå¹¶åœ¨ TiDB ä¸­æ”¯æŒç›´æ¥ä½¿ç”¨ SQL è¯­è¨€è¿›è¡ŒæŸ¥è¯¢ï¼Œå¼€å‘å’Œè¿ç»´äººå‘˜å¯ä»¥åœ¨ SQL ç¯å¢ƒæ–¹ä¾¿é«˜æ•ˆåœ°è¿›è¡Œé—®é¢˜è¯Šæ–­ã€‚&lt;/blockquote&gt;&lt;p&gt;&lt;b&gt;&lt;i&gt;â€œè·ç¦» Hackathon ç»“æŸå·²ç»ä¸€ä¸ªå¤šæ˜ŸæœŸäº†ï¼Œæ„Ÿè§‰å¿ƒæƒ…è¿˜æ˜¯æ²¡æœ‰ä»æ¿€æƒ…ä¸­å¹³å¤è¿‡æ¥ã€‚ä¸è¿‡ç”±äºæˆ‘è¯»ä¹¦å°‘ï¼Œè¿™æ—¶å€™å¥½åƒåªèƒ½æ„Ÿæ…¨ä¸€å¥ï¼Œé»‘å®¢é©¬æ‹‰æ¾çœŸæ˜¯å¤ªå¥½ç©äº†â€¦â€¦â€&lt;/i&gt;&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;ç»„é˜Ÿå’Œé€‰é¢˜&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;ç»„é˜Ÿçš„è¿‡ç¨‹æœ‰äº›å´å²–ï¼Œè¿‡ç¨‹ä¸ç»†è¡¨ï¼Œæ€»ä¹‹æœ€åæˆ‘ä»¬å‡‘æˆäº† 4 äººå›¢é˜Ÿï¼š&lt;/p&gt;&lt;p&gt;æˆ‘ï¼ˆmenglongï¼‰å’Œé˜¿æ¯›å“¥æ˜¯ PingCAP å†…éƒ¨å‘˜å·¥ï¼Œæˆ‘åœ¨ TiKV å›¢é˜Ÿï¼Œç›®å‰ä¸»è¦æ˜¯è´Ÿè´£ PD éƒ¨åˆ†çš„ã€‚é˜¿æ¯›å“¥æ˜¯ TiDB ç»„çš„å¼€å‘ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ Go è¯­è¨€åœˆçš„å¤§ä½¬ã€‚&lt;/p&gt;&lt;p&gt;æ™“å³°ï¼ˆID ç±³éº’éºŸï¼‰æ˜¯å¤§æ•°æ®åœˆçš„ç½‘çº¢ï¼Œå¯èƒ½å¾ˆå¤šäººéƒ½åœ¨å„ç§ç¤¾åŒºæˆ–å„ç§å¾®ä¿¡ç¾¤å¶é‡è¿‡ï¼Œå¦å¤–ä»–çš„å…¬å¸å…¶å®ä¹Ÿæ˜¯ä¸Šçº¿äº† TiDB é›†ç¾¤çš„å®¢æˆ·ä¹‹ä¸€ã€‚&lt;/p&gt;&lt;p&gt;èƒ¡äº‰æ¥è‡ªå°ç±³ï¼Œæ˜¯ HBase çš„ committerï¼Œåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿæ–¹é¢æœ‰ä¸°å¯Œçš„ç»éªŒï¼ŒHackathon çš„è¿‡ç¨‹ä¸­è¿˜é¡ºä¾¿ç»™ TiKV é›†ç¾¤çš„å…¨å±€å¤‡ä»½æ–¹æ¡ˆæäº†å‡ ä¸ªå¾ˆå¥½çš„å»ºè®®ï¼Œä¹Ÿæ˜¯ä¸å¾—ä¸æœâ€¦â€¦ä»–è¿˜æœ‰å¦å¤–ä¸€ä¸ªèº«ä»½ï¼Œæ˜¯æˆ‘ä»¬ TiKV ç»„å‘˜å¤§å¦¹å­çš„è€å…¬ï¼Œå¤§å¦¹å­å›è€å®¶ä¼‘äº§å‡äº†äºæ˜¯åªå¾—æ´¾å®¶å±æ¥ä»£ä¸ºè¿‡ä¸ªç˜¾ã€‚&lt;/p&gt;&lt;p&gt;æˆ‘ä»¬å¤§çº¦ä»ä¸€å‘¨ä¹‹å‰å¼€å§‹è®¨è®ºé€‰é¢˜çš„äº‹æƒ…ï¼Œæˆ‘ä»¬æ‰€æœ‰äººéƒ½æ˜¯ç¬¬ä¸€æ¬¡å‚åŠ  Hackathonï¼Œä¹Ÿæ²¡ä»€ä¹ˆé€‰é¢˜çš„ç»éªŒï¼Œç»è¿‡å¾®ä¿¡è¯­éŸ³é•¿æ—¶é—´çš„å¤´è„‘é£æš´ï¼Œå‰åå¤§çº¦æäº†æœ‰äº”å…­ä¸ªæ–¹æ¡ˆï¼Œæœ€ç»ˆæ•²å®šäº† TiQuery è¿™ä¸ªæ–¹æ¡ˆã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;æ–¹æ¡ˆçš„ä¸»è¦çµæ„Ÿæ˜¯æ¥è‡ª facebook çš„å¼€æºé¡¹ç›® osqueryï¼Œå®ƒèƒ½æŠŠç³»ç»Ÿçš„å„ç§ä¿¡æ¯ï¼ˆCPUï¼Œå†…å­˜ï¼Œæ–‡ä»¶ï¼ŒæŒ‚è½½ï¼Œè®¾å¤‡ï¼Œç½‘ç»œè¿æ¥ï¼Œcrontabï¼Œulimitï¼Œiptableï¼Œç­‰ç­‰ç­‰ç­‰ï¼‰æ•´ç†æˆç»“æ„åŒ–æ•°æ®å¹¶æ”¯æŒä»¥ SQL çš„æ–¹å¼è¿›è¡ŒæŸ¥è¯¢ã€‚å½“ç„¶å®ƒæ˜¯ä¸€ä¸ªå•æœºçš„ï¼Œæˆ‘ä»¬éœ€è¦åšä¸ª proxy æŠŠé›†ç¾¤ä¸­æ‰€æœ‰èŠ‚ç‚¹çš„æ•°æ®æ”¶é›†åœ¨ä¸€èµ·ï¼Œæ”¾åœ¨ TiDB é‡Œä¾›ç”¨æˆ·æŸ¥è¯¢ã€‚å†è€ƒè™‘ TiDB äº§å“ç”Ÿæ€çš„å®é™…æƒ…å†µï¼Œæˆ‘ä»¬è¿˜å¯ä»¥æœé›† region åˆ†å¸ƒï¼Œé…ç½®ï¼Œæ—¥å¿—ï¼Œmetrics ç­‰è¯Šæ–­æ‰€éœ€è¦ä¿¡æ¯ç»Ÿä¸€åˆ° SQL æ¥å£é‡Œï¼Œè¿™æ ·å°±å‡çº§æˆäº†ä¸€å¥—å®Œæ•´çš„è¯Šæ–­å·¥å…·ã€‚&lt;/b&gt;&lt;/p&gt;&lt;p&gt;æœ€åé€‰ TiQuery è¿™ä¸ªæ–¹æ¡ˆä¸»è¦è€ƒè™‘äº†è¿™å‡ ç‚¹ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;ä¸éœ€è¦å†™å‰ç«¯ã€‚æˆ‘ä»¬å‡ ä¸ªè™½ç„¶è¯´å¹³æ—¶æˆ–å¤šæˆ–å°‘å†™è¿‡ç‚¹å‰ç«¯ï¼Œä½†æ˜¯æ¯•ç«Ÿæ‰‹ç”Ÿï¼ŒçŸ­æ—¶é—´å¯èƒ½å¾ˆéš¾æå‡ºé…·ç‚«çš„æ•ˆæœï¼Œè€Œä¸”è¿˜æœ‰ç¿»è½¦çš„é£é™©ã€‚äº‹åè¯æ˜è¿™ä¸ªæ‰¬é•¿é¿çŸ­çš„æ€è·¯æ— ç–‘æ˜¯æ­£ç¡®çš„ï¼Œæœ€åæ‹¿åˆ°åæ¬¡çš„ 6 ä¸ªå›¢é˜Ÿåªæœ‰ 2 ä¸ªæ˜¯é‡ç‚¹åœ¨å¯è§†åŒ–è¿™å—çš„ï¼Œè€Œä¸”å‘ˆç°å‡ºæ¥çš„æ•ˆæœä»¥æˆ‘ä»¬çš„æ°´å¹³åº”è¯¥éš¾ä»¥ä¼åŠã€‚&lt;/li&gt;&lt;li&gt;ä¸å®¹æ˜“ç¿»è½¦ã€‚å› ä¸ºæœ‰ facebook/osquery è¿™ä¸ªå¼ºåŠ›é¡¹ç›®åšåç›¾ï¼ŒåŸºæœ¬ä¸Šä¸å­˜åœ¨ç¿»è½¦çš„å¯èƒ½ã€‚åšå®Œ osquery åï¼Œè®¡åˆ’çš„å…¶ä»–éƒ¨åˆ†å¯ä»¥åˆ°æ—¶å€™æ ¹æ®æƒ…å†µå†³å®šè¦ä¸è¦åšï¼Œå¯ä»¥è¯´æ˜¯æ—¢ç¨³åˆæµªã€‚&lt;/li&gt;&lt;li&gt;&lt;b&gt;å®ç”¨æ€§å¼ºã€‚&lt;/b&gt;æˆ‘ä»¬åœ¨æ—¥å¸¸å¸®åŠ©ç”¨æˆ·æ’æŸ¥é—®é¢˜çš„æ—¶å€™ï¼Œç»å¸¸éœ€è¦åœ¨ SQL / æ—¥å¿— / Grafana / pd-ctl / tidb-ctl / ssh å„ç§å·¥å…·æ¥å›åˆ‡æ¢æœé›†å„ç§ä¿¡æ¯ã€‚ç”šè‡³æœ‰æ—¶å€™æ— æ³•ç›´æ¥è®¿é—®ç”¨æˆ·çš„ç¯å¢ƒï¼Œéœ€è¦ä¸€æ­¥ä¸€æ­¥å‘ç”¨æˆ·è¯´æ˜å¦‚ä½•å»æ’æŸ¥ï¼Œåœ¨äº¤æµä¸ŠèŠ±è´¹äº†å¤§é‡ä¸å¿…è¦çš„æ—¶é—´å’Œç²¾åŠ›ã€‚æ‰€ä»¥ TiQuery è¿™ä¸ªé¡¹ç›®è§£å†³çš„æ˜¯åˆ‡å®å­˜åœ¨çš„ç—›ç‚¹ï¼Œå¬é—»å·²ç»æœ‰å®¢æˆ·å‡†å¤‡åœ¨ç”Ÿäº§é›†ç¾¤ä¸­æŠŠ TiQuery ä¸Šçº¿ï¼Œä¹Ÿæ˜¯å¾ˆå¥½çš„ä½è¯ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;h2&gt;&lt;b&gt;æ¯”èµ›è¿‡ç¨‹&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;Day 1&lt;/b&gt;&lt;/p&gt;&lt;p&gt;æ¯”èµ›ç¬¬ä¸€å¤©ã€‚æ—©ä¸Š 10 ç‚¹è¸©ç€ç‚¹æ¥åˆ°å…¬å¸ï¼Œåœ¨å‰å°ç®€å•ç­¾äº†åˆ°é¢†äº†å‘¨è¾¹ï¼Œè½¬èº«è¿›å…¥åŠå…¬åŒºåŸŸï¼Œä¸€ç¬é—´å°±è¢«æ‰‘é¢è€Œæ¥çš„çƒ­çƒˆçš„æ°”æ°›ç»™æ„ŸæŸ“åˆ°äº†ã€‚å¹³å¸¸å®‰é™ç©ºæ—·çš„å·¥ä½œç©ºé—´æ­¤æ—¶å·²æ˜¯æµæµä¸€å ‚ï¼Œå„è·¯å¤§ç¥æœ‰çš„å›´åœ¨ä¸€èµ·æ¢è®¨æ–¹æ¡ˆï¼Œæœ‰çš„å·²ç»æ‰“å¼€ç”µè„‘å¼€å§‹æ”»å…‹æŠ€æœ¯éš¾é¢˜ï¼Œè¿˜æœ‰ä¸å°‘ç›¸äº’ç½‘ä¸Šç†Ÿè¯†å·²ä¹…çš„ç½‘å‹ä»¬åœ¨çƒ­æƒ…åœ°æ‰“ç€æ‹›å‘¼ã€‚&lt;/p&gt;&lt;p&gt;æˆ‘ä¹Ÿå¾ˆå¿«æ‰¾åˆ° TiNiuB é˜Ÿçš„æ ¹æ®åœ°ï¼ŒçŸ­æš‚å¯’æš„åå°±è¿›å…¥äº†å·¥ä½œçŠ¶æ€ã€‚æ ¹æ®ä¹‹å‰å•†é‡çš„åˆ†å·¥ï¼Œæˆ‘ä¸»è¦è´Ÿè´£æŠŠ PD ç›¸å…³çš„æ•°æ®è½¬æˆ table çš„å½¢å¼ã€‚å› ä¸ºå¯¹ Go è¯­è¨€å’Œ PD çš„æ¥å£éƒ½å¾ˆç†Ÿæ‚‰ï¼Œå¾ˆå¿«å°±æŠŠ TiQuery çš„å¤§ä½“æ¡†æ¶ç»™æ’¸å‡ºæ¥äº†ï¼ŒPD ç›¸å…³çš„æ•°æ®æºä¹Ÿä¾æ¬¡ç»™æ•´ç†å‡ºæ¥äº†ã€‚&lt;/p&gt;&lt;p&gt;é˜¿æ¯›å“¥é‚£è¾¹è®¡åˆ’æ˜¯é­”æ”¹ä¸€ç‰ˆ TiDBï¼Œæ¥è¾¾æˆç‰¹å®šè¡¨çš„æ•°æ®ä»è¿œç¨‹æœåŠ¡åŠ è½½è¿™ä¸ªéœ€æ±‚ã€‚æœ¬æ¥æˆ‘ä»¬æƒ³çš„æ˜¯éœ€è¦ hack ä¸€ä¸‹ physical planï¼Œæˆ–è€…å®ç°ä¸€ä¸ªæ–°çš„ storage ä»€ä¹ˆçš„ï¼Œæƒ³æƒ³è¿˜æœ‰äº›å¤æ‚ã€‚åˆ°ä»–å…·ä½“åšçš„æ—¶å€™çŒ›ç„¶å‘ç° InformationSchema è¿™ä¸ªç¥å¥‡çš„å­˜åœ¨ï¼Œç®€å•ä»‹ç»ä¸‹ï¼ŒInformationSchema åŒ…å«äº† TiDB ä¸­ä¸€ç³»åˆ—ç‰¹æ®Šçš„è¡¨ï¼Œå®ƒä»¬çš„æ•°æ®æ˜¯ç›´æ¥ä»å†…å­˜ä¸­ææ¥çš„ï¼Œä¸éœ€è¦ç»è¿‡ physical planï¼Œä¹Ÿä¸éœ€è¦èµ° storageã€‚æ‰€ä»¥æˆ‘ä»¬ä»¿ç…§ InformationSchema çš„æ–¹å¼å¤„ç†ä¸€ä¸‹å°±è¡Œäº†ï¼Œåªä¸è¿‡æ•°æ®æ˜¯ä» TiQuery è·å–è€Œä¸æ˜¯ç›´æ¥åœ¨å†…å­˜é‡Œã€‚&lt;/p&gt;&lt;p&gt;ä¸¤è¾¹å†™å®Œä¹‹åæˆ‘ä»¬å¾ˆå¿«è¿›è¡Œäº†ç®€å•çš„è”è°ƒï¼Œç›´æ¥å°±é€šè¿‡æµ‹è¯•äº†ã€‚çœ‹åˆ° â€œSELECT * FROM pd_storeâ€è·‘å‡ºç»“æœåå¤§å®¶ä¸ç”±åœ°ä¸€é˜µæ¬¢å‘¼ã€‚ä¸å¾—ä¸è¯´ï¼Œå½“ä¸éœ€è¦è€ƒè™‘å¼‚å¸¸é”™è¯¯å¤„ç†ï¼Œä¸éœ€è¦å†™æµ‹è¯•ï¼Œä¸éœ€è¦ review çš„æ—¶å€™å†™ä»£ç çš„æ•ˆç‡æ˜¯çœŸé«˜â€¦â€¦&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-6808c88d870791b49185215a3cba3efb_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;700&quot; data-rawheight=&quot;400&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-6808c88d870791b49185215a3cba3efb&quot; data-watermark-src=&quot;v2-0133f41bf3f82ff2a72446c402dbe5c2&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;ä¸­åˆæˆ‘ä»¬åœ¨å›­åŒºçš„â€œé‚£å®¶å°é¦†â€åƒåˆé¤ã€‚è¿™é‡Œæœ‰ä¸ªå°æ’æ›²ï¼Œèƒ¡äº‰æ—©äº†ä¸ºäº†æ–¹ä¾¿è¿›å›­åŒºæŠŠå¤§å¦¹å­çš„å‘˜å·¥å¡ç»™å¸¦æ¥äº†ï¼Œæˆ‘ä»¬ä¸€åˆè®¡ä¼°æ‘¸å¥¹ä¼‘å‡ä¹‹å‰åº”è¯¥å¡é‡Œè¿˜ç•™äº†ä¸å°‘é’±ï¼Œä¾¿å†³å®šé¥±é¤ä¸€é¡¿åå¼ºè¡Œç”¨å¥¹çš„å¡ä¹°å•ã€‚ç­‰åˆ°äº†ç»“è´¦çš„æ—¶å€™æ‰å‘ç°å¡é‡Œåªç»™ç•™äº† 8 åˆ†é’±â€¦â€¦æœ€ååªå¥½æˆ‘æäº†å¡ï¼Œå¹¶æš—åœ°é‡Œä¸‹å†³å¿ƒå¥½æ­¹å¾—æ‹¿ä¸ªå¥–å›æ¥ï¼Œä¸ç„¶å·é¸¡ä¸æˆè¿˜èš€æŠŠç±³ï¼Œä¸æ­¤åŒæ—¶ä¸ç¦ä¸ºèƒ¡äº‰æœªæ¥æ¼«é•¿çš„å©šå§»ç”Ÿæ´»æäº†æŠŠæ±—ã€‚&lt;/p&gt;&lt;p&gt;ä¸‹åˆæˆ‘ä»¬åŠ å…¥äº† osquery-agent æœåŠ¡è´Ÿè´£ä»ä¸åŒèŠ‚ç‚¹æœé›†ä¸ŠæŠ¥ç³»ç»Ÿä¿¡æ¯ï¼Œå¹¶ç”¨è„šæœ¬æŠŠ osquery çš„æ‰€æœ‰ schema è½¬æˆäº† MySQL å…¼å®¹çš„å½¢å¼å¯¼å…¥è¿› TiDBã€‚è·‘é€šåç®€å•çš„è¯•ç©äº†ä¸‹ï¼ŒåŸºæœ¬ä¸Šèƒ½æŒ‰é¢„æœŸçš„æ–¹å¼è¿è¡Œï¼Œä½†æ˜¯å®ç”¨æ€§æ–¹é¢æœ‰ä¸€äº›ä¸è¶³ã€‚éšåæˆ‘ä»¬ä¸»è¦ä»è¿™å‡ ä¸ªæ–¹é¢è¿›è¡Œä¼˜åŒ–ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;å¢åŠ é›†ç¾¤æ‹“æ‰‘ç»“æ„çš„ä¿¡æ¯ã€‚osquery-agent å˜èº«æˆ tiquery-agentï¼Œé™¤äº† wrap osquery ä¹‹å¤–è¿˜ä¸ŠæŠ¥èŠ‚ç‚¹æ‰€è¿è¡Œçš„æ‰€æœ‰æœåŠ¡ä¿¡æ¯ã€‚&lt;/li&gt;&lt;li&gt;å¼•å…¥ psutil åº“ï¼Œtiquery-agent æ”¯æŒæŸ¥è¯¢é’ˆå¯¹å•ä¸ªæœåŠ¡æ›´ç²¾ç¡®çš„ CPUï¼Œå†…å­˜ç­‰ä¿¡æ¯ã€‚&lt;/li&gt;&lt;li&gt;è°ƒç ” prometheus è½¬æˆ table çš„å¯è¡Œæ€§ï¼Œè¿™ä¸ªæˆ‘ä»¬å‘ç°çŸ­æ—¶é—´ä¸å¤ªå¥½åšï¼Œå°±æ”¾å¼ƒäº†ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;å…¶ä»–åŒæ­¥åœ¨åšçš„äº‹æƒ…åŒ…æ‹¬ç”¨ ansible éƒ¨ç½²äº†ä¸€å¥—æµ‹è¯•é›†ç¾¤ï¼Œå¼€å§‹åšæ¼”ç¤ºç”¨çš„ slidesï¼Œæ¢³ç† TiQuery èƒ½æä¾›çš„åŠŸèƒ½æ•´ç†ä¸€ä¸ªæœ‰è¯´æœåŠ›çš„ user storyã€‚æœŸé—´æˆ‘è¿˜å®¢ä¸²äº†ä¸‹å¯¼å¸ˆçš„è§’è‰²ï¼Œæ”¯æŒäº†å‡ ä¸ªæ¶‰åŠåˆ° PD çš„é¡¹ç›®ã€‚&lt;/p&gt;&lt;p&gt;åˆ°äº†æ™šä¸Šï¼Œæµ‹è¯•é›†ç¾¤ä¸Šå·²ç»èƒ½å®Œå…¨é¡ºç•…åœ°è·‘èµ·æ¥äº†ï¼Œslides åŸºæœ¬ä¸Šå®Œæˆï¼Œæ¼”ç¤ºè¦ç”¨çš„æŸ¥è¯¢ä¹Ÿéƒ½å‡†å¤‡å¥½äº†ã€‚éœ¸å“¥ï¼ˆå¯¼å¸ˆå›¢æˆå‘˜&lt;b&gt;éŸ©é£&lt;/b&gt;ï¼Œäººç§° SQL å°ç‹å­ï¼‰å¸®æˆ‘ä»¬æ‰‹å†™äº†ä¸€ä¸ªå¤æ‚çš„ 4 è¡¨ JOINï¼Œä¸€æ°”å‘µæˆï¼Œå¤§å®¶çº·çº·è¡¨ç¤ºå‘å¤§ä½¬ä½å¤´ã€‚&lt;/p&gt;&lt;p&gt;23 ç‚¹å·¦å³ï¼Œæˆ‘åˆå»æ•´ä¸ªèµ›åœºæºœè¾¾äº†ä¸€åœˆï¼Œå‘ç°æ¯”è¾ƒæœ‰ç«äº‰åŠ›çš„å‡ ä¸ªé¡¹ç›®è¦ä¹ˆè¿˜åœ¨åŸ‹å¤´è‹¦å¹²ï¼Œè¦ä¹ˆå°±æ˜¯ block åœ¨æŠ€æœ¯éš¾ç‚¹ä¸Šç—›ä¸æ¬²ç”Ÿã€‚å½“æ—¶æˆ‘ä»¬å°±æ„Ÿè§‰èƒœåˆ¸åœ¨æ¡äº†ï¼Œç®€å•å•†é‡äº†ä¸€ä¸‹å°±å„è‡ªå›å®¶ä¼‘æ¯ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;Day 2&lt;/b&gt;&lt;/p&gt;&lt;p&gt;ç¬¬äºŒå¤©æ—©ä¸Šè¿‡æ¥å…ˆæ˜¯åˆè½¬äº†ä¸€åœˆæ¢æŸ¥æ•Œæƒ…ï¼Œå½“æ—¶è„‘æµ·é‡Œå°±å†’å‡ºæ¥â€œé¾Ÿå…”èµ›è·‘â€çš„æ•…äº‹ã€‚&lt;br&gt;&lt;/p&gt;&lt;p&gt;å‡ ä¸ªå¯è§†åŒ–çš„é¡¹ç›®ï¼Œæ˜¨å¤©æ™šä¸Šèµ°ä¹‹å‰è¿˜å‡ ä¹æ˜¯ç™½æ¿ä¸€ç‰‡ï¼Œä¸€å¤œä¹‹é—´å°±é…·ç‚«åˆ°æ²¡æœ‹å‹äº†ï¼Œå°¤å…¶æ˜¯å‡¤å‡°é˜Ÿï¼ŒçœŸç»™äººä¸€ç§å±±é¸¡å˜å‡¤å‡°çš„æ„Ÿè§‰ã€‚è¿˜æœ‰ TiBoysï¼Œæ˜¨å¤©æˆ‘ç¢ç£¨ç€é¡¹ç›®å¤ªå®å¤§ï¼Œé“å®šæ²¡æ³•æå‡ºæ¥çš„ï¼Œæ—©ä¸Šå»ä¸€çœ‹ï¼Œreadme é‡Œçš„ todo list å·²ç»åŸºæœ¬ä¸Šå…¨ç»™å‹¾ä¸Šäº†ï¼Œå¾ˆéš¾æƒ³åƒè¿™ä¸€å¤œä»–ä»¬ç»å†äº†ä»€ä¹ˆâ€¦â€¦&lt;/p&gt;&lt;p&gt;æˆ‘ä»¬å½“å¤©å…¶å®å°±æ²¡åšä»€ä¹ˆäº‹æƒ…äº†ï¼Œå°±æ•´ç†äº†ä¸‹é¡¹ç›®æ–‡æ¡£ä»€ä¹ˆçš„ï¼Œè¿˜æ‰¾äº†ä¸ªé©¬é‡Œå¥¥çš„å›¾ç‰‡ ps äº†ä¸‹ã€‚&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-068739583a743493fa8c42ee150f4bb7_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;600&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-068739583a743493fa8c42ee150f4bb7&quot; data-watermark-src=&quot;v2-bc600f7bf47f245cd4610e8a97926983&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;ä¸‹åˆçš„ Demo æˆ‘ä»¬æ’åœ¨æœ€åå‡ºåœºï¼Œç”±èƒ¡äº‰å‡ºåœºæ¼”ç¤ºã€‚æ•´ä¸ªè¿‡ç¨‹å‡ºå¥‡åœ°é¡ºç•…ï¼Œè¯„å§”çš„ç–‘é—®ä¹Ÿé¡ºç•…çš„è§£ç­”äº†ï¼Œå…¶å®æˆ‘ä»¬çš„é¡¹ç›®æœ¬èº«æ¯”è¾ƒç®€å•ï¼Œè¦åšçš„äº‹æƒ…ä¸€ä¸¤å¥è¯å°±èƒ½è¯´æ¸…æ¥šã€‚ç•¥æœ‰é—æ†¾çš„æ˜¯å½“æ—¶èƒ¡äº‰å¯èƒ½æ˜¯è¿‡äºæ¿€åŠ¨ï¼Œå…³äº TiQuery å…·ä½“æœ‰å“ªäº›å®ç”¨åœºæ™¯æ²¡æœ‰ç»†è¯´ã€‚&lt;/p&gt;&lt;p&gt;æœ€åæˆ‘ä»¬åœ¨ä¼—å¤šä¼˜ç§€çš„ä½œå“ä¸­æ€å‡ºé‡å›´ï¼Œä¾¥å¹¸æ‹¿åˆ°äº†ä¸‰ç­‰å¥–ï¼Œç¬¬ä¸€æ¬¡å‚èµ›çš„å¤§å®¶éƒ½å¾ˆå…´å¥‹ï¼Œæ™šä¸Šè‡ªç„¶æ˜¯åˆå‡ºå»å¥½å¥½è…è´¥äº†ä¸€æŠŠï¼Œå¹¶ç›¸çº¦ä»¥åå†æ‰¾æœºä¼šå‚åŠ ç±»ä¼¼çš„æ´»åŠ¨â€¦â€¦&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-7030f9a748d5ae252c05215e771c1edc_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;594&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-7030f9a748d5ae252c05215e771c1edc&quot; data-watermark-src=&quot;v2-e67afd03449cb4452535ebaab0959e9e&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;h2&gt;&lt;b&gt;æ„Ÿæƒ³å’Œæ€»ç»“&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;æˆ‘æœ¬äººå–œæ¬¢è·‘æ­¥ï¼Œä¹Ÿå‚åŠ è¿‡å¤šæ¬¡é©¬æ‹‰æ¾èµ›ï¼Œå…¶å®é©¬æ‹‰æ¾èµ›ä¸ä»…åœ¨äºç«æŠ€ï¼Œä¹Ÿä¸ä»…åœ¨äºåšæŒè·‘å®Œé‚£ 42kmï¼Œæ›´é‡è¦çš„æ˜¯å®ƒæ˜¯ä¸€å¤§ç¾¤æœ‰å…±åŒçˆ±å¥½çš„äººèšåœ¨ä¸€èµ·çš„ä¸€æ¬¡ç‹‚æ¬¢ã€‚ä»è¿™ä¸ªè§’åº¦çœ‹ï¼Œâ€œé»‘å®¢é©¬æ‹‰æ¾â€çœŸçš„æ˜¯éå¸¸è´´åˆ‡çš„ä¸€ä¸ªåå­—ã€‚åœ¨è¿™é‡Œæˆ‘æƒ³æ„Ÿè°¢ PingCAP å’Œå¿—æ„¿è€…ä»¬çš„ç²¾å¿ƒç»„ç»‡ï¼Œæä¾›äº†è¿™ä¹ˆå¥½çš„ä¸€ä¸ªæœºä¼šè®©å¤§å®¶æœ‰æœºä¼šäº’ç›¸æ¬£èµï¼Œåˆ‡ç£‹ï¼Œäº¤æµï¼Œå­¦ä¹ ã€‚&lt;/p&gt;&lt;p&gt;é€šè¿‡è¿™æ¬¡æ¯”èµ›æˆ‘ä¹Ÿç§¯æ”’äº†ä¸€äº›ç»éªŒï¼Œæˆ–è€…è¯´ä¸‹æ¬¡å‚åŠ  Hackathon ä¼šå»è€ƒè™‘çš„ä¸€äº›ç‚¹å§ï¼Œåœ¨è¿™é‡Œåˆ†äº«å‡ºæ¥ä¾›å¤§å®¶æ¢è®¨ï¼š&lt;/p&gt;&lt;p&gt;&lt;b&gt;THINK BIG&lt;/b&gt;ã€‚æˆ‘ä»¬åœ¨é€‰æ–¹æ¡ˆçš„æ—¶å€™ç‰¹åˆ«æ€•æƒ³å¤æ‚äº†åˆ°æ—¶å€™åšä¸å‡ºæ¥ç„¶åç¿»è½¦ï¼Œå®é™…ä¸Šåœ¨ Hackathon æ¯”èµ›æ—¶çˆ†å‘å‡ºçš„æ½œèƒ½ä¼šè¿œè¶…è‡ªå·±çš„æƒ³è±¡ï¼Œç»“æœå°±æ˜¯æˆ‘ä»¬è¿…é€Ÿå°±å®Œå·¥äº†åé¢å…¶å®æ— æ‰€äº‹äº‹â€¦â€¦å¯ä»¥ç®€å•é’ˆå¯¹ç¼–ç¨‹é€Ÿåº¦ç®—ä¸‹è´¦ï¼šä¸ç”¨è€ƒè™‘å¼‚å¸¸å¤„ç†ï¼Œæ•ˆç‡ x2ï¼Œä¸ç”¨å†™å•å…ƒæµ‹è¯•ï¼Œæ•ˆç‡ x3ï¼Œä¸ç”¨ code reviewï¼Œæ•ˆç‡ x2ï¼Œä¸ç”¨è€ƒè™‘ä¼˜é›…è®¾è®¡å‰åå…¼å®¹ï¼Œæ•ˆç‡ x2ï¼Œå…¨å¤© 24 å°æ—¶å·¥ä½œï¼Œæ•ˆç‡ x3ï¼ˆæ ¹æ®è´µå¸å…·ä½“æƒ…å†µå¯è°ƒæ•´ä¸º x2ï¼‰ï¼Œå†åŠ ä¸Šæ˜¯å‡ ä¸ªäººä¸€èµ·åšçš„ï¼Œç²—ç•¥ç®—ä¸‹æ¥ 24 å°æ—¶å†…è¶³ä»¥åšå®Œå¹³æ—¶éœ€è¦å‡ ä¸ªæœˆæ‰èƒ½å®Œæˆçš„äº‹æƒ…ï¼Œå› æ­¤æˆ‘ä»¬è®¾è®¡æ–¹æ¡ˆæ—¶å¯ä»¥å°½ç®¡å¾€å¤§äº†æƒ³ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;SHOW OFF ALL&lt;/b&gt;ã€‚æ¯”èµ›ä¹‹å‰æˆ‘ä»¬å°±å·²ç»æ„è¯†åˆ° Demo å±•ç¤ºç¯èŠ‚éå¸¸å…³é”®ï¼Œä½†æ˜¯å¯æƒœè¿™å—è¿˜æ˜¯åšå¾—ä¸å¤Ÿå¥½ï¼Œæœ‰äº›èŠ±åŠ›æ°”åšäº†çš„åŠŸèƒ½æœ€ç»ˆæ²¡æœ‰æœ€ååœ¨ Demo æ—¶å±•ç°å‡ºæ¥ï¼Œä»Šåå‚åŠ ç±»ä¼¼çš„æ¯”èµ›æ—¶ä¼šæ›´åŠ æ³¨æ„è¿™ä¸€ç‚¹ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;TiQuery é¡¹ç›®åŠå…¶æœªæ¥&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;æœ€åå†èŠ±ä¸€äº›ç¯‡å¹…æ¥æ¨å¹¿ä¸‹ TiQuery è¿™ä¸ªé¡¹ç›®å§ã€‚&lt;/p&gt;&lt;p&gt;é¦–å…ˆæ˜ç¡®ä¸€ç‚¹ï¼Œå®ƒä¸æ˜¯è¦æ›¿æ¢æ‰å·²æœ‰çš„æŸ¥æ—¥å¿—ï¼Œçœ‹ metricsï¼Œè°ƒç”¨ PD API ç­‰ç°æœ‰çš„è¯Šæ–­é—®é¢˜æ‰‹æ®µï¼Œè€Œæ˜¯æä¾›ä¸€ç§æ–°çš„é€”å¾„å’Œå¯èƒ½ï¼Œå³ç›´æ¥ä½¿ç”¨ SQL è¯­è¨€ï¼Œå¹¶ä¸”è¿™ç§é€”å¾„åœ¨å¾ˆå¤šåœºæ™¯ä¸‹ä¼šæ›´æ–¹ä¾¿ç”šè‡³æ˜¯å˜ä¸å¯èƒ½ä¸ºå¯èƒ½ã€‚&lt;/p&gt;&lt;p&gt;æ¯”å¦‚æˆ‘ä»¬å¹³å¸¸å®šä½ä¸€ä¸ªæ…¢ SQLï¼Œå¯èƒ½éœ€è¦å…ˆåœ¨ SQL ç¯å¢ƒä¸­ç¡®è®¤æœ‰é—®é¢˜çš„è¯­å¥ï¼Œç„¶åå»æ—¥å¿—ä¸­æ‰¾å‡ºå“åº”æ—¶é—´é•¿çš„ Regionï¼Œéšåä½¿ç”¨ pd-ctl å»æŸ¥è¯¢ Region çš„ä¿¡æ¯ï¼Œç„¶åå†æ ¹æ® leader æ‰€åœ¨çš„ TiKV ID æŸ¥è¯¢åˆ°å¯¹åº” TiKV æ‰€åœ¨çš„èŠ‚ç‚¹ï¼Œç„¶åå† ssh ç™»å½•åˆ°å¯¹åº”çš„èŠ‚ç‚¹æŸ¥è¯¢å…³é”®çº¿ç¨‹çš„ CPU å ç”¨æƒ…å†µâ€¦â€¦&lt;/p&gt;&lt;p&gt;å¦‚æœéƒ¨ç½²äº† TiQueryï¼Œä»¥ä¸Šæ“ä½œéƒ½å¯ä»¥åœ¨ SQL ç¯å¢ƒä¸­æå®šï¼Œä¸ç”¨å„ç§å·¥å…·æ¥å›åˆ‡æ¢ï¼Œè€Œä¸”é€šè¿‡ SQL çš„å…³è”æŸ¥è¯¢åŠŸèƒ½ï¼Œä»¥ä¸Šæ•´ä¸ªæµç¨‹ç”šè‡³åªéœ€è¦ä¸€æ¡è¯­å¥ã€‚&lt;/p&gt;&lt;p&gt;å†æ¯”å¦‚ï¼Œå®¢æˆ·çš„ç¯å¢ƒå¯èƒ½å¯¹è®¿é—®æŸäº›èµ„æºæœ‰é™åˆ¶ï¼Œæ¯”å¦‚æ²¡æœ‰æƒé™ ssh ç™»å½•å¯¹åº”çš„æœåŠ¡å™¨ï¼Œé˜²ç«å¢™çš„åŸå› æ— æ³•æŸ¥çœ‹ Grafanaï¼Œè¿™æ—¶ TiQuery å°±èƒ½å¸®ä¸”æˆ‘ä»¬æ‹¿åˆ°åŸæœ¬æ‹¿ä¸åˆ°çš„ä¿¡æ¯ã€‚è¿˜æœ‰çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ— æ³•ç›´æ¥è¿æ¥å®¢æˆ·çš„é›†ç¾¤ï¼Œåªèƒ½è¿œç¨‹æŒ‡å¯¼å®¢æˆ·å»è¯Šæ–­é—®é¢˜ï¼Œè¿™ç§æƒ…å†µä¸‹ä¸ç”¨å»è´¹åŠ›æ•™ä¼šå®¢æˆ·ç”¨å„ç§å·¥å…·äº†ï¼Œç›´æ¥æ‰”è¿‡å»ä¸€æ¡ SQLï¼Œå²‚ä¸ç¾å“‰ã€‚&lt;/p&gt;&lt;p&gt;å¦å¤–ï¼ŒSQL ä½œä¸ºä¸€é—¨æ ‡å‡†åŒ–çš„æŸ¥è¯¢è¯­è¨€ï¼Œåœ¨æ˜“ç”¨æ€§æ–¹é¢æœ‰ç€å¤©ç„¶çš„ä¼˜åŠ¿ï¼Œä¸ä»…æ–¹ä¾¿ä¸äº†è§£ TiDB çš„ DBA å¿«é€Ÿä¸Šæ‰‹ï¼Œå…¶ä»–å¤–éƒ¨ç³»ç»Ÿä¹Ÿèƒ½æ–¹ä¾¿åœ°å¯¹æ¥ï¼ˆæ¯”å¦‚å¤–éƒ¨ç›‘æ§æŠ¥è­¦ç³»ç»Ÿï¼‰ã€‚&lt;/p&gt;&lt;p&gt;å½“ç„¶äº†ï¼ŒTiQuery é¡¹ç›®å¦‚æœçœŸè¦åœ¨ä¸¥è‚ƒçš„ç”Ÿäº§ç¯å¢ƒä¸Šçº¿ï¼Œè¿˜æœ‰è®¸å¤šå·¥ä½œè¦åšï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;å®Œå–„å¼‚å¸¸å¤„ç†ï¼Œé‡æ„ï¼Œæ–‡æ¡£çš„å®Œå–„&lt;/li&gt;&lt;li&gt;æ›´å¤š schema æ”¯æŒï¼ŒåŒ…æ‹¬æ—¥å¿—æ–‡ä»¶ï¼Œprometheus metrics ç­‰&lt;/li&gt;&lt;li&gt;tidb-ansible é›†æˆï¼ŒåŒ…æ‹¬éƒ¨ç½² tiquery-agent æœåŠ¡ï¼Œé…ç½®ç”Ÿæˆï¼Œå®‰è£… osquery ç­‰&lt;/li&gt;&lt;li&gt;TiDB æ”¯æŒå¤–éƒ¨æ•°æ®æºåŠ è½½æ•°æ®ï¼ˆè¿™ä¸ªç‰¹æ€§åœ¨ Hackathon å…¶ä»–é¡¹ç›®ä¹Ÿæœ‰å„è‡ªçš„å®ç°ï¼ŒæœŸå¾…èƒ½åˆå…¥ TiDB ä¸»å¹²ï¼‰&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;æœ€åï¼Œé¡¹ç›®çš„åœ°å€åœ¨&lt;/b&gt;&lt;/p&gt;&lt;a href=&quot;https://github.com/TiNiuB/tiquery&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;v2-b79fd3efb6bcd737367065f0bda81a7a&quot; data-image-width=&quot;400&quot; data-image-height=&quot;400&quot; data-image-size=&quot;ipico&quot;&gt;TiNiuB/tiquery&lt;/a&gt;&lt;p&gt;&lt;b&gt;æœŸå¾…å¤§å®¶æ¥å…±åŒå®Œå–„ï¼&lt;/b&gt;&lt;/p&gt;&lt;blockquote&gt;TiDB Hackathon 2018 å…±è¯„é€‰å‡ºå…­ä¸ªä¼˜ç§€é¡¹ç›®ï¼Œæœ¬ç³»åˆ—æ–‡ç« å°†ç”±è¿™å…­ä¸ªé¡¹ç›®æˆå‘˜ä¸»ç¬”ï¼Œåˆ†äº«ä»–ä»¬çš„å‚èµ›ç»éªŒå’Œæˆæœã€‚æˆ‘ä»¬éå¸¸å¸Œæœ›æœ¬å±Š Hackathon è¯ç”Ÿçš„ä¼˜ç§€é¡¹ç›®èƒ½å¤Ÿåœ¨ç¤¾åŒºä¸­å»¶ç»­ä¸‹å»ï¼Œæ„Ÿå…´è¶£çš„å°ä¼™ä¼´ä»¬å¯ä»¥åŠ å…¥è¿›æ¥å“¦ã€‚&lt;/blockquote&gt;</description>
<author>ZoeyZhai</author>
<guid isPermaLink="false">2018-12-17-52554018</guid>
<pubDate>Mon, 17 Dec 2018 00:00:00 +0800</pubDate>
</item>
<item>
<title>TiDB Lab è¯ç”Ÿè®° | TiDB Hackathon ä¼˜ç§€é¡¹ç›®åˆ†äº«</title>
<link>https://henix.github.io/feeds/zhuanlan.newsql/2018-12-14-52414551.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/52414551&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-391401a44b5cfc4f07ef0d321a10fce0_r.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;blockquote&gt;æœ¬æ–‡ç”±&lt;b&gt;çº¢å‡¤å‡°ç²‰å‡¤å‡°ç²‰çº¢å‡¤å‡°é˜Ÿ&lt;/b&gt;çš„æˆå‘˜ä¸»ç¬”ï¼Œä»–ä»¬çš„é¡¹ç›® &lt;b&gt;TiDB Lab&lt;/b&gt; åœ¨æœ¬å±Š TiDB Hackathon 2018 ä¸­è·å¾—äº†äºŒç­‰å¥–ã€‚TiDB Lab ä¸º TiDB åŸ¹è®­ä½“ç³»å¢åŠ äº†ä¸€ä¸ªå¯ä»¥åŠ¨æ€è§‚æµ‹ TiDB / TiKV / PD ç»†èŠ‚çš„åŠ¨ç”»æ•™å­¦ Labï¼Œè®©ç”¨æˆ·å¯ä»¥ä¸€è¾¹è¿›è¡ŒçœŸå®æ“ä½œä¸€è¾¹è§‚å¯Ÿç»„ä»¶ä¹‹é—´çš„å˜åŒ–ï¼Œä¾‹å¦‚ SQL çš„è§£æï¼ŒRegion çš„å˜æ›´ç­‰ç­‰ï¼Œä»è€Œç”ŸåŠ¨åœ°ç†è§£ TiDB çš„å·¥ä½œåŸç†ã€‚&lt;/blockquote&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-a8ca052d52e744806a93b786c597e257_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;246&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-a8ca052d52e744806a93b786c597e257&quot; data-watermark-src=&quot;v2-1698678ea9ba1448ad082b2e043d13e5&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;h2&gt;&lt;b&gt;é¡¹ç›®ç®€ä»‹&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;1. ç®€ä»‹&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;TiDB Labï¼Œå…¨ç§° TiDB Laboratory&lt;/b&gt;ï¼Œæ˜¯ä¸€ä¸ªé›† TiDB é›†ç¾¤çŠ¶æ€çš„åœ¨çº¿å®æ—¶å¯è§†åŒ–ä¸äº¤äº’å¼æ•™å­¦çš„å¹³å°ã€‚ç”¨æˆ·å¯ä»¥ä¸€è¾¹å¯¹ TiDB é›†ç¾¤å„ä¸ªç»„ä»¶ TiKVã€TiDBã€PD è¿›è¡Œå„ç§æ“ä½œï¼ŒåŒ…æ‹¬ä¸Šä¸‹çº¿ã€å¯åŠ¨å…³é—­ã€è¿ç§»æ•°æ®ã€æ’å…¥æŸ¥è¯¢æ•°æ®ç­‰ï¼Œä¸€è¾¹åœ¨ TiDB Lab ä¸Šä»¥åŠ¨ç”»å½¢å¼è§‚å¯Ÿæ“ä½œå¯¹é›†ç¾¤çš„å½±å“ï¼Œä¾‹å¦‚æ•°æ®æ˜¯æ€ä¹ˆæµåŠ¨çš„ï¼ŒRegion å‰¯æœ¬åœ¨ä»€ä¹ˆæƒ…å†µä¸‹å‘ç”Ÿäº†å˜æ›´ç­‰ç­‰ã€‚é€šè¿‡ TiDB Lab è¿™ç§å¯¹æ“ä½œè¿›è¡Œå¯è§†åŒ–åé¦ˆçš„äº¤äº’æ¨¡å¼ï¼Œç”¨æˆ·å¯ä»¥å¿«é€Ÿä¸”ç”ŸåŠ¨åœ°ç†è§£ TiDB å†…éƒ¨åŸç†ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;2.åŠŸèƒ½&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;å®æ—¶åŠ¨æ€å±•ç¤º TiDBã€TiKV èŠ‚ç‚¹çš„æ–°å¢ã€å¯åŠ¨ä¸å…³é—­ã€‚&lt;/li&gt;&lt;li&gt;å®æ—¶åŠ¨æ€å±•ç¤º TiDB æ”¶åˆ° SQL åï¼Œç‰©ç†ç®—å­å°†å…·ä½“è¯·æ±‚å‘é€ç»™æŸäº› TiKV Region Leader å¹¶è·å–æ•°æ®çš„è¿‡ç¨‹ã€‚&lt;/li&gt;&lt;li&gt;å®æ—¶åŠ¨æ€å±•ç¤ºå„ä¸ª TiKV å®ä¾‹ä¸Š Region å‰¯æœ¬çŠ¶æ€çš„å˜åŒ–ï¼Œä¾‹å¦‚æ–°å¢ã€åˆ é™¤ã€åˆ†è£‚ã€‚&lt;/li&gt;&lt;li&gt;å®æ—¶åŠ¨æ€å±•ç¤ºå„ä¸ª TiKV å®ä¾‹ä¸Š Region å‰¯æœ¬å†…çš„æ•°æ®é‡æƒ…å†µã€‚&lt;/li&gt;&lt;li&gt;æµè§ˆé›†ç¾¤äº‹ä»¶å†å²ï¼ˆäº‹ä»¶æŒ‡ä¸Šè¿°å››æ¡åŠŸèƒ½æ‰€å±•ç¤ºçš„å„é¡¹å†…å®¹ï¼‰å¹¶æŸ¥çœ‹äº‹ä»¶çš„è¯¦ç»†æƒ…å†µï¼ŒåŒ…æ‹¬äº‹ä»¶çš„å…·ä½“æ•°æ®å†…å®¹ã€SQL Plan ç­‰ç­‰ã€‚&lt;/li&gt;&lt;li&gt;æŒ‰ TiDBã€TiKV æˆ– Region è¿‡æ»¤äº‹ä»¶å†å²ã€‚&lt;/li&gt;&lt;li&gt;å¯¹äº‹ä»¶å†å²è¿›è¡Œæ—¶é—´ç©¿æ¢­ï¼šå›åˆ°ä»»æ„äº‹ä»¶å‘ç”Ÿæ—¶åˆ»é‡æ–°è§‚å¯Ÿå½“æ—¶çš„é›†ç¾¤çŠ¶æ€ï¼Œæˆ–æŒ‰äº‹ä»¶å•æ­¥é‡æ”¾è§‚å¯Ÿé›†ç¾¤çŠ¶æ€çš„å˜åŒ–ã€‚&lt;/li&gt;&lt;li&gt;åœ¨çº¿è·å–å¸¸ç”¨è¿ç»´æ“ä½œçš„æ“ä½œæŒ‡å—ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;3.æ„¿æ™¯&lt;/b&gt;&lt;/p&gt;&lt;p&gt;æˆ‘ä»¬å…¶å®ä¸º TiDB Lab è§„åˆ’äº†æ›´å¤§çš„æ„¿æ™¯ï¼Œä½†ç”±äº Hackathon æ—¶é—´å…³ç³»ï¼Œè¿˜æ¥ä¸åŠå®ç°ã€‚æˆ‘ä»¬å¸Œæœ›èƒ½å®ç° TiDB Lab + TiDB ç”Ÿæ€ç»„ä»¶çš„æ²™ç›’ï¼Œä»è€Œåœ¨ TiDB Lab åœ¨çº¿å¹³å°ä¸Šç›´æ¥æä¾›å‘½ä»¤æ‰§è¡Œä¸ SQL æ‰§è¡ŒåŠŸèƒ½ã€‚è¿™æ ·ç”¨æˆ·æ— éœ€ç¦»å¼€å¹³å°ï¼Œæ— éœ€è‡ªè¡Œå‡†å¤‡æœºå™¨ä¸‹è½½éƒ¨ç½²ï¼Œå°±å¯ä»¥ç›´æ¥åœ¨å¹³å°ä¸Šæ ¹æ®æä¾›çš„æ“ä½œæŒ‡å—è¿›è¡Œå„ç±»æ“ä½œï¼Œå¹¶èƒ½è§‚å¯Ÿæ“ä½œå¸¦æ¥çš„å…·ä½“å½±å“ï¼Œå½¢æˆæ“ä½œä¸åé¦ˆçš„é—­ç¯ï¼ŒçœŸæ­£åœ°å®ç°é›¶é—¨æ§›æµè§ˆå™¨åœ¨çº¿æ•™å­¦ã€‚æˆ‘ä»¬æœŸæœ›å¹³å°èƒ½æä¾›ç”¨æˆ·ä»¥ä¸‹çš„æ“ä½œæµç¨‹ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;ç”¨æˆ·è·å¾—ä¸€ä¸ª TiDB Lab è´¦æˆ·å¹¶ç™»å½•ï¼ˆè€ƒè™‘åˆ°æ²™ç›’æ˜¯å ç”¨å®é™…èµ„æºçš„ï¼Œéœ€è¦é€šè¿‡è´¦æˆ·è®¸å¯æ¥é™åˆ¶é¿å…èµ„æºå¿«é€Ÿè€—å°½ï¼‰ã€‚&lt;/li&gt;&lt;li&gt;ç”¨æˆ·åœ¨ TiDB Lab ä¸Šè·å¾—è‹¥å¹²è™šæ‹Ÿæœºå™¨çš„è®¿é—®æƒé™ï¼Œæ¯ä¸ªæœºå™¨å¤„äºåŒä¸€å†…ç½‘å¹¶å…·æœ‰ç‹¬ç«‹ IPã€‚è¿™äº›è™šæ‹Ÿæœºå™¨çš„å®é™…å®ç°æ˜¯èµ„æºå—é™çš„è™šæ‹Ÿæœºæˆ–æ²™ç›’ï¼Œå› ä¸ºä½œä¸ºæ•™å­¦å®éªŒä¸éœ€è¦å ç”¨å¾ˆå¤šèµ„æºã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;ä¾‹å¦‚ï¼šå¹³å°ä¸ºç”¨æˆ·è‡ªåŠ¨åˆ†é…äº† 5 ä¸ª IP ç‹¬ç«‹çš„æ²™ç›’çš„è®¿é—®æƒé™ï¼Œåœ°å€ä¸º 192.168.0.1 ~ 192.168.0.5ã€‚&lt;/p&gt;&lt;ul&gt;&lt;li&gt;ç”¨æˆ·åœ¨å¹³å°ä¸Šè¿›è¡Œç¬¬é›¶ç« ã€Œæ¶æ„åŸç†ã€çš„å­¦ä¹ ã€‚å¹³å°æä¾›äº†ä¸€ä¸ªé»˜è®¤çš„æ‹“æ‰‘éƒ¨ç½²ï¼Œç”¨æˆ·å¯ä»¥åœ¨å¹³å°æä¾›çš„åœ¨çº¿ SQL Shell ä¸­è¿›è¡Œæ•°æ®çš„æ’å…¥ã€åˆ é™¤ã€æ›´æ–°ç­‰æ“ä½œã€‚ç”¨æˆ·é€šè¿‡å¹³å°è§‚å¯Ÿåˆ° SQL æ˜¯å¦‚ä½•å¯¹åº”åˆ° TiKV å­˜å‚¨èŠ‚ç‚¹ä¸Šçš„ï¼Œä»¥åŠæ•°æ®æ˜¯æ€ä¹ˆåˆ‡åˆ†åˆ°ä¸åŒ Region çš„ç­‰ç­‰ã€‚&lt;/li&gt;&lt;li&gt;ç”¨æˆ·åœ¨å¹³å°ä¸Šè¿›è¡Œç¬¬ä¸€ç« ã€ŒTiDB éƒ¨ç½²ã€çš„å­¦ä¹ ï¼Œäº†è§£åˆ°å¯ä»¥é€šè¿‡ ansible è¿›è¡Œéƒ¨ç½²ã€‚æ•™å­¦æ ·ä¾‹æ˜¯ä¸€ä¸ªå…¸å‹çš„ TiDB + TiKV ä¸‰å‰¯æœ¬éƒ¨ç½²ã€‚å¯¹äºè¿™ä¸ªæ•™å­¦æ ·ä¾‹ï¼Œå¹³å°å‘ŠçŸ¥ç”¨æˆ· inventory.ini å…·ä½“å†…å®¹åº”å½“å†™æˆä»€ä¹ˆæ ·å­ã€‚ç”¨æˆ·å¯ä»¥åœ¨å¹³å°æä¾›çš„åœ¨çº¿ Terminal ä¸Šä¿®æ”¹ inventory æ–‡ä»¶ï¼Œå¹¶æ‰§è¡Œéƒ¨ç½²ä¸é›†ç¾¤å¯åŠ¨å‘½ä»¤ã€‚éƒ¨ç½²å’Œå¯åŠ¨å‡èƒ½åœ¨å¹³å°ä¸Šå®æ—¶åé¦ˆå¯è§†åŒ–ã€‚&lt;/li&gt;&lt;li&gt;ç”¨æˆ·ç»§ç»­è¿›è¡Œåç»­ç« èŠ‚å­¦ä¹ ï¼Œä¾‹å¦‚ã€ŒTiDB å•ä¸€æœåŠ¡å¯åŠ¨ä¸å…³é—­ã€ã€‚ç”¨æˆ·åœ¨å¯è§†åŒ–ç•Œé¢ä¸Šç‚¹å‡»æŸä¸ªåˆšæ‰å·²ç»éƒ¨ç½²å‡ºæ¥çš„èŠ‚ç‚¹ï¼Œå¯ä»¥äº†è§£å¯åŠ¨æˆ–å…³é—­å•ä¸ª TiDB çš„å‘½ä»¤ã€‚ç”¨æˆ·å¯ä»¥åœ¨å¹³å°æä¾›çš„åœ¨çº¿ Terminal ä¸Šæ‰§è¡Œè¿™äº›å‘½ä»¤ï¼Œå°è¯•å¯åŠ¨æˆ–å…³é—­å•ä¸€ TiDBã€‚&lt;/li&gt;&lt;li&gt;ç”¨æˆ·ç»§ç»­å­¦ä¹ åŸºç¡€è¿ç»´æ“ä½œï¼Œä¾‹å¦‚ã€ŒTiKV æ‰©å®¹ã€ã€‚å¹³å°å‘ŠçŸ¥ inventory.ini åº”å½“å¦‚ä½•è¿›è¡Œä¿®æ”¹ï¼Œç”¨æˆ·å¯ä»¥æ ¹æ®æŒ‡å—åœ¨åœ¨çº¿ Terminal ä¸Šè¿›è¡Œå®è·µï¼Œå¹¶é€šè¿‡å¯è§†åŒ–ç•Œé¢è§‚å¯Ÿæ‰©å®¹çš„è¿‡ç¨‹ï¼Œä¾‹å¦‚å…¶ä»–èŠ‚ç‚¹ä¸Šçš„å‰¯æœ¬è¢«é€æ¸æ¬è¿åˆ°æ–°èŠ‚ç‚¹ä¸Šã€‚&lt;/li&gt;&lt;/ul&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-b00fb1e54cf86282b73e86667a939732_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;720&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-b00fb1e54cf86282b73e86667a939732&quot; data-watermark-src=&quot;v2-66a6b03f86e2e8fbc23c88126c249016&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;h2&gt;&lt;b&gt;å‰æœŸå‡†å¤‡&lt;/b&gt;&lt;/h2&gt;&lt;ol&gt;&lt;li&gt;&lt;b&gt;å›¢é˜Ÿ&lt;/b&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;æˆ‘ä»¬å›¢é˜Ÿæœ‰ä¸‰ä¸ªäººï¼Œæ˜¯ä¸€ä¸ª PingCAP åŒå­¦ä¸ TiDB ç¤¾åŒºå°ä¼™ä¼´é’±åŒå­¦çš„æ··åˆç»„é˜Ÿï¼Œå…¶ä¸­ PingCAP æˆå‘˜åˆ†åˆ«æ¥è‡ª TiKV ç»„ä¸ OLAP ç»„ã€‚æˆ‘ä»¬æœ¬ç€æäº‹æƒ…çš„æƒ³æ³•ï¼Œå›¢é˜Ÿå–åå«ã€Œ&lt;b&gt;çº¢å‡¤å‡°ç²‰å‡¤å‡°ç²‰çº¢å‡¤å‡°ã€&lt;/b&gt;ï¼Œæƒ³å›´è§‚ä¸»æŒäººå¿µå›¢é˜Ÿåç§°ï¼ˆç„¶è€Œæœºæ™ºçš„ä¸»æŒäººå°å§å§è®©æˆ‘ä»¬è‡ªæŠ¥å›¢é˜Ÿåç§°ï¼‰ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;2. åŸè®¡åˆ’ï¼šå¹²æ‰ gRPC&lt;/b&gt;&lt;/p&gt;&lt;p&gt;é‰´äºä»æŠ¥åå¼€å§‹ç›´åˆ° Hackathon æ­£å¼å¼€å§‹å‰å‡ å°æ—¶ï¼Œæˆ‘ä»¬éƒ½åœ¨ä¸ºåŸè®¡åˆ’åšå‡†å¤‡ï¼Œå› æ­¤å€¼å¾—è¯¦ç»†è¯´ä¸€ä¸‹â€¦&lt;/p&gt;&lt;p&gt;æˆ‘ä»¬ä¸€å¼€å§‹è§„åˆ’çš„ Hackathon é¡¹ç›®æ˜¯æ¢æ‰ TiKVã€TiDB ä¹‹é—´çš„ RPC æ¡†æ¶ gRPCï¼ŒåŸå› æœ‰å‡ ä¸ªï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;ä¸€æ˜¯å‘ç° TiKVã€TiDB ä¸­ gRPC ç»å¸¸å ç”¨äº†å¤§é‡ CPUï¼Œå°¤å…¶æ˜¯åœ¨è¯·æ±‚è¾ƒå¤šä½†å¾ˆç®€å•çš„ benchmark åœºæ™¯ä¸­ç»å¸¸æ¯” Coprocessor è¿™å—å„¿è¿˜é«˜ï¼Œè¿™åœ¨å®¢æˆ·æœºå™¨ CPU èµ„æºæ¯”è¾ƒå°‘çš„æƒ…å†µä¸‹æ˜¯æ€§èƒ½ç“¶é¢ˆï¼›&lt;/li&gt;&lt;li&gt;äºŒæ˜¯å‘ç° gRPC æ€§èƒ½ä¸€èˆ¬ï¼Œåœ¨å„ç±»å¸¸ç”¨ RPC æ¡†æ¶çš„æ€§èƒ½æµ‹è¯•ä¸­ gRPC ç»å¸¸æ˜¯å«åº•æ°´å¹³ï¼›&lt;/li&gt;&lt;li&gt;ä¸‰æ˜¯ gRPC ä¸»è¦è®¾è®¡ç”¨äºç”¨æˆ·äº§å“ä¸ Google æœåŠ¡è¿›è¡Œé€šè®¯ï¼Œå› è€Œè€ƒè™‘åˆ°äº†åŒ…æ‹¬è´Ÿè½½å‡è¡¡å‹å¥½ã€æµé‡æ§åˆ¶ç­‰æ–¹é¢ï¼Œä½†å¯¹ TiKV ä¸ TiDB è¿™ç±»å†…éƒ¨é€šè®¯æ¥è¯´è¿™äº›éƒ½æ˜¯ç”¨ä¸ä¸Šçš„åŠŸèƒ½ï¼Œä¸ºæ­¤ç‰ºç‰²çš„æ€§èƒ½æ˜¯æ— è°“çš„å¼€é”€ï¼›&lt;/li&gt;&lt;li&gt;å¦å¤–è¿‘æœŸ TiKV å†…éƒ¨æœ‰ä¸€ä¸ªå®éªŒæ˜¯å°†å¤šä¸ª RPC è¯·æ±‚ batch åˆ°ä¸€èµ·å†å‘é€ï¼ˆå½“ç„¶å¤„ç†æ—¶å€™å†æ‹†å¼€ä¸€ä¸ªä¸€ä¸ªæ‰§è¡ŒåŸæ¥çš„ handlerï¼‰ï¼Œæ€§èƒ½å¯ä»¥ç¬é—´æé«˜ä¸€å€ä»¥ä¸Šï¼Œè¿™ä¹Ÿä»ä¾§é¢è¯´æ˜äº† gRPC æ¡†æ¶è‡ªèº«å¼€é”€å¾ˆå¤§ï¼Œå› ä¸ºç”¨æˆ·ä¾§è¯·æ±‚æ€»é‡æ˜¯ä¸€è‡´çš„ï¼Œå¤„ç†æ¨¡å¼ä¹Ÿæ˜¯ä¸€è‡´çš„ï¼Œå”¯ä¸€çš„åŒºåˆ«å°±æ˜¯ RPC æ¡†æ¶æ‰¹é‡å‘é€æˆ–ä¸€æ¡ä¸€æ¡å‘é€ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;æˆ‘ä»¬æ—©åœ¨å‡ å‘¨å‰å°±å¼€å§‹å†™ç®€å• Echo Server è¿›è¡Œå¯è¡Œæ€§éªŒè¯å’Œæ€§èƒ½æµ‹è¯•ï¼Œæ˜¯ä»¥ä¸‹ä¸‰ä¸ªæ–¹é¢çš„æ­£äº¤ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;åè®®ï¼šCapnProto RPCã€brpc over gRPCã€è£¸å†™ echoã€‚&lt;/li&gt;&lt;li&gt;æœåŠ¡ç«¯ï¼šRustã€C++ï¼Œå¯¹åº”ç”¨äº TiKVã€‚&lt;/li&gt;&lt;li&gt;å®¢æˆ·ç«¯ï¼šGolangï¼Œå¯¹åº”ç”¨äº TiDBã€‚&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;å…¶ä¸­ TiKV ä¾§è°ƒç ”äº† Rust å’Œ C++ çš„æœåŠ¡ç«¯å®ç°ï¼ŒåŸå› æ˜¯ Rust å¯ä»¥é€šè¿‡ binding æ–¹å¼è°ƒç”¨ C++ æœåŠ¡ç«¯ã€‚è€Œ TiDB ä¾§å®¢æˆ·ç«¯å®ç°ä¸åŒ…å« C++ çš„åŸå› æ˜¯ Golang è¿›è¡Œ C / C++ FFI æ€§èƒ½å¾ˆå·®ï¼Œå› æ­¤å¯ä»¥ç›´æ¥æ”¾å¼ƒ C/C++ åŒ…è£…ä¸€å±‚ binding ç”¨äº TiDB çš„æƒ³æ³•ã€‚æœ€åæµ‹è¯•ä¸‹æ¥ï¼Œæœ‰ä»¥ä¸‹ç»“æœï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;CapnProtoï¼šåºåˆ—åŒ–æ€§èƒ½å¾ˆé«˜ï¼Œä½†å…¶ RPC æ€§èƒ½æ²¡æœ‰å¾ˆçªå‡ºã€‚æœ€é‡è¦çš„æ˜¯ï¼ŒCapnProto çš„ Golang Client å®ç°æœ‰ bugï¼Œå¹¶ä¸èƒ½ç¨³å®šåœ°ä¸ Rust æˆ– C++ çš„ Server è¿›è¡Œ RPC äº¤äº’ã€‚ä½œè€…å›å¤è¯´è¿™æ˜¯ä¸€ä¸ªå·²çŸ¥ç¼ºé™·ï¼Œæ¶‰åŠé‡æ„ã€‚è¿™å¯¹äº Hackathon æ¥è¯´æ˜¯ä¸€ä¸ªè‡´å‘½çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰å……è¶³çš„æ—¶é—´è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œç›´æ¥å¯¼è‡´æˆ‘ä»¬æ”¾å¼ƒè¿™ä¸ªæ–¹æ¡ˆã€‚&lt;/li&gt;&lt;li&gt;brpc over gRPCï¼šå¯ä»¥å®ç°ä½¿ç”¨ brpc C++ å®¢æˆ·ç«¯ &amp;amp; gRPC Golang æœåŠ¡ç«¯é…åˆï¼ˆæ³¨ï¼šbrpc æ²¡æœ‰ Golang çš„å®ç°ï¼‰ã€‚ä½†è¿™ä¸ªæ–¹æ¡ˆæœ¬è´¨åªæ˜¯æ›¿æ¢æœåŠ¡ç«¯çš„å®ç°ï¼Œå¹¶æ²¡æœ‰æ›¿æ¢åè®®ï¼Œå¹¶ä¸å½»åº•ï¼Œæˆ‘ä»¬ä¸æ˜¯ç‰¹åˆ«å–œæ¬¢ã€‚å¦å¤–åœ¨è¿™ä¸ªæ¢æ±¤ä¸æ¢è¯çš„æ–¹æ¡ˆä¸‹ï¼Œæµ‹è¯•ä¸‹æ¥æ€§èƒ½çš„æå‡æœ‰é™ï¼Œä¸”éšç€ payload è¶Šå¤§ä¼šè¶Šå°ã€‚æˆ‘ä»¬æœ€ç»ˆè§‰å¾—ä½œä¸ºä¸€ä¸ª Hackathon é¡¹ç›®å¦‚æœä»…æœ‰æœ‰é™çš„æ€§èƒ½æå‡ï¼ˆè™½ç„¶å¯ä»¥åœ¨å±•ç¤ºçš„æ—¶å€™æ©ç›–ç¼ºé™·åªå±•ç¤ºä¼˜ç‚¹ï¼‰ï¼Œé‚£ä¹ˆæ„ä¹‰ä¸æ˜¯å¾ˆå¤§ï¼Œæœ€ç»ˆæ— æ³•ç”¨äºäº§å“ï¼Œå› è€Œæ”¾å¼ƒã€‚&lt;/li&gt;&lt;li&gt;è£¸å†™ï¼šæˆ‘ä»¬ä¸‰ä¸ªæˆå‘˜éƒ½ä¸æ˜¯è¿™æ–¹é¢çš„è€å¸æœºï¼Œè£¸å†™å¤§æ¦‚æ˜¯å†™ä¸å®Œçš„ã€‚ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;3. æ–°è®¡åˆ’ï¼šåšä¸€ä¸ªç”¨äºåŸ¹è®­çš„å¯è§†åŒ–&lt;/b&gt;&lt;/p&gt;&lt;p&gt;åœ¨ Hackathon å¼€å§‹çš„å‰ä¸€ä¸ªæ™šä¸Šï¼Œæˆ‘ä»¬å†³å®šæ¨ç¿»é‡æ¥ï¼Œäºæ˜¯ brain storm äº†å‡ ä¸ªæƒ³æ³•ï¼Œæœ€åè§‰å¾—åšä¸€ä¸ªç”¨äºæ•™å­¦çš„å¯è§†åŒ–æ¯”è¾ƒå¯è¡Œï¼Œå¹¶ä¸”å…·æœ‰æ¯”è¾ƒå¤§çš„å®é™…æ„ä¹‰ã€‚å¦å¤–ï¼Œè¿™ä¸ªæ–°é¡¹ç›®ã€Œé›†ç¾¤å¯è§†åŒ–ã€ç›¸æ¯”åŸé¡¹ç›®ã€Œæ¢ RPCã€æ¥è¯´æ›´é€‚åˆ Hackathonï¼Œä¸»è¦åœ¨äºï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;å…·æœ‰å›¾å½¢åŒ–ç•Œé¢ï¼Œå®¹æ˜“æ‹¿å¥–å¯ä»¥ç›´è§‚åœ°å±•ç°æˆæœã€‚&lt;/li&gt;&lt;li&gt;å¹¶ä¸æ˜¯ä¸€ä¸ªã€Œéé›¶å³ä¸€ã€çš„ä»»åŠ¡ã€‚æ–°é¡¹ç›®æœ‰å¾ˆå¤šå­åŠŸèƒ½ï¼Œå¯ä»¥é€ä¸€è¿›è¡Œå®ç°ï¼Œå¾ˆç¨³å¦¥ï¼Œä¸”ä¸åƒè€é¡¹ç›®é‚£æ ·åªæœ‰æ¢å®Œæ‰çŸ¥é“æ•ˆæœã€‚&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;æˆ‘ä»¬ç»§ç»­åœ¨è¿™ä¸ªã€Œå¯è§†åŒ–ã€çš„æƒ³æ³•ä¸Šè¿›è¡Œäº†è¿›ä¸€æ­¥çš„æ€è€ƒï¼Œæƒ³åˆ°å¦‚æœå¯ä»¥åšæˆåœ¨çº¿æ•™å­¦çš„æ¨¡å¼ï¼Œåˆ™å¯ä»¥è¿›ä¸€æ­¥æ‰©å±•å…¶é¡¹ç›®æ„ä¹‰ï¼Œå½¢æˆä¸€ä¸ªå®Œæ•´çš„åœ¨çº¿æ•™å­¦ä½“ç³»ï¼Œå› æ­¤æœ€ç»ˆå†³å®šäº†é¡¹ç›®çš„ scopeã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;å…·ä½“å®ç°&lt;/b&gt;&lt;/h2&gt;&lt;blockquote&gt;&lt;i&gt;åœ¨ TiKVã€TiDB ä¸ PD ä¸­å„ä¸ªå…³é”®è·¯å¾„ä¸Šå°†å‘ç”Ÿçš„å…·ä½“ã€Œäº‹ä»¶ã€è®°å½•ä¸‹æ¥ï¼Œå¹¶åœ¨å‰ç«¯è¿›è¡Œä¸€ä¸€å¯è§†åŒ–ã€‚&lt;/i&gt;&lt;/blockquote&gt;&lt;ol&gt;&lt;li&gt;&lt;b&gt;äº‹ä»¶&lt;/b&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;æˆ‘ä»¬å°† TiDB Lab è¿›è¡Œå¯è§†åŒ–æ‰€éœ€è¦çš„ä¿¡å·ç§°ä¸ºã€Œäº‹ä»¶ã€ï¼Œå¹¶è§„åˆ’äº†ä»¥ä¸‹ã€Œäº‹ä»¶ã€ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Ansible äº‹ä»¶ï¼šAnsible éƒ¨ç½² TiDB&lt;/li&gt;&lt;li&gt;Ansible äº‹ä»¶ï¼šAnsible éƒ¨ç½² TiKV&lt;/li&gt;&lt;li&gt;TiDB äº‹ä»¶ï¼šTiDB å¯åŠ¨&lt;/li&gt;&lt;li&gt;TiDB äº‹ä»¶ï¼šTiDB å…³é—­&lt;/li&gt;&lt;li&gt;TiDB äº‹ä»¶ï¼šTiDB æ”¶åˆ°ä¸€æ¡ SQL&lt;/li&gt;&lt;li&gt;TiKV äº‹ä»¶ï¼šTiKV å¯åŠ¨&lt;/li&gt;&lt;li&gt;TiKV äº‹ä»¶ï¼šTiKV å…³é—­&lt;/li&gt;&lt;li&gt;TiKV äº‹ä»¶ï¼šTiKV æ”¶åˆ°ä¸€æ¡ KvGet è¯·æ±‚&lt;/li&gt;&lt;li&gt;TiKV äº‹ä»¶ï¼šTiKV æ”¶åˆ°ä¸€æ¡ PreWrite / Commit è¯·æ±‚&lt;/li&gt;&lt;li&gt;TiKV äº‹ä»¶ï¼šTiKV æ”¶åˆ°ä¸€æ¡ Coprocessor è¯·æ±‚&lt;/li&gt;&lt;li&gt;TiKV äº‹ä»¶ï¼šTiKV Region Peer åˆ›å»º&lt;/li&gt;&lt;li&gt;TiKV äº‹ä»¶ï¼šTiKV Region Peer åˆ é™¤&lt;/li&gt;&lt;li&gt;TiKV äº‹ä»¶ï¼šTiKV Region åˆ†è£‚&lt;/li&gt;&lt;li&gt;TiKV äº‹ä»¶ï¼šTiKV Region Snapshot å¤åˆ¶&lt;/li&gt;&lt;li&gt;TiKV äº‹ä»¶ï¼šTiKV Region æ•°æ®é‡å‘ç”Ÿæ˜¾è‘—å˜åŒ–&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;æœ€åï¼Œç”±äºæ—¶é—´å…³ç³»ã€æŠ€æœ¯éš¾åº¦å’Œå¯è§†åŒ–éœ€è¦ï¼Œå®é™…å®ç°çš„æ˜¯ä»¥ä¸‹äº‹ä»¶ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;TiDB äº‹ä»¶ï¼šTiDB å¯åŠ¨ï¼Œè‹¥é¦–æ¬¡å¯åŠ¨è®¤ä¸ºæ˜¯æ–°éƒ¨ç½²&lt;/li&gt;&lt;li&gt;TiDB äº‹ä»¶ï¼šTiDB å…³é—­&lt;/li&gt;&lt;li&gt;TiDB äº‹ä»¶ï¼šTiDB æ”¶åˆ° SQL å¹¶å‘èµ· KvGet è¯»è¯·æ±‚&lt;/li&gt;&lt;li&gt;TiDB äº‹ä»¶ï¼šTiDB æ”¶åˆ° SQL å¹¶å‘èµ· PreWrite / Commit å†™å…¥è¯·æ±‚&lt;/li&gt;&lt;li&gt;TiDB äº‹ä»¶ï¼šTiDB æ”¶åˆ° SQL å¹¶å‘èµ· Coprocessor è¯»è¯·æ±‚&lt;/li&gt;&lt;li&gt;TiKV äº‹ä»¶ï¼šTiKV å¯åŠ¨ï¼Œè‹¥é¦–æ¬¡å¯åŠ¨è®¤ä¸ºæ˜¯æ–°éƒ¨ç½²&lt;/li&gt;&lt;li&gt;TiKV äº‹ä»¶ï¼šTiKV å…³é—­&lt;/li&gt;&lt;li&gt;PD äº‹ä»¶ï¼šTiKV Region Peer åˆ›å»ºï¼ˆé€šè¿‡ Region å¿ƒè·³å®ç°ï¼‰&lt;/li&gt;&lt;li&gt;PD äº‹ä»¶ï¼šTiKV Region Peer åˆ é™¤ï¼ˆé€šè¿‡ Region å¿ƒè·³å®ç°ï¼‰&lt;/li&gt;&lt;li&gt;PD äº‹ä»¶ï¼šTiKV Region åˆ†è£‚ï¼ˆé€šè¿‡ Region å¿ƒè·³å®ç°ï¼‰&lt;/li&gt;&lt;li&gt;PD äº‹ä»¶ï¼šTiKV Region æ•°æ®é‡å‘ç”Ÿæ˜¾è‘—å˜åŒ–ï¼ˆé€šè¿‡ Region å¿ƒè·³å®ç°ï¼‰&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;2. å¯è§†åŒ–&lt;/b&gt;&lt;/p&gt;&lt;p&gt;å¯è§†åŒ–éƒ¨åˆ†ç”±å‰ç«¯ï¼ˆlab-frontendï¼‰å’Œäº‹ä»¶æ”¶é›†æœåŠ¡ï¼ˆlab-gatewayï¼‰ç»„æˆã€‚&lt;/p&gt;&lt;p&gt;äº‹ä»¶æ”¶é›†æœåŠ¡æ˜¯ä¸€ä¸ªç®€å•çš„ HTTP Serverï¼Œå„ä¸ªç»„ä»¶é€šè¿‡ HTTP Post æ–¹å¼å‘ŠçŸ¥äº‹ä»¶ï¼Œäº‹ä»¶æ”¶é›†æœåŠ¡å°†å…¶é€šè¿‡ WebSocket åè®®å®æ—¶å‘é€ç»™å‰ç«¯ã€‚äº‹ä»¶æ”¶é›†æœåŠ¡éå¸¸ç®€å•ï¼Œä½¿ç”¨çš„æ˜¯ Node.js å¼€å‘ï¼ŒåŸºäº ExpressJs å¯åŠ¨ HTTP Server å¹¶åŸºäº SocketIO å®ç°ä¸æµè§ˆå™¨çš„å®æ—¶é€šè®¯ã€‚ExpressJs æ”¶åˆ°äº‹ä»¶ JSON åå°†å…¶é€šè¿‡ SocketIO è¿›è¡Œå¹¿æ’­ï¼Œæ€»ä»£ç ä»…ä»…åå‡ è¡Œã€‚&lt;/p&gt;&lt;p&gt;å¯è§†åŒ–å‰ç«¯é‡‡ç”¨ Vue å®ç°ï¼ŒåŠ¨ç”»ä½¿ç”¨ animejs å’Œ CSS3ã€‚&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;é€šè¿‡æ¨¡æ¿å®ç°çš„å¯è§†åŒ–&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;ä¸€éƒ¨åˆ†äº‹ä»¶é€šè¿‡ã€Œç”±äº‹ä»¶æ›´æ–°é›†ç¾¤çŠ¶æ€æ•°æ® â€“ ç”±é›†ç¾¤çŠ¶æ€é€šè¿‡ Vue æ¸²æŸ“æ¨¡æ¿ã€è¿›è¡Œå¯è§†åŒ–ã€‚&lt;/p&gt;&lt;p&gt;è¿™ç±»å¯è§†åŒ–æ˜¯æœ€ç®€å•çš„ï¼Œä»¥ TiDB å¯åŠ¨ä¸å¦ä¸ºä¾‹ï¼ŒTiDB çš„å¯åŠ¨ä¸å¦åœ¨ç•Œé¢ä¸Šå‘ˆç°ä¸ºä¸€ä¸ªæ ‡ç­¾æ˜¾ç¤ºä¸ºã€ŒStartedã€æˆ–ã€ŒStoppedã€ï¼Œé‚£ä¹ˆå°±æ˜¯ä¸€ä¸ªä¼ ç»Ÿçš„ Vue MVVM æµç¨‹ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;æ•°æ®å˜é‡ instances.x.online ä»£è¡¨ TiDB x æ˜¯å¦å·²å¯åŠ¨ã€‚&lt;/li&gt;&lt;li&gt;æ”¶åˆ° TiDB Started äº‹ä»¶åï¼Œæ›´æ–° instances.x.online = true ã€‚&lt;/li&gt;&lt;li&gt;æ”¶åˆ° TiDB Stopped äº‹ä»¶åï¼Œæ›´æ–° instances.x.online = false ã€‚&lt;/li&gt;&lt;li&gt;å‰ç«¯æ¨¡æ¿ä¸Šï¼Œæ ¹æ® instances.x.online æ¸²æŸ“æˆ Started æˆ– Stopped å¯¹åº”çš„ç•Œé¢ã€‚&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;è¿™ç±»å¯è§†åŒ–çš„åŠ¨ç”»é‡‡ç”¨çš„æ˜¯ CSS3 åŠ¨ç”»ã€‚ç”±äº Region Peer ä½ç½®æ˜¯ç”± left, top CSS å±æ€§ç»™å‡ºçš„ï¼Œå› æ­¤ä¸ºå…¶åŠ ä¸Š transitionï¼Œå³å¯å®ç° Region Peer åœ¨å±å¹•ä¸Šæ˜¾ç¤ºçš„ä½ç½®æ”¹å˜çš„åŠ¨ç”»ã€‚ä½ç½®æ”¹å˜ä¼šä¸»è¦å‘ç”Ÿåœ¨åˆ†è£‚æ—¶ï¼Œåˆ†è£‚æ—¶ Region åˆ—è¡¨ä¸­æŒ‰é¡ºåºä¼šæ–°å¢ä¸€ä¸ªï¼Œé‚£ä¹ˆåé¢å„ä¸ª Region éƒ½è¦å‘åç§»åŠ¨ï¼ˆæˆ–æ¢åˆ°ä¸‹ä¸€è¡Œç­‰ï¼‰ã€‚&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-31c499ed7e5e73fb418ee24608ffbc78_r.gif&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;244&quot; data-rawheight=&quot;232&quot; data-watermark=&quot;&quot; data-original-src=&quot;&quot; data-watermark-src=&quot;&quot; data-private-watermark-src=&quot;&quot; data-thumbnail=&quot;https://pic4.zhimg.com/v2-31c499ed7e5e73fb418ee24608ffbc78_b.jpg&quot;&gt;&lt;p&gt;æœ€åï¼Œä½¿ç”¨ Vue Group Transition åŠŸèƒ½ï¼Œå³å¯ä¸º Region Peer çš„æ–°å¢ä¸åˆ é™¤ä¹ŸåŠ å…¥åŠ¨ç”»æ•ˆæœã€‚&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;é€šè¿‡åŠ¨ç”»å®ç°çš„å¯è§†åŒ–&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;å¦ä¸€éƒ¨åˆ†äº‹ä»¶å¹¶ä¸ååº”ä¸ºä¸€ä¸ªæŒä¹…åŒ– DOM çš„å˜åŒ–ï¼Œä¾‹å¦‚ TiDB æ”¶åˆ° SQL å¹¶å‘è¯·æ±‚åˆ°æŸä¸ªå…·ä½“ TiKV ä¸Š Region peer çš„äº‹ä»¶ï¼Œåœ¨å‰ç«¯å±•ç¤ºä¸ºä¸€ä¸ª TiDB èŠ‚ç‚¹åˆ° TiKV Region Peer çš„è¿‡æ¸¡åŠ¨ç”»ã€‚åŠ¨ç”»å¼€å§‹å‰å’ŒåŠ¨ç”»ç»“æŸåï¼ŒDOM æ²¡æœ‰ä»€ä¹ˆå˜åŒ–ï¼ŒåŠ¨ç”»æ˜¯ä¸€ä¸ªä¸´æ—¶çš„å¯è§†å…ƒç´ ã€‚è¿™ç±»åŠ¨ç”»é€šè¿‡ animejs å®ç°ã€‚&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-0275c3460d6d664862bb9a80c6ca3589_r.gif&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;748&quot; data-rawheight=&quot;496&quot; data-watermark=&quot;&quot; data-original-src=&quot;&quot; data-watermark-src=&quot;&quot; data-private-watermark-src=&quot;&quot; data-thumbnail=&quot;https://pic4.zhimg.com/v2-0275c3460d6d664862bb9a80c6ca3589_b.jpg&quot;&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-3a8408d8033ca7d0a57a10a282802493_r.gif&quot; data-caption=&quot;è¿™ä¸ªæµ®å¤¸çš„å¼€åœºåŠ¨ç”»æ•ˆæœä¹Ÿæ˜¯ animjs åšçš„&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;200&quot; data-rawheight=&quot;200&quot; data-watermark=&quot;&quot; data-original-src=&quot;&quot; data-watermark-src=&quot;&quot; data-private-watermark-src=&quot;&quot; data-thumbnail=&quot;https://pic1.zhimg.com/v2-3a8408d8033ca7d0a57a10a282802493_b.jpg&quot;&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;æ—¶é—´ç©¿æ¢­&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;æ—¶é—´ç©¿æ¢­æ˜¯ä¸€ä¸ªåœ¨ç›®å‰å‰ç«¯æ¡†æ¶ä¸­æä¾›çš„å¾ˆæ—¶é«¦çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬å‡†å¤‡å€Ÿé‰´ä¸€æ³¢ã€‚ä¸»è¦åŒ…æ‹¬ï¼š1. å›é€€åˆ°ä»»æ„ä¸€ä¸ªå†å²äº‹ä»¶å‘ç”Ÿçš„æ—¶åˆ»å±•ç¤ºé›†ç¾¤çš„çŠ¶æ€ï¼›2. ä»å½“å‰äº‹ä»¶å¼€å§‹å¾€åè¿›è¡Œå•æ­¥å¯è§†åŒ–é‡ç°ã€‚&lt;/p&gt;&lt;p&gt;æ—¶é—´ç©¿æ¢­çš„æœ¬è´¨æ˜¯éœ€è¦å®ç°ä¸¤ä¸ªåŸºç¡€æ“ä½œï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;å¯¹äºå•ä¸€äº‹ä»¶å®ç°æ­£å‘æ‰§è¡Œï¼Œå³äº‹ä»¶å‘ç”Ÿåï¼Œæ›´æ–°å¯¹åº”é›†ç¾¤æ•°æ®ä¿¡æ¯ï¼ˆå¦‚æœé‡‡ç”¨ã€Œé€šè¿‡æ¨¡æ¿å®ç°çš„å¯è§†åŒ–ã€ï¼‰ï¼Œæˆ–åˆ›å»ºä¸´æ—¶åŠ¨ç”» DOMï¼ˆå¦‚æœé‡‡ç”¨ã€Œé€šè¿‡åŠ¨ç”»å®ç°çš„å¯è§†åŒ–ã€ï¼‰ã€‚å¦å¤–å…è®¸è·³è¿‡ã€Œé€šè¿‡åŠ¨ç”»å®ç°çš„å¯è§†åŒ–ã€è¿™ä¸€æ­¥ã€‚&lt;/li&gt;&lt;li&gt;å¯¹äºå•ä¸€äº‹ä»¶å®ç°åå‘æ‰§è¡Œï¼Œå³æ’¤é”€è¿™ä¸ªäº‹ä»¶é€ æˆçš„å½±å“ã€‚å¯¹äºã€Œé€šè¿‡æ¨¡æ¿å®ç°çš„å¯è§†åŒ–ã€ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®äº‹ä»¶å†…å®¹åå‘æ’¤é”€å®ƒå¯¹é›†ç¾¤æ•°æ®ä¿¡æ¯çš„ä¿®æ”¹ã€‚å¯¹äºã€Œé€šè¿‡åŠ¨ç”»å®ç°çš„å¯è§†åŒ–ã€ï¼Œæˆ‘ä»¬ä»€ä¹ˆéƒ½ä¸ç”¨åšã€‚&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;æ—¶é—´ç©¿æ¢­çš„åŠŸèƒ½å¯ä»¥é€šè¿‡ç»„åˆè¿™ä¸¤ä¸ªåŸºç¡€æ“ä½œå®ç°ã€‚&lt;/p&gt;&lt;ol&gt;&lt;li&gt;å›é€€åˆ°ä»»æ„å†å²äº‹ä»¶å‘ç”Ÿæ—¶åˆ»ï¼šè‹¥æƒ³è¦å‰å¾€çš„äº‹ä»¶æ—©äºå½“å‰å‘ˆç°çš„äº‹ä»¶ï¼Œåˆ™å¯¹äºè¿™æœŸé—´çš„äº‹ä»¶é€ä¸€è¿›è¡Œåå‘æ‰§è¡Œã€‚è‹¥æƒ³è¦å‰å¾€çš„äº‹ä»¶æ™šäºå½“å‰å‘ˆç°çš„äº‹ä»¶ï¼Œåˆ™è¿›è¡Œæ— åŠ¨ç”»çš„æ­£å‘æ‰§è¡Œã€‚&lt;/li&gt;&lt;li&gt;ä»å½“å‰äº‹ä»¶å¼€å§‹å•æ­¥å¯è§†åŒ–ï¼šæ‰§è¡Œä¸€æ¬¡æœ‰åŠ¨ç”»çš„æ­£å‘æ‰§è¡Œã€‚&lt;/li&gt;&lt;li&gt;å®æ—¶å±•ç¤ºæ–°äº‹ä»¶ï¼šæ‰§è¡Œä¸€æ¬¡æœ‰åŠ¨ç”»çš„æ­£å‘æ‰§è¡Œã€‚&lt;/li&gt;&lt;/ol&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-f94e3d2c834d8591c8c7e81ddb53b773_r.gif&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;950&quot; data-rawheight=&quot;572&quot; data-watermark=&quot;&quot; data-original-src=&quot;&quot; data-watermark-src=&quot;&quot; data-private-watermark-src=&quot;&quot; data-thumbnail=&quot;https://pic3.zhimg.com/v2-f94e3d2c834d8591c8c7e81ddb53b773_b.jpg&quot;&gt;&lt;p&gt;&lt;b&gt;3. TiDB äº‹ä»¶æ”¶é›†&lt;/b&gt;&lt;/p&gt;&lt;p&gt;TiDB çš„å†å²äº‹ä»¶æ”¶é›†ç•¥ä¸º Hackã€‚ç”±äºéœ€è¦è¿‡æ»¤ä»»ä½•éç”¨æˆ·å‘èµ·çš„æŸ¥è¯¢ï¼ˆç±»ä¼¼ GC æˆ–è€… meta æŸ¥è¯¢ä¼šç”±èƒŒæ™¯åç¨‹é¢‘ç¹å‘èµ·æ‰“æ‰°ä½¿ç”¨ä½“éªŒï¼‰ï¼Œå› æ­¤åœ¨ç”¨æˆ·é“¾æ¥å…¥å£å¤„æ·»åŠ äº† context æ ‡è®°ä¸€è·¯æºå¸¦åˆ°æ‰§è¡Œå±‚ï¼Œå†ä¿®æ”¹ç›¸åº”çš„åç¨‹åŒæ­¥æ•°æ®ç»“æ„æ·»åŠ éœ€è¦è½¬å‘çš„æ ‡è®°ä¿¡æ¯ã€‚æ¯”è¾ƒéº»çƒ¦çš„æ˜¯ç±»ä¼¼ Point Get è¿™æ ·æ¥å£å…è®¸æºå¸¦ä¿¡æ¯éå¸¸å°‘çš„è°ƒç”¨ï¼Œåªå¥½å°†æ ‡è®°ä½ç¼–ç è¿› Key æœ¬èº«äº†ã€‚Plan çš„å¯è§†åŒ–å…¶å®å¹¶æ²¡æœ‰èŠ±å¤šå°‘åŠŸå¤«ï¼Œå› ä¸ºæ‰¾åˆ° TiDB æœ¬èº«å·²ç»åšäº†ç±»ä¼¼çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬æ— éåªæ˜¯å°†è¿™å—ä»£ç ç›´æ¥å·æ¥äº†ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;4. PD äº‹ä»¶æ”¶é›†&lt;/b&gt;&lt;/p&gt;&lt;p&gt;åŸæœ¬ä¸å°‘äº‹ä»¶å¸Œæœ›åœ¨ TiKV ç«¯å®Œæˆä¾¦å¬ï¼Œä¸è¿‡æ˜¾ç„¶ KV ä¸€å°æ—¶ç¼–è¯‘ä¸€æ¬¡çš„æ•ˆç‡æ— æ³•æ»¡è¶³ Hackathon ä¸­å¤šæ¬¡è¯•é”™çš„éœ€è¦ã€‚å› æ­¤æˆ‘ä»¬æ”¹ä¸ºåœ¨ PD ä¸­ä¾¦æµ‹å¿ƒè·³å’Œæ±‡æŠ¥äº‹ä»¶ã€‚å…¶å®å¹¶æ²¡æœ‰ä»€ä¹ˆç¥ç§˜ï¼Œåœ¨åŸæœ¬ PD è‡ªå·±æ£€æŸ¥ Region å˜æ›´çš„ä»£ç æ‹†åˆ†æˆ Region å’Œ Peer å˜æ›´ï¼šæ¯æ¬¡ PD æ¥åˆ° Region å¿ƒè·³ä¼šåœ¨ PD Cache ä¸­è¿›è¡Œ Version å’Œ confVer å˜æ›´çš„æ£€æµ‹ï¼Œä¸»è¦æ¶‰åŠ Peer çš„å¢åŠ å’Œå‡å°‘ç­‰ã€‚è€Œ Region Split ä¼šå•ç‹¬ç”± RegionSplitReport è¿›è¡Œæ±‡æŠ¥ï¼Œè¿™é‡Œä¹Ÿä¼šåšä¸€æ¬¡ Hookã€‚å¦å¤–å°±æ˜¯æ¯æ¬¡å¿ƒè·³ä¼šæ£€æŸ¥æ˜¯å¦æœ‰æœªä¸ŠæŠ¥ç»™ Lab çš„ Region ä¿¡æ¯ï¼Œå¦‚æœæœ‰å°±è½¬æ¢æˆ Peer ä¿¡æ¯è¿›è¡Œè¡¥å‘ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;5. TiKV äº‹ä»¶æ”¶é›†&lt;/b&gt;&lt;/p&gt;&lt;p&gt;å¦‚ä¸Šï¼ŒåŸæœ¬æˆ‘ä»¬è®¡åˆ’äº†å¾ˆå¤š TiKV äº‹ä»¶ï¼Œä½†ç”±äºå¼€å‘æœºå™¨é…ç½®ä¸ä½³ï¼Œæ¯æ¬¡ä¿®æ”¹éƒ½è¦ç­‰å¾…ä¸€å°æ—¶è¿›è¡Œä¸€æ¬¡ç¼–è¯‘ï¼Œè€ƒè™‘åˆ° Hackathon ä¸Šæ—¶é—´ç´§è¿«ï¼Œå› æ­¤æœ€ç»ˆå¤§å¤§ç¼©å‡äº† TiKV ä¸Šæ”¶é›†çš„äº‹ä»¶æ•°é‡ï¼Œæ”¹ä¸ºåªæ”¶é›†å¯åŠ¨å’Œåœæ­¢ã€‚åŸºæœ¬æ¶æ„æ˜¯äº‹ä»¶å‘ç”Ÿçš„æ—¶å€™ï¼Œäº‹ä»¶å¼‚æ­¥å‘é€ç»™ä¸€ä¸ª Channelï¼ŒChannel çš„å¦ä¸€ç«¯æœ‰ä¸€ä¸ªå¼‚æ­¥çš„ worker è´Ÿè´£ä¸æ–­å¤„ç†å„ä¸ªäº‹ä»¶å¹¶é€šè¿‡ Hyper HTTP Client å‘é€å‡ºå»ã€‚è¿™ä¸ªæµç¨‹å…¶å®ä¸ TiKV ä¸­æ±‡æŠ¥ PD äº‹ä»¶æœ‰äº›ç±»ä¼¼ï¼Œåªæ˜¯äº‹ä»¶å†…å®¹å’Œæ±‡æŠ¥ç›®æ ‡ä¸ä¸€æ ·ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;æ„Ÿæ‚Ÿ&lt;/b&gt;&lt;/h2&gt;&lt;blockquote&gt;&lt;i&gt;ä»¥ä¸‹æ–‡å­— by é©¬æ™“å®‡ @ OLAP Team, PingCAP&lt;/i&gt;&lt;br&gt;&lt;i&gt;â€œç”±äºæ¯”è¾ƒèƒ½è°ƒä¾ƒå¹²çš„æ´»ç›¸å¯¹å°‘ä¸€äº›ï¼Œæ‰€ä»¥å¤§ç‹è¦æˆ‘æ¥å·¡å±±å†™æ„Ÿæ‚Ÿã€‚â€&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;å°±åƒé˜Ÿé•¿è¯´çš„ï¼Œè¿™ä¸ªé¡¹ç›®åŸæœ¬æ˜¯å¸Œæœ›åšä¸€ä¸ª bRPC æ›¿æ¢ gRPC çš„è¯•éªŒï¼Œåªæ˜¯ç”±äºç§ç§åŸå› ä¸´åˆ° Hackathon å‰å¤œæˆ‘ä»¬æ‰ç¡®å®šè¿™æ˜¯ä¸ªå¤§æ¦‚ç‡ç¿»è½¦çš„ç‚¹å­ã€‚äºæ˜¯ä¹æˆ‘ä»¬åªå¥½åœ¨é…’åº—é‡ŒæŠ“è€³æŒ è…®ï¼Œä¸€è¾¹è®¨è®ºå¯èƒ½çš„è¡¥æ•‘æªæ–½ã€‚&lt;/p&gt;&lt;p&gt;å‚åŠ è¿‡ã€å›´è§‚è¿‡å‡ æ¬¡ Hackathonï¼Œè§è¿‡ç°åœº Demo æ•ˆæœæœ€éœ‡æ’¼çš„ä¸€æ¬¡å…¶å®å¹¶ä¸æ˜¯ä¸€ä¸ªæŠ€æœ¯ä¸Šæœ€ä¼˜ç§€çš„ä½œå“ï¼Œä½†æ˜¯å®ƒçš„ç¡®èµ¢å¾—äº†å¤§å¥–ã€‚é‚£æ˜¯ä¸€ä¸ªè„‘æ´å¥‡å¤§çš„ç‚¹å­ï¼šç”¨ Kinect ä½“æ„ŸåŠ ä¸Š DirectX çš„å…¨ 3D å±•ç¤ºåšçš„ç½‘ç»œæµé‡å®æ—¶å±•ç¤ºï¼›ç¨‹åºæ ¹æ®å®æ—¶æ•°æ®ï¼ˆä¸¾åŠæ–¹æä¾›äº†å®æ—¶ç½‘ç»œæµ‹é‡ç»Ÿè®¡ä¿¡æ¯ï¼‰èšåˆæ˜¾ç¤ºä¸åŒç²—ç»†çš„ç‚«é…·å¼§å…‰ç‰¹æ•ˆï¼Œè€Œæ¼”ç¤ºè€…åˆ™ç”¨æ‰‹åŠ¿æ“æ§åœ°çƒæ¨¡å‹çš„æ—‹è½¬ã€‚&lt;/p&gt;&lt;p&gt;äºæ˜¯åœ¨å®Œå…¨ä¸äº†è§£å¤§å®¶æ˜¯å¦èƒ½æå®šå‰ç«¯çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬è¿˜æ˜¯å¾ˆè½»ç‡åœ°å†³å®šäº†è¦åšä¸ªé‡å‰ç«¯çš„é¡¹ç›®ã€‚è‡³äºå±•ç¤ºä»€ä¹ˆï¼Ÿæ—¢ç„¶æ—¶é—´ä¸å¤Ÿï¼Œé‚£ä¹ˆç§€ä¸€ä¸ªéœ€è¦ç”Ÿäº§ä¸Šçº¿çš„å¯è§†åŒ–å·¥å…·ï¼Œç¿»è½¦çš„æ¦‚ç‡å°±å¤§çš„å¤šï¼Œä¸å¦‚ç›´æ¥å®šä½ä¸º For Educational Purpose Onlyã€‚è€Œä¸”å¤§æ¦‚æ˜¯è¿‡åº¦è§£è¯»äº†ç‚«é…·å¯¹äºæˆåŠŸçš„é‡è¦æ€§ï¼Œå› æ­¤é˜Ÿé•¿ä¹Ÿè½»ç‡åœ°å†³å®šäº†è¿™ä¸ªé¡¹ç›®çš„åŸºè°ƒæ˜¯ã€Œæå°½æµ®å¤¸ã€ã€‚å°±åœ¨è¿™æ ·å‹å¥½ä¸”ä¸é è°±çš„è®¨è®ºæ°›å›´ä¸‹ï¼Œè¿™ä¸ªé¡¹ç›®çš„ç­–åˆ’å‡ºç‚‰äº†ã€‚&lt;/p&gt;&lt;p&gt;ä¹‹åå°±æ˜¯è‰°è‹¦å“ç»è¿ç»µæ— ä¼‘çš„ä»£ç è¿‡ç¨‹äº†ã€‚&lt;/p&gt;&lt;p&gt;é¾™æ¯›äºŒå“¥ï¼Œæ™“å³°å’Œèƒ¡å®¶å±çš„ &lt;u&gt;&lt;a href=&quot;http://mp.weixin.qq.com/s?__biz=MzI3NDIxNTQyOQ==&amp;amp;mid=2247487451&amp;amp;idx=2&amp;amp;sn=5f1ee6e838c3a86556fcd556662112c5&amp;amp;chksm=eb1628b1dc61a1a7e8f4cb82e2bfaab40cbfb27e986f9705f9166d629ff31a812f7ae45b1d73&amp;amp;scene=21#wechat_redirect&quot;&gt;TiNiuB Team&lt;/a&gt;&lt;/u&gt; å°±åœ¨æˆ‘ä»¬å¯¹é¢å¼€å·¥ã€‚è®²é“ç†è¿™å…¶å®æ˜¯æˆ‘ä¸ªäººæœ€å–œæ¬¢çš„é¡¹ç›®ä¹‹ä¸€ã€‚ç¬¬ä¸€å¤©æ”¾å­¦çš„æ—¶å€™ï¼Œçœ‹ç€ä»–ä»¬çš„è¿›åº¦å…¶å®æˆ‘å¿ƒé‡Œè™šå¾—ä¸è¡Œï¼šçœ‹çœ‹åˆ«äººå®¶çš„é¡¹ç›®ï¼Œæˆ‘ä»¬çš„ç»å¯¹ä¸»åŠ›è¿˜åœ¨æŠ˜è…¾ TiDB Logo åŠ¨ç”»ï¼Œæ˜¯æˆ‘æ•¢æ€’ä¸æ•¢è¨€çš„çŠ¶æ€ã€‚&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-f2ade45b86ee55be8b85a1198f684000_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;240&quot; data-rawheight=&quot;240&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-f2ade45b86ee55be8b85a1198f684000&quot; data-watermark-src=&quot;v2-e650574cbe2a265f474817c1ac2c88e2&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;åŸæ¥æˆ‘æƒ³å·ä¸€ä¸‹æ‡’å›å®¶ç¡ä¸ªè§‰å•¥çš„ï¼Œå°±ä¸´æ—¶æ”¹å˜ä¸»æ„ç»§ç»­é…åˆé˜Ÿé•¿åŠªåŠ›å¹²æ´»ï¼›é’±åŒå­¦ä¹ŸæŠ±ç€ã€ŒTiKV ä¸€å¤©åªèƒ½ Build 24 æ¬¡å¿…é¡»çæƒœã€çš„æ€åº¦å†™ç€äººç”Ÿçš„ç¬¬ä¸€ä¸ª Rust é¡¹ç›®ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;å› æ­¤ï¼Œè¿™é‡Œå¿…é¡»é¸£è°¢é¾™å“¥ä»–ä»¬å¯¹æˆ‘ä»¬çš„é­ç­–ã€‚&lt;/b&gt;&lt;/p&gt;&lt;p&gt;äº‹å®è¯æ˜ï¼Œè¯¯æ‰“è¯¯æ’ä½†åˆæ·±è°‹è¿œè™‘çš„æµ®å¤¸æˆ˜ç•¥æ˜¯æœ‰æ•ˆçš„ã€‚Demo çš„æ—¶å€™æˆ‘å¾ˆè®¤çœŸåœ°ç›¯ç€è¯„å§”ï¼šåœ¨æœ¬é¡¹ç›®æœ€æµ®å¤¸çš„ Logo å±•ç¤ºç¯èŠ‚ï¼Œå¤§å®¶çš„çœ¼ç›æ˜¯å‘ç€å…‰çš„ï¼Œä¸€å¦‚ç›®ç¹äº†æ‘©è¥¿åˆ†å¼€çº¢æµ·ã€‚æˆ‘ä¸ªäººè®¤ä¸ºè¿™ä¸ªåŠ¨ç”» Logo ç”Ÿç”Ÿæ‹‰é«˜äº†é¡¹ç›® 50% çš„è¯„åˆ†ã€‚&lt;/p&gt;&lt;p&gt;åªæ˜¯å…·ä½“è¦è¯´æ„Ÿæ‚Ÿçš„è¯ï¼ˆä¼¼ä¹å¥½å¤šå¹´æ²¡å†™æ„Ÿæ‚Ÿäº†å‘¢ï¼‰ï¼Œé¦–å…ˆè¿™æ¬¡æˆ‘ä»¬ä¸‰ä¸ªç»„å‘˜è™½ç„¶æœ‰ä¸¤ä¸ªæ˜¯ PingCAP å‘˜å·¥ï¼Œä¸è¿‡ç”±äºæŠ€èƒ½çš„ç¼ºå£å¤§äºäººåŠ›ï¼Œå› æ­¤è´Ÿè´£çš„ä»»åŠ¡éƒ½ä¸æ˜¯è‡ªå·±æ‰€å±çš„æ¨¡å—ï¼šé˜Ÿé•¿æ˜¯ TiKV ç»„çš„ä½†æ˜¯åœ¨å†™å‰ç«¯ï¼Œæˆ‘æ˜¯ OLAP ç»„çš„ä½†æ˜¯åœ¨æ”¹ PD å’Œ DBï¼Œé’±åŒå­¦ä¹Ÿåœ¨åšè‡ªå·±ä»æ¥æ²¡å†™è¿‡çš„ Rustï¼ˆå‚èµ›å‰ä¸€å‘¨ç®€å•å…¥é—¨äº†ä¸€ä¸‹ï¼‰ï¼Œå› æ­¤å…¶å®è¿˜è›®æœ‰æŒ‘æˆ˜çš„ï¼ˆç¬‘ï¼‰ã€‚ç„¶åå¶å°”å†™å†™è‡ªå·±ä¸ç†Ÿæ‚‰çš„è¯­è¨€ï¼Œææè‡ªå·±ä¸ç†Ÿæ‚‰çš„æ¨¡å—ï¼Œä¼šæœ‰ä¸€ç§åˆ«æ ·çš„æ–°é²œåˆºæ¿€æ„Ÿï¼Œè¿™å¤§æ¦‚å°±æ˜¯æ‰€è°“çš„è·¯è¾¹é‡èŠ±æ›´é¦™å§ï¼ˆå—¯ï¼‰ï¼Ÿé™¤æ­¤ä¹‹å¤–ï¼ŒHackathon æ›´åƒä¸€ä¸ªå¤§å‹ç¤¾äº¤æ´»åŠ¨ï¼Œæ»¡è¶³äº†çŒ«ä¸€æ ·å­¤åƒ»çš„ç¨‹åºå‘˜ç¾¤ä½“è¢«éšè—çš„ç¤¾äº¤æ¬²ï¼Œæœ‰åˆ©äºç å†œçš„èº«å¿ƒå‘å±•ï¼Œå› æ­¤å¯ä»¥å¤šææ :) ã€‚&lt;/p&gt;&lt;p&gt;å›åˆ°æˆ‘ä»¬é¡¹ç›®æœ¬èº«çš„è¯ï¼Œå…¶å® TiDB çš„æºç é˜…è¯»æˆ–è€…å…¶ä»–ä»‹ç»ç±»æ–‡ç« å…¶å®å¹¶ä¸èƒ½éå¸¸ç›´è§‚åœ°å¸®åŠ©ä¸€å¤´é›¾æ°´çš„åˆå­¦è€…ç†è§£è¿™ä¸ªç³»ç»Ÿã€‚æˆ‘ä»¬åšè¿™ä¸ªé¡¹ç›®çš„æœ€å¤§ç›®çš„æ˜¯èƒ½é™ä½å­¦ä¹ é—¨æ§›ï¼Œè®©æ‰€æœ‰äººèƒ½ä»¥éå¸¸ç›´è§‚ï¼Œäº’åŠ¨çš„æ–¹å¼è¿‘è·ç¦»ç†è§£å¥¹ã€‚æ‰€ä»¥å¸Œæœ›è¿™ä¸ªé¡¹ç›®èƒ½ç»™å¤§å®¶å¸¦æ¥æ–¹ä¾¿å§ã€‚&lt;/p&gt;&lt;blockquote&gt;TiDB Hackathon 2018 å…±è¯„é€‰å‡ºå…­ä¸ªä¼˜ç§€é¡¹ç›®ï¼Œæœ¬ç³»åˆ—æ–‡ç« å°†ç”±è¿™å…­ä¸ªé¡¹ç›®æˆå‘˜ä¸»ç¬”ï¼Œåˆ†äº«ä»–ä»¬çš„å‚èµ›ç»éªŒå’Œæˆæœã€‚æˆ‘ä»¬éå¸¸å¸Œæœ›æœ¬å±Š Hackathon è¯ç”Ÿçš„ä¼˜ç§€é¡¹ç›®èƒ½å¤Ÿåœ¨ç¤¾åŒºä¸­å»¶ç»­ä¸‹å»ï¼Œæ„Ÿå…´è¶£çš„å°ä¼™ä¼´ä»¬å¯ä»¥åŠ å…¥è¿›æ¥å“¦ã€‚&lt;/blockquote&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>ZoeyZhai</author>
<guid isPermaLink="false">2018-12-14-52414551</guid>
<pubDate>Fri, 14 Dec 2018 00:00:00 +0800</pubDate>
</item>
<item>
<title>è®© TiDB è®¿é—®å¤šç§æ•°æ®æº | TiDB Hackathon ä¼˜ç§€é¡¹ç›®åˆ†äº«</title>
<link>https://henix.github.io/feeds/zhuanlan.newsql/2018-12-14-52413872.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/52413872&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-4dcc3a79d7a6c17e1fcf431ec2440e84_r.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;blockquote&gt;æœ¬æ–‡ä½œè€…æ˜¯æ¥è‡ª&lt;b&gt;CC ç»„çš„å…°æµ·åŒå­¦&lt;/b&gt;ï¼Œä»–ä»¬çš„é¡¹ç›®&lt;b&gt;ã€Šè®© TiDB è®¿é—®å¤šç§æ•°æ®æºã€‹&lt;/b&gt;åœ¨æœ¬å±Š TiDB Hackathon 2018 ä¸­è·å¾—äº†äºŒç­‰å¥–ã€‚è¯¥é¡¹ç›®å¯ä»¥è®© TiDB æ”¯æŒå¤šç§å¤–éƒ¨æ•°æ®æºçš„è®¿é—®ï¼Œé’ˆå¯¹ä¸åŒæ•°æ®æºçš„ç‰¹ç‚¹ä¼šä¸åŒçš„ä¸‹æ¨å·¥ä½œï¼Œä½¿ TiDB æˆä¸ºä¸€ä¸ªæ›´åŠ é€šç”¨çš„æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–å’Œè®¡ç®—å¹³å°ã€‚&lt;/blockquote&gt;&lt;p&gt;æˆ‘ä»¬é˜Ÿä¼æ˜¯ç”±æ­¦æ±‰å¤§å­¦åœ¨æ ¡å­¦ç”Ÿç»„æˆã€‚æˆ‘ä»¬é€‰æ‹©çš„è¯¾é¢˜æ˜¯è®© TiDB æ¥å…¥è‹¥å¹²å¤–éƒ¨çš„æ•°æ®æºï¼Œä½¿å¾— TiDB æˆä¸ºä¸€ä¸ªæ›´åŠ é€šç”¨çš„æŸ¥è¯¢ä¼˜åŒ–å’Œè®¡ç®—å¹³å°ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;ä¸ºä»€ä¹ˆé€‰è¿™ä¸ªè¯¾é¢˜&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;åˆšå¼€å§‹æˆ‘ä»¬é€‰æ‹©è¯¾é¢˜æ˜¯ TiDB æ‰§è¡Œè®¡åˆ’çš„å®æ—¶åŠ¨æ€å¯è§†åŒ–ã€‚ä½†æ˜¯å¡«äº†æŠ¥åå•åï¼ŒTiDB Robot å›å¤æˆ‘ä»¬è¯´åšå¯è§†åŒ–çš„äººå¤ªå¤šäº†ã€‚æˆ‘ä»¬æ‹…å¿ƒå’Œåˆ«äººå¤ªå¤šå†²çªï¼Œæ‰€ä»¥å’¨è¯¢äº†å¯¼å¸ˆçš„æ„è§ï¼Œæ”¹æˆäº† TiDB å¤–éƒ¨æ•°æ®æºè®¿é—®ã€‚è¿™æœŸé—´ä¹Ÿé˜…è¯»äº† F1 Query å’Œ Calcite è®ºæ–‡ï¼Œçœ‹äº†ä¸œæ—­å“¥ï¼ˆPingCAP CTOï¼‰åœ¨ PingCAP å†…éƒ¨çš„è®ºæ–‡é˜…è¯»çš„åˆ†äº«è§†é¢‘ã€‚æ„Ÿè§‰å†™ä¸€ä¸ªç®€å• Demoï¼Œè¿˜æ˜¯å¯è¡Œçš„ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;ç³»ç»Ÿæ¶æ„å’Œæ•ˆæœå±•ç¤º&lt;/b&gt;&lt;/h2&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-08d5704dedbfe4ea20221beb6dabcf52_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;777&quot; data-rawheight=&quot;449&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-08d5704dedbfe4ea20221beb6dabcf52&quot; data-watermark-src=&quot;v2-c2844ea0dd651526266cace4ae7eac28&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;å¦‚ä¸Šå›¾æ‰€ç¤ºï¼ŒTiDB é€šè¿‡ RPC æ¥å…¥å¤šä¸ªä¸åŒçš„æ•°æ®æºã€‚TiDB åˆ©ç”¨ RPC å‘é€è¯·æ±‚ç»™è¿œç«¯æ•°æ®æºï¼Œè¿œç«¯æ•°æ®æºæ”¶åˆ°è¯·æ±‚åï¼Œè¿›è¡ŒæŸ¥è¯¢å¤„ç†ï¼Œè¿”å›ç»“æœã€‚TiDB æ‹¿åˆ°è¿”å›ç»“æœè¿›ä¸€æ­¥çš„è¿›è¡Œè®¡ç®—å¤„ç†ã€‚&lt;/p&gt;&lt;p&gt;æˆ‘ä»¬é€šè¿‡å®šä¹‰ä¸€å¼ ç³»ç»Ÿè¡¨ foreign_register(table_name,source_type,rpc_info) è®°å½•ä¸€ä¸ªè¡¨ä¸Šçš„æ•°æ®å…·ä½“æ¥è‡ªå“ªç§æ•°æ®æºç±»å‹ï¼Œä»¥åŠå¯¹åº”çš„ RPC è¿æ¥ä¿¡æ¯ã€‚å¯¹äºæ¥è‡ª TiKV çš„æˆ‘ä»¬ä¸ç”¨åœ¨è¿™ä¸ªè¡¨ä¸­å†™å…¥ï¼Œé»˜è®¤çš„æ•°æ®å°±æ˜¯æ¥è‡ª TiKVã€‚&lt;/p&gt;&lt;p&gt;æˆ‘ä»¬æƒ³è®¿é—®ä¸€å¼  PostgreSQLï¼ˆåé¢ç®€ç§°ä¸º PGï¼‰ä¸Šçš„è¡¨ï¼šé¦–å…ˆï¼Œæˆ‘ä»¬åœ¨ TiDB ä¸Šå®šä¹‰ä¸€ä¸ªè¡¨(è®°ä¸ºè¡¨ a)ï¼Œç„¶ååˆ©ç”¨æˆ‘ä»¬ register_foreign(a,postgresql,ip#port#table_name) æ³¨å†Œç›¸å…³ä¿¡æ¯ã€‚ä¹‹åæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ select * from a æ¥è¯»å–åœ¨ PG ä¸Šåä¸º table_name çš„è¡¨ã€‚&lt;/p&gt;&lt;p&gt;æˆ‘ä»¬åœ¨è®¾è®¡å„ä¸ªæ•°æ®æºä¸Šæ•°æ®è®¿é—®æ—¶ï¼Œå……åˆ†è€ƒè™‘å„ä¸ªæ•°æ®æºè‡ªèº«çš„ç‰¹ç‚¹ã€‚å°†åˆé€‚çš„æ“ä½œä¸‹æ¨åˆ°å…·ä½“çš„æ•°æ®æºæ¥åšã€‚ä¾‹å¦‚ï¼ŒPG æœ¬èº«å°±æ˜¯ä¸€ä¸ªå®Œæ•´çš„æ•°æ®åº“ç³»ç»Ÿï¼Œæˆ‘ä»¬æ”¯æŒæŠ•å½±ã€æ¡ä»¶ã€è¿æ¥ä¸‹æ¨ç»™ PG æ¥åšã€‚Redis æ˜¯ä¸€ä¸ªå†…å­˜é”®å€¼æ•°æ®åº“ï¼Œæˆ‘ä»¬è€ƒè™‘åˆ°å…¶ Get ä»¥åŠç”¨æ­£åˆ™æ¥åŒ¹é…é”®å€¼å¾ˆå¿«ï¼Œæˆ‘ä»¬å°†åœ¨ Key å€¼åˆ—çš„ç‚¹æŸ¥è¯¢ä»¥åŠæ¨¡ç³ŠåŒ¹é…æŸ¥è¯¢éƒ½æ¨ç»™äº† Redis æ¥åšï¼Œå…¶ä»–æ¡ä»¶æŸ¥è¯¢æˆ‘ä»¬å°±æ²¡æœ‰è¿›è¡Œä¸‹æ¨ã€‚&lt;/p&gt;&lt;p&gt;å…·ä½“çš„è¿è¡Œæ•ˆæœå¦‚ä¸‹ï¼š&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-ad72ad983498655bfb7831ce6711d645_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;266&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-ad72ad983498655bfb7831ce6711d645&quot; data-watermark-src=&quot;v2-413d53a2fae37a96dcf666b492bb54d4&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;å¦‚å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬åœ¨è¿œç¨‹å¼€äº† 3 ä¸ª RPC Serverï¼Œè´Ÿè´£æ¥æ”¶ TiDB æ‰§è¡Œè¿‡ç¨‹ä¸­çš„å¤–éƒ¨è¡¨è¯·æ±‚ï¼Œå¹¶åœ¨å†…éƒ¨çš„ç³»ç»Ÿè¡¨ä¸­æ³¨å†Œä¸‰å¼ è¡¨ï¼Œå¹¶åœ¨ TiDB æœ¬åœ°è¿›è¡Œäº†æ¨¡å¼çš„åˆ›å»ºâ€”â€”åˆ†åˆ«æ˜¯remotecsvï¼Œremoteredisï¼Œremotepgï¼Œè¿˜æœ‰ä¸€å¼ æœ¬åœ° KV Store ä¸Šçš„ localkv è¡¨ã€‚æˆ‘ä»¬å¯¹ 4 å¼ è¡¨è¿›è¡Œ Join æ“ä½œï¼Œæ•ˆæœå¦‚å›¾æ‰€ç¤ºï¼Œè¯´æ˜å¦‚ä¸‹ã€‚&lt;/p&gt;&lt;ol&gt;&lt;li&gt;è¿œç¨‹ csv æ–‡ä»¶æˆ‘ä»¬ä¸åšé€‰æ‹©ä¸‹æ¨ï¼Œæ‰€ä»¥å¯ä»¥å‘ç° csv ä¸Šçš„æ¡ä»¶è¿˜æ˜¯åœ¨ rootï¼ˆå³æœ¬åœ°ï¼‰ä¸Šåšã€‚&lt;/li&gt;&lt;li&gt;è¿œç¨‹çš„ PG è¡¨ï¼Œæˆ‘ä»¬ä¼šè¿›è¡Œé€‰æ‹©ä¸‹æ¨ï¼Œæ‰€ä»¥å¯ä»¥å‘ç° PG è¡¨çš„ selection è¢«æ¨åˆ°äº† PG ä¸Šã€‚&lt;/li&gt;&lt;li&gt;è¿œç¨‹çš„ Redis è¡¨ï¼Œæˆ‘ä»¬ä¹Ÿä¼šè¿›è¡Œé€‰æ‹©ä¸‹æ¨ï¼ŒåŒæ—¶è¿˜å¯ä»¥åŒ…æ‹¬æ¨¡å‹æŸ¥è¯¢æ¡ä»¶ï¼ˆLikeï¼‰çš„ä¸‹æ¨ã€‚&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;P.S. æ­¤å¤–ï¼Œå¯¹äº PostgreSQL æºä¸Šä¸¤ä¸ªè¡¨çš„ Join æ“ä½œï¼Œæˆ‘ä»¬ä¹Ÿåšäº†Join çš„ä¸‹æ¨ï¼ŒJoin èŠ‚ç‚¹ä¹Ÿè¢«æ¨é€åˆ°äº† PostgreSQL æ¥åšï¼Œå…·ä½“çš„å›¾ç¤ºå¦‚ä¸‹ï¼š&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-eed13dc021d5362ada026473113cd194_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;270&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-eed13dc021d5362ada026473113cd194&quot; data-watermark-src=&quot;v2-63305dae95a51fbaa876ecde30b8342f&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;h2&gt;&lt;b&gt;å¦‚ä½•åšçš„&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;ç”±äºé¡¹ç›®åç¡¬æ ¸çš„ï¼Œéœ€è¦å……åˆ†ç†è§£ TiDB çš„ä¼˜åŒ–å™¨ï¼Œæ‰§è¡Œå™¨ç­‰ä»£ç ç»†èŠ‚ã€‚æ‰€ä»¥åœ¨æ¯”èµ›å‰æœŸï¼Œæˆ‘ä»¬èŠ±äº†ä¸¤ä¸‰å¤©å»ç ”è¯» TiDB çš„ä¼˜åŒ–å™¨ï¼Œæ‰§è¡Œå™¨ä»£ç ï¼Œå¼„æ¸…æ¥šä¸€ä¸ªç®€å•çš„ Select è¯­å¥æ‰”è¿› TiDB æ˜¯å¦‚ä½•è¿›è¡Œé€»è¾‘ä¼˜åŒ–ï¼Œç‰©ç†ä¼˜åŒ–ï¼Œä»¥åŠç”Ÿæˆæ‰§è¡Œå™¨ã€‚ä¹‹å‰æˆ‘ä»¬å¯¹ TiDB è¿™äº›ç»†èŠ‚éƒ½ä¸äº†è§£ï¼Œç¡¬ç€å»å•ƒã€‚å‘ç° TiDB ç”Ÿæˆå®Œæ‰§è¡Œå™¨ï¼Œä¼šè°ƒç”¨ä¸€ä¸ª Open å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°è¿˜æ˜¯ä¸€ä¸ªé€’å½’è°ƒç”¨ï¼Œæœ€ç»ˆåˆ° TableReader æ‰å‘å‡ºæ•°æ®è¯»å–è¯·æ±‚ï¼Œå¹¶ä¸”å·²ç»å¼€å§‹æ‹¿è¿”å›ç»“æœã€‚è¿™ä¸ªå’Œä»¥å‰åˆ†æçš„æ•°æ®åº“ç³»ç»Ÿè¿˜æœ‰äº›ä¸åŒã€‚å‰æœŸä¸ºäº†æ£€éªŒæˆ‘ä»¬è‡ªå·±å¯¹ TiDB çš„æ‰§è¡Œæµç¨‹ç†è§£çš„æ˜¯å¦æ¸…æ¥šï¼Œæˆ‘ä»¬å°è¯•ç€å»è®© TiDB è¯»å–æœ¬åœ° csv æ–‡ä»¶ã€‚&lt;/p&gt;&lt;p&gt;æ¯”èµ›æ­£å¼å¼€å§‹ï¼Œæˆ‘ä»¬ä¸€æ–¹é¢å®Œå–„ csvï¼Œä¸è®©å…¶è¿›è¡Œæ¡ä»¶ä¸‹æ¨ï¼Œå› ä¸ºæˆ‘ä»¬è¿œç«¯ RPC æ²¡æœ‰å¤„ç†æ¡ä»¶çš„èƒ½åŠ›ï¼Œæˆ‘ä»¬ä¿®æ”¹äº†é€»è¾‘è®¡åˆ’çš„æ¡ä»¶ä¸‹æ¨è§„åˆ™ï¼Œé‡åˆ°æ•°æ®æºæ˜¯ csv çš„ï¼Œæˆ‘ä»¬æ‹’ç»æ¡ä»¶ä¸‹æ¨ã€‚å¦ä¸€æ–¹é¢ï¼Œé¦–å…ˆå¾—å•ƒä¸‹ç¡¬éª¨å¤´ PostgreSQLã€‚æˆ‘ä»¬è€ƒè™‘äº†ä¸¤ç§æ–¹æ¡ˆï¼Œç¬¬ä¸€ç§æ˜¯æ‹¿åˆ° TiDB çš„ç‰©ç†è®¡åˆ’åï¼Œæˆ‘ä»¬å°†å…¶è½¬æ¢ä¸º SQLï¼Œç„¶åå‘ç»™ PGï¼›ç¬¬äºŒç§æ–¹æ¡ˆæˆ‘ä»¬ç›´æ¥å°† TiDB çš„ç‰©ç†è®¡åˆ’åºåˆ—åŒ–ä¸º PG çš„ç‰©ç†è®¡åˆ’ï¼Œå‘ç»™ PGã€‚æˆ‘ä»¬è€ƒè™‘åˆ°ç¬¬äºŒç§æ–¹æ¡ˆéœ€è¦ç»™ PG æœ¬èº«åŠ æ¥å—ç‰©ç†è®¡åˆ’çš„é’©å­ï¼Œå°±æœæ–­æ”¾å¼ƒï¼Œä¸ç„¶å¯èƒ½ä¸¤å¤©éƒ½è´¹åœ¨æ”¹ PG ä»£ç ä¸Šäº†ã€‚æˆ‘ä»¬é¦–å…ˆå®ç°äº† select * from pgtableã€‚ä¸»è¦ä¿®æ”¹äº†å¢åŠ  &lt;a href=&quot;https://github.com/hailanwhu/tidbhackthon2018/blob/b8e06e1c7571121db33efcacc20cb8ab9094f3cf/distsql/select_result.go#L45&quot;&gt;pgSelectResult&lt;/a&gt; ç»“æ„ä½“å®ç°å¯¹åº”çš„ç»“æ„ä½“ã€‚é€šè¿‡çœ‹è¯¥ç»“æ„ä½“ä»¥åŠå…¶å¯¹åº”æ¥å£å‡½æ•°ï¼Œå¤§å®¶å°±çŸ¥é“å¦‚ä½•å»è¯»å–ä¸€ä¸ªæ•°æ®æºä¸Šçš„æ•°æ®ï¼Œä»¥åŠæ˜¯å¦‚ä½•åšæŠ•å½±ä¸‹æ¨ã€‚ä¿®æ”¹ &lt;a href=&quot;https://github.com/hailanwhu/tidbhackthon2018/blob/b8e06e1c7571121db33efcacc20cb8ab9094f3cf/planner/core/logical_plans.go#L314&quot;&gt;Datasource&lt;/a&gt; æ•°æ®ç»“æ„å¢åŠ å¯¹æ•°æ®æºç±»å‹ï¼ŒRPC ä¿¡æ¯ï¼Œä»¥åŠæ¡ä»¶å­—ç¬¦ä¸²ï¼Œåœ¨éƒ¨åˆ†ç‰©ç†è®¡åˆ’å†…ï¼Œæˆ‘ä»¬ä¹Ÿå¢åŠ ç›¸å…³ä¿¡æ¯ã€‚åŒæ—¶æ ¹æ®æ•°æ®æºä¿¡æ¯ï¼Œåœ¨ &lt;a href=&quot;https://github.com/hailanwhu/tidbhackthon2018/blob/b8e06e1c7571121db33efcacc20cb8ab9094f3cf/executor/table_reader.go#L132&quot;&gt;ï¼ˆe*TableReaderExecutorï¼‰buildResp&lt;/a&gt; å¢åŠ å¯¹æ¥æºæ˜¯ PG çš„è¡¨å¤„ç†ã€‚&lt;/p&gt;&lt;p&gt;æ¥ç€æˆ‘ä»¬å¼€å§‹å°è¯•æ¡ä»¶ä¸‹æ¨ï¼šselect * from pgtable where â€¦ å°† where æ¨ä¸‹å»ã€‚æˆ‘ä»¬å‘ç°ç¬¬ä¸€é—®é¢˜ï¼šç”±äºæˆ‘ä»¬çš„æ³¨å†Œè¡¨é‡Œé¢æ²¡æœ‰è®°å½•å¤–éƒ¨æºæ•°æ®è¡¨çš„æ¨¡å¼ä¿¡æ¯å¯¼è‡´ï¼Œä¸‹æ¨å»æ„å»º SQL çš„æ—¶å€™æ ¹æœ¬æ‹¿ä¸åˆ°å¤–éƒ¨æ•°æ®æº PG ä¸Šæ­£ç¡®çš„å±æ€§åã€‚æ‰€ä»¥æˆ‘ä»¬æš‚æ—¶ä¿è¯ TiDB åˆ›å»ºçš„è¡¨æ¨¡å¼ä¸ PG åˆ›å»ºçš„è¡¨æ¨¡å¼å®Œå…¨ä¸€æ ·æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚æ¡ä»¶ä¸‹æ¨ï¼Œæˆ‘ä»¬å¯¹æ¡ä»¶çš„è½¬æ¢ä¸ºå­—ç¬¦ä¸²åœ¨å‡½æ•° &lt;a href=&quot;https://github.com/hailanwhu/tidbhackthon2018/blob/b8e06e1c7571121db33efcacc20cb8ab9094f3cf/expression/expr_to_pb.go#L72&quot;&gt;ExpressionToString&lt;/a&gt; ä¸­ï¼Œçœ‹è¯¥å‡½æ•°è°ƒç”¨å³å¯æ˜ç™½æ˜¯å¦‚ä½•è½¬æ¢çš„ã€‚å½“å‰æˆ‘ä»¬æ”¯æŒç­‰äºã€å¤§äºã€å°äºä¸‰ç§æ“ä½œç¬¦çš„ä¸‹æ¨ã€‚&lt;/p&gt;&lt;p&gt;å¾ˆå¿«å°±åˆ°äº† 1 å·ä¸‹åˆäº†ï¼Œæˆ‘ä»¬ä¸»è¦å·¥ä½œå°±æ˜¯è¿›è¡Œ &lt;a href=&quot;https://github.com/hailanwhu/tidbhackthon2018/blob/b8e06e1c7571121db33efcacc20cb8ab9094f3cf/executor/builder.go#L873&quot;&gt;Joinä¸‹æ¨&lt;/a&gt; çš„å·¥ä½œã€‚Join ä¸‹æ¨ä¸»è¦æ˜¯å½“æˆ‘ä»¬å‘ç°ä¸¤ä¸ª Join çš„è¡¨éƒ½æ¥æ¥è‡ªäºåŒä¸€ä¸ª PG å®ä¾‹æ—¶ï¼Œæˆ‘ä»¬å°±å°†è¯¥ Join ä¸‹æ¨ç»™ PGã€‚æˆ‘ä»¬å¢åŠ ä¸€ç§ Join æ‰§è¡Œå™¨ï¼š&lt;a href=&quot;https://github.com/hailanwhu/tidbhackthon2018/blob/b8e06e1c7571121db33efcacc20cb8ab9094f3cf/executor/join.go#L60&quot;&gt;PushDownJoinExec&lt;/a&gt; ã€‚å¼„å®Œ Join å·²ç»æ˜¯æ™šä¸Šäº†ã€‚è€Œä¸”ä¸­é—´è¿˜é‡åˆ°å‡ ä¸ª Bugï¼Œé¦–å…ˆï¼ŒPG ç­‰æ•°æ®æºæ²¡æœ‰ä¸€æ¡ç»“æœæ»¡è¶³æ—¶çš„è¾¹ç•Œæ¡ä»¶æ²¡æœ‰è¿›è¡Œæ£€æŸ¥ï¼Œå…¶æ¬¡æ˜¯ï¼Œåœ¨ Join ä¸‹æ¨æ—¶ï¼ŒæŸäº›æƒ…å†µä¸‹ Join æ¡ä»¶æœªå¿…éƒ½æ˜¯åœ¨ On å­å¥ï¼Œè¿™ä¸ªæ—¶å€™éœ€è¦è€ƒè™‘ Where å­å¥çš„ä¿¡æ¯ã€‚æœ€åä½¿å¾—è¿æ¥å’Œæ¡ä»¶åŒæ—¶ä¸‹æ¨æ²¡æœ‰é—®é¢˜ã€‚å› ä¸ºä¸åŒè¡¨çš„ç›¸åŒå±æ€§éœ€è¦è¿›è¡ŒåŒºåˆ†ã€‚ä¸»è¦éš¾ç‚¹å°±æ˜¯å¯¹å„ä¸ªç‰©ç†è®¡åˆ’çš„ç»“æ„ä½“ä¸­çš„è§£æå·¥ä½œã€‚&lt;/p&gt;&lt;p&gt;åˆ°äº†æ™šä¸Šï¼Œæˆ‘ä»¬å‡†å¤‡å¼€å§‹ç€æ‰‹æ¥å…¥ Redisã€‚è€ƒè™‘åˆ° Redis æœ¬èº«æ˜¯ KV å‹ï¼Œå¯¹äºç»™å®š Key çš„ Get  ä»¥åŠç»™å®š Key æ¨¡å¼çš„åŒ¹é…æ˜¯å¾ˆå¿«ã€‚æˆ‘ä»¬ç›´æ¥æƒ³åˆ°å¯¹äº Redisï¼Œæˆ‘ä»¬å…è®¸ Key å€¼åˆ—ä¸Šçš„æ¡ä»¶ä¸‹æ¨ï¼Œè®© Redis æ¥åšè¿‡æ»¤ã€‚å› ä¸º Redis æ˜¯ API å½¢å¼ï¼Œæˆ‘ä»¬å•ç‹¬å®šä¹‰ä¸€ä¸ªç®€å•è¯·æ±‚åè®®ï¼Œæ¥åŒºåˆ«å•å€¼ï¼Œæ¨¡ç³Šï¼Œä»¥åŠå…¨åº“æŸ¥è¯¢ä¸‰ç§åŸºæœ¬æƒ…å†µï¼Œè§ &lt;a href=&quot;https://github.com/hailanwhu/tidbhack2018rpcserver/blob/b132bfed58d5b9565250d9584bd6e280bc452ad0/rpcserverforredis.go#L12&quot;&gt;RequestRedis&lt;/a&gt; å®šä¹‰ã€‚Redis æ•´ä½“ä¹Ÿåƒæ˜¯ PG ä¸€æ ·çš„å¤„ç†ï¼Œä¸»è¦æ²¡æœ‰ Join ä¸‹æ¨è¿™ä¸€ä¸ªæ¯”è¾ƒå¤æ‚çš„ç‚¹ã€‚&lt;/p&gt;&lt;p&gt;æˆ‘ä»¬ä¹‹ååˆå¯¹ Explain éƒ¨åˆ†è¿›è¡Œä¿®æ”¹ï¼Œä½¿å¾—èƒ½å¤Ÿæ‰“å°èƒ½å¤Ÿåæ˜ æˆ‘ä»¬ç°åœ¨åŠ å…¥å¤–éƒ¨æ•°æ®æºåç®—å­çœŸå®çš„æ‰§è¡Œæƒ…å†µï¼Œå¯ä»¥è§ &lt;a href=&quot;https://github.com/hailanwhu/tidbhackthon2018/blob/b8e06e1c7571121db33efcacc20cb8ab9094f3cf/planner/core/common_plans.go#L525&quot;&gt;explainPlanInRowFormat&lt;/a&gt; éƒ¨åˆ†ä»£ç ã€‚ä¹‹åæˆ‘ä»¬å¼€å§‹è¿›è¡Œæµ‹è¯•æ¯ä¸ªæ•°æ®æºä¸Šçš„ï¼Œä»¥åŠå¤šä¸ªæ•°æ®æºèåˆèµ·æ¥è¿›è¡Œæµ‹è¯•ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;ä¸è¶³ä¹‹å¤„&lt;/b&gt;&lt;/h2&gt;&lt;ol&gt;&lt;li&gt;æˆ‘ä»¬å¾ˆå¤šç‰©ç†è®¡åˆ’éƒ½æ˜¯å¤ç”¨ TiDB æœ¬èº«çš„ï¼Œç»™ç‰©ç†è®¡åˆ’åŠ ä¸Šå¾ˆå¤šé™„å±å±æ€§ã€‚å…¶å®æœ€å¥½æ˜¯å°†è¿™äº›ç‰©ç†è®¡åˆ’å•ç‹¬æŠ½å–å‡ºæ¥å½¢æˆä¸€ä¸ªï¼Œä¸å»å¤ç”¨ã€‚&lt;/li&gt;&lt;li&gt;Cost æ²¡æœ‰è¿›è¡Œç»†è‡´è€ƒè™‘ï¼Œä¾‹å¦‚å¯¹äº Join ä¸‹æ¨ï¼Œå…¶å®ä¸¤å¼  100 ä¸‡çš„è¡¨è¿›è¡Œ Join å¯èƒ½ä½¿å¾—ç»“æœæˆä¸º 1000 ä¸‡ï¼Œé‚£ä¹ˆç½‘ç»œä¼ è¾“çš„ä»£ä»·åè€Œæ›´å¤§äº†ã€‚è¿™äº›å…·ä½“ç®—å­ä¸‹æ¨çš„ä»£ä»·è¿˜éœ€è¦ç»†è‡´çš„è€ƒè™‘ã€‚&lt;/li&gt;&lt;/ol&gt;&lt;h2&gt;&lt;b&gt;æ¯”è¾ƒç—›è‹¦çš„ç»å†&lt;/b&gt;&lt;/h2&gt;&lt;ol&gt;&lt;li&gt;TiDB ä¸æ”¯æŒ Create Funtionï¼Œæˆ‘ä»¬å°±åªå¥½å†™å†…ç½®å‡½æ•°ï¼Œå°±æŠŠå¦å¤–ä¸€ä¸ª Parser æ¨¡å—æ‹–ä¸‹æ¥ï¼Œè‡ªå·±ä¿®æ”¹åŠ ä¸Šè¯­æ³•ï¼Œç„¶ååœ¨åŠ ä¸Šè‡ªå·±è®¾è®¡çš„å†…ç½®å‡½æ•°ã€‚&lt;/li&gt;&lt;li&gt;æœ€ç—›è‹¦è¿˜æ˜¯ä¸¤ä¸ªæ–¹é¢ï¼Œé¦–å…ˆ Golang è¯­è¨€ï¼Œæˆ‘ä»¬ä¹‹å‰æ²¡æœ‰ç”¨å¾—å¾ˆå¤šï¼Œç»å¸¸é‡åˆ°äº›å°é—®é¢˜ï¼Œä¾‹å¦‚ interface çš„çµæ´»ä½¿ç”¨ç­‰ã€‚å…¶æ¬¡å°±æ˜¯æ¶‰åŠçš„ TiDB çš„æºç æ¨¡å—å¾ˆå¤šï¼Œä»ä¼˜åŒ–å™¨ã€æ‰§è¡Œå™¨ã€å†…ç½®å‡½æ•°ä»¥åŠå„ç§å„æ ·çš„ç»“æ„ã€‚è™½ç„¶æ€è·¯å¾ˆç®€å•ï¼Œä½†æ˜¯æ”¹åŠ¨çš„åœ°æ–¹éƒ½å¾ˆç»†èŠ‚ã€‚&lt;/li&gt;&lt;/ol&gt;&lt;h2&gt;&lt;b&gt;æ”¶è·&lt;/b&gt;&lt;/h2&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-3071d2d5a54975795c7008af298db4b7_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;831&quot; data-rawheight=&quot;616&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-3071d2d5a54975795c7008af298db4b7&quot; data-watermark-src=&quot;v2-5e8c67840493cada3362f35c86f6136a&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;æ¯”èµ›è¿‡ç¨‹ä¸­ï¼Œçœ‹åˆ°äº†éå¸¸å¤šä¼˜ç§€é€‰æ‰‹ï¼Œä»¥åŠä»–ä»¬é…·ç‚«çš„ä½œä¸šï¼Œæ„Ÿè§‰è¿˜æ˜¯æœ‰å¾ˆé•¿çš„è·¯è¦èµ°ã€‚Hackathon çš„é€‰æ‰‹éƒ½å¥½å‰å®³ï¼Œå¬åˆ°å¤§å®¶å™¼é‡Œå•ªå•¦æ•²é”®ç›˜çš„å£°éŸ³ï¼Œä¼¼ä¹è‡ªå·±ä¹Ÿä¸è§‰å¾—æœ‰å¤šç´¯äº†ã€‚äººå•Šï¼Œé€¼ä¸€ä¸‹è‡ªå·±ï¼Œä¼šæ„Ÿå—åˆ°è‡ªå·±æ— ç©·çš„åŠ›é‡ã€‚é€šè¿‡è¿™æ¬¡æ´»åŠ¨ï¼Œæˆ‘ä»¬æœ€ç»ˆèƒ½å¤Ÿçµæ´»ä½¿ç”¨ Golang è¯­è¨€ï¼Œå¯¹ TiDB æ•´ä½“ä¹Ÿæœ‰äº†æ›´æ·±å…¥çš„è®¤è¯†ï¼Œå¸Œæœ›è‡ªå·±ä»¥åèƒ½å¤Ÿç§°ä¸º TiDB çš„ä»£ç è´¡çŒ®è€…ã€‚&lt;/p&gt;&lt;p&gt;æœ€åéå¸¸æ„Ÿè°¢ PingCAP è¿™æ¬¡ç»„ç»‡çš„ Hackathon æ´»åŠ¨ï¼Œæ„Ÿè°¢å¯¼å¸ˆå›¢ã€å¿—æ„¿è€…ï¼Œä»¥åŠè¿˜æœ‰ç‰¹åˆ«æ„Ÿè°¢å¯¼å¸ˆå¼ å»ºçš„æŒ‡å¯¼ã€‚&lt;/p&gt;&lt;blockquote&gt;TiDB Hackathon 2018 å…±è¯„é€‰å‡ºå…­ä¸ªä¼˜ç§€é¡¹ç›®ï¼Œæœ¬ç³»åˆ—æ–‡ç« å°†ç”±è¿™å…­ä¸ªé¡¹ç›®æˆå‘˜ä¸»ç¬”ï¼Œåˆ†äº«ä»–ä»¬çš„å‚èµ›ç»éªŒå’Œæˆæœã€‚æˆ‘ä»¬éå¸¸å¸Œæœ›æœ¬å±Š Hackathon è¯ç”Ÿçš„ä¼˜ç§€é¡¹ç›®èƒ½å¤Ÿåœ¨ç¤¾åŒºä¸­å»¶ç»­ä¸‹å»ï¼Œæ„Ÿå…´è¶£çš„å°ä¼™ä¼´ä»¬å¯ä»¥åŠ å…¥è¿›æ¥å“¦ã€‚&lt;/blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>ZoeyZhai</author>
<guid isPermaLink="false">2018-12-14-52413872</guid>
<pubDate>Fri, 14 Dec 2018 00:00:00 +0800</pubDate>
</item>
<item>
<title>TiDB æºç é˜…è¯»ç³»åˆ—æ–‡ç« ï¼ˆäºŒåä¸€ï¼‰åŸºäºè§„åˆ™çš„ä¼˜åŒ– II</title>
<link>https://henix.github.io/feeds/zhuanlan.newsql/2018-12-11-52138596.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/52138596&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-180de02d6f7269fdf95e2294d895caf8_r.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;blockquote&gt;åœ¨ &lt;a href=&quot;https://pingcap.com/blog-cn/tidb-source-code-reading-7/&quot;&gt;TiDB æºç é˜…è¯»ç³»åˆ—æ–‡ç« ï¼ˆä¸ƒï¼‰åŸºäºè§„åˆ™çš„ä¼˜åŒ–&lt;/a&gt; ä¸€æ–‡ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº†å‡ ç§ TiDB ä¸­çš„é€»è¾‘ä¼˜åŒ–è§„åˆ™ï¼ŒåŒ…æ‹¬åˆ—å‰ªè£ï¼Œæœ€å¤§æœ€å°æ¶ˆé™¤ï¼ŒæŠ•å½±æ¶ˆé™¤ï¼Œè°“è¯ä¸‹æ¨å’Œæ„å»ºèŠ‚ç‚¹å±æ€§ï¼Œæœ¬ç¯‡å°†ç»§ç»­ä»‹ç»æ›´å¤šçš„ä¼˜åŒ–è§„åˆ™ï¼šèšåˆæ¶ˆé™¤ã€å¤–è¿æ¥æ¶ˆé™¤å’Œå­æŸ¥è¯¢ä¼˜åŒ–ã€‚&lt;/blockquote&gt;&lt;h2&gt;&lt;b&gt;èšåˆæ¶ˆé™¤&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;èšåˆæ¶ˆé™¤ä¼šæ£€æŸ¥ SQL æŸ¥è¯¢ä¸­ &lt;code class=&quot;inline&quot;&gt;Group By&lt;/code&gt; è¯­å¥æ‰€ä½¿ç”¨çš„åˆ—æ˜¯å¦å…·æœ‰å”¯ä¸€æ€§å±æ€§ï¼Œå¦‚æœæ»¡è¶³ï¼Œåˆ™ä¼šå°†æ‰§è¡Œè®¡åˆ’ä¸­ç›¸åº”çš„ &lt;code class=&quot;inline&quot;&gt;LogicalAggregation&lt;/code&gt; ç®—å­æ›¿æ¢ä¸º &lt;code class=&quot;inline&quot;&gt;LogicalProjection&lt;/code&gt; ç®—å­ã€‚è¿™é‡Œçš„é€»è¾‘æ˜¯å½“èšåˆå‡½æ•°æŒ‰ç…§å…·æœ‰å”¯ä¸€æ€§å±æ€§çš„ä¸€åˆ—æˆ–å¤šåˆ—åˆ†ç»„æ—¶ï¼Œä¸‹å±‚ç®—å­è¾“å‡ºçš„æ¯ä¸€è¡Œéƒ½æ˜¯ä¸€ä¸ªå•ç‹¬çš„åˆ†ç»„ï¼Œè¿™æ—¶å°±å¯ä»¥å°†èšåˆå‡½æ•°å±•å¼€æˆå…·ä½“çš„å‚æ•°åˆ—æˆ–è€…åŒ…å«å‚æ•°åˆ—çš„æ™®é€šå‡½æ•°è¡¨è¾¾å¼ï¼Œå…·ä½“çš„ä»£ç å®ç°åœ¨ &lt;code class=&quot;inline&quot;&gt;&lt;a href=&quot;https://github.com/eurekaka/tidb/blob/logical_rules_reading/planner/core/rule_aggregation_elimination.go&quot;&gt;rule_aggregation_elimination.go&lt;/a&gt;&lt;/code&gt; æ–‡ä»¶ä¸­ã€‚ä¸‹é¢ä¸¾ä¸€äº›å…·ä½“çš„ä¾‹å­ã€‚&lt;/p&gt;&lt;p&gt;ä¾‹ä¸€ï¼š&lt;/p&gt;&lt;p&gt;ä¸‹é¢è¿™ä¸ª Query å¯ä»¥å°†èšåˆå‡½æ•°å±•å¼€æˆåˆ—çš„æŸ¥è¯¢ï¼š&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;select max(a) from t group by t.pk;&lt;/code&gt;&lt;p&gt;è¢«ç­‰ä»·åœ°æ”¹å†™æˆï¼š&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;select a from t;&lt;/code&gt;&lt;p&gt;ä¾‹äºŒï¼š&lt;/p&gt;&lt;p&gt;ä¸‹é¢è¿™ä¸ª Query å¯ä»¥å°†èšåˆå‡½æ•°å±•å¼€ä¸ºåŒ…å«å‚æ•°åˆ—çš„å†…ç½®å‡½æ•°çš„æŸ¥è¯¢ï¼š&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;select count(a) from t group by t.pk;&lt;/code&gt;&lt;p&gt;è¢«ç­‰ä»·åœ°æ”¹å†™æˆï¼š&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;select if(isnull(a), 0, 1) from t;&lt;/code&gt;&lt;p&gt;è¿™é‡Œå…¶å®è¿˜å¯ä»¥åšè¿›ä¸€æ­¥çš„ä¼˜åŒ–ï¼šå¦‚æœåˆ— &lt;code class=&quot;inline&quot;&gt;a&lt;/code&gt; å…·æœ‰ &lt;code class=&quot;inline&quot;&gt;Not Null&lt;/code&gt; çš„å±æ€§ï¼Œé‚£ä¹ˆå¯ä»¥å°† &lt;code class=&quot;inline&quot;&gt;if(isnull(a), 0, 1)&lt;/code&gt; ç›´æ¥æ›¿æ¢ä¸ºå¸¸é‡ 1ï¼ˆç›®å‰ TiDB è¿˜æ²¡åšè¿™ä¸ªä¼˜åŒ–ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥æ¥è´¡çŒ®ä¸€ä¸ª PRï¼‰ã€‚&lt;/p&gt;&lt;p&gt;å¦å¤–æä¸€ç‚¹ï¼Œå¯¹äºå¤§éƒ¨åˆ†èšåˆå‡½æ•°ï¼Œå‚æ•°çš„ç±»å‹å’Œè¿”å›ç»“æœçš„ç±»å‹ä¸€èˆ¬æ˜¯ä¸åŒçš„ï¼Œæ‰€ä»¥åœ¨å±•å¼€èšåˆå‡½æ•°çš„æ—¶å€™ä¸€èˆ¬ä¼šåœ¨å‚æ•°åˆ—ä¸Šæ„é€  cast å‡½æ•°åšç±»å‹è½¬æ¢ï¼Œå±•å¼€åçš„è¡¨è¾¾å¼ä¼šä¿å­˜åœ¨ä½œä¸ºæ›¿æ¢ &lt;code class=&quot;inline&quot;&gt;LogicalAggregation&lt;/code&gt; ç®—å­çš„ &lt;code class=&quot;inline&quot;&gt;LogicalProjection&lt;/code&gt; ç®—å­ä¸­ã€‚&lt;/p&gt;&lt;p&gt;è¿™ä¸ªä¼˜åŒ–è¿‡ç¨‹ä¸­ï¼Œæœ‰ä¸€ç‚¹éå¸¸å…³é”®ï¼Œå°±æ˜¯å¦‚ä½•çŸ¥é“ &lt;code class=&quot;inline&quot;&gt;Group By&lt;/code&gt; ä½¿ç”¨çš„åˆ—æ˜¯å¦æ»¡è¶³å”¯ä¸€æ€§å±æ€§ï¼Œå°¤å…¶æ˜¯å½“èšåˆç®—å­çš„ä¸‹å±‚èŠ‚ç‚¹ä¸æ˜¯ &lt;code class=&quot;inline&quot;&gt;DataSource&lt;/code&gt; çš„æ—¶å€™ï¼Ÿæˆ‘ä»¬åœ¨ &lt;a href=&quot;https://pingcap.com/blog-cn/tidb-source-code-reading-7/&quot;&gt;åŸºäºè§„åˆ™çš„ä¼˜åŒ–&lt;/a&gt; ä¸€æ–‡ä¸­çš„â€œæ„å»ºèŠ‚ç‚¹å±æ€§â€ç« èŠ‚æåˆ°è¿‡ï¼Œæ‰§è¡Œè®¡åˆ’ä¸­æ¯ä¸ªç®—å­èŠ‚ç‚¹ä¼šç»´æŠ¤è¿™æ ·ä¸€ä¸ªä¿¡æ¯ï¼šå½“å‰ç®—å­çš„è¾“å‡ºä¼šæŒ‰ç…§å“ªä¸€åˆ—æˆ–è€…å“ªå‡ åˆ—æ»¡è¶³å”¯ä¸€æ€§å±æ€§ã€‚å› æ­¤ï¼Œåœ¨èšåˆæ¶ˆé™¤ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æŸ¥çœ‹ä¸‹å±‚ç®—å­ä¿å­˜çš„è¿™ä¸ªä¿¡æ¯ï¼Œå†ç»“åˆ &lt;code class=&quot;inline&quot;&gt;Group By&lt;/code&gt; ç”¨åˆ°çš„åˆ—åˆ¤æ–­å½“å‰èšåˆç®—å­æ˜¯å¦å¯ä»¥è¢«æ¶ˆé™¤ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;å¤–è¿æ¥æ¶ˆé™¤&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;ä¸åŒäº &lt;a href=&quot;https://pingcap.com/blog-cn/tidb-source-code-reading-7/&quot;&gt;åŸºäºè§„åˆ™çš„ä¼˜åŒ–&lt;/a&gt; ä¸€æ–‡ä¸­â€œè°“è¯ä¸‹æ¨â€ç« èŠ‚æåˆ°çš„å°†å¤–è¿æ¥è½¬æ¢ä¸ºå†…è¿æ¥ï¼Œè¿™é‡Œå¤–è¿æ¥æ¶ˆé™¤æŒ‡çš„æ˜¯å°†æ•´ä¸ªè¿æ¥æ“ä½œä»æŸ¥è¯¢ä¸­ç§»é™¤ã€‚&lt;/p&gt;&lt;p&gt;å¤–è¿æ¥æ¶ˆé™¤éœ€è¦æ»¡è¶³ä¸€å®šæ¡ä»¶ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;æ¡ä»¶ 1 : &lt;code class=&quot;inline&quot;&gt;LogicalJoin&lt;/code&gt; çš„çˆ¶äº²ç®—å­åªä¼šç”¨åˆ° &lt;code class=&quot;inline&quot;&gt;LogicalJoin&lt;/code&gt; çš„ outer plan æ‰€è¾“å‡ºçš„åˆ—&lt;/li&gt;&lt;li&gt;æ¡ä»¶ 2 :&lt;/li&gt;&lt;ul&gt;&lt;li&gt;æ¡ä»¶ 2.1 : &lt;code class=&quot;inline&quot;&gt;LogicalJoin&lt;/code&gt; ä¸­çš„ join key åœ¨ inner plan çš„è¾“å‡ºç»“æœä¸­æ»¡è¶³å”¯ä¸€æ€§å±æ€§&lt;/li&gt;&lt;li&gt;æ¡ä»¶ 2.2 : &lt;code class=&quot;inline&quot;&gt;LogicalJoin&lt;/code&gt; çš„çˆ¶äº²ç®—å­ä¼šå¯¹è¾“å…¥çš„è®°å½•å»é‡&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;p&gt;æ¡ä»¶ 1 å’Œæ¡ä»¶ 2 å¿…é¡»åŒæ—¶æ»¡è¶³ï¼Œä½†æ¡ä»¶ 2.1 å’Œæ¡ä»¶ 2.2 åªéœ€æ»¡è¶³ä¸€æ¡å³å¯ã€‚&lt;/p&gt;&lt;p&gt;æ»¡è¶³æ¡ä»¶ 1 å’Œ æ¡ä»¶ 2.1 çš„ä¸€ä¸ªä¾‹å­ï¼š&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;select t1.a from t1 left join t2 on t1.b = t2.pk;&lt;/code&gt;&lt;p&gt;å¯ä»¥è¢«æ”¹å†™æˆï¼š&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;select t1.a from t1;&lt;/code&gt;&lt;p&gt;æ»¡è¶³æ¡ä»¶ 1 å’Œæ¡ä»¶ 2.2 çš„ä¸€ä¸ªä¾‹å­ï¼š&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;select distinct(t1.a) from t1 left join t2 on t1.b = t2.b;&lt;/code&gt;&lt;p&gt;å¯ä»¥è¢«æ”¹å†™æˆï¼š&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;select distinct(t1.a) from t1;&lt;/code&gt;&lt;p&gt;å…·ä½“çš„åŸç†æ˜¯ï¼Œå¯¹äºå¤–è¿æ¥ï¼Œouter plan çš„æ¯ä¸€è¡Œè®°å½•è‚¯å®šä¼šåœ¨è¿æ¥çš„ç»“æœé›†é‡Œå‡ºç°ä¸€æ¬¡æˆ–å¤šæ¬¡ï¼Œå½“ outer plan çš„è¡Œä¸èƒ½æ‰¾åˆ°åŒ¹é…æ—¶ï¼Œæˆ–è€…åªèƒ½æ‰¾åˆ°ä¸€è¡ŒåŒ¹é…æ—¶ï¼Œè¿™è¡Œ outer plan çš„è®°å½•åœ¨è¿æ¥ç»“æœä¸­åªå‡ºç°ä¸€æ¬¡ï¼›å½“ outer plan çš„è¡Œèƒ½æ‰¾åˆ°å¤šè¡ŒåŒ¹é…æ—¶ï¼Œå®ƒä¼šåœ¨è¿æ¥ç»“æœä¸­å‡ºç°å¤šæ¬¡ï¼›é‚£ä¹ˆå¦‚æœ inner plan åœ¨ join key ä¸Šæ»¡è¶³å”¯ä¸€æ€§å±æ€§ï¼Œå°±ä¸å¯èƒ½å­˜åœ¨ outer plan çš„è¡Œèƒ½å¤Ÿæ‰¾åˆ°å¤šè¡ŒåŒ¹é…ï¼Œæ‰€ä»¥è¿™æ—¶ outer plan çš„æ¯ä¸€è¡Œéƒ½ä¼šä¸”ä»…ä¼šåœ¨è¿æ¥ç»“æœä¸­å‡ºç°ä¸€æ¬¡ã€‚åŒæ—¶ï¼Œä¸Šå±‚ç®—å­åªéœ€è¦ outer plan çš„æ•°æ®ï¼Œé‚£ä¹ˆå¤–è¿æ¥å¯ä»¥ç›´æ¥ä»æŸ¥è¯¢ä¸­è¢«å»é™¤æ‰ã€‚åŒç†å°±å¯ä»¥å¾ˆå®¹æ˜“ç†è§£å½“ä¸Šå±‚ç®—å­åªéœ€è¦ outer plan çš„å»é‡åç»“æœæ—¶ï¼Œå¤–è¿æ¥ä¹Ÿå¯ä»¥è¢«æ¶ˆé™¤ã€‚&lt;/p&gt;&lt;p&gt;è¿™éƒ¨åˆ†ä¼˜åŒ–çš„å…·ä½“ä»£ç å®ç°åœ¨ &lt;a href=&quot;https://github.com/eurekaka/tidb/blob/logical_rules_reading/planner/core/rule_join_elimination.go&quot;&gt;rule_join_elimination.go&lt;/a&gt; æ–‡ä»¶ä¸­ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;å­æŸ¥è¯¢ä¼˜åŒ– / å»ç›¸å…³&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;å­æŸ¥è¯¢åˆ†ä¸ºéç›¸å…³å­æŸ¥è¯¢å’Œç›¸å…³å­æŸ¥è¯¢ï¼Œä¾‹å¦‚ï¼š&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;-- éç›¸å…³å­æŸ¥è¯¢
select * from t1 where t1.a &amp;gt; (select t2.a from t2 limit 1);
-- ç›¸å…³å­æŸ¥è¯¢
select * from t1 where t1.a &amp;gt; (select t2.a from t2 where t2.b &amp;gt; t1.b limit 1);&lt;/code&gt;&lt;p&gt;å¯¹äºéç›¸å…³å­æŸ¥è¯¢ï¼Œ TiDB ä¼šåœ¨ &lt;code class=&quot;inline&quot;&gt;expressionRewriter&lt;/code&gt; çš„é€»è¾‘ä¸­åšä¸¤ç±»æ“ä½œï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;å­æŸ¥è¯¢å±•å¼€&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;å³ç›´æ¥æ‰§è¡Œå­æŸ¥è¯¢è·å¾—ç»“æœï¼Œå†åˆ©ç”¨è¿™ä¸ªç»“æœæ”¹å†™åŸæœ¬åŒ…å«å­æŸ¥è¯¢çš„è¡¨è¾¾å¼ï¼›æ¯”å¦‚ä¸Šè¿°çš„éç›¸å…³å­æŸ¥è¯¢ï¼Œå¦‚æœå…¶è¿”å›çš„ç»“æœä¸ºä¸€è¡Œè®°å½• â€œ1â€ ï¼Œé‚£ä¹ˆæ•´ä¸ªæŸ¥è¯¢ä¼šè¢«æ”¹å†™ä¸ºï¼š&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;select * from t1 where t1.a &amp;gt; 1;&lt;/code&gt;&lt;p&gt;è¯¦ç»†çš„ä»£ç é€»è¾‘å¯ä»¥å‚è€ƒ&lt;a href=&quot;https://github.com/eurekaka/tidb/blob/logical_rules_reading/planner/core/expression_rewriter.go&quot;&gt;expression_rewriter.go&lt;/a&gt;ä¸­çš„&lt;a href=&quot;https://github.com/eurekaka/tidb/blob/logical_rules_reading/planner/core/expression_rewriter.go#L685&quot;&gt;handleScalarSubquery&lt;/a&gt;å’Œ&lt;a href=&quot;https://github.com/eurekaka/tidb/blob/logical_rules_reading/planner/core/expression_rewriter.go#L535&quot;&gt;handleExistSubquery&lt;/a&gt;å‡½æ•°ã€‚&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;å­æŸ¥è¯¢è½¬ä¸º Join&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;å¯¹äºåŒ…å« IN (subquery) çš„æŸ¥è¯¢ï¼Œæ¯”å¦‚ï¼š&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;select * from t1 where t1.a in (select t2.a from t2);&lt;/code&gt;&lt;p&gt;ä¼šè¢«æ”¹å†™æˆï¼š&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;select t1.* from t1 inner join (select distinct(t2.a) as a from t2) as sub on t1.a = sub.a;&lt;/code&gt;&lt;p&gt;å¦‚æœ &lt;code class=&quot;inline&quot;&gt;t2.a&lt;/code&gt; æ»¡è¶³å”¯ä¸€æ€§å±æ€§ï¼Œæ ¹æ®ä¸Šé¢ä»‹ç»çš„èšåˆæ¶ˆé™¤è§„åˆ™ï¼ŒæŸ¥è¯¢ä¼šè¢«è¿›ä¸€æ­¥æ”¹å†™æˆï¼š&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;select t1.* from t1 inner join t2 on t1.a = t2.a;&lt;/code&gt;&lt;p&gt;è¿™é‡Œé€‰æ‹©å°†å­æŸ¥è¯¢è½¬åŒ–ä¸º inner join çš„ inner plan è€Œä¸æ˜¯æ‰§è¡Œå­æŸ¥è¯¢çš„åŸå› æ˜¯ï¼šä»¥ä¸Šè¿°æŸ¥è¯¢ä¸ºä¾‹ï¼Œå­æŸ¥è¯¢çš„ç»“æœé›†å¯èƒ½ä¼šå¾ˆå¤§ï¼Œå±•å¼€å­æŸ¥è¯¢éœ€è¦ä¸€æ¬¡æ€§å°† &lt;code class=&quot;inline&quot;&gt;t2&lt;/code&gt; çš„å…¨éƒ¨æ•°æ®ä» TiKV è¿”å›åˆ° TiDB ä¸­ç¼“å­˜ï¼Œå¹¶ä½œä¸º &lt;code class=&quot;inline&quot;&gt;t1&lt;/code&gt; æ‰«æçš„è¿‡æ»¤æ¡ä»¶ï¼›å¦‚æœå°†å­æŸ¥è¯¢è½¬åŒ–ä¸º inner join çš„ inner plan ï¼Œæˆ‘ä»¬å¯ä»¥æ›´çµæ´»åœ°å¯¹ &lt;code class=&quot;inline&quot;&gt;t2&lt;/code&gt; é€‰æ‹©è®¿é—®æ–¹å¼ï¼Œæ¯”å¦‚æˆ‘ä»¬å¯ä»¥å¯¹ join é€‰æ‹© &lt;code class=&quot;inline&quot;&gt;IndexLookUpJoin&lt;/code&gt; å®ç°æ–¹å¼ï¼Œé‚£ä¹ˆå¯¹äºæ‹¿åˆ°çš„æ¯ä¸€æ¡ &lt;code class=&quot;inline&quot;&gt;t1&lt;/code&gt; è¡¨æ•°æ®ï¼Œæˆ‘ä»¬åªéœ€æ‹¿ &lt;code class=&quot;inline&quot;&gt;t1.a&lt;/code&gt; ä½œä¸º range å¯¹ &lt;code class=&quot;inline&quot;&gt;t2&lt;/code&gt; åšä¸€æ¬¡ç´¢å¼•æ‰«æï¼Œå¦‚æœ &lt;code class=&quot;inline&quot;&gt;t1&lt;/code&gt; è¡¨å¾ˆå°ï¼Œç›¸æ¯”äºå±•å¼€å­æŸ¥è¯¢è¿”å› &lt;code class=&quot;inline&quot;&gt;t2&lt;/code&gt; å…¨éƒ¨æ•°æ®ï¼Œæˆ‘ä»¬å¯èƒ½æ€»å…±åªéœ€è¦ä» &lt;code class=&quot;inline&quot;&gt;t2&lt;/code&gt; è¿”å›å¾ˆå°‘çš„å‡ æ¡æ•°æ®ã€‚&lt;/p&gt;&lt;p&gt;æ³¨æ„è¿™ä¸ªè½¬æ¢çš„ç»“æœä¸ä¸€å®šä¼šæ¯”å±•å¼€å­æŸ¥è¯¢æ›´å¥½ï¼Œå…¶å…·ä½“æƒ…å†µä¼šå— &lt;code class=&quot;inline&quot;&gt;t1&lt;/code&gt; è¡¨å’Œ &lt;code class=&quot;inline&quot;&gt;t2&lt;/code&gt; è¡¨æ•°æ®çš„å½±å“ï¼Œå¦‚æœåœ¨ä¸Šè¿°æŸ¥è¯¢ä¸­ï¼Œ &lt;code class=&quot;inline&quot;&gt;t1&lt;/code&gt;è¡¨å¾ˆå¤§è€Œ &lt;code class=&quot;inline&quot;&gt;t2&lt;/code&gt; è¡¨å¾ˆå°ï¼Œé‚£ä¹ˆå±•å¼€å­æŸ¥è¯¢å†å¯¹ &lt;code class=&quot;inline&quot;&gt;t1&lt;/code&gt; é€‰æ‹©ç´¢å¼•æ‰«æå¯èƒ½æ‰æ˜¯æœ€å¥½çš„æ–¹æ¡ˆï¼Œæ‰€ä»¥ç°åœ¨æœ‰å‚æ•°æ§åˆ¶è¿™ä¸ªè½¬åŒ–æ˜¯å¦æ‰“å¼€ï¼Œè¯¦ç»†çš„ä»£ç å¯ä»¥å‚è€ƒ &lt;a href=&quot;https://github.com/eurekaka/tidb/blob/logical_rules_reading/planner/core/expression_rewriter.go&quot;&gt;expression_rewriter.go&lt;/a&gt; ä¸­çš„ &lt;a href=&quot;https://github.com/eurekaka/tidb/blob/logical_rules_reading/planner/core/expression_rewriter.go#L596&quot;&gt;handleInSubquery&lt;/a&gt; å‡½æ•°ã€‚&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;ç›¸å…³å­æŸ¥è¯¢&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;å¯¹äºç›¸å…³å­æŸ¥è¯¢ï¼ŒTiDB ä¼šåœ¨&lt;code class=&quot;inline&quot;&gt;expressionRewriter&lt;/code&gt;ä¸­å°†æ•´ä¸ªåŒ…å«ç›¸å…³å­æŸ¥è¯¢çš„è¡¨è¾¾å¼è½¬åŒ–ä¸º&lt;code class=&quot;inline&quot;&gt;LogicalApply&lt;/code&gt;ç®—å­ã€‚&lt;code class=&quot;inline&quot;&gt;LogicalApply&lt;/code&gt;ç®—å­æ˜¯ä¸€ç±»ç‰¹æ®Šçš„&lt;code class=&quot;inline&quot;&gt;LogicalJoin&lt;/code&gt;ï¼Œç‰¹æ®Šä¹‹å¤„ä½“ç°åœ¨æ‰§è¡Œé€»è¾‘ä¸Šï¼šå¯¹äº outer plan è¿”å›çš„æ¯ä¸€è¡Œè®°å½•ï¼Œå–å‡ºç›¸å…³åˆ—çš„å…·ä½“å€¼ä¼ é€’ç»™å­æŸ¥è¯¢ï¼Œå†æ‰§è¡Œæ ¹æ®å­æŸ¥è¯¢ç”Ÿæˆçš„ inner plan ï¼Œå³&lt;code class=&quot;inline&quot;&gt;LogicalApply&lt;/code&gt;åœ¨æ‰§è¡Œæ—¶åªèƒ½é€‰æ‹©ç±»ä¼¼ å¾ªç¯åµŒå¥—è¿æ¥çš„æ–¹å¼ï¼Œè€Œæ™®é€šçš„&lt;code class=&quot;inline&quot;&gt;LogicalJoin&lt;/code&gt;åˆ™å¯ä»¥åœ¨ç‰©ç†ä¼˜åŒ–é˜¶æ®µæ ¹æ®ä»£ä»·æ¨¡å‹é€‰æ‹©æœ€åˆé€‚çš„æ‰§è¡Œæ–¹å¼ï¼ŒåŒ…æ‹¬&lt;code class=&quot;inline&quot;&gt;HashJoin&lt;/code&gt;ï¼Œ&lt;code class=&quot;inline&quot;&gt;MergeJoin&lt;/code&gt;å’Œ&lt;code class=&quot;inline&quot;&gt;IndexLookUpJoin&lt;/code&gt;ï¼Œç†è®ºä¸Šåè€…ç”Ÿæˆçš„ç‰©ç†æ‰§è¡Œè®¡åˆ’ä¸€å®šä¼šæ¯”å‰è€…æ›´ä¼˜ï¼Œæ‰€ä»¥åœ¨é€»è¾‘ä¼˜åŒ–é˜¶æ®µæˆ‘ä»¬ä¼šæ£€æŸ¥æ˜¯å¦å¯ä»¥åº”ç”¨â€œå»ç›¸å…³â€è¿™ä¸€ä¼˜åŒ–è§„åˆ™ï¼Œè¯•å›¾å°†&lt;code class=&quot;inline&quot;&gt;LogicalApply&lt;/code&gt;è½¬åŒ–ä¸ºç­‰ä»·çš„&lt;code class=&quot;inline&quot;&gt;LogicalJoin&lt;/code&gt;ã€‚å…¶æ ¸å¿ƒæ€æƒ³æ˜¯å°†&lt;code class=&quot;inline&quot;&gt;LogicalApply&lt;/code&gt;çš„ inner plan ä¸­åŒ…å«ç›¸å…³åˆ—çš„é‚£äº›ç®—å­æå‡åˆ°&lt;code class=&quot;inline&quot;&gt;LogicalApply&lt;/code&gt;ä¹‹ä¸­æˆ–ä¹‹ä¸Šï¼Œåœ¨ç®—å­æå‡åå¦‚æœ inner plan ä¸­ä¸å†åŒ…å«ä»»ä½•çš„ç›¸å…³åˆ—ï¼Œå³ä¸å†å¼•ç”¨ä»»ä½• outer plan ä¸­çš„åˆ—ï¼Œé‚£ä¹ˆ&lt;code class=&quot;inline&quot;&gt;LogicalApply&lt;/code&gt;å°±ä¼šè¢«è½¬æ¢ä¸ºæ™®é€šçš„&lt;code class=&quot;inline&quot;&gt;LogicalJoin&lt;/code&gt;ï¼Œè¿™éƒ¨åˆ†ä»£ç é€»è¾‘å®ç°åœ¨&lt;a href=&quot;https://github.com/eurekaka/tidb/blob/logical_rules_reading/planner/core/rule_decorrelate.go&quot;&gt;rule_decorrelate.go&lt;/a&gt;æ–‡ä»¶ä¸­ã€‚&lt;/p&gt;&lt;p&gt;å…·ä½“çš„ç®—å­æå‡æ–¹å¼åˆ†ä¸ºä»¥ä¸‹å‡ ç§æƒ…å†µï¼š&lt;/p&gt;&lt;p&gt;&lt;b&gt;1. inner plan çš„æ ¹èŠ‚ç‚¹æ˜¯&lt;code class=&quot;inline&quot;&gt;LogicalSelection&lt;/code&gt;&lt;/b&gt; &lt;/p&gt;&lt;p&gt;åˆ™å°†å…¶è¿‡æ»¤æ¡ä»¶æ·»åŠ åˆ° &lt;code class=&quot;inline&quot;&gt;LogicalApply&lt;/code&gt; çš„ join condition ä¸­ï¼Œç„¶åå°†è¯¥ &lt;code class=&quot;inline&quot;&gt;LogicalSelection&lt;/code&gt; ä» inner plan ä¸­åˆ é™¤ï¼Œå†é€’å½’åœ°å¯¹ inner plan æå‡ç®—å­ã€‚&lt;/p&gt;&lt;p&gt;ä»¥å¦‚ä¸‹æŸ¥è¯¢ä¸ºä¾‹ï¼š&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;select * from t1 where t1.a in (select t2.a from t2 where t2.b = t1.b);&lt;/code&gt;&lt;p&gt;å…¶ç”Ÿæˆçš„æœ€åˆæ‰§è¡Œè®¡åˆ’ç‰‡æ®µä¼šæ˜¯ï¼š&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-a5982ed5121da2abdc05167506e48e09_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;383&quot; data-rawheight=&quot;277&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-a5982ed5121da2abdc05167506e48e09&quot; data-watermark-src=&quot;v2-8a2d9d63bd08f8d908fd93ad370a140d&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;code class=&quot;inline&quot;&gt;LogicalSelection&lt;/code&gt; æå‡åä¼šå˜æˆå¦‚ä¸‹ç‰‡æ®µï¼š&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-62f3075f148145ff308de465a07ff53b_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;404&quot; data-rawheight=&quot;191&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-62f3075f148145ff308de465a07ff53b&quot; data-watermark-src=&quot;v2-62cff68b480f307f9001d16bba429797&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;åˆ°æ­¤ inner plan ä¸­ä¸å†åŒ…å«ç›¸å…³åˆ—ï¼Œäºæ˜¯ &lt;code class=&quot;inline&quot;&gt;LogicalApply&lt;/code&gt; ä¼šè¢«è½¬æ¢ä¸ºå¦‚ä¸‹ LogicalJoin ï¼š&lt;/p&gt;&lt;u&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-22d5560a1d5a1513063c1083de52c887_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;418&quot; data-rawheight=&quot;202&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-22d5560a1d5a1513063c1083de52c887&quot; data-watermark-src=&quot;v2-7bb00d9abf4fffa883e0ca832215cc93&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;/u&gt;&lt;p&gt;&lt;b&gt;2.inner plan çš„æ ¹èŠ‚ç‚¹æ˜¯&lt;code class=&quot;inline&quot;&gt;LogicalMaxOneRow&lt;/code&gt;&lt;/b&gt;&lt;br&gt;å³è¦æ±‚å­æŸ¥è¯¢æœ€å¤šè¾“å‡ºä¸€è¡Œè®°å½•ï¼Œæ¯”å¦‚è¿™ä¸ªä¾‹å­ï¼š&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;select *, (select t2.a from t2 where t2.pk = t1.a) from t1;&lt;/code&gt;&lt;p&gt;å› ä¸ºå­æŸ¥è¯¢å‡ºç°åœ¨æ•´ä¸ªæŸ¥è¯¢çš„æŠ•å½±é¡¹é‡Œï¼Œæ‰€ä»¥ &lt;code class=&quot;inline&quot;&gt;expressionRewriter&lt;/code&gt; åœ¨å¤„ç†å­æŸ¥è¯¢æ—¶ä¼šå¯¹å…¶ç”Ÿæˆçš„æ‰§è¡Œè®¡åˆ’åœ¨æ ¹èŠ‚ç‚¹ä¸ŠåŠ ä¸€ä¸ª &lt;code class=&quot;inline&quot;&gt;LogicalMaxOneRow&lt;/code&gt; é™åˆ¶æœ€å¤šäº§ç”Ÿä¸€è¡Œè®°å½•ï¼Œå¦‚æœåœ¨æ‰§è¡Œæ—¶å‘ç°ä¸‹å±‚è¾“å‡ºå¤šäºä¸€è¡Œè®°å½•ï¼Œåˆ™ä¼šæŠ¥é”™ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå­æŸ¥è¯¢çš„è¿‡æ»¤æ¡ä»¶æ˜¯ &lt;code class=&quot;inline&quot;&gt;t2&lt;/code&gt; è¡¨çš„ä¸»é”®ä¸Šçš„ç­‰å€¼æ¡ä»¶ï¼Œæ‰€ä»¥å­æŸ¥è¯¢è‚¯å®šæœ€å¤šåªä¼šè¾“å‡ºä¸€è¡Œè®°å½•ï¼Œè€Œè¿™ä¸ªä¿¡æ¯åœ¨â€œæ„å»ºèŠ‚ç‚¹å±æ€§â€è¿™ä¸€æ­¥æ—¶ä¼šè¢«å‘æ˜å‡ºæ¥å¹¶è®°å½•åœ¨ç®—å­èŠ‚ç‚¹çš„ &lt;code class=&quot;inline&quot;&gt;MaxOneRow&lt;/code&gt; å±æ€§ä¸­ï¼Œæ‰€ä»¥è¿™é‡Œçš„ &lt;code class=&quot;inline&quot;&gt;LogicalMaxOneRow&lt;/code&gt; èŠ‚ç‚¹å®é™…ä¸Šæ˜¯å†—ä½™çš„ï¼Œäºæ˜¯æˆ‘ä»¬å¯ä»¥å°†å…¶ä» inner plan ä¸­ç§»é™¤ï¼Œç„¶åå†é€’å½’åœ°å¯¹ inner plan åšç®—å­æå‡ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;3.inner plan çš„æ ¹èŠ‚ç‚¹æ˜¯&lt;code class=&quot;inline&quot;&gt;LogicalProjection&lt;/code&gt;&lt;/b&gt; &lt;/p&gt;&lt;p&gt;åˆ™é¦–å…ˆå°†è¿™ä¸ªæŠ•å½±ç®—å­ä» inner plan ä¸­ç§»é™¤ï¼Œå†æ ¹æ®&lt;code class=&quot;inline&quot;&gt;LogicalApply&lt;/code&gt;çš„è¿æ¥ç±»å‹åˆ¤æ–­æ˜¯å¦éœ€è¦åœ¨&lt;code class=&quot;inline&quot;&gt;LogicalApply&lt;/code&gt;ä¹‹ä¸Šå†åŠ ä¸Šä¸€ä¸ª&lt;code class=&quot;inline&quot;&gt;LogicalProjection&lt;/code&gt;ï¼Œå…·ä½“æ¥è¯´æ˜¯ï¼šå¯¹äºé semi-join è¿™ä¸€ç±»çš„è¿æ¥ï¼ˆåŒ…æ‹¬ inner join å’Œ left join ï¼‰ï¼Œinner plan çš„è¾“å‡ºåˆ—ä¼šä¿ç•™åœ¨&lt;code class=&quot;inline&quot;&gt;LogicalApply&lt;/code&gt;çš„ç»“æœä¸­ï¼Œæ‰€ä»¥è¿™ä¸ªæŠ•å½±æ“ä½œéœ€è¦ä¿ç•™ï¼Œåä¹‹åˆ™ä¸éœ€è¦ã€‚æœ€åï¼Œå†é€’å½’åœ°å¯¹åˆ é™¤æŠ•å½±åçš„ inner plan æå‡ä¸‹å±‚ç®—å­ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;4.inner plan çš„æ ¹èŠ‚ç‚¹æ˜¯&lt;code class=&quot;inline&quot;&gt;LogicalAggregation&lt;/code&gt;&lt;/b&gt; &lt;/p&gt;&lt;p&gt;&lt;b&gt;a.&lt;/b&gt;é¦–å…ˆæˆ‘ä»¬ä¼šæ£€æŸ¥è¿™ä¸ªèšåˆç®—å­æ˜¯å¦å¯ä»¥è¢«æå‡åˆ° &lt;code class=&quot;inline&quot;&gt;LogicalApply&lt;/code&gt; ä¹‹ä¸Šå†æ‰§è¡Œã€‚ä»¥å¦‚ä¸‹æŸ¥è¯¢ä¸ºä¾‹ï¼š&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;select *, (select sum(t2.b) from t2 where t2.a = t1.pk) from t1;&lt;/code&gt;&lt;p&gt;å…¶æœ€åˆç”Ÿæˆçš„æ‰§è¡Œè®¡åˆ’ç‰‡æ®µä¼šæ˜¯ï¼š&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-3a476443a3930e657a52023f7ec82983_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;427&quot; data-rawheight=&quot;414&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-3a476443a3930e657a52023f7ec82983&quot; data-watermark-src=&quot;v2-2f0771f0f6b99f56ef089d61c847b1e0&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;å°†èšåˆæå‡åˆ° &lt;code class=&quot;inline&quot;&gt;LogicalApply&lt;/code&gt; åçš„æ‰§è¡Œè®¡åˆ’ç‰‡æ®µä¼šæ˜¯ï¼š&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-bcbb359b6fc8771c984fe21351e599bc_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;385&quot; data-rawheight=&quot;331&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-bcbb359b6fc8771c984fe21351e599bc&quot; data-watermark-src=&quot;v2-bab6573026a3946820f9e4b66b465ead&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;å³å…ˆå¯¹ &lt;code class=&quot;inline&quot;&gt;t1&lt;/code&gt; å’Œ &lt;code class=&quot;inline&quot;&gt;t2&lt;/code&gt; åšè¿æ¥ï¼Œå†åœ¨è¿æ¥ç»“æœä¸ŠæŒ‰ç…§ &lt;code class=&quot;inline&quot;&gt;t1.pk&lt;/code&gt; åˆ†ç»„ååšèšåˆã€‚è¿™é‡Œæœ‰ä¸¤ä¸ªå…³é”®å˜åŒ–ï¼šç¬¬ä¸€æ˜¯ä¸ç®¡æå‡å‰ &lt;code class=&quot;inline&quot;&gt;LogicalApply&lt;/code&gt; çš„è¿æ¥ç±»å‹æ˜¯ inner join è¿˜æ˜¯ left join ï¼Œæå‡åå¿…é¡»è¢«æ”¹ä¸º left join ï¼›ç¬¬äºŒæ˜¯æå‡åçš„èšåˆæ–°å¢äº† &lt;code class=&quot;inline&quot;&gt;Group By&lt;/code&gt; çš„åˆ—ï¼Œå³è¦æŒ‰ç…§ outer plan ä¼ è¿› inner plan ä¸­çš„ç›¸å…³åˆ—åšåˆ†ç»„ã€‚è¿™ä¸¤ä¸ªå˜åŒ–èƒŒåçš„åŸå› éƒ½ä¼šåœ¨åé¢è¿›è¡Œé˜è¿°ã€‚å› ä¸ºæå‡å inner plan ä¸å†åŒ…å«ç›¸å…³åˆ—ï¼Œå»ç›¸å…³åæœ€ç»ˆç”Ÿæˆçš„æ‰§è¡Œè®¡åˆ’ç‰‡æ®µä¼šæ˜¯ï¼š&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-3af11844da7786a930af425723d7ec90_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;383&quot; data-rawheight=&quot;343&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-3af11844da7786a930af425723d7ec90&quot; data-watermark-src=&quot;v2-c2e2c8792666624bcfe5ae7b5c39813c&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;èšåˆæå‡æœ‰å¾ˆå¤šé™å®šæ¡ä»¶ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;code class=&quot;inline&quot;&gt;LogicalApply&lt;/code&gt; çš„è¿æ¥ç±»å‹å¿…é¡»æ˜¯ inner join æˆ–è€… left join ã€‚ &lt;code class=&quot;inline&quot;&gt;LogicalApply&lt;/code&gt; æ˜¯æ ¹æ®ç›¸å…³å­æŸ¥è¯¢ç”Ÿæˆçš„ï¼Œåªå¯èƒ½æœ‰ 3 ç±»è¿æ¥ç±»å‹ï¼Œé™¤äº† inner join å’Œ left join å¤–ï¼Œç¬¬ä¸‰ç±»æ˜¯ semi join ï¼ˆåŒ…æ‹¬ &lt;code class=&quot;inline&quot;&gt;SemiJoin&lt;/code&gt;ï¼Œ&lt;code class=&quot;inline&quot;&gt;LeftOuterSemiJoin&lt;/code&gt;ï¼Œ&lt;code class=&quot;inline&quot;&gt;AntiSemiJoin&lt;/code&gt;ï¼Œ&lt;code class=&quot;inline&quot;&gt;AntiLeftOuterSemiJoin&lt;/code&gt;ï¼‰ï¼Œå…·ä½“å¯ä»¥å‚è€ƒ &lt;code class=&quot;inline&quot;&gt;expression_rewriter.go&lt;/code&gt; ä¸­çš„ä»£ç ï¼Œé™äºç¯‡å¹…åœ¨è¿™é‡Œå°±ä¸å¯¹æ­¤åšå±•å¼€äº†ã€‚å¯¹äº semi join ç±»å‹çš„ &lt;code class=&quot;inline&quot;&gt;LogicalApply&lt;/code&gt; ï¼Œå› ä¸º inner plan çš„è¾“å‡ºåˆ—ä¸ä¼šå‡ºç°åœ¨è¿æ¥çš„ç»“æœä¸­ï¼Œæ‰€ä»¥å¾ˆå®¹æ˜“ç†è§£æˆ‘ä»¬æ— æ³•å°†èšåˆç®—å­æå‡åˆ° &lt;code class=&quot;inline&quot;&gt;LogicalApply&lt;/code&gt; ä¹‹ä¸Šã€‚&lt;/li&gt;&lt;li&gt;&lt;code class=&quot;inline&quot;&gt;LogicalApply&lt;/code&gt; æœ¬èº«ä¸èƒ½åŒ…å« join condition ã€‚ä»¥ä¸Šé¢ç»™å‡ºçš„æŸ¥è¯¢ä¸ºä¾‹ï¼Œå¯ä»¥çœ‹åˆ°èšåˆæå‡åä¼šå°†å­æŸ¥è¯¢ä¸­åŒ…å«ç›¸å…³åˆ—çš„è¿‡æ»¤æ¡ä»¶ (&lt;code class=&quot;inline&quot;&gt;t2.a = t1.pk&lt;/code&gt;) æ·»åŠ åˆ° &lt;code class=&quot;inline&quot;&gt;LogicalApply&lt;/code&gt; çš„ join condition ä¸­ï¼Œå¦‚æœ &lt;code class=&quot;inline&quot;&gt;LogicalApply&lt;/code&gt; æœ¬èº«å­˜åœ¨ join condition ï¼Œé‚£ä¹ˆèšåˆæå‡åèšåˆç®—å­çš„è¾“å…¥ï¼ˆè¿æ¥ç®—å­çš„è¾“å‡ºï¼‰å°±ä¼šå’Œåœ¨å­æŸ¥è¯¢ä¸­æ—¶èšåˆç®—å­çš„è¾“å…¥ä¸åŒï¼Œå¯¼è‡´èšåˆç®—å­ç»“æœä¸æ­£ç¡®ã€‚&lt;/li&gt;&lt;li&gt;å­æŸ¥è¯¢ä¸­ç”¨åˆ°çš„ç›¸å…³åˆ—åœ¨ outer plan è¾“å‡ºé‡Œå…·æœ‰å”¯ä¸€æ€§å±æ€§ã€‚ä»¥ä¸Šé¢æŸ¥è¯¢ä¸ºä¾‹ï¼Œå¦‚æœ &lt;code class=&quot;inline&quot;&gt;t1.pk&lt;/code&gt; ä¸æ»¡è¶³å”¯ä¸€æ€§ï¼Œå‡è®¾ &lt;code class=&quot;inline&quot;&gt;t1&lt;/code&gt; æœ‰ä¸¤æ¡è®°å½•æ»¡è¶³ &lt;code class=&quot;inline&quot;&gt;t1.pk = 1&lt;/code&gt;ï¼Œ&lt;code class=&quot;inline&quot;&gt;t2&lt;/code&gt; åªæœ‰ä¸€æ¡è®°å½• &lt;code class=&quot;inline&quot;&gt;{ (t2.a: 1, t2.b: 2) }&lt;/code&gt; ï¼Œé‚£ä¹ˆè¯¥æŸ¥è¯¢ä¼šè¾“å‡ºä¸¤è¡Œç»“æœ &lt;code class=&quot;inline&quot;&gt;{ (sum(t2.b): 2), (sum(t2.b): 2) }&lt;/code&gt; ï¼›ä½†å¯¹äºèšåˆæå‡åçš„æ‰§è¡Œè®¡åˆ’ï¼Œåˆ™ä¼šç”Ÿæˆé”™è¯¯çš„ä¸€è¡Œç»“æœ&lt;code class=&quot;inline&quot;&gt;{ (sum(t2.b): 4) }&lt;/code&gt;ã€‚å½“ &lt;code class=&quot;inline&quot;&gt;t1.pk&lt;/code&gt; æ»¡è¶³å”¯ä¸€æ€§åï¼Œæ¯ä¸€è¡Œ outer plan çš„è®°å½•éƒ½å¯¹åº”è¿æ¥ç»“æœä¸­çš„ä¸€ä¸ªåˆ†ç»„ï¼Œæ‰€ä»¥å…¶èšåˆç»“æœä¼šå’Œåœ¨å­æŸ¥è¯¢ä¸­çš„èšåˆç»“æœä¸€è‡´ï¼Œè¿™ä¹Ÿè§£é‡Šäº†ä¸ºä»€ä¹ˆèšåˆæå‡åéœ€è¦æŒ‰ç…§ &lt;code class=&quot;inline&quot;&gt;t1.pk&lt;/code&gt; åšåˆ†ç»„ã€‚&lt;/li&gt;&lt;li&gt;èšåˆå‡½æ•°å¿…é¡»æ»¡è¶³å½“è¾“å…¥ä¸º &lt;code class=&quot;inline&quot;&gt;null&lt;/code&gt; æ—¶è¾“å‡ºç»“æœä¹Ÿä¸€å®šæ˜¯ &lt;code class=&quot;inline&quot;&gt;null&lt;/code&gt; ã€‚è¿™æ˜¯ä¸ºäº†åœ¨å­æŸ¥è¯¢ä¸­æ²¡æœ‰åŒ¹é…çš„ç‰¹æ®Šæƒ…å†µä¸‹ä¿è¯ç»“æœçš„æ­£ç¡®æ€§ï¼Œä»¥ä¸Šé¢æŸ¥è¯¢ä¸ºä¾‹ï¼Œå½“ &lt;code class=&quot;inline&quot;&gt;t2&lt;/code&gt; è¡¨æ²¡æœ‰ä»»ä½•è®°å½•æ»¡è¶³ &lt;code class=&quot;inline&quot;&gt;t2.a = t1.pk&lt;/code&gt; æ—¶ï¼Œå­æŸ¥è¯¢ä¸­ä¸ç®¡æ˜¯ä»€ä¹ˆèšåˆå‡½æ•°éƒ½ä¼šè¿”å› &lt;code class=&quot;inline&quot;&gt;null&lt;/code&gt; ç»“æœï¼Œä¸ºäº†ä¿ç•™è¿™ç§ç‰¹æ®Šæƒ…å†µï¼Œåœ¨èšåˆæå‡çš„åŒæ—¶ï¼Œ &lt;code class=&quot;inline&quot;&gt;LogicalApply&lt;/code&gt; çš„è¿æ¥ç±»å‹ä¼šè¢«å¼ºåˆ¶æ”¹ä¸º left joinï¼ˆæ”¹ä¹‹å‰å¯èƒ½æ˜¯ inner join ï¼‰ï¼Œæ‰€ä»¥åœ¨è¿™ç§æ²¡æœ‰åŒ¹é…çš„æƒ…å†µä¸‹ï¼Œ&lt;code class=&quot;inline&quot;&gt;LogicalApply&lt;/code&gt; è¾“å‡ºç»“æœä¸­ inner plan éƒ¨åˆ†ä¼šæ˜¯ &lt;code class=&quot;inline&quot;&gt;null&lt;/code&gt; ï¼Œè€Œè¿™ä¸ª &lt;code class=&quot;inline&quot;&gt;null&lt;/code&gt; ä¼šä½œä¸ºæ–°æ·»åŠ çš„èšåˆç®—å­çš„è¾“å…¥ï¼Œä¸ºäº†å’Œæå‡å‰ç»“æœä¸€è‡´ï¼Œå…¶ç»“æœä¹Ÿå¿…é¡»æ˜¯ &lt;code class=&quot;inline&quot;&gt;null&lt;/code&gt; ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;b.&lt;/b&gt;å¯¹äºæ ¹æ®ä¸Šè¿°æ¡ä»¶åˆ¤å®šä¸èƒ½æå‡çš„èšåˆç®—å­ï¼Œæˆ‘ä»¬å†æ£€æŸ¥è¿™ä¸ªèšåˆç®—å­çš„å­èŠ‚ç‚¹æ˜¯å¦ä¸º &lt;code class=&quot;inline&quot;&gt;LogicalSelection&lt;/code&gt; ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™å°†å…¶ä» inner plan ä¸­ç§»é™¤å¹¶å°†è¿‡æ»¤æ¡ä»¶æ·»åŠ åˆ° &lt;code class=&quot;inline&quot;&gt;LogicalApply&lt;/code&gt; çš„ join condition ä¸­ã€‚è¿™ç§æƒ…å†µä¸‹ &lt;code class=&quot;inline&quot;&gt;LogicalAggregation&lt;/code&gt; ä¾ç„¶ä¼šè¢«ä¿ç•™åœ¨ inner plan ä¸­ï¼Œä½†ä¼šå°† &lt;code class=&quot;inline&quot;&gt;LogicalSelection&lt;/code&gt; è¿‡æ»¤æ¡ä»¶ä¸­æ¶‰åŠçš„ inner è¡¨çš„åˆ—æ·»åŠ åˆ°èšåˆç®—å­çš„ &lt;code class=&quot;inline&quot;&gt;Group By&lt;/code&gt;ä¸­ã€‚æ¯”å¦‚å¯¹äºæŸ¥è¯¢ï¼š&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;select *, (select count(*) from t2 where t2.a = t1.a) from t1;&lt;/code&gt;&lt;p&gt;å…¶ç”Ÿæˆçš„æœ€åˆçš„æ‰§è¡Œè®¡åˆ’ç‰‡æ®µä¼šæ˜¯ï¼š&lt;/p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-7036cbfd4a1bd928df9b68a82ae2c39d_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;404&quot; data-rawheight=&quot;402&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-7036cbfd4a1bd928df9b68a82ae2c39d&quot; data-watermark-src=&quot;v2-1436664d60cbe58ed392024ac79a0d9d&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;å› ä¸ºèšåˆå‡½æ•°æ˜¯ &lt;code class=&quot;inline&quot;&gt;count(*)&lt;/code&gt; ï¼Œä¸æ»¡è¶³å½“è¾“å…¥ä¸º &lt;code class=&quot;inline&quot;&gt;null&lt;/code&gt; æ—¶è¾“å‡ºä¹Ÿä¸º &lt;code class=&quot;inline&quot;&gt;null&lt;/code&gt; çš„æ¡ä»¶ï¼Œæ‰€ä»¥å®ƒä¸èƒ½è¢«æå‡åˆ° &lt;code class=&quot;inline&quot;&gt;LogicalApply&lt;/code&gt; ä¹‹ä¸Šï¼Œä½†å®ƒå¯ä»¥è¢«æ”¹å†™æˆï¼š&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-fff11f20b805a30654aa08f8351c1c3e_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;429&quot; data-rawheight=&quot;306&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-fff11f20b805a30654aa08f8351c1c3e&quot; data-watermark-src=&quot;v2-59380836f03d5ed5d926d7465b523973&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;æ³¨æ„ &lt;code class=&quot;inline&quot;&gt;LogicalAggregation&lt;/code&gt; çš„ &lt;code class=&quot;inline&quot;&gt;Group By&lt;/code&gt; æ–°åŠ äº† &lt;code class=&quot;inline&quot;&gt;t2.a&lt;/code&gt; ï¼Œè¿™ä¸€æ­¥å°†åŸæœ¬çš„å…ˆåšè¿‡æ»¤å†åšèšåˆè½¬æ¢ä¸ºäº†å…ˆæŒ‰ç…§ &lt;code class=&quot;inline&quot;&gt;t2.a&lt;/code&gt; åˆ†ç»„åšèšåˆï¼Œå†å°†èšåˆç»“æœä¸ &lt;code class=&quot;inline&quot;&gt;t1&lt;/code&gt; åšè¿æ¥ã€‚ &lt;code class=&quot;inline&quot;&gt;LogicalSelection&lt;/code&gt; æå‡å inner plan å·²ç»ä¸å†ä¾èµ– outer plan çš„ç»“æœäº†ï¼Œæ•´ä¸ªæŸ¥è¯¢å»ç›¸å…³åå°†ä¼šå˜ä¸ºï¼š&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-eca50e9e7bf56e429defc6cf6a266a4c_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;449&quot; data-rawheight=&quot;325&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-eca50e9e7bf56e429defc6cf6a266a4c&quot; data-watermark-src=&quot;v2-0d186aabdcfc7d5ecfb758a6cb92d7d3&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;h2&gt;&lt;b&gt;æ€»ç»“&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;è¿™æ˜¯åŸºäºè§„åˆ™ä¼˜åŒ–çš„ç¬¬äºŒç¯‡æ–‡ç« ï¼Œåç»­æˆ‘ä»¬è¿˜å°†ä»‹ç»æ›´å¤šé€»è¾‘ä¼˜åŒ–è§„åˆ™ï¼šèšåˆä¸‹æ¨ï¼ŒTopN ä¸‹æ¨å’Œ Join Reorder ã€‚&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;æ›´å¤š TiDB æºç é˜…è¯»ç³»åˆ—æ–‡ç« ï¼š&lt;/p&gt;&lt;a href=&quot;https://www.pingcap.com/blog-cn/#%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;v2-60ab5bd867c2434d70c957a02a2169e1&quot; data-image-width=&quot;1200&quot; data-image-height=&quot;1200&quot; data-image-size=&quot;ipico&quot;&gt;åšå®¢&lt;/a&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>ZoeyZhai</author>
<guid isPermaLink="false">2018-12-11-52138596</guid>
<pubDate>Tue, 11 Dec 2018 00:00:00 +0800</pubDate>
</item>
<item>
<title>TiDB åœ¨é‡åŒ–æ´¾é£æ§ç³»ç»Ÿä¸­çš„åº”ç”¨</title>
<link>https://henix.github.io/feeds/zhuanlan.newsql/2018-12-10-52046270.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/52046270&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-9ee0165e5af868a1f8bcd156e502cad0_r.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;blockquote&gt;&lt;b&gt;ä½œè€…ä»‹ç»&lt;/b&gt;&lt;br&gt;&lt;b&gt;æœ±åŠ²æ¾&lt;/b&gt;ï¼Œé‡åŒ–æ´¾ç ”å‘ä¸­å¿ƒç³»ç»Ÿæ¶æ„å¸ˆï¼Œä¸»è¦å‚ä¸äº†åŸºç¡€ç»„ä»¶å¼€å‘ã€API Gateway ç­‰é¡¹ç›®ï¼Œç°åœ¨è‡´åŠ›äºå…¬å¸é£æ§ç³»ç»Ÿç›¸å…³ä¸šåŠ¡çš„æ¶æ„è®¾è®¡å’Œç ”å‘ã€‚&lt;/blockquote&gt;&lt;h2&gt;&lt;b&gt;å…¬å¸ç®€ä»‹&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;é‡åŒ–æ´¾ï¼ˆQuantGroupï¼‰åˆ›åŠäº 2014 å¹´ï¼Œæ˜¯æ•°æ®é©±åŠ¨çš„ç§‘æŠ€å…¬å¸ï¼Œæ˜¯å›½å®¶é«˜æ–°æŠ€æœ¯ä¼ä¸šã€‚é‡åŒ–æ´¾ä»¥ã€ŒMOVE THE WORLD WITH DATA, ENLIGHTEN LIFE WITH AIã€ï¼ˆæ•°æ®é©±åŠ¨ä¸–ç•Œï¼Œæ™ºèƒ½ç‚¹äº®ç”Ÿæ´»ï¼‰ä¸ºæ„¿æ™¯ï¼Œåˆ©ç”¨äººå·¥æ™ºèƒ½ã€æœºå™¨å­¦ä¹ ã€å¤§æ•°æ®æŠ€æœ¯ã€‚ä¸ºé‡‘èã€ç”µå•†ã€æ—…æ¸¸ã€å‡ºè¡Œã€æ±½è½¦ä¾›åº”é“¾ç­‰å¤šä¸ªé¢†åŸŸçš„åˆä½œä¼™ä¼´æä¾›å®šåˆ¶åŒ–çš„ç­–ç•¥å’Œæ¨¡å‹ï¼Œå¸®åŠ©æå‡è¡Œä¸šæ•ˆç‡ã€‚é‡åŒ–æ´¾å·²ä¸å›½å†…å¤–è¶…è¿‡ 300 å®¶æœºæ„å’Œå…¬å¸è¾¾æˆæ·±åº¦åˆä½œï¼Œè‡´åŠ›äºæ‰“é€ æ›´åŠ æœ‰æ´»åŠ›çš„å…±èµ¢ç”Ÿæ€ï¼Œæ¨åŠ¨ç»æµçš„å¯æŒç»­å‘å±•ã€‚&lt;/p&gt;&lt;p&gt;æˆ‘å¸ä» 2017 å¹´å¹´ä¸­å¼€å§‹è°ƒç ” TiDBï¼Œå¹¶åœ¨ç”¨æˆ·è¡Œä¸ºæ•°æ®åˆ†æç³»ç»Ÿä¸­æ­å»º TiDB é›†ç¾¤è¿›è¡Œæ•°æ®å­˜å‚¨ï¼Œç»è¿‡ä¸€å¹´å¤šçš„åº”ç”¨å’Œç ”ç©¶ï¼Œç§¯ç´¯äº†ä¸°å¯Œçš„ç»éªŒã€‚åŒæ—¶ï¼ŒTiDB å®˜æ–¹æ¨å‡º 2.0 GA ç‰ˆæœ¬ï¼ŒTiDB æ„ˆå‘æˆç†Ÿï¼Œç¨³å®šæ€§å’ŒæŸ¥è¯¢æ•ˆç‡ç­‰æ–¹é¢éƒ½æœ‰å¾ˆå¤§æå‡ã€‚æˆ‘ä»¬äº 2018 å¹´ 7 æœˆéƒ¨ç½² TiDB 2.0.5 ç‰ˆæœ¬ï¼Œå°è¯•å°†å…¶åº”ç”¨äºé£æ§ä¸šåŠ¡ä¸­ã€‚é£æ§ç³»ç»Ÿä¸»è¦æ˜¯åœ¨ç”¨æˆ·ç”³è¯·æ”¾æ¬¾æ—¶ï¼Œæ ¹æ®é£æ§è§„åˆ™ç»“åˆæ¨¡å‹å’Œç”¨æˆ·ç‰¹å¾è¿›è¡Œå®æ—¶è®¡ç®—å¹¶è¿”å›æ”¾æ¬¾ç»“æœã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;ä¸šåŠ¡èƒŒæ™¯&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;é£æ§ç³»ç»Ÿä¸­ç”¨åˆ°çš„æ•°æ®ä¸»è¦å¯ä»¥åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;ä¸€ç±»æ˜¯åŸå§‹æ•°æ®ï¼Œç”¨äºåˆ†æç”¨æˆ·å½“å‰çš„ç‰¹å¾æŒ‡æ ‡ã€‚&lt;/li&gt;&lt;li&gt;ä¸€ç±»æ˜¯å¿«ç…§æ•°æ®ï¼Œç”¨äºè®¡ç®—å†å²æŒ‡å®šæ—¶é—´ç‚¹çš„ç‰¹å¾æŒ‡æ ‡ï¼Œä¾›æ¨¡å‹è®­ç»ƒä½¿ç”¨ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;åŸå§‹æ•°æ®ä¸»è¦åˆ†ä¸ºä¸‰ç§ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;äº§ç”Ÿè‡ªå…¬å¸å†…å„ä¸ªäº§å“çº¿çš„ä¸šåŠ¡ç³»ç»Ÿæ•°æ®&lt;/li&gt;&lt;li&gt;çˆ¬è™«ç»„æä¾›çš„ç”¨æˆ·è”ç³»äººã€è¿è¥å•†ã€æ¶ˆè´¹è®°å½•ç­‰æ•°æ®&lt;/li&gt;&lt;li&gt;ç»è¿‡å¤„ç†åçš„ç”¨æˆ·ç‰¹å¾æ•°æ®&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;ç”±äºæˆ‘ä»¬çš„é£æ§ç­–ç•¥ä¸­ç”¨åˆ°äº†å¤§é‡çš„æ¨¡å‹ï¼ŒåŒ…æ‹¬ç¥ç»ç½‘ç»œæ¨¡å‹ï¼Œè¯„åˆ†æ¨¡å‹ç­‰ï¼Œè¿™äº›æ¨¡å‹çš„è®­ç»ƒéœ€è¦ä¾é å¤§é‡çš„å†å²è®¢å•ä»¥åŠç›¸å…³çš„ç”¨æˆ·ç‰¹å¾ï¼Œä¸ºäº†è®­ç»ƒå‡ºæ›´å¤šç²¾å‡†ã€ä¼˜ç§€çš„æ¨¡å‹ï¼Œå°±éœ€è¦æ›´å¤šç»´åº¦çš„ç‰¹å¾ï¼Œæ­¤æ—¶ç‰¹å¾çš„å‡†ç¡®æ€§å°±ç›´æ¥å½±å“äº†æ¨¡å‹çš„è®­ç»ƒç»“æœï¼Œä¸ºæ­¤æˆ‘ä»¬åœ¨å›æº¯æ¯ä¸€ä¸ªè®¢å•çš„ç”¨æˆ·åœ¨æŒ‡å®šæ—¶é—´çš„ç‰¹å¾è¡¨ç°æ—¶ï¼Œå°±éœ€è¦ç”¨åˆ°æ•°æ®å¿«ç…§ã€‚&lt;/p&gt;&lt;p&gt;æˆ‘ä»¬å¯ä»¥é€šè¿‡æ‹‰é“¾è¡¨çš„æ–¹å¼æ¥å®ç°æ•°æ®å¿«ç…§åŠŸèƒ½ï¼Œç®€å•è¯´å°±æ˜¯åœ¨æ¯å¼ è¡¨ä¸­å¢åŠ ä¸‰ä¸ªå­—æ®µï¼Œåˆ†åˆ«æ˜¯ new_idã€start_timeã€end_timeï¼Œæ¯ä¸€æ¬¡è®°å½•çš„æ›´æ–°éƒ½ä¼šäº§ç”Ÿä¸€æ¡æ–°çš„æ•°æ®ï¼ŒåŒæ—¶å˜æ›´åŸæœ‰è®°å½•çš„ end_timeï¼Œä»¥è®°å½•æ•°æ®çš„å˜æ›´å†å²ã€‚&lt;/p&gt;&lt;p&gt;é€šè¿‡ä¸Šé¢çš„ä»‹ç»å¯ä»¥çœ‹åˆ°ï¼Œä¸šåŠ¡æ•°æ®å’Œçˆ¬è™«æ•°æ®æœ¬èº«æ•°æ®é‡å°±å¾ˆå¤§ï¼Œå†åŠ ä¸Šéœ€è¦äº§ç”Ÿå¯¹åº”çš„æ‹‰é“¾æ•°æ®ï¼Œæ•°æ®é‡æ›´æ˜¯æˆå€å¢é•¿ã€‚å‡è®¾æ¯æ¡æ•°æ®è‡ªåˆ›å»ºåä»…å˜æ›´ä¸€æ¬¡ï¼Œé‚£æ‹‰é“¾è¡¨çš„æ•°æ®é‡å°±å·²ç»æ˜¯åŸå§‹è¡¨çš„ä¸¤å€äº†ï¼Œè€Œå®é™…ç”Ÿäº§ç¯å¢ƒä¸‹æ•°æ®çš„å˜æ›´è¿œä¸æ­¢ä¸€æ¬¡ã€‚&lt;/p&gt;&lt;p&gt;é€šè¿‡ä¸Šè¿°çš„ä»‹ç»ï¼Œæˆ‘ä»¬æ€»ç»“é£æ§ç³»ç»Ÿä¸‹çš„æ•°æ®å­˜å‚¨éœ€æ±‚åº”æ»¡è¶³ä»¥ä¸‹å‡ ç‚¹ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;ä¸šåŠ¡æ•°æ®&lt;/li&gt;&lt;li&gt;ä¸šåŠ¡æ•°æ®æ‹‰é“¾è¡¨&lt;/li&gt;&lt;li&gt;çˆ¬è™«æ•°æ®ï¼Œå¦‚è”ç³»äººä¿¡æ¯ã€è¿è¥å•†æ•°æ®ï¼Œæ¶ˆè´¹è®°å½•ç­‰&lt;/li&gt;&lt;li&gt;çˆ¬è™«æ•°æ®æ‹‰é“¾è¡¨&lt;/li&gt;&lt;li&gt;å…¶ä»–æ•°æ®ï¼Œå¦‚é¢„å¤„ç†æ•°æ®ç­‰&lt;/li&gt;&lt;/ul&gt;&lt;h2&gt;&lt;b&gt;å½“å‰æ–¹æ¡ˆ&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;ä»¥å‰æ–¹æ¡ˆä¸»è¦æ˜¯é‡‡ç”¨ HBase è¿›è¡Œæ•°æ®å­˜å‚¨ã€‚å®ƒçš„æ°´å¹³æ‰©å±•å¾ˆå¥½çš„è§£å†³äº†æ•°æ®é‡å¤§çš„é—®é¢˜ã€‚ä½†æ˜¯åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œä¹Ÿå­˜åœ¨ç€æ¯”è¾ƒæ˜æ˜¾çš„é—®é¢˜ï¼Œæœ€æ˜æ˜¾çš„å°±æ˜¯æŸ¥è¯¢çš„ API åŠŸèƒ½æ€§è¾ƒå¼±ï¼Œåªèƒ½é€šè¿‡ Key æ¥è·å–å•æ¡æ•°æ®ï¼Œæˆ–æ˜¯é€šè¿‡ Scan API æ¥æ‰¹é‡è¯»å–ï¼Œè¿™æ— ç–‘åœ¨ç‰¹å¾å›æº¯æ—¶å¢åŠ äº†é¢å¤–çš„å¼€å‘æˆæœ¬ï¼Œæ— æ³•å®ç°ä»£ç å¤ç”¨ã€‚&lt;/p&gt;&lt;p&gt;åœ¨å®æ—¶è®¡ç®—åœºæ™¯ä¸­ï¼Œä¸ºäº†é™ä½å¼€å‘æˆæœ¬ï¼Œå¯¹äºä¸šåŠ¡æ•°æ®çš„è·å–åˆ™æ˜¯é€šè¿‡è®¿é—®çº¿ä¸Šç³»ç»Ÿçš„ MySQL ä»åº“æ¥è¿›è¡ŒæŸ¥è¯¢ï¼›çˆ¬è™«æ•°æ®ç”±äºç»Ÿä¸€å­˜æ”¾åœ¨ HBase ä¸­ï¼Œè®¡ç®—æ—¶éœ€è¦å°†ç”¨åˆ°çš„æ•°æ®å…¨é‡æ‹‰å–åœ¨å†…å­˜ä¸­å†è¿›è¡Œè®¡ç®—ã€‚&lt;/p&gt;&lt;p&gt;åœ¨å›æº¯åœºæ™¯ä¸­ï¼Œé’ˆå¯¹ä¸šåŠ¡ç‰¹å¾å›æº¯ï¼Œé€šè¿‡æŸ¥è¯¢è®¢å•æ—¶é—´ä¹‹å‰çš„æ•°æ®è¿›è¡Œç‰¹å¾è®¡ç®—ï¼Œè¿™ç§æ–¹å¼å¯¹äºå·²ç»å˜æ›´çš„æ•°æ®æ˜¯æ— èƒ½ä¸ºåŠ›çš„ï¼Œåªèƒ½é€šè¿‡ HBase é‡Œçš„æ•°æ®å¿«ç…§æ¥å®ç°ï¼Œä½†æ— å½¢å¢åŠ äº†å¾ˆå¤šçš„å¼€å‘å·¥ä½œã€‚&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;TiDB ä¸ºæˆ‘ä»¬æ‰“å¼€ä¸€ç‰‡æ–°è§†é‡&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;é€šè¿‡ä¸Šé¢çš„ä»‹ç»ï¼Œæˆ‘ä»¬çŸ¥é“è¦æ„å»ºä¸€ä¸ªé£æ§ç³»ç»Ÿçš„å®æ—¶æ•°ä»“ç¯å¢ƒï¼Œéœ€è¦æ»¡è¶³ä¸‹é¢å‡ ä¸ªç‰¹æ€§ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;é«˜å¯ç”¨ï¼Œæä¾›å¥å£®ã€ç¨³å®šçš„æœåŠ¡ã€‚&lt;/li&gt;&lt;li&gt;æ”¯æŒæ°´å¹³å¼¹æ€§æ‰©å±•ï¼Œæ»¡è¶³æ—¥ç›Šå¢é•¿çš„æ•°æ®éœ€æ±‚ã€‚&lt;/li&gt;&lt;li&gt;æ€§èƒ½å¥½ï¼Œæ”¯æŒé«˜å¹¶å‘ã€‚&lt;/li&gt;&lt;li&gt;å“åº”å¿«ã€‚&lt;/li&gt;&lt;li&gt;æ”¯æŒæ ‡å‡† SQLï¼Œæœ€å¥½æ˜¯ MySQL è¯­æ³•å’Œ MySQL åè®®ï¼Œé¿å…å›æº¯æ—¶çš„é¢å¤–å¼€å‘ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;å¯ä»¥å‘ç°ï¼ŒTiDB å®Œç¾å¥‘åˆæˆ‘ä»¬çš„æ¯ä¸ªéœ€æ±‚ã€‚ç»è¿‡ TiDB åœ¨ç”¨æˆ·è¡Œä¸ºæ•°æ®åˆ†æç³»ç»Ÿä¸­çš„é•¿æœŸä½¿ç”¨ï¼Œæˆ‘ä»¬å·²ç»ç§¯ç´¯äº†ä¸€å®šçš„ç»éªŒï¼Œåœ¨æ­¤è¿‡ç¨‹ä¸­ TiDB å®˜æ–¹ä¹Ÿç»™äºˆäº†é•¿æœŸçš„æŠ€æœ¯æ”¯æŒï¼Œé‡åˆ°çš„é—®é¢˜åœ¨æ²Ÿé€šæ—¶ä¹Ÿèƒ½å¤ŸåŠæ—¶çš„åé¦ˆï¼Œè€Œä¸”è¿˜ä¸æˆ‘å¸æŠ€æœ¯äººå‘˜è¿›è¡Œè¿‡å¤šæ¬¡æŠ€æœ¯äº¤æµåŠçº¿ä¸‹åˆ†äº«ï¼Œåœ¨æ­¤æˆ‘ä»¬æ·±è¡¨æ„Ÿè°¢ã€‚ä¼´éšç€é£æ§ç³»ç»Ÿéœ€æ±‚çš„æŒç»­å¢é•¿ï¼Œæˆ‘ä»¬å¯¹æ•´ä½“æ¶æ„è¿›è¡Œäº†æ–°ä¸€è½®çš„ä¼˜åŒ–ï¼Œæ–°çš„æ•°æ®æ¥å…¥åŠå­˜å‚¨æ¶æ„å¦‚å›¾ 1ã€‚&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-a717388d8270181928386125b5163963_r.jpg&quot; data-caption=&quot;å›¾ 1  ä¼˜åŒ–åçš„æ¶æ„å›¾&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1004&quot; data-rawheight=&quot;545&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-a717388d8270181928386125b5163963&quot; data-watermark-src=&quot;v2-8e925539beecb0d3c99975e92584a69b&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;é€šè¿‡å›¾ 1 å¯ä»¥çœ‹åˆ°ï¼Œçº¿ä¸Šä¸šåŠ¡ç³»ç»Ÿäº§ç”Ÿçš„æ•°æ®ç»Ÿä¸€å­˜æ”¾åœ¨ MySQL ä¸­ï¼Œå°†è¿™äº›å­¤ç«‹çš„æ•°æ®å½’é›†åœ¨ TiDB ä¸­ï¼Œèƒ½å¤Ÿæä¾›åŸºäº SQL çš„æŸ¥è¯¢æœåŠ¡ã€‚é€šè¿‡ binlog çš„æ–¹å¼ç›´æ¥ä» MySQL å®ä¾‹è¿›è¡Œæ¥å…¥ï¼Œæ¥å…¥åçš„æ•°æ®ä»¥ä¸¤ç§ä¸åŒçš„å½¢å¼åˆ†åˆ«å­˜æ”¾ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;ä¸€ç§æ˜¯å»åˆ†åº“åˆ†è¡¨åçš„æºæ•°æ®ï¼Œé™ä½äº†å®æ—¶ç‰¹å¾è®¡ç®—çš„å®ç°åŠç»´æŠ¤æˆæœ¬ã€‚&lt;/li&gt;&lt;li&gt;å¦ä¸€ç§æ˜¯ä»¥æ‹‰é“¾æ•°æ®å½¢å¼å­˜å‚¨å®ç°æ•°æ®å¿«ç…§åŠŸèƒ½ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;ç»è¿‡è°ƒç ”ï¼Œé’ˆå¯¹ç¬¬ä¸€ç§åœºæ™¯ï¼Œå¯ä»¥é€šè¿‡é˜¿é‡Œçš„ otter æˆ–è€… TiDB å‘¨è¾¹å·¥å…· Syncer æ¥å¿«é€Ÿå®ç°ï¼Œä½†å¯¹äºç¬¬äºŒä¸ªéœ€æ±‚éƒ½æ²¡æœ‰ç°æˆçš„æˆç†Ÿè§£å†³æ–¹æ¡ˆã€‚æœ€ç»ˆï¼Œæˆ‘ä»¬åŸºäºé˜¿é‡Œçš„ canal è¿›è¡Œå®¢æˆ·ç«¯çš„å®šåˆ¶åŒ–å¼€å‘ï¼Œåˆ†åˆ«æŒ‰ç…§ä¸åŒçš„éœ€æ±‚æ‹¼è£…åˆå¹¶ SQL å¹¶å†™å…¥åˆ°ä¸åŒçš„ TiDB é›†ç¾¤ä¸­ï¼›åŒæ—¶è¿˜å¯ä»¥æŒ‰éœ€å°†éƒ¨åˆ†è¡¨çš„æ•°æ®è¿›è¡Œç»„è£…å¹¶å‘é€è‡³ Kafkaï¼Œç”¨äºå‡†å®æ—¶åˆ†æåœºæ™¯ã€‚&lt;/p&gt;&lt;p&gt;å¯¹äºæ¥è‡ªçˆ¬è™«ç»„çš„æ•°æ®ï¼Œæˆ‘ä»¬é‡‡ç”¨ç›´æ¥æ¶ˆè´¹ Kafka çš„æ–¹å¼ç»„è£… SQL å†™å…¥åˆ° TiDB å³å¯ã€‚&lt;/p&gt;&lt;p&gt;åœ¨å®é™…æ˜¯ä½¿ç”¨ä¸­ï¼Œé€šè¿‡ç´¢å¼•ç­‰ä¼˜åŒ–ï¼ŒTiDB å®Œå…¨å¯ä»¥æ”¯æŒçº¿ä¸Šå®æ—¶æŸ¥è¯¢çš„ä¸šåŠ¡éœ€æ±‚ï¼›åœ¨ç‰¹å¾å›æº¯æ—¶åªéœ€è¦é€šè¿‡å¢åŠ æŸ¥è¯¢æ¡ä»¶å°±å¯ä»¥è·å¾—æŒ‡å®šæ—¶é—´çš„ç‰¹å¾ç»“æœï¼Œå¤§å¤§é™ä½äº†å¼€å‘æˆæœ¬ã€‚&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;é‡åˆ°çš„é—®é¢˜&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;é£æ§ä¸šåŠ¡ä¸­ç”¨æˆ·ç‰¹å¾æå–çš„ SQL ç›¸å¯¹éƒ½æ¯”è¾ƒå¤æ‚ï¼Œåœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œå­˜åœ¨éƒ¨åˆ† SQL æ‰§è¡Œæ—¶é—´æ¯”åœ¨ MySQL ä¸­è€—æ—¶é«˜ã€‚é€šè¿‡ explain æˆ‘ä»¬å‘ç°ï¼Œä»–å¹¶æ²¡æœ‰ä½¿ç”¨æˆ‘ä»¬åˆ›å»ºçš„ç´¢å¼•ï¼Œè€Œæ˜¯è¿›è¡Œäº†å…¨è¡¨æ‰«æï¼Œåœ¨è¿›ä¸€æ­¥åˆ†æåè¿˜å‘ç° explain çš„ç»“æœæ˜¯ä¸ç¡®å®šçš„ã€‚&lt;/p&gt;&lt;p&gt;ç»è¿‡ä¸ TiDB å®˜æ–¹æŠ€æœ¯äººå‘˜çš„æ²Ÿé€šï¼Œæˆ‘ä»¬è¿›è¡Œäº†åˆ é™¤ç±»ä¼¼ç´¢å¼•ã€analyze table ç­‰æ“ä½œï¼Œå‘ç°é—®é¢˜ä»ç„¶å­˜åœ¨ã€‚é€šè¿‡å›¾ 2 å¯ä»¥çœ‹åˆ°å®Œå…¨ç›¸åŒçš„ SQL è¯­å¥ï¼Œå…¶æ‰§è¡Œç»“æœçš„å·®å¼‚æ€§ã€‚æœ€åæŒ‰å®˜æ–¹å»ºè®®ï¼Œæˆ‘ä»¬é‡‡ç”¨æ·»åŠ  use index çš„æ–¹å¼ä½¿å…¶å¼ºåˆ¶èµ°ç´¢å¼•ï¼Œæ‰§è¡Œæ—¶é—´ç”± 4 åˆ†é’Ÿå˜æˆäº† &amp;lt; 1sï¼Œæš‚æ—¶è§£å†³äº†ä¸šåŠ¡ä¸Šçš„éœ€æ±‚ã€‚&lt;/p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-b456777e7bdb0d4610a70c40aab191d8_r.jpg&quot; data-caption=&quot;å›¾ 2  explain ç¤ºæ„å›¾&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1004&quot; data-rawheight=&quot;408&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-b456777e7bdb0d4610a70c40aab191d8&quot; data-watermark-src=&quot;v2-7a247e9dec4e04853609cf215ab3dcc1&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;åŒæ—¶ TiDB æŠ€æœ¯äººå‘˜ä¹Ÿæ”¶é›†ç›¸å…³ä¿¡æ¯åé¦ˆç»™äº†ç ”å‘äººå‘˜ã€‚åœ¨æ•´ä¸ªé—®é¢˜çš„å¤„ç†è¿‡ç¨‹ä¸­ï¼ŒTiDB çš„æŠ€æœ¯äººå‘˜ç»™äºˆäº†é«˜åº¦çš„é…åˆå’ŒåŠæ—¶çš„åé¦ˆï¼ŒåŒæ—¶ä¹Ÿè¡¨ç°å‡ºäº†å¾ˆå¼ºçš„ä¸“ä¸šæ€§ï¼Œå¤§å¤§å‡å°‘äº†é—®é¢˜æ’æŸ¥çš„æ—¶é—´ï¼Œæˆ‘ä»¬éå¸¸æ„Ÿè°¢ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;å±•æœ›&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;ç›®å‰æˆ‘ä»¬å·²ç»æ­å»ºä¸¤ä¸ª TiDB é›†ç¾¤ï¼Œå‡ åä¸ªç‰©ç†èŠ‚ç‚¹ï¼Œç™¾äº¿çº§ç‰¹å¾æ•°æ®ï¼Œå—ç›Šäº TiDB çš„é«˜å¯ç”¨æ„æ¶ï¼Œä¸Šçº¿ä»¥æ¥ä¸€ç›´ç¨³å®šè¿è¡Œã€‚&lt;/b&gt;&lt;/p&gt;&lt;p&gt;å¦‚ä¸Šï¼ŒTiDB åœ¨æˆ‘ä»¬é£æ§ä¸šåŠ¡ä¸­çš„åº”ç”¨æ‰åªæ˜¯å¼€å§‹ï¼Œéƒ¨åˆ†ä¸šåŠ¡çš„è¿ç§»è¿˜æœ‰å¾…è¿›ä¸€æ­¥éªŒè¯ï¼Œä½†æ˜¯ TiDB ç»™æˆ‘ä»¬å¸¦æ¥çš„å¥½å¤„ä¸è¨€è€Œå–»ï¼Œä¸ºæˆ‘ä»¬åœ¨æ•°æ®å­˜å‚¨å’Œæ•°æ®åˆ†æä¸Šæ‰“å¼€äº†ä¸€ç‰‡æ–°è§†é‡ã€‚åç»­æˆ‘ä»¬ä¼šç»§ç»­åŠ å¤§å¯¹ TiDB çš„æŠ•å…¥ï¼Œä½¿å…¶æ›´å¥½åœ°æœåŠ¡äºåœ¨çº¿åˆ†æå’Œç¦»çº¿åˆ†æç­‰å„ä¸ªåœºæ™¯ã€‚æˆ‘ä»¬ä¹Ÿå¸Œæœ›è¿›ä¸€æ­¥å¢åŠ ä¸ PingCAP å›¢é˜Ÿçš„äº¤æµä¸åˆä½œï¼Œè¿›è¡Œæ›´æ·±å…¥çš„åº”ç”¨å’Œç ”ç©¶ï¼Œä¸º TiDB çš„å‘å±•è´¡çŒ®ä¸€ä»½åŠ›é‡ã€‚&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;i&gt;æ›´å¤š TiDB ç”¨æˆ·å®è·µï¼š&lt;/i&gt;&lt;/p&gt;&lt;a href=&quot;https://www.pingcap.com/cases-cn/&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;v2-60ab5bd867c2434d70c957a02a2169e1&quot; data-image-width=&quot;1200&quot; data-image-height=&quot;1200&quot; data-image-size=&quot;ipico&quot;&gt;æ¡ˆä¾‹&lt;/a&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>ZoeyZhai</author>
<guid isPermaLink="false">2018-12-10-52046270</guid>
<pubDate>Mon, 10 Dec 2018 00:00:00 +0800</pubDate>
</item>
<item>
<title>TiDB EcoSystem Tools åŸç†è§£è¯»ï¼ˆä¸€ï¼‰ï¼šTiDB-Binlog æ¶æ„æ¼”è¿›ä¸å®ç°åŸç†</title>
<link>https://henix.github.io/feeds/zhuanlan.newsql/2018-12-10-51990591.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/51990591&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-f70e162f6471c2085dcc5b1d71405c89_r.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;ç®€ä»‹&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;TiDB-Binlog ç»„ä»¶ç”¨äºæ”¶é›† TiDB çš„ binlogï¼Œå¹¶æä¾›å®æ—¶å¤‡ä»½å’ŒåŒæ­¥åŠŸèƒ½ã€‚è¯¥ç»„ä»¶åœ¨åŠŸèƒ½ä¸Šç±»ä¼¼äº MySQL çš„ä¸»ä»å¤åˆ¶ï¼ŒMySQL çš„ä¸»ä»å¤åˆ¶ä¾èµ–äºè®°å½•çš„ binlog æ–‡ä»¶ï¼ŒTiDB-Binlog ç»„ä»¶ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œä¸»è¦çš„ä¸åŒç‚¹æ˜¯ TiDB æ˜¯åˆ†å¸ƒå¼çš„ï¼Œå› æ­¤éœ€è¦æ”¶é›†å„ä¸ª TiDB å®ä¾‹äº§ç”Ÿçš„ binlogï¼Œå¹¶æŒ‰ç…§äº‹åŠ¡æäº¤çš„æ—¶é—´æ’åºåæ‰èƒ½åŒæ­¥åˆ°ä¸‹æ¸¸ã€‚å¦‚æœä½ éœ€è¦éƒ¨ç½² TiDB é›†ç¾¤çš„ä»åº“ï¼Œæˆ–è€…æƒ³è®¢é˜… TiDB æ•°æ®çš„å˜æ›´è¾“å‡ºåˆ°å…¶ä»–çš„ç³»ç»Ÿä¸­ï¼ŒTiDB-Binlog åˆ™æ˜¯å¿…ä¸å¯å°‘çš„å·¥å…·ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;æ¶æ„æ¼”è¿›&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;TiDB-Binlog è¿™ä¸ªç»„ä»¶å·²ç»å‘å¸ƒäº† 2 å¹´å¤šæ—¶é—´ï¼Œç»å†è¿‡å‡ æ¬¡æ¶æ„æ¼”è¿›ï¼Œå»å¹´åæœˆåˆ°ç°åœ¨å¤§è§„æ¨¡ä½¿ç”¨çš„æ˜¯ Kafka ç‰ˆæœ¬ï¼Œæ¶æ„å›¾å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-df721303b9040c503599496dcf52d16b_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;333&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-df721303b9040c503599496dcf52d16b&quot; data-watermark-src=&quot;v2-5119818836a0f90f06478a754c1d4d02&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;Kafka ç‰ˆæœ¬çš„ TiDB-Binlog ä¸»è¦åŒ…æ‹¬ä¸¤ä¸ªç»„ä»¶ï¼š&lt;/p&gt;&lt;p&gt;Pumpï¼šä¸€ä¸ªå®ˆæŠ¤è¿›ç¨‹ï¼Œåœ¨æ¯ä¸ª TiDB ä¸»æœºçš„åå°è¿è¡Œã€‚å…¶ä¸»è¦åŠŸèƒ½æ˜¯å®æ—¶è®°å½• TiDB äº§ç”Ÿçš„ binlog å¹¶é¡ºåºå†™å…¥ Kafka ä¸­ã€‚&lt;/p&gt;&lt;p&gt;Drainerï¼š ä» Kafka ä¸­æ”¶é›† binlogï¼Œå¹¶æŒ‰ç…§ TiDB ä¸­äº‹åŠ¡çš„æäº¤é¡ºåºè½¬åŒ–ä¸ºæŒ‡å®šæ•°æ®åº“å…¼å®¹çš„ SQL è¯­å¥æˆ–è€…æŒ‡å®šæ ¼å¼çš„æ•°æ®ï¼Œæœ€ååŒæ­¥åˆ°ç›®çš„æ•°æ®åº“æˆ–è€…å†™åˆ°é¡ºåºæ–‡ä»¶ã€‚&lt;/p&gt;&lt;p&gt;è¿™ä¸ªæ¶æ„çš„å·¥ä½œåŸç†ä¸ºï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;TiDB éœ€è¦ä¸ Pump ç»‘å®šï¼Œå³ TiDB å®ä¾‹åªèƒ½å°†å®ƒç”Ÿæˆçš„ binlog å‘é€åˆ°ä¸€ä¸ªæŒ‡å®šçš„ Pump ä¸­ï¼›&lt;/li&gt;&lt;li&gt;Pump å°† binlog å…ˆå†™åˆ°æœ¬åœ°æ–‡ä»¶ï¼Œå†å¼‚æ­¥åœ°å†™å…¥åˆ° Kafkaï¼›&lt;/li&gt;&lt;li&gt;Drainer ä» Kafka ä¸­è¯»å‡º binlogï¼Œå¯¹ binlog è¿›è¡Œæ’åºï¼Œå¯¹ binlog è§£æåç”Ÿæˆ SQL æˆ–æŒ‡å®šæ ¼å¼çš„æ•°æ®å†åŒæ­¥åˆ°ä¸‹æ¸¸ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;æ ¹æ®ç”¨æˆ·çš„åé¦ˆï¼Œä»¥åŠæˆ‘ä»¬è‡ªå·±åšçš„ä¸€äº›æµ‹è¯•ï¼Œå‘ç°è¯¥ç‰ˆæœ¬ä¸»è¦å­˜åœ¨ä¸€äº›é—®é¢˜ã€‚&lt;/p&gt;&lt;p&gt;é¦–å…ˆï¼ŒTiDB çš„è´Ÿè½½å¯èƒ½ä¸å‡è¡¡ï¼Œéƒ¨åˆ† TiDB ä¸šåŠ¡è¾ƒå¤šï¼Œäº§ç”Ÿçš„ binlog ä¹Ÿæ¯”è¾ƒå¤šï¼Œå¯¹åº”çš„ Pump çš„è´Ÿè½½é«˜ï¼Œå¯¼è‡´æ•°æ®åŒæ­¥å»¶è¿Ÿé«˜ã€‚&lt;/p&gt;&lt;p&gt;å…¶æ¬¡ï¼Œä¾èµ– Kafka é›†ç¾¤ï¼Œå¢åŠ äº†è¿ç»´æˆæœ¬ï¼›è€Œä¸” TiDB äº§ç”Ÿçš„å•æ¡ binlog çš„å¤§å°å¯è¾¾ 2Gï¼ˆä¾‹å¦‚æ‰¹é‡åˆ é™¤æ•°æ®ã€æ‰¹é‡å†™å…¥æ•°æ®ï¼‰ï¼Œéœ€è¦é…ç½® Kafka çš„æ¶ˆæ¯å¤§å°ç›¸å…³è®¾ç½®ï¼Œè€Œ Kafka å¹¶ä¸å¤ªé€‚åˆå•æ¡æ•°æ®è¾ƒå¤§çš„åœºæ™¯ã€‚&lt;/p&gt;&lt;p&gt;æœ€åï¼ŒDrainer éœ€è¦è¯»å– Kafka ä¸­çš„ binlogã€å¯¹ binlog è¿›è¡Œæ’åºã€è§£æ binlogï¼ŒåŒæ­¥æ•°æ®åˆ°ä¸‹æ¸¸ç­‰å·¥ä½œï¼Œå¯ä»¥çœ‹å‡º Drainer çš„å·¥ä½œè¾ƒå¤šï¼Œè€Œä¸” Drainer æ˜¯ä¸€ä¸ªå•ç‚¹ï¼Œæ‰€ä»¥å¾€å¾€åŒæ­¥æ•°æ®çš„ç“¶é¢ˆéƒ½åœ¨ Drainerã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;ä»¥ä¸Šè¿™äº›é—®é¢˜æˆ‘ä»¬å¾ˆéš¾åœ¨å·²æœ‰çš„æ¡†æ¶ä¸‹è¿›è¡Œä¼˜åŒ–ï¼Œå› æ­¤æˆ‘ä»¬å¯¹ TiDB-Binlog è¿›è¡Œäº†é‡æ„ï¼Œæœ€æ–°ç‰ˆæœ¬çš„ TiDB-Binlog çš„æ€»ä½“æ¶æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-6e5e2bb0245f985f9f7f3b53b2f605c9_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;391&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-6e5e2bb0245f985f9f7f3b53b2f605c9&quot; data-watermark-src=&quot;v2-742a86727627f4e4ec5e5e9f68583501&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;æ–°ç‰ˆæœ¬ TiDB-Binlog ä¸å†ä½¿ç”¨ Kafka å­˜å‚¨ binlogï¼Œä»ç„¶ä¿ç•™äº† Pump å’Œ Drainer ä¸¤ä¸ªç»„ä»¶ï¼Œä½†æ˜¯å¯¹åŠŸèƒ½è¿›è¡Œäº†è°ƒæ•´ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Pump ç”¨äºå®æ—¶è®°å½• TiDB äº§ç”Ÿçš„ binlogï¼Œå¹¶å°† binlog æŒ‰ç…§äº‹åŠ¡çš„æäº¤æ—¶é—´è¿›è¡Œæ’åºï¼Œå†æä¾›ç»™ Drainer è¿›è¡Œæ¶ˆè´¹ã€‚&lt;/li&gt;&lt;li&gt;Drainer ä»å„ä¸ª Pump ä¸­æ”¶é›† binlog è¿›è¡Œå½’å¹¶ï¼Œå†å°† binlog è½¬åŒ–æˆ SQL æˆ–è€…æŒ‡å®šæ ¼å¼çš„æ•°æ®ï¼Œæœ€ç»ˆåŒæ­¥åˆ°ä¸‹æ¸¸ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;è¯¥ç‰ˆæœ¬çš„ä¸»è¦ä¼˜ç‚¹ä¸ºï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;å¤šä¸ª Pump å½¢æˆä¸€ä¸ªé›†ç¾¤ï¼Œå¯ä»¥æ°´å¹³æ‰©å®¹ï¼Œå„ä¸ª Pump å¯ä»¥å‡åŒ€åœ°æ‰¿æ‹…ä¸šåŠ¡çš„å‹åŠ›ã€‚&lt;/li&gt;&lt;li&gt;TiDB é€šè¿‡å†…ç½®çš„ Pump Client å°† binlog åˆ†å‘åˆ°å„ä¸ª Pumpï¼Œå³ä½¿æœ‰éƒ¨åˆ† Pump å‡ºç°æ•…éšœä¹Ÿä¸å½±å“ TiDB çš„ä¸šåŠ¡ã€‚&lt;/li&gt;&lt;li&gt;Pump å†…éƒ¨å®ç°äº†ç®€å•çš„ kv æ¥å­˜å‚¨ binlogï¼Œæ–¹ä¾¿å¯¹ binlog æ•°æ®çš„ç®¡ç†ã€‚&lt;/li&gt;&lt;li&gt;åŸæ¥ Drainer çš„ binlog æ’åºé€»è¾‘ç§»åˆ°äº† Pump æ¥åšï¼Œè€Œ Pump æ˜¯å¯æ‰©å±•çš„ï¼Œè¿™æ ·å°±èƒ½æé«˜æ•´ä½“çš„åŒæ­¥æ€§èƒ½ã€‚&lt;/li&gt;&lt;li&gt;Drainer ä¸å†éœ€è¦åƒåŸæ¥ä¸€æ ·è¯»å–ä¸€æ‰¹ binlog åˆ°å†…å­˜é‡Œè¿›è¡Œå †æ’åºï¼Œåªéœ€è¦ä¾æ¬¡è¯»å–å„ä¸ª Pump çš„ binlog è¿›è¡Œå½’å¹¶æ’åºï¼Œè¿™æ ·å¯ä»¥å¤§å¤§èŠ‚çœå†…å­˜çš„ä½¿ç”¨ï¼ŒåŒæ—¶ä¹Ÿæ›´å®¹æ˜“åšå†…å­˜æ§åˆ¶ã€‚&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;ç”±äºè¯¥ç‰ˆæœ¬æœ€å¤§çš„ç‰¹ç‚¹æ˜¯å¤šä¸ª Pump ç»„æˆäº†ä¸€ä¸ªé›†ç¾¤ï¼ˆclusterï¼‰ï¼Œå› æ­¤è¯¥ç‰ˆæœ¬å‘½åä¸º cluster ç‰ˆæœ¬ã€‚ä¸‹é¢æˆ‘ä»¬ä»¥æœ€æ–°çš„ cluster ç‰ˆæœ¬çš„æ¶æ„æ¥ä»‹ç» TiDB-Binlog çš„å®ç°åŸç†ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;å·¥ä½œåŸç†&lt;/b&gt;&lt;/h2&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;binlog&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;é¦–å…ˆæˆ‘ä»¬å…ˆä»‹ç»ä¸€ä¸‹ TiDB ä¸­çš„ binlogï¼ŒTiDB çš„äº‹åŠ¡é‡‡ç”¨ 2pc ç®—æ³•ï¼Œä¸€ä¸ªæˆåŠŸçš„äº‹åŠ¡ä¼šå†™ä¸¤æ¡ binlogï¼ŒåŒ…æ‹¬ä¸€æ¡ Prewrite binlog å’Œ ä¸€æ¡ Commit binlogï¼›å¦‚æœäº‹åŠ¡å¤±è´¥ï¼Œä¼šå‘ä¸€æ¡ Rollback binlogã€‚&lt;/p&gt;&lt;p&gt;binlog çš„ç»“æ„å®šä¹‰ä¸ºï¼š&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;// Binlog è®°å½•äº‹åŠ¡ä¸­æ‰€æœ‰çš„å˜æ›´ï¼Œå¯ä»¥ç”¨ Binlog æ„å»º SQL
message Binlog {
    // Binlog çš„ç±»å‹ï¼ŒåŒ…æ‹¬ Prewriteã€Commitã€Rollback ç­‰
    optional BinlogType  tp = 1 [(gogoproto.nullable) = false];
    
    // Prewrite, Commit å’Œ Rollback ç±»å‹çš„ binlog çš„ start_tsï¼Œè®°å½•äº‹åŠ¡å¼€å§‹çš„ ts
    optional int64  start_ts = 2 [(gogoproto.nullable) = false];
    
    // commit_ts è®°å½•äº‹åŠ¡ç»“æŸçš„ tsï¼Œåªè®°å½•åœ¨ commit ç±»å‹çš„ binlog ä¸­
    optional int64  commit_ts = 3 [(gogoproto.nullable) = false];
    
    // prewrite key åªè®°å½•åœ¨ Prewrite ç±»å‹çš„ binlog ä¸­ï¼Œ
    // æ˜¯ä¸€ä¸ªäº‹åŠ¡çš„ä¸»é”®ï¼Œç”¨äºæŸ¥è¯¢è¯¥äº‹åŠ¡æ˜¯å¦æäº¤
    optional bytes  prewrite_key = 4;
    
    // prewrite_value è®°å½•åœ¨ Prewrite ç±»å‹çš„ binlog ä¸­ï¼Œç”¨äºè®°å½•æ¯ä¸€è¡Œæ•°æ®çš„æ”¹å˜
    optional bytes  prewrite_value = 5;
    
    // ddl_query è®°å½• ddl è¯­å¥
    optional bytes  ddl_query = 6;
    
    // ddl_job_id è®°å½• ddl çš„ job id
    optional int64  ddl_job_id  = 7 [(gogoproto.nullable) = false];
}&lt;/code&gt;&lt;p&gt;binlog åŠç›¸å…³çš„æ•°æ®ç»“æ„å®šä¹‰è§:&lt;a href=&quot;https://github.com/WangXiangUSTC/tipb/blob/master/proto/binlog/binlog.proto&quot;&gt;binlog.proto&lt;/a&gt;&lt;/p&gt;&lt;p&gt;å…¶ä¸­ &lt;code class=&quot;inline&quot;&gt;start_ts&lt;/code&gt; ä¸ºäº‹åŠ¡å¼€å§‹æ—¶çš„ tsï¼Œ&lt;code class=&quot;inline&quot;&gt;commit_ts&lt;/code&gt; ä¸ºäº‹åŠ¡æäº¤çš„ tsã€‚ts æ˜¯ç”±ç‰©ç†æ—¶é—´å’Œé€»è¾‘æ—¶é—´è½¬åŒ–è€Œæˆçš„ï¼Œåœ¨ TiDB ä¸­æ˜¯å”¯ä¸€çš„ï¼Œç”± PD æ¥ç»Ÿä¸€æä¾›ã€‚åœ¨å¼€å§‹ä¸€ä¸ªäº‹åŠ¡æ—¶ï¼ŒTiDB ä¼šè¯·æ±‚ PDï¼Œè·å–ä¸€ä¸ª ts ä½œä¸ºäº‹åŠ¡çš„ &lt;code class=&quot;inline&quot;&gt;start_ts&lt;/code&gt;ï¼Œåœ¨äº‹åŠ¡æäº¤æ—¶åˆ™å†æ¬¡è¯·æ±‚ PD è·å–ä¸€ä¸ª ts ä½œä¸º &lt;code class=&quot;inline&quot;&gt;commit_ts&lt;/code&gt;ã€‚ æˆ‘ä»¬åœ¨ Pump å’Œ Drainer ä¸­å°±æ˜¯æ ¹æ® binlog çš„ &lt;code class=&quot;inline&quot;&gt;commit_ts&lt;/code&gt; æ¥å¯¹ binlog è¿›è¡Œæ’åºçš„ã€‚&lt;/p&gt;&lt;p&gt;TiDB çš„ binlog è®°å½•ä¸º row æ¨¡å¼ï¼Œå³ä¿å­˜æ¯ä¸€è¡Œæ•°æ®çš„æ”¹å˜ã€‚æ•°æ®çš„å˜åŒ–è®°å½•åœ¨  &lt;code class=&quot;inline&quot;&gt;prewrite_value&lt;/code&gt; å­—æ®µä¸­ï¼Œè¯¥å­—æ®µçš„æ•°æ®ä¸»è¦ç”±åºåˆ—åŒ–åçš„ TableMutation ç»“æ„çš„æ•°æ®ç»„æˆã€‚TableMutation çš„ç»“æ„å¦‚ä¸‹æ‰€ç¤ºï¼š&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;// TableMutation å­˜å‚¨è¡¨ä¸­æ•°æ®çš„å˜åŒ–
message TableMutation {
    // è¡¨çš„ idï¼Œå”¯ä¸€æ ‡è¯†ä¸€ä¸ªè¡¨
    optional int64 table_id = 1 [(gogoproto.nullable) = false];
    
    // ä¿å­˜æ’å…¥çš„æ¯è¡Œæ•°æ®
    repeated bytes inserted_rows = 2;
    
    // ä¿å­˜ä¿®æ”¹å‰å’Œä¿®æ”¹åçš„æ¯è¡Œçš„æ•°æ®
    repeated bytes updated_rows = 3;
    
    // å·²åºŸå¼ƒ
    repeated int64 deleted_ids = 4;
    
    // å·²åºŸå¼ƒ
    repeated bytes deleted_pks = 5;
    
    // åˆ é™¤è¡Œçš„æ•°æ®
    repeated bytes deleted_rows  = 6;
    
    // è®°å½•æ•°æ®å˜æ›´çš„é¡ºåº
    repeated MutationType sequence = 7;
}&lt;/code&gt;&lt;p&gt;ä¸‹é¢ä»¥ä¸€ä¸ªä¾‹å­æ¥è¯´æ˜ binlog ä¸­æ˜¯æ€ä¹ˆå­˜å‚¨æ•°æ®çš„å˜åŒ–çš„ã€‚&lt;/p&gt;&lt;p&gt;ä¾‹å¦‚ table çš„ç»“æ„ä¸ºï¼š&lt;/p&gt;&lt;p&gt;create table &lt;code class=&quot;inline&quot;&gt;test&lt;/code&gt; (&lt;code class=&quot;inline&quot;&gt;id&lt;/code&gt; int, &lt;code class=&quot;inline&quot;&gt;name&lt;/code&gt; varchar(24), primary key &lt;code class=&quot;inline&quot;&gt;id&lt;/code&gt;)&lt;/p&gt;&lt;p&gt;æŒ‰ç…§é¡ºåºæ‰§è¡Œå¦‚ä¸‹ SQLï¼š&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;begin;
insert into test(id, name) values(1, &quot;a&quot;);
insert into test(id, name) values(2, &quot;b&quot;);
update test set name = &quot;c&quot; where id = 1;
update test set name = &quot;d&quot; where id = 2;
delete from test where id = 2;
insert into test(id, name) values(2, &quot;c&quot;);
commit;&lt;/code&gt;&lt;p&gt;åˆ™ç”Ÿæˆçš„ TableMutation çš„æ•°æ®å¦‚ä¸‹æ‰€ç¤ºï¼š&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;inserted_rows:
1, &quot;a&quot;
2, &quot;b&quot;
2, &quot;c&quot;
 
updated_rows:
1, &quot;a&quot;, 1, &quot;c&quot;
2, &quot;b&quot;, 2, &quot;d&quot;
 
deleted_rows:
2, &quot;d&quot;
 
sequence:
Insert, Insert, Update, Update, DeleteRow, Insert&lt;/code&gt;&lt;p&gt;å¯ä»¥ä»ä¾‹å­ä¸­çœ‹å‡ºï¼Œsequence ä¸­ä¿å­˜çš„æ•°æ®å˜æ›´ç±»å‹çš„é¡ºåºä¸ºæ‰§è¡Œ SQL çš„é¡ºåºï¼Œå…·ä½“å˜æ›´çš„æ•°æ®å†…å®¹åˆ™ä¿å­˜åˆ°äº†ç›¸åº”çš„å˜é‡ä¸­ã€‚&lt;/p&gt;&lt;p&gt;Drainer åœ¨æŠŠ binlog æ•°æ®åŒæ­¥åˆ°ä¸‹æ¸¸å‰ï¼Œå°±éœ€è¦æŠŠä¸Šé¢çš„è¿™äº›æ•°æ®è¿˜åŸæˆ SQLï¼Œå†åŒæ­¥åˆ°ä¸‹æ¸¸ã€‚&lt;/p&gt;&lt;p&gt;å¦å¤–éœ€è¦è¯´æ˜çš„æ˜¯ï¼ŒTiDB åœ¨å†™ binlog æ—¶ï¼Œä¼šåŒæ—¶å‘ TiKV å‘èµ·å†™æ•°æ®è¯·æ±‚å’Œå‘ Pump å‘é€ Prewrite binlogï¼Œå¦‚æœ TiKV å’Œ Pump å…¶ä¸­ä¸€ä¸ªè¯·æ±‚å¤±è´¥ï¼Œåˆ™è¯¥äº‹åŠ¡å¤±è´¥ã€‚å½“ Prewrite æˆåŠŸåï¼ŒTiDB å‘ TiKV å‘èµ· Commit æ¶ˆæ¯ï¼Œå¹¶å¼‚æ­¥åœ°å‘ Pump å‘é€ä¸€æ¡ Commit binlogã€‚ç”±äº TiDB æ˜¯åŒæ—¶å‘ TiKV å’Œ Pump å‘é€è¯·æ±‚çš„ï¼Œæ‰€ä»¥åªè¦ä¿è¯ Pump å¤„ç† Prewrite binlog è¯·æ±‚çš„æ—¶é—´å°äºç­‰äº TiKV æ‰§è¡Œ Prewrite çš„æ—¶é—´ï¼Œå¼€å¯ binlog å°±ä¸ä¼šå¯¹äº‹åŠ¡çš„å»¶è¿Ÿé€ æˆå½±å“ã€‚&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;Pump Client&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;ä»ä¸Šé¢çš„ä»‹ç»ä¸­æˆ‘ä»¬çŸ¥é“ç”±å¤šä¸ª Pump ç»„æˆä¸€ä¸ªé›†ç¾¤ï¼Œå…±åŒæ‰¿æ‹…å†™ binlog çš„è¯·æ±‚ï¼Œé‚£ä¹ˆå°±éœ€è¦ä¿è¯ TiDB èƒ½å¤Ÿå°†å†™ binlog çš„è¯·æ±‚å°½å¯èƒ½å‡åŒ€åœ°åˆ†å‘åˆ°å„ä¸ª Pumpï¼Œå¹¶ä¸”éœ€è¦è¯†åˆ«ä¸å¯ç”¨çš„ Pumpï¼ŒåŠæ—¶è·å–åˆ°æ–°åŠ å…¥é›†ç¾¤ä¸­ Pump ä¿¡æ¯ã€‚è¿™éƒ¨åˆ†çš„å·¥ä½œæ˜¯åœ¨ Pump Client ä¸­å®ç°çš„ã€‚&lt;/p&gt;&lt;p&gt;Pump Client ä»¥åŒ…çš„å½¢å¼é›†æˆåœ¨ TiDB ä¸­ï¼Œä»£ç é“¾æ¥ï¼š&lt;a href=&quot;https://github.com/pingcap/tidb-tools/tree/v2.1.0/tidb-binlog/pump_client&quot;&gt;pump_client&lt;/a&gt;ã€‚&lt;/p&gt;&lt;p&gt;Pump Client ç»´æŠ¤ Pump é›†ç¾¤çš„ä¿¡æ¯ï¼ŒPump çš„ä¿¡æ¯ä¸»è¦æ¥è‡ªäº PD ä¸­ä¿å­˜çš„ Pump çš„çŠ¶æ€ä¿¡æ¯ï¼ŒçŠ¶æ€ä¿¡æ¯çš„å®šä¹‰å¦‚ä¸‹ï¼ˆä»£ç é“¾æ¥ï¼š&lt;a href=&quot;https://github.com/pingcap/tidb-tools/blob/v2.1.0/tidb-binlog/node/node.go&quot;&gt;Status&lt;/a&gt;ï¼‰ï¼š&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;type Status struct {
    // Pump/Drainer å®ä¾‹çš„å”¯ä¸€æ ‡è¯†
    NodeID string `json:&quot;nodeId&quot;`
    
    // Pump/Drainer çš„æœåŠ¡åœ°å€
    Addr string `json:&quot;host&quot;`
    
    // Pump/Drainer çš„çŠ¶æ€ï¼Œå€¼å¯ä»¥ä¸º onlineã€pausingã€pausedã€closingã€offline
    State string `json:&quot;state&quot;`
    
    // Pump/Drainer æ˜¯å¦ aliveï¼ˆç›®å‰æ²¡æœ‰ä½¿ç”¨è¯¥å­—æ®µï¼‰
    IsAlive bool `json:&quot;isAlive&quot;`
    
    // Pumpçš„åˆ†æ•°ï¼Œè¯¥åˆ†æ•°æ˜¯ç”±èŠ‚ç‚¹çš„è´Ÿè½½ã€ç£ç›˜ä½¿ç”¨ç‡ã€å­˜å‚¨çš„æ•°æ®é‡å¤§å°ç­‰å› ç´ è®¡ç®—å¾—æ¥çš„ï¼Œ
    // è¿™æ · Pump Client å¯ä»¥æ ¹æ®åˆ†æ•°æ¥é€‰å–åˆé€‚çš„ Pump å‘é€ binlogï¼ˆå¾…å®ç°ï¼‰
    Score int64 `json:&quot;score&quot;`
    
    // Pump çš„æ ‡ç­¾ï¼Œå¯ä»¥é€šè¿‡ label å¯¹ TiDB å’Œ Pump è¿›è¡Œåˆ†ç»„ï¼Œ
    // TiDB åªèƒ½å°† binlog å‘é€åˆ°ç›¸åŒ label çš„ Pumpï¼ˆå¾…å®ç°ï¼‰
    Label *Label `json:&quot;label&quot;`
    
    // Pumpï¼š ä¿å­˜çš„ binlog çš„æœ€å¤§çš„ commit_ts
    // Drainerï¼šå·²æ¶ˆè´¹çš„ binlog çš„æœ€å¤§çš„ commit_ts
    MaxCommitTS int64 `json:&quot;maxCommitTS&quot;`
    
    // è¯¥çŠ¶æ€ä¿¡æ¯çš„æ›´æ–°æ—¶é—´å¯¹åº”çš„ ts.
    UpdateTS int64 `json:&quot;updateTS&quot;`
}&lt;/code&gt;&lt;p&gt;Pump Client æ ¹æ® Pump ä¸ŠæŠ¥åˆ° PD çš„ä¿¡æ¯ä»¥åŠå†™ binlog è¯·æ±‚çš„å®é™…æƒ…å†µå°† Pump åˆ’åˆ†ä¸ºå¯ç”¨ Pump ä¸ä¸å¯ç”¨ Pump ä¸¤ä¸ªéƒ¨åˆ†ã€‚&lt;/p&gt;&lt;p&gt;åˆ’åˆ†çš„æ–¹æ³•åŒ…æ‹¬ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;åˆå§‹åŒ–æ—¶ä» PD ä¸­è·å–æ‰€æœ‰ Pump çš„ä¿¡æ¯ï¼Œå°†çŠ¶æ€ä¸º online çš„ Pump åŠ å…¥åˆ°å¯ç”¨ Pump åˆ—è¡¨ä¸­ï¼Œå…¶ä»– Pump åŠ å…¥åˆ°éå¯ç”¨åˆ—è¡¨ä¸­ã€‚&lt;/li&gt;&lt;li&gt;Pump æ¯éš”å›ºå®šçš„æ—¶é—´ä¼šå‘é€å¿ƒè·³åˆ° PDï¼Œå¹¶æ›´æ–°è‡ªå·±çš„çŠ¶æ€ã€‚Pump Client ç›‘æ§ PD ä¸­ Pump ä¸Šä¼ çš„çŠ¶æ€ä¿¡æ¯ï¼ŒåŠæ—¶æ›´æ–°å†…å­˜ä¸­ç»´æŠ¤çš„ Pump ä¿¡æ¯ï¼Œå¦‚æœçŠ¶æ€ç”±é online è½¬æ¢ä¸º online åˆ™å°†è¯¥ Pump åŠ å…¥åˆ°å¯ç”¨ Pump åˆ—è¡¨ï¼›åä¹‹åŠ å…¥åˆ°éå¯ç”¨åˆ—è¡¨ä¸­ã€‚&lt;/li&gt;&lt;li&gt;åœ¨å†™ binlog åˆ° Pump æ—¶ï¼Œå¦‚æœè¯¥ Pump åœ¨é‡è¯•å¤šæ¬¡åä»ç„¶å†™ binlog å¤±è´¥ï¼Œåˆ™æŠŠè¯¥ Pump åŠ å…¥åˆ°éå¯ç”¨ Pump åˆ—è¡¨ä¸­ã€‚&lt;/li&gt;&lt;li&gt;å®šæ—¶å‘é€æ¢æ´»è¯·æ±‚ï¼ˆæ•°æ®ä¸ºç©ºçš„ binlog å†™è¯·æ±‚ï¼‰åˆ°éå¯ç”¨ Pump åˆ—è¡¨ä¸­çš„çŠ¶æ€ä¸º online çš„ Pumpï¼Œå¦‚æœè¿”å›æˆåŠŸï¼Œåˆ™æŠŠè¯¥ Pump é‡æ–°åŠ å…¥åˆ°å¯ç”¨ Pump åˆ—è¡¨ä¸­ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;é€šè¿‡ä¸Šé¢çš„è¿™äº›æªæ–½ï¼ŒPump Client å°±å¯ä»¥åŠæ—¶åœ°æ›´æ–°æ‰€ç»´æŠ¤çš„ Pump é›†ç¾¤ä¿¡æ¯ï¼Œä¿è¯å°† binlog å‘é€åˆ°å¯ç”¨çš„ Pump ä¸­ã€‚&lt;/p&gt;&lt;p&gt;å¦å¤–ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œæ€ä¹ˆä¿è¯ Pump Client å¯ä»¥å°† binlog å†™è¯·æ±‚å‡åŒ€åœ°åˆ†å‘åˆ°å„ä¸ª Pumpï¼Ÿæˆ‘ä»¬ç›®å‰æä¾›äº†å‡ ç§è·¯ç”±ç­–ç•¥ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;rangeï¼š æŒ‰ç…§é¡ºåºä¾æ¬¡é€‰å– Pump å‘é€ binlogï¼Œå³ç¬¬ä¸€æ¬¡é€‰å–ç¬¬ä¸€ä¸ª Pumpï¼Œç¬¬äºŒæ¬¡é€‰å–ç¬¬äºŒä¸ª Pumpâ€¦&lt;/li&gt;&lt;li&gt;hashï¼šå¯¹ binlog çš„ &lt;code class=&quot;inline&quot;&gt;start_ts&lt;/code&gt; è¿›è¡Œ hashï¼Œç„¶åé€‰å– hash å€¼å¯¹åº”çš„ Pumpã€‚&lt;/li&gt;&lt;li&gt;scoreï¼šæ ¹æ® Pump ä¸ŠæŠ¥çš„åˆ†æ•°æŒ‰ç…§åŠ æƒå¹³å‡ç®—æ³•é€‰å– Pump å‘é€ binlogï¼ˆå¾…å®ç°ï¼‰ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;éœ€è¦æ³¨æ„çš„åœ°æ–¹æ˜¯ï¼Œä»¥ä¸Šçš„ç­–ç•¥åªæ˜¯é’ˆå¯¹ Prewrite binlogï¼Œå¯¹äº Commit binlogï¼ŒPump Client ä¼šå°†å®ƒå‘é€åˆ°å¯¹åº”çš„ Prewrite binlog æ‰€é€‰æ‹©çš„ Pumpï¼Œè¿™æ ·åšæ˜¯å› ä¸ºåœ¨ Pump ä¸­éœ€è¦å°†åŒ…å« Prewrite binlog å’Œ Commit binlog çš„å®Œæ•´ binlogï¼ˆå³æ‰§è¡ŒæˆåŠŸçš„äº‹åŠ¡çš„ binlogï¼‰æä¾›ç»™ Drainerï¼Œå°† Commit binlog å‘é€åˆ°å…¶ä»– Pump æ²¡æœ‰æ„ä¹‰ã€‚&lt;/p&gt;&lt;p&gt;Pump Client å‘ Pump æäº¤å†™ binlog çš„è¯·æ±‚æ¥å£ä¸º &lt;a href=&quot;https://github.com/WangXiangUSTC/tipb/blob/master/proto/binlog/pump.proto&quot;&gt;pump.proto&lt;/a&gt; ä¸­çš„ WriteBinlogï¼Œä½¿ç”¨ grpc å‘é€ binlog è¯·æ±‚ã€‚&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;Pump&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;Pump ä¸»è¦ç”¨æ¥æ‰¿æ‹… binlog çš„å†™è¯·æ±‚ï¼Œç»´æŠ¤ binlog æ•°æ®ï¼Œå¹¶å°†æœ‰åºçš„ binlog æä¾›ç»™ Drainerã€‚æˆ‘ä»¬å°† Pump æŠ½è±¡æˆäº†ä¸€ä¸ªç®€å•çš„ kv æ•°æ®åº“ï¼Œkey ä¸º binlog çš„ &lt;code class=&quot;inline&quot;&gt;start _ts&lt;/code&gt;ï¼ˆPriwrite binlogï¼‰ æˆ–è€… &lt;code class=&quot;inline&quot;&gt;commit_ts&lt;/code&gt;ï¼ˆCommit binlogï¼‰ï¼Œvalue ä¸º binlog çš„å…ƒæ•°æ®ï¼Œbinlog çš„æ•°æ®åˆ™å­˜åœ¨æ•°æ®æ–‡ä»¶ä¸­ã€‚Drainer åƒæŸ¥æ•°æ®åº“ä¸€æ ·çš„æ¥è·å–æ‰€éœ€è¦çš„ binlogã€‚&lt;/p&gt;&lt;p&gt;Pump å†…ç½®äº† leveldb ç”¨äºå­˜å‚¨ binlog çš„å…ƒä¿¡æ¯ã€‚åœ¨ Pump æ”¶åˆ° binlog çš„å†™è¯·æ±‚æ—¶ï¼Œä¼šé¦–å…ˆå°† binlog æ•°æ®ä»¥ append çš„å½¢å¼å†™åˆ°æ–‡ä»¶ä¸­ï¼Œç„¶åå°† binlog çš„ tsã€ç±»å‹ã€æ•°æ®é•¿åº¦ã€æ‰€ä¿å­˜çš„æ–‡ä»¶ä»¥åŠåœ¨æ–‡ä»¶ä¸­çš„ä½ç½®ä¿¡æ¯ä¿å­˜åœ¨ leveldb ä¸­ï¼Œå¦‚æœä¸º Prewrite binlogï¼Œåˆ™ä»¥ &lt;code class=&quot;inline&quot;&gt;start_ts&lt;/code&gt;ä½œä¸º keyï¼›å¦‚æœæ˜¯ Commit binlogï¼Œåˆ™ä»¥ &lt;code class=&quot;inline&quot;&gt;commit_ts&lt;/code&gt; ä½œä¸º keyã€‚&lt;/p&gt;&lt;p&gt;å½“ Drainer å‘ Pump è¯·æ±‚è·å–æŒ‡å®š ts ä¹‹åçš„ binlog æ—¶ï¼ŒPump åˆ™æŸ¥è¯¢ leveldb ä¸­å¤§äºè¯¥ ts çš„ binlog çš„å…ƒæ•°æ®ï¼Œå¦‚æœå½“å‰æ•°æ®ä¸º Prewrite binlogï¼Œåˆ™å¿…é¡»æ‰¾åˆ°å¯¹åº”çš„ Commit binlogï¼›å¦‚æœä¸º Commit binlog åˆ™ç»§ç»­å‘å‰æ¨è¿›ã€‚è¿™é‡Œæœ‰ä¸ªé—®é¢˜ï¼Œåœ¨ binlog ä¸€èŠ‚ä¸­æåˆ°ï¼Œå¦‚æœ TiKV æˆåŠŸå†™å…¥äº†æ•°æ®ï¼Œå¹¶ä¸” Pump æˆåŠŸæ¥æ”¶åˆ°äº† Prewrite binlogï¼Œåˆ™è¯¥äº‹åŠ¡å°±æäº¤æˆåŠŸäº†ï¼Œé‚£ä¹ˆå¦‚æœåœ¨ TiDB å‘é€ Commit binlog åˆ° Pump å‰å‘ç”Ÿäº†ä¸€äº›å¼‚å¸¸ï¼ˆä¾‹å¦‚ TiDB å¼‚å¸¸é€€å‡ºï¼Œæˆ–è€…å¼ºåˆ¶ç»ˆæ­¢äº† TiDB è¿›ç¨‹ï¼‰ï¼Œå¯¼è‡´ Pump æ²¡æœ‰æ¥æ”¶åˆ° Commit binlogï¼Œé‚£ä¹ˆ Pump ä¸­å°±ä¼šä¸€ç›´æ‰¾ä¸åˆ°æŸäº› Prewrite binlog å¯¹åº”çš„ Commit binlogã€‚è¿™é‡Œæˆ‘ä»¬åœ¨ Pump ä¸­åšäº†å¤„ç†ï¼Œå¦‚æœæŸä¸ª Prewrite binlog è¶…è¿‡äº†ååˆ†é’Ÿéƒ½æ²¡æœ‰æ‰¾åˆ°å¯¹åº”çš„ Commit binlogï¼Œåˆ™é€šè¿‡ binlog æ•°æ®ä¸­çš„ &lt;code class=&quot;inline&quot;&gt;prewrite_key&lt;/code&gt; å»æŸ¥è¯¢ TiKV è¯¥äº‹åŠ¡æ˜¯å¦æäº¤ï¼Œå¦‚æœå·²ç»æäº¤æˆåŠŸï¼Œåˆ™ TiKV ä¼šè¿”å›è¯¥äº‹åŠ¡çš„ &lt;code class=&quot;inline&quot;&gt;commit_ts&lt;/code&gt;ï¼›å¦åˆ™ Pump å°±ä¸¢å¼ƒè¯¥æ¡ Prewrite binlogã€‚&lt;/p&gt;&lt;p&gt;binlog å…ƒæ•°æ®ä¸­æä¾›äº†æ•°æ®å­˜å‚¨çš„æ–‡ä»¶å’Œä½ç½®ï¼Œå¯ä»¥é€šè¿‡è¿™äº›ä¿¡æ¯è¯»å– binlog æ–‡ä»¶çš„æŒ‡å®šä½ç½®è·å–åˆ°æ•°æ®ã€‚å› ä¸º binlog æ•°æ®åŸºæœ¬ä¸Šæ˜¯æŒ‰é¡ºåºå†™å…¥åˆ°æ–‡ä»¶ä¸­çš„ï¼Œå› æ­¤æˆ‘ä»¬åªéœ€è¦é¡ºåºåœ°è¯» binlog æ–‡ä»¶å³å¯ï¼Œè¿™æ ·å°±ä¿è¯äº†ä¸ä¼šå› ä¸ºé¢‘ç¹åœ°è¯»å–æ–‡ä»¶è€Œå½±å“ Pump çš„æ€§èƒ½ã€‚æœ€ç»ˆï¼ŒPump ä»¥ &lt;code class=&quot;inline&quot;&gt;commit_ts&lt;/code&gt; ä¸ºæ’åºæ ‡å‡†å°† binlog æ•°æ®ä¼ è¾“ç»™ Drainerã€‚Drainer å‘ Pump è¯·æ±‚ binlog æ•°æ®çš„æ¥å£ä¸º &lt;a href=&quot;https://github.com/WangXiangUSTC/tipb/blob/master/proto/binlog/pump.proto&quot;&gt;pump.proto&lt;/a&gt; ä¸­çš„ PullBinlogsï¼Œä»¥ grpc streaming çš„å½¢å¼ä¼ è¾“ binlog æ•°æ®ã€‚&lt;/p&gt;&lt;p&gt;å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒPump ä¸­æœ‰ä¸€ä¸ª fake binlog æœºåˆ¶ã€‚Pump ä¼šå®šæ—¶ï¼ˆé»˜è®¤ä¸‰ç§’ï¼‰å‘æœ¬åœ°å­˜å‚¨ä¸­å†™å…¥ä¸€æ¡æ•°æ®ä¸ºç©ºçš„ binlogï¼Œåœ¨ç”Ÿæˆè¯¥ binlog å‰ï¼Œä¼šå‘ PD ä¸­è·å–ä¸€ä¸ª tsï¼Œä½œä¸ºè¯¥ binlog çš„ &lt;code class=&quot;inline&quot;&gt;start_ts&lt;/code&gt; ä¸ &lt;code class=&quot;inline&quot;&gt;commit_ts&lt;/code&gt;ï¼Œè¿™ç§ binlog æˆ‘ä»¬å«ä½œ fake binlogã€‚è¿™æ ·åšçš„åŸå› åœ¨ Drainer ä¸­ä»‹ç»ã€‚&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;Drainer&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;Drainer ä»å„ä¸ª Pump ä¸­è·å– binlogï¼Œå½’å¹¶åæŒ‰ç…§é¡ºåºè§£æ binlogã€ç”Ÿæˆ SQL æˆ–è€…æŒ‡å®šæ ¼å¼çš„æ•°æ®ï¼Œç„¶åå†åŒæ­¥åˆ°ä¸‹æ¸¸ã€‚&lt;/p&gt;&lt;p&gt;æ—¢ç„¶è¦ä»å„ä¸ª Pump è·å–æ•°æ®ï¼ŒDrainer å°±éœ€è¦ç»´æŠ¤ Pump é›†ç¾¤çš„ä¿¡æ¯ï¼ŒåŠæ—¶è·å–åˆ°æ–°å¢åŠ çš„ Pumpï¼Œå¹¶è¯†åˆ«å‡ºä¸å¯ç”¨çš„ Pumpï¼Œè¿™éƒ¨åˆ†åŠŸèƒ½ä¸ Pump Client ç±»ä¼¼ï¼ŒDrainer ä¹Ÿæ˜¯é€šè¿‡ PD ä¸­å­˜å‚¨çš„ Pump çš„çŠ¶æ€ä¿¡æ¯æ¥ç»´æŠ¤ Pump ä¿¡æ¯ã€‚å¦å¤–éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœæ–°å¢åŠ äº†ä¸€ä¸ª Pumpï¼Œå¿…é¡»è®©è¯¥ Pump é€šçŸ¥ Drainer è‡ªå·±ä¸Šçº¿äº†ï¼Œè¿™ä¹ˆåšæ˜¯ä¸ºäº†ä¿è¯ä¸ä¼šä¸¢æ•°æ®ã€‚ä¾‹å¦‚ï¼š&lt;/p&gt;&lt;p&gt;é›†ç¾¤ä¸­å·²ç»å­˜åœ¨ Pump1 å’Œ Pump2ï¼ŒDrainer è¯»å– Pump1 å’Œ Pump2 çš„æ•°æ®å¹¶è¿›è¡Œå½’å¹¶ï¼š&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-3cd607d2bdbee944445902c45d40e64c_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;752&quot; data-rawheight=&quot;499&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-3cd607d2bdbee944445902c45d40e64c&quot; data-watermark-src=&quot;v2-1988b173b06ddd67d5b8a6367b3ba589&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Pump1 å­˜å‚¨çš„ binlog ä¸ºï½› 1ï¼Œ3ï¼Œ5ï¼Œ7ï¼Œ9 ï½ï¼ŒPump2 å­˜å‚¨çš„ binlog ä¸ºï½›2ï¼Œ4ï¼Œ6ï¼Œ10ï½ã€‚Drainer ä»ä¸¤ä¸ª Pump è·å– binlogï¼Œå‡è®¾å½“å‰å·²ç»è¯»å–åˆ°äº†ï½›1ï¼Œ2ï¼Œ3ï¼Œ4ï¼Œ5ï¼Œ6ï¼Œ7ï½è¿™äº› binlogï¼Œå·²å¤„ç†çš„ binlog çš„ä½ç½®ä¸º 7ã€‚æ­¤æ—¶ Pump3 åŠ å…¥é›†ç¾¤ï¼Œä» Pump3 ä¸ŠæŠ¥è‡ªå·±çš„ä¸Šçº¿ä¿¡æ¯åˆ° PDï¼Œåˆ° Drainer ä» PD ä¸­è·å–åˆ° Pump3 ä¿¡æ¯éœ€è¦ä¸€å®šçš„æ—¶é—´ï¼Œå¦‚æœ Pump3 æ²¡æœ‰é€šçŸ¥ Drainer å°±ç›´æ¥æä¾›å†™ binlog æœåŠ¡ï¼Œå†™å…¥äº† binlogï½›8ï¼Œ12ï½ï¼ŒDrainer åœ¨æ­¤æœŸé—´ç»§ç»­è¯»å– Pump1 å’Œ Pump2 çš„ binlogï¼Œå‡è®¾è¯»å–åˆ°äº† 9ï¼Œä¹‹åæ‰è¯†åˆ«åˆ°äº† Pump3 å¹¶å°† Pump3 åŠ å…¥åˆ°å½’å¹¶æ’åºä¸­ï¼Œæ­¤æ—¶ Pump3 çš„ binlog 8 å°±ä¸¢å¤±äº†ã€‚ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œéœ€è¦è®© Pump3 é€šçŸ¥ Drainer è‡ªå·±å·²ç»ä¸Šçº¿ï¼ŒDrainer æ”¶åˆ°é€šçŸ¥åå°† Pump3 åŠ å…¥åˆ°å½’å¹¶æ’åºï¼Œå¹¶è¿”å›æˆåŠŸç»™ Pump3ï¼Œç„¶å Pump3 æ‰èƒ½æä¾›å†™ binlog çš„æœåŠ¡ã€‚&lt;/p&gt;&lt;p&gt;Drainer é€šè¿‡å¦‚ä¸Šæ‰€ç¤ºçš„æ–¹å¼å¯¹ binlog è¿›è¡Œå½’å¹¶æ’åºï¼Œå¹¶æ¨è¿›åŒæ­¥çš„ä½ç½®ã€‚é‚£ä¹ˆå¯èƒ½ä¼šå­˜åœ¨è¿™ç§æƒ…å†µï¼šæŸä¸ª Pump ç”±äºä¸€äº›ç‰¹æ®Šçš„åŸå› ä¸€ç›´æ²¡æœ‰æ”¶åˆ° binlog æ•°æ®ï¼Œé‚£ä¹ˆ Drainer ä¸­çš„å½’å¹¶æ’åºå°±æ— æ³•ç»§ç»­ä¸‹å»ï¼Œæ­£å¦‚æˆ‘ä»¬ç”¨ä¸¤æ¡è…¿èµ°è·¯ï¼Œå…¶ä¸­ä¸€åªè…¿ä¸åŠ¨å°±ä¸èƒ½ç»§ç»­å‰è¿›ã€‚æˆ‘ä»¬ä½¿ç”¨ Pump ä¸€èŠ‚ä¸­æåˆ°çš„ fake binlog çš„æœºåˆ¶æ¥é¿å…è¿™ç§é—®é¢˜ï¼ŒPump æ¯éš”æŒ‡å®šçš„æ—¶é—´å°±ç”Ÿæˆä¸€æ¡ fake binlogï¼Œå³ä½¿æŸäº› Pump ä¸€ç›´æ²¡æœ‰æ•°æ®å†™å…¥ï¼Œä¹Ÿå¯ä»¥ä¿è¯å½’å¹¶æ’åºæ­£å¸¸å‘å‰æ¨è¿›ã€‚&lt;/p&gt;&lt;p&gt;Drainer å°†æ‰€æœ‰ Pump çš„æ•°æ®æŒ‰ç…§ &lt;code class=&quot;inline&quot;&gt;commit_ts&lt;/code&gt; è¿›è¡Œå½’å¹¶æ’åºåï¼Œå°† binlog æ•°æ®ä¼ é€’ç»™ Drainer ä¸­çš„æ•°æ®è§£æåŠåŒæ­¥æ¨¡å—ã€‚é€šè¿‡ä¸Šé¢çš„ binlog æ ¼å¼çš„ä»‹ç»ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡º binlog æ–‡ä»¶ä¸­å¹¶æ²¡æœ‰å­˜å‚¨è¡¨ç»“æ„çš„ä¿¡æ¯ï¼Œå› æ­¤éœ€è¦åœ¨ Drainer ä¸­ç»´æŠ¤æ‰€æœ‰åº“å’Œè¡¨çš„ç»“æ„ä¿¡æ¯ã€‚åœ¨å¯åŠ¨ Drainer æ—¶ï¼ŒDrainer ä¼šè¯·æ±‚ TiKVï¼Œè·å–åˆ°æ‰€æœ‰å†å²çš„ DDL job çš„ä¿¡æ¯ï¼Œå¯¹è¿™äº› DDL job è¿›è¡Œè¿‡æ»¤ï¼Œä½¿ç”¨ Drainer å¯åŠ¨æ—¶æŒ‡å®šçš„ initial-commit-tsï¼ˆæˆ–è€… checkpoint ä¸­ä¿å­˜çš„ &lt;code class=&quot;inline&quot;&gt;commit_ts&lt;/code&gt;ï¼‰ä¹‹å‰çš„ DDL åœ¨å†…å­˜ä¸­æ„å»ºåº“å’Œè¡¨ç»“æ„ä¿¡æ¯ã€‚è¿™æ · Drainer å°±æœ‰äº†ä¸€ä»½ ts å¯¹åº”æ—¶é—´ç‚¹çš„åº“å’Œè¡¨çš„å¿«ç…§ï¼Œåœ¨è¯»å–åˆ° DDL ç±»å‹çš„ binlog æ—¶ï¼Œåˆ™æ›´æ–°åº“å’Œè¡¨çš„ä¿¡æ¯ï¼›è¯»å–åˆ° DML ç±»å‹çš„ binlog æ—¶ï¼Œåˆ™æ ¹æ®åº“å’Œè¡¨çš„ä¿¡æ¯æ¥ç”Ÿæˆ SQLã€‚&lt;/p&gt;&lt;p&gt;åœ¨ç”Ÿæˆ SQL ä¹‹åï¼Œå°±å¯ä»¥åŒæ­¥åˆ°ä¸‹æ¸¸äº†ã€‚ä¸ºäº†æé«˜ Drainer åŒæ­¥çš„é€Ÿåº¦ï¼ŒDrainer ä¸­ä½¿ç”¨å¤šä¸ªåç¨‹æ¥æ‰§è¡Œ SQLã€‚åœ¨ç”Ÿæˆ SQL æ—¶ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨ä¸»é”®ï¼å”¯ä¸€é”®çš„å€¼ä½œä¸ºè¯¥æ¡ SQL çš„ keyï¼Œé€šè¿‡å¯¹ key è¿›è¡Œ hash æ¥å°† SQL å‘é€åˆ°å¯¹åº”çš„åç¨‹ä¸­ã€‚å½“æ¯ä¸ªåç¨‹æ”¶é›†åˆ°äº†è¶³å¤Ÿå¤šçš„ SQLï¼Œæˆ–è€…è¶…è¿‡äº†ä¸€å®šçš„æ—¶é—´ï¼Œåˆ™å°†è¿™ä¸€æ‰¹çš„ SQL åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­æäº¤åˆ°ä¸‹æ¸¸ã€‚&lt;/p&gt;&lt;p&gt;ä½†æ˜¯æœ‰äº› SQL æ˜¯ç›¸å…³çš„ï¼Œå¦‚æœè¢«åˆ†åˆ°äº†ä¸åŒçš„åç¨‹ï¼Œé‚£ SQL çš„æ‰§è¡Œé¡ºåºå°±ä¸èƒ½å¾—åˆ°ä¿è¯ï¼Œé€ æˆæ•°æ®çš„ä¸ä¸€è‡´ã€‚ä¾‹å¦‚ï¼š&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;SQL1: delete from test.test where id = 1;

SQL2: replace into test.test (id, name ) values(1, &quot;a&quot;);&lt;/code&gt;&lt;p&gt;æŒ‰ç…§é¡ºåºæ‰§è¡Œåè¡¨ä¸­å­˜åœ¨ id ï¼ 1 è¯¥è¡Œæ•°æ®ï¼Œå¦‚æœè¿™ä¸¤æ¡ SQL åˆ†åˆ«åˆ†é…åˆ°äº†åç¨‹ 1 å’Œåç¨‹ 2 ä¸­ï¼Œå¹¶ä¸”åç¨‹ 2 å…ˆæ‰§è¡Œäº† SQLï¼Œåˆ™è¡¨ä¸­ä¸å†å­˜åœ¨ id ï¼ 1 çš„æ•°æ®ã€‚ä¸ºäº†é¿å…è¿™ç§æƒ…å†µçš„å‘ç”Ÿï¼ŒDrainer ä¸­åŠ å…¥äº†å†²çªæ£€æµ‹çš„æœºåˆ¶ï¼Œå¦‚æœæ£€æµ‹å‡ºæ¥ä¸¤æ¡ SQL å­˜åœ¨å†²çªï¼ˆä¿®æ”¹äº†åŒä¸€è¡Œæ•°æ®ï¼‰ï¼Œåˆ™æš‚æ—¶ä¸å°†åé¢çš„ SQL å‘é€åˆ°åç¨‹ï¼Œè€Œæ˜¯ç”Ÿæˆä¸€ä¸ª Flush ç±»å‹çš„ job å‘é€åˆ°æ‰€æœ‰çš„åç¨‹ï¼Œ æ¯ä¸ªåç¨‹åœ¨é‡åˆ° Flush job æ—¶å°±ä¼šé©¬ä¸Šæ‰§è¡Œæ‰€ç¼“å­˜çš„ SQLã€‚æ¥ç€æ‰ä¼šæŠŠè¯¥æ¡æœ‰å†²çªçš„ SQL å‘é€åˆ°å¯¹åº”çš„åç¨‹ä¸­ã€‚ä¸‹é¢ç»™å‡ºä¸€ä¸ªä¾‹å­è¯´æ˜ä¸€ä¸‹å†²çªæ£€æµ‹çš„æœºåˆ¶ï¼š&lt;/p&gt;&lt;p&gt;æœ‰ä»¥ä¸‹è¿™äº› SQLï¼Œå…¶ä¸­ id ä¸ºè¡¨çš„ä¸»é”®ï¼š&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;SQL1: update itest set id = 4, name = &quot;c&quot;, age = 15 where id = 3;    key: 3, 4

SQL2:  update itest set id = 5, name = &quot;b&quot;, age = 14 where id = 2;   keyï¼š5, 2

SQL3ï¼šdelete from itest where id = 3;                                key: 3&lt;/code&gt;&lt;ol&gt;&lt;li&gt;é¦–å…ˆå°† SQL1 å‘é€åˆ°æŒ‡å®šçš„åç¨‹ï¼Œè¿™æ—¶æ‰€æœ‰çš„ keys ä¸ºï¼»3ï¼Œ4ï¼½ï¼›&lt;/li&gt;&lt;li&gt;SQL2 çš„ keyï¼»5ï¼Œ2ï¼½ä¸ keys ä¸­çš„ï¼»3ï¼Œ4ï¼½éƒ½æ²¡æœ‰å†²çªï¼Œå°† SQL2 å‘é€åˆ°æŒ‡å®šçš„åç¨‹ï¼Œè¿™æ—¶ keys ä¸ºï¼»3ï¼Œ4ï¼Œ5ï¼Œ2ï¼½ï¼›&lt;/li&gt;&lt;li&gt;SQL3 çš„ keyï¼»3ï¼½ä¸ keys ä¸­çš„ï¼»3ï¼½å­˜åœ¨å†²çªï¼Œå‘é€ Flush job åˆ°æ‰€æœ‰åç¨‹ï¼ŒSQL1 å’Œ SQL2 è¢«æ‰§è¡Œï¼Œæ¸…ç©º keysï¼›&lt;/li&gt;&lt;li&gt;å°† SQL3 å‘é€åˆ°æŒ‡å®šçš„åç¨‹ï¼ŒåŒæ—¶æ›´æ–° keys ä¸ºï¼»3ï¼½ã€‚&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;Drainer é€šè¿‡ä»¥ä¸Šè¿™äº›æœºåˆ¶æ¥é«˜æ•ˆåœ°åŒæ­¥æ•°æ®ï¼Œå¹¶ä¸”ä¿è¯æ•°æ®çš„ä¸€è‡´ã€‚&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;i&gt;æ›´å¤šæŠ€æœ¯å¹²è´§ï¼š&lt;/i&gt;&lt;/p&gt;&lt;a href=&quot;https://www.pingcap.com/blog-cn/&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;v2-60ab5bd867c2434d70c957a02a2169e1&quot; data-image-width=&quot;1200&quot; data-image-height=&quot;1200&quot; data-image-size=&quot;ipico&quot;&gt;åšå®¢&lt;/a&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>ZoeyZhai</author>
<guid isPermaLink="false">2018-12-10-51990591</guid>
<pubDate>Mon, 10 Dec 2018 00:00:00 +0800</pubDate>
</item>
<item>
<title>TiDB åœ¨å°ç±³çš„åº”ç”¨å®è·µ</title>
<link>https://henix.github.io/feeds/zhuanlan.newsql/2018-12-03-51472404.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/51472404&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-286ddf5e402ba98f9de8bfa95ce5eb57_r.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;&lt;/p&gt;&lt;blockquote&gt;&lt;b&gt;ä½œè€…ä»‹ç»&lt;/b&gt;&lt;br&gt;å¼ è‰¯ï¼Œå°ç±³ DBA è´Ÿè´£äºº&lt;br&gt;æ½˜å‹é£ï¼Œå°ç±³ DBA&lt;br&gt;ç‹å¿…æ–‡ï¼Œå°ç±³å¼€å‘å·¥ç¨‹å¸ˆ&lt;/blockquote&gt;&lt;h2&gt;&lt;b&gt;åº”ç”¨åœºæ™¯ä»‹ç»&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;MIUI æ˜¯å°ç±³å…¬å¸æ——ä¸‹åŸºäº Android ç³»ç»Ÿæ·±åº¦ä¼˜åŒ–ã€å®šåˆ¶ã€å¼€å‘çš„ç¬¬ä¸‰æ–¹æ‰‹æœºæ“ä½œç³»ç»Ÿï¼Œä¹Ÿæ˜¯å°ç±³çš„ç¬¬ä¸€ä¸ªäº§å“ã€‚MIUI åœ¨ Android ç³»ç»ŸåŸºç¡€ä¸Šï¼Œé’ˆå¯¹ä¸­å›½ç”¨æˆ·è¿›è¡Œäº†æ·±åº¦å®šåˆ¶ï¼Œåœ¨æ­¤ä¹‹ä¸Šå­•è‚²å‡ºäº†ä¸€ç³»åˆ—çš„åº”ç”¨ï¼Œæ¯”å¦‚ä¸»é¢˜å•†åº—ã€å°ç±³éŸ³ä¹ã€åº”ç”¨å•†åº—ã€å°ç±³é˜…è¯»ç­‰ã€‚     &lt;br&gt;&lt;br&gt;&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-c4428dc7c80aea208ba650abba0f8079_r.jpg&quot; data-caption=&quot;å›¾ 1  MIUI Android ç³»ç»Ÿç•Œé¢å›¾&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;595&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-c4428dc7c80aea208ba650abba0f8079&quot; data-watermark-src=&quot;v2-acb05a51e9c3630558f4a6880d1ca2c1&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;br&gt;ç›®å‰ TiDB ä¸»è¦åº”ç”¨åœ¨ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;å°ç±³æ‰‹æœºæ¡Œé¢è´Ÿä¸€å±çš„å¿«é€’ä¸šåŠ¡&lt;/li&gt;&lt;li&gt;å•†ä¸šå¹¿å‘Šäº¤æ˜“å¹³å°ç´ ææŠ½å®¡å¹³å°&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;è¿™ä¸¤ä¸ªä¸šåŠ¡åœºæ™¯æ¯å¤©è¯»å†™é‡å‡è¾¾åˆ°ä¸Šäº¿çº§ï¼Œä¸Šçº¿ä¹‹åï¼Œæ•´ä¸ªæœåŠ¡ç¨³å®šè¿è¡Œï¼›æ¥ä¸‹æ¥æˆ‘ä»¬è®¡åˆ’é€æ­¥ä¸Šçº¿æ›´å¤šçš„ä¸šåŠ¡åœºæ™¯ï¼Œå°ç±³é˜…è¯»ç›®å‰æ­£åœ¨ç§¯æçš„é’ˆå¯¹è®¢å•ç³»ç»Ÿåšè¿ç§»æµ‹è¯•ã€‚&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;TiDB ç‰¹ç‚¹&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;TiDB ç»“åˆäº†ä¼ ç»Ÿçš„ RDBMS å’Œ NoSQL çš„æœ€ä½³ç‰¹æ€§ï¼Œå…¼å®¹ MySQL åè®®ï¼Œæ”¯æŒæ— é™çš„æ°´å¹³æ‰©å±•ï¼Œå…·å¤‡å¼ºä¸€è‡´æ€§å’Œé«˜å¯ç”¨æ€§ã€‚&lt;/p&gt;&lt;p&gt;å…·æœ‰å¦‚ä¸‹çš„ç‰¹æ€§ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;é«˜åº¦å…¼å®¹ MySQLï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹æ— éœ€ä¿®æ”¹ä»£ç å³å¯ä» MySQL è½»æ¾è¿ç§»è‡³ TiDBï¼Œå³ä½¿å·²ç»åˆ†åº“åˆ†è¡¨çš„ MySQL é›†ç¾¤äº¦å¯é€šè¿‡ TiDB æä¾›çš„è¿ç§»å·¥å…·è¿›è¡Œå®æ—¶è¿ç§»ã€‚&lt;/li&gt;&lt;li&gt;æ°´å¹³å¼¹æ€§æ‰©å±•ï¼Œé€šè¿‡ç®€å•åœ°å¢åŠ æ–°èŠ‚ç‚¹å³å¯å®ç° TiDB çš„æ°´å¹³æ‰©å±•ï¼ŒæŒ‰éœ€æ‰©å±•ååæˆ–å­˜å‚¨ï¼Œè½»æ¾åº”å¯¹é«˜å¹¶å‘ã€æµ·é‡æ•°æ®åœºæ™¯ã€‚&lt;/li&gt;&lt;li&gt;åˆ†å¸ƒå¼äº‹åŠ¡ï¼ŒTiDB 100% æ”¯æŒæ ‡å‡†çš„ ACID äº‹åŠ¡ã€‚&lt;/li&gt;&lt;li&gt;çœŸæ­£é‡‘èçº§é«˜å¯ç”¨ï¼Œç›¸æ¯”äºä¼ ç»Ÿä¸»ä»ï¼ˆM-Sï¼‰å¤åˆ¶æ–¹æ¡ˆï¼ŒåŸºäº Raft çš„å¤šæ•°æ´¾é€‰ä¸¾åè®®å¯ä»¥æä¾›é‡‘èçº§çš„ 100% æ•°æ®å¼ºä¸€è‡´æ€§ä¿è¯ï¼Œä¸”åœ¨ä¸ä¸¢å¤±å¤§å¤šæ•°å‰¯æœ¬çš„å‰æä¸‹ï¼Œå¯ä»¥å®ç°æ•…éšœçš„è‡ªåŠ¨æ¢å¤ï¼ˆauto-failoverï¼‰ï¼Œæ— éœ€äººå·¥ä»‹å…¥ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;TiDB çš„æ¶æ„åŠåŸç†å®˜ç½‘æœ‰è¯¦ç»†ä»‹ç»ï¼ˆ&lt;a href=&quot;https://pingcap.com/&quot;&gt;https://pingcap.com/&lt;/a&gt;ï¼‰ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚&lt;br&gt;&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-2a500e631bf3062d721ce5cd2cd2c817_r.jpg&quot; data-caption=&quot;å›¾ 2  TiDB åŸºç¡€æ¶æ„å›¾&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;743&quot; data-rawheight=&quot;381&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-2a500e631bf3062d721ce5cd2cd2c817&quot; data-watermark-src=&quot;v2-8169cc4855b1c15dc1d79afdb93854a4&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;h2&gt;&lt;br&gt;&lt;b&gt;èƒŒæ™¯&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;è·Ÿç»å¤§æ•°äº’è”ç½‘å…¬å¸ä¸€æ ·ï¼Œå°ç±³å…³ç³»å‹å­˜å‚¨æ•°æ®åº“é¦–é€‰ MySQLï¼Œå•æœº 2.6T ç£ç›˜ã€‚ç”±äºå°ç±³æ‰‹æœºé”€é‡çš„å¿«é€Ÿä¸Šå‡å’Œ MIUI è´Ÿä¸€å±ç”¨æˆ·é‡çš„å¿«é€Ÿå¢åŠ ï¼Œå¯¼è‡´è´Ÿä¸€å±å¿«é€’ä¸šåŠ¡æ•°æ®çš„æ•°æ®é‡å¢é•¿éå¸¸å¿«ï¼Œ&lt;b&gt;æ¯å¤©çš„è¯»å†™é‡çº§å‡åˆ†åˆ«è¾¾åˆ°ä¸Šäº¿çº§åˆ«ï¼Œæ•°æ®å¿«é€Ÿå¢é•¿å¯¼è‡´å•æœºå‡ºç°ç“¶é¢ˆï¼Œæ¯”å¦‚æ€§èƒ½æ˜æ˜¾ä¸‹é™ã€å¯ç”¨å­˜å‚¨ç©ºé—´ä¸æ–­é™ä½ã€å¤§è¡¨ DDL æ— æ³•æ‰§è¡Œç­‰ï¼Œä¸å¾—ä¸é¢ä¸´æ•°æ®åº“æ‰©å±•çš„é—®é¢˜ã€‚&lt;/b&gt;æ¯”å¦‚ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªä¸šåŠ¡åœºæ™¯ï¼ˆæ™ºèƒ½ç»ˆç«¯ï¼‰ï¼Œéœ€è¦å®šæ—¶ä»å‡ åƒä¸‡çº§çš„æ™ºèƒ½ç»ˆç«¯é«˜é¢‘çš„å‘æ•°æ®åº“å†™å…¥å„ç§ç›‘æ§åŠé‡‡é›†æ•°æ®ï¼ŒMySQL åŸºäº Binlog çš„å•çº¿ç¨‹å¤åˆ¶æ¨¡å¼ï¼Œå¾ˆå®¹æ˜“é€ æˆä»åº“å»¶è¿Ÿï¼Œå¹¶ä¸”å †ç§¯è¶Šæ¥è¶Šä¸¥é‡ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;å¯¹äº MySQL æ¥è®²ï¼Œæœ€ç›´æ¥çš„æ–¹æ¡ˆå°±æ˜¯é‡‡ç”¨åˆ†åº“åˆ†è¡¨çš„æ°´å¹³æ‰©å±•æ–¹å¼ï¼Œç»¼åˆæ¥çœ‹å¹¶ä¸æ˜¯æœ€ä¼˜çš„æ–¹æ¡ˆï¼Œæ¯”å¦‚å¯¹äºä¸šåŠ¡æ¥è®²ï¼Œå¯¹ä¸šåŠ¡ä»£ç çš„ä¾µå…¥æ€§è¾ƒå¤§ï¼›å¯¹äº DBA æ¥è®²æå‡ç®¡ç†æˆæœ¬ï¼Œåç»­éœ€è¦ä¸æ–­çš„æ‹†åˆ†æ‰©å®¹ï¼Œå³ä½¿æœ‰ä¸­é—´ä»¶ä¹Ÿæœ‰ä¸€å®šçš„å±€é™æ€§ã€‚&lt;/b&gt;åŒæ ·æ˜¯ä¸Šé¢çš„æ™ºèƒ½ç»ˆç«¯ä¸šåŠ¡åœºæ™¯ï¼Œä»ä¸šåŠ¡éœ€æ±‚çœ‹ï¼Œéœ€è¦ä»å¤šä¸ªä¸šåŠ¡ç»´åº¦è¿›è¡ŒæŸ¥è¯¢ï¼Œå¹¶ä¸”ä¸šåŠ¡ç»´åº¦å¯èƒ½éšæ—¶è¿›è¡Œæ‰©å±•ï¼Œåˆ†è¡¨çš„æ–¹æ¡ˆåŸºæœ¬ä¸èƒ½æ»¡è¶³ä¸šåŠ¡çš„éœ€æ±‚ã€‚&lt;/p&gt;&lt;p&gt;äº†è§£åˆ° TiDB ç‰¹ç‚¹ä¹‹åï¼ŒDBA ä¸ä¸šåŠ¡å¼€å‘æ²Ÿé€šç¡®è®¤å½“å‰ MySQL çš„ä½¿ç”¨æ–¹å¼ï¼Œå¹¶ä¸ TiDB çš„å…¼å®¹æ€§åšäº†è¯¦ç»†å¯¹æ¯”ï¼Œç»è¿‡ä¸šåŠ¡å‹æµ‹ä¹‹åï¼Œæ ¹æ®å‹æµ‹çš„ç»“æœï¼Œå†³å®šå°è¯•å°†æ•°æ®å­˜å‚¨ä» MySQL è¿ç§»åˆ° TiDBã€‚ç»è¿‡å‡ ä¸ªæœˆçš„çº¿ä¸Šè€ƒéªŒï¼ŒTiDB çš„è¡¨ç°è¾¾åˆ°é¢„æœŸã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;å…¼å®¹æ€§å¯¹æ¯”&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;TiDB æ”¯æŒåŒ…æ‹¬è·¨è¡Œäº‹åŠ¡ã€JOINã€å­æŸ¥è¯¢åœ¨å†…çš„ç»å¤§å¤šæ•° MySQL çš„è¯­æ³•ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ MySQL å®¢æˆ·ç«¯è¿æ¥ï¼›å¯¹äºå·²ç”¨ MySQL çš„ä¸šåŠ¡æ¥è®²ï¼ŒåŸºæœ¬å¯ä»¥æ— ç¼åˆ‡æ¢åˆ° TiDBã€‚&lt;/b&gt;&lt;br&gt;äºŒè€…ç®€å•å¯¹æ¯”å¦‚ä¸‹å‡ æ–¹é¢ï¼š&lt;/p&gt;&lt;p&gt;1. åŠŸèƒ½æ”¯æŒ&lt;/p&gt;&lt;p&gt;TiDB å°šä¸æ”¯æŒå¦‚ä¸‹å‡ é¡¹ï¼š&lt;/p&gt;&lt;ul&gt;&lt;ul&gt;&lt;li&gt;å¢åŠ ã€åˆ é™¤ä¸»é”®&lt;/li&gt;&lt;li&gt;é UTF8 å­—ç¬¦é›†&lt;/li&gt;&lt;li&gt;è§†å›¾ï¼ˆå³å°†æ”¯æŒï¼‰ã€å­˜å‚¨è¿‡ç¨‹ã€è§¦å‘å™¨ã€éƒ¨åˆ†å†…ç½®å‡½æ•°&lt;/li&gt;&lt;li&gt;Event&lt;/li&gt;&lt;li&gt;å…¨æ–‡ç´¢å¼•ã€ç©ºé—´ç´¢å¼•&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;p&gt;2. é»˜è®¤è®¾ç½®&lt;/p&gt;&lt;p&gt;å­—ç¬¦é›†ã€æ’åºè§„åˆ™ã€sql_modeã€lower_case_table_names å‡ é¡¹é»˜è®¤å€¼ä¸åŒã€‚&lt;/p&gt;&lt;p&gt;3. äº‹åŠ¡&lt;/p&gt;&lt;ul&gt;&lt;ul&gt;&lt;li&gt;TiDB ä½¿ç”¨ä¹è§‚äº‹åŠ¡æ¨¡å‹ï¼Œæäº¤åæ³¨æ„æ£€æŸ¥è¿”å›å€¼ã€‚&lt;/li&gt;&lt;li&gt;TiDB é™åˆ¶å•ä¸ªäº‹åŠ¡å¤§å°ï¼Œä¿æŒäº‹åŠ¡å°½å¯èƒ½çš„å°ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;p&gt;4. TiDB æ”¯æŒç»å¤§å¤šæ•°çš„ Online DDLã€‚&lt;/p&gt;&lt;p&gt;5. å¦ï¼Œä¸€äº› MySQL è¯­æ³•åœ¨ TiDB ä¸­å¯ä»¥è§£æé€šè¿‡ï¼Œä¸ä¼šäº§ç”Ÿä»»ä½•ä½œç”¨ï¼Œä¾‹å¦‚ï¼š create table è¯­å¥ä¸­ engineã€partition é€‰é¡¹éƒ½æ˜¯åœ¨è§£æåå¿½ç•¥ã€‚&lt;/p&gt;&lt;p&gt;6. è¯¦ç»†ä¿¡æ¯å¯ä»¥è®¿é—®å®˜ç½‘ï¼šhttps://pingcap.com/docs-cn/sql/mysql-compatibility/ ã€‚&lt;/p&gt;&lt;h2&gt;&lt;br&gt;&lt;b&gt;å‹æµ‹&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;1. ç›®çš„&lt;/b&gt;&lt;/p&gt;&lt;p&gt;é€šè¿‡å‹æµ‹ TiDB äº†è§£ä¸€ä¸‹å…¶ OLTP æ€§èƒ½ï¼Œçœ‹æ˜¯å¦æ»¡è¶³ä¸šåŠ¡è¦æ±‚ã€‚&lt;br&gt;&lt;br&gt;&lt;b&gt;2. æœºå™¨é…ç½®&lt;/b&gt;&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-5d7d319c1480a57e186b79e7bf2cd6ce_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;394&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-5d7d319c1480a57e186b79e7bf2cd6ce&quot; data-watermark-src=&quot;v2-dbdd0864ecae8948d5ef342c9e5d6c78&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;br&gt;&lt;b&gt;3. å‹æµ‹å†…å®¹ä»¥åŠç»“æœ&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt; æ ‡å‡† Select å‹æµ‹&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-3919bf10c952092538e4df79ee90caa2_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;322&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-3919bf10c952092538e4df79ee90caa2&quot; data-watermark-src=&quot;v2-1ab2200f75c089f9a9f3cade76c787b4&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-8d9269cdf30ac3f6bb7c846d4473a248_r.jpg&quot; data-caption=&quot;å›¾ 3  æ ‡å‡† Select å‹æµ‹å›¾&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;864&quot; data-rawheight=&quot;539&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-8d9269cdf30ac3f6bb7c846d4473a248&quot; data-watermark-src=&quot;v2-da683c683c19267c31a5e7fc3f07a732&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;æ ‡å‡† OLTP å‹æµ‹&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-c163a21feec655e19ab64dcb1b07f70a_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;357&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-c163a21feec655e19ab64dcb1b07f70a&quot; data-watermark-src=&quot;v2-a755b0a83bd7ddba182ba80a6ed66877&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-fddec2f978f81acfee3a2d75b2d5ebcb_r.jpg&quot; data-caption=&quot;å›¾ 4  æ ‡å‡† OLTP  å‹æµ‹å›¾&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;864&quot; data-rawheight=&quot;541&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-fddec2f978f81acfee3a2d75b2d5ebcb&quot; data-watermark-src=&quot;v2-847e24943021fd8f04ec9a6c907ff6a8&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt; æ ‡å‡† Insert å‹æµ‹&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-28457ad3a1997ddf3c1f2abb33d16fc4_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;333&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-28457ad3a1997ddf3c1f2abb33d16fc4&quot; data-watermark-src=&quot;v2-36a16a1feb93e863164d2d83eb3c472a&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-686f7602ce614f8e15fdb0ef388a009a_r.jpg&quot; data-caption=&quot;å›¾ 5  æ ‡å‡† Insert å‹æµ‹å›¾&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;864&quot; data-rawheight=&quot;539&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-686f7602ce614f8e15fdb0ef388a009a&quot; data-watermark-src=&quot;v2-c687905215da14e1e3976f9a4196762f&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;br&gt;é€šè¿‡å‹æµ‹å‘ç° TiDB ç¨³å®šæ€§ä¸Šä¸é¢„æœŸç¨æœ‰å·®åˆ«ï¼Œä¸è¿‡å‹æµ‹çš„ Load ä¼šæ˜æ˜¾é«˜äºç”Ÿäº§ä¸­çš„ä¸šåŠ¡ Loadï¼Œå‚è€ƒä½ Threads æ—¶ TiDB çš„è¡¨ç°ï¼ŒåŸºæœ¬å¯ä»¥æ»¡è¶³ä¸šåŠ¡å¯¹ DB çš„æ€§èƒ½è¦æ±‚ï¼Œå†³å®šç°åº¦ä¸€éƒ¨åˆ† MySQL ä»åº“è¯»æµé‡ä½“éªŒä¸€ä¸‹å®é™…æ•ˆæœã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;è¿ç§»è¿‡ç¨‹&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;æ•´ä¸ªè¿ç§»åˆ†ä¸º 2 å¤§å—ï¼šæ•°æ®è¿ç§»ã€æµé‡è¿ç§»ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;1. æ•°æ®è¿ç§»&lt;/b&gt;&lt;/p&gt;&lt;p&gt;æ•°æ®è¿ç§»åˆ†ä¸ºå¢é‡æ•°æ®ã€å­˜é‡æ•°æ®ä¸¤éƒ¨åˆ†ã€‚&lt;/p&gt;&lt;ul&gt;&lt;li&gt;å¯¹äºå­˜é‡æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨é€»è¾‘å¤‡ä»½ã€å¯¼å…¥çš„æ–¹å¼ï¼Œé™¤äº†ä¼ ç»Ÿçš„é€»è¾‘å¯¼å…¥å¤–ï¼Œå®˜æ–¹è¿˜æä¾›ä¸€æ¬¾ç‰©ç†å¯¼å…¥çš„å·¥å…· TiDB Lightningã€‚&lt;/li&gt;&lt;li&gt;å¯¹äºå¢é‡å¤‡ä»½å¯ä»¥ä½¿ç”¨ TiDB æä¾›çš„ Syncer ï¼ˆæ–°ç‰ˆå·²ç»æ›´åä¸º DM - Data Migrationï¼‰æ¥ä¿è¯æ•°æ®åŒæ­¥ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;Syncer ç»“æ„å¦‚å›¾ 6ï¼Œä¸»è¦ä¾é å„ç§ Rule æ¥å®ç°ä¸åŒçš„è¿‡æ»¤ã€åˆå¹¶æ•ˆæœï¼Œä¸€ä¸ªåŒæ­¥æºå¯¹åº”ä¸€ä¸ª Syncer è¿›ç¨‹ï¼ŒåŒæ­¥ Sharding æ•°æ®æ—¶åˆ™è¦å¤šä¸ª Syncer è¿›ç¨‹ã€‚&lt;br&gt;&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-facfec2bcf6879a829017e0de8b94a38_r.jpg&quot; data-caption=&quot;å›¾ 6  Syncer ç»“æ„å›¾&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;852&quot; data-rawheight=&quot;391&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-facfec2bcf6879a829017e0de8b94a38&quot; data-watermark-src=&quot;v2-fa999818be6d9fcd875987dfa5d194a8&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;br&gt;ä½¿ç”¨ Syncer éœ€è¦æ³¨æ„ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;åšå¥½åŒæ­¥å‰æ£€æŸ¥ï¼ŒåŒ…å« server-idã€log_binã€binlog_format æ˜¯å¦ä¸º ROWã€binlog_row_image æ˜¯å¦ä¸º FULLã€åŒæ­¥ç›¸å…³ç”¨æˆ·æƒé™ã€Binlog ä¿¡æ¯ç­‰ã€‚&lt;/li&gt;&lt;li&gt;ä½¿ç”¨ä¸¥æ ¼æ•°æ®æ£€æŸ¥æ¨¡å¼ï¼Œæ•°æ®ä¸åˆæ³•åˆ™ä¼šåœæ­¢ã€‚æ•°æ®è¿ç§»ä¹‹å‰æœ€å¥½é’ˆå¯¹æ•°æ®ã€è¡¨ç»“æ„åšæ£€æŸ¥ã€‚&lt;/li&gt;&lt;li&gt;åšå¥½ç›‘æ§ï¼ŒTiDB æä¾›ç°æˆçš„ç›‘æ§æ–¹æ¡ˆã€‚&lt;/li&gt;&lt;li&gt;å¯¹äºå·²ç»åˆ†ç‰‡çš„è¡¨åŒæ­¥åˆ°åŒä¸€ä¸ª TiDB é›†ç¾¤ï¼Œè¦åšå¥½é¢„å…ˆæ£€æŸ¥ã€‚ç¡®è®¤åŒæ­¥åœºæ™¯æ˜¯å¦å¯ä»¥ç”¨ route-rules è¡¨è¾¾ï¼Œæ£€æŸ¥åˆ†è¡¨çš„å”¯ä¸€é”®ã€ä¸»é”®åœ¨æ•°æ®åˆå¹¶åæ˜¯å¦å†²çªç­‰ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;2. æµé‡è¿ç§»&lt;/b&gt;&lt;/p&gt;&lt;p&gt;æµé‡åˆ‡æ¢åˆ° TiDB åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼šè¯»ã€å†™æµé‡è¿ç§»ã€‚æ¯æ¬¡åˆ‡æ¢ä¿è¯ç°åº¦è¿‡ç¨‹ï¼Œè§‚å¯Ÿå‘¨æœŸä¸º 1~2 å‘¨ï¼Œåšå¥½å›æ»šæªæ–½ã€‚&lt;/p&gt;&lt;ul&gt;&lt;li&gt;è¯»æµé‡åˆ‡æ¢åˆ° TiDBï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸­å›æ»šæ¯”è¾ƒç®€å•ï¼Œç°åº¦æ— é—®é¢˜ï¼Œåˆ™å…¨é‡åˆ‡æ¢ã€‚&lt;/li&gt;&lt;li&gt;å†å°†å†™å…¥åˆ‡æ¢åˆ° TiDBï¼Œéœ€è¦è€ƒè™‘å¥½æ•°æ®å›æ»šæ–¹æ¡ˆæˆ–è€…é‡‡ç”¨åŒå†™çš„æ–¹å¼ï¼ˆéœ€è¦æ–­æ‰ Syncerï¼‰ ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;h2&gt;&lt;b&gt;é›†ç¾¤çŠ¶å†µ&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;1. é…ç½®&lt;/b&gt;&lt;/p&gt;&lt;p&gt;é›†ç¾¤é…ç½®é‡‡ç”¨å®˜æ–¹æ¨èçš„ 7 èŠ‚ç‚¹é…ç½®ï¼Œ3 ä¸ª TiDB èŠ‚ç‚¹ï¼Œ3 ä¸ª PD èŠ‚ç‚¹ï¼Œ4 ä¸ª TiKV èŠ‚ç‚¹ï¼Œå…¶ä¸­æ¯ä¸ª TiDB ä¸ PD ä¸ºä¸€ç»„ï¼Œå…±ç”¨ä¸€å°ç‰©ç†æœºã€‚åç»­éšç€ä¸šåŠ¡å¢é•¿æˆ–è€…æ–°ä¸šåŠ¡æ¥å…¥ï¼Œå†æŒ‰éœ€æ·»åŠ  TiKV èŠ‚ç‚¹ã€‚&lt;br&gt;&lt;br&gt;&lt;b&gt;2. ç›‘æ§&lt;/b&gt;&lt;/p&gt;&lt;p&gt;ç›‘æ§é‡‡ç”¨äº† TiDB çš„æä¾›çš„ç›‘æ§æ–¹æ¡ˆï¼Œå¹¶ä¸”ä¹Ÿæ¥å…¥äº†å…¬å¸å¼€æºçš„ Falconï¼Œç›®å‰æ•´ä¸ªé›†ç¾¤è¿è¡Œæ¯”è¾ƒç¨³å®šï¼Œç›‘æ§å¦‚å›¾ 7ã€‚      &lt;br&gt;&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-6288a303380a452fb7c0f8716e97d135_r.jpg&quot; data-caption=&quot;å›¾ 7  ç›‘æ§å›¾&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;864&quot; data-rawheight=&quot;314&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-6288a303380a452fb7c0f8716e97d135&quot; data-watermark-src=&quot;v2-729e081c26da54cb02349deb61f1c839&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;h2&gt;&lt;b&gt;é‡åˆ°çš„é—®é¢˜ã€åŸå› åŠè§£å†³åŠæ³•&lt;/b&gt;&lt;/h2&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-504342f9d0b3e7799d8dc657180e2083_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;928&quot; data-rawheight=&quot;1638&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-504342f9d0b3e7799d8dc657180e2083&quot; data-watermark-src=&quot;v2-041e4d6ecb39bebe13289f22f6f275b9&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;h2&gt;&lt;br&gt;&lt;b&gt;åç»­å’Œå±•æœ›&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;ç›®å‰ TiDB åœ¨å°ç±³ä¸»è¦æä¾› OLTP æœåŠ¡ï¼Œå°ç±³æ‰‹æœºè´Ÿä¸€å±å¿«é€’ä¸šåŠ¡ä¸ºä½¿ç”¨ TiDB åšäº†ä¸€ä¸ªè‰¯å¥½çš„å¼€ç«¯ï¼Œè€Œåå•†ä¸šå¹¿å‘Šä¹Ÿæœ‰æ¥å…¥ï¼Œ2 ä¸ªä¸šåŠ¡å‡å·²ä¸Šçº¿æ•°æœˆï¼ŒTiDB çš„ç¨³å®šæ€§ç»å—ä½äº†è€ƒéªŒï¼Œå¸¦æ¥äº†å¾ˆæ£’çš„ä½“éªŒï¼Œå¯¹äºåç»­å¤§ä½“çš„è§„åˆ’å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;MIUI ç”Ÿæ€ä¸šåŠ¡ä¸­å­˜åœ¨å¤§é‡çš„ç±»ä¼¼åœºæ™¯çš„ä¸šåŠ¡ï¼Œåç»­å°†ä¼šä¸ä¸šåŠ¡å¼€å‘ç§¯ææ²Ÿé€šï¼Œä» MySQL è¿ç§»åˆ° TiDBã€‚&lt;/li&gt;&lt;li&gt;é’ˆå¯¹æŸäº›ä¸šåŠ¡åœºæ™¯ï¼Œä»¥èµ„æºåˆç†åˆ©ç”¨ä¸ºç›®æ ‡ï¼Œæ¨å‡ºå½’æ¡£é›†ç¾¤ï¼Œåˆ©ç”¨ Syncer å®ç°æ•°æ®å½’æ¡£çš„åŠŸèƒ½ã€‚&lt;/li&gt;&lt;li&gt;æ•°æ®åˆ†æï¼Œç»“åˆ TiDB æä¾›çš„å·¥å…·ï¼Œå°†æ”¯æŒç¦»çº¿ã€å®æ—¶æ•°æ®åˆ†ææ”¯æŒã€‚&lt;/li&gt;&lt;li&gt;å°† TiDB çš„ç›‘æ§èåˆåˆ°å°ç±³å…¬å¸å¼€æºçš„ç›‘æ§ç³»ç»Ÿ Falcon ä¸­ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;h2&gt;&lt;b&gt;è‡´è°¢&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;éå¸¸æ„Ÿè°¢ TiDB å®˜æ–¹åœ¨è¿ç§»åŠä¸šåŠ¡ä¸Šçº¿æœŸé—´ç»™äºˆæˆ‘ä»¬çš„æ”¯æŒï¼Œä¸ºæ¯ä¸€ä¸ª TiDB äººä¸“ä¸šçš„ç²¾ç¥ã€åŠæ—¶è´Ÿè´£çš„å“åº”ç‚¹èµã€‚&lt;br&gt;&lt;br&gt;&lt;br&gt;æ›´å¤š TiDB ç”¨æˆ·å®è·µï¼š&lt;/p&gt;&lt;a href=&quot;https://www.pingcap.com/cases-cn/&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;v2-60ab5bd867c2434d70c957a02a2169e1&quot; data-image-width=&quot;1200&quot; data-image-height=&quot;1200&quot; data-image-size=&quot;ipico&quot;&gt;æ¡ˆä¾‹&lt;/a&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>ZoeyZhai</author>
<guid isPermaLink="false">2018-12-03-51472404</guid>
<pubDate>Mon, 03 Dec 2018 00:00:00 +0800</pubDate>
</item>
</channel>
</rss>
