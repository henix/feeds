<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:media="http://search.yahoo.com/mrss/">
<channel>
<title>川流不息</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/</link>
<description>分享量化投资技术与实证心得 北京量信投资管理有限公司是一家在中国基金业协会备案登记的专业私募基金管理人。本专栏作者石川是公司联合创始人。希望通过这个平台和各位小伙伴分享我们在量化投资领域的知识和心得。原创不易，请保护版权，请在获得授权后转载。已委托“维权骑士”(http://rightknights.com) 为进行维权行动。</description>
<language>zh-cn</language>
<lastBuildDate>Thu, 14 Mar 2019 19:12:50 +0800</lastBuildDate>
<item>
<title>还在对着一阶矩做因子择时？不妨试试二阶矩</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2019-03-13-59119233.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/59119233&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-1772aa9525ea895d89602eb7e124339c_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;摘要&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;Fergis et al. (2019) 提出防御性因子择时，使用三个维度的择时指标，有效降低因子投资组合在极端市场环境下的风险。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;1 引言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;因子择时（factor timing）是进行因子投资的人绕不过的课题，但如何择时才能在样本外取得更好的效果尚无定论。然而，这丝毫不影响人们对因子择时的热情，无论是学术界还是业界都对它进行了大量的实证研究。究其原因，只因择时成功能带来的收益太诱人。&lt;/p&gt;&lt;p&gt;在 2017 年 Jacobs Levy Center 的年会上，来自 State Street Global Advisors 的 Jennifer Bender 做了题为 The promises and pitfalls of factor timing 的报告（Bender et al. 2017）。下图正是来自该报告，它假想了在开天眼前提下，正确的因子择时（每次调仓时正确挑出下一期收益最高的因子）能够获得的超高收益。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-ac5e140c930d22cb3e0e6c0fa180baf4_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;988&quot; data-rawheight=&quot;686&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;988&quot; data-original=&quot;https://pic1.zhimg.com/v2-ac5e140c930d22cb3e0e6c0fa180baf4_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-ac5e140c930d22cb3e0e6c0fa180baf4_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;988&quot; data-rawheight=&quot;686&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;988&quot; data-original=&quot;https://pic1.zhimg.com/v2-ac5e140c930d22cb3e0e6c0fa180baf4_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-ac5e140c930d22cb3e0e6c0fa180baf4_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;这篇报告后被发表于 2018 年度 Journal of Portfolio Management（JPM）的 Quantitative Special Issue（Bender et al. 2018）。就因子择时这个问题，Bender et al. (2017, 2018) 是来自业界的比较客观的声音，值得仔细读一读。不过，它并不是本文的重点，所以对它的介绍到此结束。&lt;/p&gt;&lt;p&gt;在介绍本文的重点之前，再来看看两位大佬掐架（熟悉这段的朋友请跳过）：来自 Research Affiliates 的 Robert Arnott 以及来自 AQR 的 Cliff Asness。&lt;/p&gt;&lt;p&gt;自 2016 年以来，Robert Arnott 发表了一系列因子择时的文章，题目都非常“嚣张”，比如 Timing &#39;Smart Beta&#39; Strategies? Of Course! Buy Low, Sell High!（Arnott et al. 2016）和 Forecasting Factor and Smart Beta Returns (Hint: History Is Worse than Useless)（Arnott et al. 2017）。Arnott 提倡使用&lt;b&gt;因子估值（factor valuation）&lt;/b&gt;来择时 —— &lt;b&gt;当因子便宜的时候配置、当因子昂贵的时候搁置&lt;/b&gt;。Arnott 通过实证结果证明了其主张在主流的因子上都是有效的。&lt;/p&gt;&lt;p&gt;针对按估值进行因子择时是否靠谱这个问题，我和合伙人进行了激烈的探讨，最后得到的看法是：&lt;b&gt;在便宜时候配置因子等价于在整个多因子组合中提高了对价值因子的暴露；因为价值因子是有效的，因此如此“择时”自然有效。一旦未来价值因子失效，那么这种择时法会因为在其上的过高暴露而受损。&lt;/b&gt;因此，按估值择时是否合理、怎么才能更好的规避在价值因子上的暴露是需要进一步研究的问题。&lt;/p&gt;&lt;p&gt;如果说 Arnott et al. (2016) 这篇文章只是抛出了估值择时说，那么 Arnott et al. (2017) 则更是使用了 History is worse than useless 这样刺眼的标题直接抨击了因子择时中的另一思路 —— 按因子动量择时：&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;Selecting strategies or factors&lt;/i&gt; &lt;i&gt;&lt;b&gt;based on past performance&lt;/b&gt;, regardless of the length of the sample,&lt;/i&gt; &lt;i&gt;&lt;b&gt;will not help investors earn a superior return&lt;/b&gt;&lt;/i&gt; &lt;i&gt;and is actually more likely to hurt them. —— Arnott et al. (2017)&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;面对如此“挑衅”，另一位大佬 Asness 坐不住了，他在多个场合多次抨击了 Arnott 的观点。在 2017 年，Asness 领衔在 JPM 上发表了一篇题为 Contrarian Factor Timing is Deceptively Difficult（Asness et al. 2017） 的文章，回击了因子估值择时。该文的论点之一也是估值择时有效本质是因为价值因子有效：&lt;/p&gt;&lt;blockquote&gt;&lt;b&gt;&lt;i&gt;At first glance, valuation-based timing of styles appears promising, which is not surprising because it is a simple consequence of the efficacy of the value strategy itself.&lt;/i&gt;&lt;/b&gt; &lt;i&gt;Yet when the authors implement value timing in a multi-style framework that already includes the value style, they find somewhat disappointing results.&lt;/i&gt; &lt;b&gt;&lt;i&gt;Because value timing of factors is correlated to the standard value factor, it adds further value exposure.&lt;/i&gt;&lt;/b&gt;&lt;/blockquote&gt;&lt;p&gt;除此之外，在 JPM 2019 年度最新一期的 Quantitative Special Issue 上（全刊为因子投资专题），来自 AQR 的 Tarun Gupta 和 Bryan Kelly 发表了一篇题为 Factor Momentum Everywhere 的文章，指出在全球的 65 个选股因子上观察到了稳健的动量效应、通过动量择时可以显著提高收益：&lt;/p&gt;&lt;blockquote&gt;&lt;b&gt;&lt;i&gt;Factor momentum adds significant incremental performance&lt;/i&gt;&lt;/b&gt; &lt;i&gt;to investment strategies that employ traditional momentum, industry momentum, value, and other commonly studied factors.&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;这篇文章虽然不直接出自 Asness，但毕竟也是 AQR 出品，并作为 JPM 2019 因子投资特刊的首篇文章被放在了最醒目的位置，足见其地位。至于 Asness 怒怼 Arnott 的其他故事，我的好友徐杨在大作&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMjM5NzU3MDc1MA%3D%3D%26mid%3D2455723570%26idx%3D1%26sn%3D50a6cb1a6bd8bb7c1b7a05a2215e8bd7%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;《多因子策略的五大讨论》&lt;/a&gt;中有过生动的描述，颇为精彩。&lt;/p&gt;&lt;p&gt;毫无疑问，因子择时在因子投资中争议巨大。但本文无意加入这场争论，而是想介绍 JPM 2019 因子投资特刊中的另外一篇文章 —— &lt;b&gt;Defensive factor timing（防御性因子择时，下称 DFT）&lt;/b&gt;。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;2 防御性因子择时&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;无论是根据估值还是动量做因子择时，其核心都是想获得更高的收益。较简单多样化或风险平价等配置因子的方法，这些方法的难点在于必须判断因子收益率的一阶矩 —— 期望。然而外推猜收益谈何容易？正因如此，来自 BlackRock 的团队“另辟蹊径”，提出了防御性因子择时（Fergis et al. 2019）。它正是本节以及后面两小节要介绍的内容。&lt;/p&gt;&lt;p&gt;&lt;b&gt;防御性因子择时的目的是降低风险。&lt;/b&gt;与一般的因子择时预测因子收益率不同，DFT 关注的是因子收益率的二阶矩及高阶矩，即风险。&lt;b&gt;当市场整体风险偏好骤降、不同因子之间相关性显著上升、以及单因子变得极度昂贵时，防御性因子择时主动降低因子投资组合的仓位，以此减少资产损失。&lt;/b&gt;Fergis et al. (2019) 同时指出，由于防御性因子择时的目的是规避巨大的市场风险，因此它对于因子投资组合仓位的调整也注定是一个低频事件。&lt;/p&gt;&lt;p&gt;Fergis et al. (2019) 的另外一个不同之处是，它关注的不单单是我们常说的股票市场中的因子（本文第一节中提到的那些文献以及大佬掐架针对的也主要是股票中的风格因子）。&lt;b&gt;相反的，Fergis et al. (2019) 着眼于不同类资产（股票、债券、商品、房地产等）所暴露在的风险因子上。&lt;/b&gt;具体的，Fergis et al. (2019) 一文考虑了 14 类资产：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-438706e266cba802e807ddf0c15fc353_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;950&quot; data-rawheight=&quot;700&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;950&quot; data-original=&quot;https://pic4.zhimg.com/v2-438706e266cba802e807ddf0c15fc353_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-438706e266cba802e807ddf0c15fc353_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;950&quot; data-rawheight=&quot;700&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;950&quot; data-original=&quot;https://pic4.zhimg.com/v2-438706e266cba802e807ddf0c15fc353_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-438706e266cba802e807ddf0c15fc353_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;如何确定这些不同类资产所背后共同的因子呢？最直接的办法是进行 PCA。考虑到通过统计手段找到的因子缺乏必要的经济学解释，Fergis et al. (2019) 追随 Chen, Roll and Ross (1986) 的思路、选用宏观经济指标作为这些资产所面对的共同风险因子。这些指标包括：经济增长、实际利率、通胀、信贷、新兴市场以及流动性。使用宏观经济因子的好处是：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;宏观经济能够在很大程度上解释大类资产收益率的波动；&lt;/li&gt;&lt;li&gt;长期来看，由于宏观经济因子代表系统性风险，它们都存在风险溢价；&lt;/li&gt;&lt;li&gt;这些因子背后有很强的经济学逻辑。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;然而，使用宏观经济因子必须面对的一个问题是这些因子的风险以及收益是无法直接被观测到的（比如我们没法说 GDP 增长的收益是多少）。为了解决这个难题，就不得不请出因子投资中的一个重要概念：&lt;b&gt;Factor Mimicking Portfolio&lt;/b&gt;。&lt;/p&gt;&lt;p&gt;当风险因子是诸如宏观经济指标的时候，由于无法直接衡量其波动或者收益，需要使用适当的资产构建出一个多、空对冲的投资组合，使其在该因子上的暴露最纯粹，并利用这个投资组合的收益率和波动来衡量该因子的风险和收益。这个投资组合就称为 factor mimicking portfolio。针对六大宏观经济因子，Fergis et al. (2019) 构建的 factor mimicking portfolios 如下。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-9d15620e4ce54b4b0439812bf8d58e4d_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1079&quot; data-rawheight=&quot;512&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1079&quot; data-original=&quot;https://pic2.zhimg.com/v2-9d15620e4ce54b4b0439812bf8d58e4d_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-9d15620e4ce54b4b0439812bf8d58e4d_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1079&quot; data-rawheight=&quot;512&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1079&quot; data-original=&quot;https://pic2.zhimg.com/v2-9d15620e4ce54b4b0439812bf8d58e4d_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-9d15620e4ce54b4b0439812bf8d58e4d_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;下图显示了经济增长和实际利率两个宏观经济因子和它们各自的 factor mimicking portfolios 在时序上的相关性。不难看出，factor mimicking portfolios 很好的反映出这些因子的变化。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-f2f6889adfcd11289139175dbbab5966_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1171&quot; data-rawheight=&quot;402&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1171&quot; data-original=&quot;https://pic3.zhimg.com/v2-f2f6889adfcd11289139175dbbab5966_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-f2f6889adfcd11289139175dbbab5966_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1171&quot; data-rawheight=&quot;402&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1171&quot; data-original=&quot;https://pic3.zhimg.com/v2-f2f6889adfcd11289139175dbbab5966_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-f2f6889adfcd11289139175dbbab5966_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;使用以上六大宏观经济指标的 factor mimicking portfolios 作为待配置的因子，Fergis et al. (2019) 进行了防御性因子择时的实证研究。作为配置基准，Fergis et al. (2019) 将最终的投资组合年化波动率限制在 10%，并按照以下方案配置了这六个因子、构建了多因子组合：经济增长和实际利率两个因子各贡献 30% 的风险、其余四个因子各贡献 10% 的风险。&lt;/p&gt;&lt;p&gt;下面就来看看 Fergis et al. (2019) 用来描述极端风险的择时指标。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;3 择时指标&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;极端市场风险来自三个方面：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;市场风险偏好的骤降；&lt;/li&gt;&lt;li&gt;不同因子之间的相关性激增、从而无法实现预期的分散化；&lt;/li&gt;&lt;li&gt;个别因子变得极度昂贵。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;Fergis et al. (2019) 使用不同的指标来监测上述风险。当前两种极端风险之一出现时，因子投资组合的整体仓位减少 20% 以降低风险可能造成的大幅回撤；当第三种风险出现时，投资组合会在该因子上进行 5% 的减仓。虽然 Fergis et al. (2019) 也考虑了因子估值，但是它并没有主张当某个因子便宜时为其加仓，而仅是把它当做抵御风险的手段。&lt;/p&gt;&lt;p&gt;从 Fergis et al. (2019) 提出的框架来看，前两种风险对于防御性因子择时的重要性远超过因子估值本身。因此下文着重介绍它们。对于因子估值，请参考 Fergis et al. (2019) ，本文不再赘述。&lt;/p&gt;&lt;p&gt;首先来看看市场风险偏好。Fergis et al. (2019) 使用前述 14 种资产的波动率和收益率计算秩相关系数（rank correlation coefficient），以此构建了一个 &lt;b&gt;Risk Tolerance Indicator（RTI）&lt;/b&gt;。这背后的依据是：&lt;b&gt;市场风险偏好的高、低可以由不同资产的收益率和它的风险水平的一致程度所反应。&lt;/b&gt;当风险偏好高时，高风险资产应该比低风险资产有更高的收益率；当风险偏好低时，高风险资产应比低风险资产有更大的跌幅。秩相关系数的优势是考察两个变量（这里是收益率和波动率）的单调相关性，而不假设变量之间的线性或非线性关系。&lt;/p&gt;&lt;p&gt;令 q(R) 和 q(σ) 分别代表不同资产收益率和波动率的排序序列，则 RTI 的定义为：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BRTI%7D%3D%5Cmbox%7Bcorr%7D%5Cleft%28q%28R%29%2Cq%28%5Csigma%29%5Cright%29&quot; alt=&quot;\mbox{RTI}=\mbox{corr}\left(q(R),q(\sigma)\right)&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;&lt;b&gt;根据定义，RTI 的取值范围是 -1 到 1 之间，越大说明风险偏好越高、越低说明风险容忍度越低。&lt;/b&gt;使用秩相关系数来描述市场情绪并不是什么新鲜事物，很多国内外的研究报告中都对它进行过充分的说明（&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzIyMDEwNDk1Mg%3D%3D%26mid%3D2650877127%26idx%3D1%26sn%3D141d7d447c25d5764f987d4a87f4c269%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;例子&lt;/a&gt;）。在实证中，Fergis et al. (2019) 采用 14 种资产滚动三个月的周频收益率计算 RTI。下图为 RTI 和 MSCI World Index 一年滚动收益率之间的关系，RTI 在 2008 年金融危机和 2010、2012 年欧洲主权债务危机时都给出了明确的警示信号。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-4a168375c899d290b1644a657ae9d6b5_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;973&quot; data-rawheight=&quot;650&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;973&quot; data-original=&quot;https://pic2.zhimg.com/v2-4a168375c899d290b1644a657ae9d6b5_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-4a168375c899d290b1644a657ae9d6b5_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;973&quot; data-rawheight=&quot;650&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;973&quot; data-original=&quot;https://pic2.zhimg.com/v2-4a168375c899d290b1644a657ae9d6b5_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-4a168375c899d290b1644a657ae9d6b5_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;再来看看相关性。为了监控因子之间相关性激增的风险，Fergis et al. (2019) 使用了&lt;b&gt;Diversification Ratio&lt;/b&gt;（DR）这个概念，它是各因子自身波动率按其权重的加权与投资组合波动率之比：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BDiversification+Ratio%7D%3D%5Cdisplaystyle%5Cfrac%7B%5Csum+w_i%5Csigma_i%7D%7B%5Csigma_p%7D&quot; alt=&quot;\mbox{Diversification Ratio}=\displaystyle\frac{\sum w_i\sigma_i}{\sigma_p}&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;&lt;b&gt;由定义可知，DR 越大说明因子之间的相关性越低，越能够分散化风险；越小则意味着因子之间的相关性上升。&lt;/b&gt;在实证期内，DR 和某个代表性的 20/80 stock/bond portfolio 的时序如下图所示。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-00933831aaadab9cf9d060b6c506c4a7_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1062&quot; data-rawheight=&quot;657&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1062&quot; data-original=&quot;https://pic4.zhimg.com/v2-00933831aaadab9cf9d060b6c506c4a7_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-00933831aaadab9cf9d060b6c506c4a7_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1062&quot; data-rawheight=&quot;657&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1062&quot; data-original=&quot;https://pic4.zhimg.com/v2-00933831aaadab9cf9d060b6c506c4a7_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-00933831aaadab9cf9d060b6c506c4a7_b.jpg&quot;&gt;&lt;/figure&gt;&lt;h2&gt;&lt;b&gt;4 择时案例&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;Fergis et al. (2019) 使用提出的三类择时指标 —— RTI、DR 以及因子估值 —— 介绍了四个防御性因子择时案例（下图）。本小节介绍其中的两个，即 Euro Crisis 2 和 Taper Tantrum。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-f787de95f0ed1400434f7abc4753a2c7_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;967&quot; data-rawheight=&quot;602&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;967&quot; data-original=&quot;https://pic4.zhimg.com/v2-f787de95f0ed1400434f7abc4753a2c7_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-f787de95f0ed1400434f7abc4753a2c7_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;967&quot; data-rawheight=&quot;602&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;967&quot; data-original=&quot;https://pic4.zhimg.com/v2-f787de95f0ed1400434f7abc4753a2c7_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-f787de95f0ed1400434f7abc4753a2c7_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;先来看看“Euro Crisis 2”。&lt;/p&gt;&lt;p&gt;2012 年 Q2，由希腊和西班牙引发的一系列问题使得全球市场的神经极度紧绷。RTI 指标从四月底的 20% 骤降至六月中旬的 -60%。在这种大环境下，防御性因子择时自 2012 年五月将多因子投资组合的仓位下降 20%，直至同年八月 RTI 恢复到 0% 的水平才重新提高到之前的仓位。在市场极度动荡的四个月内，该主动风控将投资组合的最大回撤从 -1.9% 降低至 -1.5%。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-78ca103d59345253c58e40e9121a9f21_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;794&quot; data-rawheight=&quot;435&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;794&quot; data-original=&quot;https://pic2.zhimg.com/v2-78ca103d59345253c58e40e9121a9f21_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-78ca103d59345253c58e40e9121a9f21_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;794&quot; data-rawheight=&quot;435&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;794&quot; data-original=&quot;https://pic2.zhimg.com/v2-78ca103d59345253c58e40e9121a9f21_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-78ca103d59345253c58e40e9121a9f21_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;再来看看“Taper Tantrum”。&lt;/p&gt;&lt;p&gt;2013 年夏天，时任美联储主席伯南克宣布美联储将会逐渐削减（taper）购债规模。听到这个消息后，投资者开始疯狂抛售债券、债市收益率大幅上行，而债券价格的下跌也传导到其他资产，导致不同类资产的下跌。这一事件被称为“减码恐慌”（taper tantrum）。&lt;/p&gt;&lt;p&gt;在这期间，RTI 指标却意外没有任何表示。所幸的是，DR 指标发挥了作用。它的急跌显示出因子之间的相关性迅速提升，从而启动了防御性因子择时。自 2013 年六月，多因子投资组合的仓位被降低 20% 以抵御风险，直至同年九月 DR 恢复到之前的水平，仓位才提高到基准水平。在这期间，防御性因子择时将投资组合的回撤从 -9.5% 降低至 -7.3%。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-83fc49b34449039e60ca3fe65480eab6_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;789&quot; data-rawheight=&quot;442&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;789&quot; data-original=&quot;https://pic3.zhimg.com/v2-83fc49b34449039e60ca3fe65480eab6_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-83fc49b34449039e60ca3fe65480eab6_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;789&quot; data-rawheight=&quot;442&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;789&quot; data-original=&quot;https://pic3.zhimg.com/v2-83fc49b34449039e60ca3fe65480eab6_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-83fc49b34449039e60ca3fe65480eab6_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;这个例子不仅说明 DR 指标在抵御风险时的作用，更说明了&lt;b&gt;同时使用多个低相关的风控指标对于抵御风险至关重要&lt;/b&gt;。如果模型中仅有 RTI，它将无法捕捉 Taper Tantrum 事件。&lt;/p&gt;&lt;p&gt;以上就是对 Fergis et al. (2019) 一文的简要解读。简单总结一下：&lt;b&gt;它使用六个宏观经济因子来刻画 14 类资产收益率的共同的变化，再结合三个角度的择时指标对这六个因子进行防御性择时，最终的目的是在市场极端风险出现时有效降低多因子投资组合的损失。&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;5 结语&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;读过 Fergis et al. (2019) 之后，我最大的感触就是大写的两个字：实用。&lt;/p&gt;&lt;p&gt;这篇文章中并没有高深的数学 —— RTI、DR 这些指标的计算方法都很简单、也早已被用在不同的投资实践中。然而，和 Bender et al. (2017, 2018) 一样，Fergis et al. (2019) 也让我们看到海外顶级机构是如何站在实践的角度进行因子择时的研究。&lt;/p&gt;&lt;p&gt;除此之外，该文的“实用性”还表现在以下两个方面。&lt;/p&gt;&lt;p&gt;首先是针对不同宏观经济指标构建的 factor mimicking portfolios。通过对这些投资组合收益和风险的追踪，可以有效的评价宏观经济风险，从而帮助我们进行风险控制。&lt;/p&gt;&lt;p&gt;第二点是该文做因子择时的出发点是对大类资产进行风险控制。如今，因子投资早已深入人心，而&lt;b&gt;因子的概念也早已从狭隘的选股指标上升到进行大类资产配置的有效手段&lt;/b&gt;。最近，MSCI 就高调推出了 Multi-Asset Class Factor Model（MAC），指导从战略和战术层面进行不同目的的资产配置，而 MAC 模型的 Tier 1 因子既包括传统意义上的 Equity、Commodity 大类资产也包括像利率、通胀等这些导致资产收益率共同波动的宏观驱动因素。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-d875da5e998b5fac98cca4cbc3e3fa09_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;872&quot; data-rawheight=&quot;517&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;872&quot; data-original=&quot;https://pic2.zhimg.com/v2-d875da5e998b5fac98cca4cbc3e3fa09_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-d875da5e998b5fac98cca4cbc3e3fa09_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;872&quot; data-rawheight=&quot;517&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;872&quot; data-original=&quot;https://pic2.zhimg.com/v2-d875da5e998b5fac98cca4cbc3e3fa09_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-d875da5e998b5fac98cca4cbc3e3fa09_b.jpg&quot;&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-356d62cf8f0d7a94702e04028f837bf6_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;918&quot; data-rawheight=&quot;232&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;918&quot; data-original=&quot;https://pic3.zhimg.com/v2-356d62cf8f0d7a94702e04028f837bf6_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-356d62cf8f0d7a94702e04028f837bf6_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;918&quot; data-rawheight=&quot;232&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;918&quot; data-original=&quot;https://pic3.zhimg.com/v2-356d62cf8f0d7a94702e04028f837bf6_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-356d62cf8f0d7a94702e04028f837bf6_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;广义的大类资产因子配置已经成为投资界的主流；&lt;b&gt;越来越多的机构在资产配置时不再仅关注资产的类别，而是聚焦于资产收益背后的不同驱动因素&lt;/b&gt;（比如债券不再被当作一个固定收益资产类别，而是被视作在 interest rate、credit、以及 inflation 因子上有不同的暴露和行为） —— 那些才是真正的因子，比如本文中的六个宏观经济因子，以及 MSCI MAC 模型中的 Tier 1。这将凸显防御性因子择时的价值。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;参考文献&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Arnott, R. D., N. Beck, V. Kalesnik, and J. West (2016). Timing &#39;Smart Beta&#39; Strategies? Of Course! Buy Low, Sell High! &lt;i&gt;Available at SSRN: &lt;a href=&quot;http://link.zhihu.com/?target=https%3A//ssrn.com/abstract%3D3040956&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;ssrn.com/abstract=30409&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;56&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/i&gt;.&lt;/li&gt;&lt;li&gt;Arnott, R. D., N. Beck, V. Kalesnik (2017). Forecasting Factor and Smart Beta Returns (Hint: History Is Worse than Useless). &lt;i&gt;Available at SSRN: &lt;a href=&quot;http://link.zhihu.com/?target=https%3A//ssrn.com/abstract%3D3040953&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;ssrn.com/abstract=30409&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;53&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/i&gt;.&lt;/li&gt;&lt;li&gt;Asness, C., S. Chandra, A. Ilmanen, and R. Israel (2017). Contrarian factor timing is deceptively difficult. &lt;i&gt;Journal of Portfolio Management&lt;/i&gt;, Special QES Issue, Vol. 43(5), 72 – 87.&lt;/li&gt;&lt;li&gt;Bender, J., X. Sun, R. Thomas, and V. Zdorovtsov (2017). &lt;i&gt;The promises and pitfalls of factor timing&lt;/i&gt;. Jacobs Levy Equity Management Center 2017 Conference.&lt;/li&gt;&lt;li&gt;Bender, J., X. Sun, R. Thomas, and V. Zdorovtsov (2018). The promises and pitfalls of factor timing. &lt;i&gt;Journal of Portfolio Management&lt;/i&gt;, Quantitative Special Issue, Vol. 44(4), 79 – 92.&lt;/li&gt;&lt;li&gt;Chen, N., R. Roll, and S. A. Ross (1986). Economic forces and the stock market. &lt;i&gt;Journal of Business&lt;/i&gt;, Vol. 59(3), 383 – 403.&lt;/li&gt;&lt;li&gt;Fergis, K., K. Gallagher, P. Hodges, and K. Hogan (2019). Defensive factor timing. &lt;i&gt;Journal of Portfolio Management&lt;/i&gt;, Quantitative Special Issue, Vol. 45(3), 50 – 68.&lt;/li&gt;&lt;li&gt;Gupta, T. and B. Kelly (2019). Factor momentum everywhere. &lt;i&gt;Journal of Portfolio Management&lt;/i&gt;, Quantitative Special Issue, Vol. 45(3), 13 – 36.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处，谢谢。已委托“维权骑士”(&lt;a href=&quot;http://link.zhihu.com/?target=http%3A//rightknights.com/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;维权骑士_免费版权监测/版权保护/版权分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2019-03-13-59119233</guid>
<pubDate>Wed, 13 Mar 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>Anomalies, Factors, and Multi-Factor Models</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2019-03-08-56614427.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/56614427&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-0407c08c16c0b0bd0fc406cbc0a0f6e7_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;摘要&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;本文解释了异象、因子以及多因子模型的区别和联系；梳理了从异象到因子再到模型背后的逻辑；介绍了学术界研究多因子模型的主流统计手段。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;1 引言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;在 empirical asset pricing 和 factor investing 中，anomalies（异象）、factors（因子）以及 multi-factor models（多因子模型）是三个常见的概念。从这些概念出发又能很自然的引发出一系列问题：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;什么是 anomalies；什么是 factors？&lt;/li&gt;&lt;li&gt;Anomalies 和 factors 有什么区别？&lt;/li&gt;&lt;li&gt;一个 multi-factor model 中应该包含多少个 factors？&lt;/li&gt;&lt;li&gt;学术界有哪些主流的 multi-factor models？&lt;/li&gt;&lt;li&gt;如何比较并在不同的 multi-factor models 之间取舍？&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;在过去几十年里，海外学术界对上述问题进行了大量的探索，留下了很多宝贵的实证结果和分析手段。而对于像你、我一样进行因子投资的投资者来说，搞清楚这些问题对于构建系统和全面的因子投资分析体系至关重要。本文试图回答上述五个问题。&lt;/p&gt;&lt;p&gt;在开始之前，先来唠两句标题。这是我第一次使用纯英文标题，倒是也没有什么特别的原因。对于文章标题，我一贯的看法是杜绝惊世骇俗，只求言简意赅、切中要害，再有就是“读来有感觉”。本文的标题翻译中文是“异象、因子和多因子模型”，实在平淡无奇，所以就索性用英文了。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;2 Anomalies&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;多因子模型是 empirical asset pricing 的一种常见方法；其研究的核心问题是找到一组能够解释股票预期收益率截面差异的因子（见&lt;a href=&quot;https://zhuanlan.zhihu.com/p/40984029&quot; class=&quot;internal&quot;&gt;《股票多因子模型的回归检验》&lt;/a&gt;）。&lt;b&gt;假使我们根据基本面特征或量价指标（或 whatever，下面统称为特征）挑选出一揽子股票并构建多空投资组合；如果该组合的收益率无法被用于 asset pricing 的多因子模型解释，则称该特征为一个异象（anomaly）。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;在数学上，这意味着该组合有模型无法解释的 α 收益率：以使用该特征构建的多空组合收益率为被解释变量放在回归方程的左侧，以多因子模型中因子收益率为解释变量放在回归方程的右边，进行时序回归，回归的截距项就是 α 收益率；如果 α 显著不为零，则说明该特征是一个异象。&lt;/p&gt;&lt;p&gt;举个例子。&lt;a href=&quot;https://zhuanlan.zhihu.com/p/44781908&quot; class=&quot;internal&quot;&gt;《获取 α 的新思路：科技关联度》&lt;/a&gt;一文介绍了 Lee et al. (2018) 这篇文章；使用科技关联度选股的多空对冲投资组合获得了主流多因子模型无法解释的 α 收益率（下图），因此它是一个异象。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-5519afc0bf7c026e91e6256824566154_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;845&quot; data-rawheight=&quot;362&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;845&quot; data-original=&quot;https://pic1.zhimg.com/v2-5519afc0bf7c026e91e6256824566154_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-5519afc0bf7c026e91e6256824566154_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;845&quot; data-rawheight=&quot;362&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;845&quot; data-original=&quot;https://pic1.zhimg.com/v2-5519afc0bf7c026e91e6256824566154_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-5519afc0bf7c026e91e6256824566154_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;从有效市场假说的观点出发，市场中不应该存在很多异象。当然，有效市场假说并不完美，再加上学术界几十年来的“不懈努力”，针对美股挖掘出了 400+ 个异象，这些异象在样本内的统计检验中都获得了很高的 t-statistics。&lt;/p&gt;&lt;p&gt;产生如此多的异象主要有两个原因：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;b&gt;第一个也是最主要的一个原因是数据挖掘。&lt;/b&gt;在 &lt;a href=&quot;https://zhuanlan.zhihu.com/p/38663777&quot; class=&quot;internal&quot;&gt;p-hacking&lt;/a&gt; 的激励和 multiple testing 的盛行下，大量所谓的异象在样本内被挖出。Harvey, Liu and Zhu (2016) 研究了学术界发表的 316 个所谓显著异象，并指出再考虑了 multiple testing 的影响后，异象收益率的 t-statistic 至少要超过 3.0（而非人们传统认为的 5% 的显著性水平对应的 2.0）才有可能是真正有效、而非来自运气。&lt;/li&gt;&lt;li&gt;&lt;b&gt;第二个原因和回归方程右侧的定价模型有关。&lt;/b&gt;比如，如果仅以 CAPM 为定价模型，那么很多异象都能获得 CAPM 无法解释的 α 收益率；随着定价模型中因子个数的增加，更多的异象变得不再显著。然而，真正的定价模型是未知的。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;谈及对异象的研究，不能不提的一篇文章是 Hou, Xue and Zhang (2017)。这篇长达 146 页的文章惊人的复现了学术界提出的 447 个异象，涵盖动量（57个）、价值/成长（68个）、投资（38个）、盈利（79个）、无形资产（103个）、以及交易摩擦（102个）六大类。下图节选了少量动量类异象说明，感受一下。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-b0faff0a4828608a0306b2d3ff94c2ae_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;718&quot; data-rawheight=&quot;670&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;718&quot; data-original=&quot;https://pic3.zhimg.com/v2-b0faff0a4828608a0306b2d3ff94c2ae_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-b0faff0a4828608a0306b2d3ff94c2ae_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;718&quot; data-rawheight=&quot;670&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;718&quot; data-original=&quot;https://pic3.zhimg.com/v2-b0faff0a4828608a0306b2d3ff94c2ae_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-b0faff0a4828608a0306b2d3ff94c2ae_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;对于这 447 个异象，当排除了微小市值股票的影响后，其中 286 个（64%）不再显著（在 5% 的显著性水平下，下同）；如果按照 Harvey, Liu and Zhu (2016) 的建议把 t-statistic 阈值提升到 3.0，则其中 380 个（85%）异象不再显著；最后，如果使用 Hou, Xue and Zhang (2015) 提出的 4 因子模型作为定价模型，那么其中 436 个（98%）异象不再显著，剩余存活的仅有 11 个。&lt;/p&gt;&lt;p&gt;好一个数据挖掘！&lt;/p&gt;&lt;p&gt;除此之外，Linnainmaa and Roberts (2018) 花费了很大的经历构建了全新的样本外数据，研究了美股中源于会计数据的 36 个异象在样本内、外的表现的差异。分析表明，绝大部分异象在样本外明显失效，它们的失效说明这些异象并非来自未知风险以及错误定价这两种解释，而更有可能仅仅是数据挖掘的产物。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;3 Factors&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;上一节介绍了异象，本节就来看看什么是因子（factors）。&lt;b&gt;一个异象是可能成为一个优秀因子的；然而由于异象之间的相关性，并不是所有异象都是因子。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;一个因子应该能够对解释资产（可以是个股也可以是个股组成的投资组合）预期收益率的截面差异有显著的增量贡献。如果异象满足上述条件，它就可以被称之为一个因子。&lt;/b&gt;在这个定义中，有两个关键词值得解读，它们是“解释”和“增量贡献”：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;“解释”说明这个异象（或者潜在因子）已经从回归方程的左侧移到了回归方程的右侧，它被用来当作解释变量来对资产的收益率做回归，考察它是否能够解释预期收益率的截面差异。&lt;/li&gt;&lt;li&gt;“增量贡献”暗示着同时考虑多个异象（因子）时，由于它们之间不完全独立，需要排除相关性的影响。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;举个例子。我们知道价值因子是一个靠谱的选股因子。然而，很多指标 —— 比如 E/P 或 B/P 都可以用来构建价值因子的 High-Minus-Low 组合。如果同时基于 E/P 和 B/P 构建了 HML_EP 和 HML_BP 两个因子，它们之间的相关性注定是非常高的。一旦选择了其中之一作为价值因子，另一个对于资产预期收益率截面差异解释能力的增量贡献就不再显著、无法成为因子。&lt;/p&gt;&lt;p&gt;&lt;b&gt;从资产定价的理论角度来说，多因子模型中的因子之间应尽可能独立；&lt;/b&gt;但是从投资实践来说，上面例子中的 E/P 和 B/P 可以被同时使用构建一个 HML 价值因子，这有助于降低波动且增加因子的鲁棒性。&lt;/p&gt;&lt;p&gt;&lt;b&gt;在从一揽子异象中筛选因子时，常见的做法是将它们同时作为回归分析中的解释变量，采用 Fama-MacBeth Regression（Fama and MacBeth 1973）来分析这些异象的收益率是否显著。&lt;/b&gt;在这方面，Green, Hand and Zhang (2017) 是一个很好的例子。&lt;/p&gt;&lt;p&gt;Green, Hand and Zhang (2017) 使用 Fama-MacBeth Regression 同时检验 94 个异象，并考虑了 multiple testing 对 t-statistic 以及 p-value 造成的影响，最终发现仅有 12 个异象可能成为潜在的因子：1. 账面市值比；2. 现金；3. 分析师数量的变化；4. 盈余公告宣告收益；5. 一个月的动量；6. 六个月动量的变化；7. 盈利同比增长的季度数量；8. 年度研发支出占市值的比重；9. 收益波动性；10. 股票换手率；11. 股票换手率的波动性；12. 零交易的天数。&lt;/p&gt;&lt;p&gt;上述结果告诉我们：&lt;b&gt;在修正 multiple testing 的数据挖掘、以及考察了不同异象的相关性之后，真正能够解释资产预期收益率截面差异的独立因子少之又少。&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;4 Multi-Factor Models&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;现在我们已经了解了异象，并通过回归分析从异象中找出了因子，接下来就是挑选因子构建多因子模型了。在构建多因子模型时，两个必须要回答的问题是：（1）选择多少个因子合适？（2）选择哪些因子更好？学术界对于第一个问题的共识为主流因子模型奠定了基调；而第二个问题则涉及不同多因子模型之间的比较。&lt;/p&gt;&lt;p&gt;对于第一个问题，我们总可以仅使用一个因子，比如 CAPM 模型仅使用了市场因子；又或者我们可以使用许多因子。一个极端的情况是把每个上市公司作为一个因子，每个公司的股票只在自己公司的因子上有暴露，在代表其他公司的因子上零暴露。这样的模型显然能完美解释股票预期收益率的截面差异，但在现实中没人会那么用。以样本内过拟合为代价，更多的因子总能更好的解释收益率的截面差异。&lt;/p&gt;&lt;p&gt;在学术界，“几个因子合适”这个问题所遵循的准则是 &lt;b&gt;The Law of Parsimony（简约法则）&lt;/b&gt;，它还有一个更为人熟知的名字 —— Occam’s razor（奥卡姆剃刀）。&lt;b&gt;如果从 ICAPM（Intertemporal CAPM）的角度来理解多因子模型，每个因子代表某种 state variable；而 state variable 是投资者想要对冲的某种风险。&lt;/b&gt;从这个意义上说，因子的个数应该是有限的。&lt;/p&gt;&lt;p&gt;依据简约法则，学术界主流的多因子模型包括以下几个（按时间顺序、排名不分先后，不完整 list），它们的因子个数均在 3 到 5 个之间：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;Fama-French 三因子模型（Fama and French 1993）：&lt;/b&gt;多因子模型的开山鼻祖，包括 MKT，HML 以及 SMB 三因子。&lt;/li&gt;&lt;li&gt;&lt;b&gt;Carhart 四因子模型（Carhart 1997）：&lt;/b&gt;在 Fama-French 三因子模型上加上了动量 MOM 因子。&lt;/li&gt;&lt;li&gt;&lt;b&gt;Novy-Marx 四因子模型（Novy-Marx 2013）：&lt;/b&gt;包含 MKT，HML，MOM 以及 PMU 四个因子；其中 PMU 所用的财务指标是 Gross Profit-to-Asset，代表 profitability 维度。&lt;/li&gt;&lt;li&gt;&lt;b&gt;Fama-French 五因子模型（Fama and French 2015）：&lt;/b&gt;Fama 和 French 在其三因子模型的基础上加入了 CMA 和 RMW 两个因子，分别代表 investment 和 profitability 两个维度。&lt;/li&gt;&lt;li&gt;&lt;b&gt;Hou-Xue-Zhang 四因子模型（Hou, Xue and Zhang 2015）：&lt;/b&gt;包含 MKT，SMB，IVA 以及 ROE；其中 IVA 是 total assets 的年增长率，代表 investment 维度。&lt;/li&gt;&lt;li&gt;&lt;b&gt;Stambaugh-Yuan 四因子模型（Stambaugh and Yuan 2016）：&lt;/b&gt;包含 MKT，SMB，MGMT 和 PERF 四个因子。MGMT 和 PERF 分别使用了 6 个和 5 个指标，代表和 management 以及 performance 相关的两个 mispricing 因子。虽然该模型只有四个因子，但它用到的基本面和量价指标多达 12 个。&lt;/li&gt;&lt;li&gt;&lt;b&gt;Daniel-Hirshleifer-Sun 三因子模型（Daniel, Hirshleifer and Sun 2018）：&lt;/b&gt;在 MKT 的基础上，使用 PEAD 和 FIN 两个指标作为短期和长期行为因子（behavioral factors）的代理指标，构建了三因子模型。该模型由于包括了传统的 MKT 风险因子，又包括行为因子，故称为复合模型。&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;如何比较不同的多因子模型呢？学术界主要有以下三种方法：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;GRS tests；&lt;/li&gt;&lt;li&gt;Mean-Variance Spanning tests；&lt;/li&gt;&lt;li&gt;Bayesian approach。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;b&gt;GRS tests&lt;/b&gt;（Gibbons, Ross and Shanken 1989）检验 n 个资产在给定因子模型下的定价错误（pricing error）—— 即 α —— 是否在统计上联合为零（jointly equal to zero）。在比较两个多因子模型时，使用两个模型的因子互为资产和定价模型进行检验。&lt;/p&gt;&lt;p&gt;举个例子。&lt;a href=&quot;https://zhuanlan.zhihu.com/p/48728998&quot; class=&quot;internal&quot;&gt;《中国版的 Fama-French 三因子模型，了解一下？》&lt;/a&gt;一文中比较了两个不同版本的价值和市值因子的效果。结果（下表）显示，当使用 SMB 和 VMG 为因子模型时，FFSMB 和 FFHML 的定价错误可以认为是零（p-value = 0.41）；反过来，当使用 FFSMB 和 FFHML 为定价模型时，SMB 和 VMG 依然存在显著不为零的定价错误（p-value 是 10 的 -13 次方这个量级）。这意味着 SMB 和 VMG 优于 FFSMB 和 FFHML。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-470af865d5d487a8a7c9be6c0478dd5e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;591&quot; data-rawheight=&quot;275&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;591&quot; data-original=&quot;https://pic3.zhimg.com/v2-470af865d5d487a8a7c9be6c0478dd5e_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-470af865d5d487a8a7c9be6c0478dd5e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;591&quot; data-rawheight=&quot;275&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;591&quot; data-original=&quot;https://pic3.zhimg.com/v2-470af865d5d487a8a7c9be6c0478dd5e_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-470af865d5d487a8a7c9be6c0478dd5e_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;Mean-Variance Spanning tests&lt;/b&gt; 考察 n 个已知资产构建的 mean-variance 有效前沿能否包含某个新资产（Huberman and Kandel 1987）。在比较两个多因子模型时，使用每个模型的因子构建有效前沿，并逐一检验其能否包含另一个模型中的因子。&lt;/p&gt;&lt;p&gt;举个例子。&lt;a href=&quot;https://zhuanlan.zhihu.com/p/51043407&quot; class=&quot;internal&quot;&gt;《美股上一个跨越时间尺度的趋势因子》&lt;/a&gt;介绍了一个新的趋势因子。考虑新的趋势因子和三个已有因子（SREV、MOM 以及 LREV）的回归模型如下：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+r_%7B%5Cmbox%7BTrend%7D%2Ct%7D%3D%5Calpha%2B%5Cbeta_1+r_%7B%5Cmbox%7BSREV%7D%2Ct%7D%2B%5Cbeta_2+r_%7B%5Cmbox%7BMOM%7D%2Ct%7D%2B%5Cbeta_3+r_%7B%5Cmbox%7BLREV%7D%2Ct%7D%2B%5Cepsilon_t&quot; alt=&quot;\displaystyle r_{\mbox{Trend},t}=\alpha+\beta_1 r_{\mbox{SREV},t}+\beta_2 r_{\mbox{MOM},t}+\beta_3 r_{\mbox{LREV},t}+\epsilon_t&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;该检验的 null hypothesis 是：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+%5Calpha%3D0%2C%7E%7E%7E%5Cbeta_1%2B%5Cbeta_2%2B%5Cbeta_3%3D1&quot; alt=&quot;\displaystyle \alpha=0,~~~\beta_1+\beta_2+\beta_3=1&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;检验结果显著的拒绝原假设，说明已有三因子无法解释新的趋势因子。&lt;/p&gt;&lt;p&gt;最后来看看 &lt;b&gt;Bayesian approach&lt;/b&gt;。假设比较两个多因子模型 M_1 和 M_2；相关数据集用 D 表示。令 prob(M_1) 和 prob(M_2) 为这两个模型的先验概率，且有 prob(M_1) + prob(M_2) = 1（这里假设把多个模型两两比较）。根据贝叶斯定理有：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+%5Cmbox%7Bprob%7D%28M_i%7CD%29%3D%5Cfrac%7B%5Cmbox%7Bprob%7D%28M_i%29%5Cmbox%7Bprob%7D%28D%7CM_i%29%7D%7B%5Cmbox%7Bprob%7D%28M_1%29%5Cmbox%7Bprob%7D%28D%7CM_1%29%2B%5Cmbox%7Bprob%7D%28M_2%29%5Cmbox%7Bprob%7D%28D%7CM_2%29%7D&quot; alt=&quot;\displaystyle \mbox{prob}(M_i|D)=\frac{\mbox{prob}(M_i)\mbox{prob}(D|M_i)}{\mbox{prob}(M_1)\mbox{prob}(D|M_1)+\mbox{prob}(M_2)\mbox{prob}(D|M_2)}&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;其中：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+%5Cmbox%7Bprob%7D%28D%7CM_i%29%3D%5Cint_%7B%5Ctheta_i%7D%5Cmbox%7Bprob%7D%28%5Ctheta_i%29%5Cmbox%7Bprob%7D%28D%7C%5Ctheta_i%29d%5Ctheta_i&quot; alt=&quot;\displaystyle \mbox{prob}(D|M_i)=\int_{\theta_i}\mbox{prob}(\theta_i)\mbox{prob}(D|\theta_i)d\theta_i&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;上式中，prob(θ_i) 是模型 i 参数的先验分布，prob(D|θ_i) 是模型 i 的似然函数。上述贝叶斯方法的核心在于确定 prob(θ_i)。根据 Pastor and Stambaugh (2000) 以及 Barillas and Shanken (2018) 的理论，它和以两个模型中的全部因子作为资产所构成的投资组合的预期最大夏普率的平方与市场夏普率的比值有关。&lt;/p&gt;&lt;p&gt;使用贝叶斯方法，Stambaugh and Yuan (2016) 比较了他们的四因子模型（记为 M-4）和 Fama-French 五因子模型（记为 FF-5）以及 Hou-Xue-Zhang 四因子模型（记为 q-4）。下图中，左图是 M-4 和 FF-5 模型的比较；右图是 M-4 和 q-4 模型的比较。图中，横坐标均为先验，即两模型中全部因子能达到的最大预期夏普率平方和市场夏普率的比值；纵坐标为不同模型的后验概率。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-3966327434e9fa7d3211397a37d79439_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1121&quot; data-rawheight=&quot;483&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1121&quot; data-original=&quot;https://pic2.zhimg.com/v2-3966327434e9fa7d3211397a37d79439_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-3966327434e9fa7d3211397a37d79439_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1121&quot; data-rawheight=&quot;483&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1121&quot; data-original=&quot;https://pic2.zhimg.com/v2-3966327434e9fa7d3211397a37d79439_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-3966327434e9fa7d3211397a37d79439_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;结果说明，当先验这个比值分别大于 1.05 和 1.2 的时候，M-4 因子模型就分别强于 FF-5 和 q-4 模型。显然，使用多个因子得到的最大夏普率很容易是市场夏普率的 1.05 或 1.2 倍，意味着数据更加倾向于支持 M-4 模型。&lt;/p&gt;&lt;p&gt;需要特别强调的是，无论采用哪种方法，比较多因子模型的目的是为了得到新的启发，而非一定要排个一二三四。&lt;b&gt;这些因子模型之间孰优孰劣并无定论，它们的提出丰富了我们对于 empirical asset pricing 的理解并指导着因子投资。&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;5 多因子模型复杂度的讨论&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;在结束本文之前，再来简单讨论下构建因子模型时遵循的 The Law of Parsimony。&lt;/p&gt;&lt;p&gt;在美国金融协会 2018 年的年会上，Daniel, Hirshleifer and Sun (2018) 报告了他们的复合因子模型，并对模型复杂度和模型的解释效果做了探讨，颇有新意。具体的，他们提出了两个 Parsimony Index，通过惩罚因子和用于构建因子的指标个数来计算模型复杂度。&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;b&gt;第一个 Parsimony Index = 零减去模型中所有因子使用的全部指标数之和；&lt;/b&gt;由此可知该 index 取值为负，越大（即越接近零）说明模型越简单。如果一个指标被用于多个因子中，则在计算该 index 时需要多次计算它。&lt;/li&gt;&lt;li&gt;&lt;b&gt;第二个 Parsimony Index = 零减去模型中的因子和指标个数之和；&lt;/b&gt;同上，该 index 取值为负，越大（即越接近零）说明模型越简单。它和前者的区别为：（1）除指标外，也考虑了对因子个数的惩罚；（2）如果某指标被用于多个因子中，其只被计算一次。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;按照上述定义，本文第四节介绍的主流因子模型的两个 Parsimony Index 取值分别为：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-4d384a3b6ae6ffc0ecd53fcb03fefa6b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;792&quot; data-rawheight=&quot;295&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;792&quot; data-original=&quot;https://pic4.zhimg.com/v2-4d384a3b6ae6ffc0ecd53fcb03fefa6b_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-4d384a3b6ae6ffc0ecd53fcb03fefa6b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;792&quot; data-rawheight=&quot;295&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;792&quot; data-original=&quot;https://pic4.zhimg.com/v2-4d384a3b6ae6ffc0ecd53fcb03fefa6b_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-4d384a3b6ae6ffc0ecd53fcb03fefa6b_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;使用上述 7 个因子模型来检验 34 个异象，根据 5% 显著性水平下显著的异象的个数以及所有异象的平均 α 收益率的绝对值分别作为模型解释力度，最后将模型解释力度和这两个 Parsimony Index 分别做回归以观察解释度和模型复杂度之间的关系。结果如下。&lt;/p&gt;&lt;p&gt;以 5% 显著性水平的异象个数作为解释力度：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-9667517a288bbfdeae72203c5357e336_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;804&quot; data-rawheight=&quot;344&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;804&quot; data-original=&quot;https://pic3.zhimg.com/v2-9667517a288bbfdeae72203c5357e336_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-9667517a288bbfdeae72203c5357e336_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;804&quot; data-rawheight=&quot;344&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;804&quot; data-original=&quot;https://pic3.zhimg.com/v2-9667517a288bbfdeae72203c5357e336_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-9667517a288bbfdeae72203c5357e336_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;以全部异象平均 |α| 为解释力度：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-346c85705fed818ebe640f8934b5039b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;803&quot; data-rawheight=&quot;346&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;803&quot; data-original=&quot;https://pic4.zhimg.com/v2-346c85705fed818ebe640f8934b5039b_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-346c85705fed818ebe640f8934b5039b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;803&quot; data-rawheight=&quot;346&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;803&quot; data-original=&quot;https://pic4.zhimg.com/v2-346c85705fed818ebe640f8934b5039b_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-346c85705fed818ebe640f8934b5039b_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;随着模型复杂度的提升（表现为 Parsimony Index 的取值更小），模型的解释力度上升（体现为 5% 显著性下的异象变少和异象平均 |α| 降低）。&lt;/b&gt;这个结论符合预期，它也再次强调了不同因子模型之间的好坏并无定论 —— 我们总能通过增加模型复杂度来提升模型（样本内）的解释效果，因此需要在模型复杂度和样本内的解释力度之间取舍。&lt;/p&gt;&lt;p&gt;&lt;b&gt;在 The Law of Parsimony 的指导思想下，一个优秀的因子模型通常有较少的因子或者基本面或量价特征；而作为使用者，我们应该尽量搞清楚每一个因子背后代表的风险。&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;6 结语&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;这篇文章没有告诉你哪个异象能赚取 α。&lt;/p&gt;&lt;p&gt;这篇文章没有告诉你哪个因子能赚取高性价比的 β。&lt;/p&gt;&lt;p&gt;这篇文章也没有告诉你哪家的多因子模型更胜一筹。&lt;/p&gt;&lt;p&gt;OK, enough for “自我否定”。既然如此，为什么要写这篇文章呢？如今，学术论文和卖方报告中开发出新“因子”的速度已远超我能理解、消化的速度。以学术界的 447 个异象为例，如果每周写一篇介绍一个，要写 9 年。异象被当作“因子”来使用，但它背后往往没有合理的金融学解释（即无法代表合理的系统性风险），或者没有用已有因子对其分析从而评判它对解释股票预期收益率截面差异的增量贡献，仅仅是数据挖掘的产物。它们中大多数根本不是因子，甚至连异象都谈不上。出于这个原因，我希望能介绍一些方法，帮助因子投资的践行者去伪存真。这就是写作本文的初衷。&lt;/p&gt;&lt;p&gt;这篇文章回答了开篇提出的五个问题；解释了异象、因子以及多因子模型的区别和联系；梳理了从异象到因子再到模型，一步步使用多因子模型背后的逻辑；介绍了学术界在研究多因子时使用的主流统计手段。希望它能够作为一个完善的工具箱，为你的多因子研究和投资添一分助力。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;（全文完）&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;延伸阅读，其他有关因子投资的文章链接如下：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/40984029&quot; class=&quot;internal&quot;&gt;《股票多因子模型的回归检验》&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/52221111&quot; class=&quot;internal&quot;&gt;《解释股票截面预期收益差异的独立因子》&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/45371443&quot; class=&quot;internal&quot;&gt;《未知风险，错误定价，还是数据迁就？》&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/38663777&quot; class=&quot;internal&quot;&gt;《在追逐 p-value 的道路上狂奔，却在科学的道路上渐行渐远》&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/38315648&quot; class=&quot;internal&quot;&gt;《你用因子，他也用因子；你没赚钱，他却赚钱了》&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/56154663&quot; class=&quot;internal&quot;&gt;《出色不如走运 (III)？》&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/45715632&quot; class=&quot;internal&quot;&gt;《出色不如走运 (II)？》&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;参考文献&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Barillas, F. and J. Shanken (2018). Comparing asset pricing models. &lt;i&gt;Journal of Finance&lt;/i&gt;, Vol. 73(2), 715 – 754.&lt;/li&gt;&lt;li&gt;Carhart, M. M. (1997). On Persistence in Mutual Fund Performance. &lt;i&gt;Journal of Finance&lt;/i&gt;, Vol. 52(1), 57 – 82.&lt;/li&gt;&lt;li&gt;Daniel, K. D., D. A. Hirshleifer and L. Sun (2018). &lt;i&gt;Short- and long-horizon behavioral factors&lt;/i&gt;. Columbia Business School Research Paper No. 18-5. Available at SSRN: &lt;a href=&quot;http://link.zhihu.com/?target=https%3A//ssrn.com/abstract%3D3086063&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;ssrn.com/abstract=30860&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;63&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;.&lt;/li&gt;&lt;li&gt;Fama, E. F. and K. R. French (1993). Common Risk Factors in the Returns on Stocks and Bonds. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 33(1), 3 – 56.&lt;/li&gt;&lt;li&gt;Fama, E. F. and K. R. French (2015). A Five-Factor Asset Pricing Model. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 116(1), 1 – 22.&lt;/li&gt;&lt;li&gt;Fama, E. F. and J. D. MacBeth (1973). Risk, return, and equilibrium: empirical tests. &lt;i&gt;Journal of Political Economy&lt;/i&gt;, Vol. 81(3), 607 – 636.&lt;/li&gt;&lt;li&gt;Green, J., J. R. M. Hand and X. F. Zhang (2017). The characteristics that provide independent information about average U.S. monthly stock returns. &lt;i&gt;Review of Financial Studies&lt;/i&gt;, Vol. 30(12), 4389 – 4436.&lt;/li&gt;&lt;li&gt;Gibbons, M. R., S. A. Ross and J. Shanken (1989). A test of the efficiency of a given portfolio. &lt;i&gt;Econometrica&lt;/i&gt;, Vol. 57(5), 1121 – 1152.&lt;/li&gt;&lt;li&gt;Harvey, C. R., Y. Liu and H. Zhu (2016). … and the cross-section of expected returns. &lt;i&gt;Review of Financial Studies&lt;/i&gt;, Vol. 29(1), 5 – 68.&lt;/li&gt;&lt;li&gt;Hou, K., C. Xue and L. Zhang (2015). Digesting anomalies: An investment approach. &lt;i&gt;Review of Financial Studies&lt;/i&gt;, Vol. 28(3), 650 – 705.&lt;/li&gt;&lt;li&gt;Hou, K., C. Xue and L. Zhang (2017). &lt;i&gt;Replicating Anomalies&lt;/i&gt;. Fisher College of Business Working Paper No. 2017-03-010; Charles A. Dice Center Working Paper No. 2017-10. Available at SSRN: &lt;a href=&quot;http://link.zhihu.com/?target=https%3A//ssrn.com/abstract%3D2961979&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;ssrn.com/abstract=29619&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;79&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;.&lt;/li&gt;&lt;li&gt;Huberman G. and S. Kandel (1987). Mean-variance spanning. &lt;i&gt;Journal of Finance&lt;/i&gt;, Vol. 42(4), 873 – 888.&lt;/li&gt;&lt;li&gt;Lee, C. M. C., S. T. Sun, R. Wang and R. Zhang (2018). Technological Links and Return Predictability. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, forthcoming.&lt;/li&gt;&lt;li&gt;Linnainmaa, J. T. and M. R. Roberts (2018). The history of the cross-section of stock returns. &lt;i&gt;Review of Financial Studies&lt;/i&gt;, Vol. 31(7), 2606 – 2649.&lt;/li&gt;&lt;li&gt;Liu, J., R. F. Stambaugh and Y. Yuan (2018). Size and Value in China. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, forthcoming.&lt;/li&gt;&lt;li&gt;Novy-Marx, R. (2013). The other side of value: The gross profitability premium. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 108 (1), 1 – 28.&lt;/li&gt;&lt;li&gt;Pastor, L. and R. F. Stambaugh (2000). Comparing asset pricing models: an investment perspective. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 56(3), 335 – 381.&lt;/li&gt;&lt;li&gt;Stambaugh, R. F. and Y. Yuan (2016). Mispricing Factors. &lt;i&gt;Review of Financial Studies&lt;/i&gt;, Vol. 30(4), 1270 – 1315.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处，谢谢。已委托“维权骑士”(&lt;a href=&quot;http://link.zhihu.com/?target=http%3A//rightknights.com/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;维权骑士_免费版权监测/版权保护/版权分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2019-03-08-56614427</guid>
<pubDate>Fri, 08 Mar 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>BAB vs BABAB</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2019-03-06-58479814.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/58479814&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-fda48c2c7f44aa4dae70a7275b1090a6_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;摘要&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;Betting Against Beta 这篇构筑在 Black CAPM 模型上的实证资产定价文章是 AQR 最著名的代表作之一。然而，有人对它提出了强烈的质疑。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;1 Black CAPM 模型&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;1972 年，Fischer Black、Michael Jensen 和 Myron Scholes &lt;b&gt;从实际市场数据中观察到股票收益率和它们的  β  画出来的资本市场线（SML）远比 CAPM 预测的要更平缓&lt;/b&gt;，这说明风险和收益的关系不能很好的满足 CAPM。Black et al. (1972) 从时间序列回归和截面回归两个维度实证了上述猜想，并提出了新的 CAPM 模型。&lt;/p&gt;&lt;p&gt;Black et al. (1972) 按照股票的 β 大小把股票分成十组（第一组中 β最大），然后在时序上回归（检验时考虑了各种偏差和误差的影响），得到了如下结果。按照 CAPM，回归的截距项（即 α）应该为 0，然而Black et al. (1972) 观察到在不同的历史时期，α 显著不为 0 且和 β 呈负相关 —— &lt;b&gt;高 β 的股票往往有负 α&lt;/b&gt;。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-da6a0eabfbd856e3681e09f6933223ab_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;843&quot; data-rawheight=&quot;615&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;843&quot; data-original=&quot;https://pic4.zhimg.com/v2-da6a0eabfbd856e3681e09f6933223ab_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-da6a0eabfbd856e3681e09f6933223ab_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;843&quot; data-rawheight=&quot;615&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;843&quot; data-original=&quot;https://pic4.zhimg.com/v2-da6a0eabfbd856e3681e09f6933223ab_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-da6a0eabfbd856e3681e09f6933223ab_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;观察到实际数据和 CAPM 之间的背离，Black et al. (1972) 抛弃了 CAPM 中的无风险利率并提出了一个双因子模型：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D%5Br_j%5D%3D%5Cmbox%7BE%7D%5Br_z%5D%281-%5Cbeta_j%29%2B%5Cmbox%7BE%7D%5Br_m%5D%5Cbeta_j&quot; alt=&quot;\mbox{E}[r_j]=\mbox{E}[r_z](1-\beta_j)+\mbox{E}[r_m]\beta_j&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;上式中小写字母 r 表示股票或者组合的绝对收益。由于第二个因子 r_z 和  β 有关，因此它被称为 β 因子。由于 r_z 和 r_m 的协方差为零，r_z 代表着一个 β 中性组合的收益率。这个改进的 CAPM 模型被后人称为 &lt;b&gt;Black CAPM 模型&lt;/b&gt;（或 zero-beta CAPM 模型），它比最初的 CAPM 更加符合实际数据，因此应用更加广泛。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;2 Betting Against Beta&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;在 Black CAPM 被提出的 40 年之后，来自 AQR 的 Andrea Frazzini 和 Lasse Heje Pedersen 在 Journal of Financial Economics 上发表了一篇题为 Betting Against Beta 的文章（Frazzini and Pedersen 2014，下称 FP），从另外的角度解释了 α 和 β 之间的负相关。他们指出&lt;b&gt;在实际投资中，不同的投资者受到不同资金使用的限制。为了追求更高的收益，一些投资者（特别是机构）会把有限的资金投资于高风险的投资品，比如高 β 的股票，这便造成了它们 α 的下降。&lt;/b&gt;FP 用 ψ 来表示资金限制强弱程度，并得出 α 和 β 的关系如下：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Calpha%3D%5Cpsi%281-%5Cbeta%29&quot; alt=&quot;\alpha=\psi(1-\beta)&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;Frazzini and Pedersen (2014) 在不同的市场中（包括股票、商品、债券、外汇）实证了他们的模型。下图显示了在美国股票和全球股票市场中，按照 β 的高低将股票分成十档，每一档的超额收益（超额收益是总收益减去一些常见因子能够解释的部分）。他们针对这个现象提出了 Betting Against Beta 策略（下称 BAB）、构建投资组合、赚取其他因子无法解释的超额收益。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-b9d2c02e1ffc6752644a93134a9b0286_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;885&quot; data-rawheight=&quot;371&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;885&quot; data-original=&quot;https://pic3.zhimg.com/v2-b9d2c02e1ffc6752644a93134a9b0286_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-b9d2c02e1ffc6752644a93134a9b0286_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;885&quot; data-rawheight=&quot;371&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;885&quot; data-original=&quot;https://pic3.zhimg.com/v2-b9d2c02e1ffc6752644a93134a9b0286_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-b9d2c02e1ffc6752644a93134a9b0286_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;由于低 Beta 作为一个因子早已深入人心，Betting Against Beta 一经发表，便在学术界和业界产生了巨大的反响。自 2014 年以来，它的被引用量在所有 Journal of Financial Economics 的文章中高居第二位，仅仅次于排名第一的 Fama-French 五因子模型。而在业界，它成为防御型投资策略当仁不让的杰出代表，得到了大量机构投资者的追捧。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-0e464d6ea04ee96f065ae98514dd07c3_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;656&quot; data-rawheight=&quot;710&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;656&quot; data-original=&quot;https://pic4.zhimg.com/v2-0e464d6ea04ee96f065ae98514dd07c3_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-0e464d6ea04ee96f065ae98514dd07c3_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;656&quot; data-rawheight=&quot;710&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;656&quot; data-original=&quot;https://pic4.zhimg.com/v2-0e464d6ea04ee96f065ae98514dd07c3_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-0e464d6ea04ee96f065ae98514dd07c3_b.jpg&quot;&gt;&lt;/figure&gt;&lt;h2&gt;&lt;b&gt;3 Betting Against Betting Against Beta&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;正所谓“人红是非多”，面对 BAB 因子在纸面上（on paper）获得的非凡超额收益，有人就提出了尖锐的质疑。2018 年，Robert Novy-Marx 和 Mihail Velikov 撰写了一篇题为 &lt;b&gt;Betting AgainstBetting Against Beta&lt;/b&gt; （BABAB）的文章（Novy-Marx and Velikov 2018），指出 FP 在构建 BAB 因子时有三个地方“不走寻常路”，从而导致了其 on paper 的超高收益，而这些收益在实际投资中无法兑现。这三个地方是：&lt;/p&gt;&lt;p&gt;&lt;b&gt;1.&lt;/b&gt; 在构建多空投资组合计算 BAB 收益率时，FP 使用了 rank-weighted（即按排名作为权重），而非主流的按市值加权的做法。Novy-Marx and Velikov (2018) 指出，rank-weighted 的效果和等权重组合十分接近，因此该组合在小市值因子上有暴露。由于小市值在美股长期有效，它对 BAB 的收益率产生了正贡献。&lt;/p&gt;&lt;p&gt;&lt;b&gt;2.&lt;/b&gt; 在构建策略时，为了获得 β 中性的组合，FP 在对冲时采用了杠杆（hedging by leveraging）。这使得该组合过分的暴露在微小市值和超小市值的股票中，以此获得的超高收益率是在实际中无法实现的。&lt;/p&gt;&lt;p&gt;&lt;b&gt;3.&lt;/b&gt; 在计算个股 β 时，FP 使用了不同的时间窗口计算波动率和相关系数。这种非主流的做法佐证了 BAB 一文中提出的&lt;i&gt;“betas of securities in the cross section are compressed toward one when funding liquidity risk is high”&lt;/i&gt;这个观点。Novy-Marx and Velikov (2018) 指出，这是由于 FP 计算 β 的方法天然有偏造成的；一旦修正了这个偏差，上述观点并不成立。由于 BAB 这篇文章连接 α 和 β 之间负相关的出发点是投资者的 funding liquidity risk，因此这一条直接挑战了 FP 对 BAB 的解释。&lt;/p&gt;&lt;p&gt;上述的第三方面 —— 计算 β 的方法 —— 对学术界的影响很大。自 BAB 发表之后，很多研究也采用同样的思路计算 β 值。&lt;b&gt;在该方法中，FP 使用一年滚动窗口计算市场和个股收益率的标准差，而采用五年滚窗口计算二者之间的相关系数；FP 指出这么做的原因是，相对于波动率，相关系数的变化更加缓慢。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;当采用传统方法计算 β 时，相关系数和标准差采用的是同样长度的时间窗口。通过简单的运算，不难看出 FP 计算的 β 值（记为 β_FP）和传统 β 值的关系：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+%5Cbeta_%7BFP%7D%5Ei%26%5Cequiv%26%5Cdisplaystyle+%5Crho_5%5Ei%5Cfrac%7B%5Csigma_1%5Ei%7D%7B%5Csigma_1%5E%7B%5Cmbox%7Bmkt%7D%7D%7D%5C%5C+%26%3D%26%5Cdisplaystyle%5Cleft%28%5Crho_5%5Ei%5Cfrac%7B%5Csigma_5%5Ei%7D%7B%5Csigma_5%5E%7B%5Cmbox%7Bmkt%7D%7D%7D%5Cright%29%5Cleft%28%5Cfrac%7B%5Csigma_5%5E%7B%5Cmbox%7Bmkt%7D%7D%5Csigma_1%5Ei%7D%7B%5Csigma_5%5Ei%5Csigma_1%5E%7B%5Cmbox%7Bmkt%7D%7D%7D%5Cright%29%5C%5C+%26%3D%26%5Cdisplaystyle%5Cleft%28%5Cfrac%7B%5Csigma_1%5Ei%2F%5Csigma_5%5Ei%7D%7B%5Csigma_1%5E%7B%5Cmbox%7Bmkt%7D%7D%2F%5Csigma_5%5E%7B%5Cmbox%7Bmkt%7D%7D%7D%5Cright%29%5Cbeta_5%5Ei+%5Cend%7Barray%7D+&quot; alt=&quot;\begin{array}{rll} \beta_{FP}^i&amp;amp;\equiv&amp;amp;\displaystyle \rho_5^i\frac{\sigma_1^i}{\sigma_1^{\mbox{mkt}}}\\ &amp;amp;=&amp;amp;\displaystyle\left(\rho_5^i\frac{\sigma_5^i}{\sigma_5^{\mbox{mkt}}}\right)\left(\frac{\sigma_5^{\mbox{mkt}}\sigma_1^i}{\sigma_5^i\sigma_1^{\mbox{mkt}}}\right)\\ &amp;amp;=&amp;amp;\displaystyle\left(\frac{\sigma_1^i/\sigma_5^i}{\sigma_1^{\mbox{mkt}}/\sigma_5^{\mbox{mkt}}}\right)\beta_5^i \end{array} &quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;上式中，ρ 表示相关系数，σ 代表标准差，上标 i 代表个股 i，mkt 代表市场，下标 1 和 5 分别代表一年和五年的滚动窗口。该关系式说明，采用 FP 方法计算出的 β 等价于传统方法计算的 β 乘以一个系数；该系数是个股一年波动率和五年波动率的之比和市场一年波动率和五年波动率之比的相对大小。&lt;/p&gt;&lt;p&gt;Novy-Marx and Velikov (2018) 指出，该系数对 β_FP 的计算在时序上有很大的影响：当市场自身处于高波动时，个股虽然也是高波动，但是实证数据表明个股的 σ_1/σ_5 和市场的 σ_1/σ_5 之间的弹性小于 1，因此该系数小于 1；与之相反的，当市场自身处于低波动时，二者之间的弹性大于 1。这说明&lt;b&gt;当市场处于高波动时，使用 FP 方法计算的个股 β 比传统方法计算的 β 更低；而当市场处于低波动时，使用 FP 方法得到的 β 比传统方法得到的 β 更高。这进一步造成，将 β_FP 按照个股市值加权后，得到的市场的 β 并不等于 1。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;下一节使用 A 股数据对此上述结论进行简单实证。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;4 简单实证&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;实证中选择的时间区间为 2010 年 1 月 1 日到 2019 年 2 月 28 日。为了简化实证，我从上证指数中选出了 830 支在整个范围内均有交易数据的个股（以此排除上市、退市等的影响）。使用个股的收益率和市值即可以构建出这 830 支股票对应的“市场”的收益率时间序列，从而计算个股的 β。&lt;/p&gt;&lt;p&gt;由于数据不足 10 年，因此实证中并没有采用 FP 中的一年和五年时间窗口，而是使用半年和两年为窗口分别计算标准差和相关系数。首先来看看个股的 σ_S/σ_L 和市场的 σ_S/σ_L 之间的关系（其中 S 代表半年的短窗口、L 代表两年的长窗口）。下图中，蓝色实线是个股 σ_S/σ_L 中位数、阴影区域为 5% 到 95% 分位数；黄色曲线是市场 σ_S/σ_L。不难看出，当市场 σ_S/σ_L 较大时（意味着市场处于高波动），大部分个股的 σ_S/σ_L 在黄色曲线之下；而当市场 σ_S/σ_L 较小时（意味着市场处于低波动），大部分个股的 σ_S/σ_L 在黄色曲线之上。这个结果和 Novy-Marx and Velikov (2018) 针对美股的实证结果相同。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-a59b0180aa72f2c83b3b31a45ae17fec_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;730&quot; data-rawheight=&quot;315&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;730&quot; data-original=&quot;https://pic1.zhimg.com/v2-a59b0180aa72f2c83b3b31a45ae17fec_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-a59b0180aa72f2c83b3b31a45ae17fec_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;730&quot; data-rawheight=&quot;315&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;730&quot; data-original=&quot;https://pic1.zhimg.com/v2-a59b0180aa72f2c83b3b31a45ae17fec_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-a59b0180aa72f2c83b3b31a45ae17fec_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;再来看看市值加权的 β_FP 得到的市场 β 如何随时间变化。理论上，当采用了正确的方法计算个股的 β 后，市场的 β 应该等于 1。&lt;/p&gt;&lt;p&gt;下图中，蓝色曲线是通过传统方法 —— 即使用两年窗口计算标准差和相关系数 —— 得到的个股 β 后再通过市值加权得到的市场 β，它的取值基本上没有偏离 1.0；而&lt;b&gt;黄色曲线为使用个股 β_FP 得到的市场 β，它在大多数时间显著的偏离 1.0。&lt;/b&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-5d57ad253028ab9a7227e7b48b726a9b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;725&quot; data-rawheight=&quot;289&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;725&quot; data-original=&quot;https://pic4.zhimg.com/v2-5d57ad253028ab9a7227e7b48b726a9b_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-5d57ad253028ab9a7227e7b48b726a9b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;725&quot; data-rawheight=&quot;289&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;725&quot; data-original=&quot;https://pic4.zhimg.com/v2-5d57ad253028ab9a7227e7b48b726a9b_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-5d57ad253028ab9a7227e7b48b726a9b_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;从个股 σ_S/σ_L 和市场 σ_S/σ_L 的关系出发可知：当市场处于高波动时，β_FP 小于传统方法计算出的 β；当市场处于低波动时，β_FP 大于传统方法计算出的 β。因此，我们预期&lt;b&gt;使用 β_FP 得到的市场 β 和市场 σ_S/σ_L 的取值在时序上呈现负相关&lt;/b&gt;。下图证实了这种猜想。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-5a73bddc686f6c1a826d380c10ca2bbc_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;750&quot; data-rawheight=&quot;288&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;750&quot; data-original=&quot;https://pic1.zhimg.com/v2-5a73bddc686f6c1a826d380c10ca2bbc_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-5a73bddc686f6c1a826d380c10ca2bbc_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;750&quot; data-rawheight=&quot;288&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;750&quot; data-original=&quot;https://pic1.zhimg.com/v2-5a73bddc686f6c1a826d380c10ca2bbc_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-5a73bddc686f6c1a826d380c10ca2bbc_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;以上实证结果说明，使用 FP 方法和使用传统方法得到的个股 β 有很大差异。这会造成以该 β 值作为因子来选股出现不同的结果。由于计算 β 需要至少两年的数据，因此下面来考察从 2012 年到 2019 年上述两种不同 β 计算方法的选股结果。&lt;/p&gt;&lt;p&gt;下图显示，使用 β_FP 战胜了传统 β：β_FP 因子获得年化收益率 9.27%、夏普率 0.59；而传统 β 因子仅获得年化收益率 5.08% 和夏普率 0.40。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-9af1cd5f7ae13c7ad05258730f674779_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;689&quot; data-rawheight=&quot;441&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;689&quot; data-original=&quot;https://pic2.zhimg.com/v2-9af1cd5f7ae13c7ad05258730f674779_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-9af1cd5f7ae13c7ad05258730f674779_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;689&quot; data-rawheight=&quot;441&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;689&quot; data-original=&quot;https://pic2.zhimg.com/v2-9af1cd5f7ae13c7ad05258730f674779_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-9af1cd5f7ae13c7ad05258730f674779_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;不过，先别着急下结论！我并没有说明因子投资组合是如何构建的。&lt;/p&gt;&lt;p&gt;该因子投资组合是按照 β 从小到大排序，首尾各取 100 支&lt;b&gt;等权&lt;/b&gt;配置，每月末调仓。等权配置增加了在小市值上的暴露；如果按照市值加权构建投资组合会如何呢？下图给出了实证结果：β_FP 因子获得年化收益率 0.65%、夏普率 0.18；而传统 β 因子获得年化收益率 0.56% 和夏普率 0.25。&lt;b&gt;当排除了小市值影响后，传统 β 因子战胜了 β_FP 因子。&lt;/b&gt;这个结果和 Novy-Marx and Velikov (2018) 对 BAB 的第一条质疑相一致。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-ba7fd49c25abd889d26d95f79d704abc_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;698&quot; data-rawheight=&quot;403&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;698&quot; data-original=&quot;https://pic1.zhimg.com/v2-ba7fd49c25abd889d26d95f79d704abc_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-ba7fd49c25abd889d26d95f79d704abc_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;698&quot; data-rawheight=&quot;403&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;698&quot; data-original=&quot;https://pic1.zhimg.com/v2-ba7fd49c25abd889d26d95f79d704abc_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-ba7fd49c25abd889d26d95f79d704abc_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;最后想指出的是，&lt;b&gt;上述结果仅仅是对 BAB 做的一点非常有限的实证，从该结果中我们还远不能得到任何确定性的结论。&lt;/b&gt;如何计算 β，这个最简单的问题，似乎也并不是那么容易回答。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;5 结语&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;大量的实证数据显示，市场 β 和 α 确实存在负相关；Fischer Black 40 年前的智慧也依旧闪亮。然而，Novy-Marx and Velikov (2018) 指出，&lt;b&gt;我们应该时刻保持警惕，搞清楚使用“特殊”方法计算的因子、构建的投资组合是否意外的暴露在别的地方并影响对因子有效与否的判断。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;最后再来自我检讨一下。我几年前第一次读 BAB 的时候，就被里面计算 β 的方法深深说服，没有努力去思考背后的逻辑是否成立。Novy-Marx and Velikov (2018) 的分析说明，即便 BAB 是来自研究能力超一流的 AQR、发表于金融领域顶刊之一的 JFE，我们也不应该想当然的拿来主义。&lt;/p&gt;&lt;p&gt;近日，AQR 这个投资界的“学术天团”为了庆祝其成立二十周年，特意甄选了 20 篇他们所著的最具代表性的学术论文、出版了《20 for Twenty》一书，BAB 赫然在列。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-b623c29a5f916139f6e01e0e2f4422e3_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;562&quot; data-rawheight=&quot;263&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;562&quot; data-original=&quot;https://pic4.zhimg.com/v2-b623c29a5f916139f6e01e0e2f4422e3_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-b623c29a5f916139f6e01e0e2f4422e3_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;562&quot; data-rawheight=&quot;263&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;562&quot; data-original=&quot;https://pic4.zhimg.com/v2-b623c29a5f916139f6e01e0e2f4422e3_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-b623c29a5f916139f6e01e0e2f4422e3_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;Cliff Asness 对这篇文章的一句话点评是：&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;Fischer Black was right about the security market line (among many other things).&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;看完了 BABAB，我想：Fischer Black 的确是对的，但是 BAB 也许未必。Don&#39;t get me wrong！我依然是 AQR 的忠实粉丝，也非常佩服他们的学术能力和分享意识，只不过正确的态度应是时刻保持独立思考，因为剖析一个因子成与败背后的真正原因始终是我们自己的责任。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;参考文献&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Black, F., M. C. Jensen and M. Scholes (1972). The Capital Asset Pricing Model: Some Empirical Tests. In &lt;i&gt;Studies in the Theory of Capital Markets&lt;/i&gt;. M. C. Jensen (editor), New York: Praeger, 79 – 121.&lt;/li&gt;&lt;li&gt;Frazzini, A. and L. H. Pedersen (2014). Betting against beta. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 111(1), 1 – 25.&lt;/li&gt;&lt;li&gt;Novy-Marx, R. and M. Velikov (2018). Betting Against Betting Against Beta. Available at SSRN: &lt;a href=&quot;http://link.zhihu.com/?target=https%3A//ssrn.com/abstract%3D3300965&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;ssrn.com/abstract=33009&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;65&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处，谢谢。已委托“维权骑士”(&lt;a href=&quot;http://link.zhihu.com/?target=http%3A//rightknights.com/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;维权骑士_免费版权监测/版权保护/版权分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2019-03-06-58479814</guid>
<pubDate>Wed, 06 Mar 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>如果我们能正确预测基本面因子</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2019-03-05-54469842.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/54469842&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-34c98a73840c97d45277561b5e27835b_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;摘要&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;使用历史基本面信息来预测未来的基本面，并基于预测值选股；如果能够预测准确，便可在价格修正以反映最新的基本面时获得超额收益。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;1 引言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;基于基本面的量化多因子选股一直是市场中研究和实践的重点，其核心逻辑是找到并配置能够预测股票未来收益率的因子。随着机器学习技术的飞速发展，越来越多的先进算法（比如各种神经网络）被用于挖掘基本面因子和股票未来收益率之间的非线性关系。&lt;/p&gt;&lt;p&gt;诚然，股票的价格和上市公司的基本面密切相关。但是在选股时，我们很难准确判断模型的有效输入。对于投资这种开放性问题，大千世界的任何信息都有可能会对决策产生影响，信息量巨大而信噪比极低。&lt;/p&gt;&lt;p&gt;如下图所示，基本面信息仅仅是现实世界全部信息的一小部分，其中还包含了大量的无用噪音甚至是虚假、错误信息。股票未来的价格反映了全部信息中的一小撮有用信息；然而具体哪些信息有用是未知的，该信息和基本面信息有交集，但后者远飞前者的全部。&lt;b&gt;直接使用基本面信息来选股（即预测股票未来的价格或收益率）将受到高信噪比的影响。&lt;/b&gt;&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-182ab726a258a507bef0e056972ba504_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;489&quot; data-rawheight=&quot;226&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;489&quot; data-original=&quot;https://pic1.zhimg.com/v2-182ab726a258a507bef0e056972ba504_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-182ab726a258a507bef0e056972ba504_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;489&quot; data-rawheight=&quot;226&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;489&quot; data-original=&quot;https://pic1.zhimg.com/v2-182ab726a258a507bef0e056972ba504_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-182ab726a258a507bef0e056972ba504_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;此外，虽然市场上存在一些异象无法被有效市场假说（EMH）解释（它们源自行为金融学中的各种认知偏差），但 EMH 仍然在大部分时间相对有效，是主宰市场的第一范式。这就意味着最新的基本面信息已经一定程度上反映在价格之中了；再使用它们来预测未来的价格，其效果会打一定的折扣。&lt;/p&gt;&lt;p&gt;为了应对上述种种困难，学术界和业界在最近几年提出了一个新的思路（如下图所示）：&lt;b&gt;使用历史基本面信息来预测未来的基本面，并基于预测值选股；如果能够预测准确，当最新财报被公布的时候，价格发生修正以反映最新的基本面信息，使得那些提前布局的投资者获得超额收益。&lt;/b&gt;&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-e83dc9df3b8c66aa9152b349460fb607_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;503&quot; data-rawheight=&quot;171&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;503&quot; data-original=&quot;https://pic4.zhimg.com/v2-e83dc9df3b8c66aa9152b349460fb607_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-e83dc9df3b8c66aa9152b349460fb607_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;503&quot; data-rawheight=&quot;171&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;503&quot; data-original=&quot;https://pic4.zhimg.com/v2-e83dc9df3b8c66aa9152b349460fb607_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-e83dc9df3b8c66aa9152b349460fb607_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;这种做法背后的假设是能够通过历史基本面信息预测出未来的基本面。我对此的看法是，&lt;b&gt;这绝不容易&lt;/b&gt;，但与使用历史基本面信息预测未来收益率相比，它背后的逻辑更直接、纯粹，而不像基本面和收益率之间还隔了一层。&lt;b&gt;由此可以猜想，过去和未来基本面之间的信噪比比过去基本面和未来价格之间的信噪比更高。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;本文的目的有如下两个：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;海外的业界基于上述思路，通过机器学习算法预测未来基本面信息、提出了&lt;b&gt;前视因子模型（Lookahead Factor Model，LFM）&lt;/b&gt;的概念。本文对这个方法进行简要介绍。&lt;/li&gt;&lt;li&gt;本文的题目中用了“如果”（if），而不是“如何”（how）。我希望首先定量探讨通过预知未来 —— 完美以及不完美的情况下 —— 能否带来超额收益。&lt;b&gt;只有这个 if 的前提成立了，以后的 how 才有意义&lt;/b&gt;（而且这个 how 也并不一定非要通过机器学习实现）。在这方面，本文基于中证 500 做一些简单实证。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;下面首先来看看 Lookahead Factor Model。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;2 Lookahead Factor Model&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;2017 年，Alberg and Lipton (2017) 在 NIPS Time Series Workshop 上报告了一篇题为《Improving factor-based quantitative investing by forecasting company fundamentals》的文章。本节对它做简要介绍。&lt;/p&gt;&lt;p&gt;之所以不花太多的篇幅，是因为这毕竟不是发表在 NIPS 正会上的，而且它仅仅是一个 poster session，文章本身也很短，所以其效果的可靠性仍有待检验。但我仍希望它能给小伙伴们带来一些启发。&lt;/p&gt;&lt;p&gt;Alberg and Lipton (2017) 的研究动机是观察到，如果能够开天眼知道未来一段时间的基本面信息（包括 Book-to-Market、EBIT/EV、Net Income/EV 以及 Sales/EV 这些），并通过它们来选股，则可以在美股上获得更高的收益，且预知未来的时间越长（用 months of clairvoyance 表示）收益越高（下图）。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-85c029783da131a99f8b500d8f17c157_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;601&quot; data-rawheight=&quot;421&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;601&quot; data-original=&quot;https://pic4.zhimg.com/v2-85c029783da131a99f8b500d8f17c157_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-85c029783da131a99f8b500d8f17c157_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;601&quot; data-rawheight=&quot;421&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;601&quot; data-original=&quot;https://pic4.zhimg.com/v2-85c029783da131a99f8b500d8f17c157_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-85c029783da131a99f8b500d8f17c157_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;以此为动机，他们使用了 Multilayer Perceptrons（MLPs）以及 Recurrent Neural Networks（RNNs）两种算法构建了预测模型，使用历史基本面信息来预测未来的基本面信息。&lt;/p&gt;&lt;p&gt;在回测中，二位作者使用了 1970 年 1 月至 2017 年 9 月 NYSE、NASDAQ 以及 AMEX 上的股票（排除了非美国的公司、金融行业公司以及超小市值公司）。模型的输入特征包括 16 个基本面变量和 4 个价格时序变量（全部是动量类的）。这 16 个基本面特征包括：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Revenue (TTM)；&lt;/li&gt;&lt;li&gt;Cost of good sold (TTM)；&lt;/li&gt;&lt;li&gt;SG&amp;amp;A (TTM)；&lt;/li&gt;&lt;li&gt;EBIT (TTM)；&lt;/li&gt;&lt;li&gt;Net income (TTM)；&lt;/li&gt;&lt;li&gt;Cash and cash equivalents (当季)；&lt;/li&gt;&lt;li&gt;Receivables (当季)；&lt;/li&gt;&lt;li&gt;Inventories (当季)；&lt;/li&gt;&lt;li&gt;Other current assets (当季)；&lt;/li&gt;&lt;li&gt;PP&amp;amp;E (当季)；&lt;/li&gt;&lt;li&gt;Other assets (当季)；&lt;/li&gt;&lt;li&gt;Debt in current liabilities (当季)；&lt;/li&gt;&lt;li&gt;Accounts payable (当季)；&lt;/li&gt;&lt;li&gt;Taxes payable (当季)；&lt;/li&gt;&lt;li&gt;Other current liabilities (当季)；&lt;/li&gt;&lt;li&gt;Total liabilities (当季)。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;在建模时，所有特征均经过必要的标准化处理；整个回测期被分为样本内（1970 - 1999）和样本外（2000 - 2017）两部分；样本内被进一步分为 training set 和 validation set 两部分。Alberg and Lipton (2017) 使用样本内的 validation set 确定模型的超参数 —— 包括 learning rate、model architecture、objective function weighting —— 以及 early stopping criteria。&lt;/p&gt;&lt;p&gt;为了解决 RNN 容易过拟合的问题，Alberg and Lipton (2017) 特意指出他们的模型是多任务学习，同时预测 16 个基本面指标；损失函数为预测值和实际值之间的均方误差（MSE）。不过作者也指出，在全部 16 个基本面指标中，&lt;b&gt;他们最终用来选股的是 EBIT/EV，因此在损失函数中对该项赋予了更高的权重。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;实证结果显示，基于神经网络的复杂算法在样本外取得了比 naïve 算法（即使用当期数据猜下一期）更低的MSE。相比 S&amp;amp;P500 指数本身以及传统的因子选股（基于当期 EBIT/EV 选股），两个 lookahead factor models 都取得了更高的年化收益率和夏普率（下表）。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-1c61a77b4b9b29e9307864533bcac3e0_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;768&quot; data-rawheight=&quot;192&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;768&quot; data-original=&quot;https://pic1.zhimg.com/v2-1c61a77b4b9b29e9307864533bcac3e0_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-1c61a77b4b9b29e9307864533bcac3e0_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;768&quot; data-rawheight=&quot;192&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;768&quot; data-original=&quot;https://pic1.zhimg.com/v2-1c61a77b4b9b29e9307864533bcac3e0_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-1c61a77b4b9b29e9307864533bcac3e0_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;以上就是关于 Alberg and Lipton (2017) 这篇文章的简要介绍。国内的一些量化论坛基于该方法在 A 股上做了实证，感兴趣的朋友可以找来看看。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;3 假如开天眼&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;本节和下一节来回答本文关注的 if 问题。我们以中证 500 成分股为选股池，回测期为 2009 年 12 月到 2018 年 12 月，选择 Earnings per Share (EPS) 作为目标基本面因子来考察成功预测未来 EPS 能否获得超额收益。&lt;/p&gt;&lt;p&gt;首先，来看看常规做法：每月末按最新 EPS 数据选取该指标最高的 20 支股票等权配置，按月调仓，不考虑任何交易成本。该选股的效果如下。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-468b5201a6abcbd4c7e9ac6cab7019c6_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;820&quot; data-rawheight=&quot;512&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;820&quot; data-original=&quot;https://pic3.zhimg.com/v2-468b5201a6abcbd4c7e9ac6cab7019c6_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-468b5201a6abcbd4c7e9ac6cab7019c6_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;820&quot; data-rawheight=&quot;512&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;820&quot; data-original=&quot;https://pic3.zhimg.com/v2-468b5201a6abcbd4c7e9ac6cab7019c6_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-468b5201a6abcbd4c7e9ac6cab7019c6_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;接下来，假设开天眼已知未来一个月的 EPS，并基于此选择 20 支 EPS 最大的股票等权配置、按月调仓。该策略的表现如下。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-fee3521655174d0577a62cf5d3f111b4_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;844&quot; data-rawheight=&quot;522&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;844&quot; data-original=&quot;https://pic1.zhimg.com/v2-fee3521655174d0577a62cf5d3f111b4_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-fee3521655174d0577a62cf5d3f111b4_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;844&quot; data-rawheight=&quot;522&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;844&quot; data-original=&quot;https://pic1.zhimg.com/v2-fee3521655174d0577a62cf5d3f111b4_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-fee3521655174d0577a62cf5d3f111b4_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;将这两个选股策略和中证 500 指数本身放在一起比较，高下立判。&lt;b&gt;无疑，EPS 本身是一个非常优秀的选股因子，而如果能预知未来 EPS 则可以获得更大的优势、更高的收益。&lt;/b&gt;&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-39ac4d260230352114f6d86491154c8b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;931&quot; data-rawheight=&quot;483&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;931&quot; data-original=&quot;https://pic4.zhimg.com/v2-39ac4d260230352114f6d86491154c8b_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-39ac4d260230352114f6d86491154c8b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;931&quot; data-rawheight=&quot;483&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;931&quot; data-original=&quot;https://pic4.zhimg.com/v2-39ac4d260230352114f6d86491154c8b_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-39ac4d260230352114f6d86491154c8b_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;发生这种现象背后的原因是什么呢？&lt;/p&gt;&lt;p&gt;下图显示了使用当期 EPS 选股时，回测期内每月平均换股的数量。其中变化最多的是五月份。这是因为上市公司需要在每年 4 月 30 日之前披露上一年的年报。因此在每年四月底，使用最新披露的 EPS 选出的股票往往较之前的选择有较大变化，这便解释了五月份的持股较四月份的持股变化最大。其他月份的股票变化和季报、中报披露以及中证 500 调整成分股有关。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-7ed72176a170321b53187bb2da47c07f_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;812&quot; data-rawheight=&quot;428&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;812&quot; data-original=&quot;https://pic4.zhimg.com/v2-7ed72176a170321b53187bb2da47c07f_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-7ed72176a170321b53187bb2da47c07f_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;812&quot; data-rawheight=&quot;428&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;812&quot; data-original=&quot;https://pic4.zhimg.com/v2-7ed72176a170321b53187bb2da47c07f_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-7ed72176a170321b53187bb2da47c07f_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;类似的，下图显示了使用&lt;b&gt;下个月&lt;/b&gt; EPS 选股时，每月平均换股的数量。比较这前后两张图，&lt;b&gt;其中最大的区别就是正常情况下五月份的变化提前在四月发生&lt;/b&gt;（因为我们假设在三月底就知道四月最新披露的 EPS 中最大的股票）。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-33f5746f9ec9551878d4a398bfcf3823_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;907&quot; data-rawheight=&quot;475&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;907&quot; data-original=&quot;https://pic4.zhimg.com/v2-33f5746f9ec9551878d4a398bfcf3823_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-33f5746f9ec9551878d4a398bfcf3823_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;907&quot; data-rawheight=&quot;475&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;907&quot; data-original=&quot;https://pic4.zhimg.com/v2-33f5746f9ec9551878d4a398bfcf3823_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-33f5746f9ec9551878d4a398bfcf3823_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;对比使用当期 EPS 选股和使用未来 EPS 选股的每月平均收益率，可以看到前面提到的这种前移带来的巨大差异。正如下图所示，&lt;b&gt;开天眼（图中 Oracle）选股的四月份收益率较正常（图中 Regular）选股的收益率有巨大提升。&lt;/b&gt;此外，开天眼选股在八月份也有巨大的提升（8 月 30 日是中报披露的截止日期）。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-fc8e36aa39c51196b2f8c964999c7343_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;841&quot; data-rawheight=&quot;441&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;841&quot; data-original=&quot;https://pic4.zhimg.com/v2-fc8e36aa39c51196b2f8c964999c7343_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-fc8e36aa39c51196b2f8c964999c7343_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;841&quot; data-rawheight=&quot;441&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;841&quot; data-original=&quot;https://pic4.zhimg.com/v2-fc8e36aa39c51196b2f8c964999c7343_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-fc8e36aa39c51196b2f8c964999c7343_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;以上结果说明，如果能准确的预测并使用未来的 EPS 选股，确实能够获得更高的收益。不幸的是，现实中我们不能开天眼。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;4 不完美预测能否带来提高？&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;第三节的结果仅仅是一个美好的愿景。在实际中，即便能够在一定程度上预测未来的 EPS（或其他基本面信息），其准确性也难以保证。&lt;b&gt;在不完美的预测下，这种努力是否能够带来超额收益呢？&lt;/b&gt;这就是本节探讨的问题。&lt;/p&gt;&lt;p&gt;以开天眼的结果作为 EPS 选股的标准答案，可以计算出使用历史 EPS 选股的错误率。从下图不难看出，由于基本面指标变动的频率较低，&lt;b&gt;在很多没有新信息披露的月份里，选股的错误率也很低，但是这并没有什么作用（这一点在构建损失函数的时候值得考虑）。起决定性作用的是错误率高的那些月份。&lt;/b&gt;&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-bef532e8960e7b3d5737d42ccf75993e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;853&quot; data-rawheight=&quot;423&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;853&quot; data-original=&quot;https://pic3.zhimg.com/v2-bef532e8960e7b3d5737d42ccf75993e_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-bef532e8960e7b3d5737d42ccf75993e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;853&quot; data-rawheight=&quot;423&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;853&quot; data-original=&quot;https://pic3.zhimg.com/v2-bef532e8960e7b3d5737d42ccf75993e_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-bef532e8960e7b3d5737d42ccf75993e_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;上一节的分析指出，使用未来 EPS 选股的优势在于提前知道年报和中报（特别是前者）中最新的 EPS，因此四月和八月贡献了巨大的超额收益。观察上图不难发现，使用历史 EPS 选股时，四月份的错误率也是全部十二个月份中最高的。下表统计了回测期内每年四月和八月使用历史 EPS 选股的错误率。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-1526f0a07e2f6ffcc6c3f88344aa084a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;590&quot; data-rawheight=&quot;393&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;590&quot; data-original=&quot;https://pic3.zhimg.com/v2-1526f0a07e2f6ffcc6c3f88344aa084a_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-1526f0a07e2f6ffcc6c3f88344aa084a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;590&quot; data-rawheight=&quot;393&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;590&quot; data-original=&quot;https://pic3.zhimg.com/v2-1526f0a07e2f6ffcc6c3f88344aa084a_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-1526f0a07e2f6ffcc6c3f88344aa084a_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;由此可见，预测 EPS 的努力可以考虑以降低四月和（或）八月选股的错误率为目标。&lt;/b&gt;为了回答“不完美预测能否带来提高”这个问题，首先考虑四月为目标并按照以下逻辑进行仿真实验。&lt;/p&gt;&lt;p&gt;对于给定的正确率 c，在回测中每年的三月底从四月 EPS 最高的 20 支股票中随机选出 20 × c 支，作为预测模型正确的部分；从剩余 480 支股票中随机选出 20 × (1 - c) 支作为预测模型错误的部分；如此便完成一次选取（这是一个非常粗糙的处理方式，因为从剩余 480 支股票中随机选出的可能是 EPS 非常差的股票；实际的预测模型 —— 无论是机器学习或者其他方法 —— 应该会比这种处理好一些）。为了降低随机性的影响，在每个四月进行 100 次仿真，取它们的平均值作为正确率 c 下该预测模型的选股结果，以此考察 EPS 预测正确率和选股效果的关系。&lt;/p&gt;&lt;p&gt;下表中 Panel A 展示了四月份 EPS 预测不同正确率下选股的效果。结果表明，随着正确率的提升，收益率和夏普率逐渐增加，选股效果远强于使用当前 EPS 的表现（使用当前 EPS 的年化收益率为 6.33%；夏普率为 0.37）。同时也看到，即便是把正确率提高到 90%，其选股效果也显著弱于全部使用未来 EPS 的情况，这说明仅仅改进四月份的正确率是不够的。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-458ad87dbde287100e95b01918f13632_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;735&quot; data-rawheight=&quot;412&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;735&quot; data-original=&quot;https://pic3.zhimg.com/v2-458ad87dbde287100e95b01918f13632_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-458ad87dbde287100e95b01918f13632_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;735&quot; data-rawheight=&quot;412&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;735&quot; data-original=&quot;https://pic3.zhimg.com/v2-458ad87dbde287100e95b01918f13632_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-458ad87dbde287100e95b01918f13632_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;上表中 Panel B 展示了同时提高四月和八月正确率的结果。随着年报和中报披露月份的同时改进，选股效果较 Panel A 中的结果进一步显著提升。当然，我们也必须注意到，&lt;b&gt;正确率的边际效应在逐渐减小&lt;/b&gt;。上述结果留给我们的启发有以下两点：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;以月频进行基本面预测时，应该着重考虑年报和季报集中披露的月份的正确率；&lt;/li&gt;&lt;li&gt;正确率对选股效果提升的边际效应逐渐减弱，当对重点月份预测的正确率提高到一定水平后，可考虑提升其他月份预测的正确性。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;从实证结果来看，即便是不完美的预测也是值得尝试的。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;5 结语&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;上周的文章中提到了&lt;a href=&quot;https://zhuanlan.zhihu.com/p/53944793&quot; class=&quot;internal&quot;&gt;“预期差”&lt;/a&gt;的概念 —— 如果我们能找到市场中的预期差，便可以利用它来获得超额收益。本文提到的准确预测 EPS 其实质也是提前捕捉预期差，等待价格向价值修正。&lt;/p&gt;&lt;p&gt;想再次强调的是，针对预测基本面这个话题，本文探讨的是 if 的问题，而不是 how 的问题，并通过实证给出了预测中一些可能需要关注的地方。在 how 的问题上，希望文中介绍的 Alberg and Lipton (2017) 给大家提供一些思路。&lt;/p&gt;&lt;p&gt;在基本面的预测方面，无论采用什么方法，预测准确才是最关键的。这就是为什么优秀分析师的盈利预测（一致预期数据）是很值钱的，因为这些数据确实能够带来 α。只不过很多时候，这些 α 的成本太高了。这就给了机器学习契机。希望在未来能够看到学术界和业界在这方面的更多突破，将先进机器学习算法运用到上市公司财务数据的预测中，为低成本的获取 α 提供新的可能性。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;参考文献&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Alberg, J. and Z. C. Lipton (2017). &lt;i&gt;Improving factor-based quantitative investing by forecasting company fundamentals.&lt;/i&gt; NIPS Time Series Workshop 2017 (&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//sites.google.com/site/nipsts2017/accepted-papers&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;sites.google.com/site/n&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;ipsts2017/accepted-papers&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;), available at &lt;a href=&quot;http://link.zhihu.com/?target=https%3A//arxiv.org/pdf/1711.04837&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;arxiv.org/pdf/1711.0483&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处，谢谢。已委托“维权骑士”(&lt;a href=&quot;http://link.zhihu.com/?target=http%3A//rightknights.com/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;维权骑士_免费版权监测/版权保护/版权分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2019-03-05-54469842</guid>
<pubDate>Tue, 05 Mar 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>所有历史数据都是样本内</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2019-02-28-57911231.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/57911231&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-7d446304a1b3059a9dd2efa59b5e2801_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;摘要&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;我们构建策略靠的不是站在回测起点往后看的先见之明，而是站在回测终点往前看的后见之明。所有历史数据都是样本内。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;1 引言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;金融领域的小伙伴想必对 Institutional Investor Journals (II Journals) 并不陌生。它旗下有很多影响力很高的期刊，其中最著名的大概是 Journal of Portfolio Management。与 JF、JFE、RFS 这些纯学术类期刊不同，II Journals 的期刊更注重实践，深得业界喜爱；而 Fischer Black、Robert Engle、Daniel Kahneman、Andrew Lo、William Sharpe、Robert Shiller 等大咖也均在 II Journals 的期刊发表过研究。&lt;/p&gt;&lt;p&gt;2018 年 II Journals 更名为 Institutional Portfolio Research Journals (IPR Journals)，并于 2019 年为旗下的期刊系列增加了一位最新成员 —— Journal of Financial Data Science。该刊的 Editors 和 Advisory Board 可谓十分豪华（下图）。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-6f0121b031dfecf2292f98b61876d616_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1020&quot; data-rawheight=&quot;777&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1020&quot; data-original=&quot;https://pic3.zhimg.com/v2-6f0121b031dfecf2292f98b61876d616_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-6f0121b031dfecf2292f98b61876d616_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1020&quot; data-rawheight=&quot;777&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1020&quot; data-original=&quot;https://pic3.zhimg.com/v2-6f0121b031dfecf2292f98b61876d616_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-6f0121b031dfecf2292f98b61876d616_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;随着大数据和机器学习算法在金融和投资中的潜在作用越来越大，这本期刊的诞生无疑是非常及时的。&lt;b&gt;它旨在指导金融领域的实践者正确使用与日俱增的数据和日新月异的技术。&lt;/b&gt;如今，该刊第一卷第一期已经发行。&lt;/p&gt;&lt;p&gt;作为处女刊，它里面包含了很多非常有意思的文章。其中最吸引我的是一篇题为 A Backtesting Protocol in the Era of Machine Learning（机器学习时代的回测协议）。它的作者是 Rob Arnott、Campbell Harvey 以及 Harry Markowitz（三位都无需介绍）。&lt;b&gt;在这篇文章中，三位作者从七个方面提出了新时代下进行策略回测时应该遵循的一些规则，从而最大化的降低数据挖掘和过拟合的影响。&lt;/b&gt;这七方面构成了一个完整且可操作的体系，能够帮助我们更好的规避样本内的虚假信号、找出能在样本外更有效的交易策略。&lt;/p&gt;&lt;p&gt;这七方面的每一块都值得好好研读一番（建议感兴趣的小伙伴找来 Arnott, Harvey, and Markowitz 2019 这篇文章读一读）。在今天的文章中，我仅想对第四部分 Cross-Validation 里面的两个论点谈一些想法。在这一部分，三位作者抛出了两个观点：&lt;/p&gt;&lt;p&gt;&lt;b&gt;1. Out of Sample is Not Really Out of Sample.&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;2. Iterated Out of Sample is Not Out of Sample.&lt;/b&gt;&lt;/p&gt;&lt;p&gt;这两句话结合起来再翻译成中文就是&lt;b&gt;所有历史数据都是样本内&lt;/b&gt;。我对此深以为然。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;2 Out of Sample is NOT Really Out of Sample&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;针对 Out of Sample is Not Really Out of Sample 这个观点，Arnott, Harvey, and Markowitz (2019) 写到：&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;Researchers have lived through the hold-out sample and thus understand the history, are knowledgeable about when markets rose and fell, and associate leading variables with past experience. As such, no true out-of-sample data exist; the only true out of sample is the live trading experience.&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;对于预留出来的样本外数据，它们也是已经发生过的历史。&lt;b&gt;尽管模型将它们视作样本外，但由于我们经历了那段历史，知道在那段时间市场是如何发展的（什么时候涨、什么时候跌），会不可避免的把领先变量和这些历史经验联系起来。&lt;/b&gt;正是由于这个原因，历史数据中并没有真正的样本外，只有实盘交易才是真正的样本外。&lt;/p&gt;&lt;p&gt;举个例子。在因子选股中，我们通常会用 PE、ROE、EPS 等指标来选股，并按照各种逻辑 —— 比如动量或者估值 —— 进行难如登天的因子择时。在择时的时候，我们会非常小心的使用滚动窗口外推，利用 point in time 数据来避免 look-ahead bias（前视偏差）。&lt;b&gt;但无论是在全部回测期内多因子选股，还是使用滚动窗口在“样本外”做因子择时，这背后无法否认的事实是我们已经知道 PE、ROE、EPS 在过去整段历史时间内是有效的！&lt;/b&gt;&lt;/p&gt;&lt;p&gt;我们并不是在 10 年前就预见到了 PE、ROE、EPS 会有效并在过去的 10 年里使用它们；而是在已经知道市场在过去 10 年是如何展开的前提下，通过 empirical data analysis 找到了 PE、ROE、EPS 这些好使的因子然后再去对着它们回测。扪心自问一下，如果一个因子在回测期内的表现是近似随机的，我们会用它来做因子择时吗？&lt;b&gt;这当然不是说它们并没有业务依据，而只是想强调正是因为历史已经发生了，因此它不是真正的样本外。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;如果在样本内找到的因子在真正的样本外无效会在多大程度上削弱策略的表现呢？来看下面的实验。&lt;/p&gt;&lt;p&gt;假设回测期从 2010 年 1 月 1 日到 2019 年 1 月 31 日；以中证 500 的成分股为股票池。针对每个因子，使用其首尾各 10% 的股票按照等权构建多、空投资组合，以对冲后的组合的收益率作为因子收益率，每月末调仓且不考虑任何费用。下图显示了依照上述说明后找到 10 个回测期内年化夏普率在 0.8 到 1.0 之间的因子的累积净值（这些因子均来自基本面或量价信息、月收益率的平均相关系数为 0.1）。图中黑色粗线表示通过等权配置这些因子所构成的多因子策略的净值。该多因子策略的夏普率高达 2.56，年化收益率 9.58%。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-682c9ef31d35f6a4ed815cdbd0e94514_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;843&quot; data-rawheight=&quot;424&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;843&quot; data-original=&quot;https://pic1.zhimg.com/v2-682c9ef31d35f6a4ed815cdbd0e94514_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-682c9ef31d35f6a4ed815cdbd0e94514_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;843&quot; data-rawheight=&quot;424&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;843&quot; data-original=&quot;https://pic1.zhimg.com/v2-682c9ef31d35f6a4ed815cdbd0e94514_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-682c9ef31d35f6a4ed815cdbd0e94514_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;下面假设这 10 个因子中的 n 个（n 取值从 1 到 10）在真实样本外完全失效 —— 即样本外该因子实际上无法预测收益率。为了模拟“真实样本外完全失效”，我们从上述 10 个因子中随机选出 10 – n 个作为有效因子，并随机生成 n 个因子来模拟那些失效的因子，以此进行一次完整回测。为了得到这 10 个混合因子策略表现的分布，将上述过程进行 3000 次仿真，并考察回测期内每个时间点该策略累积净值的中位数、5% 分位数以及 95% 分位数。下图依次展示了当 n 从 1 取到 10 时，混合多因子策略的累积净值。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-326e7bee58dfbea6adccb8c8e2c59b97_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;894&quot; data-rawheight=&quot;709&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;894&quot; data-original=&quot;https://pic4.zhimg.com/v2-326e7bee58dfbea6adccb8c8e2c59b97_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-326e7bee58dfbea6adccb8c8e2c59b97_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;894&quot; data-rawheight=&quot;709&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;894&quot; data-original=&quot;https://pic4.zhimg.com/v2-326e7bee58dfbea6adccb8c8e2c59b97_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-326e7bee58dfbea6adccb8c8e2c59b97_b.jpg&quot;&gt;&lt;/figure&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-81ddcf0dbfbbb896e25886438428ff41_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;902&quot; data-rawheight=&quot;472&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;902&quot; data-original=&quot;https://pic2.zhimg.com/v2-81ddcf0dbfbbb896e25886438428ff41_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-81ddcf0dbfbbb896e25886438428ff41_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;902&quot; data-rawheight=&quot;472&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;902&quot; data-original=&quot;https://pic2.zhimg.com/v2-81ddcf0dbfbbb896e25886438428ff41_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-81ddcf0dbfbbb896e25886438428ff41_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;从上述结果不难看出，&lt;b&gt;随着无效因子个数的增加，策略表现的“中枢”（中位数）逐渐下移，且不确定性（体现为 5% 和 95% 分位数的净值）逐渐增大。&lt;/b&gt;在整个回测期末，上述 10 种 n 取值的策略表现总结于下表。对于样本内有效的 10 个因子，如果它们在真正的样本外全部失效（即无法预测收益率），那么该策略净值中位数为零，这符合我们的预期。如果运气没那么差，仅有 5 个无效，那么年化收益率的中位数为 4.69%；相比较样本内下降了 45.7%。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-c947daf71417968537d0cf560e887177_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;666&quot; data-rawheight=&quot;471&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;666&quot; data-original=&quot;https://pic4.zhimg.com/v2-c947daf71417968537d0cf560e887177_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-c947daf71417968537d0cf560e887177_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;666&quot; data-rawheight=&quot;471&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;666&quot; data-original=&quot;https://pic4.zhimg.com/v2-c947daf71417968537d0cf560e887177_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-c947daf71417968537d0cf560e887177_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;依照上述实验思路也可以对一些常见的因子择时思路进行验证。下面以主流的按因子动量择时，每年配置过去一年涨幅最高的五个因子。使用全部 10 个样本内有效的因子，加之上述择时策略，得到的效果如下，因子择时年化收益率为 11.21%，超过了 10 个因子等权配（夏普率没有超过）。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-b40558ddd9fa70fbc3c41f8c005865fe_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;728&quot; data-rawheight=&quot;347&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;728&quot; data-original=&quot;https://pic3.zhimg.com/v2-b40558ddd9fa70fbc3c41f8c005865fe_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-b40558ddd9fa70fbc3c41f8c005865fe_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;728&quot; data-rawheight=&quot;347&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;728&quot; data-original=&quot;https://pic3.zhimg.com/v2-b40558ddd9fa70fbc3c41f8c005865fe_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-b40558ddd9fa70fbc3c41f8c005865fe_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;同样的，假设 n 个因子在真实样本外失效，来看看对该择时策略的影响。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-50936717a68f5f229f28be17d962d6ec_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;893&quot; data-rawheight=&quot;707&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;893&quot; data-original=&quot;https://pic1.zhimg.com/v2-50936717a68f5f229f28be17d962d6ec_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-50936717a68f5f229f28be17d962d6ec_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;893&quot; data-rawheight=&quot;707&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;893&quot; data-original=&quot;https://pic1.zhimg.com/v2-50936717a68f5f229f28be17d962d6ec_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-50936717a68f5f229f28be17d962d6ec_b.jpg&quot;&gt;&lt;/figure&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-c61be6dc2c49f8343f74853fbd7dfedd_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;899&quot; data-rawheight=&quot;477&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;899&quot; data-original=&quot;https://pic2.zhimg.com/v2-c61be6dc2c49f8343f74853fbd7dfedd_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-c61be6dc2c49f8343f74853fbd7dfedd_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;899&quot; data-rawheight=&quot;477&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;899&quot; data-original=&quot;https://pic2.zhimg.com/v2-c61be6dc2c49f8343f74853fbd7dfedd_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-c61be6dc2c49f8343f74853fbd7dfedd_b.jpg&quot;&gt;&lt;/figure&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-d2971ca3fb243608b85e4a2d1a9c158b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;665&quot; data-rawheight=&quot;470&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;665&quot; data-original=&quot;https://pic4.zhimg.com/v2-d2971ca3fb243608b85e4a2d1a9c158b_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-d2971ca3fb243608b85e4a2d1a9c158b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;665&quot; data-rawheight=&quot;470&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;665&quot; data-original=&quot;https://pic4.zhimg.com/v2-d2971ca3fb243608b85e4a2d1a9c158b_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-d2971ca3fb243608b85e4a2d1a9c158b_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;和不择时相似，随着失效因子个数的增加，策略中位数表现下移、不确定性加大。如果把择时策略和之前的不择时策略横向比较一下（即考虑给定失效因子个数 n 下两个策略的表现），可以发现有意思的结果：样本内有效的择时策略在样本外的中枢同样优于不择时的策略，但代价是更高的波动；这个高波动是由因子失效和择时失效两方面的不确定性共同贡献的。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;3 Iterated Out of Sample is NOT Out of Sample&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;再来看看 Iterated Out of Sample is Not Out of Sample。对此，Arnott, Harvey, and Markowitz (2019) 写到：&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;Suppose a model is successful in the in-sample period but fails out of sample. The researcher observes that the model fails for a particular reason. The researcher modifies the initial model so it then works both in sample and out of sample.&lt;/i&gt; &lt;i&gt;&lt;b&gt;This is no longer an out-of-sample test. It is overfitting.&lt;/b&gt;&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;在&lt;a href=&quot;https://zhuanlan.zhihu.com/p/38256574&quot; class=&quot;internal&quot;&gt;《科学回测中的大学问》&lt;/a&gt;一文中，我们表达过完全一致的观点：&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;在可交易特征方面，满足一个策略假设的样本其实很少。举个极端的例子，比如 A 股中追踪大牛市的趋势类策略。在过去 20 年中，也仅有三波牛市，而且它们表现出来的市场特征均不相同（比如以 2007 年大牛市构建的趋势追踪策略在 2015 年大牛市中的逃顶效果并不好）。在这种情况下，如果还把数据分成训练集和测试集会怎样呢？&lt;b&gt;我们一定会把策略在测试集中的体现出来的新市场环境反馈到训练过程中，这已经违背了分训练集和测试集调参的本意；这等价于我们在整个历史数据中对策略的参数调优了。&lt;/b&gt;&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;来看一个简单的例子 —— 针对沪深 300 指数使用双均线择时。&lt;/p&gt;&lt;p&gt;假设使用 2005 年 1 月 1 日到 2011 年 12 月 31 日作为样本内数据；使用 2012 年 1 月 1 日到 2019 年 2 月 25 日为“样本外”数据。在样本内，使用 2 天窗口计算快均线、40 天窗口计算慢均线效果非常理想（下图），其年化收益率超过 30%，夏普率高达 1.3。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-6963187947228a0dd56d961d2a02ed86_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;829&quot; data-rawheight=&quot;323&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;829&quot; data-original=&quot;https://pic3.zhimg.com/v2-6963187947228a0dd56d961d2a02ed86_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-6963187947228a0dd56d961d2a02ed86_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;829&quot; data-rawheight=&quot;323&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;829&quot; data-original=&quot;https://pic3.zhimg.com/v2-6963187947228a0dd56d961d2a02ed86_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-6963187947228a0dd56d961d2a02ed86_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;再来看看这组参数在“样本外”的表现。不幸的是，该策略在样本外的年化收益不到 8%、最大回撤 -25.95%、夏普率仅有 0.51。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-f02b9c470e418cc65a45f36b54fa063b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;833&quot; data-rawheight=&quot;323&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;833&quot; data-original=&quot;https://pic4.zhimg.com/v2-f02b9c470e418cc65a45f36b54fa063b_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-f02b9c470e418cc65a45f36b54fa063b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;833&quot; data-rawheight=&quot;323&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;833&quot; data-original=&quot;https://pic4.zhimg.com/v2-f02b9c470e418cc65a45f36b54fa063b_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-f02b9c470e418cc65a45f36b54fa063b_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;如果对着“样本外”搜参数，则最优的快、慢均线窗口参数是 20 和 24，其夏普率也仅有 0.70，远远差于 2012 年之前的表现。考虑到这种情况，很自然的想法就是添加更复杂的逻辑来提高 2012 年之后的表现。显然，这不是样本外测试，而是过拟合。&lt;/p&gt;&lt;p&gt;&lt;b&gt;无论从独立性还是可交易特征而言，交易数据其实都是十分匮乏的。&lt;/b&gt;从构建策略的角度来说，如果要求策略能够适应不同的市场状态，那么基于历史数据不断迭代的样本外并不是真正的样本外。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;4 结语&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;所有的历史数据都是样本内。&lt;/p&gt;&lt;p&gt;&lt;b&gt;我们构建策略靠的不是站在回测起点往后看的先见之明，而是站在回测终点往前看的后见之明。&lt;/b&gt;诚然，这并不意味着策略就不靠谱或者一定是数据挖掘的产物。但是，意识到这一点会让我们更加相信来自金融学或经济学先验的指标或因果关系，并防止我们沉迷于纯粹基于数据的交叉验证。&lt;/p&gt;&lt;p&gt;AQR 曾写过一篇题为 Buffett’s Alpha 的文章分析巴菲特的投资组合。结果显示，巴菲特投资组合的收益几乎可以被市场因子和五个如今我们这些后见之明的凡夫俗子能够理解的风格因子的 β 来解释。而反观巴菲特，他是在几十年前就按照这些风格因子来投资了，那是真正的样本外。&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;Buffett figured out things we think are genius many years before we all did. —— Cliff Asness&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;参考文献&lt;/b&gt;&lt;/p&gt;&lt;p&gt;Arnott, R., C. R. Harvey, and H. Markowitz (2019). A backtesting protocol in the era of machine learning. &lt;i&gt;Journal of Financial Data Science&lt;/i&gt;, Vol. 1(1), 64 – 74.&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处，谢谢。已委托“维权骑士”(&lt;a href=&quot;http://link.zhihu.com/?target=http%3A//rightknights.com&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;维权骑士_免费版权监测/版权保护/版权分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2019-02-28-57911231</guid>
<pubDate>Thu, 28 Feb 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>一个加入行为因子的复合模型</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2019-02-21-57314781.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/57314781&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-1525e3152bb401e5795de2009960ab23_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;摘要&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;Daniel, Hirshleifer, and Sun (2018) 提出了两个行为因子，在市场因子基础上构建了复合三因子模型，为实证资产定价提供了新的思路。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;1 引言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;2018 年，最新一届的 Hillcrest Behavioral Finance Award 授予了 Daniel, Hirshleifer, and Sun (2018) 这篇题为 Short- and long-horizon behavioral factors 的文章（下称 DHS）。这篇文章从来自 75 个研究机构的 103 为作者所提交的 56 篇文章中脱颖而出，获此殊荣。&lt;/p&gt;&lt;p&gt;从它的题目中就能看出，&lt;b&gt;该文提出了长、短两个时间尺度上的行为因子（behavioral factors）。这两个行为因子旨在捕捉由于过度自信和有限注意力造成的定价错误，从而解释学术界之前发现的大量选股异象。&lt;/b&gt;此外，它结合市场因子一起构建了一个&lt;b&gt;复合三因子模型（a three-factor risk-and-behavioral composite model）&lt;/b&gt;，为多因子模型的研究提供了新的思路。&lt;/p&gt;&lt;p&gt;从行为金融学的角度出发，股票收益率之间的共同运动（comovement）通常有两个原因：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;股票错误定价上的共性（Barberis and Shleifer 2003）；&lt;/li&gt;&lt;li&gt;投资者对于股票基本面新息的错误反映上的共性（Daniel, Hirshleifer, and Subrahmanyam 2001）。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;前者指出不同的股票实际上暴露在一些共同的风格风险上，而情绪冲击（sentiment shocks）会造成同一类风格的股票收益率的共同运动，因此同一类风格上的股票存在相关性很高的定价错误。后者说明由于认知偏差，投资者难以对股票基本面方面的新息做出及时、正确的反映，因此也会导致错误定价。&lt;b&gt;由于错误定价可以预测未来收益率，这意味着可以使用行为因子来构建一个多因子模型，以期更好的解释股票预期收益率之间的截面差异。&lt;/b&gt;这就是 Daniel, Hirshleifer, and Sun (2018) 背后的动机。&lt;/p&gt;&lt;p&gt;由于是要提出新的定价模型，它的任务之一是能够解释市场上的异象。按照这个思路，DHS 指出市场上的绝大多数异象按照时间尺度可以分为&lt;b&gt;短（short horizon）&lt;/b&gt;和&lt;b&gt;长（long horizon）&lt;/b&gt;两大类；短时间尺度的异象大多来自投资者的&lt;b&gt;有限注意力（limited attention）&lt;/b&gt;、长时间尺度的异象大多来自投资者的&lt;b&gt;过度自信（overconfidence）&lt;/b&gt;。为此三位作者提出了捕捉长尺度异象的 FIN 因子和捕捉短尺度异象的 PEAD 因子。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;2 长、短时间尺度的行为因子&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;先来看看捕捉长时间尺度的 FIN 因子，它使用上市公司股票发行（issuance）和回购（repurchase）计算。研究表明，&lt;b&gt;由于具备信息优势，公司的管理层善于利用市场上已经形成的定价错误“择时”自己公司的股价：当他们认为公司股价过高时，往往会增发；而当公司股价被低估时，通常采取回购。&lt;/b&gt;另一方面，普通（非理性）投资者往往过度自信，导致对上市公司增发、回购行为反应不足，使得股价不会在短期修正。&lt;/p&gt;&lt;p&gt;大量（美股上）的实证表明，&lt;b&gt;增发行为和未来的收益率负相关，而回购行为和未来的收益率正相关&lt;/b&gt;。为此，DHS 使用以下两个指标构建了他们的 FIN 因子：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;过去一年的 net-share-issuance（简称 NSI，出自 Pontiff and Woodgate 2008）；&lt;/li&gt;&lt;li&gt;过去五年的 composite-share-issuance（简称 CSI，出自 Daniel and Titman 2006）。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;综合 NSI 和 CSI（取均值）就得到了 FIN 指标，越小越好。除此之外，DHS 采用了 Fama-French 三因子中的做法，使用 FIN 指标（按从小到大排名）和市值对上市公司进行了如下的 2 × 3 划分。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-37892d629893c70dc4d8623ecb4f7d59_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;700&quot; data-rawheight=&quot;210&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;700&quot; data-original=&quot;https://pic2.zhimg.com/v2-37892d629893c70dc4d8623ecb4f7d59_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-37892d629893c70dc4d8623ecb4f7d59_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;700&quot; data-rawheight=&quot;210&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;700&quot; data-original=&quot;https://pic2.zhimg.com/v2-37892d629893c70dc4d8623ecb4f7d59_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-37892d629893c70dc4d8623ecb4f7d59_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;依上述划分，最终 FIN 因子定义为：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BFIN%7D%3D%5Cdisplaystyle%5Cfrac%7B1%7D%7B2%7D%28%5Cmbox%7BS%2FL%2BB%2FL%7D%29-%5Cfrac%7B1%7D%7B2%7D%28%5Cmbox%7BS%2FH%2BB%2FH%7D%29&quot; alt=&quot;\mbox{FIN}=\displaystyle\frac{1}{2}(\mbox{S/L+B/L})-\frac{1}{2}(\mbox{S/H+B/H})&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;由于增发和回购有很多合规的要求，因此上市公司不可能频繁的使用。此外，如果哪个上市公司频繁的增发或回购也会导致投资者的怀疑。因此该因子的变化非常缓慢，而其对应的错误定价的修正也是在很长的时间尺度上才能完成的。它仅能解释长尺度上的异象（大于 1 年，通常 3 到 5 年），而对小于 1 年尺度上的异象无能为力。&lt;/p&gt;&lt;p&gt;为此，DHS 提出了第二个行为因子 —— PEAD。&lt;/p&gt;&lt;p&gt;我们对 PEAD —— post-earnings announcement drift —— 并不陌生。&lt;b&gt;大量实证显示，拥有 positive earnings surprise 的公司的股票比 negative earnings surprise 的公司的股票在未来 6 到 9 个月内能获得更高的收益。&lt;/b&gt;之所以出现这种原因是因为投资者的有限注意力使得他们对最新的 earnings 新息反应不足（DellaVigna and Pollet 2009，Hirshleifer and Teoh 2003）。&lt;/p&gt;&lt;p&gt;为了捕捉上述反应不足，DHS 以上市公司最近的一个财报的披露日期为时间零点，计算 [-2, 1] 窗口内 —— 即披露之前两个交易日到披露后的一个交易日 —— 其相对于市场的累积超额收益率（cumulative abnormal return，简称 CAR）作为评价指标：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BCAR%7D_i%3D%5Cdisplaystyle%5Csum_%7Bd%3D-2%7D%5E%7Bd%3D1%7D%28R_%7Bi%2Cd%7D-R_%7Bm%2Cd%7D%29&quot; alt=&quot;\mbox{CAR}_i=\displaystyle\sum_{d=-2}^{d=1}(R_{i,d}-R_{m,d})&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;其中 R_{i,d} 为上市公司 i 在其最近一个披露期窗口内第 d 日的收益率；R_{m,d} 为市场在同期的收益率。由于投资者反应不足，该窗口内的收益率和未来的收益率正相关，因此该指标越大越好。和 FIN 的处理一样，使用 CAR（按从大到小排名）和市值对上市公司进行了如下 2 × 3 划分：&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-afffb12915206087359ce8ddb77fce2e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;703&quot; data-rawheight=&quot;210&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;703&quot; data-original=&quot;https://pic3.zhimg.com/v2-afffb12915206087359ce8ddb77fce2e_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-afffb12915206087359ce8ddb77fce2e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;703&quot; data-rawheight=&quot;210&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;703&quot; data-original=&quot;https://pic3.zhimg.com/v2-afffb12915206087359ce8ddb77fce2e_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-afffb12915206087359ce8ddb77fce2e_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;依上述划分，最终 PEAD 因子定义为：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BPEAD%7D%3D%5Cdisplaystyle%5Cfrac%7B1%7D%7B2%7D%28%5Cmbox%7BS%2FH%2BB%2FH%7D%29-%5Cfrac%7B1%7D%7B2%7D%28%5Cmbox%7BS%2FL%2BB%2FL%7D%29&quot; alt=&quot;\mbox{PEAD}=\displaystyle\frac{1}{2}(\mbox{S/H+B/H})-\frac{1}{2}(\mbox{S/L+B/L})&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;以上就是长、短时间尺度上的行为因子 FIN 和 PEAD 的构建方法。对于 FIN 因子，每年六月更新一次；对于 PEAD 因子，每月更新。使用 FIN 和 PEAD 两个因子，再加上代表市场风险的 MKT 因子，DHS 提出了他们的复合三因子模型：MKT、FIN 和 PEAD。&lt;/p&gt;&lt;p&gt;下面就来看看这个新模型和其他主流多因子模型的异同。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;3 不同模型比较&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;在比较不同的多因子模型时，Barillas and Shanken (2018) 指出：&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;... the model should be compared in terms of their ability to price all returns, both test assets and traded factors.&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;这句话的意思是，&lt;b&gt;一个优秀的多因子模型应该既能解释异象（test assets），又能解释其他模型中的因子（traded factors）。&lt;/b&gt;首先来看看 DHS 的两个行为因子能否解释其他主流模型中的因子。测试中考虑的其他多因子模型如下表所示（具体解释请参考&lt;a href=&quot;https://zhuanlan.zhihu.com/p/56614427&quot; class=&quot;internal&quot;&gt;《Anomalies, Factors, and Multi-Factor Models》&lt;/a&gt;）。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-72bf9397b25cb9472036d96a643dad5c_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;828&quot; data-rawheight=&quot;299&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;828&quot; data-original=&quot;https://pic1.zhimg.com/v2-72bf9397b25cb9472036d96a643dad5c_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-72bf9397b25cb9472036d96a643dad5c_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;828&quot; data-rawheight=&quot;299&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;828&quot; data-original=&quot;https://pic1.zhimg.com/v2-72bf9397b25cb9472036d96a643dad5c_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-72bf9397b25cb9472036d96a643dad5c_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;上述模型中，有些因子相同但是构建方法不同。比如 Fama-French 三因子和五因子模型中的 HML 因子和 Novy-Marx 四因子中的 HML 不同，为了区分，后者记为 HML(NM)。其他因子缩写遵循同样的命名原则。&lt;/p&gt;&lt;p&gt;下面两图显示了上述因子在实证日期内获取收益的能力和它们之间的相关性。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-aed8e9de4250d22bfa6d20a4857bb366_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;667&quot; data-rawheight=&quot;493&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;667&quot; data-original=&quot;https://pic3.zhimg.com/v2-aed8e9de4250d22bfa6d20a4857bb366_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-aed8e9de4250d22bfa6d20a4857bb366_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;667&quot; data-rawheight=&quot;493&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;667&quot; data-original=&quot;https://pic3.zhimg.com/v2-aed8e9de4250d22bfa6d20a4857bb366_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-aed8e9de4250d22bfa6d20a4857bb366_b.jpg&quot;&gt;&lt;/figure&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-8bb5decd0d668a36ca54be64688df1c1_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;843&quot; data-rawheight=&quot;361&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;843&quot; data-original=&quot;https://pic2.zhimg.com/v2-8bb5decd0d668a36ca54be64688df1c1_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-8bb5decd0d668a36ca54be64688df1c1_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;843&quot; data-rawheight=&quot;361&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;843&quot; data-original=&quot;https://pic2.zhimg.com/v2-8bb5decd0d668a36ca54be64688df1c1_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-8bb5decd0d668a36ca54be64688df1c1_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;接下来看看不同因子模型的比较。在这方面，最简单的方法就是看不同模型之间的因子能否相互解释，遵循一种“如果我能解释你、但是你不能解释我，那我就比你 NB”的思路。首先来看看 DHS 的 FIN 和 PEAD 因子能否被其他模型解释。&lt;/p&gt;&lt;p&gt;下图表明，PEAD 因子可以获得其他模型无法解释的超额收益（α 那一列）。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-2d201cde035c98779ea5e56dc0434b40_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1048&quot; data-rawheight=&quot;511&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1048&quot; data-original=&quot;https://pic1.zhimg.com/v2-2d201cde035c98779ea5e56dc0434b40_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-2d201cde035c98779ea5e56dc0434b40_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1048&quot; data-rawheight=&quot;511&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1048&quot; data-original=&quot;https://pic1.zhimg.com/v2-2d201cde035c98779ea5e56dc0434b40_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-2d201cde035c98779ea5e56dc0434b40_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;对于 FIN 因子（下图），绝大对数已有模型无法解释，例外是 NM 和 SY4 模型。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-145f0d32adf2be456f6c4a6de7bacb2a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;964&quot; data-rawheight=&quot;476&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;964&quot; data-original=&quot;https://pic3.zhimg.com/v2-145f0d32adf2be456f6c4a6de7bacb2a_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-145f0d32adf2be456f6c4a6de7bacb2a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;964&quot; data-rawheight=&quot;476&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;964&quot; data-original=&quot;https://pic3.zhimg.com/v2-145f0d32adf2be456f6c4a6de7bacb2a_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-145f0d32adf2be456f6c4a6de7bacb2a_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;再来看看 FIN 和 PEAD 因子联合起来能否解释其他模型中的因子。下图中左侧展示了仅考虑 FIN 和 PEAD 的结果，右侧展示了考虑 MKT、FIN 和 PEAD 这个三因子模型的结果。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-6e8272eb1b576f10ad5b4375eed61c11_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;800&quot; data-rawheight=&quot;561&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;800&quot; data-original=&quot;https://pic2.zhimg.com/v2-6e8272eb1b576f10ad5b4375eed61c11_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-6e8272eb1b576f10ad5b4375eed61c11_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;800&quot; data-rawheight=&quot;561&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;800&quot; data-original=&quot;https://pic2.zhimg.com/v2-6e8272eb1b576f10ad5b4375eed61c11_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-6e8272eb1b576f10ad5b4375eed61c11_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;结果显示 DHS 提出的三因子模型能够解释其他模型中绝大部分因子，然而 Fama-French 三因子中的 SMB、Novy-Marx 四因子中的 PMU 以及 HXZ4 四因子中的 IVA 因子可以获得 DHS 三因子无法解释的超额收益。其中，PMU 和 IVA 分别代表两个主流的维度 —— Profitability 和 Investment。&lt;b&gt;DHS 的复合三因子模型对其解释力度较弱不免有些令人失望。&lt;/b&gt;另外一个无法解释的是 SMB 市值因子，我们会在本文第四节加以讨论。&lt;/p&gt;&lt;p&gt;最后来看看不同多因子模型解释异象的能力。DHS 从 Hou, Xue, and Zhang (2015) 考察的 73 个异象中找出了 34 个，其中短时间尺度异象 12 个、长时间尺度异象 22 个。使用不同的检验标准，DHS 比较了不同模型在解释这些异象方面的能力（下图）。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-77f2bd4ed64544724e4238f72ecd33c9_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;919&quot; data-rawheight=&quot;618&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;919&quot; data-original=&quot;https://pic2.zhimg.com/v2-77f2bd4ed64544724e4238f72ecd33c9_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-77f2bd4ed64544724e4238f72ecd33c9_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;919&quot; data-rawheight=&quot;618&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;919&quot; data-original=&quot;https://pic2.zhimg.com/v2-77f2bd4ed64544724e4238f72ecd33c9_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-77f2bd4ed64544724e4238f72ecd33c9_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;结果表明复合三因子模型解释了全部短时间尺度异象，其在这方面的表现优于所有其他模型。对于长时间尺度异象，DHS 在 5% 的显著性水平下解释了 22 个中的 19 个，其表现和 NM 以及 SY4 模型相当，优于其他多因子模型。如果把全部 34 个异象放在一起综合考虑，复合三因子模型战胜了其他全部模型。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-ee5280b8984d8998466b62345f10c0ad_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1042&quot; data-rawheight=&quot;374&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1042&quot; data-original=&quot;https://pic2.zhimg.com/v2-ee5280b8984d8998466b62345f10c0ad_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-ee5280b8984d8998466b62345f10c0ad_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1042&quot; data-rawheight=&quot;374&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1042&quot; data-original=&quot;https://pic2.zhimg.com/v2-ee5280b8984d8998466b62345f10c0ad_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-ee5280b8984d8998466b62345f10c0ad_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;从上述实证结果来看，DHS 的三因子模型和其他主流多因子模型相比，无论从解释因子还是解释异象上来说，都十分优秀。当然，它也有其不足之处，比如无法解释 PMU 和 IVA 这两个代表 profitability 和 investment 维度的因子。&lt;/p&gt;&lt;p&gt;除了上述比较外，DHS 还从因子的复杂度层面，基于 &lt;b&gt;The Law of Parsimony（简约法则）&lt;/b&gt;的理念比较了不同的模型，并指出他们的模型由于有更少的因子和使用了更少的指标而在这方面有一定的优势。关于这方面的讨论，在&lt;a href=&quot;https://zhuanlan.zhihu.com/p/56614427&quot; class=&quot;internal&quot;&gt;之前的文章&lt;/a&gt;中已经有了介绍，这里不再赘述。&lt;/p&gt;&lt;p&gt;无论从实证数据的结果还是从模型简约程度来说，复合三因子模型确实让人眼前一亮。不过别急，在我们给它更多的赞美之前，有大佬有话要说。我们搬好小板凳看“神仙打架”。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;4 质疑之声&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;为了庆祝 Richard Thaler 获得 2017 年诺贝尔经济学奖，2018 年美国金融协会年会上特地设立了一个 Behavioral Finance session（尽管 Thaler 获奖更多的是因为他在 Behavioral Economics 上的贡献）。在这个 session 中充分讨论了三篇论文（每篇一个 presenter 和 一个 discussant），而 DHS 就是其中一篇。&lt;/p&gt;&lt;p&gt;这篇文章的 discussant 正是来自 UPenn 的 Robert Stambaugh —— SY4 四因子模型的作者之一。他的模型被 DHS 用新复合三因子模型“狠狠”的对比了一番（尤其在本文没有包括的 Parsimony 部分），滋味可想而知（也许是我狭隘了），于是在讨论环节从四个方面“怼”了 DHS 模型。本节介绍两个方面。&lt;/p&gt;&lt;p&gt;&lt;b&gt;第一个质疑是比较不同模型时选用的异象是否存在 data snooping。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;Stambaugh 指出，DHS 既然用了 Hou, Xue, and Zhang (2015) 中涉及的异象，为什么只选了 34 个呢？这里面是否有有意或者无意的原因呢？他建议考察全部 73 个异象。除了 MKT 外，DHS 和 SY4 中共涉及 PEAD、FIN、PERF 和 MGMT 四个因子。对于每个因子，从这 73 个异象中排除和它最相关的 5 个，最终得到 58 个异象（其中 16 个短时间尺度、42 个长时间尺度）。考察这两个模型解释这些异象的能力，结果（下图）显示 SY4 战胜了 DHS —— Stambaugh 扳回一城。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-6ed4463f330f0b39ea306fec0c7beca8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;604&quot; data-rawheight=&quot;314&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;604&quot; data-original=&quot;https://pic1.zhimg.com/v2-6ed4463f330f0b39ea306fec0c7beca8_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-6ed4463f330f0b39ea306fec0c7beca8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;604&quot; data-rawheight=&quot;314&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;604&quot; data-original=&quot;https://pic1.zhimg.com/v2-6ed4463f330f0b39ea306fec0c7beca8_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-6ed4463f330f0b39ea306fec0c7beca8_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;第二个质疑是为什么不考虑 size 因子。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;实证结果显示，DHS 的模型无法解释 Fama-French 模型中的 SMB 因子以及 SY4 中的 SMB 因子（下图）。大量的研究表明，股票收益率中存在显著的和 size 有关同步运动，而无论 FIN 还是 PEAD 因子在构建时，通过 2 × 3 划分刻意排除了 size 的影响，因此无法解释 size 因子。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-3319caea7bcbe2225cae7d7b981e8394_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;690&quot; data-rawheight=&quot;143&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;690&quot; data-original=&quot;https://pic1.zhimg.com/v2-3319caea7bcbe2225cae7d7b981e8394_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-3319caea7bcbe2225cae7d7b981e8394_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;690&quot; data-rawheight=&quot;143&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;690&quot; data-original=&quot;https://pic1.zhimg.com/v2-3319caea7bcbe2225cae7d7b981e8394_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-3319caea7bcbe2225cae7d7b981e8394_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;基于此，Stambaugh 建议在 DHS 中加入 size 因子。Stambaugh 比较了 DHS 原模型（记为 BF3）和加入 size 因子的 BF4 模型在另外 11 个异象中的表现，不过结果显示加入 size 因子后，能解释的异象表少了（5% 显著性水平下显著的异象从 3 个增加到 6 个），这从侧面说明了 BF3 模型不是那么稳定（是否正因解释的异象变少了而没有加入 size 不得而知），还有很多的实证分析可以研究。Stambaugh 再下一城。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-fe95af7d81f240c83ee78a2f5a418ef2_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;790&quot; data-rawheight=&quot;465&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;790&quot; data-original=&quot;https://pic3.zhimg.com/v2-fe95af7d81f240c83ee78a2f5a418ef2_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-fe95af7d81f240c83ee78a2f5a418ef2_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;790&quot; data-rawheight=&quot;465&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;790&quot; data-original=&quot;https://pic3.zhimg.com/v2-fe95af7d81f240c83ee78a2f5a418ef2_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-fe95af7d81f240c83ee78a2f5a418ef2_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;好了，对“神仙打架”的介绍到此结束。想通过它传达的是，&lt;b&gt;没有一个模型是完美的，而我们需要时刻保持理性的态度，使用科学的手段，客观的评价不同模型的优劣。&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;5 结语&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;市场中的交易者都是非理性的，每个人带有不同程度的心理偏差，集体的心理偏差体现出长时间尺度上的过度自信和短时间尺度上的有限注意力，它们又进而造成了错误定价。以此为动机，DHS 提出了两个行为因子 FIN 和 PEAD，并加上市场因子 MKT 构建了复合三因子模型，为实证资产定价提供了新的思路。&lt;/p&gt;&lt;p&gt;得益于 Daniel Kahneman、Amos Tversky、Richard Thaler 等学者的开拓性研究，如今心理学和经济学以及金融学的融合已经广泛被人所接受。行为金融学也是在这个大潮中发展起来并逐渐占据了一席之地，对帮助我们理解市场、理解投资者的非理性行为提供了有力的武器。DHS 的复合三因子模型将这个思路延续到了实证资产定价中，是一个值得肯定的尝试。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;参考文献&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Barberis, N. and A. Shleifer (2003). Style investing. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 68(2), 161 – 199.&lt;/li&gt;&lt;li&gt;Barillas, F. and J. Shanken (2018). Comparing asset pricing models. &lt;i&gt;Journal of Finance&lt;/i&gt;, Vol. 73(2), 715 – 754.&lt;/li&gt;&lt;li&gt;Carhart, M. M. (1997). On Persistence in Mutual Fund Performance. &lt;i&gt;Journal of Finance&lt;/i&gt;, Vol. 52(1), 57 – 82.&lt;/li&gt;&lt;li&gt;Daniel, K. D., D. Hirshleifer, and A. Subrahmannyam (1998). Investor psychology and security market under- and overreactions. &lt;i&gt;Journal of Finance&lt;/i&gt;, Vol. 53(6), 1839 – 1885.&lt;/li&gt;&lt;li&gt;Daniel, K. D., D. Hirshleifer, and A. Subrahmannyam (2001). Overconfidence, arbitrage, and equilibrium asset pricing. &lt;i&gt;Journal of Finance&lt;/i&gt;, Vol. 56(3), 921 – 965.&lt;/li&gt;&lt;li&gt;Daniel, K. D., D. A. Hirshleifer, and L. Sun (2018). Short- and long-horizon behavioral factors. Columbia Business School Research Paper No. 18-5. Available at SSRN: &lt;a href=&quot;http://link.zhihu.com/?target=https%3A//ssrn.com/abstract%3D3086063&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;ssrn.com/abstract=30860&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;63&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;.&lt;/li&gt;&lt;li&gt;Daniel, K. D. and S. Titman (2006). Market reactions to tangible and intangible information.&lt;i&gt;Journal of Finance&lt;/i&gt;, Vol. 61(4), 1605 – 1643.&lt;/li&gt;&lt;li&gt;DellaVigna, S. and J. Pollet (2009). Investor Inattention and Friday Earnings Announcements. &lt;i&gt;Journal of Finance&lt;/i&gt;, Vol. 64(2), 709 – 749.&lt;/li&gt;&lt;li&gt;Fama, E. F. and K. R. French (1993). Common Risk Factors in the Returns on Stocks and Bonds. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 33(1), 3 – 56.&lt;/li&gt;&lt;li&gt;Fama, E. F. and K. R. French (2015). A Five-Factor Asset Pricing Model. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 116(1), 1 – 22.&lt;/li&gt;&lt;li&gt;Hirshleifer, D. and S. H. Teoh (2003). Limited attention, information disclosure, and financial reporting. &lt;i&gt;Journal of Accounting and Economics&lt;/i&gt;, Vol. 36(1), 337 – 386.&lt;/li&gt;&lt;li&gt;Hou, K., C. Xue, and L. Zhang (2015). Digesting anomalies: An investment approach.&lt;i&gt;Review of Financial Studies&lt;/i&gt;, Vol. 28(3), 650 – 705.&lt;/li&gt;&lt;li&gt;Novy-Marx, R. (2013). The other side of value: The gross profitability premium. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 108 (1), 1 – 28.&lt;/li&gt;&lt;li&gt;Pontiff, J. and A. Woodgate (2008). Share issuance and cross-sectional returns. &lt;i&gt;Journal of Finance&lt;/i&gt;, Vol. 63(2), 921 – 945.&lt;/li&gt;&lt;li&gt;Stambaugh, R. F. and Y. Yuan (2016). Mispricing Factors. &lt;i&gt;Review of Financial Studies&lt;/i&gt;, Vol. 30(4), 1270 – 1315.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处，谢谢。已委托“维权骑士”(&lt;a href=&quot;http://link.zhihu.com/?target=http%3A//rightknights.com&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;维权骑士_免费版权监测/版权保护/版权分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2019-02-21-57314781</guid>
<pubDate>Thu, 21 Feb 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>Anomalies, Factors, and Multi-Factor Models</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2019-02-13-56614427.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/56614427&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-0407c08c16c0b0bd0fc406cbc0a0f6e7_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;摘要&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;本文解释了异象、因子以及多因子模型的区别和联系；梳理了从异象到因子再到模型背后的逻辑；介绍了学术界研究多因子模型的主流统计手段。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;1 引言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;在 empirical asset pricing 和 factor investing 中，anomalies（异象）、factors（因子）以及 multi-factor models（多因子模型）是三个常见的概念。从这些概念出发又能很自然的引发出一系列问题：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;什么是 anomalies；什么是 factors？&lt;/li&gt;&lt;li&gt;Anomalies 和 factors 有什么区别？&lt;/li&gt;&lt;li&gt;一个 multi-factor model 中应该包含多少个 factors？&lt;/li&gt;&lt;li&gt;学术界有哪些主流的 multi-factor models？&lt;/li&gt;&lt;li&gt;如何比较并在不同的 multi-factor models 之间取舍？&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;在过去几十年里，海外学术界对上述问题进行了大量的探索，留下了很多宝贵的实证结果和分析手段。而对于像你、我一样进行因子投资的投资者来说，搞清楚这些问题对于构建系统和全面的因子投资分析体系至关重要。本文试图回答上述五个问题。&lt;/p&gt;&lt;p&gt;在开始之前，先来唠两句标题。这是我第一次使用纯英文标题，倒是也没有什么特别的原因。对于文章标题，我一贯的看法是杜绝惊世骇俗，只求言简意赅、切中要害，再有就是“读来有感觉”。本文的标题翻译中文是“异象、因子和多因子模型”，实在平淡无奇，所以就索性用英文了。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;2 Anomalies&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;多因子模型是 empirical asset pricing 的一种常见方法；其研究的核心问题是找到一组能够解释股票预期收益率截面差异的因子（见&lt;a href=&quot;https://zhuanlan.zhihu.com/p/40984029&quot; class=&quot;internal&quot;&gt;《股票多因子模型的回归检验》&lt;/a&gt;）。&lt;b&gt;假使我们根据基本面特征或量价指标（或 whatever，下面统称为特征）挑选出一揽子股票并构建多空投资组合；如果该组合的收益率无法被用于 asset pricing 的多因子模型解释，则称该特征为一个异象（anomaly）。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;在数学上，这意味着该组合有模型无法解释的 α 收益率：以使用该特征构建的多空组合收益率为被解释变量放在回归方程的左侧，以多因子模型中因子收益率为解释变量放在回归方程的右边，进行时序回归，回归的截距项就是 α 收益率；如果 α 显著不为零，则说明该特征是一个异象。&lt;/p&gt;&lt;p&gt;举个例子。&lt;a href=&quot;https://zhuanlan.zhihu.com/p/44781908&quot; class=&quot;internal&quot;&gt;《获取 α 的新思路：科技关联度》&lt;/a&gt;一文介绍了 Lee et al. (2018) 这篇文章；使用科技关联度选股的多空对冲投资组合获得了主流多因子模型无法解释的 α 收益率（下图），因此它是一个异象。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-5519afc0bf7c026e91e6256824566154_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;845&quot; data-rawheight=&quot;362&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;845&quot; data-original=&quot;https://pic1.zhimg.com/v2-5519afc0bf7c026e91e6256824566154_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-5519afc0bf7c026e91e6256824566154_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;845&quot; data-rawheight=&quot;362&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;845&quot; data-original=&quot;https://pic1.zhimg.com/v2-5519afc0bf7c026e91e6256824566154_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-5519afc0bf7c026e91e6256824566154_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;从有效市场假说的观点出发，市场中不应该存在很多异象。当然，有效市场假说并不完美，再加上学术界几十年来的“不懈努力”，针对美股挖掘出了 400+ 个异象，这些异象在样本内的统计检验中都获得了很高的 t-statistics。&lt;/p&gt;&lt;p&gt;产生如此多的异象主要有两个原因：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;b&gt;第一个也是最主要的一个原因是数据挖掘。&lt;/b&gt;在 &lt;a href=&quot;https://zhuanlan.zhihu.com/p/38663777&quot; class=&quot;internal&quot;&gt;p-hacking&lt;/a&gt; 的激励和 multiple testing 的盛行下，大量所谓的异象在样本内被挖出。Harvey, Liu and Zhu (2016) 研究了学术界发表的 316 个所谓显著异象，并指出再考虑了 multiple testing 的影响后，异象收益率的 t-statistic 至少要超过 3.0（而非人们传统认为的 5% 的显著性水平对应的 2.0）才有可能是真正有效、而非来自运气。&lt;/li&gt;&lt;li&gt;&lt;b&gt;第二个原因和回归方程右侧的定价模型有关。&lt;/b&gt;比如，如果仅以 CAPM 为定价模型，那么很多异象都能获得 CAPM 无法解释的 α 收益率；随着定价模型中因子个数的增加，更多的异象变得不再显著。然而，真正的定价模型是未知的。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;谈及对异象的研究，不能不提的一篇文章是 Hou, Xue and Zhang (2017)。这篇长达 146 页的文章惊人的复现了学术界提出的 447 个异象，涵盖动量（57个）、价值/成长（68个）、投资（38个）、盈利（79个）、无形资产（103个）、以及交易摩擦（102个）六大类。下图节选了少量动量类异象说明，感受一下。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-b0faff0a4828608a0306b2d3ff94c2ae_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;718&quot; data-rawheight=&quot;670&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;718&quot; data-original=&quot;https://pic3.zhimg.com/v2-b0faff0a4828608a0306b2d3ff94c2ae_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-b0faff0a4828608a0306b2d3ff94c2ae_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;718&quot; data-rawheight=&quot;670&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;718&quot; data-original=&quot;https://pic3.zhimg.com/v2-b0faff0a4828608a0306b2d3ff94c2ae_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-b0faff0a4828608a0306b2d3ff94c2ae_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;对于这 447 个异象，当排除了微小市值股票的影响后，其中 286 个（64%）不再显著（在 5% 的显著性水平下，下同）；如果按照 Harvey, Liu and Zhu (2016) 的建议把 t-statistic 阈值提升到 3.0，则其中 380 个（85%）异象不再显著；最后，如果使用 Hou, Xue and Zhang (2015) 提出的 4 因子模型作为定价模型，那么其中 436 个（98%）异象不再显著，剩余存活的仅有 11 个。&lt;/p&gt;&lt;p&gt;好一个数据挖掘！&lt;/p&gt;&lt;p&gt;除此之外，Linnainmaa and Roberts (2018) 花费了很大的经历构建了全新的样本外数据，研究了美股中源于会计数据的 36 个异象在样本内、外的表现的差异。分析表明，绝大部分异象在样本外明显失效，它们的失效说明这些异象并非来自未知风险以及错误定价这两种解释，而更有可能仅仅是数据挖掘的产物。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;3 Factors&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;上一节介绍了异象，本节就来看看什么是因子（factors）。&lt;b&gt;一个异象是可能成为一个优秀因子的；然而由于异象之间的相关性，并不是所有异象都是因子。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;一个因子应该能够对解释资产（可以是个股也可以是个股组成的投资组合）预期收益率的截面差异有显著的增量贡献。如果异象满足上述条件，它就可以被称之为一个因子。&lt;/b&gt;在这个定义中，有两个关键词值得解读，它们是“解释”和“增量贡献”：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;“解释”说明这个异象（或者潜在因子）已经从回归方程的左侧移到了回归方程的右侧，它被用来当作解释变量来对资产的收益率做回归，考察它是否能够解释预期收益率的截面差异。&lt;/li&gt;&lt;li&gt;“增量贡献”暗示着同时考虑多个异象（因子）时，由于它们之间不完全独立，需要排除相关性的影响。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;举个例子。我们知道价值因子是一个靠谱的选股因子。然而，很多指标 —— 比如 E/P 或 B/P 都可以用来构建价值因子的 High-Minus-Low 组合。如果同时基于 E/P 和 B/P 构建了 HML_EP 和 HML_BP 两个因子，它们之间的相关性注定是非常高的。一旦选择了其中之一作为价值因子，另一个对于资产预期收益率截面差异解释能力的增量贡献就不再显著、无法成为因子。&lt;/p&gt;&lt;p&gt;&lt;b&gt;从资产定价的理论角度来说，多因子模型中的因子之间应尽可能独立；&lt;/b&gt;但是从投资实践来说，上面例子中的 E/P 和 B/P 可以被同时使用构建一个 HML 价值因子，这有助于降低波动且增加因子的鲁棒性。&lt;/p&gt;&lt;p&gt;&lt;b&gt;在从一揽子异象中筛选因子时，常见的做法是将它们同时作为回归分析中的解释变量，采用 Fama-MacBeth Regression（Fama and MacBeth 1973）来分析这些异象的收益率是否显著。&lt;/b&gt;在这方面，Green, Hand and Zhang (2017) 是一个很好的例子。&lt;/p&gt;&lt;p&gt;Green, Hand and Zhang (2017) 使用 Fama-MacBeth Regression 同时检验 94 个异象，并考虑了 multiple testing 对 t-statistic 以及 p-value 造成的影响，最终发现仅有 12 个异象可能成为潜在的因子：1. 账面市值比；2. 现金；3. 分析师数量的变化；4. 盈余公告宣告收益；5. 一个月的动量；6. 六个月动量的变化；7. 盈利同比增长的季度数量；8. 年度研发支出占市值的比重；9. 收益波动性；10. 股票换手率；11. 股票换手率的波动性；12. 零交易的天数。&lt;/p&gt;&lt;p&gt;上述结果告诉我们：&lt;b&gt;在修正 multiple testing 的数据挖掘、以及考察了不同异象的相关性之后，真正能够解释资产预期收益率截面差异的独立因子少之又少。&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;4 Multi-Factor Models&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;现在我们已经了解了异象，并通过回归分析从异象中找出了因子，接下来就是挑选因子构建多因子模型了。在构建多因子模型时，两个必须要回答的问题是：（1）选择多少个因子合适？（2）选择哪些因子更好？学术界对于第一个问题的共识为主流因子模型奠定了基调；而第二个问题则涉及不同多因子模型之间的比较。&lt;/p&gt;&lt;p&gt;对于第一个问题，我们总可以仅使用一个因子，比如 CAPM 模型仅使用了市场因子；又或者我们可以使用许多因子。一个极端的情况是把每个上市公司作为一个因子，每个公司的股票只在自己公司的因子上有暴露，在代表其他公司的因子上零暴露。这样的模型显然能完美解释股票预期收益率的截面差异，但在现实中没人会那么用。以样本内过拟合为代价，更多的因子总能更好的解释收益率的截面差异。&lt;/p&gt;&lt;p&gt;在学术界，“几个因子合适”这个问题所遵循的准则是 &lt;b&gt;The Law of Parsimony（简约法则）&lt;/b&gt;，它还有一个更为人熟知的名字 —— Occam’s razor（奥卡姆剃刀）。&lt;b&gt;如果从 ICAPM（Intertemporal CAPM）的角度来理解多因子模型，每个因子代表某种 state variable；而 state variable 是投资者想要对冲的某种风险。&lt;/b&gt;从这个意义上说，因子的个数应该是有限的。&lt;/p&gt;&lt;p&gt;依据简约法则，学术界主流的多因子模型包括以下几个（按时间顺序、排名不分先后，不完整 list），它们的因子个数均在 3 到 5 个之间：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;Fama-French 三因子模型（Fama and French 1993）：&lt;/b&gt;多因子模型的开山鼻祖，包括 MKT，HML 以及 SMB 三因子。&lt;/li&gt;&lt;li&gt;&lt;b&gt;Carhart 四因子模型（Carhart 1997）：&lt;/b&gt;在 Fama-French 三因子模型上加上了动量 MOM 因子。&lt;/li&gt;&lt;li&gt;&lt;b&gt;Novy-Marx 四因子模型（Novy-Marx 2013）：&lt;/b&gt;包含 MKT，HML，MOM 以及 PMU 四个因子；其中 PMU 所用的财务指标是 Gross Profit-to-Asset，代表 profitability 维度。&lt;/li&gt;&lt;li&gt;&lt;b&gt;Fama-French 五因子模型（Fama and French 2015）：&lt;/b&gt;Fama 和 French 在其三因子模型的基础上加入了 CMA 和 RMW 两个因子，分别代表 investment 和 profitability 两个维度。&lt;/li&gt;&lt;li&gt;&lt;b&gt;Hou-Xue-Zhang 四因子模型（Hou, Xue and Zhang 2015）：&lt;/b&gt;包含 MKT，SMB，IVA 以及 ROE；其中 IVA 是 total assets 的年增长率，代表 investment 维度。&lt;/li&gt;&lt;li&gt;&lt;b&gt;Stambaugh-Yuan 四因子模型（Stambaugh and Yuan 2016）：&lt;/b&gt;包含 MKT，SMB，MGMT 和 PERF 四个因子。MGMT 和 PERF 分别使用了 6 个和 5 个指标，代表和 management 以及 performance 相关的两个 mispricing 因子。虽然该模型只有四个因子，但它用到的基本面和量价指标多达 12 个。&lt;/li&gt;&lt;li&gt;&lt;b&gt;Daniel-Hirshleifer-Sun 三因子模型（Daniel, Hirshleifer and Sun 2018）：&lt;/b&gt;在 MKT 的基础上，使用 PEAD 和 FIN 两个指标作为短期和长期行为因子（behavioral factors）的代理指标，构建了三因子模型。该模型由于包括了传统的 MKT 风险因子，又包括行为因子，故称为复合模型。这也是一篇比较新的文章，对因子模型提供了新的思路，我会在下周的文章中重点介绍。&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;如何比较不同的多因子模型呢？学术界主要有以下三种方法：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;GRS tests；&lt;/li&gt;&lt;li&gt;Mean-Variance Spanning tests；&lt;/li&gt;&lt;li&gt;Bayesian approach。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;b&gt;GRS tests&lt;/b&gt;（Gibbons, Ross and Shanken 1989）检验 n 个资产在给定因子模型下的定价错误（pricing error）—— 即 α —— 是否在统计上联合为零（jointly equal to zero）。在比较两个多因子模型时，使用两个模型的因子互为资产和定价模型进行检验。&lt;/p&gt;&lt;p&gt;举个例子。&lt;a href=&quot;https://zhuanlan.zhihu.com/p/48728998&quot; class=&quot;internal&quot;&gt;《中国版的 Fama-French 三因子模型，了解一下？》&lt;/a&gt;一文中比较了两个不同版本的价值和市值因子的效果。结果（下表）显示，当使用 SMB 和 VMG 为因子模型时，FFSMB 和 FFHML 的定价错误可以认为是零（p-value = 0.41）；反过来，当使用 FFSMB 和 FFHML 为定价模型时，SMB 和 VMG 依然存在显著不为零的定价错误（p-value 是 10 的 -13 次方这个量级）。这意味着 SMB 和 VMG 优于 FFSMB 和 FFHML。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-470af865d5d487a8a7c9be6c0478dd5e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;591&quot; data-rawheight=&quot;275&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;591&quot; data-original=&quot;https://pic3.zhimg.com/v2-470af865d5d487a8a7c9be6c0478dd5e_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-470af865d5d487a8a7c9be6c0478dd5e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;591&quot; data-rawheight=&quot;275&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;591&quot; data-original=&quot;https://pic3.zhimg.com/v2-470af865d5d487a8a7c9be6c0478dd5e_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-470af865d5d487a8a7c9be6c0478dd5e_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;Mean-Variance Spanning tests&lt;/b&gt; 考察 n 个已知资产构建的 mean-variance 有效前沿能否包含某个新资产（Huberman and Kandel 1987）。在比较两个多因子模型时，使用每个模型的因子构建有效前沿，并逐一检验其能否包含另一个模型中的因子。&lt;/p&gt;&lt;p&gt;举个例子。&lt;a href=&quot;https://zhuanlan.zhihu.com/p/51043407&quot; class=&quot;internal&quot;&gt;《美股上一个跨越时间尺度的趋势因子》&lt;/a&gt;介绍了一个新的趋势因子。考虑新的趋势因子和三个已有因子（SREV、MOM 以及 LREV）的回归模型如下：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+r_%7B%5Cmbox%7BTrend%7D%2Ct%7D%3D%5Calpha%2B%5Cbeta_1+r_%7B%5Cmbox%7BSREV%7D%2Ct%7D%2B%5Cbeta_2+r_%7B%5Cmbox%7BMOM%7D%2Ct%7D%2B%5Cbeta_3+r_%7B%5Cmbox%7BLREV%7D%2Ct%7D%2B%5Cepsilon_t&quot; alt=&quot;\displaystyle r_{\mbox{Trend},t}=\alpha+\beta_1 r_{\mbox{SREV},t}+\beta_2 r_{\mbox{MOM},t}+\beta_3 r_{\mbox{LREV},t}+\epsilon_t&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;该检验的 null hypothesis 是：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+%5Calpha%3D0%2C%7E%7E%7E%5Cbeta_1%2B%5Cbeta_2%2B%5Cbeta_3%3D1&quot; alt=&quot;\displaystyle \alpha=0,~~~\beta_1+\beta_2+\beta_3=1&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;检验结果显著的拒绝原假设，说明已有三因子无法解释新的趋势因子。&lt;/p&gt;&lt;p&gt;最后来看看 &lt;b&gt;Bayesian approach&lt;/b&gt;。假设比较两个多因子模型 M_1 和 M_2；相关数据集用 D 表示。令 prob(M_1) 和 prob(M_2) 为这两个模型的先验概率，且有 prob(M_1) + prob(M_2) = 1（这里假设把多个模型两两比较）。根据贝叶斯定理有：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+%5Cmbox%7Bprob%7D%28M_i%7CD%29%3D%5Cfrac%7B%5Cmbox%7Bprob%7D%28M_i%29%5Cmbox%7Bprob%7D%28D%7CM_i%29%7D%7B%5Cmbox%7Bprob%7D%28M_1%29%5Cmbox%7Bprob%7D%28D%7CM_1%29%2B%5Cmbox%7Bprob%7D%28M_2%29%5Cmbox%7Bprob%7D%28D%7CM_2%29%7D&quot; alt=&quot;\displaystyle \mbox{prob}(M_i|D)=\frac{\mbox{prob}(M_i)\mbox{prob}(D|M_i)}{\mbox{prob}(M_1)\mbox{prob}(D|M_1)+\mbox{prob}(M_2)\mbox{prob}(D|M_2)}&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;其中：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+%5Cmbox%7Bprob%7D%28D%7CM_i%29%3D%5Cint_%7B%5Ctheta_i%7D%5Cmbox%7Bprob%7D%28%5Ctheta_i%29%5Cmbox%7Bprob%7D%28D%7C%5Ctheta_i%29d%5Ctheta_i&quot; alt=&quot;\displaystyle \mbox{prob}(D|M_i)=\int_{\theta_i}\mbox{prob}(\theta_i)\mbox{prob}(D|\theta_i)d\theta_i&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;上式中，prob(θ_i) 是模型 i 参数的先验分布，prob(D|θ_i) 是模型 i 的似然函数。上述贝叶斯方法的核心在于确定 prob(θ_i)。根据 Pastor and Stambaugh (2000) 以及 Barillas and Shanken (2018) 的理论，它和以两个模型中的全部因子作为资产所构成的投资组合的预期最大夏普率的平方与市场夏普率的比值有关。&lt;/p&gt;&lt;p&gt;使用贝叶斯方法，Stambaugh and Yuan (2016) 比较了他们的四因子模型（记为 M-4）和 Fama-French 五因子模型（记为 FF-5）以及 Hou-Xue-Zhang 四因子模型（记为 q-4）。下图中，左图是 M-4 和 FF-5 模型的比较；右图是 M-4 和 q-4 模型的比较。图中，横坐标均为先验，即两模型中全部因子能达到的最大预期夏普率平方和市场夏普率的比值；纵坐标为不同模型的后验概率。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-3966327434e9fa7d3211397a37d79439_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1121&quot; data-rawheight=&quot;483&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1121&quot; data-original=&quot;https://pic2.zhimg.com/v2-3966327434e9fa7d3211397a37d79439_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-3966327434e9fa7d3211397a37d79439_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1121&quot; data-rawheight=&quot;483&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1121&quot; data-original=&quot;https://pic2.zhimg.com/v2-3966327434e9fa7d3211397a37d79439_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-3966327434e9fa7d3211397a37d79439_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;结果说明，当先验这个比值分别大于 1.05 和 1.2 的时候，M-4 因子模型就分别强于 FF-5 和 q-4 模型。显然，使用多个因子得到的最大夏普率很容易是市场夏普率的 1.05 或 1.2 倍，意味着数据更加倾向于支持 M-4 模型。&lt;/p&gt;&lt;p&gt;需要特别强调的是，无论采用哪种方法，比较多因子模型的目的是为了得到新的启发，而非一定要排个一二三四。&lt;b&gt;这些因子模型之间孰优孰劣并无定论，它们的提出丰富了我们对于 empirical asset pricing 的理解并指导着因子投资。&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;5 多因子模型复杂度的讨论&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;在结束本文之前，再来简单讨论下构建因子模型时遵循的 The Law of Parsimony。&lt;/p&gt;&lt;p&gt;在美国金融协会 2018 年的年会上，Daniel, Hirshleifer and Sun (2018) 报告了他们的复合因子模型，并对模型复杂度和模型的解释效果做了探讨，颇有新意。具体的，他们提出了两个 Parsimony Index，通过惩罚因子和用于构建因子的指标个数来计算模型复杂度。&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;b&gt;第一个 Parsimony Index = 零减去模型中所有因子使用的全部指标数之和；&lt;/b&gt;由此可知该 index 取值为负，越大（即越接近零）说明模型越简单。如果一个指标被用于多个因子中，则在计算该 index 时需要多次计算它。&lt;/li&gt;&lt;li&gt;&lt;b&gt;第二个 Parsimony Index = 零减去模型中的因子和指标个数之和；&lt;/b&gt;同上，该 index 取值为负，越大（即越接近零）说明模型越简单。它和前者的区别为：（1）除指标外，也考虑了对因子个数的惩罚；（2）如果某指标被用于多个因子中，其只被计算一次。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;按照上述定义，本文第四节介绍的主流因子模型的两个 Parsimony Index 取值分别为：&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-4d384a3b6ae6ffc0ecd53fcb03fefa6b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;792&quot; data-rawheight=&quot;295&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;792&quot; data-original=&quot;https://pic4.zhimg.com/v2-4d384a3b6ae6ffc0ecd53fcb03fefa6b_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-4d384a3b6ae6ffc0ecd53fcb03fefa6b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;792&quot; data-rawheight=&quot;295&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;792&quot; data-original=&quot;https://pic4.zhimg.com/v2-4d384a3b6ae6ffc0ecd53fcb03fefa6b_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-4d384a3b6ae6ffc0ecd53fcb03fefa6b_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;使用上述 7 个因子模型来检验 34 个异象，根据 5% 显著性水平下显著的异象的个数以及所有异象的平均 α 收益率的绝对值分别作为模型解释力度，最后将模型解释力度和这两个 Parsimony Index 分别做回归以观察解释度和模型复杂度之间的关系。结果如下。&lt;/p&gt;&lt;p&gt;以 5% 显著性水平的异象个数作为解释力度：&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-9667517a288bbfdeae72203c5357e336_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;804&quot; data-rawheight=&quot;344&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;804&quot; data-original=&quot;https://pic3.zhimg.com/v2-9667517a288bbfdeae72203c5357e336_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-9667517a288bbfdeae72203c5357e336_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;804&quot; data-rawheight=&quot;344&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;804&quot; data-original=&quot;https://pic3.zhimg.com/v2-9667517a288bbfdeae72203c5357e336_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-9667517a288bbfdeae72203c5357e336_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;以全部异象平均 |α| 为解释力度：&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-346c85705fed818ebe640f8934b5039b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;803&quot; data-rawheight=&quot;346&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;803&quot; data-original=&quot;https://pic4.zhimg.com/v2-346c85705fed818ebe640f8934b5039b_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-346c85705fed818ebe640f8934b5039b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;803&quot; data-rawheight=&quot;346&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;803&quot; data-original=&quot;https://pic4.zhimg.com/v2-346c85705fed818ebe640f8934b5039b_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-346c85705fed818ebe640f8934b5039b_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;随着模型复杂度的提升（表现为 Parsimony Index 的取值更小），模型的解释力度上升（体现为 5% 显著性下的异象变少和异象平均 |α| 降低）。&lt;/b&gt;这个结论符合预期，它也再次强调了不同因子模型之间的好坏并无定论 —— 我们总能通过增加模型复杂度来提升模型（样本内）的解释效果，因此需要在模型复杂度和样本内的解释力度之间取舍。&lt;/p&gt;&lt;p&gt;&lt;b&gt;在 The Law of Parsimony 的指导思想下，一个优秀的因子模型通常有较少的因子或者基本面或量价特征；而作为使用者，我们应该尽量搞清楚每一个因子背后代表的风险。&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;6 结语&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;这篇文章没有告诉你哪个异象能赚取 α。&lt;/p&gt;&lt;p&gt;这篇文章没有告诉你哪个因子能赚取高性价比的 β。&lt;/p&gt;&lt;p&gt;这篇文章也没有告诉你哪家的多因子模型更胜一筹。&lt;/p&gt;&lt;p&gt;OK, enough for “自我否定”。既然如此，为什么要写这篇文章呢？如今，学术论文和卖方报告中开发出新“因子”的速度已远超我能理解、消化的速度。以学术界的 447 个异象为例，如果每周写一篇介绍一个，要写 9 年。异象被当作“因子”来使用，但它背后往往没有合理的金融学解释（即无法代表合理的系统性风险），或者没有用已有因子对其分析从而评判它对解释股票预期收益率截面差异的增量贡献，仅仅是数据挖掘的产物。它们中大多数根本不是因子，甚至连异象都谈不上。出于这个原因，我希望能介绍一些方法，帮助因子投资的践行者去伪存真。这就是写作本文的初衷。&lt;/p&gt;&lt;p&gt;这篇文章回答了开篇提出的五个问题；解释了异象、因子以及多因子模型的区别和联系；梳理了从异象到因子再到模型，一步步使用多因子模型背后的逻辑；介绍了学术界在研究多因子时使用的主流统计手段。希望它能够作为一个完善的工具箱，为你的多因子研究和投资添一分助力。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;（全文完）&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;延伸阅读，其他有关因子投资的文章链接如下：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/40984029&quot; class=&quot;internal&quot;&gt;《股票多因子模型的回归检验》&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/52221111&quot; class=&quot;internal&quot;&gt;《解释股票截面预期收益差异的独立因子》&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/45371443&quot; class=&quot;internal&quot;&gt;《未知风险，错误定价，还是数据迁就？》&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/38663777&quot; class=&quot;internal&quot;&gt;《在追逐 p-value 的道路上狂奔，却在科学的道路上渐行渐远》&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/38315648&quot; class=&quot;internal&quot;&gt;《你用因子，他也用因子；你没赚钱，他却赚钱了》&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/56154663&quot; class=&quot;internal&quot;&gt;《出色不如走运 (III)？》&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/45715632&quot; class=&quot;internal&quot;&gt;《出色不如走运 (II)？》&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;参考文献&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Barillas, F. and J. Shanken (2018). Comparing asset pricing models. &lt;i&gt;Journal of Finance&lt;/i&gt;, Vol. 73(2), 715 – 754.&lt;/li&gt;&lt;li&gt;Carhart, M. M. (1997). On Persistence in Mutual Fund Performance. &lt;i&gt;Journal of Finance&lt;/i&gt;, Vol. 52(1), 57 – 82.&lt;/li&gt;&lt;li&gt;Daniel, K. D., D. A. Hirshleifer and L. Sun (2018). &lt;i&gt;Short- and long-horizon behavioral factors&lt;/i&gt;. Columbia Business School Research Paper No. 18-5. Available at SSRN: &lt;a href=&quot;http://link.zhihu.com/?target=https%3A//ssrn.com/abstract%3D3086063&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;ssrn.com/abstract=30860&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;63&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;.&lt;/li&gt;&lt;li&gt;Fama, E. F. and K. R. French (1993). Common Risk Factors in the Returns on Stocks and Bonds. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 33(1), 3 – 56.&lt;/li&gt;&lt;li&gt;Fama, E. F. and K. R. French (2015). A Five-Factor Asset Pricing Model. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 116(1), 1 – 22.&lt;/li&gt;&lt;li&gt;Fama, E. F. and J. D. MacBeth (1973). Risk, return, and equilibrium: empirical tests. &lt;i&gt;Journal of Political Economy&lt;/i&gt;, Vol. 81(3), 607 – 636.&lt;/li&gt;&lt;li&gt;Green, J., J. R. M. Hand and X. F. Zhang (2017). The characteristics that provide independent information about average U.S. monthly stock returns. &lt;i&gt;Review of Financial Studies&lt;/i&gt;, Vol. 30(12), 4389 – 4436.&lt;/li&gt;&lt;li&gt;Gibbons, M. R., S. A. Ross and J. Shanken (1989). A test of the efficiency of a given portfolio. &lt;i&gt;Econometrica&lt;/i&gt;, Vol. 57(5), 1121 – 1152.&lt;/li&gt;&lt;li&gt;Harvey, C. R., Y. Liu and H. Zhu (2016). … and the cross-section of expected returns. &lt;i&gt;Review of Financial Studies&lt;/i&gt;, Vol. 29(1), 5 – 68.&lt;/li&gt;&lt;li&gt;Hou, K., C. Xue and L. Zhang (2015). Digesting anomalies: An investment approach. &lt;i&gt;Review of Financial Studies&lt;/i&gt;, Vol. 28(3), 650 – 705.&lt;/li&gt;&lt;li&gt;Hou, K., C. Xue and L. Zhang (2017). &lt;i&gt;Replicating Anomalies&lt;/i&gt;. Fisher College of Business Working Paper No. 2017-03-010; Charles A. Dice Center Working Paper No. 2017-10. Available at SSRN: &lt;a href=&quot;http://link.zhihu.com/?target=https%3A//ssrn.com/abstract%3D2961979&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;ssrn.com/abstract=29619&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;79&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;.&lt;/li&gt;&lt;li&gt;Huberman G. and S. Kandel (1987). Mean-variance spanning. &lt;i&gt;Journal of Finance&lt;/i&gt;, Vol. 42(4), 873 – 888.&lt;/li&gt;&lt;li&gt;Lee, C. M. C., S. T. Sun, R. Wang and R. Zhang (2018). Technological Links and Return Predictability. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, forthcoming.&lt;/li&gt;&lt;li&gt;Linnainmaa, J. T. and M. R. Roberts (2018). The history of the cross-section of stock returns. &lt;i&gt;Review of Financial Studies&lt;/i&gt;, Vol. 31(7), 2606 – 2649.&lt;/li&gt;&lt;li&gt;Liu, J., R. F. Stambaugh and Y. Yuan (2018). Size and Value in China. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, forthcoming.&lt;/li&gt;&lt;li&gt;Novy-Marx, R. (2013). The other side of value: The gross profitability premium. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 108 (1), 1 – 28.&lt;/li&gt;&lt;li&gt;Pastor, L. and R. F. Stambaugh (2000). Comparing asset pricing models: an investment perspective. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 56(3), 335 – 381.&lt;/li&gt;&lt;li&gt;Stambaugh, R. F. and Y. Yuan (2016). Mispricing Factors. &lt;i&gt;Review of Financial Studies&lt;/i&gt;, Vol. 30(4), 1270 – 1315.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处，谢谢。已委托“维权骑士”(&lt;a href=&quot;http://link.zhihu.com/?target=http%3A//rightknights.com&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;维权骑士_免费版权监测/版权保护/版权分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2019-02-13-56614427</guid>
<pubDate>Wed, 13 Feb 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>出色不如走运 (III)？</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2019-02-02-56154663.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/56154663&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-b67f8e2d7d4b2f70affdcb79a88cba69_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;摘要&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;本文使用随机因子的实证结果定量说明了仅靠运气就能够达到的选股效果，帮助判断选股因子是否真正有效。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;1 引言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;使用因子选股的逻辑是因子 —— 无论是来自基本面、量价还是宏观经济等 —— 都对股票未来的收益率有预测性。在定量评价一个因子是否有效时，主要的考察方式之一是计算该因子的收益率是否显著不为零（原假设）。&lt;/p&gt;&lt;p&gt;假设因子的预期收益率和该预期收益率的 standard error 分别为 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D%5Bf%5D&quot; alt=&quot;\mbox{E}[f]&quot; eeimg=&quot;1&quot;&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bs.e.%7D%28%5Cmbox%7BE%7D%5Bf%5D%29&quot; alt=&quot;\mbox{s.e.}(\mbox{E}[f])&quot; eeimg=&quot;1&quot;&gt; ，则假设检验的 t-statistic 为：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Cmbox%7Bt-statistic%7D%3D%5Cfrac%7B%5Cmbox%7BE%7D%5Bf%5D%7D%7B%5Cmbox%7Bs.e.%7D%28%5Cmbox%7BE%7D%5Bf%5D%29%7D&quot; alt=&quot;\displaystyle\mbox{t-statistic}=\frac{\mbox{E}[f]}{\mbox{s.e.}(\mbox{E}[f])}&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;在进行单因子检验时，一般要求该因子的 t-statistic 大于 2，从而以 5% 的显著性水平拒绝原假设，并认为该因子确实有预测股票收益率的能力。&lt;b&gt;然而，如果同时考虑众多因子（多重检验，multiple testing）并从里面挑出来最好的，由于 data mining 的问题（即运气），即便最好因子的 t-statistic 大于 2，也不能认为它是有效的。&lt;/b&gt;之前的两篇文章&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzIyMDEwNDk1Mg%3D%3D%26mid%3D2650876036%26idx%3D1%26sn%3D42f442ff51b288fa58e2a5d7bee3b8cf%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;《出色不如走运?》&lt;/a&gt;以及&lt;a href=&quot;https://zhuanlan.zhihu.com/p/45715632&quot; class=&quot;internal&quot;&gt;《出色不如走运(II)?》&lt;/a&gt;对这个问题进行了探讨。&lt;/p&gt;&lt;p&gt;今天这篇是《出色不如走运(III)?》。&lt;/p&gt;&lt;p&gt;假设同时考察 n 个因子、这些因子对于股票收益率的预测能力满足 Uniform distribution。如果从这 n 个因子中挑出效果最好的，这个“最好的”因子的 t-statistic 和 p-value 有哪些性质呢？我们想要回答的问题是：&lt;b&gt;在多重检验的 n 选 1 问题中，对于给定的显著性水平 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=p&quot; alt=&quot;p&quot; eeimg=&quot;1&quot;&gt; &lt;b&gt;（比如 5%），单一因子的 p-value 或 t-statistic 应满足什么条件才能拒绝原假设。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;根据 order statistic 的概率知识可知，这 n 个因子中第 i 好的满足 Beta distribution：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+U_%7B%28i%29%7D%5Csim%5Cmbox%7BBeta%7D%28i%2Cn%2B1-i%29&quot; alt=&quot;\displaystyle U_{(i)}\sim\mbox{Beta}(i,n+1-i)&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;从 n 个里面挑出最好的相当于令 i = n。根据 Beta distribution 的定义和简单计算有：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+%5Cmbox%7Bprob%7D%28U_%7B%28n%29%7D%3Cx%29%3Dx%5En&quot; alt=&quot;\displaystyle \mbox{prob}(U_{(n)}&amp;lt;x)=x^n&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;令  &lt;img src=&quot;https://www.zhihu.com/equation?tex=x+%3D+%281+%E2%80%93+p%29%5E%7B1%2Fn%7D&quot; alt=&quot;x = (1 – p)^{1/n}&quot; eeimg=&quot;1&quot;&gt;  并利用 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bprob%7D%28U+%3C+x%29+%3D+1+%E2%80%93+%5Cmbox%7Bprob%7D%28U+%E2%89%A5+x%29&quot; alt=&quot;\mbox{prob}(U &amp;lt; x) = 1 – \mbox{prob}(U ≥ x)&quot; eeimg=&quot;1&quot;&gt; 可知：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+%5Cmbox%7Bprob%7D%5Cleft%28U_%7B%28n%29%7D%5Cge%281-p%29%5E%7B1%2Fn%7D%5Cright%29%3Dp&quot; alt=&quot;\displaystyle \mbox{prob}\left(U_{(n)}\ge(1-p)^{1/n}\right)=p&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;在因子分析中，通常关注的是因子收益率是否显著不为零 —— 可正可负 —— 因此一般使用双边检验。对于给定的 p-value（单边  &lt;img src=&quot;https://www.zhihu.com/equation?tex=p%2F2&quot; alt=&quot;p/2&quot; eeimg=&quot;1&quot;&gt; ），由上式可知（将  &lt;img src=&quot;https://www.zhihu.com/equation?tex=p&quot; alt=&quot;p&quot; eeimg=&quot;1&quot;&gt;  换成 &lt;img src=&quot;https://www.zhihu.com/equation?tex=p%2F2&quot; alt=&quot;p/2&quot; eeimg=&quot;1&quot;&gt; ），这 n 个因子中最好的那个的 t-statistic 的绝对值需不小于以下阈值才能拒绝原假设：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+%5Cmbox%7Bt-statistic%7D%5E%5Cstar%3D%5Cmathcal%7BN%7D%5E%7B-1%7D%5Cleft%28%5Cleft%281-%5Cfrac%7Bp%7D%7B2%7D%5Cright%29%5E%7B1%2Fn%7D%5Cright%29&quot; alt=&quot;\displaystyle \mbox{t-statistic}^\star=\mathcal{N}^{-1}\left(\left(1-\frac{p}{2}\right)^{1/n}\right)&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;当 n 很大时，从上式可进一步推导出单一因子的 p-value 需要小于 &lt;img src=&quot;https://www.zhihu.com/equation?tex=p%2Fn&quot; alt=&quot;p/n&quot; eeimg=&quot;1&quot;&gt; 才能在 n 选 1 的 multiple testing 下拒绝原假设。举例来说，我们考察 10 个因子并希望以 5% 的显著性水平找到真正有效的因子，则这些因子各自的 p-value 只有小于 5%/10 = 0.5% 才能拒绝原假设。这正是大名鼎鼎的 &lt;b&gt;Bonferroni correction（邦费罗尼校正&lt;/b&gt;）。&lt;/p&gt;&lt;p&gt;实际因子选股面临更复杂的问题：如何从 n 个因子中选出最好的 k 个，而非 1 个；如何配置选出来的这 k 个因子 —— 等权配置还是按照它们&lt;b&gt;样本内&lt;/b&gt;的表现好坏配置。如果不妥善解决 multiple testing 的问题，上述这些做法会导致&lt;b&gt;选择偏差（selection bias）&lt;/b&gt;以及&lt;b&gt;过拟合偏差（overfitting bias）&lt;/b&gt;。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;2 选择偏差和过拟合偏差&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;在选择因子时，通常的做法是在回测中使用因子定期构建投资组合，然后分析因子预期收益率的 t-statistic。如果该 t 值小于零（且显著为负）则把该因子反过来使用。假设同时考察 n 个因子，并根据因子 t-statistic 绝对值的大小采用下列做法之一：&lt;/p&gt;&lt;p&gt;&lt;b&gt;1.&lt;/b&gt; 按照样本内 n 个因子 t-statistics 的正负同时使用全部因子，按照等权或者样本内因子效果赋权来选股（n 选 n 问题） —— 这种做法引入 overfitting bias；&lt;/p&gt;&lt;p&gt;&lt;b&gt;2.&lt;/b&gt; 从这 n 个因子中挑出样本内 t-statistic 绝对值最大的 1 个（n 选 1 问题），使用该因子选股 —— 这种做法引入 selection bias；&lt;/p&gt;&lt;p&gt;&lt;b&gt;3.&lt;/b&gt; 从这 n 个因子中挑出样本内 t-statistic 绝对值最大的 k 个（n 选 k 问题），并按等权或样本内效果赋权选股 —— 这种做法同时引入 selection bias 和 overfitting bias。&lt;/p&gt;&lt;p&gt;Novy-Marx (2015) 研究了多因子选股回测中的 selection bias 和 overfitting bias 问题。本文第一节中的数学推导正是来自 Novy-Marx (2015)，而它仅仅是 n 选 1 的一种简化情况。在投资实务中，更常见的是上述第二种 n 选 k 的问题，它面临&lt;b&gt;“因子怎么选”&lt;/b&gt;和&lt;b&gt;“因子如何配”&lt;/b&gt;这两个严峻的问题，一不小心就会引入大量的噪音。&lt;/p&gt;&lt;p&gt;&lt;b&gt;毫无疑问，multiple testing 下的数据挖掘是因子选股的大敌。通过 data mining，仅仅依靠运气，挑出来的因子 —— 哪怕再没有业务含义 —— 也会在样本内获得显著不为零的选股收益率，但它只是过拟合而已。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;针对 multiple testing 中的 data mining，Novy-Marx (2015) 从理论和实证经验两个角度分析了上述 n 选 n、n 选 1、n 选 k 三个问题中，多因子策略的 t-statistic 的分布问题。该文使用纯随机产生的因子 —— 理论上没有任何预测性 —— 在美股上选股、以美股的真实收益率计算这些随机因子的因子收益率，从而定量分析上述三个问题中多因子选股策略的 t-statistic 的阈值。&lt;/p&gt;&lt;p&gt;&lt;b&gt;这些 t-statistic 的阈值远超单因子检验中的 2.0，而如此之高的阈值更是仅仅来自于运气和 data mining。在实际选股中，使用多因子构建的策略的 t-statistic 唯有超过这些阈值才意味着它们真的对收益率有统计上非显著为零的预测性。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;本文下一节借鉴 Novy-Marx (2015) 的思路产生随机因子，使用中证 500 指数的成分股进行实证分析。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;3 来自中证 500 的实证&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;实证中的回测期从 2010 年 1 月到 2019 年 1 月，考察 n 个随机因子的选股能力。具体的：&lt;/p&gt;&lt;p&gt;&lt;b&gt;1.&lt;/b&gt; 对于每一个因子，在每月末，随机生成 500 支成分股在该因子上的取值并从高到低排列，选择取值最高的 10% 做多、取值最低的 10% 做空，以该多空组合的收益率作为该期因子的收益率；&lt;/p&gt;&lt;p&gt;&lt;b&gt;2.&lt;/b&gt; 计算回测期内每个因子的 t-statistic，如果某个因子的 t-statistic 为负，则把该随机因子反过来使用；&lt;/p&gt;&lt;p&gt;&lt;b&gt;3.&lt;/b&gt; 按照每个随机因子 t-statistic 绝对值的大小，挑选绝对值最大的 k (≤ n) 个因子，并按照等权或者正比于它们 t-statistics 的绝对值大小配置因子；&lt;/p&gt;&lt;p&gt;&lt;b&gt;4.&lt;/b&gt; 以最终多个因子的配置结果作为最终的选股结果，计算该策略在整个回测期内的 t-statistic；&lt;/p&gt;&lt;p&gt;&lt;b&gt;5.&lt;/b&gt; 上述 1 – 4 步完成了 n 选 k（当 k = 1 和 n 时，问题分别变为 n 选 1 和 n 选 n）的一次实验。为了得到 n 选 k 问题中 t-statistic 的经验分布并计算 5% 显著性水平下的 t-statistic 的阈值，对于每一组 n 和 k，将上述 4 步进行 5000 次仿真，从而计算 t-statistic 的阈值。&lt;/p&gt;&lt;p&gt;举个例子。下图是当 n = 20，k = 3（即从 20 个随机因子中选出样本内 t-statistic 绝对值最大的 3 个，并按 t-statistic 绝对值大小配置）时，5000 次仿真得到的该策略的 t-statistic 的经验分布，其均值为 3.2，其 5% 显著性水平下对应的 t-statistic（即该分布中 95% 分位数）高达 4.16。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-534f3501a732706fd85160cbafadac9b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;710&quot; data-rawheight=&quot;387&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;710&quot; data-original=&quot;https://pic4.zhimg.com/v2-534f3501a732706fd85160cbafadac9b_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-534f3501a732706fd85160cbafadac9b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;710&quot; data-rawheight=&quot;387&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;710&quot; data-original=&quot;https://pic4.zhimg.com/v2-534f3501a732706fd85160cbafadac9b_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-534f3501a732706fd85160cbafadac9b_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;该结果表明，如果我们从 20 个源于业务逻辑（或者很多人乐此不疲的 data mining）的因子中选择 3 个最好的来选股时，该策略的 t-statistic 要超过 4.16 才能认为这 3 个因子的选股效果不仅仅是运气。&lt;/p&gt;&lt;p&gt;接下来看看不同 n 和 k 的取值下，5% 显著性水平对应的 t-statistic 的阈值的情况。下图比较了不同 n 取值下，n 选 1 和 n 选 n 两种极端情况 —— n 选 1 代表仅有 selection bias；n 选 n 代表仅有 overfitting bias。下图传递出以下信息：&lt;/p&gt;&lt;p&gt;&lt;b&gt;1.&lt;/b&gt; 随着考察的随机因子个数（n）的增加，策略 t-statistic 的阈值逐渐递增；&lt;/p&gt;&lt;p&gt;&lt;b&gt;2.&lt;/b&gt; 选 n 个因子比选 1 个因子有更高的阈值；按样本内表现配置比等权配置有更高的阈值；它们说明 overfitting bias 比 selection bias 更容易在样本内产生过拟合。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-a41afc66d17ca05e21d5376ffbbc5b45_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;764&quot; data-rawheight=&quot;461&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;764&quot; data-original=&quot;https://pic2.zhimg.com/v2-a41afc66d17ca05e21d5376ffbbc5b45_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-a41afc66d17ca05e21d5376ffbbc5b45_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;764&quot; data-rawheight=&quot;461&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;764&quot; data-original=&quot;https://pic2.zhimg.com/v2-a41afc66d17ca05e21d5376ffbbc5b45_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-a41afc66d17ca05e21d5376ffbbc5b45_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;再来看看更一般的 n 选 k 的情况。下图显示了 n = 10、20、40 和 100 时，不同 k 取值下的选股策略的 t-statistic 阈值。在一般的投资实务中，尝试 100 甚至几百个因子并选择其中某些好的是十分常见的。从该实证结果中可以观察到：&lt;/p&gt;&lt;p&gt;&lt;b&gt;1.&lt;/b&gt; 随着 n 和 k 的增加，对于按照随机因子 t-statistic 绝对值赋权配置的策略，它们的 t-statistic 阈值递增；&lt;/p&gt;&lt;p&gt;&lt;b&gt;2.&lt;/b&gt; 随着 n 的增加，等权配置和按因子样本内表现配置的效果越来越接近；&lt;/p&gt;&lt;p&gt;&lt;b&gt;3.&lt;/b&gt; 对于等权配置因子的情况，能够观察到策略的效果并不随 k 递增；比如当 n = 10 时，t-statistic 的阈值随 k 先增大后减小。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-de6fad277be2eec9b3061e68db743b73_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;691&quot; data-rawheight=&quot;422&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;691&quot; data-original=&quot;https://pic4.zhimg.com/v2-de6fad277be2eec9b3061e68db743b73_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-de6fad277be2eec9b3061e68db743b73_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;691&quot; data-rawheight=&quot;422&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;691&quot; data-original=&quot;https://pic4.zhimg.com/v2-de6fad277be2eec9b3061e68db743b73_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-de6fad277be2eec9b3061e68db743b73_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;上述实证结果中，最有意思的大概是第三条。&lt;b&gt;对于等权配置的情况，在一开始，使用更多的因子可以降低策略的波动率，从而提升 t-statistic 的阈值；而一旦因子个数超过最优值，越来越多排名靠后的因子被选入，它们会降低策略的收益率，从而降低 t-statistic 的阈值。&lt;/b&gt;这是在因子投资实务中需要考虑的问题。&lt;/p&gt;&lt;p&gt;从图中可以看到，对于实证中考察的最极端情况，即“从 100 个因子选 10 个最好的”，仅仅靠运气，以随机因子构建的策略在中证 500 成分股的样本内回测中就能取得高达 7 以上的 t-statistic 阈值。Data mining 造成的 selection bias 和 overfitting bias 不容小视。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;4 结语&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;近年来，海外学术界越来越意识到 multiple testing 造成的因子分析中 data mining 的问题。一些先进的统计手段被提出以帮助鉴别哪些是真正有效的因子，哪些仅仅是运气。这些文献包括&lt;a href=&quot;https://zhuanlan.zhihu.com/p/45715632&quot; class=&quot;internal&quot;&gt;《出色不如走运(II)?》&lt;/a&gt;中介绍的那些，以及本文提及的 Novy-Marx (2015)。&lt;/p&gt;&lt;p&gt;在 empirical asset pricing 和 factor allocation 方面，我们都是 data mining 的好手。拿来一个因子，如果不好使，可以对它进行差分 —— 美其名曰增长率；再不好使，二阶差分 —— 美其名曰加速度；还不好使，行业中性、市值中性试一下、用各种其他因子回归得到残差再试一下；对于选出的因子，等权配如果效果不理想，可以按照事后夏普率配一下；还不理想？使用滚动窗口进行动态因子择时……&lt;/p&gt;&lt;p&gt;诚然，对于有严谨金融逻辑的因子 —— 比如 ROE —— 我们没有必要把它和一帮其他“邪门”因子一起比较，然后要求 ROE 也有非常高的 t-statistic，这是对统计手段的走火入魔。但是，&lt;b&gt;对于很多纯粹靠 data mining 加工出来的因子，本文使用随机因子的实证结果定量说明了仅靠运气就能够达到的效果，从而帮助判断选股因子是否真正有效。&lt;/b&gt;&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;While one should combine multiple signals they believe in, one should not believe in a combination of signals simply because they backtest well together.&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;感谢阅读，祝各位新春快乐！节后见。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;参考文献&lt;/b&gt; &lt;/p&gt;&lt;ul&gt;&lt;li&gt;Novy-Marx, R. (2015). &lt;i&gt;Backtesting strategies based on multiple signals&lt;/i&gt;. NBER Working Paper, No. 21329.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处，谢谢。已委托“维权骑士”(&lt;a href=&quot;http://link.zhihu.com/?target=http%3A//rightknights.com/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;维权骑士_免费版权监测/版权保护/版权分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2019-02-02-56154663</guid>
<pubDate>Sat, 02 Feb 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>配置风险收益还是配置噪音？</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2019-01-23-55549936.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/55549936&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-6a0bccb28af1ae5210368743fdb44f57_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;摘要&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;使用收益率序列计算夏普率、并比较不同策略时应使用科学的统计检验方法并回答正确的问题。这需要合理的先验和足够长的数据。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;1 引言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;资产配置是投资中最重要的课题之一。很多量化手段都被用来进行资产配置，比如人们耳熟能详的简单多样化、风险平价、波动率倒数、最小波动率等方法。&lt;/p&gt;&lt;p&gt;在&lt;a href=&quot;https://zhuanlan.zhihu.com/p/38301218&quot; class=&quot;internal&quot;&gt;《你真的搞懂了风险平价吗？》&lt;/a&gt;一文中我们指出，当资产之间相互独立时，应按照每个资产的夏普率平方来分配投资组合的风险，这能够最大化投资组合的夏普率。令 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%A3&quot; alt=&quot;Σ&quot; eeimg=&quot;1&quot;&gt; 表示资产的协方差矩阵、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BSR%7D_i+%3D+%CE%BC_i%2F%CF%83_i&quot; alt=&quot;\mbox{SR}_i = μ_i/σ_i&quot; eeimg=&quot;1&quot;&gt; 表示资产 i 的夏普率、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%83_p&quot; alt=&quot;σ_p&quot; eeimg=&quot;1&quot;&gt; 表示投资组合的波动率、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%89&quot; alt=&quot;ω&quot; eeimg=&quot;1&quot;&gt; 为权重向量。容易证明（下图）当投资品相互独立时（协方差矩阵是对角阵），根据夏普率平方分配风险得到的权重 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%89_i&quot; alt=&quot;ω_i&quot; eeimg=&quot;1&quot;&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%BC_i%2F%28%CF%83_i%29%5E2&quot; alt=&quot;μ_i/(σ_i)^2&quot; eeimg=&quot;1&quot;&gt; 成正比。这个比例正是大名鼎鼎的&lt;b&gt;凯利准则（Kelly criterion）&lt;/b&gt;。&lt;b&gt;在资产相互独立的假设下，按此权重配置保证了投资组合的夏普率最大。&lt;/b&gt;&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-c4d19a56f3caef42c5ed767fb11c58b8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;570&quot; data-rawheight=&quot;416&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;570&quot; data-original=&quot;https://pic1.zhimg.com/v2-c4d19a56f3caef42c5ed767fb11c58b8_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-c4d19a56f3caef42c5ed767fb11c58b8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;570&quot; data-rawheight=&quot;416&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;570&quot; data-original=&quot;https://pic1.zhimg.com/v2-c4d19a56f3caef42c5ed767fb11c58b8_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-c4d19a56f3caef42c5ed767fb11c58b8_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;在实际资产配置中，涉及的资产一般为不同类别的大类资产（如股票、债券、商品、外汇等）或者是相关性很低的投资策略，资产间可近似假设不相关。&lt;b&gt;量化配置的核心就变成是否能准确的计算不同资产的夏普率（或者其他风险、收益指标）。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;下面以沪深 300、美国 7-10 年国债、标普 500 和黄金四种资产比较一下按夏普率平方分配风险配置（下文中简称为按夏普率配置）和简单多样化配置的效果。这四类资产在回测期内的表现如下（该实证例子来自 2017 年底的&lt;a href=&quot;http://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzIyMDEwNDk1Mg%3D%3D%26mid%3D2650877501%26idx%3D1%26sn%3D65db26221ea270a282c94d47b188ae57%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;《主动风险预算初探》&lt;/a&gt;一文，因此回测期仅到 2017 年底）。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-27b7060a94030817a5604da95354bfcd_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;664&quot; data-rawheight=&quot;222&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;664&quot; data-original=&quot;https://pic2.zhimg.com/v2-27b7060a94030817a5604da95354bfcd_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-27b7060a94030817a5604da95354bfcd_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;664&quot; data-rawheight=&quot;222&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;664&quot; data-original=&quot;https://pic2.zhimg.com/v2-27b7060a94030817a5604da95354bfcd_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-27b7060a94030817a5604da95354bfcd_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;对于按夏普率配置策略，选择月频交易频率，每个月末调仓。调仓时排除最近三个月内收益率均值为负以及由于未上市因而不可交易的资产（例如在 2003 年 3 月 31 日，沪深 300 指数尚未推出，不可交易）。对于满足条件的资产，采用 20 周滚动窗口的周频收益率数据计算夏普率；按照夏普率的平方来分配风险、计算最佳的配置权重。如果当期所有资产都被排除，则在下个月空仓。非空仓时则要求每月均满仓配置，即 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%89_i&quot; alt=&quot;ω_i&quot; eeimg=&quot;1&quot;&gt; 之和为 1。按夏普率配置和简单多样化这两种策略的表现如下图所示。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-58f3f155c56dcbdcb507f5b7eecbae7d_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;853&quot; data-rawheight=&quot;515&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;853&quot; data-original=&quot;https://pic2.zhimg.com/v2-58f3f155c56dcbdcb507f5b7eecbae7d_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-58f3f155c56dcbdcb507f5b7eecbae7d_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;853&quot; data-rawheight=&quot;515&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;853&quot; data-original=&quot;https://pic2.zhimg.com/v2-58f3f155c56dcbdcb507f5b7eecbae7d_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-58f3f155c56dcbdcb507f5b7eecbae7d_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;从上述实证结果来看，按夏普率配置完胜简单多样化。按夏普率平方分配风险似乎 “理论完美、实证给力”，但现实中真的是这样吗？别着急，继续往下看。&lt;/p&gt;&lt;p&gt;上述实证结果的前提是能够对夏普率进行正确的计算。&lt;b&gt;本文的观点是通过有限的样本数据来对总体未知的夏普率进行推断、以及检验不同策略或资产的夏普率是否有显著差异（从而赋予不同的配置权重）是非常困难的一件事（是可能的，但很困难）。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;来看一个假想的例子。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;2 两年 vs 二十年&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;使用正态分布独立构建两个策略的周频收益率序列。假设两个策略的年化真实夏普率分别为 1 和 2；周频的波动率为 1%，通过夏普率就可以计算这两个周频收益率序列各自的均值，从而获得正态分布的全部参数。假设对每个策略产生 &lt;b&gt;1000 个样本点（对应约为二十年的时间）&lt;/b&gt;。&lt;/p&gt;&lt;p&gt;下图首先展示了这两个策略在&lt;b&gt;前 100 个样本点（对应两年）&lt;/b&gt;的累积收益率。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-c89b0a6b7ac07d448de433e01b075f87_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;848&quot; data-rawheight=&quot;421&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;848&quot; data-original=&quot;https://pic4.zhimg.com/v2-c89b0a6b7ac07d448de433e01b075f87_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-c89b0a6b7ac07d448de433e01b075f87_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;848&quot; data-rawheight=&quot;421&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;848&quot; data-original=&quot;https://pic4.zhimg.com/v2-c89b0a6b7ac07d448de433e01b075f87_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-c89b0a6b7ac07d448de433e01b075f87_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;你可能猜到了，我一定会故意找一个年化夏普率为 1 的策略在这前 100 周（对应两年）跑赢那个夏普率为 2 的策略的例子。上图中的蓝色为夏普率为 1 的策略的累积收益率；黄色为夏普率为 2 的策略的累积收益率。&lt;/p&gt;&lt;p&gt;如果我们把时间拉长到全部 1000 个样本点（二十年），则毫无意外的，黄色策略大幅跑赢了蓝色（注意下图中纵坐标是对数坐标）。这个例子说明，即便是年化夏普率 1 和 2 这种巨大的差异，如果只有很短的样本数据也完全能带给我们错误的结论（况且两年已经不短）。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-c4df227ccd5aba97f5540efec1586486_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;849&quot; data-rawheight=&quot;425&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;849&quot; data-original=&quot;https://pic3.zhimg.com/v2-c4df227ccd5aba97f5540efec1586486_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-c4df227ccd5aba97f5540efec1586486_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;849&quot; data-rawheight=&quot;425&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;849&quot; data-original=&quot;https://pic3.zhimg.com/v2-c4df227ccd5aba97f5540efec1586486_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-c4df227ccd5aba97f5540efec1586486_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;你可能接着会说我一定是在“cherry picking”，试了半天找出了上面这么一个有违常理的例子。下面来看看多次仿真的结果。假设进行 5000 次仿真，每次仿真生成年化夏普率分别为 1 和 2 的两个策略，每个策略长度为 1000 个样本点。下图绘制了在前 n 个样本点下（横坐标为 n 的取值），夏普率为 1 的策略跑赢夏普率为 2 的策略的概率（纵坐标）。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-38a7adfeeacb742d0062c6083db7c5aa_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;740&quot; data-rawheight=&quot;371&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;740&quot; data-original=&quot;https://pic3.zhimg.com/v2-38a7adfeeacb742d0062c6083db7c5aa_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-38a7adfeeacb742d0062c6083db7c5aa_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;740&quot; data-rawheight=&quot;371&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;740&quot; data-original=&quot;https://pic3.zhimg.com/v2-38a7adfeeacb742d0062c6083db7c5aa_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-38a7adfeeacb742d0062c6083db7c5aa_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;上图表明，如果我们的样本数据很短（比如 n = 10 或 20 周，对应几个月的情况），使用样本数据夏普率来比较两个策略的错误率（即认为真实夏普率为 1 的策略比真实夏普率为 2 的策略更好）高达 30% 以上；即使是使用 100 个样本点（两年），判断的错误率也有 16.34%。（所以“cherry picking”并没有花费我很多时间。）随着样本长度增加，错误率持续降低。&lt;/p&gt;&lt;p&gt;这个例子说明，&lt;b&gt;哪怕仅仅是希望定性的判断两个策略的夏普率孰高孰低，我们都需要足够长的样本数据。&lt;/b&gt;而如果想定量的比较不同策略的夏普率差异，则需要适合的统计检验。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;3 夏普率检验&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;数学上有很多手段检验两个收益率时间序列的夏普率是否显著不同。在这方面，最早的研究大概是 Jobson and Korkie (1981)。不过该研究假设两个策略的收益率满足二元正态分布，而实际的收益率时间序列中难以满足该假设。&lt;/p&gt;&lt;p&gt;针对上述问题，Ledoit and Wolf (2008) 提出了改进的检验方法。本文的重点虽然不是介绍这些检验方法，但由于下文的举例研究中将使用 Ledoit and Wolf (2008) 的方法，故在本节对其简要说明。感兴趣的朋友请进一步参考原文；跳过本小节也不影响后面内容的阅读。&lt;/p&gt;&lt;p&gt;根据夏普率的定义，它是策略超额收益均值和其标准差的比值。而对于一个随机变量  &lt;img src=&quot;https://www.zhihu.com/equation?tex=X&quot; alt=&quot;X&quot; eeimg=&quot;1&quot;&gt; ，其方差满足如下关系：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28X%29%3D%5Cmbox%7BE%7D%5BX%5E2%5D-%28%5Cmbox%7BE%7D%5BX%5D%29%5E2&quot; alt=&quot;\mbox{var}(X)=\mbox{E}[X^2]-(\mbox{E}[X])^2&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt; 因此，对于（超额）收益率随机变量 r，对应的夏普率可以表达为：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+%5Cmbox%7BSharpe+Ratio%7D%26%3D%26%5Cdisplaystyle%5Cfrac%7B%5Cmbox%7BE%7D%5Br%5D%7D%7B%5Csqrt%7B%5Cmbox%7Bvar%7D%28r%29%7D%7D%5C%5C+%26%3D%26%5Cdisplaystyle%5Cfrac%7B%5Cmbox%7BE%7D%5Br%5D%7D%7B%5Csqrt%7B%5Cmbox%7BE%7D%5Br%5E2%5D-%28%5Cmbox%7BE%7D%5Br%5D%29%5E2%7D%7D+%5Cend%7Barray%7D&quot; alt=&quot;\begin{array}{rll} \mbox{Sharpe Ratio}&amp;amp;=&amp;amp;\displaystyle\frac{\mbox{E}[r]}{\sqrt{\mbox{var}(r)}}\\ &amp;amp;=&amp;amp;\displaystyle\frac{\mbox{E}[r]}{\sqrt{\mbox{E}[r^2]-(\mbox{E}[r])^2}} \end{array}&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;换句话说，夏普率可以表达为收益率 r 的一阶矩（即均值 E[r]）和&lt;b&gt;非中心化&lt;/b&gt;的二阶矩（即 E[r^2]）的函数。Ledoit and Wolf (2008) 正是采用了上述表达式，极大的简化了推导。&lt;/p&gt;&lt;p&gt;对于两个待比较夏普率的收益率序列 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5C%7Br_i%5C%7D&quot; alt=&quot;\{r_i\}&quot; eeimg=&quot;1&quot;&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5C%7Br_n%5C%7D&quot; alt=&quot;\{r_n\}&quot; eeimg=&quot;1&quot;&gt; ，它们的真实（但未知）夏普率之差（用 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%94&quot; alt=&quot;Δ&quot; eeimg=&quot;1&quot;&gt; 表示）是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D%5Br_i%5D&quot; alt=&quot;\mbox{E}[r_i]&quot; eeimg=&quot;1&quot;&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D%5Br_n%5D&quot; alt=&quot;\mbox{E}[r_n]&quot; eeimg=&quot;1&quot;&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D%5Br_i%5E2%5D&quot; alt=&quot;\mbox{E}[r_i^2]&quot; eeimg=&quot;1&quot;&gt; 以及 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D%5Br_n%5E2%5D&quot; alt=&quot;\mbox{E}[r_n^2]&quot; eeimg=&quot;1&quot;&gt; 的函数（为简化表达式，令 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%BC+%3D+%5Cmbox%7BE%7D%5Br%5D&quot; alt=&quot;μ = \mbox{E}[r]&quot; eeimg=&quot;1&quot;&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B3+%3D+%5Cmbox%7BE%7D%5Br%5E2%5D&quot; alt=&quot;γ = \mbox{E}[r^2]&quot; eeimg=&quot;1&quot;&gt; ）：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5CDelta%3Df%28%5Cmu_i%2C%5Cmu_n%2C%5Cgamma_i%2C%5Cgamma_n%29%3D%5Cdisplaystyle%5Cfrac%7B%5Cmu_i%7D%7B%5Csqrt%7B%5Cgamma_i-%5Cmu_i%5E2%7D%7D+-%5Cfrac%7B%5Cmu_n%7D%7B%5Csqrt%7B%5Cgamma_n-%5Cmu_n%5E2%7D%7D&quot; alt=&quot;\Delta=f(\mu_i,\mu_n,\gamma_i,\gamma_n)=\displaystyle\frac{\mu_i}{\sqrt{\gamma_i-\mu_i^2}} -\frac{\mu_n}{\sqrt{\gamma_n-\mu_n^2}}&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;在实际中，我们只有样本数据，使用样本数据计算出的夏普率之差为：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat%5CDelta%3Df%28%5Chat%5Cmu_i%2C%5Chat%5Cmu_n%2C%5Chat%5Cgamma_i%2C%5Chat%5Cgamma_n%29%3D%5Cdisplaystyle%5Cfrac%7B%5Chat%5Cmu_i%7D%7B%5Csqrt%7B%5Chat%5Cgamma_i-%5Chat%5Cmu_i%5E2%7D%7D+-%5Cfrac%7B%5Chat%5Cmu_n%7D%7B%5Csqrt%7B%5Chat%5Cgamma_n-%5Chat%5Cmu_n%5E2%7D%7D&quot; alt=&quot;\hat\Delta=f(\hat\mu_i,\hat\mu_n,\hat\gamma_i,\hat\gamma_n)=\displaystyle\frac{\hat\mu_i}{\sqrt{\hat\gamma_i-\hat\mu_i^2}} -\frac{\hat\mu_n}{\sqrt{\hat\gamma_n-\hat\mu_n^2}}&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;为了对夏普率之差进行检验，我们必须知道样本夏普率之差的 standard error。为此，Ledoit and Wolf (2008) 使用了统计学中的 &lt;a href=&quot;http://link.zhihu.com/?target=https%3A//en.wikipedia.org/wiki/Delta_method&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;delta method&lt;/a&gt;。具体的，令 &lt;img src=&quot;https://www.zhihu.com/equation?tex=v+%3D+%28%CE%BC_i%2C+%CE%BC_n%2C+%CE%B3_i%2C+%CE%B3_n%29%27&quot; alt=&quot;v = (μ_i, μ_n, γ_i, γ_n)&#39;&quot; eeimg=&quot;1&quot;&gt; —— 即向量  &lt;img src=&quot;https://www.zhihu.com/equation?tex=v&quot; alt=&quot;v&quot; eeimg=&quot;1&quot;&gt;  代表了计算两个收益率序列夏普率之差的总体（population）未知参数；令向量  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+v&quot; alt=&quot;\hat v&quot; eeimg=&quot;1&quot;&gt;  对应  &lt;img src=&quot;https://www.zhihu.com/equation?tex=v&quot; alt=&quot;v&quot; eeimg=&quot;1&quot;&gt;  的样本（sample）参数。Ledoit and Wolf (2008) 假设：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Csqrt%7BT%7D%28%5Chat+v-v%29%5Cxrightarrow%7Bd%7D+%5Cmathcal%7BN%7D%280%2C%5CPsi%29&quot; alt=&quot;\sqrt{T}(\hat v-v)\xrightarrow{d} \mathcal{N}(0,\Psi)&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;上式箭头上的  &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;&gt;  表示依分布收敛； &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%A8&quot; alt=&quot;Ψ&quot; eeimg=&quot;1&quot;&gt;  表示 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%28%CE%BC_i%2C+%CE%BC_n%2C+%CE%B3_i%2C+%CE%B3_n%29&quot; alt=&quot;(μ_i, μ_n, γ_i, γ_n)&quot; eeimg=&quot;1&quot;&gt; 的协方差矩阵（未知、需估计）； &lt;img src=&quot;https://www.zhihu.com/equation?tex=T&quot; alt=&quot;T&quot; eeimg=&quot;1&quot;&gt; 为样本长度。由于夏普率之差  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%94&quot; alt=&quot;Δ&quot; eeimg=&quot;1&quot;&gt;  是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=v&quot; alt=&quot;v&quot; eeimg=&quot;1&quot;&gt; 的函数，直接使用 delta method 可得：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Csqrt%7BT%7D%28%5Chat+%5CDelta-%5CDelta%29%5Cxrightarrow%7Bd%7D+%5Cmathcal%7BN%7D%280%2C%5Cnabla+f%28v%29%5ET%5CPsi%5Cnabla+f%28v%29%29&quot; alt=&quot;\sqrt{T}(\hat \Delta-\Delta)\xrightarrow{d} \mathcal{N}(0,\nabla f(v)^T\Psi\nabla f(v))&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;其中：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cnabla+f%28v%29%3D%5Cdisplaystyle%5Cleft%5B+%5Cbegin%7Barray%7D%7Br%7D+%5Cdisplaystyle%5Cfrac%7B%5Cgamma_i%7D%7B%28%5Cgamma_i-%5Cmu_i%5E2%29%5E%7B1.5%7D%7D%5C%5C+%5Cdisplaystyle-%5Cfrac%7B%5Cgamma_n%7D%7B%28%5Cgamma_n-%5Cmu_n%5E2%29%5E%7B1.5%7D%7D%5C%5C+%5Cdisplaystyle-%5Cfrac%7B1%7D%7B2%7D%5Cfrac%7B%5Cmu_i%7D%7B%28%5Cgamma_i-%5Cmu_i%5E2%29%5E%7B1.5%7D%7D%5C%5C+%5Cdisplaystyle%5Cfrac%7B1%7D%7B2%7D%5Cfrac%7B%5Cmu_n%7D%7B%28%5Cgamma_n-%5Cmu_n%5E2%29%5E%7B1.5%7D%7D+%5Cend%7Barray%7D%5Cright%5D&quot; alt=&quot;\nabla f(v)=\displaystyle\left[ \begin{array}{r} \displaystyle\frac{\gamma_i}{(\gamma_i-\mu_i^2)^{1.5}}\\ \displaystyle-\frac{\gamma_n}{(\gamma_n-\mu_n^2)^{1.5}}\\ \displaystyle-\frac{1}{2}\frac{\mu_i}{(\gamma_i-\mu_i^2)^{1.5}}\\ \displaystyle\frac{1}{2}\frac{\mu_n}{(\gamma_n-\mu_n^2)^{1.5}} \end{array}\right]&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;上式就是使用样本数据计算的夏普率之差需要满足的分布。一旦我们能够得到协方差矩阵 Ψ 的相合估计  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+%CE%A8&quot; alt=&quot;\hat Ψ&quot; eeimg=&quot;1&quot;&gt; ，就可以利用下式求出  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+%CE%94&quot; alt=&quot;\hat Δ&quot; eeimg=&quot;1&quot;&gt;  的 standard error：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Cmbox%7Bs.e.%7D%28%5Chat+%5CDelta%29%3D%5Csqrt%7B%5Cfrac%7B%5Cnabla+f%28%5Chat+v%29%5ET%5Chat%5CPsi%5Cnabla+f%28%5Chat+v%29%7D%7BT%7D%7D&quot; alt=&quot;\displaystyle\mbox{s.e.}(\hat \Delta)=\sqrt{\frac{\nabla f(\hat v)^T\hat\Psi\nabla f(\hat v)}{T}}&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;有了 standard error，再假设真实夏普率之差为  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%94+%3D+%CE%B8&quot; alt=&quot;Δ = θ&quot; eeimg=&quot;1&quot;&gt; ，便可以计算 t-statistic：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Cmbox%7Bt-statistic%7D%3D%5Cfrac%7B%5Chat%5CDelta-%5Ctheta%7D%7B%5Cmbox%7Bs.e.%7D%28%5Chat+%5CDelta%29%7D&quot; alt=&quot;\displaystyle\mbox{t-statistic}=\frac{\hat\Delta-\theta}{\mbox{s.e.}(\hat \Delta)}&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;有了 t-statistic 就可以进一步计算 p-value 并以此接受或拒绝原假设 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%94+%3D+%CE%B8&quot; alt=&quot;Δ = θ&quot; eeimg=&quot;1&quot;&gt; 。问题的核心由此归结为估计协方差矩阵  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%A8&quot; alt=&quot;Ψ&quot; eeimg=&quot;1&quot;&gt; 。为此，Ledoit and Wolf (2008) 给出了两种方法：&lt;/p&gt;&lt;p&gt;第一种方法是基于渐进正态性的假设，使用 heteroskedasticity and autocorrelation (HAC) kernel estimation 对  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%A8&quot; alt=&quot;Ψ&quot; eeimg=&quot;1&quot;&gt;  进行估计。在协方差矩阵的 HAC 估计方面，学术界有很多方法，Ledoit and Wolf (2008) 采用的是 Andrews (1991) 给出的方法。&lt;/p&gt;&lt;p&gt;第二种方法是使用自助法（bootstrap）。Ledoit and Wolf (2008) 认为对于实际中的收益率时间序列，由于分布未知且样本数量较短，前一种基于渐进正态性的方法可能无法给出正确的估计。出于这种考虑，Ledoit and Wolf (2008) 采用了 studentized bootstrap 方法（见&lt;a href=&quot;https://zhuanlan.zhihu.com/p/41099219&quot; class=&quot;internal&quot;&gt;《用 Bootstrap 进行参数估计大有可为》&lt;/a&gt;中的第五节）。&lt;/p&gt;&lt;p&gt;由于篇幅所限，本节不再展开介绍协方差矩阵 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%A8&quot; alt=&quot;Ψ&quot; eeimg=&quot;1&quot;&gt; 的估计。感兴趣的朋友请参考 Ledoit and Wolf (2008)。在下一节的实验中，由于使用的假想收益率序列出自正态分布，因此使用上述第一种方法对夏普率进行检验。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;4 回答正确的问题&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;上述夏普率差别的检验回答的是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bprob%7D%28%5Chat+%CE%94+%7C+%CE%94+%3D+%CE%B8%29&quot; alt=&quot;\mbox{prob}(\hat Δ | Δ = θ)&quot; eeimg=&quot;1&quot;&gt; 的问题 —— 即在原假设 &lt;img src=&quot;https://www.zhihu.com/equation?tex=H_0%3A%CE%94+%3D+%CE%B8+&quot; alt=&quot;H_0:Δ = θ &quot; eeimg=&quot;1&quot;&gt; 下，我们观测到样本夏普率差异  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+%CE%94&quot; alt=&quot;\hat Δ&quot; eeimg=&quot;1&quot;&gt;  的概率。&lt;b&gt;在实际进行资产配置时，即便我们能显著的拒绝原假设，它也不是我们最关心的问题。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;在利用不同夏普率进行资产配置时，正确的问题是计算 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bprob%7D%28%CE%94+%3D+%CE%B8+%7C+%5Chat+%CE%94%29&quot; alt=&quot;\mbox{prob}(Δ = θ | \hat Δ)&quot; eeimg=&quot;1&quot;&gt; —— &lt;b&gt;即当样本数据显示出 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+%CE%94&quot; alt=&quot;\hat Δ&quot; eeimg=&quot;1&quot;&gt;&lt;b&gt; 的夏普率差异时，这两个策略真实夏普率差异是 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B8&quot; alt=&quot;θ&quot; eeimg=&quot;1&quot;&gt; &lt;b&gt; 的概率。&lt;/b&gt;由贝叶斯法则可知， &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bprob%7D%28%CE%94+%3D+%CE%B8+%7C+%5Chat+%CE%94%29&quot; alt=&quot;\mbox{prob}(Δ = θ | \hat Δ)&quot; eeimg=&quot;1&quot;&gt; 与 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%94+%3D+%CE%B8&quot; alt=&quot;Δ = θ&quot; eeimg=&quot;1&quot;&gt; 的先验概率以及统计检验结果 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bprob%7D%28%5Chat+%CE%94+%7C+%CE%94+%3D+%CE%B8%29&quot; alt=&quot;\mbox{prob}(\hat Δ | Δ = θ)&quot; eeimg=&quot;1&quot;&gt; 的乘积成正比：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+%5Cdisplaystyle+%5Cmbox%7Bprob%7D%28%5CDelta%3D%5Ctheta%7C%5Chat%5CDelta%29%26%3D%26%5Cdisplaystyle+%5Cfrac%7B%5Cmbox%7Bprob%7D%28%5CDelta+%3D%5Ctheta%29%5Cmbox%7Bprob%7D%28%5Chat%5CDelta%7C%5CDelta%3D%5Ctheta%29%7D%7B%5Cmbox%7Bprob%7D%28%5Chat%5CDelta%29%7D%5C%5C+%26%5Cpropto%26%5Cdisplaystyle%5Cmbox%7Bprob%7D%28%5CDelta%3D%5Ctheta%29%5Cmbox%7Bprob%7D%28%5Chat%5CDelta%7C%5CDelta%3D%5Ctheta%29+%5Cend%7Barray%7D+&quot; alt=&quot;\begin{array}{rll} \displaystyle \mbox{prob}(\Delta=\theta|\hat\Delta)&amp;amp;=&amp;amp;\displaystyle \frac{\mbox{prob}(\Delta =\theta)\mbox{prob}(\hat\Delta|\Delta=\theta)}{\mbox{prob}(\hat\Delta)}\\ &amp;amp;\propto&amp;amp;\displaystyle\mbox{prob}(\Delta=\theta)\mbox{prob}(\hat\Delta|\Delta=\theta) \end{array} &quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;上式说明，为了计算 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bprob%7D%28%CE%94+%3D+%CE%B8+%7C+%5Chat+%CE%94%29&quot; alt=&quot;\mbox{prob}(Δ = θ | \hat Δ)&quot; eeimg=&quot;1&quot;&gt; 需要知道先验 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bprob%7D%28%CE%94+%3D+%CE%B8%29&quot; alt=&quot;\mbox{prob}(Δ = θ)&quot; eeimg=&quot;1&quot;&gt; 是多少。在一定程度上，它的取值和主观经验判断密切相关 —— 比如认为两个策略夏普率没有差异的概率最大；或者认为某个策略就是风险收益更高，因此它们年化夏普率差异为 1 的概率最大等。&lt;/p&gt;&lt;p&gt;下面，假设真实年化夏普率差异 θ 的取值为 0、0.5 和 1，并假设 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bprob%7D%28%CE%94+%3D+0%29+%3D+0.6&quot; alt=&quot;\mbox{prob}(Δ = 0) = 0.6&quot; eeimg=&quot;1&quot;&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bprob%7D%28%CE%94+%3D+0.5%29+%3D+0.2&quot; alt=&quot;\mbox{prob}(Δ = 0.5) = 0.2&quot; eeimg=&quot;1&quot;&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bprob%7D%28%CE%94+%3D+1%29+%3D+0.2&quot; alt=&quot;\mbox{prob}(Δ = 1) = 0.2&quot; eeimg=&quot;1&quot;&gt; 。我们再来看看第二节中的那两个策略。&lt;/p&gt;&lt;p&gt;当只有前 100 周的样本数据，通过使用本文第三节介绍的检验方法得到如下结果：&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-16db61d9c920886f3b12a23a6105f547_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;723&quot; data-rawheight=&quot;157&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;723&quot; data-original=&quot;https://pic4.zhimg.com/v2-16db61d9c920886f3b12a23a6105f547_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-16db61d9c920886f3b12a23a6105f547_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;723&quot; data-rawheight=&quot;157&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;723&quot; data-original=&quot;https://pic4.zhimg.com/v2-16db61d9c920886f3b12a23a6105f547_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-16db61d9c920886f3b12a23a6105f547_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;从 prob(Δ = θ) 和 prob(\hat Δ | Δ = θ) 的乘积来看，最大的是 θ = 0.0 的情况，这说明仅仅通过 100 期的表现，我们并不能认为这两个策略中谁更好，尽管实际情况是策略 2 的真实夏普率是策略 1 的两倍。&lt;/p&gt;&lt;p&gt;当使用全部 1000 个样本数据时，可得到的结果如下。在足够长的样本数据下（二十年），结果显示两个策略最有可能的真实夏普率差别是 θ = 1.0。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-b1f05010d3e5b204c49b0280303fa9de_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;721&quot; data-rawheight=&quot;158&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;721&quot; data-original=&quot;https://pic3.zhimg.com/v2-b1f05010d3e5b204c49b0280303fa9de_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-b1f05010d3e5b204c49b0280303fa9de_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;721&quot; data-rawheight=&quot;158&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;721&quot; data-original=&quot;https://pic3.zhimg.com/v2-b1f05010d3e5b204c49b0280303fa9de_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-b1f05010d3e5b204c49b0280303fa9de_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;这个例子虽然从收益率序列到先验都是假想的，但通过它想要引出的观点是：&lt;/p&gt;&lt;p&gt;&lt;b&gt;1. &lt;/b&gt;评价不同资产/策略的夏普率差异（进而进行更主动的资产配置）需要一个基于统计手段的科学分析框架，并在这个框架下回答正确的问题；&lt;/p&gt;&lt;p&gt;&lt;b&gt;2. &lt;/b&gt;样本数据的长短对于总体统计量的推断至关重要，使用很短的数据计算夏普率或者资产配置也许更倾向于配置噪音。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;5 结语&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;资产配置从来都不是一个容易的课题。&lt;/p&gt;&lt;p&gt;当我们知道不同策略（或者资产）真实夏普率的时候，没有理由使用简单多样化配置；充分利用不同资产的夏普率信息才可能最大化投资组合的夏普率，达到最优的风险收益特性。可惜，真实夏普率是未知的。&lt;/p&gt;&lt;p&gt;&lt;b&gt;使用收益率序列计算夏普率并比较不同策略时应该使用科学的统计检验并回答正确的问题。这需要合理的先验和足够长的数据。&lt;/b&gt;而基于有限的数据计算出（不确定性极大的）夏普率来配置相当于择时。计算夏普率在一定程度上近似于计算收益率；短时间内收益率的外推性是非常差的，因此使用短时间内夏普率进行资产配置（择时）并不十分合理的。&lt;/p&gt;&lt;p&gt;为什么第一节中的例子里按照滚动窗口计算出的夏普率来配置显著战胜了简单多样化呢？其原因是 A 股中泾渭分明的牛、熊市 —— 任何对着 A 股的择时策略只要能躲过几波熊市都会显著提升样本内效果。在该例子中，一旦我们把 A 股从资产池中排除，对于余下几种资产，使用滚动夏普率并没有战胜简单多样化（下图）。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-ef355e761fc9b7c580b06337aec620c8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;968&quot; data-rawheight=&quot;545&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;968&quot; data-original=&quot;https://pic1.zhimg.com/v2-ef355e761fc9b7c580b06337aec620c8_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-ef355e761fc9b7c580b06337aec620c8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;968&quot; data-rawheight=&quot;545&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;968&quot; data-original=&quot;https://pic1.zhimg.com/v2-ef355e761fc9b7c580b06337aec620c8_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-ef355e761fc9b7c580b06337aec620c8_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;当使用了正确的方法和足够的数据之后，对于夏普率的判断（从而改变策略配置权重）是一种改变我们先验的低频行为。&lt;/b&gt;如果正确，它将会提高投资组合在未来的风险收益特征；如果错误，它则大概率是在样本内对着数据过拟合而已。&lt;/p&gt;&lt;p&gt;&lt;b&gt;基于有限的收益率序列、滚动计算夏普率（或其他风险、收益指标）并配置资产，到底是在配置风险收益还是在配置噪音？&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;参考文献&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Andrews, D. W. K. (1991). Heteroskedasticity and autocorrelation consistent covariance matrix estimation. &lt;i&gt;Econometrica&lt;/i&gt;, Vol. 59(3), 817 – 858.&lt;/li&gt;&lt;li&gt;Jobson, J. D. and B. M. Korkie (1981). Performance hypothesis testing with the Sharpe and Treynor measures. &lt;i&gt;Journal of Finance&lt;/i&gt;, Vol. 36(4), 889 – 908.&lt;/li&gt;&lt;li&gt;Ledoit, O. and M. Wolf (2008). Robust performance hypothesis testing with the Sharpe ratio. &lt;i&gt;Journal of Empirical Finance&lt;/i&gt;, Vol. 15(5), 850 – 859.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处，谢谢。已委托“维权骑士”(&lt;a href=&quot;http://link.zhihu.com/?target=http%3A//rightknights.com&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;维权骑士_免费版权监测/版权保护/版权分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2019-01-23-55549936</guid>
<pubDate>Wed, 23 Jan 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>多因子回归检验中的 Newey-West 调整</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2019-01-16-54913149.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/54913149&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-74781a2b37d40bae46dca534e259ec5a_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;摘要&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;Newey-West 调整是计量经济学中的经典方法，在多因子模型回归分析中无处不在。本文介绍它的用法。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;1 引言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;本文有很多数学公式。&lt;/p&gt;&lt;p&gt;本文的推导重点参考了 William Greene 的经典教材 Econometric Analysis（Greene 2003，我用的第五版，最新的出到了第八版）。&lt;/p&gt;&lt;p&gt;本文回答了一个曾让我纠结很久的问题。&lt;/p&gt;&lt;p&gt;在学术界关于 empirical asset pricing 的论文中，portfolio test 和 regression test 是检验一个新因子是否有效的两个常见手段。在前者中，使用已有因子的收益率作为 regressors、使用基于新因子构建的投资组合的收益率作为被解释变量，进行时序回归，从而检验新因子组合是否可以获得超额收益 α、以及它在已有因子上的 β。在后者中，新因子和已有因子一起被用来和个股收益率进行截面回归（通常使用 Fama-MacBeth regression），然后考察新因子的预期收益率 E[f] 是否显著不为零。&lt;/p&gt;&lt;p&gt;无论是上面哪种方法，学者们都会对回归分析得到的 α、β 以及 E[f] 给出 t-statistic 从而检验它们的显著性。而在学术论文所报告的结果中，经常出现诸如“Newey and West adjusted t-statistic”或者“Newey and West adjusted standard error”（standard error 是用来计算 t-statistic 的）这样的描述。这不禁让人疑问：&lt;b&gt;回归检验中的 Newey and West 调整到底是什么？&lt;/b&gt;&lt;/p&gt;&lt;p&gt;除了要搞懂它到底是什么之外，我们也关心它是如何实操的，这样才能将它用在 A 股的实证研究中。这就是本文关心的话题。本文的内容提要如下：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;第二、三节介绍必要的数学背景，解释 Newey-West 调整的重要性。&lt;/li&gt;&lt;li&gt;第四节针对 A 股进行 portfolio test 的实证研究，指出考虑 Newey-West 调整后 α 和 β 的显著性的变化。&lt;/li&gt;&lt;li&gt;第五节说明通过 Fama-MacBeth regression 求解因子预期收益率 E[f] 中的 Newey-West 调整是一种简化版。&lt;/li&gt;&lt;li&gt;第六节总结本文，并评论一下 Barra 在计算协方差矩阵中的 Newey-West 调整。&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;让我们从广义线性回归说起。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;2 广义线性回归&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;考虑如下&lt;b&gt;广义线性回归模型（generalized linear regression model）&lt;/b&gt;：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+%5Cdisplaystyle+%5Cmathbf%7By%7D%26%3D%26%5Cmathbf%7BX%5Cbeta%7D%2B%5Cmathbf%7B%5Cvarepsilon%7D%5C%5C+%5Cmbox%7BE%7D%5B%5Cmathbf%7B%5Cvarepsilon%7D%7C%5Cmathbf%7BX%7D%5D%26%3D%26%5Cmathbf%7B0%7D%5C%5C+%5Cmbox%7BE%7D%5B%5Cmathbf%7B%5Cvarepsilon%5Cvarepsilon%27%7D%7C%5Cmathbf%7BX%7D%5D%26%3D%26%5Csigma%5E2%5Cmathbf%7B%5COmega%7D%3D%5Cmathbf%7B%5CSigma%7D+%5Cend%7Barray%7D+&quot; alt=&quot;\begin{array}{rll} \displaystyle \mathbf{y}&amp;amp;=&amp;amp;\mathbf{X\beta}+\mathbf{\varepsilon}\\ \mbox{E}[\mathbf{\varepsilon}|\mathbf{X}]&amp;amp;=&amp;amp;\mathbf{0}\\ \mbox{E}[\mathbf{\varepsilon\varepsilon&#39;}|\mathbf{X}]&amp;amp;=&amp;amp;\sigma^2\mathbf{\Omega}=\mathbf{\Sigma} \end{array} &quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;上述模型是&lt;b&gt;时序上&lt;/b&gt;的线性回归模型；其中 &lt;b&gt;y&lt;/b&gt; 是 T × 1 阶向量（T 代表时序的总期数）；&lt;b&gt;X&lt;/b&gt; 是 T × K 阶矩矩阵（其中 K 是 regressors 的个数）；&lt;b&gt;ε&lt;/b&gt; 是 T × 1 阶残差向量；&lt;b&gt;Σ&lt;/b&gt;（T × T 阶）是残差的协方差矩阵。回归的目的是为了得到回归系数 &lt;b&gt;β&lt;/b&gt;（K × 1 阶矩阵）并检验它们的显著性。&lt;/p&gt;&lt;p&gt;上述模型和经典线性回归模型最大的区别是矩阵 &lt;b&gt;Ω&lt;/b&gt; 的引入。在经典模型中假设给定解释变量 &lt;b&gt;X&lt;/b&gt; 下，不同时刻 t 的残差是独立且同方差，因此 &lt;b&gt;Ω&lt;/b&gt; 是单位阵 &lt;b&gt;I&lt;/b&gt;。&lt;/p&gt;&lt;p&gt;在广义线性回归中，残差独立、同方差这两个假设均可被打破，从而得到两个残差中常见的特性：&lt;b&gt;异方差（heteroscedasticity）&lt;/b&gt;和&lt;b&gt;自相关（autocorrelation）&lt;/b&gt;。多因子模型回归中的残差就经常呈现上述两种特性。在广义线性回归模型中引入 &lt;b&gt;Ω&lt;/b&gt; 正是为了反映上述特性。以下是两个例子。&lt;/p&gt;&lt;p&gt;对于异方差（但仍可以假设独立），通常有：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brllll%7D+%5Csigma%5E2%5Cmathbf%7B%5COmega%7D%26%3D%26%5Csigma%5E2+%5Cleft%5B%5Cbegin%7Barray%7D%7Bcccc%7D+%5Comega_%7B11%7D%260%26%5Ccdots%260%5C%5C+0%26%5Comega_%7B22%7D%26%5Ccdots%260%5C%5C+%5Cvdots%26%5Cvdots%26%5Cddots%26%5Cvdots%5C%5C+0%260%26%5Ccdots%26%5Comega_%7BTT%7D+%5Cend%7Barray%7D%5Cright%5D%26%3D%26+%5Cleft%5B%5Cbegin%7Barray%7D%7Bcccc%7D+%5Csigma_%7B1%7D%5E2%260%26%5Ccdots%260%5C%5C+0%26%5Csigma_%7B2%7D%5E2%26%5Ccdots%260%5C%5C+%5Cvdots%26%5Cvdots%26%5Cddots%26%5Cvdots%5C%5C+0%260%26%5Ccdots%26%5Csigma_%7BT%7D%5E2+%5Cend%7Barray%7D%5Cright%5D+%5Cend%7Barray%7D&quot; alt=&quot;\begin{array}{rllll} \sigma^2\mathbf{\Omega}&amp;amp;=&amp;amp;\sigma^2 \left[\begin{array}{cccc} \omega_{11}&amp;amp;0&amp;amp;\cdots&amp;amp;0\\ 0&amp;amp;\omega_{22}&amp;amp;\cdots&amp;amp;0\\ \vdots&amp;amp;\vdots&amp;amp;\ddots&amp;amp;\vdots\\ 0&amp;amp;0&amp;amp;\cdots&amp;amp;\omega_{TT} \end{array}\right]&amp;amp;=&amp;amp; \left[\begin{array}{cccc} \sigma_{1}^2&amp;amp;0&amp;amp;\cdots&amp;amp;0\\ 0&amp;amp;\sigma_{2}^2&amp;amp;\cdots&amp;amp;0\\ \vdots&amp;amp;\vdots&amp;amp;\ddots&amp;amp;\vdots\\ 0&amp;amp;0&amp;amp;\cdots&amp;amp;\sigma_{T}^2 \end{array}\right] \end{array}&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;对于自相关（但同方差），通常有：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+%5Csigma%5E2%5Cmathbf%7B%5COmega%7D%26%3D%26%5Csigma%5E2+%5Cleft%5B%5Cbegin%7Barray%7D%7Bcccc%7D+1%26%5Crho_1%26%5Ccdots%26%5Crho_%7BT-1%7D%5C%5C+%5Crho_1%261%26%5Ccdots%26%5Crho_%7BT-2%7D%5C%5C+%5Cvdots%26%5Cvdots%26%5Cddots%26%5Cvdots%5C%5C+%5Crho_%7BT-1%7D%26%5Crho_%7BT-2%7D%26%5Ccdots%261+%5Cend%7Barray%7D%5Cright%5D+%5Cend%7Barray%7D&quot; alt=&quot;\begin{array}{rll} \sigma^2\mathbf{\Omega}&amp;amp;=&amp;amp;\sigma^2 \left[\begin{array}{cccc} 1&amp;amp;\rho_1&amp;amp;\cdots&amp;amp;\rho_{T-1}\\ \rho_1&amp;amp;1&amp;amp;\cdots&amp;amp;\rho_{T-2}\\ \vdots&amp;amp;\vdots&amp;amp;\ddots&amp;amp;\vdots\\ \rho_{T-1}&amp;amp;\rho_{T-2}&amp;amp;\cdots&amp;amp;1 \end{array}\right] \end{array}&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;当然我们也可以既考虑异方差又考虑自相关性。在一般情况下 &lt;b&gt;Ω&lt;/b&gt; 矩阵中第 i 行、第 j 列的元素用 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%89_%7Bij%7D&quot; alt=&quot;ω_{ij}&quot; eeimg=&quot;1&quot;&gt; 表示。&lt;/p&gt;&lt;p&gt;如果 &lt;b&gt;Ω&lt;/b&gt; 已知，则通常使用 generalized least squares 来对 &lt;b&gt;β&lt;/b&gt; 进行参数估计。但当 &lt;b&gt;Ω&lt;/b&gt; 未知时，OLS 往往是首选。对该广义线性回归模型进行 OLS 求解就可以得到 &lt;b&gt;β&lt;/b&gt; 的 OLS 估计，记为 &lt;b&gt;b&lt;/b&gt;：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmathbf%7Bb%7D%3D%28%5Cmathbf%7BX%27X%7D%29%5E%7B-1%7D%5Cmathbf%7BX%27y%7D%3D%5Cmathbf%7B%5Cbeta%7D%2B%28%5Cmathbf%7BX%27X%7D%29%5E%7B-1%7D%5Cmathbf%7BX%27%5Cvarepsilon%7D&quot; alt=&quot;\mathbf{b}=(\mathbf{X&#39;X})^{-1}\mathbf{X&#39;y}=\mathbf{\beta}+(\mathbf{X&#39;X})^{-1}\mathbf{X&#39;\varepsilon}&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;对上式两边取期望，则当 E[&lt;b&gt;ε&lt;/b&gt;|&lt;b&gt;X&lt;/b&gt;] = 0 的假设成立时易知 E[&lt;b&gt;b&lt;/b&gt;] = &lt;b&gt;β&lt;/b&gt;。利用 E[&lt;b&gt;b&lt;/b&gt;] = &lt;b&gt;β&lt;/b&gt; 进而推导出 &lt;b&gt;b&lt;/b&gt; 的协方差矩阵，记为 &lt;b&gt;V&lt;/b&gt;_OLS：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+%5Cmathbf%7BV%7D_%7B%5Cmbox%7BOLS%7D%7D%26%3D%26%5Cmbox%7BE%7D%5B%28%5Cmathbf%7Bb-%5Cbeta%7D%29%28%5Cmathbf%7Bb-%5Cbeta%7D%29%27%7C%5Cmathbf%7BX%7D%5D%5C%5C+%26%3D%26%5Cmbox%7BE%7D%5B%28%5Cmathbf%7BX%27X%7D%29%5E%7B-1%7D%5Cmathbf%7BX%7D%27%5Cvarepsilon%5Cvarepsilon%27%5Cmathbf%7BX%28X%27X%29%7D%5E%7B-1%7D%7C%5Cmathbf%7BX%7D%5D%5C%5C+%26%3D%26%28%5Cmathbf%7BX%27X%7D%29%5E%7B-1%7D%5Cmathbf%7BX%7D%27%28%5Csigma%5E2%5Cmathbf%7B%5COmega%7D%29%5Cmathbf%7BX%28X%27X%29%7D%5E%7B-1%7D%5C%5C+%26%3D%26%5Cdisplaystyle%5Cfrac%7B1%7D%7BT%7D%5Cleft%28%5Cfrac%7B1%7D%7BT%7D%5Cmathbf%7BX%27X%7D%5Cright%29%5E%7B-1%7D%5Cleft%28%5Cfrac%7B1%7D%7BT%7D%5Cmathbf%7BX%27%7D%5B%5Csigma%5E2%5Cmathbf%7B%5COmega%7D%5D%5Cmathbf%7BX%7D%5Cright%29%5Cleft%28%5Cfrac%7B1%7D%7BT%7D%5Cmathbf%7BX%27X%7D%5Cright%29%5E%7B-1%7D+%5Cend%7Barray%7D&quot; alt=&quot;\begin{array}{rll} \mathbf{V}_{\mbox{OLS}}&amp;amp;=&amp;amp;\mbox{E}[(\mathbf{b-\beta})(\mathbf{b-\beta})&#39;|\mathbf{X}]\\ &amp;amp;=&amp;amp;\mbox{E}[(\mathbf{X&#39;X})^{-1}\mathbf{X}&#39;\varepsilon\varepsilon&#39;\mathbf{X(X&#39;X)}^{-1}|\mathbf{X}]\\ &amp;amp;=&amp;amp;(\mathbf{X&#39;X})^{-1}\mathbf{X}&#39;(\sigma^2\mathbf{\Omega})\mathbf{X(X&#39;X)}^{-1}\\ &amp;amp;=&amp;amp;\displaystyle\frac{1}{T}\left(\frac{1}{T}\mathbf{X&#39;X}\right)^{-1}\left(\frac{1}{T}\mathbf{X&#39;}[\sigma^2\mathbf{\Omega}]\mathbf{X}\right)\left(\frac{1}{T}\mathbf{X&#39;X}\right)^{-1} \end{array}&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;当残差不存在异方差以及自相关性时，&lt;b&gt;Ω&lt;/b&gt; = &lt;b&gt;I&lt;/b&gt; 而上面的协方差矩阵也可以简化成我们最熟悉的经典 OLS 里面的形式，也就是各种 OLS 软件包给出的参数的标准误（协方差矩阵对角线元素的平方根）和 t-statistic 的结果。然而，&lt;b&gt;当残差存在异方差或者自相关时，OLS 得到的 β 的方差的估计是不准确的，从而影响对 β 进行统计检验。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;在 &lt;b&gt;Ω&lt;/b&gt; 未知的情况下，需对 &lt;b&gt;V&lt;/b&gt;_OLS 进行估计。上面的表达式可以看成是三个矩阵相乘的形式，其中第一个和第三个仅和 &lt;b&gt;X&lt;/b&gt; 有关，因此&lt;b&gt;核心目标就是估计中间矩阵（middle matrix）。&lt;/b&gt;为了方便讨论，另&lt;b&gt;Q&lt;/b&gt; 代表中间的矩阵：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+%5Cmathbf%7BQ%7D%26%3D%26%5Cdisplaystyle%5Cfrac%7B1%7D%7BT%7D%5Cmathbf%7BX%27%7D%5B%5Csigma%5E2%5Cmathbf%7B%5COmega%7D%5D%5Cmathbf%7BX%7D%5C%5C+%26%3D%26%5Cdisplaystyle%5Cfrac%7B1%7D%7BT%7D%5Csum_%7Bi%3D1%7D%5ET%5Csum_%7Bj%3D1%7D%5ET%5Csigma_%7Bij%7D%5Cmathbf%7Bx%7D_i%5Cmathbf%7Bx%7D_j%27+%5Cend%7Barray%7D&quot; alt=&quot;\begin{array}{rll} \mathbf{Q}&amp;amp;=&amp;amp;\displaystyle\frac{1}{T}\mathbf{X&#39;}[\sigma^2\mathbf{\Omega}]\mathbf{X}\\ &amp;amp;=&amp;amp;\displaystyle\frac{1}{T}\sum_{i=1}^T\sum_{j=1}^T\sigma_{ij}\mathbf{x}_i\mathbf{x}_j&#39; \end{array}&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;其中  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmathbf%7Bx%7D_i+%3D+%5Bx_%7Bi1%7D%2C+x_%7Bi2%7D%2C+%E2%80%A6%2C+x_%7BiK%7D%5D%E2%80%99&quot; alt=&quot;\mathbf{x}_i = [x_{i1}, x_{i2}, …, x_{iK}]’&quot; eeimg=&quot;1&quot;&gt; ，即 &lt;b&gt;X&lt;/b&gt; 的第 i 行的转置（注意它不等于 &lt;b&gt;X&lt;/b&gt; 的第 i 列）。一旦我们能找到矩阵 &lt;b&gt;Q&lt;/b&gt; 的估计，便可进而求出 &lt;b&gt;b&lt;/b&gt; 的协方差矩阵 &lt;b&gt;V&lt;/b&gt;_OLS。在估计 &lt;b&gt;Q&lt;/b&gt; 时，我们需要用到的“武器”便是 regressor 矩阵 &lt;b&gt;X&lt;/b&gt; 以及样本残差 &lt;b&gt;e&lt;/b&gt;。&lt;/p&gt;&lt;p&gt;针对残差的假设不同，最常见的两种估计是 White 估计（仅假设异方差）以及 Newey and West 估计（考虑异方差及自相关）。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;3 White and Newey-West Estimators&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;当残差仅有异方差但没有自相关时，我们需要的估计量 &lt;b&gt;Q&lt;/b&gt; 简化为：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+%5Cmathbf%7BQ%7D%26%3D%26%5Cdisplaystyle%5Cfrac%7B1%7D%7BT%7D%5Csum_%7Bi%3D1%7D%5ET%5Csigma_%7Bi%7D%5E2%5Cmathbf%7Bx%7D_i%5Cmathbf%7Bx%7D_i%27+%5Cend%7Barray%7D+&quot; alt=&quot;\begin{array}{rll} \mathbf{Q}&amp;amp;=&amp;amp;\displaystyle\frac{1}{T}\sum_{i=1}^T\sigma_{i}^2\mathbf{x}_i\mathbf{x}_i&#39; \end{array} &quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;White (1980) 指出使用 &lt;b&gt;X&lt;/b&gt; 以及 &lt;b&gt;e&lt;/b&gt; 可以求出 &lt;b&gt;Q&lt;/b&gt; 的渐进估计（记为 &lt;b&gt;S&lt;/b&gt;_0）：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+%5Cmathbf%7BS%7D_0%26%3D%26%5Cdisplaystyle%5Cfrac%7B1%7D%7BT%7D%5Csum_%7Bi%3D1%7D%5ET+e_%7Bi%7D%5E2%5Cmathbf%7Bx%7D_i%5Cmathbf%7Bx%7D_i%27+%5Cend%7Barray%7D+&quot; alt=&quot;\begin{array}{rll} \mathbf{S}_0&amp;amp;=&amp;amp;\displaystyle\frac{1}{T}\sum_{i=1}^T e_{i}^2\mathbf{x}_i\mathbf{x}_i&#39; \end{array} &quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;将上述 &lt;b&gt;Q&lt;/b&gt; 的估计 &lt;b&gt;S&lt;/b&gt;_0 代入到 &lt;b&gt;V&lt;/b&gt;_OLS 的表达式中，可以得到 &lt;b&gt;b&lt;/b&gt; 的协方差矩阵的估计：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+%5Cmathbf%7BV%7D_%7B%5Cmbox%7BOLS%7D%7D%26%3D%26%5Cdisplaystyle%5Cfrac%7B1%7D%7BT%7D%5Cleft%28%5Cfrac%7B1%7D%7BT%7D%5Cmathbf%7BX%27X%7D%5Cright%29%5E%7B-1%7D%5Cleft%28%5Cfrac%7B1%7D%7BT%7D%5Csum_%7Bi%3D1%7D%5ET+e_i%5E2%5Cmathbf%7Bx%7D_i%5Cmathbf%7Bx%7D_i%27%5Cright%29%5Cleft%28%5Cfrac%7B1%7D%7BT%7D%5Cmathbf%7BX%27X%7D%5Cright%29%5E%7B-1%7D%5C%5C%5C%5C+%26%3D%26T%28%5Cmathbf%7BX%27X%7D%29%5E%7B-1%7D%5Cmathbf%7BS%7D_0%28%5Cmathbf%7BX%27X%7D%29%5E%7B-1%7D+%5Cend%7Barray%7D+&quot; alt=&quot;\begin{array}{rll} \mathbf{V}_{\mbox{OLS}}&amp;amp;=&amp;amp;\displaystyle\frac{1}{T}\left(\frac{1}{T}\mathbf{X&#39;X}\right)^{-1}\left(\frac{1}{T}\sum_{i=1}^T e_i^2\mathbf{x}_i\mathbf{x}_i&#39;\right)\left(\frac{1}{T}\mathbf{X&#39;X}\right)^{-1}\\\\ &amp;amp;=&amp;amp;T(\mathbf{X&#39;X})^{-1}\mathbf{S}_0(\mathbf{X&#39;X})^{-1} \end{array} &quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;上述估计称为 &lt;b&gt;White heteroscedasticity consistent estimator&lt;/b&gt;。&lt;b&gt;这一结果极其重要。它意味着哪怕我们对异方差的取值或结构一无所知，我们仍然可以根据最小二乘的结果进行适当的推断。&lt;/b&gt;考虑到实际问题中，多因子收益率残差的异方差性质未知，这一性质就显得格外重要。&lt;/p&gt;&lt;p&gt;在实际问题中，除了异方差外，仍需考虑残差的自相关性。为此，一个自然的想法是将上述 &lt;b&gt;Q&lt;/b&gt; 的估计延伸到对角线之外的元素，即：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+%5Cmathbf%7BS%7D%26%3D%26%5Cdisplaystyle%5Cfrac%7B1%7D%7BT%7D%5Csum_%7Bi%3D1%7D%5ET%5Csum_%7Bj%3D1%7D%5ET+e_%7Bij%7D%5Cmathbf%7Bx%7D_i%5Cmathbf%7Bx%7D_j%27+%5Cend%7Barray%7D+&quot; alt=&quot;\begin{array}{rll} \mathbf{S}&amp;amp;=&amp;amp;\displaystyle\frac{1}{T}\sum_{i=1}^T\sum_{j=1}^T e_{ij}\mathbf{x}_i\mathbf{x}_j&#39; \end{array} &quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;&lt;b&gt;然而，这种方法有两个问题，因此并不正确：&lt;/b&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;首先，该表达式中一共有 T^2 项求和，而它的 scaling factor 仅仅是 1/T，因此 &lt;b&gt;S&lt;/b&gt; 可能完全不收敛；&lt;/li&gt;&lt;li&gt;即便 &lt;b&gt;S&lt;/b&gt; 收敛，它也很可能不是正定的，从而使得最后估计的 &lt;b&gt;b&lt;/b&gt; 的协方差矩阵不是正定的，这显然有违常理。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;怎么办呢？大名鼎鼎的 Newey and West estimator 闪亮登场（Newey and West 1987）！他们给出了当残差同时存在异方差和自相关时，&lt;b&gt;Q&lt;/b&gt; 的相合估计，记为 &lt;b&gt;S&lt;/b&gt;：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brrll%7D+%26%5Cmathbf%7BS%7D%26%3D%26%5Cdisplaystyle%5Cfrac%7B1%7D%7BT%7D%5Cleft%5C%7B%5Csum_%7Bt%3D1%7D%5ET+e_%7Bt%7D%5E2%5Cmathbf%7Bx%7D_t%5Cmathbf%7Bx%7D_t%27%2B%5Csum_%7Bl%3D1%7D%5EL%5Csum_%7Bt%3Dl%2B1%7D%5ET+w_le_%7Bt%7De_%7Bt-l%7D%28%5Cmathbf%7Bx%7D_t%5Cmathbf%7Bx%7D_%7Bt-l%7D%27%2B%5Cmathbf%7Bx%7D_%7Bt-l%7D%5Cmathbf%7Bx%7D_%7Bt%7D%27%29%5Cright%5C%7D%5C%5C+%5Cmbox%7Bwhere%7D%26w_l%26%3D%26%5Cdisplaystyle+1-%5Cfrac%7Bl%7D%7B1%2BL%7D+%5Cend%7Barray%7D+&quot; alt=&quot;\begin{array}{rrll} &amp;amp;\mathbf{S}&amp;amp;=&amp;amp;\displaystyle\frac{1}{T}\left\{\sum_{t=1}^T e_{t}^2\mathbf{x}_t\mathbf{x}_t&#39;+\sum_{l=1}^L\sum_{t=l+1}^T w_le_{t}e_{t-l}(\mathbf{x}_t\mathbf{x}_{t-l}&#39;+\mathbf{x}_{t-l}\mathbf{x}_{t}&#39;)\right\}\\ \mbox{where}&amp;amp;w_l&amp;amp;=&amp;amp;\displaystyle 1-\frac{l}{1+L} \end{array} &quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;&lt;b&gt;这就是计量经济学中无处不在的 Newey-West 调整。&lt;/b&gt;上式中，大括号中的第一项对应仅有异方差情况下的 &lt;b&gt;S&lt;/b&gt;_0，而后面第二项则是针对自相关性的修正。其中 L 是计算自相关性影响的最大滞后阶数（Newey and West 1994 给出了自动计算 L 取值的自适应算法），w_l 是滞后期 l 的系数，其隐含的意思是自相关性的影响随着滞后期 l 的增大而减小。在实际计算时，考虑到自由度的问题，为了得到无偏估计可以将上式中大括号外面的 1/T 换成 1/(T - K)；大括号内部的求和项仍是 T 项及 L × T 项。&lt;/p&gt;&lt;p&gt;将 &lt;b&gt;S&lt;/b&gt; 代入到 &lt;b&gt;V&lt;/b&gt;_OLS 的表达式中，得到 &lt;b&gt;Newey–West autocorrelation consistent covariance estimator&lt;/b&gt;：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+%5Cmathbf%7BV%7D_%7B%5Cmbox%7BOLS%7D%7D%26%3D%26%5Cdisplaystyle+T%28%5Cmathbf%7BX%27X%7D%29%5E%7B-1%7D%5Cmathbf%7BS%7D%28%5Cmathbf%7BX%27X%7D%29%5E%7B-1%7D+%5Cend%7Barray%7D+&quot; alt=&quot;\begin{array}{rll} \mathbf{V}_{\mbox{OLS}}&amp;amp;=&amp;amp;\displaystyle T(\mathbf{X&#39;X})^{-1}\mathbf{S}(\mathbf{X&#39;X})^{-1} \end{array} &quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;&lt;b&gt;在时序&lt;/b&gt; &lt;b&gt;OLS 回归中，Newey-West 调整同时作用于多个&lt;/b&gt; &lt;b&gt;regressors 的回归系数&lt;/b&gt;，从而求出 &lt;b&gt;b&lt;/b&gt; 的协方差矩阵，常见于因子分析中的 portfolio test 中，具体方法为：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;使用目标因子投资组合的收益率序列和（多个）已有因子收益率在时序上 OLS 回归（同时带截距项，代表超额收益部分；假设已有因子 + 截距项一共 K 个 regressors），得到残差；&lt;/li&gt;&lt;li&gt;使用截距项和已有因子收益率序列（回归中的 &lt;b&gt;X&lt;/b&gt;）和残差 &lt;b&gt;e&lt;/b&gt;，通过 Newey-West 调整求出 &lt;b&gt;V&lt;/b&gt;_OLS；&lt;/li&gt;&lt;li&gt;将 &lt;b&gt;V&lt;/b&gt;_OLS 的对角线元素开平方，其平方根就是参数 &lt;b&gt;b&lt;/b&gt; 的标准误（一共 K 个，对应 K 个 regressors）；&lt;/li&gt;&lt;li&gt;使用 &lt;b&gt;b&lt;/b&gt; 的估计和 Newey-West 调整后的标准误计算出这些参数的 t-statistics，从而判断它们的显著性。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;下面来看一个例子。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;4 一个例子&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/53944793&quot; class=&quot;internal&quot;&gt;《寻找股票市场中的预期差》&lt;/a&gt;一文基于基本面和市场预期之差进行了选股。对于使用“预期差”因子构建的投资组合，该文应用一些已有因子进行了 portfolio test。假设已有因子包括 Fama and French (1993) 三因子以及 Carhart (1997) 的动量因子。这四个因子的累积收益率如下图所示。下面用这个 portfolio test 说明 Newey-West 调整。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-0ab23dbf46373fa7da0d1bb9bcbb644a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;847&quot; data-rawheight=&quot;429&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;847&quot; data-original=&quot;https://pic3.zhimg.com/v2-0ab23dbf46373fa7da0d1bb9bcbb644a_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-0ab23dbf46373fa7da0d1bb9bcbb644a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;847&quot; data-rawheight=&quot;429&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;847&quot; data-original=&quot;https://pic3.zhimg.com/v2-0ab23dbf46373fa7da0d1bb9bcbb644a_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-0ab23dbf46373fa7da0d1bb9bcbb644a_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;以上述四个因子以及一个截距项作为 regressors，对“预期差”因子的投资组合在时序上进行 OLS 回归，得到残差 &lt;b&gt;e&lt;/b&gt;。加入截距项后，&lt;b&gt;X&lt;/b&gt; 矩阵一共有 5 列 —— 第一列全是 1，对应截距；后面四列对应 4 个已有因子的收益率时间序列。使用 &lt;b&gt;X&lt;/b&gt; 和 &lt;b&gt;e&lt;/b&gt; 对进行 Newey-West 调整，计算回归系数的标准误。在计算中，使用Newey and West (1994) 自动计算滞后阶数 L：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+L%3D4%5Ctimes%5Cleft%28%5Cfrac%7BT%7D%7B100%7D%5Cright%29%5E%7B2%2F9%7D&quot; alt=&quot;\displaystyle L=4\times\left(\frac{T}{100}\right)^{2/9}&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;由于实证中一共使用了 108 期月频收益率数据，因此 T = 108；由上式计算出的 L = 4。下表给出了使用经典 OLS 和使用 Newey-West 调整后得到的回归系数 standard errors 以及 t-statistics。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-0dabeed934a19260dae6056ed7e52356_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;778&quot; data-rawheight=&quot;285&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;778&quot; data-original=&quot;https://pic3.zhimg.com/v2-0dabeed934a19260dae6056ed7e52356_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-0dabeed934a19260dae6056ed7e52356_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;778&quot; data-rawheight=&quot;285&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;778&quot; data-original=&quot;https://pic3.zhimg.com/v2-0dabeed934a19260dae6056ed7e52356_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-0dabeed934a19260dae6056ed7e52356_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;使用 Newey-West 调整后，“预期差”选股的超额收益（α）的 t-statistic 从 3.325 上升至 4.371；HML 以及 MOM 因子的系数 β_HML 和 β_MOM 的 t-statistics 分别从 20.171 和 3.420 降低到 10.778 和 2.233。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;5 简化版 Newey-West 调整&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;上一节说明了在进行时序回归的 portfolio test 中如何进行 Newey-West 调整。那么，使用截面回归的 regression test 又如何呢？&lt;/p&gt;&lt;p&gt;在因子分析中，Fama-MacBeth regression 是最常见的截面回归方法（Fama and MacBeth 1973）。在该回归中，每一期使用当期因子暴露和个股下一期的收益率进行截面回归，得到因子的收益率；在全部期进行截面回归后，便可得到每个因子收益率的时间序列。&lt;b&gt;将因子收益率在时序上取均值就得到每个因子的预期收益率，而我们关心的是该因子预期收益率是否显著不为零。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;对于任何因子，其收益率序列在时序上很可能存在异方差和自相关性，因此在计算其均值标准误的时候需要进行 Newey-West 调整。&lt;/b&gt;然而，这和上面的多因子时序回归很不相同。如何进行 Newey-West 调整呢？&lt;/p&gt;&lt;p&gt;关于这个问题，Turan Bali、Robert Engle、Scott Murray 三位所著的经典教材 Empirical Asset Pricing, the cross section of stock returns（Bali et al. 2016）给出了答案。&lt;b&gt;对于单个因子的收益率序列，将其用 1 作为 regressor 回归得到残差 —— 这相当于用因子收益率减去它在时序上的均值。&lt;/b&gt;然后把这个残差和 &lt;b&gt;X&lt;/b&gt; = &lt;b&gt;1&lt;/b&gt; 代入到 Newey-West 调整中即可。&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-e168a54f661914c8884f8ce277e0b428_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;727&quot; data-rawheight=&quot;411&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;727&quot; data-original=&quot;https://pic1.zhimg.com/v2-e168a54f661914c8884f8ce277e0b428_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-e168a54f661914c8884f8ce277e0b428_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;727&quot; data-rawheight=&quot;411&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;727&quot; data-original=&quot;https://pic1.zhimg.com/v2-e168a54f661914c8884f8ce277e0b428_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-e168a54f661914c8884f8ce277e0b428_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;在这个简化版的 Newey-West 调整中，&lt;b&gt;Q&lt;/b&gt; 的估计 &lt;b&gt;S&lt;/b&gt; 简化为：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brrll%7D+%26%5Cmathbf%7BS%7D%26%3D%26%5Cdisplaystyle%5Cfrac%7B1%7D%7BT%7D%5Cleft%5C%7B%5Csum_%7Bt%3D1%7D%5ET+e_%7Bt%7D%5E2%2B2%5Csum_%7Bl%3D1%7D%5EL%5Csum_%7Bt%3Dl%2B1%7D%5ET+w_le_%7Bt%7De_%7Bt-l%7D%5Cright%5C%7D%5C%5C+%5Cmbox%7Bwhere%7D%26e_t%26%3D%26f_t+-+%5Cmbox%7BE%7D_t%5Bf_t%5D%5C%5C+%26w_l%26%3D%26%5Cdisplaystyle+1-%5Cfrac%7Bl%7D%7B1%2BL%7D+%5Cend%7Barray%7D&quot; alt=&quot;\begin{array}{rrll} &amp;amp;\mathbf{S}&amp;amp;=&amp;amp;\displaystyle\frac{1}{T}\left\{\sum_{t=1}^T e_{t}^2+2\sum_{l=1}^L\sum_{t=l+1}^T w_le_{t}e_{t-l}\right\}\\ \mbox{where}&amp;amp;e_t&amp;amp;=&amp;amp;f_t - \mbox{E}_t[f_t]\\ &amp;amp;w_l&amp;amp;=&amp;amp;\displaystyle 1-\frac{l}{1+L} \end{array}&quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;其中 f_t 代表被检验因子的收益率时间序列，E_t[f_t] 是它在时序上的均值。由于我们仅仅有一个 regressor，因此上述 &lt;b&gt;S&lt;/b&gt; 其实是一个标量。将它代入到 &lt;b&gt;V&lt;/b&gt;_OLS 的表达式中，在对其开方，就得到 E_t[f_t] 的标准误：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+%5Cmbox%7Bs.e.%7D%28%5Cmbox%7BE%7D_t%5Bf_t%5D%29%26%3D%26%5Cdisplaystyle+%5Csqrt%7B%5Cmathbf%7BS%7D%2FT%7D+%5Cend%7Barray%7D+&quot; alt=&quot;\begin{array}{rll} \mbox{s.e.}(\mbox{E}_t[f_t])&amp;amp;=&amp;amp;\displaystyle \sqrt{\mathbf{S}/T} \end{array} &quot; eeimg=&quot;1&quot;&gt; &lt;/p&gt;&lt;p&gt;对每个因子依次使用上述修正，获得其各自收益率均值的 standard error，然后就可以计算 t-statistic 以及 p-value 并检验它们的显著性。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;6 结语&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;本文介绍了计量经济学中常见的 Newey-West 估计（顺便提一句， White 1980 估计也十分流行），它们在因子回归分析中无处不在。在 portfolio test 中，通过时序回归，并应用 Newey-West 调整对多个 regressors 的回归系数的标准误同时修正；在 regression test 中，首先通过 T 期截面回归得到因子的收益率时序，然后再对该时序进行 Newey-West 调整从而得到因子预期收益率的标准误。&lt;/p&gt;&lt;p&gt;在 Barra 的因子模型中，采用 Newey-West 调整对日频因子收益率的协方差矩阵进行了修正（Briner et al. 2009, pp 25）：&lt;/p&gt;&lt;figure&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-4f66cb15d55bbb775f7e9edf3b7c8049_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1102&quot; data-rawheight=&quot;289&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1102&quot; data-original=&quot;https://pic2.zhimg.com/v2-4f66cb15d55bbb775f7e9edf3b7c8049_r.jpg&quot;&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-4f66cb15d55bbb775f7e9edf3b7c8049_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1102&quot; data-rawheight=&quot;289&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1102&quot; data-original=&quot;https://pic2.zhimg.com/v2-4f66cb15d55bbb775f7e9edf3b7c8049_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-4f66cb15d55bbb775f7e9edf3b7c8049_b.jpg&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;有必要指出的是，Barra 修正的是因子收益率的协方差矩阵，而不是因子收益率均值或者任何回归系数 β&lt;/b&gt; &lt;b&gt;的协方差矩阵。&lt;/b&gt;仔细检查上面的式子，并没有看到任何 regressor 矩阵 &lt;b&gt;X&lt;/b&gt; 或者残差向量 &lt;b&gt;e&lt;/b&gt; 的身影；以上 Barra 的用法和本文讨论的 portfolio test 和 regression test 中的 Newey-West 调整都不太一样。我对其的理解是（欢迎批评、指正），Barra 借鉴了 Newey-West 在处理 middle matrix &lt;b&gt;Q &lt;/b&gt;时引入滞后期处理自相关性的方法，将它的日频自相关矩阵 C 对标为 Newey and West (1987) 中的  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+%CE%A9_0&quot; alt=&quot;\hat Ω_0&quot; eeimg=&quot;1&quot;&gt; ，从而应用了 Newey and West (1987) 中的式 (5)。&lt;/p&gt;&lt;p&gt;最后，非常感谢你认真看到这里。这不是一篇 fancy 的文章，而是一篇工具文，希望它能对你有些帮助。在我自己进行 empirical asset pricing 研究时，在 portfolio test 和 regression test 时也会用到 Newey-West 调整。相信你看完本文，在今后再看到我提及它的时候，知道我干了什么。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;参考文献&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Bali, T. G., R. F. Engle, and S. Murray (2016). &lt;i&gt;Empirical asset pricing, the cross section of stock returns.&lt;/i&gt; John Wiley &amp;amp; Sons, Inc., Hoboken, New Jersey.&lt;/li&gt;&lt;li&gt;Briner, B. G., R. C. Smith, and P. Ward (2009). &lt;i&gt;The Barra Europe equity model (EUE3)&lt;/i&gt;. Research Notes.&lt;/li&gt;&lt;li&gt;Carhart, M. M. (1997). On Persistence in Mutual Fund Performance. &lt;i&gt;Journal of Finance&lt;/i&gt;, Vol. 52(1), 57 – 82.&lt;/li&gt;&lt;li&gt;Fama, E. F. and K. R. French (1993). Common risk factors in the returns on stocks and bonds. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 33(1), 3 – 56.&lt;/li&gt;&lt;li&gt;Fama, E. F. and J. D. MacBeth (1973). Risk, return, and equilibrium: empirical tests. &lt;i&gt;Journal of Political Economy&lt;/i&gt;, Vol. 81(3), 607 – 636.&lt;/li&gt;&lt;li&gt;Greene, W. H. (2003). &lt;i&gt;Econometric Analysis (5th ed)&lt;/i&gt;. Prentice Hall, Upper Saddle River, New Jersey.&lt;/li&gt;&lt;li&gt;Newey, W. K. and K. D. West (1987). A simple, positive semi-definite, heteroskedasticity and autocorrelation consistent covariance matrix. &lt;i&gt;Econometrica&lt;/i&gt;, Vol. 55(3), 703 – 708.&lt;/li&gt;&lt;li&gt;Newey, W. K. and K. D. West (1994). Automatic lag selection in covariance matrix estimation. &lt;i&gt;Review of Economic Studies&lt;/i&gt;, Vol. 61(4), 631 – 653.&lt;/li&gt;&lt;li&gt;White, H. (1980). A heteroskedasticity-consistent covariance matrix estimator and a direct test for heteroskedasticity. &lt;i&gt;Econometrica&lt;/i&gt;, Vol. 48(4), 817 – 838.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处，谢谢。已委托“维权骑士”(&lt;a href=&quot;http://link.zhihu.com/?target=http%3A//rightknights.com/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;维权骑士_免费版权监测/版权保护/版权分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2019-01-16-54913149</guid>
<pubDate>Wed, 16 Jan 2019 00:00:00 +0800</pubDate>
</item>
</channel>
</rss>
