<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>卡特兰数（Catalan number）（三）</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/31585260">原文</a></p>
<div class="title-image"><img src="https://pic3.zhimg.com/v2-d0418c42d149ea3cdf4e353ee0131855_r.jpg" alt=""></div><p><b>这次的都是有些复杂的模型。</b></p><hr><p>➤ 垒硬币</p><p>最下面一行有 <equation>n</equation> 个硬币。</p><p>例如 <equation>n=3</equation> 时，有如下5种垒硬币方法：</p><img src="https://pic2.zhimg.com/v2-b31a26d18ac155dd916cb9c16e1cbbc2_r.jpg" data-caption="" data-size="normal" data-rawwidth="1850" data-rawheight="327"><p>事实上将“画群峰”所得山峰们的小三角形相间染色，深色小三角形“画”一个圆，全体就构成了“垒硬币”方法。</p><p>例如：</p><img src="https://pic2.zhimg.com/v2-f373a616eb03db3d95a17976bbc1d9d7_r.jpg" data-caption="" data-size="normal" data-rawwidth="254" data-rawheight="226"><hr><p>➤ 不相交的划分</p><p>设 <equation>S=\{1,2,3,\cdots,n\}</equation> ， <equation>S</equation> 的子集的集合 <equation>\{A_1,A_2,\cdots,A_m\}</equation> 称作 <equation>S</equation> 的一个不相交划分，如果：</p><ol><li>对于任意 <equation>1\leq i\leq m</equation> ， <equation>A_i</equation> 非空；</li><li>对于任意 <equation>1\leq x\leq n</equation> ，存在 <equation>1\leq i\leq m</equation> 使得 <equation>x\in A_i</equation> ；</li><li>对于任意 <equation>1\leq i\ne j\leq m</equation> ， <equation>A_i\cap A_j=\emptyset</equation> ；</li><li>对于任意 <equation>1\leq i\ne j\leq m</equation> ，不存在 <equation>1\leq a&lt;b&lt;c&lt;d \leq n</equation> 满足 <equation>\{a,c\}\subseteq A_i</equation> 、 <equation>\{b,d\}\subseteq A_j</equation> 。</li></ol><p>例如 <equation>\{\{1\},\{2\},\{3,5\},\{4,6\}\}</equation> 、 <equation>\{\{1,4\},\{2,6\},\{3,5\}\}</equation> 都不是 <equation>\{1,2,3,4,5,6\}</equation> 的不相交划分。</p><p>当 <equation>n=3</equation> 时，有如下5种不同的不相交划分：</p><p><equation>\{\{1\},\{2\},\{3\}\}</equation> 、 <equation>\{\{1\},\{2,3\}\}</equation> 、 <equation>\{\{1,2\},\{3\}\}</equation> 、 <equation>\{\{1,2,3\}\}</equation> 、 <equation>\{\{1,3\},\{2\}\}</equation> 。</p><img src="https://pic1.zhimg.com/v2-d86b678ffbccd45e51a89bfc8fa2b903_r.jpg" data-caption="" data-size="normal" data-rawwidth="1078" data-rawheight="62"><p>而当 <equation>n=4</equation> 时，有如下14种不同的不相交划分：</p><p><equation>\{\{1\},\{2\},\{3\},\{4\}\}</equation> 、 <equation>\{\{1\},\{2\},\{3,4\}\}</equation> 、 <equation>\{\{1\},\{2,3\},\{4\}\}</equation> 、 <equation>\{\{1\},\{2,3,4\}\}</equation> 、 <equation>\{\{1\},\{2,4\},\{3\}\}</equation> ；<equation>\{\{1,2\},\{3\},\{4\}\}</equation> 、 <equation>\{\{1,2\},\{3,4\}\}</equation> 、 <equation>\{\{1,2,3\},\{4\}\}</equation> 、 <equation>\{\{1,2,3,4\}\}</equation> 、 <equation>\{\{1,2,4\},\{3\}\}</equation> ； <equation>\{\{1,3\},\{2\},\{4\}\}</equation> 、 <equation>\{\{1,3\},\{2,4\}\}</equation> ； <equation>\{\{1,4\},\{2,3\}\}</equation> 、 <equation>\{\{1,4\},\{2\},\{3\}\}</equation> 。</p><img src="https://pic4.zhimg.com/v2-6fdf75763603da1f235f03eb580ca872_r.jpg" data-caption="" data-size="normal" data-rawwidth="1360" data-rawheight="243"><p><b>分析：</b>记 <equation>S=\{1,2,3,\cdots,n\}</equation> 的一个不相交划分数为 <equation>C_n</equation> 。考虑“ <equation>1</equation> ”所在的划分块，有以下两种情况——</p><ol><li>该划分块为 <equation>\{1\}</equation> ，于是剩下的问题就是 <equation>\{2,3,\cdots,n\}</equation>  的不相交划分 ；</li><li>该划分块中有多于1个元素，假设其中除 <equation>1</equation> 之外最小的值为 <equation>m</equation> ，则问题划分为 <equation>\{2,3,\cdots,m-1\}</equation>  的不相交划分和 <equation>\{m,\cdots,n\}</equation>  的不相交划分数。</li></ol><img src="https://pic1.zhimg.com/v2-6a3bc082fe78833c5bf906a1c502ebc0_r.jpg" data-caption="" data-size="normal" data-rawwidth="422" data-rawheight="250"><p>因此得到 <equation>C_0=1</equation> ， <equation>C_1=1</equation> ，</p><p><equation>\begin{eqnarray*} C_n &amp; = &amp; C_{n-1}+\\ &amp; &amp; C_0C_{n-1}+C_1C_{n-2}+\cdots+C_{n-2}C_1\\ &amp; = &amp; C_0C_{n-1}+C_1C_{n-2}+\cdots+C_{n-2}C_1+C_{n-1}C_0 \end{eqnarray*}</equation> </p><hr><p>➤ 有序根树</p><p>有 <equation>n+1</equation> 个节点的有序根树。</p><p>当 <equation>n=2</equation> 时，有如下2种不同的有序根树：</p><img src="https://pic4.zhimg.com/v2-6ad357b1a3dd4fcad37b933d98f443e3_r.jpg" data-caption="" data-size="normal" data-rawwidth="190" data-rawheight="129"><p>当 <equation>n=3</equation> 时，有如下5种不同的有序根树：</p><img src="https://pic2.zhimg.com/v2-e9ccda96fea3c964120a3de63ee1ba08_r.jpg" data-caption="" data-size="normal" data-rawwidth="571" data-rawheight="184"><p><b>分析：</b>去掉“根”后，将得到的有序森林使用“左-首个孩子；右-下一个兄弟”的方式转换为位置二叉树（Doubly-Chained Tree），则得到本问题和“有 <equation>n</equation> 个内点的位置二叉树”问题的对应。</p><img src="https://pic1.zhimg.com/v2-5375870857d42f220412e7f5ca31eea6_r.jpg" data-caption="" data-size="normal" data-rawwidth="602" data-rawheight="589"><hr><p>➤ 不出现“321”模式的全排列</p><p>如果 <equation>p=p_1p_2\cdots p_n</equation> 是 <equation>1\sim n</equation> 的一个全排列/置换，如果不存在 <equation>i&lt;j&lt;k</equation> 使得 <equation>p_i&gt;p_j&gt;p_k</equation> 则称 <equation>p</equation> 是一个不出现“321”模式的全排列——也即 <equation>p</equation> 中不存在长为3的递减子序列（各项不必连续）。</p><p>当 <equation>n=3</equation> 时，有5种这样的全排列：</p><img src="https://pic1.zhimg.com/v2-4ad6d00e3c7f307dd27d30dac4cbb8ca_r.jpg" data-caption="" data-size="normal" data-rawwidth="120" data-rawheight="239"><p>当 <equation>n=4</equation> 时，有14种这样的全排列：</p><img src="https://pic1.zhimg.com/v2-f16865c30111a62a2645e89009076af4_r.jpg" data-caption="" data-size="normal" data-rawwidth="656" data-rawheight="240"><p>下面介绍由Rotem提出的将一个不出现“321”模式的全排列映射到不穿越对角线的格路问题的方法。</p><p>定义一种特殊的序列 <equation>b_1,b_2, . . . ,b_n</equation> 满足</p><ol><li><equation>b_1 \leq b_2 \leq\cdots \leq b_n</equation> ；</li><li><equation> 0 \leq b_i \leq i − 1</equation> ， <equation>i = 1, 2, . . . , n</equation> 。</li></ol><p>之后将这样的序列和格路形成的各列高度之间建立一一对应，例如：</p><img src="https://pic3.zhimg.com/v2-b3bb3d6e8374eb89b15303c71d97e29f_r.jpg" data-caption="" data-size="normal" data-rawwidth="684" data-rawheight="230"><p>假设 <equation>p_1p_2 . . . p_n</equation> 是一个不出现“321”模式的全排列，令</p><ul><li><equation>b_1=0</equation> ，</li><li>对于 <equation>i = 2, . . . , n</equation> ，若 <equation>p_i </equation> 比它左边所有的数值都大则 <equation>b_i = b_{i−1}</equation> ，否则 <equation>b_i = p_i</equation> 。 </li></ul><p>例如：</p><img src="https://pic2.zhimg.com/v2-fad1031dd2ea2f46fed99382d7eff81a_r.jpg" data-caption="" data-size="normal" data-rawwidth="1058" data-rawheight="202"><p>例如 <equation>n=3</equation> 时——</p><img src="https://pic4.zhimg.com/v2-af751a79adcddb2922f78cdb1a475079_r.jpg" data-caption="" data-size="normal" data-rawwidth="456" data-rawheight="246"><p><equation>n=4</equation> 时——</p><img src="https://pic1.zhimg.com/v2-7b2c82cf568c75f7cba01bafa2c24f95_r.jpg" data-caption="" data-size="normal" data-rawwidth="786" data-rawheight="467"><p>逆映射的方法是：</p><p>对于一个这样的序列，例如</p><img src="https://pic4.zhimg.com/v2-f8a80973c56c6b0421c19deb5b1de621_r.jpg" data-caption="" data-size="normal" data-rawwidth="348" data-rawheight="89"><p>保留非零值从左至右的首次出现，</p><img src="https://pic2.zhimg.com/v2-987f8b5695cf0273aa8e1b8837e3cd4a_r.jpg" data-caption="" data-size="normal" data-rawwidth="348" data-rawheight="89"><p>之后从左至右在各个其他格中按升序填入其他值。</p><img src="https://pic4.zhimg.com/v2-58cca97ade6212c3b758ae94deaf609b_r.jpg" data-caption="" data-size="normal" data-rawwidth="348" data-rawheight="88"><p>➤ 特殊的 <equation>n</equation> 阶严格上三角矩阵</p><p><equation>n</equation> 阶方阵 <equation>\mathbf{M}</equation> 满足：</p><ul><li>对所有 <equation>1\leq i \leq n</equation> ，有 <equation>\mathbf{M}_{ii}=0</equation> ；</li><li>对所有 <equation>1\leq i \leq n</equation> ， <equation>1\leq j_1&lt;j_2 \leq n</equation> ，有 <equation>\mathbf{M}_{ij_1} \leq \mathbf{M}_{ij_2}</equation> ；</li><li>对所有 <equation>1\leq i_1&lt;i_2 \leq n</equation> ， <equation>1\leq j \leq n</equation> ，有 <equation>\mathbf{M}_{i_1j} \geq \mathbf{M}_{i_2j}</equation> ；</li></ul><p>例如 <equation>n=3</equation> 时，有如下5种特殊的严格上三角矩阵（一一对应格路模型）：</p><img src="https://pic3.zhimg.com/v2-2d3f0a229021c9e13203798ad6925fc7_r.jpg" data-caption="" data-size="normal" data-rawwidth="801" data-rawheight="128"><p>事实上，每一个这样的严格上三角矩阵一一对应一个无标号元素形成的半序（semiorder）集。</p><p>例如下图（使用Hasse图表示）：</p><img src="https://pic1.zhimg.com/v2-37a3958473d313fcb61c7c2f92b510c8_r.jpg" data-caption="" data-size="normal" data-rawwidth="581" data-rawheight="280"><hr><p>➤ 堆垒骨牌</p><p>感谢 <a class="member_mention" href="http://www.zhihu.com/people/2c0f78ec4736f2b1a245120b3f611559" data-hash="2c0f78ec4736f2b1a245120b3f611559" data-hovercard="p$b$2c0f78ec4736f2b1a245120b3f611559">@李令昆</a> 帮我编写程序！</p><p>一些高度为 <equation>1</equation> 宽度为整数的骨牌堆在一起，要求：</p><ol><li>总宽度为 <equation>n+1</equation> ；</li><li>下面的骨牌的左端严格“右于”上面石条的左端；</li><li>上面的骨牌的右端严格“左于”下面石条的右端。</li></ol><p>例如 <equation>n=3</equation> 时，有如下5种堆垒骨牌方式：</p><img src="https://pic2.zhimg.com/v2-7cb70d9d8bf04a8789c6f7c27456a0b3_r.jpg" data-caption="" data-size="normal" data-rawwidth="910" data-rawheight="117"><p><equation>n=4</equation> 时，有如下14种堆垒骨牌方式：</p><img src="https://pic1.zhimg.com/v2-fb5a114e15cecc3667c6e60144b209af_r.jpg" data-caption="" data-size="normal" data-rawwidth="1100" data-rawheight="429"><p><b>分析：</b>自上而下将每一个骨牌用 <equation>(begin_i,end_i)</equation> 表示，例如下图所示。</p><img src="https://pic1.zhimg.com/v2-dc46ebcc9cdf127013116f06ec16cc99_r.jpg" data-caption="" data-size="normal" data-rawwidth="568" data-rawheight="259"><p>自上而下定义 <equation>value_i</equation> 和 <equation>count_i</equation> ：</p><ul><li><equation>value_i=begin_i</equation> ；</li><li><equation>count_0=end_0-begin_0</equation> ；</li><li><equation>count_{i+1}=end_{i+1}-end_i</equation> ， <equation>i=1,2,3,...</equation> 。</li></ul><p>例如：</p><img src="https://pic1.zhimg.com/v2-ed9522472262b70504c0df663981a6c5_r.jpg" data-caption="" data-size="normal" data-rawwidth="674" data-rawheight="259"><p><br></p><p>之后依次写 <equation>count_i</equation> 个 <equation>value_i</equation> ，就得到了“不出现321模式的全排列”部分中定义的序列。</p><p>例如：</p><img src="https://pic4.zhimg.com/v2-81bb50728ff5682c5dddf4a875af198b_r.jpg" data-caption="" data-size="normal" data-rawwidth="971" data-rawheight="259"><p></p>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
