<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Rust Quiz 解读：Quiz 4</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/51560682">原文</a></p>
<div class="title-image"><img src="https://pic4.zhimg.com/v2-27785f4d62d62024a054a78b168015d1_r.jpg" alt=""></div><blockquote>来自于RustFest 2018 大会上Alex Crichton 和 David Tolnay两位大佬的轻演讲主题：Rust Quiz<br>- <a href="https://github.com/dtolnay/rust-quiz">rust-quiz源码</a><br>-  <a href="https://dtolnay.github.io/rust-quiz/18">在线练习和解答</a><br>-  <a href="https://www.youtube.com/watch?v=QtDj9R6vtA8&amp;index=6&amp;list=PLgC1L0fKd7UlpVTHVfLYVtudVx8CzbSxW&amp;t=0s">视频</a><br>不得不说，两位大佬出的题非常具有迷惑性，一不留神就落入了陷阱。</blockquote><h2><b>Quiz 4:</b></h2><p>下面这段代码输出什么？</p><code lang="rust">fn main() {
    let (.., x, y) = (0, 1, ..);
    print!("{}", b"066"[y][x]);
}</code><p><b>输出结果： 54</b></p><h2><b>解读：</b></h2><p><b>考察要点： </b></p><ol><li>模式匹配</li><li>Range和RangeFull</li><li>字节字符串表示法</li></ol><p>上面只有两行代码，但是隐藏了很多信息。</p><p>Rust中let绑定语句支持模式匹配。main函数中代码第一行是元组的匹配赋值操作。在等号左边的<code class="inline">(.., x, y)</code>是匹配的模式，等号右边<code class="inline">(0, 1, ..)</code>是要匹配的值。</p><p>这里最迷惑人的地方就是<code class="inline">..</code>，在匹配模式中，<code class="inline">..</code>代表其余要匹配的项。在上面示例中，就是除了x和y之外，要匹配的项。而在等号右边等待匹配的值中，<code class="inline">..</code>则代表一个值：RangeFull。RangeFull是一个单元结构体，它代表Range（范围）的全范围类型。</p><p>所以，下面代码是合法的：</p><code lang="rust">let range_full = std::ops::RangeFull;
let range_full = ..;</code><p>这两行代码是等价的。</p><p>所以，上面最终的元组匹配结果是：</p><ol><li>左边<code class="inline">..</code>匹配右边的<code class="inline">0</code></li><li>左边<code class="inline">x</code>匹配右边的<code class="inline">1</code></li><li>左边<code class="inline">y</code>匹配右边的<code class="inline">..</code></li></ol><p>然后在最后的<code class="inline">print!</code>语句中，<code class="inline">b"0666"</code>实际上是一种字节字符串的语法糖，它等价于<code class="inline">[48u8, 54u8, 54u8]</code>字节序列：</p><code lang="rust">let d = [48u8, 54u8, 54u8];
 assert_eq!("066", std::str::from_utf8(&amp;d).unwrap());</code><p>所以，<code class="inline">b"066"[y][x]</code>现在是<code class="inline">b"066"[..][1] == b"6"</code>，那么最终输出结果就是： 54。</p><p><br></p><p><a href="https://dtolnay.github.io/rust-quiz/4">点此查看 Rust Quiz 4</a> </p><p></p>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
