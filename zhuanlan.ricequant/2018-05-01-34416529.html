<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>量化投资从回测到实盘的鸿沟——从海森堡不确定原理谈起</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/34416529">原文</a></p>
<div class="title-image"><img src="https://pic3.zhimg.com/v2-cdf090dd23cc189522bcce193283f2cf_r.jpg" alt=""></div><h2>1. 前言</h2><p>量化投资需要回测。</p><p>然而回测只是第一步。考验买方Quant的最终标准仍然是盈利，而且是稳定和成规模的盈利。</p><p>从事量化投资的朋友经常会发现，在回测中非常好的策略，在实盘中表现不一定好。回测易，而实盘难。从回测到实盘还存在大量的问题，值得研究和思考。</p><p>很多原因可以造成回测和实盘的差距。第一个常见的原因是对交易成本考虑不够。这不是大问题。我们可以通过调整回测参数来修改回测结果，最后重新评价策略。第二个常见的原因是过度优化，知乎中有大量讨论过度优化的回答和文章，例如以下两篇：</p><a href="https://zhuanlan.zhihu.com/p/30940020" data-draft-node="block" data-draft-type="link-card" data-image="v2-7206af4541aa7d1359a6b0747c4c4155" data-image-width="700" data-image-height="788" data-image-size="ipico">Vincent Leiberich：量化投资的哲学基础4：科学哲学家告诉你怎样避免过度优化</a><a href="https://www.zhihu.com/question/25573027/answer/289040447" data-draft-node="block" data-draft-type="link-card">如何在策略回测中避免过度拟合 (overfitting) 以及保证测试参数的稳健性 (robust)？</a><p>还有一个原因是更加深刻和难以解决的。量化投资假设历史会重演。然而，事实上，投资行为会改变金融市场，会不可逆地改变金融市场，会使策略更难以稳定盈利，使得历史不会重演。</p><p>要说明上面的观点，我们需要从物理中借鉴概念来说明。</p><h2>2. 观察者效应</h2><p>在以牛顿三大定律为代表的经典物理的框架下，理论并不会随着观察者不同而不同。</p><p>然而在具体观测操作中，会存在观察者效应。物理学中的观察者效应是指，对一个现象的观察就会改变这个现象。</p><a href="https://en.wikipedia.org/wiki/Observer_effect_(physics)" data-draft-node="block" data-draft-type="link-card">Observer effect (physics)</a><p>一个简单的例子就是检测汽车轮胎的胎压。要检测胎压，我们就需要释放一点轮胎中的空气出来。然后，释放轮胎中的空气，就改变了轮胎的胎压。因此想准确的测量轮胎的胎压就是不可能的。</p><p>如果存在观察者效应，观察者和被观察的现象不是相互独立的，而是相互影响的。一旦这种影响存在，准确的观察就变得非常困难。</p><h2>3. 海森堡不确定性原理</h2><p>不确定性原理（Uncertainty principle）是由<a href="https://baike.baidu.com/item/%E6%B5%B7%E6%A3%AE%E5%A0%A1">海森堡</a>于1927年提出：你不可能同时知道一个粒子的位置和它的速度。随着量子物理学的进步，人们进一步加深了对不确定性原理的认识。维基百科的定义更根本和广泛，参见下面链接。</p><a href="https://en.wikipedia.org/wiki/Uncertainty_principle" data-draft-node="block" data-draft-type="link-card" data-image="v2-85d0dd62422d50ea1fff038a2a6c39b8" data-image-width="360" data-image-height="270" data-image-size="180x120">Uncertainty principle</a><p>不确定性原理在提出之初常常和观察者效应是混淆。我们需要用光照到一个粒子上的方式来测量一个粒子的位置和速度。<a href="https://baike.baidu.com/item/%E6%B5%B7%E6%A3%AE%E5%A0%A1">海森堡</a>写道：“在位置被测定的一瞬，即当光子正被电子偏转时，电子的动量发生一个不连续的变化，因此，在确知电子位置的瞬间，关于它的动量我们就只能知道相应于其不连续变化的大小的程度。于是，位置测定得越准确，动量的测定就越不准确，反之亦然。”海森堡在这个例子中借用了观察者效应，指出一个粒子的位置和速度无法准确测量。</p><p>然而，随着量子物理的进步，我们逐渐清晰了解不确定性原理和观察者效应的不同。不确定性原理是“波系统”的根本属性，量子系统就是典型的“波系统”。 不确定原理表述的是量子系统的基本性质，而不是当代技术的观察效果的局限。</p><h2>4. 参与者效应</h2><p>金融市场没有“观察者效应”。仅仅对于金融市场的观察，不会改变市场。</p><p>但是金融市场有“参与者效应”。只要参与市场交易，就会改变市场，就会让市场向着不利于自己策略的方向演进。</p><p>在一个零和博弈的市场，假设只有A和B两个投资人，那么A赚到100元，就意味着B亏损了100元。假设A是一个聪明的投资者，A有一个聪明的投资策略a，每天能从B那里赚走100元。那么有三种可能性，B也很聪明，改变自己的交易行为，使得自己不再亏损。B不聪明，但是发现自己持续亏钱，因此退出市场。或者B真的很笨，一直亏损，直到亏光所有的积蓄和信用，B也将退出市场。A的盈利，要么驱使B变聪明，要么把B驱逐出市场，要么把B消灭。总而言之，A都改变了市场，a策略也不可能持续盈利下去。</p><p>那么，当市场上有许多投资人的时候，B其实就是除了A以外的所有投资人。如果A掌握了一个聪明的策略，就会驱使一部分投资人变聪明，或者驱逐一部分投资离开市场，或者消灭一部分投资人。</p><p>所以，量化投资的领域内没有“圣杯”。牛顿在三百年前发现了“三大定律”，至今“三大定律”还在为人民服务。屠呦呦发现了青蒿素，青蒿素消灭了疟疾，但青蒿素也就没有用了。在量化投资的领域，我们发现了一个策略，策略盈利，策略改变市场，市场更加有效，策略也就失效了。</p><p>不少人可能会这样想：如果A不每天赚走100元，而是只赚走1元，通过细水长流，让B在不知不觉中失血，这样A就能一直赚钱下去。很多人是抱有这样大的想法而走上了职业交易的道路。然而只要进一步思考，我们发现这样的想法是靠不住的。</p><h2>5. 加强版参与者效应和观察者效应</h2><p>仅仅对于金融市场的观察，不会改变市场。仅仅研发了一个量化策略，而不交易，不会改变市场。</p><p>但是，你并不知道有没有其他人在采用同样的量化策略进行交易。在金融市场中，无数人在交易，天外有天，人外有人。一旦你发现了一个策略，你无法保证没有人发现并使用同样的策略交易。即便你不交易，其他人也会交易。</p><p>在一个零和博弈的市场，假设A是一个聪明的投资者，A有一个投资策略a，每天能从B那里赚走100元。但是A并没有交易。然而，市场上来了同样的聪明的C。C同样发现了a策略。你无法阻止C交易a策略。一旦C开始交易，市场就将被改变，Alpha策略就将失效。</p><p>因此，加强版参与者效应和观察者效应就很像了：一旦你观察到一个策略，你几乎敢肯定也有其他的聪明玩家发现并交易了这个策略，系统已经被改变，策略即将失效。</p><h2>6. 囚徒困境和海森堡不确定性原理</h2><p>在加强版的参与者效应下，交易者非常容易陷入囚徒困境。我还是以A和C为例子，A和C都面临着两个选项，扩大规模交易或者不扩大规模交易。</p><ol><li>A和C都不扩大规模交易：这样B每天亏损200元，B在不知不觉中失血，B在100天后退出市场，A和C各自能获得10000元。</li><li>A扩大规模5倍，C不扩大：这样B每天亏损600元，B在第10天发现亏损，A能获得5000元，C能获得1000元。</li><li>A不扩大，C扩大规模5倍：与上面例子类似，A能获得1000元，C能获得5000元。</li><li>A和C都亏大规模交易：这样B每天亏损1000元，B能够立即发现自己失血，第二天就退出市场，A和B各获得500元。</li></ol><p>第一个情况中，A和C的盈利是最多；第四种情况下，A和C赚的钱最少。</p><p>但是，A和C都无法知道对方的存在，而无法沟通合作。A和C都出于个人利益最大化而扩大规模。囚徒困境的结果就是第四种情况，A和C都扩大交易规模。这将导致B更快离开市场，导致系统被更快地改变，导致策略更快失效。</p><p>因此，这里和海森堡不确定性原理就很像了。市场变得更有效就是市场根本属性。每个策略尽快失效就是策略的根本属性。</p><h2>7. 怎么办？</h2><p>本文的核心观点有点悲观了。市场的有效是市场的根本属性。策略的失效是策略的根本属性。那么，对于职业投资人的启示是什么？</p><ol><li>策略的盈利都是暂时的。新策略的研发不能停止。</li><li>当你发现一个策略，就马上用尽可能多的资金去交易，赚到尽可能多的盈利。你不贪婪，在市场上某个隐藏角落的竞争对手也会贪婪。</li><li>符合某些特征的策略可能会更持久一些：</li></ol><ul><li>更高的门坎。门坎可以来自更复杂的策略算法、更罕见的数据来源和更高效的IT平台。这将带来更少的竞争对手。</li><li>更深刻。如果你的策略的有效性根植于人类的不理性，那么一波韭菜被收割以后，新的韭菜还会长出来。</li><li>更广泛。如果你的策略的对手盘是一个人，那么取之一瓢，你就将深刻影响市场。如果你的策略的对手盘是庞大的机构，那么你可以赚走更多的盈利而不担心对市场有深刻影响。</li></ul><p></p><p></p><p></p>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
