<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>策略篇——残差项的均值回归</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/41270521">原文</a></p>
<div class="title-image"><img src="https://pic4.zhimg.com/v2-951dbd993c11fea2498a25ff765ff3f7_r.jpg" alt=""></div><h2><b>摘要</b></h2><p>本文对超额收益净值建模，认为超额收益净值具有均值回归的特征。采用的方法是<b>OU过程（Ornstein–Uhlenbeck process）</b>，并且站在长期和短期的均值回归的角度，提出了类‘布林带’新方法并给出具体实施步骤，可供业界参考。</p><h2><b>背景介绍</b></h2><p>均值回归是量化投资策略里的一大类，金融里的均值回归在维基百科定义如下：</p><blockquote>“In finance,<b>mean reversion </b>is the assumption that a stock's price will tend to move to the average price over time”</blockquote><p>这句话符合一些技术派的观点：“涨多了就要跌，跌够了就要涨”。但是如何应用呢？技术派有个非常知名的方法：叫布林带。布林带给当前股票价格设定上下的置信区间，其中一个应用是（当然还有其它应用）：当超过上下界可以的时候，认为价格有较大概率回弹。</p><p>但是价格除了有均值回归的特性之外，还有动量特征，当牛市和熊市到来，在价格上操作均值回归（比如抄底）比较危险</p><p>为了将牛市和熊市的或者其他动量信息剥离掉，我们自然想到“残差项”，残差项就是在个股收益率被市场风格因子剔除掉的部分，比如CAPM中的残差项。</p><p>Yeo and Papanicolaou (2017)也做过对残差项的均值回归。</p><p>残差项可以通过CAPM回归得到，或者风险模型得到（风险模型可能更好，因子残差项更纯）</p><p>残差项的可以理解为”超额收益“，为了直观性和交易可实现性，我不使用全局CAPM回归得到残差项，而是对每个个股，做这样一个操作：</p><p>（为了简便）在CAPM框架下，根据前值估计出个股的beta（beta反映了市场收益对个股收益的边际贡献），然后做beta对冲（做多1个单位的个股，做空beta个单位的市场组合），那么该策略的收益本质上就是我们的残差项，或者是“超额收益”</p><p><b>我试图构造一个类似布林带的指标，使得投资者可以直接参考，它更符合理论，且更稳健</b></p><h2><b>模型设定</b></h2><p>布林带的直观之处在于它直接对价格序列进行建模，投资者的损益也是从价格序列上体现。而超额收益率（残差项）是个流量的概念，不能直接反应损益，所以我的指标必须也是存量指标，那么我可以通过超额收益率算累计净值，从而获得一个存量序列，比如下图：</p><img src="https://pic2.zhimg.com/v2-2bf6a7d5c0d56ce55ddeb6965cb08bb9_r.jpg" data-caption="浦发银行（600000.SH）超额收益净值" data-size="normal" data-rawwidth="974" data-rawheight="356" data-watermark="watermark" data-original-src="v2-2bf6a7d5c0d56ce55ddeb6965cb08bb9" data-watermark-src="v2-ec3826a14027534e9bd536efc6bea593" data-private-watermark-src=""><p>Yeo and Papanicolaou （2017）使用了<b>OU过程（Ornstein–Uhlenbeck process）</b>，详见维基百科<a href="https://en.wikipedia.org/wiki/Ornstein%E2%80%93Uhlenbeck_process">Ornstein-Uhlenbeck process</a>。本文也是受到OU过程的启发，OU过程的正式表达式如下：</p><p><equation>dx_t = \theta(\mu-x_t)dt+\sigma dW_t \\(1)</equation> </p><p>其中 <equation>\theta&gt;0,\sigma&gt;0,\mu</equation> 为参数， <equation>W_t</equation> 为维纳过程</p><p>而OU过程是具有均值回归的特性的，当 <equation>x_t&gt;\mu </equation>时，在不考虑随机变量 <equation>W_t</equation> 的情况下， <equation>dx_t &lt;0</equation> ，使得 <equation>x_t</equation> 在那一瞬间有一个向下的斜率。</p><p>不妨做如下假设：</p><p><b>假设：超额收益净值是一个OU过程</b></p><p>为了简化模型：考虑OU过程的离散形式：</p><p><equation>x_{t}-x_{t-1} = \theta(\mu-x_{t-1}) + \sigma(W_t-W_{t-1})\\(2)</equation> </p><p>（注意：我认为在离散的情况下 <equation>\theta(\mu-x_{t}) </equation> 里面的 <equation>x_t</equation> 应该为 <equation>x_{t-1}</equation>, 因为离散情况下没有办法刻画“瞬时”状态，只有通过前后期的差分体现）</p><p>（2）式的 <equation>W_t </equation> 为离散<b>维纳过程</b>（Discrete <b>Wiener Process</b>）:</p><p>离散的维纳过程描述了这样一个情景： <equation>W_1...W_t</equation> 时间序列的每一个增量 （increment）<equation>W_t-W_{t-1},\forall{t}</equation> 都是独立同分布的（服从 <equation>N(0,s^2)</equation> 的正太分布，（2）式中 <equation>s</equation> =1）。</p><p>所以（2）式子可以化简为</p><p><equation>x_t-x_{t-1} = \theta(\mu-x_{t-1}) + \epsilon_t\\(3)</equation> </p><p>其中 <equation>\epsilon_t \sim N(0,\sigma^2), \forall{t}</equation> </p><p>（3）式中 <equation>x_t</equation> 由上一期值 <equation>x_{t-1}</equation> 与均值的偏离度 <equation>\mu-x_{t-1}</equation> ，和回归速度 <equation>\theta</equation> 决定。</p><p>进一步可以化简成带漂移(drift)的AR（1）过程：</p><p><equation>x_t = a + bx_{t-1} + \epsilon_t\\(4)</equation> </p><p>其中 <equation>a=\theta\mu,b=1-\theta,\epsilon_t \sim N(0,\sigma^2), \forall{t}\ </equation> </p><p><br></p><p><b>从图中可以看出，该序列在长期和短期都存在均值回归</b></p><p>如果只考虑长期均值，均值回归会在短期承受收益震荡；如果只考虑短期均值，则忽略了大周期的均值回归方向。</p><p>造成长短期均值回归共存的原因之一为：超额收益不够纯粹，某些情况存在动量，而且在实操中，也很难得到纯粹的超额收益。</p><p>所以接下来，我要对长期均值回归和短期均值回归分别考虑：</p><h2><b>长期</b>：</h2><p>用较长周期 <equation>W</equation> 期的数据滚动对（4）式子进行如下滚动操作：</p><ol><li>估计<equation>\hat{a},\hat{b},\hat{\sigma}</equation> ,并计算长期均值 <equation>\hat{\mu}</equation> :</li></ol><p><equation>\hat{\mu}=\frac{\hat{a}}{1-\hat{b}}\\</equation> 2. 估计 <equation>\hat{\mu}</equation> 的方差：</p><p><equation>\epsilon_t</equation> 的正态分布导致估计量 <equation>\hat{a}</equation> 和 <equation>\hat{b}</equation> 也是正太分布，所以 <equation>\hat{\mu}</equation> 服从柯西分布（Cauchy distribution），而柯西分布在解析上是不存在方差的。</p><p>但是为了刻画我们有多大程度上信赖估计量 <equation>\hat{\mu}</equation> ,我们需要用其他的方法。可以考虑用bootstrap方法重新采样不断估计 <equation>\hat{\mu_1}</equation> ... <equation>\hat{\mu_n}</equation> ,采用分位数估计法（取分位数为5%和95% <equation>\hat{\mu_n}</equation> 值之间的区域），或者n倍bootstrap估计方差法，作为 <equation>\hat{\mu}</equation> 的置信区间。</p><p>在离散OU过程中， <equation>\sigma</equation> 反映了序列的波动率，或者不确定性。 可以根据估计的<equation>\hat{\sigma}</equation> </p><p>可以得到长期均值回归的“布林带”，“中轨”为长期均值 <equation>\hat{\mu}</equation> ，“上下轨”为置信区间顶底再加上k倍的 <equation>\hat{\sigma}</equation> 。</p><p>长期的均值回归认为在较长的一段时期内，序列不应该偏离均值，一旦偏离均值，必然会回复；而在短期择考虑不同的情况。</p><h2><b>短期</b>：</h2><p>短期内认为：在给定均值已经偏离的情况下，认为在未来几期会有回复的趋势。</p><p>在短期（ <equation>w</equation> 期），认为序列做条件均值回归。</p><p>比如在给定 <equation>x_s</equation> 期的实现值 <equation>\hat{x_s}</equation> ,求 条件期望<equation>E(x_t|x_s)</equation> ，认为在给定的时间窗口里，序列不会偏离条件期望太远。</p><p>滚动 <equation>w</equation> 期窗口做如下操作：</p><ol><li>估计参数, <equation>\hat{a},\hat{b},\hat{\sigma}</equation> ；</li><li>给定 <equation>t </equation> 时刻的实现值 <equation>\hat{x_t}</equation> 递归地计算 <equation>t+w</equation> 期的条件期望和方差</li></ol><p><equation>E(x_{t+1}) = \hat{a}+\hat{b}\hat{x_{t}}\\ ...\\ E(x_{t+w}) = \hat{a}+\hat{b}E(x_{t+w-1})</equation> </p><p><br></p><p><equation>var(x_t) = \hat{\sigma}^2\\ var(x_{t+1}) = \hat{b}^2\hat{\sigma}^2+\hat{\sigma}^2\\ ...</equation> </p><p>3. 建立 <equation>x_t</equation> 的置信区间</p><p><equation>CI = E(x_t+w|x_t)\pm k\cdot{std(x_{t+w}|x_t)}\\ </equation> </p><p>其中 <equation>k</equation> 为常数，由此可以构建一个短期均值回归的“布林带”：“中轨”为条件期望，“上轨”，“下轨”分别为偏离条件期望的 <equation>k</equation> 倍标准差值</p><p>当我们有了长短期的“布林带”之后，我们可以有很大的想象空间，其中一种是：当超额收益净值同时高于长期和短期布林带，做空；同时低于长期和短期布林带，做多。</p><h2><b>参考文献</b></h2><p>Yeo, J. and G. Papanicolaou (2017). Risk control of mean-reversion time in statistical arbitrage.<i>Risk and Decision Analysis</i>, Vol. 6(4), 263 – 290.</p><hr><p>（虽然有参考文献，但是其实思路和方法都是独立构建，完全原创）</p><p>以上只是理论部分，有空了(如果有的话)会加上实证部分，敬请期待！</p><p>注：文章部分内容受到 <a class="member_mention" href="http://www.zhihu.com/people/65c35f508b1bd677362f91e2313b5771" data-hash="65c35f508b1bd677362f91e2313b5771" data-hovercard="p$b$65c35f508b1bd677362f91e2313b5771">@石川</a> 一篇文章<a href="https://zhuanlan.zhihu.com/p/38821733">次世代均值回归策略</a>中关于OU过程描述的启发，感谢！</p><p></p><p></p><p></p><p></p><p></p><p></p>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
</body>
</html>
