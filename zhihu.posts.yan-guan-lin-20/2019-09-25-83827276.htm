<div class="title-image"><img src="https://pic1.zhimg.com/v2-582a24682bccd7ddf4d0bdd6325b96c6_r.jpg" alt=""></div><p><b>本系列专注“虚假理论”，与“预测”，“交易策略”，"期权策略"等贴近交易的内容毫不相关。不感兴趣的知友可以继续右上角了。</b></p><a href="https://zhuanlan.zhihu.com/p/74091260" data-draft-node="block" data-draft-type="link-card" data-image="https://pic3.zhimg.com/v2-582a24682bccd7ddf4d0bdd6325b96c6_ipico.jpg" data-image-width="1024" data-image-height="1024" class="internal">黑猫Q形态：关于计价单位2 ——T-远期测度</a><p>上篇文章以微分形式推导了HJM框架下远期债，Libor的等以高斯过程表述的dynamic，并且确定了这些产品分别在什么测度下是鞅。本篇将给出给出一个HJM框架下衍生的重要结论即——HJM下短期率过程长期回归项的确定。</p><p>Generally，HJM作为一个无套利框架，他必然能和别的无套利条件一样列出风险的市场价格方程组从而得出（漂移）唯一解。本篇文章的重点不在证明这个解的唯一性，而是要通过HJM框架求出这个唯一解。</p><p>解法有很多种，本文接上一篇继续参考AP红书第四章。</p><p class="ztext-empty-paragraph"><br/></p><p><b>累积波动率的马尔可夫形式：</b></p><p>在HJM框架下，短期率可有瞬时远期率构成：</p><p><img src="https://www.zhihu.com/equation?tex=r%28t%29+%3D+f%280%2Ct%29+%2B+%5Cint_0%5Et%5Csigma_f%28u%2Ct%29%5Cint_t%5ET%5Csigma_f%28u%2Cs%29dsdu+%2B+%5Cint_0%5Et%5Csigma_f%28u%2Ct%29dW%28u%29++%5Ctag1" alt="r(t) = f(0,t) + \int_0^t\sigma_f(u,t)\int_t^T\sigma_f(u,s)dsdu + \int_0^t\sigma_f(u,t)dW(u)  \tag1" eeimg="1"/> </p><p>这个形式下远期波动率不是马尔可夫，因为它带有时刻t的积分（这会导致不同的t条件下，期望不一致），我们希望短期率和他的波动率有一个马尔可夫形式。因此我么不妨令：</p><p><img src="https://www.zhihu.com/equation?tex=%5Csigma_f%28t%2CT%29+%3D+g%28t%29h%28T%29+%5Ctag2" alt="\sigma_f(t,T) = g(t)h(T) \tag2" eeimg="1"/> </p><p>如此，之前提到的债券累积波动率将会如下形式：</p><p><img src="https://www.zhihu.com/equation?tex=%5Csigma_p%28t%2CT%29+%3D+%5Cint_0%5ET+%5Csigma_f%28t%2Cu%29du+%3D+g%28t%29%5Cint_t%5ETh%28u%29du+%5Ctag3" alt="\sigma_p(t,T) = \int_0^T \sigma_f(t,u)du = g(t)\int_t^Th(u)du \tag3" eeimg="1"/> </p><p>同时：</p><p><img src="https://www.zhihu.com/equation?tex=r%28t%29+%3D+f%280%2Ct%29+%2B+h%28t%29%5Cint_0%5Etg%28u%29%5E2%5Cint_t%5ETh%28s%29dsdu+%2B+h%28t%29%5Cint_0%5Etg%28u%29dW%28u%29++%5Ctag4" alt="r(t) = f(0,t) + h(t)\int_0^tg(u)^2\int_t^Th(s)dsdu + h(t)\int_0^tg(u)dW(u)  \tag4" eeimg="1"/> </p><p>我们令波动率的随机项： <img src="https://www.zhihu.com/equation?tex=D%28t%29+%3A%3D+%5Cint_0%5Et%5Csigma_f%28u%2Ct%29dW%28u%29+%3Dh%28t%29%5Cint_0%5Etg%28u%29dW%28u%29" alt="D(t) := \int_0^t\sigma_f(u,t)dW(u) =h(t)\int_0^tg(u)dW(u)" eeimg="1"/> </p><p>如此:</p><p><img src="https://www.zhihu.com/equation?tex=D%28T%29+%3D+h%28T%29%5Cint_0%5ETg%28u%29dW%28u%29+%3D+%5Cfrac%7Bh%28T%29%7D%7Bh%28t%29%7DD%28t%29+%2B+h%28T%29%5Cint_t%5ETg%28u%29dW%28u%29++%5Ctag5" alt="D(T) = h(T)\int_0^Tg(u)dW(u) = \frac{h(T)}{h(t)}D(t) + h(T)\int_t^Tg(u)dW(u)  \tag5" eeimg="1"/> </p><p>由于后半部分 <img src="https://www.zhihu.com/equation?tex=%5Cint_t%5ET" alt="\int_t^T" eeimg="1"/> 的信息在t时刻都是不知道的，因此获得D(t)和获得t时刻前的信息 <img src="https://www.zhihu.com/equation?tex=%5Cmathcal%7BF%7D_t" alt="\mathcal{F}_t" eeimg="1"/> 对期望没有任何影响： <img src="https://www.zhihu.com/equation?tex=E%5BD%28T%29%7CD%28t%29%5D+%3D+E%5BD%28T%29%7C%5Cmathcal%7BF%7D_t%5D+" alt="E[D(T)|D(t)] = E[D(T)|\mathcal{F}_t] " eeimg="1"/> ，这正是马尔可夫性质。</p><p>我们对比进行变量分立前的累积波动率： <img src="https://www.zhihu.com/equation?tex=D%28T%29+%3D++%5Cint_0%5Et+%5Csigma_f%28t%2Cu%29dW%28u%29+%2B++%5Cint_t%5ET+%5Csigma_f%28t%2Cu%29dW%28u%29" alt="D(T) =  \int_0^t \sigma_f(t,u)dW(u) +  \int_t^T \sigma_f(t,u)dW(u)" eeimg="1"/>  在给定 <img src="https://www.zhihu.com/equation?tex=%5Cmathcal%7BF%7D_t" alt="\mathcal{F}_t" eeimg="1"/> 后前半部积分中的 <img src="https://www.zhihu.com/equation?tex=W%280%29+%5Csim+W%28t%29" alt="W(0) \sim W(t)" eeimg="1"/> 全部被变成了已知，破坏了马尔可夫性质。这里可以看出分离时间t和期限T的优点。大部分OU过程下的短期率过程都是可以带入这种分离的，在后文会给出例子。</p><p class="ztext-empty-paragraph"><br/></p><p><b>短期率的马尔可夫形式：</b></p><p>接下来要对式1关于t求导，AP第四章关于这部写的比较省略，在这里会详细地把他们展开。</p><p>令 <img src="https://www.zhihu.com/equation?tex=m_f%28t%2Cu%29+%3A%3D+g%28u%29%5E2%5Cint_u%5Et+h%28s%29+ds" alt="m_f(t,u) := g(u)^2\int_u^t h(s) ds" eeimg="1"/> 则：</p><p><img src="https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+dr%28t%29+%26%3D+d%5Bf%280%2Ct%29+%2B+h%28t%29%5Cint_0%5Etm_f%28t%2Cu%29du+%2B+h%28t%29%5Cint_0%5Etg%28u%29dW%28u%29%5D+%5C%5C+%26%3D+%5Cfrac%7B%5Cpartial+f%280%2Ct%29%7D%7B%5Cpartial+t%7Ddt+%2B%5Bh%27%28t%29%5Cint_0%5Etm_f%28t%2Cu%29dudt+%2Bh%28t%29+++%5Cfrac%7B%5Cpartial++%5Cint_0%5Etm_f%28t%2Cu%29du+%7D%7B%5Cpartial+t+%7Ddt%5D++%5C%5C%26%2B%5B+h%27%28t%29%5Cint_0%5Etg%28u%29+dW%28u%29dt+%2B+h%28t%29+%5Cfrac%7Bd%5Cint_0%5Et+g%28u%29+dW%28u%29%7D%7Bdt%7D+%5D%5Ctag6+%5Cend%7Balign%7D" alt="\begin{align} dr(t) &= d[f(0,t) + h(t)\int_0^tm_f(t,u)du + h(t)\int_0^tg(u)dW(u)] \\ &= \frac{\partial f(0,t)}{\partial t}dt +[h'(t)\int_0^tm_f(t,u)dudt +h(t)   \frac{\partial  \int_0^tm_f(t,u)du }{\partial t }dt]  \\&+[ h'(t)\int_0^tg(u) dW(u)dt + h(t) \frac{d\int_0^t g(u) dW(u)}{dt} ]\tag6 \end{align}" eeimg="1"/> </p><p>其中： <img src="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial++%5Cint_0%5Etm_f%28t%2Cu%29du+%7D%7B%5Cpartial+t+%7D++%3D+%5Cint_0%5Etg%28u%29%5E2h%28t%29+du%2Bm_f%28t%2Ct%29" alt="\frac{\partial  \int_0^tm_f(t,u)du }{\partial t }  = \int_0^tg(u)^2h(t) du+m_f(t,t)" eeimg="1"/> 。 同时 <img src="https://www.zhihu.com/equation?tex=%5Cfrac%7Bd%5Cint_0%5Et+g%28u%29+dW%28u%29%7D%7Bdt%7D+" alt="\frac{d\int_0^t g(u) dW(u)}{dt} " eeimg="1"/> 由于是对整个随机积分整体求导，因此不涉及 <img src="https://www.zhihu.com/equation?tex=dW%28t%29" alt="dW(t)" eeimg="1"/> 的导数，我们得到 <img src="https://www.zhihu.com/equation?tex=g%28t%29+dW%28t%29" alt="g(t) dW(t)" eeimg="1"/> 。整理式6得：</p><p><img src="https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+dr%28t%29+%26%3D+%5Cfrac%7B%5Cpartial+f%280%2Ct%29%7D%7B%5Cpartial+t%7Ddt+%2B%5C%7Bh%27%28t%29%5Cint_0%5Etm_f%28t%2Cu%29dudt+%2Bh%28t%29+%5B%5Cint_0%5Etg%28u%29%5E2h%28t%29+%2Bm_f%28t%2Ct%29%5Ddt+%5C%7D+%5C%5C%26%2B%5C%7B+h%27%28t%29%5Cint_0%5Etg%28u%29+dW%28u%29dt+%2B+h%28t%29+g%28t%29dW%28t%29+%5C%7D+%5Ctag7+%5Cend%7Balign%7D" alt="\begin{align} dr(t) &= \frac{\partial f(0,t)}{\partial t}dt +\{h'(t)\int_0^tm_f(t,u)dudt +h(t) [\int_0^tg(u)^2h(t) +m_f(t,t)]dt \} \\&+\{ h'(t)\int_0^tg(u) dW(u)dt + h(t) g(t)dW(t) \} \tag7 \end{align}" eeimg="1"/> </p><p>整理清楚后我们发现:</p><p>1. <img src="https://www.zhihu.com/equation?tex=m_f%28t%2Ct%29+%3Dg%28u%29%5E2%5Cint_t%5Et+h%28s%29+ds+%3D+0" alt="m_f(t,t) =g(u)^2\int_t^t h(s) ds = 0" eeimg="1"/> </p><p>2. <img src="https://www.zhihu.com/equation?tex=h%27%28t%29%5Cint_0%5Etm_f%28t%2Cu%29dudt+" alt="h'(t)\int_0^tm_f(t,u)dudt " eeimg="1"/> 和 <img src="https://www.zhihu.com/equation?tex=h%27%28t%29%5Cint_0%5Etg%28u%29+dW%28u%29dt+" alt="h'(t)\int_0^tg(u) dW(u)dt " eeimg="1"/> 有相同系数，可以根据 <img src="https://www.zhihu.com/equation?tex=m_f%28t%2Cu%29" alt="m_f(t,u)" eeimg="1"/> 定义凑r(t) 。这里凑r(t)的目的是，只要的到了分割了漂移中的r(t)和其他部分，就能构成一般形式的OU过程，则r(t)以外的部分就可作为OU过程中的长期回归项存在。</p><p>我们根据定义有 <img src="https://www.zhihu.com/equation?tex=h%27%28t%29%5Cint_0%5Etm_f%28t%2Cu%29dudt++%2Bh%27%28t%29%5Cint_0%5Etg%28u%29+dW%28u%29dt++%3D+%5Cfrac%7Bh%27%28t%29%7D%7Bh%28t%29%7D%28r%28t%29+-+f%280%2Ct%29%29" alt="h'(t)\int_0^tm_f(t,u)dudt  +h'(t)\int_0^tg(u) dW(u)dt  = \frac{h'(t)}{h(t)}(r(t) - f(0,t))" eeimg="1"/> ,则式7可以化成广义OU过程形式：</p><p><img src="https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+dr%28t%29+%26%3D+%5B%28%5Cfrac%7B%5Cpartial+f%280%2Ct%29%7D%7B%5Cpartial+t%7D++-+%5Cfrac%7Bh%27%28t%29%7D%7Bh%28t%29%7Df%280%2Ct%29++%2B+h%28t%29+%5E2%5Cint_0%5Etg%28u%29%5E2du%29++%2B+++%5Cfrac%7Bh%27%28t%29%7D%7Bh%28t%29%7D+r%28t%29%5Ddt++%5C%5C%26%2B+h%28t%29+g%28t%29dW%28t%29++%5Ctag8+%5Cend%7Balign%7D" alt="\begin{align} dr(t) &= [(\frac{\partial f(0,t)}{\partial t}  - \frac{h'(t)}{h(t)}f(0,t)  + h(t) ^2\int_0^tg(u)^2du)  +   \frac{h'(t)}{h(t)} r(t)]dt  \\&+ h(t) g(t)dW(t)  \tag8 \end{align}" eeimg="1"/> </p><p> 值得注意的是，式中 <img src="https://www.zhihu.com/equation?tex=h%28t%29+%5E2%5Cint_0%5Etg%28u%29%5E2du" alt="h(t) ^2\int_0^tg(u)^2du" eeimg="1"/> 其实就是 <img src="https://www.zhihu.com/equation?tex=%5Cint_0%5Et%5Csigma_f%28u%2Ct%29%5E2du" alt="\int_0^t\sigma_f(u,t)^2du" eeimg="1"/> </p><p>式8就是AP红书，第四章4.46的结果。其中 <img src="https://www.zhihu.com/equation?tex=f%280%2Ct%29" alt="f(0,t)" eeimg="1"/> 为初期可观测的量，漂移项圆括号内的内容就是HJM框架下马尔可夫形式波动率所表示的OU过程中长期回归项。我们已知OU过程是一个马尔可夫过程，因此这些计算间接证明了在HJM框架下远期率的波动率能取到形如式2的马尔可夫形式后，短期率也是马尔可夫的。</p><p class="ztext-empty-paragraph"><br/></p><p><b>一个具体例子：</b></p><p>对于一般形式的OU短期率过程:</p><p><img src="https://www.zhihu.com/equation?tex=dr%28t%29+%3D+%28%5Ctheta%28t%29+-+%5Calpha%28t%29r%28t%29%29dt+%2B%5Csigma%28t%29dW%28t%29+%5Ctag9" alt="dr(t) = (\theta(t) - \alpha(t)r(t))dt +\sigma(t)dW(t) \tag9" eeimg="1"/> </p><p>令 <img src="https://www.zhihu.com/equation?tex=h%28T%29+%3D+e%5E%7B-%5Cint_0%5ET%5Calpha%28s%29ds+%7D" alt="h(T) = e^{-\int_0^T\alpha(s)ds }" eeimg="1"/> ， <img src="https://www.zhihu.com/equation?tex=g%28t%29+%3D+e%5E%7B%5Cint_0%5Et%5Calpha%28s%29ds+%7D%5Csigma%28t%29" alt="g(t) = e^{\int_0^t\alpha(s)ds }\sigma(t)" eeimg="1"/> 。</p><p>则易得 <img src="https://www.zhihu.com/equation?tex=h%27%28t%29%2Fh%28t%29+%3D+-%5Calpha%28t%29" alt="h'(t)/h(t) = -\alpha(t)" eeimg="1"/> 且 <img src="https://www.zhihu.com/equation?tex=%5Csigma_f%28t%2CT%29+%3D+e%5E%7B-%5Cint_t%5ET%5Calpha%28s%29ds+%7D%5Csigma%28t%29" alt="\sigma_f(t,T) = e^{-\int_t^T\alpha(s)ds }\sigma(t)" eeimg="1"/> .</p><p>带入式8后即可得：</p><p><img src="https://www.zhihu.com/equation?tex=%5Ctheta%28t%29+%3D%5Cfrac%7B%5Cpartial+f%280%2Ct%29%7D%7B%5Cpartial+t%7D++%2B%5Calpha%28t%29f%280%2Ct%29+%2B+%5Cint_0%5Et+e%5E%7B-2%5Cint_u%5Et%5Calpha%28s%29ds+%7D%5Csigma%28t%29%5E2du+%5Ctag%7B10%7D" alt="\theta(t) =\frac{\partial f(0,t)}{\partial t}  +\alpha(t)f(0,t) + \int_0^t e^{-2\int_u^t\alpha(s)ds }\sigma(t)^2du \tag{10}" eeimg="1"/> </p><p class="ztext-empty-paragraph"><br/></p><p><b>后记：</b></p><p>本文的结果是一个经典结果，有很多种推导方式，HJM框架下的推导只是其中一种。文中的构造马尔可夫形式远期波动率的手段在固收建模时也是一个常用手段，在很多处理期限结构的时候也可以这么做。</p><p>另外，为什么要那么无聊把计算过程全部写出来。可能在很多受过严格训练科班出身的人眼中，文章中的推导都是显然易得的。但是自身就是国内“金融”背景出身的黑猫太了解对于我们这些基本没学过啥东西的"金融废物“，这些内容真的是太难太深邃了。特别是对于AP这样能省步骤就省步骤的”查阅“书，对于刚刚接触的同学和玩《文明》上手就天神难度差不多。因此在写的试图尽量还原每一步容易产生理解问题的计算步骤，好让广大没有那么多计算训练的"金融废物“也能看懂。</p><p>最后按照惯例，本系列是“纯虚假理论”，是由一个不但理论功底不扎实也没有实践经验，还只会“唧唧歪歪装逼”的后台编写的。不指望能对从业者和学习者产生任何帮助，纯粹是笔者娱乐和消遣产物。</p><p class="ztext-empty-paragraph"><br/></p><p><b>Ref:</b></p><p>Interest Rate Modeling. Volume 1: Foundations and Vanilla Models by  <a href="https://link.zhihu.com/?target=https%3A//www.amazon.com/s/ref%3Ddp_byline_sr_book_1%3Fie%3DUTF8%26field-author%3DLeif%2BB.%2BG.%2BAndersen%26text%3DLeif%2BB.%2BG.%2BAndersen%26sort%3Drelevancerank%26search-alias%3Dbooks" class=" wrap external" target="_blank" rel="nofollow noreferrer">Leif B. G. Andersen</a></p><p></p>