<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>深度学习入门：什么是张量(Tensor)？</title>
</head>
<body>
<p><a href="https://mp.weixin.qq.com/s?timestamp=1548222668&amp;src=3&amp;ver=1&amp;signature=2houLpv7eAQMZBBCTTs1kqseAcBvx9LMHx8J97nJloqr3kWI*l*eqtT*nI7HanmMsB6hWeErakT-AVQRamvIGOWzQhmme3EQXqwMTvHWc-gLsUEyg8Vq2TqQiQkrnNnVj*YaZo966INJZPw1MIwVS6LmtkpHgnyXqQFWJPUe-jo=">原文</a></p>
<div id="js_top_ad_area" class="top_banner"></div><div class="rich_media_inner">

        
        
        <div id="page-content" class="rich_media_area_primary">
          <div class="rich_media_area_primary_inner">
                                    
                        

            <div id="img-content">

                
                <h2 class="rich_media_title" id="activity-name">
                    
                    
                    深度学习入门：什么是张量(Tensor)？

                                                                                </h2>
                <div id="meta_content" class="rich_media_meta_list">
                                                                                <span class="rich_media_meta rich_media_meta_text">
                                                <span id="js_author_name" class="rich_media_meta_link" data-rewardsn="" data-timestamp="" data-canreward="0">王圣元</span>
                                            </span>
                                        
                                       
                                                                    
                                        <span class="rich_media_meta rich_media_meta_nickname" id="profileBt">
                      <a href="javascript:void(0);" id="js_name">
                        聚宽量化实验室                      </a>
                      <div id="js_profile_qrcode" class="profile_container" style="display:none;">
                          <div class="profile_inner">
                              <strong class="profile_nickname">聚宽量化实验室</strong>
                              <img class="profile_avatar" id="js_profile_qrcode_img" src="" alt="">

                              <p class="profile_meta">
                              <label class="profile_meta_label">微信号</label>
                              <span class="profile_meta_value">JoinQuant-jx</span>
                              </p>

                              <p class="profile_meta">
                              <label class="profile_meta_label">功能介绍</label>
                              <span class="profile_meta_value">用数学+编程，驾驭金融市场波动。 汇集最优质量化投资模型，和最勤奋聪明的大脑。</span>
                              </p>
                              
                          </div>
                          <span class="profile_arrow_wrp" id="js_profile_arrow_wrp">
                              <i class="profile_arrow arrow_out"></i>
                              <i class="profile_arrow arrow_in"></i>
                          </span>
                      </div>
                    </span>


                    <em id="publish_time" class="rich_media_meta rich_media_meta_text"></em>





                </div>
                
                
                
                
                                                
                                                                
                                
                
                <div class="rich_media_content " id="js_content">
                    

                    

                    
                    
                    <p style="text-align: center;" data-mpa-powered-by="yiban.io"><br></p><p style="text-align: center;"><img class="" data-ratio="0.57265625" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCG10MfSaJWcNALWNO2CBJyFMG0hou4T7fQZiaL9IC4YjIKibrDMhgUdcpE35mibMibxq7z2icpp4jJHKWg/640?wx_fmt=png" data-type="png" data-w="1280"><br></p><section class="mpa-template" data-mpa-template-id="882985" data-mpa-color="null" data-mpa-category="收藏" style="white-space: normal;"><section><section class="layout" style="margin: 2px auto;border-width: 0px;border-style: initial;border-color: initial;box-sizing: border-box;"><section style="height: 6px;box-sizing: border-box;color: inherit;"><section style="height: 5.99609px;width: 6px;float: left;border-top: 2px solid rgb(247, 142, 188);border-right-color: rgb(247, 142, 188);border-bottom-color: rgb(247, 142, 188);border-left: 2px solid rgb(247, 142, 188);box-sizing: border-box;color: inherit;"></section><section style="height: 5.99609px;width: 6px;float: right;border-top: 2px solid rgb(247, 142, 188);border-right: 2px solid rgb(247, 142, 188);border-bottom-color: rgb(247, 142, 188);border-left-color: rgb(247, 142, 188);box-sizing: border-box;color: inherit;"></section><section style="display: inline-block;color: rgb(247, 142, 188);clear: both;box-sizing: border-box;border-color: rgb(247, 142, 188);"></section></section><section style="margin: -1px 4px;padding: 0.8em;border-width: 1px;border-style: solid;border-color: rgb(247, 142, 188);box-sizing: border-box;box-shadow: rgb(117, 117, 117) 0px 0px 4px;color: inherit;"><section style="color: rgb(247, 142, 188);line-height: 1.4;word-break: break-all;border-color: rgb(247, 142, 188);text-align: center;"><strong><span style="font-size: 14px;">此文献给今天五岁的女儿</span></strong></section><section style="color: rgb(247, 142, 188);line-height: 1.4;word-break: break-all;border-color: rgb(247, 142, 188);text-align: center;"><strong><span style="font-size: 14px;">四岁献上的是至今最满意的<a href="http://mp.weixin.qq.com/s?__biz=MzIzMjY0MjE1MA==&amp;mid=2247485523&amp;idx=1&amp;sn=25449fbc0ecd34fec2f85256e1042185&amp;chksm=e8908b5adfe7024c0f3d88ea8bb3c16ba5e652e05e28dcf1537488d187fd460edcb2125f651b&amp;scene=21#wechat_redirect" target="_blank" data-linktype="2">胶囊网络</a></span></strong></section></section><section style="height: 6px;box-sizing: border-box;color: inherit;"><section style="height: 5.99609px;width: 6px;float: left;border-bottom: 2px solid rgb(247, 142, 188);border-top-color: rgb(247, 142, 188);border-right-color: rgb(247, 142, 188);border-left: 2px solid rgb(247, 142, 188);box-sizing: border-box;color: inherit;"></section><section style="height: 5.99609px;width: 6px;float: right;border-bottom: 2px solid rgb(247, 142, 188);border-top-color: rgb(247, 142, 188);border-right: 2px solid rgb(247, 142, 188);border-left-color: rgb(247, 142, 188);box-sizing: border-box;color: inherit;"></section></section></section></section></section><p style="white-space: normal;"><br></p><section class="mpa-template" data-mpa-template-id="882152" data-mpa-color="null" data-mpa-category="收藏" style="white-space: normal;"><section><section style="padding: 10px;"><section class="autonum" style="float: left;width: 40px;height: 40px;text-align: center;color: rgb(255, 255, 255);background-color: rgb(13, 12, 12);font-size: 24px;line-height: 40px;">0</section><section style="padding-right: 15px;padding-left: 15px;width: auto;display: inline-block;float: left;height: 40px;font-size: 18px;line-height: 35px;border-bottom: 2px solid rgb(13, 12, 12);border-top: 2px solid rgb(13, 12, 12);">引言</section><section style='background-image: url("https://mmbiz.qpic.cn/mmbiz_png/fgnkxfGnnkSBJo13oUicPbCbqeTcIyiakNc2UGmnmA1qH7HExsicAyuzE3Foogxo1VmRNr68icYkKibV0wM7nqTIHng/640?wx_fmt=png");width: 18px;height: 40px;float: left;background-repeat: no-repeat;background-color: rgb(13, 12, 12);background-size: 100% 40px;'></section></section><section style="width: 556.25px;clear: both;"></section></section></section><p style="white-space: normal;"><br></p><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 17px;color: rgb(51, 51, 51);letter-spacing: 0.5px;">斯蒂文想用聚宽 (JoinQuant) 写一个股票投资的量化策略，首先需要收集大量的数据。(下面聚宽代码基本上可以一看就懂，详细的代码解释见本帖第四章)</span></p><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 17px;color: rgb(51, 51, 51);letter-spacing: 0.5px;"><br></span></p><section class="mpa-template" data-mpa-template-id="921851" data-mpa-color="null" data-mpa-category="收藏"><section><section class="layout"><section style="margin: 1em 0px;color: rgb(51, 51, 51);box-sizing:border-box;border-bottom-width: 2px;border-bottom-style: solid;border-bottom-color: rgb(236, 68, 68);clear: both;"><section style="display: inline-block;padding:3px 10px 0px;color: rgb(255, 255, 255);box-sizing:border-box;border-top-left-radius: 3px;border-top-right-radius: 3px;height: 28px;background-color: rgb(236, 68, 68);"><strong>阶段一</strong></section><section style="box-sizing:border-box;border-top-width:28px;border-top-style: solid;border-color: transparent rgb(206,206,206);border-bottom-width: 0px;border-bottom-style: solid;border-left-width: 15px;border-left-style: solid;display: inline-block;margin-left:2px;vertical-align:top;"></section></section></section></section></section><p style="text-align:justify;text-justify:inter-ideograph;"><span style="letter-spacing: 0.5px;">斯蒂文查了查 2019 年 1 月 3 日平安银行 (000001.XSHE) 的收盘价，发现是 9.28，他默默将这个单数字存到 X0 里。</span><span style="font-size: 17px;color: rgb(51, 51, 51);letter-spacing: 0.5px;"></span></p><p style="white-space: normal;"><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(248, 248, 248);color: rgb(51, 51, 51);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-github">X0 = get_price( <span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 85px;text-decoration: none solid rgb(221, 17, 68);font-weight: 400;font-style: normal;">'000001.XSHE'</span>,<br>start_date=<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 78px;text-decoration: none solid rgb(221, 17, 68);font-weight: 400;font-style: normal;">'2019-01-03'</span>,<br>end_date=<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 79px;text-decoration: none solid rgb(221, 17, 68);font-weight: 400;font-style: normal;">'2019-01-03'</span>,<br>frequency=<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(221, 17, 68);font-weight: 400;font-style: normal;">'daily'</span>,<br>fields=[<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 45px;text-decoration: none solid rgb(221, 17, 68);font-weight: 400;font-style: normal;">'close'</span><span class="hljs-github-string" style="background: rgba(0, 0, 0, 0);display: inline;width: 45px;text-decoration: none solid rgb(221, 17, 68);font-weight: 400;font-style: normal;color: rgb(0, 0, 0);">]</span> )</code></pre></section><p style="white-space: normal;"><br></p><p style="text-align: center;"><img class="" data-before-oversubscription-url="http://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCG10MfSaJWcNALWNO2CBJyFhHX4eGGXh8gcslB8Yhec46tbZG4pOc7oZIHtE8eIS8afGXPdr7T9FA/0?wx_fmt=png" data-ratio="0.3411764705882353" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCG10MfSaJWcNALWNO2CBJyFhHX4eGGXh8gcslB8Yhec46tbZG4pOc7oZIHtE8eIS8afGXPdr7T9FA/640?wx_fmt=png" data-type="png" data-w="340" style="width: 51%;height: auto !important;"></p><p style="text-align: center;"><br></p><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 17px;color: rgb(51, 51, 51);letter-spacing: 0.5px;">X0 又称为标量 (scalar)，或更严谨的称为 0 维张量 (0D tensor)。</span></p><p style="text-align:justify;text-justify:inter-ideograph;"><br></p><section class="mpa-template" data-mpa-template-id="1546276" data-mpa-color="null" data-mpa-category="收藏"><section><section class="layout"><section style="margin: 1em 0px;color: rgb(51, 51, 51);box-sizing: border-box;border-bottom: 2px solid rgb(236, 68, 68);clear: both;"><section style="display: inline-block;padding: 3px 10px 0px;color: rgb(255, 255, 255);box-sizing: border-box;border-top-left-radius: 3px;border-top-right-radius: 3px;height: 28px;background-color: rgb(236, 68, 68);"><strong>阶段二</strong></section><section style="box-sizing:border-box;border-top-width:28px;border-top-style: solid;border-color: transparent rgb(206,206,206);border-bottom-width: 0px;border-bottom-style: solid;border-left-width: 15px;border-left-style: solid;display: inline-block;margin-left:2px;vertical-align:top;"></section></section></section></section></section><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 17px;color: rgb(51, 51, 51);letter-spacing: 0.5px;">单天股票价格太少，至少要算一些均值、标准差这些统计量吧。</span><br></p><p style="text-align:justify;text-justify:inter-ideograph;"><br></p><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 17px;color: rgb(51, 51, 51);letter-spacing: 0.5px;">斯蒂文从一天的数据扩展到一年，下载了从 2019 年 1 月 3 日起过去一年的平安银行历史收盘价，存到 X1 里。</span></p><p style="white-space: normal;"><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(248, 248, 248);color: rgb(51, 51, 51);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-github">X1 = get_price( <span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 85px;text-decoration: none solid rgb(221, 17, 68);font-weight: 400;font-style: normal;">'000001.XSHE'</span>,<br>start_date=<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 78px;text-decoration: none solid rgb(221, 17, 68);font-weight: 400;font-style: normal;">'2018-01-03'</span>,<br>end_date=<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 79px;text-decoration: none solid rgb(221, 17, 68);font-weight: 400;font-style: normal;">'2019-01-03'</span>,<br>frequency=<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(221, 17, 68);font-weight: 400;font-style: normal;">'daily'</span>,<br>fields=[<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 45px;text-decoration: none solid rgb(221, 17, 68);font-weight: 400;font-style: normal;">'close'</span><span style="background: rgba(0, 0, 0, 0);display: inline;width: 45px;text-decoration: none solid rgb(221, 17, 68);font-weight: 400;font-style: normal;color: rgb(0, 0, 0);">]</span><span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 45px;text-decoration: none solid rgb(221, 17, 68);font-weight: 400;font-style: normal;"> </span>)</code></pre></section><p style="white-space: normal;"><br></p><p style="text-align: center;"><img class="" data-backh="308" data-backw="395" data-before-oversubscription-url="http://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCG10MfSaJWcNALWNO2CBJyFtm7dib4Y4Gic30Toicclq6lMKmDsgSQeWRicNcNmnBO6DTFV6kTN6aRILw/0?wx_fmt=png" data-ratio="0.7772151898734178" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCG10MfSaJWcNALWNO2CBJyFtm7dib4Y4Gic30Toicclq6lMKmDsgSQeWRicNcNmnBO6DTFV6kTN6aRILw/640?wx_fmt=png" data-type="png" data-w="395" style="width: 70%;height: auto !important;"></p><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 17px;color: rgb(51, 51, 51);letter-spacing: 0.5px;"><br></span></p><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 17px;color: rgb(51, 51, 51);letter-spacing: 0.5px;">X1 在 X0 基础上添加了时间维度 (红色箭头)，从标量扩展成向量 (vector)，又称为 1 维张量 (1D tensor)。</span></p><p style="text-align:justify;text-justify:inter-ideograph;"><br></p><section class="mpa-template" data-mpa-template-id="1546276" data-mpa-color="null" data-mpa-category="收藏"><section><section class="layout"><section style="margin: 1em 0px;color: rgb(51, 51, 51);box-sizing: border-box;border-bottom: 2px solid rgb(236, 68, 68);clear: both;"><section style="display: inline-block;padding:3px 10px 0px;color: rgb(255, 255, 255);box-sizing:border-box;border-top-left-radius: 3px;border-top-right-radius: 3px;height: 28px;background-color: rgb(236, 68, 68);"><strong mpa-from-tpl="t">阶段三</strong></section><section style="box-sizing:border-box;border-top-width:28px;border-top-style: solid;border-color: transparent rgb(206,206,206);border-bottom-width: 0px;border-bottom-style: solid;border-left-width: 15px;border-left-style: solid;display: inline-block;margin-left:2px;vertical-align:top;"></section></section></section></section></section><p style="text-align:justify;text-justify:inter-ideograph;"><span style="letter-spacing: 0.5px;">单个股票太少，分散原则告诉我们需要投资相关性系数为负的两支股票。</span><span style="font-size: 17px;color: rgb(51, 51, 51);letter-spacing: 0.5px;"></span><br></p><p style="text-align:justify;text-justify:inter-ideograph;"><br></p><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 17px;color: rgb(51, 51, 51);letter-spacing: 0.5px;">斯蒂文增加了茅台股票 (600519.XSHG)，</span><span style="letter-spacing: 0.5px;">下载了从 2019年 1 月 3 日起过去一年的平安银行和茅台历史收盘价，存到 X2 里。</span></p><p style="white-space: normal;"><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(248, 248, 248);color: rgb(51, 51, 51);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-github">X2 = get_price( [<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 85px;text-decoration: none solid rgb(221, 17, 68);font-weight: 400;font-style: normal;">'000001.XSHE'</span>,<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 85px;text-decoration: none solid rgb(221, 17, 68);font-weight: 400;font-style: normal;">'600519.XSHG'</span>],<br>start_date=<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 78px;text-decoration: none solid rgb(221, 17, 68);font-weight: 400;font-style: normal;">'2018-01-03'</span>,<br>end_date=<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 79px;text-decoration: none solid rgb(221, 17, 68);font-weight: 400;font-style: normal;">'2019-01-03'</span>,<br>frequency=<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(221, 17, 68);font-weight: 400;font-style: normal;">'daily'</span>,<br>fields=[<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(221, 17, 68);font-weight: 400;font-style: normal;">'close'</span>] )</code></pre></section><p style="white-space: normal;"><br></p><p style="text-align: center;"><img class="" data-backh="383" data-backw="521" data-before-oversubscription-url="http://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCG10MfSaJWcNALWNO2CBJyFW14VmicApFlyYQwU7aQ0ibcemTp4qGy2yQEpHgzUMmHNyN5BwXaicZQRg/0?wx_fmt=png" data-ratio="0.7351247600767754" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCG10MfSaJWcNALWNO2CBJyFW14VmicApFlyYQwU7aQ0ibcemTp4qGy2yQEpHgzUMmHNyN5BwXaicZQRg/640?wx_fmt=png" data-type="png" data-w="521" style="width: 90%;height: auto !important;"></p><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 17px;color: rgb(51, 51, 51);letter-spacing: 0.5px;"></span></p><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 17px;color: rgb(51, 51, 51);letter-spacing: 0.5px;">X2 在 X1 基础上添加了横截维度 (蓝色箭头)，从向量扩展成矩阵 (matrix)，又称为 2 维张量 (2D tensor)。</span></p><p style="text-align:justify;text-justify:inter-ideograph;"><br></p><section class="mpa-template" data-mpa-template-id="1546276" data-mpa-color="null" data-mpa-category="收藏"><section><section class="layout"><section style="margin: 1em 0px;color: rgb(51, 51, 51);box-sizing:border-box;border-bottom-width: 2px;border-bottom-style: solid;border-bottom-color: rgb(236, 68, 68);clear: both;"><section style="display: inline-block;padding:3px 10px 0px;color: rgb(255, 255, 255);box-sizing:border-box;border-top-left-radius: 3px;border-top-right-radius: 3px;height: 28px;background-color: rgb(236, 68, 68);"><strong mpa-from-tpl="t">阶段四</strong></section><section style="box-sizing:border-box;border-top-width:28px;border-top-style: solid;border-color: transparent rgb(206,206,206);border-bottom-width: 0px;border-bottom-style: solid;border-left-width: 15px;border-left-style: solid;display: inline-block;margin-left:2px;vertical-align:top;"></section></section></section></section></section><p style="text-align:justify;text-justify:inter-ideograph;"><span style="letter-spacing: 0.5px;">收盘价一个信息不够，在趋势追踪模型中，价格和交易量是在股票走势中相当重要的因素。</span><br></p><p style="text-align:justify;text-justify:inter-ideograph;"><br></p><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 17px;color: rgb(51, 51, 51);letter-spacing: 0.5px;">斯蒂文增加了交易量，下载了从 2019 年 1 月 3 日起过去一年的平安银行和茅台历史收盘价和交易量，存到 X3 里。</span></p><p style="white-space: normal;"><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(248, 248, 248);color: rgb(51, 51, 51);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-github">X3 = get_price( [<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 85px;text-decoration: none solid rgb(221, 17, 68);font-weight: 400;font-style: normal;">'000001.XSHE'</span>,<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 85px;text-decoration: none solid rgb(221, 17, 68);font-weight: 400;font-style: normal;">'600519.XSHG'</span>],<br>start_date=<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 78px;text-decoration: none solid rgb(221, 17, 68);font-weight: 400;font-style: normal;">'2018-01-03'</span>,<br>end_date=<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 79px;text-decoration: none solid rgb(221, 17, 68);font-weight: 400;font-style: normal;">'2019-01-03'</span>,<br>frequency=<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(221, 17, 68);font-weight: 400;font-style: normal;">'daily'</span>,<br>fields=[<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(221, 17, 68);font-weight: 400;font-style: normal;">'close'</span>,<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 53px;text-decoration: none solid rgb(221, 17, 68);font-weight: 400;font-style: normal;">'volume'</span>] )</code></pre></section><p style="white-space: normal;"><br></p><p style="text-align: center;"><img class="" data-backh="510" data-backw="556" data-before-oversubscription-url="http://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCG10MfSaJWcNALWNO2CBJyF44sISFn0iannYFdKibFRXlNibtoSDpR4xMqhQ4U01t50icbpk3yTvNRQYQ/0?wx_fmt=png" data-ratio="0.9157733537519143" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCG10MfSaJWcNALWNO2CBJyF44sISFn0iannYFdKibFRXlNibtoSDpR4xMqhQ4U01t50icbpk3yTvNRQYQ/640?wx_fmt=png" data-type="png" data-w="653" style="width: 100%;height: auto;"></p><p style="white-space: normal;"><br></p><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 17px;color: rgb(51, 51, 51);letter-spacing: 0.5px;">X3 在 X2 基础上添加了信息维度 (绿色箭头)，从矩阵扩展成 3 维张量 (3D tensor)。</span></p><p style="text-align:justify;text-justify:inter-ideograph;"><span style="color: rgb(51, 51, 51);letter-spacing: 0.5px;font-size: 17px;"> </span></p><section class="mpa-template" data-mpa-template-id="1546276" data-mpa-color="null" data-mpa-category="收藏"><section><section class="layout"><section style="margin: 1em 0px;color: rgb(51, 51, 51);box-sizing:border-box;border-bottom-width: 2px;border-bottom-style: solid;border-bottom-color: rgb(236, 68, 68);clear: both;"><section style="display: inline-block;padding:3px 10px 0px;color: rgb(255, 255, 255);box-sizing:border-box;border-top-left-radius: 3px;border-top-right-radius: 3px;height: 28px;background-color: rgb(236, 68, 68);"><strong mpa-from-tpl="t">阶段五</strong></section><section style="box-sizing:border-box;border-top-width:28px;border-top-style: solid;border-color: transparent rgb(206,206,206);border-bottom-width: 0px;border-bottom-style: solid;border-left-width: 15px;border-left-style: solid;display: inline-block;margin-left:2px;vertical-align:top;"></section></section></section></section></section><p style="text-align:justify;text-justify:inter-ideograph;"><span style="letter-spacing: 0.5px;">收盘信息太过于少，如果要日内交易怎么办？</span><br></p><p style="text-align:justify;text-justify:inter-ideograph;"><br></p><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 17px;color: rgb(51, 51, 51);letter-spacing: 0.5px;">斯蒂文又增加了 tick 数据 (聚宽对股票的 tick 数据切片时间为 3 秒)，下载了从 2019 年 1 月 3 日起过去一年的平安银行和茅台历史 tick 价格和交易量，存到 X4 里。</span></p><p style="white-space: normal;"><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(248, 248, 248);color: rgb(51, 51, 51);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-github"><span class="hljs-github-keyword" style="color: rgb(51, 51, 51);background: rgba(0, 0, 0, 0);display: inline;width: 40px;text-decoration: none solid rgb(51, 51, 51);font-weight: 700;font-style: normal;">import</span> pandas <span class="hljs-github-keyword" style="color: rgb(51, 51, 51);background: rgba(0, 0, 0, 0);display: inline;width: 14px;text-decoration: none solid rgb(51, 51, 51);font-weight: 700;font-style: normal;">as</span> pd<br>tick_data1 = []<br>tick_data2 = []<br><br><span class="hljs-github-keyword" style="color: rgb(51, 51, 51);background: rgba(0, 0, 0, 0);display: inline;width: 20px;text-decoration: none solid rgb(51, 51, 51);font-weight: 700;font-style: normal;">for</span> date <span class="hljs-github-keyword" style="color: rgb(51, 51, 51);background: rgba(0, 0, 0, 0);display: inline;width: 14px;text-decoration: none solid rgb(51, 51, 51);font-weight: 700;font-style: normal;">in</span> pd.date_range(<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 79px;text-decoration: none solid rgb(221, 17, 68);font-weight: 400;font-style: normal;">'2018-01-04'</span>, <span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 79px;text-decoration: none solid rgb(221, 17, 68);font-weight: 400;font-style: normal;">'2019-01-04'</span>).tolist():<br><br>    d = get_ticks(<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 85px;text-decoration: none solid rgb(221, 17, 68);font-weight: 400;font-style: normal;">'000001.XSHE'</span>,<br>  start_dt=<span class="hljs-github-keyword" style="color: rgb(51, 51, 51);background: rgba(0, 0, 0, 0);display: inline;width: 26px;text-decoration: none solid rgb(51, 51, 51);font-weight: 700;font-style: normal;">None</span>,<br>  end_dt=date,<br>  count=<span class="hljs-github-number" style="color: rgb(0, 128, 128);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(0, 128, 128);font-weight: 400;font-style: normal;">5</span>,<br>  fields=[<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 40px;text-decoration: none solid rgb(221, 17, 68);font-weight: 400;font-style: normal;">'time'</span>,<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 59px;text-decoration: none solid rgb(221, 17, 68);font-weight: 400;font-style: normal;">'current'</span>,<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 53px;text-decoration: none solid rgb(221, 17, 68);font-weight: 400;font-style: normal;">'volume'</span>])<br>    tick_data1.append(d)<br><br>    d = get_ticks(<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 85px;text-decoration: none solid rgb(221, 17, 68);font-weight: 400;font-style: normal;">'600519.XSHG'</span>,<br>  start_dt=<span class="hljs-github-keyword" style="color: rgb(51, 51, 51);background: rgba(0, 0, 0, 0);display: inline;width: 26px;text-decoration: none solid rgb(51, 51, 51);font-weight: 700;font-style: normal;">None</span>,<br>  end_dt=date,<br>  count=<span class="hljs-github-number" style="color: rgb(0, 128, 128);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(0, 128, 128);font-weight: 400;font-style: normal;">5</span>,<br>fields=[<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration: none solid rgb(221, 17, 68);font-weight: 400;font-style: normal;">'time'</span>,<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 59px;text-decoration: none solid rgb(221, 17, 68);font-weight: 400;font-style: normal;">'current'</span>,<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 53px;text-decoration: none solid rgb(221, 17, 68);font-weight: 400;font-style: normal;">'volume'</span>])<br>    tick_data2.append(d)</code></pre></section><p style="white-space: normal;"><br></p><p style="text-align: center;"><img class="" data-backh="443" data-backw="556" data-before-oversubscription-url="http://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCG10MfSaJWcNALWNO2CBJyFG7tOaS8OGL4H5mjxu9RypRCibicpia5oddEpagiam4Dh358fGSrkWuRicibA/0?wx_fmt=png" data-ratio="0.7952755905511811" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCG10MfSaJWcNALWNO2CBJyFG7tOaS8OGL4H5mjxu9RypRCibicpia5oddEpagiam4Dh358fGSrkWuRicibA/640?wx_fmt=png" data-type="png" data-w="889" style="width: 100%;height: auto;"></p><p style="white-space: normal;"><br></p><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 17px;color: rgb(51, 51, 51);letter-spacing: 0.5px;">X4 在 X3 基础上添加了频率维度(灰色箭头)，从 3 维张量扩展成 4 维张量 (4D tensor)。</span></p><p style="text-align:justify;text-justify:inter-ideograph;"><br></p><section class="mpa-template" data-mpa-template-id="2215" data-mpa-color="#ffffff" data-mpa-category="分隔"><section class="" style="box-sizing: border-box;"><section class="" style="text-align: center;margin-top: 10px;margin-bottom: 10px;box-sizing: border-box;"><section class="" style="max-width: 100%;vertical-align: middle;display: inline-block;width: 70%;overflow: hidden !important;box-sizing: border-box;"><img class="" data-ratio="0.115625" src="https://mmbiz.qpic.cn/mmbiz_png/b96CibCt70iaaYLV0bgNpicicsbF4YkGTMjqW9Q36dpIF4ICT42fjTzFWItciaBl2QpAgBER4VwwFubraMMtX9C3TrQ/640" data-type="png" data-w="640" style="vertical-align: middle;box-sizing: border-box;width: 100% !important;height: auto !important;visibility: visible !important;border-color: rgb(68, 153, 231);" width="100%"></section></section></section></section><p style="text-align:justify;text-justify:inter-ideograph;"><span style="color: rgb(51, 51, 51);letter-spacing: 0.5px;font-size: 17px;">纵横时间之长，驰骋股票之宽，领略信息之深，体会频率之快，如果能够获取下图这四维数据，再做不好量化策略就。。。等等，这帖不是打深度学习的基础吗，怎么扯到量化投资了？其实张量无处不在，因为数据无处不在，维度无处不在。</span></p><p style="white-space: normal;"><br></p><p style="white-space: normal;text-align: center;"><img class="" data-backh="474" data-backw="556" data-before-oversubscription-url="https://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCEnLOffKdMdfGkPCVwpIgPIHPJsantr5ZNE179JnBIKVl36SJPyiaRO0eiaibvdXAGicCO7Mth2pxjJJA/640?wx_fmt=png" data-copyright="0" data-ratio="0.8506271379703535" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCEnLOffKdMdfGkPCVwpIgPIHPJsantr5ZNE179JnBIKVl36SJPyiaRO0eiaibvdXAGicCO7Mth2pxjJJA/640?wx_fmt=png" data-type="png" data-w="877" style="text-align: center;white-space: normal;width: 90%;height: auto !important;"></p><p style="white-space: normal;"><br></p><section class="mpa-template" data-mpa-template-id="998729" data-mpa-color="null" data-mpa-category="收藏"><section style="background-color: rgb(250, 255, 250);border-width: 1px;border-style: solid;border-color: rgb(148, 209, 224);box-shadow: rgba(148, 209, 224, 0.5) 5px 5px 0px;padding: 10px;margin: 12px;line-height: 22px;font-size: 14px;color: rgb(113, 113, 113);text-align: justify;"><p style="margin:0;padding:0;">本来一开始是想讲张量求导 (tensor derivative) 和计算图 (computational graph) 的，但讲这个必须把张量要讲清楚吧。后来解释张量一发不可收拾写成了完整一贴。这贴把张量基础打牢，下贴继续张量求导和计算图。</p><p style="margin:0;padding:0;"><br></p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="0.57265625" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCGtX1AVEp0TIh07I3ibP80XVfc1CwSDPd4icLiaXhBjUAicw5VB5Ds00YapdjufSs2iaK76aibXFvCen7dw/640?wx_fmt=png" data-type="png" data-w="1280" style="width: 100%;height: auto;" data-backw="510" data-backh="293" data-before-oversubscription-url="https://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCGtX1AVEp0TIh07I3ibP80XVfc1CwSDPd4icLiaXhBjUAicw5VB5Ds00YapdjufSs2iaK76aibXFvCen7dw/640?wx_fmt=png"></p></section></section><p style="white-space: normal;"><br></p><p style="white-space: normal;"><span style="letter-spacing: 0.5px;">本帖目录如下：</span><br></p><section class="_135editor" data-tools="135编辑器" data-id="89132" data-color="rgb(33, 33, 34)" data-custom="rgb(33, 33, 34)" style="white-space: normal;line-height: 25.6px;border-width: 0px;border-style: none;border-color: initial;"><section class="layout" style="margin: 10px auto;padding: 5px;"><section style="padding-top: 20px;padding-right: 15px;padding-left: 15px;height: auto;border-top: 5px solid rgb(33, 33, 34);border-left: 5px solid rgb(33, 33, 34);border-right: 5px solid rgb(33, 33, 34);"><section data-width="100%" style="margin-top: -30px;width: 506px;height: 30px;"><section style="width: 100px;height: 30px;float: right;text-align: center;background: rgb(255, 255, 255);"><span style="font-size: 18px;color: rgb(171, 25, 66);"><strong>目录</strong></span></section></section><section class="135brush" style="color: rgb(112, 112, 112);font-size: 14px;"><p><span style="color: rgb(192, 0, 0);"><strong><span style="font-size: 16px;">第一章 - <span style="color: rgb(192, 0, 0);font-size: 16px;">线性代数的张量</span></span></strong></span></p><p><br></p><p><span style="color: rgb(192, 0, 0);"><strong><span style="font-size: 16px;">第二章 - <span style="color: rgb(192, 0, 0);font-size: 16px;">编程语言的张量</span></span></strong></span></p><p><br></p><p><span style="font-size: 16px;color: rgb(192, 0, 0);">    2.1 Python</span></p><p><span style="font-size: 16px;color: rgb(192, 0, 0);">    2.2 TensorFlow</span></p><p><span style="font-size: 16px;color: rgb(192, 0, 0);">    2.3 MXNet<br></span></p><p><span style="font-size: 16px;color: rgb(192, 0, 0);">    2.4 PyTorch<br></span></p><p><span style="font-size: 16px;color: rgb(192, 0, 0);">    2.5 Matlab<br></span></p><p><br></p><p><span style="color: rgb(192, 0, 0);"><strong><span style="font-size: 16px;">第三章 - <span style="color: rgb(192, 0, 0);font-size: 16px;">机器学习的张量</span></span></strong></span></p><p><br></p><p><span style="font-size: 16px;color: rgb(192, 0, 0);">    3.1 简介</span></p><p><span style="font-size: 16px;color: rgb(192, 0, 0);">    3.2 2D <span style="line-height: 25.6px;">数据表</span></span></p><p><span style="font-size: 16px;color: rgb(192, 0, 0);">    3.3 3D 序列数据</span></p><p><span style="font-size: 16px;color: rgb(192, 0, 0);">    3.4 4D 图像数据</span></p><p><span style="font-size: 16px;color: rgb(192, 0, 0);">    3.5 5D 视屏数据</span></p><p><br></p><p><strong style="color: rgb(192, 0, 0);font-size: 14px;white-space: normal;"><span style="font-size: 16px;">第四章 - 量化金融的张量</span></strong></p><p><br></p><p><span style="font-size: 16px;color: rgb(192, 0, 0);">    4.1 简介</span></p><p><span style="font-size: 16px;color: rgb(192, 0, 0);">    4.2 JoinQuant 之 A 股</span></p><p><span style="font-size: 16px;color: rgb(192, 0, 0);">    4.3 Quantopian 之美股</span><strong style="color: rgb(192, 0, 0);font-size: 14px;white-space: normal;"><span style="font-size: 16px;"><br></span></strong></p><p><strong style="color: rgb(192, 0, 0);font-size: 14px;white-space: normal;"><span style="font-size: 14px;"></span></strong></p><p><strong style="color: rgb(192, 0, 0);font-size: 14px;white-space: normal;"><span style="font-size: 16px;"><strong style="font-size: 14px;white-space: normal;color: rgb(192, 0, 0);"><span style="font-size: 16px;">第五章 - 张量运算</span></strong></span></strong></p><p><strong style="color: rgb(192, 0, 0);font-size: 14px;white-space: normal;"><strong style="font-size: 14px;white-space: normal;color: rgb(192, 0, 0);"><span style="font-size: 14px;"></span></strong></strong></p><p style="color: rgb(112, 112, 112);font-size: 14px;white-space: normal;"><span style="font-size: 16px;color: rgb(192, 0, 0);">    5.1 化繁为简</span></p><p style="color: rgb(112, 112, 112);font-size: 14px;white-space: normal;"><span style="font-size: 16px;color: rgb(192, 0, 0);">    5</span><span style="color: rgb(192, 0, 0);font-size: 16px;">.2 由简推繁</span></p><p style="color: rgb(112, 112, 112);font-size: 14px;white-space: normal;"><br></p><p><span style="color: rgb(192, 0, 0);"><strong><span style="font-size: 16px;">总结</span></strong></span></p><p><br></p></section></section><section data-width="100%" style="margin-top: -20px;width: 546px;border-left: 5px solid rgb(33, 33, 34);border-right: 5px solid rgb(33, 33, 34);"><img class="assistant" data-backh="214" data-backw="546" data-before-oversubscription-url="https://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCHBBK6P6aonVFiaChMsQqPh8wPhuFNic8iatKW94gQ0C44ibTZqYhibR0Rd8J4WRJIQU8UtJfDiaDhRDqng/640?wx_fmt=png" data-ratio="0.39215686274509803" src="https://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCHBBK6P6aonVFiaChMsQqPh8wPhuFNic8iatKW94gQ0C44ibTZqYhibR0Rd8J4WRJIQU8UtJfDiaDhRDqng/640?wx_fmt=png" data-type="png" data-w="1275" data-width="100%" style="width: 100%;display: block;height: auto;"></section></section></section><p style="white-space: normal;"><br></p><section class="mpa-template" data-mpa-template-id="882153" data-mpa-color="null" data-mpa-category="收藏" style="white-space: normal;"><section><section style="padding: 10px;"><section class="autonum" style="float: left;width: 40px;height: 40px;text-align: center;color: rgb(255, 255, 255);background-color: rgb(13, 12, 12);font-size: 24px;line-height: 40px;">1</section><section style="padding-right: 15px;padding-left: 15px;width: auto;display: inline-block;float: left;height: 40px;font-size: 18px;line-height: 35px;border-bottom: 2px solid rgb(13, 12, 12);border-top: 2px solid rgb(13, 12, 12);">线性代数的张量</section><section style='background-image: url("https://mmbiz.qpic.cn/mmbiz_png/fgnkxfGnnkSBJo13oUicPbCbqeTcIyiakNc2UGmnmA1qH7HExsicAyuzE3Foogxo1VmRNr68icYkKibV0wM7nqTIHng/640?wx_fmt=png");width: 18px;height: 40px;float: left;background-repeat: no-repeat;background-color: rgb(13, 12, 12);background-size: 100% 40px;'></section></section><section style="width: 556.25px;clear: both;"></section></section></section><p style="white-space: normal;"><br></p><p style="white-space: normal;">线性代数大家肯定学过标量、向量和矩阵，它们分别称为 0 维张量、1 维张量和 2 维张量，而高于 2 维的张量统称为 n 维张量 (n ≥ 3)。</p><p style="white-space: normal;"><br></p><p style="white-space: normal;text-align: center;"><img class="" data-backh="288" data-backw="474" data-before-oversubscription-url="http://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCEnLOffKdMdfGkPCVwpIgPIEicmwJYlEBklFSq6gxAjhR1ZeSuptjibCg1MCibgVwdczmm5ia9Zib3sSGA/0?wx_fmt=png" data-ratio="0.6067653276955602" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCEnLOffKdMdfGkPCVwpIgPIEicmwJYlEBklFSq6gxAjhR1ZeSuptjibCg1MCibgVwdczmm5ia9Zib3sSGA/640?wx_fmt=png" data-type="png" data-w="473" style="width: 556.25px;"></p><p style="white-space: normal;"><br></p><p style="white-space: normal;"><br></p><section class="mpa-template" data-mpa-template-id="882154" data-mpa-color="null" data-mpa-category="收藏"><section><section style="padding:10px 10px;"><section class="autonum" style="float: left;width: 40px;height: 40px;text-align: center;color: rgb(255, 255, 255);background-color: rgb(13, 12, 12);font-size: 24px;line-height: 40px;">2</section><section style="width: auto;display: inline-block;float: left;padding: 0px 15px;height: 40px;font-size: 18px;line-height: 35px;border-bottom: 2px solid rgb(13, 12, 12);border-top: 2px solid rgb(13, 12, 12);">编程语言的向量</section><section style='background-image: url("https://mmbiz.qpic.cn/mmbiz_png/fgnkxfGnnkSBJo13oUicPbCbqeTcIyiakNc2UGmnmA1qH7HExsicAyuzE3Foogxo1VmRNr68icYkKibV0wM7nqTIHng/640?wx_fmt=png");width: 18px;height: 40px;float: left;background-repeat: no-repeat;background-color: rgb(13, 12, 12);background-size: 100% 40px;'></section></section><section style="width:100%;clear:both;"></section></section></section><p style="white-space: normal;text-align: left;line-height: normal;background: white;"><span style="font-family: DengXian;color: black;"></span><br></p><p style="white-space: normal;"><span style="font-family: DengXian;">很多编程语言把张量当成数据的容器</span> (container)<span style="font-family: DengXian;">。在计算机中最终处理的都是数值型数据，因此张量大多指一个装着数值类变量的容器。接下来我们看看 </span>Python, TensorFlow, MXNet, PyTorch <span style="font-family: DengXian;">和 </span>Matlab <span style="font-family: DengXian;">里面的张量长什么样把。</span></p><p style="white-space: normal;"><strong><span style="color: rgb(192, 0, 0);"></span></strong><br></p><section class="mpa-template" data-mpa-template-id="882500" data-mpa-color="null" data-mpa-category="收藏"><section><section style="border-width: 0px;border-style: initial;border-color: initial;padding: 0px;margin: 0px auto;text-align: center;white-space: normal;"><section style='background-image:url("https://mmbiz.qpic.cn/mmbiz_png/ianq03UUWGmIDLYyVZsymkTnBibBPxwxoWuIkiaMRfF2nPrvryogjrO4XfhpWegMwicuiapXBQia8qeINYhefTtwGfrQ/640?wx_fmt=png");display:inline-block;margin:0 auto;text-align:left;background-size:auto 50px;background-repeat:no-repeat;width:42px;height:50px;vertical-align:top;line-height:50px;text-align:center;color:#fff;'><p style="font-size: 20px;border-width: 0px;border-style: initial;border-color: initial;padding: 0px;margin: 0px;"><span style="font-size: 16px;font-family: Optima-Regular, PingFangTC-light;">2.1</span></p></section><section style='background-image:url("https://mmbiz.qpic.cn/mmbiz_png/ianq03UUWGmIDLYyVZsymkTnBibBPxwxoWEnrBa7fuiccJgxAndh66NF0fKuTFduWXp2icIoXhBpibVePONwaJ3Jvzg/640?wx_fmt=png");display:inline-block;margin:0 auto;text-align:left;background-size:auto 50px;background-repeat:no-repeat;height:50px;'><section style="display:inline-block;padding-left:10px;line-height:50px;color:#333;margin-top:0;vertical-align:top;"><p style="font-size: 14px;border-width: 0px;border-style: initial;border-color: initial;padding: 0px;margin: 0px;"><span style="color: rgb(255, 41, 65);font-size: 16px;font-family: Optima-Regular, PingFangTC-light;"><strong mpa-from-tpl="t">Python</strong></span></p></section></section><section style='background-image:url("https://mmbiz.qpic.cn/mmbiz_png/ianq03UUWGmIDLYyVZsymkTnBibBPxwxoWzfenALo6kEeDUGXCyFibSibU24BtebdP2ialR438RwuG8TnZUIv9k8Ubg/640?wx_fmt=png");display:inline-block;margin:0 auto;text-align:left;background-size:auto 50px;background-repeat:no-repeat;width:17px;height:50px;vertical-align:top;'></section></section></section></section><p style="white-space: normal;text-align: center;"><br></p><p style="white-space: normal;"><span style="font-family: DengXian;">深度学习框架 </span>Keras <span style="font-family: DengXian;">就直接用 </span>Python <span style="font-family: DengXian;">的 </span>numpy <span style="font-family: DengXian;">的模块来使用张量的。上面也讲过，张量就是多维数组，不像 </span>Keras <span style="font-family: DengXian;">直接用 </span>Python <span style="font-family: DengXian;">的 </span>numpy<span style="font-family: DengXian;">，其他深度学习框架对张量或多维数组稍微做了些改变，比如：</span></p><p style="white-space: normal;"><span style="font-family: DengXian;color: black;"></span><br></p><ul class=" list-paddingleft-2" style="list-style-type: square;"><li><p><span style="color: black;">Tensorflow </span><span style="font-family: DengXian;color: black;">里用 </span><span style="color: black;">tf.Tensor</span></p></li><li><p><span style="color: black;">MXNet </span><span style="font-family: DengXian;color: black;">里用 </span><span style="color: black;">ndarray</span></p></li><li><p><span style="color: black;">PyTorch </span><span style="font-family: DengXian;color: black;">里用 </span><span style="color: black;">torch.tensor</span></p></li></ul><p style="white-space: normal;"><br></p><p><span style="font-family:DengXian;">首先从 </span>Python <span style="font-family:DengXian;">里面导入 </span>numpy <span style="font-family:DengXian;">模块。这里的 </span>np <span style="font-family:DengXian;">是 </span>numpy <span style="font-family:DengXian;">的缩写形式。</span></p><p style="white-space: normal;"><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t" style="white-space: normal;"><pre style="margin-top: 0px;margin-bottom: 0px;padding: 0px;background-image: none;background-color: initial;"><code class="hljs-sublime" style="margin-right: 0.15em;margin-left: 0.15em;padding: 5.95px;border-radius: 4px;font-size: 0.85em;background: rgb(35, 36, 31);color: rgb(248, 248, 242);display: block;overflow-x: auto;white-space: nowrap;"><span class="hljs-sublime-keyword" style="color: rgb(249, 38, 114);background: rgba(0, 0, 0, 0);display: inline;width: 40px;text-decoration-style: solid;text-decoration-color: rgb(249, 38, 114);">import</span> numpy <span class="hljs-sublime-keyword" style="color: rgb(249, 38, 114);background: rgba(0, 0, 0, 0);display: inline;width: 14px;text-decoration-style: solid;text-decoration-color: rgb(249, 38, 114);">as</span> np</code></pre></section><p style="white-space: normal;"><br></p><p style="white-space: normal;"><span style="font-family: DengXian;">下面是用 </span>Python <span style="font-family: DengXian;">的 </span>numpy <span style="font-family: DengXian;">来定义 </span>0 <span style="font-family: DengXian;">到 </span>4 <span style="font-family: DengXian;">维的张量。</span></p><p style="white-space: normal;"><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t" style="white-space: normal;"><pre style="margin-top: 0px;margin-bottom: 0px;padding: 0px;background-image: none;background-color: initial;"><code class="hljs-sublime" style="margin-right: 0.15em;margin-left: 0.15em;padding: 5.95px;border-radius: 4px;font-size: 0.85em;background: rgb(35, 36, 31);color: rgb(248, 248, 242);display: block;overflow-x: auto;white-space: nowrap;"><span class="hljs-sublime-comment" style="color: rgb(117, 113, 94);background: rgba(0, 0, 0, 0);display: inline;width: 55px;text-decoration-style: solid;text-decoration-color: rgb(117, 113, 94);"># 0维张量</span><br>X0 = np.array(<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 14px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">42</span>)<br><br><span class="hljs-sublime-comment" style="color: rgb(117, 113, 94);background: rgba(0, 0, 0, 0);display: inline;width: 108px;text-decoration-style: solid;text-decoration-color: rgb(117, 113, 94);"># 1维张量        </span><br>X1 = np.array( [<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">1</span> <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">2</span>] )<br><br><span class="hljs-sublime-comment" style="color: rgb(117, 113, 94);background: rgba(0, 0, 0, 0);display: inline;width: 81px;text-decoration-style: solid;text-decoration-color: rgb(117, 113, 94);"># 2维张量    </span><br>X2 = np.array( [<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">1</span> <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">2</span>], [<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">3</span> <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">4</span>] )<br><br><span class="hljs-sublime-comment" style="color: rgb(117, 113, 94);background: rgba(0, 0, 0, 0);display: inline;width: 69px;text-decoration-style: solid;text-decoration-color: rgb(117, 113, 94);"># 3维张量  </span><br>X3 = np.array([[[<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">1</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">4</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">7</span>], [<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">2</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">5</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">8</span>], [<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">3</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">6</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">9</span>]],<br>              [[<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">1</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">2</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">3</span>], [<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">4</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">5</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">6</span>], [<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">7</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">8</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">9</span>]],<br>              [[<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">9</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">8</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">7</span>], [<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">6</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">5</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">4</span>], [<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">3</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">2</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">1</span>]]])  <br><br><span class="hljs-sublime-comment" style="color: rgb(117, 113, 94);background: rgba(0, 0, 0, 0);display: inline;width: 55px;text-decoration-style: solid;text-decoration-color: rgb(117, 113, 94);"># 4维张量</span><br>X4 = np.ones( (<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 33px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">60000</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 14px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">28</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 14px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">28</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">3</span>) )</code></pre></section><p style="white-space: normal;"><br></p><p style="white-space: normal;"><span style="font-family: DengXian;">不难看出</span></p><p style="white-space: normal;"><br></p><ul class=" list-paddingleft-2" style=""><li><p>X0, X1, X2, X3 <span style="font-family: DengXian;">都是用 </span>np.array <span style="font-family: DengXian;">直接设定张量里的元素来定义张量</span></p></li><li><p>X4 <span style="font-family: DengXian;">用 </span>np.ones <span style="font-family: DengXian;">和张量的形状 </span>(60000,28, 28, 3) <span style="font-family: DengXian;">来定义一个所有元素都是 </span>1 <span style="font-family: DengXian;">的张量</span></p></li></ul><p style="white-space: normal;"><br></p><section class="mpa-template" data-mpa-template-id="882500" data-mpa-color="null" data-mpa-category="收藏"><section><section style="border-width: 0px;border-style: initial;border-color: initial;padding: 0px;margin: 0px auto;text-align: center;white-space: normal;"><section style='background-image:url("https://mmbiz.qpic.cn/mmbiz_png/ianq03UUWGmIDLYyVZsymkTnBibBPxwxoWuIkiaMRfF2nPrvryogjrO4XfhpWegMwicuiapXBQia8qeINYhefTtwGfrQ/640?wx_fmt=png");display:inline-block;margin:0 auto;text-align:left;background-size:auto 50px;background-repeat:no-repeat;width:42px;height:50px;vertical-align:top;line-height:50px;text-align:center;color:#fff;'><p style="font-size: 20px;border-width: 0px;border-style: initial;border-color: initial;padding: 0px;margin: 0px;"><span style="font-size: 16px;font-family: Optima-Regular, PingFangTC-light;">2.2</span></p></section><section style='background-image:url("https://mmbiz.qpic.cn/mmbiz_png/ianq03UUWGmIDLYyVZsymkTnBibBPxwxoWEnrBa7fuiccJgxAndh66NF0fKuTFduWXp2icIoXhBpibVePONwaJ3Jvzg/640?wx_fmt=png");display:inline-block;margin:0 auto;text-align:left;background-size:auto 50px;background-repeat:no-repeat;height:50px;'><section style="display: inline-block;padding-left: 10px;line-height: 50px;color: rgb(51, 51, 51);margin-top: 0px;vertical-align: top;"><p style="font-size: 14px;border-width: 0px;border-style: initial;border-color: initial;padding: 0px;margin: 0px;"><span style="color: rgb(255, 41, 65);font-size: 16px;font-family: Optima-Regular, PingFangTC-light;"><strong mpa-from-tpl="t">TensorFlow</strong></span></p></section></section><section style='background-image:url("https://mmbiz.qpic.cn/mmbiz_png/ianq03UUWGmIDLYyVZsymkTnBibBPxwxoWzfenALo6kEeDUGXCyFibSibU24BtebdP2ialR438RwuG8TnZUIv9k8Ubg/640?wx_fmt=png");display:inline-block;margin:0 auto;text-align:left;background-size:auto 50px;background-repeat:no-repeat;width:17px;height:50px;vertical-align:top;'></section></section></section></section><p style="white-space: normal;text-align: center;"><br></p><p style="white-space: normal;"><span style="font-family: DengXian;">顾名思义，</span>TensorFlow <span style="font-family: DengXian;">建立了计算图，让张量 </span>(tensor) <span style="font-family: DengXian;">从中流动 </span>(flow)<span style="font-family: DengXian;">，因此取名 </span>TensorFlow<span style="font-family: DengXian;">。首先从 </span>tensorflow <span style="font-family: DengXian;">里面导入 </span>tf.Tensor <span style="font-family: DengXian;">模块。这里的 </span>tf <span style="font-family: DengXian;">是 </span>tensorflow <span style="font-family: DengXian;">的缩写形式。</span></p><p style="white-space: normal;"><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t" style="white-space: normal;"><pre style="margin-top: 0px;margin-bottom: 0px;padding: 0px;background-image: none;background-color: initial;"><code class="hljs-sublime" style="margin-right: 0.15em;margin-left: 0.15em;padding: 5.95px;border-radius: 4px;font-size: 0.85em;background: rgb(35, 36, 31);color: rgb(248, 248, 242);display: block;overflow-x: auto;white-space: nowrap;"><span class="hljs-sublime-keyword" style="color: rgb(249, 38, 114);background: rgba(0, 0, 0, 0);display: inline;width: 40px;text-decoration-style: solid;text-decoration-color: rgb(249, 38, 114);">import</span> tensorflow <span class="hljs-sublime-keyword" style="color: rgb(249, 38, 114);background: rgba(0, 0, 0, 0);display: inline;width: 14px;text-decoration-style: solid;text-decoration-color: rgb(249, 38, 114);">as</span> tf</code></pre></section><p style="white-space: normal;"><br></p><p style="white-space: normal;"><span style="color: windowtext;">tf.Tensor</span> <span style="font-family: DengXian;">由以下两个特征定义：</span></p><p style="white-space: normal;"> </p><ol class=" list-paddingleft-2" style=""><li><p><span style="font-family: DengXian;">数据类型 </span>(data type)<span style="font-family: DengXian;">，包括整数、浮点数和字符等</span></p></li><li><p><span style="font-family: DengXian;">形状 </span>(shape)</p></li></ol><p style="white-space: normal;"><br></p><p style="white-space: normal;">Tensor 中的每个元素都具有相同而其已知的数据类型，形状是张量的每个维度 (TensorFlow 称 rank) 上的元素个数，而且可能只是部分已知。比如一张彩色照片由宽 28，高 28，3 色道的元素组成，那么该三维照片数据的形状 (完全可知) 可写成</p><p style="white-space: normal;"><br></p><p style="white-space: normal;"><span style="text-indent: 0.5in;">    [28, 28, 3]</span></p><p style="white-space: normal;"><br></p><p style="white-space: normal;"><span style="font-family: DengXian;">将照片当做神经网络的输入时，有时候我们不清楚有多少张照片，因此整个四维照片数据集的形状 </span>(<span style="font-family: DengXian;">部分已知</span>) <span style="font-family: DengXian;">可写成</span></p><p style="white-space: normal;"><br></p><p style="white-space: normal;"><span style="text-indent: 0.5in;">    [None, 28, 28, 3]</span></p><p style="white-space: normal;"><br></p><p style="white-space: normal;"><span style="font-family: DengXian;">其中 </span>None <span style="font-family: DengXian;">指照片数目未知。</span></p><p style="white-space: normal;"><br></p><p style="white-space: normal;">TensorFlow 官网这样解释 rank 和 shape 的。</p><p style="white-space: normal;"><br></p><p style="white-space: normal;text-align: center;"><img class="" data-backh="195" data-backw="461" data-before-oversubscription-url="http://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCEnLOffKdMdfGkPCVwpIgPI6wKq8zic9qexWaObRpOqUiaicQicjd9HOgSo4WTaicDElWb2bfRXS9k2Xicg/0?wx_fmt=png" data-ratio="0.4229934924078091" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCEnLOffKdMdfGkPCVwpIgPI6wKq8zic9qexWaObRpOqUiaicQicjd9HOgSo4WTaicDElWb2bfRXS9k2Xicg/640?wx_fmt=png" data-type="png" data-w="461" style="width: 556.25px;"></p><p style="white-space: normal;"><br></p><p style="white-space: normal;">tf.Tensor 还可再细分成 tf.Variable, tf.constant 和 tf.placeholder 等，它们意思一眼可知，分别代表变量、常量和占位符的意思。下面是用 tf.Variable 来定义 0 到 4 维的张量。</p><p style="white-space: normal;"><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t" style="white-space: normal;"><pre style="margin-top: 0px;margin-bottom: 0px;padding: 0px;background-image: none;background-color: initial;"><code class="hljs-sublime" style="margin-right: 0.15em;margin-left: 0.15em;padding: 5.95px;border-radius: 4px;font-size: 0.85em;background: rgb(35, 36, 31);color: rgb(248, 248, 242);display: block;overflow-x: auto;white-space: nowrap;"><span class="hljs-sublime-comment" style="color: rgb(117, 113, 94);background: rgba(0, 0, 0, 0);display: inline;width: 55px;text-decoration-style: solid;text-decoration-color: rgb(117, 113, 94);"># 0维张量</span><br>X0 = tf.Variable( <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 26px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">1031</span>, tf.int16 )<br><br><span class="hljs-sublime-comment" style="color: rgb(117, 113, 94);background: rgba(0, 0, 0, 0);display: inline;width: 55px;text-decoration-style: solid;text-decoration-color: rgb(117, 113, 94);"># 1维张量</span><br>X1 = tf.Variable( [<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 45px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">3.14159</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 45px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">2.71828</span>], tf.float32 )<br><br><span class="hljs-sublime-comment" style="color: rgb(117, 113, 94);background: rgba(0, 0, 0, 0);display: inline;width: 55px;text-decoration-style: solid;text-decoration-color: rgb(117, 113, 94);"># 2维张量</span><br>X2 = tf.Variable( [ [<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">4</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">9</span>], [<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">16</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">25</span>] ], tf.int32 )<br><br><span class="hljs-sublime-comment" style="color: rgb(117, 113, 94);background: rgba(0, 0, 0, 0);display: inline;width: 55px;text-decoration-style: solid;text-decoration-color: rgb(117, 113, 94);"># 3维张量</span><br>X3 = tf.ones( [<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 33px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">60000</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 14px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">28</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 14px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">28</span>] )<br><br><span class="hljs-sublime-comment" style="color: rgb(117, 113, 94);background: rgba(0, 0, 0, 0);display: inline;width: 55px;text-decoration-style: solid;text-decoration-color: rgb(117, 113, 94);"># 4维张量</span><br>X4 = tf.zeros( [<span class="hljs-sublime-keyword" style="color: rgb(249, 38, 114);background: rgba(0, 0, 0, 0);display: inline;width: 26px;text-decoration-style: solid;text-decoration-color: rgb(249, 38, 114);">None</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 14px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">28</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 14px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">28</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">3</span>] )</code></pre></section><p style="white-space: normal;"><br></p><p style="white-space: normal;">不难看出</p><p style="white-space: normal;"><br></p><ul class=" list-paddingleft-2" style=""><li><p>上面 X0, X1, X2 都是用 tf. Variable 直接设定张量里的元素来定义张量</p></li><li><p>X3 用 tf.ones 和张量的形状 (60000, 28, 28) 来定义一个所有元素都是 1 的张量</p></li><li><p>X4 用 tf.zeros 和张量的形状 (None, 28, 28, 3) 来定义一个所有元素都是 0 的张量。</p></li></ul><p style="white-space: normal;"><br></p><p style="white-space: normal;">X3 <span style="font-family: DengXian;">像不像一个数目已知的<strong><span style="color: white;background: black;">黑白</span></strong>照片的数据集？</span>X4 <span style="font-family: DengXian;">像不像一个数目未知的</span><span style="font-family: DengXian;color: rgb(255, 255, 255);"><strong><span style="background: red;">彩</span></strong><strong><span style="background: blue;">色</span></strong></span><span style="font-family: DengXian;">照片的数据集？</span></p><p style="white-space: normal;"><span style="font-family: DengXian;"><br></span></p><section class="mpa-template" data-mpa-template-id="882500" data-mpa-color="null" data-mpa-category="收藏"><section><section style="border-width: 0px;border-style: initial;border-color: initial;padding: 0px;margin: 0px auto;text-align: center;white-space: normal;"><section style='background-image:url("https://mmbiz.qpic.cn/mmbiz_png/ianq03UUWGmIDLYyVZsymkTnBibBPxwxoWuIkiaMRfF2nPrvryogjrO4XfhpWegMwicuiapXBQia8qeINYhefTtwGfrQ/640?wx_fmt=png");display:inline-block;margin:0 auto;text-align:left;background-size:auto 50px;background-repeat:no-repeat;width:42px;height:50px;vertical-align:top;line-height:50px;text-align:center;color:#fff;'><p style="font-size: 20px;border-width: 0px;border-style: initial;border-color: initial;padding: 0px;margin: 0px;"><span style="font-size: 16px;font-family: Optima-Regular, PingFangTC-light;">2.3</span></p></section><section style='background-image:url("https://mmbiz.qpic.cn/mmbiz_png/ianq03UUWGmIDLYyVZsymkTnBibBPxwxoWEnrBa7fuiccJgxAndh66NF0fKuTFduWXp2icIoXhBpibVePONwaJ3Jvzg/640?wx_fmt=png");display:inline-block;margin:0 auto;text-align:left;background-size:auto 50px;background-repeat:no-repeat;height:50px;'><section style="display:inline-block;padding-left:10px;line-height:50px;color:#333;margin-top:0;vertical-align:top;"><p style="font-size: 14px;border-width: 0px;border-style: initial;border-color: initial;padding: 0px;margin: 0px;"><span style="color: rgb(255, 41, 65);font-size: 16px;font-family: Optima-Regular, PingFangTC-light;"><strong mpa-from-tpl="t">MXNet</strong></span></p></section></section><section style='background-image:url("https://mmbiz.qpic.cn/mmbiz_png/ianq03UUWGmIDLYyVZsymkTnBibBPxwxoWzfenALo6kEeDUGXCyFibSibU24BtebdP2ialR438RwuG8TnZUIv9k8Ubg/640?wx_fmt=png");display:inline-block;margin:0 auto;text-align:left;background-size:auto 50px;background-repeat:no-repeat;width:17px;height:50px;vertical-align:top;'></section></section></section></section><p style="white-space: normal;text-align: center;"><br></p><p style="white-space: normal;"><span style="font-family: DengXian;color: black;">首先从 </span><span style="color: black;">mxnet </span><span style="font-family: DengXian;color: black;">导</span><span style="color: black;">⼊ ndarray </span><span style="font-family: DengXian;color: black;">模块。这里的 </span><span style="color: black;">nd </span><span style="font-family: DengXian;color: black;">是 </span><span style="color: black;">ndarray </span><span style="font-family: DengXian;color: black;">的缩写形式。</span></p><p style="white-space: normal;"><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t" style="white-space: normal;"><pre style="margin-top: 0px;margin-bottom: 0px;padding: 0px;background-image: none;background-color: initial;"><code class="hljs-sublime" style="margin-right: 0.15em;margin-left: 0.15em;padding: 5.95px;border-radius: 4px;font-size: 0.85em;background: rgb(35, 36, 31);color: rgb(248, 248, 242);display: block;overflow-x: auto;white-space: nowrap;"><span class="hljs-sublime-keyword" style="color: rgb(249, 38, 114);background: rgba(0, 0, 0, 0);display: inline;width: 26px;text-decoration-style: solid;text-decoration-color: rgb(249, 38, 114);">from</span> mxnet <span class="hljs-sublime-keyword" style="color: rgb(249, 38, 114);background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration-style: solid;text-decoration-color: rgb(249, 38, 114);">import</span> nd</code></pre></section><p style="white-space: normal;"><br></p><p style="white-space: normal;"><span style="font-family: DengXian;">下面是用 </span>mxnet <span style="font-family: DengXian;">的 </span>ndarray <span style="font-family: DengXian;">来定义 </span>0 <span style="font-family: DengXian;">到 </span>4 <span style="font-family: DengXian;">维的张量。</span></p><p style="white-space: normal;"><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t" style="white-space: normal;"><pre style="margin-top: 0px;margin-bottom: 0px;padding: 0px;background-image: none;background-color: initial;"><code class="hljs-sublime" style="margin-right: 0.15em;margin-left: 0.15em;padding: 5.95px;border-radius: 4px;font-size: 0.85em;background: rgb(35, 36, 31);color: rgb(248, 248, 242);display: block;overflow-x: auto;white-space: nowrap;"><span class="hljs-sublime-comment" style="color: rgb(117, 113, 94);background: rgba(0, 0, 0, 0);display: inline;width: 55px;text-decoration-style: solid;text-decoration-color: rgb(117, 113, 94);"># 0维张量</span><br>X0 = <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">5</span><br><br><span class="hljs-sublime-comment" style="color: rgb(117, 113, 94);background: rgba(0, 0, 0, 0);display: inline;width: 55px;text-decoration-style: solid;text-decoration-color: rgb(117, 113, 94);"># 1维张量</span><br>X1 = nd.arange(<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">12</span>)<br><br><span class="hljs-sublime-comment" style="color: rgb(117, 113, 94);background: rgba(0, 0, 0, 0);display: inline;width: 55px;text-decoration-style: solid;text-decoration-color: rgb(117, 113, 94);"># 2维张量</span><br>X2 = X1.reshape( (<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">3</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">4</span>) )<br><br><span class="hljs-sublime-comment" style="color: rgb(117, 113, 94);background: rgba(0, 0, 0, 0);display: inline;width: 55px;text-decoration-style: solid;text-decoration-color: rgb(117, 113, 94);"># 3维张量</span><br>X3 = nd.random.normal( <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">0</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">1</span>, shape=(<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">3</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">4</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">5</span>) )<br><br><span class="hljs-sublime-comment" style="color: rgb(117, 113, 94);background: rgba(0, 0, 0, 0);display: inline;width: 55px;text-decoration-style: solid;text-decoration-color: rgb(117, 113, 94);"># 4维张量</span><br>X4 = nd.zeros( (<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 33px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">10000</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 14px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">28</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 14px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">28</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">3</span>) )</code></pre></section><p style="white-space: normal;"><br></p><p style="white-space: normal;"><span style="font-family: DengXian;">不难看出</span></p><p style="white-space: normal;"> </p><ul class=" list-paddingleft-2" style=""><li><p>X0, X1 <span style="font-family: DengXian;">都是用 </span>nd <span style="font-family: DengXian;box-sizing: border-box !important;">直接设定张量里的元素来定义张量</span></p></li><li><p>X2 <span style="font-family: DengXian;">将一维张量 </span>X1 <span style="font-family: DengXian;">重新排成 </span>3×4 <span style="font-family: DengXian;">的二维张量</span></p></li><li><p>X3 <span style="font-family: DengXian;">用 </span>nd.random.normal <span style="font-family: DengXian;">和张量的形状 </span>(3, 4, 5) <span style="font-family: DengXian;">来定义一个高斯随机张量</span></p></li><li><p>X4 <span style="font-family: DengXian;">用 </span>nd.zeros <span style="font-family: DengXian;">和张量的形状 </span>(10000, 28, 28, 3) <span style="font-family: DengXian;">来定义一个所有元素都是 </span>1 <span style="font-family: DengXian;">的张量</span></p></li></ul><p style="white-space: normal;text-align: center;"><br></p><section class="mpa-template" data-mpa-template-id="882500" data-mpa-color="null" data-mpa-category="收藏"><section><section style="border-width: 0px;border-style: initial;border-color: initial;padding: 0px;margin: 0px auto;text-align: center;white-space: normal;"><section style='background-image:url("https://mmbiz.qpic.cn/mmbiz_png/ianq03UUWGmIDLYyVZsymkTnBibBPxwxoWuIkiaMRfF2nPrvryogjrO4XfhpWegMwicuiapXBQia8qeINYhefTtwGfrQ/640?wx_fmt=png");display:inline-block;margin:0 auto;text-align:left;background-size:auto 50px;background-repeat:no-repeat;width:42px;height:50px;vertical-align:top;line-height:50px;text-align:center;color:#fff;'><p style="font-size: 20px;border-width: 0px;border-style: initial;border-color: initial;padding: 0px;margin: 0px;"><span style="font-size: 16px;font-family: Optima-Regular, PingFangTC-light;">2.4</span></p></section><section style='background-image:url("https://mmbiz.qpic.cn/mmbiz_png/ianq03UUWGmIDLYyVZsymkTnBibBPxwxoWEnrBa7fuiccJgxAndh66NF0fKuTFduWXp2icIoXhBpibVePONwaJ3Jvzg/640?wx_fmt=png");display:inline-block;margin:0 auto;text-align:left;background-size:auto 50px;background-repeat:no-repeat;height:50px;'><section style="display:inline-block;padding-left:10px;line-height:50px;color:#333;margin-top:0;vertical-align:top;"><p style="font-size: 14px;border-width: 0px;border-style: initial;border-color: initial;padding: 0px;margin: 0px;"><span style="color: rgb(255, 41, 65);font-size: 16px;font-family: Optima-Regular, PingFangTC-light;"><strong mpa-from-tpl="t">PyTorch</strong></span></p></section></section><section style='background-image:url("https://mmbiz.qpic.cn/mmbiz_png/ianq03UUWGmIDLYyVZsymkTnBibBPxwxoWzfenALo6kEeDUGXCyFibSibU24BtebdP2ialR438RwuG8TnZUIv9k8Ubg/640?wx_fmt=png");display:inline-block;margin:0 auto;text-align:left;background-size:auto 50px;background-repeat:no-repeat;width:17px;height:50px;vertical-align:top;'></section></section></section></section><p style="white-space: normal;text-align: center;"><strong><span style="color: rgb(192, 0, 0);"> </span></strong><br></p><p style="white-space: normal;"><span style="font-family: DengXian;color: black;">首先从 </span><span style="color: black;">PyTorch </span><span style="font-family: DengXian;color: black;">导</span><span style="color: black;">⼊ torch </span><span style="font-family: DengXian;color: black;">模块。</span></p><p style="white-space: normal;"><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t" style="white-space: normal;"><pre style="margin-top: 0px;margin-bottom: 0px;padding: 0px;background-image: none;background-color: initial;"><code class="hljs-sublime" style="margin-right: 0.15em;margin-left: 0.15em;padding: 5.95px;border-radius: 4px;font-size: 0.85em;background: rgb(35, 36, 31);color: rgb(248, 248, 242);display: block;overflow-x: auto;white-space: nowrap;"><span class="hljs-sublime-keyword" style="color: rgb(249, 38, 114);background: rgba(0, 0, 0, 0);display: inline;width: 40px;text-decoration-style: solid;text-decoration-color: rgb(249, 38, 114);">import</span> torch</code></pre></section><p style="white-space: normal;"><br></p><p style="white-space: normal;"><span style="font-family: DengXian;">下面是用 </span><span style="color: black;">PyTorch </span><span style="font-family: DengXian;">的 </span><span style="color: black;">torch </span><span style="font-family: DengXian;">来定义 </span>0 <span style="font-family: DengXian;">到 </span>4 <span style="font-family: DengXian;">维的张量。</span></p><p style="white-space: normal;"><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t" style="white-space: normal;"><pre style="margin-top: 0px;margin-bottom: 0px;padding: 0px;background-image: none;background-color: initial;"><code class="hljs-sublime" style="margin-right: 0.15em;margin-left: 0.15em;padding: 5.95px;border-radius: 4px;font-size: 0.85em;background: rgb(35, 36, 31);color: rgb(248, 248, 242);display: block;overflow-x: auto;white-space: nowrap;"><span class="hljs-sublime-comment" style="color: rgb(117, 113, 94);background: rgba(0, 0, 0, 0);display: inline;width: 55px;text-decoration-style: solid;text-decoration-color: rgb(117, 113, 94);"># 0维张量</span><br>X0 = torch.tensor(<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">3</span>)<br><br><span class="hljs-sublime-comment" style="color: rgb(117, 113, 94);background: rgba(0, 0, 0, 0);display: inline;width: 55px;text-decoration-style: solid;text-decoration-color: rgb(117, 113, 94);"># 1维张量</span><br>X1 = torch.tensor([<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">9</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 14px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">-9</span>])<br><br><span class="hljs-sublime-comment" style="color: rgb(117, 113, 94);background: rgba(0, 0, 0, 0);display: inline;width: 55px;text-decoration-style: solid;text-decoration-color: rgb(117, 113, 94);"># 2维张量</span><br>X2 = torch.rand(<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">5</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">5</span>)<br><br><span class="hljs-sublime-comment" style="color: rgb(117, 113, 94);background: rgba(0, 0, 0, 0);display: inline;width: 55px;text-decoration-style: solid;text-decoration-color: rgb(117, 113, 94);"># 3维张量</span><br>X3 = torch.tensor([[[<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">3</span>]]])<br><br><span class="hljs-sublime-comment" style="color: rgb(117, 113, 94);background: rgba(0, 0, 0, 0);display: inline;width: 55px;text-decoration-style: solid;text-decoration-color: rgb(117, 113, 94);"># 4维张量</span><br>X4 = torch.tensor.new_ones((<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 33px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">60000</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 14px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">28</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 14px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">28</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration-style: solid;text-decoration-color: rgb(174, 129, 255);">3</span>))</code></pre></section><p style="white-space: normal;"><br></p><p style="white-space: normal;"><span style="font-family: DengXian;">不难看出</span></p><p style="white-space: normal;"><br></p><ul class=" list-paddingleft-2" style=""><li><p>X0, X1, X3 <span style="font-family: DengXian;">都是用 </span>torch.tensor <span style="font-family: DengXian;">直接设定张量里的元素来定义张量</span></p></li><li><p>X2 <span style="font-family: DengXian;">用 </span>torch.rand <span style="font-family: DengXian;">和张量的形状 </span>(5, 5) <span style="font-family: DengXian;">来定义一个随机张量</span></p></li><li><p>X4 <span style="font-family: DengXian;">用 </span>new_ones <span style="font-family: DengXian;">和张量的形状 </span>(60000, 28, 28, 3) <span style="font-family: DengXian;">来定义一个所有元素都是 </span>1 <span style="font-family: DengXian;">的张量</span></p></li></ul><p style="white-space: normal;"><br></p><section class="mpa-template" data-mpa-template-id="882500" data-mpa-color="null" data-mpa-category="收藏"><section><section style="border-width: 0px;border-style: initial;border-color: initial;padding: 0px;margin: 0px auto;text-align: center;white-space: normal;"><section style='background-image:url("https://mmbiz.qpic.cn/mmbiz_png/ianq03UUWGmIDLYyVZsymkTnBibBPxwxoWuIkiaMRfF2nPrvryogjrO4XfhpWegMwicuiapXBQia8qeINYhefTtwGfrQ/640?wx_fmt=png");display:inline-block;margin:0 auto;text-align:left;background-size:auto 50px;background-repeat:no-repeat;width:42px;height:50px;vertical-align:top;line-height:50px;text-align:center;color:#fff;'><p style="font-size: 20px;border-width: 0px;border-style: initial;border-color: initial;padding: 0px;margin: 0px;"><span style="font-size: 16px;font-family: Optima-Regular, PingFangTC-light;">2.5</span></p></section><section style='background-image:url("https://mmbiz.qpic.cn/mmbiz_png/ianq03UUWGmIDLYyVZsymkTnBibBPxwxoWEnrBa7fuiccJgxAndh66NF0fKuTFduWXp2icIoXhBpibVePONwaJ3Jvzg/640?wx_fmt=png");display:inline-block;margin:0 auto;text-align:left;background-size:auto 50px;background-repeat:no-repeat;height:50px;'><section style="display:inline-block;padding-left:10px;line-height:50px;color:#333;margin-top:0;vertical-align:top;"><p style="font-size: 14px;border-width: 0px;border-style: initial;border-color: initial;padding: 0px;margin: 0px;"><span style="color: rgb(255, 41, 65);font-size: 16px;font-family: Optima-Regular, PingFangTC-light;"><strong mpa-from-tpl="t">Matlab</strong></span></p></section></section><section style='background-image:url("https://mmbiz.qpic.cn/mmbiz_png/ianq03UUWGmIDLYyVZsymkTnBibBPxwxoWzfenALo6kEeDUGXCyFibSibU24BtebdP2ialR438RwuG8TnZUIv9k8Ubg/640?wx_fmt=png");display:inline-block;margin:0 auto;text-align:left;background-size:auto 50px;background-repeat:no-repeat;width:17px;height:50px;vertical-align:top;'></section></section></section></section><p style="white-space: normal;text-align: center;"><br></p><p style="white-space: normal;"><span style="font-family: DengXian;">下面是用 </span><span style="color: black;">Matlab </span><span style="font-family: DengXian;">来定义 </span>0 <span style="font-family: DengXian;">到 </span>4 <span style="font-family: DengXian;">维的张量。</span></p><p style="white-space: normal;"><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t" style="white-space: normal;"><pre style="margin-top: 0px;margin-bottom: 0px;padding: 0px;background-image: none;background-color: initial;"><code class="hljs-sublime" style="margin-right: 0.15em;margin-left: 0.15em;padding: 5.95px;border-radius: 4px;font-size: 0.85em;background: rgb(35, 36, 31);color: rgb(248, 248, 242);display: block;overflow-x: auto;white-space: nowrap;">% 0 维数组<br>X0 = 2;<br><br>% 1 维数组<br>X1 = [1 2; 3 4];<br><br>% 2 维数组<br>X2 = [1 2 3; 4 5 6; 7 8 9];<br><br>% 3 维数组<br>X3 = cat( 3, X2, [3 2 1; 0 9 8; 5 3 7] );<br><br>% 4 维数组<br>X4 = repmat( 5,[2 3 1 4] );</code></pre></section><p style="white-space: normal;"><br></p><p style="white-space: normal;"><span style="font-family: DengXian;">不难看出</span></p><p style="white-space: normal;"><br></p><ul class=" list-paddingleft-2" style=""><li><p>X0, X1, X2 <span style="font-family: DengXian;">都是用方括号 “</span>[]<span style="font-family: DengXian;">”</span> <span style="font-family: DengXian;">直接设定张量里的元素来定义张量</span></p></li><li><p>X3 <span style="font-family: DengXian;">用 </span>cat <span style="font-family: DengXian;">把 </span>X2 (3×3) <span style="font-family: DengXian;">和另一个 </span>3×3 <span style="font-family: DengXian;">按张量按第 </span>3 <span style="font-family: DengXian;">维度上拼接起来</span></p></li><li><p>X4 <span style="font-family: DengXian;">用 </span>repmat <span style="font-family: DengXian;">把元素 </span>5 <span style="font-family: DengXian;">复制一个形状为 </span>[2, 3, 1, 4] <span style="font-family: DengXian;">的张量</span></p></li></ul><p style="white-space: normal;"><br></p><p style="white-space: normal;"><br></p><section class="mpa-template" data-mpa-template-id="882155" data-mpa-color="null" data-mpa-category="收藏"><section><section style="padding:10px 10px;"><section class="autonum" style="float: left;width: 40px;height: 40px;text-align: center;color: rgb(255, 255, 255);background-color: rgb(13, 12, 12);font-size: 24px;line-height: 40px;">3</section><section style="width: auto;display: inline-block;float: left;padding: 0px 15px;height: 40px;font-size: 18px;line-height: 35px;border-bottom: 2px solid rgb(13, 12, 12);border-top: 2px solid rgb(13, 12, 12);">机器学习的张量</section><section style='background-image: url("https://mmbiz.qpic.cn/mmbiz_png/fgnkxfGnnkSBJo13oUicPbCbqeTcIyiakNc2UGmnmA1qH7HExsicAyuzE3Foogxo1VmRNr68icYkKibV0wM7nqTIHng/640?wx_fmt=png");width: 18px;height: 40px;float: left;background-repeat: no-repeat;background-color: rgb(13, 12, 12);background-size: 100% 40px;'></section></section><section style="width:100%;clear:both;"></section></section></section><p style="white-space: normal;"><br></p><section class="mpa-template" data-mpa-template-id="882500" data-mpa-color="null" data-mpa-category="收藏"><section><section style="border-width: 0px;border-style: initial;border-color: initial;padding: 0px;margin: 0px auto;text-align: center;white-space: normal;"><section style='background-image:url("https://mmbiz.qpic.cn/mmbiz_png/ianq03UUWGmIDLYyVZsymkTnBibBPxwxoWuIkiaMRfF2nPrvryogjrO4XfhpWegMwicuiapXBQia8qeINYhefTtwGfrQ/640?wx_fmt=png");display:inline-block;margin:0 auto;text-align:left;background-size:auto 50px;background-repeat:no-repeat;width:42px;height:50px;vertical-align:top;line-height:50px;text-align:center;color:#fff;'><p style="font-size: 20px;border-width: 0px;border-style: initial;border-color: initial;padding: 0px;margin: 0px;"><span style="font-size: 16px;font-family: Optima-Regular, PingFangTC-light;">3.1</span></p></section><section style='background-image:url("https://mmbiz.qpic.cn/mmbiz_png/ianq03UUWGmIDLYyVZsymkTnBibBPxwxoWEnrBa7fuiccJgxAndh66NF0fKuTFduWXp2icIoXhBpibVePONwaJ3Jvzg/640?wx_fmt=png");display:inline-block;margin:0 auto;text-align:left;background-size:auto 50px;background-repeat:no-repeat;height:50px;'><section style="display:inline-block;padding-left:10px;line-height:50px;color:#333;margin-top:0;vertical-align:top;"><p style="font-size: 14px;border-width: 0px;border-style: initial;border-color: initial;padding: 0px;margin: 0px;"><span style="color: rgb(255, 41, 65);font-size: 16px;font-family: Optima-Regular, PingFangTC-light;"><strong mpa-from-tpl="t">简介</strong></span></p></section></section><section style='background-image:url("https://mmbiz.qpic.cn/mmbiz_png/ianq03UUWGmIDLYyVZsymkTnBibBPxwxoWzfenALo6kEeDUGXCyFibSibU24BtebdP2ialR438RwuG8TnZUIv9k8Ubg/640?wx_fmt=png");display:inline-block;margin:0 auto;text-align:left;background-size:auto 50px;background-repeat:no-repeat;width:17px;height:50px;vertical-align:top;'></section></section></section></section><p style="white-space: normal;"><span style="font-family: DengXian;"></span></p><p style="white-space: normal;"><span style="font-family: DengXian;">机器学习 </span>(<span style="font-family: DengXian;">深度学习</span>) <span style="font-family: DengXian;">中用到的数据，包括结构性数据 </span>(<span style="font-family: DengXian;">数据表、序列</span>) <span style="font-family: DengXian;">和非结构性数据 </span>(<span style="font-family: DengXian;">图片、视屏</span>) <span style="font-family: DengXian;">都是张量，总结如下：</span></p><p style="white-space: normal;"><br></p><ul class=" list-paddingleft-2" style="list-style-type: circle;"><li><p style="text-align: left;line-height: normal;"><span style="font-size: 14px;"><strong><span style="font-family: DengXian;">数据表</span></strong><span style="font-family: DengXian;">：</span>2 <span style="font-family: DengXian;">维，形状 </span>= (<span style="font-family: DengXian;color: red;">样本数</span><span style="font-family: DengXian;">，特征数</span>)</span></p></li><li><p style="text-align: left;line-height: normal;"><span style="font-size: 14px;"><strong><span style="font-family: DengXian;">序列类</span></strong><span style="font-family: DengXian;">：</span>3 <span style="font-family: DengXian;">维，形状 </span>= (<span style="font-family: DengXian;color: red;">样本数</span><span style="font-family: DengXian;">，步长，特征数</span>)</span></p></li><li><p style="text-align: left;line-height: normal;"><span style="font-size: 14px;"><strong><span style="font-family: DengXian;">图像类</span></strong><span style="font-family: DengXian;">：</span>4 <span style="font-family: DengXian;">维，形状 </span>= (<span style="font-family: DengXian;color: red;">样本数</span><span style="font-family: DengXian;">，宽，高，通道数</span>)</span></p></li><li><p style="text-align: left;line-height: normal;"><span style="font-size: 14px;"><strong><span style="font-family: DengXian;">视屏类</span></strong><span style="font-family: DengXian;">：</span>5 <span style="font-family: DengXian;">维，形状 </span>= (<span style="font-family: DengXian;color: red;">样本数</span><span style="font-family: DengXian;">，帧数，宽，高，通道数</span>)</span></p></li></ul><p style="white-space: normal;text-align: left;line-height: normal;"><br></p><p style="white-space: normal;line-height: normal;"><span style="font-family: DengXian;">机器学习，尤其深度学习，需要大量的数据，因此<span style="color: red;">样本数</span>肯定占一个维度，惯例我们把它称为维度</span> 1<span style="font-family: DengXian;">。这样机器学习要处理的张量至少从 </span>2 <span style="font-family: DengXian;">维开始。</span></p><p style="white-space: normal;line-height: normal;"><br></p><section class="mpa-template" data-mpa-template-id="882500" data-mpa-color="null" data-mpa-category="收藏"><section><section style="border-width: 0px;border-style: initial;border-color: initial;padding: 0px;margin: 0px auto;text-align: center;white-space: normal;"><section style='background-image:url("https://mmbiz.qpic.cn/mmbiz_png/ianq03UUWGmIDLYyVZsymkTnBibBPxwxoWuIkiaMRfF2nPrvryogjrO4XfhpWegMwicuiapXBQia8qeINYhefTtwGfrQ/640?wx_fmt=png");display:inline-block;margin:0 auto;text-align:left;background-size:auto 50px;background-repeat:no-repeat;width:42px;height:50px;vertical-align:top;line-height:50px;text-align:center;color:#fff;'><p style="font-size: 20px;border-width: 0px;border-style: initial;border-color: initial;padding: 0px;margin: 0px;"><span style="font-size: 16px;font-family: Optima-Regular, PingFangTC-light;">3.2</span></p></section><section style='background-image:url("https://mmbiz.qpic.cn/mmbiz_png/ianq03UUWGmIDLYyVZsymkTnBibBPxwxoWEnrBa7fuiccJgxAndh66NF0fKuTFduWXp2icIoXhBpibVePONwaJ3Jvzg/640?wx_fmt=png");display:inline-block;margin:0 auto;text-align:left;background-size:auto 50px;background-repeat:no-repeat;height:50px;'><section style="display:inline-block;padding-left:10px;line-height:50px;color:#333;margin-top:0;vertical-align:top;"><p style="font-size: 14px;border-width: 0px;border-style: initial;border-color: initial;padding: 0px;margin: 0px;"><span style="color: rgb(255, 41, 65);font-size: 16px;font-family: Optima-Regular, PingFangTC-light;"><strong mpa-from-tpl="t">2D 数据表</strong></span></p></section></section><section style='background-image:url("https://mmbiz.qpic.cn/mmbiz_png/ianq03UUWGmIDLYyVZsymkTnBibBPxwxoWzfenALo6kEeDUGXCyFibSibU24BtebdP2ialR438RwuG8TnZUIv9k8Ubg/640?wx_fmt=png");display:inline-block;margin:0 auto;text-align:left;background-size:auto 50px;background-repeat:no-repeat;width:17px;height:50px;vertical-align:top;'></section></section></section></section><p style="white-space: normal;"><br></p><p style="white-space: normal;">2 <span style="font-family: DengXian;">维张量就是矩阵，也叫数据表，一般用 </span>csv <span style="font-family: DengXian;">存储。</span></p><p style="white-space: normal;"><br></p><p style="white-space: normal;text-align: center;"><img class="" data-backh="159" data-backw="556" data-before-oversubscription-url="http://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCG10MfSaJWcNALWNO2CBJyFjGZEAbIqV10ldtfLZIzJDUcZx1F07bHVWdjiaUxluTQJSCjv58tn0Xg/0?wx_fmt=png" data-ratio="0.2857142857142857" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCG10MfSaJWcNALWNO2CBJyFjGZEAbIqV10ldtfLZIzJDUcZx1F07bHVWdjiaUxluTQJSCjv58tn0Xg/640?wx_fmt=png" data-type="png" data-w="672" style="width: 556.25px;"></p><p style="white-space: normal;"><br></p><p style="white-space: normal;"><span style="font-family: DengXian;">这套房屋 </span>21,000 <span style="font-family: DengXian;">个数据包括其价格 </span>(y)<span style="font-family: DengXian;">，平方英尺，卧室数，楼层，日期，翻新年份等等</span> 21 <span style="font-family: DengXian;">栏。该数据形状为 </span>(21000, 21)<span style="font-family: DengXian;">。传统机器学习的线性回归可以来预测房价。</span></p><p style="white-space: normal;"><br></p><p style="white-space: normal;">2 <span style="font-family: DengXian;">维张量的数据表示图如下：</span></p><p style="text-align: center;"><br></p><p style="text-align: center;"><img class="" data-backh="189" data-backw="556" data-before-oversubscription-url="http://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCG67olIO7NH4LibhJeKIKGUrw6GXicbFiac9CwoF3Mk9dyIibWZxoCgaf1uoVCvlhQiamLacTZsFfdF0AA/0?wx_fmt=png" data-ratio="0.33916083916083917" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCG67olIO7NH4LibhJeKIKGUrw6GXicbFiac9CwoF3Mk9dyIibWZxoCgaf1uoVCvlhQiamLacTZsFfdF0AA/640?wx_fmt=png" data-type="png" data-w="1144" style="text-align: center;white-space: normal;width: 100%;height: auto;"></p><p style="text-align: center;"><br></p><section class="mpa-template" data-mpa-template-id="882500" data-mpa-color="null" data-mpa-category="收藏"><section><section style="border-width: 0px;border-style: initial;border-color: initial;padding: 0px;margin: 0px auto;text-align: center;white-space: normal;"><section style='background-image:url("https://mmbiz.qpic.cn/mmbiz_png/ianq03UUWGmIDLYyVZsymkTnBibBPxwxoWuIkiaMRfF2nPrvryogjrO4XfhpWegMwicuiapXBQia8qeINYhefTtwGfrQ/640?wx_fmt=png");display:inline-block;margin:0 auto;text-align:left;background-size:auto 50px;background-repeat:no-repeat;width:42px;height:50px;vertical-align:top;line-height:50px;text-align:center;color:#fff;'><p style="font-size: 20px;border-width: 0px;border-style: initial;border-color: initial;padding: 0px;margin: 0px;"><span style="font-size: 16px;font-family: Optima-Regular, PingFangTC-light;">3.3</span></p></section><section style='background-image:url("https://mmbiz.qpic.cn/mmbiz_png/ianq03UUWGmIDLYyVZsymkTnBibBPxwxoWEnrBa7fuiccJgxAndh66NF0fKuTFduWXp2icIoXhBpibVePONwaJ3Jvzg/640?wx_fmt=png");display:inline-block;margin:0 auto;text-align:left;background-size:auto 50px;background-repeat:no-repeat;height:50px;'><section style="display:inline-block;padding-left:10px;line-height:50px;color:#333;margin-top:0;vertical-align:top;"><p style="font-size: 14px;border-width: 0px;border-style: initial;border-color: initial;padding: 0px;margin: 0px;"><span style="color: rgb(255, 41, 65);font-size: 16px;font-family: Optima-Regular, PingFangTC-light;"><strong mpa-from-tpl="t">3D 序列数据</strong></span></p></section></section><section style='background-image:url("https://mmbiz.qpic.cn/mmbiz_png/ianq03UUWGmIDLYyVZsymkTnBibBPxwxoWzfenALo6kEeDUGXCyFibSibU24BtebdP2ialR438RwuG8TnZUIv9k8Ubg/640?wx_fmt=png");display:inline-block;margin:0 auto;text-align:left;background-size:auto 50px;background-repeat:no-repeat;width:17px;height:50px;vertical-align:top;'></section></section></section></section><p style="white-space: normal;"><span style="font-family: DengXian;"><br></span></p><p><span style="font-family: DengXian;">推特 </span>(twitter) <span style="font-family: DengXian;">的每条推文 </span>(tweet) <span style="font-family: DengXian;">规定只能发 </span>280 <span style="font-family: DengXian;">个字符。在编码推文时，将 </span>280 <span style="font-family: DengXian;">个字符的序列用独热编码 </span>(one-hot encoding) <span style="font-family: DengXian;">到包含 </span>128 <span style="font-family: DengXian;">个字符的 </span>ASCII <span style="font-family: DengXian;">表，如下所示。</span></p><p style="white-space: normal;"><span style="font-family: DengXian;"><br></span></p><p style="white-space: normal;"><span style="font-family: DengXian;"><img class="" data-backh="370" data-backw="556" data-before-oversubscription-url="https://upload.wikimedia.org/wikipedia/commons/thumb/1/1b/ASCII-Table-wide.svg/875px-ASCII-Table-wide.svg.png" data-ratio="0.6651428571428571" src="https://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCG67olIO7NH4LibhJeKIKGUr42JicFxDht13mv3YEljsVwx4ibwzgP83XRfp6TeEhssicc2nTe0NwTTmw/640?wx_fmt=png" data-type="png" data-w="875" style="width: 100%;height: auto;"></span></p><p style="white-space: normal;"><span style="font-family: DengXian;"><br></span></p><p style="white-space: normal;"><span style="font-family: DengXian;">这样，每条推文都可以编码为 </span>2 <span style="font-family: DengXian;">维张量形状 </span>(280, 128)<span style="font-family: DengXian;">，比如一条 </span>tweet <span style="font-family: DengXian;">是 “</span><span style="color: rgb(172, 57, 255);">I love python :)</span><span style="font-family: DengXian;">”，这句话映射到 </span>ASCII <span style="font-family: DengXian;">表变成：</span></p><p style="white-space: normal;"><span style="font-family: DengXian;"><br></span></p><p style="text-align: center;"><img class="" data-backh="358" data-backw="556" data-before-oversubscription-url="http://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCG67olIO7NH4LibhJeKIKGUr2khkGlLfBfDiawvVPmvNEywPED5rRic9ic8UYJCsHD15tYoSK6dDuztVQ/0?wx_fmt=png" data-ratio="0.6425531914893617" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCG67olIO7NH4LibhJeKIKGUr2khkGlLfBfDiawvVPmvNEywPED5rRic9ic8UYJCsHD15tYoSK6dDuztVQ/640?wx_fmt=png" data-type="png" data-w="940" style="width: 100%;height: auto;"></p><p style="white-space: normal;"><span style="font-family: DengXian;"></span><br></p><p style="white-space: normal;"><span style="font-family: DengXian;">如果收集到 </span>1 <span style="font-family: DengXian;">百万条推文，那么整个数据集的形状为 </span>(1000000, 280, 128)<span style="font-family: DengXian;">。传统机器学习的对率回归可以来做情感分析。</span></p><p style="white-space: normal;"><span style="font-family: DengXian;"><br></span></p><p>3 <span style="font-family:DengXian;">维张量的数据表示图如下：</span></p><p><span style="font-family:DengXian;"><br></span></p><p style="text-align: center;"><img class="" data-backh="216" data-backw="556" data-before-oversubscription-url="http://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCG67olIO7NH4LibhJeKIKGUrPA6RlJmKlAtlypRUZW12PicCO2fB8lLbEF52XTgj7In9ITjr3cqmACA/0?wx_fmt=png" data-ratio="0.38866396761133604" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCG67olIO7NH4LibhJeKIKGUrPA6RlJmKlAtlypRUZW12PicCO2fB8lLbEF52XTgj7In9ITjr3cqmACA/640?wx_fmt=png" data-type="png" data-w="1235" style="width: 100%;height: auto;"></p><p style="white-space: normal;"><br></p><section class="mpa-template" data-mpa-template-id="882500" data-mpa-color="null" data-mpa-category="收藏"><section><section style="border-width: 0px;border-style: initial;border-color: initial;padding: 0px;margin: 0px auto;text-align: center;white-space: normal;"><section style='background-image:url("https://mmbiz.qpic.cn/mmbiz_png/ianq03UUWGmIDLYyVZsymkTnBibBPxwxoWuIkiaMRfF2nPrvryogjrO4XfhpWegMwicuiapXBQia8qeINYhefTtwGfrQ/640?wx_fmt=png");display:inline-block;margin:0 auto;text-align:left;background-size:auto 50px;background-repeat:no-repeat;width:42px;height:50px;vertical-align:top;line-height:50px;text-align:center;color:#fff;'><p style="font-size: 20px;border-width: 0px;border-style: initial;border-color: initial;padding: 0px;margin: 0px;"><span style="font-size: 16px;font-family: Optima-Regular, PingFangTC-light;">3.4</span></p></section><section style='background-image:url("https://mmbiz.qpic.cn/mmbiz_png/ianq03UUWGmIDLYyVZsymkTnBibBPxwxoWEnrBa7fuiccJgxAndh66NF0fKuTFduWXp2icIoXhBpibVePONwaJ3Jvzg/640?wx_fmt=png");display:inline-block;margin:0 auto;text-align:left;background-size:auto 50px;background-repeat:no-repeat;height:50px;'><section style="display:inline-block;padding-left:10px;line-height:50px;color:#333;margin-top:0;vertical-align:top;"><p style="font-size: 14px;border-width: 0px;border-style: initial;border-color: initial;padding: 0px;margin: 0px;"><span style="color: rgb(255, 41, 65);font-size: 16px;font-family: Optima-Regular, PingFangTC-light;"><strong mpa-from-tpl="t">4D 图像数据</strong></span></p></section></section><section style='background-image:url("https://mmbiz.qpic.cn/mmbiz_png/ianq03UUWGmIDLYyVZsymkTnBibBPxwxoWzfenALo6kEeDUGXCyFibSibU24BtebdP2ialR438RwuG8TnZUIv9k8Ubg/640?wx_fmt=png");display:inline-block;margin:0 auto;text-align:left;background-size:auto 50px;background-repeat:no-repeat;width:17px;height:50px;vertical-align:top;'></section></section></section></section><p style="white-space: normal;"><br></p><p><span style="font-family:DengXian;">图像通常具有</span>3<span style="font-family:DengXian;">个维度：宽度，高度和颜色通道。虽然是黑白图像 </span>(<span style="font-family:DengXian;">如 </span>MNIST <span style="font-family:DengXian;">数字</span>) <span style="font-family:DengXian;">只有一个颜色通道，按照惯例，我们还是把它当成 </span>3 <span style="font-family:DengXian;">维，即颜色通道只有一维。</span></p><p><span style="font-family:DengXian;"><br></span></p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p><span style="font-family: DengXian;color: black;">一组黑白照片可存成形状为 </span><span style="color: black;">(</span><span style="font-family: DengXian;color: black;">样本数，宽，高，</span><span style="color: red;">1</span><span style="color: black;">) </span><span style="font-family: DengXian;color: black;">的 </span><span style="color: black;">4 </span><span style="font-family: DengXian;color: black;">维张量</span></p></li><li><p><span style="font-family: DengXian;color: black;">一组彩色照片可存成形状为 </span><span style="color: black;">(</span><span style="font-family: DengXian;color: black;">样本数，宽，高，</span><span style="color: blue;">3</span><span style="color: black;">) </span><span style="font-family: DengXian;color: black;">的 </span><span style="color: black;">4 </span><span style="font-family: DengXian;color: black;">维张量</span></p></li></ul><p style="white-space: normal;"><br></p><p style="text-align: center;"><img class="" data-backh="214" data-backw="556" data-before-oversubscription-url="http://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCG67olIO7NH4LibhJeKIKGUrMkIAcR7G8Xc4a4iaLpTvMfEXbraHdY7tuwabUvrfncnqyAGedcbluuA/0?wx_fmt=png" data-ratio="0.38436482084690554" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCG67olIO7NH4LibhJeKIKGUrMkIAcR7G8Xc4a4iaLpTvMfEXbraHdY7tuwabUvrfncnqyAGedcbluuA/640?wx_fmt=png" data-type="png" data-w="1228" style="width: 100%;height: auto;"></p><p><span style="font-family: DengXian;">通常 </span>0 <span style="font-family: DengXian;">代表黑色，</span>255 <span style="font-family: DengXian;">代表白色。</span><br></p><p><span style="font-family:DengXian;"><br></span></p><p>4 <span style="font-family:DengXian;">维张量的数据表示图如下：</span></p><p><span style="font-family:DengXian;"><br></span></p><p style="text-align: center;"><img class="" data-backh="309" data-backw="556" data-before-oversubscription-url="http://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCG67olIO7NH4LibhJeKIKGUr12TPzCWrf8RlUOOaQnPCCJh3ZdibmQweos29PwqAZyMeKljkxdTrkHA/0?wx_fmt=png" data-ratio="0.5548654244306418" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCG67olIO7NH4LibhJeKIKGUr12TPzCWrf8RlUOOaQnPCCJh3ZdibmQweos29PwqAZyMeKljkxdTrkHA/640?wx_fmt=png" data-type="png" data-w="966" style="width: 100%;height: auto;"></p><p style="white-space: normal;"><br></p><section class="mpa-template" data-mpa-template-id="882500" data-mpa-color="null" data-mpa-category="收藏"><section><section style="border-width: 0px;border-style: initial;border-color: initial;padding: 0px;margin: 0px auto;text-align: center;white-space: normal;"><section style='background-image:url("https://mmbiz.qpic.cn/mmbiz_png/ianq03UUWGmIDLYyVZsymkTnBibBPxwxoWuIkiaMRfF2nPrvryogjrO4XfhpWegMwicuiapXBQia8qeINYhefTtwGfrQ/640?wx_fmt=png");display:inline-block;margin:0 auto;text-align:left;background-size:auto 50px;background-repeat:no-repeat;width:42px;height:50px;vertical-align:top;line-height:50px;text-align:center;color:#fff;'><p style="font-size: 20px;border-width: 0px;border-style: initial;border-color: initial;padding: 0px;margin: 0px;"><span style="font-size: 16px;font-family: Optima-Regular, PingFangTC-light;">3.5</span></p></section><section style='background-image:url("https://mmbiz.qpic.cn/mmbiz_png/ianq03UUWGmIDLYyVZsymkTnBibBPxwxoWEnrBa7fuiccJgxAndh66NF0fKuTFduWXp2icIoXhBpibVePONwaJ3Jvzg/640?wx_fmt=png");display:inline-block;margin:0 auto;text-align:left;background-size:auto 50px;background-repeat:no-repeat;height:50px;'><section style="display:inline-block;padding-left:10px;line-height:50px;color:#333;margin-top:0;vertical-align:top;"><p style="font-size: 14px;border-width: 0px;border-style: initial;border-color: initial;padding: 0px;margin: 0px;"><span style="color: rgb(255, 41, 65);font-size: 16px;font-family: Optima-Regular, PingFangTC-light;"><strong mpa-from-tpl="t">5D 视屏数据</strong></span></p></section></section><section style='background-image:url("https://mmbiz.qpic.cn/mmbiz_png/ianq03UUWGmIDLYyVZsymkTnBibBPxwxoWzfenALo6kEeDUGXCyFibSibU24BtebdP2ialR438RwuG8TnZUIv9k8Ubg/640?wx_fmt=png");display:inline-block;margin:0 auto;text-align:left;background-size:auto 50px;background-repeat:no-repeat;width:17px;height:50px;vertical-align:top;'></section></section></section></section><p style="white-space: normal;"><br></p><p><span style="font-family:DengXian;">视频可以被分解成一幅幅帧 </span>(frame)<span style="font-family:DengXian;">。</span></p><p><span style="font-family: DengXian;"><br></span></p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p><span style="font-family: DengXian;">每<span style="font-family: DengXian;">幅</span>帧就是彩色图像，可以存储在形状是 </span>(<span style="font-family: DengXian;">宽度，高度，通道</span>) <span style="font-family: DengXian;">的 </span>3D <span style="font-family: DengXian;">张量中</span></p></li><li><p><span style="font-family: DengXian;">视屏 </span>(<span style="font-family: DengXian;">一个序列的帧</span>) <span style="font-family: DengXian;">可以存储在形状是 </span>(<span style="font-family: DengXian;color: red;">帧数</span><span style="font-family: DengXian;">，宽度，高度，通道</span>) <span style="font-family: DengXian;">的 </span>4D <span style="font-family: DengXian;">张量中</span></p></li><li><p><span style="font-family: DengXian;">一批不同的视频可以存储在形状是 </span>(<span style="font-family: DengXian;color: blue;">样本数</span><span style="font-family: DengXian;">，<span style="color:red;">帧数</span>，宽度，高度，通道</span>) <span style="font-family: DengXian;">的 </span>5D <span style="font-family: DengXian;">张量中</span></p></li></ul><p><br></p><p><span style="font-family:DengXian;">下面一个 </span>9:42 <span style="font-family:DengXian;">秒的 </span>1280x720 YouTube <span style="font-family:DengXian;">视频 </span>(<span style="font-family: DengXian;">哈登三分绝杀勇士</span>)<span style="font-family: DengXian;">，被分解成 </span>40 <span style="font-family: DengXian;">个样本数据，每个样本包括 </span>240 <span style="font-family: DengXian;">帧。这样的视频剪辑将存储在形状为 </span>(<span style="color: blue;">40</span>, <span style="color: red;">240</span>, 1280, 720, 3) <span style="font-family: DengXian;">的张量中。</span></p><p style="white-space: normal;"><br></p><p style="text-align: center;"><img class="" data-ratio="0.5628571428571428" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCG67olIO7NH4LibhJeKIKGUrRchgib2jFooqowdPh4G8qsPU2B2oCULMfGd9S9e9zBzukDDaG5UOfCA/640?wx_fmt=png" data-type="png" data-w="700" style=""></p><p style="white-space: normal;"><br></p><p>5 <span style="font-family:DengXian;">维张量的数据表示图如下：</span></p><p style="white-space: normal;"><br></p><p style="text-align: center;"><img class="" data-backh="203" data-backw="556" data-before-oversubscription-url="http://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCG67olIO7NH4LibhJeKIKGUruiclbcqibbXz21V9MuuN96ICCgu8fPbD55OqDNTQOEJicFVN3AicibjHt6w/0?wx_fmt=png" data-ratio="0.36370839936608557" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCG67olIO7NH4LibhJeKIKGUruiclbcqibbXz21V9MuuN96ICCgu8fPbD55OqDNTQOEJicFVN3AicibjHt6w/640?wx_fmt=png" data-type="png" data-w="1262" style="width: 100%;height: auto;"></p><p style="white-space: normal;"><br></p><p style="white-space: normal;"><br></p><section class="mpa-template" data-mpa-template-id="882155" data-mpa-color="null" data-mpa-category="收藏"><section><section style="padding:10px 10px;"><section class="autonum" style="float:left;width:40px;height:40px;text-align:center;color:#fff;background-color:#0d0c0c;font-size:24px;line-height:40px;">4</section><section style="width:auto;display:inline-block;float:left;padding:0px 15px;height:40px;font-size:18px;line-height:35px;border-bottom:solid 2px #0d0c0c;border-top:solid 2px #0d0c0c;">量化金融的张量</section><section style='background-image:url("https://mmbiz.qpic.cn/mmbiz_png/fgnkxfGnnkSBJo13oUicPbCbqeTcIyiakNc2UGmnmA1qH7HExsicAyuzE3Foogxo1VmRNr68icYkKibV0wM7nqTIHng/640?wx_fmt=png");width:18px;height:40px;float:left;background-repeat:no-repeat;background-color:#0d0c0c;background-size:100% 40px;'></section></section><section style="width:100%;clear:both;"></section></section></section><p style="white-space: normal;"><br></p><section class="mpa-template" data-mpa-template-id="882500" data-mpa-color="null" data-mpa-category="收藏" style="white-space: normal;"><section><section style="margin-right: auto;margin-left: auto;border-width: 0px;border-style: initial;border-color: initial;text-align: center;"><section style='margin-right: auto;margin-left: auto;background-image: url("https://mmbiz.qpic.cn/mmbiz_png/ianq03UUWGmIDLYyVZsymkTnBibBPxwxoWuIkiaMRfF2nPrvryogjrO4XfhpWegMwicuiapXBQia8qeINYhefTtwGfrQ/640?wx_fmt=png");display: inline-block;background-size: auto 50px;background-repeat: no-repeat;width: 42px;height: 50px;vertical-align: top;line-height: 50px;color: rgb(255, 255, 255);'><p style="font-size: 20px;border-width: 0px;border-style: initial;border-color: initial;"><span style="font-size: 16px;font-family: Optima-Regular, PingFangTC-light;">4.1</span></p></section><section style='margin-right: auto;margin-left: auto;background-image: url("https://mmbiz.qpic.cn/mmbiz_png/ianq03UUWGmIDLYyVZsymkTnBibBPxwxoWEnrBa7fuiccJgxAndh66NF0fKuTFduWXp2icIoXhBpibVePONwaJ3Jvzg/640?wx_fmt=png");display: inline-block;text-align: left;background-size: auto 50px;background-repeat: no-repeat;height: 50px;'><section style="padding-left: 10px;display: inline-block;line-height: 50px;vertical-align: top;"><p style="font-size: 14px;border-width: 0px;border-style: initial;border-color: initial;"><span style="color: rgb(255, 41, 65);font-size: 16px;font-family: Optima-Regular, PingFangTC-light;"><strong mpa-from-tpl="t">简介</strong></span></p></section></section><section style='margin-right: auto;margin-left: auto;background-image: url("https://mmbiz.qpic.cn/mmbiz_png/ianq03UUWGmIDLYyVZsymkTnBibBPxwxoWzfenALo6kEeDUGXCyFibSibU24BtebdP2ialR438RwuG8TnZUIv9k8Ubg/640?wx_fmt=png");display: inline-block;text-align: left;background-size: auto 50px;background-repeat: no-repeat;width: 17px;height: 50px;vertical-align: top;'></section></section></section></section><p style="white-space: normal;"><br></p><p style="white-space: normal;"><span style="font-family: DengXian;">在量化金融中，我们用股票数据举例来说明不同维度的张量，习惯将维度定义如下：</span></p><p style="white-space: normal;"><br></p><p style="white-space: normal;text-align: center;"><img class="" data-backh="151" data-backw="556" data-before-oversubscription-url="http://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCEnLOffKdMdfGkPCVwpIgPI6H8QeKeVNsVrfO2RgBf7E0pic161ibmJgoic9MVK1lGJzqgVO9BdkQAZA/0?wx_fmt=png" data-ratio="0.27258320126782887" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCEnLOffKdMdfGkPCVwpIgPI6H8QeKeVNsVrfO2RgBf7E0pic161ibmJgoic9MVK1lGJzqgVO9BdkQAZA/640?wx_fmt=png" data-type="png" data-w="631" style="width: 556.25px;"></p><p style="white-space: normal;"><br></p><p style="white-space: normal;"><span style="font-family: DengXian;">结合上表，下图清晰画出各个维度的代表的意思。</span><br></p><p style="white-space: normal;"><br></p><p style="white-space: normal;text-align: center;"><img class="" data-before-oversubscription-url="https://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCEnLOffKdMdfGkPCVwpIgPIHPJsantr5ZNE179JnBIKVl36SJPyiaRO0eiaibvdXAGicCO7Mth2pxjJJA/640?wx_fmt=png" data-copyright="0" data-ratio="0.8506271379703535" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCEnLOffKdMdfGkPCVwpIgPIHPJsantr5ZNE179JnBIKVl36SJPyiaRO0eiaibvdXAGicCO7Mth2pxjJJA/640?wx_fmt=png" data-type="png" data-w="877" style="width: 501px;height: auto;"></p><p style="white-space: normal;"><br></p><p style="white-space: normal;"><span style="font-family: DengXian;">接下来我们特别选取聚宽 </span>(JoinQuant) <span style="font-family: DengXian;">量化平台来举 </span>A <span style="font-family: DengXian;">股的例子，选取 </span>Quantoptian <span style="font-family: DengXian;">量化平台来举美股的例子。</span></p><p style="white-space: normal;"><br></p><section class="mpa-template" data-mpa-template-id="882500" data-mpa-color="null" data-mpa-category="收藏"><section><section style="border-width: 0px;border-style: initial;border-color: initial;padding: 0px;margin: 0px auto;text-align: center;white-space: normal;"><section style='background-image:url("https://mmbiz.qpic.cn/mmbiz_png/ianq03UUWGmIDLYyVZsymkTnBibBPxwxoWuIkiaMRfF2nPrvryogjrO4XfhpWegMwicuiapXBQia8qeINYhefTtwGfrQ/640?wx_fmt=png");display:inline-block;margin:0 auto;text-align:left;background-size:auto 50px;background-repeat:no-repeat;width:42px;height:50px;vertical-align:top;line-height:50px;text-align:center;color:#fff;'><p style="font-size: 20px;border-width: 0px;border-style: initial;border-color: initial;padding: 0px;margin: 0px;"><span style="font-size: 16px;font-family: Optima-Regular, PingFangTC-light;">4.2</span></p></section><section style='background-image:url("https://mmbiz.qpic.cn/mmbiz_png/ianq03UUWGmIDLYyVZsymkTnBibBPxwxoWEnrBa7fuiccJgxAndh66NF0fKuTFduWXp2icIoXhBpibVePONwaJ3Jvzg/640?wx_fmt=png");display:inline-block;margin:0 auto;text-align:left;background-size:auto 50px;background-repeat:no-repeat;height:50px;'><section style="display:inline-block;padding-left:10px;line-height:50px;color:#333;margin-top:0;vertical-align:top;"><p style="font-size: 14px;border-width: 0px;border-style: initial;border-color: initial;padding: 0px;margin: 0px;"><span style="color: rgb(255, 41, 65);font-size: 16px;font-family: Optima-Regular, PingFangTC-light;"><strong mpa-from-tpl="t">JoinQuant 之 A 股</strong></span></p></section></section><section style='background-image:url("https://mmbiz.qpic.cn/mmbiz_png/ianq03UUWGmIDLYyVZsymkTnBibBPxwxoWzfenALo6kEeDUGXCyFibSibU24BtebdP2ialR438RwuG8TnZUIv9k8Ubg/640?wx_fmt=png");display:inline-block;margin:0 auto;text-align:left;background-size:auto 50px;background-repeat:no-repeat;width:17px;height:50px;vertical-align:top;'></section></section></section></section><p style="white-space: normal;text-align: center;"><br></p><p style="white-space: normal;">首先引入 Python 基本的 numpy 模块。</p><p style="white-space: normal;"><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t" style="white-space: normal;"><pre style="margin-top: 0px;margin-bottom: 0px;padding: 0px;background-image: none;background-color: initial;"><code class="hljs-github" style="margin-right: 0.15em;margin-left: 0.15em;padding: 5.95px;border-radius: 4px;font-size: 0.85em;background: rgb(248, 248, 248);display: block;overflow-x: auto;white-space: nowrap;"><span class="hljs-github-keyword" style="background: rgba(0, 0, 0, 0);display: inline;width: 40px;text-decoration-style: solid;text-decoration-color: rgb(51, 51, 51);font-weight: 700;">import</span> numpy <span class="hljs-github-keyword" style="background: rgba(0, 0, 0, 0);display: inline;width: 14px;text-decoration-style: solid;text-decoration-color: rgb(51, 51, 51);font-weight: 700;">as</span> np</code></pre></section><section class="mpa-template" data-mpa-template-id="921851" data-mpa-color="null" data-mpa-category="收藏" style="white-space: normal;"><section><section class="layout"><section style="margin-top: 1em;margin-bottom: 1em;box-sizing: border-box;border-bottom: 2px solid rgb(236, 68, 68);clear: both;"><section style="padding-top: 3px;padding-right: 10px;padding-left: 10px;display: inline-block;color: rgb(255, 255, 255);box-sizing: border-box;border-top-left-radius: 3px;border-top-right-radius: 3px;height: 28px;background-color: rgb(236, 68, 68);">0 维张量：一个收盘价</section><section style="margin-left: 2px;box-sizing: border-box;border-top: 28px solid transparent;border-right-color: rgb(206, 206, 206);border-bottom: 0px solid transparent;border-left: 15px solid rgb(206, 206, 206);display: inline-block;vertical-align: top;"></section></section></section></section></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t" style="white-space: normal;"><pre style="margin-top: 0px;margin-bottom: 0px;padding: 0px;background-image: none;background-color: initial;"><code class="hljs-github" style="margin-right: 0.15em;margin-left: 0.15em;padding: 5.95px;border-radius: 4px;font-size: 0.85em;background: rgb(248, 248, 248);display: block;overflow-x: auto;white-space: nowrap;"><span class="hljs-github-comment" style="color: rgb(153, 153, 136);background: rgba(0, 0, 0, 0);display: inline;width: 270px;text-decoration-style: solid;text-decoration-color: rgb(153, 153, 136);font-style: italic;"># 茅台 (600519.XSHG) 在2019年1月3日的收盘价</span><br>X0 = get_price(<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 85px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'600519.XSHG'</span>,start_date=<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 79px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'2019-01-03'</span>,<br>end_date=<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 79px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'2019-01-03'</span>, frequency=<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 45px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'daily'</span>, <br>fields=<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 45px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'close'</span>)<br><br>print( <span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 73px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'张量形状是'</span>, X0.shape )<br>print( <span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 108px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'张量压缩后形状是'</span>, np.squeeze(X0).shape )<br>X0</code></pre></section><p style="white-space: normal;"><br></p><p style="white-space: normal;"><span style="font-family: DengXian;">结果得到茅台在 </span>2019 <span style="font-family: DengXian;">年 </span>1 <span style="font-family: DengXian;">月 </span>3 <span style="font-family: DengXian;">日的收盘价，</span><span style="line-height: 21.25px;font-family: DengXian;">记为 </span>X0<span style="line-height: 21.25px;font-family: DengXian;">，它</span><span style="font-family: DengXian;">是一个 </span>1×1 <span style="font-family: DengXian;">的标量，压缩之后的形状是 </span>()<span style="font-family: DengXian;">，是一个 </span>0 <span style="font-family: DengXian;">维张量。</span></p><p style="white-space: normal;"><br></p><p style="white-space: normal;text-align: center;"><img class="" data-backh="124" data-backw="446" data-before-oversubscription-url="http://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCEnLOffKdMdfGkPCVwpIgPIibiaiaaFCVhbHtbWmVWzicbqP1SRLwGfnuQjiaFG0VpzXUIzXWfO4cv8flA/0?wx_fmt=png" data-ratio="0.27740492170022374" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCEnLOffKdMdfGkPCVwpIgPIibiaiaaFCVhbHtbWmVWzicbqP1SRLwGfnuQjiaFG0VpzXUIzXWfO4cv8flA/640?wx_fmt=png" data-type="png" data-w="447" style="width: 556.25px;box-shadow: none;"></p><p style="white-space: normal;text-align: center;"><br></p><section class="mpa-template" data-mpa-template-id="921851" data-mpa-color="null" data-mpa-category="收藏" style="white-space: normal;"><section><section class="layout"><section style="margin-top: 1em;margin-bottom: 1em;box-sizing: border-box;border-bottom: 2px solid rgb(236, 68, 68);clear: both;"><section style="padding-top: 3px;padding-right: 10px;padding-left: 10px;display: inline-block;color: rgb(255, 255, 255);box-sizing: border-box;border-top-left-radius: 3px;border-top-right-radius: 3px;height: 28px;background-color: rgb(236, 68, 68);">1 维张量：加入时间维度</section><section style="margin-left: 2px;box-sizing: border-box;border-top: 28px solid transparent;border-right-color: rgb(206, 206, 206);border-bottom: 0px solid transparent;border-left: 15px solid rgb(206, 206, 206);display: inline-block;vertical-align: top;"></section></section></section></section></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t" style="white-space: normal;"><pre style="margin-top: 0px;margin-bottom: 0px;padding: 0px;background-image: none;background-color: initial;"><code class="hljs-github" style="margin-right: 0.15em;margin-left: 0.15em;padding: 5.95px;border-radius: 4px;font-size: 0.85em;background: rgb(248, 248, 248);display: block;overflow-x: auto;white-space: nowrap;"><span class="hljs-github-comment" style="color: rgb(153, 153, 136);background: rgba(0, 0, 0, 0);display: inline;width: 348px;text-decoration-style: solid;text-decoration-color: rgb(153, 153, 136);font-style: italic;"># 获取茅台 (600519.XSHG) 从2019年1月3日起的4天历史收盘价</span><br>X1 = get_price(<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 85px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'600519.XSHG'</span>, start_date=<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 78px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'2018-12-27'</span>, <br>end_date=<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 79px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'2019-01-03'</span>, frequency=<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 45px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'daily'</span>, <br>fields=<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 45px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'close'</span>)<br><br>print( <span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 73px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'张量形状是'</span>, X1.shape )<br>print( <span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 108px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'张量压缩后形状是'</span>, np.squeeze(X1).shape )<br>X1</code></pre></section><p style="white-space: normal;"><br></p><p style="white-space: normal;"><span style="font-family: DengXian;">结果得到茅台从 </span>2019 <span style="font-family: DengXian;">年 </span>1 <span style="font-family: DengXian;">月 </span>3 <span style="font-family: DengXian;">日起 </span><span style="color: red;">4 </span><span style="font-family: DengXian;color: red;">天的历史收盘价</span><span style="font-family: DengXian;">，记为 </span>X1<span style="font-family: DengXian;">，它是一个 </span>4×1 <span style="font-family: DengXian;">的向量，压缩之后的形状是 </span>(4,)<span style="font-family: DengXian;">，是一个 </span>1 <span style="font-family: DengXian;">维张量。</span></p><p style="white-space: normal;"><br></p><p style="white-space: normal;text-align: center;"><img class="" data-backh="210" data-backw="536" data-before-oversubscription-url="http://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCEnLOffKdMdfGkPCVwpIgPIu5sEVYj1aqObguFy2cFwGZ3tMTYPmibVVvPicvMxZSjmjOlezy81PbDw/0?wx_fmt=png" data-ratio="0.3917910447761194" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCEnLOffKdMdfGkPCVwpIgPIu5sEVYj1aqObguFy2cFwGZ3tMTYPmibVVvPicvMxZSjmjOlezy81PbDw/640?wx_fmt=png" data-type="png" data-w="536" style="width: 556.25px;"></p><p style="white-space: normal;"><br></p><section class="mpa-template" data-mpa-template-id="921851" data-mpa-color="null" data-mpa-category="收藏" style="white-space: normal;"><section><section class="layout"><section style="margin-top: 1em;margin-bottom: 1em;box-sizing: border-box;border-bottom: 2px solid rgb(236, 68, 68);clear: both;"><section style="padding-top: 3px;padding-right: 10px;padding-left: 10px;display: inline-block;color: rgb(255, 255, 255);box-sizing: border-box;border-top-left-radius: 3px;border-top-right-radius: 3px;height: 28px;background-color: rgb(236, 68, 68);">2 维张量：加入股票维度</section><section style="margin-left: 2px;box-sizing: border-box;border-top: 28px solid transparent;border-right-color: rgb(206, 206, 206);border-bottom: 0px solid transparent;border-left: 15px solid rgb(206, 206, 206);display: inline-block;vertical-align: top;"></section></section></section></section></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t" style="white-space: normal;"><pre style="margin-top: 0px;margin-bottom: 0px;padding: 0px;background-image: none;background-color: initial;"><code class="hljs-github" style="margin-right: 0.15em;margin-left: 0.15em;padding: 5.95px;border-radius: 4px;font-size: 0.85em;background: rgb(248, 248, 248);display: block;overflow-x: auto;white-space: nowrap;"><span class="hljs-github-comment" style="color: rgb(153, 153, 136);background: rgba(0, 0, 0, 0);display: inline;width: 505px;text-decoration-style: solid;text-decoration-color: rgb(153, 153, 136);font-style: italic;"># 获取茅台 (600519.XSHG) 和平安银行 (000001.XSHE) <br># 从2019年1月3日起的4天历史收盘价</span><br>X2 = get_price([<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 85px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'600519.XSHG'</span>, <span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 85px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'000001.XSHE'</span>], <br>start_date=<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 78px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'2018-12-27'</span>, end_date=<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 79px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'2019-01-03'</span>,<br>frequency=<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'daily'</span>, fields=[<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'close'</span>])<br><br>print( <span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 73px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'张量形状是'</span>, X2.shape )<br>print( <span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 108px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'张量压缩后形状是'</span>, np.squeeze(X2).shape )<br><br>X2[<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 45px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'close'</span>]</code></pre></section><p style="white-space: normal;"><br></p><p style="white-space: normal;"><span style="font-family: DengXian;">结果得到<span style="color: red;">茅台和平安银行</span>从 </span>2019 <span style="font-family: DengXian;">年 </span>1 <span style="font-family: DengXian;">月 </span>3 <span style="font-family: DengXian;">日起 </span><span style="color: black;">4 </span><span style="font-family: DengXian;color: black;">天的历史收盘价</span><span style="font-family: DengXian;">，记为 </span>X2<span style="font-family: DengXian;">，它是一个 </span><span style="color: blue;">1</span>×4×2 <span style="font-family: DengXian;">的张量，这个 </span><span style="color: blue;">1 </span><span style="font-family: DengXian;">维度指的产出只有 </span>[<span style="color: rgb(221, 17, 68);font-family: monospace;font-size: 14.45px;background-color: rgb(248, 248, 248);">'close'</span>] <span style="font-family: DengXian;">一种类型的信息，因此该维度可以被压缩。</span>X2 <span style="font-family: DengXian;">压缩之后的形状是 </span>(4, 2)<span style="font-family: DengXian;">，是一个 </span>2 <span style="font-family: DengXian;">维张量。</span></p><p style="white-space: normal;"><br></p><p style="white-space: normal;text-align: center;"><img class="" data-backh="208" data-backw="541" data-before-oversubscription-url="http://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCEnLOffKdMdfGkPCVwpIgPITQRGk6DpibvVYR3n07IiaPsTCibcQ8TW7vFVjzxJEkAN6icQF3LMKcG8yg/0?wx_fmt=png" data-ratio="0.3844731977818854" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCEnLOffKdMdfGkPCVwpIgPITQRGk6DpibvVYR3n07IiaPsTCibcQ8TW7vFVjzxJEkAN6icQF3LMKcG8yg/640?wx_fmt=png" data-type="png" data-w="541" style="width: 556.25px;"></p><p style="white-space: normal;"><br></p><section class="mpa-template" data-mpa-template-id="921851" data-mpa-color="null" data-mpa-category="收藏" style="white-space: normal;"><section><section class="layout"><section style="margin-top: 1em;margin-bottom: 1em;box-sizing: border-box;border-bottom: 2px solid rgb(236, 68, 68);clear: both;"><section style="padding-top: 3px;padding-right: 10px;padding-left: 10px;display: inline-block;color: rgb(255, 255, 255);box-sizing: border-box;border-top-left-radius: 3px;border-top-right-radius: 3px;height: 28px;background-color: rgb(236, 68, 68);">3 维张量：加入信息维度</section><section style="margin-left: 2px;box-sizing: border-box;border-top: 28px solid transparent;border-right-color: rgb(206, 206, 206);border-bottom: 0px solid transparent;border-left: 15px solid rgb(206, 206, 206);display: inline-block;vertical-align: top;"></section></section></section></section></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t" style="white-space: normal;"><pre style="margin-top: 0px;margin-bottom: 0px;padding: 0px;background-image: none;background-color: initial;"><code class="hljs-github" style="margin-right: 0.15em;margin-left: 0.15em;padding: 5.95px;border-radius: 4px;font-size: 0.85em;background: rgb(248, 248, 248);display: block;overflow-x: auto;white-space: nowrap;"><span class="hljs-github-comment" style="color: rgb(153, 153, 136);background: rgba(0, 0, 0, 0);display: inline;width: 310px;text-decoration-style: solid;text-decoration-color: rgb(153, 153, 136);font-style: italic;"># 获取茅台 (600519.XSHG) 和平安银行 (000001.XSHE)</span><br><span class="hljs-github-comment" style="color: rgb(153, 153, 136);background: rgba(0, 0, 0, 0);display: inline;width: 249px;text-decoration-style: solid;text-decoration-color: rgb(153, 153, 136);font-style: italic;"># 从2019年1月3日起的4天历史收盘价和交易量</span><br>X3 = get_price([<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 85px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'600519.XSHG'</span>, <span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 85px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'000001.XSHE'</span>],<br>start_date=<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 78px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'2018-12-27'</span>, end_date=<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 79px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'2019-01-03'</span>,<br>frequency=<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'daily'</span>, fields=[<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'close'</span>,<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 53px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'volume'</span>])<br><br>print( <span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 73px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'张量形状是'</span>, X3.shape )<br>print( <span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 108px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'张量压缩后形状是'</span>, np.squeeze(X3).shape )<br><br>X3[<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 45px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'close'</span>]<br>X3[<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 53px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'volume'</span>]</code></pre></section><p style="white-space: normal;"><br></p><p style="white-space: normal;"><span style="font-family: DengXian;">结果得到<span style="color: black;">茅台和平安银行</span>从 </span>2019 <span style="font-family: DengXian;">年 </span>1 <span style="font-family: DengXian;">月 </span>3 <span style="font-family: DengXian;">日起 </span><span style="color: black;">4 </span><span style="font-family: DengXian;color: black;">天的历史</span><span style="font-family: DengXian;color: red;">收盘价和交易量</span><span style="font-family: DengXian;">，记为 </span>X3<span style="font-family: DengXian;">，它是一个 </span><span style="color: blue;">2</span>×4×2 <span style="font-family: DengXian;">的张量，这个 </span><span style="color: blue;">2 </span><span style="font-family: DengXian;">维度指的产出有 </span>[<span style="color: rgb(221, 17, 68);font-family: monospace;font-size: 14.45px;background-color: rgb(248, 248, 248);">'close'</span>] <span style="font-family: DengXian;">和 </span>[<span style="color: rgb(221, 17, 68);font-family: monospace;font-size: 14.45px;background-color: rgb(248, 248, 248);">'volume'</span>] <span style="font-family: DengXian;">两种类型的信息，因此该维度不能被压缩。</span>X3 <span style="font-family: DengXian;">压缩之后的形状还是 </span>(2, 4, 2)<span style="font-family: DengXian;">，是一个 </span>3 <span style="font-family: DengXian;">维张量。</span></p><p style="white-space: normal;"><br></p><p style="white-space: normal;text-align: center;"><img class="" data-backh="213" data-backw="541" data-before-oversubscription-url="http://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCEnLOffKdMdfGkPCVwpIgPIOHzW5gKwJeLZcDmWWew8HrQiadk2ic7ZEyjMSiavGeIH45icKE4TUEAQ5A/0?wx_fmt=png" data-ratio="0.39186691312384475" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCEnLOffKdMdfGkPCVwpIgPIOHzW5gKwJeLZcDmWWew8HrQiadk2ic7ZEyjMSiavGeIH45icKE4TUEAQ5A/640?wx_fmt=png" data-type="png" data-w="541" style="width: 556.25px;"></p><p style="white-space: normal;text-align: center;"><img class="" data-backh="154" data-backw="544" data-before-oversubscription-url="http://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCEnLOffKdMdfGkPCVwpIgPIeqdhqGhQb80oIfNaxFsChTfOvdKm9LUdretZgUIzZETaP1FmjmibstQ/0?wx_fmt=png" data-ratio="0.283609576427256" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCEnLOffKdMdfGkPCVwpIgPIeqdhqGhQb80oIfNaxFsChTfOvdKm9LUdretZgUIzZETaP1FmjmibstQ/640?wx_fmt=png" data-type="png" data-w="543" style="width: 556.25px;"></p><p style="white-space: normal;"><br></p><section class="mpa-template" data-mpa-template-id="1544155" data-mpa-color="null" data-mpa-category="收藏" style="white-space: normal;"><section><section class="layout"><section style="margin-top: 1em;margin-bottom: 1em;box-sizing: border-box;border-bottom: 2px solid rgb(236, 68, 68);clear: both;"><section style="padding-top: 3px;padding-right: 10px;padding-left: 10px;display: inline-block;color: rgb(255, 255, 255);box-sizing: border-box;border-top-left-radius: 3px;border-top-right-radius: 3px;height: 28px;background-color: rgb(236, 68, 68);">4 维张量：加入频率维度</section><section style="margin-left: 2px;box-sizing: border-box;border-top: 28px solid transparent;border-right-color: rgb(206, 206, 206);border-bottom: 0px solid transparent;border-left: 15px solid rgb(206, 206, 206);display: inline-block;vertical-align: top;"></section></section></section></section></section><p style="white-space: normal;"><span style="font-family: DengXian;">当你可以在时间维度上纵横 </span>(<span style="font-family: DengXian;">不同天，如 </span>t, t-1, t-2, …)<span style="font-family: DengXian;">，可以在横截维度上驰骋 </span>(<span style="font-family: DengXian;">不同股票，如茅台、平安等</span>)<span style="font-family: DengXian;">，可以在信息维度上选择 </span>(<span style="font-family: DengXian;">不同产出，如收盘价、交易量等</span>)<span style="font-family: DengXian;">，你几乎可以获取任何信息。但是还有一个维度，频率维度，即在日内收集 </span>tick <span style="font-family: DengXian;">级别的数据。国外和国内对于 </span>tick <span style="font-family: DengXian;">数据定义有些不同：</span></p><p style="white-space: normal;"><br></p><ul class=" list-paddingleft-2" style=""><li><p><span style="font-family: DengXian;">国外：任何委托单 </span>(order) <span style="font-family: DengXian;">使委托账本 </span>(order book) <span style="font-family: DengXian;">变化而得到的表格</span></p></li><li><p><span style="font-family: DengXian;">国内：对委托账本的按一定切片时间 </span>(500 <span style="font-family: DengXian;">毫秒，</span>3 <span style="font-family: DengXian;">秒，</span>6 <span style="font-family: DengXian;">秒等</span>) <span style="font-family: DengXian;">抽样的信息。</span></p></li></ul><p style="white-space: normal;"><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t" style="white-space: normal;"><pre style="margin-top: 0px;margin-bottom: 0px;padding: 0px;background-image: none;background-color: initial;"><code class="hljs-github" style="margin-right: 0.15em;margin-left: 0.15em;padding: 5.95px;border-radius: 4px;font-size: 0.85em;background: rgb(248, 248, 248);display: block;overflow-x: auto;white-space: nowrap;"><span class="hljs-github-comment" style="color: rgb(153, 153, 136);background: rgba(0, 0, 0, 0);display: inline;width: 195px;text-decoration-style: solid;text-decoration-color: rgb(153, 153, 136);font-style: italic;"># 引入 tick 级别的当前价和交易量</span><br><span class="hljs-github-comment" style="color: rgb(153, 153, 136);background: rgba(0, 0, 0, 0);display: inline;width: 279px;text-decoration-style: solid;text-decoration-color: rgb(153, 153, 136);font-style: italic;"># 融入 3 维张量得到的张量形状为 (2, 4, 2, 10)</span><br>d = get_ticks(<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 85px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'000001.XSHE'</span>, start_dt=<span class="hljs-github-keyword" style="background: rgba(0, 0, 0, 0);display: inline;width: 26px;text-decoration-style: solid;text-decoration-color: rgb(51, 51, 51);font-weight: 700;">None</span>, <br>end_dt=<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 79px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">"2019-01-03"</span>, count=<span class="hljs-github-number" style="color: rgb(0, 128, 128);background: rgba(0, 0, 0, 0);display: inline;width: 14px;text-decoration-style: solid;text-decoration-color: rgb(0, 128, 128);">10</span>,<br>fields=[<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'time'</span>,<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 59px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'current'</span>,<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 53px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'volume'</span>])<br><br>d</code></pre></section><p style="white-space: normal;"><br></p><p style="white-space: normal;"><span style="font-family: DengXian;">上面代码是获取<span style="color: black;">平安银行</span>在 </span>2019 <span style="font-family: DengXian;">年 </span>1 <span style="font-family: DengXian;">月 </span>3 <span style="font-family: DengXian;">日开盘前，即 </span>2019 <span style="font-family: DengXian;">年 </span>1 <span style="font-family: DengXian;">月 </span>2 <span style="font-family: DengXian;">日收盘前 </span>(A <span style="font-family: DengXian;">股是每天下午 </span>15 <span style="font-family: DengXian;">点收盘</span>) <span style="font-family: DengXian;">的 </span>10 <span style="font-family: DengXian;">个 </span>tick <span style="font-family: DengXian;">数据 </span>(<span style="font-family: DengXian;">现价和交易量</span>)<span style="font-family: DengXian;">，得到以下结果是个 </span>record <span style="font-family: DengXian;">类型的数组。该数组有 </span>10 <span style="font-family: DengXian;">条记录，每条记录分别包含时间、现价和交易量。</span></p><p style="white-space: normal;"><br></p><p style="white-space: normal;text-align: center;"><img class="" data-backh="166" data-backw="556" data-before-oversubscription-url="http://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCEnLOffKdMdfGkPCVwpIgPIRbCc9dST32Z383ZXHfnMeCau6dFglHS04HmGF4JUIL6sicHsC9BrUIg/0?wx_fmt=png" data-ratio="0.2980769230769231" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCEnLOffKdMdfGkPCVwpIgPIRbCc9dST32Z383ZXHfnMeCau6dFglHS04HmGF4JUIL6sicHsC9BrUIg/640?wx_fmt=png" data-type="png" data-w="624" style="width: 556.25px;"></p><p style="white-space: normal;"><br></p><p style="white-space: normal;"><span style="font-family: DengXian;">从上面结果来看，时间用了科学计数表现形式，根本看不出来具体的精确到秒的区别，因此我们将 </span>record <span style="font-family: DengXian;">类型数组转换成 </span>list<span style="font-family: DengXian;">。</span></p><p style="white-space: normal;"><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t" style="white-space: normal;"><pre style="margin-top: 0px;margin-bottom: 0px;padding: 0px;background-image: none;background-color: initial;"><code class="hljs-github" style="margin-right: 0.15em;margin-left: 0.15em;padding: 5.95px;border-radius: 4px;font-size: 0.85em;background: rgb(248, 248, 248);display: block;overflow-x: auto;white-space: nowrap;">d.tolist()</code></pre></section><p style="white-space: normal;"><br></p><p style="white-space: normal;text-align: center;"><img class="" data-backh="169" data-backw="539" data-before-oversubscription-url="http://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCEnLOffKdMdfGkPCVwpIgPIlTLvPoy1ibGlcAlYiaJhYeDKjV4K7VB5Q4ic1ChLm2IzV8XpJSU6PU48g/0?wx_fmt=png" data-ratio="0.3141263940520446" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCEnLOffKdMdfGkPCVwpIgPIlTLvPoy1ibGlcAlYiaJhYeDKjV4K7VB5Q4ic1ChLm2IzV8XpJSU6PU48g/640?wx_fmt=png" data-type="png" data-w="538" style="width: 556.25px;"></p><p style="white-space: normal;"><br></p><p style="white-space: normal;"><span style="font-family: DengXian;">现在时间看清楚了，结合 </span>3 <span style="font-family: DengXian;">维张量里的收盘价和交易量，我们发现 </span>tick <span style="font-family: DengXian;">数据最后一行</span> (<span style="font-family: DengXian;">时间是 </span>2019<span style="font-family: DengXian;"> 年 </span>1 <span style="font-family: DengXian;">月 </span>2 <span style="font-family: DengXian;">日 </span>15<span style="font-family: DengXian;"> 点</span>) <span style="font-family: DengXian;">的现价 </span>9.19 <span style="font-family: DengXian;">和交易量 </span>539386 <span style="font-family: DengXian;">和下图右的同一天的平安银行栏下的数据完全吻合。</span></p><p style="white-space: normal;"><br></p><p style="white-space: normal;text-align: center;"><img class="" data-backh="246" data-backw="556" data-before-oversubscription-url="https://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCEnLOffKdMdfGkPCVwpIgPIGaqtcr0RJaib9wGLiaibPHWuDicTgfeN3DTJf9dYXe17WibOSx2OdsXh3FA/0?wx_fmt=png" data-copyright="0" data-ratio="0.4434850863422292" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCEnLOffKdMdfGkPCVwpIgPIGaqtcr0RJaib9wGLiaibPHWuDicTgfeN3DTJf9dYXe17WibOSx2OdsXh3FA/640?wx_fmt=png" data-type="png" data-w="1274" style="width: 556.25px;"></p><p style="white-space: normal;"><br></p><p style="white-space: normal;"><span style="font-family: DengXian;">此外我们发现时间栏下面的数相差为 </span>3<span style="font-family: DengXian;">，即 </span>tick <span style="font-family: DengXian;">大小为 </span>3 <span style="font-family: DengXian;">秒，即交易所每 </span>3 <span style="font-family: DengXian;">秒照一次快照。</span></p><p style="white-space: normal;text-align: center;"><br></p><section class="mpa-template" data-mpa-template-id="882500" data-mpa-color="null" data-mpa-category="收藏"><section><section style="border-width: 0px;border-style: initial;border-color: initial;padding: 0px;margin: 0px auto;text-align: center;white-space: normal;"><section style='background-image:url("https://mmbiz.qpic.cn/mmbiz_png/ianq03UUWGmIDLYyVZsymkTnBibBPxwxoWuIkiaMRfF2nPrvryogjrO4XfhpWegMwicuiapXBQia8qeINYhefTtwGfrQ/640?wx_fmt=png");display:inline-block;margin:0 auto;text-align:left;background-size:auto 50px;background-repeat:no-repeat;width:42px;height:50px;vertical-align:top;line-height:50px;text-align:center;color:#fff;'><p style="font-size: 20px;border-width: 0px;border-style: initial;border-color: initial;padding: 0px;margin: 0px;"><span style="font-size: 16px;font-family: Optima-Regular, PingFangTC-light;">4.3</span></p></section><section style='background-image:url("https://mmbiz.qpic.cn/mmbiz_png/ianq03UUWGmIDLYyVZsymkTnBibBPxwxoWEnrBa7fuiccJgxAndh66NF0fKuTFduWXp2icIoXhBpibVePONwaJ3Jvzg/640?wx_fmt=png");display:inline-block;margin:0 auto;text-align:left;background-size:auto 50px;background-repeat:no-repeat;height:50px;'><section style="display:inline-block;padding-left:10px;line-height:50px;color:#333;margin-top:0;vertical-align:top;"><p style="font-size: 14px;border-width: 0px;border-style: initial;border-color: initial;padding: 0px;margin: 0px;"><span style="color: rgb(255, 41, 65);font-size: 16px;font-family: Optima-Regular, PingFangTC-light;"><strong mpa-from-tpl="t">Quantopian 之美股</strong></span></p></section></section><section style='background-image:url("https://mmbiz.qpic.cn/mmbiz_png/ianq03UUWGmIDLYyVZsymkTnBibBPxwxoWzfenALo6kEeDUGXCyFibSibU24BtebdP2ialR438RwuG8TnZUIv9k8Ubg/640?wx_fmt=png");display:inline-block;margin:0 auto;text-align:left;background-size:auto 50px;background-repeat:no-repeat;width:17px;height:50px;vertical-align:top;'></section></section></section></section><p style="white-space: normal;"><br></p><p style="white-space: normal;">首先引入 Python 基本的 numpy 和 pandas 模块,还有 quantopian.research 特有的 prices 和 symbols 模块。</p><p style="white-space: normal;"><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t" style="white-space: normal;"><pre style="margin-top: 0px;margin-bottom: 0px;padding: 0px;background-image: none;background-color: initial;"><code class="hljs-github" style="margin-right: 0.15em;margin-left: 0.15em;padding: 5.95px;border-radius: 4px;font-size: 0.85em;background: rgb(248, 248, 248);display: block;overflow-x: auto;white-space: nowrap;"><span class="hljs-github-keyword" style="background: rgba(0, 0, 0, 0);display: inline;width: 26px;text-decoration-style: solid;text-decoration-color: rgb(51, 51, 51);font-weight: 700;">from</span> quantopian.research <span class="hljs-github-keyword" style="background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration-style: solid;text-decoration-color: rgb(51, 51, 51);font-weight: 700;">import</span> prices, symbols<br><span class="hljs-github-keyword" style="background: rgba(0, 0, 0, 0);display: inline;width: 40px;text-decoration-style: solid;text-decoration-color: rgb(51, 51, 51);font-weight: 700;">import</span> numpy <span class="hljs-github-keyword" style="background: rgba(0, 0, 0, 0);display: inline;width: 14px;text-decoration-style: solid;text-decoration-color: rgb(51, 51, 51);font-weight: 700;">as</span> np<br><span class="hljs-github-keyword" style="background: rgba(0, 0, 0, 0);display: inline;width: 40px;text-decoration-style: solid;text-decoration-color: rgb(51, 51, 51);font-weight: 700;">import</span> pandas <span class="hljs-github-keyword" style="background: rgba(0, 0, 0, 0);display: inline;width: 14px;text-decoration-style: solid;text-decoration-color: rgb(51, 51, 51);font-weight: 700;">as</span> pd</code></pre></section><section class="mpa-template" data-mpa-template-id="1544155" data-mpa-color="null" data-mpa-category="收藏" style="white-space: normal;"><section><section class="layout"><section style="margin-top: 1em;margin-bottom: 1em;box-sizing: border-box;border-bottom: 2px solid rgb(236, 68, 68);clear: both;"><section style="padding-top: 3px;padding-right: 10px;padding-left: 10px;display: inline-block;color: rgb(255, 255, 255);box-sizing: border-box;border-top-left-radius: 3px;border-top-right-radius: 3px;height: 28px;background-color: rgb(236, 68, 68);">0 维张量：一个收盘价</section><section style="margin-left: 2px;box-sizing: border-box;border-top: 28px solid transparent;border-right-color: rgb(206, 206, 206);border-bottom: 0px solid transparent;border-left: 15px solid rgb(206, 206, 206);display: inline-block;vertical-align: top;"></section></section></section></section></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t" style="white-space: normal;"><pre style="margin-top: 0px;margin-bottom: 0px;padding: 0px;background-image: none;background-color: initial;"><code class="hljs-github" style="margin-right: 0.15em;margin-left: 0.15em;padding: 5.95px;border-radius: 4px;font-size: 0.85em;background: rgb(248, 248, 248);display: block;overflow-x: auto;white-space: nowrap;"><span class="hljs-github-comment" style="color: rgb(153, 153, 136);background: rgba(0, 0, 0, 0);display: inline;width: 224px;text-decoration-style: solid;text-decoration-color: rgb(153, 153, 136);font-style: italic;"># 苹果 (AAPL) 在2019年1月3日的收盘价</span><br>X0 = prices( assets=symbols([<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'AAPL'</span>]), <br>start=<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 78px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'2019-01-03'</span>, end=<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 78px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'2019-01-03'</span> )<br><br><span class="hljs-github-keyword" style="background: rgba(0, 0, 0, 0);display: inline;width: 33px;text-decoration-style: solid;text-decoration-color: rgb(51, 51, 51);font-weight: 700;">print</span> <span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 150px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'The shape of tenor is'</span>, X0.shape<br><span class="hljs-github-keyword" style="background: rgba(0, 0, 0, 0);display: inline;width: 33px;text-decoration-style: solid;text-decoration-color: rgb(51, 51, 51);font-weight: 700;">print</span> <span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 254px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'The shape of tenor (after squeeze) is'</span>, <br>np.squeeze(X0).shape<br><br>X0</code></pre></section><p style="white-space: normal;"><br></p><p style="white-space: normal;"><span style="font-family: DengXian;">结果得到苹果在 </span>2019 <span style="font-family: DengXian;">年 </span>1 <span style="font-family: DengXian;">月 </span>3 <span style="font-family: DengXian;">日的收盘价，<span style="line-height: 21.25px;">记为 </span></span>X0<span style="font-family: DengXian;"><span style="line-height: 21.25px;">，它</span>是一个 </span>1×1 <span style="font-family: DengXian;">的标量，压缩之后的形状是 </span>()<span style="font-family: DengXian;">，是一个 </span>0 <span style="font-family: DengXian;">维张量。</span></p><p style="white-space: normal;"><br></p><p style="white-space: normal;text-align: center;"><img class="" data-backh="99" data-backw="556" data-before-oversubscription-url="http://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCEnLOffKdMdfGkPCVwpIgPIIZg7V0bxVul2WwaKBJ9I8icGAJgS68lRq50ErJbiaGsklaBNQe6RhbFw/0?wx_fmt=png" data-ratio="0.1781305114638448" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCEnLOffKdMdfGkPCVwpIgPIIZg7V0bxVul2WwaKBJ9I8icGAJgS68lRq50ErJbiaGsklaBNQe6RhbFw/640?wx_fmt=png" data-type="png" data-w="567" style="width: 556.25px;"></p><p style="white-space: normal;"><br></p><section class="mpa-template" data-mpa-template-id="1544155" data-mpa-color="null" data-mpa-category="收藏" style="white-space: normal;"><section><section class="layout"><section style="margin-top: 1em;margin-bottom: 1em;box-sizing: border-box;border-bottom: 2px solid rgb(236, 68, 68);clear: both;"><section style="padding-top: 3px;padding-right: 10px;padding-left: 10px;display: inline-block;color: rgb(255, 255, 255);box-sizing: border-box;border-top-left-radius: 3px;border-top-right-radius: 3px;height: 28px;background-color: rgb(236, 68, 68);">1 维张量：加入时间维度</section><section style="margin-left: 2px;box-sizing: border-box;border-top: 28px solid transparent;border-right-color: rgb(206, 206, 206);border-bottom: 0px solid transparent;border-left: 15px solid rgb(206, 206, 206);display: inline-block;vertical-align: top;"></section></section></section></section></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t" style="white-space: normal;"><pre style="margin-top: 0px;margin-bottom: 0px;padding: 0px;background-image: none;background-color: initial;"><code class="hljs-github" style="margin-right: 0.15em;margin-left: 0.15em;padding: 5.95px;border-radius: 4px;font-size: 0.85em;background: rgb(248, 248, 248);display: block;overflow-x: auto;white-space: nowrap;"><span class="hljs-github-comment" style="color: rgb(153, 153, 136);background: rgba(0, 0, 0, 0);display: inline;width: 278px;text-decoration-style: solid;text-decoration-color: rgb(153, 153, 136);font-style: italic;"># 苹果 (AAPL) 从2019年1月3日起的5天历史收盘价</span><br>X1 = prices( assets=symbols([<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'AAPL'</span>]), <br>start=<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 78px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'2018-12-27'</span>, end=<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 78px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'2019-01-03'</span> )<br><br><span class="hljs-github-keyword" style="background: rgba(0, 0, 0, 0);display: inline;width: 33px;text-decoration-style: solid;text-decoration-color: rgb(51, 51, 51);font-weight: 700;">print</span> <span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 150px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'The shape of tenor is'</span>, X1.shape<br><span class="hljs-github-keyword" style="background: rgba(0, 0, 0, 0);display: inline;width: 33px;text-decoration-style: solid;text-decoration-color: rgb(51, 51, 51);font-weight: 700;">print</span> <span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 254px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'The shape of tenor (after squeeze) is'</span>, np.squeeze(X1).shape<br><br>X1</code></pre></section><p style="white-space: normal;"><br></p><p><span style="font-family: DengXian;">结果得到苹果从 </span>2019 <span style="font-family: DengXian;">年 </span>1 <span style="font-family: DengXian;">月 </span>3 <span style="font-family: DengXian;">日起</span> 5<span style="color: red;"> </span><span style="font-family: DengXian;color: red;">天的历史收盘价</span><span style="font-family: DengXian;">，记为 </span>X1<span style="font-family: DengXian;">，它是一个 </span>5×1 <span style="font-family: DengXian;">的向量，压缩之后的形状是 </span>(5,)<span style="font-family: DengXian;">，是一个 </span>1 <span style="font-family: DengXian;">维张量。</span></p><p style="white-space: normal;"><br></p><p style="white-space: normal;text-align: center;"><img class="" data-backh="203" data-backw="556" data-before-oversubscription-url="http://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCEnLOffKdMdfGkPCVwpIgPIg6hptP8tgfmXmy1WEt0AckODTmlzSql6icYEsSq75pK0CePic3ZBzbiaQ/0?wx_fmt=png" data-ratio="0.3644524236983842" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCEnLOffKdMdfGkPCVwpIgPIg6hptP8tgfmXmy1WEt0AckODTmlzSql6icYEsSq75pK0CePic3ZBzbiaQ/640?wx_fmt=png" data-type="png" data-w="557" style="width: 556.25px;"></p><p style="white-space: normal;"><br></p><section class="mpa-template" data-mpa-template-id="1544155" data-mpa-color="null" data-mpa-category="收藏" style="white-space: normal;"><section><section class="layout"><section style="margin-top: 1em;margin-bottom: 1em;box-sizing: border-box;border-bottom: 2px solid rgb(236, 68, 68);clear: both;"><section style="padding-top: 3px;padding-right: 10px;padding-left: 10px;display: inline-block;color: rgb(255, 255, 255);box-sizing: border-box;border-top-left-radius: 3px;border-top-right-radius: 3px;height: 28px;background-color: rgb(236, 68, 68);">2 维张量：加入股票维度</section><section style="margin-left: 2px;box-sizing: border-box;border-top: 28px solid transparent;border-right-color: rgb(206, 206, 206);border-bottom: 0px solid transparent;border-left: 15px solid rgb(206, 206, 206);display: inline-block;vertical-align: top;"></section></section></section></section></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t" style="white-space: normal;"><pre style="margin-top: 0px;margin-bottom: 0px;padding: 0px;background-image: none;background-color: initial;"><code class="hljs-github" style="margin-right: 0.15em;margin-left: 0.15em;padding: 5.95px;border-radius: 4px;font-size: 0.85em;background: rgb(248, 248, 248);display: block;overflow-x: auto;white-space: nowrap;"><span class="hljs-github-comment" style="color: rgb(153, 153, 136);background: rgba(0, 0, 0, 0);display: inline;width: 164px;text-decoration-style: solid;text-decoration-color: rgb(153, 153, 136);font-style: italic;"># 苹果 (AAPL) 和脸书 (FB) </span><br><span class="hljs-github-comment" style="color: rgb(153, 153, 136);background: rgba(0, 0, 0, 0);display: inline;width: 201px;text-decoration-style: solid;text-decoration-color: rgb(153, 153, 136);font-style: italic;"># 从2019年1月3日起的5天历史收盘价</span><br><br>X2 = prices( assets=symbols([<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'AAPL'</span>,<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 26px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'FB'</span>]), <br>start=<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 78px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'2018-12-27'</span>, end=<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 78px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'2019-01-03'</span> )<br><br><span class="hljs-github-keyword" style="background: rgba(0, 0, 0, 0);display: inline;width: 33px;text-decoration-style: solid;text-decoration-color: rgb(51, 51, 51);font-weight: 700;">print</span> <span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 150px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'The shape of tenor is'</span>, X2.shape<br><span class="hljs-github-keyword" style="background: rgba(0, 0, 0, 0);display: inline;width: 33px;text-decoration-style: solid;text-decoration-color: rgb(51, 51, 51);font-weight: 700;">print</span> <span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 254px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'The shape of tenor (after squeeze) is'</span>, np.squeeze(X2).shape<br><br>X2</code></pre></section><p style="white-space: normal;"><br></p><p style="white-space: normal;"><span style="font-family: DengXian;">结果得到<span style="color: red;">苹果和脸书</span>从 </span>2019 <span style="font-family: DengXian;">年 </span>1 <span style="font-family: DengXian;">月 </span>3 <span style="font-family: DengXian;">日起 </span><span style="color: black;">5 </span><span style="font-family: DengXian;color: black;">天的历史收盘价</span><span style="font-family: DengXian;">，记为 </span>X2<span style="font-family: DengXian;">，它是一个 </span>5×2 <span style="font-family: DengXian;">的张量。</span>X2 <span style="font-family: DengXian;">压缩之后的形状还是 </span>(5, 2)<span style="font-family: DengXian;">，是一个 </span>2 <span style="font-family: DengXian;">维张量。</span></p><p style="white-space: normal;"><br></p><p style="white-space: normal;text-align: center;"><img class="" data-backh="195" data-backw="556" data-before-oversubscription-url="http://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCEnLOffKdMdfGkPCVwpIgPI0wtCELjbu1NrdFPYoSfhoVAxPqygDjT3icDoicKZkkwp9EB8WiaSDopyw/0?wx_fmt=png" data-ratio="0.35075885328836426" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCEnLOffKdMdfGkPCVwpIgPI0wtCELjbu1NrdFPYoSfhoVAxPqygDjT3icDoicKZkkwp9EB8WiaSDopyw/640?wx_fmt=png" data-type="png" data-w="593" style="width: 556.25px;"></p><p style="white-space: normal;"><br></p><section class="mpa-template" data-mpa-template-id="1544155" data-mpa-color="null" data-mpa-category="收藏" style="white-space: normal;"><section><section class="layout"><section style="margin-top: 1em;margin-bottom: 1em;box-sizing: border-box;border-bottom: 2px solid rgb(236, 68, 68);clear: both;"><section style="padding-top: 3px;padding-right: 10px;padding-left: 10px;display: inline-block;color: rgb(255, 255, 255);box-sizing: border-box;border-top-left-radius: 3px;border-top-right-radius: 3px;height: 28px;background-color: rgb(236, 68, 68);">3 维张量：加入信息维度</section><section style="margin-left: 2px;box-sizing: border-box;border-top: 28px solid transparent;border-right-color: rgb(206, 206, 206);border-bottom: 0px solid transparent;border-left: 15px solid rgb(206, 206, 206);display: inline-block;vertical-align: top;"></section></section></section></section></section><p style="white-space: normal;"><span style="font-family: DengXian;">在 </span>Quantopian <span style="font-family: DengXian;">框架中，</span>prices <span style="font-family: DengXian;">和 </span>volume <span style="font-family: DengXian;">是分开的物体，因此不能够像聚宽那样用 </span>get_price <span style="font-family: DengXian;">函数将这两个信息一次性获取</span>(<span style="font-family: DengXian;">只需设定 </span>fields =[<span style="font-size: 14px;"><span style="color: rgb(186, 33, 33);">'close'</span>,<span style="color: rgb(186, 33, 33);">'volume'</span></span>])<span style="font-family: DengXian;">。要在 </span>Quantopian <span style="font-family: DengXian;">达到同样效果，必须使用自带的 </span>Pipeline<span style="font-family: DengXian;">。</span>Pipeline <span style="font-family: DengXian;">中文是管道的意思，在这里指的是贯穿了整个数据系统的一个管道，使得使用者能够集中精力从数据中获取所需要的信息，而不是把精力花费在管理日常数据和管理数据库方面。通俗来说，</span>Pipeline <span style="font-family: DengXian;">就是自动化数据工作的利器。</span></p><p style="white-space: normal;"> <br></p><p style="white-space: normal;"><span style="font-family: DengXian;">首先引入下面四个模块，前两个用来创建和运行</span>Pipeline<span style="font-family: DengXian;">，</span>USEquityPricing <span style="font-family: DengXian;">储存了美股的各种信息，</span>StaticAssets <span style="font-family: DengXian;">提供了一组固定资产代码而用于调试 </span>Pipeline <span style="font-family: DengXian;">的功能 </span>(<span style="font-family: DengXian;">后面解释</span>)<span style="font-family: DengXian;">。</span></p><p style="white-space: normal;"><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t" style="white-space: normal;"><pre style="margin-top: 0px;margin-bottom: 0px;padding: 0px;background-image: none;background-color: initial;"><code class="hljs-github" style="margin-right: 0.15em;margin-left: 0.15em;padding: 5.95px;border-radius: 4px;font-size: 0.85em;background: rgb(248, 248, 248);display: block;overflow-x: auto;white-space: nowrap;"><span class="hljs-github-keyword" style="background: rgba(0, 0, 0, 0);display: inline;width: 26px;text-decoration-style: solid;text-decoration-color: rgb(51, 51, 51);font-weight: 700;">from</span> quantopian.pipeline <span class="hljs-github-keyword" style="background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration-style: solid;text-decoration-color: rgb(51, 51, 51);font-weight: 700;">import</span> Pipeline<br><span class="hljs-github-keyword" style="background: rgba(0, 0, 0, 0);display: inline;width: 26px;text-decoration-style: solid;text-decoration-color: rgb(51, 51, 51);font-weight: 700;">from</span> quantopian.research <span class="hljs-github-keyword" style="background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration-style: solid;text-decoration-color: rgb(51, 51, 51);font-weight: 700;">import</span> run_pipeline<br><span class="hljs-github-keyword" style="background: rgba(0, 0, 0, 0);display: inline;width: 26px;text-decoration-style: solid;text-decoration-color: rgb(51, 51, 51);font-weight: 700;">from</span> quantopian.pipeline.data <span class="hljs-github-keyword" style="background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration-style: solid;text-decoration-color: rgb(51, 51, 51);font-weight: 700;">import</span> USEquityPricing<br><span class="hljs-github-keyword" style="background: rgba(0, 0, 0, 0);display: inline;width: 26px;text-decoration-style: solid;text-decoration-color: rgb(51, 51, 51);font-weight: 700;">from</span> quantopian.pipeline.filters <span class="hljs-github-keyword" style="background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration-style: solid;text-decoration-color: rgb(51, 51, 51);font-weight: 700;">import</span> StaticAssets</code></pre></section><p style="white-space: normal;"><br></p><p style="white-space: normal;"><span style="font-family: DengXian;">要想用 </span>Pipeline<span style="font-family: DengXian;">，必先建 </span>Pipeline<span style="font-family: DengXian;">。以下代码创建一个数据表 </span>(dataframe)<span style="font-family: DengXian;">，限定关注的信息是收盘价和交易量，限定关注的股票是苹果和脸书。</span></p><p style="white-space: normal;"><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t" style="white-space: normal;"><pre style="margin-top: 0px;margin-bottom: 0px;padding: 0px;background-image: none;background-color: initial;"><code class="hljs-github" style="margin-right: 0.15em;margin-left: 0.15em;padding: 5.95px;border-radius: 4px;font-size: 0.85em;background: rgb(248, 248, 248);display: block;overflow-x: auto;white-space: nowrap;"><span class="hljs-github-function" style="background: rgba(0, 0, 0, 0);display: inline;width: 131px;text-decoration-style: solid;text-decoration-color: rgb(51, 51, 51);"><span class="hljs-github-keyword" style="background: rgba(0, 0, 0, 0);display: inline;width: 20px;text-decoration-style: solid;text-decoration-color: rgb(51, 51, 51);font-weight: 700;">def</span> <span class="hljs-github-title" style="color: rgb(153, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 85px;text-decoration-style: solid;text-decoration-color: rgb(153, 0, 0);font-weight: 700;">make_pipeline</span><span class="hljs-github-params" style="background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration-style: solid;text-decoration-color: rgb(51, 51, 51);">()</span>:</span><br>   <br>   close_price = USEquityPricing.close.latest<br>   volume = USEquityPricing.volume.latest<br>   <br>   <span class="hljs-github-keyword" style="background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration-style: solid;text-decoration-color: rgb(51, 51, 51);font-weight: 700;">return</span> Pipeline(<br>       columns = {<br>           <span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'close'</span>: close_price,<br>           <span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 53px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'volume'</span>: volume,<br>       },<br>       screen = StaticAssets(symbols([<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'AAPL'</span>,<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 26px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'FB'</span>])),<br>   )</code></pre></section><p style="white-space: normal;"><br></p><p style="white-space: normal;"><span style="font-family: DengXian;">建完 </span>Pipeline<span style="font-family: DengXian;">，就可运行。用 </span>run_pipeline <span style="font-family: DengXian;">函数加上对日期的限定就可以了。</span></p><p style="white-space: normal;"><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t" style="white-space: normal;"><pre style="margin-top: 0px;margin-bottom: 0px;padding: 0px;background-image: none;background-color: initial;"><code class="hljs-github" style="margin-right: 0.15em;margin-left: 0.15em;padding: 5.95px;border-radius: 4px;font-size: 0.85em;background: rgb(248, 248, 248);display: block;overflow-x: auto;white-space: nowrap;">X3 = run_pipeline(<br>   make_pipeline(),<br>   start_date=<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 78px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'2018-12-27'</span>,<br>   end_date=<span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 79px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'2019-01-03'</span>,<br>)<br><br><span class="hljs-github-keyword" style="background: rgba(0, 0, 0, 0);display: inline;width: 33px;text-decoration-style: solid;text-decoration-color: rgb(51, 51, 51);font-weight: 700;">print</span> <span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 150px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'The shape of tenor is'</span>, X3.shape<br><span class="hljs-github-keyword" style="background: rgba(0, 0, 0, 0);display: inline;width: 33px;text-decoration-style: solid;text-decoration-color: rgb(51, 51, 51);font-weight: 700;">print</span> <span class="hljs-github-string" style="color: rgb(221, 17, 68);background: rgba(0, 0, 0, 0);display: inline;width: 254px;text-decoration-style: solid;text-decoration-color: rgb(221, 17, 68);">'The shape of tenor (after squeeze) is'</span>, np.squeeze(X3).shape<br><br>X3</code></pre></section><p style="white-space: normal;"><br></p><p style="white-space: normal;"><span style="font-family: DengXian;">结果得到苹果和脸书从 </span>2019 <span style="font-family: DengXian;">年 </span>1 <span style="font-family: DengXian;">月 </span>3 <span style="font-family: DengXian;">日起 </span><span style="color: black;">5 </span><span style="font-family: DengXian;color: black;">天的历史收盘价和交易量</span><span style="font-family: DengXian;">，记为 </span>X3<span style="font-family: DengXian;">，它是一个 </span>10×2 <span style="font-family: DengXian;">的张量。咋一看它不是 </span>3 <span style="font-family: DengXian;">维而是 </span>2 <span style="font-family: DengXian;">维张量，但是从下面数据表的结构可看出它是一个 </span>MultiIndex <span style="font-family: DengXian;">的表。在行上有两层，第一层是时间层，第二层是股票层，而列是信息层。表面上看 </span>X3 <span style="font-family: DengXian;">是个 </span>2 <span style="font-family: DengXian;">维张量，实质上它是个 </span>3 <span style="font-family: DengXian;">维张量。</span></p><p style="white-space: normal;"><br></p><p style="white-space: normal;text-align: center;"><img class="" data-backh="275" data-backw="556" data-before-oversubscription-url="http://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCEnLOffKdMdfGkPCVwpIgPI8ObMlnGU0iavVteqvQptLtxnyKr4QCx5wjAZVlWWCrTYvzlfzuU0ZQw/0?wx_fmt=png" data-oversubscription-url="http://mmbiz.qpic.cn/mmbiz_jpg/e4kxNicDVcCEnLOffKdMdfGkPCVwpIgPIMulZw1cq2KgDddbiaicZkhz7W6oNBbPlOAB3FfW9Gfqrp7T8SUIEK7hg/0?wx_fmt=jpeg" data-ratio="0.4947683109118087" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_jpg/e4kxNicDVcCEnLOffKdMdfGkPCVwpIgPIMulZw1cq2KgDddbiaicZkhz7W6oNBbPlOAB3FfW9Gfqrp7T8SUIEK7hg/640?wx_fmt=jpeg" data-type="jpeg" data-w="669" style="width: 556.25px;"></p><p style="white-space: normal;"><br></p><section class="mpa-template" data-mpa-template-id="1544155" data-mpa-color="null" data-mpa-category="收藏" style="white-space: normal;"><section><section class="layout"><section style="margin-top: 1em;margin-bottom: 1em;box-sizing: border-box;border-bottom: 2px solid rgb(236, 68, 68);clear: both;"><section style="padding-top: 3px;padding-right: 10px;padding-left: 10px;display: inline-block;color: rgb(255, 255, 255);box-sizing: border-box;border-top-left-radius: 3px;border-top-right-radius: 3px;height: 28px;background-color: rgb(236, 68, 68);">4 维张量：加入频率维度</section><section style="margin-left: 2px;box-sizing: border-box;border-top: 28px solid transparent;border-right-color: rgb(206, 206, 206);border-bottom: 0px solid transparent;border-left: 15px solid rgb(206, 206, 206);display: inline-block;vertical-align: top;"></section></section></section></section></section><p style="white-space: normal;"><span style="font-family: DengXian;">找了半天，好像 </span>Quantoptian <span style="font-family: DengXian;">不支持 </span>tick <span style="font-family: DengXian;">数据的获取。这点要给聚宽点个赞。</span></p><p style="white-space: normal;"><br></p><p style="white-space: normal;"><br></p><section class="mpa-template" data-mpa-template-id="882154" data-mpa-color="null" data-mpa-category="收藏" style="white-space: normal;"><section><section style="padding: 10px;"><section class="autonum" style="float: left;width: 40px;height: 40px;text-align: center;color: rgb(255, 255, 255);background-color: rgb(13, 12, 12);font-size: 24px;line-height: 40px;">5</section><section style="padding-right: 15px;padding-left: 15px;width: auto;display: inline-block;float: left;height: 40px;font-size: 18px;line-height: 35px;border-bottom: 2px solid rgb(13, 12, 12);border-top: 2px solid rgb(13, 12, 12);">张量运算</section><section style='background-image: url("https://mmbiz.qpic.cn/mmbiz_png/fgnkxfGnnkSBJo13oUicPbCbqeTcIyiakNc2UGmnmA1qH7HExsicAyuzE3Foogxo1VmRNr68icYkKibV0wM7nqTIHng/640?wx_fmt=png");width: 18px;height: 40px;float: left;background-repeat: no-repeat;background-color: rgb(13, 12, 12);background-size: 100% 40px;'></section></section><section style="width: 556.25px;clear: both;"></section></section></section><p style="white-space: normal;"><br></p><section class="mpa-template" data-mpa-template-id="882500" data-mpa-color="null" data-mpa-category="收藏"><section><section style="border-width: 0px;border-style: initial;border-color: initial;padding: 0px;margin: 0px auto;text-align: center;white-space: normal;"><section style='background-image:url("https://mmbiz.qpic.cn/mmbiz_png/ianq03UUWGmIDLYyVZsymkTnBibBPxwxoWuIkiaMRfF2nPrvryogjrO4XfhpWegMwicuiapXBQia8qeINYhefTtwGfrQ/640?wx_fmt=png");display:inline-block;margin:0 auto;text-align:left;background-size:auto 50px;background-repeat:no-repeat;width:42px;height:50px;vertical-align:top;line-height:50px;text-align:center;color:#fff;'><p style="font-size: 20px;border-width: 0px;border-style: initial;border-color: initial;padding: 0px;margin: 0px;"><span style="font-size: 16px;font-family: Optima-Regular, PingFangTC-light;">5.1</span></p></section><section style='background-image:url("https://mmbiz.qpic.cn/mmbiz_png/ianq03UUWGmIDLYyVZsymkTnBibBPxwxoWEnrBa7fuiccJgxAndh66NF0fKuTFduWXp2icIoXhBpibVePONwaJ3Jvzg/640?wx_fmt=png");display:inline-block;margin:0 auto;text-align:left;background-size:auto 50px;background-repeat:no-repeat;height:50px;'><section style="display:inline-block;padding-left:10px;line-height:50px;color:#333;margin-top:0;vertical-align:top;"><p style="font-size: 14px;border-width: 0px;border-style: initial;border-color: initial;padding: 0px;margin: 0px;"><span style="color: rgb(255, 41, 65);font-size: 16px;font-family: Optima-Regular, PingFangTC-light;"><strong mpa-from-tpl="t">化繁为简</strong></span></p></section></section><section style='background-image:url("https://mmbiz.qpic.cn/mmbiz_png/ianq03UUWGmIDLYyVZsymkTnBibBPxwxoWzfenALo6kEeDUGXCyFibSibU24BtebdP2ialR438RwuG8TnZUIv9k8Ubg/640?wx_fmt=png");display:inline-block;margin:0 auto;text-align:left;background-size:auto 50px;background-repeat:no-repeat;width:17px;height:50px;vertical-align:top;'></section></section></section></section><p><span style="font-family: DengXian;"></span><br></p><p><span style="font-family: DengXian;">深度学习中的神经网络本质就是张量运算，本节用最简单的神经网络 </span>(<span style="font-family: DengXian;">没有隐藏层</span>) <span style="font-family: DengXian;">来列举所有类型的张量运算。</span></p><p style="text-align: center;"><br></p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="0.6134680134680135" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCG67olIO7NH4LibhJeKIKGUrhw7eokzLzM56vKdXiabIJoPibLIh6ohFr1cZTODQvXiakpq0NDoDY1gxQ/640?wx_fmt=png" data-type="png" data-w="1485" style=""></p><p style="white-space: normal;"><span style="font-family: DengXian;"><br></span></p><p style="white-space: normal;"><span style="font-family: DengXian;">上图实际上是用神经网络来识别手写数字 </span>(MNIST <span style="font-family: DengXian;">的数据</span>)<span style="font-family: DengXian;">，大概分四个步骤：</span> </p><p style="white-space: normal;"><br></p><ol class=" list-paddingleft-2" style="list-style-type: decimal;"><li><p style="white-space: normal;"><span style="font-family: DengXian;">提取黑白图像的像素矩阵，重塑成向量 </span>X</p></li><li><p style="white-space: normal;"><span style="font-family: DengXian;">用权重矩阵 </span>W <span style="font-family: DengXian;">点乘 </span>X</p></li><li><p style="white-space: normal;"><span style="font-family: DengXian;">加上偏置向量 </span>b</p></li><li><p style="white-space: normal;"><span style="font-family: DengXian;">将分数向量 </span>WX + b <span style="font-family: DengXian;">用 </span>softmax <span style="font-family: DengXian;">转换成概率向量</span></p></li></ol><p><br></p><p><span style="font-family:DengXian;">对应的概率值最大的位置索引便是图像里的数字，上图数字 </span>9 <span style="font-family:DengXian;">对应的概率为 </span>0.97<span style="font-family:DengXian;">，因此推断图片里是 </span>9<span style="font-family:DengXian;">。</span></p><p><br></p><p><span style="font-family:DengXian;">将上述四步，从输入到输出用一个公式表示：</span></p><p><span style="font-family:DengXian;"><br></span></p><p style="text-align: center;"><img class="" data-backh="158" data-backw="556" data-before-oversubscription-url="http://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCHVPPx0L69g3S3djpe1XibftgXULXHLjbfNcmCCsicexf6j3VicfbscdwXSth4NMKJzhSmEHOGXf2WJg/0?wx_fmt=png" data-ratio="0.2824074074074074" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCHVPPx0L69g3S3djpe1XibftgXULXHLjbfNcmCCsicexf6j3VicfbscdwXSth4NMKJzhSmEHOGXf2WJg/640?wx_fmt=png" data-type="png" data-w="648" style="width: 100%;height: auto;"></p><p style="white-space: normal;"><br></p><p><span style="font-family:DengXian;">复杂的公式里面涉及到四类张量运算，从里到外按顺序来看：</span></p><p><br></p><ol class=" list-paddingleft-2" style="list-style-type: decimal;"><li><p><span style="font-family: DengXian;">重塑形状 </span>(reshape)</p></li><li><p><span style='font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 9px;line-height: normal;font-family: "Times New Roman"'> </span><span style="font-family: DengXian;">张量点乘 </span>(tensor dot)</p></li><li><p><span style="font-family: DengXian;">广播机制 </span>(boardcasting)</p></li><li><p><span style="font-family: DengXian;">元素层面 </span>(element-wise)</p></li></ol><p style="white-space: normal;"><br></p><p><span style="font-family:DengXian;">下面我们来各个击破。</span></p><section class="mpa-template" data-mpa-template-id="921851" data-mpa-color="null" data-mpa-category="收藏"><section><section class="layout"><section style="margin: 1em 0px;color: rgb(51, 51, 51);box-sizing: border-box;border-bottom: 2px solid rgb(236, 68, 68);clear: both;"><section style="display: inline-block;padding:3px 10px 0px;color: rgb(255, 255, 255);box-sizing:border-box;border-top-left-radius: 3px;border-top-right-radius: 3px;height: 28px;background-color: rgb(236, 68, 68);"><strong>重塑形状</strong></section><section style="box-sizing:border-box;border-top-width:28px;border-top-style: solid;border-color: transparent rgb(206,206,206);border-bottom-width: 0px;border-bottom-style: solid;border-left-width: 15px;border-left-style: solid;display: inline-block;margin-left:2px;vertical-align:top;"></section></section></section></section></section><p><span style="font-family: DengXian;">重塑张量的形状意味着重新排列各个维度的元素个数以匹配目标形状。重塑形成的张量和初始张量有同样的元素。</span></p><p><span style="font-family: DengXian;"><br></span></p><p style="text-align: center;"><img class="" data-backh="270" data-backw="556" data-before-oversubscription-url="http://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCHVPPx0L69g3S3djpe1XibftDmtVVRicqwn4M8KGYrjKGS8WhPJib6Ox1b6cTPtVvNVn4EJgDAzF0CIw/0?wx_fmt=png" data-ratio="0.4855813953488372" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCHVPPx0L69g3S3djpe1XibftDmtVVRicqwn4M8KGYrjKGS8WhPJib6Ox1b6cTPtVvNVn4EJgDAzF0CIw/640?wx_fmt=png" data-type="png" data-w="1075" style="width: 100%;height: auto;"></p><p><span style="font-family: DengXian;"></span></p><p><span style="font-family: DengXian;">再看三个简单例子。</span></p><p><br></p><p><strong><span style="font-family: DengXian;">例一</span></strong><span style="font-family: DengXian;">：生成一个 </span>3×2 <span style="font-family: DengXian;">的矩阵，该矩阵里有 </span>6 <span style="font-family: DengXian;">个元素。</span></p><p><span style="font-family: DengXian;"><br></span></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(35, 36, 31);color: rgb(248, 248, 242);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-sublime">x = np.array( [[<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">0</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">1</span>], [<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">2</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">3</span>], [<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">4</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">5</span>]] )<br>print(x.shape)<br>x</code></pre></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(255, 255, 255);color: rgb(0, 0, 0);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-vs">(<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">3</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">2</span>)<br><br>array([[<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">0</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">1</span>],<br>       [<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">2</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">3</span>],<br>       [<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">4</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">5</span>]])</code></pre></section><p><br></p><p><span style="font-family:DengXian;"><strong><strong style="white-space: normal;"><span style="font-family: DengXian;">例二</span></strong><span style="font-family: DengXian;">：</span></strong>重塑成 </span>6×1 <span style="font-family:DengXian;">的矩阵，也是 </span>6 <span style="font-family:DengXian;">个元素，因此使用 </span>reshape <span style="font-family:DengXian;">不会报错。需要注意的是在 </span>python <span style="font-family:DengXian;">里是按行来获取元素来排列的 </span>(Matlab <span style="font-family:DengXian;">是按列来获取</span>)<span style="font-family:DengXian;">。</span></p><p><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(35, 36, 31);color: rgb(248, 248, 242);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-sublime">x = x.reshape( <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">6</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">1</span> )<br>print(x.shape)<br>x</code></pre></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(255, 255, 255);color: rgb(0, 0, 0);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-vs">(<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">6</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">1</span>)<br><br>array([[<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">0</span>],<br>       [<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">1</span>],<br>       [<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">2</span>],<br>       [<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">3</span>],<br>       [<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">4</span>],<br>       [<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">5</span>]])</code></pre></section><p><br></p><p><span style="font-family:DengXian;"><strong style="white-space: normal;"><span style="font-family: DengXian;">例三</span></strong><span style="font-family: DengXian;">：</span>重塑成 </span>2×3 <span style="font-family:DengXian;">的矩阵，也是 </span>6 <span style="font-family:DengXian;">个元素，因此使用 </span>reshape <span style="font-family:DengXian;">不会报错。这里在 </span>reshape <span style="font-family:DengXian;">函数的第二个参数放的是 </span><span style="color: rgb(172, 57, 255);">-1</span><span style="font-family:DengXian;">，意思就是我不知道或者不想费力来设定这一维度的元素个数，</span>python <span style="font-family:DengXian;">来帮我算出，结果也看到了是 </span>3<span style="font-family:DengXian;">。因此 </span>reshape(2, -<span style="color: rgb(172, 57, 255);">1</span>) <span style="font-family:DengXian;">和 </span>reshape(2, <span style="color: rgb(172, 57, 255);">3</span>) <span style="font-family:DengXian;">是等价的，只不过使用起来更方便。</span></p><p><span style="font-family:DengXian;"><br></span></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(35, 36, 31);color: rgb(248, 248, 242);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-sublime">x = x.reshape( <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">2</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 14px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">-1</span> )<br>print(x.shape)<br>x</code></pre></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(255, 255, 255);color: rgb(0, 0, 0);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-vs">(<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">2</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">3</span>)<br><br>array([[<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">0</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">1</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">2</span>],<br>       [<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">3</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">4</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">5</span>]])</code></pre></section><p><br></p><section class="mpa-template" data-mpa-template-id="921851" data-mpa-color="null" data-mpa-category="收藏"><section><section class="layout"><section style="margin: 1em 0px;color: rgb(51, 51, 51);box-sizing:border-box;border-bottom-width: 2px;border-bottom-style: solid;border-bottom-color: rgb(236, 68, 68);clear: both;"><section style="display: inline-block;padding:3px 10px 0px;color: rgb(255, 255, 255);box-sizing:border-box;border-top-left-radius: 3px;border-top-right-radius: 3px;height: 28px;background-color: rgb(236, 68, 68);"><strong>张量点乘</strong></section><section style="box-sizing:border-box;border-top-width:28px;border-top-style: solid;border-color: transparent rgb(206,206,206);border-bottom-width: 0px;border-bottom-style: solid;border-left-width: 15px;border-left-style: solid;display: inline-block;margin-left:2px;vertical-align:top;"></section></section></section></section></section><p><span style="font-family: DengXian;">在 </span>python <span style="font-family: DengXian;"><span style="font-family: DengXian;"><span style="font-family: DengXian;">中</span>乘法指的是在元素层面做乘法，用符号 “</span>*<span style="font-family: DengXian;">”。</span>在 </span>numpy <span style="font-family: DengXian;">中，点乘指的不是在元素层面做乘法，用 </span>np.dot <span style="font-family: DengXian;">函数。点乘左右两边最常见的张量就是</span></p><p> </p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p><span style="font-family:DengXian;">向量 </span>(1D) <span style="font-family:DengXian;">和向量 </span>(1D)</p></li><li><p><span style="font-family:DengXian;">矩阵 </span>(2D) <span style="font-family:DengXian;">和向量 </span>(1D)</p></li><li><p><span style="font-family:DengXian;">矩阵 </span>(2D) <span style="font-family:DengXian;">和矩阵 </span>(2D)</p></li></ul><p><br></p><p><span style="font-family:DengXian;">分别看看三个简单例子。</span></p><p><span style="font-family:DengXian;"><br></span></p><p><strong><span style="font-family:DengXian;">例一</span></strong><span style="font-family:DengXian;">：</span>np.dot(<span style="font-family:DengXian;">向量</span>, <span style="font-family:DengXian;">向量</span>) <span style="font-family:DengXian;">实际上做的就是内积，即把两个向量每个元素相乘，最后再加总。<span style="font-family: DengXian;">点乘结果 </span></span>10<span style="font-family:DengXian;"> <span style="font-family: DengXian;">是个标量 </span>(</span>0D<span style="font-family:DengXian;"> <span style="font-family: DengXian;">张量</span>)<span style="font-family: DengXian;">，形状 </span></span>= ()<span style="font-family: DengXian;">。</span></p><p><span style="font-family:DengXian;"></span><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(35, 36, 31);color: rgb(248, 248, 242);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-sublime">x = np.array( [<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">1</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">2</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">3</span>] )<br>y = np.array( [<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">3</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">2</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">1</span>] )<br>z = np.dot(x,y)<br>print(z.shape)<br>z</code></pre></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(255, 255, 255);color: rgb(0, 0, 0);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-vs">()<br><span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 14px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">10</span></code></pre></section><p><br></p><p><strong><span style="font-family:DengXian;">例二</span></strong><span style="font-family:DengXian;">：</span>np.dot(<span style="font-family:DengXian;">矩阵</span>, <span style="font-family:DengXian;">向量</span>) <span style="font-family:DengXian;">实际上做的就是普通的矩阵乘以向量。点乘结果是个向量 </span>(1D <span style="font-family:DengXian;">张量</span>)<span style="font-family:DengXian;">，形状 </span>= (2, )<span style="font-family:DengXian;">。</span></p><p><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(35, 36, 31);color: rgb(248, 248, 242);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-sublime">x = np.array( [<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">1</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">2</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">3</span>] )<br>y = np.array( [[<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">3</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">2</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">1</span>], [<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">1</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">1</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">1</span>]] )<br>z = np.dot(y,x)<br>print(z.shape)<br>z</code></pre></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(255, 255, 255);color: rgb(0, 0, 0);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-vs">(<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">2</span>,)<br>array([<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">10</span>,  <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">6</span>])</code></pre></section><p><span style="font-family: DengXian;"></span><br></p><p><strong><span style="font-family:DengXian;">例三</span></strong><span style="font-family:DengXian;">：</span>np.dot(<span style="font-family:DengXian;">矩阵</span>, <span style="font-family:DengXian;">矩阵</span>) <span style="font-family:DengXian;">实际上做的就是普通的矩阵乘以矩阵。点乘结果是个矩阵 </span>(2D <span style="font-family:DengXian;">张量</span>)<span style="font-family:DengXian;">，形状 </span>= (2, 3)<span style="font-family:DengXian;">。</span></p><p><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(35, 36, 31);color: rgb(248, 248, 242);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-sublime">x = np.array( [[<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">1</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">2</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">3</span>], [<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">1</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">2</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">3</span>], [<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">1</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">2</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">3</span>]] )<br>y = np.array( [[<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">3</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">2</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">1</span>], [<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">1</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">1</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">1</span>]] )<br>z = np.dot(y,x)<br>print(z.shape)<br>z</code></pre></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(255, 255, 255);color: rgb(0, 0, 0);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-vs">(<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">2</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">3</span>)<br>array([[ <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">6</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">12</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">18</span>],<br>       [ <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">3</span>,  <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">6</span>,  <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">9</span>]])</code></pre></section><p><span style="font-family: DengXian;"></span></p><section class="mpa-template" data-mpa-template-id="998729" data-mpa-color="null" data-mpa-category="收藏"><section style="background-color: rgb(250, 255, 250);border-width: 1px;border-style: solid;border-color: rgb(148, 209, 224);box-shadow: rgba(148, 209, 224, 0.5) 5px 5px 0px;padding: 10px;margin: 12px;line-height: 22px;font-size: 14px;color: rgb(113, 113, 113);text-align: justify;"><p style="margin:0;padding:0;"><span style="font-size: 17px;">从例二和例三看出，当 x 第二个维度的元素 (x.shape[1]) 和 y 第一个维度的元素 (y.shape[0]) 个数相等时，np.dot(X, Y) 才有意义，点乘得到的结果形状= (X.shape[0], y.shape[1])。</span></p></section></section><p><span style="font-family: DengXian;"><br></span></p><p><span style="font-family: DengXian;">上面例子都是低维张量 </span>(<span style="font-family: DengXian;">维度 </span>≤ 2) <span style="font-family: DengXian;">的点乘运算，接下来我们看两个稍微复杂的例子。</span></p><p><br></p><p><span style="color: rgb(0, 0, 0);"><strong><span style="font-family: DengXian;">例四</span></strong></span><span style="font-family:DengXian;">：当 </span>x <span style="font-family:DengXian;">是 </span>3D <span style="font-family:DengXian;">张量，</span>y <span style="font-family:DengXian;">是 </span>1D <span style="font-family:DengXian;">张量，</span>np.dot(x, y) <span style="font-family:DengXian;">是将 </span>x <span style="font-family:DengXian;">和 </span>y <strong><span style="font-family:DengXian;color:red;">最后一维</span></strong><span style="font-family:DengXian;">的元素相乘并加总。此例 </span>x <span style="font-family:DengXian;">的形状是 </span>(2, 3, <span style="color:red;">4</span>)<span style="font-family:DengXian;">，</span>y <span style="font-family:DengXian;">的形状是 </span>(<span style="color:red;">4</span>, )<span style="font-family:DengXian;">，因此点乘结果的形状是 </span>(2, 3)<span style="font-family:DengXian;">。</span></p><p><span style="font-family:DengXian;"></span><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(35, 36, 31);color: rgb(248, 248, 242);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-sublime">x = np.ones( shape=(<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">2</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">3</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">4</span>) )<br>y = np.array( [<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">1</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">2</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">3</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">4</span>] )<br>z = np.dot(x,y)<br>print(z.shape)<br>z</code></pre></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(255, 255, 255);color: rgb(0, 0, 0);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-vs">(<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">2</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">3</span>)<br>array([[<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 20px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">10.</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 20px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">10.</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 20px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">10.</span>],<br>       [<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 20px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">10.</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 20px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">10.</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 20px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">10.</span>]])</code></pre></section><p><span style="font-family:DengXian;"></span><br></p><p><span style="color: rgb(0, 0, 0);"><strong><span style="font-family: DengXian;">例五</span></strong></span><span style="font-family:DengXian;">：当 </span>x <span style="font-family:DengXian;">是 </span>3D <span style="font-family:DengXian;">张量，</span>y <span style="font-family:DengXian;">是 </span>2D <span style="font-family:DengXian;">张量，</span>np.dot(x, y) <span style="font-family:DengXian;">是将 </span>x <span style="font-family:DengXian;">的<strong><span style="color:red;">最后一维</span></strong>和 </span>y <span style="font-family:DengXian;">的<strong><span style="color:red;">倒数第二维</span></strong>的元素相乘并加总。此例 </span>x <span style="font-family:DengXian;">的形状是 </span>(2, 3, <span style="color:red;">4</span>)<span style="font-family:DengXian;">，</span>y <span style="font-family:DengXian;">的形状是 </span>(<span style="color:red;">4</span>, 2)<span style="font-family:DengXian;">，因此点乘结果的形状是 </span>(2, 3, 2)<span style="font-family:DengXian;">。</span></p><p><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(35, 36, 31);color: rgb(248, 248, 242);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-sublime">x = np.random.normal( <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">0</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">1</span>, size=(<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">2</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">3</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">4</span>) )<br>y = np.random.normal( <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">0</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">1</span>, size=(<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">4</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">2</span>) )<br>z = np.dot(x,y)<br>print(z.shape)<br>z</code></pre></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(255, 255, 255);color: rgb(0, 0, 0);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-vs">(<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">2</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">3</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">2</span>)<br>array([[[ <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 66px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">2.11753451</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 73px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">-0.27546168</span>],<br>        [<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 73px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">-1.23348676</span>,  <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 66px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">0.42524653</span>],<br>        [<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 59px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">-4.349676</span>  , <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 65px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">-0.3030879</span> ]],<br><br>       [[ <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 66px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">0.15537744</span>,  <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 66px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">0.44865273</span>],<br>        [<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 73px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">-3.09328194</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 73px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">-0.43473885</span>],<br>        [ <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 66px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">0.27844225</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 73px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">-0.48024693</span>]]])</code></pre></section><p><span style="font-family:DengXian;"><br></span></p><p><span style="font-family:DengXian;">例五的规则也适用于 </span>nD <span style="font-family:DengXian;">张量和 </span>mD <span style="font-family:DengXian;">张量 </span>(<span style="font-family:DengXian;">当 </span>m ≥ 2 <span style="font-family:DengXian;">时</span>) <span style="line-height: 125%;font-family: DengXian;font-size: 17px;">的点乘</span><span style="font-family:DengXian;">。</span></p><p><span style="font-family:DengXian;"><br></span></p><section class="mpa-template" data-mpa-template-id="921851" data-mpa-color="null" data-mpa-category="收藏"><section><section class="layout"><section style="margin: 1em 0px;color: rgb(51, 51, 51);box-sizing:border-box;border-bottom-width: 2px;border-bottom-style: solid;border-bottom-color: rgb(236, 68, 68);clear: both;"><section style="display: inline-block;padding:3px 10px 0px;color: rgb(255, 255, 255);box-sizing:border-box;border-top-left-radius: 3px;border-top-right-radius: 3px;height: 28px;background-color: rgb(236, 68, 68);"><strong>广播机制</strong></section><section style="box-sizing:border-box;border-top-width:28px;border-top-style: solid;border-color: transparent rgb(206,206,206);border-bottom-width: 0px;border-bottom-style: solid;border-left-width: 15px;border-left-style: solid;display: inline-block;margin-left:2px;vertical-align:top;"></section></section></section></section></section><p><span style="font-family: DengXian;">当对两个形状不同的张量按元素操作时，可能会触发广播机制。具体做法，先适当复制元素使得这两个张量形状相同后再按元素操作，两个步骤：</span></p><p><span style="font-family: DengXian;"><br></span></p><ol class=" list-paddingleft-2" style="list-style-type: decimal;"><li><p><span style="font-family: DengXian;">广播轴 </span>(broadcast axes)<span style="font-family: DengXian;">：比对两个张量的维度，将形状小的张量的维度 </span>(<span style="font-family: DengXian;">轴</span>) <span style="font-family: DengXian;">补齐</span></p></li><li><p><span style="font-family: DengXian;">复制元素：顺着补齐的轴，将形状小的张量里的元素复制，使得最终形状和另一个张量吻合</span></p></li></ol><p><span style="font-family: DengXian;"><br></span></p><p style="text-align: center;"><img class="" data-backh="150" data-backw="501" data-before-oversubscription-url="http://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCHVPPx0L69g3S3djpe1XibftAD9mcuAviarE2WxEAVCTibNnTbDJziabUxEAZjBrWeykXZhxndWL5Asiaw/0?wx_fmt=png" data-ratio="0.3002309468822171" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCHVPPx0L69g3S3djpe1XibftAD9mcuAviarE2WxEAVCTibNnTbDJziabUxEAZjBrWeykXZhxndWL5Asiaw/640?wx_fmt=png" data-type="png" data-w="866" style="width: 100%;height: auto;border-radius: 3px;"></p><p><span style="font-family: DengXian;"><br></span></p><p><span style="font-family:DengXian;">用代码验证一下我们的理解。</span></p><p><span style="font-family: DengXian;"></span><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(35, 36, 31);color: rgb(248, 248, 242);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-sublime">x = np.arange(<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">1</span>,<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">7</span>).reshape(<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">3</span>,<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">2</span>)<br>y = np.arange(<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">1</span>,<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">3</span>).reshape(<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">2</span>)<br>print( (x + y).shape )<br>x + y</code></pre></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(255, 255, 255);color: rgb(0, 0, 0);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-vs">(<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">3</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">2</span>)<br>array([[<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">2</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">4</span>],<br>       [<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">4</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">6</span>],<br>       [<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">6</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">8</span>]])</code></pre></section><p><span style="font-family: DengXian;"><br></span></p><p><span style="font-family:DengXian;">有一个情况比较特殊，就是 </span>x <span style="font-family:DengXian;">和 </span>y <span style="font-family:DengXian;">都是 </span>2D <span style="font-family:DengXian;">张量 </span>(<span style="font-family:DengXian;">形状一样</span>)<span style="font-family:DengXian;">，但是 </span>x <span style="font-family:DengXian;">和 </span>y <span style="font-family:DengXian;">分别在不同维度的元素个数为 </span>1<span style="font-family:DengXian;">。这样的话广播机制也适用于它们，如下图。</span></p><p><span style="font-family: DengXian;"></span><br></p><p style="text-align: center;"><img class="" data-backh="190" data-backw="556" data-before-oversubscription-url="http://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCHVPPx0L69g3S3djpe1XibftdyfYp9mRgghXOAxfIwmJ2TEib6wH57XEXrHoItnqEVVyfzNJ1nRWXOg/0?wx_fmt=png" data-ratio="0.34054669703872437" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCHVPPx0L69g3S3djpe1XibftdyfYp9mRgghXOAxfIwmJ2TEib6wH57XEXrHoItnqEVVyfzNJ1nRWXOg/640?wx_fmt=png" data-type="png" data-w="878" style="width: 100%;height: auto;"></p><p><span style="font-family: DengXian;"><br></span></p><p><span style="font-family:DengXian;">用代码验证一下我们的理解。</span></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(35, 36, 31);color: rgb(248, 248, 242);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-sublime">x = np.arange(<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">1</span>,<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">4</span>).reshape(<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">3</span>,<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">1</span>)<br>y = np.arange(<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">1</span>,<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">3</span>).reshape(<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">1</span>,<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">2</span>)<br>print( (x + y).shape )<br>x + y</code></pre></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(255, 255, 255);color: rgb(0, 0, 0);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-vs">(<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">3</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">2</span>)<br>array([[<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">2</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">3</span>],<br>       [<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">3</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">4</span>],<br>       [<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">4</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">5</span>]])</code></pre></section><p><span style="font-family: DengXian;"></span><br></p><p><span style="font-family:DengXian;">扩展到高维张量，</span></p><p><span style="font-family:DengXian;"><br></span></p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p><span style="font-family: DengXian;">一个形状是 </span>(n<sub>0</sub>, …, n<sub>i, </sub>n<sub>i+1</sub>, …, n<sub>m</sub>)</p></li><li><p><span style="font-family: DengXian;">一个形状是 </span>(n<sub>i+1</sub>, …, n<sub>m</sub>)</p></li></ul><p><br></p><p><span style="font-family:DengXian;">在进行张量运算时，对于轴 </span>n<sub>0 </sub><span style="font-family:DengXian;">到 </span>n<sub>i</sub><span style="font-family:DengXian;">，广播机制将自动发生。</span></p><p><br></p><p><span style="font-family:DengXian;">用下面两个例子来验证一下我们的理解。</span></p><p><span style="font-family:DengXian;"><br></span></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(35, 36, 31);color: rgb(248, 248, 242);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-sublime">x = np.arange(<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">1</span>,<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">25</span>).reshape(<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">2</span>,<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">3</span>,<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">4</span>)<br>y = np.arange(<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">1</span>,<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">5</span>).reshape(<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">4</span>)<br>print( (x + y).shape )<br>x + y</code></pre></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(255, 255, 255);color: rgb(0, 0, 0);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-vs">(<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">2</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">3</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">4</span>)<br>array([[[ <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">2</span>,  <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">4</span>,  <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">6</span>,  <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">8</span>],<br>        [ <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">6</span>,  <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">8</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">10</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">12</span>],<br>        [<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 14px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">10</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 14px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">12</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">14</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">16</span>]],<br><br>       [[<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 14px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">14</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 14px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">16</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">18</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">20</span>],<br>        [<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 14px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">18</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 14px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">20</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">22</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">24</span>],<br>        [<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 14px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">22</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 14px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">24</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">26</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">28</span>]]])</code></pre></section><p><span style="font-family:DengXian;"></span><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(35, 36, 31);color: rgb(248, 248, 242);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-sublime">x = np.arange(<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">1</span>,<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">25</span>).reshape(<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">2</span>,<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">3</span>,<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">4</span>)<br>y = np.arange(<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">1</span>,<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">13</span>).reshape(<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">3</span>,<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">4</span>)<br>print( (x + y).shape )<br>x + y</code></pre></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(255, 255, 255);color: rgb(0, 0, 0);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-vs">(<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">2</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">3</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">4</span>)<br>array([[[ <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">2</span>,  <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">4</span>,  <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">6</span>,  <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">8</span>],<br>        [<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 14px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">10</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 14px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">12</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">14</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">16</span>],<br>        [<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 14px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">18</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 14px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">20</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">22</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">24</span>]],<br><br>       [[<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 14px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">14</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 14px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">16</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">18</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">20</span>],<br>        [<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 14px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">22</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 14px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">24</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">26</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">28</span>],<br>        [<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 14px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">30</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 14px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">32</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">34</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">36</span>]]])</code></pre></section><p><span style="font-family:DengXian;"></span></p><section class="mpa-template" data-mpa-template-id="921851" data-mpa-color="null" data-mpa-category="收藏"><section><section class="layout"><section style="margin: 1em 0px;color: rgb(51, 51, 51);box-sizing:border-box;border-bottom-width: 2px;border-bottom-style: solid;border-bottom-color: rgb(236, 68, 68);clear: both;"><section style="display: inline-block;padding:3px 10px 0px;color: rgb(255, 255, 255);box-sizing:border-box;border-top-left-radius: 3px;border-top-right-radius: 3px;height: 28px;background-color: rgb(236, 68, 68);"><strong>元素层面</strong></section><section style="box-sizing:border-box;border-top-width:28px;border-top-style: solid;border-color: transparent rgb(206,206,206);border-bottom-width: 0px;border-bottom-style: solid;border-left-width: 15px;border-left-style: solid;display: inline-block;margin-left:2px;vertical-align:top;"></section></section></section></section></section><p><span style="font-family: DengXian;">在元素层面的操作用两类：</span><br></p><p><span style="font-family: DengXian;"><br></span></p><ol class=" list-paddingleft-2" style="list-style-type: decimal;"><li><p><span style="font-family: DengXian;">用运算符 “</span>+,–, *, /<span style="font-family: DengXian;">” 来连接两个形状一样的张量 </span>(<span style="font-family: DengXian;">要不然触发广播机制</span>)</p></li><li><p><span style="font-family: DengXian;">用函数如 </span>exp(), softmax() <span style="font-family: DengXian;">来传递一个张量</span></p></li></ol><p><br></p><p><span style="font-family:DengXian;">两类在元素层面</span><span style="line-height: 125%;font-family: DengXian;font-size: 17px;">运算出来的</span><span style="font-family:DengXian;">的结果张量的</span><span style="font-family: DengXian;color: rgb(255, 41, 65);"><strong>形状不变</strong></span><span style="font-family:DengXian;">。</span></p><p><br></p><p><span style="font-family:DengXian;">举个简单例子，首先生成两个随机变量，形状 </span>= (2, 3)</p><p style="white-space: normal;"><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(35, 36, 31);color: rgb(248, 248, 242);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-sublime">x = np.random.normal( <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">0</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">1</span>, size=(<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">2</span>,<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">3</span>) )<br>y = np.random.normal( <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">0</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">1</span>, size=(<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">2</span>,<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">3</span>) )</code></pre></section><p style="white-space: normal;"><br></p><p><span style="font-family:DengXian;">按元素加法：</span></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(35, 36, 31);color: rgb(248, 248, 242);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-sublime">x + y</code></pre></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(255, 255, 255);color: rgb(0, 0, 0);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-vs">array([[ <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 66px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">0.90289729</span>,  <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 65px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">1.09982878</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 71px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">-2.91277851</span>],<br>       [ <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 66px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">0.42207416</span>,  <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 65px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">1.37044143</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 71px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">-0.12210443</span>]])</code></pre></section><p style="white-space: normal;"><br></p><p style="white-space: normal;"><span style="font-family: DengXian;">按元素减法：</span></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t" style="white-space: normal;"><pre style="margin-top: 0px;margin-bottom: 0px;padding: 0px;background-image: none;background-color: initial;"><code class="hljs-sublime" style="margin-right: 0.15em;margin-left: 0.15em;padding: 5.95px;border-radius: 4px;font-size: 0.85em;background: rgb(35, 36, 31);color: rgb(248, 248, 242);display: block;overflow-x: auto;white-space: nowrap;">x - y</code></pre></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(255, 255, 255);color: rgb(0, 0, 0);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-vs">array([[<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 73px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">-0.90005841</span>,  <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 65px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">0.41618533</span>,  <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 65px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">0.86788043</span>],<br>       [<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 73px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">-0.18896878</span>,  <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 65px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">1.22037828</span>,  <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 65px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">0.00227839</span>]])</code></pre></section><p style="white-space: normal;"><br></p><p style="white-space: normal;"><span style="font-family: DengXian;">按元素乘法：</span></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t" style="white-space: normal;"><pre style="margin-top: 0px;margin-bottom: 0px;padding: 0px;background-image: none;background-color: initial;"><code class="hljs-sublime" style="margin-right: 0.15em;margin-left: 0.15em;padding: 5.95px;border-radius: 4px;font-size: 0.85em;background: rgb(35, 36, 31);color: rgb(248, 248, 242);display: block;overflow-x: auto;white-space: nowrap;">x * y</code></pre></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(255, 255, 255);color: rgb(0, 0, 0);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-vs">array([[<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 91px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">1.27959426e-03</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 91px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">2.59103276e-01</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 91px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">1.93276555e+00</span>],<br>       [<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 91px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">3.56093497e-02</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 91px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">9.71966398e-02</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 91px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">3.72607504e-03</span>]])</code></pre></section><p style="white-space: normal;"><br></p><p style="white-space: normal;"><span style="font-family: DengXian;">按元素除法：</span></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t" style="white-space: normal;"><pre style="margin-top: 0px;margin-bottom: 0px;padding: 0px;background-image: none;background-color: initial;"><code class="hljs-sublime" style="margin-right: 0.15em;margin-left: 0.15em;padding: 5.95px;border-radius: 4px;font-size: 0.85em;background: rgb(35, 36, 31);color: rgb(248, 248, 242);display: block;overflow-x: auto;white-space: nowrap;">x / y</code></pre></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(255, 255, 255);color: rgb(0, 0, 0);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-vs">array([[<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 91px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">1.57457067e-03</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 91px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">2.21755087e+00</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 91px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">5.40884040e-01</span>],<br>       [<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 91px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">3.81487730e-01</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 91px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">1.72648632e+01</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 91px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">9.63364914e-01</span>]])</code></pre></section><p style="white-space: normal;"><br></p><p><span style="font-family:DengXian;">函数 </span>exp()<span style="font-family:DengXian;">：</span></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t" style="white-space: normal;"><pre style="margin-top: 0px;margin-bottom: 0px;padding: 0px;background-image: none;background-color: initial;"><code class="hljs-sublime" style="margin-right: 0.15em;margin-left: 0.15em;padding: 5.95px;border-radius: 4px;font-size: 0.85em;background: rgb(35, 36, 31);color: rgb(248, 248, 242);display: block;overflow-x: auto;white-space: nowrap;">np.exp(x)</code></pre></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(255, 255, 255);color: rgb(0, 0, 0);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-vs">array([[<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 65px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">1.00142045</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 53px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">2.134019</span>  , <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 66px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">0.35971291</span>],<br>       [<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 65px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">1.12361671</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 65px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">3.65249266</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 66px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">0.94184645</span>]])</code></pre></section><p style="white-space: normal;"><br></p><p><span style="font-family:DengXian;">函数 </span>softmax()<span style="font-family:DengXian;">：</span></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(35, 36, 31);color: rgb(248, 248, 242);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-sublime"><span class="hljs-sublime-function" style="color: rgb(248, 248, 242);background: rgba(0, 0, 0, 0);display: inline;width: 158px;text-decoration: none solid rgb(248, 248, 242);font-weight: 400;font-style: normal;"><span class="hljs-sublime-keyword" style="color: rgb(249, 38, 114);background: rgba(0, 0, 0, 0);display: inline;width: 20px;text-decoration: none solid rgb(249, 38, 114);font-weight: 400;font-style: normal;">def</span> <span class="hljs-sublime-title" style="color: rgb(166, 226, 46);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(166, 226, 46);font-weight: 400;font-style: normal;">softmax</span><span class="hljs-sublime-params" style="color: rgb(248, 248, 242);background: rgba(0, 0, 0, 0);display: inline;width: 78px;text-decoration: none solid rgb(248, 248, 242);font-weight: 400;font-style: normal;">(x, axis=<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">-1</span>)</span>:</span><br>    e_x = np.exp(x - np.max(x,axis,keepdims=<span class="hljs-sublime-keyword" style="color: rgb(249, 38, 114);background: rgba(0, 0, 0, 0);display: inline;width: 26px;text-decoration: none solid rgb(249, 38, 114);font-weight: 400;font-style: normal;">True</span>))<br>    <span class="hljs-sublime-keyword" style="color: rgb(249, 38, 114);background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration: none solid rgb(249, 38, 114);font-weight: 400;font-style: normal;">return</span> e_x / e_x.sum(axis,keepdims=<span class="hljs-sublime-keyword" style="color: rgb(249, 38, 114);background: rgba(0, 0, 0, 0);display: inline;width: 26px;text-decoration: none solid rgb(249, 38, 114);font-weight: 400;font-style: normal;">True</span>)</code></pre></section><p style="white-space: normal;"><span style="font-family: DengXian;"><br></span></p><p>代码对应着下面流程图秒懂。在编写 softmax 时需要注意的是，当 s 太大或太小，分母可能无穷大或者是零，这样会造成上溢 (overflow) 和下溢 (underflow) 问题。一个聪明的办法是找到 s 的最大值，然后分别减去它。这样最后的结果不会受影响，而且排除了上溢和下溢的可能性。</p><p><br></p><p style="text-align: center;"><img class="" data-backh="228" data-backw="556" data-before-oversubscription-url="https://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCHVPPx0L69g3S3djpe1XibftfbzfJmkoD8pQEz0ficx5Y7xSwFEkCFIXuPw6vcVvibs9PXTEsK7WticDw/0?wx_fmt=png" data-copyright="0" data-ratio="0.40886965927528396" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCHVPPx0L69g3S3djpe1XibftfbzfJmkoD8pQEz0ficx5Y7xSwFEkCFIXuPw6vcVvibs9PXTEsK7WticDw/640?wx_fmt=png" data-type="png" data-w="1849" style="width: 100%;height: auto;"></p><p><br></p><p>x <span style="font-family:DengXian;">是个矩阵，由上图可知 </span>softmax <span style="font-family:DengXian;">通常是作用在向量上，这样用 </span>softmax() <span style="font-family:DengXian;">函数时必须设定 </span>axis<span style="font-family:DengXian;">，即在哪个轴 </span>(<span style="font-family:DengXian;">也叫维度</span>) <span style="font-family:DengXian;">上的元素做 </span>softmax<span style="font-family:DengXian;">，比如 </span>axis =0 <span style="font-family:DengXian;">指第一维，</span>axis = 1 <span style="font-family:DengXian;">指第二维，</span>axis= -1 <span style="font-family:DengXian;">指最后一维。</span></p><p style="white-space: normal;"><span style="font-family: DengXian;"></span></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(35, 36, 31);color: rgb(248, 248, 242);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-sublime">y = softmax( x, axis=<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">0</span> )<br>print(y)<br>np.sum( y, axis=<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">0</span> )</code></pre></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(255, 255, 255);color: rgb(0, 0, 0);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-vs">array([[<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 65px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">0.47124844</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 65px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">0.36879196</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 66px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">0.27637073</span>],<br>       [<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 65px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">0.52875156</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 65px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">0.63120804</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 66px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">0.72362927</span>]])<br><br>array([<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">1.</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">1.</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">1.</span>])</code></pre></section><p style="white-space: normal;"><span style="font-family: DengXian;"></span><br></p><p><span style="font-family:DengXian;">在行上元素做 </span>softmax<span style="font-family:DengXian;">，显然在行上元素求和都等于  </span>1<span style="font-family:DengXian;">，因为有三列，所有最后结果是三个 </span>1<span style="font-family:DengXian;">。</span></p><p style="white-space: normal;"><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(35, 36, 31);color: rgb(248, 248, 242);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-sublime">y = softmax( x, axis=<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">1</span> )<br>print(y)<br>np.sum( y, axis=<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">1</span> )</code></pre></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(255, 255, 255);color: rgb(0, 0, 0);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-vs">array([[<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 65px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">0.28651697</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 65px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">0.61056537</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 66px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">0.10291766</span>],<br>       [<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 65px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">0.19650671</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 65px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">0.63877595</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 66px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">0.16471734</span>]])<br><br>array([<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">1.</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">1.</span>])</code></pre></section><p style="white-space: normal;"><br></p><p><span style="font-family:DengXian;">在列上元素做 </span>softmax<span style="font-family:DengXian;">，显然在列上元素求和都等于 </span>1<span style="font-family:DengXian;">，因为有两行，所有最后结果是两个 </span>1<span style="font-family:DengXian;">。</span></p><p style="white-space: normal;"><br></p><section class="mpa-template" data-mpa-template-id="882500" data-mpa-color="null" data-mpa-category="收藏"><section><section style="border-width: 0px;border-style: initial;border-color: initial;padding: 0px;margin: 0px auto;text-align: center;white-space: normal;"><section style='background-image:url("https://mmbiz.qpic.cn/mmbiz_png/ianq03UUWGmIDLYyVZsymkTnBibBPxwxoWuIkiaMRfF2nPrvryogjrO4XfhpWegMwicuiapXBQia8qeINYhefTtwGfrQ/640?wx_fmt=png");display:inline-block;margin:0 auto;text-align:left;background-size:auto 50px;background-repeat:no-repeat;width:42px;height:50px;vertical-align:top;line-height:50px;text-align:center;color:#fff;'><p style="font-size: 20px;border-width: 0px;border-style: initial;border-color: initial;padding: 0px;margin: 0px;"><span style="font-size: 16px;font-family: Optima-Regular, PingFangTC-light;">5.2</span></p></section><section style='background-image:url("https://mmbiz.qpic.cn/mmbiz_png/ianq03UUWGmIDLYyVZsymkTnBibBPxwxoWEnrBa7fuiccJgxAndh66NF0fKuTFduWXp2icIoXhBpibVePONwaJ3Jvzg/640?wx_fmt=png");display:inline-block;margin:0 auto;text-align:left;background-size:auto 50px;background-repeat:no-repeat;height:50px;'><section style="display:inline-block;padding-left:10px;line-height:50px;color:#333;margin-top:0;vertical-align:top;"><p style="font-size: 14px;border-width: 0px;border-style: initial;border-color: initial;padding: 0px;margin: 0px;"><span style="color: rgb(255, 41, 65);font-size: 16px;font-family: Optima-Regular, PingFangTC-light;"><strong mpa-from-tpl="t">由简推繁</strong></span></p></section></section><section style='background-image:url("https://mmbiz.qpic.cn/mmbiz_png/ianq03UUWGmIDLYyVZsymkTnBibBPxwxoWzfenALo6kEeDUGXCyFibSibU24BtebdP2ialR438RwuG8TnZUIv9k8Ubg/640?wx_fmt=png");display:inline-block;margin:0 auto;text-align:left;background-size:auto 50px;background-repeat:no-repeat;width:17px;height:50px;vertical-align:top;'></section></section></section></section><p><span style="font-family: DengXian;"><br></span></p><p><span style="font-family: DengXian;">上节已经弄懂四种张量运算的类型了，本节再回到用神经网络来识别数字的例子。先不用管权重 </span>W <span style="font-family: DengXian;">和偏置 </span>b <span style="font-family: DengXian;">如何优化出来的，假设已经有了最优 </span>W <span style="font-family: DengXian;">和 </span>b<span style="font-family: DengXian;">，我们主要是想验证一下在实际问题中，张量运算是如何进行的。</span></p><p><span style="font-family: DengXian;"><br></span></p><p><span style="font-family: DengXian;">我们用 </span>TensorFlow <span style="font-family: DengXian;">和 </span>Keras <span style="font-family: DengXian;">来展示，数据集是 </span>MNIST<span style="font-family: DengXian;">。首先导入</span>numpy, tensorflow, keras <span style="font-family: DengXian;">等模块。</span></p><p style="white-space: normal;"><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(35, 36, 31);color: rgb(248, 248, 242);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-sublime"><span class="hljs-sublime-keyword" style="color: rgb(249, 38, 114);background: rgba(0, 0, 0, 0);display: inline;width: 40px;text-decoration: none solid rgb(249, 38, 114);font-weight: 400;font-style: normal;">import</span> numpy <span class="hljs-sublime-keyword" style="color: rgb(249, 38, 114);background: rgba(0, 0, 0, 0);display: inline;width: 14px;text-decoration: none solid rgb(249, 38, 114);font-weight: 400;font-style: normal;">as</span> np<br><span class="hljs-sublime-keyword" style="color: rgb(249, 38, 114);background: rgba(0, 0, 0, 0);display: inline;width: 40px;text-decoration: none solid rgb(249, 38, 114);font-weight: 400;font-style: normal;">import</span> tensorflow <span class="hljs-sublime-keyword" style="color: rgb(249, 38, 114);background: rgba(0, 0, 0, 0);display: inline;width: 14px;text-decoration: none solid rgb(249, 38, 114);font-weight: 400;font-style: normal;">as</span> tf<br><span class="hljs-sublime-keyword" style="color: rgb(249, 38, 114);background: rgba(0, 0, 0, 0);display: inline;width: 40px;text-decoration: none solid rgb(249, 38, 114);font-weight: 400;font-style: normal;">import</span> tensorflow.keras <span class="hljs-sublime-keyword" style="color: rgb(249, 38, 114);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(249, 38, 114);font-weight: 400;font-style: normal;">as</span> keras<br><span class="hljs-sublime-keyword" style="color: rgb(249, 38, 114);background: rgba(0, 0, 0, 0);display: inline;width: 26px;text-decoration: none solid rgb(249, 38, 114);font-weight: 400;font-style: normal;">from</span> tensorflow.keras.datasets <span class="hljs-sublime-keyword" style="color: rgb(249, 38, 114);background: rgba(0, 0, 0, 0);display: inline;width: 40px;text-decoration: none solid rgb(249, 38, 114);font-weight: 400;font-style: normal;">import</span> mnist</code></pre></section><p style="white-space: normal;"><br></p><p><span style="font-family:DengXian;">定义 </span>MINST <span style="font-family:DengXian;">里面黑白数字图片的宽度和高度都为 </span>28<span style="font-family:DengXian;">，通道为 </span>1 (<span style="font-family:DengXian;">不是彩色</span>)<span style="font-family:DengXian;">。定义最终输出的个数为 </span>10<span style="font-family:DengXian;">，因为只有 </span>10 <span style="font-family:DengXian;">个数字。</span></p><p style="white-space: normal;"><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(35, 36, 31);color: rgb(248, 248, 242);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-sublime"><span class="hljs-sublime-comment" style="color: rgb(117, 113, 94);background: rgba(0, 0, 0, 0);display: inline;width: 164px;text-decoration: none solid rgb(117, 113, 94);font-weight: 400;font-style: normal;"># input image dimensions </span><br>n_W, n_H = <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">28</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">28</span><br><span class="hljs-sublime-comment" style="color: rgb(117, 113, 94);background: rgba(0, 0, 0, 0);display: inline;width: 118px;text-decoration: none solid rgb(117, 113, 94);font-weight: 400;font-style: normal;"># class dimensions</span><br>n_y = <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">10</span></code></pre></section><p style="white-space: normal;"><br></p><p><span style="font-family:DengXian;">为了模仿真实的机器学习流程，将数据分成训练集和测试集。但本节重点只看张量运算，因此我们只关注训练集，发现它的形状是 </span>(60000, 28, 28)<span style="font-family:DengXian;">，其中 </span>60000 <span style="font-family:DengXian;">代表图片个数。</span></p><p><span style="font-family:DengXian;"><br></span></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(35, 36, 31);color: rgb(248, 248, 242);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-sublime">(x_train, y_train), (x_test, y_test) <br>= mnist.load_data()<br><br>x_train.shape</code></pre></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(255, 255, 255);color: rgb(0, 0, 0);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-vs">(<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 34px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">60000</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">28</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">28</span>)</code></pre></section><p><span style="font-family:DengXian;"></span><br></p><p><span style="font-family:DengXian;">回顾本章开始列出的公式，来看看如何从“</span>60000 <span style="font-family:DengXian;">张图片输入 </span>X_train<span style="font-family:DengXian;">”经过一系列的张量运算得到“</span>60000 <span style="font-family:DengXian;">个概率输出向量”，</span><span style="line-height: 125%;font-family: DengXian;font-size: 17px;">顺带也看看每次运算之后向量的形状如何变化。</span><span style="font-family:DengXian;">起点从 </span><span style="color:red;">X_train </span><span style="font-family:DengXian;">开始！</span></p><p><span style="font-family:DengXian;"><br></span></p><p style="text-align: center;"><img class="" data-backh="91" data-backw="556" data-before-oversubscription-url="http://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCHVPPx0L69g3S3djpe1Xibftqbj7asfLuA0un6dyImU23qs35fFIovho0ukfV8mnmQMmky4k1Cx6UA/0?wx_fmt=png" data-ratio="0.1634304207119741" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCHVPPx0L69g3S3djpe1Xibftqbj7asfLuA0un6dyImU23qs35fFIovho0ukfV8mnmQMmky4k1Cx6UA/640?wx_fmt=png" data-type="png" data-w="618" style="width: 100%;height: auto;"></p><section class="mpa-template" data-mpa-template-id="921851" data-mpa-color="null" data-mpa-category="收藏" style="white-space: normal;"><section><section class="layout"><section style="margin-top: 1em;margin-bottom: 1em;box-sizing: border-box;border-bottom: 2px solid rgb(236, 68, 68);clear: both;"><section style="padding-top: 3px;padding-right: 10px;padding-left: 10px;display: inline-block;color: rgb(255, 255, 255);box-sizing: border-box;border-top-left-radius: 3px;border-top-right-radius: 3px;height: 28px;background-color: rgb(236, 68, 68);"><strong>重塑形状</strong></section><section style="margin-left: 2px;box-sizing: border-box;border-top: 28px solid transparent;border-right-color: rgb(206, 206, 206);border-bottom: 0px solid transparent;border-left: 15px solid rgb(206, 206, 206);display: inline-block;vertical-align: top;"></section></section></section></section></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(35, 36, 31);color: rgb(248, 248, 242);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-sublime">X = x_train.reshape( x_train.shape[<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">0</span>], <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 14px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">-1</span> ).T<br>X.shape</code></pre></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(255, 255, 255);color: rgb(0, 0, 0);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-vs">(<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 20px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">784</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 33px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">60000</span>)</code></pre></section><p style="white-space: normal;"><br></p><p><span style="font-family:DengXian;">抛开样本数的维度，我们目标是把 </span>2 <span style="font-family:DengXian;">维的“宽度和高度”重塑成 </span>1 <span style="font-family:DengXian;">维。注意 </span>reshape <span style="font-family:DengXian;">函数第二个参数用到了 </span><span style="color: rgb(172, 57, 255);">-1</span><span style="font-family:DengXian;">，这是我们偷懒不想计算 </span>28×28<span style="font-family:DengXian;">。本来重塑后的形状是 </span>(60000, 784)<span style="font-family:DengXian;">，转置之后 </span>X <span style="font-family:DengXian;">形状是 </span>(784, 60000)<span style="font-family:DengXian;">。转置的原因是有时我们会把点乘写成矩阵相乘的形式，而不想看到 </span>XW<sup>T </sup><span style="font-family:DengXian;">这样的形式，而想看到 </span>WX <span style="font-family:DengXian;">这样的形式 </span>(<span style="font-family:DengXian;">只是一种追求美感的惯例</span>)<span style="font-family:DengXian;">。</span></p><p style="white-space: normal;"><br></p><p><span style="font-family:DengXian;">这时候上述公式进展到</span></p><p><span style="font-family:DengXian;"><br></span></p><p style="text-align: center;"><img class="" data-backh="80" data-backw="556" data-before-oversubscription-url="http://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCHVPPx0L69g3S3djpe1Xibftc42QhRSibAropuJClrHaI8IEFE4UwiaZk8cXB38jOye3zx0zFLchRtsQ/0?wx_fmt=png" data-ratio="0.14397496087636932" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCHVPPx0L69g3S3djpe1Xibftc42QhRSibAropuJClrHaI8IEFE4UwiaZk8cXB38jOye3zx0zFLchRtsQ/640?wx_fmt=png" data-type="png" data-w="639" style="width: 100%;height: auto;"></p><p style="text-align: left;"><br></p><section class="mpa-template" data-mpa-template-id="921851" data-mpa-color="null" data-mpa-category="收藏" style="white-space: normal;"><section><section class="layout"><section style="margin-top: 1em;margin-bottom: 1em;box-sizing: border-box;border-bottom: 2px solid rgb(236, 68, 68);clear: both;"><section style="padding-top: 3px;padding-right: 10px;padding-left: 10px;display: inline-block;color: rgb(255, 255, 255);box-sizing: border-box;border-top-left-radius: 3px;border-top-right-radius: 3px;height: 28px;background-color: rgb(236, 68, 68);"><strong>张量点乘</strong></section><section style="margin-left: 2px;box-sizing: border-box;border-top: 28px solid transparent;border-right-color: rgb(206, 206, 206);border-bottom: 0px solid transparent;border-left: 15px solid rgb(206, 206, 206);display: inline-block;vertical-align: top;"></section></section></section></section></section><p><span style="font-family: DengXian;">初始化权重矩阵 </span>W <span style="font-family: DengXian;">和偏置向量 </span>b<span style="font-family: DengXian;">。根据 </span>X <span style="font-family: DengXian;">的形状为 </span>(784, 60000)<span style="font-family: DengXian;">，可先推出 </span>W <span style="font-family: DengXian;">的形状应该为 </span>(?,784)<span style="font-family: DengXian;">；又根据输出 </span>Y <span style="font-family: DengXian;">包含 </span>10 <span style="font-family: DengXian;">个数字的概率值，因此 </span>b <span style="font-family: DengXian;">的形状为 </span>(10, 1)<span style="font-family: DengXian;">，则完全推出 </span>W <span style="font-family: DengXian;">的形状 </span>(10, 784)<span style="font-family: DengXian;">。</span></p><p><span style="font-family: DengXian;"><br></span></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(35, 36, 31);color: rgb(248, 248, 242);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-sublime">W = np.random.normal( <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">0</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">1</span>, size=(n_y, X.shape[<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">0</span>]) )<br>b = np.random.normal( <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">0</span>, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">1</span>, size=(n_y, <span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">1</span>) )<br>print( W.shape )<br>print( b.shape )</code></pre></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(255, 255, 255);color: rgb(0, 0, 0);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-vs">(<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 14px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">10</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 20px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">784</span>)<br>(<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 14px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">10</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 8px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">1</span>)</code></pre></section><p><span style="font-family: DengXian;"></span></p><p><span style="font-family: DengXian;">利用 </span>np.dot <span style="font-family: DengXian;">计算 </span>W <span style="font-family: DengXian;">和 </span>X 点乘<span style="font-family: DengXian;">得到 </span>WX<span style="font-family:DengXian;"></span></p><pre style="margin-top: 0px;margin-bottom: 0px;padding: 0px;background-image: none;background-color: initial;"><p><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin-top: 0px;margin-bottom: 0px;padding: 0px;background-image: none;background-color: initial;"><code class="hljs-sublime" style="margin-right: 0.15em;margin-left: 0.15em;padding: 5.95px;border-radius: 4px;font-size: 0.85em;background: rgb(35, 36, 31);color: rgb(248, 248, 242);display: block;overflow-x: auto;white-space: nowrap;">WX = np.dot(W,X)<br>WX.shape</code></pre></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin-top: 0px;margin-bottom: 0px;padding: 0px;background-image: none;background-color: initial;"><code class="hljs-vs" style="margin-right: 0.15em;margin-left: 0.15em;padding: 5.95px;border-radius: 4px;font-size: 0.85em;background: rgb(255, 255, 255);color: rgb(0, 0, 0);display: block;overflow-x: auto;white-space: nowrap;">(<span class="hljs-vs-number" style="background: rgba(0, 0, 0, 0);display: inline;width: 14px;text-decoration-style: solid;text-decoration-color: rgb(0, 0, 0);">10</span>, <span class="hljs-vs-number" style="background: rgba(0, 0, 0, 0);display: inline;width: 33px;text-decoration-style: solid;text-decoration-color: rgb(0, 0, 0);">60000</span>)</code></pre></section><code class="hljs-vs" style="margin-right: 0.15em;margin-left: 0.15em;padding: 5.95px;border-radius: 4px;font-size: 0.85em;background: rgb(255, 255, 255);color: rgb(0, 0, 0);display: block;overflow-x: auto;white-space: nowrap;"><span style="font-family: DengXian;background-color: initial;color: rgb(51, 51, 51);font-size: 17px;"><br>这时候上述公式进展到<br><br></span></code><p style="text-align: center;"><img class="" data-backh="81" data-backw="556" data-before-oversubscription-url="http://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCHVPPx0L69g3S3djpe1XibftICwPu0mJv10fbwNoW1kuic8emLsBeblaNX0hAM9ia9QgibVLU5gIUqzibg/0?wx_fmt=png" data-ratio="0.1456752655538695" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCHVPPx0L69g3S3djpe1XibftICwPu0mJv10fbwNoW1kuic8emLsBeblaNX0hAM9ia9QgibVLU5gIUqzibg/640?wx_fmt=png" data-type="png" data-w="659" style="width: 556.25px;"></p></pre><p><br></p><section class="mpa-template" data-mpa-template-id="921851" data-mpa-color="null" data-mpa-category="收藏" style="white-space: normal;"><section><section class="layout"><section style="margin-top: 1em;margin-bottom: 1em;box-sizing: border-box;border-bottom: 2px solid rgb(236, 68, 68);clear: both;"><section style="padding-top: 3px;padding-right: 10px;padding-left: 10px;display: inline-block;color: rgb(255, 255, 255);box-sizing: border-box;border-top-left-radius: 3px;border-top-right-radius: 3px;height: 28px;background-color: rgb(236, 68, 68);"><strong>广播机制</strong></section><section style="margin-left: 2px;box-sizing: border-box;border-top: 28px solid transparent;border-right-color: rgb(206, 206, 206);border-bottom: 0px solid transparent;border-left: 15px solid rgb(206, 206, 206);display: inline-block;vertical-align: top;"></section></section></section></section></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(35, 36, 31);color: rgb(248, 248, 242);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-sublime">Z = WX + b<br>Z.shape</code></pre></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(255, 255, 255);color: rgb(0, 0, 0);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-vs">(<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 14px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">10</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 33px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">60000</span>)</code></pre></section><p style="white-space: normal;"><span style="font-size:16px;line-height:125%;"><br></span></p><p style="white-space: normal;"><span style="font-size: 17px;"><span style="line-height: 125%;">WX </span><span style="line-height: 125%;font-family: DengXian;">的形状是 </span><span style="line-height: 125%;">(10, 60000)</span><span style="line-height: 125%;font-family: DengXian;">，</span><span style="line-height: 125%;">b </span><span style="line-height: 125%;font-family: DengXian;">的形状是 </span><span style="line-height: 125%;">(10, 1)</span><span style="line-height: 125%;font-family: DengXian;">，广播机制完全适用于两者的相加。</span><span style="font-family: DengXian;">这时候上述公式进展到</span></span></p><p style="white-space: normal;"><span style="font-size: 17px;font-family: DengXian;"><br></span></p><p style="text-align: center;"><img class="" data-backh="88" data-backw="556" data-before-oversubscription-url="http://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCHVPPx0L69g3S3djpe1Xibft6ia5ibtQFG4ajfkU1X0UAOFTGkn1wQ3cqqWMYuSUib4lpyg4QqoSYw7fg/0?wx_fmt=png" data-ratio="0.15780141843971632" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCHVPPx0L69g3S3djpe1Xibft6ia5ibtQFG4ajfkU1X0UAOFTGkn1wQ3cqqWMYuSUib4lpyg4QqoSYw7fg/640?wx_fmt=png" data-type="png" data-w="564" style="width: 100%;height: auto;"></p><section class="mpa-template" data-mpa-template-id="921851" data-mpa-color="null" data-mpa-category="收藏" style="white-space: normal;"><section><section class="layout"><section style="margin-top: 1em;margin-bottom: 1em;box-sizing: border-box;border-bottom: 2px solid rgb(236, 68, 68);clear: both;"><section style="padding-top: 3px;padding-right: 10px;padding-left: 10px;display: inline-block;color: rgb(255, 255, 255);box-sizing: border-box;border-top-left-radius: 3px;border-top-right-radius: 3px;height: 28px;background-color: rgb(236, 68, 68);"><strong>元素层面</strong></section><section style="margin-left: 2px;box-sizing: border-box;border-top: 28px solid transparent;border-right-color: rgb(206, 206, 206);border-bottom: 0px solid transparent;border-left: 15px solid rgb(206, 206, 206);display: inline-block;vertical-align: top;"></section></section></section></section></section><p><span style="font-family:DengXian;">最后用 </span>tensorflow <span style="font-family:DengXian;">里面的 </span>tf.nn.softmax <span style="font-family:DengXian;">来把 </span>Z <span style="font-family:DengXian;">转成 </span>Y<span style="font-family:DengXian;">。</span>Z <span style="font-family:DengXian;">的形状是 </span>(10,60000)<span style="font-family:DengXian;">，显然 </span>softmax <span style="font-family:DengXian;">应该作用在每行上 </span>(axis= 0)<span style="font-family:DengXian;">，因此对于每一张图片 </span>(<span style="font-family:DengXian;">一共 </span>60000 <span style="font-family:DengXian;">张</span>)<span style="font-family:DengXian;">，输出应该是数字 </span>1 <span style="font-family:DengXian;">到 </span>10 <span style="font-family:DengXian;">对应的概率。</span></p><p><span style="font-family:DengXian;"><br></span></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(35, 36, 31);color: rgb(248, 248, 242);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-sublime">tensor_Y = tf.nn.softmax( Z, axis=<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">0</span> )<br>Y = keras.backend.eval(tensor_Y)<br>Y.shape</code></pre></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(255, 255, 255);color: rgb(0, 0, 0);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-vs">(<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 14px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">10</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 33px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">60000</span>)</code></pre></section><p style="white-space: normal;"><br></p><p>tf.nn.softmax <span style="font-family:DengXian;">输出来是 </span>tensorflow <span style="font-family:DengXian;">里面的 </span>Tensor <span style="font-family:DengXian;">变量，需要用 </span>eval <span style="font-family:DengXian;">方法把它转成 </span>numpy <span style="font-family:DengXian;">的形式。最后发现 </span>Y <span style="font-family:DengXian;">和 </span>Z <span style="font-family:DengXian;">的形状都是 </span>(10, 60000)<span style="font-family:DengXian;">。</span></p><p><br></p><p><span style="font-family:DengXian;">最后来验证一下，是否 </span>softmax <span style="font-family:DengXian;">使用在行上了。如果是的，沿着每行加总应该等于 </span>1 (<span style="font-family:DengXian;">概率之和要等于 </span>1)<span style="font-family:DengXian;">。</span></p><p><span style="font-family:DengXian;"><br></span></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(35, 36, 31);color: rgb(248, 248, 242);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-sublime">np.sum( Y, axis=<span class="hljs-sublime-number" style="color: rgb(174, 129, 255);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(174, 129, 255);font-weight: 400;font-style: normal;">0</span> )</code></pre></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(255, 255, 255);color: rgb(0, 0, 0);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-vs">array([<span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">1.</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">1.</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">1.</span>, ..., <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">1.</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">1.</span>, <span class="hljs-vs-number" style="color: rgb(0, 0, 0);background: rgba(0, 0, 0, 0);display: inline;width: 14px;text-decoration: none solid rgb(0, 0, 0);font-weight: 400;font-style: normal;">1.</span>])</code></pre></section><p style="white-space: normal;"><br></p><p><span style="font-family:DengXian;">这时候上述公式进展到</span></p><p style="white-space: normal;"><br></p><p style="text-align: center;"><img class="" data-backh="84" data-backw="556" data-before-oversubscription-url="http://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCHVPPx0L69g3S3djpe1XibftiaW4IribLyf2P7n1uOIM75wURfoiac3kHBT613QYh6ul7iblKCWbJ6eVRA/0?wx_fmt=png" data-ratio="0.14991482112436116" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCHVPPx0L69g3S3djpe1XibftiaW4IribLyf2P7n1uOIM75wURfoiac3kHBT613QYh6ul7iblKCWbJ6eVRA/640?wx_fmt=png" data-type="png" data-w="587" style="width: 100%;height: auto;"></p><p style="white-space: normal;"><br></p><p style="white-space: normal;"><br></p><section class="mpa-template" data-mpa-template-id="882157" data-mpa-color="null" data-mpa-category="收藏" style="white-space: normal;"><section><section style="padding: 10px;"><section class="autonum" style="float: left;width: 40px;height: 40px;text-align: center;color: rgb(255, 255, 255);background-color: rgb(13, 12, 12);font-size: 24px;line-height: 40px;">6</section><section style="padding-right: 15px;padding-left: 15px;width: auto;display: inline-block;float: left;height: 40px;font-size: 18px;line-height: 35px;border-bottom: 2px solid rgb(13, 12, 12);border-top: 2px solid rgb(13, 12, 12);">总结</section><section style='background-image: url("https://mmbiz.qpic.cn/mmbiz_png/fgnkxfGnnkSBJo13oUicPbCbqeTcIyiakNc2UGmnmA1qH7HExsicAyuzE3Foogxo1VmRNr68icYkKibV0wM7nqTIHng/640?wx_fmt=png");width: 18px;height: 40px;float: left;background-repeat: no-repeat;background-color: rgb(13, 12, 12);background-size: 100% 40px;'></section></section><section style="width: 556.25px;clear: both;"></section></section></section><p style="white-space: normal;"><br></p><p><span style="font-family: DengXian;font-size: 17px;">张量就是高维数组，数据无所不在，维度无所不在，因此张量无所不在。</span></p><p><span style="font-family: DengXian;"><br></span></p><p><span style="font-family:DengXian;">深度学习里的神经网络可以看成是一组张量运算，谷歌下面著名的深度学习框架 </span>TensorFlow <span style="font-family:DengXian;">是建立了计算图，让张量 </span>(tensor) <span style="font-family:DengXian;">从中流动 </span>(flow)<span style="font-family:DengXian;">：因此得名 </span>TensorFlow<span style="font-family:DengXian;">。</span></p><p><span style="font-family: DengXian;"><br></span></p><p><span style="font-family: DengXian;">张量之间的运算可归纳成四种，重塑、点乘、广播和元素层面。下面公式只是反映一层神经网络的张量流动，多层神经网络无非就是多次用到下面公式 </span>(<span style="font-family: DengXian;">会有微小调整</span>)<span style="font-family: DengXian;">。弄清楚每种张量运算的类型和运算前后的张量形状的匹配是最重要的。</span></p><p><span style="font-family: DengXian;"></span></p><p style="text-align: center;"><img class="" data-backh="223" data-backw="556" data-before-oversubscription-url="http://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCHVPPx0L69g3S3djpe1XibftYtEBHqUVxWJLibg1VjFvkJAMibDSERf5httTeStibVQ50E0wAPWExS8zg/0?wx_fmt=png" data-ratio="0.40103492884864167" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCHVPPx0L69g3S3djpe1XibftYtEBHqUVxWJLibg1VjFvkJAMibDSERf5httTeStibVQ50E0wAPWExS8zg/640?wx_fmt=png" data-type="png" data-w="773" style="width: 100%;height: auto;"></p><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 17px;color: rgb(51, 51, 51);letter-spacing: 0.5px;"></span></p><p><span style="font-family:DengXian;">细心的读者终于受不了了，想知道 </span>W <span style="font-family:DengXian;">和 </span>b <span style="font-family:DengXian;">怎么来的。答案：</span></p><p><span style="font-family:DengXian;"><br></span></p><ol class=" list-paddingleft-2" style="list-style-type: decimal;"><li><p><span style="font-family:DengXian;">用上面公式 </span>L <span style="font-family:DengXian;">遍得到输出 </span>Y<span style="font-family:DengXian;">，和真实标签构建误差函数</span></p></li><li><p><span style="font-family:DengXian;">对误差函数求所有 </span>W <span style="font-family:DengXian;">和 </span>b <span style="font-family:DengXian;">的导数</span></p></li><li><p><span style="font-family:DengXian;">用各种各样的优化方法迭代求解</span></p></li></ol><p><br></p><p><span style="font-family:DengXian;">但是这里 </span>W <span style="font-family:DengXian;">和 </span>b <span style="font-family:DengXian;">都是矩阵或向量，而且深层神经网络又有很多个 </span>W <span style="font-family:DengXian;">和 </span>b<span style="font-family:DengXian;">，那么在优化求解中，两个问题最重要</span></p><p><br></p><ol class=" list-paddingleft-2" style="list-style-type: upper-roman;"><li><p><span style="font-family:DengXian;">怎样<strong><span style="color:red;">有效</span></strong>的推导出误差函数对所有函数的偏导数？</span></p></li><li><p><span style="font-family:DengXian;">怎样<strong><span style="color:blue;">有效</span></strong>的计算它们？</span></p></li></ol><p><span style="font-family: DengXian;letter-spacing: 0.5px;"><br></span></p><p><span style="font-family: DengXian;letter-spacing: 0.5px;">解决问题 </span><span style="letter-spacing: 0.5px;">I </span><span style="font-family: DengXian;letter-spacing: 0.5px;">需要了解</span><strong><span style="font-family: DengXian;color: red;letter-spacing: 0.5px;">张量求导</span></strong><span style="font-family: DengXian;letter-spacing: 0.5px;">，解决问题 </span><span style="letter-spacing: 0.5px;">II </span><span style="font-family: DengXian;letter-spacing: 0.5px;">需要了解</span><strong><span style="font-family: DengXian;color: blue;letter-spacing: 0.5px;">计算图 </span></strong><span style="letter-spacing: 0.5px;">(</span><span style="font-family: DengXian;letter-spacing: 0.5px;">反向传播</span><span style="letter-spacing: 0.5px;">)</span><span style="font-family: DengXian;letter-spacing: 0.5px;">。这是下帖的内容，非常重要又十分有趣，学会了它们你不再是调包侠，学会了它们出了错你知道哪里去找，学会了它们你可以肆意推导 </span><span style="letter-spacing: 0.5px;">DNN, CNN, RNN (LSTM, GRU) </span><span style="font-family: DengXian;letter-spacing: 0.5px;">的反向传播公式。我的任务就是让你们轻松学会它们！</span><span style="letter-spacing: 0.5px;">Stay Tuned!</span></p><section class="mpa-template" data-mpa-template-id="1530286" data-mpa-color="null" data-mpa-category="收藏"><p><br></p><section data-role="outer" style="margin: 0px 1em;padding: 0px;font-size: 16px;line-height: 25.6px;color: rgb(62, 62, 62);text-align: center;"><section data-role="paragraph" style="margin: 0px;padding: 0px;"><section data-role="outer" style="margin: 0px;padding: 0px;"><p style="clear: both;min-height: 1em;line-height: 1.75em;"><img class="" data-ratio="0.037096774193548385" src="http://mmbiz.qpic.cn/mmbiz/yqVAqoZvDibGn3quicLUfUwlIuWZlUCASOYuepCwbOiaNHC4CIHpsr252icsEyHy4ltkuIO0UrPuwCyZ8GHTf10mTA/640?" data-type="png" data-w="620" data-width="100%" style="margin: 5px 0px 10px;padding: 0px;color: inherit;line-height: 25.6px;display: block;height: auto !important;visibility: visible !important;width: 556px !important;" width="650px"></p></section></section></section></section><p style="white-space: normal;"><br></p><section class="mpa-template" data-mpa-template-id="2434" data-mpa-color="#ffffff" data-mpa-category="引导" style="white-space: normal;"><p class="" style="text-align: center;"><strong>按二维码关注</strong><span style="color: rgb(0, 122, 170);"><strong>王的机器</strong></span></p><p class="" style="text-align: center;"><strong>迟早精通</strong><span style="color: rgb(255, 41, 65);"><strong>机学</strong></span><span style="color: rgb(0, 128, 255);"><strong>金工</strong></span><span style="color: rgb(0, 209, 0);"><strong>量投</strong></span></p><p class=""><img class="__bg_gif" data-copyright="0" data-ratio="0.1" src="https://mmbiz.qpic.cn/mmbiz_gif/b96CibCt70iaagrfovcR4xZRU4sIT4pAfRhAHTulo7mvISXAlk0HyVMgAqfUVqiarVAbEwhrNicj4wibzgjYcVV4C2w/640" data-type="gif" data-w="1000" style="width: auto !important;visibility: visible !important;"></p></section><p style="white-space: normal;text-align: center;"><img class="" data-copyright="0" data-ratio="1" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_jpg/e4kxNicDVcCFmpib4X6RoRVaPRiaVUxwJsBuDqk2Q30CypicFTOuTLINHwg5cMYY62Kd9oO4yWDDa9gdKnbfsYXicJA/640?wx_fmt=jpeg" data-type="jpeg" data-w="258"></p><section class="mpa-template" data-mpa-template-id="882147" data-mpa-color="null" data-mpa-category="fav" style="white-space: normal;"><section><img class="" data-backh="121" data-backw="556" data-before-oversubscription-url="https://mmbiz.qpic.cn/mmbiz_gif/cZkI8M0nbCkXzTeDWepHbhwXDIFJk7sPlnjBt7bofGIrcpGsmCEoQbjEo6qgb5vuKEp4hhPibvUibsCwGaLXibiaNg/" data-ratio="0.21866666666666668" src="https://mmbiz.qpic.cn/mmbiz_gif/cZkI8M0nbCkXzTeDWepHbhwXDIFJk7sPlnjBt7bofGIrcpGsmCEoQbjEo6qgb5vuKEp4hhPibvUibsCwGaLXibiaNg/640" data-type="gif" data-w="750" style="border-color: rgb(68, 153, 231);width: 100%;height: auto;"></section></section><section class="mpa-template" data-mpa-template-id="628" data-mpa-color="#ffffff" data-mpa-category="title" style="white-space: normal;"><section><section style="padding: 10px;text-align: center;"><section style="display: inline-block;"><section style='padding-left: 19px;background-image: url("https://mmbiz.qpic.cn/mmbiz_png/fgnkxfGnnkTicsrX1MficjcdwBlzDp9Jq78uukicmicgvMjzkUNzmJvW1U3O9fp7QgqIGEEaG8QUSkMsWII6jtSlOg/640?wx_fmt=png");float: left;width: 60px;height: 53px;background-repeat: no-repeat;background-size: 100%;font-size: 18px;text-align: left;line-height: 53px;color: rgb(255, 255, 255);'><strong>往</strong></section><section style='margin-top: 13px;margin-left: -13px;padding-right: 20px;padding-left: 20px;background-image: url("https://mmbiz.qpic.cn/mmbiz_png/fgnkxfGnnkTicsrX1MficjcdwBlzDp9Jq73HibCQ7An4gIOJ0Dgy1BxDaZfgY5aDH6FjYIxlBqaMfdJXZKpV4FxTw/640?wx_fmt=png");float: left;width: auto;height: 30px;color: rgb(155, 91, 83);font-size: 16px;line-height: 30px;background-repeat: no-repeat;background-size: 100% 2px;background-position: center bottom;'><strong>年女儿生日给她写的信</strong></section></section></section></section></section><p style="white-space: normal;text-align: left;"><span style="font-size: 20px;color: rgb(61, 170, 214);"><strong>2015 年</strong></span></p><p style="white-space: normal;text-align: center;"><img class="" data-backh="840" data-backw="556" data-before-oversubscription-url="https://mmbiz.qpic.cn/mmbiz_jpg/e4kxNicDVcCE5FKaFH91zXxMuHylbVsDibwtVDYmibOwUicI7q7mo4pIRzA8iaqKFdHl4hsVqNZh8YoPbhbQh4ibicvlQ/" data-copyright="0" data-ratio="1.509375" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_jpg/e4kxNicDVcCE5FKaFH91zXxMuHylbVsDibwtVDYmibOwUicI7q7mo4pIRzA8iaqKFdHl4hsVqNZh8YoPbhbQh4ibicvlQ/640" data-type="jpeg" data-w="640" style="width: 100%;height: auto;"></p><p style="white-space: normal;text-align: left;"><strong style="color: rgb(61, 170, 214);font-size: 20px;text-align: center;">2016 年</strong></p><p style="white-space: normal;text-align: center;"><img class="" data-backh="663" data-backw="556" data-before-oversubscription-url="https://mmbiz.qpic.cn/mmbiz_jpg/e4kxNicDVcCFoniaxyiaLCeGI9gPoNPFSqMxwHfKGdMTzibeCkrgOnUXSHcEJlluDLj1zhrvbvWnlrOPd44YVDl8pg/" data-copyright="0" data-ratio="1.1906666666666668" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_jpg/e4kxNicDVcCFoniaxyiaLCeGI9gPoNPFSqMxwHfKGdMTzibeCkrgOnUXSHcEJlluDLj1zhrvbvWnlrOPd44YVDl8pg/640" data-type="jpeg" data-w="750" style="width: 100%;height: auto;"></p><p style="white-space: normal;"><strong style="color: rgb(61, 170, 214);font-size: 20px;text-align: center;">2017 年</strong></p><p style="white-space: normal;text-align: center;"><img class="" data-backh="696" data-backw="556" data-before-oversubscription-url="https://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCFoniaxyiaLCeGI9gPoNPFSqMy3j6lOR8SN1pFOoMYibkcI6Wlx3Xws0GjDIk6OOn2G2W7cDM54IYohQ/" data-copyright="0" data-ratio="1.2527472527472527" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/e4kxNicDVcCFoniaxyiaLCeGI9gPoNPFSqMy3j6lOR8SN1pFOoMYibkcI6Wlx3Xws0GjDIk6OOn2G2W7cDM54IYohQ/640" data-type="png" data-w="637" style="width: 100%;height: auto;"></p><p style="white-space: normal;"><strong style="color: rgb(61, 170, 214);font-size: 20px;text-align: center;">2018 年</strong></p><p style="white-space: normal;text-align: center;"><img class="" data-backh="734" data-backw="556" data-before-oversubscription-url="https://mmbiz.qpic.cn/mmbiz_jpg/e4kxNicDVcCF1xOVaqffYpG99CVibfIYClLkhx7zJTVozbG49POf7WlorDC7Bk3nicX7VZtbtDjTkECehiadWSqYkg/" data-copyright="0" data-ratio="1.3193798449612404" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_jpg/e4kxNicDVcCF1xOVaqffYpG99CVibfIYClLkhx7zJTVozbG49POf7WlorDC7Bk3nicX7VZtbtDjTkECehiadWSqYkg/640" data-type="jpeg" data-w="645" style="width: 100%;border-radius: 3px;height: auto;"></p><p><strong style="white-space: normal;color: rgb(61, 170, 214);font-size: 20px;text-align: center;">2019 年</strong></p><p style="text-align: center;"><img class="" data-backh="895" data-backw="556" data-before-oversubscription-url="https://mmbiz.qpic.cn/mmbiz_jpg/e4kxNicDVcCHVPPx0L69g3S3djpe1XibftHHSKpZfOBvQVgfmWZ33DCZMEdUzibELd15SI2AR4ibZEic3FiaTckuYzicQ/0?wx_fmt=jpeg" data-copyright="0" data-ratio="1.6091314031180401" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_jpg/e4kxNicDVcCHVPPx0L69g3S3djpe1XibftHHSKpZfOBvQVgfmWZ33DCZMEdUzibELd15SI2AR4ibZEic3FiaTckuYzicQ/640?wx_fmt=jpeg" data-type="jpeg" data-w="898" style="width: 100%;height: auto;"></p>
                </div>
                <script nonce="736110442" type="text/javascript">
                    var first_sceen__time = (+new Date());

                    if ("" == 1 && document.getElementById('js_content')) {
                        document.getElementById('js_content').addEventListener("selectstart",function(e){ e.preventDefault(); });
                    }

                    
                    (function(){
                        if (navigator.userAgent.indexOf("WindowsWechat") != -1){
                            var link = document.createElement('link');
                            var head = document.getElementsByTagName('head')[0];
                            link.rel = 'stylesheet';
                            link.type = 'text/css';
                            link.href = "//res.wx.qq.com/mmbizwap/zh_CN/htmledition/style/page/appmsg_new/winwx430b95.css";
                            head.appendChild(link);
                        }
                    })();
                </script>

                
                <div class="ct_mpda_wrp" id="js_sponsor_ad_area" style="display:none;"></div>
                
                
                <div class="read-more__area" id="js_more_read_area" style="display:none;">
                    
                </div>

                
                                <div class="reward_area tc reward_area_primary" id="js_reward_area" style="display:none;">
                    <div class="reward-avatar" style="display: none;" id="js_reward_avatar">
                        <img src="" alt="" id="js_reward_author_head">
                    </div>
                    
                                       
                                                <div class="reward-author" style="display: none;" id="js_reward_author">王圣元</div>
                                            
                                       

                                        <p>
                        <a class="reward_button" id="js_reward_link" href="##"><span id="js_reward_link_text">赞赏</span></a>
                    </p>
                    <div id="js_reward_inner" class="reward_area_inner" style="display:none;">
                        <p class="weui-loadmore weui-loadmore_line reward_user_tips" id="js_reward_total_parent">
                          <span class="weui-loadmore__tips"><a href="##" id="js_reward_total"></a> 人<span id="js_reward_total_text">赞赏</span></span>
                        </p>
                        
                        <div id="js_reward_list" class="reward_user_list"></div>
                    </div>
                </div>
                                <div class="reward_qrcode_area reward_area tc" id="js_reward_qrcode" style="display:none;">
                    <p class="tips_global">长按二维码向我转账</p>
                                        <p class="reward_tips"></p>
                    <span class="reward_qrcode_img_wrp"><img class="reward_qrcode_img" id="js_reward_qrcode_img"></span>
                    <p class="tips_global">受苹果公司新规定影响，微信 iOS 版的赞赏功能被关闭，可通过二维码转账支持公众号。</p>
                </div>
                                                
                
                                <a class="original_tool_area" id="copyright_info" href="##">
                    <div class="flex_cell original_cell">
                        <div class="flex_cell_bd flex_cell_primary">
                          <p class="tips_global_primary">文章转载自公众号</p>
                        </div>
                        <div class="flex_cell_ft icon_access">
                            <span class="radius_avatar">
                                                                <img class="avatar" src="http://wx.qlogo.cn/mmhead/Q3auHgzwzM6cicR6BmLrSjEhP7FsqYjwFpaNac0Wa9ibBWkmW7QtSxNw/0" alt="王的机器">
                                                            </span>
                            <strong class="original_cell_nickname">
                              王的机器
                            </strong>
                        </div>
                    </div>
                </a>
                            </div>
                                    
                        


                        
            <ul id="js_hotspot_area" class="article_extend_area"></ul>


            

            


<div class="rich_media_tool" id="js_toobar3">

        <div id="js_read_area3" class="media_tool_meta tips_global_primary meta_primary" style="display:none;">阅读 <span id="readNum3"></span></div>

    <span style="display:none;" class="media_tool_meta meta_extra meta_praise" id="like_old">
        <i class="icon_praise_gray"></i><span class="praise_num" id="likeNum_old"></span>
    </span>

    <span style="display:none;" class="media_tool_meta meta_extra meta_like" id="like3">
        <button class="like_btn" id="js_like_btn"> 
          好看<span class="like_num" id="likeNum3"></span>
        </button>
    </span>

    <div id="js_like_educate" style="display:none">
        <div class="weui-mask"></div>
        <div class="weui-dialog weui-dialog_haokan">
        <div class="weui-dialog__hd"><strong class="weui-dialog__title" id="educate_title">已推荐到看一看</strong></div>
        <div class="weui-dialog__bd">
          <img class="pic_haokan" src="//res.wx.qq.com/mmbizwap/zh_CN/htmledition/images/pic/appmsg/pic_haokan42f400.png">
            你的朋友可以在“发现”-“看一看”看到你认为好看的文章。        </div>
        <div class="weui-dialog__ft" id="educate_btn" style="display: none">
          <a href="javascript:;" class="weui-dialog__btn weui-dialog__btn_default" id="js_cancel">取消</a>
          <a href="javascript:;" class="weui-dialog__btn weui-dialog__btn_primary" id="js_confirm">推荐</a>
        </div>
        <div class="weui-dialog__ft" id="educate_btn2" style="display: none">
          <a href="javascript:;" class="weui-dialog__btn weui-dialog__btn_primary" id="js_acknowledge">我知道了</a>
        </div>
        </div>
    </div>

    <div id="js_unlike_educate" style="display:none">
        <div class="weui-mask"></div>
        <div class="weui-dialog">
        
        <div class="weui-dialog__bd">
            已取消，“好看”想法已同步删除        </div>
        <div class="weui-dialog__ft">
          <a href="javascript:;" class="weui-dialog__btn weui-dialog__btn_primary" id="js_unlike_know">知道了</a>
        </div>
        </div>
    </div>

    
    </div>


<div class="like_comment_wrp" id="js_a_like_comment" style="display: none;">
  <div class="like_comment_inner">
    <div class="like_comment_hd" style="display:none" id="js_like_title"></div>
    <div class="like_comment_bd">
      <div class="tips_global_primary like_comment_tips">
        <i class="weui-icon-success"></i>已推荐到看一看<a href="javascript:;" class="like_comment_share_link" id="js_a_like_comment_share">和朋友分享想法</a>
      </div>
    </div>
    <div class="like_comment_ft">
      <span id="js_a_like_comment_msg" class="like_comment_msg" style="visibility:hidden">最多200字，当前共<span id="js_a_like_current_cnt"></span>字</span>
      <button class="like_comment_btn" disabled id="js_a_like_confirm">发送</button>
    </div>
  </div>
</div>

<div id="js_like_toast" style="display: none;">
  <div class="weui-mask_transparent"></div>
  <div class="weui-toast">
    <i class="weui-icon-success-no-circle weui-icon_toast"></i>
    <p class="weui-toast__content" id="js_toast_msg">已发送</p>
  </div>
</div>


<div style="display: none;" id="js_b_comment_panel" class="like_comment_primary_pop">
  <div class="like_comment_primary_wrp" id="js_b_wrp">
    <div class="like_comment_primary_inner">
      <div class="like_comment_primary_hd">
        <h4 class="like_comment_primary_title">
          朋友将在看一看看到        </h4>
        <button id="js_b_like_confirm" class="like_comment_primary_btn">确定</button>
      </div>
      <div id="js_b_comment_text_first" class="like_comment_primary_bd">
        <span class="tips_global_primary">
          分享你的想法...        </span>
      </div>
    </div>
  </div>
  <div class="like_comment_primary_mask" id="js_mask_1"></div>
</div>

<div style="display: none;" id="js_b_comment_final">
  <div class="like_comment_primary_wrp editing" id="js_comment_wrp">
    <div class="like_comment_primary_inner">
      <div class="like_comment_primary_hd">
        <button class="like_comment_primary_cancel" id="js_b_comment_cancel">取消</button>
        <h4 class="like_comment_primary_title"> 分享想法到看一看 </h4>
        <button class="like_comment_primary_btn" id="js_b_comment_confirm">确定</button>
      </div>
      <div class="like_comment_primary_bd">
        <textarea class="like_comment_textarea weui-textarea" placeholder="分享你的想法..." id="js_b_comment_text_second"></textarea>
      </div>
      <span class="like_comment_msg" id="js_b_like_comment_msg" style="visibility: hidden;">最多200字，当前共<span id="js_b_like_current_cnt"></span>字</span>
    </div>
  </div>
  <div class="like_comment_primary_mask" id="js_mask_2"></div>
</div>

<div id="js_loading" style=" display: none;">
    <div class="weui-mask_transparent"></div>
    <div class="weui-toast">
        <i class="weui-loading weui-icon_toast"></i>
        <p class="weui-toast__content">发送中</p>
    </div>
</div>

<div id="js_fail" style="display:none">
    <div class="weui-mask"></div>
    <div class="weui-dialog">
    <div class="weui-dialog__bd">
        网络异常，请稍后重试    </div>
    <div class="weui-dialog__ft">
      <a href="javascript:;" class="weui-dialog__btn weui-dialog__btn_primary" id="js_fail_inform">知道了</a>
    </div>
    </div>
</div>



                        <div class="rich_media_tool" id="js_sg_bar">

                                
            </div>
                      </div>
        </div>

        <div class="rich_media_area_primary sougou" id="sg_tj" style="display:none"></div>


        
        <div class="rich_media_area_extra">
          <div class="rich_media_area_extra_inner">
              
              <div id="js_share_appmsg">
              </div>

              
                            <div class="mpda_bottom_container" id="js_bottom_ad_area"></div>
                            
              <div id="js_iframetest" style="display:none;"></div>
                            
                            
              <div class="rich_media_extra rich_media_extra_discuss" id="js_cmt_container" style="display:none">
                

                
                <div class="discuss_mod" id="js_friend_cmt_area" style="display:none">
                  
                  
                  
                </div>

                                <div class="discuss_mod" id="js_cmt_area" style="display:none">
                </div>
                              </div>
          </div>
        </div>

        
        <div id="js_pc_qr_code" class="qr_code_pc_outer" style="display:none;">
            <div class="qr_code_pc_inner">
                <div class="qr_code_pc">
                    <img id="js_pc_qr_code_img" class="qr_code_pc_img">
                    <p>微信扫一扫<br>关注该公众号</p>
                </div>
            </div>
        </div>
    </div>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
</body>
</html>
