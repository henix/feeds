<p>对于任何拥有大量比特币、以太币或其他加密资产的人来说，加密货币安全都是一个问题。大多数比特币都存放在比特币钱包或比特币银行中。你的比特币持有量被记录在公共账本上。您可以通过使用私钥进行身份验证来访问这些资产。</p><p>比特币钱包可以更准确地描述为比特币钥匙环，上面串着很多把钥匙。保护您的比特币钱包就是保护私钥，正如保护任何一段文本都有许多不同的方法一样，保护比特币私钥也有许多方法。</p><p>可以用比特币银行来比喻Coinbase等机构。Coinbase采用了比特币钱包的技术，并将其封装在与银行和大型科技公司相关联的转移层中。通过使用比特币银行，你牺牲了管理自己私钥的自主权。好的一面是，您不必管理自己的私钥，因为私钥管理非常烦人。当然，放弃私钥管理，也就放弃了一些自主权。</p><p>詹姆逊·洛普(Jameson Lopp，简称JL)是一名密码朋克，也是Casa的加密货币工程师。在这篇文章中，我们将与Jameson对话，探讨比特币钱包如何工作，如何保护它们，常见的威胁，诈骗和比特币的黑客企图。</p><p>致远：今天我想和大家谈谈加密货币安全，特别是钱包安全。让我们从钱包开始讨论。什么是比特币钱包?为什么比特币持有者需要一个钱包?</p><p>JL：钱包不是最好的名字。最好将这些东西中的一个称为密钥环或密钥管理服务。但基本上你所做的是你在创建一种软件，它可以帮助你管理解开密码资产的私钥，允许你使用它们，并允许你管理你实际金钱的其他方面。所以在比特币中，这基本上意味着管理未使用的交易输出，也就是真正的“比特币”。</p><p>致远：那些未使用的交易输出，它们是保存在钱包中还是公开访问?让我们来回顾一下比特币钱包和公共账本之间的相互作用。</p><p>JL：是的。所以UTXOs基本上就是当前可用的可消费比特币的数据库，这些比特币是你通过解析区块链本身以及查看区块链的整个历史而获得的。区块链就是一系列的输入和输出。每个交易都要花费一些输入，然后创建新的输出。按照在整个历史从一开始的创世区块,我们可以删除交易输出,用于创建新的交易，并且将其广播到网络上,然后进入区块链。</p><p>最终我们到达了现在的状态。</p><p>所以，如果你能把比特币网络上的交易看作是一个状态转换函数，在这个函数中，你消费一些交易输出，然后创建新的，最终我们在区块链的当前端点得到当前状态。</p><p>致远：当我初始化一个比特币钱包时，我需要做什么?</p><p>JL：你要做的就是创建这些私钥。有很多不同的方法可以做到这一点，但是对于他们所谓的分层确定性钱包，现在有一个标准，其中您实际上只是创建这个根主密钥对，然后从该主密钥对中派生出所有公共私钥。这有好几个原因，但是特别需要指出的是，它意味着您只需要备份主密钥对，并且事实上还有其他标准允许您只备份一个12或24个字符长度的种子短语，然后使用它来导出主密钥对本身。</p><p>因此，当您创建一个新的钱包时，除了一些公钥和私钥之外，钱包中没有任何东西。但是如果您以前从未使用过这组公钥和私钥，当然钱包中也不会有任何币，因为没有东西会被发送到那些地址。</p><p>致远：在这种情况下，您不需要扫描整个区块链并找到与此钱包相关的所有交易，因为您知道它是惟一的。</p><p>JL：是的，如果这是你第一次使用钱包。现在，如果要从以前使用的钱包中导入种子短语或一组密钥对，则需要返回并执行某种扫描，以便得到那些未使用的交易输出。</p><p>致远：你在这里描述的是，如果我已经是比特币用户，我有一个钱包，我想把它一直留在家里，然后也许我还有另一个钱包，我可以随身携带，偶尔使用，我希望他们是相同的帐户结构的副本。如果我把那个新钱包和第一个钱包相同的地址模式拷贝起来，那么我需要做什么呢？</p><p>JL：那么，在那种情况下，钱包软件将从最开始的时间点开始，或者在某些情况下，如果您知道何时开始使用钱包，那么您可以告诉它仅仅从某个日期开始。但是这个钱包将不得不进入网络，或者您当然可以让它连接到您的节点。但是它必须连接到网络上某个地方的某个完整的比特币节点，然后开始查询该节点，它基本上将遍历放入该区块链的每个块，并将向该节点发送一个查询，该查询表示：“这是一种模糊过滤器，我查找与匹配此模糊筛选器的任何地址相关的任何交易。如果有匹配的话，把它发回给我，我会在本地更仔细地检查这些交易。”</p><p>所以你可以很快地做到这一点，因为你可以——这实际上被称为SPV，简化的支付验证，实际上在许多年前的中本聪白皮书中有描述。通过使用位于每个区块标头中的默克尔树的根结点，您实际上可以从节点获得一个强大的加密证明，证明特定块中存在特定的交易，而不必下载曾经发生的所有交易。</p><p>现在，在不深入讨论细节的情况下，这里有一些隐私问题。虽然存在一些潜在的审查问题，但它在大多数情况下都运行良好。当然，也有很多改进的建议，让它更经得起审查，更私密。</p><p>致远：让我们将SPV与完整节点的讨论留到稍后讨论。</p><p>JL：当然</p><p>致远：现在只关注钱包，我需要的硬件规格是什么?我可以在我的MacBook或在我的手机上运行这个吗?安全比特币钱包软件的要求是什么?</p><p>JL：这是一个相当宽泛的问题，如果你对计算机安全有所了解，你就会知道没有什么是100%安全的。所以你真正想做的是尽量减少你使用的钱包的攻击面。当然，总会有性能和便利的权衡。所以一般来说，您的设置越安全，它就越不方便，或者性能越差。</p><p>所以说，当你在笔记本电脑、台式机、手机等常规硬件上运行钱包时，它们总是会有更多潜在的攻击载体，因为你在运行一个成熟的操作系统，可能有恶意软件在上面。就像有一百万不同的事情可能出错, 可能导致您将您的私钥暴露给某个攻击者，或者攻击者的欺骗地址，当您没有查看时将它们交换出去，并且您意外地将钱发送到一个攻击者的地址，而不是你想要的接收者。</p><p>事实上，我现在的公司正在建立这个基础。尝试将用户体验与这些硬件密钥管理设备的安全性结合起来，比如移动应用程序钱包。这些设备通常更安全，因为它们是定制的硬件，除了管理安全元素中的私钥和为各种加密货币执行交易签名操作外，基本上什么也不做。所以基本上不可能把恶意软件和其他不好的东西放到这些设备上，因为它们根本不支持其他操作。</p><p>致远：这就是说， 除非某种类型供应链的闯入者。 我最近看到的这种类型就是比如你有一个商店，Casa商店，因为你是一个专属的安全公司。我认为我可以做出一个论断就是如果你从你的Casa商店买一个 Trezor 钱包可能会比从ebay买更安全。因为你可能不想要从ebay买一个比特币。</p><p>JL：你可能不想从任意一个人那里买。现在，当人们从eBay或其他p2p市场购买硬件钱包时，我们看到的攻击类型，并不是那些人真的去篡改硬件本身，通常没有那么复杂，因为这些人买的是硬件设备。然后他们打开它，在上面放一个钱包种子短语，他们知道种子短语，然后他们把它寄给其他人，基本上是给他们指令，告诉他们，“哦，不要重置设备。继续使用种子短语。并且这是你的种子短语。“然后，他们当然会等着有人把钱存进去，然后把钱全偷走。”</p><p>我不是一个硬件专家，但如果你继续喜欢Trezor和Ledger网站，你应该能够找到更多的材料，在那里，他们实际上有很多防篡改机制内置到硬件本身中，使得某人打开硬件非常非常困难。这就像固件在每次设备打开时都要检查硬件的完整性。</p><p>当然，只要有足够的资源，任何事情都是可能的，比如，我想，如果你去一家拥有电子显微镜和各种其他设备的三家信访机构，他们可能会篡改这类东西。但总的来说，您获得了设备本身未被篡改的真正、真正高水平的安全性。</p><p>致远：这是比特币钱包，我们现在已经深入讨论了。还有一个常用的术语--比特币银行。我认为这可能是你可以用来形容Coinbase的。比特币银行的股票是多少？比特币银行账户与比特币钱包相比如何？</p><p>JL：通常我们称某家银行为银行时，指的是大型托管服务。因此，他们正在为很多人管理比特币和加密资产。因此，这基本上意味着他们必须代表其他人保护所有这些私钥的安全，这意味着他们将拥有更加复杂的多层存储解决方案。</p><p>例如，当你谈论Coinbase时，我最近听说过，他们可能持有至少5%的比特币。你可以去他们的项目博客看看，他们在一两年前发表了一篇文章，讨论他们使用的一些安全机制。这基本上意味着，这些私钥的绝大部分都将在高度安全的缺省情况下脱机，其中必须有多个人同时进入，才能打开金库并进入金库，它基本上就是这个巨大的法拉第笼。每当他们想从这个冷藏库里把钱放进他们的热钱包时，这是一个非常复杂的过程，它有许多、许多的检查和平衡，以确保他们不仅免受黑客和外部威胁，但即使是从内部人士那里，他们也可能会被激励去偷私钥，然后飞到某个不被引渡的国家。</p><p>致远：在这个描述中，您概述了冷存储和热存储之间的区别，并给出了一些示例。我知道冷存储和热存储是极端的描述，它们之间有很多粒度，什么是冷存储什么是热存储。您能描述一下将被分类为冷库或热库的帐户类型吗?</p><p>JL：是的。所以一般来说，当我们说冷存储和热存储的时候，我们基本上是说它连接到互联网上或者它没有连接到互联网上。</p><p>很明显，当你把设备从互联网上断开时，你就创建了这条空隙，这样黑客就无法访问它。对于黑客来说，最安全的办法就是拔掉插头。</p><p>现在当人们想到冷存储时，他们通常想到的是纸制钱包。事实上，我不建议人们使用纸质钱包，除非他们非常先进，因为有太多东西会出问题。</p><p>但是我一般说冷存储硬件密钥管理设备,由于设备本身,而你仍然把它插在电脑甚至手机在某些情况下,这些设备设置的方式实际上是私钥不能离开设备的情况。</p><p>即使有一根电缆连接设备到另一台计算机，在电缆之间传输的数据是非常有限的，而且密钥永远不会从设备上传输出去。所以事情的另一面是一个热钱包,你有这些私钥机器不断地连接到互联网或有时连接到互联网,但它只是一个软件,是一台通用计算机管理私钥。这里的问题是，即使一个好的钱包会让这些密钥在磁盘上的文件中保持加密，但在某个时间点，您将不得不访问这些私钥。你必须解密这一团数据才能和它签署交易。</p><p>即使只有几毫秒的时间，如果计算机上有一些恶意软件或其他东西在等待您这样做，那么它可以刷新您的私钥并窃取您的所有密码资产，这就是我们遇到热钱包的主要问题，这就是为什么交易所一直被黑客攻击，是因为它们必须运行热钱包，以便能够进行自动取款。</p><p><br></p><p><br></p><p><br></p><p>===============================================================<br><b>文章首发在微信公众号：btc201800</b><br><b><a href="http://link.zhihu.com/?target=http%3A//weixin.qq.com/r/GC8UDDjEjmXxrXxv93oK" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">http://</span><span class="visible">weixin.qq.com/r/GC8UDDj</span><span class="invisible">EjmXxrXxv93oK</span><span class="ellipsis"></span></a></b> <b>(二维码自动识别)</b><br><b>音频发布在喜马拉雅上“区块链杂谈 (第2季)“</b></p><p><b>宁波格密链网络科技有限公司，专注于区块链上的密码技术研发。</b></p>