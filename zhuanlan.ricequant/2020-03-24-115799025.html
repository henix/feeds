<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>为了清除未来数据，RQData重算了300多个衍生财务指标 | 精益求精，臻于至善</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/115799025">原文</a></p>
<div class="title-image"><img src="https://pic4.zhimg.com/v2-d51d7781ce87a12d77ae3699ed4a4b78_b.jpg" alt=""></div><p>在量化投资中，财务数据是判断上市公司基本面情况的重要数据。米筐科技（Ricequant）基于量化交易的实际投资研究需求，依据上市公司三大表（资产负债表、现金流量表、利润表）原生财务数据，自主实现了超过 300 个衍生财务数据计算。</p><p>欢迎通过浏览器访问<a href="https://link.zhihu.com/?target=https%3A//datayi.cn/w/qPkMxAN9" class=" wrap external" target="_blank" rel="nofollow noreferrer">Ricequant官网</a>，或通点击下方卡片申请试用。</p><a href="https://link.zhihu.com/?target=https%3A//datayi.cn/w/qPkMxAN9" data-draft-node="block" data-draft-type="link-card" class=" wrap external" target="_blank" rel="nofollow noreferrer">RICEQUANT</a><h2><b>01 米筐科技财务指标的亮点</b></h2><p>1，<b>支持多种计算逻辑</b>，支持基于LF（即last file，最近一期财报）、LYR（即last year ratio，最近一期年报）以及TTM（即trailing twelve months，滚动12个月）三种财务数据处理逻辑。</p><p>2，<b>更贴近量化需要</b>，和其他数据商提供的财务指标相比，米筐财务衍生指标计算过程中采取了“Point in Time”的处理方式，考虑历史数据实际公布时间点来对指标进行计算，严格避免未来数据，使得所使用的数据更好的反映历史时点真实情况。</p><p>3，<b>数据稳定</b>，RQData已实现自动化清洗检查入库流程，更及时发现异常数据。</p><p>4，<b>指标种类丰富</b>, 衍生财务指标分为估值衍生指标、经营衍生指标、现金流衍生指标、财务衍生指标、成长性衍生指标五类(见表1)，涵盖了业内对于财务衍生指标绝大部分的使用需求。</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-08a5accc23c0a9f02e809271ca493f40_b.jpg" data-size="normal" data-rawwidth="753" data-rawheight="295" class="origin_image zh-lightbox-thumb" width="753" data-original="https://pic1.zhimg.com/v2-08a5accc23c0a9f02e809271ca493f40_r.jpg"/></noscript><img src="https://pic1.zhimg.com/v2-08a5accc23c0a9f02e809271ca493f40_b.jpg" data-size="normal" data-rawwidth="753" data-rawheight="295" class="origin_image zh-lightbox-thumb lazy" width="753" data-original="https://pic1.zhimg.com/v2-08a5accc23c0a9f02e809271ca493f40_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-08a5accc23c0a9f02e809271ca493f40_b.jpg"/><figcaption>财务衍生指标类型说明（表1）</figcaption></figure><h2><b>02 衍生指标计算逻辑</b></h2><p>米筐科技财务衍生指标包含<b>LF、LYR 和TTM</b>三种处理方式。若衍生指标定义中<b>涉及资产负债表</b>字段，则<b>提供上述三种财务数据处理逻辑</b>；若衍生指标定义中<b>仅涉及利润表和现金流量表</b>字段，则<b>提供LYR和TTM两种处理逻辑</b>。米筐科技财务衍生指标命名规则如表2。</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-066468dc9716cae40b676af916f23bd4_b.jpg" data-size="normal" data-rawwidth="847" data-rawheight="189" class="origin_image zh-lightbox-thumb" width="847" data-original="https://pic1.zhimg.com/v2-066468dc9716cae40b676af916f23bd4_r.jpg"/></noscript><img src="https://pic1.zhimg.com/v2-066468dc9716cae40b676af916f23bd4_b.jpg" data-size="normal" data-rawwidth="847" data-rawheight="189" class="origin_image zh-lightbox-thumb lazy" width="847" data-original="https://pic1.zhimg.com/v2-066468dc9716cae40b676af916f23bd4_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-066468dc9716cae40b676af916f23bd4_b.jpg"/><figcaption>衍生指标命名规则（表2）</figcaption></figure><p>注：和三大基础报表财务指标的LF、LYR以及TTM 处理后的命名指标不同，衍生财务指标不带有数字后缀。</p><h2><b>03 PIT计算方式的说明</b></h2><p>众所周知，财报的发布有一定的延迟，例如今年三月份发布的财报反映的是去年的经营状况，在进行量化回测等场景时，在今年三月份之前都无法获得去年年底的经营状况。将时钟倒转，以当时实际能获得的最新数据为基础进行下一步的计算或研究，这种方法称为PIT（即Point in Time）。</p><p>下面以300461.XSHE在2019年9月10日的基础财务指标滚动利润率数值进行说明（衍生财务指标依据基础财务指标计算）：</p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-5006c7e7d47b1e4bce0aa4a7e3eb315e_b.png" data-caption="" data-size="normal" data-rawwidth="1592" data-rawheight="195" class="origin_image zh-lightbox-thumb" width="1592" data-original="https://pic3.zhimg.com/v2-5006c7e7d47b1e4bce0aa4a7e3eb315e_r.jpg"/></noscript><img src="https://pic3.zhimg.com/v2-5006c7e7d47b1e4bce0aa4a7e3eb315e_b.png" data-caption="" data-size="normal" data-rawwidth="1592" data-rawheight="195" class="origin_image zh-lightbox-thumb lazy" width="1592" data-original="https://pic3.zhimg.com/v2-5006c7e7d47b1e4bce0aa4a7e3eb315e_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-5006c7e7d47b1e4bce0aa4a7e3eb315e_b.png"/></figure><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-9a4cd0106d7853033973615301ef1616_b.jpg" data-caption="" data-size="normal" data-rawwidth="929" data-rawheight="560" class="origin_image zh-lightbox-thumb" width="929" data-original="https://pic3.zhimg.com/v2-9a4cd0106d7853033973615301ef1616_r.jpg"/></noscript><img src="https://pic3.zhimg.com/v2-9a4cd0106d7853033973615301ef1616_b.jpg" data-caption="" data-size="normal" data-rawwidth="929" data-rawheight="560" class="origin_image zh-lightbox-thumb lazy" width="929" data-original="https://pic3.zhimg.com/v2-9a4cd0106d7853033973615301ef1616_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-9a4cd0106d7853033973615301ef1616_b.jpg"/></figure><p>注：对于资产负债表为TTM为最近四期报告数据均值，对于现金流量表和利润表，TTM为连续四季度报告数据的累加值。</p><p>利润表TTM = 最近一期年报的数据 + 最近一期披露数据 − 去年同期披露数据</p><p>如上图300461.XSHE在2019年8月30日当天发布了2019半年报，2019半年报对2018q2的净利润进行了数值调整，2018q2在2019年半年报中数值由原先54961372.9700调整为24396031.7900，如图在计算2019年9月10日的300461.XSHE滚动净利润时采用的是当时2018q2的最新值24396031.7900而不是54961372.9700。</p><p>PIT财务数据应用于米筐四大投研产品（见下图），避免任何未来数据的干扰，为客户搭建准确可靠的投研业务系统。</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-3b878f4cdba8f9c19644a0c04c50f1c1_b.jpg" data-caption="" data-size="normal" data-rawwidth="885" data-rawheight="288" class="origin_image zh-lightbox-thumb" width="885" data-original="https://pic2.zhimg.com/v2-3b878f4cdba8f9c19644a0c04c50f1c1_r.jpg"/></noscript><img src="https://pic2.zhimg.com/v2-3b878f4cdba8f9c19644a0c04c50f1c1_b.jpg" data-caption="" data-size="normal" data-rawwidth="885" data-rawheight="288" class="origin_image zh-lightbox-thumb lazy" width="885" data-original="https://pic2.zhimg.com/v2-3b878f4cdba8f9c19644a0c04c50f1c1_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-3b878f4cdba8f9c19644a0c04c50f1c1_b.jpg"/></figure><h2><b>04 基于米筐PIT处理财务指标，避免策略回测表现失真</b></h2><p>米筐提供的财务指标基于财报的调整记录做了严格的PIT处理，避免投研中未来数据带来的回测结果失真的问题。</p><p>以股票300029.XSHE为例，在10月24日发布，10月28日调整的情况下，一般数据供应商会把24——28日之间的净利润也修改为亏损3619万元。若以该数据进行回测，在24日选股策略则会“预知”该股票净利润大幅亏损，从而避免持有。该“预知” 能力，会导致策略在回测中表现明显提升——买入未来净利润上调的股票，或卖出未来净利润下调的股票。从而导致策略的回测表现失真，在实盘中无法重现。</p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-9bb5218b63f85f296fa7bb051f6513ce_b.jpg" data-caption="" data-size="normal" data-rawwidth="1099" data-rawheight="407" class="origin_image zh-lightbox-thumb" width="1099" data-original="https://pic3.zhimg.com/v2-9bb5218b63f85f296fa7bb051f6513ce_r.jpg"/></noscript><img src="https://pic3.zhimg.com/v2-9bb5218b63f85f296fa7bb051f6513ce_b.jpg" data-caption="" data-size="normal" data-rawwidth="1099" data-rawheight="407" class="origin_image zh-lightbox-thumb lazy" width="1099" data-original="https://pic3.zhimg.com/v2-9bb5218b63f85f296fa7bb051f6513ce_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-9bb5218b63f85f296fa7bb051f6513ce_b.jpg"/></figure><p>get_factor严格按照回测中当前时间点，市场所能获知的财务情况计算因子取值，从而真实反映策略基于当前信息的选股能力，提升投研回测的准确度。</p><h2><b>05 基于财务报告完整调整记录，构建公司治理质量风险指标</b></h2><p>随着证券市场监管的完善，和MSCI等知名机构把公司治理水平纳入指数编制的考量，投资者对于上市公司的治理水平关注度持续增加，上市公司的财务报告的操作是公司治理水平低下的重要表现之一。米筐的get_pit_financials查询财务数据提供上市公司各期财务报告的完整发布/修正记录，帮助客户追踪和分析上市公司财务操作的蛛丝马迹，构建公司治理水平质量的风险排查指标。</p><p>例如，查询股票300029.XSHE的2019年三季度报，发现其在10月24日公布亏损696万元，10月28日调整为亏损3619万元，存在财务操作的嫌疑。该股票前复权收盘价也在10月28日后开始大幅下跌，直到年底。上述例子说明，通过财报记录的及时跟踪，能够发现排除存在治理问题的上市公司，避免潜在损失。</p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-91d1acc97559c7b2fdf5fd00d30458b7_b.jpg" data-caption="" data-size="normal" data-rawwidth="671" data-rawheight="440" class="origin_image zh-lightbox-thumb" width="671" data-original="https://pic4.zhimg.com/v2-91d1acc97559c7b2fdf5fd00d30458b7_r.jpg"/></noscript><img src="https://pic4.zhimg.com/v2-91d1acc97559c7b2fdf5fd00d30458b7_b.jpg" data-caption="" data-size="normal" data-rawwidth="671" data-rawheight="440" class="origin_image zh-lightbox-thumb lazy" width="671" data-original="https://pic4.zhimg.com/v2-91d1acc97559c7b2fdf5fd00d30458b7_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-91d1acc97559c7b2fdf5fd00d30458b7_b.jpg"/></figure><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-4ceba7b4de13ba2d759321270ceb0c1b_b.jpg" data-caption="" data-size="normal" data-rawwidth="1076" data-rawheight="301" class="origin_image zh-lightbox-thumb" width="1076" data-original="https://pic4.zhimg.com/v2-4ceba7b4de13ba2d759321270ceb0c1b_r.jpg"/></noscript><img src="https://pic4.zhimg.com/v2-4ceba7b4de13ba2d759321270ceb0c1b_b.jpg" data-caption="" data-size="normal" data-rawwidth="1076" data-rawheight="301" class="origin_image zh-lightbox-thumb lazy" width="1076" data-original="https://pic4.zhimg.com/v2-4ceba7b4de13ba2d759321270ceb0c1b_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-4ceba7b4de13ba2d759321270ceb0c1b_b.jpg"/></figure><h2><b>06 米筐RQData数据本地化服务</b></h2><p>RQData集成了简单高效的API，通过极简的本地安装方式，提供强大的数据查询访问功能。最大限度地免除数据整理、清洗及运维的烦恼，帮助投研人员更专注于投研及模型开发等关键环节。</p><p>米筐RQData上线五年，零服务中断。米筐采取了流式传输和压缩、负载均衡（CLB）及Kubernets技术来满足数据实时订阅的低延迟要求，实现了全自动化运维及高峰期动态扩容，能够保障不间断的投研及研发，为客户关键业务保驾护航。</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-45ff144afc27f47b62a1f7ee9d8fea01_b.jpg" data-size="normal" data-rawwidth="701" data-rawheight="689" class="origin_image zh-lightbox-thumb" width="701" data-original="https://pic2.zhimg.com/v2-45ff144afc27f47b62a1f7ee9d8fea01_r.jpg"/></noscript><img src="https://pic2.zhimg.com/v2-45ff144afc27f47b62a1f7ee9d8fea01_b.jpg" data-size="normal" data-rawwidth="701" data-rawheight="689" class="origin_image zh-lightbox-thumb lazy" width="701" data-original="https://pic2.zhimg.com/v2-45ff144afc27f47b62a1f7ee9d8fea01_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-45ff144afc27f47b62a1f7ee9d8fea01_b.jpg"/><figcaption>米筐RQData提供全市场金融数据(表3)</figcaption></figure><p>RQData支持Python API、Matlab API及Excel插件等多种调取方式</p><p class="ztext-empty-paragraph"><br/></p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-70e7b0dc89b8b8eae90258f1c0cd9550_b.jpg" data-caption="" data-size="normal" data-rawwidth="1660" data-rawheight="1148" class="origin_image zh-lightbox-thumb" width="1660" data-original="https://pic1.zhimg.com/v2-70e7b0dc89b8b8eae90258f1c0cd9550_r.jpg"/></noscript><img src="https://pic1.zhimg.com/v2-70e7b0dc89b8b8eae90258f1c0cd9550_b.jpg" data-caption="" data-size="normal" data-rawwidth="1660" data-rawheight="1148" class="origin_image zh-lightbox-thumb lazy" width="1660" data-original="https://pic1.zhimg.com/v2-70e7b0dc89b8b8eae90258f1c0cd9550_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-70e7b0dc89b8b8eae90258f1c0cd9550_b.jpg"/></figure><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-7c227c92ed4ebdbf32c996e21be876c9_b.jpg" data-caption="" data-size="normal" data-rawwidth="1660" data-rawheight="1148" class="origin_image zh-lightbox-thumb" width="1660" data-original="https://pic2.zhimg.com/v2-7c227c92ed4ebdbf32c996e21be876c9_r.jpg"/></noscript><img src="https://pic2.zhimg.com/v2-7c227c92ed4ebdbf32c996e21be876c9_b.jpg" data-caption="" data-size="normal" data-rawwidth="1660" data-rawheight="1148" class="origin_image zh-lightbox-thumb lazy" width="1660" data-original="https://pic2.zhimg.com/v2-7c227c92ed4ebdbf32c996e21be876c9_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-7c227c92ed4ebdbf32c996e21be876c9_b.jpg"/></figure><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-a615e5d8336fe7451ba31bfc008646d2_b.jpg" data-caption="" data-size="normal" data-rawwidth="1660" data-rawheight="1148" class="origin_image zh-lightbox-thumb" width="1660" data-original="https://pic3.zhimg.com/v2-a615e5d8336fe7451ba31bfc008646d2_r.jpg"/></noscript><img src="https://pic3.zhimg.com/v2-a615e5d8336fe7451ba31bfc008646d2_b.jpg" data-caption="" data-size="normal" data-rawwidth="1660" data-rawheight="1148" class="origin_image zh-lightbox-thumb lazy" width="1660" data-original="https://pic3.zhimg.com/v2-a615e5d8336fe7451ba31bfc008646d2_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-a615e5d8336fe7451ba31bfc008646d2_b.jpg"/></figure><p class="ztext-empty-paragraph"><br/></p><p>米筐科技秉持“精益求精，臻于至善”的理念，为资管行业提供更多优质金融科技产品服务。米筐RQData自算衍生财务指标已加入RQData数据库。</p><p>欢迎通过浏览器访问<a href="https://link.zhihu.com/?target=https%3A//datayi.cn/w/qPkMxAN9" class=" wrap external" target="_blank" rel="nofollow noreferrer">Ricequant官网</a>，或通点击下方卡片申请试用。</p><a href="https://link.zhihu.com/?target=https%3A//datayi.cn/w/qPkMxAN9" data-draft-node="block" data-draft-type="link-card" class=" wrap external" target="_blank" rel="nofollow noreferrer">RICEQUANT</a><p></p>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
