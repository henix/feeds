<div class="title-image"><img src="https://pic2.zhimg.com/v2-ec365838de922be3943a970c1d2f3e1d_b.jpg" alt=""></div><p></p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-37fc3cc4e57451d49f0f844e2cc35a26_b.jpg" data-caption="" data-size="normal" data-rawwidth="900" data-rawheight="500" class="origin_image zh-lightbox-thumb" width="900" data-original="https://pic3.zhimg.com/v2-37fc3cc4e57451d49f0f844e2cc35a26_r.jpg"/></noscript><img src="https://pic3.zhimg.com/v2-37fc3cc4e57451d49f0f844e2cc35a26_b.jpg" data-caption="" data-size="normal" data-rawwidth="900" data-rawheight="500" class="origin_image zh-lightbox-thumb lazy" width="900" data-original="https://pic3.zhimg.com/v2-37fc3cc4e57451d49f0f844e2cc35a26_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-37fc3cc4e57451d49f0f844e2cc35a26_b.jpg"/></figure><p><b>一、导语</b></p><p>我们知道，资产价格的波动受到非常多因素的影响，比如上一个交易日的价格，交易量，国家经济走势，交易者的心理预期，各种技术指标，财务指标，甚至还可以是交易日的天气情况等等。每个人都可以总结出非常多影响资产价格的特征（也可以叫因子，变量）。但是如何在这些特征中，选取出<b>真正有效的特征</b>呢？这时候就可以用到本文中要介绍的<b>信息增益</b>了。</p><p class="ztext-empty-paragraph"><br/></p><p><b>二、熵</b></p><p>即：下一个交易日的涨跌的不确定性。</p><p>由于影响资产价格的因素很多，因此人们往往用随机性描述资产的价格波动，把它看成一个<b>随机变量</b>。但是，随机变量的不确定性不是一成不变的。比如扔硬币，如果90%的概率都是正面向上，我们认为它的不确定性比50%正面向上的硬币要低。那么<b>如何衡量一个离散变量的不确定性呢</b>？在信息论和概率统计中，人们使用一个变量的‘<b>熵</b>’来表示这个变量的不确定性。为了简明起见，我们都用离散变量进行举例。</p><p>如果一个离散变量Y的概率分布是：</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-03fc8a893bd672fbfc418cb4d4a83719_b.jpg" data-caption="" data-size="normal" data-rawwidth="263" data-rawheight="61" class="content_image" width="263"/></noscript><img src="https://pic2.zhimg.com/v2-03fc8a893bd672fbfc418cb4d4a83719_b.jpg" data-caption="" data-size="normal" data-rawwidth="263" data-rawheight="61" class="content_image lazy" width="263" data-actualsrc="https://pic2.zhimg.com/v2-03fc8a893bd672fbfc418cb4d4a83719_b.jpg"/></figure><p>那么变量Y的熵定义为：</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-0b457a53caf7dfca8e4fc8b5e2e21491_b.jpg" data-caption="" data-size="normal" data-rawwidth="205" data-rawheight="61" class="content_image" width="205"/></noscript><img src="https://pic2.zhimg.com/v2-0b457a53caf7dfca8e4fc8b5e2e21491_b.jpg" data-caption="" data-size="normal" data-rawwidth="205" data-rawheight="61" class="content_image lazy" width="205" data-actualsrc="https://pic2.zhimg.com/v2-0b457a53caf7dfca8e4fc8b5e2e21491_b.jpg"/></figure><p>由上述公式看出，当变量Y的分布只有一个值的时候，它没有任何不确定性，计算出的熵是0。一个变量的<b>熵越大</b>，它的<b>不确定性也越大</b>，也<b>越难预测</b>。举个例子：如果我们用变量X表示第二天的资产涨跌，X只能取上涨或者下跌。当X取上涨的概率从0%变化到100%时，其熵的变化是先变大再变小的。如下图所示，资产涨跌概率都是50%的时候，熵最大，表示这时候的状态最不稳定，最无序。</p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-fc675fc08f787186ad3d69bc977b6c52_b.jpg" data-caption="" data-size="normal" data-rawwidth="423" data-rawheight="290" class="origin_image zh-lightbox-thumb" width="423" data-original="https://pic3.zhimg.com/v2-fc675fc08f787186ad3d69bc977b6c52_r.jpg"/></noscript><img src="https://pic3.zhimg.com/v2-fc675fc08f787186ad3d69bc977b6c52_b.jpg" data-caption="" data-size="normal" data-rawwidth="423" data-rawheight="290" class="origin_image zh-lightbox-thumb lazy" width="423" data-original="https://pic3.zhimg.com/v2-fc675fc08f787186ad3d69bc977b6c52_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-fc675fc08f787186ad3d69bc977b6c52_b.jpg"/></figure><p class="ztext-empty-paragraph"><br/></p><p><b>三、条件熵</b></p><p>即：知道了今天的涨跌，下一个交易日的涨跌的不确定性。</p><p>上文中，我们介绍了离散变量的熵及其计算公式。但是为了更好的预测未来的涨跌情况，我们需要更多的信息。例如，在股票涨跌的预测中，如果不知道其他信息，可以假设涨跌的概率都是50%，股票变动的熵就是1；但在已知今天的涨跌的情况下，下一个交易日涨跌的概率就变成<b><i>P(Xt|Xt-1=涨)</i></b>或者是<b><i>P(Xt|Xt-1=跌)</i></b>此时怎么进行熵的衡量呢？</p><p>假设我们要研究的变量为Y，已观测到的变量为X；用<b><i>H(Y|X=xi)</i></b>表示在X取值为xi的情况下，变量Y的熵，那么条件熵<b><i>H(Y|X)</i></b>就表示在已知信息X的情况下，变量Y的不确定性。条件熵的计算公式是：</p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-57cedf370075ec5871fa581ad56b65ca_b.jpg" data-caption="" data-size="normal" data-rawwidth="288" data-rawheight="60" class="content_image" width="288"/></noscript><img src="https://pic3.zhimg.com/v2-57cedf370075ec5871fa581ad56b65ca_b.jpg" data-caption="" data-size="normal" data-rawwidth="288" data-rawheight="60" class="content_image lazy" width="288" data-actualsrc="https://pic3.zhimg.com/v2-57cedf370075ec5871fa581ad56b65ca_b.jpg"/></figure><p>在这里，<b><i>pxi=P(X=xi)</i></b>，i=1,2,…,m。注意这个公式中的<b><i>H(Y|X=xi)</i></b>和<b><i>H(Y|X)</i></b>的符号比较像，但<b><i>H(Y|X=xi)</i></b>的意思是将<b><i>(Y|X=xi)</i></b>整体看成一个变量Z，利用下面的公式进行计算，不要被迷惑了。</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-07a8881f68334e58656cd85835250c39_b.jpg" data-caption="" data-size="normal" data-rawwidth="199" data-rawheight="29" class="content_image" width="199"/></noscript><img src="https://pic2.zhimg.com/v2-07a8881f68334e58656cd85835250c39_b.jpg" data-caption="" data-size="normal" data-rawwidth="199" data-rawheight="29" class="content_image lazy" width="199" data-actualsrc="https://pic2.zhimg.com/v2-07a8881f68334e58656cd85835250c39_b.jpg"/></figure><p class="ztext-empty-paragraph"><br/></p><p><b>四、信息增益</b></p><p>即：特征中包含的信息度量。</p><p>熵是变量不确定性的度量，条件熵就是在已知某些特征信息的情况下，对变量的不确定性的度量。那么这些已知的特征信息<b>做了多少贡献呢</b>？这就得引入信息增益的概念了。特征X对于变量Y的信息增益<b><i>g(X,Y)</i></b>的计算公式如下：</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-1dbb447d1b0c0264ef5b00ea4778e730_b.jpg" data-caption="" data-size="normal" data-rawwidth="240" data-rawheight="47" class="content_image" width="240"/></noscript><img src="https://pic1.zhimg.com/v2-1dbb447d1b0c0264ef5b00ea4778e730_b.jpg" data-caption="" data-size="normal" data-rawwidth="240" data-rawheight="47" class="content_image lazy" width="240" data-actualsrc="https://pic1.zhimg.com/v2-1dbb447d1b0c0264ef5b00ea4778e730_b.jpg"/></figure><p>信息增益也被称为“<b>互信息</b>”，表示<b>知道特征X的信息时</b>，<b>变量Y的信息不确定性减少程度</b>。信息增益越大，表示特征提供的信息越多，这个特征也越重要。</p><p>下面通过一个小例子，具体展示下信息增益的计算过程：</p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-8dbfed71b27ee9d31a58ae09f4cadd1a_b.jpg" data-caption="" data-size="normal" data-rawwidth="494" data-rawheight="238" class="origin_image zh-lightbox-thumb" width="494" data-original="https://pic3.zhimg.com/v2-8dbfed71b27ee9d31a58ae09f4cadd1a_r.jpg"/></noscript><img src="https://pic3.zhimg.com/v2-8dbfed71b27ee9d31a58ae09f4cadd1a_b.jpg" data-caption="" data-size="normal" data-rawwidth="494" data-rawheight="238" class="origin_image zh-lightbox-thumb lazy" width="494" data-original="https://pic3.zhimg.com/v2-8dbfed71b27ee9d31a58ae09f4cadd1a_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-8dbfed71b27ee9d31a58ae09f4cadd1a_b.jpg"/></figure><p>在上表中，一共有六个Y的数据，其中三个是涨，三个是跌，涨和跌的概率分布都是50%。记<i><b>p1=p(Y=涨)=1/2</b></i>，<i><b>p2=p(Y=跌)=1/2</b></i>。那么Y的熵是：</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-638e9f9ba265fcc79d960ee601b1de6c_b.jpg" data-caption="" data-size="normal" data-rawwidth="314" data-rawheight="153" class="content_image" width="314"/></noscript><img src="https://pic1.zhimg.com/v2-638e9f9ba265fcc79d960ee601b1de6c_b.jpg" data-caption="" data-size="normal" data-rawwidth="314" data-rawheight="153" class="content_image lazy" width="314" data-actualsrc="https://pic1.zhimg.com/v2-638e9f9ba265fcc79d960ee601b1de6c_b.jpg"/></figure><p>在X为涨的情况下，一共有两个Y的数据，都是涨。记<b><i>p1=P(Y=涨|X=涨)=1</i></b>，<b><i>p2=P(Y=跌|X=涨)=0</i></b>，则有：</p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-edd78744830aa25e1ead023f9519c8ab_b.jpg" data-caption="" data-size="normal" data-rawwidth="289" data-rawheight="116" class="content_image" width="289"/></noscript><img src="https://pic4.zhimg.com/v2-edd78744830aa25e1ead023f9519c8ab_b.jpg" data-caption="" data-size="normal" data-rawwidth="289" data-rawheight="116" class="content_image lazy" width="289" data-actualsrc="https://pic4.zhimg.com/v2-edd78744830aa25e1ead023f9519c8ab_b.jpg"/></figure><p>这里再重复一下，需要把<b><i>(Y|X=涨)</i></b>整体看做一个变量，才能更好的理解公式。</p><p>在X是跌的情况下，一共有四个Y的数据，三个是跌，一个是涨，记<i><b>p1=P(Y=跌|X=跌)=3/4</b></i>，<i><b>p1=P(Y=涨|X=跌)=1/4</b></i>，则有：</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-7320197108e216ea2ac15b61bc380471_b.jpg" data-caption="" data-size="normal" data-rawwidth="375" data-rawheight="147" class="content_image" width="375"/></noscript><img src="https://pic2.zhimg.com/v2-7320197108e216ea2ac15b61bc380471_b.jpg" data-caption="" data-size="normal" data-rawwidth="375" data-rawheight="147" class="content_image lazy" width="375" data-actualsrc="https://pic2.zhimg.com/v2-7320197108e216ea2ac15b61bc380471_b.jpg"/></figure><p>我们考虑X本身的涨跌概率，记<b><i>px1=P(X=涨)=1/3</i></b>，<b><i>px2=P(X=跌)=2/3</i></b>，则最终的条件熵为：</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-c1b9c9d30ac386c19d322a077bc8b0e9_b.jpg" data-caption="" data-size="normal" data-rawwidth="359" data-rawheight="142" class="content_image" width="359"/></noscript><img src="https://pic2.zhimg.com/v2-c1b9c9d30ac386c19d322a077bc8b0e9_b.jpg" data-caption="" data-size="normal" data-rawwidth="359" data-rawheight="142" class="content_image lazy" width="359" data-actualsrc="https://pic2.zhimg.com/v2-c1b9c9d30ac386c19d322a077bc8b0e9_b.jpg"/></figure><p>信息增益为：</p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-62264beacfe543bff1610bfeb4607cbb_b.jpg" data-caption="" data-size="normal" data-rawwidth="265" data-rawheight="100" class="content_image" width="265"/></noscript><img src="https://pic4.zhimg.com/v2-62264beacfe543bff1610bfeb4607cbb_b.jpg" data-caption="" data-size="normal" data-rawwidth="265" data-rawheight="100" class="content_image lazy" width="265" data-actualsrc="https://pic4.zhimg.com/v2-62264beacfe543bff1610bfeb4607cbb_b.jpg"/></figure><p class="ztext-empty-paragraph"><br/></p><p><b>五、小结</b></p><p>上面给大家介绍了信息论中的信息增益的计算方法。通俗而言，<b>利用信息增益可以衡量在引入一个变量之后，原有变量不确定性减少的程度</b>。信息增益越高，表示新引入的变量效果越好。信息增益可以帮助我们了解各个因子是否有效，也可以用来衡量<b>机器学习</b>中的各个特征的重要性。还有更多的用法，大家可以自己去探索。</p>