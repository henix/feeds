<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>不完美的“完美洗牌法”</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/29178813">原文</a></p>
<div class="title-image"><img src="https://pic4.zhimg.com/v2-a489a16ffc57b24d824dfe2c8939cb66_r.jpg" alt=""></div><p>（  ┬─┬ ノ( ' - 'ノ)      迫切需要美术编辑！     (╯' - ')╯︵ ┻━┻  ）</p><p><br></p><p>为后续理论的叙述方便，将一摞纸牌<b>自上而下从0开始</b>计数，即自上而下是第0张牌、第1张牌、……、第50张牌、第51张牌。</p><hr><p><b>交错式洗牌（riffle）</b>又称为<b>完美洗牌法（perfect riffle shuffle）</b>或<b>鸽尾洗牌法</b>，是一种常见的洗牌方法，主要流程为先将纸牌分成两半，之后使两叠纸牌一张叉一张地交错叠在一起。</p><p>完美洗牌法有两种：</p><ul><li>顶端的纸牌洗牌后仍在顶端，称作<b>外洗法</b>；</li><li>否则（顶端纸牌洗牌后处在第2张位置）称作<b>内洗法</b>。</li></ul><p>如图1所示，(a) 表示分为两半，(b)表示外洗法，(c)表示内洗法。</p><img src="https://pic4.zhimg.com/v2-e767f4b37eb90a2145b20f8fe2f65e80_r.png" data-rawwidth="1300" data-rawheight="585"><p>图2是8张纸牌的外洗法和内洗法的示例。</p><img src="https://pic3.zhimg.com/v2-daa7fb6892cd6f6b4e76b5a3db3a377e_r.png" data-rawwidth="1249" data-rawheight="355"><p><br></p><hr><p>无论外洗法还是内洗法，都是某位置上纸牌的置换（如图3所示），逆置换就是纸牌所在位置的置换。</p><img src="https://pic1.zhimg.com/v2-b36afc8785e02642234c04178fc5909b_r.png" data-rawwidth="1133" data-rawheight="378"><ul><li>外洗法置换的形式化表示为： <equation>f(2i)=i，f(2i+1)=26+i，0\leq i\leq 25</equation> ；</li><li>内洗法置换的形式化表示为： <equation>g(2i+1)=i，g(2i)=26+i，0\leq i \leq 25</equation>。</li></ul><p>（ <equation>f ^{-1}(x)=2x，2x&lt;51</equation> 时； <equation>f ^{-1}(x)=2x-51，2x\geq51</equation> 时。<equation>g^{-1}(x)=2x+1，2x&lt;51</equation>时； <equation>g^{-1}(x)=2x-52，2x\geq51</equation> 时。）</p><hr><p>可以将置换写作轮换的乘积，如8张纸牌的外洗法（图4(a)）可写作(1)(235)(476)(8)，8张纸牌的内洗法（图4(b)）可写作(124875)(36)。</p><img src="https://pic4.zhimg.com/v2-a86f6f7b4123e16a55cb938b67ab2f36_r.png" data-rawwidth="1235" data-rawheight="428"><p>于是可以由轮换计算计算置换的周期：假设置换 <equation>\pi=\sigma_1\sigma_2…\sigma_k</equation>， <equation>\sigma_i</equation> 的长度为 <equation>l_i</equation> ，则得到 <equation>\pi</equation> 的周期为 <equation>\text{LCM}[l_1,l_2…,l_k]</equation> 。如图5所示，8张纸牌的外洗法置换(0)(142)(356)(7)的周期是3。</p><img src="https://pic2.zhimg.com/v2-bd8c4f1e13648444e235706085316238_r.png" data-rawwidth="1003" data-rawheight="833"><p>8张纸牌的外洗法置换为(0)(1, 26, 13, 32, 16, 8, 4, 2)(3, 27, 39, 45, 48, 24, 12, 6)(5, 28, 14, 7, 29, 40, 20, 10)(9, 30, 15, 33, 42, 21, 36, 18)(11, 31, 41, 46, 23, 37, 44, 22)(19, 35, 43, 47, 49, 50, 25, 38)(17, 34)(51)，周期为8，也即使用外洗法洗牌<b>8次</b>就会将整叠纸牌恢复到最初的顺序。（如图5所示）</p><p>而8张纸牌的内洗法置换为(0, 26, 39, 19, 9, 4, 28, 40, 46, 49, 24, 38, 45, 22, 37, 18, 35, 17, 8, 30, 41, 20, 36, 44, 48, 50, 51, 25, 12, 32, 42, 47, 23, 11, 5, 2, 27, 13, 6, 29, 14, 33, 16, 34, 43, 21, 10, 31, 15, 7, 3, 1)，周期为52，需要<b>52次洗牌</b>才会将整叠纸牌恢复到最初的顺序。</p><p>虽然52远多于8，但和一副牌的全排列数52!相比实在太微不足道了，从置乱的角度上讲，“完美洗牌法”远非完美；然而它在魔术中却具有奇妙的作用——请看下篇。</p><p><br></p><p>（写的我想哭了 (;﹏;) 支持的格式太“单纯”了……）</p>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
