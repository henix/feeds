<p>我相信很多人（大佬除外）都有这样的疑惑，就是base64加密后有时后面有一个“=”；有时有两个“=”；有时没有“=”。在做CTF题的时候，遇到没有“=”的时候，都怀疑自己是不是哪一步搞错了。</p><p>像这样：</p><ul><li>dHdvc2VjdXJpdHk=</li><li>d2VsY29tZQ==</li><li>eW91</li></ul><p>今天，我们就来一探究竟。</p><h2>Base64</h2><p><b>什么是base64加密？</b></p><blockquote>Base64 是网络上最常见的用于传输 8Bit 字节码的编码方式之一，Base64 就是一种基于 64 个可打印字符来表示二进制数据的方法。Base64 编码是从二进制到字符的过程，可用于在HTTP环境下传递较长的标识信息。采用 Base64 编码具有不可读性，需要解码后才能阅读。</blockquote><p>简而言之，一种只有 64 个对象的 8Bit 编码。表单如下：</p><div class="highlight"><pre><code class="language-text">0　A　　17　R　　　34　i　　　51　z

1　B　　18　S　　　35　j　　　52　0

2　C　　19　T　　　36　k　　　53　1

3　D　　20　U　　　37　l　　　54　2

4　E　　21　V　　　38　m　　　55　3

5　F　　22　W　　　39　n　　　56　4

6　G　　23　X　　　40　o　　　57　5

7　H　　24　Y　　　41　p　　　58　6

8　I　　25　Z　　　42　q　　　59　7

9　J　　26　a　　　43　r　　　60　8

10　K　　27　b　　　44　s　　　61　9

11　L　　28　c　　　45　t　　　62　+

12　M　　29　d　　　46　u　　　63　/

13　N　　30　e　　　47　v

14　O　　31　f　　　48　w

15　P　　32　g　　　49　x

16　Q　　33　h　　　50　y</code></pre></div><p>我们想要知道它末尾的“=”是如何产生的，就要了解其编码的过程。</p><p><b>编码的过程？</b></p><p>Base64 编码在数据传输过程中应用广泛，例如传统的邮件只支持可见字符的传送，像 ASCII 码的控制字符就不能通过邮件传送。这样就受到了很大的限制，比如图片二进制流的每个字节不可能全部是可见字符，所以就传送不了。正好 Base64 编码使用 64 个可见字符来表示二进制数据。</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-69a1611f1af279c737e00ec46b427691_b.jpg" data-caption="" data-size="normal" data-rawwidth="1141" data-rawheight="128" class="origin_image zh-lightbox-thumb" width="1141" data-original="https://pic2.zhimg.com/v2-69a1611f1af279c737e00ec46b427691_r.jpg"/></noscript><img src="https://pic2.zhimg.com/v2-69a1611f1af279c737e00ec46b427691_b.jpg" data-caption="" data-size="normal" data-rawwidth="1141" data-rawheight="128" class="origin_image zh-lightbox-thumb lazy" width="1141" data-original="https://pic2.zhimg.com/v2-69a1611f1af279c737e00ec46b427691_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-69a1611f1af279c737e00ec46b427691_b.jpg"/></figure><p>由图中可以看出 base64 编码整个过程：</p><ul><li>取源文本二进制位</li><li>对源文本二进制位按 6 位划分得到 base64 划分二进制位</li><li>在 base64 划分二进制位前面添加两个 0，得到 base64 字典索引</li><li>查 base64 表，得到 base64 对应的值</li></ul><p><b>Base64 编码解析</b></p><p>我们通过上面的图可以看出，每 3 字节源文本会生成 4 字节 base64 编码（&#34;Nod&#34; 生成 &#34;Tm9k&#34;）,那么我们在编码的时候每次处理三个字节的数据（生成不足 4 字节的用&#34;=&#34;补充），处理步骤如下:</p><ul><li>取第一个字节的前 6 位并在前面加上 00，这里我们使用&#34;右移&#34;<br/>&#39;N&#39; =&gt; &#39;01001110&#39; =&gt; 右移两位 =&gt; &#39;00010011&#39; =&gt; 19 =&gt; 查表 =&gt; &#39;T&#39;</li><li>取第一个字节的后 2 位(用&#39;与&#39;和&#39;左移&#39;)，加上第二个字节的前 4 位<br/>&#39;N&#39; =&gt; &#39;01001110&#39; =&gt; 与运算 &#39;00000011&#39; =&gt; &#39;00000010&#39; =&gt; 左移 4 位 =&gt; &#39;00100000&#39;<br/>&#39;o&#39; =&gt; &#39;01101111&#39; =&gt; 右移 4 位 =&gt; &#39;00000110&#39; =&gt; &#39;00100000&#39; 加上 &#39;00000110&#39; =&gt; &#39;00100110&#39; =&gt; 查表 =&gt; &#39;m&#39;</li><li>后面的依次类推，使用&#34;与&#34;,&#34;右移&#34;,&#34;左移&#34;操作将 3 字节变成 4 字节</li></ul><blockquote>“与”运算是计算机中一种基本的逻辑运算方式，符号表示为 &amp;。<br/>运算规则：0&amp;0=0;  0&amp;1=0;   1&amp;0=0;    1&amp;1=1<br/>即：两位同时为“1”，结果才为“1”，否则为0<br/>例如：3&amp;5  即 0000 0011&amp; 0000 0101 = 00000001  因此，3&amp;5的值得1。<br/>“左移”将一个运算对象的各二进制位全部左移若干位（左边的二进制丢弃，右边补0）<br/>例如：<br/>00001010&lt;&lt;2 = 00101000<br/>10001010&lt;&lt;3 = 01010000</blockquote><p>解码与之相反，将 4 字节的 base64 编码进行还原为 3 字节的源文本。</p><h2>Base64 编码解码实现✔</h2><p>这里以 node.js 为例。</p><p>先实现 base64 的字典（算是 base64 的核心吧）</p><div class="highlight"><pre><code class="language-js"><span class="k">const</span> <span class="nx">base64EncodeDict</span> <span class="o">=</span> <span class="s1">&#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#39;</span><span class="p">;</span>
<span class="k">const</span> <span class="nx">baseDecodeDict</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;0&#39;</span><span class="o">:</span> <span class="mi">52</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="o">:</span> <span class="mi">53</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="o">:</span> <span class="mi">54</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="o">:</span> <span class="mi">55</span><span class="p">,</span> <span class="s1">&#39;4&#39;</span><span class="o">:</span> <span class="mi">56</span><span class="p">,</span> <span class="s1">&#39;5&#39;</span><span class="o">:</span> <span class="mi">57</span><span class="p">,</span> <span class="s1">&#39;6&#39;</span><span class="o">:</span> <span class="mi">58</span><span class="p">,</span> <span class="s1">&#39;7&#39;</span><span class="o">:</span> <span class="mi">59</span><span class="p">,</span> <span class="s1">&#39;8&#39;</span><span class="o">:</span> <span class="mi">60</span><span class="p">,</span> <span class="s1">&#39;9&#39;</span><span class="o">:</span> <span class="mi">61</span><span class="p">,</span> <span class="nx">A</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">B</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">C</span><span class="o">:</span> <span class="mi">2</span><span class="p">,</span> <span class="nx">D</span><span class="o">:</span> <span class="mi">3</span><span class="p">,</span> <span class="nx">E</span><span class="o">:</span> <span class="mi">4</span><span class="p">,</span> <span class="nx">F</span><span class="o">:</span> <span class="mi">5</span><span class="p">,</span> <span class="nx">G</span><span class="o">:</span> <span class="mi">6</span><span class="p">,</span> <span class="nx">H</span><span class="o">:</span> <span class="mi">7</span><span class="p">,</span> <span class="nx">I</span><span class="o">:</span> <span class="mi">8</span><span class="p">,</span> <span class="nx">J</span><span class="o">:</span> <span class="mi">9</span><span class="p">,</span> <span class="nx">K</span><span class="o">:</span> <span class="mi">10</span><span class="p">,</span> <span class="nx">L</span><span class="o">:</span> <span class="mi">11</span><span class="p">,</span> <span class="nx">M</span><span class="o">:</span> <span class="mi">12</span><span class="p">,</span> <span class="nx">N</span><span class="o">:</span> <span class="mi">13</span><span class="p">,</span> <span class="nx">O</span><span class="o">:</span> <span class="mi">14</span><span class="p">,</span> <span class="nx">P</span><span class="o">:</span> <span class="mi">15</span><span class="p">,</span> <span class="nx">Q</span><span class="o">:</span> <span class="mi">16</span><span class="p">,</span> <span class="nx">R</span><span class="o">:</span> <span class="mi">17</span><span class="p">,</span> <span class="nx">S</span><span class="o">:</span> <span class="mi">18</span><span class="p">,</span> <span class="nx">T</span><span class="o">:</span> <span class="mi">19</span><span class="p">,</span> <span class="nx">U</span><span class="o">:</span> <span class="mi">20</span><span class="p">,</span> <span class="nx">V</span><span class="o">:</span> <span class="mi">21</span><span class="p">,</span> <span class="nx">W</span><span class="o">:</span> <span class="mi">22</span><span class="p">,</span> <span class="nx">X</span><span class="o">:</span> <span class="mi">23</span><span class="p">,</span> <span class="nx">Y</span><span class="o">:</span> <span class="mi">24</span><span class="p">,</span> <span class="nx">Z</span><span class="o">:</span> <span class="mi">25</span><span class="p">,</span> <span class="nx">a</span><span class="o">:</span> <span class="mi">26</span><span class="p">,</span> <span class="nx">b</span><span class="o">:</span> <span class="mi">27</span><span class="p">,</span> <span class="nx">c</span><span class="o">:</span> <span class="mi">28</span><span class="p">,</span> <span class="nx">d</span><span class="o">:</span> <span class="mi">29</span><span class="p">,</span> <span class="nx">e</span><span class="o">:</span> <span class="mi">30</span><span class="p">,</span> <span class="nx">f</span><span class="o">:</span> <span class="mi">31</span><span class="p">,</span> <span class="nx">g</span><span class="o">:</span> <span class="mi">32</span><span class="p">,</span> <span class="nx">h</span><span class="o">:</span> <span class="mi">33</span><span class="p">,</span> <span class="nx">i</span><span class="o">:</span> <span class="mi">34</span><span class="p">,</span> <span class="nx">j</span><span class="o">:</span> <span class="mi">35</span><span class="p">,</span> <span class="nx">k</span><span class="o">:</span> <span class="mi">36</span><span class="p">,</span> <span class="nx">l</span><span class="o">:</span> <span class="mi">37</span><span class="p">,</span> <span class="nx">m</span><span class="o">:</span> <span class="mi">38</span><span class="p">,</span> <span class="nx">n</span><span class="o">:</span> <span class="mi">39</span><span class="p">,</span> <span class="nx">o</span><span class="o">:</span> <span class="mi">40</span><span class="p">,</span> <span class="nx">p</span><span class="o">:</span> <span class="mi">41</span><span class="p">,</span> <span class="nx">q</span><span class="o">:</span> <span class="mi">42</span><span class="p">,</span> <span class="nx">r</span><span class="o">:</span> <span class="mi">43</span><span class="p">,</span> <span class="nx">s</span><span class="o">:</span> <span class="mi">44</span><span class="p">,</span> <span class="nx">t</span><span class="o">:</span> <span class="mi">45</span><span class="p">,</span> <span class="nx">u</span><span class="o">:</span> <span class="mi">46</span><span class="p">,</span> <span class="nx">v</span><span class="o">:</span> <span class="mi">47</span><span class="p">,</span> <span class="nx">w</span><span class="o">:</span> <span class="mi">48</span><span class="p">,</span> <span class="nx">x</span><span class="o">:</span> <span class="mi">49</span><span class="p">,</span> <span class="nx">y</span><span class="o">:</span> <span class="mi">50</span><span class="p">,</span> <span class="nx">z</span><span class="o">:</span> <span class="mi">51</span><span class="p">,</span> <span class="s1">&#39;+&#39;</span><span class="o">:</span> <span class="mi">62</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="o">:</span> <span class="mi">63</span> <span class="p">};</span>
</code></pre></div><p><b>编码实现</b></p><div class="highlight"><pre><code class="language-js"><span class="k">const</span> <span class="nx">Base64Encode</span> <span class="o">=</span> <span class="p">(</span><span class="nx">source</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="k">const</span> <span class="nx">aim</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">source</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">+=</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// 获取第一个字符
</span><span class="c1"></span>        <span class="kd">let</span> <span class="nx">cr</span> <span class="o">=</span> <span class="nx">source</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">charCodeAt</span><span class="p">();</span>
        <span class="nx">aim</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">base64EncodeDict</span><span class="p">[</span><span class="nx">cr</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]);</span>
        <span class="c1">// 获取第二个字符
</span><span class="c1"></span>        <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&gt;=</span> <span class="nx">source</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">aim</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">base64EncodeDict</span><span class="p">[((</span><span class="nx">cr</span> <span class="o">&amp;</span> <span class="mi">3</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">)])</span>
            <span class="nx">aim</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="s1">&#39;=&#39;</span><span class="p">);</span>
            <span class="k">break</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">aim</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">base64EncodeDict</span><span class="p">[((</span><span class="nx">cr</span> <span class="o">&amp;</span> <span class="mi">3</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="nx">source</span><span class="p">[</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">].</span><span class="nx">charCodeAt</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span><span class="p">)]);</span>
        <span class="p">}</span>
        <span class="c1">// 获取第三个字符
</span><span class="c1"></span>        <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&gt;=</span> <span class="nx">source</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">aim</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">base64EncodeDict</span><span class="p">[((</span><span class="nx">source</span><span class="p">[</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">].</span><span class="nx">charCodeAt</span><span class="p">()</span> <span class="o">&amp;</span> <span class="mi">15</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span><span class="p">)])</span>
            <span class="nx">aim</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">aim</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">base64EncodeDict</span><span class="p">[((</span><span class="nx">source</span><span class="p">[</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">].</span><span class="nx">charCodeAt</span><span class="p">()</span> <span class="o">&amp;</span> <span class="mi">15</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="nx">source</span><span class="p">[</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">].</span><span class="nx">charCodeAt</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="mi">6</span><span class="p">)])</span>
            <span class="nx">aim</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">base64EncodeDict</span><span class="p">[</span><span class="nx">source</span><span class="p">[</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">].</span><span class="nx">charCodeAt</span><span class="p">()</span> <span class="o">&amp;</span> <span class="mi">63</span><span class="p">]);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">aim</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div><p>解码同理，我们需要将 4 个字节同时处理,也是用&#34;与&#34;,&#34;左移&#34;,&#34;右移&#34;来实现</p><p><b>解码实现</b></p><div class="highlight"><pre><code class="language-js"><span class="k">const</span> <span class="nx">Base64Decode</span> <span class="o">=</span> <span class="p">(</span><span class="nx">source</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="k">const</span> <span class="nx">aim</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">source</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">+=</span> <span class="mi">4</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">aim</span><span class="p">.</span><span class="nx">push</span><span class="p">((</span><span class="nx">baseDecodeDict</span><span class="p">[</span><span class="nx">source</span><span class="p">[</span><span class="nx">i</span><span class="p">]]</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="nx">baseDecodeDict</span><span class="p">[</span><span class="nx">source</span><span class="p">[</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]]</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span><span class="p">))</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">source</span><span class="p">[</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">===</span> <span class="s1">&#39;=&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">break</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">aim</span><span class="p">.</span><span class="nx">push</span><span class="p">(((</span><span class="nx">baseDecodeDict</span><span class="p">[</span><span class="nx">source</span><span class="p">[</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]]</span> <span class="o">&amp;</span> <span class="mi">15</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="nx">baseDecodeDict</span><span class="p">[</span><span class="nx">source</span><span class="p">[</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]]</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">))</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">source</span><span class="p">[</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">===</span> <span class="s1">&#39;=&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">aim</span><span class="p">.</span><span class="nx">push</span><span class="p">((</span><span class="nx">baseDecodeDict</span><span class="p">[</span><span class="nx">source</span><span class="p">[</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]]</span> <span class="o">&amp;</span> <span class="mi">3</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">6</span><span class="p">)</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">aim</span><span class="p">.</span><span class="nx">push</span><span class="p">(((</span><span class="nx">baseDecodeDict</span><span class="p">[</span><span class="nx">source</span><span class="p">[</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]]</span> <span class="o">&amp;</span> <span class="mi">3</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="nx">baseDecodeDict</span><span class="p">[</span><span class="nx">source</span><span class="p">[</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]]))</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="nx">r</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">item</span> <span class="k">of</span> <span class="nx">aim</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">r</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nb">String</span><span class="p">.</span><span class="nx">fromCharCode</span><span class="p">(</span><span class="nx">item</span><span class="p">))</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">r</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div><p><b>运行测试：</b></p><figure data-size="small"><noscript><img src="https://pic4.zhimg.com/v2-b3250bf225fa7205b1a8ea4128097d2f_b.jpg" data-caption="" data-size="small" data-rawwidth="617" data-rawheight="287" class="origin_image zh-lightbox-thumb" width="617" data-original="https://pic4.zhimg.com/v2-b3250bf225fa7205b1a8ea4128097d2f_r.jpg"/></noscript><img src="https://pic4.zhimg.com/v2-b3250bf225fa7205b1a8ea4128097d2f_b.jpg" data-caption="" data-size="small" data-rawwidth="617" data-rawheight="287" class="origin_image zh-lightbox-thumb lazy" width="617" data-original="https://pic4.zhimg.com/v2-b3250bf225fa7205b1a8ea4128097d2f_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-b3250bf225fa7205b1a8ea4128097d2f_b.jpg"/></figure><p><b>DIY 加密解密</b></p><p>上面提到的 base64 编码表，在整个编码解码过程中，我们可以看出来，编码表起着重要的作用，我们可以通过修改编码表，可以生成变异的 Base64 编码（相当于自己独一无二的加密方式）。</p><p>比如：CTF中流行的佛曰、百家姓等。。。</p><p><b>多字节的 base64 编码</b></p><p>可能都看到了，这样的 base64 编码解码只能为单字节字符，一些双字节字符，比如中文、emoji 表情等，是如何进行 base64 编码解码的呢？</p><p>普遍的解决办法是将多字节字符进行 utf-8 编码为字符串，再进行 base64 编码，解码就与其相反。</p><h2>base64的常见使用✨</h2><p>再次认识一下，base64 编码的定义：被设计用来把任意序列的 8 位字节描述为一种不易被人直接识别的形式。</p><p><b>为什么要使用 base64 编码？</b></p><ol><li>隐藏加密，其文本形式不易被人读取</li><li>加密算法复杂程度和效率</li><li>处理数据传输过程</li></ol><p><b>base64 使用案例</b></p><p><b>一：xml 中的数据处理</b></p><p>一个 xml 当中包含另一个 xml 的数据，此时如果将 xml 数据直接写入显然不合适，将 xml 进行适当进行编码存入较为方便，xml 当中的字符一般都是可见字符，但是由于存在中文字符，可能存在不可见字符，直接将字符打印在外层 xml 的数据中显然不合理，那么怎么办呢？</p><p>所以，基于这样的需求，我们可以使用base64进行编码，然后存入xml，解码反之</p><p>还有个办法，将 byte 的值写在 xml 当中，空格或者逗号分开，这样也可以将 byte 数据传入，不过这样更浪费空间，且不易保存。</p><p><b>二：图片进行 base64 编码</b></p><p>图片的 base64 编码，就是将一副图片数据编码成一串字符串，使用该字符串代替图像地址。</p><p><b>这样做有什么意义呢？</b></p><p>要知道，我们所看到的网页上的每一个图片，都是需要消耗一个 http 请求下载而来的。没错，不管如何，图片的下载始终都要向服务器发出请求，要是图片的下载不用向服务器发出请求，而可以随着 HTML 的下载同时下载到本地那就太好了，而 base64 正好能解决这个问题。</p><p><b>那么图片的 base64 编码长什么样子呢？</b></p><p>举个栗子，知乎的登录页中扫码登录的入口图使用的就是base64编码。我们可以看到： </p><figure data-size="small"><noscript><img src="https://pic2.zhimg.com/v2-e45fabb20a78576cdc9d65a2d6ef6b5d_b.jpg" data-caption="" data-size="small" data-rawwidth="1596" data-rawheight="979" class="origin_image zh-lightbox-thumb" width="1596" data-original="https://pic2.zhimg.com/v2-e45fabb20a78576cdc9d65a2d6ef6b5d_r.jpg"/></noscript><img src="https://pic2.zhimg.com/v2-e45fabb20a78576cdc9d65a2d6ef6b5d_b.jpg" data-caption="" data-size="small" data-rawwidth="1596" data-rawheight="979" class="origin_image zh-lightbox-thumb lazy" width="1596" data-original="https://pic2.zhimg.com/v2-e45fabb20a78576cdc9d65a2d6ef6b5d_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-e45fabb20a78576cdc9d65a2d6ef6b5d_b.jpg"/></figure><p>在 css 和 html 中有所区别：</p><div class="highlight"><pre><code class="language-text">//在css里的写法
xxx {
  background: url(data:image/gif;base64,xxx...xxx==) no-repeat center;
}
//在html代码img标签里的写法
&lt;img src=&#34;data:image/gif;base64,xxx...xxx==&#34;&gt;</code></pre></div><p><b>那么为什么要使用 base64 传输图片文件？</b></p><p>前面也说到了，因为这样可以节省一个 http 请求。图片的 base64 编码可以算是前端优化的一环。效益虽小，但却缺能积少成多。</p><p><b>三：一些接口中的参数使用 base64 编码</b></p><p>从长度上来说，这样做视乎并不能减少数据长度而达到缩小数据包提高传输速率的目的，那为什么那些参数需要使用 base64 编码呢？</p><ul><li>编码，进行简单的算法（几乎不影响效率）</li><li>算法可逆，可编码可解码，不影响通信</li><li>编码后，肉眼无法读取其原始内容</li><li>加密后的字符串只有[0-9a-zA-Z+/=]，不可打印字符(包括转移字符)也可传输</li></ul><blockquote>简单来说，base64 可以消除数据传输上的一切“妖魔鬼怪”，达到“天下大同”的目的。</blockquote><p>又比如有些文本协议不支持不可见字符的传递，只能用大于32的可见字符来传递信息（协议规定），所以还是会用上 base64 编码。</p><p>有关 <b>base64</b> 的内容就简单介绍到这里。更多有关 CTF 的内容请前往 <a href="https://link.zhihu.com/?target=https%3A//twosecurity.cn/%3Fquery_ref%3DqGLdXm" class=" wrap external" target="_blank" rel="nofollow noreferrer">二向箔安全</a> 进行学习，最近推出了一系列免费的网络安全技能包，有关CTF、渗透测试、网络攻防、黑客技巧尽在其中，学它涨姿势💯。</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-bacc5586a9947727c6c17bbaff0c6df1_b.jpg" data-caption="" data-size="normal" data-rawwidth="720" data-rawheight="403" class="origin_image zh-lightbox-thumb" width="720" data-original="https://pic2.zhimg.com/v2-bacc5586a9947727c6c17bbaff0c6df1_r.jpg"/></noscript><img src="https://pic2.zhimg.com/v2-bacc5586a9947727c6c17bbaff0c6df1_b.jpg" data-caption="" data-size="normal" data-rawwidth="720" data-rawheight="403" class="origin_image zh-lightbox-thumb lazy" width="720" data-original="https://pic2.zhimg.com/v2-bacc5586a9947727c6c17bbaff0c6df1_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-bacc5586a9947727c6c17bbaff0c6df1_b.jpg"/></figure><p></p>