<p></p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-eca987e734abb9dfc541c5eabfa65e14_b.gif" data-caption="" data-size="normal" data-rawwidth="900" data-rawheight="200" data-thumbnail="https://pic1.zhimg.com/v2-eca987e734abb9dfc541c5eabfa65e14_b.jpg" class="origin_image zh-lightbox-thumb" width="900" data-original="https://pic1.zhimg.com/v2-eca987e734abb9dfc541c5eabfa65e14_r.jpg"/></noscript><img src="https://pic1.zhimg.com/v2-eca987e734abb9dfc541c5eabfa65e14_b.gif" data-caption="" data-size="normal" data-rawwidth="900" data-rawheight="200" data-thumbnail="https://pic1.zhimg.com/v2-eca987e734abb9dfc541c5eabfa65e14_b.jpg" class="origin_image zh-lightbox-thumb lazy" width="900" data-original="https://pic1.zhimg.com/v2-eca987e734abb9dfc541c5eabfa65e14_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-eca987e734abb9dfc541c5eabfa65e14_b.gif"/></figure><p class="ztext-empty-paragraph"><br/></p><p><b>未经授权，严禁转载</b></p><p class="ztext-empty-paragraph"><br/></p><h2><b>前言</b></h2><p>本文沿用 Qian 的最优化体系获取因子权重，与之不同的是，我们将优化目标由最大化复合因子 IC_IR 变为最大化复合因子单期 IC。通过多个例子的实证研究发现，最大化单期IC能有效解决“等权”的配置偏差问题，在绝大部分因子空间，最优 IC 加权所构建的组合，其表现均优于按照“等权”方式所构建的组合。 </p><h2><b>研究目的</b></h2><p>本文参考广发证券研报《从最大化复合因子单期 IC 角度看因子权重》，根据研报分析，现阶段应用较多的因子加权方法主要有以下几种: 等权加权、 IC 加权和 IC_IR 加权、以及最优化 IC_IR 加权。其中，等权加权是因子加权最传统的方法，这种方法受因子之间有效性差异、线性相关性影响明显。而 IC 加权、 IC_IR 加权对等权方式忽视了因子有效性差异的问题进行了改进，在大部分情况下会优于等权加权形式。最大化复合因子 IC_IR 加权已运用较广。</p><h2><b>研究内容</b></h2><p>（1）传统因子加权方式的局限性: 选择 ZZ800 为股票池，以市值因子和营业利润同比增长率为例，分析等权加权与 IC 加权的差异，根据回测结果分析两种因子加权方式的效用；<br/></p><p>（2）设计最大化复合因子单期 IC 的理论最优比例: 本文沿用 Qian 的最优化体系获取因子权重，与之不同的是，我们将优化目标由最大化复合因子 IC_IR 变为最大化复合因子单期 IC。理论解析解的形式表明，最大化复合因子单期 IC 的权重与两方面因素有关: 一是因子的有效性，即因子 IC; 二是因子之间的相关系数。</p><p>（3）最大化复合因子单期 IC 的应用: 本文通过例子实证研究发现，最大化单期 IC 能有效解决“等权”的配置偏差问题，在绝大部分因子空间，最优 IC 加权 所构建的组合，其表现均优于按照“等权”方式所构建的组合。</p><h2><b>研究结论</b></h2><p>（1）通过对市值因子与营业利润同比增长率为例进行分析，IC 加权对等权方式忽视了因子有效性差异的问题进行了改进，在大部分情况下会优于等权加权形式。</p><p>（2）本文沿用 Qian 的最优化体系获取因子权重，与之不同的是，我们将优化目标由最大化复合因子 IR 变为最大化复合因子单期 IC，并根据该方法进行因子权重的计算。理论解析解的形式表明，最大化复合因子单期 IC 的权重与两方面因素有关: 一是因子的有效性，即因子 IC; 二是因子之间的相关系数。</p><p>（3）通过以下 7 个因子: 市盈率(PB)、市净率(PE)、市销率(PS)、营业利润同比增长率、资产负债率、反转(前 1 月累计收益)、换手率(前 10 个交易日日均换手率)，进行不同因子加权方法的测试。文章实证结果也表明，最大化单期 IC 能有效解决“等权”的配置偏差问题，在绝大部分情况，最优 IC 加权所构建的组合，其表现均优于“等权”方式 所构建的组合，最大化单期 IC 能够获得最佳的结果。</p><h2><b>&gt;&gt;&gt; 因子等权加权</b></h2><h2><b>1.1 日期列表获取</b></h2><p>在每个月的月末对因子数据进行提取，因此需要对每个月的月末日期进行统计。</p><p><br/>输入参数分别为 peroid、start_date 和 end_date，其中 peroid 进行周期选择，可选周期为周(W)、月(M)和季(Q)，start_date和end_date 分别为开始日期和结束日期。</p><p><br/>函数返回值为对应的月末日期，如选取开始日期为 2017.1.1，结束日期为 2018.1.1。</p><h2><b>1.2 股票列表获取</b></h2><p>股票池: ZZ800<br/>股票筛选: 剔除 ST 股票，剔除上市 3 个月内的股票，每只股票视作一个样本<br/>以 ZZ800 为例，取 2016-08-31 当天的股票成分股</p><h2><b>1.3 数据获取</b></h2><p>本章旨在分析因子等权加权回测效果，股票选为 ZZ800，回测时间为 2013.1.1 至 2018.1.1，因子选定为市值和营业利润同比增长率，在每个月最后一个自然日，获取当前最新的因子数据以及对应的股票超额收益。</p><h2><b>1.4 数据分析</b></h2><p>考虑一个包含市值、营业利润同比增长率的两因子模型，本章分别基于两种加权方式计算复合因子值，然后选择复合因子值最高的 100 只股票构建组合。其中，组合 1 为等权组合，即市值和营业利润同比增长率按照等权的方式加总为复合因子; 组合 2 为 60/40 组合，即市值和营业利润同比增长率因子的加权比例分别为 60%、40%。</p><p><br/>股票池: ZZ800，剔除 ST 股票以及上市 3 个月内的股票<br/>对比基准: ZZ800<br/>交易费用: 千分之 1.5<br/>调仓周期: 月</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-b146890c9d1084e14425d467328e015d_b.jpg" data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="445" class="origin_image zh-lightbox-thumb" width="1080" data-original="https://pic2.zhimg.com/v2-b146890c9d1084e14425d467328e015d_r.jpg"/></noscript><img src="https://pic2.zhimg.com/v2-b146890c9d1084e14425d467328e015d_b.jpg" data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="445" class="origin_image zh-lightbox-thumb lazy" width="1080" data-original="https://pic2.zhimg.com/v2-b146890c9d1084e14425d467328e015d_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-b146890c9d1084e14425d467328e015d_b.jpg"/></figure><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-9dd814bb31ab30e4c1573316725a87ae_b.jpg" data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="450" class="origin_image zh-lightbox-thumb" width="1080" data-original="https://pic3.zhimg.com/v2-9dd814bb31ab30e4c1573316725a87ae_r.jpg"/></noscript><img src="https://pic3.zhimg.com/v2-9dd814bb31ab30e4c1573316725a87ae_b.jpg" data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="450" class="origin_image zh-lightbox-thumb lazy" width="1080" data-original="https://pic3.zhimg.com/v2-9dd814bb31ab30e4c1573316725a87ae_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-9dd814bb31ab30e4c1573316725a87ae_b.jpg"/></figure><p class="ztext-empty-paragraph"><br/></p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-04a6f1a0686c13cf2bb84050b6344a8f_b.jpg" data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="445" class="origin_image zh-lightbox-thumb" width="1080" data-original="https://pic4.zhimg.com/v2-04a6f1a0686c13cf2bb84050b6344a8f_r.jpg"/></noscript><img src="https://pic4.zhimg.com/v2-04a6f1a0686c13cf2bb84050b6344a8f_b.jpg" data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="445" class="origin_image zh-lightbox-thumb lazy" width="1080" data-original="https://pic4.zhimg.com/v2-04a6f1a0686c13cf2bb84050b6344a8f_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-04a6f1a0686c13cf2bb84050b6344a8f_b.jpg"/></figure><p class="ztext-empty-paragraph"><br/></p><p>第一张图统计了两因子等权组合及 60/40 组合的净值曲线图，上表统计了两个组合的超额收益指标对比。从中可看出，提高了市值权重的60/40 组合，收益率高于等权组合，同时风险（最大回撤、年化波动率）也高于等权组合。此外，从月度角度来看，等权因子组合和 60/40 组合的稳定性都非常高。</p><h2><b>&gt;&gt;&gt; 因子IC加权</b></h2><h2><b>2.1 因子 IC 分析</b></h2><p>对比市值和营业利润同比增长率的 IC 序列统计特征可发现，市值因子的IC均值（0.09）明显优于营业利润同比增长率（0.028），同时前者IC 序列的波动性也高于后者。从 IR 来看，市值因子效果更好，这种效果相差明显的情况下，简单的等权加权并不能体现市值因子的强有效选股效应，从而拖累了多因子组合的表现。</p><h2><b>2.2 因子 IC 等权组合分析</b></h2><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-288fdd83f08021912f63c5929b2e2963_b.jpg" data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="450" class="origin_image zh-lightbox-thumb" width="1080" data-original="https://pic4.zhimg.com/v2-288fdd83f08021912f63c5929b2e2963_r.jpg"/></noscript><img src="https://pic4.zhimg.com/v2-288fdd83f08021912f63c5929b2e2963_b.jpg" data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="450" class="origin_image zh-lightbox-thumb lazy" width="1080" data-original="https://pic4.zhimg.com/v2-288fdd83f08021912f63c5929b2e2963_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-288fdd83f08021912f63c5929b2e2963_b.jpg"/></figure><p class="ztext-empty-paragraph"><br/></p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-dab6eb907acb1cb9b3493e37e090b3bb_b.jpg" data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="445" class="origin_image zh-lightbox-thumb" width="1080" data-original="https://pic4.zhimg.com/v2-dab6eb907acb1cb9b3493e37e090b3bb_r.jpg"/></noscript><img src="https://pic4.zhimg.com/v2-dab6eb907acb1cb9b3493e37e090b3bb_b.jpg" data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="445" class="origin_image zh-lightbox-thumb lazy" width="1080" data-original="https://pic4.zhimg.com/v2-dab6eb907acb1cb9b3493e37e090b3bb_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-dab6eb907acb1cb9b3493e37e090b3bb_b.jpg"/></figure><p>第一张图统计了两因子等权组合、60/40 组合以及 IC 加权因子组合的净值曲线图，上表统计了这三个组合的超额收益指标对比。从中可看出， 出IC 加权组合的收益率明显高于等权组合以及60/40 组合，同时风险（最大回撤、年化波动率）也高于等权组合以及 60/40 组合。但是从夏普比率来看，因子 IC 加权组合的收益风险比高于其余两个组合。从月度收益来看，因子 IC 加权组合的月胜率为 85%，可见模型收益稳定性得到进一步提高。</p><p>进一步分析发现，在市值、营业利润同比增长率的例子中，两因子按照 IC 加权的权重分别为 76.90% 和 23.10%；市值因子的权重高于等权形式，也高于主观的 60/40 组合。也就是说，因子 IC 加权组合增加了收益高、波动大的“市值因子”权重，减少了收益低、波动小的“营业利润同比增长率”权重，从而使得 IC 加权组合的整体收益、波动均高于等权组合。</p><h2><b>&gt;&gt;&gt; 最大化复合因子单期IC</b></h2><h2><b>3.1 理论最优比例的计算</b></h2><p>由前面的分析可知，在对因子加权时，需考虑因子本身的有效性（IC），但因子 IC 加权并非在所有情况下都优于等权组合。那么，从理论上看若以最大化复合因子单期 IC 为目标，最优加权比例与哪些因素相关呢？</p><p><br/>假设有 M 个因子，分别为 F1、F2、…、Fm，它们基于权重序列W=（w1,…，wm）加总为复合因子Fc,即</p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-433a7290e581923d48b3334fe43125bb_b.jpg" data-caption="" data-size="normal" data-rawwidth="284" data-rawheight="56" class="content_image" width="284"/></noscript><img src="https://pic4.zhimg.com/v2-433a7290e581923d48b3334fe43125bb_b.jpg" data-caption="" data-size="normal" data-rawwidth="284" data-rawheight="56" class="content_image lazy" width="284" data-actualsrc="https://pic4.zhimg.com/v2-433a7290e581923d48b3334fe43125bb_b.jpg"/></figure><p>按照前面的说明，我们最优化的目标函数为：</p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-83acc9010925646c273063779812cebf_b.jpg" data-caption="" data-size="normal" data-rawwidth="324" data-rawheight="51" class="content_image" width="324"/></noscript><img src="https://pic4.zhimg.com/v2-83acc9010925646c273063779812cebf_b.jpg" data-caption="" data-size="normal" data-rawwidth="324" data-rawheight="51" class="content_image lazy" width="324" data-actualsrc="https://pic4.zhimg.com/v2-83acc9010925646c273063779812cebf_b.jpg"/></figure><p>假设两因子横截面协方差为：</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-0fb71bd0436660788aa1910244924cfd_b.jpg" data-caption="" data-size="normal" data-rawwidth="161" data-rawheight="27" class="content_image" width="161"/></noscript><img src="https://pic2.zhimg.com/v2-0fb71bd0436660788aa1910244924cfd_b.jpg" data-caption="" data-size="normal" data-rawwidth="161" data-rawheight="27" class="content_image lazy" width="161" data-actualsrc="https://pic2.zhimg.com/v2-0fb71bd0436660788aa1910244924cfd_b.jpg"/></figure><p>相应的协方差矩阵为</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-4c8726ddd663c549fc00fef4d7f3a78d_b.jpg" data-caption="" data-size="normal" data-rawwidth="122" data-rawheight="38" class="content_image" width="122"/></noscript><img src="https://pic2.zhimg.com/v2-4c8726ddd663c549fc00fef4d7f3a78d_b.jpg" data-caption="" data-size="normal" data-rawwidth="122" data-rawheight="38" class="content_image lazy" width="122" data-actualsrc="https://pic2.zhimg.com/v2-4c8726ddd663c549fc00fef4d7f3a78d_b.jpg"/></figure><p>同时对每一期的因子值进行标准化处理，使得因子标准差变为1，则上面的复合因子IC可简化为如下形式：</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-1f2f6ddc5e54766dd648c0962194060c_b.jpg" data-caption="" data-size="normal" data-rawwidth="293" data-rawheight="89" class="content_image" width="293"/></noscript><img src="https://pic1.zhimg.com/v2-1f2f6ddc5e54766dd648c0962194060c_b.jpg" data-caption="" data-size="normal" data-rawwidth="293" data-rawheight="89" class="content_image lazy" width="293" data-actualsrc="https://pic1.zhimg.com/v2-1f2f6ddc5e54766dd648c0962194060c_b.jpg"/></figure><p>从上面的解析式可看出，最大化复合因子单期IC 的理论最优权重与两方面的因素有关：因子之间的协方差，以及因子IC。为说明相关系数（协方差）与最优权重的关系，我们以两因子模型的例子进行说明。在一个只包含两个因子的模型中，上述等式可以简化如下形式：</p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-87a4b5d6a9bb138cca8497a6cc127823_b.jpg" data-caption="" data-size="normal" data-rawwidth="279" data-rawheight="103" class="content_image" width="279"/></noscript><img src="https://pic4.zhimg.com/v2-87a4b5d6a9bb138cca8497a6cc127823_b.jpg" data-caption="" data-size="normal" data-rawwidth="279" data-rawheight="103" class="content_image lazy" width="279" data-actualsrc="https://pic4.zhimg.com/v2-87a4b5d6a9bb138cca8497a6cc127823_b.jpg"/></figure><p>从上面的简化形式可以看出，若两因子为正相关关系，则相比于 IC 加权，最优 IC 加权方式会增加有效性更高（即 IC 更大）的因子权重；若两因子为负相关关系，则最优 IC 加权会增加有效性相对较低的因子权重，以稳定组合的收益。</p><p class="ztext-empty-paragraph"><br/></p><p><b>3.2 组合测试</b><br/></p><p>接下来，利用前一部分推导的最优 IC 加权方式，针对 7 个因子构建多因子模型: 市盈率(PB)、市净率(PE)、市销率(PS)、营业利润同比增长率、资产负债率、反转(前 1 月累计收益)、换手率(前 10 个交易日日均换手率)。每个月最后一个自然日，获取这 7 个因子数据以及下个月相对 ZZ800 的超额收益。为综合比较前文所提及的三种加权方式，在此部分的应用中我们仍然构建 3 个组合进行对比，分别是因子等权组合、因子 IC 加权以及最优 IC 加权组合。</p><p><br/>股票池: ZZ800，剔除 ST 股票以及上市 3 个月内的股票<br/>对比基准: ZZ800<br/>交易费用: 千分之 1.5<br/>调仓周期: 月</p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-63bc7c6a878ca41d5cac48679f5d04fa_b.jpg" data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="447" class="origin_image zh-lightbox-thumb" width="1080" data-original="https://pic3.zhimg.com/v2-63bc7c6a878ca41d5cac48679f5d04fa_r.jpg"/></noscript><img src="https://pic3.zhimg.com/v2-63bc7c6a878ca41d5cac48679f5d04fa_b.jpg" data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="447" class="origin_image zh-lightbox-thumb lazy" width="1080" data-original="https://pic3.zhimg.com/v2-63bc7c6a878ca41d5cac48679f5d04fa_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-63bc7c6a878ca41d5cac48679f5d04fa_b.jpg"/></figure><p>在上述 7 个因子的例子中，回测时间在 2013 - 2018，等权组合的年化超额收益为 19.87%，但夏普比率较低，为1.00。因子 IC 加权组合的收益表现略优于等权组合，年化收益增加至 22.27%，夏普比率也比其更高，为 1.09。三个组合中表现最好的是最优 IC 加权组合，其年化超额达 23.61%，夏普比率在三种也是最高，为 1.17。</p><h2><b>总结</b></h2><p>目前而言，应用较多的因子加权方法主要有以下几种: 等权加权、IC 加权和 IC_IR 加权、以及最优化 IC_IR 加权。其中，等权加权是因子加权最传统的方法，这种方法受因子之间有效性差异、线性相关性影响明显。而 IC 加权对等权方式忽视了因子有效性差异的问题进行了改进，在大部分情况下会优于等权加权形式。</p><p><br/>Qian 在《Quantitative Equtiy Portfolio Management》一书中提出以最大化复合因子 IC_IR 获得因子权重，综合考虑了因子的 IC 大小以及 IC 时间序列的稳定性，目前已有许多文章对此种加权方式进行了测试。</p><p><br/>本文沿用 Qian 的最优化体系获取因子权重，与之不同的是，我们将优化目标由最大化复合因子 IR 变为最大化复合因子单期 IC。理论解析解的形式表明，最大化复合因子单期 IC 的权重与两方面因素有关: 一是因子的有效性，即因子 IC;二是因子之间的相关系数。同时，文章实证结果也表明，最大化单期 IC 能有效解决“等权”的配置偏差问题，在绝大部分因子空间，最优 IC 加权所构建的组合，其表现均优于“等权”方式 所构建的组合。</p><p>点击<a href="https://link.zhihu.com/?target=https%3A//www.joinquant.com/view/community/detail/21064" class=" wrap external" target="_blank" rel="nofollow noreferrer">【阅读原文】</a>，查看研究原码~</p><p></p>