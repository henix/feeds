<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:media="http://search.yahoo.com/mrss/">
<channel>
<title>川流不息</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/</link>
<description>分享量化投资技术与实证心得 北京量信投资管理有限公司是一家在中国基金业协会备案登记的专业私募基金管理人。本专栏作者石川是公司联合创始人。希望通过这个平台和各位小伙伴分享我们在量化投资领域的知识和心得。原创不易，请保护版权，请在获得授权后转载。已委托“维权骑士”(http://rightknights.com) 为进行维权行动。</description>
<language>zh-cn</language>
<lastBuildDate>Wed, 18 Dec 2019 07:50:46 +0800</lastBuildDate>
<item>
<title>因子样本外表现为什么变差？</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2019-12-17-96990210.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/96990210&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-506754755985b7fe2c33deb05a917583_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;摘要&lt;/b&gt;&lt;/p&gt;&lt;p&gt;曝光导致错误定价减弱、因子拥挤和交易成本是因子样本外变差的三大原因。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;00 引言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;因子样本外的表现较样本内变差是人们的共识。这里的因子包括异象（anomalies）和传统意义上的风格 beta 因子，在下文不做区分，统称为因子。造成因子样本内、外表现差异的最主要原因自然是样本内的 data snooping（即因子本来就是假的），但如果因子确实是真实的，那么它们在样本外变差的原因是什么呢？学术界和业界的主要观点包括以下三种：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;b&gt;曝光导致错误定价减弱&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;因子拥挤&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;交易成本&lt;/b&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;在 2019 年 9 月刚刚结束的 Wharton 商学院 Jacobs Levy Center 年会中，一共深入讨论了四篇论文，其中两篇就和因子样本外表现有关，它们分别是 Bowles et al. (2019) 以及 Chen and Velikov (2019)，足见这个话题的重要性。具体来说，Bowles et al. (2019) 以 Anomaly Time 为题从“曝光导致错误定价减弱”的角度谈论了因子的表现；而 Chen and Velikov (2019) 则从“交易成本”的角度指出，在考虑了非常合理的费用之后，绝大多数因子在样本外根本无法赚钱。&lt;/p&gt;&lt;p&gt;本文就来简要探讨一下因子样本外表现变差的三个原因。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;01 曝光导致错误定价减弱&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;因子代表着市场某方面的非有效性、代表了某种 mispricing（错误定价）。&lt;/b&gt;只要套利限制不是过大，那么聪明的投资者一定会先人一步去交易这个因子，导致错误定价收窄，这就解释了为什么&lt;b&gt;当因子被发表后，它的收益往往也跟着显著下降。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;在这方面，McLean and Pontiff (2016)  的研究颇具代表性。该文研究了 97 个因子，发现因子样本外的表现比样本内的表现下降了 26%、而发表后（post-publication）的表现较样本内则下降了 58%。McLean and Pontiff (2016)  考虑样本内外差异是为了控制过拟合的影响。上述结果表明，58% 与 26% 之差 —— 即 32% —— 就是发表本身造成因子效果的减弱。McLean and Pontiff (2016)  把它称作 publication-informed trading。这背后的逻辑链是：因子被发表导致它被公布于众 --&amp;gt; 越来越多的人交易该因子从而减弱了错误定价 --&amp;gt; 最终导致因子收益率降低。&lt;/p&gt;&lt;p&gt;如果说 McLean and Pontiff (2016)  检验了因子的平均收益，Bowles et al. (2019) 则是从时效性的角度展示了因子背后的信息越来越快的被 priced in。长久以来，由于 Fama and French (1993) 的影响太过深远，学术界在研究因子的时候为了避免未来数据，通常采用每年再平衡的方法（量价相关的指标通常是月频再平衡），导致构建因子的指标数据严重滞后。这其中最著名的例子要数 Eugene Fama 的弟子 Cliff Asness 使用月频价格对 HML 的改造（&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzUxNzY0NjU3Mw%3D%3D%26mid%3D2247483911%26idx%3D1%26sn%3D29be96059644fdf80dc9db87a69b9fa5%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Asness and Frazzini 2013&lt;/a&gt;）。使用了月频价格数据后的 HML 较 Fama and French (1993) 三因子的 HML 表现更好，说明了数据时效性的重要性。&lt;/p&gt;&lt;p&gt;再来看个更显著的例子。下图显示了 Reliant Energy Inc. 这家公司 2007 和 2008 两年 10-K filing 的时间，以及按学术界传统每年 6 月底再平衡时该公司的股价变化。在 2007 年 10-K filing 到 6 月底这 85 天内，因最新的财报数据，该公司股价上涨 59.09%。如果按照两个 10-K filing 之间来调仓选入该股票，那么在两个披露期之间可以获利 44.63%；而在传统研究框架下，如果在两个 6 月底调仓，选入该股票却亏损 21.08%。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-a5ef0242551f31c74192fecb9c996fc8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;555&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-a5ef0242551f31c74192fecb9c996fc8_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-a5ef0242551f31c74192fecb9c996fc8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;555&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-a5ef0242551f31c74192fecb9c996fc8_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-a5ef0242551f31c74192fecb9c996fc8_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;对于使用财务指标构造的因子，学术界之所以使用每年再平衡是因为学术界的重心毕竟是 empirical asset pricing。&lt;b&gt;为了研究成果的可复制性和可比性&lt;/b&gt;，大家用的都是同样的数据库、采用同样的再平衡周期，因此也就没有想过要用粒度更细的数据。&lt;/p&gt;&lt;p&gt;Bowles et al. (2019) 一文则另辟蹊径，使用 &lt;b&gt;Compustat Snapshot 数据库&lt;/b&gt;对因子时效进行了分析。用 Bowles et al. (2019) 自己的话说，Snapshot 在学术界用的很少，但它却是有着粒度最细的数据 —— 细到记录财报中&lt;b&gt;每个单一变量&lt;/b&gt;更新的时间：&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;For&lt;/i&gt; &lt;i&gt;&lt;b&gt;each&lt;/b&gt;&lt;/i&gt; &lt;i&gt;financial statement&lt;/i&gt; &lt;i&gt;&lt;b&gt;variable&lt;/b&gt;, Snapshot identifies&lt;/i&gt; &lt;i&gt;&lt;b&gt;the first date&lt;/b&gt;&lt;/i&gt; &lt;i&gt;on which each variable was reported.&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;以美股为例，通常上市公司先有 earnings announcement 然后才有 10-Q 和 10-K filing。而在 earnings announcement 上往往只会公布 total revenue 和 net income 等少许指标，而在正式的 filing 中才披露全部财报内容。在这种情况下，Snapshot 数据库会在 earnings announcement 当日更新 total revenue 和 net income 数据，而等到实际 filing 之后再更新其他数据。因此，使用 Snapshot 数据可以保证在用来计算因子的指标被更新后，第一时间更新因子、进行投资组合的再平衡。&lt;/p&gt;&lt;p&gt;利用 Snapshot 数据，Bowles et al. (2019) 研究了一些常见的源自财务数据的因子，发现绝大多数因子在最新数据更新后的 120 天之内（特别是最初的 30 天内）能够获得显著的超额收益。而在 120 天之后，超额收益消失（下图）。不过，Bowles et al. (2019) 也指出，最近几年的实证结果显示，因子的超额收益消失的更快。基于这些发现，Bowles et al. (2019) 认为因子是真实的（而非 data snooping 出来的），但很快就会因套利交易而消失。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-3d261a3427bde6d4c651f1f51cb16c6b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;899&quot; data-rawheight=&quot;627&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;899&quot; data-original=&quot;https://pic4.zhimg.com/v2-3d261a3427bde6d4c651f1f51cb16c6b_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-3d261a3427bde6d4c651f1f51cb16c6b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;899&quot; data-rawheight=&quot;627&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;899&quot; data-original=&quot;https://pic4.zhimg.com/v2-3d261a3427bde6d4c651f1f51cb16c6b_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-3d261a3427bde6d4c651f1f51cb16c6b_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;Bowles et al. (2019) 针对美股的研究和前不久天风证券的一篇《和时间赛跑 —— 利用实时财务信息增强组合收益》针对 A 股的报告异曲同工。该研究显示，利用业绩预告和快报能够提升财务信息的时效性，提高财务因子的表现。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;02 因子拥挤&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;造成因子样本外变差的第二个原因是&lt;b&gt;因子拥挤（factor crowding）&lt;/b&gt;。&lt;/p&gt;&lt;p&gt;通常来说，因子都有周期性。当某类因子好使的时候，就会造成更多的资金引入，从而出现因子拥挤，并降低该因子未来的预期收益率。而 rule-based （使用相似的指标排序、接近的调仓频率）的因子投资无疑加剧了这种负面影响。&lt;/p&gt;&lt;p&gt;由于因子拥挤度和因子未来收益率呈现负相关，如何定量计算因子拥挤度就成为人们关注的问题。在这方面，MSCI 整理了相关研究，提出五个描述因子拥挤度的代理指标（Bayraktar et al. 2015，Bonne et al. 2018）。这五个指标是：valuation spread、short Interest spread、pairwise correlation、factor volatility 以及 factor reversal。考虑到由于制度问题，short interest spread 在 A 股上并不适用，下面对其他四个指标做简要介绍。海通证券的报告《因子失效预警：因子拥挤》针对 A 股对上述四个指标进行了分析。&lt;/p&gt;&lt;p&gt;&lt;b&gt;2.1 Valuation Spread&lt;/b&gt;&lt;/p&gt;&lt;p&gt;顾名思义，valuation spread（估值价差）考虑的正是因子的估值。关于因子估值在 A 股上的实证，感兴趣的小伙伴请参考&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzI3Mjk5OTU1Ng%3D%3D%26mid%3D2247483923%26idx%3D1%26sn%3Ddd5e368d21c71137a7d2fd971af7c970%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;《你家因子便宜吗？&lt;/a&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzI3Mjk5OTU1Ng%3D%3D%26mid%3D2247483923%26idx%3D1%26sn%3Ddd5e368d21c71137a7d2fd971af7c970%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;——基于value spread的因子择时研究》&lt;/a&gt;。这背后的逻辑是，当更多资金涌入某个因子时（特别是多头时），会造成受波及股票的价格上涨，使它们的估值变高。因此，因子估值和因子拥挤度成正相关，是一个不错代理指标。&lt;/p&gt;&lt;p&gt;估值价差的计算方法十分直观。首先选择一个合适的股票估值指标，比如 B/P，然后分别计算因子多空两头组合中该估值指标的中位数，以此作为多空两头的估值，最后这两个估值差就是因子的估值价差。以 B/P 为例，Bonne et al. (2018) 使用的计算公式为：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvaluation+spread%7D%3D%5Cdisplaystyle%5Cln%5Cleft%28%5Cfrac%7B%5Cmbox%7Bmedian+B%2FP+in+long+leg%7D%7D%7B%5Cmbox%7Bmedian+B%2FP+in+short+leg%7D%7D%5Cright%29&quot; alt=&quot;\mbox{valuation spread}=\displaystyle\ln\left(\frac{\mbox{median B/P in long leg}}{\mbox{median B/P in short leg}}\right)&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;&lt;b&gt;2.2 Pairwise Correlation&lt;/b&gt;&lt;/p&gt;&lt;p&gt;第二个指标是 Pairwise Correlation（配对相关性）。它是为了从因子投资组合内股票收益率的相关程度来试图揭示资金持仓的集中程度，并以此来评价因子的拥挤程度。为了计算该指标，Bonne et al. (2018) 采用了如下步骤：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;将因子多（空）头内的股票做市场、市值等中性化处理，得到残差；&lt;/li&gt;&lt;li&gt;使用 63 个交易日的残差计算每个股票和其所在多、空头内平均残差收益率的相关性。以多头为例，使用多头组合中第 i 支股票的残差收益率和剩余股票残差收益率均值计算相关系数。空头处理相同。&lt;/li&gt;&lt;li&gt;计算多、空两头组内所有股票相关系数的均值；&lt;/li&gt;&lt;li&gt;将多、空两头相关系数均值再取平均，得到该因子 Pairwise Correlation 的原始值，最后再将该值进行标准化就得到最终该因子的 Pairwise Correlation。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;b&gt;2.3 Factor Volatility&lt;/b&gt;&lt;/p&gt;&lt;p&gt;由于资金的流入会加剧因子收益率的波动，因此 Bonne et al. (2018) 从这个角度提出了衡量因子拥挤度的第三个指标：Factor Volatility（因子波动率）。值得一提的是，Bonne et al. (2018) 使用的是预测的未来因子波动率相对未来市场波动率的比值来计算该指标。他们认为这么做可以有效的控制市场波动率变化造成的影响。在实际操作中，一个简化的处理方法是使用因子的历史波动率。&lt;/p&gt;&lt;p&gt;&lt;b&gt;2.4 Factor Reversal&lt;/b&gt;&lt;/p&gt;&lt;p&gt;最后一个指标是 Factor Reversal（因子反转）。De Bondt and Thaler (1985) 这篇著名的论文表明美股在 3 到 5 年的中长期尺度上存在反转。由于因子是股票构成的投资组合，因此我们可以自然的从股票的反转延伸出因子的反转。Bonne et al. (2018) 使用因子过去三年的累积收益率计算该指标。&lt;/p&gt;&lt;p&gt;以前文提到的《因子失效预警：因子拥挤》研究结果为例，下图展示了估值价差和因子反转两个因子拥挤度指标和 A 股上一些常见因子未来收益率的关系（之所以没有放另外两个指标的结果是因为报告中的计算方法和 Bonne et al. 2018 的方法差异较大；方法并无优劣之分，但因实证结果并不直接对应前文介绍的方法，故略去）。图中结果显示，对其中大部分因子，这两个指标和因子未来收益率成负相关，说明该因子拥挤会造成因子表现变差。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-55557f4d5c71fa6e8c53a1d4b1d48306_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;364&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-55557f4d5c71fa6e8c53a1d4b1d48306_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-55557f4d5c71fa6e8c53a1d4b1d48306_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;364&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-55557f4d5c71fa6e8c53a1d4b1d48306_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-55557f4d5c71fa6e8c53a1d4b1d48306_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;最后，因子拥挤也会引发流动性冲击。一旦市场中发生冲击因子的事件后，持有相似头寸的管理人会竞相卖出手中的股票，由此产生的流动性危机会造成很大的亏损。2007 年 8 月，美股市场上一些非常优秀的量化对冲基金在短时间内录得了巨大的亏损。Khandani and Lo (2011) 对此进行了研究并发现，很多基金经理在短时间内清理了相似的头寸，巨大的抛压对流动性造成了巨大的打击、使得这些股票的价格在短时间内大幅下跌。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;03 交易成本&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;交易成本是因子在样本外的效果较样本内显著变差的第三个原因。&lt;/p&gt;&lt;p&gt;&lt;b&gt;学术论文通常不会对交易费用给予充分的考虑，这会造成对因子收益率的高估。&lt;/b&gt;此外，由于因子投资组合一般都是多、空对冲的组合，如果不合理考虑做空限制，也会高估因子的收益。Novy-Marx and Velikov (2015) 研究了交易费用对因子效果的影响，并提出三个思路降低交易成本：（1）仅使用交易费用低的股票构建因子组合；（2）降低因子组合再平衡的频率；（3）在交易时考虑更严格的买卖价差约束。&lt;/p&gt;&lt;p&gt;在 Chen and Velikov (2019) 一文中，二位作者使用 &lt;b&gt;effective spread（有效价差）&lt;/b&gt;的概念代替传统的 bid-ask spread，对多达 120 种因子进行了研究。他们的研究发现 …… 哎，先上图吧。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-5d8545bd2c7fb372fb44982e2e191473_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;807&quot; data-rawheight=&quot;428&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;807&quot; data-original=&quot;https://pic4.zhimg.com/v2-5d8545bd2c7fb372fb44982e2e191473_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-5d8545bd2c7fb372fb44982e2e191473_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;807&quot; data-rawheight=&quot;428&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;807&quot; data-original=&quot;https://pic4.zhimg.com/v2-5d8545bd2c7fb372fb44982e2e191473_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-5d8545bd2c7fb372fb44982e2e191473_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;上图中，蓝色的 bar 代表着 120 个因子样本内的平均 gross 收益率（不考虑任何交易成本）；黄色 bar 为这些因子在发表后的平均 gross 收益率；红色 bar 为考虑了交易成本后，这些因子的平均收益率 —— &lt;b&gt;负的&lt;/b&gt;。&lt;/p&gt;&lt;p&gt;来看下具体研究方法。Chen and Velikov (2019) 对 effective spread 的定义为：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Beffective+spread%7D%3D%5Cdisplaystyle+2%5Ctimes%5Cleft%28%5Cln%28%5Cmbox%7Btrade+price%7D%29-%5Cln%28%5Cmbox%7Bquote+midpoint%7D%29%5Cright%29&quot; alt=&quot;\mbox{effective spread}=\displaystyle 2\times\left(\ln(\mbox{trade price})-\ln(\mbox{quote midpoint})\right)&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;为了考虑交易成本，他们假设每次调仓时的交易费用为上述 effective spread 的一半。从上述定义不难看出，因子的费后 net return 和换手率以及换仓时的 effective spread 息息相关：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bnet+return%7D%3D%5Cdisplaystyle+%5Cmbox%7Bgross+return%7D-%5Cmbox%7Bturnover%7D%5Ctimes%5Cmbox%7Beffective+spread%7D&quot; alt=&quot;\mbox{net return}=\displaystyle \mbox{gross return}-\mbox{turnover}\times\mbox{effective spread}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;有必要指出的是，Chen and Velikov (2019) 的研究仅考虑交易费用，并不考虑任何冲击成本。这意味着考虑了冲击成本后，因子样本外的 net return 只能更惨。下表显示了在考虑了成本后，120 个因子在样本内、外的收益情况（括号中为标准差）。结果显示，考虑成本后，即便是样本内，这些因子的月均收益仅有 0.05%，而样本外的收益更是小于零。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-65f3dc33c08959a08315feb8f2824e05_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;865&quot; data-rawheight=&quot;361&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;865&quot; data-original=&quot;https://pic2.zhimg.com/v2-65f3dc33c08959a08315feb8f2824e05_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-65f3dc33c08959a08315feb8f2824e05_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;865&quot; data-rawheight=&quot;361&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;865&quot; data-original=&quot;https://pic2.zhimg.com/v2-65f3dc33c08959a08315feb8f2824e05_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-65f3dc33c08959a08315feb8f2824e05_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;下图展示了样本外，这 120 个因子的 net returns 的分布。这些 net returns 经过了一定的交易优化处理，有效降低了换手率和交易成本，因此整体来看所有因子的 net return 均值是大于零的，而非上表中 -0.03% 那么惨。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-72ba155e7d1058b8443a9f9279aeedf8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;688&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-72ba155e7d1058b8443a9f9279aeedf8_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-72ba155e7d1058b8443a9f9279aeedf8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;688&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-72ba155e7d1058b8443a9f9279aeedf8_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-72ba155e7d1058b8443a9f9279aeedf8_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;这个分布看上去像是一个均值接近零的正态分布，和随机因子的表现并无太大差异（即如果我们使用完全随机生成的 120 个因子，其中也总会有一些是“显著”的）。由于发表的因子都多少存在 selection bias，因此面对上述结果，Chen and Velikov (2019) 不禁发问：排除运气后，还有多少因子是显著的？为了回答上述问题，他们采用了 empirical Bayes 方法对 selection bias 进行修正。&lt;/p&gt;&lt;p&gt;Chen and Velikov (2019) 假设因子  &lt;img src=&quot;https://www.zhihu.com/equation?tex=i&quot; alt=&quot;i&quot; eeimg=&quot;1&quot;/&gt;  在被发表后的样本平均收益率 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbar+r_i&quot; alt=&quot;\bar r_i&quot; eeimg=&quot;1&quot;/&gt; 由真实 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%BC_i&quot; alt=&quot;μ_i&quot; eeimg=&quot;1&quot;/&gt; 和噪音 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B5_i&quot; alt=&quot;ε_i&quot; eeimg=&quot;1&quot;/&gt; 决定：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbar+r_i%3D%5Cmu_i%2B%5Cvarepsilon_i&quot; alt=&quot;\bar r_i=\mu_i+\varepsilon_i&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;其中 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B5_i&quot; alt=&quot;ε_i&quot; eeimg=&quot;1&quot;/&gt; 满足正态分布 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmathcal%7BN%7D%280%2C+%5Cmbox%7BSE%7D_i%29&quot; alt=&quot;\mathcal{N}(0, \mbox{SE}_i)&quot; eeimg=&quot;1&quot;/&gt; ，这里 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BSE%7D_i&quot; alt=&quot;\mbox{SE}_i&quot; eeimg=&quot;1&quot;/&gt; 是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbar+r_i&quot; alt=&quot;\bar r_i&quot; eeimg=&quot;1&quot;/&gt; 的 standard error。Chen and Velikov (2019) 进一步假设所有因子 net return 的真实均值 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%BC_i&quot; alt=&quot;μ_i&quot; eeimg=&quot;1&quot;/&gt; 都满足如下正态分布：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmu_i%5Csim%5Cmathcal%7BN%7D%28%5Cmu_%7B%5Cmu%7D%2C%5Csigma_%7B%5Cmu%7D%29&quot; alt=&quot;\mu_i\sim\mathcal{N}(\mu_{\mu},\sigma_{\mu})&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;Chen and Velikov (2019) 采用 method of moments 对参数 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%BC_%CE%BC&quot; alt=&quot;μ_μ&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%83_%CE%BC&quot; alt=&quot;σ_μ&quot; eeimg=&quot;1&quot;/&gt; 进行估计：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+%5Chat%5Cmu_%7B%5Cmu%7D%26%3D%26%5Cdisplaystyle%5Cfrac%7B1%7D%7BN%7D%5Csum_i%5Cbar+r_i%5C%5C+%5Chat%5Csigma_%7B%5Cmu%7D%5E2%26%3D%26%5Cdisplaystyle%5Cmax%5Cleft%5C%7B%5Cleft%5B%5Cfrac%7B1%7D%7BN%7D%5Csum_i%28%5Cbar+r_i-%5Chat%5Cmu_%7B%5Cmu%7D%29%5E2-%5Cfrac%7B1%7D%7BN%7D%5Csum_i%5Cmbox%7BSE%7D_i%5E2%5Cright%5D%2C0%5Cright%5C%7D+%5Cend%7Barray%7D&quot; alt=&quot;\begin{array}{rll} \hat\mu_{\mu}&amp;amp;=&amp;amp;\displaystyle\frac{1}{N}\sum_i\bar r_i\\ \hat\sigma_{\mu}^2&amp;amp;=&amp;amp;\displaystyle\max\left\{\left[\frac{1}{N}\sum_i(\bar r_i-\hat\mu_{\mu})^2-\frac{1}{N}\sum_i\mbox{SE}_i^2\right],0\right\} \end{array}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;上式说明 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+%CE%BC_%CE%BC&quot; alt=&quot;\hat μ_μ&quot; eeimg=&quot;1&quot;/&gt; 是所有因子平均收益率的截面均值。看到这里，似乎还没见 Bayes 的影子。别着急，有了 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbar+r_i&quot; alt=&quot;\bar r_i&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%BC_%CE%BC&quot; alt=&quot;μ_μ&quot; eeimg=&quot;1&quot;/&gt; 的估计，接下来马上就要&lt;b&gt;贝叶斯收缩（Bayes shrinkage）&lt;/b&gt;了：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D%5B%5Cmu_i%7Cr_i%2C%5Cmbox%7BSE%7D_i%5D%3Ds_i%5Cmu_%7B%5Cmu%7D%2B%281-s_i%29%5Cbar+r_i&quot; alt=&quot;\mbox{E}[\mu_i|r_i,\mbox{SE}_i]=s_i\mu_{\mu}+(1-s_i)\bar r_i&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;上式中 &lt;img src=&quot;https://www.zhihu.com/equation?tex=s_i&quot; alt=&quot;s_i&quot; eeimg=&quot;1&quot;/&gt; 是收缩系数，它由 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbar+r_i&quot; alt=&quot;\bar r_i&quot; eeimg=&quot;1&quot;/&gt; 的 standard error（ &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BSE%7D_i&quot; alt=&quot;\mbox{SE}_i&quot; eeimg=&quot;1&quot;/&gt; ）和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%BC_%7B%5Cmu%7D&quot; alt=&quot;μ_{\mu}&quot; eeimg=&quot;1&quot;/&gt; 的标准差 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%83_%CE%BC&quot; alt=&quot;σ_μ&quot; eeimg=&quot;1&quot;/&gt; 的相对大小决定：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=s_i%3D%5Cdisplaystyle%5Cfrac%7B%5Cmbox%7BSE%7D%5E2_i%7D%7B%5Csigma_%7B%5Cmu%7D%5E2%2B%5Cmbox%7BSE%7D_i%5E2%7D&quot; alt=&quot;s_i=\displaystyle\frac{\mbox{SE}^2_i}{\sigma_{\mu}^2+\mbox{SE}_i^2}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;结合 &lt;img src=&quot;https://www.zhihu.com/equation?tex=s_i&quot; alt=&quot;s_i&quot; eeimg=&quot;1&quot;/&gt; 的定义不难看出，如果 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BSE%7D_i&quot; alt=&quot;\mbox{SE}_i&quot; eeimg=&quot;1&quot;/&gt; 小说明 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbar+r_i&quot; alt=&quot;\bar r_i&quot; eeimg=&quot;1&quot;/&gt; 可信，则收缩后的因子  &lt;img src=&quot;https://www.zhihu.com/equation?tex=i&quot; alt=&quot;i&quot; eeimg=&quot;1&quot;/&gt;  的收益率由其主宰；如果 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BSE%7D_i&quot; alt=&quot;\mbox{SE}_i&quot; eeimg=&quot;1&quot;/&gt; 相对 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%83_%CE%BC&quot; alt=&quot;σ_μ&quot; eeimg=&quot;1&quot;/&gt; 很大就说明 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbar+r_i&quot; alt=&quot;\bar r_i&quot; eeimg=&quot;1&quot;/&gt; 不靠谱，则因子 &lt;img src=&quot;https://www.zhihu.com/equation?tex=i&quot; alt=&quot;i&quot; eeimg=&quot;1&quot;/&gt; 的收益率由全部 120 个因子的截面均值主宰。经如此调整后，Chen and Velikov (2019) 得到了如下结果。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-3d0ca713d273e202558ccd0104055625_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;751&quot; data-rawheight=&quot;303&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;751&quot; data-original=&quot;https://pic2.zhimg.com/v2-3d0ca713d273e202558ccd0104055625_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-3d0ca713d273e202558ccd0104055625_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;751&quot; data-rawheight=&quot;303&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;751&quot; data-original=&quot;https://pic2.zhimg.com/v2-3d0ca713d273e202558ccd0104055625_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-3d0ca713d273e202558ccd0104055625_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;排除 selection bias 之后，即便是最好的因子（top 5%），被发表后月均 net return 仅有 0.21% —— 这还是在允许等权构建因子的前提下。当使用市值加权时，该数值降低至 0.07%。基于以上结果，Chen and Velikov (2019) 认为考虑了合理的交易成本后，绝大多数因子在样本外都无法获利。不要忘记，以上结果还是基于对交易进行了优化后的结果。&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;Average investors should expect&lt;/i&gt; &lt;i&gt;&lt;b&gt;only tiny profits&lt;/b&gt;&lt;/i&gt; &lt;i&gt;from selected, cost-mitigated anomaly strategies.&lt;/i&gt;&lt;/blockquote&gt;&lt;h2&gt;&lt;b&gt;04 结语&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;由于曝光导致错误定价减弱、因子拥挤以及交易成本等原因，因子样本外表现变差是因子投资中必须面对的问题。这也催生了业界对因子择时的极大兴趣，并尝试使用各种手段持续挖新的因子（新的因子意味着曝光少、拥挤度低）。Arnott et al. (2019) 一文也严肃讨论了投资人在因子投资中常犯的三大错误，第一条就是对样本内的表现非理性外推，造成对因子样本外的表现缺乏理性预期。&lt;/p&gt;&lt;p&gt;另外，当因子表现变差时，人们由此想到的另一个问题是因子是否会失效。对此，我们认为如果因子背后的原因是风险补偿或者错误定价，那么还是有理由相信因子长期来看会有效的。在这方面，Asness (2015) 有过精彩的讨论。该文认为诸如 value、momentum、carry 等因子在长期来看会持续有效。这背后的原因主要包括：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;从风险的角度来看，因子承担了某些不可预知的风险，需要得到相应的补偿。只要风险是真实存在的，承担这种风险长期就会得到回报。&lt;/li&gt;&lt;li&gt;从行为金融学的角度来看，投资者认知偏差和信息传播速度等因素可以导致股票的价格偏离内在价值。只要投资者“动物精神”不消失，那么错误定价就会一直存在，就给了使用因子获取收益的机会。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;最后，还有一个事实也不得不提：很多人知道了一个因子，并不代表他会利用这个因子，也并不代表他无条件的信任这个因子，更不代表他会坚定不移的使用这个因子。知道并不意味着懂，懂并不意味着会用，会用也并不意味着始终如一。因此，有充分先验依据的因子的长期表现依然值得期待。&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;参考文献&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Arnott, R., C. R. Harvey, V. Kalesnik, and J. Linnainmaa (2019). Alice’s adventures in factorland: Three blunders that plague factor investing. &lt;i&gt;The Journal of Portfolio Management&lt;/i&gt;, Vol. 45(4), 18 – 36.&lt;/li&gt;&lt;li&gt;Asness, C. S. (2015). How can a strategy still work if everyone knows about it? AQR Research Insight.&lt;/li&gt;&lt;li&gt;Asness, C. S. and A. Frazzini (2013). The devil in HML’s details. &lt;i&gt;The Journal of Portfolio Management&lt;/i&gt;, Vol. 39(4), 49 – 68.&lt;/li&gt;&lt;li&gt;Bayraktar, M., S. Doole, A. Kassam, and S. Radchenko (2015). Lost in the crowd? Identifying and measuring crowded strategies and trades. MSCI Research Insight.&lt;/li&gt;&lt;li&gt;Bonne, G., L. Roisenberg, R. Kouzmenko, and P. Zangari (2018). MSCI integrated factor crowding model. MSCI Research Insight.&lt;/li&gt;&lt;li&gt;Bowles, B., A. V. Reed, M. Ringgenberg, and J. R. Thornock (2019). Anomaly time. SSRN Working Paper.&lt;/li&gt;&lt;li&gt;Chen, A. Y. and M. Velikov (2019). Accounting for anomaly zoo: A trading cost perspective. SSRN Working Paper.&lt;/li&gt;&lt;li&gt;De Bondt, W. M. and R. H. Thaler (1985). Does the stock market overreact? Journal of Finance, Vol. 40(3), 793 – 805.&lt;/li&gt;&lt;li&gt;Fama, E. F. and K. R. French (1993). Common risk factors in the returns on stocks and bonds. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 33(1), 3 – 56.&lt;/li&gt;&lt;li&gt;Khandani, A. E. and A. W. Lo (2011). What happened to the quants in August 2007? Evidence from factors and transactions data. &lt;i&gt;Journal of Financial Markets&lt;/i&gt;, Vol. 14(1), 1 – 46.&lt;/li&gt;&lt;li&gt;McLean, R.D. and J. Pontiff (2016). Does academic research destroy stock return predictability? &lt;i&gt;Journal of Finance&lt;/i&gt;, Vol. 71(1), 5 – 32.&lt;/li&gt;&lt;li&gt;Novy-Marx, R. and M. Velikov (2015). A taxonomy of anomalies and their trading costs. &lt;i&gt;Review of Financial Studies&lt;/i&gt;, Vol. 29(1), 104 – 147.&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;免责声明：&lt;/b&gt;文章内容不可视为投资意见。市场有风险，入市需谨慎。&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处。已委托“维权骑士”(&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//rightknights.com/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;维权骑士_免费版权监测/版权保护/内容多平台分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2019-12-17-96990210</guid>
<pubDate>Tue, 17 Dec 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>因子样本外表现为什么变差？</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2019-12-12-96990210.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/96990210&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-506754755985b7fe2c33deb05a917583_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;摘要&lt;/b&gt;&lt;/p&gt;&lt;p&gt;曝光导致错误定价减弱、因子拥挤和交易成本是因子样本外变差的三大原因。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;00 引言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;因子样本外的表现较样本内变差是人们的共识。这里的因子包括异象（anomalies）和传统意义上的风格 beta 因子，在下文不做区分，统称为因子。造成因子样本内、外表现差异的最主要原因自然是样本内的 data snooping（即因子本来就是假的），但如果因子确实是真实的，那么它们在样本外变差的原因是什么呢？学术界和业界的主要观点包括以下三种：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;b&gt;曝光导致错误定价减弱&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;因子拥挤&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;交易成本&lt;/b&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;在 2019 年 9 月刚刚结束的 Wharton 商学院 Jacobs Levy Center 年会中，一共深入讨论了四篇论文，其中两篇就和因子样本外表现有关，它们分别是 Bowles et al. (2019) 以及 Chen and Velikov (2019)，足见这个话题的重要性。具体来说，Bowles et al. (2019) 以 Anomaly Time 为题从“曝光导致错误定价减弱”的角度谈论了因子的表现；而 Chen and Velikov (2019) 则从“交易成本”的角度指出，在考虑了非常合理的费用之后，绝大多数因子在样本外根本无法赚钱。&lt;/p&gt;&lt;p&gt;本文就来简要探讨一下因子样本外表现变差的三个原因。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;01 曝光导致错误定价减弱&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;因子代表着市场某方面的非有效性、代表了某种 mispricing（错误定价）。&lt;/b&gt;只要套利限制不是过大，那么聪明的投资者一定会先人一步去交易这个因子，导致错误定价收窄，这就解释了为什么&lt;b&gt;当因子被发表后，它的收益往往也跟着显著下降。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;在这方面，McLean and Pontiff (2016)  的研究颇具代表性。该文研究了 97 个因子，发现因子样本外的表现比样本内的表现下降了 26%、而发表后（post-publication）的表现较样本内则下降了 58%。McLean and Pontiff (2016)  考虑样本内外差异是为了控制过拟合的影响。上述结果表明，58% 与 26% 之差 —— 即 32% —— 就是发表本身造成因子效果的减弱。McLean and Pontiff (2016)  把它称作 publication-informed trading。这背后的逻辑链是：因子被发表导致它被公布于众 --&amp;gt; 越来越多的人交易该因子从而减弱了错误定价 --&amp;gt; 最终导致因子收益率降低。&lt;/p&gt;&lt;p&gt;如果说 McLean and Pontiff (2016)  检验了因子的平均收益，Bowles et al. (2019) 则是从时效性的角度展示了因子背后的信息越来越快的被 priced in。长久以来，由于 Fama and French (1993) 的影响太过深远，学术界在研究因子的时候为了避免未来数据，通常采用每年再平衡的方法（量价相关的指标通常是月频再平衡），导致构建因子的指标数据严重滞后。这其中最著名的例子要数 Eugene Fama 的弟子 Cliff Asness 使用月频价格对 HML 的改造（&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzUxNzY0NjU3Mw%3D%3D%26mid%3D2247483911%26idx%3D1%26sn%3D29be96059644fdf80dc9db87a69b9fa5%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Asness and Frazzini 2013&lt;/a&gt;）。使用了月频价格数据后的 HML 较 Fama and French (1993) 三因子的 HML 表现更好，说明了数据时效性的重要性。&lt;/p&gt;&lt;p&gt;再来看个更显著的例子。下图显示了 Reliant Energy Inc. 这家公司 2007 和 2008 两年 10-K filing 的时间，以及按学术界传统每年 6 月底再平衡时该公司的股价变化。在 2007 年 10-K filing 到 6 月底这 85 天内，因最新的财报数据，该公司股价上涨 59.09%。如果按照两个 10-K filing 之间来调仓选入该股票，那么在两个披露期之间可以获利 44.63%；而在传统研究框架下，如果在两个 6 月底调仓，选入该股票却亏损 21.08%。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-a5ef0242551f31c74192fecb9c996fc8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;555&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-a5ef0242551f31c74192fecb9c996fc8_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-a5ef0242551f31c74192fecb9c996fc8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;555&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-a5ef0242551f31c74192fecb9c996fc8_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-a5ef0242551f31c74192fecb9c996fc8_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;对于使用财务指标构造的因子，学术界之所以使用每年再平衡是因为学术界的重心毕竟是 empirical asset pricing。&lt;b&gt;为了研究成果的可复制性和可比性&lt;/b&gt;，大家用的都是同样的数据库、采用同样的再平衡周期，因此也就没有想过要用粒度更细的数据。&lt;/p&gt;&lt;p&gt;Bowles et al. (2019) 一文则另辟蹊径，使用 &lt;b&gt;Compustat Snapshot 数据库&lt;/b&gt;对因子时效进行了分析。用 Bowles et al. (2019) 自己的话说，Snapshot 在学术界用的很少，但它却是有着粒度最细的数据 —— 细到记录财报中&lt;b&gt;每个单一变量&lt;/b&gt;更新的时间：&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;For&lt;/i&gt; &lt;i&gt;&lt;b&gt;each&lt;/b&gt;&lt;/i&gt; &lt;i&gt;financial statement&lt;/i&gt; &lt;i&gt;&lt;b&gt;variable&lt;/b&gt;, Snapshot identifies&lt;/i&gt; &lt;i&gt;&lt;b&gt;the first date&lt;/b&gt;&lt;/i&gt; &lt;i&gt;on which each variable was reported.&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;以美股为例，通常上市公司先有 earnings announcement 然后才有 10-Q 和 10-K filing。而在 earnings announcement 上往往只会公布 total revenue 和 net income 等少许指标，而在正式的 filing 中才披露全部财报内容。在这种情况下，Snapshot 数据库会在 earnings announcement 当日更新 total revenue 和 net income 数据，而等到实际 filing 之后再更新其他数据。因此，使用 Snapshot 数据可以保证在用来计算因子的指标被更新后，第一时间更新因子、进行投资组合的再平衡。&lt;/p&gt;&lt;p&gt;利用 Snapshot 数据，Bowles et al. (2019) 研究了一些常见的源自财务数据的因子，发现绝大多数因子在最新数据更新后的 120 天之内（特别是最初的 30 天内）能够获得显著的超额收益。而在 120 天之后，超额收益消失（下图）。不过，Bowles et al. (2019) 也指出，最近几年的实证结果显示，因子的超额收益消失的更快。基于这些发现，Bowles et al. (2019) 认为因子是真实的（而非 data snooping 出来的），但很快就会因套利交易而消失。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-3d261a3427bde6d4c651f1f51cb16c6b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;899&quot; data-rawheight=&quot;627&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;899&quot; data-original=&quot;https://pic4.zhimg.com/v2-3d261a3427bde6d4c651f1f51cb16c6b_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-3d261a3427bde6d4c651f1f51cb16c6b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;899&quot; data-rawheight=&quot;627&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;899&quot; data-original=&quot;https://pic4.zhimg.com/v2-3d261a3427bde6d4c651f1f51cb16c6b_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-3d261a3427bde6d4c651f1f51cb16c6b_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;Bowles et al. (2019) 针对美股的研究和前不久天风证券的一篇《和时间赛跑 —— 利用实时财务信息增强组合收益》针对 A 股的报告异曲同工。该研究显示，利用业绩预告和快报能够提升财务信息的时效性，提高财务因子的表现。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;02 因子拥挤&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;造成因子样本外变差的第二个原因是&lt;b&gt;因子拥挤（factor crowding）&lt;/b&gt;。&lt;/p&gt;&lt;p&gt;通常来说，因子都有周期性。当某类因子好使的时候，就会造成更多的资金引入，从而出现因子拥挤，并降低该因子未来的预期收益率。而 rule-based （使用相似的指标排序、接近的调仓频率）的因子投资无疑加剧了这种负面影响。&lt;/p&gt;&lt;p&gt;由于因子拥挤度和因子未来收益率呈现负相关，如何定量计算因子拥挤度就成为人们关注的问题。在这方面，MSCI 整理了相关研究，提出五个描述因子拥挤度的代理指标（Bayraktar et al. 2015，Bonne et al. 2018）。这五个指标是：valuation spread、short Interest spread、pairwise correlation、factor volatility 以及 factor reversal。考虑到由于制度问题，short interest spread 在 A 股上并不适用，下面对其他四个指标做简要介绍。海通证券的报告《因子失效预警：因子拥挤》针对 A 股对上述四个指标进行了分析。&lt;/p&gt;&lt;p&gt;&lt;b&gt;2.1 Valuation Spread&lt;/b&gt;&lt;/p&gt;&lt;p&gt;顾名思义，valuation spread（估值价差）考虑的正是因子的估值。关于因子估值在 A 股上的实证，感兴趣的小伙伴请参考&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzI3Mjk5OTU1Ng%3D%3D%26mid%3D2247483923%26idx%3D1%26sn%3Ddd5e368d21c71137a7d2fd971af7c970%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;《你家因子便宜吗？&lt;/a&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzI3Mjk5OTU1Ng%3D%3D%26mid%3D2247483923%26idx%3D1%26sn%3Ddd5e368d21c71137a7d2fd971af7c970%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;——基于value spread的因子择时研究》&lt;/a&gt;。这背后的逻辑是，当更多资金涌入某个因子时（特别是多头时），会造成受波及股票的价格上涨，使它们的估值变高。因此，因子估值和因子拥挤度成正相关，是一个不错代理指标。&lt;/p&gt;&lt;p&gt;估值价差的计算方法十分直观。首先选择一个合适的股票估值指标，比如 B/P，然后分别计算因子多空两头组合中该估值指标的中位数，以此作为多空两头的估值，最后这两个估值差就是因子的估值价差。以 B/P 为例，Bonne et al. (2018) 使用的计算公式为：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvaluation+spread%7D%3D%5Cdisplaystyle%5Cln%5Cleft%28%5Cfrac%7B%5Cmbox%7Bmedian+B%2FP+in+long+leg%7D%7D%7B%5Cmbox%7Bmedian+B%2FP+in+short+leg%7D%7D%5Cright%29&quot; alt=&quot;\mbox{valuation spread}=\displaystyle\ln\left(\frac{\mbox{median B/P in long leg}}{\mbox{median B/P in short leg}}\right)&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;&lt;b&gt;2.2 Pairwise Correlation&lt;/b&gt;&lt;/p&gt;&lt;p&gt;第二个指标是 Pairwise Correlation（配对相关性）。它是为了从因子投资组合内股票收益率的相关程度来试图揭示资金持仓的集中程度，并以此来评价因子的拥挤程度。为了计算该指标，Bonne et al. (2018) 采用了如下步骤：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;将因子多（空）头内的股票做市场、市值等中性化处理，得到残差；&lt;/li&gt;&lt;li&gt;使用 63 个交易日的残差计算每个股票和其所在多、空头内平均残差收益率的相关性。以多头为例，使用多头组合中第 i 支股票的残差收益率和剩余股票残差收益率均值计算相关系数。空头处理相同。&lt;/li&gt;&lt;li&gt;计算多、空两头组内所有股票相关系数的均值；&lt;/li&gt;&lt;li&gt;将多、空两头相关系数均值再取平均，得到该因子 Pairwise Correlation 的原始值，最后再将该值进行标准化就得到最终该因子的 Pairwise Correlation。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;b&gt;2.3 Factor Volatility&lt;/b&gt;&lt;/p&gt;&lt;p&gt;由于资金的流入会加剧因子收益率的波动，因此 Bonne et al. (2018) 从这个角度提出了衡量因子拥挤度的第三个指标：Factor Volatility（因子波动率）。值得一提的是，Bonne et al. (2018) 使用的是预测的未来因子波动率相对未来市场波动率的比值来计算该指标。他们认为这么做可以有效的控制市场波动率变化造成的影响。在实际操作中，一个简化的处理方法是使用因子的历史波动率。&lt;/p&gt;&lt;p&gt;&lt;b&gt;2.4 Factor Reversal&lt;/b&gt;&lt;/p&gt;&lt;p&gt;最后一个指标是 Factor Reversal（因子反转）。De Bondt and Thaler (1985) 这篇著名的论文表明美股在 3 到 5 年的中长期尺度上存在反转。由于因子是股票构成的投资组合，因此我们可以自然的从股票的反转延伸出因子的反转。Bonne et al. (2018) 使用因子过去三年的累积收益率计算该指标。&lt;/p&gt;&lt;p&gt;以前文提到的《因子失效预警：因子拥挤》研究结果为例，下图展示了估值价差和因子反转两个因子拥挤度指标和 A 股上一些常见因子未来收益率的关系（之所以没有放另外两个指标的结果是因为报告中的计算方法和 Bonne et al. 2018 的方法差异较大；方法并无优劣之分，但因实证结果并不直接对应前文介绍的方法，故略去）。图中结果显示，对其中大部分因子，这两个指标和因子未来收益率成负相关，说明该因子拥挤会造成因子表现变差。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-55557f4d5c71fa6e8c53a1d4b1d48306_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;364&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-55557f4d5c71fa6e8c53a1d4b1d48306_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-55557f4d5c71fa6e8c53a1d4b1d48306_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;364&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-55557f4d5c71fa6e8c53a1d4b1d48306_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-55557f4d5c71fa6e8c53a1d4b1d48306_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;最后，因子拥挤也会引发流动性冲击。一旦市场中发生冲击因子的事件后，持有相似头寸的管理人会竞相卖出手中的股票，由此产生的流动性危机会造成很大的亏损。2007 年 8 月，美股市场上一些非常优秀的量化对冲基金在短时间内录得了巨大的亏损。Khandani and Lo (2011) 对此进行了研究并发现，很多基金经理在短时间内清理了相似的头寸，巨大的抛压对流动性造成了巨大的打击、使得这些股票的价格在短时间内大幅下跌。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;03 交易成本&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;交易成本是因子在样本外的效果较样本内显著变差的第三个原因。&lt;/p&gt;&lt;p&gt;&lt;b&gt;学术论文通常不会对交易费用给予充分的考虑，这会造成对因子收益率的高估。&lt;/b&gt;此外，由于因子投资组合一般都是多、空对冲的组合，如果不合理考虑做空限制，也会高估因子的收益。Novy-Marx and Velikov (2015) 研究了交易费用对因子效果的影响，并提出三个思路降低交易成本：（1）仅使用交易费用低的股票构建因子组合；（2）降低因子组合再平衡的频率；（3）在交易时考虑更严格的买卖价差约束。&lt;/p&gt;&lt;p&gt;在 Chen and Velikov (2019) 一文中，二位作者使用 &lt;b&gt;effective spread（有效价差）&lt;/b&gt;的概念代替传统的 bid-ask spread，对多达 120 种因子进行了研究。他们的研究发现 …… 哎，先上图吧。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-5d8545bd2c7fb372fb44982e2e191473_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;807&quot; data-rawheight=&quot;428&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;807&quot; data-original=&quot;https://pic4.zhimg.com/v2-5d8545bd2c7fb372fb44982e2e191473_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-5d8545bd2c7fb372fb44982e2e191473_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;807&quot; data-rawheight=&quot;428&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;807&quot; data-original=&quot;https://pic4.zhimg.com/v2-5d8545bd2c7fb372fb44982e2e191473_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-5d8545bd2c7fb372fb44982e2e191473_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;上图中，蓝色的 bar 代表着 120 个因子样本内的平均 gross 收益率（不考虑任何交易成本）；黄色 bar 为这些因子在发表后的平均 gross 收益率；红色 bar 为考虑了交易成本后，这些因子的平均收益率 —— &lt;b&gt;负的&lt;/b&gt;。&lt;/p&gt;&lt;p&gt;来看下具体研究方法。Chen and Velikov (2019) 对 effective spread 的定义为：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Beffective+spread%7D%3D%5Cdisplaystyle+2%5Ctimes%5Cleft%28%5Cln%28%5Cmbox%7Btrade+price%7D%29-%5Cln%28%5Cmbox%7Bquote+midpoint%7D%29%5Cright%29&quot; alt=&quot;\mbox{effective spread}=\displaystyle 2\times\left(\ln(\mbox{trade price})-\ln(\mbox{quote midpoint})\right)&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;为了考虑交易成本，他们假设每次调仓时的交易费用为上述 effective spread 的一半。从上述定义不难看出，因子的费后 net return 和换手率以及换仓时的 effective spread 息息相关：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bnet+return%7D%3D%5Cdisplaystyle+%5Cmbox%7Bgross+return%7D-%5Cmbox%7Bturnover%7D%5Ctimes%5Cmbox%7Beffective+spread%7D&quot; alt=&quot;\mbox{net return}=\displaystyle \mbox{gross return}-\mbox{turnover}\times\mbox{effective spread}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;有必要指出的是，Chen and Velikov (2019) 的研究仅考虑交易费用，并不考虑任何冲击成本。这意味着考虑了冲击成本后，因子样本外的 net return 只能更惨。下表显示了在考虑了成本后，120 个因子在样本内、外的收益情况（括号中为标准差）。结果显示，考虑成本后，即便是样本内，这些因子的月均收益仅有 0.05%，而样本外的收益更是小于零。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-65f3dc33c08959a08315feb8f2824e05_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;865&quot; data-rawheight=&quot;361&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;865&quot; data-original=&quot;https://pic2.zhimg.com/v2-65f3dc33c08959a08315feb8f2824e05_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-65f3dc33c08959a08315feb8f2824e05_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;865&quot; data-rawheight=&quot;361&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;865&quot; data-original=&quot;https://pic2.zhimg.com/v2-65f3dc33c08959a08315feb8f2824e05_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-65f3dc33c08959a08315feb8f2824e05_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;下图展示了样本外，这 120 个因子的 net returns 的分布。这些 net returns 经过了一定的交易优化处理，有效降低了换手率和交易成本，因此整体来看所有因子的 net return 均值是大于零的，而非上表中 -0.03% 那么惨。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-72ba155e7d1058b8443a9f9279aeedf8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;688&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-72ba155e7d1058b8443a9f9279aeedf8_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-72ba155e7d1058b8443a9f9279aeedf8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;688&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-72ba155e7d1058b8443a9f9279aeedf8_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-72ba155e7d1058b8443a9f9279aeedf8_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;这个分布看上去像是一个均值接近零的正态分布，和随机因子的表现并无太大差异（即如果我们使用完全随机生成的 120 个因子，其中也总会有一些是“显著”的）。由于发表的因子都多少存在 selection bias，因此面对上述结果，Chen and Velikov (2019) 不禁发问：排除运气后，还有多少因子是显著的？为了回答上述问题，他们采用了 empirical Bayes 方法对 selection bias 进行修正。&lt;/p&gt;&lt;p&gt;Chen and Velikov (2019) 假设因子  &lt;img src=&quot;https://www.zhihu.com/equation?tex=i&quot; alt=&quot;i&quot; eeimg=&quot;1&quot;/&gt;  在被发表后的样本平均收益率 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbar+r_i&quot; alt=&quot;\bar r_i&quot; eeimg=&quot;1&quot;/&gt; 由真实 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%BC_i&quot; alt=&quot;μ_i&quot; eeimg=&quot;1&quot;/&gt; 和噪音 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B5_i&quot; alt=&quot;ε_i&quot; eeimg=&quot;1&quot;/&gt; 决定：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbar+r_i%3D%5Cmu_i%2B%5Cvarepsilon_i&quot; alt=&quot;\bar r_i=\mu_i+\varepsilon_i&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;其中 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B5_i&quot; alt=&quot;ε_i&quot; eeimg=&quot;1&quot;/&gt; 满足正态分布 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmathcal%7BN%7D%280%2C+%5Cmbox%7BSE%7D_i%29&quot; alt=&quot;\mathcal{N}(0, \mbox{SE}_i)&quot; eeimg=&quot;1&quot;/&gt; ，这里 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BSE%7D_i&quot; alt=&quot;\mbox{SE}_i&quot; eeimg=&quot;1&quot;/&gt; 是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbar+r_i&quot; alt=&quot;\bar r_i&quot; eeimg=&quot;1&quot;/&gt; 的 standard error。Chen and Velikov (2019) 进一步假设所有因子 net return 的真实均值 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%BC_i&quot; alt=&quot;μ_i&quot; eeimg=&quot;1&quot;/&gt; 都满足如下正态分布：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmu_i%5Csim%5Cmathcal%7BN%7D%28%5Cmu_%7B%5Cmu%7D%2C%5Csigma_%7B%5Cmu%7D%29&quot; alt=&quot;\mu_i\sim\mathcal{N}(\mu_{\mu},\sigma_{\mu})&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;Chen and Velikov (2019) 采用 method of moments 对参数 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%BC_%CE%BC&quot; alt=&quot;μ_μ&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%83_%CE%BC&quot; alt=&quot;σ_μ&quot; eeimg=&quot;1&quot;/&gt; 进行估计：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+%5Chat%5Cmu_%7B%5Cmu%7D%26%3D%26%5Cdisplaystyle%5Cfrac%7B1%7D%7BN%7D%5Csum_i%5Cbar+r_i%5C%5C+%5Chat%5Csigma_%7B%5Cmu%7D%5E2%26%3D%26%5Cdisplaystyle%5Cmax%5Cleft%5C%7B%5Cleft%5B%5Cfrac%7B1%7D%7BN%7D%5Csum_i%28%5Cbar+r_i-%5Chat%5Cmu_%7B%5Cmu%7D%29%5E2-%5Cfrac%7B1%7D%7BN%7D%5Csum_i%5Cmbox%7BSE%7D_i%5E2%5Cright%5D%2C0%5Cright%5C%7D+%5Cend%7Barray%7D&quot; alt=&quot;\begin{array}{rll} \hat\mu_{\mu}&amp;amp;=&amp;amp;\displaystyle\frac{1}{N}\sum_i\bar r_i\\ \hat\sigma_{\mu}^2&amp;amp;=&amp;amp;\displaystyle\max\left\{\left[\frac{1}{N}\sum_i(\bar r_i-\hat\mu_{\mu})^2-\frac{1}{N}\sum_i\mbox{SE}_i^2\right],0\right\} \end{array}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;上式说明 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+%CE%BC_%CE%BC&quot; alt=&quot;\hat μ_μ&quot; eeimg=&quot;1&quot;/&gt; 是所有因子平均收益率的截面均值。看到这里，似乎还没见 Bayes 的影子。别着急，有了 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbar+r_i&quot; alt=&quot;\bar r_i&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%BC_%CE%BC&quot; alt=&quot;μ_μ&quot; eeimg=&quot;1&quot;/&gt; 的估计，接下来马上就要&lt;b&gt;贝叶斯收缩（Bayes shrinkage）&lt;/b&gt;了：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D%5B%5Cmu_i%7Cr_i%2C%5Cmbox%7BSE%7D_i%5D%3Ds_i%5Cmu_%7B%5Cmu%7D%2B%281-s_i%29%5Cbar+r_i&quot; alt=&quot;\mbox{E}[\mu_i|r_i,\mbox{SE}_i]=s_i\mu_{\mu}+(1-s_i)\bar r_i&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;上式中 &lt;img src=&quot;https://www.zhihu.com/equation?tex=s_i&quot; alt=&quot;s_i&quot; eeimg=&quot;1&quot;/&gt; 是收缩系数，它由 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbar+r_i&quot; alt=&quot;\bar r_i&quot; eeimg=&quot;1&quot;/&gt; 的 standard error（ &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BSE%7D_i&quot; alt=&quot;\mbox{SE}_i&quot; eeimg=&quot;1&quot;/&gt; ）和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%BC_i&quot; alt=&quot;μ_i&quot; eeimg=&quot;1&quot;/&gt; 的标准差 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%83_%CE%BC&quot; alt=&quot;σ_μ&quot; eeimg=&quot;1&quot;/&gt; 的相对大小决定：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=s_i%3D%5Cdisplaystyle%5Cfrac%7B%5Cmbox%7BSE%7D%5E2_i%7D%7B%5Csigma_%7B%5Cmu%7D%5E2%2B%5Cmbox%7BSE%7D_i%5E2%7D&quot; alt=&quot;s_i=\displaystyle\frac{\mbox{SE}^2_i}{\sigma_{\mu}^2+\mbox{SE}_i^2}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;结合 &lt;img src=&quot;https://www.zhihu.com/equation?tex=s_i&quot; alt=&quot;s_i&quot; eeimg=&quot;1&quot;/&gt; 的定义不难看出，如果 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BSE%7D_i&quot; alt=&quot;\mbox{SE}_i&quot; eeimg=&quot;1&quot;/&gt; 小说明 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbar+r_i&quot; alt=&quot;\bar r_i&quot; eeimg=&quot;1&quot;/&gt; 可信，则收缩后的因子  &lt;img src=&quot;https://www.zhihu.com/equation?tex=i&quot; alt=&quot;i&quot; eeimg=&quot;1&quot;/&gt;  的收益率由其主宰；如果 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BSE%7D_i&quot; alt=&quot;\mbox{SE}_i&quot; eeimg=&quot;1&quot;/&gt; 相对 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%83_%CE%BC&quot; alt=&quot;σ_μ&quot; eeimg=&quot;1&quot;/&gt; 很大就说明 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbar+r_i&quot; alt=&quot;\bar r_i&quot; eeimg=&quot;1&quot;/&gt; 不靠谱，则因子 &lt;img src=&quot;https://www.zhihu.com/equation?tex=i&quot; alt=&quot;i&quot; eeimg=&quot;1&quot;/&gt; 的收益率由全部 120 个因子的截面均值主宰。经如此调整后，Chen and Velikov (2019) 得到了如下结果。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-3d0ca713d273e202558ccd0104055625_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;751&quot; data-rawheight=&quot;303&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;751&quot; data-original=&quot;https://pic2.zhimg.com/v2-3d0ca713d273e202558ccd0104055625_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-3d0ca713d273e202558ccd0104055625_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;751&quot; data-rawheight=&quot;303&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;751&quot; data-original=&quot;https://pic2.zhimg.com/v2-3d0ca713d273e202558ccd0104055625_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-3d0ca713d273e202558ccd0104055625_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;排除 selection bias 之后，即便是最好的因子（top 5%），被发表后月均 net return 仅有 0.21% —— 这还是在允许等权构建因子的前提下。当使用市值加权时，该数值降低至 0.07%。基于以上结果，Chen and Velikov (2019) 认为考虑了合理的交易成本后，绝大多数因子在样本外都无法获利。不要忘记，以上结果还是基于对交易进行了优化后的结果。&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;Average investors should expect&lt;/i&gt; &lt;i&gt;&lt;b&gt;only tiny profits&lt;/b&gt;&lt;/i&gt; &lt;i&gt;from selected, cost-mitigated anomaly strategies.&lt;/i&gt;&lt;/blockquote&gt;&lt;h2&gt;&lt;b&gt;04 结语&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;由于曝光导致错误定价减弱、因子拥挤以及交易成本等原因，因子样本外表现变差是因子投资中必须面对的问题。这也催生了业界对因子择时的极大兴趣，并尝试使用各种手段持续挖新的因子（新的因子意味着曝光少、拥挤度低）。Arnott et al. (2019) 一文也严肃讨论了投资人在因子投资中常犯的三大错误，第一条就是对样本内的表现非理性外推，造成对因子样本外的表现缺乏理性预期。&lt;/p&gt;&lt;p&gt;另外，当因子表现变差时，人们由此想到的另一个问题是因子是否会失效。对此，我们认为如果因子背后的原因是风险补偿或者错误定价，那么还是有理由相信因子长期来看会有效的。在这方面，Asness (2015) 有过精彩的讨论。该文认为诸如 value、momentum、carry 等因子在长期来看会持续有效。这背后的原因主要包括：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;从风险的角度来看，因子承担了某些不可预知的风险，需要得到相应的补偿。只要风险是真实存在的，承担这种风险长期就会得到回报。&lt;/li&gt;&lt;li&gt;从行为金融学的角度来看，投资者认知偏差和信息传播速度等因素可以导致股票的价格偏离内在价值。只要投资者“动物精神”不消失，那么错误定价就会一直存在，就给了使用因子获取收益的机会。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;最后，还有一个事实也不得不提：很多人知道了一个因子，并不代表他会利用这个因子，也并不代表他无条件的信任这个因子，更不代表他会坚定不移的使用这个因子。知道并不意味着懂，懂并不意味着会用，会用也并不意味着始终如一。因此，有充分先验依据的因子的长期表现依然值得期待。&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;参考文献&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Arnott, R., C. R. Harvey, V. Kalesnik, and J. Linnainmaa (2019). Alice’s adventures in factorland: Three blunders that plague factor investing. &lt;i&gt;The Journal of Portfolio Management&lt;/i&gt;, Vol. 45(4), 18 – 36.&lt;/li&gt;&lt;li&gt;Asness, C. S. (2015). How can a strategy still work if everyone knowns about it? AQR Research Insight.&lt;/li&gt;&lt;li&gt;Asness, C. S. and A. Frazzini (2013). The devil in HML’s details. &lt;i&gt;The Journal of Portfolio Management&lt;/i&gt;, Vol. 39(4), 49 – 68.&lt;/li&gt;&lt;li&gt;Bayraktar, M., S. Doole, A. Kassam, and S. Radchenko (2015). Lost in the crowd? Identifying and measuring crowded strategies and trades. MSCI Research Insight.&lt;/li&gt;&lt;li&gt;Bonne, G., L. Roisenberg, R. Kouzmenko, and P. Zangari (2018). MSCI integrated factor crowding model. MSCI Research Insight.&lt;/li&gt;&lt;li&gt;Bowles, B., A. V. Reed, M. Ringgenberg, and J. R. Thornock (2019). Anomaly time. SSRN Working Paper.&lt;/li&gt;&lt;li&gt;Chen, A. Y. and M. Velikov (2019). Accounting for anomaly zoo: A trading cost perspective. SSRN Working Paper.&lt;/li&gt;&lt;li&gt;De Bondt, W. M. and R. H. Thaler (1985). Does the stock market overreact? Journal of Finance, Vol. 40(3), 793 – 805.&lt;/li&gt;&lt;li&gt;Fama, E. F. and K. R. French (1993). Common risk factors in the returns on stocks and bonds. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 33(1), 3 – 56.&lt;/li&gt;&lt;li&gt;Khandani, A. E. and A. W. Lo (2011). What happened to the quants in August 2007? Evidence from factors and transactions data. &lt;i&gt;Journal of Financial Markets&lt;/i&gt;, Vol. 14(1), 1 – 46.&lt;/li&gt;&lt;li&gt;McLean, R.D. and J. Pontiff (2016). Does academic research destroy stock return predictability? &lt;i&gt;Journal of Finance&lt;/i&gt;, Vol. 71(1), 5 – 32.&lt;/li&gt;&lt;li&gt;Novy-Marx, R. and M. Velikov (2015). A taxonomy of anomalies and their trading costs. &lt;i&gt;Review of Financial Studies&lt;/i&gt;, Vol. 29(1), 104 – 147.&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;免责声明：&lt;/b&gt;文章内容不可视为投资意见。市场有风险，入市需谨慎。&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处。已委托“维权骑士”(&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//rightknights.com/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;维权骑士_免费版权监测/版权保护/内容多平台分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2019-12-12-96990210</guid>
<pubDate>Thu, 12 Dec 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>残差动量 —— 有理有据还是数据挖掘？</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2019-12-04-95259084.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/95259084&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-9b0d610e327f63373ff51c4ed40c4f72_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;作者：&lt;/b&gt;刀疤连（Chihiro Quantitative Research）、llanglli（因子动物园）；石川&lt;/p&gt;&lt;p&gt;&lt;b&gt;摘要：&lt;/b&gt;与传统动量不同，残差动量在 A 股效果显著。但这背后是有理有据还是数据挖掘？&lt;/p&gt;&lt;h2&gt;&lt;b&gt;1 引言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;动量，更确切地说是 Jegadeesh and Titman (1993) 提出的截面相对强弱，一直以来是美股生命力最旺盛的异象之一。无论是 Fama and French (1993) 三因子模型还是 Fama and French (2015) 五因子模型均无法解释动量策略（Blitz et al. 2018），因此 Eugene Fama 也不得不承认它是最显著的异象。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-eecf1c351ae4d09fa2d438264c4d3c0b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;968&quot; data-rawheight=&quot;331&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;968&quot; data-original=&quot;https://pic4.zhimg.com/v2-eecf1c351ae4d09fa2d438264c4d3c0b_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-eecf1c351ae4d09fa2d438264c4d3c0b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;968&quot; data-rawheight=&quot;331&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;968&quot; data-original=&quot;https://pic4.zhimg.com/v2-eecf1c351ae4d09fa2d438264c4d3c0b_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-eecf1c351ae4d09fa2d438264c4d3c0b_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;在美股上，动量策略虽然长期来看很不错，但这种做多前期 Winner 做空前期 Loser 的对冲组合却时不时会来个 crash，俗称动量崩溃（momentum crash），即动量策略会遭遇不多但持续时间长、幅度大的下跌。学术界的研究认为这和该组合的动态风险敞口有关。Geczy and Samonov (2013) 基于超长的美国股市数据指出，动量效应对于市场组合有着动态的暴露，具体敞口则取决于市场状态。当市场从一种状态转换到另一种状态的初期，动量组合对于最新市场状态有着负的暴露，从而导致市场转换期的大幅损失。Daniel and Moskowitz (2016) 发现动量崩溃与该策略的尾部风险有关。崩溃往往发生在市场恐慌时，此时资产价格大跌而波动率大幅上升，这与 Geczy and Samonov (2013) 的发现一致。&lt;/p&gt;&lt;p&gt;为了改善动量策略的极端表现，2011 年来自 Robeco 的 David Blitz 领衔发表了 Blitz, Huij, and Martens (2011) 一文，提出了残差动量（residual momentum）策略。该策略使用股票相对于 Fama and French (1993) 三因子模型的残差收益率，经残差波动率调整后计算了残差动量（因此也被称为异质动量，idiosyncratic momentum）。Blitz, Huij, and Martens (2011) 的实证结果显示，该策略比传统动量策略能够获得更高的风险收益比。除此之外，Hanauer and Windmueller (2019) 指出残差动量在传动动量 crash 的时期表现更好，能够极大降低亏损。&lt;/p&gt;&lt;p&gt;尽管动量策略在美股呼风唤雨，但是它到了 A 股中似乎画风一变、难有作为。那么，残差动量又如何呢？Lin (2019) 一文使用 Blitz, Huij, and Martens (2011) 的思路在 A 股上实证了残差动量策略，得出了惊人的效果（下图）。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-bd4ce3733210b19e5f194861b15bd110_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;804&quot; data-rawheight=&quot;661&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;804&quot; data-original=&quot;https://pic1.zhimg.com/v2-bd4ce3733210b19e5f194861b15bd110_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-bd4ce3733210b19e5f194861b15bd110_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;804&quot; data-rawheight=&quot;661&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;804&quot; data-original=&quot;https://pic1.zhimg.com/v2-bd4ce3733210b19e5f194861b15bd110_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-bd4ce3733210b19e5f194861b15bd110_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;怎么样？多、空对冲得到的残差动量（红线）累积收益率稳健上行（Panel A），滚动三年窗口的夏普率（Panel B）在整个实证窗口内均为正，且在很高的比例下在 1.0 以上，这种表现让多少风格因子汗颜？&lt;/p&gt;&lt;p&gt;坦白说，我们第一眼看到这个结果是不信的。再加上 Finance Research Letters 这个期刊的口碑也不是太过硬，更令人增加了几分怀疑。残差动量的计算方法是否合理，即其背后到底代表了什么原因？A 股市场上的残差动量是否真的有如此惊人的表现？带着这些问题，本期搞事情小组就来对残差动量进行深度实证。&lt;/p&gt;&lt;p&gt;先来看看 Blitz, Huij, and Martens (2011) 提出的残差动量计算方法。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;2 计算方法：有理有据？&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;Blitz, Huij, and Martens (2011) 使用 Fama and French (1993) 三因子模型为基准，使用股票月频超额收益和三因子月频收益率数据构建时序回归模型：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=r_%7Bi%2Ct%7D%3D%5Calpha_i%2B%5Cbeta_%7B1%2Ci%7D%5Cmbox%7BRMRF%7D_t%2B%5Cbeta_%7B2%2Ci%7D%5Cmbox%7BSMB%7D_t%2B%5Cbeta_%7B3%2Ci%7D%5Cmbox%7BHML%7D_t%2B%5Cvarepsilon_%7Bi%2Ct%7D&quot; alt=&quot;r_{i,t}=\alpha_i+\beta_{1,i}\mbox{RMRF}_t+\beta_{2,i}\mbox{SMB}_t+\beta_{3,i}\mbox{HML}_t+\varepsilon_{i,t}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;上式中，&lt;img src=&quot;https://www.zhihu.com/equation?tex=r_%7Bi%2C+t%7D&quot; alt=&quot;r_{i, t}&quot; eeimg=&quot;1&quot;/&gt; 为股票 i 在第 t 月相对无风险利率的超额收益，&lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B1_i&quot; alt=&quot;α_i&quot; eeimg=&quot;1&quot;/&gt; 表示三因子模型无法解释的 abnormal return，&lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B5_%7Bi%2C+t%7D&quot; alt=&quot;ε_{i, t}&quot; eeimg=&quot;1&quot;/&gt; 表示残差。在每个 T 月初，Blitz, Huij, and Martens (2011) 构建残差动量的方法包括以下几步：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;使用&lt;b&gt;过去 36 个月&lt;/b&gt;的收益率数据进行上述时序回归，得到参数估计和残差 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B5_%7Bi%2C+t%7D&quot; alt=&quot;ε_{i, t}&quot; eeimg=&quot;1&quot;/&gt; 序列；&lt;/li&gt;&lt;li&gt;在上述回归得到的 36 的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B5_%7Bi%2C+t%7D&quot; alt=&quot;ε_{i, t}&quot; eeimg=&quot;1&quot;/&gt; 中，&lt;b&gt;仅使用 T – 12 到 T – 2&lt;/b&gt; 这 11 个月的残差项 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B5_%7Bi%2C+t%7D&quot; alt=&quot;ε_{i, t}&quot; eeimg=&quot;1&quot;/&gt; ，计算这些残差项的收益率之和；之所以舍弃最近一个月，即 T – 1 月的收益率，是类比常规动量策略对最近一个月短期反转的规避；&lt;/li&gt;&lt;li&gt;同样的，使用 T – 12 到 T – 2 的这 11 个残差项  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B5_%7Bi%2C+t%7D&quot; alt=&quot;ε_{i, t}&quot; eeimg=&quot;1&quot;/&gt; ，计算它们的标准差（也就是常说的残差波动率）；将第二项的&lt;b&gt;残差总收益率除以残差波动率进行标准化&lt;/b&gt;，就得到了最终标准化后的残差动量；通过做多残差动量最高的 10% 并同时做空残差动量最低的 10% 就构建了残差动量因子组合。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;有意思的是，Blitz, Huij, and Martens (2011) 一文仅是使用文字描述了残差动量的计算方法，但并没有给出任何一目了然的公式。不过最近的 Blitz, Hanauer, and Vidojevic (2018) 一文给出了明确的公式：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bresidual+mom%7D_%7Bi%2Ct%7D%3D%5Cdisplaystyle%5Cfrac%7B%5Csum_%7BT-12%7D%5E%7BT-2%7D%5Cvarepsilon_%7Bi%2Ct%7D%7D%7B%5Csqrt%7B%5Csum_%7BT-12%7D%5E%7BT-2%7D%28%5Cvarepsilon_%7Bi%2Ct%7D-%5Cbar%5Cvarepsilon_%7Bi%7D%29%5E2%7D%7D&quot; alt=&quot;\mbox{residual mom}_{i,t}=\displaystyle\frac{\sum_{T-12}^{T-2}\varepsilon_{i,t}}{\sqrt{\sum_{T-12}^{T-2}(\varepsilon_{i,t}-\bar\varepsilon_{i})^2}}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;值得一提的是，该公式的分母中，根号内的部分较常见的方差公式差 1/11 这个系数。但由于它不改变残差动量排名的单调性，因此上式等价于残差总收益被残差波动率进行标准化。搞事情小组就计算残差动量的三个步骤有以下四点疑问。&lt;/p&gt;&lt;p&gt;首先，在时序回归时，Blitz, Huij, and Martens (2011) 考虑了截距项 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B1_i&quot; alt=&quot;α_i&quot; eeimg=&quot;1&quot;/&gt; ，但是并没有把它作为异质动量的一部分。如果仅从“残差”动量这个名字来看，似乎使用回归方程的残差计算无可厚非；但如果抛开新的动量因子叫什么， &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B1_i&quot; alt=&quot;α_i&quot; eeimg=&quot;1&quot;/&gt; 毫无疑问属于收益率中无法被三因子模型解释的部分。Blitz, Huij, and Martens (2011) 给出的理由是， &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B1_i&quot; alt=&quot;α_i&quot; eeimg=&quot;1&quot;/&gt; 的作用是控制模型设定偏误，这个解释似乎是合理的。&lt;/p&gt;&lt;p&gt;其次，在 Blitz, Huij, and Martens (2011) 的方法中，用来计算每个 T 时刻残差动量的残差来自同一个时序回归：使用 36 期月频收益率回归，但只选择了 T – 12 到 T – 2 这 11 个点计算非标准化之前的残差动量。从 OLS 回归隐含的假设来说，残差时间序列应该满足平稳性，且由于回归中考虑了截距项，因此这 36 个残差项的均值严格等于零。因此，从数学上说这 36 个残差项是一个均值为零的平稳序列，而 T – 12 到 T – 2 中间的 11 个点仅仅是这个平稳序列中的一部分。&lt;b&gt;无论这部分的均值是否大于零，它的大小为什么会和该股票未来收益率正相关，而非仅仅是个随机扰动呢（它们仅是一个均值为零的平稳序列中的一部分）？此外，为什么不同股票中，不同平稳残差序列在同一段时期的残差和大小能够预示它们未来预期收益率的差异呢？&lt;/b&gt;Blitz, Huij, and Martens (2011) 一文对这些问题并未给出太多的讨论。&lt;/p&gt;&lt;p&gt;从上面的说明中可以引出第三点疑问。如前所述，Blitz, Huij, and Martens (2011) 在每个月初 T 使用最近 36 个月进行一次回归得到 36 个残差，并使用其中的 11 个计算残差动量，因此这 11 个残差来自同一个回归（如下图）。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-29a561943dbfb3717b4e132adf4fddbe_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;663&quot; data-rawheight=&quot;181&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;663&quot; data-original=&quot;https://pic3.zhimg.com/v2-29a561943dbfb3717b4e132adf4fddbe_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-29a561943dbfb3717b4e132adf4fddbe_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;663&quot; data-rawheight=&quot;181&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;663&quot; data-original=&quot;https://pic3.zhimg.com/v2-29a561943dbfb3717b4e132adf4fddbe_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-29a561943dbfb3717b4e132adf4fddbe_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;与上述方法相对应的，可以考虑计算残差动量的残差来自 11 个不同的回归。比如，对于 T 期，使用 T – 37 到 T – 2 这 36 个月的数据回归，并仅记录 T – 2 的残差，记为 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B5_%7Bi%2C+T-2%7D%5E%7B%281%29%7D&quot; alt=&quot;ε_{i, T-2}^{(1)}&quot; eeimg=&quot;1&quot;/&gt; ，上标 (1) 代表第 1 次回归；然后使用 T – 38 到 T – 3 这 36 个月的数据回归，并仅记录 T – 3 的残差 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B5_%7Bi%2C+T-3%7D%5E%7B%282%29%7D&quot; alt=&quot;ε_{i, T-3}^{(2)}&quot; eeimg=&quot;1&quot;/&gt; ；以此类推，最终使用 T – 47 到 T – 12 这 36 个月的数据回归，并仅记录 T – 12 的残差 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B5_%7Bi%2C+T-12%7D%5E%7B%2811%29%7D&quot; alt=&quot;ε_{i, T-12}^{(11)}&quot; eeimg=&quot;1&quot;/&gt; 。使用上述来自 11 个回归的残差计算残差收益率。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-9f5b310b7d1b6b204913ab629713be28_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;895&quot; data-rawheight=&quot;253&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;895&quot; data-original=&quot;https://pic1.zhimg.com/v2-9f5b310b7d1b6b204913ab629713be28_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-9f5b310b7d1b6b204913ab629713be28_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;895&quot; data-rawheight=&quot;253&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;895&quot; data-original=&quot;https://pic1.zhimg.com/v2-9f5b310b7d1b6b204913ab629713be28_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-9f5b310b7d1b6b204913ab629713be28_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;虽然第二种方法听上去有些怪怪的，也不如 Blitz, Huij, and Martens (2011) 的方法易于理解，但学术界对它也有一定的研究。比如 Gutierrez and Prinsky (2007) 就使用这种方法研究了异质动量。因此，单一回归和多个回归计算残差动量有什么区别就是我们的第三个疑问。本文的实证中将会考虑这两种方法。&lt;/p&gt;&lt;p&gt;最后一点疑问是在计算残差动量时，是否有必要使用残差标准差作为分母，对残差动量进行标准化。对于这个操作，Blitz, Huij, and Martens (2011) 引用 Gutierrez and Prinsky (2007) 的研究指出上述标准化可以降低残差的噪声，得到更加纯净的异质动量，提高残差动量的效果。Blitz, Hanauer, and Vidojevic (2018) 的后续研究强调说无论是否标准化，残差动量本身都可以获得显著的超额收益率。&lt;/p&gt;&lt;p&gt;关于这一点，搞事情小组关注的重点是这波操作在 A 股上是否会“夸大”残差动量的效果。上述标准化将残差标准差作为分母，这意味着当分子上的残差动量相同的情况下，标准化可以起到高配低异质波动、低配高异质波动的情况。搞事情小组之前的研究&lt;a href=&quot;https://zhuanlan.zhihu.com/p/80443596&quot; class=&quot;internal&quot;&gt;《异质波动率之谜》&lt;/a&gt;指出，低异质波动率现象确实存在于 A 股市场，说明如此标准化肯定有助于加强残差动量。因此，如果按照 Blitz, Huij, and Martens (2011) 的方法计算的残差动量在 A 股上有效，那么它到底因为分子的部分、分母的部分、还是两部分均有贡献？这就成为必须回答的问题。在接下来的实证中也将会把这两部分拆开来看。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;3 实证&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;本节和下一节针对 A 股进行实证分析。本节的重点是比较单一回归（Blitz, Huij, and Martens 2011 的方法）和多次回归计算残差动量这两种方法。下一节将会把残差波动率的影响剥离开分析。&lt;/p&gt;&lt;p&gt;在以下的分析中，实证期为 1999 年 1 月 1 日至 2019 年 9 月 30 日；在每月末构建投资组合的时候剔除掉次新股、停牌股、风险警示股、一字涨跌停股；同时考虑等权和市值加权两种情况。在计算残差收益率时，采用搞事情小组维护的以月频进行再平衡灵活版 Fama and French (1993) 三因子模型。&lt;/p&gt;&lt;p&gt;首先来看按照 Blitz, Huij, and Martens (2011) 的方法计算残差动量的结果；结果以 portfolio test result 的方式呈现。下图 1 — 3 显示了这 10 组（第 0 组为残差动量最低；第 9 组为残差动量最高组）以及残差动量因子（即第 9 组减去第 0 组）的累积收益率和风险收益特征，其中 Panel A 为等权、Panel B 为市值加权。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-3953be4c4fc33863d3a59a64fac89145_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;871&quot; data-rawheight=&quot;647&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;871&quot; data-original=&quot;https://pic2.zhimg.com/v2-3953be4c4fc33863d3a59a64fac89145_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-3953be4c4fc33863d3a59a64fac89145_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;871&quot; data-rawheight=&quot;647&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;871&quot; data-original=&quot;https://pic2.zhimg.com/v2-3953be4c4fc33863d3a59a64fac89145_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-3953be4c4fc33863d3a59a64fac89145_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-a820b8e42eaa5fabd4fc82da34ccb5c5_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;878&quot; data-rawheight=&quot;677&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;878&quot; data-original=&quot;https://pic2.zhimg.com/v2-a820b8e42eaa5fabd4fc82da34ccb5c5_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-a820b8e42eaa5fabd4fc82da34ccb5c5_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;878&quot; data-rawheight=&quot;677&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;878&quot; data-original=&quot;https://pic2.zhimg.com/v2-a820b8e42eaa5fabd4fc82da34ccb5c5_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-a820b8e42eaa5fabd4fc82da34ccb5c5_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-f4bd846559839ed665df44d5e11610e7_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;985&quot; data-rawheight=&quot;473&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;985&quot; data-original=&quot;https://pic4.zhimg.com/v2-f4bd846559839ed665df44d5e11610e7_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-f4bd846559839ed665df44d5e11610e7_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;985&quot; data-rawheight=&quot;473&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;985&quot; data-original=&quot;https://pic4.zhimg.com/v2-f4bd846559839ed665df44d5e11610e7_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-f4bd846559839ed665df44d5e11610e7_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;上述结果显示，&lt;b&gt;无论是等权还是市值加权，在 A 股上均可以观察到显著的残差动量效应&lt;/b&gt;（虽然本文的实证结果并没有 Lin 2019 中的惊艳，该文仅考虑了等权的情况）。在等权下，残差动量因子的夏普率高达 0.78，其最大回撤为 -25.35%，有效抵御了 momentum crash 风险。当采用市值加权时，残差动量效果有所减弱，但依然显著。这样的结果和传统截面动量因子在 A 股上的效果截然不同。&lt;/p&gt;&lt;p&gt;当然，面对这样的结果，我们仍然不知道到底是作为分母的残差波动率贡献了多少，该问题将在第四节研究。下面再来看看第二种方法，即采用 11 个回归计算残差收益率、再计算残差动量的结果。下图 4 — 6 显示了相应的 portfolio sort test 结果。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-9cb250b77a030880680aa1f64c37a35e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;891&quot; data-rawheight=&quot;651&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;891&quot; data-original=&quot;https://pic3.zhimg.com/v2-9cb250b77a030880680aa1f64c37a35e_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-9cb250b77a030880680aa1f64c37a35e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;891&quot; data-rawheight=&quot;651&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;891&quot; data-original=&quot;https://pic3.zhimg.com/v2-9cb250b77a030880680aa1f64c37a35e_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-9cb250b77a030880680aa1f64c37a35e_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-b71ad539879548c2d04a0efda480e406_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;873&quot; data-rawheight=&quot;673&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;873&quot; data-original=&quot;https://pic3.zhimg.com/v2-b71ad539879548c2d04a0efda480e406_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-b71ad539879548c2d04a0efda480e406_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;873&quot; data-rawheight=&quot;673&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;873&quot; data-original=&quot;https://pic3.zhimg.com/v2-b71ad539879548c2d04a0efda480e406_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-b71ad539879548c2d04a0efda480e406_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-257dec3f6702cb5a8dbec2bbc57a74df_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;982&quot; data-rawheight=&quot;472&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;982&quot; data-original=&quot;https://pic4.zhimg.com/v2-257dec3f6702cb5a8dbec2bbc57a74df_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-257dec3f6702cb5a8dbec2bbc57a74df_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;982&quot; data-rawheight=&quot;472&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;982&quot; data-original=&quot;https://pic4.zhimg.com/v2-257dec3f6702cb5a8dbec2bbc57a74df_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-257dec3f6702cb5a8dbec2bbc57a74df_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;当采用 11 个不同的回归时，残差动量的效果较前一种方法变差。无论是等权还是市值加权，残差动量因子在 2007 到 2009 年间都经历了长时间且大幅度的回撤。除此之外，这十个 portfolios 的单调性也变差。我们对此的猜想是，使用 11 个不同的回归计算残差收益率这种方法额外引入了不必要的不对称性，即不同时期的残差来自不同的分布。由于残差动量的计算高度依赖参数估计的准确性，长期来看这种方法的不稳定性更高。&lt;/p&gt;&lt;p&gt;需要强调的是，虽然第二种方法不如 Blitz, Huij, and Martens (2011) 的方法，但这种结果上的差异仍然没有回答上一节关于残差动量计算方法的两个问题：（1）为什么均值为零的平稳序列中的一部分和未来收益率正相关；（2）为什么这部分残差能够解释预期收益率的截面差异。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;4 进一步实证&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;第三节的实证结果显示经标准化后的残差动量在 A 股是有效的。本小节的实证就来回答第二个问题：残差波动率在这方面是否起到了显著的作用？&lt;/p&gt;&lt;p&gt;为了控制残差波动率（即作为分母的残差标准差）的影响，本文采用 double dependent sort 进行分析。首先按照残差波动率（记为 ivol）从低到高把所有股票分成五组，然后再把每组内的股票按照原始残差动量（记为 imom）高低分成五组。这样一共得到 25 个投资组合，以考察每个 ivol 组内原始残差动量是否能够解释股票的预期收益率差异。图 7、8 分别显示了等权和市值加权下，这 25 个投资组合的年化收益率。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-71317d4658806a0aef8b8967a1e4378f_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;792&quot; data-rawheight=&quot;722&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;792&quot; data-original=&quot;https://pic4.zhimg.com/v2-71317d4658806a0aef8b8967a1e4378f_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-71317d4658806a0aef8b8967a1e4378f_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;792&quot; data-rawheight=&quot;722&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;792&quot; data-original=&quot;https://pic4.zhimg.com/v2-71317d4658806a0aef8b8967a1e4378f_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-71317d4658806a0aef8b8967a1e4378f_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-b7a69cd3c8f77ab8b066894e2572beed_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;800&quot; data-rawheight=&quot;713&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;800&quot; data-original=&quot;https://pic2.zhimg.com/v2-b7a69cd3c8f77ab8b066894e2572beed_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-b7a69cd3c8f77ab8b066894e2572beed_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;800&quot; data-rawheight=&quot;713&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;800&quot; data-original=&quot;https://pic2.zhimg.com/v2-b7a69cd3c8f77ab8b066894e2572beed_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-b7a69cd3c8f77ab8b066894e2572beed_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;从图 7、8 的结果中可以观察到以下几点：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;在控制了 ivol 之后，每组内的 imom 基本上依然单调，呈现高 imom 比低 imom 组的预期收益率更高的现象，说明原始残差动量就是有效的。&lt;/li&gt;&lt;li&gt;在低 ivol 组内，各 imom 组的收益率比其在高 ivol 组内的对应的 imom 组的收益率更高。&lt;/li&gt;&lt;li&gt;从头（imom4）尾（imom0）两组的区分度来说，&lt;b&gt;imom4 – imom0 的收益率在五个 ivol 组内呈现出倒 U 形&lt;/b&gt;，意味着无论是低波动组还是高波动组，imom 对于截面预期收益率差异的解释都不如在中等 ivol 组内更好。我们对此的猜想是，在高波动组中噪音更高，且 OLS 回归系数的标准误和残差标准差成正比，因此参数估计的误差也更高，这些都对准确计算残差动量有影响；而在低波动组中，残差所代表的和定价有关的信息可能已经反映在了其他风格因子上，从而降低了它的解释能力。&lt;/li&gt;&lt;li&gt;无论是等权还是市值加权，均能观察到上述几点；市值加权较等权的平均收益更低。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;经过以上的分析，我们可以说基于 Blitz, Huij, and Martens (2011) 定义的残差动量在 A 股有效，并非依靠了低异质波动率的原因，作为分子的原始残差动量在没有被标准化的情况下依然能获得显著的超额收益。事实上，作为 robustness check，我们也仅使用原始残差动量（即未经残差波动率标准化）构建了残差动量因子，实证结果显示它在 A 股上的效果甚至超过了经标准化的版本（等权时，未经标准化的残差动量因子夏普率为 .82，高于经标准化后的 .78；市值加权时，前者的夏普率为 .59，高于后者的 .58）。&lt;/p&gt;&lt;p&gt;这样的结果似乎足以令人兴奋了。但是，我们还想抛出一个问号，并以此总结全文。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;5 结语：问题比发现更多&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;毫无疑问，残差动量 —— 无论其背后的“故事”是什么 —— 其有效的必要条件是有一个靠谱的定价模型。虽然美股上已经有很多主流的多因子模型，但是针对 A 股却并没有广泛被认可的定价模型。这让任何研究残差收益率的实证结果都面临挑战。&lt;/p&gt;&lt;p&gt;在计算残差动量的时候，Blitz, Huij, and Martens (2011) 以控制模型设定偏误为由舍去了回归中的  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B1_i&quot; alt=&quot;α_i&quot; eeimg=&quot;1&quot;/&gt; 。面对这种处理，我们仍然很好奇，如果带上 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B1_i&quot; alt=&quot;α_i&quot; eeimg=&quot;1&quot;/&gt; 又会怎样？从 A 股上的实证结果来看，&lt;b&gt;带上 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B1_i&quot; alt=&quot;α_i&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 之后，残差动量翻车了……&lt;/b&gt;&lt;/p&gt;&lt;p&gt;仍然以 Blitz, Huij, and Martens (2011) 的方法获得残差收益率，在计算残差动量时，使用 T – 12 到 T – 2 期之间的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B1_i&quot; alt=&quot;α_i&quot; eeimg=&quot;1&quot;/&gt; 和残差总收益之和作为分子：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bresidual+mom%7D_%7Bi%2Ct%7D%5E%5Cprime%3D%5Cdisplaystyle%5Cfrac%7B11%5Calpha_i%2B%5Csum_%7BT-12%7D%5E%7BT-2%7D%5Cvarepsilon_%7Bi%2Ct%7D%7D%7B%5Csqrt%7B%5Csum_%7BT-12%7D%5E%7BT-2%7D%28%5Cvarepsilon_%7Bi%2Ct%7D-%5Cbar%5Cvarepsilon_%7Bi%7D%29%5E2%7D%7D&quot; alt=&quot;\mbox{residual mom}_{i,t}^\prime=\displaystyle\frac{11\alpha_i+\sum_{T-12}^{T-2}\varepsilon_{i,t}}{\sqrt{\sum_{T-12}^{T-2}(\varepsilon_{i,t}-\bar\varepsilon_{i})^2}}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;以等权为例，在上述定义下，残差动量变成了残差反转（图 9）。除此之外，我们也尝试了在时序回归计算残差收益率时不加入截距项，也得到了残差反转的结果。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-ee9ffbdc9ed4de6ba2e0563a49b906ec_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;987&quot; data-rawheight=&quot;591&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;987&quot; data-original=&quot;https://pic1.zhimg.com/v2-ee9ffbdc9ed4de6ba2e0563a49b906ec_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-ee9ffbdc9ed4de6ba2e0563a49b906ec_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;987&quot; data-rawheight=&quot;591&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;987&quot; data-original=&quot;https://pic1.zhimg.com/v2-ee9ffbdc9ed4de6ba2e0563a49b906ec_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-ee9ffbdc9ed4de6ba2e0563a49b906ec_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;作为开放性的问题，本文并不试图对上述看起来十分矛盾的结果进行更深入的讨论。只是希望通过它们说明，&lt;b&gt;在使用残差收益率构建因子的时候，模型怎么设定、参数如何估计都会直接影响因子的计算，且有时甚至产生完全相反的效果，因此必须要搞清楚每一步的原因是什么，以免陷入数据挖掘。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;前文&lt;a href=&quot;https://zhuanlan.zhihu.com/p/40468929&quot; class=&quot;internal&quot;&gt;《给你的动量策略加点“料”》&lt;/a&gt;曾指出，传统动量策略之所以有效和人们的有限注意力（limited attention）有关，并以此作为一个维度改进了传统动量。由于大脑中的资源有限，一系列频繁但微小的变化对于人的吸引力远不如少数却显著的变化；因此投资者对于连续信息造成的股价变化反应不足。随着时间的推移，这些信息缓慢的被吸收并反映到价格中，从而导致了动量。而对于残差动量，Blitz, Huij, and Martens (2011) 认为也可以从 gradual-information-diffusion 假说解释：信息在投资者之间的扩散是缓慢的，而且相比于影响所有公司的公共事件，投资者对于那些针对公司的特定事件的反应则更加迟缓，这就形成了残差动量。&lt;/p&gt;&lt;p&gt;从投资者的反应不足来解释动量和残差动量似乎是站的住脚的。&lt;b&gt;而对于美股市场，动量和残差动量双双有效，且残差动量的效果优于传统动量这个结果也是可以支持上述假说的。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;但是 A 股……&lt;b&gt;在动量如此不好使的前提下，仅仅使用了一个同样对于 A 股也不那么完美的定价模型计算出残差，就得到了如此好使的残差动量。&lt;/b&gt;这背后的原因恐怕比残差动量这个简单的公式要复杂得多。&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;参考文献&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Blitz, D., M. X. Hanauer, and M. Vidojevic (2018). The idiosyncratic momentum anomaly. SSRN 2947044.&lt;/li&gt;&lt;li&gt;Blitz, D., M. X. Hanauer, M. Vidojevic, and P. van Vliet (2018). Five concerns with the five-factor model. &lt;i&gt;The Journal of Portfolio Management&lt;/i&gt;, Vol. 44(4), 71 – 78.&lt;/li&gt;&lt;li&gt;Blitz, D., J. Huij, and M. Martens (2011). Residual momentum. &lt;i&gt;Journal of Empirical Finance&lt;/i&gt;, Vol. 18(3), 506 – 521.&lt;/li&gt;&lt;li&gt;Daniel, K. and T. J. Moskowitz (2016). Momentum crashes. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 122(2), 221 – 247.&lt;/li&gt;&lt;li&gt;Fama, E. F. and K. R. French (1993). Common risk factors in the returns on stocks and bonds. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 33(1), 3 – 56.&lt;/li&gt;&lt;li&gt;Fama, E. F. and K. R. French (2015). A five-factor asset pricing model. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 116(1), 1 – 22.&lt;/li&gt;&lt;li&gt;Geczy, C. and M. Samonov (2016). Two centuries of price-return momentum. &lt;i&gt;Financial Analysts Journal&lt;/i&gt;, Vol. 72(5), 32 – 56.&lt;/li&gt;&lt;li&gt;Gutierrez, R. C. and C. A. Prinsky (2007). Momentum, reversal, and the trading behaviors of institutions. &lt;i&gt;Journal of Financial Markets&lt;/i&gt;, Vol. 10(1), 48 – 75.&lt;/li&gt;&lt;li&gt;Hanauer, M. X. and S. Windmueller (2019). Enhanced momentum strategies. SSRN 2427919.&lt;/li&gt;&lt;li&gt;Jegadeesh, N. and S. Titman (1993). Returns to Buying Winners and Selling Losers: Implications for Stock Market Efficiency. &lt;i&gt;Journal of Finance&lt;/i&gt;, Vol. 48(1), 65 – 91.&lt;/li&gt;&lt;li&gt;Lin, Q. (2019). Residual momentum and the cross-section of stock returns: Chinese evidence. &lt;i&gt;Finance Research Letters&lt;/i&gt;, Vol. 29, 206 – 215.&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;免责声明：&lt;/b&gt;文章内容不可视为投资意见。市场有风险，入市需谨慎。&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处。已委托“维权骑士”(&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//rightknights.com&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;维权骑士_免费版权监测/版权保护/内容多平台分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2019-12-04-95259084</guid>
<pubDate>Wed, 04 Dec 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>Generalized Method of Moments</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2019-11-21-92490417.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/92490417&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-99130ac172d0b32f0107c8fc68b18872_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;摘要&lt;/b&gt;&lt;/p&gt;&lt;p&gt;GMM 是研究 asset pricing 时绕不过的工具。本文介绍 GMM 框架的强大之处，并阐述其背后的数学之美。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;01 引言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;好了，来写写 &lt;b&gt;GMM（Generalized Method of Moments，广义矩估计）&lt;/b&gt;吧，站在 asset pricing 的视角。&lt;/p&gt;&lt;p&gt;前文&lt;a href=&quot;https://zhuanlan.zhihu.com/p/88458489&quot; class=&quot;internal&quot;&gt;《理解资产价格》&lt;/a&gt;已经提到，Hansen (1982) 提出的 GMM 在 empirical asset pricing 研究的历史上起到了举足轻重的作用，而如今无论是在经济学领域还是金融学领域，GMM 因其数学上的优雅和特性上的强大都被广泛的运用。&lt;/p&gt;&lt;p&gt;今天这篇文章算是我自己关于 GMM 的一个学习笔记，而我的学习资料（公众号的老朋友一定猜到了）正是 John Cochrane 教授的神书 Asset Pricing（Cochrane 2005）以及他在 UChicago 时做的 Online 课程中对 GMM 的介绍。Cochrane 教授讲的实在是太清楚、到位了，本文是我做对他所讲的内容的消化、梳理和再串联。&lt;/p&gt;&lt;p&gt;&lt;b&gt;本文的目标是试图从 intuition 出发揭示 GMM 蕴含数学之美；试图把公式掰开揉碎讲清楚从而帮助感兴趣的朋友理解大公式背后的本质。&lt;/b&gt;我会力争在行文中做到非常准确，在 population 和 sample 之间腾挪、把 variance 和 test statistic 都说清楚。Cochrane 教授说，学习 GMM 时最大的障碍就是它的 notation（数学符号）繁多；只要搞清楚 notation，其实 GMM 背后的数学精髓是非常简单的，因为 GMM 的核心最终能够归结为计算 the variance of the sample mean。希望本文能够带给你这种恍然大悟之感。&lt;/p&gt;&lt;p&gt;先来剧透一下，本文希望传达以下三方面内容：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;GMM 的框架包括 model、estimate 以及 test 三部分；&lt;/li&gt;&lt;li&gt;学习 GMM 时，最大的障碍往往来自 notation；搞清楚 notation 后，GMM 背后的数学非常容易理解；&lt;/li&gt;&lt;li&gt;GMM 不应被当作计量学的黑箱。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;b&gt;以我一贯的风格，行文中会“死磕”数学公式，因此这注定是一篇十分 technical 的文章。&lt;/b&gt;本文的技术性远超&lt;a href=&quot;https://zhuanlan.zhihu.com/p/40984029&quot; class=&quot;internal&quot;&gt;《股票多因子模型的回归检验》&lt;/a&gt;，因此同样建议在一个能静下心来思考的心境下和环境中阅读。对于不关心数学、仅想快速了解 GMM 是什么的读者来说，我强烈推荐&lt;a href=&quot;https://www.zhihu.com/question/41312883/answer/91484566?utm_source=wechat_session&amp;amp;utm_medium=social&amp;amp;utm_oi=728969207022125056&amp;amp;from=singlemessage&amp;amp;isappinstalled=0&quot; class=&quot;internal&quot;&gt;慧航大神关于 GMM 的回答&lt;/a&gt;。那篇回答对读者非常友好，涉及到的数学恰到好处，深入浅出的介绍了 GMM 的原理。&lt;/p&gt;&lt;p&gt;如果本文能对你理解 GMM 起到一点帮助，那完全是 Cochrane 教授的功劳；如果你看完后依然困惑，那一定也必须是怪我没写好……&lt;/p&gt;&lt;p&gt;Cochrane 教授说 GMM 的核心最终能够归结为计算 the variance of the sample mean；让我们就从 the variance of the sample mean 说起。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;02 Variance of the Sample Mean&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;考虑某随机变量  &lt;img src=&quot;https://www.zhihu.com/equation?tex=u_t&quot; alt=&quot;u_t&quot; eeimg=&quot;1&quot;/&gt; 。假设它在某个样本内的取值为 0，-1，3，3，-3。我们可以很容易的算出样本均值：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Cbar+u+%3D+%5Cmbox%7BE%7D_T%5Bu_t%5D%3D0.4&quot; alt=&quot;\displaystyle\bar u = \mbox{E}_T[u_t]=0.4&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;上式中， &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D_T+%3D+%281%2FT%29%5Csum%28.%29&quot; alt=&quot;\mbox{E}_T = (1/T)\sum(.)&quot; eeimg=&quot;1&quot;/&gt; 表示对样本数据求平均， &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbar+u&quot; alt=&quot;\bar u&quot; eeimg=&quot;1&quot;/&gt; 表示 &lt;img src=&quot;https://www.zhihu.com/equation?tex=u_t&quot; alt=&quot;u_t&quot; eeimg=&quot;1&quot;/&gt; 的样本均值。由于 &lt;img src=&quot;https://www.zhihu.com/equation?tex=u_t&quot; alt=&quot;u_t&quot; eeimg=&quot;1&quot;/&gt; 是一个随机变量，因此其&lt;b&gt;样本均值  &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbar+u_t&quot; alt=&quot;\bar u_t&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;本身也是一个随机变量&lt;/b&gt;。虽然它在我们这个样本中的取值为 0.4，但如果我们能够乘坐时光机回到过去“重写历史”，得到不同的样本，那么在不同样本中，样本均值的取值也会有所变化。比如在下面这个表中，假设除样本一（就是上面这个样本）之外，还有三个样本，而它们的样本均值 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbar+u&quot; alt=&quot;\bar u&quot; eeimg=&quot;1&quot;/&gt; 的取值分别为 -0.8，0.6 和 1.6。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-2d988b6aebb6c5ba1c5a23ccb4d1ad54_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;713&quot; data-rawheight=&quot;317&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;713&quot; data-original=&quot;https://pic1.zhimg.com/v2-2d988b6aebb6c5ba1c5a23ccb4d1ad54_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-2d988b6aebb6c5ba1c5a23ccb4d1ad54_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;713&quot; data-rawheight=&quot;317&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;713&quot; data-original=&quot;https://pic1.zhimg.com/v2-2d988b6aebb6c5ba1c5a23ccb4d1ad54_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-2d988b6aebb6c5ba1c5a23ccb4d1ad54_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;既然样本均值本身也是一个随机变量，那么一个很自然的问题就是样本均值在不同的样本中是如何变化的，即 variance of the sample mean。从 variance 的定义出发可得：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Cmbox%7Bvar%7D%28%5Cbar+u%29%3D%5Cmbox%7Bvar%7D%5Cleft%28%5Cfrac%7B1%7D%7BT%7D%5Csum_%7Bt%3D1%7D%5ET+u_t%5Cright%29%3D%5Cfrac%7B1%7D%7BT%5E2%7D%5Cmbox%7Bvar%7D%5Cleft%28%5Csum_%7Bt%3D1%7D%5ET+u_t%5Cright%29&quot; alt=&quot;\displaystyle\mbox{var}(\bar u)=\mbox{var}\left(\frac{1}{T}\sum_{t=1}^T u_t\right)=\frac{1}{T^2}\mbox{var}\left(\sum_{t=1}^T u_t\right)&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;在最简单的情况中，假设 &lt;img src=&quot;https://www.zhihu.com/equation?tex=u_t&quot; alt=&quot;u_t&quot; eeimg=&quot;1&quot;/&gt; 序列满足 i.i.d.，则上式可以简化成：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Cmbox%7Bvar%7D%28%5Cbar+u%29%3D%5Cfrac%7B1%7D%7BT%5E2%7D%5Cmbox%7Bvar%7D%5Cleft%28%5Csum_%7Bt%3D1%7D%5ET+u_t%5Cright%29%3D%5Cfrac%7B%5Csigma%5E2%28u_t%29%7D%7BT%7D&quot; alt=&quot;\displaystyle\mbox{var}(\bar u)=\frac{1}{T^2}\mbox{var}\left(\sum_{t=1}^T u_t\right)=\frac{\sigma^2(u_t)}{T}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;把两边开方就得到样本均值的 standard error：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Cmbox%7Bs.e.%7D%28%5Cbar+u%29%3D%5Cfrac%7B%5Csigma%28u_t%29%7D%7B%5Csqrt%7BT%7D%7D&quot; alt=&quot;\displaystyle\mbox{s.e.}(\bar u)=\frac{\sigma(u_t)}{\sqrt{T}}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;这大概是我们在统计课中学到的印象最深的一个式子（假设 &lt;img src=&quot;https://www.zhihu.com/equation?tex=u_t&quot; alt=&quot;u_t&quot; eeimg=&quot;1&quot;/&gt; 满足 i.i.d. 条件下样本均值的 standard error）。在更一般的情况中 —— 尤其是在金融数据（比如收益率）数据中 ——  &lt;img src=&quot;https://www.zhihu.com/equation?tex=u_t&quot; alt=&quot;u_t&quot; eeimg=&quot;1&quot;/&gt;  序列是前后是有非零的自相关的，即 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bcov%7D%28u_t%2C+u_%7Bt-j%7D%29+%E2%89%A0+0&quot; alt=&quot;\mbox{cov}(u_t, u_{t-j}) ≠ 0&quot; eeimg=&quot;1&quot;/&gt; ，因此需要得到更一般下样本均值  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbar+u&quot; alt=&quot;\bar u&quot; eeimg=&quot;1&quot;/&gt;  的 variance：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Cmbox%7Bvar%7D%28%5Cbar+u%29%3D%5Cfrac%7B1%7D%7BT%7D%5Cleft%5B%5Cmbox%7Bvar%7D%28u_t%29%2B%5Csum_%7Bj%3D1%7D%5ET%5Cfrac%7BT-j%7D%7BT%7D%5Cleft%28%5Cmbox%7Bcov%7D%28u_t%2C+u_%7Bt-j%7D%29%2B%5Cmbox%7Bcov%7D%28u_t%2C+u_%7Bt%2Bj%7D%29%5Cright%29%5Cright%5D&quot; alt=&quot;\displaystyle\mbox{var}(\bar u)=\frac{1}{T}\left[\mbox{var}(u_t)+\sum_{j=1}^T\frac{T-j}{T}\left(\mbox{cov}(u_t, u_{t-j})+\mbox{cov}(u_t, u_{t+j})\right)\right]&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;当  &lt;img src=&quot;https://www.zhihu.com/equation?tex=T&quot; alt=&quot;T&quot; eeimg=&quot;1&quot;/&gt;  趋于无穷大时（即 sample size 越来越大）， &lt;img src=&quot;https://www.zhihu.com/equation?tex=%28T+%E2%80%93+j%29%2FT&quot; alt=&quot;(T – j)/T&quot; eeimg=&quot;1&quot;/&gt; 趋于 1，就可以求出 &lt;img src=&quot;https://www.zhihu.com/equation?tex=var%28%5Cbar+u%29&quot; alt=&quot;var(\bar u)&quot; eeimg=&quot;1&quot;/&gt; 的渐进（asymptotic）形式：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Cmbox%7Bvar%7D%28%5Cbar+u%29%5Crightarrow%5Cfrac%7B1%7D%7BT%7D%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D%5Cmbox%7Bvar%7D%28u_t%2C+u_%7Bt-j%7D%29&quot; alt=&quot;\displaystyle\mbox{var}(\bar u)\rightarrow\frac{1}{T}\sum_{j=-\infty}^{\infty}\mbox{var}(u_t, u_{t-j})&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;下面再假设一个特殊的情况，即随机变量 &lt;img src=&quot;https://www.zhihu.com/equation?tex=u_t&quot; alt=&quot;u_t&quot; eeimg=&quot;1&quot;/&gt; 的&lt;b&gt;总体均值&lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D%5Bu_t%5D+%3D+0&quot; alt=&quot;\mbox{E}[u_t] = 0&quot; eeimg=&quot;1&quot;/&gt; ，并利用方差的定义  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28X%2C+Y%29+%3D+%5Cmbox%7BE%7D%5BXY%5D+%E2%80%93+%5Cmbox%7BE%7D%5BX%5D%5Cmbox%7BE%7D%5BY%5D&quot; alt=&quot;\mbox{var}(X, Y) = \mbox{E}[XY] – \mbox{E}[X]\mbox{E}[Y]&quot; eeimg=&quot;1&quot;/&gt;  可得：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Cmbox%7Bvar%7D%28%5Cbar+u%29%5Crightarrow%5Cfrac%7B1%7D%7BT%7D%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D%5Cmbox%7BE%7D%5Bu_tu_%7Bt-j%7D%5D%3D%5Cfrac%7B1%7D%7BT%7DS&quot; alt=&quot;\displaystyle\mbox{var}(\bar u)\rightarrow\frac{1}{T}\sum_{j=-\infty}^{\infty}\mbox{E}[u_tu_{t-j}]=\frac{1}{T}S&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;上式最后一项中的  &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt;  代表了中间项中那一大坨求和项。在 GMM 的术语中， &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt;  被称作 spectral density matrix at frequency zero of &lt;img src=&quot;https://www.zhihu.com/equation?tex=u_t&quot; alt=&quot;u_t&quot; eeimg=&quot;1&quot;/&gt; 。&lt;/p&gt;&lt;p&gt;OK！整理一下。本小节从我们熟悉的样本均值出发指出样本均值本身也是一个随机变量，并推导出当 sample size &lt;img src=&quot;https://www.zhihu.com/equation?tex=T&quot; alt=&quot;T&quot; eeimg=&quot;1&quot;/&gt;  趋于无穷且假设 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D%5Bu_t%5D+%3D+0&quot; alt=&quot;\mbox{E}[u_t] = 0&quot; eeimg=&quot;1&quot;/&gt; 时，variance of the sample mean 渐进趋于 &lt;img src=&quot;https://www.zhihu.com/equation?tex=S%2FT&quot; alt=&quot;S/T&quot; eeimg=&quot;1&quot;/&gt; ，其中  &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt;  是无穷级数求和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Csum%5Cmbox%7BE%7D%5Bu_tu_%7Bt-j%7D%5D&quot; alt=&quot;\sum\mbox{E}[u_tu_{t-j}]&quot; eeimg=&quot;1&quot;/&gt; 。&lt;/p&gt;&lt;p&gt;千万不要小看这个 &lt;img src=&quot;https://www.zhihu.com/equation?tex=var%28%5Cbar+u%29+%5Crightarrow+S%2FT&quot; alt=&quot;var(\bar u) \rightarrow S/T&quot; eeimg=&quot;1&quot;/&gt; 这个式子，它在下文 GMM 的数学推导中起着至关重要的作用。用 Cochrane 的话说，&lt;b&gt;GMM 中大绝大部分计量学均可归结到这个式子（most econometrics boils down to this）！&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;03 GMM 框架&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;回顾了 variance of the sample mean 之后，本小节就来直观的看看 GMM 到底是怎么回事儿。&lt;/p&gt;&lt;p&gt;&lt;b&gt;GMM 的作用是为了检验模型。&lt;/b&gt;模型到底对不对？模型的参数如何估计？误差是来自运气还是因为模型有误？GMM 提供了一个优雅而强大的计量学框架来回答这些问题。一般来说，GMM 框架分为以下三个部分：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;b&gt;第一部分：把待研究的问题表达成一系列总体矩条件（population moment conditions） ——&lt;/b&gt; &lt;b&gt;这是提出 model；&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;第二部分：使用样本数据得到对应的样本矩（sample moments），从而对参数进行估计 ——&lt;/b&gt; &lt;b&gt;这是把 model 和 data 联系起来；&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;第三部分：计算 sample moments 的 variance，从而对 population moments 进行 statistical test ——&lt;/b&gt; &lt;b&gt;这是检验 model。&lt;/b&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;b&gt;所以概括来说就是 GMM 就是用 sample moments 代替 population moments 然后对 population moments 进行统计检验。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;3.1 GMM 第一部分&lt;/b&gt;&lt;/p&gt;&lt;p&gt;我们用  &lt;img src=&quot;https://www.zhihu.com/equation?tex=x_t&quot; alt=&quot;x_t&quot; eeimg=&quot;1&quot;/&gt;  代表 data， &lt;img src=&quot;https://www.zhihu.com/equation?tex=b&quot; alt=&quot;b&quot; eeimg=&quot;1&quot;/&gt;  代表参数（这些都是 vectors），且存在一系列关于 &lt;img src=&quot;https://www.zhihu.com/equation?tex=x_t&quot; alt=&quot;x_t&quot; eeimg=&quot;1&quot;/&gt; 和 b 的函数 &lt;img src=&quot;https://www.zhihu.com/equation?tex=f%28x_t%2C+b%29&quot; alt=&quot;f(x_t, b)&quot; eeimg=&quot;1&quot;/&gt; 。 &lt;img src=&quot;https://www.zhihu.com/equation?tex=f%28x_t%2C+b%29&quot; alt=&quot;f(x_t, b)&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;的 expected value 即 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D%5Bf%28x_t%2C+b%29%5D&quot; alt=&quot;\mbox{E}[f(x_t, b)]&quot; eeimg=&quot;1&quot;/&gt; 就是 population moments。&lt;/b&gt;在 GMM 中，我们要求 population moments 满足 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D%5Bf%28x_t%2C+b%29%5D+%3D+0&quot; alt=&quot;\mbox{E}[f(x_t, b)] = 0&quot; eeimg=&quot;1&quot;/&gt; 的约束，&lt;b&gt;这一系列 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D%5Bf%28x_t%2C+b%29%5D+%3D+0&quot; alt=&quot;\mbox{E}[f(x_t, b)] = 0&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 约束就是 GMM 中的 population moment conditions（矩条件）。这些 moment conditions 是我们关于真实模型（true model）的猜测。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;需要说明的是，期望符号 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D&quot; alt=&quot;\mbox{E}&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt; 表示对总体求均值；而前面使用的（接下来也将会继续使用的）期望符号 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D_T&quot; alt=&quot;\mbox{E}_T&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;（有个下标 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=T&quot; alt=&quot;T&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;）表示对样本求均值。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;GMM 的第一部分是把待研究的问题转化成数据 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=x_t&quot; alt=&quot;x_t&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt; 和参数 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=b&quot; alt=&quot;b&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 的一系列方程 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=f&quot; alt=&quot;f&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;、且假设在 true model 下这些方程的 moments 满足 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D%5Bf%28x_t%2C+b%29%5D+%3D+0&quot; alt=&quot;\mbox{E}[f(x_t, b)] = 0&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+%5Cmbox%7BExpress+Model%7D%26%5Crightarrow%26%5Cdisplaystyle%5Cmbox%7BMean+of+%7Df%28%5Cmbox%7BData%2C+Parameter%7D%29%3D0%5C%5C+%26%5Crightarrow%26%5Cdisplaystyle%5Cmbox%7BE%7D%5Bf%28x_t%2C+b%29%5D%3D0+%5Cend%7Barray%7D+&quot; alt=&quot;\begin{array}{rll} \mbox{Express Model}&amp;amp;\rightarrow&amp;amp;\displaystyle\mbox{Mean of }f(\mbox{Data, Parameter})=0\\ &amp;amp;\rightarrow&amp;amp;\displaystyle\mbox{E}[f(x_t, b)]=0 \end{array} &quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;仍然晦涩？马上来看一些 asset pricing 中的例子。&lt;/p&gt;&lt;p&gt;从最基础的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=p+%3D+%5Cmbox%7BE%7D%5Bmx%5D&quot; alt=&quot;p = \mbox{E}[mx]&quot; eeimg=&quot;1&quot;/&gt; 出发（详见&lt;a href=&quot;https://zhuanlan.zhihu.com/p/88458489&quot; class=&quot;internal&quot;&gt;《理解资产价格》&lt;/a&gt;），其中 m 是 stochastic discount factor（由某些未知参数 &lt;img src=&quot;https://www.zhihu.com/equation?tex=b&quot; alt=&quot;b&quot; eeimg=&quot;1&quot;/&gt; 决定）、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=x&quot; alt=&quot;x&quot; eeimg=&quot;1&quot;/&gt;  是回报、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=p&quot; alt=&quot;p&quot; eeimg=&quot;1&quot;/&gt;  是价格。如果把 &lt;img src=&quot;https://www.zhihu.com/equation?tex=x&quot; alt=&quot;x&quot; eeimg=&quot;1&quot;/&gt; 换成超额收益（用 &lt;img src=&quot;https://www.zhihu.com/equation?tex=R%5Ee&quot; alt=&quot;R^e&quot; eeimg=&quot;1&quot;/&gt; 表示）则有：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Cmbox%7BE%7D%5Bm%28b%29R%5Ee%5D%3D0&quot; alt=&quot;\displaystyle\mbox{E}[m(b)R^e]=0&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;如果把  &lt;img src=&quot;https://www.zhihu.com/equation?tex=x&quot; alt=&quot;x&quot; eeimg=&quot;1&quot;/&gt;  换成 gross risk-free rate  &lt;img src=&quot;https://www.zhihu.com/equation?tex=R_f&quot; alt=&quot;R_f&quot; eeimg=&quot;1&quot;/&gt; （即 &lt;img src=&quot;https://www.zhihu.com/equation?tex=t&quot; alt=&quot;t&quot; eeimg=&quot;1&quot;/&gt; 时刻投入 1， &lt;img src=&quot;https://www.zhihu.com/equation?tex=t+%2B+1&quot; alt=&quot;t + 1&quot; eeimg=&quot;1&quot;/&gt; 时刻得到  &lt;img src=&quot;https://www.zhihu.com/equation?tex=R_f&quot; alt=&quot;R_f&quot; eeimg=&quot;1&quot;/&gt; ）则有：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Cmbox%7BE%7D%5Bm%28b%29R_f-1%5D%3D0&quot; alt=&quot;\displaystyle\mbox{E}[m(b)R_f-1]=0&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;这些都是 asset pricing 中常见的 moment conditions。&lt;/p&gt;&lt;p&gt;&lt;b&gt;3.2 GMM 第二部分&lt;/b&gt;&lt;/p&gt;&lt;p&gt;第一部分虽然把问题描述清楚了，但它们都是 population moment conditions，只是我们对于真实模型的猜想，我们有的只是样本数据。&lt;b&gt;GMM 的第二部分就是用 sample moments 来代替 population moments，从而建立起模型和数据之间的联系，以进行参数估计。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;和本文第二节一样，用  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D_T&quot; alt=&quot;\mbox{E}_T&quot; eeimg=&quot;1&quot;/&gt;  代表对样本数据求平均，则 sample moments 可以写成：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Cmbox%7BE%7D_T%5Bf%28x_t%2C+b%29%5D%3D%5Cfrac%7B1%7D%7BT%7D%5Csum_%7Bt%3D1%7D%5ET+f%28x_t%2C+b%29%5Cequiv+g_T%28b%29&quot; alt=&quot;\displaystyle\mbox{E}_T[f(x_t, b)]=\frac{1}{T}\sum_{t=1}^T f(x_t, b)\equiv g_T(b)&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;上式中最后引入符号 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; 仅仅是为了下文中简化公式。怎么样？看着这个式子有没有什么感想？无论研究的具体问题是什么（我们研究的是 asset pricing，而别人也可以研究经济学或金融学中其他的问题），不管 &lt;img src=&quot;https://www.zhihu.com/equation?tex=f&quot; alt=&quot;f&quot; eeimg=&quot;1&quot;/&gt; 到底长什么样子或数据 &lt;img src=&quot;https://www.zhihu.com/equation?tex=x_t&quot; alt=&quot;x_t&quot; eeimg=&quot;1&quot;/&gt; 和参数 &lt;img src=&quot;https://www.zhihu.com/equation?tex=b&quot; alt=&quot;b&quot; eeimg=&quot;1&quot;/&gt; 向量都是什么，&lt;b&gt;上面的 sample moments 也仅仅是 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=f%28x_t%2C+b%29&quot; alt=&quot;f(x_t, b)&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt; 在样本内取平均，因此也只是一种 sample mean！&lt;/b&gt;&lt;/p&gt;&lt;p&gt;从 sample moments 出发就可以进行参数估计。来自总体的 moment conditions 要求  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D%5Bf%28x_t%2C+b%29%5D+%3D+0&quot; alt=&quot;\mbox{E}[f(x_t, b)] = 0&quot; eeimg=&quot;1&quot;/&gt; ；使用样本数据，GMM estimator 的核心是找到  &lt;img src=&quot;https://www.zhihu.com/equation?tex=b&quot; alt=&quot;b&quot; eeimg=&quot;1&quot;/&gt;  的估计 —— 记为 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; —— 使得所有 sample moments 都尽可能的等于零：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Cmbox%7BE%7D_T%5Bf%28x_t%2C+%5Chat+b%29%5D%5Csimeq+0&quot; alt=&quot;\displaystyle\mbox{E}_T[f(x_t, \hat b)]\simeq 0&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;上式中之所以用了约等于而非等于，是因为&lt;b&gt;在实际问题中，sample moments 的个数往往超过参数的个数（这也被称为 overidentification）。&lt;/b&gt;假设一共有 n 个 moments（即 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; 是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=n+%C3%97+1&quot; alt=&quot;n × 1&quot; eeimg=&quot;1&quot;/&gt; 阶 vector）， &lt;img src=&quot;https://www.zhihu.com/equation?tex=p&quot; alt=&quot;p&quot; eeimg=&quot;1&quot;/&gt;  个参数（即  &lt;img src=&quot;https://www.zhihu.com/equation?tex=b&quot; alt=&quot;b&quot; eeimg=&quot;1&quot;/&gt;  是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=p+%C3%97+1&quot; alt=&quot;p × 1&quot; eeimg=&quot;1&quot;/&gt; 阶 vector）。当 &lt;img src=&quot;https://www.zhihu.com/equation?tex=n+%3E+p&quot; alt=&quot;n &amp;gt; p&quot; eeimg=&quot;1&quot;/&gt; 时，我们无法让所有的 sample moments 都等于零，而是选择让这其中的  &lt;img src=&quot;https://www.zhihu.com/equation?tex=p&quot; alt=&quot;p&quot; eeimg=&quot;1&quot;/&gt;  个 sample moments 或者这些 sample moments 的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=p&quot; alt=&quot;p&quot; eeimg=&quot;1&quot;/&gt; 个线性组合等于 0。这就是 GMM estimator：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Chat+b%3A+%5Cmbox%7Bset+%7D+ag_T%28%5Chat+b%29%3D0&quot; alt=&quot;\displaystyle\hat b: \mbox{set } ag_T(\hat b)=0&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;上式中， &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt;  是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=p+%C3%97+n&quot; alt=&quot;p × n&quot; eeimg=&quot;1&quot;/&gt; 阶矩阵，每一行都代表一个 sample moments 的线性组合。在具体问题中，根据 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; 的具体形式，上式可能有解析解或数值解。求解上式就可以获得 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; 。不过有的小伙伴可能会说：&lt;b&gt;等一下，你还没说矩条件的线性组合矩阵 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 是什么！不同的 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 显然会得到不同的参数估计。&lt;/b&gt;没错，在 GMM 的框架下，我们可以自由选择  &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; 。然而，纯从计量学的角度，有一个特殊的矩阵  &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt;  会让 GMM estimator 成为 efficient estimator。下文第 3.3 节和第 5 节将会就 efficiency 进行说明。&lt;/p&gt;&lt;p&gt;为了加深理解，仍然用 asset pricing 来举例子。假设 consumption-based CAPM（CCAPM）是真正的模型，因此随机折现因子 &lt;img src=&quot;https://www.zhihu.com/equation?tex=m&quot; alt=&quot;m&quot; eeimg=&quot;1&quot;/&gt; 由两个参数 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B2&quot; alt=&quot;β&quot; eeimg=&quot;1&quot;/&gt; 和  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B3&quot; alt=&quot;γ&quot; eeimg=&quot;1&quot;/&gt;  决定（CCAPM 的介绍请见&lt;a href=&quot;https://zhuanlan.zhihu.com/p/88458489&quot; class=&quot;internal&quot;&gt;《理解资产价格》&lt;/a&gt;），即 &lt;img src=&quot;https://www.zhihu.com/equation?tex=b%3D%5B%5Cbeta%2C%5Cgamma%5D%5E%5Cprime&quot; alt=&quot;b=[\beta,\gamma]^\prime&quot; eeimg=&quot;1&quot;/&gt; ；进一步假设我们有四个资产来检验 CCAPM，它们是 risk-free、市场组合以及 Fama and French (1993) 中的 HML 和 SMB。在这个例子中， &lt;img src=&quot;https://www.zhihu.com/equation?tex=n+%3D+4&quot; alt=&quot;n = 4&quot; eeimg=&quot;1&quot;/&gt; 而 &lt;img src=&quot;https://www.zhihu.com/equation?tex=p+%3D+2&quot; alt=&quot;p = 2&quot; eeimg=&quot;1&quot;/&gt; ，因此 &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; 是一个 &lt;img src=&quot;https://www.zhihu.com/equation?tex=2+%C3%97+4&quot; alt=&quot;2 × 4&quot; eeimg=&quot;1&quot;/&gt; 阶矩阵，而 GMM estimator 可以写成：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cleft%5B+%5Cbegin%7Barray%7D%7Bcccc%7D+a_%7B11%7D%26a_%7B12%7D%26a_%7B13%7D%26a_%7B14%7D%5C%5C+a_%7B21%7D%26a_%7B22%7D%26a_%7B23%7D%26a_%7B24%7D+%5Cend%7Barray%7D+%5Cright%5D+%5Cleft%5B+%5Cbegin%7Barray%7D%7Bl%7D+%5Cmbox%7BE%7D_T%5Bm%28%5Chat%5Cbeta%2C%5Chat%5Cgamma%29R%5Ee_m%5D%5C%5C+%5Cmbox%7BE%7D_T%5Bm%28%5Chat%5Cbeta%2C%5Chat%5Cgamma%29R_f-1%5D%5C%5C+%5Cmbox%7BE%7D_T%5Bm%28%5Chat%5Cbeta%2C%5Chat%5Cgamma%29R%5E%7B%5Cmbox%7BHML%7D%7D%5D%5C%5C+%5Cmbox%7BE%7D_T%5Bm%28%5Chat%5Cbeta%2C%5Chat%5Cgamma%29R%5E%7B%5Cmbox%7BSMB%7D%7D%5D+%5Cend%7Barray%7D+%5Cright%5D%3D+%5Cleft%5B+%5Cbegin%7Barray%7D%7Bc%7D+0%5C%5C0+%5Cend%7Barray%7D+%5Cright%5D&quot; alt=&quot;\left[ \begin{array}{cccc} a_{11}&amp;amp;a_{12}&amp;amp;a_{13}&amp;amp;a_{14}\\ a_{21}&amp;amp;a_{22}&amp;amp;a_{23}&amp;amp;a_{24} \end{array} \right] \left[ \begin{array}{l} \mbox{E}_T[m(\hat\beta,\hat\gamma)R^e_m]\\ \mbox{E}_T[m(\hat\beta,\hat\gamma)R_f-1]\\ \mbox{E}_T[m(\hat\beta,\hat\gamma)R^{\mbox{HML}}]\\ \mbox{E}_T[m(\hat\beta,\hat\gamma)R^{\mbox{SMB}}] \end{array} \right]= \left[ \begin{array}{c} 0\\0 \end{array} \right]&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;根据上式就可以使用 sample moments 求出参数估计 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; 。&lt;/p&gt;&lt;p&gt;&lt;b&gt;3.3 GMM 第三部分&lt;/b&gt;&lt;/p&gt;&lt;p&gt;使用 GMM estimator 得到的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; 仅仅是真实但未知参数 &lt;img src=&quot;https://www.zhihu.com/equation?tex=b_0&quot; alt=&quot;b_0&quot; eeimg=&quot;1&quot;/&gt; 的一个估计。从统计学的角度，我们自然关心估计的误差，即 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt; 。马上来回答上面遗留的矩阵 &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; 的选择的问题。&lt;b&gt;对于给定的 moments &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;，从计量学的角度有一个特殊的矩阵 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 使得 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 最小，这就是 efficient 的含义。&lt;/b&gt;Hansen (1982) 给出了这个  &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt;  的形式。关于 &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; 的进一步讨论将放在本文第五节。&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BVar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{Var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt;  的大小仅仅告诉我们参数估计是否准确，而对于研究的问题来说，我们更加关注的是当给定 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; 时，sample moments 的 variance，记为 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; ，的大小。从业务上说，在一般的 overidentification 问题下（moments 个数多于参数个数），sample moments 不可能都是零（如果 moments 个数  &lt;img src=&quot;https://www.zhihu.com/equation?tex=n&quot; alt=&quot;n&quot; eeimg=&quot;1&quot;/&gt;  等于参数个数  &lt;img src=&quot;https://www.zhihu.com/equation?tex=p&quot; alt=&quot;p&quot; eeimg=&quot;1&quot;/&gt; ，我们可以令每个 moment 都等于零从而求出全部  &lt;img src=&quot;https://www.zhihu.com/equation?tex=p&quot; alt=&quot;p&quot; eeimg=&quot;1&quot;/&gt;  个参数），因此我们关心 sample moments 联合起来相对于零的偏离的大小是多少。&lt;/p&gt;&lt;p&gt;&lt;b&gt;我们必须搞清楚 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T%28%5Chat+b%29&quot; alt=&quot;g_T(\hat b)&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 联合起来相对于零的偏离是因为运气成分还是因为选择的 population moment condition 就是错的。&lt;/b&gt;如果仅仅因为运气（即偏离的很小），那可以接受 population moment conditions —— 比如接受一个选择的 asset pricing 模型；如果不是因为运气（即偏离很大），那就只能拒绝 population moment conditions —— 即 reject 一个 asset pricing 模型。这就是 statistical test。唯有有了 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; ，才能够进行 statistical test。&lt;b&gt;计算 variance 并进行 statistical test 就是 GMM 的第三部分。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;值得一提的是，由于 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T%28%5Chat+b%29&quot; alt=&quot;g_T(\hat b)&quot; eeimg=&quot;1&quot;/&gt; 都是向量，因此 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; 事实上都代表了它们各自的 &lt;b&gt;variance-covariance matrix&lt;/b&gt;，其中 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt; 是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=p+%C3%97+p&quot; alt=&quot;p × p&quot; eeimg=&quot;1&quot;/&gt; 阶矩阵（共有 &lt;img src=&quot;https://www.zhihu.com/equation?tex=p&quot; alt=&quot;p&quot; eeimg=&quot;1&quot;/&gt; 个参数），而 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; 是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=n+%C3%97+n&quot; alt=&quot;n × n&quot; eeimg=&quot;1&quot;/&gt; 阶矩阵（共有  &lt;img src=&quot;https://www.zhihu.com/equation?tex=n&quot; alt=&quot;n&quot; eeimg=&quot;1&quot;/&gt;  个 moments）。&lt;/p&gt;&lt;p&gt;有了 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; 就可以写出 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T%28%5Chat+b%29&quot; alt=&quot;g_T(\hat b)&quot; eeimg=&quot;1&quot;/&gt; 的分布。当 sample size  &lt;img src=&quot;https://www.zhihu.com/equation?tex=T&quot; alt=&quot;T&quot; eeimg=&quot;1&quot;/&gt;  趋于无穷时， &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; 的满足以下渐进正态性：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Csqrt%7BT%7D%28%5Chat+b-b_0%29%5Crightarrow%5Cmathcal%7BN%7D%5Cleft%5B0%2C+%28ad%29%5E%7B-1%7DaSa%5E%5Cprime%28ad%29%5E%7B-1%5Cprime%7D%5Cright%5D&quot; alt=&quot;\displaystyle\sqrt{T}(\hat b-b_0)\rightarrow\mathcal{N}\left[0, (ad)^{-1}aSa^\prime(ad)^{-1\prime}\right]&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;上式中， &lt;img src=&quot;https://www.zhihu.com/equation?tex=-1&quot; alt=&quot;-1&quot; eeimg=&quot;1&quot;/&gt; 表示求逆， &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cprime&quot; alt=&quot;\prime&quot; eeimg=&quot;1&quot;/&gt; 表示转置，所以 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%28ad%29%5E%7B-1%5Cprime%7D&quot; alt=&quot;(ad)^{-1\prime}&quot; eeimg=&quot;1&quot;/&gt; 表示先求 &lt;img src=&quot;https://www.zhihu.com/equation?tex=ad&quot; alt=&quot;ad&quot; eeimg=&quot;1&quot;/&gt; 的逆矩阵再转置。这个式子正是 Hansen (1982) 中的 Theorem 3.1。Hansen (1982) 给出了渐进分布成立需要满足的一系列假设。在实际应用中，我们需要记住的是&lt;b&gt;数据 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=x_t&quot; alt=&quot;x_t&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 需要满足弱平稳性，这是因为 GMM 的基础是随着 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=T&quot; alt=&quot;T&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 的增大，sample mean 向 population mean 收敛。&lt;/b&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-45f6d1441ef969c244596d5bd9777482_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;904&quot; data-rawheight=&quot;116&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;904&quot; data-original=&quot;https://pic3.zhimg.com/v2-45f6d1441ef969c244596d5bd9777482_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-45f6d1441ef969c244596d5bd9777482_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;904&quot; data-rawheight=&quot;116&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;904&quot; data-original=&quot;https://pic3.zhimg.com/v2-45f6d1441ef969c244596d5bd9777482_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-45f6d1441ef969c244596d5bd9777482_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;此外， &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T%28%5Chat+b%29&quot; alt=&quot;g_T(\hat b)&quot; eeimg=&quot;1&quot;/&gt; 满足如下渐进正态性：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Csqrt%7BT%7Dg_T%28%5Chat+b%29%5Crightarrow%5Cmathcal%7BN%7D%5Cleft%5B0%2C%28I-d%28ad%29%5E%7B-1%7Da%29S%28I-d%28ad%29%5E%7B-1%7Da%29%5E%5Cprime%5Cright%5D&quot; alt=&quot;\displaystyle\sqrt{T}g_T(\hat b)\rightarrow\mathcal{N}\left[0,(I-d(ad)^{-1}a)S(I-d(ad)^{-1}a)^\prime\right]&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;上式中， &lt;img src=&quot;https://www.zhihu.com/equation?tex=I&quot; alt=&quot;I&quot; eeimg=&quot;1&quot;/&gt;  是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=n+%C3%97+n&quot; alt=&quot;n × n&quot; eeimg=&quot;1&quot;/&gt; 阶单位阵。这个式子正是 Hansen (1982) 中的 Lemma 4.1。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-79d44f2d157583534df26f3fd996edf6_b.png&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;911&quot; data-rawheight=&quot;106&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;911&quot; data-original=&quot;https://pic3.zhimg.com/v2-79d44f2d157583534df26f3fd996edf6_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-79d44f2d157583534df26f3fd996edf6_b.png&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;911&quot; data-rawheight=&quot;106&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;911&quot; data-original=&quot;https://pic3.zhimg.com/v2-79d44f2d157583534df26f3fd996edf6_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-79d44f2d157583534df26f3fd996edf6_b.png&quot;/&gt;&lt;/figure&gt;&lt;p&gt;看到这里，你大概在想：What the hell?! 这又  &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt;  又  &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt;  又  &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt;  又求逆又转置，这都是什么“牛鬼蛇神”？有一种“每个字都认识、但是放在一起就看不懂了”的既视感。这里的 a 就是上面 sample moments 的线性组合矩阵，但是  &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt;  和  &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt;  还没有介绍。别着急，第四节将会把这些式子掰开了、揉碎了说清楚的。&lt;/p&gt;&lt;p&gt;看到  &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt;  你是否想到什么？没错，本文第二节讲 the variance of the sample mean 的时候提到了  &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt; 。而上面 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; 看似无比复杂，但它们的本质也都离不开 the variance of the sample mean！&lt;/p&gt;&lt;p&gt;在有了 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T%28%5Chat+b%29&quot; alt=&quot;g_T(\hat b)&quot; eeimg=&quot;1&quot;/&gt; 的分布后，就可以对 GMM 第一部分中选择的模型进行检验，从而决定是接受还是拒绝它。以 asset pricing 为例，这些 moments 代表了不同资产或投资组合的 pricing errors。我们关心 pricing errors 是否联合起来显著不为零，这时可以用 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T%28%5Chat+b%29&quot; alt=&quot;g_T(\hat b)&quot; eeimg=&quot;1&quot;/&gt; 的分布构建 chi-squared statistic 来检验。如果 test statistic 超过给定显著性水平的阈值，那么我们就可以拒绝该 asset pricing 模型。&lt;/p&gt;&lt;p&gt;总结一下，本小节介绍了 GMM 的三部分：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;b&gt;第一部分是把关心的问题表述成一组 population moment conditions；&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;第二部分是用 sample moments 代替 population moments 从而把样本数据和模型联系起来，并进行参数估计；&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;第三部分是计算 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 和 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;，从而进行 statistical test，决定是否接受第一部分中的模型。&lt;/b&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;下一节就来看看 statistical test 背后的数学基础。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;04 数学基础&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;OK! Let&amp;#39;s do the math!&lt;/p&gt;&lt;p&gt;本节的目标是解释 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; 里面的那些  &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt; 、求逆以及转置。我会力争把所有涉及到的公式都讲清楚。了解本节的内容无疑会更好的理解 GMM 背后的数学之美（汗），但是从阅读的角度，跳过本小节也不影响对后文的理解。&lt;/p&gt;&lt;p&gt;先说  &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt; ，这是一切的核心。从下式出发来解释  &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt; ：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+g_T%28b_0%29%5Cequiv%5Cfrac%7B1%7D%7BT%7D%5Csum_%7Bt%3D1%7D%5ET+f%28x_t%2C+b_0%29%3D%5Cfrac%7B1%7D%7BT%7D%5Csum_%7Bt%3D1%7D%5ET+U_t&quot; alt=&quot;\displaystyle g_T(b_0)\equiv\frac{1}{T}\sum_{t=1}^T f(x_t, b_0)=\frac{1}{T}\sum_{t=1}^T U_t&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;上式中第一个等价符号是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; 的定义（参考 3.2 节），第二个等号是使用 &lt;img src=&quot;https://www.zhihu.com/equation?tex=U_t&quot; alt=&quot;U_t&quot; eeimg=&quot;1&quot;/&gt; 来代表 &lt;img src=&quot;https://www.zhihu.com/equation?tex=f%28x_t%2C+b_0%29&quot; alt=&quot;f(x_t, b_0)&quot; eeimg=&quot;1&quot;/&gt; 。&lt;b&gt;需要强调的是，上式中 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 的参数是真实（但未知）的参数 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=b_0&quot; alt=&quot;b_0&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;。而&lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=+g_T%28b_0%29&quot; alt=&quot; g_T(b_0)&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 的方差 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28b_0%29%29&quot; alt=&quot;\mbox{var}(g_T(b_0))&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 就表示 sample moments &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 在真实参数&lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=b_0&quot; alt=&quot;b_0&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;下的 sampling variance。无论 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=f&quot; alt=&quot;f&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt; 长什么样子，sample moments 的数学形式都仅仅取平均，因此 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28b_0%29%29&quot; alt=&quot;\mbox{var}(g_T(b_0))&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt; 正是 the variance of the sample mean！&lt;/b&gt;（这就是本文第二节的价值所在。）&lt;/p&gt;&lt;p&gt;上面之所以用了 &lt;img src=&quot;https://www.zhihu.com/equation?tex=U_t&quot; alt=&quot;U_t&quot; eeimg=&quot;1&quot;/&gt; ，一是为了简化表达式，二是为了和本文第二节中的小写 &lt;img src=&quot;https://www.zhihu.com/equation?tex=u_t&quot; alt=&quot;u_t&quot; eeimg=&quot;1&quot;/&gt; 呼应起来：这里的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=U_t&quot; alt=&quot;U_t&quot; eeimg=&quot;1&quot;/&gt; 对应第二节的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=u_t&quot; alt=&quot;u_t&quot; eeimg=&quot;1&quot;/&gt; 、这里的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T%28b_0%29&quot; alt=&quot;g_T(b_0)&quot; eeimg=&quot;1&quot;/&gt; 就是第二节的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbar+u&quot; alt=&quot;\bar u&quot; eeimg=&quot;1&quot;/&gt; ，因此马上得到（当  &lt;img src=&quot;https://www.zhihu.com/equation?tex=T&quot; alt=&quot;T&quot; eeimg=&quot;1&quot;/&gt;  趋于无穷）：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+%5Cmbox%7Bvar%7D%28g_T%28b_0%29%29%5Crightarrow%5Cfrac%7B1%7D%7BT%7D%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D%5Cmbox%7BE%7D%5BU_tU_%7Bt-j%7D%5E%5Cprime%5D%3D%5Cfrac%7B1%7D%7BT%7DS&quot; alt=&quot;\displaystyle \mbox{var}(g_T(b_0))\rightarrow\frac{1}{T}\sum_{j=-\infty}^{\infty}\mbox{E}[U_tU_{t-j}^\prime]=\frac{1}{T}S&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;&lt;b&gt;这正是 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt; 的定义&lt;/b&gt;（实际中，它可以用样本数据来估计）。上面的计算中之所以能把方差和协方差写成 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D%5BXY%5D&quot; alt=&quot;\mbox{E}[XY]&quot; eeimg=&quot;1&quot;/&gt; 的形式是因为我们假设真实模型满足 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D%5Bf%28x_t%2C+b_0%29%5D+%3D+%5Cmbox%7BE%7D%5BU_t%5D+%3D+0&quot; alt=&quot;\mbox{E}[f(x_t, b_0)] = \mbox{E}[U_t] = 0&quot; eeimg=&quot;1&quot;/&gt; 。（预期符号 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7BE%7D&quot; alt=&quot;\mbox{E}&quot; eeimg=&quot;1&quot;/&gt; 没有下标 &lt;img src=&quot;https://www.zhihu.com/equation?tex=T&quot; alt=&quot;T&quot; eeimg=&quot;1&quot;/&gt; ，表示 population expectation。）&lt;/p&gt;&lt;p&gt;重要的事情说三遍：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;上面求的 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28b_0%29%29&quot; alt=&quot;\mbox{var}(g_T(b_0))&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 是 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 在真实参数 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=b_0&quot; alt=&quot;b_0&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt;、而非估计量 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 下的 variance。&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;上面求的&lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28b_0%29%29&quot; alt=&quot;\mbox{var}(g_T(b_0))&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;是 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 在真实参数 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=b_0&quot; alt=&quot;b_0&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt;、而非估计量 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 下的 variance。&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;上面求的&lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28b_0%29%29&quot; alt=&quot;\mbox{var}(g_T(b_0))&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;是 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 在真实参数 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=b_0&quot; alt=&quot;b_0&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt;、而非估计量 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 下的 variance。&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;当然，我们最终关心的是当 &lt;img src=&quot;https://www.zhihu.com/equation?tex=b+%3D+%5Chat+b&quot; alt=&quot;b = \hat b&quot; eeimg=&quot;1&quot;/&gt; 时 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; 的方差，即 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; 。然而，一旦有了 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28b_0%29%29+%3D+S%2FT&quot; alt=&quot;\mbox{var}(g_T(b_0)) = S/T&quot; eeimg=&quot;1&quot;/&gt; ，计算 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt; 以及 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; 就变得迎刃而解。这就是为什么 Cochrane 教授说一切都可以归结为计算 the variance of the sample mean。&lt;/p&gt;&lt;p&gt;接下来就看看 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt; 如何计算。由 GMM estimator 可知， &lt;img src=&quot;https://www.zhihu.com/equation?tex=ag_T%28%5Chat+b%29+%3D+0&quot; alt=&quot;ag_T(\hat b) = 0&quot; eeimg=&quot;1&quot;/&gt; 。将该式在真实参数 &lt;img src=&quot;https://www.zhihu.com/equation?tex=b_0&quot; alt=&quot;b_0&quot; eeimg=&quot;1&quot;/&gt; 进行一阶泰勒展开有：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+ag_T%28b_0%29%2Ba%5Cfrac%7B%5Cpartial+g_T%7D%7B%5Cpartial+b%5E%5Cprime%7D%28%5Chat+b-b_0%29%3D0&quot; alt=&quot;\displaystyle ag_T(b_0)+a\frac{\partial g_T}{\partial b^\prime}(\hat b-b_0)=0&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;细心的小伙伴可能注意到了一阶偏导数  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%E2%88%82g_T%2F%E2%88%82b%5E%5Cprime&quot; alt=&quot;∂g_T/∂b^\prime&quot; eeimg=&quot;1&quot;/&gt;  的分母中 &lt;img src=&quot;https://www.zhihu.com/equation?tex=b&quot; alt=&quot;b&quot; eeimg=&quot;1&quot;/&gt; 右上角有个十分诡异的转置符号。在计算偏导数时， &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; 是一个 &lt;img src=&quot;https://www.zhihu.com/equation?tex=n+%C3%97+1&quot; alt=&quot;n × 1&quot; eeimg=&quot;1&quot;/&gt; 阶向量（ &lt;img src=&quot;https://www.zhihu.com/equation?tex=n&quot; alt=&quot;n&quot; eeimg=&quot;1&quot;/&gt;  个 moments），而  &lt;img src=&quot;https://www.zhihu.com/equation?tex=b&quot; alt=&quot;b&quot; eeimg=&quot;1&quot;/&gt;  是一个 &lt;img src=&quot;https://www.zhihu.com/equation?tex=p+%C3%97+1&quot; alt=&quot;p × 1&quot; eeimg=&quot;1&quot;/&gt; 阶向量（ &lt;img src=&quot;https://www.zhihu.com/equation?tex=p&quot; alt=&quot;p&quot; eeimg=&quot;1&quot;/&gt; 个参数），因此偏导数其实是一个矩阵（要么 &lt;img src=&quot;https://www.zhihu.com/equation?tex=n+%C3%97+p&quot; alt=&quot;n × p&quot; eeimg=&quot;1&quot;/&gt; 阶、要么 &lt;img src=&quot;https://www.zhihu.com/equation?tex=p+%C3%97+n&quot; alt=&quot;p × n&quot; eeimg=&quot;1&quot;/&gt; 阶），而这类运算属于 matrix calculus。当转置符号出现在分母时，得到的矩阵是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=n+%C3%97+p&quot; alt=&quot;n × p&quot; eeimg=&quot;1&quot;/&gt; 阶，即每一行代表一个 moment，这种排列方式称作 numerator layout，也称作 Jacobian formulation。而这个一阶偏导数矩阵也正是我们的  &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt; ：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+d%5Cequiv%5Cmbox%7BE%7D%5Cleft%5B%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+b%5E%5Cprime%7D%28x_t%2C+b%29%5Cright%5D%3D%5Cfrac%7B%5Cpartial+g_T%28b%29%7D%7B%5Cpartial+b%5E%5Cprime%7D&quot; alt=&quot;\displaystyle d\equiv\mbox{E}\left[\frac{\partial f}{\partial b^\prime}(x_t, b)\right]=\frac{\partial g_T(b)}{\partial b^\prime}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;严格来说， &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt; 应该由 population moments 的一阶导数计算（上面的第一个等价条件）；但在应用中， &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt; 的取值用 sample moments 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=b+%3D+%5Chat+b&quot; alt=&quot;b = \hat b&quot; eeimg=&quot;1&quot;/&gt; 来估计（上面的第二的等式）。用  &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt;  替换  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%E2%88%82g_T%2F%E2%88%82b%5E%5Cprime&quot; alt=&quot;∂g_T/∂b^\prime&quot; eeimg=&quot;1&quot;/&gt;  并代入上面的泰勒展开，进行简单的代数运算可得：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+%26ag_T%28b_0%29%2Bad%28%5Chat+b-b_0%29%3D0%5C%5C+%5CRightarrow%26%5Chat+b-b_0%3D-%28ad%29%5E%7B-1%7Dag_T%28b_0%29+%5Cend%7Barray%7D&quot; alt=&quot;\begin{array}{rll} &amp;amp;ag_T(b_0)+ad(\hat b-b_0)=0\\ \Rightarrow&amp;amp;\hat b-b_0=-(ad)^{-1}ag_T(b_0) \end{array}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;上式两边直接求 variance 就得到 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b-b_0%29&quot; alt=&quot;\mbox{var}(\hat b-b_0)&quot; eeimg=&quot;1&quot;/&gt; 。值得一提的是，上式右侧的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%28ad%29%5E%7B-1%7Da&quot; alt=&quot;(ad)^{-1}a&quot; eeimg=&quot;1&quot;/&gt; 是系数矩阵而 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T%28b_0%29&quot; alt=&quot;g_T(b_0)&quot; eeimg=&quot;1&quot;/&gt; 的 variance 我们之前已经求出来了 —— 没错正是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=S%2FT&quot; alt=&quot;S/T&quot; eeimg=&quot;1&quot;/&gt; 。因此有：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Cmbox%7Bvar%7D%28%5Chat+b-b_0%29%3D%5Cfrac%7B1%7D%7BT%7D%28ad%29%5E%7B-1%7DaSa%5E%5Cprime%28ad%29%5E%7B-1%5Cprime%7D&quot; alt=&quot;\displaystyle\mbox{var}(\hat b-b_0)=\frac{1}{T}(ad)^{-1}aSa^\prime(ad)^{-1\prime}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;数学上虽然通过泰勒展开顺理成章的从 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28b_0%29%29&quot; alt=&quot;\mbox{var}(g_T(b_0))&quot; eeimg=&quot;1&quot;/&gt; 得到了 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b-b_0%29&quot; alt=&quot;\mbox{var}(\hat b-b_0)&quot; eeimg=&quot;1&quot;/&gt; ，但我们仍然希望从直觉上了解上面一顿操作猛如虎到底干了什么。考虑最简单的情况，即一个 moment 和一个参数（因此 &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; 是一个标量，令 &lt;img src=&quot;https://www.zhihu.com/equation?tex=a+%3D+1&quot; alt=&quot;a = 1&quot; eeimg=&quot;1&quot;/&gt; ），我们可以画出 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28b_0%29%29&quot; alt=&quot;\mbox{var}(g_T(b_0))&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b+-+b_0%29&quot; alt=&quot;\mbox{var}(\hat b - b_0)&quot; eeimg=&quot;1&quot;/&gt; 的关系。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-86baaf4c057fa96625436eafa0bd77c7_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;853&quot; data-rawheight=&quot;387&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;853&quot; data-original=&quot;https://pic4.zhimg.com/v2-86baaf4c057fa96625436eafa0bd77c7_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-86baaf4c057fa96625436eafa0bd77c7_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;853&quot; data-rawheight=&quot;387&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;853&quot; data-original=&quot;https://pic4.zhimg.com/v2-86baaf4c057fa96625436eafa0bd77c7_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-86baaf4c057fa96625436eafa0bd77c7_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;图中，灰色曲线表示不同参数  &lt;img src=&quot;https://www.zhihu.com/equation?tex=b&quot; alt=&quot;b&quot; eeimg=&quot;1&quot;/&gt;  时的 population moment，用 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g%28b%29&quot; alt=&quot;g(b)&quot; eeimg=&quot;1&quot;/&gt; 表示。对于真实参数 &lt;img src=&quot;https://www.zhihu.com/equation?tex=b_0&quot; alt=&quot;b_0&quot; eeimg=&quot;1&quot;/&gt; ，由假设有 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g%28b_0%29+%3D+%5Cmbox%7BE%7D%5Bf%28x_t%2C+b_0%29%5D+%3D+0&quot; alt=&quot;g(b_0) = \mbox{E}[f(x_t, b_0)] = 0&quot; eeimg=&quot;1&quot;/&gt; ，因此在图上，灰色曲线经过 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%28b_0%2C+0%29&quot; alt=&quot;(b_0, 0)&quot; eeimg=&quot;1&quot;/&gt; 这个点；蓝色曲线表示不同参数  &lt;img src=&quot;https://www.zhihu.com/equation?tex=b&quot; alt=&quot;b&quot; eeimg=&quot;1&quot;/&gt;  时的 sample moment，用 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T%28b%29&quot; alt=&quot;g_T(b)&quot; eeimg=&quot;1&quot;/&gt; 表示。图中 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T%28b_0%29&quot; alt=&quot;g_T(b_0)&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g%28b_0%29+%3D+0&quot; alt=&quot;g(b_0) = 0&quot; eeimg=&quot;1&quot;/&gt; 之间的距离就是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T%28b_0%29&quot; alt=&quot;g_T(b_0)&quot; eeimg=&quot;1&quot;/&gt; 的 sampling variation，即我们的样本可能由于 luck 或者 unluck，以至于 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T%28b_0%29+%E2%89%A0+0&quot; alt=&quot;g_T(b_0) ≠ 0&quot; eeimg=&quot;1&quot;/&gt; 而是较  &lt;img src=&quot;https://www.zhihu.com/equation?tex=0&quot; alt=&quot;0&quot; eeimg=&quot;1&quot;/&gt;  有一定的偏离，在统计上它就是  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28b_0%29%29&quot; alt=&quot;\mbox{var}(g_T(b_0))&quot; eeimg=&quot;1&quot;/&gt; 。&lt;/p&gt;&lt;p&gt;接下来，对于 sample moment &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; ，我们令其等于 0 求出的参数估计为 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; ，因此蓝色曲线  &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt;  经过 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%28%5Chat+b%2C+0%29&quot; alt=&quot;(\hat b, 0)&quot; eeimg=&quot;1&quot;/&gt; 这个点。下面在蓝线上的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; 点计算其切线（红色）并计算切线的斜率 &lt;img src=&quot;https://www.zhihu.com/equation?tex=d+%3D+%5Cmbox%7Bd%7Dg%2F%5Cmbox%7Bd%7Db&quot; alt=&quot;d = \mbox{d}g/\mbox{d}b&quot; eeimg=&quot;1&quot;/&gt; 。通过 &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt; 我们就可以把 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T%28b_0%29&quot; alt=&quot;g_T(b_0)&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g%28b_0%29+%3D+0&quot; alt=&quot;g(b_0) = 0&quot; eeimg=&quot;1&quot;/&gt; 之间的 sampling variation 转换成 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=b_0&quot; alt=&quot;b_0&quot; eeimg=&quot;1&quot;/&gt; 之间的 sampling variation，即 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b+%E2%80%93+b_0%29&quot; alt=&quot;\mbox{var}(\hat b – b_0)&quot; eeimg=&quot;1&quot;/&gt; 。这正是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28b_0%29%29&quot; alt=&quot;\mbox{var}(g_T(b_0))&quot; eeimg=&quot;1&quot;/&gt; 和  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b+%E2%80%93+b_0%29&quot; alt=&quot;\mbox{var}(\hat b – b_0)&quot; eeimg=&quot;1&quot;/&gt;  关系的几何含义。&lt;/p&gt;&lt;p&gt;下面我们如法炮制，利用一阶泰勒展开从 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28b_0%29%29&quot; alt=&quot;\mbox{var}(g_T(b_0))&quot; eeimg=&quot;1&quot;/&gt; 求解 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; ：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+g_T%28%5Chat+b%29%3Dg_T%28b_0%29%2B%5Cfrac%7B%5Cpartial+g_T%7D%7B%5Cpartial+b%5E%5Cprime%7D%28%5Chat+b-b_0%29&quot; alt=&quot;\displaystyle g_T(\hat b)=g_T(b_0)+\frac{\partial g_T}{\partial b^\prime}(\hat b-b_0)&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;由于 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b+%E2%80%93+b_0&quot; alt=&quot;\hat b – b_0&quot; eeimg=&quot;1&quot;/&gt; 已经在之前求出了，因此只需把它代入到上式就可得到：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+g_T%28%5Chat+b%29%26%3D%26%5Cdisplaystyle+g_T%28b_0%29-d%28ad%29%5E%7B-1%7Dag_T%28b_0%29%5C%5C+%26%3D%26%5Cleft%5BI-d%28ad%29%5E%7B-1%7Da%5Cright%5Dg_T%28b_0%29+%5Cend%7Barray%7D&quot; alt=&quot;\begin{array}{rll} g_T(\hat b)&amp;amp;=&amp;amp;\displaystyle g_T(b_0)-d(ad)^{-1}ag_T(b_0)\\ &amp;amp;=&amp;amp;\left[I-d(ad)^{-1}a\right]g_T(b_0) \end{array}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;两边同时求 variance（确切的说是 variance-covariance matrix）有：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29%26%3D%26%5Cdisplaystyle%5Cleft%5BI-d%28ad%29%5E%7B-1%7Da%5Cright%5D%5Cmbox%7Bvar%7D%28g_T%28b_0%29%29%5Cleft%5BI-d%28ad%29%5E%7B-1%7Da%5Cright%5D%5E%5Cprime%5C%5C+%26%3D%26%5Cdisplaystyle%5Cfrac%7B1%7D%7BT%7D%5Cleft%5BI-d%28ad%29%5E%7B-1%7Da%5Cright%5DS%5Cleft%5BI-d%28ad%29%5E%7B-1%7Da%5Cright%5D%5E%5Cprime+%5Cend%7Barray%7D&quot; alt=&quot;\begin{array}{rll} \mbox{var}(g_T(\hat b))&amp;amp;=&amp;amp;\displaystyle\left[I-d(ad)^{-1}a\right]\mbox{var}(g_T(b_0))\left[I-d(ad)^{-1}a\right]^\prime\\ &amp;amp;=&amp;amp;\displaystyle\frac{1}{T}\left[I-d(ad)^{-1}a\right]S\left[I-d(ad)^{-1}a\right]^\prime \end{array}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;上式中的第二个等式用到了我们的老朋友： &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28b_0%29%29+%3D+S%2FT&quot; alt=&quot;\mbox{var}(g_T(b_0)) = S/T&quot; eeimg=&quot;1&quot;/&gt; —— variance of sample mean！关于 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28b_0%29%29&quot; alt=&quot;\mbox{var}(g_T(b_0))&quot; eeimg=&quot;1&quot;/&gt; 的关系也可以从直觉上解释两句。不难看出， &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; 是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28b_0%29%29&quot; alt=&quot;\mbox{var}(g_T(b_0))&quot; eeimg=&quot;1&quot;/&gt; 乘以一个系数矩阵，这个系数矩阵是单位阵  &lt;img src=&quot;https://www.zhihu.com/equation?tex=I&quot; alt=&quot;I&quot; eeimg=&quot;1&quot;/&gt;  减去这一大坨 &lt;img src=&quot;https://www.zhihu.com/equation?tex=d%28ad%29%5E%7B-1%7Da&quot; alt=&quot;d(ad)^{-1}a&quot; eeimg=&quot;1&quot;/&gt; 。&lt;b&gt;因此从直觉上说，&lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 在 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=b+%3D+%5Chat+b&quot; alt=&quot;b = \hat b&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 时的方差 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;会比 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 在 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=b+%3D+b_0&quot; alt=&quot;b = b_0&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 时的方差 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28b_0%29%29&quot; alt=&quot;\mbox{var}(g_T(b_0))&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;要小一些。&lt;/b&gt;这是因为在 GMM 估计时，我们要求 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; 的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=p&quot; alt=&quot;p&quot; eeimg=&quot;1&quot;/&gt; 个线性组合等于零 —— &lt;img src=&quot;https://www.zhihu.com/equation?tex=ag_T%28%5Chat+b%29+%3D+0&quot; alt=&quot;ag_T(\hat b) = 0&quot; eeimg=&quot;1&quot;/&gt; —— 从而求出 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; ，因此求解 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; 的过程用掉了 sample moments 的一些 variation，所以当 &lt;img src=&quot;https://www.zhihu.com/equation?tex=b+%3D+%5Chat+b&quot; alt=&quot;b = \hat b&quot; eeimg=&quot;1&quot;/&gt; 时 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; 方差小于当 &lt;img src=&quot;https://www.zhihu.com/equation?tex=b+%3D+b_0&quot; alt=&quot;b = b_0&quot; eeimg=&quot;1&quot;/&gt; 时 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; 的方差。&lt;/p&gt;&lt;p&gt;&lt;b&gt;无论是 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 还是 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;，上面一顿泰勒展开操作虽然非常热闹，但它们其实都仅是用了统计学中的 delta method。所以，其实我们只是用了 variance of the sample mean（&lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=S%2FT&quot; alt=&quot;S/T&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;）+ delta method 就求出了我们关心的&lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 和 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;。就是这么简单。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;有了 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; ，就可以得到 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T%28%5Chat+b%29&quot; alt=&quot;g_T(\hat b)&quot; eeimg=&quot;1&quot;/&gt; 的渐近分布（3.3 节介绍过），使用它的分布就可以构建 chi-squared statistic 来对模型进行检验：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+%26%5Cdisplaystyle+g_T%28%5Chat+b%29%5E%5Cprime%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29%5E%7B-1%7Dg_T%28%5Chat+b%29%5Csim%5Cchi%5E2_%7Bn-p%7D%5C%5C+%5CRightarrow%26%5Cdisplaystyle+Tg_T%28%5Chat+b%29%5E%5Cprime%5Cleft%5B%5Cleft%28I-d%28ad%29%5E%7B-1%7Da%5Cright%29S%5Cleft%28I-d%28ad%29%5E%7B-1%7Da%5Cright%29%5E%5Cprime%5Cright%5D%5E%7B-1%7D+g_T%28%5Chat+b%29%5Csim%5Cchi%5E2_%7Bn-p%7D+%5Cend%7Barray%7D&quot; alt=&quot;\begin{array}{rll} &amp;amp;\displaystyle g_T(\hat b)^\prime\mbox{var}(g_T(\hat b))^{-1}g_T(\hat b)\sim\chi^2_{n-p}\\ \Rightarrow&amp;amp;\displaystyle Tg_T(\hat b)^\prime\left[\left(I-d(ad)^{-1}a\right)S\left(I-d(ad)^{-1}a\right)^\prime\right]^{-1} g_T(\hat b)\sim\chi^2_{n-p} \end{array}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;上式的第二步是把  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt;  的表达式代入并求逆；chi-squared statistic 的自由度是 moments 的个数减去参数的个数，即 &lt;img src=&quot;https://www.zhihu.com/equation?tex=n+%E2%80%93+p&quot; alt=&quot;n – p&quot; eeimg=&quot;1&quot;/&gt; 。&lt;b&gt;由于估计 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 的时候用掉了 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=p&quot; alt=&quot;p&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt; 个自由度，所以 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T%28%5Chat+b%29&quot; alt=&quot;g_T(\hat b)&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt; 的 variance-covariance matrix 不是满秩的（这也体现在了 chi-squared statistic 的自由度 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=n+%E2%80%93+p&quot; alt=&quot;n – p&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 上），因此上式中对 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 求逆实际上是 pseudo-inverse。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;如果你在 Wikipedia 或者其他书籍上查阅 GMM 的资料，也许看到的 chi-squared statistic 的表达式远没有上面这个复杂。&lt;b&gt;上述表达式是最 general 的情况&lt;/b&gt;，因为我们尚未讨论那个使 GMM estimator 变得 efficient 的特殊的矩阵  &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; 。在那个  &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt;  下， &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; 矩阵以及 chi-squared statistic 表达式将被大大的简化。Efficient GMM 就是下一节的内容。&lt;/p&gt;&lt;p&gt;总结一下本小节。上面用了大量的文字和推导把 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; 背后的数学含义呈现给各位，是希望这个过程能帮助小伙伴们加深对 GMM 的理解。站在 notation 的角度来说，虽然这些公式看上去很复杂（又是转置、又是求逆的），&lt;b&gt;但我们只需给 GMM 框架提供它需要的 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;、&lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;、&lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt; 和 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;，剩下的“无脑”交给 GMM 就可以计算出各种想要的统计量并进行 test，非常方便。&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;05 Efficient GMM&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;本文的 3.2 小节给出的 GMM estimator 如下：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Chat+b%3A+%5Cmbox%7Bset+%7D+ag_T%28%5Chat+b%29%3D0&quot; alt=&quot;\displaystyle\hat b: \mbox{set } ag_T(\hat b)=0&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;其中  &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt;  是一个 &lt;img src=&quot;https://www.zhihu.com/equation?tex=p+%C3%97+n&quot; alt=&quot;p × n&quot; eeimg=&quot;1&quot;/&gt; 阶矩阵，每一行都代表一个 sample moments 的线性组合。本节关心的问题是，&lt;b&gt;如何选取矩阵 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;？&lt;/b&gt;回答这个问题可以从&lt;b&gt;业务上&lt;/b&gt;和&lt;b&gt;统计上&lt;/b&gt;两方面思考 —— &lt;b&gt;永远不要忘记业务层面的思考！从经济学或金融学原理出发，尤其是针对 asset pricing 的问题，我们可以选择一些最 economically important 的 moments，让它们或它们的线性组合等于零。我们不应让 GMM 成为一个 statistical 黑箱，代替我们的思考。&lt;/b&gt;第七节将会进一步说明。&lt;/p&gt;&lt;p&gt;再来从统计上说，Hansen (1982) 指出了一个特殊的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; 矩阵，它能确保得到 efficient GMM estimator，即在给定的 moments &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; 下，该矩阵  &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt;  使得 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt; 最小。这个特殊的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; 矩阵为：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+a%3Dd%5E%5Cprime+S%5E%7B-1%7D&quot; alt=&quot;\displaystyle a=d^\prime S^{-1}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;看到这里可能又有小伙伴会问： &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt;  见过、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt;  见过、转置明白、求逆矩阵清楚，但是这四个符号组合在一起得到的  &lt;img src=&quot;https://www.zhihu.com/equation?tex=d%5E%5Cprime+S%5E%7B-1%7D&quot; alt=&quot;d^\prime S^{-1}&quot; eeimg=&quot;1&quot;/&gt;  是个什么鬼？？这个 &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; 到底有没有什么更直观的含义？别急，先来看看  &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt;  的阶数。本文的 3.2 节已经指出  &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt;  是一个 &lt;img src=&quot;https://www.zhihu.com/equation?tex=p+%C3%97+n&quot; alt=&quot;p × n&quot; eeimg=&quot;1&quot;/&gt; 阶矩阵，下面我们来验证一下。&lt;/p&gt;&lt;p&gt;前面首次提到 &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt; 的时候说过了，它是一阶偏导数  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%E2%88%82g_T%2F%E2%88%82b%5E%5Cprime&quot; alt=&quot;∂g_T/∂b^\prime&quot; eeimg=&quot;1&quot;/&gt; 。但由于 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; （ &lt;img src=&quot;https://www.zhihu.com/equation?tex=n+%C3%97+1&quot; alt=&quot;n × 1&quot; eeimg=&quot;1&quot;/&gt; 阶）和  &lt;img src=&quot;https://www.zhihu.com/equation?tex=b&quot; alt=&quot;b&quot; eeimg=&quot;1&quot;/&gt; （ &lt;img src=&quot;https://www.zhihu.com/equation?tex=p+%C3%97+1&quot; alt=&quot;p × 1&quot; eeimg=&quot;1&quot;/&gt; 阶）都是 vectors，因此  &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt;  是一个遵照 numerator layout（也称作 Jacobian formulation）排列的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=n+%C3%97+p&quot; alt=&quot;n × p&quot; eeimg=&quot;1&quot;/&gt; 阶矩阵。因此矩阵  &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt;  的转置  &lt;img src=&quot;https://www.zhihu.com/equation?tex=d%5E%5Cprime&quot; alt=&quot;d^\prime&quot; eeimg=&quot;1&quot;/&gt;  就是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=p+%C3%97+n&quot; alt=&quot;p × n&quot; eeimg=&quot;1&quot;/&gt; 的矩阵，它同样也是一个一阶偏导数  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%E2%88%82g_T%5E%5Cprime%2F%E2%88%82b&quot; alt=&quot;∂g_T^\prime/∂b&quot; eeimg=&quot;1&quot;/&gt;  —— 这次转置在 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; 上，遵循的是 denominator layout（也称 Hessian formulation），通常表示&lt;b&gt;求梯度（gradient）&lt;/b&gt;。最后，由于 &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt; 是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=n+%C3%97+n&quot; alt=&quot;n × n&quot; eeimg=&quot;1&quot;/&gt; 阶，因此 a 确实是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=p+%C3%97+n&quot; alt=&quot;p × n&quot; eeimg=&quot;1&quot;/&gt; 阶。&lt;/p&gt;&lt;p&gt;下面我们就来看看 &lt;img src=&quot;https://www.zhihu.com/equation?tex=d%5E%5Cprime+S%5E%7B-1%7D&quot; alt=&quot;d^\prime S^{-1}&quot; eeimg=&quot;1&quot;/&gt; 到底是个什么鬼。其实它有着非常清晰的含义。为了解释 &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; 就不得不提 GMM estimator 的另一种表达式，这可能也是之前接触过 GMM 的小伙伴更熟悉的一种表达式：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Chat+b%3D+%5Carg%5Cmin+g_T%28b%29%5E%5Cprime+Wg_T%28b%29&quot; alt=&quot;\displaystyle\hat b= \arg\min g_T(b)^\prime Wg_T(b)&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;上式中  &lt;img src=&quot;https://www.zhihu.com/equation?tex=W&quot; alt=&quot;W&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt; 是权重矩阵（weighting matrix）&lt;/b&gt;，它是一个半正定矩阵。这个式子的含义是，在 overidentification 问题中，既然我们无法让所有的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; 都等于零，那么就让所有  &lt;img src=&quot;https://www.zhihu.com/equation?tex=n&quot; alt=&quot;n&quot; eeimg=&quot;1&quot;/&gt;  个  &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt;  的范数的加权之和尽可能的接近零，以此来确定 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; 。&lt;/p&gt;&lt;p&gt;正如在本文的第一种 GMM estimator 表达中我们可以随意选择矩阵  &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt;  一样，在上面的第二种 GMM estimator 表达中我们可以随意选择权重矩阵  &lt;img src=&quot;https://www.zhihu.com/equation?tex=W&quot; alt=&quot;W&quot; eeimg=&quot;1&quot;/&gt; 。但是从 efficiency 的角度，最优的权重矩阵  &lt;img src=&quot;https://www.zhihu.com/equation?tex=W&quot; alt=&quot;W&quot; eeimg=&quot;1&quot;/&gt;  满足：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+W%3DS%5E%7B-1%7D&quot; alt=&quot;\displaystyle W=S^{-1}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;这从统计上非常好理解：我们有一组 moments &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; ，我们希望它们（非负）加权之和最接近零。使用 &lt;img src=&quot;https://www.zhihu.com/equation?tex=W+%3D+S%5E%7B-1%7D&quot; alt=&quot;W = S^{-1}&quot; eeimg=&quot;1&quot;/&gt; 即 &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt; 的&lt;b&gt;逆矩阵&lt;/b&gt;（别忘了 &lt;img src=&quot;https://www.zhihu.com/equation?tex=S%2FT&quot; alt=&quot;S/T&quot; eeimg=&quot;1&quot;/&gt; 是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28b_0%29%29&quot; alt=&quot;\mbox{var}(g_T(b_0))&quot; eeimg=&quot;1&quot;/&gt; ）&lt;b&gt;相当于给那些 sampling variation&lt;/b&gt; &lt;b&gt;大的 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 更低的权重、给那些 sampling variation&lt;/b&gt; &lt;b&gt;小的 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 更高的权重（inverse 的意义）。换句话说，我们更愿意相信那些误差小的 moments 并使用它们来得到尽可能准确的参数估计 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;，从而使 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 最低，这也就是 efficient 的含义。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;将 &lt;img src=&quot;https://www.zhihu.com/equation?tex=W+%3D+S%5E%7B-1%7D&quot; alt=&quot;W = S^{-1}&quot; eeimg=&quot;1&quot;/&gt; 代入上面第二个 GMM estimator 并求其 first order condition 有：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+%5Cleft%28%5Cfrac%7B%5Cpartial+g_T%5E%5Cprime%7D%7B%5Cpartial+b%7DS%5E%7B-1%7D%5Cright%29g_T%28%5Chat+b%29%3D0&quot; alt=&quot;\displaystyle \left(\frac{\partial g_T^\prime}{\partial b}S^{-1}\right)g_T(\hat b)=0&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;怎么样，看着眼熟不？括号里的第一项正是  &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt;  的转置  &lt;img src=&quot;https://www.zhihu.com/equation?tex=d%5E%5Cprime&quot; alt=&quot;d^\prime&quot; eeimg=&quot;1&quot;/&gt; ，第二项是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=S%5E%7B-1%7D&quot; alt=&quot;S^{-1}&quot; eeimg=&quot;1&quot;/&gt; ，这两个放一起  &lt;img src=&quot;https://www.zhihu.com/equation?tex=d%5E%5Cprime+S%5E%7B-1%7D&quot; alt=&quot;d^\prime S^{-1}&quot; eeimg=&quot;1&quot;/&gt;  正是第一种 GMM estimator 下最优的矩阵 &lt;img src=&quot;https://www.zhihu.com/equation?tex=a+%3D+d%5E%5Cprime+S%5E%7B-1%7D&quot; alt=&quot;a = d^\prime S^{-1}&quot; eeimg=&quot;1&quot;/&gt; ：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brrl%7D+%26%5Cmbox%7BGMM+estimator+%7DW%3DS%5E%7B-1%7D%3A%26%5Cdisplaystyle%5Chat+b%3D+%5Carg%5Cmin+g_T%28b%29%5E%5Cprime+S%5E%7B-1%7Dg_T%28b%29%5C%5C+%5CRightarrow%26%5Cmbox%7Bfirst+order+condition%7D%3A%26%5Cdisplaystyle+%5Cleft%28%5Cfrac%7B%5Cpartial+g_T%5E%5Cprime%7D%7B%5Cpartial+b%7DS%5E%7B-1%7D%5Cright%29g_T%28%5Chat+b%29%3D0%5C%5C+%5CRightarrow%26%26%5Cdisplaystyle+%5Cleft%28%5Cleft%5B%5Cfrac%7B%5Cpartial+g_T%7D%7B%5Cpartial+b%5E%5Cprime%7D%5Cright%5D%5E%5Cprime+S%5E%7B-1%7D%5Cright%29g_T%28%5Chat+b%29%3D0%5C%5C+%5CRightarrow%26%26%5Cdisplaystyle+%5Cleft%28d%5E%5Cprime+S%5E%7B-1%7D%5Cright%29g_T%28%5Chat+b%29%3D0%5C%5C+%5CRightarrow%26%5Cmbox%7BGMM+estimator+%7Da%3Dd%5E%5Cprime+S%5E%7B-1%7D%3A%26%5Cdisplaystyle+ag_T%28%5Chat+b%29%3D0+%5Cend%7Barray%7D&quot; alt=&quot;\begin{array}{rrl} &amp;amp;\mbox{GMM estimator }W=S^{-1}:&amp;amp;\displaystyle\hat b= \arg\min g_T(b)^\prime S^{-1}g_T(b)\\ \Rightarrow&amp;amp;\mbox{first order condition}:&amp;amp;\displaystyle \left(\frac{\partial g_T^\prime}{\partial b}S^{-1}\right)g_T(\hat b)=0\\ \Rightarrow&amp;amp;&amp;amp;\displaystyle \left(\left[\frac{\partial g_T}{\partial b^\prime}\right]^\prime S^{-1}\right)g_T(\hat b)=0\\ \Rightarrow&amp;amp;&amp;amp;\displaystyle \left(d^\prime S^{-1}\right)g_T(\hat b)=0\\ \Rightarrow&amp;amp;\mbox{GMM estimator }a=d^\prime S^{-1}:&amp;amp;\displaystyle ag_T(\hat b)=0 \end{array}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;这就是最优矩阵  &lt;img src=&quot;https://www.zhihu.com/equation?tex=a+%3D+d%5E%5Cprime+S%5E%7B-1%7D&quot; alt=&quot;a = d^\prime S^{-1}&quot; eeimg=&quot;1&quot;/&gt;  的含义。从上面的推导也不难看出这两种 GMM estimator 表达式是等价的：无论我们取何种  &lt;img src=&quot;https://www.zhihu.com/equation?tex=W&quot; alt=&quot;W&quot; eeimg=&quot;1&quot;/&gt;  权重矩阵，都有一个与之对应的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=a+%3D+d%5E%5Cprime+W&quot; alt=&quot;a = d^\prime W&quot; eeimg=&quot;1&quot;/&gt; 矩阵。当矩阵  &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt;  或权重矩阵  &lt;img src=&quot;https://www.zhihu.com/equation?tex=W&quot; alt=&quot;W&quot; eeimg=&quot;1&quot;/&gt;  取统计上最优时， &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+b%29&quot; alt=&quot;\mbox{var}(\hat b)&quot; eeimg=&quot;1&quot;/&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29&quot; alt=&quot;\mbox{var}(g_T(\hat b))&quot; eeimg=&quot;1&quot;/&gt; 以及 chi-squared test statistic 的表达式均可以大大化简。Hansen (1982) 给出了它们的形式：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+%5Cmbox%7Bvar%7D%28%5Chat+b%29%26%3D%26%5Cdisplaystyle%5Cfrac%7B1%7D%7BT%7D%5Cleft%28d%5E%5Cprime+S%5E%7B-1%7Dd%5Cright%29%5E%7B-1%7D%5C%5C+%5Cmbox%7Bvar%7D%28g_T%28%5Chat+b%29%29%26%3D%26%5Cdisplaystyle%5Cfrac%7B1%7D%7BT%7D%5Cleft%28S-d%28d%5E%5Cprime+S%5E%7B-1%7Dd%29%5E%7B-1%7Dd%5E%5Cprime%5Cright%29%5C%5C+Tg_T%28%5Chat+b%29%5E%5Cprime+S%5E%7B-1%7Dg_T%28%5Chat+b%29%26%5Csim%26%5Cchi%5E2_%7Bn-p%7D+%5Cend%7Barray%7D&quot; alt=&quot;\begin{array}{rll} \mbox{var}(\hat b)&amp;amp;=&amp;amp;\displaystyle\frac{1}{T}\left(d^\prime S^{-1}d\right)^{-1}\\ \mbox{var}(g_T(\hat b))&amp;amp;=&amp;amp;\displaystyle\frac{1}{T}\left(S-d(d^\prime S^{-1}d)^{-1}d^\prime\right)\\ Tg_T(\hat b)^\prime S^{-1}g_T(\hat b)&amp;amp;\sim&amp;amp;\chi^2_{n-p} \end{array}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;&lt;b&gt;需要强调的是，以上的这些大大简化了的表达式只有当 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=a+%3D+d%5E%5Cprime+S%5E%7B-1%7D&quot; alt=&quot;a = d^\prime S^{-1}&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;（或 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=W+%3D+S%5E%7B-1%7D&quot; alt=&quot;W = S^{-1}&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;）时才成立！如果 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt; 或 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=W&quot; alt=&quot;W&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt; 取别的值，则应该使用本文第 4 节中介绍的更 general 的形式。&lt;/b&gt;很多关于 GMM 的材料中默认 &lt;img src=&quot;https://www.zhihu.com/equation?tex=W+%3D+S%5E%7B-1%7D&quot; alt=&quot;W = S^{-1}&quot; eeimg=&quot;1&quot;/&gt; 而给出了这些统计量的简化形式，使用时应搞清楚前提条件。&lt;/p&gt;&lt;p&gt;在实际估计中，因为必须先有 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; 才能估计  &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt; ，并计算 &lt;img src=&quot;https://www.zhihu.com/equation?tex=W+%3D+S%5E%7B-1%7D&quot; alt=&quot;W = S^{-1}&quot; eeimg=&quot;1&quot;/&gt; （或最优的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; ）；但另一方面只有使用 &lt;img src=&quot;https://www.zhihu.com/equation?tex=S%5E%7B-1%7D&quot; alt=&quot;S^{-1}&quot; eeimg=&quot;1&quot;/&gt; 才能得到最优的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; 。这似乎是一个鸡生蛋、蛋生鸡的问题。因此，实际中往往采用 two-stage estimates：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;First Stage：&lt;/b&gt;通常取 &lt;img src=&quot;https://www.zhihu.com/equation?tex=W+%3D+I&quot; alt=&quot;W = I&quot; eeimg=&quot;1&quot;/&gt; 单位阵，估计出 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; ；&lt;/li&gt;&lt;li&gt;&lt;b&gt;Second Stage：&lt;/b&gt;使用  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt;  估计 S，令 &lt;img src=&quot;https://www.zhihu.com/equation?tex=W+%3D+S%5E%7B-1%7D&quot; alt=&quot;W = S^{-1}&quot; eeimg=&quot;1&quot;/&gt; 进行再一次估计得到新的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; 。&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;当然，如果愿意，也可以把上面的第二步&lt;b&gt;迭代多次&lt;/b&gt;，得到最终的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Chat+b&quot; alt=&quot;\hat b&quot; eeimg=&quot;1&quot;/&gt; 。以上就完成了关于 GMM 的全部介绍。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;06 GMM does OLS&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;GMM 之所以如此强大，是因为它自带的“estimate、variance、test”三部曲能够干很多事儿！对于很多需要研究的问题，只要把它的模型塞进 GMM 的框架，就可以得到想要的分析结果。&lt;/p&gt;&lt;p&gt;本节就把我们熟悉的 OLS 放在 GMM 的框架下看看后者的强大之处。由于参数个数和 moments 个数相同，因此 OLS 不存在 overidentification 的问题，我们没有什么可以检验的。但是 GMM 仍然可以轻松的计算出参数的 variance（即完成 estimate 和 variance 两步），无论 OLS 的残差是否存在自相关或异方差。&lt;/p&gt;&lt;p&gt;想要使用 GMM 框架，只需要把 OLS 表述成 moment conditions。考虑 OLS 问题（截距被视作一个解释变量，不做区分；假设一共有  &lt;img src=&quot;https://www.zhihu.com/equation?tex=k&quot; alt=&quot;k&quot; eeimg=&quot;1&quot;/&gt;  个解释变量，因此 &lt;img src=&quot;https://www.zhihu.com/equation?tex=x_t&quot; alt=&quot;x_t&quot; eeimg=&quot;1&quot;/&gt; 表示 &lt;img src=&quot;https://www.zhihu.com/equation?tex=k+%C3%97+1&quot; alt=&quot;k × 1&quot; eeimg=&quot;1&quot;/&gt; 阶向量）如下：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+y_t%3D%5Cbeta%5E%5Cprime+x_t%2B%5Cvarepsilon_t&quot; alt=&quot;\displaystyle y_t=\beta^\prime x_t+\varepsilon_t&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;由 OLS 的性质可知，其解释变量和残差正交，因此 OLS 的 moment conditions 为：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T%28%5Chat%5Cbeta%29%3D%5Cmbox%7BE%7D_T%5Cleft%5Bx_t%28y_t-%5Chat%5Cbeta%5E%5Cprime+x_t%29%5Cright%5D%3D0&quot; alt=&quot;g_T(\hat\beta)=\mbox{E}_T\left[x_t(y_t-\hat\beta^\prime x_t)\right]=0&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;由于 moments 个数和参数个数相同，因此我们只需要令所有 sample moments 都等于零即可，这意味着矩阵 &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; 是单位阵 &lt;img src=&quot;https://www.zhihu.com/equation?tex=I&quot; alt=&quot;I&quot; eeimg=&quot;1&quot;/&gt; ，因此在上式的 GMM estimator 中省略了  &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; 。求解上述 sample moment conditions 就可以得到参数的估计：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Chat%5Cbeta%3D%5Cleft%5B%5Cmbox%7BE%7D_T%28x_tx_t%5E%5Cprime%29%5Cright%5D%5E%7B-1%7D%5Cmbox%7BE%7D_T%28x_ty_t%29&quot; alt=&quot;\displaystyle\hat\beta=\left[\mbox{E}_T(x_tx_t^\prime)\right]^{-1}\mbox{E}_T(x_ty_t)&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;如果令  &lt;img src=&quot;https://www.zhihu.com/equation?tex=X+%3D+%5Bx_1+x_2+%E2%80%A6+x_t%5D%5E%5Cprime&quot; alt=&quot;X = [x_1 x_2 … x_t]^\prime&quot; eeimg=&quot;1&quot;/&gt;  表示 data matrix，则有 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%281%2FT%29X%5E%5Cprime+X+%3D+%5Cmbox%7BE%7D_T%5Bx_tx_t%5E%5Cprime%5D&quot; alt=&quot;(1/T)X^\prime X = \mbox{E}_T[x_tx_t^\prime]&quot; eeimg=&quot;1&quot;/&gt; ，因此上式又可以写成：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle%5Chat%5Cbeta%3D%5Cleft%5B%5Cmbox%7BE%7D_T%28x_tx_t%5E%5Cprime%29%5Cright%5D%5E%7B-1%7D%5Cmbox%7BE%7D_T%28x_ty_t%29%3D%28X%5E%5Cprime+X%29%5E%7B-1%7DX%5E%5Cprime+Y&quot; alt=&quot;\displaystyle\hat\beta=\left[\mbox{E}_T(x_tx_t^\prime)\right]^{-1}\mbox{E}_T(x_ty_t)=(X^\prime X)^{-1}X^\prime Y&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;这正是我们熟悉的 OLS estimator。GMM 的强大之处在于轻松的计算 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+%CE%B2%29&quot; alt=&quot;\mbox{var}(\hat β)&quot; eeimg=&quot;1&quot;/&gt; 。为此，我们需要给 GMM 框架提供它所需要的  &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt;  和  &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt; （已经有了  &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt;  和  &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; ）。根据  &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt;  和  &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt;  的定义可得：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+d%26%3D%26-%5Cmbox%7BE%7D%5Bx_tx_t%5E%5Cprime%5D%5C%5C+f%28x_t%2C+%5Cbeta%29%26%3D%26x_t%5Cvarepsilon_t%5C%5C+S%26%3D%26%5Cdisplaystyle%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D%5Cmbox%7BE%7D%5B%5Cvarepsilon_tx_tx_%7Bt-j%7D%5E%5Cprime%5Cvarepsilon_%7Bt-j%7D%5D+%5Cend%7Barray%7D&quot; alt=&quot;\begin{array}{rll} d&amp;amp;=&amp;amp;-\mbox{E}[x_tx_t^\prime]\\ f(x_t, \beta)&amp;amp;=&amp;amp;x_t\varepsilon_t\\ S&amp;amp;=&amp;amp;\displaystyle\sum_{j=-\infty}^{\infty}\mbox{E}[\varepsilon_tx_tx_{t-j}^\prime\varepsilon_{t-j}] \end{array}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;有了 &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt; ，直接利用 GMM 中的公式就可以求出 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+%CE%B2%29&quot; alt=&quot;\mbox{var}(\hat β)&quot; eeimg=&quot;1&quot;/&gt; ：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+%5Cmbox%7Bvar%7D%28%5Chat%5Cbeta%29%3D%5Cfrac%7B1%7D%7BT%7D%5Cmbox%7BE%7D%5Bx_tx_t%5E%5Cprime%5D%5E%7B-1%7D%5Cleft%5B%5Csum_%7Bj%3D-%5Cinfty%7D%5E%7B%5Cinfty%7D%5Cmbox%7BE%7D%5B%5Cvarepsilon_tx_tx_%7Bt-j%7D%5E%5Cprime%5Cvarepsilon_%7Bt-j%7D%5D%5Cright%5D%5Cmbox%7BE%7D%5Bx_tx_t%5E%5Cprime%5D%5E%7B-1%7D&quot; alt=&quot;\displaystyle \mbox{var}(\hat\beta)=\frac{1}{T}\mbox{E}[x_tx_t^\prime]^{-1}\left[\sum_{j=-\infty}^{\infty}\mbox{E}[\varepsilon_tx_tx_{t-j}^\prime\varepsilon_{t-j}]\right]\mbox{E}[x_tx_t^\prime]^{-1}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;这正是广义 OLS 下 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+%CE%B2%29&quot; alt=&quot;\mbox{var}(\hat β)&quot; eeimg=&quot;1&quot;/&gt; 的表达式（请参考&lt;a href=&quot;https://zhuanlan.zhihu.com/p/54913149&quot; class=&quot;internal&quot;&gt;《多因子回归检验中的 Newey-West 调整》&lt;/a&gt;对比）。&lt;/p&gt;&lt;p&gt;We are done!&lt;/p&gt;&lt;p&gt;下面考察几种情况。首先如果残差满足 i.i.d.， &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+%CE%B2%29&quot; alt=&quot;\mbox{var}(\hat β)&quot; eeimg=&quot;1&quot;/&gt; 就可以简化成我们最熟悉的样子：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+%5Cmbox%7Bvar%7D%28%5Chat%5Cbeta%29%3D%5Cfrac%7B1%7D%7BT%7D%5Csigma_%7B%5Cvarepsilon%7D%5E2%5Cmbox%7BE%7D%5Bx_tx_t%5E%5Cprime%5D%5E%7B-1%7D%3D%5Csigma_%7B%5Cvarepsilon%7D%5E2%5Cleft%28X%5E%5Cprime+X%5Cright%29%5E%7B-1%7D&quot; alt=&quot;\displaystyle \mbox{var}(\hat\beta)=\frac{1}{T}\sigma_{\varepsilon}^2\mbox{E}[x_tx_t^\prime]^{-1}=\sigma_{\varepsilon}^2\left(X^\prime X\right)^{-1}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;通常来说，残差中可能存在异方差、自相关或者两者皆有。在 GMM 的框架下，为了计算 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+%CE%B2%29&quot; alt=&quot;\mbox{var}(\hat β)&quot; eeimg=&quot;1&quot;/&gt; 仅需要在  &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt;  矩阵中考虑异方差和自相关造成的影响。当残差仅存在异方差时， &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt;  的表达式为：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+S%3D%5Cmbox%7BE%7D%5B%5Cvarepsilon_t%5E2x_tx_t%27%5D&quot; alt=&quot;\displaystyle S=\mbox{E}[\varepsilon_t^2x_tx_t&amp;#39;]&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;因此 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+%CE%B2%29&quot; alt=&quot;\mbox{var}(\hat β)&quot; eeimg=&quot;1&quot;/&gt; 的表达式变成：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+%5Cmbox%7Bvar%7D%28%5Chat%5Cbeta%29%3D%5Cfrac%7B1%7D%7BT%7D%5Cmbox%7BE%7D%5Bx_tx_t%5E%5Cprime%5D%5E%7B-1%7D%5Cmbox%7BE%7D%5B%5Cvarepsilon_t%5E2x_tx_t%5E%5Cprime%5D%5Cmbox%7BE%7D%5Bx_tx_t%5E%5Cprime%5D%5E%7B-1%7D&quot; alt=&quot;\displaystyle \mbox{var}(\hat\beta)=\frac{1}{T}\mbox{E}[x_tx_t^\prime]^{-1}\mbox{E}[\varepsilon_t^2x_tx_t^\prime]\mbox{E}[x_tx_t^\prime]^{-1}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;这正是大名鼎鼎的 White (1980) heteroscedasticity consistent estimator。&lt;/p&gt;&lt;p&gt;当残差即存在异方差又存在自相关时， &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt; 可以写作：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+S%3D%5Csum_%7Bj%3D-k%7D%5Ek+w_j%5Cmbox%7BE%7D%5B%5Cvarepsilon_tx_tx_%7Bt-j%7D%27%5Cvarepsilon_%7Bt-j%7D%5D&quot; alt=&quot;\displaystyle S=\sum_{j=-k}^k w_j\mbox{E}[\varepsilon_tx_tx_{t-j}&amp;#39;\varepsilon_{t-j}]&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;而 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmbox%7Bvar%7D%28%5Chat+%CE%B2%29&quot; alt=&quot;\mbox{var}(\hat β)&quot; eeimg=&quot;1&quot;/&gt; 的表达式变成：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+%5Cmbox%7Bvar%7D%28%5Chat%5Cbeta%29%3D%5Cfrac%7B1%7D%7BT%7D%5Cmbox%7BE%7D%5Bx_tx_t%5E%5Cprime%5D%5E%7B-1%7D%5Cleft%5B%5Csum_%7Bj%3D-k%7D%5Ek+w_j%5Cmbox%7BE%7D%5B%5Cvarepsilon_tx_tx_%7Bt-j%7D%27%5Cvarepsilon_%7Bt-j%7D%5D%5Cright%5D%5Cmbox%7BE%7D%5Bx_tx_t%5E%5Cprime%5D%5E%7B-1%7D&quot; alt=&quot;\displaystyle \mbox{var}(\hat\beta)=\frac{1}{T}\mbox{E}[x_tx_t^\prime]^{-1}\left[\sum_{j=-k}^k w_j\mbox{E}[\varepsilon_tx_tx_{t-j}&amp;#39;\varepsilon_{t-j}]\right]\mbox{E}[x_tx_t^\prime]^{-1}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;这正是大名鼎鼎的 Newey and West (1987) autocorrelation consistent covariance estimator（见&lt;a href=&quot;https://zhuanlan.zhihu.com/p/54913149&quot; class=&quot;internal&quot;&gt;《多因子回归检验中的 Newey-West 调整》&lt;/a&gt;）。&lt;/p&gt;&lt;p&gt;无论残差具有什么特性，整个 OLS 的求解过程都可以很好的装到 GMM 的框架中。而当使用 GMM 框架时，只需按照它的要求来定义  &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt;  以及  &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt; ，就可以“无脑”的利用 GMM 给出的结果。这正是 GMM 的强大之处。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;07 不应成为黑箱&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;在结束本文之前，再花一小节讨论一个很重要的问题：&lt;b&gt;GMM 不应该成为计量学黑箱。&lt;/b&gt;这是我听完 Cochrane 教授的讲解后印象非常深刻的一点。&lt;/p&gt;&lt;p&gt;GMM 如此强大再加上现在各种编程语言（R、Stata 等）都能方便的计算，这种便捷性似乎把人们都惯坏了；&lt;b&gt;人们习惯于把问题描述成 moment conditions 然后一股脑塞进 GMM 并纯从统计的角度使用 efficient estimator（即 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=W+%3D+S%5E%7B-1%7D&quot; alt=&quot;W = S^{-1}&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;）。&lt;/b&gt;Cochrane 教授警告说这么做十分危险。&lt;/p&gt;&lt;p&gt;&lt;b&gt;GMM 的强大之处在于它不仅仅是一个计量学工具来做 test，而是它足够 flexible 从而可以让我们研究我们真正关心的经济学或金融学问题，这体现在我们可以从“先验”出发去定义最适合待研究问题的矩阵 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;（或权重矩阵 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=W&quot; alt=&quot;W&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;），而非无脑的选择 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=W+%3D+S%5E%7B-1%7D&quot; alt=&quot;W = S^{-1}&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;以 3.2 节中 asset pricing 的例子来说，我们有四个 moments，两个参数。这四个 moments 来自四个资产：risk-free、市场组合以及 HML 和 SMB，我们假设待检验的模型是 CCAPM。从经济学业务出发，我们可以选择如下的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=ag_T%28%5Chat+b%29+%3D+0&quot; alt=&quot;ag_T(\hat b) = 0&quot; eeimg=&quot;1&quot;/&gt; ：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cleft%5B+%5Cbegin%7Barray%7D%7Bcccc%7D+1%260%260%260%5C%5C+0%261%260%260+%5Cend%7Barray%7D+%5Cright%5D+%5Cleft%5B+%5Cbegin%7Barray%7D%7Bl%7D+%5Cmbox%7BE%7D_T%5Bm%28%5Chat%5Cbeta%2C%5Chat%5Cgamma%29R%5Ee_m%5D%5C%5C+%5Cmbox%7BE%7D_T%5Bm%28%5Chat%5Cbeta%2C%5Chat%5Cgamma%29R_f-1%5D%5C%5C+%5Cmbox%7BE%7D_T%5Bm%28%5Chat%5Cbeta%2C%5Chat%5Cgamma%29R%5E%7B%5Cmbox%7BHML%7D%7D%5D%5C%5C+%5Cmbox%7BE%7D_T%5Bm%28%5Chat%5Cbeta%2C%5Chat%5Cgamma%29R%5E%7B%5Cmbox%7BSMB%7D%7D%5D+%5Cend%7Barray%7D+%5Cright%5D%3D+%5Cleft%5B+%5Cbegin%7Barray%7D%7Bc%7D+0%5C%5C0+%5Cend%7Barray%7D+%5Cright%5D&quot; alt=&quot;\left[ \begin{array}{cccc} 1&amp;amp;0&amp;amp;0&amp;amp;0\\ 0&amp;amp;1&amp;amp;0&amp;amp;0 \end{array} \right] \left[ \begin{array}{l} \mbox{E}_T[m(\hat\beta,\hat\gamma)R^e_m]\\ \mbox{E}_T[m(\hat\beta,\hat\gamma)R_f-1]\\ \mbox{E}_T[m(\hat\beta,\hat\gamma)R^{\mbox{HML}}]\\ \mbox{E}_T[m(\hat\beta,\hat\gamma)R^{\mbox{SMB}}] \end{array} \right]= \left[ \begin{array}{c} 0\\0 \end{array} \right]&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;在这个矩阵  &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt;  中，我们令市场超额收益和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=R_f+&quot; alt=&quot;R_f &quot; eeimg=&quot;1&quot;/&gt; 完美满足两个 sample moment conditions，并由此进行 CCAPM 的参数估计，求出两个参数，然后使用另外两个资产 HML 和 SMB 来检验 CCAPM。由 GMM 框架可知，最终的 chi-squared test statistic 的自由度为 2（因为一共 4 个资产，2 个被用来估计参数），因此联合检验的实际上正是 HML 和 SMB 在 CCAPM 这个定价模型下的 pricing errors。如果 pricing errors 联合显著不为零，那么就可以拒绝 CCAPM。这个例子说明，&lt;b&gt;从经济学原理出发选择合适的 a 或 W 能让我们回答最感兴趣的经济学问题。&lt;/b&gt;GMM 的强大之处正在于此。&lt;/p&gt;&lt;p&gt;纯从统计学的角度来说， &lt;img src=&quot;https://www.zhihu.com/equation?tex=W+%3D+S%5E%7B-1%7D&quot; alt=&quot;W = S^{-1}&quot; eeimg=&quot;1&quot;/&gt; 确实能够得到 efficient GMM。但不要忘记，这个 efficient 的是以给定的 moments 为前提的 —— 如果换了或者添加了更多的 moments，参数的 efficient 估计也会发生变化。在金融市场中，有无数的资产，包括股票、债券、外汇、商品等，还有无数的投资组合，这些资产可以构成无数的 moments。为了 efficiency，我们应该把这成千上万资产的 moments 都塞进 GMM 才能得到 efficient 的估计。但显然，从业务的角度来说这毫无意义。在研究资产定价的时候，我们应该使用最“clever”的资产，比如 HML、SMB 这些投资组合。它们才是我们真正关心的问题。&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;The quest for efficiency doesn&amp;#39;t really drive us as much as the quest for something that is robust and that expresses what the model is supposed to do. —— John Cochrane&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;b&gt;GMM 非常好使，但在 asset pricing 的研究中，我们不应追求使用 GMM 进行一个仅在统计上正式但模型却缺乏含义的 statistical test。GMM 的强大在于它让我们从经济学和金融学原理出发，去 measure 和 estimate 最合理的模型、并同时对 sampling error 保持足够的认识。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;不要让 GMM 成为计量学的黑箱。&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;08 结语&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;呼！终于写完了！感谢你看到这里！&lt;/p&gt;&lt;p&gt;作为感谢，上点硬货 —— GMM 的 formula sheet（出自 Cochrane 2005）。它总结了前文解读的每一个公式。网上能找到的 Asset Pricing 的电子版还是 2000 年 6 月的版本，有不少 Typo。这张截图是来自 2005 年的修订版。怎么样？&lt;b&gt;GMM 其实并不复杂，我们只需要提供并计算 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;，&lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;，&lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=d+&quot; alt=&quot;d &quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;和 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;；有了它们，GMM 框架 takes care of everything else！&lt;/b&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-3dae1f9979c74ebe0a02ae47a70661cc_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;993&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-3dae1f9979c74ebe0a02ae47a70661cc_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-3dae1f9979c74ebe0a02ae47a70661cc_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;993&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-3dae1f9979c74ebe0a02ae47a70661cc_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-3dae1f9979c74ebe0a02ae47a70661cc_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;最后对全文简要总结如下：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;b&gt;GMM 的框架下包括 model、estimate 以及 test 三部分；它用 sample moments 代替 population moments 来检验后者；GMM 涉及的数学（不那么严谨的说）可以归结为 the variance of the sample mean + delta method。&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;从 notation 的角度，我们只需找到 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;、&lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=g_T&quot; alt=&quot;g_T&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;、&lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=d&quot; alt=&quot;d&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt; 和 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=S&quot; alt=&quot;S&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;，剩下的交给 GMM 的公式；&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;GMM 允许我们自由挑选矩阵 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;（或 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=W&quot; alt=&quot;W&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;）；从统计学的角度存在一个特定的 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=a&quot; alt=&quot;a&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;（或 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=W&quot; alt=&quot;W&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt;）是最 efficient 的；但 GMM 不应被当作计量学的黑箱，理解你所研究的问题永远是最重要的。&lt;/b&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;写完本文，我的感受和写完&lt;a href=&quot;https://zhuanlan.zhihu.com/p/40984029&quot; class=&quot;internal&quot;&gt;《股票多因子模型的回归检验》&lt;/a&gt;是一模一样的，对 Cochrane 教授崇拜的五体投地。关于 GMM 的内容，Cochrane 教授在其 UChicago 的课程中介绍的非常生动、到位，听完再结合他的书仔细体会，那收获就一个字 —— 爽！&lt;/p&gt;&lt;p&gt;最后，我想用和&lt;a href=&quot;https://zhuanlan.zhihu.com/p/40984029&quot; class=&quot;internal&quot;&gt;《股票多因子模型的回归检验》&lt;/a&gt;一文同样的结语作为本文的收尾。在介绍 Asset Pricing 这门课的时候，Cochrane 教授谈到：&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;The math in real, academic, finance is not actually that hard. Understanding how to use the equations, and see what they really mean about the world... that&amp;#39;s hard, and that&amp;#39;s what I hope will be uniquely rewarding about this class.&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;再一次的，我也真心希望本文在你理解 GMM 以及应用它研究 asset pricing 的道路上起到一点点帮助。&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;参考文献&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Cochrane, J. H (2005). &lt;i&gt;Asset Pricing (revised edition)&lt;/i&gt;. Princeton University Press.&lt;/li&gt;&lt;li&gt;Fama, E. F. and K. R. French (1993). Common Risk Factors in the Returns on Stocks and Bonds. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 33(1), 3 – 56.&lt;/li&gt;&lt;li&gt;Hansen, L. P. (1982). Large sample properties of generalized method of moments estimators. &lt;i&gt;Econometrica&lt;/i&gt;, Vol. 50(4), 1029 – 1054.&lt;/li&gt;&lt;li&gt;Newey, W. K. and K. D. West (1987). A simple, positive semi-definite, heteroskedasticity and autocorrelation consistent covariance matrix. &lt;i&gt;Econometrica&lt;/i&gt;, Vol. 55(3), 703 – 708.&lt;/li&gt;&lt;li&gt;White, H. (1980). A heteroskedasticity-consistent covariance matrix estimator and a direct test for heteroskedasticity. &lt;i&gt;Econometrica&lt;/i&gt;, Vol. 48(4), 817 – 838.&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;免责声明：&lt;/b&gt;文章内容不可视为投资意见。市场有风险，入市需谨慎。&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处。已委托“维权骑士”(&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//rightknights.com/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;维权骑士_免费版权监测/版权保护/内容多平台分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2019-11-21-92490417</guid>
<pubDate>Thu, 21 Nov 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>Wikipedia of Trend Following (II)</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2019-11-09-91028298.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/91028298&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-f4268ba0b0326e704f9f7ed1ce25cfb0_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;h2&gt;&lt;b&gt;00 引言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;近日，《贫穷的本质》这本书突然火了。它的英文原作是 Poor Economics，出版于 2011 年，并于当年就斩获了 Financial Times and Goldman Sachs Business Book of the Year Award。中文版《贫穷的本质》早在 2013 年 4 月就由中信出版集团带到了国内。然而它却突然在 2019 年 10 月的某一天火了。究其原因，是因为其作者 —— 来自 MIT 的 Abhijit Banerjee 以及 Esther Duflo 教授 —— 连同 Harvard 的 Michael Kremer 教授分享了 2019 年诺贝尔经济学奖。从该书的作者获奖到该书在国内迅速走红毫无疑问是一个 trend following（趋势追踪）的鲜活实例，而这样的例子每时每刻都发生在我们身边。&lt;/p&gt;&lt;p&gt;在金融市场，trend following 更是最具生命力的一种交易策略。之前，我的好友刀疤连就于趋势追踪写了一篇两万字雄文（&lt;a href=&quot;https://zhuanlan.zhihu.com/p/81421085&quot; class=&quot;internal&quot;&gt;链接在此&lt;/a&gt;，因为该文涉及的内容的广泛性，我称其为 Wikipedia of Trend Following），该文系统阐述了趋势追踪策略的是与非。考虑到我自己之前也写过多篇关于趋势追踪的文章，因此今天也来就这个话题系统梳理一下；我将本文命名为 Wikipedia of Trend Following (II)。本文的正文部分共包含七小节：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;第一节：&lt;/b&gt;时序与截面&lt;/li&gt;&lt;li&gt;&lt;b&gt;第二节：&lt;/b&gt;确定计算趋势的时间尺度&lt;/li&gt;&lt;li&gt;&lt;b&gt;第三节：&lt;/b&gt;哪个趋势指标更好使？&lt;/li&gt;&lt;li&gt;&lt;b&gt;第四节：&lt;/b&gt;移动平均的本质&lt;/li&gt;&lt;li&gt;&lt;b&gt;第五节：&lt;/b&gt;对趋势追踪的正确预期&lt;/li&gt;&lt;li&gt;&lt;b&gt;第六节：&lt;/b&gt;从风险角度看趋势策略&lt;/li&gt;&lt;li&gt;&lt;b&gt;第七节：&lt;/b&gt;结语&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;下面就让我们开启趋势之旅。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;01 时序与截面&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;Trend Following 策略指的是投资者根据资产的上涨或者下跌趋势做出相应的多、空交易。&lt;/b&gt;具体来说，趋势追踪又可以分为时序动量（time-series momentum）和截面动量（cross-sectional momentum）两类。&lt;/p&gt;&lt;p&gt;在时序动量中，投资者做多之前上涨趋势显著的资产、做空之前下跌趋势显著的资产；而在截面动量中，投资者做多在截面上收益率&lt;b&gt;相对&lt;/b&gt;较高的资产、做空在截面上收益率&lt;b&gt;相对&lt;/b&gt;较低的资产。在时序动量中，我们希望资产可以各自延续其在之前的趋势。而在截面动量中，相比于每个资产绝对走势，我们更关注的是它们相对的强弱走势，希望强者恒强、弱者恒弱，因此截面动量又称为 winners-minus-losers 策略。&lt;/p&gt;&lt;p&gt;以下从资产相关性的角度比较一下时序和截面动量的差异。&lt;/p&gt;&lt;p&gt;多样化（diversification）是规避投资风险的重要思想，其体现是将资金分配到不同的资产中。对于时序动量策略来说，要想获得多样化收益（diversification gain），就必须考虑相关性低的资产。Roncalli (2017) 指出，当资产之间的相关性很高时，时序动量策略的表现不会因为资产个数的增加而显著提升。下图为假设资产相关系数为 80% 的情况下，资产个数和时序动量策略年化收益率的累积分布函数的关系。由于资产之间的相关性很高，当资产个数超过 3 时，多样化带来的额外收益就几乎不发生改变了。&lt;b&gt;时序动量喜欢相关性低的资产。&lt;/b&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-35f486968368faaa220f758fc3e3e2b9_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;937&quot; data-rawheight=&quot;419&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;937&quot; data-original=&quot;https://pic2.zhimg.com/v2-35f486968368faaa220f758fc3e3e2b9_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-35f486968368faaa220f758fc3e3e2b9_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;937&quot; data-rawheight=&quot;419&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;937&quot; data-original=&quot;https://pic2.zhimg.com/v2-35f486968368faaa220f758fc3e3e2b9_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-35f486968368faaa220f758fc3e3e2b9_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;与时序动量不同，&lt;b&gt;截面动量策略喜欢相关性高的资产。&lt;/b&gt;同样是来自 Roncalli (2017) 的研究表明，截面动量策略的夏普率随着资产相关性的增加而提高（下图）。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-49e39b60028a698839eaf509285af590_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;942&quot; data-rawheight=&quot;416&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;942&quot; data-original=&quot;https://pic1.zhimg.com/v2-49e39b60028a698839eaf509285af590_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-49e39b60028a698839eaf509285af590_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;942&quot; data-rawheight=&quot;416&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;942&quot; data-original=&quot;https://pic1.zhimg.com/v2-49e39b60028a698839eaf509285af590_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-49e39b60028a698839eaf509285af590_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;一般当人们提到 trend following 的时候，指的往往是时序动量策略，即多、空交易信号根据资产自己上涨或下跌的趋势而构建。&lt;/b&gt;本文接下来的讨论也将围绕时序动量展开。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;02 确定计算趋势的时间尺度&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;想要通过 trend following 策略赚钱，最重要的一点是什么？很多文献告诉我们，趋势追踪中的重中之重包括 trend measure（即选择最优的指标来计算趋势）以及 position sizing（仓位管理）。毫无疑问，这两点对于趋势策略至关重要，但在我看来，&lt;b&gt;更重要的要数选择计算趋势的时间尺度。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;举个例子，Winton Capital（元盛 —— 每当提及趋势追踪时，我脑海中想到的第一个名字）在 2013 年的一篇 research note（Winton 2013）中以下列来自四大类的 20 个资产进行了趋势策略时间尺度的研究。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-89e10ea3a32618611c4b72f6f36978bf_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;722&quot; data-rawheight=&quot;268&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;722&quot; data-original=&quot;https://pic4.zhimg.com/v2-89e10ea3a32618611c4b72f6f36978bf_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-89e10ea3a32618611c4b72f6f36978bf_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;722&quot; data-rawheight=&quot;268&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;722&quot; data-original=&quot;https://pic4.zhimg.com/v2-89e10ea3a32618611c4b72f6f36978bf_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-89e10ea3a32618611c4b72f6f36978bf_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;Winton (2013) 依据趋势追踪策略换手率的高低定义了 fast、medium 以及 slow 三个级别的策略（换手率越高意味着时间尺度越短），并交易上述 20 种资产。风险调整后，这三个级别策略的表现如下图所示。从中不难看出，fast 级别（换手率高）自 2004 年开始就基本失效了，而 medium 和 slow 级别策略在 2004 年之后依然有效；自 2012 年之后，medium 级别策略较其之前的表现也有所减弱，而 slow 级别的表现相对稳健，虽然其绝对收益不如 fast 和 medium 级别。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-defb5906854303986f2ea128876c3337_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;727&quot; data-rawheight=&quot;390&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;727&quot; data-original=&quot;https://pic4.zhimg.com/v2-defb5906854303986f2ea128876c3337_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-defb5906854303986f2ea128876c3337_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;727&quot; data-rawheight=&quot;390&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;727&quot; data-original=&quot;https://pic4.zhimg.com/v2-defb5906854303986f2ea128876c3337_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-defb5906854303986f2ea128876c3337_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;再来看两个离我们更近的例子。下图中，我用&lt;b&gt;同样的参数&lt;/b&gt;分别以上证指数和标普 500 指数为资产，构建了仅做多的趋势追踪策略。结果显示，适合上证指数的趋势参数在标普 500 指数上完全不好使。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-963fc8114660dd1e755c987c4ca85fae_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;731&quot; data-rawheight=&quot;553&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;731&quot; data-original=&quot;https://pic3.zhimg.com/v2-963fc8114660dd1e755c987c4ca85fae_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-963fc8114660dd1e755c987c4ca85fae_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;731&quot; data-rawheight=&quot;553&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;731&quot; data-original=&quot;https://pic3.zhimg.com/v2-963fc8114660dd1e755c987c4ca85fae_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-963fc8114660dd1e755c987c4ca85fae_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;上面的强烈对比说明：&lt;b&gt;趋势策略好使的前提是计算趋势的时间尺度和资产的收益率特征匹配。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;前文&lt;a href=&quot;https://zhuanlan.zhihu.com/p/40358079&quot; class=&quot;internal&quot;&gt;《什么样的收益率特性适合趋势追踪策略》&lt;/a&gt;使用如下的数学模型对上述观点进行了详细的论述，这里简单回顾下。考虑到资产收益率序列通常包含低频均值、非常微弱的自相关性以及白噪声三个部分构成，利用如下步骤人工合成对数收益率：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brrll%7D+%5Cmbox%7BStep+1%3A%7D%26b_0%26%5Csim%26%5Cmathcal%7BN%7D%280%2C+%5Csigma%29%5C%5C+%5Cmbox%7BStep+2%3A%7D%26e_t%26%5Csim%26%5Cmathcal%7BN%7D%280%2C+%5Csigma%29%5C%5C+%5Cmbox%7BStep+3%3A%7D%26b_t%26%3D%26%5Crho%5Ctimes+b_%7Bt-1%7D%2Be_t%2C~~t%3D1%2C2%2C%5Ccdots%5C%5C+%5Cmbox%7BStep+4%3A%7D%26r_t%26%3D%26b_t-%5Cmu_b%2B%5Cmu%2C~~+t%3D0%2C1%2C2%2C%5Ccdots+%5Cend%7Barray%7D&quot; alt=&quot;\begin{array}{rrll} \mbox{Step 1:}&amp;amp;b_0&amp;amp;\sim&amp;amp;\mathcal{N}(0, \sigma)\\ \mbox{Step 2:}&amp;amp;e_t&amp;amp;\sim&amp;amp;\mathcal{N}(0, \sigma)\\ \mbox{Step 3:}&amp;amp;b_t&amp;amp;=&amp;amp;\rho\times b_{t-1}+e_t,~~t=1,2,\cdots\\ \mbox{Step 4:}&amp;amp;r_t&amp;amp;=&amp;amp;b_t-\mu_b+\mu,~~ t=0,1,2,\cdots \end{array}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;上述过程中， &lt;img src=&quot;https://www.zhihu.com/equation?tex=e_t&quot; alt=&quot;e_t&quot; eeimg=&quot;1&quot;/&gt; 是白噪声序列，它满足均值为 0，标准差为  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%83&quot; alt=&quot;σ&quot; eeimg=&quot;1&quot;/&gt;  的正态分布。 &lt;img src=&quot;https://www.zhihu.com/equation?tex=r_t&quot; alt=&quot;r_t&quot; eeimg=&quot;1&quot;/&gt; 是人工对数收益率序列。为了使它满足给定的长期均值  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%BC&quot; alt=&quot;μ&quot; eeimg=&quot;1&quot;/&gt;  和自相关性 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%81&quot; alt=&quot;ρ&quot; eeimg=&quot;1&quot;/&gt; ，构造过程中使用了辅助序列  &lt;img src=&quot;https://www.zhihu.com/equation?tex=b_t&quot; alt=&quot;b_t&quot; eeimg=&quot;1&quot;/&gt; 。首先利用迭代构造出满足自相关性  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%81&quot; alt=&quot;ρ&quot; eeimg=&quot;1&quot;/&gt;  的序列  &lt;img src=&quot;https://www.zhihu.com/equation?tex=b_t&quot; alt=&quot;b_t&quot; eeimg=&quot;1&quot;/&gt; 。由于在构造 &lt;img src=&quot;https://www.zhihu.com/equation?tex=b_t&quot; alt=&quot;b_t&quot; eeimg=&quot;1&quot;/&gt; 时可能会引入非零样本均值 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%BC_b&quot; alt=&quot;μ_b&quot; eeimg=&quot;1&quot;/&gt; ，因此在利用 &lt;img src=&quot;https://www.zhihu.com/equation?tex=b_t&quot; alt=&quot;b_t&quot; eeimg=&quot;1&quot;/&gt; 构造 &lt;img src=&quot;https://www.zhihu.com/equation?tex=r_t&quot; alt=&quot;r_t&quot; eeimg=&quot;1&quot;/&gt; 时，将 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%BC_b&quot; alt=&quot;μ_b&quot; eeimg=&quot;1&quot;/&gt; 去除并把给定的均值 μ &lt;img src=&quot;https://www.zhihu.com/equation?tex=b_t&quot; alt=&quot;b_t&quot; eeimg=&quot;1&quot;/&gt; 加回来。这样最终生成的对数收益率序列 &lt;img src=&quot;https://www.zhihu.com/equation?tex=r_t&quot; alt=&quot;r_t&quot; eeimg=&quot;1&quot;/&gt; 同时满足的低频均值 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%BC&quot; alt=&quot;μ&quot; eeimg=&quot;1&quot;/&gt; 和自相关性  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%81&quot; alt=&quot;ρ&quot; eeimg=&quot;1&quot;/&gt; 。&lt;/p&gt;&lt;p&gt;利用这个数学模型，以  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%BC&quot; alt=&quot;μ&quot; eeimg=&quot;1&quot;/&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%81&quot; alt=&quot;ρ&quot; eeimg=&quot;1&quot;/&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%83&quot; alt=&quot;σ&quot; eeimg=&quot;1&quot;/&gt;  作为输入，&lt;a href=&quot;https://zhuanlan.zhihu.com/p/40358079&quot; class=&quot;internal&quot;&gt;《什么样的收益率特性适合趋势追踪策略》&lt;/a&gt;一文进行了大量的仿真分析，研究了趋势策略的效果与参数组  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%BC&quot; alt=&quot;μ&quot; eeimg=&quot;1&quot;/&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%81&quot; alt=&quot;ρ&quot; eeimg=&quot;1&quot;/&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%83&quot; alt=&quot;σ&quot; eeimg=&quot;1&quot;/&gt;  的关系并得到如下结论：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;b&gt;长期均值 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%BC&quot; alt=&quot;μ&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 主宰自相关性 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%81&quot; alt=&quot;ρ&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; —— 比起缥缈的自相关性，低频分量 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%BC&quot; alt=&quot;μ&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt; 才是真正的趋势（想想股市的大牛市）；&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;收益率均值 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%BC&quot; alt=&quot;μ&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt; 和收益率标准差 &lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%83&quot; alt=&quot;σ&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt; 的数量级之差影响趋势效果 —— 这意味着合理选择计算趋势的时间尺度至关重要。&lt;/b&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;通常来说，对于日频数据，收益率标准差比均值高两个数量级，在这个级别上趋势策略难有作为。如果把时间拉长，在更低的频率（即更长的时间尺度）上计算收益率，可以有效提高均值并降低其标准差，当均值和标准差相差一个数量级时，趋势策略或大有可为。这就是为什么同一组趋势参数在 A 股好使（A 股大牛市的时候日收益率均值太高）却在美股上不好使（例如，在过去 3000 个交易日中，SPX 的日频收益率标准差是其均值的近 40 倍，而其月频收益率的标准差仅是其均值的 7 倍）。&lt;/p&gt;&lt;p&gt;以上就是关于时间尺度的讨论。一旦确定了计算趋势的时间尺度，下一步就是选择合适的指标了，比如是使用价格均线还是收益率均值来衡量趋势强弱？是使用简单的移动平均还是对近期数据权重更高的指数平均？这都属于 trend measure 要回答的问题。而关于构建趋势策略的另一方面 position sizing，刀疤连在&lt;a href=&quot;https://zhuanlan.zhihu.com/p/81421085&quot; class=&quot;internal&quot;&gt;之前的文章&lt;/a&gt;中有过详细说明，本文不再赘述。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;03 哪个趋势指标更好使 ？&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;关于不同 trend measures 的比较，Levine and Pedersen (2016) 有过精彩的讨论，&lt;a href=&quot;https://zhuanlan.zhihu.com/p/50483693&quot; class=&quot;internal&quot;&gt;《有没有哪个趋势指标更好使？&lt;/a&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzIyMDEwNDk1Mg%3D%3D%26mid%3D2650878543%26idx%3D1%26sn%3D336f00e5703605956fbe799cee5efbfb%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;》&lt;/a&gt;一文也做过解读。结论是 —— 先泼盆冷水吧 —— 并没有哪种 measure 吊打其他的。&lt;/p&gt;&lt;p&gt;在技术层面，各种捕捉趋势的方法也是层出不穷：基于收益率的时序动量、来自技术分析的均线交叉或通道突破、各种 state space 模型比如 Kalman 滤波、基于价格的线性回归、甚至是频域分析。当某种方法的回测结果不是那么给力的时候，人们的第一反应总是寻找下一个更复杂的方法。然而究其核心，上述方法都是基于价格或者收益率的时间序列计算出来的。&lt;b&gt;Levine and Pedersen (2016) 通过使用 trend signature plots（趋势签名图）这个概念比较了不同的 trend measures 方法，认为不同的方法并没有本质区别。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;以时序收益率均值，技术分析中的长、短均线交叉，Kalman 滤波，以及价格对时间的时序回归这些常见的 trend measures 为例，它们的 trend signature plots 如下图所示。在给定的计算趋势的时间尺度下，这些方法的 trend signature plots 显然没有它们的名字听上去差异那么大。&lt;b&gt;它们虽然形态有些差异，但其本质仍然都是收益率的某种加权平均。&lt;/b&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-bba29386be8d4a02b6dcaf3651f156a6_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;599&quot; data-rawheight=&quot;757&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;599&quot; data-original=&quot;https://pic3.zhimg.com/v2-bba29386be8d4a02b6dcaf3651f156a6_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-bba29386be8d4a02b6dcaf3651f156a6_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;599&quot; data-rawheight=&quot;757&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;599&quot; data-original=&quot;https://pic3.zhimg.com/v2-bba29386be8d4a02b6dcaf3651f156a6_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-bba29386be8d4a02b6dcaf3651f156a6_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;除了从数学上证明不同 trend measures 并无实质差异外，Levine and Pedersen (2016) 也通过一个实例进行了说明。它们采用 Moskowitz, Ooi, and Pedersen (2012) 一文中的 58 种资产为交易对象，在不同时间尺度上分别使用两种不同的 trend measures 来构建策略、考察趋势策略的效果。得到的结论和本小节以及上一节完全一致：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;b&gt;计算趋势的时间尺度至关重要；&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;在给定的时间尺度下，具体使用哪种 trend measure 差异并不大。&lt;/b&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;既然不同 trend measures 的差异很小，接下来我们就以最简单的移动平均为例来探究一下趋势信号背后的本质。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;04 移动平均的本质&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;在人们的认知中，趋势追踪是一个右侧交易策略，它使用某个 trend measure 来描述过去一段时间上涨或下跌趋势的强弱，并假设该趋势会持续。而无论采取何种 trend measure，我们都无法提前预判趋势何时会结束，因此趋势策略往往在趋势发生逆转时录得较大的亏损，这也正是趋势策略的风险收益特征。在良好的风控下，这并不是太大的缺点，本文的第六节将从风险的角度进一步讨论这一点。&lt;/p&gt;&lt;p&gt;在本小节，我们试图回答的问题是，趋势策略为什么注定是一个右侧交易策略，为什么无法预知趋势什么时候会结束，意味着&lt;b&gt;趋势信号有明显的滞后性&lt;/b&gt;。这就要从趋势信号（以移动平均为例）的本质说起。&lt;/p&gt;&lt;p&gt;&lt;b&gt;从数学上说，移动平均的本质是一种低通滤波。它的目的是过滤掉时间序列中的高频扰动，保留有用的低频趋势。&lt;/b&gt;如何从时间序列中抽取出真正的低频趋势呢？下面将从数学上解释移动平均的本质，并揭示趋势信号滞后性的成因。&lt;/p&gt;&lt;p&gt;假设我们有一个时间序列 &lt;img src=&quot;https://www.zhihu.com/equation?tex=y+%3D+%5C%7B%E2%80%A6%2C+y_%7Bt-2%7D%2C+y_%7Bt-1%7D%2C+y_t%2C+y_%7Bt%2B1%7D%2C+y_%7Bt%2B2%7D%2C+%E2%80%A6%5C%7D&quot; alt=&quot;y = \{…, y_{t-2}, y_{t-1}, y_t, y_{t+1}, y_{t+2}, …\}&quot; eeimg=&quot;1&quot;/&gt; ，如下图所示。另外，假设我们有一个作用在时域 t 上的过滤函数 F（F 的具体形式由选择的移动平均算法决定）。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-619498171ee8d57fc4442eaa7bfd891e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;272&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-619498171ee8d57fc4442eaa7bfd891e_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-619498171ee8d57fc4442eaa7bfd891e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;272&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-619498171ee8d57fc4442eaa7bfd891e_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-619498171ee8d57fc4442eaa7bfd891e_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;在理论上，在任意 t 时刻的低频滤波（用 &lt;img src=&quot;https://www.zhihu.com/equation?tex=x_t&quot; alt=&quot;x_t&quot; eeimg=&quot;1&quot;/&gt; 表示）在数学上可以表示为该时间序列 y 和过滤函数 F 在整个时域上的卷积，即&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+x_t%3D%5Csum_%7Bi%3D-%5Cinfty%7D%5E%7B%5Cinfty%7DF_iy_%7Bt-i%7D&quot; alt=&quot;\displaystyle x_t=\sum_{i=-\infty}^{\infty}F_iy_{t-i}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;其中， &lt;img src=&quot;https://www.zhihu.com/equation?tex=F_i&quot; alt=&quot;F_i&quot; eeimg=&quot;1&quot;/&gt; 为过滤函数 F 在时刻 i 的取值（可以理解为 &lt;img src=&quot;https://www.zhihu.com/equation?tex=y_%7Bt-1%7D&quot; alt=&quot;y_{t-1}&quot; eeimg=&quot;1&quot;/&gt; 的权重；比如简单平均就是等权）。在实际中通常使用长度为 T 的窗口来代替上面这个无穷级数，这意味着过滤函数 F 只在窗口长度 T 内有效、在窗口之外为 0，如下图所示：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-3e64ae392341f8c1558d45724c7c3b18_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;294&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-3e64ae392341f8c1558d45724c7c3b18_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-3e64ae392341f8c1558d45724c7c3b18_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;294&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic1.zhimg.com/v2-3e64ae392341f8c1558d45724c7c3b18_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-3e64ae392341f8c1558d45724c7c3b18_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;加入长度为 T 的窗函数后，在时刻t的低频滤波变为该时间序列 y 和过滤函数 F 在这个窗口内的卷积：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+x_t%3D%5Csum_%7Bi%3Dt-%28T-1%29%2F2%7D%5E%7Bt%2B%28T-1%29%2F2%7DF_iy_%7Bt-i%7D&quot; alt=&quot;\displaystyle x_t=\sum_{i=t-(T-1)/2}^{t+(T-1)/2}F_iy_{t-i}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;&lt;b&gt;上述公式最大的问题是：在计算 t 时刻的低频分量时，利用到了未来的数据。换句话说，理论上的低通滤波（或者移动平滑）必须要用事后数据，其假设所有数据都发生后再在全局上计算所有时点的低频分量。&lt;/b&gt;但这在实时数据中是不可能的，因为在任何当前时刻 t，我们都没有未来数据可以利用。由于现实中无法使用 t-(T-1)/2 到 t+(T-1)/2 之间的数据，只能退而求其次将整个窗口在时间轴上向左平移 (T-1)/2 个单位、使用 t-(T-1) 到 t 之间的数据来计算 &lt;img src=&quot;https://www.zhihu.com/equation?tex=x_t&quot; alt=&quot;x_t&quot; eeimg=&quot;1&quot;/&gt; ，如下图所示：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-ddb99a4cd3447b2e7fd99e40a2aaf48f_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1027&quot; data-rawheight=&quot;318&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1027&quot; data-original=&quot;https://pic4.zhimg.com/v2-ddb99a4cd3447b2e7fd99e40a2aaf48f_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-ddb99a4cd3447b2e7fd99e40a2aaf48f_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1027&quot; data-rawheight=&quot;318&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1027&quot; data-original=&quot;https://pic4.zhimg.com/v2-ddb99a4cd3447b2e7fd99e40a2aaf48f_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-ddb99a4cd3447b2e7fd99e40a2aaf48f_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;如此处理后，对于实时数据，在当前时刻 t 的低频滤波变为该时间序列 y 和过滤函数 F 在 t-T+1 到 t 之间的卷积：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+x_t%3D%5Csum_%7Bi%3Dt-T%2B1%7D%5E%7Bt%7DF_iy_%7Bt-i%7D&quot; alt=&quot;\displaystyle x_t=\sum_{i=t-T+1}^{t}F_iy_{t-i}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;以 simple moving average 为例，在窗口 T 内，过滤函数在每个时点的取值都是 1/T（等权）。利用上述公式计算得到的实际上是 t-(T-1)/2 时刻、而非 t 时刻的低频趋势，而我们却只能把它当作 t 时刻的低频趋势使用，如此就产生了 (T-1)/2 的滞后。&lt;/p&gt;&lt;p&gt;&lt;b&gt;没有未来数据便是趋势信号滞后的根本原因。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;从上述公式可知，计算均线的时间窗口 T 越大，滞后 (T-1)/2 也就越多（比如我们看股票数据里面 MA20、MA30、MA50 等日均线，随着均线窗口 T 增大，得到的移动平滑曲线也越滞后）。正是由于滞后性和计算均线计算均线窗口的关系，人们本能上更加抵触使用长时间窗口来计算趋势。同时，人们也更加偏好使用指数加权或其他复杂的加权方法，以期更快捕捉趋势变化的原因（业界为此开发出了很多不同的移动平均算法，见&lt;a href=&quot;https://zhuanlan.zhihu.com/p/38276041&quot; class=&quot;internal&quot;&gt;《移动平均：你知道的与你不知道的》&lt;/a&gt;），但没有未来数据造成的滞后性使得趋势追踪注定成为右侧交易策略。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;05 对趋势追踪表现的正确预期&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;要想成功的使用趋势追踪策略，除了对其各个方面有深入的理解外，还要对它的表现有合理的预期，这就是本小节的话题。&lt;/p&gt;&lt;p&gt;在关于趋势策略（时序动量）的研究中，最重要的一篇文章当属 Moskowitz, Ooi, and Pedersen (2012) 这篇发表于顶刊 Journal of Financial Economics 的题为 Time series momentum 的文章。下图正来自这篇文章。它展示了对不同大类的资产使用 12-month trend measure 进行趋势追踪策略的年化夏普率。虽然趋势追踪策略在所有资产均获得正的夏普率，但大部分年化夏普率都在 0.4 以下。以当前市场上资金的主流（yet 非理性）看法来看，这样的表现毫无吸引力，&lt;b&gt;但这个范畴内的夏普率恰恰就是趋势策略在单一资产上的代表性表现。&lt;/b&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-c79f129f2edf2cd9304baf53166a4dcd_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;994&quot; data-rawheight=&quot;542&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;994&quot; data-original=&quot;https://pic2.zhimg.com/v2-c79f129f2edf2cd9304baf53166a4dcd_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-c79f129f2edf2cd9304baf53166a4dcd_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;994&quot; data-rawheight=&quot;542&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;994&quot; data-original=&quot;https://pic2.zhimg.com/v2-c79f129f2edf2cd9304baf53166a4dcd_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-c79f129f2edf2cd9304baf53166a4dcd_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;虽然趋势追踪在单一策略上提高空间有限，但好处是不同类资产的相关性较低，因此我们可以把它们的趋势策略放在一起，既实现了分散化，又能提升风险收益特征。这便给了人们无限的想象空间。下面我们就来模拟一下。&lt;/p&gt;&lt;p&gt;在模拟中，我使用了元盛开发的 &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//tools.winton.com/thefuture/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;The Future 工具&lt;/a&gt;，它以单一策略的夏普率、相关性等参数作为输入，非常方便的可视化出这些单一策略组合在一起之后的效果。假设我们有 20 个单一趋势追踪策略，每个策略的夏普率为 0.4，策略之间的相关性为 0.1，则可以得到以下的仿真结果：portfolio 的夏普率提升到了 1.16，显著高于单一策略的 0.4。当然，这仅仅是一次仿真；复合策略夏普率的分布可以通过数学推导、在合理的假设下得到，或通过更多的仿真得到。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-9bd7970a6b486c399a67d82812dda64e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;504&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-9bd7970a6b486c399a67d82812dda64e_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-9bd7970a6b486c399a67d82812dda64e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;504&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-9bd7970a6b486c399a67d82812dda64e_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-9bd7970a6b486c399a67d82812dda64e_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;上面这个小实验表明众多品种的趋势策略放在一起后的综合效果确实能够显著提升风险收益特征。&lt;b&gt;然而我们也必须认识到，多品种的趋势追踪策略仍然可能在短到中期（1 - 3 年）的范围内持续亏损。&lt;/b&gt;下图是大名鼎鼎的 Barclay CTA Index（考虑到趋势追踪占 CTA 中很高的比重，因此以该 Index 的表现代表趋势策略在历史上的表现），它在 2011 年 7 月之后的表现就有些惨不忍睹，从 2015 年开始几乎在持续的回撤。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-af8198fa05cd39921fc4a584bbfd0d8c_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;715&quot; data-rawheight=&quot;468&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;715&quot; data-original=&quot;https://pic1.zhimg.com/v2-af8198fa05cd39921fc4a584bbfd0d8c_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-af8198fa05cd39921fc4a584bbfd0d8c_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;715&quot; data-rawheight=&quot;468&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;715&quot; data-original=&quot;https://pic1.zhimg.com/v2-af8198fa05cd39921fc4a584bbfd0d8c_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-af8198fa05cd39921fc4a584bbfd0d8c_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;趋势追踪策略并不是圣杯；根据市场所处的状态，它有好使的时候，更有持续亏损的时候。长期来看，趋势追踪策略可以获得很好的收益、值得配置；&lt;b&gt;但真正能配置以及驾驭它的人，一定是对短到中期内它的表现能有多差有非常清醒的认知。&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;06 从风险的角度看趋势策略&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;最后来从风险的角度看趋势追踪。&lt;/p&gt;&lt;p&gt;对于大部分常见的资产或者投资策略，它们的收益分布都有如下的形状 —— 均值为正，但是左侧存在着极端事件造成的巨大亏损，从而造成分布的负偏。这个分布通常被称为 Taleb Distribution，以 Nassim Nicholas Taleb 命名；他以《黑天鹅》一书闻名于世（黑天鹅代表了左侧的极端事件）。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-37044c90db5bb2d28f841f7248a49be9_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;572&quot; data-rawheight=&quot;322&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;572&quot; data-original=&quot;https://pic2.zhimg.com/v2-37044c90db5bb2d28f841f7248a49be9_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-37044c90db5bb2d28f841f7248a49be9_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;572&quot; data-rawheight=&quot;322&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;572&quot; data-original=&quot;https://pic2.zhimg.com/v2-37044c90db5bb2d28f841f7248a49be9_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-37044c90db5bb2d28f841f7248a49be9_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;而趋势追踪策略的收益分布（假设合理使用杠杆和进行风控）却和上面不同，趋势策略的收益率分布往往是 positive skewed 的。从趋势策略的 PnL 曲线来看，它在更多的时候是连续经历小幅回撤，然后换来一大波（大趋势）的上涨，从而将之前的众多小幅回撤抹平，使得该策略的长期收益为正。这个“亏损有限、收益无限”的特征造就了趋势策略收益分布的正偏。这个分布又被称作圣杯分布（Holy Grail distribution）。趋势追踪策略虽然不是圣杯，但它的收益分布满足圣杯分布。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-61ebead93d98b4c4a2686f2cbc943a08_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;562&quot; data-rawheight=&quot;350&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;562&quot; data-original=&quot;https://pic1.zhimg.com/v2-61ebead93d98b4c4a2686f2cbc943a08_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-61ebead93d98b4c4a2686f2cbc943a08_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;562&quot; data-rawheight=&quot;350&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;562&quot; data-original=&quot;https://pic1.zhimg.com/v2-61ebead93d98b4c4a2686f2cbc943a08_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-61ebead93d98b4c4a2686f2cbc943a08_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;正是因为这种独特的特性，使得趋势策略能在其他资产发生左侧尾部风险的时候脱颖而出，这也就是它为什么享有 crisis alpha 的美名。关于 crisis alpha 的特性，&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzIyMDEwNDk1Mg%3D%3D%26mid%3D2650879433%26idx%3D1%26sn%3D423052122849a8115f34ff3122ad3d9c%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;刀疤连的文章&lt;/a&gt;中有过详细的描述并针对国内市场进行了实证研究。&lt;/p&gt;&lt;p&gt;为什么不同策略的收益率会表现出不同的分布特征？这可以从两类不同的风险来解释。任何投资策略想要赚钱，都需要承担一定的风险。而策略承担什么类型的风险就决定了它的收益分布具备何种的特征。&lt;b&gt;风险可以被分为 convergent risks 和 divergent risks 两大类，因此策略也可以被视为 convergent risk taking 和 divergent risk taking 两大类。&lt;/b&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;b&gt;Convergent risks 是那些被人们理解、可通过建模来测量（尽管不一定准确）的风险；&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;Divergent risks 是哪些未知的风险、无法预测的风险、不能很好的被度量的风险。&lt;/b&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;当构建 convergent risk taking 策略的时候，人们根据金融学或者经济学原理对资产的走势有一个先验信仰，并以此为判断做出投资决策。另一方面，在构建 divergent risk taking 策略时，人们假设资产未来的走势是未知的、不使用任何先验信仰来辅助判断资产会涨还是会跌，而是根据资产价格自身的发展做出相应的判断。&lt;/p&gt;&lt;p&gt;举例来说，股票市场中的价值投资正是 convergent risk taking 的代表。这类策略通过深度行业研究挖掘上市公司的内在价值，当价格低于价值时则买入，耐心的等待其价格向价值回归、无视短期的波动甚至是持续下跌，这是这类策略愿意且主动承担的风险。而常见于 CTA 中的趋势追踪策略则是 divergent risk taking 的代表。这类策略对资产的内在价值不做任何判断，而是严格依据价格的走势进行交易：价格上涨了做多、价格下跌时做空；当盈利时会逐渐加仓，当亏损时会及时清仓。正因如此，趋势追踪策略属于 divergent risk taking 策略，因而其收益满足圣杯分布的特性，这也正是趋势追踪策略能够长盛不衰的原因。&lt;/p&gt;&lt;p&gt;&lt;b&gt;有必要指出的是，圣杯分布是非常美好的，而获得美好的东西注定是十分困难的。&lt;/b&gt;趋势追踪策略最困难的地方在于在趋势中拿的住单子，让利润奔跑（只有这样才能实现收益率分布的右尾）。然而，由于认知偏差，人们往往对确定性高的低收益过度偏爱，因而总是倾向早早平掉盈利的单子。唯有克服人性的错误，才有可能真正享受到趋势策略带来的圣杯分布。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;07 结语&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;来回顾一下本文对趋势追踪策略做了哪些思考。&lt;/p&gt;&lt;p&gt;从技术层面来看，一个成功的趋势策略，最重要的是计算趋势的时间尺度，策略的参数应适应资产的收益率特征。当确定了时间尺度后，具体使用哪个 trend measure 并无本质区别，把更多的精力放在 position sizing 来控制风险可能是更好的选择。作为右侧交易策略，使用历史数据计算得到的趋势信号注定有一定的滞后性，这是难以避免的，使用诸如指数平滑来给最新的数据更高的权重是业界对于减少滞后性的一种尝试。&lt;/p&gt;&lt;p&gt;从心理层面来看，想要成功使用趋势追踪策略就必须要对它的风险收益特征有清醒的认识。单资产上的趋势策略的夏普率通常不高，但是把不同低相关资产的趋势策略组合在一起能显著提升 portfolio 的夏普率。即便如此，趋势策略在短到中期内（例如 1 年）也非常有可能出现持续的回撤。驾驭趋势策略不在于理解它长期来看的正期望，而在于欣然接受它短期内潜在的很差的表现。&lt;/p&gt;&lt;p&gt;从风险角度来看，趋势策略属于 divergent risk taking 策略。它虽然不是圣杯，但它的收益率分布满足圣杯分布，这使得它具备 crisis alpha 等优点，极具配置价值。不过值得一提的是，有研究表明，过度使用杠杆对这类策略的收益和风险的放大是非线性的。因此，科学、有效的风控是使用趋势策略的重要一环。&lt;/p&gt;&lt;p&gt;以上。&lt;/p&gt;&lt;p&gt;好了，我要接着去读最近刚入手的《贫穷的本质》了。各位再见。&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;参考文献&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Levine, A. and L. H. Pedersen (2016). Which trend is your friend? &lt;i&gt;Financial Analysts Journal&lt;/i&gt;, Vol. 72(3), 51 – 66.&lt;/li&gt;&lt;li&gt;Moskowitz, T., Y. H. Ooi, and L. H. Pedersen (2012). Time Series Momentum. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 104(2), 228 – 250.&lt;/li&gt;&lt;li&gt;Roncalli, T. (2017). Keep up the momentum. SSRN: &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//ssrn.com/abstract%3D3083921&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;ssrn.com/abstract=30839&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;21&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;.&lt;/li&gt;&lt;li&gt;Winton (2013). Historical Performance of Trend Following. Winton Capital Research Note.&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;免责声明：&lt;/b&gt;文章内容不可视为投资意见。市场有风险，入市需谨慎。&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处。已委托“维权骑士”(&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//rightknights.com&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;维权骑士_免费版权监测/版权保护/内容多平台分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2019-11-09-91028298</guid>
<pubDate>Sat, 09 Nov 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>理解资产价格</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2019-10-25-88458489.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/88458489&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-1879732b7c16af87a5fd8d7daa4ad409_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;摘要&lt;/b&gt;&lt;/p&gt;&lt;p&gt;站在巨人的肩膀上理解资产价格。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;01 P = E[mx]&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;这一切始于 P = E[mx]。&lt;/p&gt;&lt;p&gt;假设 t 时刻，某资产 i 的价格是  &lt;img src=&quot;https://www.zhihu.com/equation?tex=P_%7Bi%2C+t%7D&quot; alt=&quot;P_{i, t}&quot; eeimg=&quot;1&quot;/&gt; ；t + 1 时刻，资产处于某种资产状态 s，其发生的概率为 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CF%80_%7Bt%2B1%7D%28s%29&quot; alt=&quot;π_{t+1}(s)&quot; eeimg=&quot;1&quot;/&gt; ，且在该状态下，资产的支付额和对应的折现因子分别为 &lt;img src=&quot;https://www.zhihu.com/equation?tex=x_%7Bi%2C+t%2B1%7D%28s%29&quot; alt=&quot;x_{i, t+1}(s)&quot; eeimg=&quot;1&quot;/&gt; 和 &lt;img src=&quot;https://www.zhihu.com/equation?tex=m_%7Bt%2B1%7D%28s%29&quot; alt=&quot;m_{t+1}(s)&quot; eeimg=&quot;1&quot;/&gt; 。由 absence of arbitrage opportunities（无套利）约束可知， &lt;img src=&quot;https://www.zhihu.com/equation?tex=P_%7Bi%2C+t%7D&quot; alt=&quot;P_{i, t}&quot; eeimg=&quot;1&quot;/&gt; 满足以下关系（无套利意味着左右两端必须相等）：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+P_%7Bi%2Ct%7D%3D%5Csum_s%5Cpi_%7Bt%2B1%7D%28s%29m_%7Bt%2B1%7D%28s%29x_%7Bi%2C+t%2B1%7D%28s%29&quot; alt=&quot;\displaystyle P_{i,t}=\sum_s\pi_{t+1}(s)m_{t+1}(s)x_{i, t+1}(s)&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;利用数学中的期望符号 E，可以把上式写成更加“喜闻乐见”的形式：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+P_%7Bi%2Ct%7D%3D%5Cmbox%7BE%7D_t%5Bm_%7Bt%2B1%7Dx_%7Bi%2Ct%2B1%7D%5D&quot; alt=&quot;\displaystyle P_{i,t}=\mbox{E}_t[m_{t+1}x_{i,t+1}]&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;E_t 意味着在 t 时刻在状态变量 s 的概率空间求期望。这个公式称作 &lt;b&gt;no-arbitrage pricing formula&lt;/b&gt;，它正是 asset pricing 的基础。其中的 m 被称作 &lt;b&gt;stochastic discount factor&lt;/b&gt;。&lt;/p&gt;&lt;p&gt;接下来的故事就从 P = E[mx] 讲起。一系列自然而然的问题包括什么驱动了资产的价格、资产的收益率可以预测吗？&lt;/p&gt;&lt;h2&gt;&lt;b&gt;02 短期不可预测性&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;首先来看短期的情况。&lt;/p&gt;&lt;p&gt;假设考虑两个非常近的时点。在这之间，无风险收益率近似为零，且因为时间很短，因而可以假设折现因子 m 在不同状态下的变化不大。在这些假设下，m 近似等于 1。进一步的，假设未来的支付等于出售该资产的价格，因此由 P = E[mx] 可知：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+P_t%3D%5Cmbox%7BE%7D_t%5BP_%7Bt%2B1%7D%5D&quot; alt=&quot;\displaystyle P_t=\mbox{E}_t[P_{t+1}]&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;&lt;b&gt;上式意味着短期内价格的上升或下降是随机的，收益率难以预测。&lt;/b&gt;在检验短期内能否预测方面，&lt;b&gt;Eugene Fama&lt;/b&gt; 做出了重大的贡献，主要包括以下两个方面。&lt;/p&gt;&lt;p&gt;第一方面是对收益率序列的直接统计检验。虽然在 Fama 之前，有诸如 Samuelson (1965) 和 Mandelbrot (1966) 这样的开创性研究，但 Fama 无疑是系统性研究收益率统计特性的第一人 —— 他在其 1963 年的博士论文（后于 1965 年全文发表在 Journal of Business 上，见 Fama 1965）中使用序列相关性检验、游程检验（runs test）以及过滤准则检验（filter test，即使用特定的规则对收益率序列过滤，然后考察其是否能战胜买入持有）检验了短期收益率无法预测，该研究对后续的相关研究产生了巨大的影响。在收益率的不可预测下，efficient market 这个概念也应运而生。&lt;/p&gt;&lt;p&gt;Fama 对于市场有效性的最大贡献来自 Fama (1970) 提出的 joint hypothesis（联合假说）问题。所谓  joint hypothesis  问题指的是为了检验市场有效性，首先要有一个合理的 asset pricing 模型。只有知道了 asset pricing 模型给出的均衡状态下资产的预期收益率，才有可能正确的检验市场是否有效。此外，Fama (1970) 还对有效市场假说的三种形式，即 weak、semi-strong、strong 进行了讨论。&lt;/p&gt;&lt;p&gt;Fama 的第二个贡献是首次提出了 event study 的方法（Fama, Fisher, Jensen, and Roll 1969，下称 FFJR）。FFRJ 是事件分析的开山鼻祖。&lt;b&gt;事件分析的对象是和资产价格相关的新息（事件）发生前后，资产的价格会有怎样的行为。&lt;/b&gt;FFJR 为此提出了开创新的方法论，主要包括三个方面：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;将市场的收益率从个股的收益率中排除，将个股特异收益率作为研究重点，从而剔除市场时序波动的影响。&lt;/li&gt;&lt;li&gt;在时间轴上，将事件发生的时刻记为 time 0；事件发生之前在 0 的左侧、事件发生之后则在 0 的右侧。考察股票特异收益率在事件发生前、发生时、以及发生后的变化。&lt;/li&gt;&lt;li&gt;这一点大概是最具创新的一点：任何事件在个股上是否发生以及发生的时间都是不同的，而由于上述第二步时间轴上的统一处理，我们就可以把所有个股的同类事件在截面上平均起来考察整体的效果。这会消除个股对事件的特异波动，从而考察事件对于股票特异收益率的平均影响效果。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;FFJR 的研究发现，股票的 abnormal return 在事件发生后没有任何异常回报（下图），事件所包含的信息已经很好的反映在价格之中，从而证明了市场的有效性。而以上方法论中的三点创新也迅速开辟了一个子领域。如今，事件分析在经济和金融领域都有广泛的应用。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-7d244051e1ece922b2b7e511d1ef5d9e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1056&quot; data-rawheight=&quot;536&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1056&quot; data-original=&quot;https://pic3.zhimg.com/v2-7d244051e1ece922b2b7e511d1ef5d9e_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-7d244051e1ece922b2b7e511d1ef5d9e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1056&quot; data-rawheight=&quot;536&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1056&quot; data-original=&quot;https://pic3.zhimg.com/v2-7d244051e1ece922b2b7e511d1ef5d9e_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-7d244051e1ece922b2b7e511d1ef5d9e_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;blockquote&gt;&lt;i&gt;An event study arguably offers the cleanest way of testing for whether new information is incorporated fully in prices, without generating predictable price movements.&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;根据以上关于有效市场假说和事件分析的研究结果，人们对资产价格和收益率在短期内的不可预测性达成了共识。这是上世纪 70 年代，人们对于资产价格理解迈出的第一步。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;03 过度波动导致长期可预测&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;下面来看看资产价格和收益率在更长的时间周期下能否被预测。这是上世纪 80 年代的主要研究课题之一。而在这一领域的代表性人物则是 &lt;b&gt;Robert Shiller&lt;/b&gt;，他做出了大量开创性的贡献。&lt;/p&gt;&lt;p&gt;Shiller 的第一个贡献在于提出了 variance ratio tests。Shiller (1979, 1981) 分别以债券和股票作为资产，研究了它们短期波动和长期波动的方差差异。以股票为例，在 1980 年以前，学者们倾向认为股票的长期波动取决于和未来现金流相关的基本面信息的波动，直到 Shiller (1981) 发表，这个观点也因检验结果而被颠覆；而 Shiller (1981) 一文的题目也和它的内容一样具有颠覆性：Do stock prices move too much to be justified by subsequent changes in dividends?&lt;/p&gt;&lt;p&gt;我们仍然可以从 P = E[mx] 出发理解 Shiller 的发现。以股票为例，该定价方程意味着股票今天的价格等于其预期基本面价格的现值，即未来所有期现金流（对于股票，可以认为是股息）的折现值之和。令 &lt;img src=&quot;https://www.zhihu.com/equation?tex=P%5E%5Cstar_%7Bi%2C+t%7D&quot; alt=&quot;P^\star_{i, t}&quot; eeimg=&quot;1&quot;/&gt; 代表这个股票 i 的未知基本面价值的折现值，它的变化来自未来股息（x）和折现因子（m）的波动。由 P = E[mx] 有：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+P_%7Bi%2Ct%7D%3D%5Cmbox%7BE%7D_t%5BP%5E%5Cstar_%7Bi%2Ct%7D%5D&quot; alt=&quot;\displaystyle P_{i,t}=\mbox{E}_t[P^\star_{i,t}]&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;由上式可知，预测误差为 &lt;img src=&quot;https://www.zhihu.com/equation?tex=P_%7Bi%2C+t%7D+%E2%80%93+P%5E%5Cstar_%7Bi%2C+t%7D&quot; alt=&quot;P_{i, t} – P^\star_{i, t}&quot; eeimg=&quot;1&quot;/&gt; ，而该误差应该和所有历史信息（包括现在的价格  &lt;img src=&quot;https://www.zhihu.com/equation?tex=P_%7Bi%2C+t%7D&quot; alt=&quot;P_{i, t}&quot; eeimg=&quot;1&quot;/&gt; ）是不相关的。接下来，我们可以把 &lt;img src=&quot;https://www.zhihu.com/equation?tex=P%5E%5Cstar_%7Bi%2C+t%7D&quot; alt=&quot;P^\star_{i, t}&quot; eeimg=&quot;1&quot;/&gt; 写成如下的形式（左右两侧完全是等价的）：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+P%5E%5Cstar_%7Bi%2Ct%7D%5Cequiv+P_%7Bi%2Ct%7D%2B%28P%5E%5Cstar_%7Bi%2Ct%7D-P_%7Bi%2Ct%7D%29&quot; alt=&quot;\displaystyle P^\star_{i,t}\equiv P_{i,t}+(P^\star_{i,t}-P_{i,t})&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;利用误差项 &lt;img src=&quot;https://www.zhihu.com/equation?tex=P_%7Bi%2C+t%7D+%E2%80%93+P%5E%5Cstar_%7Bi%2C+t%7D&quot; alt=&quot;P_{i, t} – P^\star_{i, t}&quot; eeimg=&quot;1&quot;/&gt; 和所有历史信息（包括 &lt;img src=&quot;https://www.zhihu.com/equation?tex=P_%7Bi%2C+t%7D&quot; alt=&quot;P_{i, t}&quot; eeimg=&quot;1&quot;/&gt; ）独立这个性质，对上式两边直接求方差可得：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+%5Cmbox%7Bvar%7D%28P%5E%5Cstar_%7Bi%2Ct%7D%29%3D+%5Cmbox%7Bvar%7D%28P_%7Bi%2Ct%7D%29%2B%5Cmbox%7Bvar%7D%28P%5E%5Cstar_%7Bi%2Ct%7D-P_%7Bi%2Ct%7D%29&quot; alt=&quot;\displaystyle \mbox{var}(P^\star_{i,t})= \mbox{var}(P_{i,t})+\mbox{var}(P^\star_{i,t}-P_{i,t})&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;由于方差一定是非负的，上式意味着基本面价值的波动应该大于价格本身的波动：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+%5Cmbox%7Bvar%7D%28P%5E%5Cstar_%7Bi%2Ct%7D%29%3E+%5Cmbox%7Bvar%7D%28P_%7Bi%2Ct%7D%29&quot; alt=&quot;\displaystyle \mbox{var}(P^\star_{i,t})&amp;gt; \mbox{var}(P_{i,t})&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;当资产为股票时，这表示股票价格的波动应该小于未来股息现值和的波动。但事实是否是如此呢？Shiller (1981) 回答了这个问题，并发现了和模型完全相反的结论：&lt;b&gt;价格的方差比未来股息折现值之和的方差要大得多。&lt;/b&gt;下图显示了 Shiller 的分析结果。其中价格均做了 detrend 处理，从而方便我们更好的观察波动本身。在两张图中，实线分别代表价格的波动，而虚线代表以股息折现和的波动。Shiller 的研究也带动了一系列 variance bounds tests 的研究（代表文献见 &lt;a href=&quot;https://zhuanlan.zhihu.com/p/86823603&quot; class=&quot;internal&quot;&gt;Lo 2007&lt;/a&gt; 中的 Volume III、Part I）。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-72a4167022ca25e767b4e6765881c0ee_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1039&quot; data-rawheight=&quot;667&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1039&quot; data-original=&quot;https://pic3.zhimg.com/v2-72a4167022ca25e767b4e6765881c0ee_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-72a4167022ca25e767b4e6765881c0ee_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1039&quot; data-rawheight=&quot;667&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1039&quot; data-original=&quot;https://pic3.zhimg.com/v2-72a4167022ca25e767b4e6765881c0ee_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-72a4167022ca25e767b4e6765881c0ee_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;Shiller 的研究表明，股票和债券的短期波动比其长期波动更加剧烈，说明长期的价格呈现均值回复的特征，因此长期来看这些资产的收益是可以被预测的 —— 高于平均的收益之后往往伴随着低于平均水平的收益。&lt;/b&gt;这是在 Fama 于上世纪 70 年代的重要发现后，人们对于资产价格理解迈出的又一步。&lt;/p&gt;&lt;p&gt;在 Shiller (1981) 之后，学术界关于资产的长期可预测性做出了大量的研究。比如，Campbell and Shiller (1988) 发现实际盈利的长期均值能很好的预测未来的股息率，且该变量和当前价格的比值可以很好的预测未来的价格。Fama and French (1988) 发现随着时间尺度的增加，dividend yield 对于收益率的预测能力也逐渐提高（更高的时序 R-squared，下图），这也和“收益率在短期内难以预测，在长期内可以预测”这个观点相一致。短期的高波动是资产价格在长时间尺度下可预测性的前提。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-6fd8c1e4b6476a68e7fb678e6768b898_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;877&quot; data-rawheight=&quot;506&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;877&quot; data-original=&quot;https://pic1.zhimg.com/v2-6fd8c1e4b6476a68e7fb678e6768b898_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-6fd8c1e4b6476a68e7fb678e6768b898_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;877&quot; data-rawheight=&quot;506&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;877&quot; data-original=&quot;https://pic1.zhimg.com/v2-6fd8c1e4b6476a68e7fb678e6768b898_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-6fd8c1e4b6476a68e7fb678e6768b898_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;让我们回到 P = E[mx]。&lt;/p&gt;&lt;p&gt;Shiller 等人的研究表示，既然 P 的波动比 x 的波动更高，那么如果 P = E[mx]，即无套利定价公式，仍然成立，&lt;b&gt;那么 P 的高波动只能是来自折现因子 m 的高波动&lt;/b&gt;。因此，接下来学者们急需回答的问题就是：&lt;b&gt;是什么导致了 m 的高波动？来自经济学的理论模型是否支持 m 的高波动？&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;04 理性 CCAPM 模型&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;如果想从经济学理论出发来解释 m 的高波动，那么就需要把资产的价格和人们的储蓄和风险决策（投资风险资产）相联系起来。在这方面，当仁不让的选择是 consumption-based CAPM —— &lt;b&gt;CCAPM&lt;/b&gt;，&lt;b&gt;它允许投资者的风险偏好（即随机折现因子）随时间变化&lt;/b&gt;，背后的原因可能是消费或者财富的冲击。在 CCAPM 中，消费者的决策目标是预期效用的最大化：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+%5Cmbox%7BE%7D%5Cleft%5B%5Csum_%7Bj%3D0%7D%5E%5Cinfty%5Cbeta%5Ej+u%28c_%7Bt%2Bj%7D%29%5Cright%5D&quot; alt=&quot;\displaystyle \mbox{E}\left[\sum_{j=0}^\infty\beta^j u(c_{t+j})\right]&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;上式中，β 表示一个主观系数、u 是效用函数、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=c_%7Bt%2Bj%7D&quot; alt=&quot;c_{t+j}&quot; eeimg=&quot;1&quot;/&gt; 表示 t + j 期的消费。CCAPM 假设投资人每一期购买一定量的风险资产（价格为 P），并通过最大化上述目标函数来确定最优的购买量。根据目标函数的一阶条件可以获得如下关系（具体推导可参考 Cochrane 2005）：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+u%5E%5Cprime%28c_t%29%3D%5Cmbox%7BE%7D%5Cleft%5B%5Cbeta%5Cfrac%7Bu%5E%5Cprime%28c_%7Bt%2B1%7D%29x_%7Bi%2C+t%2B1%7D%7D%7BP_%7Bi%2Ct%7D%7D%5Cright%5D&quot; alt=&quot;\displaystyle u^\prime(c_t)=\mbox{E}\left[\beta\frac{u^\prime(c_{t+1})x_{i, t+1}}{P_{i,t}}\right]&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;上式中左侧是在 t 时刻消费一个单位能够获得的边际效用；右侧是将该单位进行投资（于风险资产）并在 t + 1 时刻获得 &lt;img src=&quot;https://www.zhihu.com/equation?tex=x_%7Bi%2C+t%2B1%7D%2FP_%7Bi%2C+t%7D&quot; alt=&quot;x_{i, t+1}/P_{i, t}&quot; eeimg=&quot;1&quot;/&gt; 的回报并将其折现之后的边际效用。根据一阶条件，这二者应该相等，故得到上式。将其进行简单变化可得：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+P_%7Bi%2Ct%7D%3D%5Cmbox%7BE%7D%5Cleft%5B%5Cbeta%5Cfrac%7Bu%5E%5Cprime%28c_%7Bt%2B1%7D%29%7D%7Bu%5E%5Cprime%28c_t%29%7Dx_%7Bi%2C+t%2B1%7D%5Cright%5D&quot; alt=&quot;\displaystyle P_{i,t}=\mbox{E}\left[\beta\frac{u^\prime(c_{t+1})}{u^\prime(c_t)}x_{i, t+1}\right]&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;上式正是 CCAPM 下的资产定价方程。将它和 P = E[mx] 比较不难发现，在这个理论下随机折现因子满足：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+m%3D%5Cbeta%5Cfrac%7Bu%5E%5Cprime%28c_%7Bt%2B1%7D%29%7D%7Bu%5E%5Cprime%28c_t%29%7D&quot; alt=&quot;\displaystyle m=\beta\frac{u^\prime(c_{t+1})}{u^\prime(c_t)}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;CCAPM 指出 m 和当期消费还是下期消费的边际效用之比有关。从经济理论出发，这个表达式解释了为什么在经济衰退时，折现因子比较低：当经济不景气时， &lt;img src=&quot;https://www.zhihu.com/equation?tex=c_t&quot; alt=&quot;c_t&quot; eeimg=&quot;1&quot;/&gt;  较低、边际效用  &lt;img src=&quot;https://www.zhihu.com/equation?tex=u%27%28c_t%29&quot; alt=&quot;u&amp;#39;(c_t)&quot; eeimg=&quot;1&quot;/&gt;  较高，因此边际效用比 &lt;img src=&quot;https://www.zhihu.com/equation?tex=u%27%28c_%7Bt%2B1%7D%29%2Fu%27%28c_t%29&quot; alt=&quot;u&amp;#39;(c_{t+1})/u&amp;#39;(c_t)&quot; eeimg=&quot;1&quot;/&gt; 较低；反之，当经济繁荣时，折现因子 m 应较高。&lt;/p&gt;&lt;p&gt;OK，模型有了。回顾一下模型是要干什么：CCAPM 模型是试图搞清楚随机折现因子 m 如此高波动背后的原因。&lt;b&gt;因此接下来就是用数据来对模型进行参数估计，从而检验这个理论是否成立。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;但是在当时，人们突然发现，不会了！&lt;/p&gt;&lt;p&gt;在 CCAPM 中，模型是变量的非线性方程；此外，需要为消费确定一个完整的随机过程模型；最后，在这个动态系统中，误差项的时序相关性也让使用正式的统计方法难上加难。&lt;/p&gt;&lt;p&gt;面对这些难以逾越的困难，当时的两种妥协包括：（1）使用 calibration（校准）和非正式统计；（2）在模型之外强行加入一系列非常具体的假设 —— 哪怕有些假设和被处理的问题毫不相关 —— 从而把非线性的 CCAPM 线性化处理。在第一种方法的努力中，Grossman and Shiller (1981) 是定量检验 CCAPM 的始作俑者。在使用了美国消费数据后，他们发现&lt;b&gt;只有当消费的边际效用对消费变化极度敏感，即投资者表现出极度的风险厌恶时，股票价格的波动才能符合 CCAPM 模型。&lt;/b&gt;换句话说，在合理的假设下，CCAPM 只能被拒绝。&lt;/p&gt;&lt;p&gt;当然，使用校准多少差点意思。而使用具体假设后的线性化也没强到哪里去 —— CCAPM 依然被拒绝。而因为各种具体的假设也多少让问题变得更加复杂：人们无法确定 CCAPM 被拒绝本身是因为理论存在固有的局限，还是为线性化处理 CCAPM 而做的各种假设不够合理。显然在上世纪 80 年代，人们急需计量经济学理论的突破，让正式检验 CCAPM 成为可能。&lt;/p&gt;&lt;p&gt;就在这个时候，&lt;b&gt;Lars Peter Hansen&lt;/b&gt; 的 &lt;b&gt;Generalized Method of Moments&lt;/b&gt;（GMM，Hansen 1982）横空出世。&lt;/p&gt;&lt;p&gt;为简化表达式，令 &lt;img src=&quot;https://www.zhihu.com/equation?tex=R_%7Bi%2C+t%2B1%7D+%3D+x_%7Bi%2C+t%2B1%7D+%2F+P_%7Bi%2C+t%7D&quot; alt=&quot;R_{i, t+1} = x_{i, t+1} / P_{i, t}&quot; eeimg=&quot;1&quot;/&gt; ，即 R 是 t 到 t + 1 的 gross return。利用 R 对 CCAPM 定价公式变形并利用误差项和历史数据（比如过去的价格或者收益率，历史数据用工具变量 &lt;img src=&quot;https://www.zhihu.com/equation?tex=z_%7Bj%2C+t%7D&quot; alt=&quot;z_{j, t}&quot; eeimg=&quot;1&quot;/&gt; 表示）之间的独立性可得如下关系式：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+%5Cmbox%7BE%7D%5Cleft%5B%5Cleft%28%5Cbeta%5Cfrac%7Bu%5E%5Cprime%28c_%7Bt%2B1%7D%29%7D%7Bu%5E%5Cprime%28c_t%29%7DR_%7Bi%2C+t%2B1%7D-1%5Cright%29%5Ccdot+z_%7Bj%2Ct%7D%5Cright%5D%3D0&quot; alt=&quot;\displaystyle \mbox{E}\left[\left(\beta\frac{u^\prime(c_{t+1})}{u^\prime(c_t)}R_{i, t+1}-1\right)\cdot z_{j,t}\right]=0&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;上面这个从 CCAPM 定价公式得到的&lt;b&gt;矩条件（moment condition）&lt;/b&gt;正是 GMM 的研究对象；上式可以看成是以下向量方程的一个分量：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+%5Cmbox%7BE%7D%5B%5Cmathbf%7Bg%7D%28%5Cmathbf%7Bx_t%7D%2C+%5Cmathbf%7B%5Ctheta%7D%29%5D%3D%5Cmathbf%7B0%7D&quot; alt=&quot;\displaystyle \mbox{E}[\mathbf{g}(\mathbf{x_t}, \mathbf{\theta})]=\mathbf{0}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;其中向量 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmathbf%7Bx%7D_t&quot; alt=&quot;\mathbf{x}_t&quot; eeimg=&quot;1&quot;/&gt; 表示一个随机过程、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B8&quot; alt=&quot;θ&quot; eeimg=&quot;1&quot;/&gt;  表示带估计的参数、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmathbf%7Bg%7D&quot; alt=&quot;\mathbf{g}&quot; eeimg=&quot;1&quot;/&gt;  表示一系列正交条件。在我们的例子中， &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmathbf%7Bx%7D_t&quot; alt=&quot;\mathbf{x}_t&quot; eeimg=&quot;1&quot;/&gt; 由 c、R 以及 z 组成， &lt;img src=&quot;https://www.zhihu.com/equation?tex=%CE%B8&quot; alt=&quot;θ&quot; eeimg=&quot;1&quot;/&gt;  由 β 以及 u 中的其他参数组成，而 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmathbf%7Bg%7D&quot; alt=&quot;\mathbf{g}&quot; eeimg=&quot;1&quot;/&gt; 的第 (i, j) 个条件是：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmathbf%7Bg%7D%28i%2C+j%29%3D%5Cleft%28%5Cbeta%5Cfrac%7Bu%5E%5Cprime%28c_%7Bt%2B1%7D%29%7D%7Bu%5E%5Cprime%28c_t%29%7DR_%7Bi%2C+t%2B1%7D-1%5Cright%29%5Ccdot+z_%7Bj%2Ct%7D&quot; alt=&quot;\mathbf{g}(i, j)=\left(\beta\frac{u^\prime(c_{t+1})}{u^\prime(c_t)}R_{i, t+1}-1\right)\cdot z_{j,t}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;GMM estimator 可以使用样本数据的矩条件来定义；GMM 可以用来进行参数估计和假设检验。Hansen (1982) 对 GMM 估计以及它的各种特性进行了详尽的描述。而 GMM 之所以如此强大的原因是它对随机过程 &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmathbf%7Bx%7D_t&quot; alt=&quot;\mathbf{x}_t&quot; eeimg=&quot;1&quot;/&gt; 的限制非常少（只需要满足弱平稳和各态历经性），此外它对于  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmathbf%7Bg%7D&quot; alt=&quot;\mathbf{g}&quot; eeimg=&quot;1&quot;/&gt;  的限制也非常少（可以是非线性的）。这种强大的特征对于处理经济学的面板数据至关重要。在资产定价中，随机过程的残差是相关的，且主要关系也是非线性的。正因为如此“好使”，Hansen (1982) 成为了计量经济学领域最具影响力的论文之一。此外，Hansen 在提出 GMM 之后又对其进行了一系列必要的扩展，包括 alternative GMM estimators（Hansen, Heaton, and Yaron 1996）、工具变量选择（Hansen 1985）、连续时间模型（Hansen and Scheinkman 1995）以及非最优权重矩阵下的 GMM（Hansen and Jagannathan 1997）等。&lt;/p&gt;&lt;p&gt;有了 GMM，学术界终于可以一展身手，检验 CCAPM 了；GMM 首次被应用于资产定价正是出自 Hansen and Singleton (1982)，而他们的结论是 CCAPM 再次被拒绝了 —— &lt;b&gt;根据 CCAPM 理论、从数据估计出的时变折现因子 m 也根本无法解释资产价格的高波动&lt;/b&gt;。在 GMM 被推出之前，如果学术界对 CCAPM 被拒绝还心存幻想，那么这次 CCAPM 可以说是彻底被打败了。&lt;/p&gt;&lt;p&gt;让上述结果雪上加霜的是，Hansen and Jagannathan (1991) 为随机折现因子 m 的波动计算出了一个下界 —— 它和资产的夏普率有关。以美国股市的数据来计算，m 波动的下界应该在 0.5 左右。从消费的实际数据来看，消费的波动是很低的。因此如果 CCAPM 能够解释随机折现因子 m 的波动，那么需要投资者具有不切实际的风险厌恶水平，否则就难以支撑 m 高达 0.5 的波动。&lt;/p&gt;&lt;p&gt;尽管 CCAPM 遭到了拒绝，但学术界似乎不想轻易放弃它，而是努力的对理论进行“完善”，包括提出不同形式的效用函数、以及考虑不同投资者偏好的差异等。&lt;b&gt;归根到底，是学术界不想放弃理性行为这个假设。&lt;/b&gt;而就在这个时期，考虑投资者非理性的行为金融学也悄然萌芽。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;05 行为金融学&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;如果要问谁是行为金融学的代表人物，得到的答案可能是 Amos Tversky 和 Daniel Kahneman。这两位的地位和贡献无需多言，但他们更多的还是从心理学的角度分析人如何做决策；另外可能的答案是 &lt;a href=&quot;https://zhuanlan.zhihu.com/p/38610013&quot; class=&quot;internal&quot;&gt;Richard Thaler&lt;/a&gt;，但 Thaler 更大的贡献是行为经济学（他获得诺奖也是因为在行为经济学上的贡献而非行为金融学）。&lt;/p&gt;&lt;p&gt;行为金融学的代表人物当属 &lt;b&gt;Robert Shiller&lt;/b&gt;，而奠定其地位的正是 Shiller (1984) 这篇提出了噪音交易者模型的论文。这篇论文成为了日后日益增长的行为金融学文献的起点。在 Shiller (1984) 的模型中，聪明投资者依基本面价值进行投资；&lt;b&gt;而噪音交易者的存在造成了价格和内在价值出现了偏离；价格的过度波动来源于人们非理性行为造成的对基本面信息的过度反应。&lt;/b&gt;反观聪明交易者，虽然能对预期回报做出理性反映，但这种反映因受到自身财富的限制而并不充分。&lt;/p&gt;&lt;p&gt;自 Shiller (1984) 发表之后，大量相关的研究结果被提出，&lt;b&gt;这其中有很多是从行为偏差的角度来修正 CCAPM 中理性偏好的假设，这无疑有着非凡的意义，它意味着基于理性和行为的模型正在结合。&lt;/b&gt;另一方面，更多的学者开始用心理学的发现来研究个&lt;a href=&quot;https://zhuanlan.zhihu.com/p/48155082&quot; class=&quot;internal&quot;&gt;人的行为和偏误&lt;/a&gt;，这些心理学发现包括 &lt;a href=&quot;https://zhuanlan.zhihu.com/p/38526672&quot; class=&quot;internal&quot;&gt;prospect theory&lt;/a&gt;、overconfidence 以及 &lt;a href=&quot;https://zhuanlan.zhihu.com/p/38610013&quot; class=&quot;internal&quot;&gt;mental accounting&lt;/a&gt; 等。&lt;/p&gt;&lt;p&gt;关于行为金融学如何影响资产价格的综述，感兴趣的小伙伴可参考&lt;a href=&quot;https://zhuanlan.zhihu.com/p/78564724&quot; class=&quot;internal&quot;&gt;《资产价格和交易量背后的行为金融学》&lt;/a&gt;。很多从行为金融学出发的新的定价模型被研究出来，它们对解释股票市场价格和交易量的高波动，以及价格在不同尺度下表现出的异象（比如长期的反转）给出了令人信服的解释。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-0dbd33705be090db825780a622d87547_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;481&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-0dbd33705be090db825780a622d87547_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-0dbd33705be090db825780a622d87547_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;481&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic4.zhimg.com/v2-0dbd33705be090db825780a622d87547_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-0dbd33705be090db825780a622d87547_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;Shiller (1984) 的另一个功绩是回应了长久以来“理性投资者”派对行为金融学的最大质疑 —— 如果价格偏离了价值，即能被预测，为什么没有因套利而消失？Shiller (1984) 提出了 limits to arbitrage（有限套利），排除了这个阻碍行为金融学发展的障碍。&lt;/p&gt;&lt;p&gt;在行为金融学的进一步发展中，大量的研究表明资产的价格和投资人非理性的情绪有密切的关系（比如泡沫）。这里面家喻户晓的例子包括金融市场的同质标的（例如同一个公司在不同市场上交易）不满足“一价定理”以及“封闭基金之谜”等。在这方面的更多证据可以参考 Shiller 的著作《非理性繁荣》（Shiller 2000）。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;06 预期收益率截面差异&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;到目前为止，我们对于资产价格的理解仍然停留在时间序列层面。一个自然的问题是：是什么决定了资产价格的截面差异？例如，为什么在同一时点，某只股票的价值比另一只更高呢？根据 P = E[mx]，价值取决于未来的现金流和折现因子的变化。那么，哪些因素决定了资产不同的现金流以及投资者对于不同资产的时间偏好和风险偏好呢？&lt;/p&gt;&lt;p&gt;关于资产收益截面差异的研究，首先进入我们脑海中的名字恐怕仍然非 &lt;b&gt;Eugene Fama&lt;/b&gt; 莫属。&lt;/p&gt;&lt;p&gt;以股票为例，50 年前关于其截面收益差异的第一范式无疑是 CAPM。在最初关于 CAPM 的检验中，最著名的两篇论文当属 Black, Jensen and Scholes (1972) 以及 Fama and MacBeth (1973)。Fama and MacBeth (1973) 开创性的在每个时间节点逐一进行截面回归，从而规避了残差收益率的截面相关性对回归结果的影响。这篇文章提出的“先回归、再均值”的方法，即 Fama-MacBeth regression，在后来得到了非常广泛的应用。&lt;/p&gt;&lt;p&gt;虽然最初的检验结果大体上支持 CAPM，但是到了上世纪 70 年代，很多 CAPM 无法解释的异象被提出。这些单一异象虽然都挑战着 CAPM，但它们并没有形成合力，所以人们并未对 CAPM 产生太大的质疑，直到 Fama and French (1992) 整合了之前被提出的多种异象，从而给了 CAPM 致命一击。&lt;/p&gt;&lt;p&gt;为了摒弃一个旧模型，唯有提出一个更好的新模型，而这个更好的模型就是 Fama and French (1993) 三因子模型。该模型在市场 β 的基础上加入了 HML 和 SMB 两个因子。Fama and French (1996) 指出三因子模型是 Merton (1973) ICAPM 的多因子版本，并认为 Size 和 Value 和公司的财务困境风险有关。但是，关于这二者代表何种 state variables 以及为什么它们能够捕捉市场 β 无法解释的风险依旧没有定论。&lt;/p&gt;&lt;p&gt;对于 value premium，风险解释的对立面是来自行为金融学的解释。这方面的代表论文要数 DeBondt and Thaler (1987) 以及 Lakonishok, Shleifer, and Vishny (1994)。他们认为投资者在市场好（差）的时候会对成长股（价值股）过度反应。当随后价格被修正时，前者的收益率就会降低，而后者的收益率会上升，造成 value premium。不过 Fama 认为这并不能解释 value 持续存在的原因，除非投资者从来不从他们的过错中学到什么。&lt;/p&gt;&lt;p&gt;Fama and French (1993) 拉开了使用多因子进行 empirical asset pricing 研究的序幕。这个三因子模型也一度成为股票定价中最重要的 benchmark，直到它的继任者 Fama and French (2015) 五因子模型诞生。在过去的二十五年中，Fama and French (1993) 引领了多因子研究的发展（很多主流因子模型被提出）以及因子背后成因解释的研究（行为金融学的研究结果也在这方面做出了巨大的贡献），后者的意义则更加非凡。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;07 结语&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;让我们来回顾一下本文到目前为止介绍的内容。&lt;/p&gt;&lt;p&gt;本文从 P = E[mx] 讲起，指出价格由折现因子以及未来的支付额的现值决定。从这个式子出发引出资产价格在短期内难以预测。在更长的时间尺度上，variance ratio tests 指出资产短期的波动大大高于长期的波动、价格的波动大大高于基本面的波动。过度波动意味着资产收益率在长期是可以预测的。既然 P 的波动远远大于 x 的波动，因此依据 P = E[mx]，随机折现因子 m 必须有很高的波动。在这方面，GMM 的提出让人们能够检验 CCAPM 并把它拒绝了，这也推动了行为金融学的发展，从非理性偏好的角度解释价格的高波动并认为价格可以偏离价值，而噪音交易者模型以及有限套利也为行为金融学的发展铺平了道路。如今，风险和行为偏差成为驱动资产价格变化的两大动力，它们也共同推动了人们关于资产预期收益率截面差异的理解。下图汇总了上述行文的逻辑导图。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-ef0ffffba519151dc940b3677507cced_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;927&quot; data-rawheight=&quot;387&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;927&quot; data-original=&quot;https://pic2.zhimg.com/v2-ef0ffffba519151dc940b3677507cced_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-ef0ffffba519151dc940b3677507cced_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;927&quot; data-rawheight=&quot;387&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;927&quot; data-original=&quot;https://pic2.zhimg.com/v2-ef0ffffba519151dc940b3677507cced_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-ef0ffffba519151dc940b3677507cced_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;写完本文，我有一种七经八络都非常舒爽的感觉。这是因为上面这个从 P = E[mx] 出发、一步步让我们理解资产价格的行文逻辑异常清晰。当然，如此清晰的逻辑完全不是我的功劳。&lt;/p&gt;&lt;p&gt;从行文中多次划重点提及的几个名字中，你大概已经看出了这篇文章主要是围绕 Eugene Fama、Lars Peter Hansen 以及 Robert Shiller 三位对于 empirical asset pricing 的贡献阐述的，而这三位于 2013 年分享了诺贝尔经济学奖。&lt;/p&gt;&lt;p&gt;没错，本文最重要的参考文献正是诺贝尔学术委员会为了介绍三位的研究成果而编纂的科普性文章 —— Understanding Asset Prices（文末有链接）。该文以上述这个无比清晰的逻辑阐述了学术界（特别是这三位）在资产定价方面的研究成果。由于篇幅有限，本文仅根据我自己的理解梳理了我认为最重要的部分，但它完全无法代替 Understanding Asset Prices 这篇雄文，因此建议感兴趣的小伙伴精读之。另外还有一个福音是，网上有一位叫劳佳的大神，把该文翻译成了中文并获授权免费分享（文末也有链接），供各位小伙伴参考。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-0943dc95e2a3d2d3b322a2c863c48fb3_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1082&quot; data-rawheight=&quot;747&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1082&quot; data-original=&quot;https://pic4.zhimg.com/v2-0943dc95e2a3d2d3b322a2c863c48fb3_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-0943dc95e2a3d2d3b322a2c863c48fb3_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1082&quot; data-rawheight=&quot;747&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1082&quot; data-original=&quot;https://pic4.zhimg.com/v2-0943dc95e2a3d2d3b322a2c863c48fb3_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-0943dc95e2a3d2d3b322a2c863c48fb3_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;这个中文版翻译的非常流畅（除少数术语稍微不够准确），可以代替原文的理解。不过值得一提的是，英文版在之后对其中的一些 typo 进行了修改，但由于中文翻译是根据最早的英文版翻译的，因此并没有修正。所以各位读中文版时，如果对某些公式感到困惑（我就卖个关子吧），可参考英文版。&lt;/p&gt;&lt;p&gt;前不久，我看了最近很火的一部电影 —— Free Solo（徒手攀岩），对里面的一段台词印象深刻。它说的是人类的自我挑战中，总要时不时有一个 quantum leap。Eugene Fama、Lars Peter Hansen 以及 Robert Shiller 三位的卓越研究无疑是 asset pricing 领域的 quantum leaps。&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;参考文献&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Barberis, N. (2018). Psychology-based models of asset prices and trading volume. Working paper, Yale School of Management.&lt;/li&gt;&lt;li&gt;Black, F., M. C. Jensen and M. Scholes (1972). The Capital Asset Pricing Model: Some Empirical Tests. In &lt;i&gt;Studies in the Theory of Capital Markets&lt;/i&gt;. M. C. Jensen (ed), New York: Praeger, 79 – 121.&lt;/li&gt;&lt;li&gt;Campbell, J. Y. and R. J. Shiller (1988). The dividend-price ratio and expectations of future dividends and discount factors. &lt;i&gt;Review of Financial Studies&lt;/i&gt;, Vol. 1(3), 195 – 228.&lt;/li&gt;&lt;li&gt;Cochrane, J. H (2005). &lt;i&gt;Asset Pricing (revised edition)&lt;/i&gt;. Princeton University Press.&lt;/li&gt;&lt;li&gt;DeBondt, W. F. M. and R. H. Thaler (1987). Further evidence on investor overreaction and stock market seasonality. &lt;i&gt;Journal of Finance&lt;/i&gt;, Vol. 42(3), 557 – 581.&lt;/li&gt;&lt;li&gt;Fama, E. F. (1965). The behavior of stock-market prices. &lt;i&gt;Journal of Business&lt;/i&gt;, Vol. 38(1), 34 – 105.&lt;/li&gt;&lt;li&gt;Fama, E. F. (1970). Efficient capital markets: a review of theory and empirical work. &lt;i&gt;Journal of Finance&lt;/i&gt;, Vol. 25(2), 383 – 417.&lt;/li&gt;&lt;li&gt;Fama, E. F., L. Fisher, M. C. Jensen, and R. Roll (1969). The adjustment of stock prices to new information. &lt;i&gt;International Economic Review&lt;/i&gt;, Vol. 10(1), 1 – 21.&lt;/li&gt;&lt;li&gt;Fama, E. F. and K. R. French (1988). Dividend yields and expected stock returns. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 22(1), 3 – 25.&lt;/li&gt;&lt;li&gt;Fama, E. F. and K. R. French (1992). The cross-section of expected stock returns. &lt;i&gt;Journal of Finance&lt;/i&gt;, Vol. 47(2), 427 – 465.&lt;/li&gt;&lt;li&gt;Fama, E. F. and K. R. French (1993). Common Risk Factors in the Returns on Stocks and Bonds. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 33(1), 3 – 56.&lt;/li&gt;&lt;li&gt;Fama, E. F. and K. R. French (1996). Multifactor explanations of asset pricing anomalies. &lt;i&gt;Journal of Finance&lt;/i&gt;, Vol. 51(1), 55 – 84.&lt;/li&gt;&lt;li&gt;Fama, E. F. and K. R. French (2015). A five-factor asset pricing model. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 116(1), 1 – 22.&lt;/li&gt;&lt;li&gt;Fama, E. F. and J. D. MacBeth (1973). Risk, return, and equilibrium: empirical tests. &lt;i&gt;Journal of Political Economy&lt;/i&gt;, Vol. 81(3), 607 – 636.&lt;/li&gt;&lt;li&gt;Grossman, S. J. and R. J. Shiller (1981). The determinants of variability of stock market prices. &lt;i&gt;American Economic Review&lt;/i&gt;, Vol. 71(2), 222 – 227.&lt;/li&gt;&lt;li&gt;Hansen, L. P. (1982). Large sample properties of generalized method of moments estimators. &lt;i&gt;Econometrica&lt;/i&gt;, Vol. 50(4), 1029 – 1054.&lt;/li&gt;&lt;li&gt;Hansen, L. P. (1985). A method for calculating bounds on the asymptotic covariance matrices of generalized method of moments estimators. &lt;i&gt;Journal of Econometrics&lt;/i&gt;, Vol. 30(1-2), 203 – 238.&lt;/li&gt;&lt;li&gt;Hansen, L. P., J. Heaton, and A. Yaron (1996). Finite-sample properties of some alternative GMM estimators. &lt;i&gt;Journal of Business &amp;amp; Economic Statistics&lt;/i&gt;, Vol. 14(3), 262 – 280.&lt;/li&gt;&lt;li&gt;Hansen, L. P. and R. Jagannathan (1991). Implications of security market data for models of dynamics economies. &lt;i&gt;Journal of Political Economy&lt;/i&gt;, Vol. 99(2), 225 – 262.&lt;/li&gt;&lt;li&gt;Hansen, L. P. and R. Jagannathan (1997). Assessing specification errors in stochastic discount factor models. &lt;i&gt;Journal of Finance&lt;/i&gt;, Vol. 52(2), 557 – 590.&lt;/li&gt;&lt;li&gt;Hansen, L. P. and J. A. Scheinkman (1995). Back to the future: generating moment implications for continuous-time Markov processes. &lt;i&gt;Econometrica&lt;/i&gt;, Vol. 63(4), 767 – 804.&lt;/li&gt;&lt;li&gt;Hansen, L. P. and K. J. Singleton (1982). Generalized instrumental variables estimation of nonlinear rational expectations models. &lt;i&gt;Econometrica&lt;/i&gt;, Vol. 50(5), 1269 – 1286.&lt;/li&gt;&lt;li&gt;Lakonishok, J., A. Shleifer, and R. W. Vishny (1994). Contrarian investment, extrapolation, and risk. &lt;i&gt;Journal of Finance&lt;/i&gt;, Vol. 49(5), 1541 – 1578.&lt;/li&gt;&lt;li&gt;Lo, A. W. (Eds.) (2007). &lt;i&gt;The International Library of Financial Econometrics Series, Volumes 1 – 5&lt;/i&gt;. Cheltenham, UK: Edward Elgar Publishers.&lt;/li&gt;&lt;li&gt;Mandelbrot, B. (1966). Forecasts of future prices, unbiased markets, and &amp;#34;Martingale&amp;#34; models. &lt;i&gt;Journal of Business&lt;/i&gt;, Vol. 39(1), 242 – 255.&lt;/li&gt;&lt;li&gt;Merton, R. C. (1973). An intertemporal capital asset pricing model. &lt;i&gt;Econometrica&lt;/i&gt;, Vol. 41(5), 867 – 887.&lt;/li&gt;&lt;li&gt;Samuelson, P. (1965). Proof that properly anticipated prices fluctuate randomly. &lt;i&gt;Industrial Management Review&lt;/i&gt;, Vol. 6, 41 – 49.&lt;/li&gt;&lt;li&gt;Shiller, R. J. (1979). The volatility of long term interest rates and expectations models of the term structure. &lt;i&gt;Journal of Political Economy&lt;/i&gt;, Vol. 87(6), 1190 – 1219.&lt;/li&gt;&lt;li&gt;Shiller, R. J. (1981). Do stock prices move too much to be justified by subsequent changes in dividends? &lt;i&gt;American Economic Review&lt;/i&gt;, Vol. 71(3), 421 – 436.&lt;/li&gt;&lt;li&gt;Shiller, R. J. (1984). Stock prices and social dynamics. &lt;i&gt;Brookings Papers on Economic Activity&lt;/i&gt;, Vol. 1984(2), 457 – 510.&lt;/li&gt;&lt;li&gt;Shiller, R. J. (2000). &lt;i&gt;Irrational Exuberance&lt;/i&gt;. Princeton University Press.&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//www.nobelprize.org/uploads/2018/06/advanced-economicsciences2013.pdf&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://www.&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;nobelprize.org/uploads/&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;2018/06/advanced-economicsciences2013.pdf&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//www.jlao.net/wp-content/uploads/2013/12/NobelEconomics1.pdf&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://www.&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;jlao.net/wp-content/upl&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;oads/2013/12/NobelEconomics1.pdf&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;免责声明：&lt;/b&gt;文章内容不可视为投资意见。市场有风险，入市需谨慎。&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处。已委托“维权骑士”(&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//rightknights.com/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;维权骑士_免费版权监测/版权保护/内容多平台分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2019-10-25-88458489</guid>
<pubDate>Fri, 25 Oct 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>金融计量学发展史上的重要文献</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2019-10-15-86823603.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/86823603&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-f2989a75f857484b6a7c82354a357423_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;摘要&lt;/b&gt;&lt;/p&gt;&lt;p&gt;随着金融产品和工具变得越来越复杂，各种模型和方法也变得越来越复杂。Lo (2007b) 总结了金融计量学发展史上的重要文献。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;01 引言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;工欲善其事，必先利其器。&lt;/p&gt;&lt;p&gt;这句话在量化投资领域得到了很好的诠释。从研究收益率和价格的 &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzIyMDEwNDk1Mg%3D%3D%26mid%3D2650877757%26idx%3D1%26sn%3D03e705fcc0abf1c016b26dd1f9139d4d%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;random walk 模型&lt;/a&gt;、长记忆性以及肥尾（如&lt;a href=&quot;https://zhuanlan.zhihu.com/p/38282038&quot; class=&quot;internal&quot;&gt;分数布朗运动&lt;/a&gt;）、价格配对的&lt;a href=&quot;https://zhuanlan.zhihu.com/p/38755022&quot; class=&quot;internal&quot;&gt;协整&lt;/a&gt;，到研究资产定价的 &lt;a href=&quot;https://zhuanlan.zhihu.com/p/39455532&quot; class=&quot;internal&quot;&gt;CAPM&lt;/a&gt;、Fama-French 三因子模型、以及 APT 理论（&lt;a href=&quot;https://zhuanlan.zhihu.com/p/79431970&quot; class=&quot;internal&quot;&gt;多因子模型&lt;/a&gt;）；从基于连续时间的&lt;a href=&quot;https://zhuanlan.zhihu.com/p/38293827&quot; class=&quot;internal&quot;&gt;衍生品定价模型&lt;/a&gt;、高频策略倚赖的市场微观结构，再到更精细的统计工具如 &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzUxNzY0NjU3Mw%3D%3D%26mid%3D2247484061%26idx%3D1%26sn%3Db836d7aa4d140ee6d2a2887dff882451%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;GMM&lt;/a&gt;、&lt;a href=&quot;https://zhuanlan.zhihu.com/p/38614373&quot; class=&quot;internal&quot;&gt;贝叶斯方法&lt;/a&gt;、乃至机器学习，这些&lt;b&gt;金融计量学（financial econometrics）&lt;/b&gt;方法为今天各种丰富的量化策略和数量化投资研究打下了坚实的基础。而随着金融产品和金融工具变得越来越复杂，各种模型和方法也变得越来越复杂。&lt;/p&gt;&lt;p&gt;对于想要在金融工程和量化投资一展身手的小伙伴来说，如果有人分门别类的把过去几十年发展而来的各种金融计量方法加以总结，那无疑是一个巨大的福音。前一阵子，我在网上找资料的时候，无意间发现了这个福音。&lt;/p&gt;&lt;p&gt;而这个造福大众的人，正是在金融工程领域占据举足轻重地位的 Andrew Lo（罗闻全）教授。2007 年，他编纂的金融计量学丛书 International Library of Financial Econometrics 系列由 Edward Elgar Publishers 出版（Lo 2007b）。该系列共包括 5 卷，囊括 114 篇颇具开创性和影响力的学术论文，从 5 个角度梳理了金融计量方法和模型的发展：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;Volume I：&lt;/b&gt;Statistical models of asset prices；&lt;/li&gt;&lt;li&gt;&lt;b&gt;Volume II：&lt;/b&gt;Static asset pricing models；&lt;/li&gt;&lt;li&gt;&lt;b&gt;Volume III：&lt;/b&gt;Dynamic asset pricing models；&lt;/li&gt;&lt;li&gt;&lt;b&gt;Volume IV：&lt;/b&gt;Continuous-time methods and market microstructure；&lt;/li&gt;&lt;li&gt;&lt;b&gt;Volume V：&lt;/b&gt;Statistical methods and non-standard finance。&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;在 CFA 官网上一篇 book review 的文章如此评价该系列：&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;This five-volume set of 114 articles, edited by the prominent financial economist Andrew Lo, brings together many of the most import academic studies of the past four and a half decades in the growing field of financial econometrics. Like the field itself, the scope of this collection is quite wide, touching nearly every issue in empirical finance.&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;除此之外，Lo (2007a) 也在 SSRN 上以 Financial Econometrics 为题撰文对该系列进行了介绍。本文的主要目的就是以 Lo (2007a) 为主要参考文献来介绍金融计量学的发展，以供感兴趣的小伙伴查阅金融计量领域的相关文献。值得一提的是，这套丛书的出版距今已超过十年，因此它自然无法包括这十年来该领域的最新进展，因此本文的第四小节会以此为出发点简单聊聊该系列的不足。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;02 金融计量学的发展&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;金融计量领域的发展始于上世纪 60 年，并在过去的半个世纪呈现了井喷式发展。而发展的背后离不开以下三个要素：&lt;b&gt;需求&lt;/b&gt;、&lt;b&gt;大师&lt;/b&gt;和&lt;b&gt;计算机技术&lt;/b&gt;。&lt;/p&gt;&lt;p&gt;先说需求。随着时间的推移，金融系统变得愈发复杂，这表现为更多的市场参与者、更丰富的金融工具、以及与日俱增的交易量。这一切使得人们迫切需要能够用来研究和分析金融市场的各种计量工具，也使得金融计量学的发展成为了一种必然。&lt;/p&gt;&lt;p&gt;再说大师。任何一个领域的从无到有都离不开大师。对计量金融领域这些巨匠的名字我们也早已耳熟能详 —— Fischer Black、&lt;a href=&quot;https://zhuanlan.zhihu.com/p/68850512&quot; class=&quot;internal&quot;&gt;Eugene Fama&lt;/a&gt;、John Lintner、Harry Markowitz、Robert Merton、Franco Modigliani、Merton Miller、Stephen Ross、Paul Samuelson、Myron Scholes 以及 William Sharpe 等，哪个不是如雷贯耳、家喻户晓？他们的卓越成就为现代量化金融分析的发展奠定了深远而持久的基础。&lt;/p&gt;&lt;p&gt;最后说计算机技术。金融计量学的发展自然离不开计算机技术的突破 —— 包括软件、硬件、数据的采集和存储。如果没有 CRSP 的价格数据，那么有效市场假说仅仅是一个“文科”概念，而非一个 testable hypothesis；如果没有 Compustat/Wind 的公司财务数据，那么基本面量化投资乃至因子投资也仅仅是纸上谈兵。正是有了各种各样的数据，才使得诸如 α、β、R-squared、相关系数、累积收益率、&lt;a href=&quot;https://zhuanlan.zhihu.com/p/38279811&quot; class=&quot;internal&quot;&gt;夏普率&lt;/a&gt;这些概念有了具体而鲜活的意义。&lt;/p&gt;&lt;p&gt;接下来就看看这套丛书的每一卷都有哪些内容。&lt;/p&gt;&lt;p&gt;第一卷是关于收益率的各种模型，它们是一切金融计量方法的出发点。这些模型对收益率的基本特征进行了刻画，包括预测性、肥尾、&lt;a href=&quot;https://zhuanlan.zhihu.com/p/77307871&quot; class=&quot;internal&quot;&gt;序列相关性&lt;/a&gt;、以及时变的波动率等。第二卷是静态资产定价模型，它在收益率基础上增加了进一步的假设，包括投资者偏好、参数分布以及一般均衡假设等，我们熟悉的 CAPM、APT 以及业绩归因均属于这卷的内容。第三卷在之前的基础上列举了动态资产定价模型的相关文献，比如 consumption-based 资产定价模型和 term structure 模型等。在第三卷的基础上，第四卷总结了衍生品连续时间随机过程的和市场微观结构的相关文献，深化了人们对于价格和收益率动态变化的理解。全系列的第五卷另辟蹊径，总结了方法论方面的一些重磅文献，比如 GMM、贝叶斯理论、&lt;a href=&quot;https://zhuanlan.zhihu.com/p/56154663&quot; class=&quot;internal&quot;&gt;selection and data-snooping bias&lt;/a&gt;、&lt;a href=&quot;https://zhuanlan.zhihu.com/p/75304930&quot; class=&quot;internal&quot;&gt;event study&lt;/a&gt; 等，使得整套丛书更加充实。&lt;/p&gt;&lt;p&gt;下一小节将罗列每一卷的具体文献。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;03 具体文献&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;Volume I: Statistical Models of Asset Returns&lt;/b&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-0d843a4fc35e5921e78ef5ffd9b275ed_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;663&quot; data-rawheight=&quot;689&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;663&quot; data-original=&quot;https://pic2.zhimg.com/v2-0d843a4fc35e5921e78ef5ffd9b275ed_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-0d843a4fc35e5921e78ef5ffd9b275ed_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;663&quot; data-rawheight=&quot;689&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;663&quot; data-original=&quot;https://pic2.zhimg.com/v2-0d843a4fc35e5921e78ef5ffd9b275ed_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-0d843a4fc35e5921e78ef5ffd9b275ed_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-217477aecf045a6fb6805755b2127b97_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;680&quot; data-rawheight=&quot;800&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;680&quot; data-original=&quot;https://pic4.zhimg.com/v2-217477aecf045a6fb6805755b2127b97_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-217477aecf045a6fb6805755b2127b97_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;680&quot; data-rawheight=&quot;800&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;680&quot; data-original=&quot;https://pic4.zhimg.com/v2-217477aecf045a6fb6805755b2127b97_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-217477aecf045a6fb6805755b2127b97_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;Volume II: Static Asset Pricing Models&lt;/b&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-49225a29c0b7e691da6c5ff5d18b8996_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;666&quot; data-rawheight=&quot;654&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;666&quot; data-original=&quot;https://pic3.zhimg.com/v2-49225a29c0b7e691da6c5ff5d18b8996_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-49225a29c0b7e691da6c5ff5d18b8996_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;666&quot; data-rawheight=&quot;654&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;666&quot; data-original=&quot;https://pic3.zhimg.com/v2-49225a29c0b7e691da6c5ff5d18b8996_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-49225a29c0b7e691da6c5ff5d18b8996_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-6297869f0131a0a6c35e6e769351809a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;666&quot; data-rawheight=&quot;856&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;666&quot; data-original=&quot;https://pic3.zhimg.com/v2-6297869f0131a0a6c35e6e769351809a_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-6297869f0131a0a6c35e6e769351809a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;666&quot; data-rawheight=&quot;856&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;666&quot; data-original=&quot;https://pic3.zhimg.com/v2-6297869f0131a0a6c35e6e769351809a_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-6297869f0131a0a6c35e6e769351809a_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;Volume III: Dynamic Asset Pricing Models&lt;/b&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-0aae2ab97e6bf29c5de9fdca6719e243_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;664&quot; data-rawheight=&quot;645&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;664&quot; data-original=&quot;https://pic4.zhimg.com/v2-0aae2ab97e6bf29c5de9fdca6719e243_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-0aae2ab97e6bf29c5de9fdca6719e243_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;664&quot; data-rawheight=&quot;645&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;664&quot; data-original=&quot;https://pic4.zhimg.com/v2-0aae2ab97e6bf29c5de9fdca6719e243_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-0aae2ab97e6bf29c5de9fdca6719e243_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-c9f3a7bbd1d0e161f3f7b9706574a501_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;662&quot; data-rawheight=&quot;418&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;662&quot; data-original=&quot;https://pic2.zhimg.com/v2-c9f3a7bbd1d0e161f3f7b9706574a501_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-c9f3a7bbd1d0e161f3f7b9706574a501_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;662&quot; data-rawheight=&quot;418&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;662&quot; data-original=&quot;https://pic2.zhimg.com/v2-c9f3a7bbd1d0e161f3f7b9706574a501_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-c9f3a7bbd1d0e161f3f7b9706574a501_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-cc99e11b54b3870b6ef51a9e6a49b4a6_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;662&quot; data-rawheight=&quot;471&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;662&quot; data-original=&quot;https://pic3.zhimg.com/v2-cc99e11b54b3870b6ef51a9e6a49b4a6_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-cc99e11b54b3870b6ef51a9e6a49b4a6_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;662&quot; data-rawheight=&quot;471&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;662&quot; data-original=&quot;https://pic3.zhimg.com/v2-cc99e11b54b3870b6ef51a9e6a49b4a6_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-cc99e11b54b3870b6ef51a9e6a49b4a6_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-f2a3f6c8168bb716871337017a23ef24_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;662&quot; data-rawheight=&quot;72&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;662&quot; data-original=&quot;https://pic1.zhimg.com/v2-f2a3f6c8168bb716871337017a23ef24_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-f2a3f6c8168bb716871337017a23ef24_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;662&quot; data-rawheight=&quot;72&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;662&quot; data-original=&quot;https://pic1.zhimg.com/v2-f2a3f6c8168bb716871337017a23ef24_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-f2a3f6c8168bb716871337017a23ef24_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;Volume IV: Continuous-Time Methods and Market Microstructure&lt;/b&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-9e259ce03280358ff13de28debd89f7f_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;662&quot; data-rawheight=&quot;637&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;662&quot; data-original=&quot;https://pic4.zhimg.com/v2-9e259ce03280358ff13de28debd89f7f_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-9e259ce03280358ff13de28debd89f7f_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;662&quot; data-rawheight=&quot;637&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;662&quot; data-original=&quot;https://pic4.zhimg.com/v2-9e259ce03280358ff13de28debd89f7f_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-9e259ce03280358ff13de28debd89f7f_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-a0550fef26e806855ee891ce73253806_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;662&quot; data-rawheight=&quot;627&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;662&quot; data-original=&quot;https://pic3.zhimg.com/v2-a0550fef26e806855ee891ce73253806_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-a0550fef26e806855ee891ce73253806_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;662&quot; data-rawheight=&quot;627&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;662&quot; data-original=&quot;https://pic3.zhimg.com/v2-a0550fef26e806855ee891ce73253806_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-a0550fef26e806855ee891ce73253806_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-ac7c2375ce3d7a32dd4f60a364aea9b2_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;662&quot; data-rawheight=&quot;282&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;662&quot; data-original=&quot;https://pic3.zhimg.com/v2-ac7c2375ce3d7a32dd4f60a364aea9b2_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-ac7c2375ce3d7a32dd4f60a364aea9b2_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;662&quot; data-rawheight=&quot;282&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;662&quot; data-original=&quot;https://pic3.zhimg.com/v2-ac7c2375ce3d7a32dd4f60a364aea9b2_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-ac7c2375ce3d7a32dd4f60a364aea9b2_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;Volume V: Statistical Methods and Non-Standard Finance&lt;/b&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-6d152caa0a5c531d583e041637dd8fd8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;662&quot; data-rawheight=&quot;649&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;662&quot; data-original=&quot;https://pic1.zhimg.com/v2-6d152caa0a5c531d583e041637dd8fd8_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-6d152caa0a5c531d583e041637dd8fd8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;662&quot; data-rawheight=&quot;649&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;662&quot; data-original=&quot;https://pic1.zhimg.com/v2-6d152caa0a5c531d583e041637dd8fd8_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-6d152caa0a5c531d583e041637dd8fd8_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-33c158ed04365bb8b7ca5e9effef7204_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;662&quot; data-rawheight=&quot;462&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;662&quot; data-original=&quot;https://pic1.zhimg.com/v2-33c158ed04365bb8b7ca5e9effef7204_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-33c158ed04365bb8b7ca5e9effef7204_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;662&quot; data-rawheight=&quot;462&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;662&quot; data-original=&quot;https://pic1.zhimg.com/v2-33c158ed04365bb8b7ca5e9effef7204_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-33c158ed04365bb8b7ca5e9effef7204_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-affb8b4d8e250b39eb6cecdc19b78046_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;662&quot; data-rawheight=&quot;448&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;662&quot; data-original=&quot;https://pic3.zhimg.com/v2-affb8b4d8e250b39eb6cecdc19b78046_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-affb8b4d8e250b39eb6cecdc19b78046_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;662&quot; data-rawheight=&quot;448&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;662&quot; data-original=&quot;https://pic3.zhimg.com/v2-affb8b4d8e250b39eb6cecdc19b78046_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-affb8b4d8e250b39eb6cecdc19b78046_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;04 结语&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;Lo (2007b) 虽然收录了 114 篇论文，但客观的说它并不完美。来自 CFA 官网的那篇 book review 也一针见血的指出：&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;Many of this volume&amp;#39;s articles have had substantial influence, but others represent the editor&amp;#39;s&lt;/i&gt; &lt;i&gt;&lt;b&gt;idiosyncratic interests&lt;/b&gt;.&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;Idiosyncratic interests —— 我看到这里反正笑出声了。但这个小批评也并非空穴来风。比如，在这套丛书在介绍衍生品定价模型时并没有收录 Black and Scholes (1973) 和 Merton (1973) 这两篇期权定价的开创性论文，着实令人匪夷所思。此外，该书中包括了“令人不是特别舒适的比例的”罗教授自己的文章（no offense）。&lt;/p&gt;&lt;p&gt;当然，Lo (2007b) 最大的“不足”是它出版的时间。由于是十年前的产物，它自然无法包括最近十年金融计量领域的最新发展，比如 Harvey, et al. (2016)、Barillas and Shanken (2018)、&lt;a href=&quot;https://zhuanlan.zhihu.com/p/71072376&quot; class=&quot;internal&quot;&gt;Jegadeesh, et al. (2019)&lt;/a&gt;、Pukthuanthong, et al. (2019) 以及 &lt;a href=&quot;https://zhuanlan.zhihu.com/p/84462587&quot; class=&quot;internal&quot;&gt;Fama and French (2019)&lt;/a&gt; 这些 asset pricing 方法论上的新进展。当然，要数过去十年方法论上的最大突破，无疑要数机器学习。&lt;/p&gt;&lt;p&gt;在 SSRN 上，如果我们搜索 all time 最具影响力的经济学学者，Michael Jensen 和 Eugene Fama 独领风骚。但是如果我们搜索近几年来下载量最高的作者，Marcos Lopez de Prado 这个（如今我们也已经不再陌生的）名字则脱颖而出。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-1b759bd77fcdb83adcb501ccc29d6952_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;528&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-1b759bd77fcdb83adcb501ccc29d6952_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-1b759bd77fcdb83adcb501ccc29d6952_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;528&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-1b759bd77fcdb83adcb501ccc29d6952_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-1b759bd77fcdb83adcb501ccc29d6952_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;近几年，Lopez de Prado 在将机器学习应用于金融投资的实践中做了非常多的探索，发表了很多颇具实践意义的论文，可谓是在金融领域应用机器学习的先驱之一。他的集大成之作当属 Lopez de Prado (2018) 这本专著。他认为在量化交易中，传统的计量经济学应逐渐被机器学习取代，因为后者才更加适合金融数据的各种特征。他也曾在一篇题为 &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzAxNTc0Mjg0Mg%3D%3D%26mid%3D2653292186%26idx%3D1%26sn%3D87501434ae16f29afffec19a6884ee8d%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;The 7 reasons most econometric investments fail&lt;/a&gt;的报告中谈论了传统计量方法的局限。不过，从 Andrew Lo 的分类来看，机器学习的发展也属于 financial econometrics，因此我仍然把 Lopez de Prado 的各种方法论归结为金融计量学的新发展，而非代替物。&lt;/p&gt;&lt;p&gt;毫无疑问，人们无法无视机器学习的飞速发展以及它在金融领域越来越重要的作用，而它也是后 Lo (2007b) 时代，我们需要接受并拥抱的最重要的变革。&lt;/p&gt;&lt;p&gt;尽管存在一些不足，但瑕不掩瑜，Lo (2007b) 仍然是一项造福后人的工程。细数这 5 卷丛书中的经典论文能够让我们一览现代金融计量学发展的重要脉络。&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;参考文献&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Barillas, F. and J. Shanken (2018). Comparing asset pricing models. &lt;i&gt;Journal of Finance&lt;/i&gt;, Vol. 73(2), 715 – 754.&lt;/li&gt;&lt;li&gt;Black F. and M. Scholes (1973). The pricing of options and corporate liabilities. &lt;i&gt;Journal of Political Economy&lt;/i&gt;, Vol. 81(3), 637 – 654.&lt;/li&gt;&lt;li&gt;Fama, E. F. and K. R. French (2019). Comparing cross-section and time-series factor models. &lt;i&gt;Review of Financial Studies&lt;/i&gt;, forthcoming.&lt;/li&gt;&lt;li&gt;Harvey, C. R., Y. Liu, and H. Zhu (2016). … and the cross-section of expected returns. &lt;i&gt;Review of Financial Studies&lt;/i&gt;, Vol. 29(1), 5 – 68.&lt;/li&gt;&lt;li&gt;Jegadeesh, N., J. Noh, K. Pukthuanthong, R. Roll, and J. Wang (2019). Empirical tests of asset pricing models with individual assets: Resolving the errors-in-variables bias in risk premium estimation. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 133(2), 273 – 298.&lt;/li&gt;&lt;li&gt;Lo, A. W. (2007a). Financial econometrics. SSRN: &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//ssrn.com/abstract%3D991805&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;ssrn.com/abstract=99180&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;.&lt;/li&gt;&lt;li&gt;Lo, A. W. (Eds.) (2007b). &lt;i&gt;The International Library of Financial Econometrics Series, Volumes 1 – 5&lt;/i&gt;. Cheltenham, UK: Edward Elgar Publishers.&lt;/li&gt;&lt;li&gt;Lopez de Prado, M. (2018). &lt;i&gt;Advances in Financial Machine Learning&lt;/i&gt;. Hoboken, NJ: John Wiley &amp;amp; Sons.&lt;/li&gt;&lt;li&gt;Merton R. C. (1973). Theory of rational option pricing. The &lt;i&gt;Bell Journal of Economics and Management Science&lt;/i&gt;, Vol. 4(1), 141 – 183.&lt;/li&gt;&lt;li&gt;Pukthuanthong, K., R. Roll, and A. Subrahmanyam (2019). A protocol for factor identification. &lt;i&gt;Review of Financial Studies&lt;/i&gt;, Vol. 32(4), 1573 – 1607.&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;免责声明：&lt;/b&gt;文章内容不可视为投资意见。市场有风险，入市需谨慎。&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处。已委托“维权骑士”(&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//rightknights.com/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;维权骑士_免费版权监测/版权保护/内容多平台分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2019-10-15-86823603</guid>
<pubDate>Tue, 15 Oct 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>Which Beta (II) ?</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2019-09-27-84462587.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/84462587&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-f1ba0736286363fae232880f47a5d020_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;摘要&lt;/b&gt;&lt;/p&gt;&lt;p&gt;Fama and French (2019) 系统的比较了时序和截面多因子定价模型，为回答 which beta 提供了有力的依据。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;01 引言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;近日，Eugene Fama 和他的老搭档 Ken French 在 Review of Financial Studies 上发表了一篇题为 Comparing cross-section and time-series factor models 的最新文章（Fama and French 2019）。顾名思义，该文对比了截面（CS）和时序（TS）两种因子模型在解释资产收益率时的效果。&lt;/p&gt;&lt;p&gt;这篇文章保留了 FF 一贯简单、直接、从数据出发的文风。但是它在 CS 和 TS 上来回切换，在时序回归 β 为作为因子载荷和以 firm characteristics 作为因子载荷之间辗转腾挪，读来也着实令人烧脑。需要对 CS 和 TS 模型，以及使用到的 Fama and MacBeth (1973) Regression（以下记为 FM regression）非常熟悉才不至于在阅读时迷失。有小伙伴后台留言希望我们能介绍一下这篇文章，今天就借这个机会对它进行解读。&lt;/p&gt;&lt;p&gt;&lt;b&gt;Fama and French (2019) 的目的是为了从 TS 和 CS 的比较中找出更好的定价模型（empirical asset pricing model）。&lt;/b&gt;它的结论对于进行因子投资非常有价值，因为更好的模型意味着在截面上能更好区分股票预期收益率的差异。在 Fama and French (2019) 一文中，两位作者先后考虑了四个模型，进行了全方位系统的对比，从实证数据中得出了非常符合预期的结论，而这个结论也刚好能回答前文&lt;a href=&quot;https://zhuanlan.zhihu.com/p/71072376&quot; class=&quot;internal&quot;&gt;《Which Beta ?》&lt;/a&gt;所关注的核心问题。&lt;/p&gt;&lt;p&gt;为此，我给本文起名为《Which Beta (II) ?》。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;02 Fama-MacBeth Regression&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;Fama and French (2019) 一文以 Fama and French (2015) 五因子模型（下文记为 FF5）为 benchmark 构建了不同 TS、CS 版本的因子模型。为构建 CS 模型，他们采用了 FM regression。&lt;/p&gt;&lt;p&gt;传统的 FM regression 分为两步：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;b&gt;第一步是时序回归：&lt;/b&gt;把因子收益率放在回归方程的 RHS，把资产收益率逐一放在回归方程的 LHS，通过时序回归计算每个资产在这些因子上的 factor loading β；&lt;/li&gt;&lt;li&gt;&lt;b&gt;第二步是截面回归：&lt;/b&gt;使用第一步得到的 β 作为解释变量放在 RHS，使用资产的收益率放在 LHS，截面回归求出因子的 risk premium λ；每一期得到每个因子的溢价后，最后检验每个因子溢价的均值是否显著。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;最初，Fama and MacBeth (1973) 一文是为了检验 CAPM。因此，它的第一步是为了得到个股的 market β 值。而如今无论是学术界还是业界的应用中，在使用 FM regression 时，往往跳过第一步，而直接运用它第二步中“先单期截面回归、再从时序上取平均”的思想，以排除残差收益率的截面相关性带来的影响。&lt;/p&gt;&lt;p&gt;既然跳过了第一步，那么用什么来做 factor loading 呢？对，正是 firm characteristics。比如我们熟悉的 Barra 模型，其本质是一个 FM regression。它没有使用第一步时序回归计算 factor loading，而是直接使用了 firm characteristics，并进行第二步的截面回归计算 factor risk premium。&lt;/p&gt;&lt;p&gt;Fama and French (2019) 一文也正是使用 firm characteristics 作为 factor loadings，并通过 FM regression 来提出截面因子模型。考虑 FF5 中的五个因子，除了市场因子外，其余四个风格因子用到的 firm characteristics 包括 Market Cap（MC）、Book-to-Market（BM）、Operating Profitability（OP）以及 Change of Total Assets（INV）。以这四个指标作为 RHS，以资产下期收益率作为 LHS，可以写出 FM regression：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=R_%7Bit%7D%3DR_%7Bzt%7D%2BR_%7B%5Csmall%7B%5Cmbox%7BMC%7Dt%7D%7D%5Cmbox%7BMC%7D_%7Bit-1%7D%2BR_%7B%5Csmall%7B%5Cmbox%7BBM%7Dt%7D%7D%5Cmbox%7BBM%7D_%7Bit-1%7D%2BR_%7B%5Csmall%7B%5Cmbox%7BOP%7Dt%7D%7D%5Cmbox%7BOP%7D_%7Bit-1%7D%2BR_%7B%5Csmall%7B%5Cmbox%7BINV%7Dt%7D%7D%5Cmbox%7BINV%7D_%7Bit-1%7D%2Be_%7Bit%7D&quot; alt=&quot;R_{it}=R_{zt}+R_{\small{\mbox{MC}t}}\mbox{MC}_{it-1}+R_{\small{\mbox{BM}t}}\mbox{BM}_{it-1}+R_{\small{\mbox{OP}t}}\mbox{OP}_{it-1}+R_{\small{\mbox{INV}t}}\mbox{INV}_{it-1}+e_{it}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;在每一期 t – 1， 通过使用该期的指标和 t 期资产收益率进行截面回归，就可以得到 t 期这些指标的因子收益率。上式中，所有 R 代表的变量均表示不同的收益率，其中 &lt;img src=&quot;https://www.zhihu.com/equation?tex=R_%7Bzt%7D&quot; alt=&quot;R_{zt}&quot; eeimg=&quot;1&quot;/&gt; 为截距项（会在本文第三节重点说明）， &lt;img src=&quot;https://www.zhihu.com/equation?tex=e_%7Bit%7D&quot; alt=&quot;e_{it}&quot; eeimg=&quot;1&quot;/&gt;  为残差项。&lt;/p&gt;&lt;p&gt;由截面回归的性质可知，这些收益率对应的投资组合均为&lt;b&gt;纯因子组合&lt;/b&gt;。以 &lt;img src=&quot;https://www.zhihu.com/equation?tex=R_%7B%5Csmall%5Cmbox%7BMC%7Dt%7D&quot; alt=&quot;R_{\small\mbox{MC}t}&quot; eeimg=&quot;1&quot;/&gt; 为例，它是 MC 因子纯因子组合的收益率，该组合满足在 MC 因子上一个单位的暴露，而在其他三个因子上零暴露。而截距项对应的投资组合则满足其中资产的权重之和为 1，而在任何风格因子上均没有暴露。将上式中  &lt;img src=&quot;https://www.zhihu.com/equation?tex=R_%7Bzt%7D&quot; alt=&quot;R_{zt}&quot; eeimg=&quot;1&quot;/&gt;  挪到等式左侧得到：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=R_%7Bit%7D-R_%7Bzt%7D%3DR_%7B%5Csmall%7B%5Cmbox%7BMC%7Dt%7D%7D%5Cmbox%7BMC%7D_%7Bit-1%7D%2BR_%7B%5Csmall%7B%5Cmbox%7BBM%7Dt%7D%7D%5Cmbox%7BBM%7D_%7Bit-1%7D%2BR_%7B%5Csmall%7B%5Cmbox%7BOP%7Dt%7D%7D%5Cmbox%7BOP%7D_%7Bit-1%7D%2BR_%7B%5Csmall%7B%5Cmbox%7BINV%7Dt%7D%7D%5Cmbox%7BINV%7D_%7Bit-1%7D%2Be_%7Bit%7D&quot; alt=&quot;R_{it}-R_{zt}=R_{\small{\mbox{MC}t}}\mbox{MC}_{it-1}+R_{\small{\mbox{BM}t}}\mbox{BM}_{it-1}+R_{\small{\mbox{OP}t}}\mbox{OP}_{it-1}+R_{\small{\mbox{INV}t}}\mbox{INV}_{it-1}+e_{it}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;不妨把这个式子称为（*）式，它是 Fama and French (2019) 构建 CS 定价模型的关键，我们会留在第三节进行说明。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;03 三个模型&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;Fama and French (2019) 一文共考虑了四个多因子定价模型，两个 TS 模型，两个 CS 模型。其中第二个 TS 模型是在其更早的 working paper 版本中并没有出现，它里面考虑了交叉项。但老实说这第二个 TS 模型并不是 Fama and French (2019) 对比的重点，所以下文中不做考虑。本文仅介绍三个模型：一个 TS 模型和两个 CS 模型。&lt;/p&gt;&lt;p&gt;TS 模型就是我们熟悉的 FF5：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=R_%7Bit%7D-R_%7Bft%7D%3Da_i%2Bb_i%28R_%7Bmt%7D-R_%7Bft%7D%29%2Bs_i%5Cmbox%7BSMB%7D_t%2Bh_i%5Cmbox%7BHML%7D_t%2Br_i%5Cmbox%7BRMW%7D_t%2Bc_i%5Cmbox%7BCMA%7D_t%2Be_%7Bit%7D&quot; alt=&quot;R_{it}-R_{ft}=a_i+b_i(R_{mt}-R_{ft})+s_i\mbox{SMB}_t+h_i\mbox{HML}_t+r_i\mbox{RMW}_t+c_i\mbox{CMA}_t+e_{it}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;其中 &lt;img src=&quot;https://www.zhihu.com/equation?tex=R_%7Bmt%7D&quot; alt=&quot;R_{mt}&quot; eeimg=&quot;1&quot;/&gt; 是 t 期市场收益率， &lt;img src=&quot;https://www.zhihu.com/equation?tex=R_%7Bft%7D&quot; alt=&quot;R_{ft}&quot; eeimg=&quot;1&quot;/&gt; 为 t 期无风险收益率，SMB、HML、RMW 以及 CMA 这些是使用相应 firm characteristics 通过 2 × 3 double sort 构建的多空对冲组合的收益率，代表了因子的收益率（具体方法可参考 Fama and French 2015），而小写字母 &lt;img src=&quot;https://www.zhihu.com/equation?tex=b_i&quot; alt=&quot;b_i&quot; eeimg=&quot;1&quot;/&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=s_i&quot; alt=&quot;s_i&quot; eeimg=&quot;1&quot;/&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=h_i&quot; alt=&quot;h_i&quot; eeimg=&quot;1&quot;/&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=r_i&quot; alt=&quot;r_i&quot; eeimg=&quot;1&quot;/&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=c_i&quot; alt=&quot;c_i&quot; eeimg=&quot;1&quot;/&gt; 则代表了公司 i 在这些因子上的暴露，通过时序回归得到；a_i 是截距项，即该模型无法解释的超额收益。&lt;/p&gt;&lt;p&gt;说完了 TS 模型，再来说 CS 模型。还记得（*）式吗？&lt;/p&gt;&lt;p&gt;它是 CS 模型的基础，但它看起来不像个定价模型，原因是它是一个单期的截面回归。如果我们把全部 T 期的截面回归&lt;b&gt;跨时间堆叠在一起&lt;/b&gt;（用 FF 的话叫 stacked across time），并在（*）等号右边的表达中将收益率和作为 loading 的 firm characteristics 位置对调，就可以得到下面这个式子：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=R_%7Bit%7D-R_%7Bzt%7D%3D%5Cmbox%7BMC%7D_%7Bit-1%7DR_%7B%5Csmall%7B%5Cmbox%7BMC%7Dt%7D%7D%2B%5Cmbox%7BBM%7D_%7Bit-1%7DR_%7B%5Csmall%7B%5Cmbox%7BBM%7Dt%7D%7D%2B%5Cmbox%7BOP%7D_%7Bit-1%7DR_%7B%5Csmall%7B%5Cmbox%7BOP%7Dt%7D%7D%2B%5Cmbox%7BINV%7D_%7Bit-1%7DR_%7B%5Csmall%7B%5Cmbox%7BINV%7Dt%7D%7D%2Be_%7Bit%7D&quot; alt=&quot;R_{it}-R_{zt}=\mbox{MC}_{it-1}R_{\small{\mbox{MC}t}}+\mbox{BM}_{it-1}R_{\small{\mbox{BM}t}}+\mbox{OP}_{it-1}R_{\small{\mbox{OP}t}}+\mbox{INV}_{it-1}R_{\small{\mbox{INV}t}}+e_{it}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;通过这个变化，FM regression 摇身一变，成为一个定价模型，这就是第一个 CS 定价模型（记为 CS 模型一）。它是一个&lt;b&gt;四因子模型&lt;/b&gt;，因子为 R_MC、R_BM、R_OP 以及 R_INV，factor loading 为这些因子各自对应的 firm characteristics。特别需要强调的是，&lt;b&gt;该因子模型解释的并不是 TS 模型中 R_it 相对 R_f 的超额收益，而是 R_it 相对 R_zt 的超额收益。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=R_%7Bzt%7D&quot; alt=&quot;R_{zt}&quot; eeimg=&quot;1&quot;/&gt;  是什么呢？&lt;/p&gt;&lt;p&gt;从（*）式可知， &lt;img src=&quot;https://www.zhihu.com/equation?tex=R_%7Bzt%7D&quot; alt=&quot;R_{zt}&quot; eeimg=&quot;1&quot;/&gt; 是每个截面上 FM regression 回归的截距项，因此它显然和 FM regression 中 LHS 的那些资产的收益率有关。那么，Fama and French (2019) 用什么资产放在 LHS 呢？Fama and French (2019) 的目的是以 FF5 为基础比较 TS 和 CS 定价模型。&lt;b&gt;因此，显然不能随便挑一些无关资产放在 FM regression 的 LHS，那样的话 CS 模型的因子就和 FF5 的因子不具备可比性。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;从上面的描述中，你大概已经猜到了（用红笔划重点已经划到那个份儿上了），&lt;b&gt;被放在 FM regression 的 LHS 的资产必须和 FF5 的因子密切相关；事实上，这些 LHS 资产正是构建 FF5 因子的那些投资组合。&lt;/b&gt;在 FF5 中，除去市场因子，其他四个因子均是由市值和某个指标 2 × 3 double sort 得到的 6 个投资组合来构建。由于在 SMB 之外还有三个因子，因此一共有 6 × 3 = 18 个投资组合。Fama and French (2019) 正是用这 18 个投资组合作为 FM regression 的 LHS，从而求出（*）式中的因子收益率 &lt;img src=&quot;https://www.zhihu.com/equation?tex=R_%7B%5Csmall%5Cmbox%7BMC%7Dt%7D&quot; alt=&quot;R_{\small\mbox{MC}t}&quot; eeimg=&quot;1&quot;/&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=R_%7B%5Csmall%5Cmbox%7BBM%7Dt%7D&quot; alt=&quot;R_{\small\mbox{BM}t}&quot; eeimg=&quot;1&quot;/&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=R_%7B%5Csmall%5Cmbox%7BOP%7Dt%7D&quot; alt=&quot;R_{\small\mbox{OP}t}&quot; eeimg=&quot;1&quot;/&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=R_%7B%5Csmall%5Cmbox%7BINV%7Dt%7D&quot; alt=&quot;R_{\small\mbox{INV}t}&quot; eeimg=&quot;1&quot;/&gt;  以及截距项  &lt;img src=&quot;https://www.zhihu.com/equation?tex=R_%7Bzt%7D&quot; alt=&quot;R_{zt}&quot; eeimg=&quot;1&quot;/&gt; 。&lt;/p&gt;&lt;p&gt;上述 LHS 资产的选择在 Fama and French (2019) 中至关重要，它也对应着该文中很重要的一段话：&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;Using the same portfolios (those from the 2×3 sorts) to produce TS and CS factors is important. The cross-section regressions that generate the CS factors optimize the month-by-month description of returns of these portfolios. In contract, the TS factor definitions are arbitrary. Since the same portfolios produce the TS and CS factors,&lt;/i&gt; &lt;i&gt;&lt;b&gt;one central issue in our tests is whether the optimization of the CS factors enhances the description of average returns for test assets beyond those that produce the factors.&lt;/b&gt;&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;上面这段话的意思就是，CS 模型中，每个因子都是截面回归最优化得到的纯因子组合，保证了在目标因子上的单位暴露和在非目标因子无暴露；而在 TS 模型中，2 × 3 double sort 得到的因子则没有这样的性质，每个因子都可能在其他因子上有时变的暴露。基于这种差异，Fama and French (2019) 想要通过实证分析回答的问题是，&lt;b&gt;构建因子组合时的这种优化能否更好的解释截面预期收益率差异？&lt;/b&gt;&lt;/p&gt;&lt;p&gt;由于 LHS 资产是这 18 个投资组合，那么在 FM regression RHS 的 firm characteristics 显然也只能是这些投资组合的。这些投资组合的 firm characteristics 由每个组合中个股的相应指标按市值加权得到。此外，对 CS 模型中的每个因子，Fama and French (2019) 将这 18 个组合的指标在截面上进行了常规的标准化，让它们截面均值为 0，标准差为 1。&lt;/p&gt;&lt;p&gt;下面我们终于能够回答 R_zt 是什么了。假设我们有一个投资组合（称为 X）是上述 18 个组合的等权平均。令 R_X 代表这个组合的收益率。依据上述标准化方法，由于 X 组合是这 18 个组合的平均，因此它在 CS 模型中的全部四个因子上的暴露均为零。把 R_X 和这些零暴露（factor loading = 0）代入到（*）式中有：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+R_X%26%3D%26R_%7Bzt%7D%2B0%5Ctimes+R_%7B%5Csmall%7B%5Cmbox%7BMC%7Dt%7D%7D%2B0%5Ctimes+R_%7B%5Csmall%7B%5Cmbox%7BBM%7Dt%7D%7D%2B0%5Ctimes+R_%7B%5Csmall%7B%5Cmbox%7BOP%7Dt%7D%7D%2B0%5Ctimes+R_%7B%5Csmall%7B%5Cmbox%7BINV%7Dt%7D%7D%5C%5C+%26%3D%26R_%7Bzt%7D+%5Cend%7Barray%7D&quot; alt=&quot;\begin{array}{rll} R_X&amp;amp;=&amp;amp;R_{zt}+0\times R_{\small{\mbox{MC}t}}+0\times R_{\small{\mbox{BM}t}}+0\times R_{\small{\mbox{OP}t}}+0\times R_{\small{\mbox{INV}t}}\\ &amp;amp;=&amp;amp;R_{zt} \end{array}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=R_%7Bzt%7D%3DR_X&quot; alt=&quot;R_{zt}=R_X&quot; eeimg=&quot;1&quot;/&gt;  意味着 &lt;img src=&quot;https://www.zhihu.com/equation?tex=R_%7Bzt%7D&quot; alt=&quot;R_{zt}&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 正是这 18 个投资组合收益率的均值&lt;/b&gt;；这就是  &lt;img src=&quot;https://www.zhihu.com/equation?tex=R_%7Bzt%7D&quot; alt=&quot;R_{zt}&quot; eeimg=&quot;1&quot;/&gt;  的含义。熟悉 Barra 模型的小伙伴也不妨回想一下， &lt;img src=&quot;https://www.zhihu.com/equation?tex=R_%7Bzt%7D&quot; alt=&quot;R_{zt}&quot; eeimg=&quot;1&quot;/&gt; 的作用和 CNE5 中的国家因子是一样的。由于在 Barra 模型中风格因子用市值权重来做的标准化，因此 CNE5 中的国家因子代表了市值加权的个股收益率，也就正好是市场因子。这里的  &lt;img src=&quot;https://www.zhihu.com/equation?tex=R_%7Bzt%7D&quot; alt=&quot;R_{zt}&quot; eeimg=&quot;1&quot;/&gt;  和 CNE5 中的国家因子有异曲同工之妙。&lt;/p&gt;&lt;p&gt;之所以花费了如此多的笔墨解释  &lt;img src=&quot;https://www.zhihu.com/equation?tex=R_%7Bzt%7D&quot; alt=&quot;R_{zt}&quot; eeimg=&quot;1&quot;/&gt; ，是因为在上述 CS 定价模型中，四因子解释的是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=R_%7Bit%7D&quot; alt=&quot;R_{it}&quot; eeimg=&quot;1&quot;/&gt; 相对  &lt;img src=&quot;https://www.zhihu.com/equation?tex=R_%7Bzt%7D&quot; alt=&quot;R_{zt}&quot; eeimg=&quot;1&quot;/&gt;  的超额收益（即  &lt;img src=&quot;https://www.zhihu.com/equation?tex=R_%7Bit%7D-R_%7Bzt%7D&quot; alt=&quot;R_{it}-R_{zt}&quot; eeimg=&quot;1&quot;/&gt; ）的截面差异。因此，从业务上搞清楚 &lt;img src=&quot;https://www.zhihu.com/equation?tex=R_%7Bzt%7D&quot; alt=&quot;R_{zt}&quot; eeimg=&quot;1&quot;/&gt; 的含义至关重要。&lt;/p&gt;&lt;p&gt;OK，so far so good?&lt;/p&gt;&lt;p&gt;Fama and French (2019) 在上述 CS 定价模型的基础上又提出了第二个 CS 模型（记为 CS 模型二）：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=R_%7Bit%7D-R_%7Bft%7D%3Da_i%2Bb_%7B1i%7D%28R_%7Bmt%7D-R_%7Bft%7D%29%2Bb_%7B2i%7DR_%7B%5Csmall%7B%5Cmbox%7BMC%7Dt%7D%7D%2Bb_%7B3i%7DR_%7B%5Csmall%7B%5Cmbox%7BBM%7Dt%7D%7D%2Bb_%7B4i%7DR_%7B%5Csmall%7B%5Cmbox%7BOP%7Dt%7D%7D%2Bb_%7B5i%7DR_%7B%5Csmall%7B%5Cmbox%7BINV%7Dt%7D%7D%2Be_%7Bit%7D&quot; alt=&quot;R_{it}-R_{ft}=a_i+b_{1i}(R_{mt}-R_{ft})+b_{2i}R_{\small{\mbox{MC}t}}+b_{3i}R_{\small{\mbox{BM}t}}+b_{4i}R_{\small{\mbox{OP}t}}+b_{5i}R_{\small{\mbox{INV}t}}+e_{it}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;相比前者，这个版本的 CS 模型就非常好理解了。它实际上是用了时序回归 + CS 因子。在这个模型中，作为因子的仍然是通过 FM regression 得到的 &lt;img src=&quot;https://www.zhihu.com/equation?tex=R_%7B%5Csmall%5Cmbox%7BMC%7Dt%7D&quot; alt=&quot;R_{\small\mbox{MC}t}&quot; eeimg=&quot;1&quot;/&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=R_%7B%5Csmall%5Cmbox%7BBM%7Dt%7D&quot; alt=&quot;R_{\small\mbox{BM}t}&quot; eeimg=&quot;1&quot;/&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=R_%7B%5Csmall%5Cmbox%7BOP%7Dt%7D&quot; alt=&quot;R_{\small\mbox{OP}t}&quot; eeimg=&quot;1&quot;/&gt; 、 &lt;img src=&quot;https://www.zhihu.com/equation?tex=R_%7B%5Csmall%5Cmbox%7BINV%7Dt%7D&quot; alt=&quot;R_{\small\mbox{INV}t}&quot; eeimg=&quot;1&quot;/&gt; ；除此之外还加入了 &lt;img src=&quot;https://www.zhihu.com/equation?tex=R_%7Bmt%7D+%E2%80%93+R_%7Bft%7D&quot; alt=&quot;R_{mt} – R_{ft}&quot; eeimg=&quot;1&quot;/&gt; 这个市场因子，因此&lt;b&gt;该模型是一个五因子模型&lt;/b&gt;。它解释的也是  &lt;img src=&quot;https://www.zhihu.com/equation?tex=R_%7Bit%7D&quot; alt=&quot;R_{it}&quot; eeimg=&quot;1&quot;/&gt;  相对 &lt;img src=&quot;https://www.zhihu.com/equation?tex=R_%7Bft%7D&quot; alt=&quot;R_{ft}&quot; eeimg=&quot;1&quot;/&gt; 的超额收益 —— &lt;b&gt;在这个模型中没有 &lt;/b&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=R_%7Bzt%7D&quot; alt=&quot;R_{zt}&quot; eeimg=&quot;1&quot;/&gt;&lt;b&gt; 什么事儿！&lt;/b&gt;最重要的是，这个模型也是通过时序回归求出上述五个因子的 factor loadings。&lt;/p&gt;&lt;p&gt;从上面的描述不难看出，&lt;b&gt;第二个 CS 模型直接对标了 FF5&lt;/b&gt;。这二者唯一的区别就是在四个风格因子的构建上：FF5 使用 18 个 2 × 3 double sort 的投资组合构建；而在 CS 模型二中，使用 FM regression 求解纯因子模型来构建。&lt;/p&gt;&lt;p&gt;作为回顾，下表总结了这三个不同的定价模型：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-abe9b2d61bddae422a67654b20cc664c_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;948&quot; data-rawheight=&quot;303&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;948&quot; data-original=&quot;https://pic1.zhimg.com/v2-abe9b2d61bddae422a67654b20cc664c_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-abe9b2d61bddae422a67654b20cc664c_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;948&quot; data-rawheight=&quot;303&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;948&quot; data-original=&quot;https://pic1.zhimg.com/v2-abe9b2d61bddae422a67654b20cc664c_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-abe9b2d61bddae422a67654b20cc664c_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;h2&gt;&lt;b&gt;04 CS 因子做定价模型？&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;看到这里，有的小伙伴也许会困惑：FF5 和 CS 模型二非常好理解，它们只是 factor returns 的差异，从定价模型的角度来说，以这些 factor returns 作为解释变量，只需要对每个 LHS 资产单独进行时序回归就能得到其无法被模型解释的超额收益（时序回归中的截距 &lt;img src=&quot;https://www.zhihu.com/equation?tex=a_i&quot; alt=&quot;a_i&quot; eeimg=&quot;1&quot;/&gt; ）。&lt;/p&gt;&lt;p&gt;而 CS 模型一则有所不同，它的 factor loadings 是 firm characteristics，它只不过是把不同的截面回归跨时间堆叠在一起使它看起来像一个定价模型。&lt;b&gt;但它从始至终都不进行时序回归，如何获得 pricing error 呢？&lt;/b&gt;&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;It is important to be clear about how model (2) is applied in the asset pricing tests of panels B5 and B6 of Table 3.&lt;/i&gt; &lt;i&gt;&lt;b&gt;Panels B5 and B6 do not test model (2) with time-series regressions.&lt;/b&gt;&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;上面这段话出自 Fama and French (2019)，其中 model (2) 就是本文的 CS 模型一。为了使用该模型进行 asset pricing 并求出 pricing error，Fama and French (2019) 采用了如下两步：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;第一步：&lt;/b&gt;每一期，通过（*）式的截面回归得到四个因子的收益率和截距项 R_zt；&lt;/li&gt;&lt;li&gt;&lt;b&gt;第二步：&lt;/b&gt;对于某给定资产（强调！这里的资产是定价模型的 LHS，而非 FM regression 的 LHS，因此&lt;b&gt;这里的资产并不是用来计算 CS 因子的 18 个投资组合！&lt;/b&gt;），计算其四个 firm characteristics，然后使用第一步回归得到的四个因子的收益率以及 R_zt 计算出该资产 t 期的预期收益率；该预期收益率与真实收益率之差就是该资产在 t 时刻的 pricing error。&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;按照上述两步就可以得到每个资产每期的 pricing error；将它们在时序上平均就得到该资产在 CS 模型一下的平均 pricing error。&lt;/p&gt;&lt;p&gt;为了比较这三个定价模型，需要使用足够多有代表性的资产放在因子模型的 LHS。Lewellen, Nagel, and Shanken (2010) 指出应使用足够多的投资组合作为 LHS 以避免这些 LHS 资产有非常强的 factor structure、造成检验失效；而 Jegadeesh et al. (2019) 更是倡导使用个股作为 LHS 检验定价模型。&lt;/p&gt;&lt;p&gt;在 Fama and French (2019) 中，二位作者（自然）没有使用个股作为 LHS，但是使用了多达 210 个投资组合。构建这些投资组合背后的指标即来自构建因子的指标，也来自学术界常见的异象。比如，对于 BM、OP、INV 这些指标，他们分别使用市值和这些指标进行 5 × 5 double sort 构建了 25 个组合（因此 3 个指标一共有 75 个组合），此外 Fama and French (2019) 还考虑了动量指标，也构建了 25 个组合。在异象方面，他们考虑了诸如 Black, Jensen, and Scholes (1972) 的 market β 和 Ang et al. (2006) 的低波动异象，构建了一共 110 个组合。&lt;/p&gt;&lt;p&gt;关于这些 LHS 组合的具体描述，请参考 Fama and French (2019)，下面来看实证结果。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;05 实证结果&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;为对比不同的 TS 和 CS 定价模型，Fama and French (2019) 使用了大量的实证并进行了充分的稳健性检验。此外，在评价模型时，他们采用了不同的 metrics，如 Gibbons, Ross, and Shanken (1989) test statistic 以及 pricing error 绝对值均值等。本小节仅以 Fama and French (2019) 的 Table 3 为例介绍实证结果。&lt;/p&gt;&lt;p&gt;首先来看 Table 3 的 Panel A。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-10ca485d0fdbde189541624814c5769a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;433&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-10ca485d0fdbde189541624814c5769a_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-10ca485d0fdbde189541624814c5769a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;433&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-10ca485d0fdbde189541624814c5769a_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-10ca485d0fdbde189541624814c5769a_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;虽然仅仅是 Panel A，但它又细分为 A1 到 A4，包含的信息量非常大。我把最关键的用红框标出来了。这里，我们只需要关注 Panels A1 和 A2（因为 A3 和 A4 是关于那个带交叉项的模型，本文并不涉及）。Panels A1 和 A2 的区别只是在于 LHS 投资组合的数量差异，除此之外它们均是比较了 Fama and French (2019) 中的模型（3）和模型（4），分别对应本文中的 TS 模型（FF5）和 CS 模型二（对标 FF5 的那个）。&lt;/p&gt;&lt;p&gt;另外值得一提的是，在 FF5 的基础上，Fama and French (2019) 也考虑了 UMD 动量因子。当加入动量因子后，其 TS 模型便加入了 UMD 因子，而 CS 模型就加入了 &lt;img src=&quot;https://www.zhihu.com/equation?tex=R_%7B%5Csmall%5Cmbox%7BMOM%7D%7D&quot; alt=&quot;R_{\small\mbox{MOM}}&quot; eeimg=&quot;1&quot;/&gt; 因子。&lt;/p&gt;&lt;p&gt;上表中，红框标出来的 metric（A|α|）是给定定价模型下，所有 LHS 资产的 pricing errors 绝对值的均值。&lt;b&gt;这个值越接近零说明定价模型越出色。&lt;/b&gt;从结果不难看出，无论是五因子还是加入了 UMD 和 R_MOM 的六因子模型，无论是考虑 185 个还是 210 个 LHS 资产，&lt;b&gt;CS 模型二均优于其对应的 TS 模型。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;接下来再看看 Panel B。相比于 Panel A 对比了 TS 模型和 CS 模型二，Panel B 仅仅关注 CS 模型一，但它巨大的信息量却更令人“懵逼”。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-59b3c188c37dcfa37d02a1e0f0199316_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;450&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-59b3c188c37dcfa37d02a1e0f0199316_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-59b3c188c37dcfa37d02a1e0f0199316_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;450&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-59b3c188c37dcfa37d02a1e0f0199316_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-59b3c188c37dcfa37d02a1e0f0199316_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;为了解释它，我不得不先回顾一下 CS 模型一：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=R_%7Bit%7D-R_%7Bzt%7D%3D%5Cmbox%7BMC%7D_%7Bit-1%7DR_%7B%5Csmall%7B%5Cmbox%7BMC%7Dt%7D%7D%2B%5Cmbox%7BBM%7D_%7Bit-1%7DR_%7B%5Csmall%7B%5Cmbox%7BBM%7Dt%7D%7D%2B%5Cmbox%7BOP%7D_%7Bit-1%7DR_%7B%5Csmall%7B%5Cmbox%7BOP%7Dt%7D%7D%2B%5Cmbox%7BINV%7D_%7Bit-1%7DR_%7B%5Csmall%7B%5Cmbox%7BINV%7Dt%7D%7D%2Be_%7Bit%7D&quot; alt=&quot;R_{it}-R_{zt}=\mbox{MC}_{it-1}R_{\small{\mbox{MC}t}}+\mbox{BM}_{it-1}R_{\small{\mbox{BM}t}}+\mbox{OP}_{it-1}R_{\small{\mbox{OP}t}}+\mbox{INV}_{it-1}R_{\small{\mbox{INV}t}}+e_{it}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;首先，这个模型解释的是 &lt;img src=&quot;https://www.zhihu.com/equation?tex=R_%7Bit%7D&quot; alt=&quot;R_{it}&quot; eeimg=&quot;1&quot;/&gt; 相对 &lt;img src=&quot;https://www.zhihu.com/equation?tex=R_%7Bzt%7D&quot; alt=&quot;R_{zt}&quot; eeimg=&quot;1&quot;/&gt; 而非 &lt;img src=&quot;https://www.zhihu.com/equation?tex=R_%7Bft%7D&quot; alt=&quot;R_{ft}&quot; eeimg=&quot;1&quot;/&gt; 的超额收益；其次，该模型中作为 factor loadings 的是 firm characteristics，而且它们是时变的，而非常数。记住了这两条，就可以来看 Panel B 了：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;其中 Panels B5 和 B6 正是这个 CS 模型一的结果&lt;/b&gt;（注意表中横线标出的部分：factor loadings are time-varying characteristics）；因此，&lt;b&gt;只有这两个 panels 的结果才能和 Panel A 中的 TS 模型和 CS 模型二进行 apple-to-apple 的比较。&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;Panels B3 和 B4 可以算是 CS 模型一的对照组&lt;/b&gt;，它们和该模型的区别是 factor loadings 是 firm characteristics 在整个时序上的平均值，因此对于每个 CS 因子，其 factor loading 是一个常数（factor loadings are average characteristics）。&lt;/li&gt;&lt;li&gt;&lt;b&gt;最后，Panels B1 和 B2 就是打酱油的（哦，不不不，它们也是对照组）&lt;/b&gt;；它们的 factor loadings 和 firm characteristics 没有任何关系，而是使用 &lt;img src=&quot;https://www.zhihu.com/equation?tex=R_%7Bit%7D+%E2%80%93+R_%7Bzt%7D&quot; alt=&quot;R_{it} – R_{zt}&quot; eeimg=&quot;1&quot;/&gt; 和 CS 因子收益率进行时序回归得到的（类似 TS 模型的处理；factor loadings are constant regression slopes）。&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;有了上述说明就可以来看结果了。上表显示，无论采用哪些 LHS 资产来评价不同模型，我们都可以观察到这样的结果：&lt;b&gt;Panels B5/6 优于 Panels B3/4 优于 Panels B1/2&lt;/b&gt;。进一步的，比较 Panels B5/6 和 Panel A 中的 TS 和 CS 模型二可知，&lt;b&gt;CS 模型一的效果是最好的&lt;/b&gt;。比如，当采用 185 个 LHS 资产时，这三个模型的平均定价错误绝对值为：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-ddf7120d0521a46c23c01b1b5b8d2b62_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;649&quot; data-rawheight=&quot;196&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;649&quot; data-original=&quot;https://pic3.zhimg.com/v2-ddf7120d0521a46c23c01b1b5b8d2b62_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-ddf7120d0521a46c23c01b1b5b8d2b62_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;649&quot; data-rawheight=&quot;196&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;649&quot; data-original=&quot;https://pic3.zhimg.com/v2-ddf7120d0521a46c23c01b1b5b8d2b62_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-ddf7120d0521a46c23c01b1b5b8d2b62_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;从以上各种对比的结果中可以得到 Fama and French (2019) 一文的&lt;b&gt;核心结论&lt;/b&gt;：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;b&gt;以 FM regression 得到的 CS 因子作为解释变量的 CS 定价模型优于传统的 FF5，即 TS 定价模型（两个 CS 模型均优于 TS 模型）。&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;当使用 CS 因子时，对应的 factor loadings 应采用 firm characteristics，而非像 Panels B1/2 中的时序回归。&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;当使用 firm characteristics 作为 CS 模型的 factor loadings 时，时变 loadings 的效果好于恒定 loadings 的效果（Panels B5/6 优于 Panels B3/4），但这种差异并不明显；CS 模型之所以优秀源于通过 FM regression 得到的 CS 因子 factor returns（那些纯因子组合的收益率）。&lt;/b&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;最后用 Fama and French (2019) 原文对上述结论做一个总结：&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;We close by addressing a central question: What explains the dominance of model (2)? All the models we consider target cross-section variation in average returns related to the same size, value, profitability, investment, and momentum characteristics. And the CS factors of model (2) are constructed from returns on the same 2 × 3 MC-BM, MC-OP, MC-INV, and MC-MOM portfolios that produce the TS factors of model (3).&lt;/i&gt; &lt;i&gt;&lt;b&gt;The way these returns are related to produce the TS factors is, however, arbitrary. In contrast, monthly cross-section FM OLS regressions combine returns and characteristics on the 2 × 3 portfolios to produce CS factors that&lt;/b&gt;&lt;/i&gt; &lt;i&gt;&lt;b&gt;optimize&lt;/b&gt;&lt;/i&gt; &lt;i&gt;&lt;b&gt;the month-by-month description of returns on these portfolios.&lt;/b&gt;&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;一句话概括：&lt;b&gt;截面回归得到的纯因子组合的 factor returns 比各种 double sort 得到的 factor returns 能够更好的解释资产的截面差异。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;Barra 大概要笑出声了。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;06 结语&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;Fama and French (2019) 是一篇典型的 Eugene Fama 的文章，它把 empirical analysis 做到了极致并得出了非常清晰的结论。&lt;/p&gt;&lt;p&gt;不过，我最初精读完它的 working paper 版本的时候感受也是懵逼的，因为它的信息量太大，而且在各种模型之间切换，给人一种脑容量不够的感觉。而后来得知这篇文章被 RFS 接受后也是懵逼的。我想大概只有 FF 写这么一篇文章才能被顶刊接受吧。它实在是太 empirical 了，最终的结论 —— 虽然异常清晰 —— 也仅仅是建立在 empirical results 之上的。&lt;/p&gt;&lt;p&gt;当然，不管怎样，该文回答了无论是学术界还是业界都非常关心的问题，即到底应该用什么作为 factor returns 以及用什么作为 factor loadings。从 Fama and French (2019) 的研究结果来看，CS 纯因子组合或大有可为。也许在不久的将来，我们就能看到用 CS 因子来构建的因子模型来 PK 掉所有靠各种 sort 获得的 TS 因子模型了（学术界主流 TS 因子模型见 Hou et al. 2019）。&lt;/p&gt;&lt;p&gt;So, which beta? 我们也许已经有了答案。&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;参考文献&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Ang, A., R. J. Hodrick, Y. Xing, and X. Zhang (2006). The cross-section of volatility and expected returns. &lt;i&gt;The Journal of Finance&lt;/i&gt;, Vol. 61(1), 259 – 299.&lt;/li&gt;&lt;li&gt;Black, F., M. C. Jensen, and M. Scholes (1972). The Capital Asset Pricing Model: Some Empirical Tests. In &lt;i&gt;Studies in the Theory of Capital Markets&lt;/i&gt;. M. C. Jensen (ed), New York: Praeger, 79 – 121.&lt;/li&gt;&lt;li&gt;Fama, E. F. and K. R. French (2015). A Five-Factor Asset Pricing Model. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 116(1), 1 – 22.&lt;/li&gt;&lt;li&gt;Fama, E. F. and K. R. French (2019). Comparing cross-section and time-series factor models. &lt;i&gt;The Review of Financial Studies&lt;/i&gt;, forthcoming.&lt;/li&gt;&lt;li&gt;Fama, E. F. and J. D. MacBeth (1973). Risk, Return, and Equilibrium: Empirical Tests. &lt;i&gt;The Journal of Political Economy&lt;/i&gt;, Vol. 81(3), 607 – 636.&lt;/li&gt;&lt;li&gt;Gibbons, M. R., S. A. Ross, and J. Shanken (1989). A test of the efficiency of a given portfolio. &lt;i&gt;Econometrica&lt;/i&gt;, Vol. 57(5), 1121 – 1152.&lt;/li&gt;&lt;li&gt;Hou, K., H. Mo, C. Xue, and L. Zhang (2019). Which factors? &lt;i&gt;Review of Finance&lt;/i&gt;, Vol. 23(1), 1 – 35.&lt;/li&gt;&lt;li&gt;Jegadeesh, N., J. Noh, K. Pukthuanthong, R. Roll, and J. Wang (2019). Empirical tests of asset pricing models with individual assets: Resolving the errors-in-variables bias in risk premium estimation. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 133(2), 273 – 298.&lt;/li&gt;&lt;li&gt;Lewellen, J., S. Nagel, and J. Shanken (2010). A skeptical appraisal of asset pricing tests.&lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 96(2), 175 – 194.&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;免责声明：&lt;/b&gt;文章内容不可视为投资意见。市场有风险，入市需谨慎。&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处。已委托“维权骑士”(&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//rightknights.com&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;维权骑士_免费版权监测/版权保护/内容多平台分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2019-09-27-84462587</guid>
<pubDate>Fri, 27 Sep 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>Calendar Anomalies：糖衣下的 Multiple Testing?</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2019-09-20-83321444.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/83321444&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-1fc08f773c670879c7489e25fde10bc7_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;摘要&lt;/b&gt;&lt;/p&gt;&lt;p&gt;以特定日期作为条件来划分收益率并检验不同划分下的显著性是一种多重检验。在修正之后，很多所谓的日历异象都不再显著。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;01 引言&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;Calendar Anomalies（日历异象）&lt;/b&gt;指的是资产在一年中的某些特定的日子内有显著非零的条件预期收益率。这其中最大名鼎鼎的当属股票市场中的换月效应（turn of month effect）：股票市场在每月的最后 1 个交易日到下一个月的第 3 个交易日这个窗口内的收益率显著高于一个月中的其他交易日。&lt;/p&gt;&lt;p&gt;McConnell and Xu (2008) 的研究发现，在 1926 到 2005 间，在换月窗口内买入标普 500 指数的 ETF 可获得得年化 7.20% 的收益率（夏普率高达 1.04）。Carchano and Pardo Tornero (2011) 更是以标普 500 指数、德国法兰克福指数和日经指数为研究对象，分析了 188 种日历异象，并发现在统计上和经济上同时显著的只有换月效应。&lt;/p&gt;&lt;p&gt;除了市场指数外，学术界也以各种风格因子投资组合为标的研究各种 calendar anomalies。在最近一篇刊发于 JPM 的文章中，Aharon and Qadan (2019) 提出虽然 size effect 在全样本中效果越来越弱，但它依然显著的存活于某些特定的日期内，构成 calendar anomalies。&lt;/p&gt;&lt;p&gt;真的是这样么？&lt;/p&gt;&lt;p&gt;&lt;b&gt;以特定日期作为条件来划分收益率并检验不同划分下的显著性（相当于同时检验多个 hypotheses），这其实属于 multiple testing（多重检验）。&lt;/b&gt;在大量不同的划分下，仅仅因为运气就总会有一些是非常显著的、被人们冠以 calendar anomalies 之名。&lt;/p&gt;&lt;p&gt;只有对 multiple testing 的影响进行必要的修正，才能公正的评判某种特定日期的划分是否真的得到显著的收益率异象。这就是本文要探讨的内容。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;02 日历异象？&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;来看一个例子。以中证 500 指数成分股为标的，使用某个常见的风格因子将它们排序，取首尾 10% 构建多、空对冲投资组合作为该因子的投资组合。&lt;/p&gt;&lt;p&gt;下图显示了实证期内中证 500 指数（蓝线）和该风格因子组合（黄线）的走势。从黄线可以看出，它无法获得显著的超额收益。事实上，其日收益率均值的 t-statistic 仅有 1.17，对应的 p-value 高达 0.24。在全样本来看，这个因子是不显著的。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-fe0f8d4ce8874a61e497fbca32b0438e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;852&quot; data-rawheight=&quot;466&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;852&quot; data-original=&quot;https://pic3.zhimg.com/v2-fe0f8d4ce8874a61e497fbca32b0438e_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-fe0f8d4ce8874a61e497fbca32b0438e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;852&quot; data-rawheight=&quot;466&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;852&quot; data-original=&quot;https://pic3.zhimg.com/v2-fe0f8d4ce8874a61e497fbca32b0438e_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-fe0f8d4ce8874a61e497fbca32b0438e_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;接着，考虑几种常见的日历现象：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;换月（turn of month）；&lt;/li&gt;&lt;li&gt;月份效应（calendar month）；&lt;/li&gt;&lt;li&gt;“星期几”效应（day of week）。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;当我们在时间上进行各种划分后，神奇的事情发生了。这个全样本内不显著的因子，在某些特定的划分中出现了显著的 calendar anomalies，它们包括三月效应、五月效应、十一月效应、十二月效应以及星期二效应。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-a2afd9486d1fa0a9b0169319ff9c2f86_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;650&quot; data-rawheight=&quot;717&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;650&quot; data-original=&quot;https://pic3.zhimg.com/v2-a2afd9486d1fa0a9b0169319ff9c2f86_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-a2afd9486d1fa0a9b0169319ff9c2f86_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;650&quot; data-rawheight=&quot;717&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;650&quot; data-original=&quot;https://pic3.zhimg.com/v2-a2afd9486d1fa0a9b0169319ff9c2f86_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-a2afd9486d1fa0a9b0169319ff9c2f86_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;上述五个潜在 calendar anomalies 的 p-values 均在 0.05 以下。但不要忘了，以上实际同时检验了 18 个假设 —— 1 个换月效应 + 12 个月份效应 + 5 个“星期几”效应。在这种背景下，即便有些假设的 p-value 是非常小的，也不应该立刻得出拒绝某个原假设的结论，而是应该针对 multiple testing 进行修正，以修正后的 p-value 作为判断依据。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;03 Multiple Testing 修正&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;前文&lt;a href=&quot;https://zhuanlan.zhihu.com/p/45715632&quot; class=&quot;internal&quot;&gt;《出色不如走运 II?》&lt;/a&gt;曾介绍过 Bonferroni、Holm、BHY 这三种 multiple testing 修正方法。本小节简单回顾一下，在本文第四节的分析中将采用 BHY 修正。&lt;/p&gt;&lt;p&gt;在实施了 multiple testing 后应控制 &lt;b&gt;family-wise error rate（FWER，族错误率）&lt;/b&gt;和 &lt;b&gt;false discovery rate（FDR）&lt;/b&gt;两个指标。它们均代表着 Type I error，即错误的拒绝原假设。如果我们有 K 个 hypotheses（&lt;b&gt;对应前文中的多个 calendar anomalies&lt;/b&gt;），它们的 p-value 分别为  &lt;img src=&quot;https://www.zhihu.com/equation?tex=p_1%2C+p_2%2C+%E2%80%A6%2Cp_K&quot; alt=&quot;p_1, p_2, …,p_K&quot; eeimg=&quot;1&quot;/&gt; 。根据事先选定的显著性水平（比如 5%），其中 R 个 hypotheses 被拒绝了，即有 R 个发现（discoveries） —— 包括 true discoveries 和 false discoveries。令 &lt;img src=&quot;https://www.zhihu.com/equation?tex=N_r+%E2%89%A4+R&quot; alt=&quot;N_r ≤ R&quot; eeimg=&quot;1&quot;/&gt; 代表 false discoveries 的个数，则 FWER 和 FDR 的定义分别为：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+%5Cmbox%7BFWER%7D%26%3D%26%5Cmbox%7Bprob%7D%28N_r%5Cge+1%29%5C%5C+%5Cmbox%7BFDR%7D%26%3D%26%5Cmbox%7BE%7D%5BN_r%2FR%5D+%5Cend%7Barray%7D&quot; alt=&quot;\begin{array}{rll} \mbox{FWER}&amp;amp;=&amp;amp;\mbox{prob}(N_r\ge 1)\\ \mbox{FDR}&amp;amp;=&amp;amp;\mbox{E}[N_r/R] \end{array}&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;由定义可知，FWER 是至少出现一个 false discovery 的概率，控制它对单个 hypothesis 来说是相当严格的，会大大提升 Type II Error。相比之下，FDR 允许  &lt;img src=&quot;https://www.zhihu.com/equation?tex=N_r&quot; alt=&quot;N_r&quot; eeimg=&quot;1&quot;/&gt;  随 R 增加，因此控制的是 false discoveries 的比例，是一种相对温和的方法。&lt;b&gt;无论采用哪种方法，在针对多重检验的修正下，都会有相当一部分的 discoveries 不再显著（即不能拒绝原假设）。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;依据控制 FWER 或 FDR，本文谈及的三种修正方法可以分为两类：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Bonferroni correction 和 Holm adjustment 的目的是控制 family-wise error rate；&lt;/li&gt;&lt;li&gt;BHY adjustment 的目的是控制 false discovery rate。&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;这三种方法均能修正原始假设的 p-value，从而惩罚多重检验的影响。修正后的 p-value 往往会大于原始的 p-value，也就意味着修正后的 t-statistic&lt;/b&gt; &lt;b&gt;更小。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;接下来通过一个例子说明这些方法的差异。考虑六个假设，它们的 p-values 从小到大依次是 0.005、0.009、0.0128、0.0135、0.045、0.06。在单一假设检验下，前五个可以在 5% 的显著性水平下被拒绝。但由于我们实际上同时进行了六个假设检验，因此必须对上述 p-values 进行修正。&lt;/p&gt;&lt;p&gt;首先来看 Bonferroni correction，它对原始 p-value 的调整如下：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+p_i%5E%7B%5Cmbox%7BBonferroni%7D%7D%3D%5Cmin%5C%7BKp_i%2C1%5C%7D%2C~~i%3D1%2C%5Ccdots%2CK&quot; alt=&quot;\displaystyle p_i^{\mbox{Bonferroni}}=\min\{Kp_i,1\},~~i=1,\cdots,K&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;修正后的 Bonferroni p-value 分别为 0.03、0.054、0.0768、0.081、0.27 和 0.36；在 5% 的显著性水平下，我们仅能拒绝第一个假设。&lt;/p&gt;&lt;p&gt;接下来看看 Holm (1979) 修正。它按照原始 p-value 从小到大依次修正，公式为：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cdisplaystyle+p_i%5E%7B%5Cmbox%7BHolm%7D%7D%3D%5Cmin%5Cleft%5C%7B%5Cmax_%7Bj%5Cle+i%7D%5C%7B%28K-j%2B1%29p_j%5C%7D%2C1%5Cright%5C%7D%2C~~i%3D1%2C%5Ccdots%2CK&quot; alt=&quot;\displaystyle p_i^{\mbox{Holm}}=\min\left\{\max_{j\le i}\{(K-j+1)p_j\},1\right\},~~i=1,\cdots,K&quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;根据上述定义，最小的 p-value 被修正后，其 Holm p-value 为 0.06；第二个假设的 Holm p-value 为  &lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cmax%5C%7B6+%C3%97+0.005%2C+5+%C3%97+0.009%5C%7D+%3D+0.045&quot; alt=&quot;\max\{6 × 0.005, 5 × 0.009\} = 0.045&quot; eeimg=&quot;1&quot;/&gt; 。以此类推就能计算出其他四个假设的 Holm p-values。经过 Holm 修正后，在 5% 的显著性水平下，我们仅能拒绝前两个假设。&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+p_3%5E%7B%5Cmbox%7BHolm%7D%7D%26%3D%26%5Cmax%5C%7B6p_1%2C5p_2%2C4p_3%5C%7D%3D4p_3%3D0.0512%5C%5C+p_4%5E%7B%5Cmbox%7BHolm%7D%7D%26%3D%26%5Cmax%5C%7B6p_1%2C5p_2%2C4p_3%2C3p_4%5C%7D%3D4p_3%3D0.0512%5C%5C+p_5%5E%7B%5Cmbox%7BHolm%7D%7D%26%3D%26%5Cmax%5C%7B6p_1%2C5p_2%2C4p_3%2C3p_4%2C2p_5%5C%7D%3D2p_5%3D0.09%5C%5C+p_6%5E%7B%5Cmbox%7BHolm%7D%7D%26%3D%26%5Cmax%5C%7B6p_1%2C5p_2%2C4p_3%2C3p_4%2C2p_5%2Cp_6%5C%7D%3D2p_5%3D0.09+%5Cend%7Barray%7D+&quot; alt=&quot;\begin{array}{rll} p_3^{\mbox{Holm}}&amp;amp;=&amp;amp;\max\{6p_1,5p_2,4p_3\}=4p_3=0.0512\\ p_4^{\mbox{Holm}}&amp;amp;=&amp;amp;\max\{6p_1,5p_2,4p_3,3p_4\}=4p_3=0.0512\\ p_5^{\mbox{Holm}}&amp;amp;=&amp;amp;\max\{6p_1,5p_2,4p_3,3p_4,2p_5\}=2p_5=0.09\\ p_6^{\mbox{Holm}}&amp;amp;=&amp;amp;\max\{6p_1,5p_2,4p_3,3p_4,2p_5,p_6\}=2p_5=0.09 \end{array} &quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;最后来看看 BHY 修正（Benjamini and Hochberg 1995, Benjamini and Yekutieli 2001）。它从原始 p-value 中最大的一个开始逆向修正：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+%26%26p_i%5E%7B%5Cmbox%7BBHY%7D%7D%3D%5Cleft%5C%7B+%5Cbegin%7Barray%7D%7Blll%7D+p_K%26%5Cmbox%7Bif%7D%26i%3DK%5C%5C%5C%5C+%5Cmin%5Cleft%5C%7Bp_%7Bi%2B1%7D%5E%7B%5Cmbox%7BBHY%7D%7D%2C%5Cdisplaystyle%5Cfrac%7BK%5Ctimes+c%28K%29%7D%7Bi%7Dp_i%5Cright%5C%7D%26%5Cmbox%7Bif%7D%26i%5Cle+K-1+%5Cend%7Barray%7D+%5Cright.%5C%5C+%26%5Cmbox%7Bwhere%7D%26%5Cdisplaystyle+c%28K%29%3D%5Csum_%7Bj%3D1%7D%5EK%5Cfrac%7B1%7D%7Bj%7D+%5Cend%7Barray%7D+&quot; alt=&quot;\begin{array}{rll} &amp;amp;&amp;amp;p_i^{\mbox{BHY}}=\left\{ \begin{array}{lll} p_K&amp;amp;\mbox{if}&amp;amp;i=K\\\\ \min\left\{p_{i+1}^{\mbox{BHY}},\displaystyle\frac{K\times c(K)}{i}p_i\right\}&amp;amp;\mbox{if}&amp;amp;i\le K-1 \end{array} \right.\\ &amp;amp;\mbox{where}&amp;amp;\displaystyle c(K)=\sum_{j=1}^K\frac{1}{j} \end{array} &quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;由定义可知原始最大的 p-value 在调整后保持不变。然后从第二大的开始，依次按照上述公式计算，最终得到调整后的 BHY p-values，它们是（从小到大排列）：0.0496、0.0496、0.0496、0.0496、0.06、0.06。在 5% 的显著性水平下，我们依然可以拒绝前四个假设。&lt;/p&gt;&lt;p&gt;再次强调的是，&lt;b&gt;BHY 方法是以控制 false discovery rate 为目标，它的修正比另外两种以控制 family-wise error rate 的方法更加温和。因此，当使用 BHY 调整时，会有更多的原假设被拒绝。&lt;/b&gt;此外，BHY 对检验统计量之间的相关性不敏感，因此适应性更强。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;04 消失的日历异象&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;下面使用 BHY 方法对本文第二节的 p-values 进行修正。考虑不同的 multiple tests 个数，BHY 调整后的 p-values 如下表所示。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-0ef42177363865dbfa9c384a5ef96bc4_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;840&quot; data-rawheight=&quot;676&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;840&quot; data-original=&quot;https://pic1.zhimg.com/v2-0ef42177363865dbfa9c384a5ef96bc4_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-0ef42177363865dbfa9c384a5ef96bc4_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;840&quot; data-rawheight=&quot;676&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;840&quot; data-original=&quot;https://pic1.zhimg.com/v2-0ef42177363865dbfa9c384a5ef96bc4_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-0ef42177363865dbfa9c384a5ef96bc4_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;对于月份效应，如果我们仅考虑这 12 个 tests（而忽略其他额外的 tests），那么修正后的 p-value 中，三月效应和十二月效应依然在 10% 的显著性水平下显著（p-values 分别为 0.0881 和 0.0922），而五月和十二月效应不再显著。类似的，对于“星期几”效应，如果仅考虑这 5 个 tests，修正后的 p-value 全都不再显著。&lt;/p&gt;&lt;p&gt;如果同时考虑全部 18 个 tests，则会对原始 p-values 进行更严格的修正。在这种情况下，以上各种划分 —— 无论是换月、月份还是“星期几”效应 —— 均不再显著，我们无法在 10% 的水平下拒绝任何假设。当排除了 multiple testing 造成的影响后，这个风格因子的收益率不存在任何 calendar anomalies。&lt;/p&gt;&lt;p&gt;BTW，这个全样本中不显著的因子是 Operating Cost TTM。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;05 结语&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;如今，在研究因子时，我们已经熟知 multiple testing 的危害。&lt;b&gt;而将收益率在时间上进行各种划分并同时进行多个检验则是另一种形式的 multiple testing。&lt;/b&gt;在这种背景下，独立判别收益率在某个划分下是否显著并不合理。本文以 Operating Cost TTM 这个常见的质量因子为例说明如未能排除 multiple testing 的影响，它会让我们得出错误的结论。&lt;/p&gt;&lt;p&gt;当我们考虑了足够多的 calendar effects 时，仅仅依靠运气就一定会找到显著的区间。为了杜绝虚假发现，应对显著性进行修正。在 Carchano and Pardo Tornero (2011) 这篇检验了 188 个异象的文章中，作者采用了 bootstrap 的方法，这也是排除运气的一种思路。&lt;/p&gt;&lt;p&gt;从统计上来说，收益率在一月份显著和在某个没有任何特殊意义的连续 30 天内显著并无区别；类似的，收益率在春节后的第一个交易日显著和在一年中的第 137 个交易日显著也没什么不同。但是，在这两个比较中，人们会非常愿意给前者找到“合理”的解释并相信它们是 calendar anomalies。一个 calendar anomaly 是否真实存在并不取决于我们能否找出“合理”的理由或讲出“动听”的故事，而是应基于严谨的统计检验结果。&lt;/p&gt;&lt;p&gt;市场中各种喜闻乐见的 calendar anomalies，是否只是建立在 multiple testing 之上的虚无？&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;参考文献&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Aharon, D. Y. and M. Qadan (2019). The size effect is alive and well, and hiding behind calendar anomalies. &lt;i&gt;The Journal of Portfolio Management&lt;/i&gt;, Vol. 45(6), 61 – 74.&lt;/li&gt;&lt;li&gt;Benjamini, Y. and Y. Hochberg (1995). Controlling the false discovery rate: A practical and powerful approach to multiple testing. &lt;i&gt;Journal of the Royal Statistical Society&lt;/i&gt;, Series B, Vol. 57, 289 – 300.&lt;/li&gt;&lt;li&gt;Benjamini, Y. and D. Yekutieli (2001). The control of the false discovery rate in multiple testing under Dependency. &lt;i&gt;Annals of Statistics&lt;/i&gt;, Vol. 29, 1165 – 1188.&lt;/li&gt;&lt;li&gt;Carchano, O. and A. Pardo Tornero. (2011). Calendar anomalies in stock index futures. Available at SSRN, &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//ssrn.com/abstract%3D1958587&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;ssrn.com/abstract=19585&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;87&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;.&lt;/li&gt;&lt;li&gt;Holm, S. (1979). A simple sequentially rejective multiple test procedure. &lt;i&gt;Scandinavian Journal of Statistics&lt;/i&gt;, Vol. 6, 65 – 70.&lt;/li&gt;&lt;li&gt;McConnell, J. and W. Xu (2008). Equity returns at the turn of the month. &lt;i&gt;Financial Analysts Journal&lt;/i&gt;, Vol. 64(2), 49 – 64.&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;免责声明：&lt;/b&gt;文章内容不可视为投资意见。市场有风险，入市需谨慎。&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处。已委托“维权骑士”(&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//rightknights.com&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;维权骑士_免费版权监测/版权保护/内容多平台分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2019-09-20-83321444</guid>
<pubDate>Fri, 20 Sep 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>q-factor model 往事</title>
<link>https://henix.github.io/feeds/zhuanlan.mitcshi/2019-09-12-82233089.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/82233089&quot;&gt;原文&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-e4bf0ba7e1e52300ae26ec69f0b7f285_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;感谢刀疤连对本文实证数据的大力支持；感谢刀疤连和刘洋溢博士在本文写作中提出的中肯意见。&lt;/p&gt;&lt;p&gt;&lt;b&gt;摘要：&lt;/b&gt;本文试图一撇学术界的一段尘封往事。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;01 Journal of Finance, Vol. 65(2), 563 – 594&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;2009 年底，一篇来自华人教授陈龙和张橹的文章编辑完毕，即将刊发于金融学顶刊 Journal of Finance 2010 年 4 月的第 65 卷、第 2 期（Vol. 65, No. 2）。这篇文章的题目是 A Better Three-Factor Model That Explains More Anomalies，它从 q-theory 理论出发提出了投资和盈利两个因子，加上市场因子构建了一个新的三因子模型，直接对标了 Fama and French (1993) 的三因子模型（下文记为 FF3）。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-7526cfe547bb15e945e308f779508794_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;949&quot; data-rawheight=&quot;640&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;949&quot; data-original=&quot;https://pic1.zhimg.com/v2-7526cfe547bb15e945e308f779508794_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-7526cfe547bb15e945e308f779508794_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;949&quot; data-rawheight=&quot;640&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;949&quot; data-original=&quot;https://pic1.zhimg.com/v2-7526cfe547bb15e945e308f779508794_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-7526cfe547bb15e945e308f779508794_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;遗憾的是，该文最终并没有按计划出现在这期的 Journal of Finance 中。下图是发表于该期杂志的全部文章，我们无法从中找到它的身影。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-8bafb0200a2cb81ad0d1f558c27fc848_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;668&quot; data-rawheight=&quot;805&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;668&quot; data-original=&quot;https://pic1.zhimg.com/v2-8bafb0200a2cb81ad0d1f558c27fc848_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-8bafb0200a2cb81ad0d1f558c27fc848_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;668&quot; data-rawheight=&quot;805&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;668&quot; data-original=&quot;https://pic1.zhimg.com/v2-8bafb0200a2cb81ad0d1f558c27fc848_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-8bafb0200a2cb81ad0d1f558c27fc848_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;这篇文章之所以没有如期刊发，是因为它在最后一刻被撤稿。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;02 撤稿&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;是什么原因让即将刊发于金融学顶刊的文章被撤稿呢？2016 年，张橹教授在清华金融评论上撰文介绍 q-theory factor model 时谈及了这段历史（Zhang 2016）：&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;不幸的是那一稿和之前的几稿中，盈利因子的建造程序有失误。&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;从上述只言片语的描述可以猜测，构造程序有失误可能是使用了错误的财务指标或者是使用了未来数据（ &lt;a class=&quot;member_mention&quot; href=&quot;https://www.zhihu.com/people/2aabe2f784afcc242b18cad062235cca&quot; data-hash=&quot;2aabe2f784afcc242b18cad062235cca&quot; data-hovercard=&quot;p$b$2aabe2f784afcc242b18cad062235cca&quot;&gt;@童话李&lt;/a&gt;  介绍过这段&lt;a href=&quot;https://www.zhihu.com/question/29558634/answer/380163042?hb_wx_block=1&quot; class=&quot;internal&quot;&gt;往事&lt;/a&gt;，他指出错误是使用了未来数据）。为了搞清楚背后的原因，我查阅了相关公开可得资料，尽最大可能的得到了一些推断。本小节的余下部分就来陈述我的推断，但它依然只是 educated guess。&lt;/p&gt;&lt;p&gt;从 Zhang (2016) 的描述可知，这篇在 Journal of Finance 上夭折的文章是之后 2015 年发表于 Review of Financial Studies 的 Hou, Xue, and Zhang (2015) 的前身（以下记为 HXZ）。HXZ 的致谢部分有这么一段话：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-91f26696bb0a63a7f7b13da9a76b6029_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;795&quot; data-rawheight=&quot;187&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;795&quot; data-original=&quot;https://pic2.zhimg.com/v2-91f26696bb0a63a7f7b13da9a76b6029_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-91f26696bb0a63a7f7b13da9a76b6029_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;795&quot; data-rawheight=&quot;187&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;795&quot; data-original=&quot;https://pic2.zhimg.com/v2-91f26696bb0a63a7f7b13da9a76b6029_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-91f26696bb0a63a7f7b13da9a76b6029_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;这句话给出了两个非常重要的信息。第一个是前面几个版本中存在一个 &lt;b&gt;timing error&lt;/b&gt;；第二个是指出这个错误的人是大名鼎鼎的 Robert Novy-Marx。从这个“timing error”可以合理的推断：&lt;b&gt;在盈利指标的构造上，之前 Journal of Finance 的版本出现了数据可得性的问题。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;从盈利因子的构造频率来看，也确实存在使用未来数据的风险点。对于盈利因子，无论是 JF 还是 RFS 版本，均是按月频来构建，这和美股 empirical asset pricing 上最常见的以年度频率来构建因子大大不同。为了在月频上更加迅速的捕捉因子的变化，陈、张两位教授在构建盈利因子时使用了粒度更细的季报数据，这可能埋下了 timing error 的隐患。&lt;/p&gt;&lt;p&gt;下面来看看 JF 和 RFS 版本的盈利因子在构造上有何不同。需要插播一句的是，在 JF 版本以及更早的 working paper 版本中，盈利因子的构建使用的是 ROA 指标；而在 2010 年修正了 timing error 之后的版本、以及最终发表于 RFS 的版本中，盈利因子使用了 ROE 指标。无论是 ROA 还是 ROE，作为分子的均是 income before extraordinary items，只是分母有所不同。&lt;/p&gt;&lt;p&gt;首先来看 JF 版本的描述：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-fdceb018722b40d87af68639694343a0_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;797&quot; data-rawheight=&quot;482&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;797&quot; data-original=&quot;https://pic1.zhimg.com/v2-fdceb018722b40d87af68639694343a0_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-fdceb018722b40d87af68639694343a0_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;797&quot; data-rawheight=&quot;482&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;797&quot; data-original=&quot;https://pic1.zhimg.com/v2-fdceb018722b40d87af68639694343a0_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-fdceb018722b40d87af68639694343a0_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;再下来是 RFS 版本的描述：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-c0c70a77c6665de298433e165c4b7c94_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;820&quot; data-rawheight=&quot;400&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;820&quot; data-original=&quot;https://pic1.zhimg.com/v2-c0c70a77c6665de298433e165c4b7c94_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-c0c70a77c6665de298433e165c4b7c94_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;820&quot; data-rawheight=&quot;400&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;820&quot; data-original=&quot;https://pic1.zhimg.com/v2-c0c70a77c6665de298433e165c4b7c94_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-c0c70a77c6665de298433e165c4b7c94_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;比较上述两个版本不难发现，ROA 使用了最新季度数据中的 earnings 除以上一个季度的 total assets；而 ROE 使用了最新季度数据中的 earnings 除以上一个季度的 book equity。如果 timing error 由分母引起，那么猜测是 ROA 中的 total assets 有问题，而 ROE 中的 book equity 没有问题，这也能合理的解释为什么最终发表在 RFS 上的版本把之前的 ROA 换成了 ROE（否则将 ROA 换成 ROE 则令人不解）。&lt;/p&gt;&lt;p&gt;然而，从构建因子的定义来看，分母用的是 last quarter total assets 或 last quarter book equity，已经额外滞后了一期，所以分母出问题的可能并不大。由此可以推断，在最新 earnings 数据（即分子）的处理上，JF 的版本可能存在问题。下面继续沿着 JF 和 RFS 两个版本中 earnings 处理的差异进行分析。&lt;/p&gt;&lt;p&gt;在 JF 的版本中，为了保证数据的可得性，作者使用了四个月的窗口做为滞后期（4-month lag）；而在 RFS 版本中，作者并没有一刀切采用 4-month lag 窗口，&lt;b&gt;而是更精确的使用了 Compustat Quarterly 数据库中&lt;/b&gt; &lt;b&gt;RDQ —— quarterly earnings announcement dates&lt;/b&gt; &lt;b&gt;这个条目，以确保每次可以取到最近一个季报披露出来的 earnings 数据。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;从这两种处理方法的比对中可以猜测，一刀切滞后四个月的处理方式可能会有引入未来数据的风险。以下是 Compustat Quarterly 数据的一个示例（包含 4 个公司）。其中 &lt;b&gt;datadate&lt;/b&gt; 条目是 &lt;b&gt;fiscal quarter end date&lt;/b&gt;，而 rdq 就是上面提到的实际的 earnings announcement dates。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-6c7751f893934d2a810449c396974a24_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;829&quot; data-rawheight=&quot;479&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;829&quot; data-original=&quot;https://pic1.zhimg.com/v2-6c7751f893934d2a810449c396974a24_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-6c7751f893934d2a810449c396974a24_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;829&quot; data-rawheight=&quot;479&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;829&quot; data-original=&quot;https://pic1.zhimg.com/v2-6c7751f893934d2a810449c396974a24_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-6c7751f893934d2a810449c396974a24_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;假设不参考 RDQ 条目，而仅仅使用 datadate 这个条目。如果现在是 2006 年 9 月 1 日，为了构建最新的盈利因子，我们使用滞后四个月的盈利数据。对于 ADCT 这个公司，按上述逻辑我们会去抓取 datadate = 20060430 的季报数据。该季报的实际披露日期是 20060531，远在 9 月 1 日之前，因此数据可得性没有问题。&lt;/p&gt;&lt;p&gt;事实上，在上图中的所有季报数据中，每一个 rdq 均在相应 datadate 之后的四个月内，因此采用 4-month lag 似乎没有问题。&lt;b&gt;但是否存在季报未能在四个月内披露的情况呢？&lt;/b&gt; 按照美国 SEC 的规定，上市公司在披露年报（10-K）和季报（10-Q）时，需要满足如下时效性的要求：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-11f47463561bfa436913e38493d9dfe9_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;657&quot; data-rawheight=&quot;268&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;657&quot; data-original=&quot;https://pic2.zhimg.com/v2-11f47463561bfa436913e38493d9dfe9_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-11f47463561bfa436913e38493d9dfe9_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;657&quot; data-rawheight=&quot;268&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;657&quot; data-original=&quot;https://pic2.zhimg.com/v2-11f47463561bfa436913e38493d9dfe9_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-11f47463561bfa436913e38493d9dfe9_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;可见，上市公司应在 fiscal quarter end date 之后的 40 或 45 天之内披露最新的季报、在 fiscal year end date 之后的 75 天到 90 天之内披露年报，否则将会遭到处罚。如果上市公司均满足这个要求，则上述 4-month lag 的处理方法可以保证数据的可得性。然而凡是都有例外，这就不得不提及另一个概念 —— &lt;b&gt;Non-Timely Filings（未能按时披露）&lt;/b&gt;。&lt;/p&gt;&lt;p&gt;当上市公司无法在规定日期内披露季报（或年报），SEC 要求它们进行 Non-Timely Filings 并给出未能及时披露的原因。在公司进行 NT filings 之后，它们将获得额外的 5 天（15 天）进行季报（年报）的披露。Audit Analytics (2014) 一文分析了 2011 年到 2013 年，NYSE，AMEX 以及 NASDAQ 三大交易所的上市公司中针对季报采用 NT filings 的次数，总计高达 201 次。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-cc070168b46eafd02c3441f4c5fe3470_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;680&quot; data-rawheight=&quot;458&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;680&quot; data-original=&quot;https://pic1.zhimg.com/v2-cc070168b46eafd02c3441f4c5fe3470_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-cc070168b46eafd02c3441f4c5fe3470_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;680&quot; data-rawheight=&quot;458&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;680&quot; data-original=&quot;https://pic1.zhimg.com/v2-cc070168b46eafd02c3441f4c5fe3470_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-cc070168b46eafd02c3441f4c5fe3470_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;使用了 NT filings 说明公司季报的审计有一定的问题，无法满足 40（或 45）天的披露截止日期。这意味着这些公司存在延迟披露的风险。那么在这些 NT filings 的公司中，是否均能在额外给予的 5 天内完成披露呢？还是需要更多时间，甚至超过我们关心的四个月（从 fiscal quarter end date 开始算）呢？&lt;/p&gt;&lt;p&gt;针对上图中的例子，Audit Analytics (2014) 进一步给出了这些上市公司采用 NT filings 之后到实际披露日期之间的天数。可以看到，大部分公司在额外给予的 5 天内完成了披露，但仍然有相当多的公司未能完成，而更有不可忽视 70 家公司在 NT filings 之后的 90 天之内都无法完成披露。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-d72a260660a32a4a3da21fdc13722e2a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;795&quot; data-rawheight=&quot;575&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;795&quot; data-original=&quot;https://pic3.zhimg.com/v2-d72a260660a32a4a3da21fdc13722e2a_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-d72a260660a32a4a3da21fdc13722e2a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;795&quot; data-rawheight=&quot;575&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;795&quot; data-original=&quot;https://pic3.zhimg.com/v2-d72a260660a32a4a3da21fdc13722e2a_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-d72a260660a32a4a3da21fdc13722e2a_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;统计结果显示，在 2011 年到 2013 年间，有相当一部分公司未能在 fiscal quarter end date 之后的四个月内披露最新的财报。除了 Audit Analytics (2014) 之外，Bartov and Konchitchki (2017) 统计了 2000 年至 2008 年美股上市公司 NT filings 的次数（下表）。虽然我们不知道这些 cases 中 NT filings 到实际披露之间的天数，但它也至少说明延迟披露是十分常见的现象。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-a357aeddeb48b9bb5f21e289d2c2d496_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;806&quot; data-rawheight=&quot;408&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;806&quot; data-original=&quot;https://pic3.zhimg.com/v2-a357aeddeb48b9bb5f21e289d2c2d496_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-a357aeddeb48b9bb5f21e289d2c2d496_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;806&quot; data-rawheight=&quot;408&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;806&quot; data-original=&quot;https://pic3.zhimg.com/v2-a357aeddeb48b9bb5f21e289d2c2d496_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-a357aeddeb48b9bb5f21e289d2c2d496_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;延迟披露无疑使 4-month lag 这种处理方式存在使用未来数据风险；而像 RFS 版本中使用 RDQ —— quarterly earnings announcement dates 则可以规避这个问题。&lt;/p&gt;&lt;p&gt;以上就是关于 JF 版本计算盈利因子时 timing error 的猜测。再次重申的是，这仅仅是我的 best educated guess，正确与否未知。如果真实的原因是分母的问题（因此把 ROA 换成了 ROE），那么就请各位把上述梳理当作对 Compustat Quarterly data 和 SEC filings 规则的一个介绍吧（无奈脸）。&lt;/p&gt;&lt;p&gt;在本小节最开始谈到 HXZ 的致谢时，那句话里的第二个重要信息是 Robert Novy-Marx。这篇被撤回的文章在修改后仍然未能刊发于 Journal of Finance，而是遗憾的变成一篇 SSRN 上的 working paper（题目也变成了 An alternative three-factor model），作者也在陈、张两位教授之外加了一位，而加入的这位正是 Robert Novy-Marx（Chen, Novy-Marx, and Zhang 2011）。真奇妙。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-d49b66dea6eda80b4f8a26b993e580a8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;760&quot; data-rawheight=&quot;597&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;760&quot; data-original=&quot;https://pic1.zhimg.com/v2-d49b66dea6eda80b4f8a26b993e580a8_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-d49b66dea6eda80b4f8a26b993e580a8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;760&quot; data-rawheight=&quot;597&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;760&quot; data-original=&quot;https://pic1.zhimg.com/v2-d49b66dea6eda80b4f8a26b993e580a8_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-d49b66dea6eda80b4f8a26b993e580a8_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;有意思的是，2013 年 Novy-Marx 在 Journal of Financial Economics 上发表了他学术生涯迄今为止最重要的一篇文章 The other side of value: the gross profitability premium（Novy-Marx 2013）。Google Scholar 显示，这篇以及上面的 SSRN 是他被引用量最高的两篇文章。Novy-Marx 因盈利因子一战成名。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-e876a20c1c394cf8683ff3c44d67be49_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;884&quot; data-rawheight=&quot;494&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;884&quot; data-original=&quot;https://pic2.zhimg.com/v2-e876a20c1c394cf8683ff3c44d67be49_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-e876a20c1c394cf8683ff3c44d67be49_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;884&quot; data-rawheight=&quot;494&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;884&quot; data-original=&quot;https://pic2.zhimg.com/v2-e876a20c1c394cf8683ff3c44d67be49_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-e876a20c1c394cf8683ff3c44d67be49_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;公允的说，Novy-Marx (2013) 版本的盈利因子使用了更加纯粹（即不容易被操纵）的 gross profit 作为分子，因此它比 ROA 或 ROE 都更加合理。&lt;/b&gt;在本文第五小节基于 A 股的实证中也会采用 Novy-Marx (2013) 的盈利因子代替 q-factor model 中的 ROE。实证中的数据采用了&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzI3Mjk5OTU1Ng%3D%3D%26mid%3D2247484005%26idx%3D1%26sn%3Dcda80867ed8ba55d2a31368d8fdcecd9%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;《A 股财务数据的整理和使用》&lt;/a&gt;介绍的方法、考虑了 announcement date 以满足 Point-in-Time 的要求。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;03 触动了谁的利益？&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;在学术研究中，出现数据问题其实并不罕见（金融领域有些发表的文章甚至使用了错误的数据、或错误的使用了数据）。&lt;b&gt;对于从 q-theory 引出的这个三因子模型来说，它的价值不应该因盈利因子的构造失误而抹杀。&lt;/b&gt;陈、张两位教授也的确在 2010 年 4 月将修改稿继续投到 Journal of Finance（Zhang 2016），然而修改稿最终还是被拒绝了。&lt;/p&gt;&lt;p&gt;盈利因子经改造后依然被 JF 拒绝让人感到十分费解 —— 因为 theoretical contribution 和 empirical evidence 都还在，它绝对够的上 JF 的标准。但为什么最终被拒绝了呢？不禁让人浮想联翩。&lt;/p&gt;&lt;p&gt;在 2010 年之前，除了 CAPM 之外，FF3 是 empirical asset pricing 的“第一范式”（其他主流的多因子定价模型都是在 2010 年之后发表的；例外是 Carhart 1997 的四因子模型，但它也只是在 FF3 的基础上加入了动量因子）。因此，陈、张二位教授从 q-theory 提出的市场、投资和盈利三因子模型无疑是和 FF3 的一次直接 PK。而该文的标题 —— A &lt;b&gt;Better&lt;/b&gt; Three-Factor Model That Explains &lt;b&gt;More&lt;/b&gt; Anomalies —— 所使用的“better”、“more”这样的词汇也火药味十足。可以想见，它一旦被发表，则有可能撼动 FF3 在 empirical asset pricing 的地位，这将会在学术界引起怎样的轰动。&lt;/p&gt;&lt;p&gt;追溯 q-factor model 的历史不难发现，它最早以 NBER working paper 的形式发表于 2007 年，当时的题目为 Neoclassical factors。在那之后，该文几经修改，题目也跟着发生了变化。在 2009 年 1 月和 4 月的版本中，题目分别为 An equilibrium three-factor model 和 Production-based factors。&lt;b&gt;但无论怎么改动，这些标题均不带有任何感情色彩。&lt;/b&gt;为什么 JF 版本的论文会用了这么一个充满火药味的名字呢？&lt;/p&gt;&lt;p&gt;张橹教授在清华金融评论的撰文（Zhang 2016）中指出，他当时&lt;b&gt;极力反对&lt;/b&gt;这个名字，无奈一位&lt;b&gt;资深审稿人&lt;/b&gt;坚持让他们使用 A Better Three-Factor Model That Explains More Anomalies：&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-a87f382b3f102607446bc3e345941ead_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;499&quot; data-rawheight=&quot;208&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;499&quot; data-original=&quot;https://pic2.zhimg.com/v2-a87f382b3f102607446bc3e345941ead_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-a87f382b3f102607446bc3e345941ead_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;499&quot; data-rawheight=&quot;208&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;499&quot; data-original=&quot;https://pic2.zhimg.com/v2-a87f382b3f102607446bc3e345941ead_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-a87f382b3f102607446bc3e345941ead_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;发过学术论文的小伙伴大概都了解，审稿人通常不会大改稿件的标题，顶多是提提“shorten it”之类的意见（好吧，我审稿的时候见到太长的标题会给这个意见）。就算是遇到建议改标题的，但如果作者坚持，那么和 editors 正常沟通一下也还是尽可能不做修改的。但显然，陈、张两位教授受到了这位资深审稿人的巨大压力，无奈之下不得不把题目改成了 A Better Three-Factor Model That Explains More Anomalies。&lt;/p&gt;&lt;p&gt;我无从得知这个“不嫌事儿大”的审稿人到底是谁，但 TA 一定是位举足轻重的大佬，大到陈、张二位教授不得不听。同样根据 &lt;a class=&quot;member_mention&quot; href=&quot;https://www.zhihu.com/people/2aabe2f784afcc242b18cad062235cca&quot; data-hash=&quot;2aabe2f784afcc242b18cad062235cca&quot; data-hovercard=&quot;p$b$2aabe2f784afcc242b18cad062235cca&quot;&gt;@童话李&lt;/a&gt;  对这段往事的介绍，这个幕后的大佬是研究动量的先驱 Sheridan Titman；Titman 对 UChicago 派并不感冒，因此便建议陈、张二位教授使用这么一个将矛头直指 FF3 的题目。&lt;/p&gt;&lt;p&gt;这个充满火药味的题目对修改稿最终被 JF 拒绝起到了推波助澜的作用。&lt;/p&gt;&lt;p&gt;根据 Zhang (2016) 的介绍，他们于 2010 年 4 月将修改稿被重新投到 JF 之后又经历了长达一年的审稿，却最终于 2011 年 4 月被拒绝。长达一年的重审是非常令人匪夷所思的。因为按照正常的逻辑，既然 theoretical contribution 和 empirical evidence 都在，那么修改后的版本被接受应该不成问题；即使是想要拒绝，也根本没有必要拖到一年之后的 2011 年 4 月。&lt;/p&gt;&lt;p&gt;事实上，自 2006 年到 2011 年间，时任 Journal of Finance editor 的是杜克大学的 Campbell Harvey 教授。在他 2010 年的 editor report 中明确写道该期刊的 turnaround time 非常短（70.1% 的投稿在 70 天内得到了 editorial decisions），极有很少一部分稿件的审稿周期超过 100 天（Harvey 2011）。而最重要的是下面这句：&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;As of December 31,&lt;/i&gt; &lt;i&gt;&lt;b&gt;no paper&lt;/b&gt;&lt;/i&gt; &lt;i&gt;was currently in the review process&lt;/i&gt; &lt;i&gt;&lt;b&gt;more than 187 days&lt;/b&gt;.&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;而这个审稿时间长达 187 天的稿件的 decision time 是 2011 年 1 月 2 日（Harvey 2011），显然也不是张橹教授口中的 2011 年 4 月，因此它应该不是 q-factor model 的修改版。当然，从 editor report 中还是难以明确 turnaround time 的计算口径。因此，如果一篇文章被提交后又被反复的 revise and resubmit，它的 turnaround time 到底从哪次 submit 开始计算未知。所以 q-factor model 修改版的审稿时间在特定的口径下也许仍然满足小于 187 天。但如果真相并非如此，那么这份 editor report 就有刻意掩盖该文长达一年审稿时间之嫌，这将是 Journal of Finance 审稿史上的一个污点。&lt;/p&gt;&lt;p&gt;为什么修改稿会再次经历长达一年的时间却仍然被拒绝呢？&lt;b&gt;这次对修改稿的审稿耽误了这个重要因子模型长达一年的时间（学术界中一年是非常宝贵的）。&lt;/b&gt;张橹教授在回忆这段往事时称，这是他学术生涯中的至暗时刻：&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;After the procedure was corrected in the April-2010 draft, the paper limped for one more year at Journal of Finance, and was formally rejected in April 2011. Persisting through&lt;/i&gt; &lt;i&gt;&lt;b&gt;the darkest times of my career&lt;/b&gt;, I rebuilt my team with Prof. Kewei Hou and Prof. Chen Xue.&lt;/i&gt;&lt;/blockquote&gt;&lt;p&gt;在回答上面那个“为什么又历经一年却被拒”的问题之前，先来看看 q-factor model 的后续发展。重组了 team 的张橹教授和侯恪惟以及薛辰两位教授一起于 2012 年首先以 NBER working paper 的形式重新发布了最新版本，题为 Digesting anomalies: An investment approach。而也是在这个版本中，正式在 q-factor model 中加入了 Size 因子，得到了最终的四因子模型（市场、市值、投资以及盈利）。这篇 working paper 之后又历经两年的严格审稿，最终于 2014 年 8 月被 RFS 接受，并于 2015 年 3 月发表（Hou, Xue, and Zhang 2015）。&lt;/p&gt;&lt;p&gt;历经坎坷，这个全新的从 q-theory 提出的多因子模型终于在顶刊上面世，而它也当仁不让成为 editor&amp;#39;s choice 以及 lead article。RFS 的出版商、牛津大学出版社更是以 A new benchmark model for estimating expected stock returns 为题撰文为其造势。&lt;/p&gt;&lt;p&gt;从 2010 年就应该刊发在 Journal of Finance 到几经波折最终于 2015 年刊发在 Review of Financial Studies，不禁令人唏嘘。&lt;b&gt;而更加玄妙的是，在 q-factor model 被耽误的四年中，同样加入投资和盈利的 Fama and French (2015) 五因子模型（以下记为 FF5）被发表了。&lt;/b&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-a0cd1e251262c0a5208983dbe97cd5f5_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;950&quot; data-rawheight=&quot;513&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;950&quot; data-original=&quot;https://pic2.zhimg.com/v2-a0cd1e251262c0a5208983dbe97cd5f5_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-a0cd1e251262c0a5208983dbe97cd5f5_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;950&quot; data-rawheight=&quot;513&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;950&quot; data-original=&quot;https://pic2.zhimg.com/v2-a0cd1e251262c0a5208983dbe97cd5f5_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-a0cd1e251262c0a5208983dbe97cd5f5_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;HXZ 于 2014 年 8 月被接受、2015 年 3 月被刊载；而同一时期，添加了几乎完全一样的投资和盈利（出发点完全不同，FF5 的出发点是 discounted cash flow 模型）的 FF5 于 2014 年 9 月被接受、2015 年 4 月被刊载。&lt;/p&gt;&lt;p&gt;由于 HXZ 和 FF5 同时期被提出，q-factor model 的影响力显然就没有当年对标 FF3 的那种轰动效果。这一变化造成的直接后果是，&lt;b&gt;FF5 一经发表，自然而然的接过了 FF3 的抢，继续牢牢占据 empirical asset pricing 的“第一范式”。&lt;/b&gt;这一点可以从引用数量上得到佐证：截至本文写作时，根据 Google Scholar 的引用数量，FF5 被引用了 2397 次，而 HXZ 只有 934 次，较前者少了一半之多。&lt;b&gt;试想一下，如果 q-factor model 早在 2010 年就被发表，那到今天又是怎样的局面？&lt;/b&gt;&lt;/p&gt;&lt;p&gt;我们无从得知 q-factor model 被拖了四年之久是否和学术界相关利益小圈子为 FF5 争取时间有关。我没有查到相关的资料，因此无法判断。感兴趣的小伙伴可以看看 &lt;a class=&quot;member_mention&quot; href=&quot;https://www.zhihu.com/people/2aabe2f784afcc242b18cad062235cca&quot; data-hash=&quot;2aabe2f784afcc242b18cad062235cca&quot; data-hovercard=&quot;p$b$2aabe2f784afcc242b18cad062235cca&quot;&gt;@童话李&lt;/a&gt;  的&lt;a href=&quot;https://www.zhihu.com/question/29558634/answer/380163042?hb_wx_block=1&quot; class=&quot;internal&quot;&gt;回答&lt;/a&gt;（文末参考文献有链接），它对 q-factor model 修改稿被再次投到 Journal of Finance 之后的经历有进一步的介绍（还牵扯出一位重量级利益相关方）。不过我无从考证。&lt;/p&gt;&lt;p&gt;虽然没有找到相关资料，但是从 Zhang (2016) 的表述中，也能看到一些蛛丝马迹；&lt;b&gt;FF5 的提出和 q-factor model 被耽误了四年的时间之间注定有些千丝万缕的关联。&lt;/b&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-549c9481e17241ff04653aae50609dc7_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;525&quot; data-rawheight=&quot;311&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;525&quot; data-original=&quot;https://pic4.zhimg.com/v2-549c9481e17241ff04653aae50609dc7_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-549c9481e17241ff04653aae50609dc7_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;525&quot; data-rawheight=&quot;311&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;525&quot; data-original=&quot;https://pic4.zhimg.com/v2-549c9481e17241ff04653aae50609dc7_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-549c9481e17241ff04653aae50609dc7_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;2019 年，Hou et al. (2019) 在 Review of Finance 上发表了一篇题为 Which Factors? 的文章，比较了包括 FF3 和 FF5 在内的学术界主流的多因子模型，也从因子构造上“怼”了 FF5 中的投资因子。从这个事情上也能看出 q-factor model 和 FF5 之间的瓜葛，以及 q-factor model 发明者心中的不忿。下面简要回顾一下。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;04 Factor War&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;关于 Hou et al. (2019) 是如何“怼”FF5 的投资因子，&lt;a href=&quot;https://zhuanlan.zhihu.com/p/72957469&quot; class=&quot;internal&quot;&gt;《从 Factor Zoo 到 Factor War，实证资产定价走向何方?》&lt;/a&gt;一文有详细的解读。而如今，当我们了解了 q-factor model 发表背后的艰辛历程后，就更能理解 Hou et al. (2019) 一文。&lt;/p&gt;&lt;p&gt;以下简单回顾下之前那篇文章中 FF5 和 q-factor model 在投资因子上的差异。它们都使用最近一个财年 total assets 的变化率作为因子，但出发点不同：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;q-factor model 来自投资中的 q-theory，它指出收益率和 &lt;b&gt;past &lt;/b&gt;investment 成反比，因此 q-factor model 中使用最近一个财年 total assets 的变化率没有任何问题；&lt;/li&gt;&lt;li&gt;FF5 来自 discounted cash flow（DCF）模型出发得出收益率和&lt;b&gt;未来 expected&lt;/b&gt; investment 成反比；但 FF5 基于 Fama and French (2006) 的检验结果，采用 past investment —— 即过去一个财年 total assets 的变化率 —— 当作未来 expected investment 的 naïve estimate。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;Hou et al. (2019) 的两个核心观点是：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;DCF 中的 IRR 和未来单期的 expected return 不同。从 valuation theory 出发并将 IRR 换成未来单期预期收益率，则从理论上是可以推导出 expected investment 和 expected return 之间存在&lt;b&gt;正相关&lt;/b&gt;（正如同 Fama and French 2006 里的检验结果），而非 FF5 使用 DCF 所隐含的负相关 —— 这是从理论上开炮；&lt;/li&gt;&lt;li&gt;实证结果显示 past investment 并不是 expected investment 的一个很好的代理指标，即 naïve estimate 根本不靠谱 —— 这是从实证上开炮。&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;b&gt;结合上述两点，FF5 使用 past investment 构建的投资因子（且该因子有效）其实是阴差阳错的利用了 past investment 和收益率之间的负相关（源自 q-theory）；而非他们从 DCF 推出的 expected investment 和收益率之间的负相关性。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;客观的说，关于 expected investment 和 expected return 的关系，q-factor model 比 FF5 更合理。&lt;b&gt;因此，HXZ 从 q-theory 推出的投资因子比 FF5 从 DCF 推出的投资因子在理论上更加站得住脚。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;抛开理论上的差异不说，从针对美股的实证结果来看，虽然 FF5 和 q-factor model 使用了同样的历史 total asset 增长率构建投资因子，但由于构建方法不同，q-factor model 中投资因子的溢价也完胜 FF5。这似乎佐证了 q-factor model 背后的 q-theory 能更好的解释 past investment 和 expected return 之间的关系。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;05 FF3 and q-factor models in China&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;其实，无论是 FF3 中的 SMB、HML，还是 q-factor model 中的投资和盈利；又不管它们在学术界有着怎样的恩怨情仇，它们都帮助我们更好的了解了股票预期收益率在截面上产生差异的原因。&lt;/p&gt;&lt;p&gt;长久以来在 A 股上的实证结果也表明，&lt;b&gt;上述四个风格因子（投资因子稍弱）在大 A 股上是相互补充而非对立的关系。&lt;/b&gt;本小节就来用实证结果证明这一点。&lt;/p&gt;&lt;p&gt;以全 A 股（排除金融）为例，按照学术界传统的 2 × 3 double sort 的方法构建这四个风格因子。对于除了 Size 之外的三个因子，采用的指标分别为 book-to-market，total asset growth 以及 gross profitability to total assets（Novy-Marx 2013 版本的盈利因子；如采用 ROA 或 ROE 也能得到类似的结果）。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-3dee657852960d24bd86cc2ff9c7a40a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;725&quot; data-rawheight=&quot;333&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;725&quot; data-original=&quot;https://pic3.zhimg.com/v2-3dee657852960d24bd86cc2ff9c7a40a_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-3dee657852960d24bd86cc2ff9c7a40a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;725&quot; data-rawheight=&quot;333&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;725&quot; data-original=&quot;https://pic3.zhimg.com/v2-3dee657852960d24bd86cc2ff9c7a40a_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-3dee657852960d24bd86cc2ff9c7a40a_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;根据 2 × 3 double sort，Size 因子和其它风格因子（价值、投资和盈利）的构建方法为：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brll%7D+%5Cmbox%7BSMB%7D%26%3D%26%5Cdisplaystyle%5Cfrac%7B1%7D%7B3%7D%28%5Cmbox%7BS%2FT%2BS%2FM%2BS%2FB%7D%29-%5Cfrac%7B1%7D%7B3%7D%28%5Cmbox%7BB%2FT%2BB%2FM%2BB%2FB%7D%29%5C%5C+%5Cmbox%7BStyle%7D%26%3D%26%5Cdisplaystyle%5Cfrac%7B1%7D%7B2%7D%28%5Cmbox%7BS%2FT%2BB%2FT%7D%29-%5Cfrac%7B1%7D%7B2%7D%28%5Cmbox%7BS%2FB%2BB%2FB%7D%29+%5Cend%7Barray%7D+&quot; alt=&quot;\begin{array}{rll} \mbox{SMB}&amp;amp;=&amp;amp;\displaystyle\frac{1}{3}(\mbox{S/T+S/M+S/B})-\frac{1}{3}(\mbox{B/T+B/M+B/B})\\ \mbox{Style}&amp;amp;=&amp;amp;\displaystyle\frac{1}{2}(\mbox{S/T+B/T})-\frac{1}{2}(\mbox{S/B+B/B}) \end{array} &quot; eeimg=&quot;1&quot;/&gt; &lt;/p&gt;&lt;p&gt;为比较两个因子模型的优劣，首先采用 Gibbons, Ross, and Shanken (1989) Test。结果显示，两组因子互为模型和资产时，作为模型的两个因子均无法解释另外两个作为资产的因子。&lt;b&gt;这说明两个模型均能获得对方无法解释的超额收益。&lt;/b&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-c6d0943d5710d2e39df46d986adba234_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;556&quot; data-rawheight=&quot;240&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;556&quot; data-original=&quot;https://pic1.zhimg.com/v2-c6d0943d5710d2e39df46d986adba234_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-c6d0943d5710d2e39df46d986adba234_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;556&quot; data-rawheight=&quot;240&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;556&quot; data-original=&quot;https://pic1.zhimg.com/v2-c6d0943d5710d2e39df46d986adba234_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-c6d0943d5710d2e39df46d986adba234_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;接下来再通过 Fama and MacBeth (1973) Regression 考察代表这四个风格因子的公司指标能否获得风险溢价。在实证期 2000 年 1 月到 2018 年 12 月内，FM Regression 结果如下。除投资因子外，其他三个因子均能获得显著的风险溢价（市值的风险溢价为负说明小市值公司比大市值公司涨的多）。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-10ae5067c0967978daa443bbdff8594f_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;795&quot; data-rawheight=&quot;359&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;795&quot; data-original=&quot;https://pic4.zhimg.com/v2-10ae5067c0967978daa443bbdff8594f_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-10ae5067c0967978daa443bbdff8594f_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;795&quot; data-rawheight=&quot;359&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;795&quot; data-original=&quot;https://pic4.zhimg.com/v2-10ae5067c0967978daa443bbdff8594f_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-10ae5067c0967978daa443bbdff8594f_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;因此，q-factor model 在 FF3 的基础上，为我们更好的理解市场做了必要补充。&lt;/p&gt;&lt;h2&gt;&lt;b&gt;06 结语&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;近年来，从 q-theory 投资理论出发得到的多因子模型 —— q-factor model —— 受到了学术界和业界越来越高的重视。这是以张橹教授为代表的华人学者对 empirical asset pricing 的杰出贡献。&lt;/b&gt;关于投资理论的更多解读，感兴趣的小伙伴可参考 [因子动物园] 的&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzUxNzY0NjU3Mw%3D%3D%26mid%3D2247484082%26idx%3D1%26sn%3D5e928ca55b3f594af640783f728bbfdf%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;《投资效应：&lt;/a&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzUxNzY0NjU3Mw%3D%3D%26mid%3D2247484082%26idx%3D1%26sn%3D5e928ca55b3f594af640783f728bbfdf%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Factor War 前传》&lt;/a&gt;。&lt;/p&gt;&lt;p&gt;本文以一篇未能刊发在 Journal of Finance 上的文章为引子，介绍了 q-factor model 背后的一段历史；我也在写作过程中深深的感受到了学术创新的艰辛。坦率的说，&lt;a href=&quot;https://zhuanlan.zhihu.com/p/72957469&quot; class=&quot;internal&quot;&gt;《从 Factor Zoo 到 Factor War，实证资产定价走向何方?》&lt;/a&gt;一文对 q-factor model 和 FF5 的立场，在某些字里行间的表述中没有做到完全中立，我感到颇为不安。因此希望本文能够尽量客观的介绍 q-factor model 背后的故事。&lt;/p&gt;&lt;p&gt;令人欣慰的是，学术界并没有遗忘这篇本应该刊发于 Journal of Finance 的文章、或者对其讳莫如深。John Cochrane 教授（Eugene Fama 的女婿）就在其 Empirical Asset Pricing 课程的网站上的 Production based methods 部分列举了这篇文章，并提供下载。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-ef5839d2f6038e42b2bbf6f5e0b7bad8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;954&quot; data-rawheight=&quot;417&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;954&quot; data-original=&quot;https://pic1.zhimg.com/v2-ef5839d2f6038e42b2bbf6f5e0b7bad8_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-ef5839d2f6038e42b2bbf6f5e0b7bad8_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;954&quot; data-rawheight=&quot;417&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;954&quot; data-original=&quot;https://pic1.zhimg.com/v2-ef5839d2f6038e42b2bbf6f5e0b7bad8_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-ef5839d2f6038e42b2bbf6f5e0b7bad8_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;是金子总会发光的。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;2018 年，Hou et al. (2018) 在 q-factor model 的基础上加入了预期投资增长因子，提出了前者的进阶版： &lt;img src=&quot;https://www.zhihu.com/equation?tex=q%5E5&quot; alt=&quot;q^5&quot; eeimg=&quot;1&quot;/&gt;  model。&lt;b&gt;针对美股的实证分析显示，&lt;/b&gt; &lt;img src=&quot;https://www.zhihu.com/equation?tex=q%5E5&quot; alt=&quot;q^5&quot; eeimg=&quot;1&quot;/&gt; &lt;b&gt; 是当下所有主流因子模型中最能够解释 anomalies 的&lt;/b&gt;。之后，这几位教授又使用  &lt;img src=&quot;https://www.zhihu.com/equation?tex=q%5E5&quot; alt=&quot;q^5&quot; eeimg=&quot;1&quot;/&gt;  解释了历史上的多位价值投资大佬（如巴菲特和格伦布拉特）以及学术界的一些重要因子（如 AQR 的 QMJ 和 Piotroski 的 F-Score）的收益，&lt;b&gt;从 investment theory 的角度对解读格雷厄姆和多德的 Security Analysis 提供了全新的思路。&lt;/b&gt;&lt;/p&gt;&lt;p&gt;2019 年，Hou et al. (2019) 这篇题为 Which Factors? 的文章一举获得了 Review of Finance 的 Spangle IQAM Best Paper Prize，表明学术界对 q-factor model 的认可。&lt;/p&gt;&lt;p&gt;风向也许已经悄然发生了转变……&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-6ea0ad38bff4a316c1ebd62077769d75_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;571&quot; data-rawheight=&quot;601&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;571&quot; data-original=&quot;https://pic2.zhimg.com/v2-6ea0ad38bff4a316c1ebd62077769d75_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-6ea0ad38bff4a316c1ebd62077769d75_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;571&quot; data-rawheight=&quot;601&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;571&quot; data-original=&quot;https://pic2.zhimg.com/v2-6ea0ad38bff4a316c1ebd62077769d75_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-6ea0ad38bff4a316c1ebd62077769d75_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;参考文献&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Audit Analytics (2014). Non-timely filing: an overview. Available at: &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//blog.auditanalytics.com/non-timely-filings-an-overview/&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;blog.auditanalytics.com&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;/non-timely-filings-an-overview/&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;.&lt;/li&gt;&lt;li&gt;Bartov, E. and Y. Konchitchki (2017). SEC filings, regulatory deadlines, and capital market consequences. New York University Law and Economics Working Paper, No. 254.&lt;/li&gt;&lt;li&gt;Carhart, M. M. (1997). On Persistence in Mutual Fund Performance. &lt;i&gt;The Journal of Finance&lt;/i&gt;, Vol. 52(1), 57 – 82.&lt;/li&gt;&lt;li&gt;Chen, L., R. Novy-Marx, and L. Zhang (2011). An alternative three-Factor model. Available at SSRN: &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//ssrn.com/abstract%3D1418117&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;ssrn.com/abstract=14181&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;17&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;.&lt;/li&gt;&lt;li&gt;Fama, E. F. and K. R. French (1993). Common risk factors in the returns on stocks and bonds. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 33(1), 3 – 56.&lt;/li&gt;&lt;li&gt;Fama, E. F. and K. R. French (2006). Profitability, investment and average returns. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 82(3), 491 – 518.&lt;/li&gt;&lt;li&gt;Fama, E. F. and K. R. French (2015). A Five-Factor Asset Pricing Model. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 116(1), 1 – 22.&lt;/li&gt;&lt;li&gt;Fama, E. F. and J. D. MacBeth (1973). Risk, return, and equilibrium: empirical tests. &lt;i&gt;Journal of Political Economy&lt;/i&gt;, Vol. 81(3), 607 – 636.&lt;/li&gt;&lt;li&gt;Gibbons, M. R., S. A. Ross, and J. Shanken (1989). A test of the efficiency of a given portfolio. &lt;i&gt;Econometrica&lt;/i&gt;, Vol. 57(5), 1121 – 1152.&lt;/li&gt;&lt;li&gt;Harvey, C. R. (2011). Report of the editor of the Journal of Finance for the year 2010. &lt;i&gt;The Journal of Finance&lt;/i&gt;, Vol. 66(4), 1439 – 1452.&lt;/li&gt;&lt;li&gt;Hou, K., H. Mo, C. Xue, and L. Zhang (2018). q^5. NBER Working Paper, No. 24709.&lt;/li&gt;&lt;li&gt;Hou, K., H. Mo, C. Xue, and L. Zhang (2019). Which factors? &lt;i&gt;Review of Finance&lt;/i&gt;, Vol. 23(1), 1 – 35.&lt;/li&gt;&lt;li&gt;Hou, K., C. Xue, and L. Zhang (2015). Digesting anomalies: an investment approach. &lt;i&gt;The Review of Financial Studies&lt;/i&gt;, Vol. 28(3), 650 – 705.&lt;/li&gt;&lt;li&gt;Newey, W. K. and K. D. West (1987). A simple, positive semi-definite, heteroskedasticity and autocorrelation consistent covariance matrix. &lt;i&gt;Econometrica&lt;/i&gt;, Vol. 55(3), 703 – 708.&lt;/li&gt;&lt;li&gt;Novy-Marx, R. (2013). The other side of value: The gross profitability premium. &lt;i&gt;Journal of Financial Economics&lt;/i&gt;, Vol. 108 (1), 1 – 28.&lt;/li&gt;&lt;li&gt;Zhang, L. (2016). Factors war. &lt;i&gt;Tsinghua Financial Review&lt;/i&gt;, Vol. 37, 101 – 104, in Chinese.&lt;/li&gt;&lt;li&gt;&lt;a class=&quot;member_mention&quot; href=&quot;https://www.zhihu.com/people/2aabe2f784afcc242b18cad062235cca&quot; data-hash=&quot;2aabe2f784afcc242b18cad062235cca&quot; data-hovercard=&quot;p$b$2aabe2f784afcc242b18cad062235cca&quot;&gt;@童话李&lt;/a&gt;：&lt;a href=&quot;https://www.zhihu.com/question/29558634/answer/380163042?hb_wx_block=1&quot; class=&quot;internal&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://www.&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;zhihu.com/question/2955&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;8634/answer/380163042?hb_wx_block=1&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;免责声明：&lt;/b&gt;文章内容不可视为投资意见。市场有风险，入市需谨慎。&lt;/p&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;原创不易，请保护版权。如需转载，请联系获得授权，并注明出处。已委托“维权骑士”(&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//rightknights.com/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;维权骑士_免费版权监测/版权保护/内容多平台分发&lt;/a&gt;) 为进行维权行动。&lt;/p&gt;</description>
<author>石川</author>
<guid isPermaLink="false">2019-09-12-82233089</guid>
<pubDate>Thu, 12 Sep 2019 00:00:00 +0800</pubDate>
</item>
</channel>
</rss>
