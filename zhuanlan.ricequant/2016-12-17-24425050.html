<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>（万字干货转载）量化投资的方法论</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/24425050">原文</a></p>
<div class="title-image"><img src="https://pic2.zhimg.com/v2-4b5489cc45255e31b6cc830506d6fc81_r.jpg" alt=""></div><h2><strong>“<a href="https://www.ricequant.com/?f=n" data-title="Ricequant" class="" data-editable="true">Ricequant</a>”经棋剑资产首席执行官王晓光先生授权发布，如转载请独自获得授权。</strong></h2><br><p><strong>写在文前：周末为大家奉上一篇来自棋剑资产王晓光的一篇报告，文有点长，但是确实系统地讲解了量化投资这件事。海纳百川，多学习不同的观点能拓宽视野。先祝大家周末快乐。</strong></p><img src="https://pic3.zhimg.com/v2-862d32a9d39af33a6f044c348e0af0b3_r.jpg" data-rawwidth="500" data-rawheight="270"><p><strong>原文：</strong></p><p>大家好！非常荣幸可以来到第九届R语言会议作报告。今天我主要围绕量化投资，结合自己以及我们团队在量化投资领域的实践经验，以及一些经典的理论知识，尝试性地为大家梳理量化投资的方法论体系，希望为大家在量化投资领域产生一些新的认识提供一些帮助。</p><p>我们先从几个在量化投资中经常遇到的小问题出发，然后逐渐深入思考量化投资的几个基本方法和原则。这些问题或许没有统一的标准答案，我也不会给出具体的答案，这里提出的主要目的是引起大家思考。</p><p>首先第一个问题是如何定义与看待期望收益与风险? 这可以说是投资领域的终极问题。这个问题很大程度上决定了你如何做策略的研发，如果管理风险，以及如何进行资产配置等关键问题。首先，到目前大家已经比较能够一致认同的就是，收益这个变量本身是随机的，不确定的，而且极难预测，因此单纯谈论收益，从长期的系统化投资角度讲，意义不大，一次两次赚多少钱跟你的系统化投资没有太大关系，<strong>而研究的重点，要放在期望收益上，也就是从概率意义上以及大样本意义上的期望水平。</strong>与收益相对应的是风险，如何定义风险也是有着不同的版本。一种简单的定义可以是波动率，或下行波动率，但是这并不能包含市场中的大部分主要风险，比如说流动性风险，再比如说即使只考虑波动率或亏损，在bad times的时候，某个资产或某个策略的大幅亏损对投资者的整个系统化投资的危害程度一般也会更高，而在good times的时候，同样的亏损或波动率或许对整个系统的危害程度没有那么高，这一点通过市场溢价的水平就可以看出来:比如说市场总是倾向于给予out of money的期权更高的溢价（波动率微笑特征），或者在大部分时间内给予小市值高成长股票更高的风险溢价（然而在股市出现系统性崩盘时，这类股票的跌幅往往也是最大的），这些都是市场在表达对风险的不同对待的现象。 </p><p>第二个问题是期望收益来自哪里？这是做策略投研的一个核心问题，你首先要有一个基本的逻辑作为引导，来开发你的策略，然后再运用数据和模型进行去伪存真，抽丝剥茧的分析，但是在这个过程中，逻辑是必不可少的一个主线，那么这个逻辑就是你思考的期望收益的来源。<strong>有的人从不同资产类别的角度理解期望收益来源</strong>，去比较股票，债券，商品等不同资产类别的收益贡献，那么这就是朝着大类资产配置和组合的角度去理解投资，这里面做得好，也是可以做出比全市场平均配置更好的投资方案的。还有一些人，<strong>通过策略风格角度理解收益的来源，</strong>比如趋势类策略贡献多少收益，波动率类策略贡献多少收益，那么这便是从策略风格或种类的角度去分析，也可以成为一套体系。但是这些都是分析的角度，最终仍然没有根本性回答你的超额收益来自哪里的问题。比如说趋势策略，为什么就会有超额收益呢？或者说股票，为什么相对于债券有超额收益呢？从这个层次上，<strong>我认为超额收益的主要来源，其实归根结底分为两类，一类是利用市场一定时间内的无效性或者别人犯得错误，这是很多价值投资或套利投资的基本逻辑来源。另一类就是这种投资行为的超额收益是承担了某种风险的风险溢价，比如说</strong><strong>volatility selling </strong><strong>或者sell options, </strong><strong>就可以归为这种。</strong>卖出波动率或卖出期权，其实相当于卖保险，是在承担一些小概率的高风险，这些小概率事件可能很久都不会发生，于是投资人通过卖期权可能在很长一段时间内获得稳定的收益，但是一旦小概率事件发生，那么到时候产生的亏损，也往往是致命的。再比如说针对一些流动性极差的资产的做市策略，往往也可以获利丰厚，但是这是因为在这种资产中做市交易承担了更多的流动性风险，这种风险处理稍有不慎就可能导致严重亏损，所以在这种资产中做市的收益才会显得比较高，但是前提是你了解清楚这个风险溢价的来源，并有技巧可以合理的化解他，或者比别人能够在这方面做的更好，否则的话，从长期看，你的期望收益未必是很高的。基本上市场上大部分的非高频系统化投资策略的稳定超额收益的来源，往往都与上述两个方面有关，现在市场变得越来越有效，所以其实第一种收益来源的机会逐渐变得越来越少，越来越难以抓住，而第二种收益的来源，是可以长期存在的，但是第二种收益的来源，往往是风险溢价，他并不是免费午餐，这一点是要牢记的。所以不要以为你的投资系统连续7年或10年都可以稳定盈利，你就可以高枕无忧，其实或许只是你承担的风险事件，还没有到来而已，如果对于这些风险，你无法做到比别人更好的管理，那么这个游戏长久的进行下去，迟早有一天属于你的黑天鹅会到来，而且到来的频率越低，越往往会是一次性致命的。</p><p>第三个问题是一个策略被很多人知道了以后，是否就不赚钱了呢？接着上面的那个问题的思路继续讲，如果你的这个策略的收益来源主要是通过市场的无效性获益，那么确实当更多人知道了这一点并参与进来，你的获利空间也就越来越小。但是如果你的策略的收益来源是第二种，那么其实即使很多人知道了，也未必会导致它不赚钱，当然，正如上面我们提到的，这样的收益，其所承担的风险，你也是需要有很清醒的认识的，并可以合理的管理这个风险，所以从这个角度叫，盈亏同源是有道理的，好多人说的盈亏同源，其实往往就是指第二种的这个收益。</p><p>第四个问题是如何评价一个投资系统或策略的好与坏？或者如何评价一个基金的好与坏？这个问题也是仁者见仁智者见智了，但是据我所了解，很悲观的是，最后很难有一种方法能够非常准确与客观并长期有效。比如说历史业绩，这当然是一个重要的指标，但是历史业绩的好与坏一定与未来正相关吗？有时是的，但有时可以是反过来的。比如一个策略或基金，在商品期货市场今年下半年的趋势行情中，不到一两个月就赚了超过30%的收益的话，这当然是不错的业绩，但是根据此，就购买这只基金并期望明年获得类似的收益，是合理的吗？仔细想想，其实不合理。因为一个策略或者基金能够在短时间内获取如此高的收益，恰恰说明他的策略风格是明确的，单一的，投资的观点是相对激进的，比如说他全部都是趋势类的策略思路，而且还用了比较高的杠杆，那么继续坚持这样的投资策略或思路的话，假如明年市场陷入无序的震荡，他可能就会亏大钱了。当然你可以争论说明年或许还是趋势行情，但我觉得这方面除非你有非常合理的具体的模型来预测，并且确实证明长期有效，否则我是不觉得你可以准确预测明年的市场结构的（历史上多次证明华尔街大部分专业机构和交易者对于未来一年的市场的预测往往都是大概率错误的）。你也可以说，这个策略很智能，或者这个基金经理很智能，他们总是能在趋势来的时候做趋势交易，震荡市场来了就知道做震荡，市场中是否存在这样的高手长年可以准确判断并切换的？我觉得天才可能是有的，但是你遇到的概率是比较低的，<strong>一个理性的投资者，不应该基于一个假设就是自己是全市场最聪明或者全市场最幸运的一个，来进行投资。</strong>这样的心态下，大概率投资生涯会比较短。人在面对市场的时候，谦虚一点，保守一点总是更好的，即使你很看好趋势行情，也要为非趋势行情的市场做足准备，不要总是假设自己很聪明，可以做很多预测，然后在不同子策略或子基金之间来回选择切换做择时，事实往往是残酷的，那就是你这么做之后发现其实自己是比较蠢的那一个，择时起到反作用，你觉得这个基金该赚钱了，或者这个策略该赚钱了，然后想去抄底的，结果反而不如人家一直呆在里面的或者一直在外面的。所以从这个角度讲，即使很多的专业机构，做的也不够好。最近FOF在国内非常火爆，可是我要做一个悲观的预言就是目前市场上已经做FOF或者成立的FOF，其中绝大多数的寿命可能都不会超过3年，这个跟在股市里散户十人九亏是一个道理，心态没摆正，机构并不会比散户做的更好。好多FOF基本就是看着历史业绩选子基金，业绩好的买进入，差了的就赎回，其他的思考能力很差，对市场的理解很差，对策略的把握也不行，那么几年下来大家就会发现他这个FOF还不如平均的买入那几个子基金然后抱着不动的结果好，那么可想而知他的结果了。所以说，投资策略评价是一门很高深的学问，不是说你看几个指标，算一算夏普率，比一比最大回撤，然后答案就确定了。我的观点是，做策略评价的人，做FOF的人，选子基金的人，他做交易或者投资研发的能力，得比那些做策略的人，做子基金的人，水平更高，这样才能选的好。你一个子策略能做好，一个子基金能做好，才能够考虑怎么做好多个子基金的搭配，多个子策略的组合，一个都搞不好就想搞多个，没当好徒弟就想做师傅，往往事与愿违，可惜现在的市场实际情况看，是反过来的，这导致我对整个FOF行业的每个FOF基金的寿命长短，不表示乐观。</p><p>最后一个小问题，引出我今天的主题，也就是怎么样才能做出赚钱的量化投资策略？一个人，从科班出身的统计学博士，或者计算机/数学/经济专家，到一个优秀的可以稳定贡献优质量化策略的quant或基金经理，中间究竟差了哪些，需要哪些步骤？ 为了回答这个问题，以及上述几个问题，我今天斗胆尝试性地与大家分享，量化投资的方法论体系。</p><p>我理解的量化投资方法论，有以下四个维度：</p><p>   <strong>投资的三面魔方：资产类别，风险因子，策略风格</strong></p><p>   <strong>投资的三套理论：资产定价模型，投资组合理论，有效市场假说</strong></p><p>   <strong>量化的两个载体：数据，人</strong></p><p>   <strong>决策的两个维度：收益，风险</strong></p><img src="https://pic1.zhimg.com/v2-e7eedcc981f891e7cb3fe0c923fb9015_r.jpg" data-rawwidth="640" data-rawheight="360"><p>下面我们来分别逐一讨论这四个维度。</p><p>首先我们来看中间的这个正方体，也就是投资的三面魔方。</p><img src="https://pic1.zhimg.com/v2-4b5489cc45255e31b6cc830506d6fc81_r.jpg" data-rawwidth="640" data-rawheight="360"><p>这个正方体不是我发明的，是来自于Antti Ilmanen 写的Expected Returns这本书。这本书中针对资产类别，风险因子，策略风格三大方面，对期望收益进行了不同视 的深度阐述，是值得仔细去研读的一本书。在这里我简单的总结下这本书里的一些主要观点。这三大方面里面，大家最常见的就是资产类别这个方面。资产类别一般可以分为股票类资产，信用类资产，国债类资产，以及另类资产（比如商品期货，房地产，艺术品等都可以属于这类）。大家可以看到这里显示的是过去二十年股票市场的年化收益情况，可以看到大部分年份的平均收益在5%左右，年化的夏普率大概不到0.5，那么这就让大家有了一个基本的概念，就是在股票市场中你平均可以预期的收益大概在什么水平，以及为此要承担多少的风险或者波动。当然，优秀的投资者可以获取远超过市场平均水平的收益，但是作为一个参考的基本标准，过去几十年的股市平均收益情况，给了大家一个基本的心理预期。如果你的心里预期收益相对于这个参考标准过于高，而所愿意承担的风险又过于低，那就要考虑是否是过于理想主义了，或者说这就对你的投资策略的水平有了很高的要求。接下来这几页给出了一些信用类衍生品，公司债，国债以及商品的历史表现情况，整体看各类资产的收益水平长期看是比较接近的，有的平均收益高一些，有的平均收益低一些，但是平均收益低的资产夏普率往往并不低，所以在衡量期望收益的同时还要考虑到风险的水平。</p><p>那么除了资产类别这个角度，还有另外两个重要的角度来分析和理解期望收益与风险。那就是策略风格角度和风险因子角度。这里列出了跨市场长期验证比较有效的几类策略的风格，<strong>趋势类，价值类，</strong><strong>carry</strong><strong>，以及波动率交易。</strong>这四种思路或者逻辑可以说囊括了市场中绝大多数的量化策略，同时他们彼此之间的相关性也比较低，逻辑各有不同。价值投资类策略，在股市中是应用最多的，比如下面这个图，就显示了一个非常简单的根据市净率和市盈率指标构建的价值投资策略在美股上的历史表现，可以看到从1929年开始一直到2009年，每一个时间段内，价值投资组合的表现都要比大盘的整体表现要更好，那么这样快100年的规律，同时又是极其简单的策略逻辑和变量，使得人们可以一定程度上相信，价值投资策略确实是可以产生超额收益的。那么如果你进一步深入的去想，价值投资策略究竟赚的什么钱呢？回头我开始讲的第二个问题，就是收益的来源问题，当时提出了两个基本方面，一个是市场的无效或错误定价，一个是风险溢价，那么其实价值投资策略在这两个方面，都可以得到一些论证。<strong>一些被严重低估或高估的股票，一定程度上是市场错误定价的反映，这个是可以用来赚钱的。而价值类策略，在熊市或者市场低迷甚至崩盘的时期表现尤其好，可能体现的是风险溢价，因为当时环境下，整个市场的风险情绪变得非常低迷，绝大多数投资人都变得非常不愿意承担风险，那么这时候你愿意承担一定程度的风险，这种行为可以获得一定程度的风险溢价补偿。</strong></p><img src="https://pic4.zhimg.com/v2-f19ec136d8be6c3715cc9ce5ceb7d0e3_r.jpg" data-rawwidth="640" data-rawheight="357"><p>Reference: Expected Returns, Antti Ilmanen</p><br><p>Carry策略，最常见于外汇交易，利用不同国家货币的利率高低之差进行套利。下面这个图显示的是不同货币的存款利率相对美元的存款利率的差值以及对应的该货币相对美元的超额收益。我们可以清晰的看到一个明显的规律，那就是存款利率相对美元存款利率高的货币，他的收益也相对美元更高，这种现象在中长期时间窗口下过去持续有效，由此验证了carry交易思路的合理性。但是需要强调的是，如果放在不同的时间窗口下看，结果可以大不一样，如果你以一个月或者一周的时间窗口去看，那么carry的表现就没有那么明显和稳定。<strong>Carry</strong><strong>策略的合理性，也可以在逻辑上有明确的解释，所以这样的策略，如果运用得当，设计的巧妙，不失为一种可以长期依赖的好的策略思路之一。</strong></p><img src="https://pic2.zhimg.com/v2-2b59a093dc5086a71c4f8825b0cead7b_r.png" data-rawwidth="638" data-rawheight="304"><p>Reference: Expected Returns, Antti Ilmanen</p><br><p>Trend 策略，在商品期货交易中被提及的最多。大家可以看到下图中商品期货趋势性指数，过去几十年的时间内连续保持了稳定的收益能力，这其实很让人匪夷所思。要知道图中的这个趋势性指数，他的计算方法是完全公开的，是定时公布数值的，可以说是市场公开化的秘密，不存在什么神秘的部分，而且计算方法非常简单，基本上就是根据过去9到12个月不同商品期货的return，做多收益高的，做空收益最低的那些，就这样简单组合而来的。那么这么简单的思路，广为人知的策略，为何连续几十年一直保持了超出市场平均水平或指数的收益呢？为何保持了相对比较好的夏普率呢？这其实不是一个很好回答的问题，有的人尝试在市场无效性角度找理由，有的人尝试用风险溢价的角度去理解，但是都有一定道理但又感觉不是非常充分，这说明这个市场中，还有很多非常普遍和简单的规律，是我们现在的金融学理论，还未能很好的解释的，这也是金融和投资的魅力所在。现在比较流行的是通过市场行为学的角度去理解，<strong>说投资者一般习惯于低估已发生事件的长远影响与意义，而对于这种低估的矫正，又是一个逐渐的过程，有一种心理上的不情愿。还有一点就是投资者往往在发生大额亏损之后反而变得更加激进，而对于小额的亏损反而比较倾向于止损，这样的心态助推了市场中追涨杀跌的效应，从而对趋势形成一种增强。</strong>这都有一定道理，不同的投资者专注不同的方面去理解，那么你理解的角度不同，你做出的趋势交易策略的逻辑也就不同，最后到市场中去检验，怎样的逻辑和策略是更加经得住考验。说到趋势类策略，这里多说几句，趋势类策略，在我看来，难的不是在趋势市场中赚到钱，这个很容易，用两条均线就可以做到。难的是在漫长的没有趋势的市场中，如何控制你的亏损，你不要以为系统里面设了止损就万事无忧了，你也可以连续止损，最后还是亏很多，<strong>这其实是一个中长期最大化收益，与短周期内最小化损失这样两个相互矛盾的目标的优化平衡问题，这个平衡问题做的好，那么你的趋势类策略就基本合格了，做不好，那么收益高的时候可以很高，但是亏得时候一样可以很惨。</strong>一旦你意识到这个问题的存在，那么如何用量化的方法和手段来解决，反而不是太难的事情，这样的优化问题，在数学上是可以很好的定义的，前人也都已经做出了很好的理论来解决，你只需要去找到他就是了，这个工作，对于数理背景很扎实的quant人员，反而不是多么困难的事情。<strong>当然，趋势类策略还有一些细节技巧比如在趋势的中后期，波动率比较高的时候适当降低仓位等等，可以进一步平滑你的收益曲线，提高整体的夏普率等，</strong>这些都是做量化投研工作中的一些细节，细节做得足够好，能够进一步提高你的收益能力。现在专业量化对冲基金公司中的quant,很多的时间也都花在去寻找和处理这些细节上。</p><img src="https://pic1.zhimg.com/v2-56c77c0288788947fced029df8809b82_r.jpg" data-rawwidth="640" data-rawheight="355"><p> Reference: Expected Returns, Antti Ilmanen</p><br><p>波动率策略，在期权市场中最经常被提到。波动率套利，做多波动率，做空波动率，利用期权组合，你可以构建上述各种交易策略。这类策略的好处在于他一般不爆露单边趋势性风险，可以是趋势类策略的很好的补充，但是他也有他的风险。比如做空波动率，或者卖出OTM的期权的策略，在很长时间内可能都是比较稳定盈利的，但是一旦黑天鹅事件发生，你卖出的OTM期权被行权，那么你就面临大额的亏损。这个现象在下图中可以得到明显的体现。比如下面图中这个covered call writing 的策略以及其他几个类似策略，在美股市场从2001年到2007年有着很好的收益曲线，但是在2008年金融危机时，所发生的亏损相当于过去7年收益的总和，相当于过去7年白做了。这个例子就是典型的第二种收益来源，就是<strong>风险溢价</strong>，在平时一直给你很好的风险溢价收益，但是这不是免费的，等到风险来的时候，你会发现这个溢价，其实不便宜。所以说，<strong>评价一个策略不要以为仅仅看看历史收益就可以了，连续七年稳定实盘收益的策略或基金，也可能一朝把你带入死亡之地</strong>，更何况现在国内很多机构评价量化策略的时候，都还拿不到7年的历史实盘业绩，国内产品业绩有3年以上的算不错了，可是7年甚至10年的业绩，都不一定可以完全确保你未来重复这个收益水平。要注意这种现象可不仅仅存在于期权交易市场，其实股票策略，阿尔法策略，CTA策略，都可以有类似的例子，所以大家对这个一定要慎之又慎，这个策略评价问题，远比你想象的要复杂的多。</p><img src="https://pic3.zhimg.com/v2-669386610b7e1b2da936548159ad39bb_r.jpg" data-rawwidth="640" data-rawheight="272"><p> Reference: Expected Returns, Antti Ilmanen</p><br><p>最后在策略风格这个方面，再补充一点的是，上面几个策略种类之所以拿出来讲，就是看重他们的另一个优点：<strong>普适性</strong>。趋势策略不仅可以用于商品，还可以用于股票或债券，Carry策略在股市和期货也可以有对应。有人问carry怎么对应？这个你要发挥一点想象力和举一反三，抓住carry的本质，<strong>你会发现其实</strong><strong>carry</strong><strong>在商品中对应的就是现货和期货，或者近远月期货合约的基差，也就是所谓的升贴水，在股市中，高carry</strong><strong>可以对应为高股息的股票，</strong>那么对应的策略都是可以做出来的，而且在不同市场中都一致性的表现比较好，而且是多年比较稳定的表现，那么这样的策略，就更加让人信任一点，把钱配置到这些策略，会更踏实一些，当然，不同的人做出的策略质量还有区别，都是carry策略，大家水平也都不一样，这才是体现不同对冲基金实力差距的地方。所以说，机构之间比的，有时候往往就是这些策略之间的细节，谁可以把细节做的更好。</p><p>同理，value策略或波动率策略也都可以在股市或商品期货市场中得到很好的实现。比如下图的这个展示，是我们公司针对这四大类策略思路在中国商品期货市场中的应用开发的一些子策略，当然这里的策略没有上面讲的那么简单了，用到了一些更复杂的模型，一些机器学习的算法以及非线性优化，随机优化等等，但是策略的基本逻辑思路，是没有太大的本质区别的，因此，至少我们证明这些经典的策略逻辑思路，在当下仍然是可以被使用的，这个方向是没有问题的，但是随着市场的竞争越来越激烈，对你的模型的技巧水平要求变得越来越高，不过模型的技巧水平这个是可以通过不断学习和实践而提高的，只要方向对了，坚持下去，做出好的模型只是时间问题。但如果你的方向不对，那就麻烦了。</p><img src="https://pic1.zhimg.com/v2-f8d05c45f0a4b0878b6599043bf3a55f_r.jpg" data-rawwidth="557" data-rawheight="287"><p>注：以上图表不构成投资建议，过去表现不能预测未来收益。</p><p>所以说，作为一个普通的投资者， 你至少应该有个基本的概念就是以上几类策略风格，都是什么意思，收益来源都是什么，然后在每个市场大概对应什么思路，有了这些基本的概念，那么当有人再问你期望收益怎么来的时候，你就不至于答不出来了，<strong>你至少有了一个明确的方向，就是知道不同市场中做量化策略你大概先要在哪几个思路上下功夫比较靠谱，</strong>至于最后做的质量如何，这需要知识以及经验的积累，是一个漫长的过程，但是方向走对了，就不怕漫长，就可以一直走下去。否则，你走进了死胡同，比如用一些很高深莫测的数理模型，暴力优化参数得出一些逻辑不通的量化策略，看似回测夏普很高，可是根本无法合理的解释逻辑以及收益的来源，那么这样的策略就算做出来结果再漂亮，也不敢用。而我做一个value，或一个carry策略，方法得当，逻辑不复杂，没有过拟合的话，结果漂亮我的信心会更大一些，因为这是在几十年的历史中，多个市场反复验证有效的东西，而且是逻辑上解释的通的，这就好很多。</p><p>讲完了策略风格和资产类别，大家可能觉得投资这个事情已经够复杂了，需要考虑这么多方面，不过这还不够，还有一个方面就是风险因子，比如上面魔方里面写的那几个因子，增长，通胀，流动性，尾部风险等。策略组合的再好，资产分散化做的再好，尾部风险方面完全没考虑，那么一样可以下场很惨，上个世纪著名的长期资本管理公司，就是一个很好的反面例子。你把过多的赌注压在了尾部风险不出现这上面，那么就会出问题。本来尾部风险没那么高的，这也是为什么稍微朝这方向暴露一些头寸是完全合理的，但是你过于贪心，暴露过多，最后超出了所能承受的范围，就不妥了。再比如说，我们都知道经济增长好的时候，股票收益往往比较好，这时候做股票裸多组合，要比完全中性阿尔法策略组合，收益要高，但是你过于贪心，一直裸多，那么就把过多的风险暴露在经济增长这个不确定的变量上。还有像流动性风险，比如小市值的股票，有时候高的收益体现了流动性溢价，你过于贪求这个溢价，把所有赌注都压在这里，那么一旦市场整体流动性突然大幅降低，你的这个投资组合，将会是受伤最严重的那个，人家持有蓝筹股的，这时候反而不会像你那么惨。所以大家看到，天底下没有免费的午餐，如果市场中有人天天请你吃饭，那这往往不是什么好事，尤其你还理所当然的觉得这是因为自己比较聪明的缘故，那就很危险了。所以说，风险因子方面，也是很重要的一个方面，是需要慎重考虑的，否则，一个看似在资产类别以及投资策略风格方面都已经充分分散化的投资方案，仍然有可能有着隐藏的过多的某种风险，平时不发觉，一旦出问题，就会很严重。而在不同的风险因子上，应该如何选择暴露的倾向和比重呢？我们知道，超额收益往往和风险溢价有关，所以你想完全不暴露任何风险，这是不太现实的，除非你可以接受国债的收益水平。既然风险因子的敞口是一种必然，<strong>那么在没有具体的合理的模型去预测风险因子的水平或度量其变化规律的时候，最好的方式可能就是风险平价，也就是主要的几类风险因子平均暴露，这种保守的方式可能是最好的。</strong>当然，如果你的策略或模型，对于某类风险因子的分析能力非常强大，比如你可以很好的预测市场流动性的变化情况，那么这种情况下，就另当别论，你超比例的在某种风险因子上存在敞口，或许就是可行的，但是也要额外小心，仔细推敲逻辑。</p><img src="https://pic1.zhimg.com/v2-e211c0c9c41f4a80a6d0807b1be51d1b_r.jpg" data-rawwidth="640" data-rawheight="413"><p>Reference: Expected Returns, Antti Ilmanen</p><br><p>如上图所示，可以看到在长期平均来看，流动性越差的资产，期望收益也相对越高，这个例子很好的反映了流动性作为一个风险因子，与期望收益之间的密切关系。有的时候你的投资方案或者组合收益比较高，很可能就是由于在某种风险因子上的敞口比较大而获取的风险溢价，这个是要额外关注的。因此风险因子这一方面，作为投资的三大角度之一，是必不可少的。<br><br></p><p>讲到这里，投资的三面魔方就讲完了。总结一下上述的论述，就是<strong>量化投资方法论的第一个维度，就是要在资产类别，策略风格，风险因子这三大不同角度对投资进行建模与设计，一个成熟的投资方案，一定是同时兼顾了三方面的考虑，在资产类别，策略风格，风险因子上都做到了合理的分散化，并对自己投资组合在这三大方面的风险敞口情况，有着清晰的认识，同时能够很好的理解这三大方面相互之间的交叉影响和整合的。</strong>这里，量化投资可能对于策略风格这个角度挖掘的更深一些，而宏观对冲可能在风险因子上下的功夫更多，而两者都要很仔细的做好资产类别的分散化配置。在这三方面做的越好，越深入，你的投资方案就越能经得起长时间的考验。而且，这样一个切入视角，给了一个量化投资者很好的一个大局观，让你时时刻刻知道你做的每一步，大概在这整个方案中，是在哪个位置，所以说，我把这称之为方法论，应当是不过分的说法。</p><p>接下来要讲的，就是金融投资学的一些基本的模型理论基础。</p><p>从大学起，我们学过的金融学投资学理论，可谓是多如牛毛。每一套理论都有他的价值，但也都有他的缺陷。这里我回顾自己多年来理解的多套金融投资学理论，从中找出了我认为尤其重要，又具有奠基意义的三大理论，作为这一维度的讲解。<strong>这三大理论就是资产定价理论，投资组合理论以及市场有效假说。</strong>上个世界50年代，马科维茨首先提出了一套经典的投资组合最优化理论<strong>，首度突出强调了分散化投资的概念</strong>，并创造性提出理性投资者都应该持有市场最优投资组合这一观点，为之后的资本资产定价理论的提出，做了重要铺垫。现在马科维茨模型已经不怎么被使用来做投资组合了，但是分散化投资的理念被保留下来，而且后续的各种各样的投资组合理论，其实源头都是马科维兹模型，因此他的这个工作，是奠基性的。<strong>投资组合理论，为我们提供了很好的工具，来解决如何在不同资产类别或不同策略之间配置权重的问题。</strong>这是在投资中不可避免的一个问题。如今，先进的投资组合理论已经不再像马科维茨模型那样需要有过于强的假设条件，甚至并不需要你对资产的未来期望收益有一个准确估计（因为这个估计很难，所以基于期望收益准确估计的投资组合理论的实用性都比较差），也可以融合人的主观观点进去等等，像black-litterman model, robust portfolio management, online portfolio theory等等，更有现在结合前沿的机器学习或人工智能模型的优势来进行投资组合最优化的模型，根据你的不同需求，总可以找到你需要的那一款。</p><p>资本资产定价理论，最早源于CAPM模型，最先提出了beta的概念以及阿尔法的概念，为一个资产的期望收益，提供了一个合理的解释与分解，并且这个分解方法是如此的有生命力，以至于到今天，各式各样的smart beta因子，层出不穷，你掌握了别人不知道的smart beta, 那你就相当于有了自己独特的阿尔法因子，可以用来获取超出市场风险调整过后的期望收益水平的超额收益，这简直是所有主动管理者梦寐以求的。如今看来，你可能会觉得CAPM模型过于简单，不就是一个线性回归么。那么其实我觉得你还是没有理解他的深刻意义与深远影响，这不仅仅是一个理论或者一个方程，<strong>他甚至构建了当今社会一种非常主流的投资逻辑与价值观，成为了很多人评价投资方法质量的工具，包括为归因分析等做了铺垫，</strong>因此，做量化投资或者系统化投资的人，你不可能能够绕的过阿尔法与beta，也不能忽视CAPM模型的重要价值，直到今日，它依然为我提供很好的建模切入视角与分析工具。</p><p>市场有效性假说，或许是永远无法被证明或否定的假说，但是这丝毫不妨碍它如今在现代金融学中的核心地位。很多套利交易的逻辑根本点，就是基于有效的市场假设，你的套利交易才有收敛获利的一天。市场如果不是有效，期权定价的black scholes公式就无从谈起，价值投资也就变成了猜硬币的游戏。而同时，市场在某段时间内，局部的相对弱有效性甚至无效性，恰恰是很多量化投资策略的出发点，是获取利润的根本。<strong>很多时候，量化投研工作的相当一部分就是去寻找市场中相对不那么有效的一段时间或一个市场，然后利用这点去套利。</strong>你比如说，由于目前人民币的不可完全自由兑换以及非完全市场汇率体制，导致了国内的商品期货和国外同品种的商品期货之间，经常会出现非常诱人的套利交易空间，也就是所谓的内外盘套利，这就是利用了市场局部的由于某些特殊原因导致的弱有效性，来获取收益。将来一旦人民币汇率完全市场化，人民币实现完全自由兑换，大家都可以同时交易内外盘的时候，那么这种内外盘套利交易的利润空间，肯定就大大降低甚至变得不存在，其实现在这个空间，随着人民币汇改的不断前进，已经在逐渐缩小。</p><p>因此，大家可以看到，上述的这些基本的金融投资学理论，他们的重要性。最原始的模型可能已经无法准确描述市场，但是他们的思路，建模的切入点，仍然是我们宝贵的财富与资源。这些理论的后续衍生模型，往往在量化投资中扮演核心的地位，因此，<strong>量化投资方法论的第二个维度，就是要合理的运用这些经典金融投资学的模型思路与理论工具，用这些工具，这些切入点，来回答你的投资问题，提升你的投资方案或引导你构建自己的投资模型。</strong></p><p>量化投资的第三个维度，我来说说连个重要的载体，一个是数据，一个是人。数据大家都比较重视，做量化整天和数据打交道，在这里我重点强调数据的合理使用，以及常见的错误。首先一点，<strong>是数据的准确性</strong>，这个问题在中国还比较严重。中国的量化投资处于刚刚兴起的状态，很多东西都还比较的原始，像数据保存的重要性以及数据的准确度，这些也都是最近几年才重视起来。2009年以前中国甚至很难找到一份准确完成的商品期货全品种tick数据，更不用说其他的数据比如基本面数据等等。所以这给量化投资工作者提出了很高的挑战。我们团队回国后第一件事就是寻找完整准确的历史数据，我们花了几个月的时间，通过对市面的不同来源的几个版本的tick数据的撮合比较，才最终获得了一份我们觉得可以信任的数据，这中间IT工作人员花费了大量的时间精力，中间有着无数的细节，一言难尽。但是这个工作很重要，是你做好量化的前提，你在这方面偷工减料，绝对不是明智的行为。你的数据都不能保证准确，你做的模型的回测结果如何值得信任呢？你比如说，我们都知道商品期货存在主力合约换月的问题，换月的时候不同月份的合约价格之间肯定是存在一个价差的，这个价差你不管，直接粗暴的把两个不同合约合在一起拼成所谓主力合约，然后用这个主力合约去回测你的模型，那这就要出大问题。我们专门做过测试，找了一个量化的策略，用这种暴力拼接的主力合约回测过去6年的数据，结果是赚钱的，夏普很好，但是我们采用了经我们重新计算和仔细拼接的正确的主力连续合约回测同样的模型，结果是亏钱的，这中间的差别就可以这么大，所以不要以为这是一个小事情。所以说，做量化投资，数据与IT支持是非常重要的。你的数据库质量如何，你的回测系统是否设计的足够精确，是否考虑了交易成本，交易滑点等等，你的服务器是否运维的稳定，一旦机房断电了你的交易怎么处理，程序出错了怎么迅速恢复，灾备系统搞的怎么样，这些细节看似不是关键，但是哪一个环节没做好，都可以产生致命的后果。所以我一直都觉得，一个量化对冲基金团队或公司，看他们的实力或量化的专注程度，不要直盯着模型看，模型人家毕竟不能告诉你太多的细节，但是你可以通过看他们公司的IT团队质量和规模，看他们公司合伙人里面有几个是纯IT背景的，团队中IT工程师的人数比例，就可以侧面反映他们量化投资对细节的把握，专注的态度到一个什么水平。整个公司没有IT合伙人，或者整个团队几十个人，IT工程师角色就两三个人，这样的团队说是专注于做量化，量化做的很好，我其实是怀疑的。因为现实的情况是，根据我们的经验，专业的量化对冲基金，不是策略研发的效率或速度，而是你的IT工作效率和速度，决定了你整个团队量化交易前进的速度，尤其在前几年，更是如此。搞了很多策略，IT执行不过关，问题频频，最后一样赚不到钱。</p><br><p><strong>数据除了准确之外，还要注意的几点就是数据的选取要有充分代表性，时间段选取要足够客观。</strong>比如你回测一个趋势交易策略，如果只拿2015年的股指期货数据来测试，那么结果可能很好，但是我们都知道2015年市场有明显的趋势，这是一段特殊的样本，你还要看看你的模型在2011年，2012年等等年份表现如何。再比如上面讲过的卖出期权的波动率策略，在2001-2007年这七年中表现都非常稳定，但是如果你把2008年考虑进去，发现结论大不一样。还有要注意就是针对数据的结果的推论，一定要逻辑严密，谨防逻辑漏洞。一个策略在一段时间内有效不能推论他在其他时间就有效。<strong>数据的运用要以有效逻辑为根本指导原则，要注意时间周期，样本特殊性等方面的影响，使用方法足够客观，对于得出的结论的推论要足够谨慎。（比如，一个策略或规律在一段数据中统计意义显著也不能保证其一定有效，一个规律在一段时间内成立不代表在任意时间内都成立，在一个品种上有效不如在多个品种上有效。规律的成立不仅要有基于有效数据的统计结果支持，更要有合理的逻辑支持，逻辑上应该可以与文中讨论的市场的三面魔方或三大理论形成联系）</strong></p><p>另一个载体就是人。做量化投资往往容易忽视人在市场中的影响。人的行为可以为数据的分析增添额外的不确定性，这个是要尤其注意的。量化投资策略既要符合数据所揭示的规律，又要符合市场行为学原则。<strong>人的市场行为，既可以是收益之源头，也可以是风险之所附</strong>。人的因素，利用的好，其实可以是你策略收益逻辑的源头，但是如果对其忽略，那么它也可以是你模型潜在的风险所在。这个因为时间关系具体就不展开讲了。</p><p>最后，量化投资的<strong>第四个维度是风险与收益之间的平衡。</strong>有人说刚才不是讲到了风险因子，与期望收益，怎么现在又把他变成单独的维度，是不是重复呢？不是的。要注意我这里讲的风险与收益的平衡，是指在你已经充分考虑了以上几个维度之后，你采用了准确的数据，合理的使用数据，做了很多的子策略，既符合数据的结论与逻辑，又不与市场行为学冲突，你还考虑了资产类别的分散配置，策略风格的组合，风险因子的敞口暴露，那么在这之后，当你每天拿着这套投资系统，处于市场中的时候，你依然每天面临着收益与亏损，你依然要考虑，你今天要把多少的本金投入到你的投资方案中？你如果连续遭遇了10%的净值回撤，该怎么办？最近市场变得特别火爆，每个人都在赚钱，你或许开始考虑是不是你的方案过于保守。你会不会觉得一个散户上个月赚了50%，而经过你精心设计的投资组合方案，上个月只赚了1%，甚至是亏了1%，这样的你觉得特别沮丧或者愚蠢？你开始考虑或许应该更多的配置一些股票，因为最近股市的行情太好了，或者把多空策略改成裸多吧？反正过去六个月你的空头部分一直在亏钱。。这样的问题，还可以有很多，这些问题每天困扰着你，所以不要以为量化投资者，心态上就可以完全摆脱纠结。<strong>这个市场的魅力就在于，无论如何没有人可以摆脱这个心态的抉择，因为无论再完美的模型，都有可能是存在大的漏洞的，都不能让你完全</strong><strong>100%</strong><strong>信任的，而你的亏损带给你负面的情绪，散户的心态，这种心态让你丧失理性，从而放大你对模型的偏见或者让你做出不理智的决策，</strong>而且不要以为你是一个专业的量化投资者，所以永远不会犯这种低级的错误。<strong>其实在强大的市场面前，任何人从根本上讲，都存在变成一个不理性的散户的可能。</strong>就如同来回被割韭菜的散户一样，一个专业的FOF机构投资者，如果来回在子基金之间做“高吸低抛”，仔细想想他又与散户有什么本质区别？在这个意义上，人都是渺小的，我们面对市场，永远都要谦虚。因此，<strong>对于量化投资者的最后一个考验，其实和对市场所有参与者的考验是一样的，就是你的投资价值观，你对收益与风险的平衡把握，既不过于贪婪的追求收益，也不过于恐惧的惧怕风险，</strong>说起来容易啊，做起来很难。因此，投资决策还剩下关键一环，那就是期望收益与风险之间的平衡。</p><p>收益与风险是不可分割的整体，盈亏同源。</p><p>收益与风险之间的平衡没有完全统一的标准或者最优答案，不同投资者的不同选择体现不同的投资价值观。从长期看，对于无法预测的风险，选择风险平价原则或许是目前人类可以做到的最好的理性选择。这恰恰对应了中国哲学智慧所讲的大智若愚，重剑无锋<strong>。过于激进的心态，过于追求技巧的择时或者自作聪明的切换，往往最后适得其反。因为，你要永远记住的是，无论你赚了多少钱，做了多少年，读过多少书，离开了你精心设计的投资方案，在市场中你其实和初入市场的散户，没有什么本质的区别。投资，切记不要做多余的事情。</strong></p><p>最后，做一个总结。一个是策略方案上实盘之前的问题排查，根据上述几个维度，我设计了下面九个问题大家可以参考：</p><p>   数据是否准确可靠，数据使用是否足够客观？</p><p>   数据结论到策略逻辑之间的推论是否严谨而不存在逻辑漏洞？</p><p>   策略逻辑是否合理？是否在不同市场具有一定普适性？</p><p>   期望收益是否可以被合理解释？从资产类别，策略风格，风险因子三大角度进行归因分析，分析结果是否合理并能够反映主要的期望收益？</p><p>   可能的策略失效风险有哪些？</p><p>   策略是否同时考虑了数据与人这两个载体？</p><p>   策略是否合理的平衡了收益与风险？</p><p>   新策略如何添加到原有的策略系统中去？在哪些品种上配置？不同策略之间权重如何决定？</p><p>   未来出现何种情况要果断停止策略的使用？</p><p>第二个总结，是对我讲的量化投资方法论的四大维度总结：<strong>投资要做好三个方面的事：不同策略风格的组合搭配，不同市场资产的分散配置，不同风险因子的合理暴露与搭配，并懂得合理运用这三者之间的联系，全面的构建投资系统。</strong></p><p><strong>资产定价理论体系，投资组合理论体系，有效市场假说，这三大金融学理论框架为投资提供分析方法与建模切入点</strong></p><p><strong>量化投资研究的主要载体有数据和人，要合理的使用数据，分析数据，不要忽视人的因素与行为。</strong></p><p><strong>当上述一切都得到合理的运用，投资决策剩下的事情便是对风险与收益的平衡。打造理性投资价值观，就是做好收益与风险的平衡，然后持之以恒，并心怀敬畏，方可业绩长青。</strong></p><p>我的演讲就到这里，希望能给大家一些启发，谢谢大家！</p><p><b>转载要求（要附上微信： 上海棋剑资产管理有限公司）</b></p><p><b>PS：米筐专业版现已推出，欢迎加微信：RQmimiao 咨询试用。</b></p>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
