<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>【量化课堂】羊驼交易系统</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/23692465">原文</a></p>
<div class="title-image"><img src="https://pic4.zhimg.com/v2-6522c72cf94cd04755844c57d2221c9f_b.jpg" alt=""></div><h2><b>听说我们的神兽草泥马，哦不，羊驼，能选股？</b></h2><p>美国“旧金山纪事报”曾做过大猩猩选股实验，让大猩猩随机挑选出5只股票。发现这个股票组合比《华尔街日报》8位知名分析师精心计算分析挑选的5只股票组合表现还好！2014年甘肃卫视的《马上知道》栏目中，节目组让羊驼随机选择一堆股票进行持仓，然后每天卖掉持有的股票中收益率最差的一只，再买入羊驼随机选择的一只。结果也得到了很可观的收益率！是不是很神奇！</p><p>稍加思考，我们可以发现其实这是一个将<a href="https://link.zhihu.com/?target=https%3A//www.joinquant.com/post/1697%3Ff%3Dzhzl%26m%3D23692465" class=" wrap external" target="_blank" rel="nofollow noreferrer">动量因子</a>和遗传算法（这是啥？）相结合的策略。听上去很高深的样子，别急，我们先来看看什么是遗传算法。</p><br/><br/><h4><strong>物竞天择，适者生存</strong></h4><p>达尔文进化论认为，生物之间存在着生存争斗，适应者生存下来，不适者则被淘汰，这就是自然的选择。而股票市场中也存在这样一种选择，投资者就是大自然。投资者偏好高收益股票，厌恶低收益股票。于是，高收益股票生存下来，低收益股票被淘汰。羊驼算法，就是在一轮轮的竞争中，剔除表现最差的股票，保留表现优异的股票，让优良的基因得以传承。这个表现呢，就用过去一段时间的收益率（动量因子）来刻画。</p><p><strong>羊驼嘛，就羊驼嘛</strong></p><p>绕了这么大一个圈子，终于到了我们的主题。</p><p>羊驼策略，简单来说就是无脑选股，周期性调仓——每次剔除收益率最差的n支股票，买入随机选择的n支。为了让我们的策略是可复现的，我们选择用历史收益率最低的股票来代替随机选股，逻辑嘛：根据<a href="https://link.zhihu.com/?target=https%3A//www.joinquant.com/post/1608%3Ff%3Dzhzl%26m%3D23692465" class=" wrap external" target="_blank" rel="nofollow noreferrer">均值回归</a>的思路，我们买入前期跌幅最大的股票并期待它们的走势会反转。在一个调仓周期之后，当期反转力度最强的股票会被留下，让它继续升值；而反转力度最差的会被卖掉，换成股票池里跌幅最大的。当然，如果持有的股票不仅是持仓内跌幅最大的，并且还是全股票池跌幅最大的，那还是拿着不动吧。</p><p>所以这是一个结合动量和反转的策略，好像有点不伦不类的样子吧，但是它有收益呀有收益！为什么不用动量的方法选股呢你问。我们试了，哈哈哈哈… 在反复调参之后勉强可以跑平大盘！</p><br/><br/><h2><b>策略实现</b></h2><p>    1.设置参数，包括股票池，调仓周期 holdingPeriod (代码中为tc)，收益率计算周期 holdingPeriod (代码中为N)，每次持仓股票数目为 num_stocks ，每次换仓换股数量 change_No等。</p><p>    2.计算股票池和持仓中所有股票的上一周期的收益率:</p><figure><noscript><img src="https://pic4.zhimg.com/v2-addc2cf861866192d5eecd89d3b259ef_b.png" data-rawwidth="566" data-rawheight="78" class="origin_image zh-lightbox-thumb" width="566" data-original="https://pic4.zhimg.com/v2-addc2cf861866192d5eecd89d3b259ef_r.jpg"/></noscript><img src="https://pic4.zhimg.com/v2-addc2cf861866192d5eecd89d3b259ef_b.png" data-rawwidth="566" data-rawheight="78" class="origin_image zh-lightbox-thumb lazy" width="566" data-original="https://pic4.zhimg.com/v2-addc2cf861866192d5eecd89d3b259ef_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-addc2cf861866192d5eecd89d3b259ef_b.png"/></figure><p>    3.将可行股票池内的股票按照上一周期(returnPeriod)收益率排序。将目前持仓股票按照上一周期(holdingPeriod)收益率排序。<br/></p><p>    4.卖出当前持仓中收益率最低的 change_No 支股票，卖出股票得到的现金和原来库存现金等金额买入回测期收益排名最差的 change_No 支股票。如果持仓中的某支股票在持仓中排在收益率最差 change_No 中，同时又在所有可行股票池最差收益率排名 change_No 中，则仅调仓不换股。</p><p>    5.每 holdingPeriod 天进行 Rebalance ，调整持仓中股票到手中所有股票市值/ num_stocks 。</p><p>    对应参数选择为持股20支，每次换取2只，回测期60天，调仓期60天，从2008年10月开始。股票池是沪深300。这个策略还是有比较稳定的超额收益的。</p><figure><noscript><img src="https://pic2.zhimg.com/v2-8192b7409aa16a49431e578198574af5_b.png" data-rawwidth="1253" data-rawheight="349" class="origin_image zh-lightbox-thumb" width="1253" data-original="https://pic2.zhimg.com/v2-8192b7409aa16a49431e578198574af5_r.jpg"/></noscript><img src="https://pic2.zhimg.com/v2-8192b7409aa16a49431e578198574af5_b.png" data-rawwidth="1253" data-rawheight="349" class="origin_image zh-lightbox-thumb lazy" width="1253" data-original="https://pic2.zhimg.com/v2-8192b7409aa16a49431e578198574af5_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-8192b7409aa16a49431e578198574af5_b.png"/></figure><h2><strong>回测结果与改进空间：</strong></h2><p>1、 以回测期内收益最低购买是均值回归的思想，但是我们还可以结合各股其他指标判断来更精准地选择股票。<br/>2、 本策略中收益走势与大盘较为一致，可以结合大盘走势分析进行择时，避免熊市带来的亏损；当然也可以卖空股指期货进行对冲。</p><br/><h2><strong>函数和变量说明书：</strong></h2><p>函数说明书</p><figure><noscript><img src="https://pic3.zhimg.com/v2-fc0708b568ae3b3466021ca5eb2ad076_b.png" data-rawwidth="1342" data-rawheight="694" class="origin_image zh-lightbox-thumb" width="1342" data-original="https://pic3.zhimg.com/v2-fc0708b568ae3b3466021ca5eb2ad076_r.jpg"/></noscript><img src="https://pic3.zhimg.com/v2-fc0708b568ae3b3466021ca5eb2ad076_b.png" data-rawwidth="1342" data-rawheight="694" class="origin_image zh-lightbox-thumb lazy" width="1342" data-original="https://pic3.zhimg.com/v2-fc0708b568ae3b3466021ca5eb2ad076_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-fc0708b568ae3b3466021ca5eb2ad076_b.png"/></figure><p>变量说明书</p><figure><noscript><img src="https://pic3.zhimg.com/v2-a31ee04afefd8de5c29816960feb5e1e_b.png" data-rawwidth="926" data-rawheight="543" class="origin_image zh-lightbox-thumb" width="926" data-original="https://pic3.zhimg.com/v2-a31ee04afefd8de5c29816960feb5e1e_r.jpg"/></noscript><img src="https://pic3.zhimg.com/v2-a31ee04afefd8de5c29816960feb5e1e_b.png" data-rawwidth="926" data-rawheight="543" class="origin_image zh-lightbox-thumb lazy" width="926" data-original="https://pic3.zhimg.com/v2-a31ee04afefd8de5c29816960feb5e1e_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-a31ee04afefd8de5c29816960feb5e1e_b.png"/></figure><p>到JoinQuant查看策略并与作者交流讨论：<a class=" wrap external" href="https://link.zhihu.com/?target=https%3A//www.joinquant.com/post/3423%3Ff%3Dzhzl%26m%3D23692465" target="_blank" rel="nofollow noreferrer">【量化课堂】羊驼交易系统</a></p>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
