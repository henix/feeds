<h2>公钥加密</h2><p class="ztext-empty-paragraph"><br/></p><p>安全密钥分发由公钥密码系统解决，因为它不需要您和室友之间进行安全的初始密钥协商。公钥密码系统也称为非对称密钥加密 - 与对称密钥相反 - 使用一对密钥（两个独立的密钥）：用于加密的公钥和用于解密的私钥（也称为秘钥）。由公钥无法推导出私钥。</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-ea2602ef50f275dd83df0193be05d34d_b.png" data-caption="" data-size="normal" data-rawwidth="370" data-rawheight="58" class="content_image" width="370"/></noscript><img src="https://pic2.zhimg.com/v2-ea2602ef50f275dd83df0193be05d34d_b.png" data-caption="" data-size="normal" data-rawwidth="370" data-rawheight="58" class="content_image lazy" width="370" data-actualsrc="https://pic2.zhimg.com/v2-ea2602ef50f275dd83df0193be05d34d_b.png"/></figure><p>我们可以将非对称密钥密码系统与电子邮件帐户进行类比。任何人可以访问您的电子邮件地址（例如，任何人都可以通过your@email.com向您发送电子邮件），但您是唯一拥有登录密码的人（这意味着只有您可以阅读电子邮件的内容）。公钥是您的电子邮件地址，私钥是与您的电子邮件地址登录的密码。<br/> <br/> </p><p>它是如何运作的：</p><p>第1步：创建一对私钥 - 公钥（稍后我们将讨论生成密钥对）。</p><p> 第2步：与朋友分享您的公钥。</p><p> 第3步：发件人使用您的公钥加密明文（原始邮件+加密=密文）。</p><p> 第4步：发件人向您发送密文。</p><p> 第5步：使用您的私钥解密密文（密文+解密=原始消息）。</p><p> 优点：增加了便利性和安全性。</p><p> 缺点：加密速度慢。所有公钥 - 私钥都容易受到暴力攻击（这可以通过选择加大密钥大小来避免）。您无法验证合作伙伴的身份（易受冒充）。</p><p>用法：由于增长密钥大小会产生过大的加密消息输出，因此加密和传输消息需要更长的时间。出于实践目的，公共密钥优先用于短消息加密，例如发送私钥或数字证书，而不是加密长消息。不方便的是，较短的密钥长度提供较低的安全性，但是在加密消息长度或传输时间方面，您是赢家。因此，密钥应经常更换。</p><h2>RSA</h2><p>RSA是以Rivest，Shamir和Adleman3人的首字母命名，是使用前一段中描述的Diffie-Hellman(密钥交换算法)方法，是公钥密码系统的下一步。该算法基于大整数难以分解的事实。</p><p> 我会在我假设你喜欢数学之前逐步解释RSA算法:)</p><p>首先你应该知道mod（模运算）和互质整数。</p><p> 欧拉定理(<a href="https://link.zhihu.com/?target=https%3A//en.wikipedia.org/wiki/Euler%27s_theorem" class=" wrap external" target="_blank" rel="nofollow noreferrer">Euler’s theorem</a>)：</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-34e7c6253a5e114e298261bd1c0f0139_b.jpg" data-caption="" data-size="normal" data-rawwidth="259" data-rawheight="44" class="content_image" width="259"/></noscript><img src="https://pic2.zhimg.com/v2-34e7c6253a5e114e298261bd1c0f0139_b.jpg" data-caption="" data-size="normal" data-rawwidth="259" data-rawheight="44" class="content_image lazy" width="259" data-actualsrc="https://pic2.zhimg.com/v2-34e7c6253a5e114e298261bd1c0f0139_b.jpg"/></figure><p class="ztext-empty-paragraph"><br/></p><p>其中phi（z）是欧拉函数( Euler&#39;s totient function)，z是正整数。</p><p>简而言之，欧拉函数将与z互质的个数记为phi（z）。如果z是素数，那么phi（z）= z-1（*）。</p><p>例子:</p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-1cc0d6f59d080455537fb68a08693943_b.jpg" data-caption="" data-size="normal" data-rawwidth="381" data-rawheight="303" class="content_image" width="381"/></noscript><img src="https://pic4.zhimg.com/v2-1cc0d6f59d080455537fb68a08693943_b.jpg" data-caption="" data-size="normal" data-rawwidth="381" data-rawheight="303" class="content_image lazy" width="381" data-actualsrc="https://pic4.zhimg.com/v2-1cc0d6f59d080455537fb68a08693943_b.jpg"/></figure><p>让我们继续欧拉定理:</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-74267b9c730653bb3e811ef9a5b807fc_b.jpg" data-caption="" data-size="normal" data-rawwidth="580" data-rawheight="132" class="origin_image zh-lightbox-thumb" width="580" data-original="https://pic1.zhimg.com/v2-74267b9c730653bb3e811ef9a5b807fc_r.jpg"/></noscript><img src="https://pic1.zhimg.com/v2-74267b9c730653bb3e811ef9a5b807fc_b.jpg" data-caption="" data-size="normal" data-rawwidth="580" data-rawheight="132" class="origin_image zh-lightbox-thumb lazy" width="580" data-original="https://pic1.zhimg.com/v2-74267b9c730653bb3e811ef9a5b807fc_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-74267b9c730653bb3e811ef9a5b807fc_b.jpg"/></figure><p class="ztext-empty-paragraph"><br/></p><p>使用数学归纳法我们可以证明：</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-dca3f3c1cbbd74ca594e54762e7b3d04_b.jpg" data-caption="" data-size="normal" data-rawwidth="541" data-rawheight="94" class="origin_image zh-lightbox-thumb" width="541" data-original="https://pic1.zhimg.com/v2-dca3f3c1cbbd74ca594e54762e7b3d04_r.jpg"/></noscript><img src="https://pic1.zhimg.com/v2-dca3f3c1cbbd74ca594e54762e7b3d04_b.jpg" data-caption="" data-size="normal" data-rawwidth="541" data-rawheight="94" class="origin_image zh-lightbox-thumb lazy" width="541" data-original="https://pic1.zhimg.com/v2-dca3f3c1cbbd74ca594e54762e7b3d04_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-dca3f3c1cbbd74ca594e54762e7b3d04_b.jpg"/></figure><p class="ztext-empty-paragraph"><br/></p><p>这意味着数字x的指数幂为phi（z）+1时，结果是返回自身。</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-4b8f2b2d53bd79029404dcee343a4050_b.png" data-caption="" data-size="normal" data-rawwidth="185" data-rawheight="64" class="content_image" width="185"/></noscript><img src="https://pic1.zhimg.com/v2-4b8f2b2d53bd79029404dcee343a4050_b.png" data-caption="" data-size="normal" data-rawwidth="185" data-rawheight="64" class="content_image lazy" width="185" data-actualsrc="https://pic1.zhimg.com/v2-4b8f2b2d53bd79029404dcee343a4050_b.png"/></figure><p class="ztext-empty-paragraph"><br/></p><p>从（*）方程和欧拉定理，我们得到</p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-abed9e0a9179bebe05975b781448a79a_b.jpg" data-caption="" data-size="normal" data-rawwidth="314" data-rawheight="81" class="content_image" width="314"/></noscript><img src="https://pic3.zhimg.com/v2-abed9e0a9179bebe05975b781448a79a_b.jpg" data-caption="" data-size="normal" data-rawwidth="314" data-rawheight="81" class="content_image lazy" width="314" data-actualsrc="https://pic3.zhimg.com/v2-abed9e0a9179bebe05975b781448a79a_b.jpg"/></figure><p class="ztext-empty-paragraph"><br/></p><p>到目前为止，我们对RSA一无所知。现在是时候把所有这些方程联系起来了。</p><p>我们假设两个素数p，q。用p * q替换z。</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-448a4ae9bd59223058f67708d9978c1d_b.jpg" data-caption="" data-size="normal" data-rawwidth="624" data-rawheight="108" class="origin_image zh-lightbox-thumb" width="624" data-original="https://pic2.zhimg.com/v2-448a4ae9bd59223058f67708d9978c1d_r.jpg"/></noscript><img src="https://pic2.zhimg.com/v2-448a4ae9bd59223058f67708d9978c1d_b.jpg" data-caption="" data-size="normal" data-rawwidth="624" data-rawheight="108" class="origin_image zh-lightbox-thumb lazy" width="624" data-original="https://pic2.zhimg.com/v2-448a4ae9bd59223058f67708d9978c1d_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-448a4ae9bd59223058f67708d9978c1d_b.jpg"/></figure><p class="ztext-empty-paragraph"><br/></p><p>从等式（**）与K = 1和等式（***）我们得到：</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-a09a8d9a444b975bd04c5a7bbe6d9ed0_b.jpg" data-caption="" data-size="normal" data-rawwidth="375" data-rawheight="67" class="content_image" width="375"/></noscript><img src="https://pic1.zhimg.com/v2-a09a8d9a444b975bd04c5a7bbe6d9ed0_b.jpg" data-caption="" data-size="normal" data-rawwidth="375" data-rawheight="67" class="content_image lazy" width="375" data-actualsrc="https://pic1.zhimg.com/v2-a09a8d9a444b975bd04c5a7bbe6d9ed0_b.jpg"/></figure><p class="ztext-empty-paragraph"><br/></p><p>这意味着只有当我们可以分解p * q数时，我们才能找到（p-1）*（q-1）+1。将x视为消息。我们可以选择一个随机素数E（加密密钥），它必须是（p-1）*（q-1）的互质。然后我们计算D（解密密钥）为：</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-97d59f57ce7eaba69d101dcb33576894_b.png" data-caption="" data-size="normal" data-rawwidth="287" data-rawheight="38" class="content_image" width="287"/></noscript><img src="https://pic1.zhimg.com/v2-97d59f57ce7eaba69d101dcb33576894_b.png" data-caption="" data-size="normal" data-rawwidth="287" data-rawheight="38" class="content_image lazy" width="287" data-actualsrc="https://pic1.zhimg.com/v2-97d59f57ce7eaba69d101dcb33576894_b.png"/></figure><p class="ztext-empty-paragraph"><br/></p><p>其中D是mod的逆。<br/>现在我们可以使用RSA算法，因为我们有公钥（E）和私钥（D）：</p><p>如果结果密文^ E &lt;p * q，则存在针对RSA基于指数E和密文的短的弱点攻击。建议使用更长的密钥加密。</p><p class="ztext-empty-paragraph"><br/></p><p class="ztext-empty-paragraph"><br/></p><p class="ztext-empty-paragraph"><br/></p><p>==========================================================================</p><p><b>文章首发在微信公众号：btc201800</b> <b>知识星球ID：28018093</b></p><p><b>音频发布在喜马拉雅上“区块链杂谈 (第2季)”</b> <b><a href="https://link.zhihu.com/?target=http%3A//xima.tv/Bjq4se" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">http://</span><span class="visible">xima.tv/Bjq4se</span><span class="invisible"></span></a></b></p><p><b>解读区块链白皮书</b> <a href="https://link.zhihu.com/?target=http%3A//xima.tv/RNU1Q8" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">http://</span><span class="visible">xima.tv/RNU1Q8</span><span class="invisible"></span></a></p><p><b>宁波格密链网络科技有限公司，专注于区块链上的密码技术研发。</b></p>