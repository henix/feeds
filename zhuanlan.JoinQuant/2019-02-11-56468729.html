<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>VIF方法（方差膨胀因子）因子独立性检验 全流程解读</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/56468729">原文</a></p>
<div class="title-image"><img src="https://pic1.zhimg.com/v2-609133a58aa34160c4201d9e306659e2_b.jpg" alt=""></div><p>       基于因子模型的选股策略是股票市场量化应用最广泛的模型之一。然而很多时候，使用因子模型在实盘运行的绩效并不理想，究其原因可能是由于因子选择的偏差，市场风格轮动等。但还有一个显著的因素，就是选取因子之间可能存在高度的多重共线性，导致模型对股票价格与市场的解释能力存在很大偏误。</p><p class="ztext-empty-paragraph"><br/></p><p>      为了在筛选因子之初就避免陷入这样的误区。本文介绍一种VIF（方差膨胀检验）方法，<b>来对因子之间的线性相关关系进行检验</b>，从而帮助投资者们在可以选取到独立性更好的因子，增强因子模型的解释能力。</p><p class="ztext-empty-paragraph"><br/></p><p class="ztext-empty-paragraph"><br/></p><h2><b>一、方法介绍</b></h2><p class="ztext-empty-paragraph"><br/></p><p class="ztext-empty-paragraph"><br/></p><p>　　所谓VIF方法，计算难度并不高。在线性回归方法里，应用最广泛的就是最小二乘法（OLS），只不过<b>我们对每个因子，用其他Ｎ个因子进行回归解释。</b></p><p class="ztext-empty-paragraph"><br/></p><p>　　其中有一个检验模型解释能力的检验统计指标为R^2（样本可决系数），R^2的大小决定了解释变量对因变量的解释能力。而为了检验因子之间的线性相关关系，我们可以通过OLS对单一因子和解释因子进行回归，然后如果其R^2较小，说明此因子被其他因子解释程度较低，线性相关程度较低。</p><p class="ztext-empty-paragraph"><br/></p><p>　　注：之所以不使用协方差计算相关性是由于协方差难以应用在多元线性相关情况下。给出VIF计算方法：</p><p class="ztext-empty-paragraph"><br/></p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-540e72c23a47f18c952b21b192b309a1_b.jpg" data-caption="" data-size="normal" data-rawwidth="224" data-rawheight="69" class="content_image" width="224"/></noscript><img src="https://pic2.zhimg.com/v2-540e72c23a47f18c952b21b192b309a1_b.jpg" data-caption="" data-size="normal" data-rawwidth="224" data-rawheight="69" class="content_image lazy" width="224" data-actualsrc="https://pic2.zhimg.com/v2-540e72c23a47f18c952b21b192b309a1_b.jpg"/></figure><p class="ztext-empty-paragraph"><br/></p><p class="ztext-empty-paragraph"><br/></p><p>从上文很容易看出，VIF越高解释变量和因变量之间线性相关性就越强。</p><p class="ztext-empty-paragraph"><br/></p><p class="ztext-empty-paragraph"><br/></p><h2><b>二、检验实践</b></h2><p class="ztext-empty-paragraph"><br/></p><p class="ztext-empty-paragraph"><br/></p><p>　　数据来源：聚宽量化平台投资研究板块</p><p>　　选取因子：EPS（每股收益），</p><p>　　ROE（净资产收益率），</p><p>　　market_cap（市值），</p><p>　　pb（市净率），</p><p>　　&#39;net_profit_ratio&#39;（销售净利率），</p><p>　　&#39;gross_income_ratio&#39;，（销售毛利率）</p><p>　　&#39;quick_ratio&#39;，（速动比率）</p><p>　　&#39;current_ratio&#39;（流动比率(单季度)）</p><p>　　（后面四个因子来源于聚宽因子库）</p><p class="ztext-empty-paragraph"><br/></p><p> 时间窗口选取：2012.3.4—2018.7.4</p><p> 回望频率：两个月检</p><p class="ztext-empty-paragraph"><br/></p><p class="ztext-empty-paragraph"><br/></p><p>1. 获取数据：（鉴于篇幅仅展示2012-03-04当日前十支股票相关因子数据）</p><p class="ztext-empty-paragraph"><br/></p><p class="ztext-empty-paragraph"><br/></p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-73f49669a76945ba59395649dad89e36_b.jpg" data-caption="" data-size="normal" data-rawwidth="558" data-rawheight="220" class="origin_image zh-lightbox-thumb" width="558" data-original="https://pic3.zhimg.com/v2-73f49669a76945ba59395649dad89e36_r.jpg"/></noscript><img src="https://pic3.zhimg.com/v2-73f49669a76945ba59395649dad89e36_b.jpg" data-caption="" data-size="normal" data-rawwidth="558" data-rawheight="220" class="origin_image zh-lightbox-thumb lazy" width="558" data-original="https://pic3.zhimg.com/v2-73f49669a76945ba59395649dad89e36_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-73f49669a76945ba59395649dad89e36_b.jpg"/></figure><p class="ztext-empty-paragraph"><br/></p><p class="ztext-empty-paragraph"><br/></p><p>2. 缺失值检验：（鉴于篇幅仅展示2013-03-04当日检验情况）<br/></p><p>返回0代表无缺失值，返回其他数字代表缺失值数量</p><p class="ztext-empty-paragraph"><br/></p><p class="ztext-empty-paragraph"><br/></p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-4ee009957493f1237ae0498702bf367e_b.jpg" data-caption="" data-size="normal" data-rawwidth="334" data-rawheight="167" class="content_image" width="334"/></noscript><img src="https://pic3.zhimg.com/v2-4ee009957493f1237ae0498702bf367e_b.jpg" data-caption="" data-size="normal" data-rawwidth="334" data-rawheight="167" class="content_image lazy" width="334" data-actualsrc="https://pic3.zhimg.com/v2-4ee009957493f1237ae0498702bf367e_b.jpg"/></figure><p class="ztext-empty-paragraph"><br/></p><p class="ztext-empty-paragraph"><br/></p><p>3. 被检验两两因子间线性相关性预了解（图例，鉴于篇幅仅展示2013-03-04当日检验情况）</p><p class="ztext-empty-paragraph"><br/></p><p class="ztext-empty-paragraph"><br/></p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-98ba9072e196b7bfd04f337616cfc09e_b.jpg" data-caption="" data-size="normal" data-rawwidth="750" data-rawheight="1891" class="origin_image zh-lightbox-thumb" width="750" data-original="https://pic3.zhimg.com/v2-98ba9072e196b7bfd04f337616cfc09e_r.jpg"/></noscript><img src="https://pic3.zhimg.com/v2-98ba9072e196b7bfd04f337616cfc09e_b.jpg" data-caption="" data-size="normal" data-rawwidth="750" data-rawheight="1891" class="origin_image zh-lightbox-thumb lazy" width="750" data-original="https://pic3.zhimg.com/v2-98ba9072e196b7bfd04f337616cfc09e_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-98ba9072e196b7bfd04f337616cfc09e_b.jpg"/></figure><p class="ztext-empty-paragraph"><br/></p><p>                             案例图表示，各因子对市值因子market_cap的解释能力</p><p>                                   蓝色阴影部分，是回归直线斜率95%的置信区间</p><p class="ztext-empty-paragraph"><br/></p><p>4. 计算并获取每个时点下被解释因子与其余7个因子之间的回归VIF值，绘制时间序列图</p><p class="ztext-empty-paragraph"><br/></p><p class="ztext-empty-paragraph"><br/></p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-629a08c897d5957ea6b7656d27d96a9a_b.jpg" data-caption="" data-size="normal" data-rawwidth="424" data-rawheight="566" class="origin_image zh-lightbox-thumb" width="424" data-original="https://pic3.zhimg.com/v2-629a08c897d5957ea6b7656d27d96a9a_r.jpg"/></noscript><img src="https://pic3.zhimg.com/v2-629a08c897d5957ea6b7656d27d96a9a_b.jpg" data-caption="" data-size="normal" data-rawwidth="424" data-rawheight="566" class="origin_image zh-lightbox-thumb lazy" width="424" data-original="https://pic3.zhimg.com/v2-629a08c897d5957ea6b7656d27d96a9a_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-629a08c897d5957ea6b7656d27d96a9a_b.jpg"/></figure><p class="ztext-empty-paragraph"><br/></p><p class="ztext-empty-paragraph"><br/></p><p>　　分别是百分比堆积图，和绝对数值图（柱状图）。通过百分比堆积图可以看出，各因子的VIF值全程比较稳定，所以其占据总体的百分比也稳定。柱状图可以看出各因子值细节，各位读者可以去聚宽克隆该研究，即可看到更清晰图片。</p><p class="ztext-empty-paragraph"><br/></p><p>5. 全段测试计算时间内，各因子VIF值均值，比较大小（图例）</p><p class="ztext-empty-paragraph"><br/></p><p class="ztext-empty-paragraph"><br/></p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-a5a18cb0de066555d886182e91f110d7_b.jpg" data-caption="" data-size="normal" data-rawwidth="452" data-rawheight="290" class="origin_image zh-lightbox-thumb" width="452" data-original="https://pic4.zhimg.com/v2-a5a18cb0de066555d886182e91f110d7_r.jpg"/></noscript><img src="https://pic4.zhimg.com/v2-a5a18cb0de066555d886182e91f110d7_b.jpg" data-caption="" data-size="normal" data-rawwidth="452" data-rawheight="290" class="origin_image zh-lightbox-thumb lazy" width="452" data-original="https://pic4.zhimg.com/v2-a5a18cb0de066555d886182e91f110d7_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-a5a18cb0de066555d886182e91f110d7_b.jpg"/></figure><p class="ztext-empty-paragraph"><br/></p><p class="ztext-empty-paragraph"><br/></p><p>6. 相比而言quick_ratio这一因子的VIF在窗口期平均值较低，因而这就提示了我们如果在构建因子模型时，采用其余其中因子时可以考虑添加这一因子，增强模型的解释能力。</p><p class="ztext-empty-paragraph"><br/></p><p class="ztext-empty-paragraph"><br/></p><h2><b>三、方法总结与体会</b></h2><p class="ztext-empty-paragraph"><br/></p><p class="ztext-empty-paragraph"><br/></p><p>　　使用VIF进行检验的方法主要为，对某一因子和其余因子进行回归，得到R^2，计算VIF，剔除因子中VIF高的因子，保留VIF较低的因子，以此类推，直到得到一个相关性较低的因子组合来增强模型的解释能力。</p><p class="ztext-empty-paragraph"><br/></p><p>　　在实际测试过程中，并非要指定一个VIF阈值，比如某因子的VIF值超过阈值才剔除，而是通过观察所有因子值的VIF值，<b>如果发现该值较大（显著离群），剔除该因子即可。</b>本次我们的几个因子表现都非常出色，VIF值稳定且没有离群较大值，因此，没能找到任何一个需要剔除的因子。</p><p class="ztext-empty-paragraph"><br/></p><a href="https://link.zhihu.com/?target=https%3A//www.joinquant.com/post/16256" data-draft-node="block" data-draft-type="link-card" class=" wrap external" target="_blank" rel="nofollow noreferrer">VIF方法因子独立性检验 - point:21 - JoinQuant</a><p></p>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
