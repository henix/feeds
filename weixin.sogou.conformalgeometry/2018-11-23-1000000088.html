<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>深度学习和几何（演讲提要）</title>
</head>
<body>
<p><a href="https://mp.weixin.qq.com/s?timestamp=1557315702&amp;src=3&amp;ver=1&amp;signature=PeoRXAkXYf6fFAL3RfcSDP-V6mJjrWuRhd5nnV7Yd81Z3K9uKCDzz8yQpJi8sz6nbQic7zafqPywGxs2gLRRAoZxFFaDrEcYdqvvjy12nrUqsvvTYeMFf0kR8EXCM1WzZIek9cqzazPAMyDYU5I9jtdNOETtQYRPDrDlEmQzRn4=">原文</a></p>
<div id="js_top_ad_area" class="top_banner"></div><div class="rich_media_inner">

        
        
        <div id="page-content" class="rich_media_area_primary">
          <div class="rich_media_area_primary_inner">
                                    
                        

            <div id="img-content">

                
                <h2 class="rich_media_title" id="activity-name">
                    
                    
                    深度学习和几何（演讲提要）

                                                                                </h2>
                <div id="meta_content" class="rich_media_meta_list">
                                                            <span id="copyright_logo" class="rich_media_meta rich_media_meta_text meta_tag_text">原创：</span>
                                                            <span class="rich_media_meta rich_media_meta_text">
                                                <span id="js_author_name" class="rich_media_meta_link" data-rewardsn="" data-timestamp="" data-canreward="0">顾险峰</span>
                                            </span>
                                        
                                       
                                                                    
                                        <span class="rich_media_meta rich_media_meta_nickname" id="profileBt">
                      <a href="javascript:void(0);" id="js_name">
                        老顾谈几何                      </a>
                      <div id="js_profile_qrcode" class="profile_container" style="display:none;">
                          <div class="profile_inner">
                              <strong class="profile_nickname">老顾谈几何</strong>
                              <img class="profile_avatar" id="js_profile_qrcode_img" src="" alt="">

                              <p class="profile_meta">
                              <label class="profile_meta_label">微信号</label>
                              <span class="profile_meta_value">conformalgeometry</span>
                              </p>

                              <p class="profile_meta">
                              <label class="profile_meta_label">功能介绍</label>
                              <span class="profile_meta_value">讲解、传播现代几何理论、计算方法和实际应用。理论包括代数拓扑，微分几何，黎曼面理论，偏微分方程，代数几何，复几何等等；计算方法包括计算拓扑，计算共形几何，离散曲率流等等；应用包括计算机图形学，视觉，网络，几何建模，可视化和医学图像等等。</span>
                              </p>
                              
                          </div>
                          <span class="profile_arrow_wrp" id="js_profile_arrow_wrp">
                              <i class="profile_arrow arrow_out"></i>
                              <i class="profile_arrow arrow_in"></i>
                          </span>
                      </div>
                    </span>


                    <em id="publish_time" class="rich_media_meta rich_media_meta_text"></em>





                </div>
                
                
                
                
                                                
                                                                
                                
                
                <div class="rich_media_content " id="js_content">
                    

                    

                    
                    
                    <p>感恩节来临，生活节奏终于缓慢下来。纽约长岛天空一片湛蓝，艳阳高照，满地碎金。这一阶段，老顾收到很多读者来信，大多询问深度学习和最优传输理论的关系，很多问题反映出读者的深度思考和独特见解。恰逢老顾也在研究生课堂上为学生们讲解深度学习的几何观点，最近也在世界各地给了很多相关的演讲。目前正是生成对抗模型理论迅猛发展阶段，也是深度学习算法和硬件迅速演化阶段。老顾倾向认为最优传输理论对于深度学习中的生成模型给出了迄今为止最为严格的理论解释，并对未来的发展有一定指导作用。最优传输理论（Optimal Mass Transportation ），凸几何（Convex Geometry），蒙日-安培方程（Monge-Ampere Equation）的交汇给出了生成模型的几何观点。为此，老顾求教于世界上这一领域的知名数学家，向丘成桐先生请教蒙日-安培方程和Alexandrov理论，和Villani探讨最优传输的Brenier理论和GAN的关系，向汪徐家先生请教蒙日-安培方程解的正则性和Alexadrov逼近的收敛阶[5]。老顾也鼓励身边的年轻人投身到这一研究方向，深入理解最优传输理论，下苦功取得工程突破。</p><p><br></p><p>目前，老顾在哈佛大学的数学科学和应用中心负责人工智能方面的研究工作。诚聘博士后，有意愿者，请和老顾联系（gu@cmsa.fas.harvard.edu）。</p><p><br></p><p>最近，老顾在世界各地给出了一些演讲，主题是深度学习的几何观点，下面将这几次演讲的内容简略记录一下。相信的数学推导，可以参看以前的系列文章，<a href="http://mp.weixin.qq.com/s?__biz=MzA3NTM4MzY1Mg==&amp;mid=2650814452&amp;idx=1&amp;sn=3312f0134032a3094eb9c4043842f547&amp;chksm=8485c1ffb3f248e9ed87461245eef145ebf0be348158625985d49a9c57c9d8d3340e624d190e&amp;scene=21#wechat_redirect" target="_blank">深度学习的几何观点</a>，<a href="http://mp.weixin.qq.com/s?__biz=MzA3NTM4MzY1Mg==&amp;mid=2650814456&amp;idx=1&amp;sn=1f0dc7373488347077d54603b765dff3&amp;chksm=8485c1f3b3f248e5b4e86ba8193c3b35d0c24f1ec315a104c08a50ae3661b9e0c94a6b3fe56f&amp;scene=21#wechat_redirect" target="_blank">学习能力上限</a>，<a href="http://mp.weixin.qq.com/s?__biz=MzA3NTM4MzY1Mg==&amp;mid=2650814467&amp;idx=1&amp;sn=34fc910c894d6d895302fac9d26e2c70&amp;chksm=8485ce08b3f2471e4cdd2a082f3c1d1e95d77551ae6771248eb4876c344d844939d832d8f55a&amp;scene=21#wechat_redirect" target="_blank">概率变换观点</a>，<a href="http://mp.weixin.qq.com/s?__biz=MzA3NTM4MzY1Mg==&amp;mid=2650814550&amp;idx=1&amp;sn=66a08a800bbcc07a545f7dee06c2de50&amp;chksm=8485ce5db3f2474bd4744a6a712ecab3b15dbc36ae8e13c374a9ed575d6445fc6263a4cc880f&amp;scene=21#wechat_redirect" target="_blank">蒙日-安培方程</a>。</p><section class="" label="Copyright © 2015 Yead All Rights Reserved." style='white-space: normal;max-width: 100%;color: rgb(51, 51, 51);font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 17px;letter-spacing: 0.544px;text-align: justify;background-color: rgb(255, 255, 255);box-sizing: border-box !important;overflow-wrap: break-word !important;'><section style="margin-right: auto;margin-left: auto;max-width: 100%;text-align: center;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="margin-right: auto;margin-left: auto;max-width: 100%;overflow: hidden;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="margin-top: 0.5em;margin-bottom: 0.5em;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="max-width: 100%;border-width: medium;border-style: none;border-color: currentcolor;line-height: 1.5em;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section class="" label="Copyright © 2015 Yead All Rights Reserved." style="margin: 5px auto;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="margin-right: auto;margin-left: auto;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="margin-right: auto;margin-left: auto;max-width: 100%;overflow: hidden;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="margin-top: 0.5em;margin-bottom: 0.5em;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="max-width: 100%;border-width: medium;border-style: none;border-color: currentcolor;line-height: 1.5em;box-sizing: border-box !important;overflow-wrap: break-word !important;"><p style="margin-top: 5px;margin-bottom: 25px;padding: 8px 23px;max-width: 100%;min-height: 1em;border-radius: 10px;color: rgb(34, 34, 34);border-top: 5px solid rgb(0, 88, 156);border-bottom: 5px solid rgb(0, 88, 156);display: inline-block;line-height: 1.75em;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;font-size: 18px;color: rgb(63, 63, 63);box-sizing: border-box !important;overflow-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(0, 128, 255);line-height: 21.4px;font-family: 宋体;box-sizing: border-box !important;overflow-wrap: break-word !important;">基本假设</span></strong></span></p></section></section></section></section></section></section></section></section></section></section><p>近些年来，深度学习方法摧枯拉朽般地超越了传统方法，我们认为基于统计的深度学习方法的成功是因为如下的两个数据分布规律：</p><p><br></p><p><span style="color: rgb(0, 82, 255);"><em>流形分布律</em></span><em>（law of manifold distribution）</em>：在高维背景空间中，特定类的真实数据分布靠近某个低维流形；</p><p><span style="color: rgb(0, 82, 255);"><em>聚类分布律</em></span><em>（law of cluster distribution）</em>：同一类数据中的不同子类，对应于流形上不同的概率分布；并且这些概率分布之间的距离足够远，使得这些子类可以被区分。</p><p><br></p><p>比如，我们考察所有的128乘128的彩色图像，所有这样的图像构成了<img class="" data-ratio="0.1326530612244898" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30genk5rj65socg1wAZMCVMrktrLaATTyEgpRVe2SqJwfkSR0L3ckLUXzJDRlCjVacYF2bHGh4vwKjbw/640?wx_fmt=gif" data-type="gif" data-w="98">维欧氏空间中的一个单位立方体，我们称之为<span style="color: rgb(0, 82, 255);">图像空间（image space）</span>或者<span style="color: rgb(0, 82, 255);">背景空间（Ambient space）</span>。大多数图像并没有实际的物理意义，我们只对特定类别的图像感兴趣，例如人脸图像。所有的人脸图像分布在背景空间中的一个维数很低的流形附近，我们称之为<span style="color: rgb(0, 82, 255);">数据流形</span>（data manifold）。经过实验验证，人脸数据流形大概在100维左右。</p><p><br></p><section class="" label="Copyright © 2015 Yead All Rights Reserved." style='white-space: normal;max-width: 100%;color: rgb(51, 51, 51);font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 17px;letter-spacing: 0.544px;text-align: justify;background-color: rgb(255, 255, 255);box-sizing: border-box !important;overflow-wrap: break-word !important;'><section style="margin-right: auto;margin-left: auto;max-width: 100%;text-align: center;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="margin-right: auto;margin-left: auto;max-width: 100%;overflow: hidden;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="margin-top: 0.5em;margin-bottom: 0.5em;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="max-width: 100%;border-width: medium;border-style: none;border-color: currentcolor;line-height: 1.5em;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section class="" label="Copyright © 2015 Yead All Rights Reserved." style="margin: 5px auto;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="margin-right: auto;margin-left: auto;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="margin-right: auto;margin-left: auto;max-width: 100%;overflow: hidden;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="margin-top: 0.5em;margin-bottom: 0.5em;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="max-width: 100%;border-width: medium;border-style: none;border-color: currentcolor;line-height: 1.5em;box-sizing: border-box !important;overflow-wrap: break-word !important;"><p style="margin-top: 5px;margin-bottom: 25px;padding: 8px 23px;max-width: 100%;min-height: 1em;border-radius: 10px;color: rgb(34, 34, 34);border-top: 5px solid rgb(0, 88, 156);border-bottom: 5px solid rgb(0, 88, 156);display: inline-block;line-height: 1.75em;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;font-size: 18px;color: rgb(63, 63, 63);box-sizing: border-box !important;overflow-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(0, 128, 255);line-height: 21.4px;font-family: 宋体;box-sizing: border-box !important;overflow-wrap: break-word !important;">流形嵌入</span></strong></span></p></section></section></section></section></section></section></section></section></section></section><p>那么，我们<strong>如何来描绘这个流形</strong>，<strong>如何获取这个流形</strong>，<strong>如何保证逼近的精度</strong>？这些正是深度学习的第一个主要任务：学习流形的结构，计算流形嵌入。数学上，假设给定嵌入在背景空间中的流形，我们将流形上的一个开邻域，同胚映射到参数空间，这一过程被称为是流形的局部参数化。用深度学习的语言来讲，就是学习<span style="color: rgb(0, 82, 255);">编码映射</span>（encoding map）和<span style="color: rgb(0, 82, 255);">解码映射</span>（decoding map），参数域被称为是<span style="color: rgb(0, 82, 255);">隐空间</span>（latent space）或者<span style="color: rgb(0, 82, 255);">特征空间</span>（feature space）。数据流形上的每个点被映射成参数域上的一个点，即每张人脸图片被映射成隐空间中的一个点，被称为是这张图片的特征（feature），或者<span style="color: rgb(0, 82, 255);">编码</span>（code）。</p><p><br></p><p>数学上，给定一个流形嵌入在高维欧氏空间之中，我们在流形上<span style="color: rgb(0, 82, 255);">稠密采样</span>，通过采样点，我们可以<span style="color: rgb(0, 82, 255);">重构分片线性流形</span>，用以逼近初始流形。在数字几何中，我们用三维扫描仪扫描一张人脸曲面，得到的是稠密点云，然后我们对点云计算三维背景空间的Delaunay三角剖分，得到一张分片线性的曲面（三角网格），这张分片线性的曲面就是真实光滑人脸曲面的离散逼近。逼近的精度，取决于采样的密度，理论上一般用<img class="" data-ratio="0.5454545454545454" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30genk5rj65socg1wAZMCVMrktZqNOIp2kHvXQzYSpW96r31x0qsS0OJibDUIljnRSJlucq6dsZnm3d9w/640?wx_fmt=gif" data-type="gif" data-w="33"><span style="color: rgb(0, 82, 255);">网</span>（<img class="" data-ratio="0.5454545454545454" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30genk5rj65socg1wAZMCVMrktQG5XJG3YjpiboorBMlCYia1OU9vmPKsJk7XvViakpicOmzt0icl3BJLNV4A/640?wx_fmt=gif" data-type="gif" data-w="33">-net）。所谓<img class="" data-ratio="0.5454545454545454" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30genk5rj65socg1wAZMCVMrktQG5XJG3YjpiboorBMlCYia1OU9vmPKsJk7XvViakpicOmzt0icl3BJLNV4A/640?wx_fmt=gif" data-type="gif" data-w="33">采样条件如下：曲面上任意一个半径为<img class="" data-ratio="1.375" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30genk5rj65socg1wAZMCVMrktFQkB2lCZ13ExGExPH1EKlduvHiblMAngtUA2yjB6wqe3CJHyXsXYdwg/640?wx_fmt=gif" data-type="gif" data-w="8">的测地圆盘内部，至少有一个采样点；任意两个采样点之间的距离不小于<img class="" data-ratio="0.875" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30genk5rj65socg1wAZMCVMrktlib1XBqG36SkrVxMVtNJRmJxjYXOFSOHCLpa7u74JYQwuwkYuRaCyPg/640?wx_fmt=gif" data-type="gif" data-w="8">。可以严密证明，合适选取<img class="" data-ratio="0.5454545454545454" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30genk5rj65socg1wAZMCVMrktQG5XJG3YjpiboorBMlCYia1OU9vmPKsJk7XvViakpicOmzt0icl3BJLNV4A/640?wx_fmt=gif" data-type="gif" data-w="33" style="white-space: normal;">可以保证重构的离散曲面收敛于原来光滑曲面，这里收敛指Hausdorff距离收敛，测地距离收敛，曲率测度收敛和Laplace-Beltrami算子收敛。</p><p><br></p><p>深度学习采取同样的手法，我们在数据流形上稠密采样，然后重构分片线性流形，用以逼近数据流形。理论上<img class="" data-ratio="0.5454545454545454" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30genk5rj65socg1wAZMCVMrktQG5XJG3YjpiboorBMlCYia1OU9vmPKsJk7XvViakpicOmzt0icl3BJLNV4A/640?wx_fmt=gif" data-type="gif" data-w="33" style="white-space: normal;">-网的采样条件同样适用于深度学习理论，但是目前这方面研究一片空白。在深度学习模型之中，我们用流形的参数表示来描绘流形。举例而言，如果我们描述单位球面，我们可以用如下的参数曲面形式：</p><p><br></p><p style="text-align: center;"><img class="" data-ratio="0.05750798722044728" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30genk5rj65socg1wAZMCVMrkttsibWGJiclhC9dlItUVWHdjjfZYfu5xazfzCGc4V0UEewciaJpPKuIicZQ/640?wx_fmt=gif" data-type="gif" data-w="313"></p><p><br></p><p>在深度学习中，这种参数表示就是解码映射，一般由一个DNN来表示。通常我们用ReLU DNN，因此参数表示是分片线性映射。</p><p style="text-align: center;"><br></p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="0.33416666666666667" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30genk5rj65socg1wAZMCVMrktH9SNmiaPIiadujGlXTQAG0n40PtHriaDACycAmlvVgU6QjB1sIfjGuCpQ/640?wx_fmt=png" data-type="png" data-w="1200" style=""></p><p style="text-align: center;">Fig.1 Autoencoder 学习流形。</p><p><br></p><p>我们将这些概念应用，做一个思想实验（thought experiment）：假定背景空间是三维欧氏空间，数据流形是弥勒佛曲面（图1左帧）。我们在曲面上稠密采样，用经典的自动编码器（autoencoder）学习，将数据流形编码到二维隐空间（图1中帧）；在将隐空间的特征向量映射会背景空间，得到分片线性的重构流形（图1右帧）。我们看到，重构流形较好地逼近了初始流形，编码映射和解码映射是：<span style="color: rgb(0, 82, 255);">连续<span style="color: rgb(0, 82, 255);">单射</span>，即拓扑同胚。</span></p><p><br></p><p><img class="" data-copyright="0" data-ratio="0.47477744807121663" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30genk5rj65socg1wAZMCVMrktNABLiaKLiciaibbuelEtCQFQtlSB0j3n9UibicJnX4n0zPNciamQLjj6AKkiag/640?wx_fmt=png" data-type="png" data-w="1685" style=""></p><p style="text-align: center;">Fig 2. 解码映射的分片线性结构。</p><p style="text-align: center;"><br></p><p>ReLU DNN可以表示分片线性映射，例如弥勒佛的编码映射和解码映射。图2显示了这种分片线性结构。背景空间中的任意一点被映射到隐空间中，激活一系列的神经元，如果背景空间中的两点激活同样的神经元，那么它们彼此等价。所有彼此等价的点构成一个等价类，形成背景空间中的一个胞腔，每个胞腔被ReLU DNN线性映射到隐空间的一个胞腔。图2中不同的胞腔用不同的颜色来表示。由此，我们可以真切看到编码映射的分片线性结构。</p><section class="" label="Copyright © 2015 Yead All Rights Reserved." style='white-space: normal;max-width: 100%;color: rgb(51, 51, 51);font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 17px;letter-spacing: 0.544px;text-align: justify;background-color: rgb(255, 255, 255);box-sizing: border-box !important;overflow-wrap: break-word !important;'><section style="margin-right: auto;margin-left: auto;max-width: 100%;text-align: center;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="margin-right: auto;margin-left: auto;max-width: 100%;overflow: hidden;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="margin-top: 0.5em;margin-bottom: 0.5em;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="max-width: 100%;border-width: medium;border-style: none;border-color: currentcolor;line-height: 1.5em;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section class="" label="Copyright © 2015 Yead All Rights Reserved." style="margin: 5px auto;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="margin-right: auto;margin-left: auto;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="margin-right: auto;margin-left: auto;max-width: 100%;overflow: hidden;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="margin-top: 0.5em;margin-bottom: 0.5em;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="max-width: 100%;border-width: medium;border-style: none;border-color: currentcolor;line-height: 1.5em;box-sizing: border-box !important;overflow-wrap: break-word !important;"><p style="margin-top: 5px;margin-bottom: 25px;padding: 8px 23px;max-width: 100%;min-height: 1em;border-radius: 10px;color: rgb(34, 34, 34);border-top: 5px solid rgb(0, 88, 156);border-bottom: 5px solid rgb(0, 88, 156);display: inline-block;line-height: 1.75em;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;font-size: 18px;color: rgb(63, 63, 63);box-sizing: border-box !important;overflow-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(0, 128, 255);line-height: 21.4px;font-family: 宋体;box-sizing: border-box !important;overflow-wrap: break-word !important;">概率变换</span></strong></span></p></section></section></section></section></section></section></section></section></section></section><p>深度神经网络将数据流形的一个邻域映射到隐空间中，将数据的概率分布映射到隐空间中参数域上的一个概率分布。不同的编码映射会得到隐空间中的不同概率分布。</p><p><br></p><p><img class="" data-copyright="0" data-ratio="0.43951985226223456" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gendI0RTlM3c8D4t33I6m93pgEdkfFXfAbu3Ljc01Rt8us6xaP62KCu1K3AE9lYyyaY3KzFfOJbkyQ/640?wx_fmt=png" data-type="png" data-w="1083" style=""></p><p><img class="" data-copyright="0" data-ratio="0.4417744916820702" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gendI0RTlM3c8D4t33I6m93pZl25Q1p32NysNXDIIYJ8oQZk6WeLjp1bpZ4AlLH1qF1850v5tVp1pA/640?wx_fmt=png" data-type="png" data-w="1082" style=""></p><p style="text-align: center;"><br></p><p style="text-align: center;">Fig. 3 不同的编码映射得到不同的概率分布。</p><p><br></p><p>图3显示了这一概念。两种编码映射将弥勒佛曲面映射到隐空间（平面圆盘），我们在平面圆盘上均匀采样，在拉回到弥勒佛曲面上。上面一行的编码映射将平面的均匀采样拉回成曲面上的非均匀采样；下面一行的编码映射将隐空间的均匀采样拉回成曲面上的均匀采样。这意味着，通过对隐空间进行变换，我们可以控制概率分布。在生成模型中，我们希望在隐空间均匀采样，从而得的数据流形上的均匀采样，即图3中的第二种情形。</p><section class="" label="Copyright © 2015 Yead All Rights Reserved." style='white-space: normal;max-width: 100%;color: rgb(51, 51, 51);font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 17px;letter-spacing: 0.544px;text-align: justify;background-color: rgb(255, 255, 255);box-sizing: border-box !important;overflow-wrap: break-word !important;'><section style="margin-right: auto;margin-left: auto;max-width: 100%;text-align: center;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="margin-right: auto;margin-left: auto;max-width: 100%;overflow: hidden;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="margin-top: 0.5em;margin-bottom: 0.5em;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="max-width: 100%;border-width: medium;border-style: none;border-color: currentcolor;line-height: 1.5em;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section class="" label="Copyright © 2015 Yead All Rights Reserved." style="margin: 5px auto;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="margin-right: auto;margin-left: auto;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="margin-right: auto;margin-left: auto;max-width: 100%;overflow: hidden;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="margin-top: 0.5em;margin-bottom: 0.5em;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="max-width: 100%;border-width: medium;border-style: none;border-color: currentcolor;line-height: 1.5em;box-sizing: border-box !important;overflow-wrap: break-word !important;"><p style="margin-top: 5px;margin-bottom: 25px;padding: 8px 23px;max-width: 100%;min-height: 1em;border-radius: 10px;color: rgb(34, 34, 34);border-top: 5px solid rgb(0, 88, 156);border-bottom: 5px solid rgb(0, 88, 156);display: inline-block;line-height: 1.75em;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;font-size: 18px;color: rgb(63, 63, 63);box-sizing: border-box !important;overflow-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(0, 128, 255);line-height: 21.4px;font-family: 宋体;box-sizing: border-box !important;overflow-wrap: break-word !important;">最优传输</span></strong></span></p></section></section></section></section></section></section></section></section></section></section><p>将一种概率分布变换成另外一种概率分布，这正是最优传输理论（Optimal Mass Transportation）的拿手好戏。这一理论有三种解读方式：概率论，偏微分方程和微分几何。我们简述如下：给定欧氏空间中的凸区域<img class="" data-ratio="0.24074074074074073" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30genk5rj65socg1wAZMCVMrktUPF8c8NWyCNJAW7AE2l5TH2GicKZCUXD8R73wJxk86iasibXRpuPBoPCQ/640?wx_fmt=gif" data-type="gif" data-w="54">，其上定义了另个概率测度<img class="" data-ratio="0.37037037037037035" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30genk5rj65socg1wAZMCVMrktAH6Em1nxHC3JsRRmabAO9eMibMarjOgn9qTvompvXfb3qPI1TqlJKIA/640?wx_fmt=gif" data-type="gif" data-w="27">，满足总测度相同的条件，我们寻求一个隐空间到自身的同胚变换<img class="" data-ratio="0.14473684210526316" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30genk5rj65socg1wAZMCVMrktib7Wiczvhn8XrqjWp40ntAg4kvZyicU6Ual6u0hggPfFicJCf6icEdqt8hw/640?wx_fmt=gif" data-type="gif" data-w="76">，将概率分布<img class="" data-ratio="1" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30genk5rj65socg1wAZMCVMrkt0qt7QyDbLf8swylpCJyHHhnobrYg6zb3WH3A7pnHgQGmfpgQAeIbBw/640?wx_fmt=gif" data-type="gif" data-w="10" style="white-space: normal;">映射到概率分布<img class="" data-ratio="0.7777777777777778" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30genk5rj65socg1wAZMCVMrkt2ibBIfbkacRgBb6Gn3QskaDXM3jsqIGMLYVY9uUayQMaEHu2jh5M5PQ/640?wx_fmt=gif" data-type="gif" data-w="9" style="white-space: normal;">，记为<img class="" data-ratio="0.2413793103448276" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30genk5rj65socg1wAZMCVMrktVyh474NeapPq7olicJib0dAVSKsyd8tibxyRj1kHXEZHw8ASjLbBBvniag/640?wx_fmt=gif" data-type="gif" data-w="58">。这样的映射有无穷多个，我们希望找到一个使得<span style="color: rgb(0, 82, 255);">传输代价</span>最小，传输代价可以定义成</p><p style="text-align: center;"><img class="" data-ratio="0.19718309859154928" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30genk5rj65socg1wAZMCVMrktibdiaqdGwTLMIdCfNDhvXCBBfXqZOG50yrrOVVUsX515e1pwVHDMDAJw/640?wx_fmt=gif" data-type="gif" data-w="213">,</p><p>这里<span style="color: rgb(0, 82, 255);">距离函数</span><img class="" data-ratio="0.4090909090909091" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30genk5rj65socg1wAZMCVMrktXnn1VSbcPfy0CuvBv2TZlAFxROY0V8x1DN92icMERjZT7jERuYC5guQ/640?wx_fmt=gif" data-type="gif" data-w="44">是将单位质量从源点运输到目标点所花费的代价。<span style="color: rgb(0, 82, 255);">最优传输映射</span><span style="color: rgb(0, 0, 0);">就是满足条件<img class="" data-ratio="0.2413793103448276" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30genk5rj65socg1wAZMCVMrktVyh474NeapPq7olicJib0dAVSKsyd8tibxyRj1kHXEZHw8ASjLbBBvniag/640?wx_fmt=gif" data-type="gif" data-w="58" style="white-space: normal;">并且使得传输代价最小者。最优传输映射的传输代价被定义为概率分布间的</span><span style="color: rgb(0, 82, 255);">Wasserstein距离</span><span style="color: rgb(0, 0, 0);">。</span></p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="0.4315443592552026" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gel9tsvL8ZQK7vSy03p6CicRwHXwIv12OW3nJXPPSY3dHMsFgic8HeyBb07fQfsLzT7xQWdkhB7cEKdw/640?wx_fmt=png" data-type="png" data-w="913" style=""></p><p style="text-align: center;"><span style="color: rgb(0, 0, 0);"></span>Fig 4. Wasserstein-GAN 模型的几何解释。</p><p><br></p><p><span style="color: rgb(0, 0, 0);">最优传输理论和Wasserstein距离被广泛应用于</span><span style="color: rgb(0, 82, 255);">对抗生成网络</span><span style="color: rgb(0, 0, 0);">（Generative Adverseral Net），生成器（Generator）的主要任务就是计算最优传输映射，将隐空间的均匀（或者Gauss）分布映射成数据分布；判别器（Discriminator）核心是计算数据分布和生成分布之间的Wasserstein距离。在目前的GAN模型中，判别器和生成器的计算相对独立，彼此竞争。图4给出了W-GAN的几何解释。</span></p><p><br></p><p>不同的距离函数<img class="" data-ratio="0.4090909090909091" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30genk5rj65socg1wAZMCVMrktXnn1VSbcPfy0CuvBv2TZlAFxROY0V8x1DN92icMERjZT7jERuYC5guQ/640?wx_fmt=gif" data-type="gif" data-w="44" style="white-space: normal;">诱导不同的最优传输映射。Brenier和Villani建立的理论表明，如果距离函数是欧氏距离的平方，<img class="" data-ratio="0.1557377049180328" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30genk5rj65socg1wAZMCVMrktm3nRTUpI4hibP30dYuefiaeGnrJ2L69QmNZs0q02KuibkmxzP1DpZQKCA/640?wx_fmt=gif" data-type="gif" data-w="122">，那么存在一个凸函数，<span style="color: rgb(0, 82, 255);">Brenier势能函数</span><img class="" data-ratio="0.1506849315068493" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30genk5rj65socg1wAZMCVMrkttic2nYfQz9Pgruy6ZP7DbheZkHW1k475ibbgAeCL9WQq7u067vRAwqHg/640?wx_fmt=gif" data-type="gif" data-w="73">，满足<span style="color: rgb(0, 82, 255);">蒙日-安培</span>偏微分方程：</p><p style="text-align: center;"><img class="" data-ratio="0.21794871794871795" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30genk5rj65socg1wAZMCVMrktQ06vRuSvfbe1oTkr7D7TJtctn6yhLHfpiaGFAyKSYm5aayvvaCw2DiaQ/640?wx_fmt=gif" data-type="gif" data-w="156">，</p><p style="text-align: left;">Briener势能的梯度映射<img class="" data-ratio="0.14942528735632185" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30genk5rj65socg1wAZMCVMrktOOMctdkx8h0pwWefYbW7uf2EE7zUdgmCm4GItOIricceMEI8XwgCchw/640?wx_fmt=gif" data-type="gif" data-w="87">给出了隐空间的自同胚，并且将概率分布<img class="" data-ratio="1" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30genk5rj65socg1wAZMCVMrkt0qt7QyDbLf8swylpCJyHHhnobrYg6zb3WH3A7pnHgQGmfpgQAeIbBw/640?wx_fmt=gif" data-type="gif" data-w="10">映射到概率分布<img class="" data-ratio="0.7777777777777778" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30genk5rj65socg1wAZMCVMrkt2ibBIfbkacRgBb6Gn3QskaDXM3jsqIGMLYVY9uUayQMaEHu2jh5M5PQ/640?wx_fmt=gif" data-type="gif" data-w="9">，并且这一映射使得<span style="color: rgb(0, 82, 255);">传输代价</span>最小，即最优传输映射。</p><p style="text-align: left;"><br></p><p style="text-align: left;">Brenier理论同时表明，Wasserstein距离的计算结果和最优传输映射的计算结果之间相差一个数学变换。因此，生成器和判别器的计算可以大为简化。</p><p style="text-align: left;"><br></p><section class="" label="Copyright © 2015 Yead All Rights Reserved." style='white-space: normal;max-width: 100%;color: rgb(51, 51, 51);font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 17px;letter-spacing: 0.544px;text-align: justify;background-color: rgb(255, 255, 255);box-sizing: border-box !important;overflow-wrap: break-word !important;'><section style="margin-right: auto;margin-left: auto;max-width: 100%;text-align: center;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="margin-right: auto;margin-left: auto;max-width: 100%;overflow: hidden;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="margin-top: 0.5em;margin-bottom: 0.5em;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="max-width: 100%;border-width: medium;border-style: none;border-color: currentcolor;line-height: 1.5em;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section class="" label="Copyright © 2015 Yead All Rights Reserved." style="margin: 5px auto;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="margin-right: auto;margin-left: auto;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="margin-right: auto;margin-left: auto;max-width: 100%;overflow: hidden;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="margin-top: 0.5em;margin-bottom: 0.5em;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="max-width: 100%;border-width: medium;border-style: none;border-color: currentcolor;line-height: 1.5em;box-sizing: border-box !important;overflow-wrap: break-word !important;"><p style="margin-top: 5px;margin-bottom: 25px;padding: 8px 23px;max-width: 100%;min-height: 1em;border-radius: 10px;color: rgb(34, 34, 34);border-top: 5px solid rgb(0, 88, 156);border-bottom: 5px solid rgb(0, 88, 156);display: inline-block;line-height: 1.75em;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;font-size: 18px;color: rgb(63, 63, 63);box-sizing: border-box !important;overflow-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(0, 128, 255);line-height: 21.4px;font-family: 宋体;box-sizing: border-box !important;overflow-wrap: break-word !important;">凸几何</span></strong></span></p></section></section></section></section></section></section></section></section></section></section><p style="text-align: left;">另一方面，蒙日-安培方程刻画了微分几何种闵可夫斯基（Minkowski）问题和亚历山大（Alexandrov）问题，因此最优传输映射可以用几何方法求解。</p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="0.47533632286995514" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gelXYwM3lvdqXJnky1Ut52h7NuW4TcDxLGHpfO9YVPCJSHoLOZ9FuhWaiaGPFE3PC4XMHG7LoIoYxwA/640?wx_fmt=png" data-type="png" data-w="892" style=""></p><p style="text-align: center;">Fig. 5 闵可夫斯基问题和亚历山大问题。</p><p style="text-align: center;"><br></p><p style="text-align: left;">图5 显示了Minkowski和Alexandrov问题的几何图景：给定凸多面体每个面的法向量和面积，我们可以唯一决定凸多面体的形状。Alenxandrov问题中的凸多面体就是Brenier势能函数。根据我们的理论，Alexandrov问题可以通过凸优化来求解。<br></p><section class="" label="Copyright © 2015 Yead All Rights Reserved." style='white-space: normal;max-width: 100%;color: rgb(51, 51, 51);font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 17px;letter-spacing: 0.544px;text-align: justify;background-color: rgb(255, 255, 255);box-sizing: border-box !important;overflow-wrap: break-word !important;'><section style="margin-right: auto;margin-left: auto;max-width: 100%;text-align: center;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="margin-right: auto;margin-left: auto;max-width: 100%;overflow: hidden;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="margin-top: 0.5em;margin-bottom: 0.5em;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="max-width: 100%;border-width: medium;border-style: none;border-color: currentcolor;line-height: 1.5em;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section class="" label="Copyright © 2015 Yead All Rights Reserved." style="margin: 5px auto;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="margin-right: auto;margin-left: auto;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="margin-right: auto;margin-left: auto;max-width: 100%;overflow: hidden;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="margin-top: 0.5em;margin-bottom: 0.5em;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="max-width: 100%;border-width: medium;border-style: none;border-color: currentcolor;line-height: 1.5em;box-sizing: border-box !important;overflow-wrap: break-word !important;"><p style="margin-top: 5px;margin-bottom: 25px;padding: 8px 23px;max-width: 100%;min-height: 1em;border-radius: 10px;color: rgb(34, 34, 34);border-top: 5px solid rgb(0, 88, 156);border-bottom: 5px solid rgb(0, 88, 156);display: inline-block;line-height: 1.75em;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;font-size: 18px;color: rgb(63, 63, 63);box-sizing: border-box !important;overflow-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(0, 128, 255);line-height: 21.4px;font-family: 宋体;box-sizing: border-box !important;overflow-wrap: break-word !important;">半透明模型</span></strong></span></p></section></section></section></section></section></section></section></section></section></section><p style="text-align: left;">我们可以将流形嵌入和概率变换分拆，前者用AutoEncoder实现，后者用我们倡导的OMT 几何方法求解，这样我们将一部分的黑箱变得透明，得到半透明生成模型 AE-OMT。</p><p style="text-align: left;"><br></p><p style="text-align: center;"><img data-copyright="0" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30genk5rj65socg1wAZMCVMrktC2RhHuxxNC5QhCVorjaiaL06XRcDqJXchPWUJ3nE5ldXK2PXVgrEdXg/640?wx_fmt=png" data-type="png" style="" class="" data-ratio="0.681910569105691" data-w="984"></p><p style="text-align: center;">Fig 6. AE-OMT 半透明生成模型。<br></p><p style="text-align: center;"><br></p><p style="text-align: left;">如图6所示，数据流形到隐空间的编码和解码映射用AutoEncoder实现，在隐空间中我们用几何方法计算Brenier势能函数，得到最优传输映射，将均匀分布映射成数据在隐空间的分布。</p><p style="text-align: left;"><br></p><p style="text-align: left;">这种学习模型异常简单，同时概率变换部分的理论透明，优化能量为凸，保证了最优传输映射的存在性，唯一性，和数值稳定性。同时，离散解到光滑解的逼近阶也有理论保证。</p><p style="text-align: left;"><br></p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="1" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_jpg/JcQsXQ30genk5rj65socg1wAZMCVMrktUJ4hGM3wmuJXLdeJWcoXq2wZ5tGh5Bwia42SajJtau24MSUh8I5XySw/640?wx_fmt=jpeg" data-type="jpeg" data-w="1042" style=""></p><p style="text-align: center;">Fig 7. 随机生成的人脸图像。</p><p style="text-align: center;"><br></p><p style="text-align: left;">我们用这一模型来生成人脸图像，用CelebA数据集进行训练，然后在隐空间对编码随机采样，再用解码映射得到图像，如图7所示。</p><p style="text-align: left;"><br></p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="1" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30genk5rj65socg1wAZMCVMrktKrwJicSLJe44b0dkqRly6Ld1k4HTQraN13PWvs4glnc8FXhWWMz7ZmA/640?wx_fmt=png" data-type="png" data-w="512" style=""></p><p style="text-align: center;"><span style="text-align: center;">    Fig 8. 人脸图像流形上的一条曲线。</span></p><p style="text-align: center;"><span style="text-align: center;"><br></span></p><p style="text-align: left;"><span style="text-align: center;">我们在隐空间任选两点，然后画出连接两点的直线段，解码映射将线段映成人脸数据流形上的一条曲线，如图8所示，我们看到姿态、表情、肤色的光滑变化过程。<br></span></p><section class="" label="Copyright © 2015 Yead All Rights Reserved." style='white-space: normal;max-width: 100%;color: rgb(51, 51, 51);font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 17px;letter-spacing: 0.544px;text-align: justify;background-color: rgb(255, 255, 255);box-sizing: border-box !important;overflow-wrap: break-word !important;'><section style="margin-right: auto;margin-left: auto;max-width: 100%;text-align: center;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="margin-right: auto;margin-left: auto;max-width: 100%;overflow: hidden;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="margin-top: 0.5em;margin-bottom: 0.5em;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="max-width: 100%;border-width: medium;border-style: none;border-color: currentcolor;line-height: 1.5em;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section class="" label="Copyright © 2015 Yead All Rights Reserved." style="margin: 5px auto;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="margin-right: auto;margin-left: auto;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="margin-right: auto;margin-left: auto;max-width: 100%;overflow: hidden;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="margin-top: 0.5em;margin-bottom: 0.5em;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="max-width: 100%;border-width: medium;border-style: none;border-color: currentcolor;line-height: 1.5em;box-sizing: border-box !important;overflow-wrap: break-word !important;"><p style="margin-top: 5px;margin-bottom: 25px;padding: 8px 23px;max-width: 100%;min-height: 1em;border-radius: 10px;color: rgb(34, 34, 34);border-top: 5px solid rgb(0, 88, 156);border-bottom: 5px solid rgb(0, 88, 156);display: inline-block;line-height: 1.75em;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;font-size: 18px;color: rgb(63, 63, 63);box-sizing: border-box !important;overflow-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(0, 128, 255);line-height: 21.4px;font-family: 宋体;box-sizing: border-box !important;overflow-wrap: break-word !important;">Mode Collapse</span></strong></span></p></section><section style="max-width: 100%;border-width: medium;border-style: none;border-color: currentcolor;line-height: 1.5em;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="letter-spacing: 0.544px;"><br></span></section><section style="max-width: 100%;border-width: medium;border-style: none;border-color: currentcolor;line-height: 1.5em;box-sizing: border-box !important;overflow-wrap: break-word !important;text-align: justify;"><span style="letter-spacing: 0.544px;">很多自然数据分布式多模态的，就是说同一类数据中有多个子类，每个子类对应着数据流形上的不同分布。这些分布的支集（support）可能彼此分离。这时，传统的GAN模型非常难以训练，学习的结果也不尽人意。一般会出现两种情况，有可能GAN只能生成一两个数字，而无法生成所有10个数字；或者，GAN模型可能生成一些没有意义的图片。</span></section><p style="text-align: center;"><br></p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="1.9917355371900827" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30genk5rj65socg1wAZMCVMrkty4IslxACeqBuChLwDXCxrYcfZuQEZHouYFF9gMQd1QZSpv5aibPAntA/640?wx_fmt=png" data-type="png" data-w="242" style='letter-spacing: 0.544px;font-family: "Helvetica Neue", Helvetica, "Hiragino Sans GB", "Microsoft YaHei", Arial, sans-serif;'><br></p></section></section></section></section></section></section></section></section></section><p style="text-align: center;">Fig 9. MNIST 的生成结果。</p><p style="text-align: center;"><br></p><p style="text-align: left;"><span style='color: rgb(51, 51, 51);font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 17px;letter-spacing: 0.544px;text-align: justify;background-color: rgb(255, 255, 255);'>比如我们学习MNIST数据，</span>如图9所示，第二行第四列、第七行第四列的数字比较有歧义。<br></p><p style="text-align: left;"><br></p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="1" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30genk5rj65socg1wAZMCVMrktgJwTIGQMG7IlN03XsnJcOWlwX0y1jZwnxGOAhA4pqWtsIk297UZ4wg/640?wx_fmt=png" data-type="png" data-w="640" style=""></p><p style="text-align: center;"><span style="text-align: center;"></span><span style="text-align: center;"> </span><span style="text-align: center;">Fig 10. 第三行的人脸，左眼为棕色、右眼为蓝色。</span></p><p style="text-align: center;"><br></p><p style="white-space: normal;"><span style='color: rgb(51, 51, 51);font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 17px;letter-spacing: 0.544px;text-align: justify;background-color: rgb(255, 255, 255);'>再如我们学习CelebA数据，</span>如图10所示，第三行的人脸一只眼睛为蓝色，另外一只眼睛为棕色。这在生物学上是极其罕见的事情。<br></p><p style='color: rgb(51, 51, 51);font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 17px;letter-spacing: 0.544px;text-align: center;white-space: normal;background-color: rgb(255, 255, 255);'><br></p><p style='color: rgb(51, 51, 51);font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 17px;letter-spacing: 0.544px;text-align: center;white-space: normal;background-color: rgb(255, 255, 255);'><img class="" data-copyright="0" data-ratio="0.588" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30genk5rj65socg1wAZMCVMrkt5cpEcDNoiczbKMkVT8vGHvUYHAxofT8lia2fGibGHz66DibItLu6qvF2VA/640?wx_fmt=png" data-type="png" data-w="1500"></p><p style="text-align: center;">Fig 11. Mode collapse 的几何解释。</p><p style="text-align: center;"><br></p><p style="text-align: left;">我们用图11来解释Mode Collapse的原因。在平面上，数据集合为离散点集，分成三个团簇，所有数据点的概率测度都相同。我们将单位圆盘映射到数据集合，就是说我们求取单位圆盘的一个胞腔分解，每个胞腔映射到一个数据点，胞腔的面积彼此相等。同时，在所有这种胞腔分解中，求得唯一的一种，使得传输代价最小，即离散最优传输映射。Brenier势能函数表示成定义在单位圆盘上的凸多面体曲面。我们看到，凸多面体有3条尖脊，平面圆盘的胞腔分解有3条分割线，将圆盘分成3个区域，每个区域映到一个团簇。因此，最优传输映射不是连续映射。但是，ReLU DNN只能表达连续的分片线性映射，这意味着<em>最优解不在DNN的函数空间里面</em>。因此ReLU DNN或者映到某几个团簇，或者映到团簇之间的无意义区域。半蓝半棕眼睛的图像就是如此生成。在这种情形下，Brenier势能函数是连续的，传输映射是非连续的，DNN应该去表示Brenier势能函数，而非直接表示传输映射。</p><p style="text-align: left;"><br></p><section style='color: rgb(51, 51, 51);font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 17px;letter-spacing: 0.544px;text-align: center;white-space: normal;background-color: rgb(255, 255, 255);max-width: 100%;border-width: medium;border-style: none;border-color: currentcolor;line-height: 1.5em;box-sizing: border-box !important;overflow-wrap: break-word !important;'><p style="margin-top: 5px;margin-bottom: 25px;padding: 8px 23px;max-width: 100%;min-height: 1em;border-radius: 10px;color: rgb(34, 34, 34);border-top: 5px solid rgb(0, 88, 156);border-bottom: 5px solid rgb(0, 88, 156);display: inline-block;line-height: 1.75em;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;font-size: 18px;color: rgb(63, 63, 63);box-sizing: border-box !important;overflow-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(0, 128, 255);line-height: 21.4px;font-family: 宋体;box-sizing: border-box !important;overflow-wrap: break-word !important;">小结</span></strong></span></p></section><p style="text-align: left;">这里，我们基于流形分布假设、团簇分布假设将深度学习的任务分解为流形嵌入和概率变换。概率变换可以由经典的最优传输理论来解释，并用几何方法来取代。简单的Autoencoder-OptimalTransportation （AE-OMT）模型可以用于各种生成任务，对于Mode Collapse给出了几何解释。</p><p style="text-align: left;"><br></p><p style="text-align: left;">几何观点下的深度学习方向具有大量的理论问题期待解决，大量的技术细节需要仔细探讨，大量的实际应用等待开发。如果广大同学和朋友有兴趣合作，欢迎切磋交流！</p><p style="text-align: left;"><br></p><section style='white-space: normal;color: rgb(51, 51, 51);font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 17px;letter-spacing: 0.544px;text-align: center;background-color: rgb(255, 255, 255);max-width: 100%;border-width: medium;border-style: none;border-color: currentcolor;line-height: 1.5em;box-sizing: border-box !important;overflow-wrap: break-word !important;'><p style="margin-top: 5px;margin-bottom: 25px;padding: 8px 23px;max-width: 100%;min-height: 1em;border-radius: 10px;color: rgb(34, 34, 34);border-top: 5px solid rgb(0, 88, 156);border-bottom: 5px solid rgb(0, 88, 156);display: inline-block;line-height: 1.75em;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;font-size: 18px;color: rgb(63, 63, 63);box-sizing: border-box !important;overflow-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(0, 128, 255);line-height: 21.4px;font-family: 宋体;box-sizing: border-box !important;overflow-wrap: break-word !important;">鸣谢</span></strong></span></p></section><p style="text-align: left;">这些工作是和世界各地很多学者共同完成，哈佛大学的丘成桐先生，格罗斯大学的罗锋教授，石溪大学的Dimitris Samaras教授【4】，大连理工大学的罗钟铉教授，雷娜教授，郑晓朋教授，武汉大学的苏科华教授，北京师范大学的崔丽教授，Arizona大学的王雅琳教授，UCLA的刘克峰教授，首都师范大学的方复全教授，香港中文大学的雷乐铭教授等等，一概表示感谢！特别感谢Cedric Villani先生，汪徐家教授！也特别感谢研究生团队，温成峰，齐鑫，李新元，郭洋，安东生，李轩，刘会东，王怡硕，陈伟，任玉雪，柯景耀和很多同学！</p><p style="text-align: left;"><br></p><p style="text-align: left;"><br></p><hr style='max-width: 100%;color: rgb(51, 51, 51);font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 17px;letter-spacing: 0.544px;text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);box-sizing: border-box !important;overflow-wrap: break-word !important;'><p style='max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 17px;letter-spacing: 0.544px;text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);box-sizing: border-box !important;overflow-wrap: break-word !important;'><br style="max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"></p><p style='max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 17px;letter-spacing: 0.544px;text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);box-sizing: border-box !important;overflow-wrap: break-word !important;'>References</p><p style='max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 17px;letter-spacing: 0.544px;text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);box-sizing: border-box !important;overflow-wrap: break-word !important;'>                                         </p><ol class=" list-paddingleft-2"><li><p style="max-width: 100%;min-height: 1em;color: rgb(62, 62, 62);font-size: 16px;text-align: left;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(34, 34, 34);font-family: sans-serif;box-sizing: border-box !important;overflow-wrap: break-word !important;">Na Lei, Zhongxuan</span><span style="max-width: 100%;color: rgb(34, 34, 34);font-family: sans-serif;box-sizing: border-box !important;overflow-wrap: break-word !important;"> Luo, Shing-Tung Yau and David Xianfeng Gu.  "Geometric Understanding of Deep Learning". </span><span style="max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">arXiv</span><span style="max-width: 100%;color: rgb(34, 34, 34);font-family: sans-serif;box-sizing: border-box !important;overflow-wrap: break-word !important;">:1805.10451 . </span></p><p style="max-width: 100%;min-height: 1em;color: rgb(62, 62, 62);font-size: 16px;text-align: left;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(34, 34, 34);font-family: sans-serif;box-sizing: border-box !important;overflow-wrap: break-word !important;"></span><span style="max-width: 100%;color: rgb(34, 34, 34);font-family: sans-serif;box-sizing: border-box !important;overflow-wrap: break-word !important;">https://arxiv.org/abs/1805.10451</span></p></li><li><p style="max-width: 100%;min-height: 1em;text-align: left;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(34, 34, 34);font-family: sans-serif;box-sizing: border-box !important;overflow-wrap: break-word !important;">Xianfeng Gu, Feng Luo, Jian Sun, and Shing-Tung Yau. "Variational principles for minkowski type problems, discrete optimal transport", and discrete monge-ampere equations. Asian Journal of Mathematics (AJM), 20(2):383-398, 2016.</span></p></li><li><p style="max-width: 100%;min-height: 1em;text-align: left;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(34, 34, 34);font-family: sans-serif;box-sizing: border-box !important;overflow-wrap: break-word !important;">Na Lei,Kehua Su,Li Cui,Shing-Tung Yau,David Xianfeng Gu, "A Geometric View of Optimal Transportation and Generative Model", arXiv:1710.05488. https://arxiv.org/abs/1710.05488</span></p></li><li><p style="max-width: 100%;min-height: 1em;text-align: left;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(34, 34, 34);font-family: sans-serif;box-sizing: border-box !important;overflow-wrap: break-word !important;">Huidong L，Xianfeng Gu, Dimitris Samaras, "A Two-Step Computation of the Exact GAN Wasserstein Distance", ICML 2018.</span></p></li><li><p style="max-width: 100%;min-height: 1em;text-align: left;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(34, 34, 34);font-family: sans-serif;box-sizing: border-box !important;overflow-wrap: break-word !important;">Haodi Chen， Genggeng Huang and Xu-Jia Wang， “Convergence rate estimates for Aleksandrov's solution to the Monge-Ampere Equation", Accepted by SIAM J. Numerical Analysis.</span></p></li></ol>
                </div>
                <script nonce="1171829150" type="text/javascript">
                    var first_sceen__time = (+new Date());

                    if ("" == 1 && document.getElementById('js_content')) {
                        document.getElementById('js_content').addEventListener("selectstart",function(e){ e.preventDefault(); });
                    }

                    
                    (function(){
                        if (navigator.userAgent.indexOf("WindowsWechat") != -1){
                            var link = document.createElement('link');
                            var head = document.getElementsByTagName('head')[0];
                            link.rel = 'stylesheet';
                            link.type = 'text/css';
                            link.href = "//res.wx.qq.com/mmbizwap/zh_CN/htmledition/style/page/appmsg_new/winwx3ec991.css";
                            head.appendChild(link);
                        }
                    })();
                </script>

                
                <div class="ct_mpda_wrp" id="js_sponsor_ad_area" style="display:none;"></div>

                
                                <div class="reward_area tc reward_area_primary" id="js_reward_area" style="display:none;">
                    <div class="reward-avatar" style="display: none;" id="js_reward_avatar">
                        <img src="" alt="" id="js_reward_author_head">
                    </div>
                    
                                       
                                                <div class="reward-author" style="display: none;" id="js_reward_author">顾险峰</div>
                                            
                                       

                                        <p>
                        <a class="reward_button" id="js_reward_link" href="##"><span id="js_reward_link_text">赞赏</span></a>
                    </p>
                    <div id="js_reward_inner" class="reward_area_inner" style="display:none;">
                        <p class="weui-loadmore weui-loadmore_line reward_user_tips" id="js_reward_total_parent">
                          <span class="weui-loadmore__tips"><a href="##" id="js_reward_total"></a> 人<span id="js_reward_total_text">赞赏</span></span>
                        </p>
                        
                        <div id="js_reward_list" class="reward_user_list"></div>
                    </div>
                </div>
                                <div class="reward_qrcode_area reward_area tc" id="js_reward_qrcode" style="display:none;">
                    <p class="tips_global">长按二维码向我转账</p>
                                        <p class="reward_tips"></p>
                    <span class="reward_qrcode_img_wrp"><img class="reward_qrcode_img" id="js_reward_qrcode_img"></span>
                    <p class="tips_global">受苹果公司新规定影响，微信 iOS 版的赞赏功能被关闭，可通过二维码转账支持公众号。</p>
                </div>
                                                
                
                            </div>
                                    
                        


                        
            <ul id="js_hotspot_area" class="article_extend_area"></ul>


            
                        <div class="rich_media_tool" id="js_toobar3">

                                            <div id="js_read_area3" class="media_tool_meta tips_global_primary meta_primary" style="display:none;">阅读 <span id="readNum3"></span></div>

                <span style="display:none;" class="media_tool_meta meta_extra meta_praise" id="like3">
                    <i class="icon_praise_gray"></i><span class="praise_num" id="likeNum3"></span>
                </span>

                

            </div>


                        <div class="rich_media_tool" id="js_sg_bar">

                                
            </div>
                      </div>
        </div>

        <div class="rich_media_area_primary sougou" id="sg_tj" style="display:none"></div>


        
        <div class="rich_media_area_extra">
          <div class="rich_media_area_extra_inner">
              
              <div id="js_share_appmsg">
              </div>

              
                            <div class="mpda_bottom_container" id="js_bottom_ad_area"></div>
                            
              <div id="js_iframetest" style="display:none;"></div>
                            
                            
              <div class="rich_media_extra rich_media_extra_discuss" id="js_cmt_container" style="display:none">
                

                
                <div class="discuss_mod" id="js_friend_cmt_area" style="display:none">
                  
                  
                  
                </div>

                                <div class="discuss_mod" id="js_cmt_area" style="display:none">
                </div>
                              </div>
          </div>
        </div>

        
        <div id="js_pc_qr_code" class="qr_code_pc_outer" style="display:none;">
            <div class="qr_code_pc_inner">
                <div class="qr_code_pc">
                    <img id="js_pc_qr_code_img" class="qr_code_pc_img">
                    <p>微信扫一扫<br>关注该公众号</p>
                </div>
            </div>
        </div>
    </div>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
