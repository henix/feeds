<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>LWE问题及其公钥密码方案</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/57780925">原文</a></p>
<p>本文节选自陈智罡博士的博士论文。</p><p>错误学习问题（<i>Learning with Errors</i>，简称LWE）由Regev在2005年提出[11]，该问题已经成为格密码学中广泛使用的密码学基。LWE问题是一个平均情况下的问题，Regev在论文[11]中将LWE问题量子归约到格上标准困难问题。因此在LWE问题之上建立的所有密码学方案，都能够将其安全建立在格问题的最坏情况下困难性之上。</p><p>1.1  </p><h2>1.1.1 LWE问题</h2><p>LWE问题就是给出一些关于秘密向量<b><i>s</i></b>的“近似”随机线性方程，其目标是恢复秘密向量<b><i>s</i></b> 。例如给出如下一些“近似”随机线性方程：</p><p>14<b><i>s</i></b>1 + 15<b><i>s</i></b>2 + 5<b><i>s</i></b>3 + 2<b><i>s</i></b>4 ≈8  (mod 17)</p><p>13<b><i>s</i></b>1 + 14<b><i>s</i></b>2 + 14<b><i>s</i></b>3 + 6<b><i>s</i></b>4≈16  (mod 17)</p><p>6<b><i>s</i></b>1 + 10<b><i>s</i></b>2 + 13<b><i>s</i></b>3 + 1<b><i>s</i></b>4≈3  (mod 17)</p><p>10<b><i>s</i></b>1 + 4<b><i>s</i></b>2 + 12<b><i>s</i></b>3 + 16<b><i>s</i></b>4≈12  (mod 17)</p><p>…………</p><p>9<b><i>s</i></b>1 + 5<b><i>s</i></b>2 + 9<b><i>s</i></b>3 + 6<b><i>s</i></b>4≈9  (mod 17)</p><p>在上述每个方程中，加入了一个小的错误，该错误在+1和-1之间，目标是恢复向量<b><i>s</i></b>。如果上述方程中没有加入错误，则使用高斯消元法就可以在多项式时间内恢复向量<b><i>s</i></b>。但是由于加入了错误，使得该问题变得非常的困难。</p><p><b>LWE问题定义</b> 参数<i>n </i>≥1，模<i>q</i> ≥ 2，</p><figure><noscript><img src="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg" data-caption="" data-size="normal" class="content_image"></noscript><img src="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg" data-caption="" data-size="normal" class="content_image lazy" data-actualsrc="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg"></figure><p>是</p><figure><noscript><img src="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg" data-caption="" data-size="normal" class="content_image"></noscript><img src="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg" data-caption="" data-size="normal" class="content_image lazy" data-actualsrc="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg"></figure><p>上的一个错误概率分布。</p><figure><noscript><img src="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg" data-caption="" data-size="normal" class="content_image"></noscript><img src="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg" data-caption="" data-size="normal" class="content_image lazy" data-actualsrc="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg"></figure><p>是</p><figure><noscript><img src="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg" data-caption="" data-size="normal" class="content_image"></noscript><img src="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg" data-caption="" data-size="normal" class="content_image lazy" data-actualsrc="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg"></figure><p>上的一个概率分布，该分布通过如下方式获得：随机均匀选择一个向量<b><i>a</i></b>∈</p><figure><noscript><img src="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg" data-caption="" data-size="normal" class="content_image"></noscript><img src="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg" data-caption="" data-size="normal" class="content_image lazy" data-actualsrc="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg"></figure><p>，根据分布</p><figure><noscript><img src="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg" data-caption="" data-size="normal" class="content_image"></noscript><img src="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg" data-caption="" data-size="normal" class="content_image lazy" data-actualsrc="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg"></figure><p>选择错误向量<b><i>e</i></b>∈</p><figure><noscript><img src="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg" data-caption="" data-size="normal" class="content_image"></noscript><img src="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg" data-caption="" data-size="normal" class="content_image lazy" data-actualsrc="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg"></figure><p>，输出（<b><i>a</i></b>，<b><i>b</i></b>=&lt;<b><i> a</i></b> , <b><i>s </i></b>&gt; +<b><i>e</i></b> mod <i>q</i>）。LWE问题是对于<b><i>s</i></b>∈</p><figure><noscript><img src="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg" data-caption="" data-size="normal" class="content_image"></noscript><img src="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg" data-caption="" data-size="normal" class="content_image lazy" data-actualsrc="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg"></figure><p>，给出任意数量的从</p><figure><noscript><img src="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg" data-caption="" data-size="normal" class="content_image"></noscript><img src="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg" data-caption="" data-size="normal" class="content_image lazy" data-actualsrc="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg"></figure><p>取出的独立实例，其目的是输出<b><i>s</i></b>。</p><p><b>LWE判定问题</b> 上述LWE问题是一个LWE搜索问题，密码学中更感兴趣的是LWE问题的另外一个版本：平均情况下的LWE判定问题。即对于随机均匀选择的<b><i>s</i></b>∈</p><figure><noscript><img src="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg" data-caption="" data-size="normal" class="content_image"></noscript><img src="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg" data-caption="" data-size="normal" class="content_image lazy" data-actualsrc="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg"></figure><p>，能够以不可忽略的概率区分</p><figure><noscript><img src="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg" data-caption="" data-size="normal" class="content_image"></noscript><img src="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg" data-caption="" data-size="normal" class="content_image lazy" data-actualsrc="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg"></figure><p>分布与均匀分布</p><figure><noscript><img src="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg" data-caption="" data-size="normal" class="content_image"></noscript><img src="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg" data-caption="" data-size="normal" class="content_image lazy" data-actualsrc="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg"></figure><p>上的实例。判定LWE问题可以归约到搜索LWE问题。</p><p>如果在均匀选择秘密向量<b><i>s</i></b>的情况下，判定LWE问题可以被解决，则对于所有秘密向量<b><i>s</i></b>，判定LWE问题都可以被解决。</p><p><b>LWE问题与BDD问题</b> 上述LWE问题定义中，对于<i>m</i>个从</p><figure><noscript><img src="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg" data-caption="" data-size="normal" class="content_image"></noscript><img src="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg" data-caption="" data-size="normal" class="content_image lazy" data-actualsrc="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg"></figure><p>取出的独立实例，可以用随机均匀矩阵<b><i>A</i></b>∈</p><figure><noscript><img src="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg" data-caption="" data-size="normal" class="content_image"></noscript><img src="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg" data-caption="" data-size="normal" class="content_image lazy" data-actualsrc="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg"></figure><p>和<b><i>b</i></b>=<i><b>A</b>T<b> s</b></i>+<b><i>e</i></b>表出。所以LWE问题可以看成是随机格</p><figure><noscript><img src="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg" data-caption="" data-size="normal" class="content_image"></noscript><img src="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg" data-caption="" data-size="normal" class="content_image lazy" data-actualsrc="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg"></figure><p>上的BDD问题。</p><p><b>参数说明</b> 分布</p><figure><noscript><img src="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg" data-caption="" data-size="normal" class="content_image"></noscript><img src="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg" data-caption="" data-size="normal" class="content_image lazy" data-actualsrc="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg"></figure><p>是一个标准偏离是</p><figure><noscript><img src="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg" data-caption="" data-size="normal" class="content_image"></noscript><img src="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg" data-caption="" data-size="normal" class="content_image lazy" data-actualsrc="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg"></figure><p>的类似高斯分布，其中</p><figure><noscript><img src="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg" data-caption="" data-size="normal" class="content_image"></noscript><img src="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg" data-caption="" data-size="normal" class="content_image lazy" data-actualsrc="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg"></figure><p>，通常</p><figure><noscript><img src="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg" data-caption="" data-size="normal" class="content_image"></noscript><img src="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg" data-caption="" data-size="normal" class="content_image lazy" data-actualsrc="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg"></figure><p>取为1/poly（<i>n</i>）。模<i>q</i>一般是关于<i>n</i>的多项式。LWE实例的数量并不重要。</p><p><b>LWE问题的困难性</b> 以下三个原因说明LWE问题是困难的。第一，已知最好的求解LWE问题的算法运行时间是指数级的，即使是对量子计算机也没有任何帮助。第二，LWE问题是LPN问题的自然扩展，而LPN问题在学习理论中被广泛研究而且普遍认为是困难的。此外LPN问题可以形式化为随机线性二元码的解码问题，如果LPN问题的求解算法有一点进步，则意味着编码理论的一个突破。第三，也是最重要的，LWE问题被归约到最坏情况下的格上标准困难问题，例如GapSVP和SIVP[11,85]。</p><p>Regev在2005年证明了只要</p><figure><noscript><img src="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg" data-caption="" data-size="normal" class="content_image"></noscript><img src="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg" data-caption="" data-size="normal" class="content_image lazy" data-actualsrc="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg"></figure><p>，那么在平均情况下解决LWE问题，其困难性至少与使用量子算法近似格上标准困难问题相同，其中近似因子是</p><figure><noscript><img src="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg" data-caption="" data-size="normal" class="content_image"></noscript><img src="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg" data-caption="" data-size="normal" class="content_image lazy" data-actualsrc="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg"></figure><p>。随后Peikert在2009年给出了一个相同近似因子的经典约减而非量子约减，但是需要满足<i>q</i>≥2<i>n</i>/2。最近Brakerski等人在2013年给出了在<i>q</i>为多项式的情况下的一个经典LWE问题的约减，但是在维数上有所损失[120]。</p><p>在LWE问题中，<b><i>s</i></b>可以随机均匀的取自于</p><figure><noscript><img src="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg" data-caption="" data-size="normal" class="content_image"></noscript><img src="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg" data-caption="" data-size="normal" class="content_image lazy" data-actualsrc="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg"></figure><p>。这一方面使得</p><figure><noscript><img src="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg" data-caption="" data-size="normal" class="content_image"></noscript><img src="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg" data-caption="" data-size="normal" class="content_image lazy" data-actualsrc="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg"></figure><p>的长度可以更短，另外一方面其困难性不变[111]。</p><p>假设根据高斯分布</p><figure><noscript><img src="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg" data-caption="" data-size="normal" class="content_image"></noscript><img src="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg" data-caption="" data-size="normal" class="content_image lazy" data-actualsrc="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg"></figure><p>选择的错误向量长度的界是<i>B</i>，则有<i>B</i>≤</p><figure><noscript><img src="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg" data-caption="" data-size="normal" class="content_image"></noscript><img src="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg" data-caption="" data-size="normal" class="content_image lazy" data-actualsrc="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg"></figure><p>，得到</p><figure><noscript><img src="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg" data-caption="" data-size="normal" class="content_image"></noscript><img src="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg" data-caption="" data-size="normal" class="content_image lazy" data-actualsrc="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg"></figure><p>，从而</p><figure><noscript><img src="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg" data-caption="" data-size="normal" class="content_image"></noscript><img src="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg" data-caption="" data-size="normal" class="content_image lazy" data-actualsrc="https://pic2.zhimg.com/v2-3c40829a650f96ab57be6975d78f8601_b.jpg"></figure><p>。该式反映了近似因子与<i>q</i>/<i>B</i>的大小有关，而<i>q</i>/<i>B</i>又与全同态加密方案的计算深度有关，所以当维数<i>n</i>和<i>B</i>固定的情况下，模<i>q</i>越大，全同态加密方案的安全性越低，而全同态加密方案的同态计算能力越高。</p><figure><noscript><img src="https://pic3.zhimg.com/v2-b68efc3b5c5abffa5af6af411aa19ae2_b.jpg" data-caption="" data-size="normal" data-rawwidth="442" data-rawheight="598" class="origin_image zh-lightbox-thumb" width="442" data-original="https://pic3.zhimg.com/v2-b68efc3b5c5abffa5af6af411aa19ae2_r.jpg"></noscript><img src="https://pic3.zhimg.com/v2-b68efc3b5c5abffa5af6af411aa19ae2_b.jpg" data-caption="" data-size="normal" data-rawwidth="442" data-rawheight="598" class="origin_image zh-lightbox-thumb lazy" width="442" data-original="https://pic3.zhimg.com/v2-b68efc3b5c5abffa5af6af411aa19ae2_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-b68efc3b5c5abffa5af6af411aa19ae2_b.jpg"></figure><p>===============================================================</p><p><b>文章首发在微信公众号：btc201800</b></p><p><b><a href="http://link.zhihu.com/?target=http%3A//weixin.qq.com/r/GC8UDDjEjmXxrXxv93oK" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">http://</span><span class="visible">weixin.qq.com/r/GC8UDDj</span><span class="invisible">EjmXxrXxv93oK</span><span class="ellipsis"></span></a>(二维码自动识别)</b></p><p><b>音频发布在喜马拉雅上“区块链杂谈 (第2季)“</b></p><p><b>宁波格密链网络科技有限公司，专注于区块链上的密码技术研发。</b></p>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
</body>
</html>
