<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>深度学习的几何理解（3） - 概率变换的几何观点</title>
</head>
<body>
<p><a href="https://mp.weixin.qq.com/s?timestamp=1536074163&amp;src=3&amp;ver=1&amp;signature=fKuVtFpB-PVCJf99NQ0BS0ailNUxxpM7sCFL2vamdB66WosBEfn4r4lwQilO-ZRBJQ54K2WkAeXid6HhpFoTHCBKwkqIKbf4XdrdWblBtq7Hbj33O*u6MXbPJv56mBJUFL7RaU8APt3Mw5ubn1hnJvod9KdG3u-IUzefHra21Gs=">原文</a></p>
<div id="js_top_ad_area" class="top_banner"></div><div class="rich_media_inner">
                        
        
        <div id="page-content" class="rich_media_area_primary">
            
                        
            <div id="img-content">

                
                <h2 class="rich_media_title" id="activity-name">
                    深度学习的几何理解（3） - 概率变换的几何观点

                                                                                </h2>
                <div id="meta_content" class="rich_media_meta_list">
                                                            <span id="copyright_logo" class="rich_media_meta rich_media_meta_text meta_tag_text">原创：</span>
                                                            <span class="rich_media_meta rich_media_meta_text">
                                                顾险峰
                                            </span>
                                        <span class="rich_media_meta rich_media_meta_nickname" id="profileBt">
                      <a href="javascript:void(0);" id="js_name">
                        老顾谈几何                      </a>
                      <div id="js_profile_qrcode" class="profile_container" style="display:none;">
                          <div class="profile_inner">
                              <strong class="profile_nickname">老顾谈几何</strong>
                              <img class="profile_avatar" id="js_profile_qrcode_img" src="" alt="">

                              <p class="profile_meta">
                              <label class="profile_meta_label">微信号</label>
                              <span class="profile_meta_value">conformalgeometry</span>
                              </p>

                              <p class="profile_meta">
                              <label class="profile_meta_label">功能介绍</label>
                              <span class="profile_meta_value">讲解、传播现代几何理论、计算方法和实际应用。理论包括代数拓扑，微分几何，黎曼面理论，偏微分方程，代数几何，复几何等等；计算方法包括计算拓扑，计算共形几何，离散曲率流等等；应用包括计算机图形学，视觉，网络，几何建模，可视化和医学图像等等。</span>
                              </p>
                              
                          </div>
                          <span class="profile_arrow_wrp" id="js_profile_arrow_wrp">
                              <i class="profile_arrow arrow_out"></i>
                              <i class="profile_arrow arrow_in"></i>
                          </span>
                      </div>
                    </span>


                    <em id="publish_time" class="rich_media_meta rich_media_meta_text"></em>





                </div>
                
                
                
                
                                                
                                                                
                
                <div class="rich_media_content " lang='="en"' id="js_content">
                    

                    

                    
                    
                    <p><span style="color: rgb(51, 51, 51);">（最近，哈佛大学丘成桐先生领导的团队，大连理工大学罗钟铉教授、雷娜教授领导的团队应用几何方法研究深度学习。老顾受邀在一些大学和科研机构做了题为“深度学习的几何观点”的报告，汇报了这方面的进展情况。这里是报告的简要记录，具体内容见【1】。）</span></p><p><span style="color: rgb(51, 51, 51);"><br></span></p><p><span style="color: rgb(51, 51, 51);"></span></p><p><img class="" data-copyright="0" data-ratio="0.5" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTOdKPibMBjL418H5mMQ3la1GqOeXsicIicUMF5RxMo5pjLLyRiaVIG2To9w/640?wx_fmt=png" data-type="png" data-w="930" style=""></p><p><span style="color: rgb(51, 51, 51);"></span><br></p><p><span style="color: rgb(51, 51, 51);">昨天（2018年6月15日），严东辉教授邀请老顾在泛华统计协会（ International Chinese Statistical Association）举办的应用统计会议（ICSA2018 Applied Statistics Symposium）上做了“深度学习的几何观点”的报告。会议上Eric Xing教授给出报告，用统计概率的观点统一了变分自动编码器（VAE，Variational Autoencoder）和生成对抗网络（GAN，Generative Aderseral Network）。老顾用几何观点将VAE和GAN加以分析，再度阐述GAN模型中的对抗是虚拟的，没有必要的，生成器网络和判别器网络是冗余的。（以前的博文曾经系统阐述过，请见 “<a href="http://mp.weixin.qq.com/s?__biz=MzA3NTM4MzY1Mg==&amp;mid=2650814302&amp;idx=1&amp;sn=87642b1c0662b3b71666e45a1cb2a0b3&amp;chksm=8485c155b3f248433dbdb33d92d36851d25791a261c7ae09164155314e1cee7d578140ef0456&amp;scene=21#wechat_redirect" target="_blank">虚构的对抗，GAN with the wind<span style="color: rgb(51, 51, 51);">”</span></a>）下面我们从几何角度详细解释。</span></p><p><span style="color: rgb(51, 51, 51);"><br></span></p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="0.6672199170124481" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gelDIwPrM2WLELiaQ4xUwEoibt3W3Uffw1dPY3DXhGtD1Ls9jyTFVDEFqicJsaN0KsfVHAUZ8bezgfNog/640?wx_fmt=png" data-type="png" data-w="1205" style=""></p><p style="text-align: center;">图1. 流形结构。</p><p style="text-align: center;"><br></p><p style="text-align: left;">我们前面阐述过深度学习成功的核心原因可以部分归结为流形分布律和聚类分布律（<a href="http://mp.weixin.qq.com/s?__biz=MzA3NTM4MzY1Mg==&amp;mid=2650814452&amp;idx=1&amp;sn=3312f0134032a3094eb9c4043842f547&amp;chksm=8485c1ffb3f248e9ed87461245eef145ebf0be348158625985d49a9c57c9d8d3340e624d190e&amp;scene=21#wechat_redirect" target="_blank">深度学习的几何观点（1） - 流形分布定律</a>），深度学习的基本任务就在于从数据中学习流形结构，建立流形的参数表达；和变换概率分布。</p><p style="text-align: left;"><br></p><p style="text-align: left;">如图1所示，假设概率分布<img class="" data-ratio="1" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekC8LIYgDuyXLvXpjGibBTiarGu6lpOOuy1QlJ5AsMm8nCjTM0XM6CowfiaMo7VHOezXnxPibewDlMpSg/640?wx_fmt=gif" data-type="gif" data-w="10" style="white-space: normal;">的支集是流形<img class="" data-ratio="0.9166666666666666" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekC8LIYgDuyXLvXpjGibBTiargTdH2siaibxN3Cm6icOWPo1GhcapzcO6cqy1Wlcx9OOMffhSbpqLF4baw/640?wx_fmt=gif" data-type="gif" data-w="12" style="white-space: normal;">。我们上一讲（<a href="http://mp.weixin.qq.com/s?__biz=MzA3NTM4MzY1Mg==&amp;mid=2650814456&amp;idx=1&amp;sn=1f0dc7373488347077d54603b765dff3&amp;chksm=8485c1f3b3f248e5b4e86ba8193c3b35d0c24f1ec315a104c08a50ae3661b9e0c94a6b3fe56f&amp;scene=21#wechat_redirect" target="_blank">深度学习的几何理解（2） - 学习能力的上限</a>）分析了深度学习如何计算流形的参数化映射（即编码映射），<img class="" data-ratio="0.18604651162790697" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekC8LIYgDuyXLvXpjGibBTiarxdKlbWNsM0ZBkewdUB4NpZuiamk4icYO5WpWwx2LnGyEaQoibCfibvsSOQ/640?wx_fmt=gif" data-type="gif" data-w="86">；和参数化表示（解码映射），<img class="" data-ratio="0.20212765957446807" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekC8LIYgDuyXLvXpjGibBTiar5BI2wNhiciaibIgNQwAa7ujqcrONPkic8cYdAOJcYyLic3kiamq2RXja7R6A/640?wx_fmt=gif" data-type="gif" data-w="94">。编码映射将流形上的概率测度<img class="" data-ratio="1" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekC8LIYgDuyXLvXpjGibBTiarGu6lpOOuy1QlJ5AsMm8nCjTM0XM6CowfiaMo7VHOezXnxPibewDlMpSg/640?wx_fmt=gif" data-type="gif" data-w="10" style="white-space: normal;">映射到参数域（隐空间）<img class="" data-ratio="0.9285714285714286" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekC8LIYgDuyXLvXpjGibBTiar3quLDbWuzTVFRL3icNoX9nUSS6IBhibs1TLJsn3y1Q1j1A2f2cibg6rlA/640?wx_fmt=gif" data-type="gif" data-w="14">上，“推前”概率测度记为<img class="" data-ratio="0.5333333333333333" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekC8LIYgDuyXLvXpjGibBTiarf38Z4rybWdPAJawjqD3P4YUmlNL8YAJdy0eVOibBAVhL2ibA4F0ic5Myg/640?wx_fmt=gif" data-type="gif" data-w="30">。在工程应用中，我们希望能够完全控制隐空间上的（推前）概率分布<img class="" data-ratio="0.5333333333333333" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekC8LIYgDuyXLvXpjGibBTiarf38Z4rybWdPAJawjqD3P4YUmlNL8YAJdy0eVOibBAVhL2ibA4F0ic5Myg/640?wx_fmt=gif" data-type="gif" data-w="30" style="white-space: normal;">，使之等于高斯分布或者均匀分布，为此，我们构造隐空间到自身的同胚映射，<img class="" data-ratio="0.2" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekC8LIYgDuyXLvXpjGibBTiaraEic3HL8XBzl9eDfDOXosh9WCVaqM25TmCcBXSaohQOCzpreWqGgzGw/640?wx_fmt=gif" data-type="gif" data-w="95">，满足<img class="" data-ratio="0.21505376344086022" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekC8LIYgDuyXLvXpjGibBTiarOMtgIgYEvq3m0BX2CficKkjuMCYsWV5rw09YmcZF1sCCQmrQOFqkQ8Q/640?wx_fmt=gif" data-type="gif" data-w="93">等于高斯分布或者均匀分布。</p><p style="text-align: left;"><br></p><p><img class="" data-copyright="0" data-ratio="0.43951985226223456" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gendI0RTlM3c8D4t33I6m93pgEdkfFXfAbu3Ljc01Rt8us6xaP62KCu1K3AE9lYyyaY3KzFfOJbkyQ/640?wx_fmt=png" data-type="png" data-w="1083" style=""></p><p><img class="" data-copyright="0" data-ratio="0.4417744916820702" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gendI0RTlM3c8D4t33I6m93pZl25Q1p32NysNXDIIYJ8oQZk6WeLjp1bpZ4AlLH1qF1850v5tVp1pA/640?wx_fmt=png" data-type="png" data-w="1082" style=""></p><p style="text-align: center;">图2. 隐空间的同胚映射，改变概率分布。</p><p style="text-align: center;"><br></p><p style="text-align: left;">如图2所示，我们将米勒佛曲面<img class="" data-ratio="0.9166666666666666" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekC8LIYgDuyXLvXpjGibBTiargTdH2siaibxN3Cm6icOWPo1GhcapzcO6cqy1Wlcx9OOMffhSbpqLF4baw/640?wx_fmt=gif" data-type="gif" data-w="12" style="white-space: normal;">映射到平面圆盘<img class="" data-ratio="0.9285714285714286" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekC8LIYgDuyXLvXpjGibBTiar3quLDbWuzTVFRL3icNoX9nUSS6IBhibs1TLJsn3y1Q1j1A2f2cibg6rlA/640?wx_fmt=gif" data-type="gif" data-w="14" style="white-space: normal;">，<img class="" data-ratio="0.18604651162790697" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekC8LIYgDuyXLvXpjGibBTiarxdKlbWNsM0ZBkewdUB4NpZuiamk4icYO5WpWwx2LnGyEaQoibCfibvsSOQ/640?wx_fmt=gif" data-type="gif" data-w="86" style="white-space: normal;">；在平面圆盘上均匀采样，再映射回米勒佛曲面，<img class="" data-ratio="0.20212765957446807" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekC8LIYgDuyXLvXpjGibBTiar5BI2wNhiciaibIgNQwAa7ujqcrONPkic8cYdAOJcYyLic3kiamq2RXja7R6A/640?wx_fmt=gif" data-type="gif" data-w="94" style="white-space: normal;">。上面一行显示圆盘上的均匀分布映回曲面后不再是曲面上的均匀分布。下面一行显示，我们建立平面圆盘到自身的同胚映射，<img class="" data-ratio="0.2" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekC8LIYgDuyXLvXpjGibBTiaraEic3HL8XBzl9eDfDOXosh9WCVaqM25TmCcBXSaohQOCzpreWqGgzGw/640?wx_fmt=gif" data-type="gif" data-w="95" style="white-space: normal;">，这样平面圆盘上的均匀分布被映射到曲面上的均匀分布。核心问题在于如何构造隐空间的自同胚，实现两个概率测度间的变换。这方面已经有相对成熟的最优传输理论。</p><section class="" label="Copyright © 2015 Yead All Rights Reserved." style="max-width: 100%;color: rgb(51, 51, 51);"><section style="margin-right: auto;margin-left: auto;max-width: 100%;text-align: center;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><section style="margin-right: auto;margin-left: auto;max-width: 100%;overflow: hidden;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><section style="margin-top: 0.5em;margin-bottom: 0.5em;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><section style="max-width: 100%;border-width: medium;border-style: none;border-color: currentcolor;line-height: 1.5em;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><section class="" label="Copyright © 2015 Yead All Rights Reserved." style="margin: 5px auto;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><section style="margin-right: auto;margin-left: auto;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><section style="margin-right: auto;margin-left: auto;max-width: 100%;overflow: hidden;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><section style="margin-top: 0.5em;margin-bottom: 0.5em;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><section style="max-width: 100%;border-width: medium;border-style: none;border-color: currentcolor;line-height: 1.5em;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><p style="margin-top: 5px;margin-bottom: 25px;padding: 8px 23px;max-width: 100%;min-height: 1em;border-radius: 10px;color: rgb(34, 34, 34);border-top: 5px solid rgb(0, 88, 156);border-bottom: 5px solid rgb(0, 88, 156);display: inline-block;line-height: 1.75em;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;font-size: 18px;color: rgb(63, 63, 63);box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(0, 128, 255);line-height: 21.4px;font-family: 宋体;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;">最优传输理论</span></strong></span></p></section></section></section></section></section></section></section></section></section></section><p style="text-align: left;">给定欧氏空间中的两个区域和定义其上的概率测度<img class="" data-ratio="0.42857142857142855" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTibEp7FsmSAm1yNoqlDOvRWwkfhT3nBnopCzoohR5JDU961yJEb14VfQ/640?wx_fmt=gif" data-type="gif" data-w="42">和<img class="" data-ratio="0.47368421052631576" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTMfMo1tYSrHAwoJE7FdHOzlZUWZ25uyXM0KMoccTBzic3dvWX66ymcpQ/640?wx_fmt=gif" data-type="gif" data-w="38">，总测度相等<img class="" data-ratio="0.18947368421052632" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTZWtErwNlJzJTFOWmicN04DZ7bcbdvQOSWwrxkx1ic3w4pQicpYGBPQTCA/640?wx_fmt=gif" data-type="gif" data-w="95">。假设<img class="" data-ratio="0.1375" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTECYicib0NdDY7ZUDrYEP4yjgLn19QfGkHmjUuyAfBFEaZIEwKVwicZcEQ/640?wx_fmt=gif" data-type="gif" data-w="80" style="white-space: normal;">是一个区域间的映射，如果对于任意的可测集合<img class="" data-ratio="0.24489795918367346" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTsQJMsDub3OhOgvqrrsIoEIdBz8FLubTa7A4ibTqn0T23z9gWibpVsgjQ/640?wx_fmt=gif" data-type="gif" data-w="49">，都有</p><p style="text-align: center;"><img class="" data-ratio="0.3103448275862069" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTkRbhCpP7dwjAHRjQLetn14ra8gq9gekE9PnibqQ9vvcIVdowmI07AYg/640?wx_fmt=gif" data-type="gif" data-w="145">,</p><p style="text-align: left;">那么我们说此映射<span style="color: rgb(0, 82, 255);">保持测度</span>，记成<img class="" data-ratio="0.2413793103448276" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTE7vBIn3tmLfjCjyGgnIIzhZv2EpuR2WOFBH2zzEc5ORWgV477cn7Hg/640?wx_fmt=gif" data-type="gif" data-w="58">。对于任意<img class="" data-ratio="0.26666666666666666" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTaOwkcWUOUjgneCrUSxS0OZhheUI1Lugt99SJNQSw7kKbMzgrpPibSyw/640?wx_fmt=gif" data-type="gif" data-w="45">，<img class="" data-ratio="0.3333333333333333" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTNleePtL3KtZjgjq9ibj1GC84JcXAtr5FibRappjUSBAnrzhUicYsSH6oQ/640?wx_fmt=gif" data-type="gif" data-w="42">，它们之间的距离为<img class="" data-ratio="0.4090909090909091" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTvsberIoA1MicsbvPng6jKva61yicozEmcmyPYdicJ8HiaSGwmg161iaiaricA/640?wx_fmt=gif" data-type="gif" data-w="44">，那么映射的<span style="color: rgb(0, 82, 255);">传输代价</span>定义为：</p><p style="text-align: center;"><img class="" data-ratio="0.19444444444444445" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTDTCHt3vAxQlA5ibPXH2qjibVSUftw7lbWp0soxnJMfXgtgNdxOOvUxGQ/640?wx_fmt=gif" data-type="gif" data-w="216">.</p><p style="text-align: left;"><br></p><p style="text-align: left;">法国数学家蒙日（Monge）于1781年提出了著名的<span style="color: rgb(0, 82, 255);">最优传输问题</span>：寻找保持测度的传输映射<img class="" data-ratio="0.1375" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTECYicib0NdDY7ZUDrYEP4yjgLn19QfGkHmjUuyAfBFEaZIEwKVwicZcEQ/640?wx_fmt=gif" data-type="gif" data-w="80">，使得传输代价最小，<img class="" data-ratio="0.18691588785046728" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTiaXzn0cyZ1t4ia4MmukDOuWia7eO4b3XYBJ2O9jlEtop2StfianicOlFO6A/640?wx_fmt=gif" data-type="gif" data-w="107">。这个映射被称为是<span style="color: rgb(0, 82, 255);">最优传输映射</span>，最优传输映射的传输代价被称为是两个概率测度之间的Wasserstein距离，记为<img class="" data-ratio="0.3" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTFp93mqBqvC5W87c3slSpRPcXTxIVlXickHW1EZw53kv3pfbsphgeGiaw/640?wx_fmt=gif" data-type="gif" data-w="60"> 。</p><p style="text-align: left;"><br></p><p style="text-align: left;">Kantorovich将传输映射（transportation map）减弱为传输规划（transportation scheme），用联合概率分布<img class="" data-ratio="1.1111111111111112" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTSk6L1Dw9GhHicLnotLgfNUszumgNBpGyH94bI7icdKUHHiamBiciaSfDroQ/640?wx_fmt=gif" data-type="gif" data-w="9">来表示传输规划，其边际概率分布等于<img class="" data-ratio="1" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTCXiaNxdGTltSibceRIkDrqduGWdspV14icYYONGSvMFQN2f5gCsoVzsHQ/640?wx_fmt=gif" data-type="gif" data-w="10">和<img class="" data-ratio="0.7777777777777778" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTOKicNNXt2ys4BviatEVYvIcLWGNSx2n0QoJibOHtXB7yWI4A77QwgY3bw/640?wx_fmt=gif" data-type="gif" data-w="9">，即对于任意可测集合<img class="" data-ratio="0.24" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TT0xyA4AmT5th5qVLgicDmibLqalZZY2YZE1xAKaibSGK4ZMwgcHliaTAPyw/640?wx_fmt=gif" data-type="gif" data-w="50">，<img class="" data-ratio="0.24489795918367346" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTsQJMsDub3OhOgvqrrsIoEIdBz8FLubTa7A4ibTqn0T23z9gWibpVsgjQ/640?wx_fmt=gif" data-type="gif" data-w="49">，<img class="" data-ratio="0.14516129032258066" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTSGn6KufWo0G3gzmDocxrDNlmDGiaaXlL9KYZwR47dnmjZ2FL2dkU61g/640?wx_fmt=gif" data-type="gif" data-w="124">，<img class="" data-ratio="0.14173228346456693" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTnfkkcTD8d0xBcicKjnud5hjQiaVDkk22ZtxtbrbU0HibyrV3gdsK7WHoA/640?wx_fmt=gif" data-type="gif" data-w="127">，记为<img class="" data-ratio="0.18181818181818182" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTwnY03eevnszhsOUM0K0oj7P6qiaCqoRZcvyMtQpw5BqprdZnWic776Pw/640?wx_fmt=gif" data-type="gif" data-w="55">，<img class="" data-ratio="0.24074074074074073" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTA4IehSibHrQR4XRCafchCwE2FWiapUOf3onuibhC3tadPMuiaU1Ae9Tr6Q/640?wx_fmt=gif" data-type="gif" data-w="54">。Kantarovich将最优传输问题转化成 <span style="color: rgb(0, 82, 255);">Kantarovich问题</span>，Wasserstein距离等于</p><p style="text-align: left;"><br></p><p style="text-align: center;"><img class="" data-ratio="0.12640449438202248" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTZGRT5pf9hWQRnXYefQ8lv04Ip5VIbDKsh1544TCOAiat9Auo899Q2ow/640?wx_fmt=gif" data-type="gif" data-w="356"></p><p style="text-align: center;"><br></p><p style="text-align: left;">如果最优传输映射存在，那么最优联合概率分布的支集为对角线<img class="" data-ratio="0.13953488372093023" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTSeTR2rV9f6FmHHA1nqG7xJ27S9ic2dtzThiaq39vvaibjH2NiceuVsD5Ag/640?wx_fmt=gif" data-type="gif" data-w="129">。Kantarovich发明了线性规划来求解这一问题，由此得到1975年的诺贝尔经济奖。</p><p style="text-align: left;"><br></p><p style="text-align: left;">Kantarovich问题等价于其<span style="color: rgb(0, 82, 255);">对偶形式</span>， Wasserstein距离等于</p><p style="text-align: center;"><img class="" data-ratio="0.15100671140939598" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTibwwWga2qMviaxW3s8aUwYJZy7E2I5WU3qQicU1Sc36fp5u1tX3kcxuZw/640?wx_fmt=gif" data-type="gif" data-w="298">,</p><p style="text-align: left;">这里<img class="" data-ratio="0.47368421052631576" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTpnpUib4bm6NicOuU5Xg9RYE57LfhzcHm3OoJd8CA41KkQWwtHby2pxeg/640?wx_fmt=gif" data-type="gif" data-w="38">是<img class="" data-ratio="0.9090909090909091" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTN2kRs32EDqrbcPTJBHnVjpS55mXds8vGx17wdoBmdsMuTgclzS9peA/640?wx_fmt=gif" data-type="gif" data-w="11">的c-变换，</p><p style="text-align: center;"><img class="" data-ratio="0.12385321100917432" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTcQt46yXu0ic7Jgyl0k4nkiciamkdFOFGTicfPDxY0tQgf5jCDrFOtvWUVA/640?wx_fmt=gif" data-type="gif" data-w="218">。</p><p style="text-align: justify;">我们将<img class="" data-ratio="0.9090909090909091" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTN2kRs32EDqrbcPTJBHnVjpS55mXds8vGx17wdoBmdsMuTgclzS9peA/640?wx_fmt=gif" data-type="gif" data-w="11">称为<span style="color: rgb(0, 82, 255);">Kantarovich势能函数</span>。<span style="text-align: left;">如果距离函数为</span><img class="" data-ratio="0.15789473684210525" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TT7MRol2NCtIZv9gaYST4WdK7KhrZj7R4qL4dicURWJHDHJMfvymRjtFw/640?wx_fmt=gif" data-type="gif" data-w="114" style="text-align: left;"><span style="text-align: left;">，那么可以证明</span><img class="" data-ratio="0.234375" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTpCIIkBYSKZITBmheYmhKtrMKSr0ON2yyibiap9QibgicicWfptG3ibfmNpYw/640?wx_fmt=gif" data-type="gif" data-w="64" style="text-align: left;"><span style="text-align: left;">，并且</span><img class="" data-ratio="0.9090909090909091" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTN2kRs32EDqrbcPTJBHnVjpS55mXds8vGx17wdoBmdsMuTgclzS9peA/640?wx_fmt=gif" data-type="gif" data-w="11" style="text-align: left;"><span style="text-align: left;">是1-Lipsitz函数。</span></p><p style="text-align: left;"><span style="text-align: left;"><br></span></p><p style="text-align: left;"><span style="text-align: left;">二十世纪八十年代，Brenier进一步发展了Kantarovich的理论。如果采用<img class="" data-ratio="0.8823529411764706" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTVxZ7KbHWc2h3wURM2Cl1T54taN9NGjmw0yRW0bLeX3zUGeiayst73eg/640?wx_fmt=gif" data-type="gif" data-w="17">距离函数，<img class="" data-ratio="0.16541353383458646" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TT8WMh1cPPuTjIH6YhpUX4Ak2EzFAnWH4Xn1qXgSc8GtZFPj69NqsN6Q/640?wx_fmt=gif" data-type="gif" data-w="133">，那么存在一个凸函数<img class="" data-ratio="0.14285714285714285" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTLohtic6QXrMfndFbZceVxbbyfw4wwvvXZkvnRS8lHibej4ZubIMibQSNA/640?wx_fmt=gif" data-type="gif" data-w="77">，其梯度映射给出了最优传输映射，<img class="" data-ratio="0.16981132075471697" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTjd9HJQAFCAibljpibKib42FeZBTIJHqgEZEXlJlXf3Fxr8Jr9Fx7VqicEw/640?wx_fmt=gif" data-type="gif" data-w="106">。我们称这个凸函数为</span><span style="text-align: left;color: rgb(0, 82, 255);">Brenier势能函数</span><span style="text-align: left;">。那么由最优传输映射保测度，我们得到Brenier势能函数满足</span><span style="text-align: left;color: rgb(0, 82, 255);">蒙日-安培方程</span><span style="text-align: left;">，</span><br></p><p style="text-align: left;"><span style="text-align: left;"><br></span></p><p style="text-align: center;"><span style="text-align: left;"><img class="" data-ratio="0.2169811320754717" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTibJ8krQ13plSmYm4IsloJaNGibojnknMpeD51lQVEoNlictjb13HIiakhA/640?wx_fmt=gif" data-type="gif" data-w="212">。</span></p><p style="text-align: center;"><span style="text-align: left;"><br></span></p><p style="text-align: left;"><span style="text-align: left;">更进一步，在<img class="" data-ratio="0.8823529411764706" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTVxZ7KbHWc2h3wURM2Cl1T54taN9NGjmw0yRW0bLeX3zUGeiayst73eg/640?wx_fmt=gif" data-type="gif" data-w="17">距离下，最优传输映射的Kantarovich势能函数和Brenier势能函数满足简单的等式：</span></p><p style="text-align: center;"><span style="text-align: left;"><img class="" data-ratio="0.15948275862068967" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTqMMIc8WSaVHlM6ZW9DoMLD8l50rEktTgLggha9a4NMdhzmsTpzPdlw/640?wx_fmt=gif" data-type="gif" data-w="232">。</span></p><p style="text-align: center;"><span style="text-align: left;"><br></span></p><p style="text-align: center;"><span style="text-align: left;"></span></p><section class="" label="Copyright © 2015 Yead All Rights Reserved." style="white-space: normal;max-width: 100%;color: rgb(51, 51, 51);"><section style="margin-right: auto;margin-left: auto;max-width: 100%;text-align: center;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><section style="margin-right: auto;margin-left: auto;max-width: 100%;overflow: hidden;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><section style="margin-top: 0.5em;margin-bottom: 0.5em;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><section style="max-width: 100%;border-width: medium;border-style: none;border-color: currentcolor;line-height: 1.5em;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><section class="" label="Copyright © 2015 Yead All Rights Reserved." style="margin: 5px auto;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><section style="margin-right: auto;margin-left: auto;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><section style="margin-right: auto;margin-left: auto;max-width: 100%;overflow: hidden;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><section style="margin-top: 0.5em;margin-bottom: 0.5em;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><section style="max-width: 100%;border-width: medium;border-style: none;border-color: currentcolor;line-height: 1.5em;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><p style="margin-top: 5px;margin-bottom: 25px;padding: 8px 23px;max-width: 100%;min-height: 1em;border-radius: 10px;color: rgb(34, 34, 34);border-top: 5px solid rgb(0, 88, 156);border-bottom: 5px solid rgb(0, 88, 156);display: inline-block;line-height: 1.75em;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;font-size: 18px;color: rgb(63, 63, 63);box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(0, 128, 255);line-height: 21.4px;font-family: 宋体;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;">凸几何理论</span></strong></span></p></section></section></section></section></section></section></section></section></section></section><p style="text-align: left;"><span style="text-align: left;"></span>最优传输的<img class="" data-ratio="0.8823529411764706" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTVxZ7KbHWc2h3wURM2Cl1T54taN9NGjmw0yRW0bLeX3zUGeiayst73eg/640?wx_fmt=gif" data-type="gif" data-w="17" style="white-space: normal;">理论天然地和凸几何闵可夫斯基理论等价，因此我们可以用更为直观的几何观点来分析概率变换问题，从而可以将深度学习中的黑箱部分用透明的数学模型来取代。</p><p style="text-align: left;"><br></p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="1" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz/JcQsXQ30gekFqghJgmHyZrqRwl7u0rqJmQcBFsEvic3A4kcNhOzWRgwPreansISuHQ6jWQEicaR2rPeV0HiaLWhkg/640?wx_fmt=png" data-type="png" data-w="500" style="width: 338px;height: 338px;"></p><p style="text-align: center;">图3. 闵可夫斯基定理。</p><p style="text-align: center;"><br></p><p style="text-align: left;">如图3所示，给定一个凸多面体，每个面的法向量已知，面积已知，所有面的面积和法向量的乘积之和等于0，<span style="text-align: center;">闵可夫斯基（Minkowski）定理证明这样的凸多面体存在，并且彼此相差一个平移。</span></p><p style="text-align: left;"><br></p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="0.7911392405063291" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz/JcQsXQ30gekFqghJgmHyZrqRwl7u0rqJmcYIHQ2Y41EomwD2GgYme9pUfvs2fLiaiaMyu2G17yQHH0d33Vicq7Yibg/640?wx_fmt=png" data-type="png" data-w="632" style="width: 375px;height: 295px;"></p><p style="text-align: center;">图5. 亚历山大定理。</p><p style="text-align: left;"><br></p><p style="text-align: left;"><span style="text-align: center;">闵可夫斯基的学生<span style="text-align: center;">亚历山大（Alexandroff）将<span style="text-align: center;">闵可夫斯基的结果推广到开的凸多面体，如图5所示。给定凸多面体每个面的法向量，和每个面向平面圆盘的投影面积，总投影面积等于平面圆盘面积，那么这样的凸多面体存在，并且彼此相差一个垂直平移。<span style="text-align: center;">亚历山大在</span>1950年给出的证明是基于代数拓扑原理，从中无法构造算法。2013年，丘成桐先生，罗锋，孙剑和老顾给出一个基于变分法的证明【2】。证明的大致思路如下：每个面的线性方程记为<img class="" data-ratio="0.23376623376623376" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTaNicRZVlycs7TfENeRM0vicjcUuyanVPk2wIzK1E9iavibZ2B4SpcoIB3Q/640?wx_fmt=gif" data-type="gif" data-w="77">，这里梯度<img class="" data-ratio="0.8333333333333334" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTgtpibpW6ZOKCSnYNsmVzjRKJDVWQBic2qODyjUUoRnZeHxbZ6zKwBCHg/640?wx_fmt=gif" data-type="gif" data-w="12">已知，截距<img class="" data-ratio="1" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTAWqQLmsLP7706GluBjOGBfibZwPl9OxlgLPPykRfibZdjvBOeiaz2WhqA/640?wx_fmt=gif" data-type="gif" data-w="14">未知。每个平面将三维欧氏空间分成上下两个半空间，所有上半空间的交集叫做这些平面的</span></span></span><span style="text-align: center;color: rgb(0, 82, 255);">上包络，</span><span style="text-align: center;color: rgb(0, 0, 0);">上包络的边界即为凸多面体。我们通过改变截距来调节每个面的投影面积。<span style="text-align: center;"> 亚历山大定理中的截距优化下面的凹能量，</span></span></p><p style="text-align: left;"><span style="text-align: center;color: rgb(0, 0, 0);"><span style="text-align: center;"><br></span></span></p><p style="text-align: center;"><span style="text-align: center;color: rgb(0, 0, 0);"><span style="text-align: center;"><img class="" data-ratio="0.15384615384615385" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTib5v77icKD7kD2ssDibG03cLLEqJEzFE8Y23IicF8vRN47kpEGjdx4FvNg/640?wx_fmt=gif" data-type="gif" data-w="351">,</span></span></p><p style="text-align: left;"><span style="text-align: center;color: rgb(0, 0, 0);"><span style="text-align: center;"><br></span></span></p><p style="text-align: left;">这里<img class="" data-ratio="0.22784810126582278" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTst3wYyZicPOfD5iasyXp3ibZ5Re2TCU0MA1Jr1Z19Qt5eQx0YGEXA1Ruw/640?wx_fmt=gif" data-type="gif" data-w="79">是每个面的目标投影面积，<img class="" data-ratio="0.20689655172413793" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTYHsgJcDQeyeEEbDwtPumECgs0UhFWwdMniadiaDcYxib56dxnbYKwF17g/640?wx_fmt=gif" data-type="gif" data-w="87">是每个面的当前面积。可以证明，这个能量在子空间<img class="" data-ratio="0.19327731092436976" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gen7NqFic7ZgPReXoGhG6mJzibwvoB6znr5jroH3g9Jvg5iaoiarlKRruRmsveI5jNukyRzO3G0ic8CnaVg/640?wx_fmt=gif" data-type="gif" data-w="119">上是严格凹的，其梯度和海森矩阵都有明确的几何意义，因此可以用牛顿法快速求解。</p><p style="text-align: left;"><br></p><p style="text-align: left;">这一理论可以直接推广到任意维，证明不需要改动。</p><section class="" label="Copyright © 2015 Yead All Rights Reserved." style="white-space: normal;max-width: 100%;color: rgb(51, 51, 51);"><section style="margin-right: auto;margin-left: auto;max-width: 100%;text-align: center;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><section style="margin-right: auto;margin-left: auto;max-width: 100%;overflow: hidden;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><section style="margin-top: 0.5em;margin-bottom: 0.5em;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><section style="max-width: 100%;border-width: medium;border-style: none;border-color: currentcolor;line-height: 1.5em;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><section class="" label="Copyright © 2015 Yead All Rights Reserved." style="margin: 5px auto;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><section style="margin-right: auto;margin-left: auto;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><section style="margin-right: auto;margin-left: auto;max-width: 100%;overflow: hidden;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><section style="margin-top: 0.5em;margin-bottom: 0.5em;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><section style="max-width: 100%;border-width: medium;border-style: none;border-color: currentcolor;line-height: 1.5em;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><p style="margin-top: 5px;margin-bottom: 25px;padding: 8px 23px;max-width: 100%;min-height: 1em;border-radius: 10px;color: rgb(34, 34, 34);border-top: 5px solid rgb(0, 88, 156);border-bottom: 5px solid rgb(0, 88, 156);display: inline-block;line-height: 1.75em;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;font-size: 18px;color: rgb(63, 63, 63);box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(0, 128, 255);line-height: 21.4px;font-family: 宋体;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;">Brenier理论，Alexandroff理论的等价关系</span></strong></span></p></section></section></section></section></section></section></section></section></section></section><p>最优传输的Brenier理论和凸几何的Alexandroff理论本质上是等价的。下面我们来具体分析。</p><p><br></p><p><img class="" data-copyright="0" data-ratio="0.5255555555555556" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz/JcQsXQ30gekH4mQ6ibwpp2ZYYFibSvAxHw4n807GX7niaLZh4dt7W70FNldftvhqnUib3kgBsx9icnmuZxDV970W6cw/640?wx_fmt=png" data-type="png" data-w="900" style=""></p><p style="text-align: center;">图6. 离散最优传输问题。</p><p><br></p><p>图6显示了离散最优传输问题。目标概率测度为离散的Dirac测度，</p><p style="text-align: center;"><img class="" data-ratio="0.3724137931034483" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTWY4D6cGySVwCuVMa0CjQCN6JXqrx8OttlAtHQek63RbFQk0360HWAw/640?wx_fmt=gif" data-type="gif" data-w="145">,</p><p style="text-align: left;">源概率测度是单位圆盘上的均匀分布。我们希望找到单位圆盘上的一个剖分，每个胞腔<img class="" data-ratio="0.7" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTLtJdK4kUqjaTKYg98am6xjTy3cAmYw5wvRlJNia6chXDlfONGj2qxlQ/640?wx_fmt=gif" data-type="gif" data-w="20">映射到一个目标点<img class="" data-ratio="0.8333333333333334" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTgtpibpW6ZOKCSnYNsmVzjRKJDVWQBic2qODyjUUoRnZeHxbZ6zKwBCHg/640?wx_fmt=gif" data-type="gif" data-w="12">，<img class="" data-ratio="0.16470588235294117" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTJza95KpOC18GQJBUdicRJTJA3xCw8icrQC6SIawEpW51OBBn8r49dJyw/640?wx_fmt=gif" data-type="gif" data-w="85">，并且胞腔<img class="" data-ratio="0.7" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTLtJdK4kUqjaTKYg98am6xjTy3cAmYw5wvRlJNia6chXDlfONGj2qxlQ/640?wx_fmt=gif" data-type="gif" data-w="20" style="white-space: normal;">的面积等于目标测度<img class="" data-ratio="0.8333333333333334" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTBkjQicOB2usY0WJ11iaFMbeOY4UTIvFT3v2BrdEmP82qW6Q1OSCdUrJg/640?wx_fmt=gif" data-type="gif" data-w="12">。在所有的这种剖分中，找到一个特定的剖分，极小化传输代价，</p><p style="text-align: center;"><img class="" data-ratio="0.2" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTIxiaAcNukbbL7TVmCja4WSjrqC4Pkgmmcj5fu1Hhajkz3UqB9Qrf1kQ/640?wx_fmt=gif" data-type="gif" data-w="210">。</p><p><br></p><p><img class="" data-copyright="0" data-ratio="0.5555555555555556" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz/JcQsXQ30gekH4mQ6ibwpp2ZYYFibSvAxHwEoHTF4scf0aQ4WnNTfcRyRBeO2ssusHH2U4wL81Ohq20Nqia5X58fYQ/640?wx_fmt=png" data-type="png" data-w="900" style=""></p><p style="text-align: center;">图7. 离散Brenier势能函数的构造。</p><p><br></p><p style="text-align: left;">根据Brenier理论，存在一个凸函数，其梯度映射给出最优传输映射。对于每一个目标点<img class="" data-ratio="0.8333333333333334" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTgtpibpW6ZOKCSnYNsmVzjRKJDVWQBic2qODyjUUoRnZeHxbZ6zKwBCHg/640?wx_fmt=gif" data-type="gif" data-w="12" style="white-space: normal;">，构成一个平面其梯度等于<img class="" data-ratio="0.8333333333333334" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTgtpibpW6ZOKCSnYNsmVzjRKJDVWQBic2qODyjUUoRnZeHxbZ6zKwBCHg/640?wx_fmt=gif" data-type="gif" data-w="12" style="white-space: normal;">，<img class="" data-ratio="0.23376623376623376" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTaNicRZVlycs7TfENeRM0vicjcUuyanVPk2wIzK1E9iavibZ2B4SpcoIB3Q/640?wx_fmt=gif" data-type="gif" data-w="77" style="text-align: center;white-space: normal;">，其上包络给出Brenier势能函数，每个面的投影面积等于<img class="" data-ratio="0.8333333333333334" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTBkjQicOB2usY0WJ11iaFMbeOY4UTIvFT3v2BrdEmP82qW6Q1OSCdUrJg/640?wx_fmt=gif" data-type="gif" data-w="12">。由此我们看到Brenier定理和Alexandroff定理本质相同。</p><p><br></p><p><img class="" data-copyright="0" data-ratio="0.5" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz/JcQsXQ30genNFwIcsJwBx6uIbdzafxVOiciaD1Bf7hTVib0pLR7dvb1uVeTFQbAz7TuRLUr9Nz8JGkkd1I4CIr9UQ/640?wx_fmt=png" data-type="png" data-w="900" style=""></p><p><img class="" data-copyright="0" data-ratio="0.5" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz/JcQsXQ30genNFwIcsJwBx6uIbdzafxVOPLCosHPBOuEXFoHkaHGkSwLXHwlwKiaFFu3iaXkSXs7ltesL60spGdyA/640?wx_fmt=png" data-type="png" data-w="900" style=""></p><p style="text-align: center;">图6. 最优传输映射的计算实例。</p><p style="text-align: center;"><br></p><p style="text-align: left;">图6显示了这种方法的一个计算实例，首先我们将滴水兽曲面用黎曼映照映射到平面单位圆盘，黎曼映射的像如下行左帧所示，那么曲面的面元诱导了平面圆盘上的一个测度。平面圆盘上的欧氏面元定义了均匀测度。我们用上面讲述的变分法来构造平面圆盘到自身的最优传输映射，最优传输映射的像如下行右帧所示。那么最优传输映射的结果给出了从曲面到平面圆盘的保面元映射。<br></p><p style="text-align: left;"><br></p><section class="" label="Copyright © 2015 Yead All Rights Reserved." style="white-space: normal;max-width: 100%;color: rgb(51, 51, 51);"><section style="margin-right: auto;margin-left: auto;max-width: 100%;text-align: center;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><section style="margin-right: auto;margin-left: auto;max-width: 100%;overflow: hidden;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><section style="margin-top: 0.5em;margin-bottom: 0.5em;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><section style="max-width: 100%;border-width: medium;border-style: none;border-color: currentcolor;line-height: 1.5em;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><section class="" label="Copyright © 2015 Yead All Rights Reserved." style="margin: 5px auto;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><section style="margin-right: auto;margin-left: auto;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><section style="margin-right: auto;margin-left: auto;max-width: 100%;overflow: hidden;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><section style="margin-top: 0.5em;margin-bottom: 0.5em;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><section style="max-width: 100%;border-width: medium;border-style: none;border-color: currentcolor;line-height: 1.5em;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><p style="margin-top: 5px;margin-bottom: 25px;padding: 8px 23px;max-width: 100%;min-height: 1em;border-radius: 10px;color: rgb(34, 34, 34);border-top: 5px solid rgb(0, 88, 156);border-bottom: 5px solid rgb(0, 88, 156);display: inline-block;line-height: 1.75em;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;font-size: 18px;color: rgb(63, 63, 63);box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(0, 128, 255);line-height: 21.4px;font-family: 宋体;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;">对抗生成网络（GAN）</span></strong></span></p></section></section></section></section></section></section></section></section></section></section><p style="text-align: left;"><span style="color: rgb(51, 51, 51);">2014年，<span style="color: rgb(51, 51, 51);">Goodfellow </span>提出了GAN的概念，他的解释如下：GAN的核心思想是构造两个深度神经网络：判别器D和生成器G，用户为GAN提供一些真实货币作为训练样本，生成器G生成假币来欺骗判别器D，判别器D判断一张货币是否来自真实样本还是G生成的伪币；判别器和生成器交替训练，能力在博弈中同步提高，最后达到平衡点的时候判别器无法区分样本的真伪，生成器的伪造功能炉火纯青，生成的货币几可乱真。这种计算机左右手互搏的对抗图景，使得GAN成为最为吸引人的深度学习模型。</span></p><p style="text-align: left;"><span style="color: rgb(51, 51, 51);"><img src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gel9tsvL8ZQK7vSy03p6CicRwHXwIv12OW3nJXPPSY3dHMsFgic8HeyBb07fQfsLzT7xQWdkhB7cEKdw/640?wx_fmt=png" data-type="png" class="" data-ratio="0.43125" data-w="640"></span></p><p style="text-align: left;"><span style="color: rgb(51, 51, 51);"></span></p><p style="max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);text-align: center;">图7. WassersteinGAN的理论框架。<br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></p><p style="max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></p><p style="max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);">图7显示了Wasserstein GAN的理论框架。假设在隐空间有一个固定的概率分布<img class="" data-ratio="0.26865671641791045" src="http://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gelXYwM3lvdqXJnky1Ut52h7C0RfkJ85ic2ZjNuKuyTf4zPZt7HftfXyOHCXd8YojwMoviaHJLsHRGRQ/640?wx_fmt=png" data-type="png" data-w="67" style="box-sizing: border-box !important;word-wrap: break-word !important;width: auto !important;visibility: visible !important;">，例如高斯分布或者均匀分布。我们用一个深度神经网络<img class="" data-ratio="1.375" src="http://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gelXYwM3lvdqXJnky1Ut52h7jgiaUyACrIw2sMiaMJF8OceSXoZ5ib2Ps90gcmhh3y4NDWwdLXxdOd1Mw/640?wx_fmt=png" data-type="png" data-w="8" style="box-sizing: border-box !important;word-wrap: break-word !important;width: auto !important;visibility: visible !important;">来逼近解码映射<img class="" data-ratio="0.18292682926829268" src="http://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gelXYwM3lvdqXJnky1Ut52h7g3f8XWQwzyrNkeV556DlTLrUnib0icfGWlDBZvSW2bOaDSrlnZjINwHA/640?wx_fmt=png" data-type="png" data-w="82" style="box-sizing: border-box !important;word-wrap: break-word !important;width: auto !important;visibility: visible !important;">，<img class="" data-ratio="0.7142857142857143" src="http://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gelXYwM3lvdqXJnky1Ut52h7Z5wnVPMFxyap41HiamBNoFqZ14UX52muFeKg6hjWXwtx9WKhu555ibrg/640?wx_fmt=png" data-type="png" data-w="14" style="box-sizing: border-box !important;word-wrap: break-word !important;width: auto !important;visibility: visible !important;">将<img class="" data-ratio="1.75" src="http://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gelXYwM3lvdqXJnky1Ut52h7xc4gPjYDgF2SBo23H51KiapjDkdFIicca85nl7JOATQuyGN1qj5Y3cOQ/640?wx_fmt=png" data-type="png" data-w="8" style="box-sizing: border-box !important;word-wrap: break-word !important;width: auto !important;visibility: visible !important;">映成了图像空间中的概率分布</p><p style="max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);"><img class="" data-ratio="0.1935483870967742" src="http://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gelXYwM3lvdqXJnky1Ut52h7rkmllZqiaKvUvDhhszAUBoAJgr0c0ZIwq35jZrUBJ9P3WGmcWoC01ibg/640?wx_fmt=png" data-type="png" data-w="93" style="box-sizing: border-box !important;word-wrap: break-word !important;width: auto !important;visibility: visible !important;">,</p><p style="max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);">我们称<img class="" data-ratio="0.625" src="http://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gelXYwM3lvdqXJnky1Ut52h7mic21iaEiaZOVzk1kiaFaAiawticvvgtBXNOphzy32gN8xEJ06SJiaA7pwjNw/640?wx_fmt=png" data-type="png" data-w="16" style="box-sizing: border-box !important;word-wrap: break-word !important;width: auto !important;visibility: visible !important;">为生成分布。判别器的核心任务是计算训练数据分布<img class="" data-ratio="0.7777777777777778" src="http://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gelXYwM3lvdqXJnky1Ut52h7vGM6RlKhbPpJQO2iapKBElibDn5btp85jiabYPbicPmSApd6hrAq6YIbZQ/640?wx_fmt=png" data-type="png" data-w="9" style="box-sizing: border-box !important;word-wrap: break-word !important;width: auto !important;visibility: visible !important;">和生成分布<img class="" data-ratio="0.625" src="http://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gelXYwM3lvdqXJnky1Ut52h7mic21iaEiaZOVzk1kiaFaAiawticvvgtBXNOphzy32gN8xEJ06SJiaA7pwjNw/640?wx_fmt=png" data-type="png" data-w="16" style="box-sizing: border-box !important;word-wrap: break-word !important;width: auto !important;visibility: visible !important;">之间的距离；生成器的目的在于调节<img class="" data-ratio="0.7142857142857143" src="http://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gelXYwM3lvdqXJnky1Ut52h7Z5wnVPMFxyap41HiamBNoFqZ14UX52muFeKg6hjWXwtx9WKhu555ibrg/640?wx_fmt=png" data-type="png" data-w="14" style="box-sizing: border-box !important;word-wrap: break-word !important;width: auto !important;visibility: visible !important;">使得生成分布<img class="" data-ratio="0.625" src="http://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gelXYwM3lvdqXJnky1Ut52h7mic21iaEiaZOVzk1kiaFaAiawticvvgtBXNOphzy32gN8xEJ06SJiaA7pwjNw/640?wx_fmt=png" data-type="png" data-w="16" style="box-sizing: border-box !important;word-wrap: break-word !important;width: auto !important;visibility: visible !important;">尽量接近数据分布<img class="" data-ratio="0.7777777777777778" src="http://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gelXYwM3lvdqXJnky1Ut52h7vGM6RlKhbPpJQO2iapKBElibDn5btp85jiabYPbicPmSApd6hrAq6YIbZQ/640?wx_fmt=png" data-type="png" data-w="9" style="box-sizing: border-box !important;word-wrap: break-word !important;width: auto !important;visibility: visible !important;">。换言之，<span style="color: rgb(0, 82, 255);">判别器计算Wasserstein距离；生成器计算最优传输映射</span>。</p><p style="max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);"><br></p><p style="max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);">判别器计算测度间的Wasserstein距离，等价于求解Kantarovich势能函数。如果距离函数为<img class="" data-ratio="0.15789473684210525" src="http://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gelXYwM3lvdqXJnky1Ut52h7m3QswnZTxsJgaLDOWRHeSuYP5odevXfsy934KBRRUA5ibjzmpic7hn3w/640?wx_fmt=png" data-type="png" data-w="114" style="box-sizing: border-box !important;word-wrap: break-word !important;width: auto !important;visibility: visible !important;">，Kantorovich势能为1-Lipsitz，并且<img class="" data-ratio="0.234375" src="http://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gelXYwM3lvdqXJnky1Ut52h7PfSWvnRibg4ch0HjEjVWyk4oibAEPa19LGib4AEP97VO4licczrlOr8YLg/640?wx_fmt=png" data-type="png" data-w="64" style="box-sizing: border-box !important;word-wrap: break-word !important;width: auto !important;visibility: visible !important;">。这里Kantorovich势能由一个深度神经网络<img class="" data-ratio="1.75" src="http://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gelXYwM3lvdqXJnky1Ut52h7eKP11FMHbdzgicY5RcFqRoCCVz0tibyjc3KYGdlmU4cP6E585aia3lgicA/640?wx_fmt=png" data-type="png" data-w="8" style="box-sizing: border-box !important;word-wrap: break-word !important;width: auto !important;visibility: visible !important;">来计算，记为<img class="" data-ratio="0.7647058823529411" src="http://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gelXYwM3lvdqXJnky1Ut52h7Vp2Uk1fnJ8zE5Qwb7PSFvtianXlTQt6icOyF2y3B4PmibXeRJqibzX6h6w/640?wx_fmt=png" data-type="png" data-w="17" style="box-sizing: border-box !important;word-wrap: break-word !important;width: auto !important;visibility: visible !important;">。Wasserstein距离为</p><p style="max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);text-align: center;"><img class="" data-ratio="0.14285714285714285" src="http://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gelXYwM3lvdqXJnky1Ut52h7pEJSGRMwg5qpmGPnwowss6DrtpyawRy2UXj6yHSkOUnc3SbywP5otg/640?wx_fmt=png" data-type="png" data-w="315" style="box-sizing: border-box !important;word-wrap: break-word !important;width: auto !important;visibility: visible !important;">。</p><p style="max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);">生成器极小化Wasserstein距离，<img class="" data-ratio="0.17142857142857143" src="http://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gelXYwM3lvdqXJnky1Ut52h7KjApPIPReeeGibVicVp2G9a8k8WjpPmnIakMsdsstXIhWRpRZqnG9fWA/640?wx_fmt=png" data-type="png" data-w="105" style="box-sizing: border-box !important;word-wrap: break-word !important;width: auto !important;visibility: visible !important;">。所以整个WGAN进行极小-极大优化：</p><p style="max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);text-align: center;"><img class="" data-ratio="0.140625" src="http://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gelXYwM3lvdqXJnky1Ut52h7FC9ur4lHysqjFPQ90wVs48BD3rfY1gJcQPmicX32jk2RoYeMw2HRy1Q/640?wx_fmt=png" data-type="png" data-w="320" style="box-sizing: border-box !important;word-wrap: break-word !important;width: auto !important;visibility: visible !important;">。</p><p style="max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></p><p style="max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);">生成器极大化，判别器极小化，各自由一个深度网络交替完成。在优化过程中，解码映射<img class="" data-ratio="0.7142857142857143" src="http://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gelXYwM3lvdqXJnky1Ut52h7Z5wnVPMFxyap41HiamBNoFqZ14UX52muFeKg6hjWXwtx9WKhu555ibrg/640?wx_fmt=png" data-type="png" data-w="14" style="box-sizing: border-box !important;word-wrap: break-word !important;width: auto !important;visibility: visible !important;">和Kantorovich势能函数<img class="" data-ratio="0.7647058823529411" src="http://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gelXYwM3lvdqXJnky1Ut52h7Vp2Uk1fnJ8zE5Qwb7PSFvtianXlTQt6icOyF2y3B4PmibXeRJqibzX6h6w/640?wx_fmt=png" data-type="png" data-w="17" style="box-sizing: border-box !important;word-wrap: break-word !important;width: auto !important;visibility: visible !important;">彼此独立。</p><p style="text-align: left;"><span style="color: rgb(51, 51, 51);"><br></span>如果，我们用<img class="" data-ratio="0.8823529411764706" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTVxZ7KbHWc2h3wURM2Cl1T54taN9NGjmw0yRW0bLeX3zUGeiayst73eg/640?wx_fmt=gif" data-type="gif" data-w="17">距离函数，<img class="" data-ratio="0.16541353383458646" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TT8WMh1cPPuTjIH6YhpUX4Ak2EzFAnWH4Xn1qXgSc8GtZFPj69NqsN6Q/640?wx_fmt=gif" data-type="gif" data-w="133">，那么Wasserstein距离由Kantarovich势能函数<img class="" data-ratio="0.9090909090909091" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTN2kRs32EDqrbcPTJBHnVjpS55mXds8vGx17wdoBmdsMuTgclzS9peA/640?wx_fmt=gif" data-type="gif" data-w="11">给出，最优传输映射由Brenier势能<img class="" data-ratio="0.7" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTtajUnRafacXJ2cPqL7rqoxsc2cVY6jRUYKh65JWgwk1KZYonbS35Lw/640?wx_fmt=gif" data-type="gif" data-w="10">给出。在<img class="" data-ratio="0.8823529411764706" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTVxZ7KbHWc2h3wURM2Cl1T54taN9NGjmw0yRW0bLeX3zUGeiayst73eg/640?wx_fmt=gif" data-type="gif" data-w="17">距离下，最优传输映射的Kantarovich势能函数和Brenier势能函数满足简单的等式：</p><p style="white-space: normal;text-align: center;"><span style="text-align: left;"><img class="" data-ratio="0.15948275862068967" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTqMMIc8WSaVHlM6ZW9DoMLD8l50rEktTgLggha9a4NMdhzmsTpzPdlw/640?wx_fmt=gif" data-type="gif" data-w="232">，</span></p><p style="white-space: normal;text-align: left;"><span style="text-align: left;">这意味着：在最优情况下，</span><span style="text-align: left;color: rgb(0, 82, 255);">判别器D由生成器G的结果直接给出；生成器G由判别器D的结果直接给出；判别器D和生成器G之间的对抗是虚拟的；判别器网络和生成器网络是冗余的</span><span style="text-align: left;">。这和人们对于GAN模型生成器、判别器相克相生的想象大相径庭。</span></p><section class="" label="Copyright © 2015 Yead All Rights Reserved." style="white-space: normal;max-width: 100%;color: rgb(51, 51, 51);"><section style="margin-right: auto;margin-left: auto;max-width: 100%;text-align: center;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><section style="margin-right: auto;margin-left: auto;max-width: 100%;overflow: hidden;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><section style="margin-top: 0.5em;margin-bottom: 0.5em;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><section style="max-width: 100%;border-width: medium;border-style: none;border-color: currentcolor;line-height: 1.5em;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><section class="" label="Copyright © 2015 Yead All Rights Reserved." style="margin: 5px auto;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><section style="margin-right: auto;margin-left: auto;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><section style="margin-right: auto;margin-left: auto;max-width: 100%;overflow: hidden;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><section style="margin-top: 0.5em;margin-bottom: 0.5em;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><section style="max-width: 100%;border-width: medium;border-style: none;border-color: currentcolor;line-height: 1.5em;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><p style="margin-top: 5px;margin-bottom: 25px;padding: 8px 23px;max-width: 100%;min-height: 1em;border-radius: 10px;color: rgb(34, 34, 34);border-top: 5px solid rgb(0, 88, 156);border-bottom: 5px solid rgb(0, 88, 156);display: inline-block;line-height: 1.75em;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;font-size: 18px;color: rgb(63, 63, 63);box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(0, 128, 255);line-height: 21.4px;font-family: 宋体;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;">半透明深度网络模型</span></strong></span></p></section></section></section></section></section></section></section></section></section></section><p style="white-space: normal;text-align: left;"><span style="text-align: left;"></span></p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="0.6815789473684211" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTLc4h2Ak1mtdLGc7OhKwcQqhVJjI1Tv3YqWNMe1ibzvFQRuicE7CRv6eg/640?wx_fmt=png" data-type="png" data-w="760" style=""></p><p style="text-align: center;">图8. <span style="color: rgb(0, 0, 0);"><strong style="color: rgb(63, 63, 63);font-size: 18px;text-align: center;white-space: normal;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;line-height: 21.4px;font-family: 宋体;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;">半透明深度网络模型</span></strong></span>。</p><p style="text-align: center;"><br></p><p style="text-align: left;">传统的变分自动编码器VAE核心想法是将隐空间的概率分布变换成高斯分布，手法相当曲折。<br></p><p style="text-align: left;"><br></p><p style="text-align: left;">因为概率变换可以用最优传输理论来清晰阐释，并且用牛顿法优化凸能量可以保证全局最优性，和高阶收敛速度，我们可以将深度学习中的概率变换部分分离出来，用透明的数学模型来取代，其他部分依然用传统的黑箱来运算，如此得到了半透明的网络模型【4】。</p><p style="text-align: left;"><br></p><p style="text-align: left;">如图8所示，我们将GAN和VAE进行改进，流形的编码解码映射依然用autoencoder来计算，数据分布<strong><img class="" data-ratio="0.7777777777777778" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTOKicNNXt2ys4BviatEVYvIcLWGNSx2n0QoJibOHtXB7yWI4A77QwgY3bw/640?wx_fmt=gif" data-type="gif" data-w="9"></strong>被编码映射<img class="" data-ratio="0.1875" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TT2CM7VvhRg5nGPIFLY3VDYiaic5JQS6yNCZhSScqRibX8LBa4p3bFCR4Cg/640?wx_fmt=gif" data-type="gif" data-w="80">推前到隐空间，得到分布。我们再计算隐空间的最优传输映射，<img class="" data-ratio="0.15384615384615385" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTzwjX6o68dRWGtpV491gQTxTgxibhxiaicYSgsgZJBO0cOYM6tZIV80uWg/640?wx_fmt=gif" data-type="gif" data-w="78">，将均匀分布变换成推前概率分布。隐空间的最优传输映射可以用透明的几何方法计算。</p><p style="text-align: left;"><br></p><p><img class="" data-copyright="0" data-ratio="0.4787714543812105" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TT56FXQf7FM9Cia6ZVNPzjrAX9P0iaDAJZlkQGM0FO5BicjfN6M8tQKoibhg/640?wx_fmt=png" data-type="png" data-w="1107" style=""></p><p style="text-align: center;">real digits and VAE results</p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="0.4787714543812105" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTj9ibibzIVO4mciaLbZANWQgEnzdQiaGlnwwFlG8mfnibXZibF5M68xnbdeAQ/640?wx_fmt=png" data-type="png" data-w="1107" style=""></p><p style="white-space: normal;text-align: center;"><span style="text-align: left;"></span>WGAN and AE-OMT</p><p style="white-space: normal;text-align: center;"><br></p><p style="white-space: normal;text-align: center;">图9. 半透明网络的计算结果和其他模型的计算结果比较。</p><p style="white-space: normal;text-align: center;"><br></p><p style="text-align: left;">我们将半透明网络做为生成模型，在手写体数据集合上进行测试。如图9所示，半透明网络的计算结果优于传统的VAE和WGAN结果。</p><p style="text-align: left;"><br></p><p style="text-align: center;"><img class="" data-copyright="0" data-ratio="0.49150943396226415" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTr8VzBaOrF5zGXTzP5o1Ix8u0EvfpibTvnTOQl8bNIMgAichMg2MhGfCw/640?wx_fmt=png" data-type="png" data-w="1060" style=""></p><p style="text-align: center;">图10. VAE和半透明网络比较。</p><p style="text-align: center;"><br></p><p style="text-align: left;">我们将半透明网络做为生成模型，在人脸图片数据集合上进行测试。如图10所示，半透明网络的计算结果优于传统的VAE结果。</p><section class="" label="Copyright © 2015 Yead All Rights Reserved." style="white-space: normal;max-width: 100%;color: rgb(51, 51, 51);"><section style="margin-right: auto;margin-left: auto;max-width: 100%;text-align: center;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><section style="margin-right: auto;margin-left: auto;max-width: 100%;overflow: hidden;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><section style="margin-top: 0.5em;margin-bottom: 0.5em;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><section style="max-width: 100%;border-width: medium;border-style: none;border-color: currentcolor;line-height: 1.5em;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><section class="" label="Copyright © 2015 Yead All Rights Reserved." style="margin: 5px auto;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><section style="margin-right: auto;margin-left: auto;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><section style="margin-right: auto;margin-left: auto;max-width: 100%;overflow: hidden;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><section style="margin-top: 0.5em;margin-bottom: 0.5em;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><section style="max-width: 100%;border-width: medium;border-style: none;border-color: currentcolor;line-height: 1.5em;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><p style="margin-top: 5px;margin-bottom: 25px;padding: 8px 23px;max-width: 100%;min-height: 1em;border-radius: 10px;color: rgb(34, 34, 34);border-top: 5px solid rgb(0, 88, 156);border-bottom: 5px solid rgb(0, 88, 156);display: inline-block;line-height: 1.75em;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;font-size: 18px;color: rgb(63, 63, 63);box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(0, 128, 255);line-height: 21.4px;font-family: 宋体;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;">小结</span></strong></span></p></section></section></section></section></section></section></section></section></section></section><p style="white-space: normal;">最优传输理论可以用于解释深度学习中的概率分布变换。<img class="" data-ratio="0.8823529411764706" src="https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gekZ6ibUskCXqNm4ImvCdn0TTVxZ7KbHWc2h3wURM2Cl1T54taN9NGjmw0yRW0bLeX3zUGeiayst73eg/640?wx_fmt=gif" data-type="gif" data-w="17" style="white-space: normal;">最优传输的Brenier理论和凸几何中的Alexandroff理论等价，我们的理论结果给出了基于变分法的构造。在这种情形下，生成器和判别器彼此等价，它们之间的对抗不再需要，网络体系结构可以大幅简化。在深度学习中，我们可以将流形降维和概率变换分开，用透明的最优传输模型来部分取代黑箱，得到半透明网络模型。</p><p style="white-space: normal;"><br></p><hr style="max-width: 100%;color: rgb(51, 51, 51);"><p style="max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></p><p style="max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);">References</p><p style="max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);">                                         </p><ol class=" list-paddingleft-2" style=""><li><p style="max-width: 100%;min-height: 1em;color: rgb(62, 62, 62);font-size: 16px;text-align: left;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(34, 34, 34);font-family: sans-serif;box-sizing: border-box !important;word-wrap: break-word !important;">Na Lei, Zhongxuan</span><span style="max-width: 100%;color: rgb(34, 34, 34);font-family: sans-serif;box-sizing: border-box !important;word-wrap: break-word !important;"> Luo, Shing-Tung Yau and David Xianfeng Gu.  "Geometric Understanding of Deep Learning". </span><span style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;">arXiv</span><span style="max-width: 100%;color: rgb(34, 34, 34);font-family: sans-serif;box-sizing: border-box !important;word-wrap: break-word !important;">:1805.10451 . </span></p><p style="max-width: 100%;min-height: 1em;color: rgb(62, 62, 62);font-size: 16px;text-align: left;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(34, 34, 34);font-family: sans-serif;box-sizing: border-box !important;word-wrap: break-word !important;"></span><span style="max-width: 100%;color: rgb(34, 34, 34);font-family: sans-serif;box-sizing: border-box !important;word-wrap: break-word !important;">https://arxiv.org/abs/1805.10451</span></p></li><li><p style="max-width: 100%;min-height: 1em;text-align: left;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(34, 34, 34);font-family: sans-serif;box-sizing: border-box !important;word-wrap: break-word !important;">Xianfeng Gu, Feng Luo, Jian Sun, and Shing-Tung Yau. "Variational principles for minkowski type problems, discrete optimal transport", and discrete monge-ampere equations. Asian Journal of Mathematics (AJM), 20(2):383-398, 2016.</span></p></li><li><p style="max-width: 100%;min-height: 1em;text-align: left;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(34, 34, 34);font-family: sans-serif;box-sizing: border-box !important;word-wrap: break-word !important;">Na Lei,Kehua Su,Li Cui,Shing-Tung Yau,David Xianfeng Gu, "A Geometric View of Optimal Transportation and Generative Model", arXiv:1710.05488. https://arxiv.org/abs/1710.05488</span></p></li><li><p style="max-width: 100%;min-height: 1em;text-align: left;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(34, 34, 34);font-family: sans-serif;box-sizing: border-box !important;word-wrap: break-word !important;">Huidong L，Xianfeng Gu, Dimitris Samaras, "A Two-Step Computation of the Exact GAN Wasserstein Distance", ICML 2018.</span></p></li></ol><hr style="max-width: 100%;color: rgb(51, 51, 51);"><p style="max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"></p><p style="max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);text-align: center;"><span style="max-width: 100%;font-size: 14px;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(255, 0, 0);box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;">请长按下方二维码，选择 </span></strong><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(0, 112, 192);box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;">“识别图中二维码”</span></strong>，<span style="max-width: 100%;color: rgb(255, 0, 0);box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;">即可</strong></span><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(255, 0, 0);box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;">关注。</span></strong></span></p><p style="max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);text-align: center;"><img class="" data-ratio="1" data-s="300,640" src="http://mmbiz.qpic.cn/mmbiz/JcQsXQ30gelOVETohsich3cia5IMMJiboNDlSr36r7Ktrq0PWjKrFPT8uGibibsE1K7T7Hf5iaItCzhUAsKHu4zIGiaew/640?" data-type="png" data-w="430" style="box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;visibility: visible !important;width: 430px !important;" width="430px"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"></p><p style="max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);"><span style="max-width: 100%;font-size: 14px;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;">【老顾谈几何】邀请国内国际著名纯粹数学家，应用数学家，理论物理学家和计算机科学家，讲授现代拓扑和几何的理论，算法和应用。</span></p><p style="max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"></p><p style="max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);"><span style="max-width: 100%;font-size: 14px;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;">回复“<strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(255, 41, 65);box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;">目录</span></strong>”，可以浏览往期精华；回复“<strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(255, 41, 65);box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;">智商</span></strong>”，可以阅读“<span style="max-width: 100%;color: rgb(255, 41, 65);box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;">如何从大脑形状判断一个人的智商</strong></span>”；回复“<strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(255, 41, 65);box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;">象牙塔</span></strong>”，可以阅读“<strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(255, 41, 65);box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;">纯粹数学走出象牙塔</span></strong>”；回复“<span style="max-width: 100%;color: rgb(255, 41, 65);box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;">概览</strong></span>”，可以阅读“<span style="max-width: 100%;color: rgb(255, 41, 65);box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;">计算共形几何概览</strong></span>”。</span></p><p><span style="max-width: 100%;font-size: 14px;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><br></span></p><p style="text-align: left;"><br></p>
                </div>
                <script nonce="31319996" type="text/javascript">
                    var first_sceen__time = (+new Date());

                    if ("" == 1 && document.getElementById('js_content')) {
                        document.getElementById('js_content').addEventListener("selectstart",function(e){ e.preventDefault(); });
                    }

                    
                    (function(){
                        if (navigator.userAgent.indexOf("WindowsWechat") != -1){
                            var link = document.createElement('link');
                            var head = document.getElementsByTagName('head')[0];
                            link.rel = 'stylesheet';
                            link.type = 'text/css';
                            link.href = "//res.wx.qq.com/mmbizwap/zh_CN/htmledition/style/page/appmsg_new/winwx3de35e.css";
                            head.appendChild(link);
                        }
                    })();
                </script>
                
                
                                
                <div class="ct_mpda_wrp" id="js_sponsor_ad_area" style="display:none;"></div>

                
                                <div class="reward_area tc reward_area_primary" id="js_preview_reward_author" style="display:none;">
                    <div class="reward-avatar" style="display: none;" id="js_preview_reward_author_avatar">
                        <img src="" alt="" id="js_preview_reward_author_head">
                    </div>
                    <div class="reward-author" id="js_preview_reward_author_name">顾险峰</div>
                    <p class="reward_tips" id="js_preview_reward_author_wording" style="display:none;"></p>
                    <p>
                        <a class="reward_button" id="js_preview_reward_author_link" href="##"><span id="js_preview_reward_link_text">赞赏</span></a>
                    </p>
                </div>
                
                <div class="reward_qrcode_area reward_area tc" id="js_preview_reward_qrcode" style="display:none;">
                    <p class="tips_global">长按二维码向我转账</p>
                    <p id="js_preview_reward_ios_wording" class="reward_tips" style="display:none;"></p>
                    <span class="reward_qrcode_img_wrp"><img class="reward_qrcode_img" src="//res.wx.qq.com/mmbizwap/zh_CN/htmledition/images/pic/appmsg/pic_reward_qrcode.2x3534dd.png"></span>
                    <p class="tips_global">受苹果公司新规定影响，微信 iOS 版的赞赏功能被关闭，可通过二维码转账支持公众号。</p>
                </div>
                            </div>
                                    
                        


                        
            <ul id="js_hotspot_area" class="article_extend_area"></ul>


            
                        <div class="rich_media_tool" id="js_toobar3">

                                            <div id="js_read_area3" class="media_tool_meta tips_global_primary meta_primary" style="display:none;">阅读 <span id="readNum3"></span></div>

                <span style="display:none;" class="media_tool_meta meta_extra meta_praise" id="like3">
                    <i class="icon_praise_gray"></i><span class="praise_num" id="likeNum3"></span>
                </span>

                

            </div>


                        <div class="rich_media_tool" id="js_sg_bar">

                                
            </div>
                    </div>

        <div class="rich_media_area_primary sougou" id="sg_tj" style="display:none"></div>


        
        <div class="rich_media_area_extra">
            
            <div id="js_share_appmsg">
            </div>

            
                        <div class="mpda_bottom_container" id="js_bottom_ad_area"></div>
                        
            <div id="js_iframetest" style="display:none;"></div>
                        
                        
            <div class="rich_media_extra rich_media_extra_discuss" id="js_cmt_container" style="display:none">
              

              
              <div class="discuss_mod" id="js_friend_cmt_area" style="display:none">
                
                
                
              </div>

                            <div class="discuss_mod" id="js_cmt_area" style="display:none">
              </div>
                          </div>
        </div>

        
        <div id="js_pc_qr_code" class="qr_code_pc_outer" style="display:none;">
            <div class="qr_code_pc_inner">
                <div class="qr_code_pc">
                    <img id="js_pc_qr_code_img" class="qr_code_pc_img">
                    <p>微信扫一扫<br>关注该公众号</p>
                </div>
            </div>
        </div>
    </div>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
