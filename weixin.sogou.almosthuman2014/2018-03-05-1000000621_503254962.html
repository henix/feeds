<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>教程 | 如何通过Scikit-Learn实现多类别文本分类？</title>
</head>
<body>
<p><a href="https://mp.weixin.qq.com/s?timestamp=1521028352&amp;src=3&amp;ver=1&amp;signature=KzaFTe9QBbqBUCDL-mQ9TU4iyI-5kteE9WGPOdXFDhoEGLHPxA54mYY3egWHuUlYmdYOCM66gL6t7iYInJY9m8UMA2zFTXTyuslgs6q6TfTUgqe9dYGOP90q1ys-f9hnBWLuTk06qpdigOVCYoy-zCSb4uMYpge3P44P7H0kdPI=">原文</a></p>
<div id="img-content">
                
                <h2 class="rich_media_title" id="activity-name">
                    教程 | 如何通过Scikit-Learn实现多类别文本分类？                                    </h2>
                <div id="meta_content" class="rich_media_meta_list">
                                                            <em id="post-date" class="rich_media_meta rich_media_meta_text">2018-03-05</em>

                                        <a class="rich_media_meta rich_media_meta_link rich_media_meta_nickname" href="##" id="post-user">机器之心</a>
                    <span class="rich_media_meta rich_media_meta_text rich_media_meta_nickname">机器之心</span>


                    <div id="js_profile_qrcode" class="profile_container" style="display:none;">
                        <div class="profile_inner">
                            <strong class="profile_nickname">机器之心</strong>
                            <img class="profile_avatar" id="js_profile_qrcode_img" src="" alt="">

                            <p class="profile_meta">
                            <label class="profile_meta_label">微信号</label>
                            <span class="profile_meta_value">almosthuman2014</span>
                            </p>

                            <p class="profile_meta">
                            <label class="profile_meta_label">功能介绍</label>
                            <span class="profile_meta_value">专业的人工智能媒体和产业服务平台</span>
                            </p>
                            
                        </div>
                        <span class="profile_arrow_wrp" id="js_profile_arrow_wrp">
                            <i class="profile_arrow arrow_out"></i>
                            <i class="profile_arrow arrow_in"></i>
                        </span>
                    </div>
                </div>
                
                
                
                
                                                
                                                                
                
                <div class="rich_media_content " id="js_content">
                    

                    

                    
                    
                    <section style="font-size: 16px;white-space: normal;max-width: 100%;color: rgb(62, 62, 62);background-color: rgb(255, 255, 255);line-height: 28.4444px;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section data-id="85660" data-custom="rgb(117, 117, 118)" data-color="rgb(117, 117, 118)" style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section data-id="85660" data-custom="rgb(117, 117, 118)" data-color="rgb(117, 117, 118)" style="max-width: 100%;border-width: 0px;border-style: initial;border-color: currentcolor;font-family: 微软雅黑;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="margin-top: 2em;padding-top: 0.5em;padding-bottom: 0.5em;max-width: 100%;border-style: solid none;font-family: inherit;text-decoration: inherit;border-top-color: rgb(204, 204, 204);border-bottom-color: rgb(204, 204, 204);border-top-width: 1px;border-bottom-width: 1px;box-sizing: border-box !important;word-wrap: break-word !important;"><p style="margin-top: -1.2em;max-width: 100%;min-height: 1em;text-align: center;line-height: 1.75em;border-width: initial;border-style: initial;border-color: currentcolor;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(255, 255, 255);background-color: rgb(117, 117, 118);font-size: 14px;box-sizing: border-box !important;word-wrap: break-word !important;">选自towardsdatascience</span></p><section data-style="white-space: normal; text-align: left;font-size: 14px;line-height: 1.5em; color: rgb(12, 12, 12);" style="padding: 16px 16px 10px;max-width: 100%;font-family: inherit;box-sizing: border-box !important;word-wrap: break-word !important;"><p style="max-width: 100%;min-height: 1em;text-align: center;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="color: rgb(136, 136, 136);max-width: 100%;font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;">作者：</strong></span><span style="max-width: 100%;color: rgb(136, 136, 136);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(136, 136, 136);text-align: justify;box-sizing: border-box !important;word-wrap: break-word !important;">Susan Li</span></strong></span></p><p style="max-width: 100%;min-height: 1em;text-align: center;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 12px;color: rgb(136, 136, 136);box-sizing: border-box !important;word-wrap: break-word !important;">机器之心编译</span></strong></p><p style="max-width: 100%;min-height: 1em;text-align: center;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 12px;color: rgb(136, 136, 136);box-sizing: border-box !important;word-wrap: break-word !important;">参与：程耀彤、黄小天</span></strong></p></section></section></section></section></section></section></section></section></section></section></section></section><p style="text-align: justify;line-height: 1.75em;"><br></p><blockquote><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;color: rgb(136, 136, 136);">互联网的绝大多数的文本分类都是二进制的，本文要解决的问题更为复杂。作者使用 Python 和 Jupyter Notebook 开发系统，并借助 Scikit-Learn 实现了消费者金融投诉的 12 个预定义分类。本项目的 GitHub 地址见文中。</span></p></blockquote><p><span style="font-size: 14px;text-align: justify;"><br></span></p><p><span style="font-size: 14px;text-align: justify;color: rgb(123, 12, 0);">GitHub 地址：https://github.com/susanli2016/Machine-Learning-with-Python/blob/master/Consumer_complaints.ipynb</span><br></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">商业活动中有很多文本分类应用。例如，新闻报道通常是按照主题进行构架；内容或产品通常是根据类别添加标签；可以根据用户如何在线讨论某个产品或品牌将其分为多个群组......</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">然而，互联网上绝大多数的文本分类文章和教程都是二进制文本分类，比如垃圾邮件过滤，情感分析。大多数情况下，现实世界的问题更为复杂。因此，这就是我们今天要做的事情：将消费者的金融投诉分为 12 个预定义的类别。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">我们使用 Python 和 Jupyter Notebook 开发系统，机器学习方面则借助 Scikit-Learn。如果你想要 PySpark 实现，请阅读下篇文章。</span></p><p><br></p><p style="text-align: center;line-height: 1.75em;"><span style="font-size: 16px;"><strong>问题表述</strong></span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">该问题是监督式文本分类问题，我们的目标是调查哪种监督式机器学习方法最适合解决它。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">当出现新投诉时，我们希望将其分配到 12 个类别中的一个。分类器假设每个新投诉都被分配到一个且仅一个的类别之中。这是多类别文本分类问题。我迫不及待想看到我们能实现什么！</span></p><p><br></p><p style="text-align: center;line-height: 1.75em;"><strong><span style="font-size: 16px;">数据探索</span></strong></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">在深入训练机器学习模型之前，我们首先应该看一些实例，以及每个类别的投诉数量：</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"></span></p><pre style="box-sizing: border-box;margin-top: 0px;margin-bottom: 0px;padding: 0px;font-size: 16px;color: rgb(62, 62, 62);line-height: inherit;background-color: rgb(255, 255, 255);"><code class="python language-python hljs" style="box-sizing: border-box;margin-right: 2px;margin-left: 2px;padding: 0.5em;font-size: 14px;color: rgb(169, 183, 198);line-height: 18px;border-radius: 0px;background: rgb(40, 43, 46);font-family: Consolas, Inconsolata, Courier, monospace;display: block;overflow-x: auto;letter-spacing: 0px;word-wrap: normal !important;word-break: normal !important;overflow-y: auto !important;"><span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">import</span> pandas <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">as</span> pd<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">df = pd.read_csv(<span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">'Consumer_Complaints.csv'</span>)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">df.head()</code></pre><p><br></p><p><img class="" data-copyright="0" data-ratio="0.4570230607966457" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWic7GYIsIKR5bEo5S0bHjWXYnL84cbCLDYXL77Y6udBcuuCAHjL2xlZCCWGYx2o4SYciaf4j4RhNaVQ/640?wx_fmt=png" data-type="png" data-w="954" style=""></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"></span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">对于这个项目，我们只需要两栏——「产品」和「消费者投诉叙述」。</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"><br></span></p><p style="text-align: justify;line-height: 1.75em;"><strong><span style="font-size: 14px;">输入： Consumer_complaint_narrative</span></strong></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">实例：「我的信用报告中有过时的信息，我以前有争议的是这些信息已超过七年未被删除，并且不符合信用报告的要求」</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><strong><span style="font-size: 14px;">输出：product</span></strong></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">实例：信用报告</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">我们将删除「消费者投诉叙述」栏中的缺失值，并添加一列来将产品编码为整数，因为分类变量通常用整数表示比用字符串更好。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">我们还创建了几个字典供将来使用。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">清理完成后，这是我们将要处理的前五行数据：</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"></span></p><pre style="box-sizing: border-box;margin-top: 0px;margin-bottom: 0px;padding: 0px;font-size: 16px;color: rgb(62, 62, 62);line-height: inherit;background-color: rgb(255, 255, 255);"><code class="python language-python hljs" style="box-sizing: border-box;margin-right: 2px;margin-left: 2px;padding: 0.5em;font-size: 14px;color: rgb(169, 183, 198);line-height: 18px;border-radius: 0px;background: rgb(40, 43, 46);font-family: Consolas, Inconsolata, Courier, monospace;display: block;overflow-x: auto;letter-spacing: 0px;word-wrap: normal !important;word-break: normal !important;overflow-y: auto !important;"><span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">from</span> io <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">import</span> StringIO<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">col = [<span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">'Product'</span>, <span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">'Consumer complaint narrative'</span>]<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">df = df[col]<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">df = df[pd.notnull(df[<span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">'Consumer complaint narrative'</span>])]<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">df.columns = [<span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">'Product'</span>, <span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">'Consumer_complaint_narrative'</span>]<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">df[<span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">'category_id'</span>] = df[<span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">'Product'</span>].factorize()[<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">0</span>]<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">category_id_df = df[[<span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">'Product'</span>, <span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">'category_id'</span>]].drop_duplicates().sort_values(<span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">'category_id'</span>)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">category_to_id = dict(category_id_df.values)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">id_to_category = dict(category_id_df[[<span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">'category_id'</span>, <span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">'Product'</span>]].values)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">df.head()</code></pre><p><br></p><p><img class="" data-copyright="0" data-ratio="0.3477406679764244" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWic7GYIsIKR5bEo5S0bHjWXYeiaTfO6vYNziacRibYicqokpZsOdYplcKYZRT7pOtkTMUjUzibY486zN1Mw/640?wx_fmt=png" data-type="png" data-w="509" style=""></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"></span></p><p><br></p><p style="text-align: center;line-height: 1.75em;"><span style="font-size: 16px;"><strong>不平衡类</strong></span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">我们看到每件产品的投诉数量不平衡。消费者的投诉更集中于收取欠款、信用报告和抵押方面。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"></span></p><pre style="box-sizing: border-box;margin-top: 0px;margin-bottom: 0px;padding: 0px;font-size: 16px;color: rgb(62, 62, 62);line-height: inherit;background-color: rgb(255, 255, 255);"><code class="python language-python hljs" style="box-sizing: border-box;margin-right: 2px;margin-left: 2px;padding: 0.5em;font-size: 14px;color: rgb(169, 183, 198);line-height: 18px;border-radius: 0px;background: rgb(40, 43, 46);font-family: Consolas, Inconsolata, Courier, monospace;display: block;overflow-x: auto;letter-spacing: 0px;word-wrap: normal !important;word-break: normal !important;overflow-y: auto !important;"><span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">import</span> matplotlib.pyplot <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">as</span> plt<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">fig = plt.figure(figsize=(<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">8</span>,<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">6</span>))<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">df.groupby(<span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">'Product'</span>).Consumer_complaint_narrative.count().plot.bar(ylim=<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">0</span>)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">plt.show()<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"></code></pre><p style="text-align: justify;line-height: 1.75em;"><br><span style="font-size: 14px;"></span></p><p><img class="" data-copyright="0" data-ratio="0.8794964028776978" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWic7GYIsIKR5bEo5S0bHjWXYh8GBcktd25sPRKux7d254ibkiaIyJyECvUYxWgE70a2GlSJXHapLNKOg/640?wx_fmt=png" data-type="png" data-w="556" style=""></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">当我们遇到这样的问题时，我们使用标准算法解决这些问题必然会遇到困难。常规算法往往偏向于多数类别，而不考虑数据分布。在最糟糕的情况下，少数类别被视为异常值并被忽略。对于某些情况，如欺诈检测或癌症预测，我们则需要仔细配置我们的模型或人为地平衡数据集，比如欠采样或过采样每个类别。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">但是，在学习不平衡数据的情况下，我们最感兴趣的是多数类。我们想有一个分类器，能够对多数类提供较高的预测精度，同时对少数类保持合理的准确度。因此我们会保持原样。</span></p><p><br></p><p style="text-align: center;line-height: 1.75em;"><span style="font-size: 16px;"><strong>文本表达</strong></span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">分类器和学习算法不能直接处理原始形式的文本文档，因为它们大多数都期望大小固定的数字特征向量而不是具有可变长度的原始文本文档。因此，在预处理步骤中，文本被转换为更易于管理的表达。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">从文本中提取特征的一种常见方法是使用词袋模型：对于每个文档，我们案例中的投诉叙述、单词的出现（通常是频率）被考虑在内，而它们出现顺序则被忽略。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">具体来说，对于我们数据集中的每一项，我们将计算一种被称为词频、反向文档频率的值，其缩写为 tf-idf。我们将使用 sklearn.feature_extraction.text.TfidfVectorizer 为每个消费者投诉叙述计算一个 tf-idf 向量。</span></p><p><span style="font-size: 14px;text-align: justify;"><br></span></p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p><span style="font-size: 14px;text-align: justify;">sublinear_df 设为 True 从而使用频率的对数形式。</span><br></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">min_df 是单词必须存在的最小文档数量。</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">norm 设为 l2，以确保我们所有特征向量的欧几里德范数为 1。</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">ngram_range 设为 (1, 2)，表示我们想要考虑 unigrams 和 bigrams。</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">stop_words 设为 "english" 来删除所有常用代词 ("a", "the", ...) 以减少噪音特征的数量。</span></p></li></ul><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"></span></p><pre style="box-sizing: border-box;margin-top: 0px;margin-bottom: 0px;padding: 0px;font-size: 16px;color: rgb(62, 62, 62);line-height: inherit;background-color: rgb(255, 255, 255);"><code class="python language-python hljs" style="box-sizing: border-box;margin-right: 2px;margin-left: 2px;padding: 0.5em;font-size: 14px;color: rgb(169, 183, 198);line-height: 18px;border-radius: 0px;background: rgb(40, 43, 46);font-family: Consolas, Inconsolata, Courier, monospace;display: block;overflow-x: auto;letter-spacing: 0px;word-wrap: normal !important;word-break: normal !important;overflow-y: auto !important;"><span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">from</span> sklearn.feature_extraction.text <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">import</span> TfidfVectorizer<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">tfidf = TfidfVectorizer(sublinear_tf=<span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">True</span>, min_df=<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">5</span>, norm=<span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">'l2'</span>, encoding=<span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">'latin-1'</span>, ngram_range=(<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">1</span>, <span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">2</span>), stop_words=<span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">'english'</span>)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">features = tfidf.fit_transform(df.Consumer_complaint_narrative).toarray()<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">labels = df.category_id<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">features.shape<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"></code></pre><p style="text-align: justify;line-height: 1.75em;"><br><span style="font-size: 14px;"></span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">(4569, 12633)</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">现在，4569 个消费者投诉描述中的每一个由 12633 个特征表达，代表不同的 unigrams 和 bigrams 的 tf-idf 分数。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">我们可以使用 sklearn.feature_selection.chi2 来查找与每个产品最相关的项：</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"></span></p><pre style="box-sizing: border-box;margin-top: 0px;margin-bottom: 0px;padding: 0px;font-size: 16px;color: rgb(62, 62, 62);line-height: inherit;background-color: rgb(255, 255, 255);"><code class="python language-python hljs" style="box-sizing: border-box;margin-right: 2px;margin-left: 2px;padding: 0.5em;font-size: 14px;color: rgb(169, 183, 198);line-height: 18px;border-radius: 0px;background: rgb(40, 43, 46);font-family: Consolas, Inconsolata, Courier, monospace;display: block;overflow-x: auto;letter-spacing: 0px;word-wrap: normal !important;word-break: normal !important;overflow-y: auto !important;"><span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">from</span> sklearn.feature_selection <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">import</span> chi2<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"><span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">import</span> numpy <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">as</span> np<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">N = <span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">2</span><br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"><span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">for</span> Product, category_id <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">in</span> sorted(category_to_id.items()):<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"> features_chi2 = chi2(features, labels == category_id)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"> indices = np.argsort(features_chi2[<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">0</span>])<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"> feature_names = np.array(tfidf.get_feature_names())[indices]<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"> unigrams = [v <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">for</span> v <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">in</span> feature_names <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">if</span> len(v.split(<span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">' '</span>)) == <span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">1</span>]<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"> bigrams = [v <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">for</span> v <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">in</span> feature_names <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">if</span> len(v.split(<span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">' '</span>)) == <span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">2</span>]<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"> print(<span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">"# '{}':"</span>.format(Product))<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"> print(<span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">" . Most correlated unigrams:\n. {}"</span>.format(<span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">'\n. '</span>.join(unigrams[-N:])))<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"> print(<span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">" . Most correlated bigrams:\n. {}"</span>.format(<span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">'\n. '</span>.join(bigrams[-N:])))</code></pre><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"># 『银行账户或服务』:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 最相关的 unigrams:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 银行</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 透支</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 最相关的 bigrams:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 透支费</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 支票账户</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> # 『消费者贷款』:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 最相关的 unigrams:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 车</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 交通工具</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 最相关的 bigrams:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 交通工具 xxxx</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 丰田金融</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> # 『信用卡』:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 最相关的 unigrams:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 花旗</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 卡</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 最相关的 bigrams:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 年费</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 信用卡</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> # 『信用报告』:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 最相关的 unigrams:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 益百利</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . equifax</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 最相关的 bigrams:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 全联公司</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 信用报告</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> # 『讨回欠款』:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 最相关的 unigrams:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 收集</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 债务</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 最相关的 bigrams:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 讨回全款</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 讨债公司</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> # 『汇款』:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 最相关的 unigrams:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . wu</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . paypal</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 最相关的 bigrams:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 西联汇款</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 汇款</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> # 『抵押』:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 最相关的 unigrams:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 修正</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 抵押</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 最相关的 bigrams:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 抵押公司</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 贷款修改</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> # 『其他金融服务』:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 最相关的 unigrams:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 牙齿</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 护照</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 最相关的 bigrams:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 帮助支付</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 规定支付</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> # 『发薪日贷款』:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 最相关的 unigrams:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 借款</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 发薪日</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 最相关的 bigrams:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 大图片</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 发薪日贷款</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> # 『预付卡』:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 最相关的 unigrams:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 服务</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 充值</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 最相关的 bigrams:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 获得资金</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 预付卡</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> # 『学生贷款』:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 最相关的 unigrams:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 学生</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . navient</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 最相关的 bigrams:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . student loans</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . student loan</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> # 『虚拟货币』:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 最相关的 unigrams:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 手柄</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . https</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 最相关的 bigrams:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . xxxx 提供者</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 想要钱 </span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">它们都有道理，难道不是吗？</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><strong><span style="font-size: 14px;">多类别分类器：特征和设计</span></strong></p><p><br></p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">为了训练监督式分类器，我们首先将「消费者投诉叙述」转化为数字向量。我们研究了向量表示，例如 TF-IDF 加权向量。</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">有了这个向量表达的文本后，我们可以训练监督式分类器来训练看不到的「消费者投诉叙述」并预测它们的「产品」。</span></p></li></ul><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">在完成上述数据转换之后，现在我们拥有所有的特征和，是时候训练分类器了。我们可以使用很多算法来解决这类问题。</span></p><p><br></p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">朴素贝叶斯分类器：最适合字数统计的是多项式变体：</span></p></li></ul><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"></span></p><pre style="box-sizing: border-box;margin-top: 0px;margin-bottom: 0px;padding: 0px;font-size: 16px;color: rgb(62, 62, 62);line-height: inherit;background-color: rgb(255, 255, 255);"><code class="python language-python hljs" style="box-sizing: border-box;margin-right: 2px;margin-left: 2px;padding: 0.5em;font-size: 14px;color: rgb(169, 183, 198);line-height: 18px;border-radius: 0px;background: rgb(40, 43, 46);font-family: Consolas, Inconsolata, Courier, monospace;display: block;overflow-x: auto;letter-spacing: 0px;word-wrap: normal !important;word-break: normal !important;overflow-y: auto !important;"><span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">from</span> sklearn.model_selection <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">import</span> train_test_split<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"><span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">from</span> sklearn.feature_extraction.text <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">import</span> CountVectorizer<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"><span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">from</span> sklearn.feature_extraction.text <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">import</span> TfidfTransformer<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"><span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">from</span> sklearn.naive_bayes <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">import</span> MultinomialNB<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">X_train, X_test, y_train, y_test = train_test_split(df[<span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">'Consumer_complaint_narrative'</span>], df[<span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">'Product'</span>], random_state = <span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">0</span>)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">count_vect = CountVectorizer()<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">X_train_counts = count_vect.fit_transform(X_train)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">tfidf_transformer = TfidfTransformer()<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">X_train_tfidf = tfidf_transformer.fit_transform(X_train_counts)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">clf = MultinomialNB().fit(X_train_tfidf, y_train)</code></pre><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">在拟合好训练集后，让我们做一些预测。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"></span></p><pre style="box-sizing: border-box;margin-top: 0px;margin-bottom: 0px;padding: 0px;font-size: 16px;color: rgb(62, 62, 62);line-height: inherit;background-color: rgb(255, 255, 255);"><code class="python language-python hljs" style="box-sizing: border-box;margin-right: 2px;margin-left: 2px;padding: 0.5em;font-size: 14px;color: rgb(169, 183, 198);line-height: 18px;border-radius: 0px;background: rgb(40, 43, 46);font-family: Consolas, Inconsolata, Courier, monospace;display: block;overflow-x: auto;letter-spacing: 0px;word-wrap: normal !important;word-break: normal !important;overflow-y: auto !important;">print(clf.predict(count_vect.transform([<span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">"This company refuses to provide me verification and validation of debt per my right under the FDCPA. I do not believe this debt is mine."</span>])))<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"></code></pre><p style="text-align: justify;line-height: 1.75em;"><br><span style="font-size: 14px;"></span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">「『收回欠款』」</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"></span></p><pre style="box-sizing: border-box;margin-top: 0px;margin-bottom: 0px;padding: 0px;font-size: 16px;color: rgb(62, 62, 62);line-height: inherit;background-color: rgb(255, 255, 255);"><code class="python language-python hljs" style="box-sizing: border-box;margin-right: 2px;margin-left: 2px;padding: 0.5em;font-size: 14px;color: rgb(169, 183, 198);line-height: 18px;border-radius: 0px;background: rgb(40, 43, 46);font-family: Consolas, Inconsolata, Courier, monospace;display: block;overflow-x: auto;letter-spacing: 0px;word-wrap: normal !important;word-break: normal !important;overflow-y: auto !important;">df[df[<span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">'Consumer_complaint_narrative'</span>] == <span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">"This company refuses to provide me verification and validation of debt per my right under the FDCPA. I do not believe this debt is mine."</span>]</code></pre><p><br></p><p><img class="" data-copyright="0" data-ratio="0.12830957230142567" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWic7GYIsIKR5bEo5S0bHjWXY6kxMGj3HPRabBN2OUzibVRVtR3ekaibABYiaSQFzIicsHeiak2vHxMHmo6g/640?wx_fmt=png" data-type="png" data-w="491" style=""></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"></span></p><pre style="box-sizing: border-box;margin-top: 0px;margin-bottom: 0px;padding: 0px;font-size: 16px;color: rgb(62, 62, 62);line-height: inherit;background-color: rgb(255, 255, 255);"><code class="python language-python hljs" style="box-sizing: border-box;margin-right: 2px;margin-left: 2px;padding: 0.5em;font-size: 14px;color: rgb(169, 183, 198);line-height: 18px;border-radius: 0px;background: rgb(40, 43, 46);font-family: Consolas, Inconsolata, Courier, monospace;display: block;overflow-x: auto;letter-spacing: 0px;word-wrap: normal !important;word-break: normal !important;overflow-y: auto !important;">print(clf.predict(count_vect.transform([<span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">"I am disputing the inaccurate information the Chex-Systems has on my credit report. I initially submitted a police report on XXXX/XXXX/16 and Chex Systems only deleted the items that I mentioned in the letter and not all the items that were actually listed on the police report. In other words they wanted me to say word for word to them what items were fraudulent. The total disregard of the police report and what accounts that it states that are fraudulent. If they just had paid a little closer attention to the police report I would not been in this position now and they would n't have to research once again. I would like the reported information to be removed : XXXX XXXX XXXX"</span>])))<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"></code></pre><p style="text-align: justify;line-height: 1.75em;"><br><span style="font-size: 14px;"></span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">「『信用报告』」</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"></span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"></span></p><pre style="box-sizing: border-box;margin-top: 0px;margin-bottom: 0px;padding: 0px;font-size: 16px;color: rgb(62, 62, 62);line-height: inherit;background-color: rgb(255, 255, 255);"><code class="python language-python hljs" style="box-sizing: border-box;margin-right: 2px;margin-left: 2px;padding: 0.5em;font-size: 14px;color: rgb(169, 183, 198);line-height: 18px;border-radius: 0px;background: rgb(40, 43, 46);font-family: Consolas, Inconsolata, Courier, monospace;display: block;overflow-x: auto;letter-spacing: 0px;word-wrap: normal !important;word-break: normal !important;overflow-y: auto !important;">df[df[<span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">'Consumer_complaint_narrative'</span>] == <span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">"I am disputing the inaccurate information the Chex-Systems has on my credit report. I initially submitted a police report on XXXX/XXXX/16 and Chex Systems only deleted the items that I mentioned in the letter and not all the items that were actually listed on the police report. In other words they wanted me to say word for word to them what items were fraudulent. The total disregard of the police report and what accounts that it states that are fraudulent. If they just had paid a little closer attention to the police report I would not been in this position now and they would n't have to research once again. I would like the reported information to be removed : XXXX XXXX XXXX"</span>]<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"></code></pre><p style="text-align: justify;line-height: 1.75em;"><br><span style="font-size: 14px;"></span></p><p><img class="" data-copyright="0" data-ratio="0.15051546391752577" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWic7GYIsIKR5bEo5S0bHjWXY56vhUuA5qYdiaBcJQSWcibgBETSLFFOZNgfGQwiaBLjCSKJGR77sQru2g/640?wx_fmt=png" data-type="png" data-w="485" style="white-space: normal;"></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">不是太寒酸！</span></p><p><br></p><p style="text-align: center;line-height: 1.75em;"><span style="font-size: 16px;"><strong>模型选择</strong></span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">我们现在准备尝试不同的机器学习模型，评估它们的准确性并找出潜在问题的根源。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">我们将对以下四种模型进行基准测试：</span></p><p><br></p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">Logistic 回归</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">（多项式）朴素贝叶斯</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">线性支持向量机</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">随机森林</span></p></li></ul><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"></span></p><pre style="box-sizing: border-box;margin-top: 0px;margin-bottom: 0px;padding: 0px;font-size: 16px;color: rgb(62, 62, 62);line-height: inherit;background-color: rgb(255, 255, 255);"><code class="python language-python hljs" style="box-sizing: border-box;margin-right: 2px;margin-left: 2px;padding: 0.5em;font-size: 14px;color: rgb(169, 183, 198);line-height: 18px;border-radius: 0px;background: rgb(40, 43, 46);font-family: Consolas, Inconsolata, Courier, monospace;display: block;overflow-x: auto;letter-spacing: 0px;word-wrap: normal !important;word-break: normal !important;overflow-y: auto !important;"><span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">from</span> sklearn.linear_model <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">import</span> LogisticRegression<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"><span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">from</span> sklearn.ensemble <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">import</span> RandomForestClassifier<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"><span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">from</span> sklearn.svm <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">import</span> LinearSVC<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"><span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">from</span> sklearn.model_selection <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">import</span> cross_val_score<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">models = [<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"> RandomForestClassifier(n_estimators=<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">200</span>, max_depth=<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">3</span>, random_state=<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">0</span>),<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"> LinearSVC(),<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"> MultinomialNB(),<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"> LogisticRegression(random_state=<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">0</span>),<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">]<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">CV = <span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">5</span><br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">cv_df = pd.DataFrame(index=range(CV * len(models)))<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">entries = []<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"><span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">for</span> model <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">in</span> models:<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"> model_name = model.__class__.__name__<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"> accuracies = cross_val_score(model, features, labels, scoring=<span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">'accuracy'</span>, cv=CV)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"> <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">for</span> fold_idx, accuracy <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">in</span> enumerate(accuracies):<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"> entries.append((model_name, fold_idx, accuracy))<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">cv_df = pd.DataFrame(entries, columns=[<span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">'model_name'</span>, <span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">'fold_idx'</span>, <span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">'accuracy'</span>])<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"><span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">import</span> seaborn <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">as</span> sns<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">sns.boxplot(x=<span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">'model_name'</span>, y=<span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">'accuracy'</span>, data=cv_df)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">sns.stripplot(x=<span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">'model_name'</span>, y=<span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">'accuracy'</span>, data=cv_df, <br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"> size=<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">8</span>, jitter=<span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">True</span>, edgecolor=<span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">"gray"</span>, linewidth=<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">2</span>)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">plt.show()<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"></code></pre><p style="text-align: justify;line-height: 1.75em;"><br><span style="font-size: 14px;"></span></p><p><img class="" data-copyright="0" data-ratio="0.6690647482014388" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWic7GYIsIKR5bEo5S0bHjWXYdJRJVQciaBc8p9pKRHV9QpFyUU3eWJ8QMyxYTlrdpEsw9llFIsv2Xvg/640?wx_fmt=png" data-type="png" data-w="417" style=""></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"></span></p><pre style="box-sizing: border-box;margin-top: 0px;margin-bottom: 0px;padding: 0px;font-size: 16px;color: rgb(62, 62, 62);line-height: inherit;background-color: rgb(255, 255, 255);"><code class="python language-python hljs" style="box-sizing: border-box;margin-right: 2px;margin-left: 2px;padding: 0.5em;font-size: 14px;color: rgb(169, 183, 198);line-height: 18px;border-radius: 0px;background: rgb(40, 43, 46);font-family: Consolas, Inconsolata, Courier, monospace;display: block;overflow-x: auto;letter-spacing: 0px;word-wrap: normal !important;word-break: normal !important;overflow-y: auto !important;">cv_df.groupby(<span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">'model_name'</span>).accuracy.mean()<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"></code></pre><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"><br></span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">模型名称</span></p><p><br></p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">线性支持向量机：0.822890</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">Logistic 回归：0.792927</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">（多项式）朴素贝叶斯：0.688519</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">随机森林：0.443826</span></p></li></ul><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">名称：精确度，dtype：float64</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"><br></span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">线性支持向量机和 Logistic 回归比其他两个分类器执行的更好，前者具有轻微的优势，其中位精度约为 82%。</span></p><p><br></p><p style="text-align: center;line-height: 1.75em;"><span style="font-size: 16px;"><strong>模型评估</strong></span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">继续使用我们的最佳模型（LinearSVC），我们将查看混淆矩阵，并展示预测标签和实际标签之间的差异。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"></span></p><pre style="box-sizing: border-box;margin-top: 0px;margin-bottom: 0px;padding: 0px;font-size: 16px;color: rgb(62, 62, 62);line-height: inherit;background-color: rgb(255, 255, 255);"><code class="python language-python hljs" style="box-sizing: border-box;margin-right: 2px;margin-left: 2px;padding: 0.5em;font-size: 14px;color: rgb(169, 183, 198);line-height: 18px;border-radius: 0px;background: rgb(40, 43, 46);font-family: Consolas, Inconsolata, Courier, monospace;display: block;overflow-x: auto;letter-spacing: 0px;word-wrap: normal !important;word-break: normal !important;overflow-y: auto !important;">model = LinearSVC()<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">X_train, X_test, y_train, y_test, indices_train, indices_test = train_test_split(features, labels, df.index, test_size=<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">0.33</span>, random_state=<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">0</span>)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">model.fit(X_train, y_train)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">y_pred = model.predict(X_test)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"><span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">from</span> sklearn.metrics <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">import</span> confusion_matrix<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">conf_mat = confusion_matrix(y_test, y_pred)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">fig, ax = plt.subplots(figsize=(<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">10</span>,<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">10</span>))<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">sns.heatmap(conf_mat, annot=<span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">True</span>, fmt=<span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">'d'</span>,<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"> xticklabels=category_id_df.Product.values, yticklabels=category_id_df.Product.values)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">plt.ylabel(<span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">'Actual'</span>)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">plt.xlabel(<span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">'Predicted'</span>)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">plt.show()<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"></code></pre><p><br></p><p><img class="" data-copyright="0" data-ratio="0.7657232704402516" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWic7GYIsIKR5bEo5S0bHjWXYtbdheaL6IUFM4vJLettBtnh1W5VydzJUsI8B7mn8rOEcXXQYcFtDjQ/640?wx_fmt=png" data-type="png" data-w="636" style=""></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">正如我们所希望的，绝大多数预测都在对角线结束（预测标签=实际标签）。然而，仍然存在大量错误分类，看看这些是由什么造成的可能很有趣：</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"></span></p><pre style="box-sizing: border-box;margin-top: 0px;margin-bottom: 0px;padding: 0px;font-size: 16px;color: rgb(62, 62, 62);line-height: inherit;background-color: rgb(255, 255, 255);"><code class="python language-python hljs" style="box-sizing: border-box;margin-right: 2px;margin-left: 2px;padding: 0.5em;font-size: 14px;color: rgb(169, 183, 198);line-height: 18px;border-radius: 0px;background: rgb(40, 43, 46);font-family: Consolas, Inconsolata, Courier, monospace;display: block;overflow-x: auto;letter-spacing: 0px;word-wrap: normal !important;word-break: normal !important;overflow-y: auto !important;"><span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">from</span> IPython.display <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">import</span> display<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"><span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">for</span> predicted <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">in</span> category_id_df.category_id:<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"> <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">for</span> actual <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">in</span> category_id_df.category_id:<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"> <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">if</span> predicted != actual <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">and</span> conf_mat[actual, predicted] &gt;= <span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">10</span>:<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"> print(<span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">"'{}' predicted as '{}' : {} examples."</span>.format(id_to_category[actual], id_to_category[predicted], conf_mat[actual, predicted]))<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"> display(df.loc[indices_test[(y_test == actual) &amp; (y_pred == predicted)]][[<span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">'Product'</span>, <span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">'Consumer_complaint_narrative'</span>]])<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"> print(<span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">''</span>)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"></code></pre><p style="text-align: justify;line-height: 1.75em;"><br><span style="font-size: 14px;"></span></p><p><img class="" data-copyright="0" data-ratio="0.6183745583038869" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWic7GYIsIKR5bEo5S0bHjWXYtvCzXB3RoJ56icVlUSSygQ3kFrt11ydGXmR4Y48nAKgCicPuDktAdnnw/640?wx_fmt=png" data-type="png" data-w="566" style=""></p><p><br></p><p><img class="" data-copyright="0" data-ratio="0.618018018018018" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWic7GYIsIKR5bEo5S0bHjWXYyJRztLArgrkeeI9RZPleBoBmDGrA17uTnjpavImb0ibPbT8TQbo8yGg/640?wx_fmt=png" data-type="png" data-w="555" style=""></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"></span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">如你所见，一些错误分类的投诉涉及多个主题（比如涉及信用卡和信用报告的投诉）。这种错误总是发生。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">再次，我们使用卡方检验来找到与每个类别最相关的项：</span></p><p><br></p><pre style="box-sizing: border-box;margin-top: 0px;margin-bottom: 0px;padding: 0px;font-size: 16px;color: rgb(62, 62, 62);line-height: inherit;background-color: rgb(255, 255, 255);"><code class="python language-python hljs" style="box-sizing: border-box;margin-right: 2px;margin-left: 2px;padding: 0.5em;font-size: 14px;color: rgb(169, 183, 198);line-height: 18px;border-radius: 0px;background: rgb(40, 43, 46);font-family: Consolas, Inconsolata, Courier, monospace;display: block;overflow-x: auto;letter-spacing: 0px;word-wrap: normal !important;word-break: normal !important;overflow-y: auto !important;">model.fit(features, labels)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">N = <span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">2</span><br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"><span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">for</span> Product, category_id <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">in</span> sorted(category_to_id.items()):<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"> indices = np.argsort(model.coef_[category_id])<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"> feature_names = np.array(tfidf.get_feature_names())[indices]<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"> unigrams = [v <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">for</span> v <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">in</span> reversed(feature_names) <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">if</span> len(v.split(<span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">' '</span>)) == <span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">1</span>][:N]<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"> bigrams = [v <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">for</span> v <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">in</span> reversed(feature_names) <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">if</span> len(v.split(<span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">' '</span>)) == <span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">2</span>][:N]<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"> print(<span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">"# '{}':"</span>.format(Product))<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"> print(<span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">" . Top unigrams:\n . {}"</span>.format(<span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">'\n . '</span>.join(unigrams)))<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"> print(<span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">" . Top bigrams:\n . {}"</span>.format(<span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">'\n . '</span>.join(bigrams)))<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"></code></pre><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"># 『银行账户或服务』:</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 最高的 unigrams:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 银行</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 账户</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 最高的 bigrams:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 借记卡</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 透支费用</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"># 『消费者贷款』:</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 最高的 unigrams:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 交通工具</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 车</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 最高的 bigrams:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 个人贷款</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 历史 xxxx</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"># 『信用卡』:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 最高的 unigrams:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 卡</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 发现</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 最高的 bigrams:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 信用卡</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 发现卡</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"># 『信用报告』:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 最高的 unigrams:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . equifax</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 全联公司</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 最高的 bigrams:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . xxxx 账户</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 全联公司</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"># 『讨回欠款』:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 最高的 unigrams:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 债务</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 收集</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 最高的 bigrams:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 账户信用</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 时间提供</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"># 『汇款』:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 最高的 unigrams:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . paypal</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 汇款</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 最高的 bigrams:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 汇款</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 寄钱</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"># 『抵押』:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 最高的 unigrams:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 抵押</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 国际支付宝</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 最高的 bigrams:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 贷款修改</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 抵押公司</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"># 『其他金融服务』:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 最高的 unigrams:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 护照</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 牙齿</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 最高的 bigrams:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 规定支付</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 帮助支付</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"># 『发薪日贷款』:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 最高的 unigrams:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 发薪日</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 贷款</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 最高的 bigrams:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 发薪日贷款</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 发薪日</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"># 『预付卡』:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 最高的 unigrams:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 充值</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 服务</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 最高的 bigrams:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 预付卡</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 使用卡</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"># 『学生贷款』:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 最高的 unigrams:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . navient</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 贷款</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 最高的 bigrams:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 学生贷款</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . sallie mae</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"># 『虚拟货币』:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 最高的 unigrams:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . https</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . tx</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 最高的 bigrams:</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . 想要钱</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"> . xxxx 提供者</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">它们符合我们的预期。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">最后，我们打印出每个类的分类报告：</span></p><p><br></p><pre style="box-sizing: border-box;margin-top: 0px;margin-bottom: 0px;padding: 0px;font-size: 16px;color: rgb(62, 62, 62);line-height: inherit;background-color: rgb(255, 255, 255);"><code class="python language-python hljs" style="box-sizing: border-box;margin-right: 2px;margin-left: 2px;padding: 0.5em;font-size: 14px;color: rgb(169, 183, 198);line-height: 18px;border-radius: 0px;background: rgb(40, 43, 46);font-family: Consolas, Inconsolata, Courier, monospace;display: block;overflow-x: auto;letter-spacing: 0px;word-wrap: normal !important;word-break: normal !important;overflow-y: auto !important;"><span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">from</span> sklearn <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">import</span> metrics<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">print(metrics.classification_report(y_test, y_pred, target_names=df[<span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">'Product'</span>].unique()))</code></pre><p><br></p><p><img class="" data-copyright="0" data-ratio="0.43167701863354035" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWic7GYIsIKR5bEo5S0bHjWXYdtSawkBeVPxF8picvbtG7Jnt5qhcJGWXbVZ3iayMXfWQ4HT3SaibSzxBA/640?wx_fmt=png" data-type="png" data-w="644" style=""></p><p><span style="font-size: 14px;text-align: justify;"></span></p><p style="font-size: 16px;white-space: normal;max-width: 100%;min-height: 1em;color: rgb(62, 62, 62);background-color: rgb(255, 255, 255);text-align: justify;line-height: 1.75em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="color: rgb(136, 136, 136);"><em><span style="font-size: 12px;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><br></span></em></span></p><p style="font-size: 16px;white-space: normal;max-width: 100%;min-height: 1em;color: rgb(62, 62, 62);background-color: rgb(255, 255, 255);text-align: justify;line-height: 1.75em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="color: rgb(136, 136, 136);"><em><span style="font-size: 12px;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;">原文链接：https://towardsdatascience.com/multi-class-text-classification-with-scikit-learn-12f1e60e0a9f</span></em></span></p><p style="font-size: 16px;white-space: normal;max-width: 100%;min-height: 1em;color: rgb(62, 62, 62);background-color: rgb(255, 255, 255);text-align: justify;line-height: 1.75em;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;line-height: 25.6px;font-family: 微软雅黑;font-size: 14px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(127, 127, 127);box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;color: rgb(62, 62, 62);line-height: 25.6px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(127, 127, 127);box-sizing: border-box !important;word-wrap: break-word !important;"><br></span></strong></span></strong></p><p style="font-size: 16px;white-space: normal;max-width: 100%;min-height: 1em;color: rgb(62, 62, 62);background-color: rgb(255, 255, 255);text-align: justify;line-height: 1.75em;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;line-height: 25.6px;font-family: 微软雅黑;font-size: 14px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(127, 127, 127);box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;color: rgb(62, 62, 62);line-height: 25.6px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(127, 127, 127);box-sizing: border-box !important;word-wrap: break-word !important;"><br></span></strong></span></strong></p><p style="font-size: 16px;white-space: normal;max-width: 100%;min-height: 1em;color: rgb(62, 62, 62);background-color: rgb(255, 255, 255);text-align: justify;line-height: 1.75em;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;line-height: 25.6px;font-family: 微软雅黑;font-size: 14px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(127, 127, 127);box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;color: rgb(62, 62, 62);line-height: 25.6px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(127, 127, 127);box-sizing: border-box !important;word-wrap: break-word !important;">本文为机器之心编译，<strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;">转载请联系本公众号获得授权</span></strong></span></strong>。</span></strong><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></p><p style="margin-bottom: 5px;white-space: normal;max-width: 100%;min-height: 1em;color: rgb(62, 62, 62);background-color: rgb(255, 255, 255);font-size: 18px;line-height: 1.75em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(127, 127, 127);line-height: 25.6px;font-family: 微软雅黑;text-align: justify;box-sizing: border-box !important;word-wrap: break-word !important;">✄------------------------------------------------</span></p><p style="margin-bottom: 5px;white-space: normal;max-width: 100%;min-height: 1em;color: rgb(62, 62, 62);background-color: rgb(255, 255, 255);font-size: 18px;font-family: 微软雅黑;text-align: center;line-height: 1.75em;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(217, 33, 66);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">加入机器之心（全职记者/实习生）：hr@jiqizhixin.com</span></strong></p><p style="white-space: normal;max-width: 100%;min-height: 1em;color: rgb(62, 62, 62);background-color: rgb(255, 255, 255);font-size: 18px;font-family: 微软雅黑;text-align: center;line-height: 1.75em;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(217, 33, 66);line-height: 1.6;font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">投稿或寻求报道：editor@jiqizhixin.com</span></strong></p><p style="white-space: normal;max-width: 100%;min-height: 1em;color: rgb(62, 62, 62);background-color: rgb(255, 255, 255);font-size: 18px;font-family: 微软雅黑;text-align: center;line-height: 1.75em;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 12px;color: rgb(217, 33, 66);line-height: 1.6;box-sizing: border-box !important;word-wrap: break-word !important;">广告&amp;商务合作：bd@jiqizhixin.com</span></strong></p>
                </div>
                <script nonce="573650820" type="text/javascript">
                    var first_sceen__time = (+new Date());

                    if ("" == 1 && document.getElementById('js_content')) {
                        document.getElementById('js_content').addEventListener("selectstart",function(e){ e.preventDefault(); });
                    }

                    
                    (function(){
                        if (navigator.userAgent.indexOf("WindowsWechat") != -1){
                            var link = document.createElement('link');
                            var head = document.getElementsByTagName('head')[0];
                            link.rel = 'stylesheet';
                            link.type = 'text/css';
                            link.href = "//res.wx.qq.com/mmbizwap/zh_CN/htmledition/style/page/appmsg/page_mp_article_improve_winwx31619e.css";
                            head.appendChild(link);
                        }
                    })();
                </script>
                
                
                                
                <div class="ct_mpda_wrp" id="js_sponsor_ad_area" style="display:none;"></div>

                
                                <div class="reward_area tc" id="js_preview_reward" style="display:none;">
                    <p id="js_preview_reward_wording" class="tips_global reward_tips" style="display:none;"></p>
                    <p>
                        <a class="reward_access" id="js_preview_reward_link" href="##"><span class="icon-reward"></span>赞赏</a>

                    </p>
                </div>
                <div class="reward_qrcode_area reward_area tc" id="js_preview_reward_qrcode" style="display:none;">
                    <p class="tips_global">长按二维码向我转账</p>
                    <p id="js_preview_reward_ios_wording" class="reward_tips" style="display:none;"></p>
                    <span class="reward_qrcode_img_wrp"><img class="reward_qrcode_img" src="//res.wx.qq.com/mmbizwap/zh_CN/htmledition/images/pic/appmsg/pic_reward_qrcode.2x3534dd.png"></span>
                    <p class="tips_global">受苹果公司新规定影响，微信 iOS 版的赞赏功能被关闭，可通过二维码转账支持公众号。</p>
                </div>
                            </div><div class="rich_media_tool" id="js_toobar3">
                
                                
                                            <div id="js_read_area3" class="media_tool_meta tips_global meta_primary" style="display:none;">阅读 <span id="readNum3"></span></div>

                <span style="display:none;" class="media_tool_meta meta_primary tips_global meta_praise" id="like3">
                    <i class="icon_praise_gray"></i><span class="praise_num" id="likeNum3"></span>
                </span>

                <a id="js_report_article3" style="display:none;" class="media_tool_meta tips_global meta_extra" href="##">投诉</a>

            </div><div class="rich_media_tool" id="js_sg_bar">
                
                                
                                
            </div>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
