<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>从Inception v1到Inception-ResNet，一文概览Inception家族的「奋斗史」</title>
</head>
<body>
<p><a href="https://mp.weixin.qq.com/s?timestamp=1527695441&amp;src=3&amp;ver=1&amp;signature=sz35w1tHE*ocopopMwKokTgGvVsDFfdKVgscyaotBzTiG2zy-DGDjTW7qG3v1DHYqfzmEJ-7IVfIsCCuZwC-m-Sh0fHUSd06tng3srq36GjRrJruUpLOc4KstnjkTG6tCLjOy4-1TOiZ5JFCdfA5wDB0fTl0K8Y8cEAgJsCrGYI=">原文</a></p>
<div id="js_top_ad_area" class="top_banner"></div><div class="rich_media_inner">
                        
        
        <div id="page-content" class="rich_media_area_primary">
            
                        
            <div id="img-content">

                
                <h2 class="rich_media_title" id="activity-name">
                    
                    <script nonce="469685275" type="text/javascript">
                        if(/(iPhone|iPad|iPod|iOS)/i.test(navigator.userAgent)){
                            document.write("<span class='rich_media_title_ios'>从Inception v1到Inception-ResNet，一文概览Inception家族的「奋斗史」");
                        }else{
                            document.write("从Inception v1到Inception-ResNet，一文概览Inception家族的「奋斗史」");
                        }
                    </script>

                                                                                </h2>
                <div id="meta_content" class="rich_media_meta_list">
                                                                                <span class="rich_media_meta rich_media_meta_nickname" id="profileBt">
                      <a href="javascript:void(0);">
                        机器之心                      </a>
                      <div id="js_profile_qrcode" class="profile_container" style="display:none;">
                          <div class="profile_inner">
                              <strong class="profile_nickname">机器之心</strong>
                              <img class="profile_avatar" id="js_profile_qrcode_img" src="" alt="">

                              <p class="profile_meta">
                              <label class="profile_meta_label">微信号</label>
                              <span class="profile_meta_value">almosthuman2014</span>
                              </p>

                              <p class="profile_meta">
                              <label class="profile_meta_label">功能介绍</label>
                              <span class="profile_meta_value">专业的人工智能媒体和产业服务平台</span>
                              </p>
                              
                          </div>
                          <span class="profile_arrow_wrp" id="js_profile_arrow_wrp">
                              <i class="profile_arrow arrow_out"></i>
                              <i class="profile_arrow arrow_in"></i>
                          </span>
                      </div>
                    </span>


                    <em id="publish_time" class="rich_media_meta rich_media_meta_text"></em>





                </div>
                
                
                
                
                                                
                                                                
                
                <div class="rich_media_content " lang='="en"' id="js_content">
                    

                    

                    
                    
                    <p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;"></span></p><section style="white-space: normal;max-width: 100%;caret-color: rgb(51, 51, 51);"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section data-id="85660" data-custom="rgb(117, 117, 118)" data-color="rgb(117, 117, 118)" style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section data-id="85660" data-custom="rgb(117, 117, 118)" data-color="rgb(117, 117, 118)" style="max-width: 100%;border-width: 0px;border-style: initial;border-color: currentcolor;font-family: 微软雅黑;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="margin-top: 2em;padding-top: 0.5em;padding-bottom: 0.5em;max-width: 100%;border-style: solid none;font-family: inherit;text-decoration: inherit;border-top-color: rgb(204, 204, 204);border-bottom-color: rgb(204, 204, 204);border-top-width: 1px;border-bottom-width: 1px;box-sizing: border-box !important;word-wrap: break-word !important;"><p style="margin-top: -1.2em;color: rgb(51, 51, 51);font-size: 17px;max-width: 100%;min-height: 1em;text-align: center;line-height: 1.75em;border-width: initial;border-style: initial;border-color: currentcolor;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(255, 255, 255);background-color: rgb(117, 117, 118);font-size: 16px;box-sizing: border-box !important;word-wrap: break-word !important;">选自Medium<span style="max-width: 100%;font-size: 15px;text-align: justify;"></span></span></p><section data-style="white-space: normal; text-align: left;font-size: 14px;line-height: 1.5em; color: rgb(12, 12, 12);" style="padding: 16px 16px 10px;max-width: 100%;font-family: inherit;box-sizing: border-box !important;word-wrap: break-word !important;"><p style="color: rgb(51, 51, 51);font-size: 17px;max-width: 100%;min-height: 1em;text-align: center;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 12px;color: rgb(136, 136, 136);box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;">作者：Bharath Raj</strong></span></p><p style="color: rgb(51, 51, 51);font-size: 17px;max-width: 100%;min-height: 1em;text-align: center;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;color: rgb(136, 136, 136);font-size: 12px;font-family: inherit;text-decoration: inherit;box-sizing: border-box !important;word-wrap: break-word !important;">机器之心编译</strong></p><p style="color: rgb(51, 51, 51);font-size: 17px;max-width: 100%;min-height: 1em;text-align: center;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;color: rgb(136, 136, 136);font-size: 12px;font-family: inherit;text-decoration: inherit;box-sizing: border-box !important;word-wrap: break-word !important;">参与：路、刘晓坤</strong></p></section></section></section></section></section></section></section></section></section></section></section></section><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;"></span><br></p><blockquote><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;color: rgb(136, 136, 136);">本文简要介绍了 Inception 家族的主要成员，包括 Inception v1、Inception v2 和 Inception v3、Inception v4 和 Inception-ResNet。它们的计算效率与参数效率在所有卷积架构中都是顶尖的，且根据 CS231n 中所介绍的，Inception V4 基本上是当前在 ImageNet 图像分类任务 Top-1 正确率最高的模型。</span></p></blockquote><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">Inception 网络是 CNN 分类器发展史上一个重要的里程碑。在 Inception 出现之前，大部分流行 CNN 仅仅是把卷积层堆叠得越来越多，使网络越来越深，以此希望能够得到更好的性能。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">例如第一个得到广泛关注的 AlexNet，它本质上就是扩展 LeNet 的深度，并应用一些 ReLU、Dropout 等技巧。AlexNet 有 5 个卷积层和 3 个最大池化层，它可分为上下两个完全相同的分支，这两个分支在第三个卷积层和全连接层上可以相互交换信息。与 Inception 同年提出的优秀网络还有 VGG-Net，它相比于 AlexNet 有更小的卷积核和更深的层级。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">VGG-Net 的泛化性能非常好，常用于图像特征的抽取目标检测候选框生成等。VGG 最大的问题就在于参数数量，VGG-19 基本上是参数量最多的卷积网络架构。这一问题也是第一次提出 Inception 结构的 GoogLeNet 所重点关注的，它没有如同 VGG-Net 那样大量使用全连接网络，因此参数量非常小。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">GoogLeNet 最大的特点就是使用了 Inception 模块，它的目的是设计一种具有优良局部拓扑结构的网络，即对输入图像并行地执行多个卷积运算或池化操作，并将所有输出结果拼接为一个非常深的特征图。因为 1*1、3*3 或 5*5 等不同的卷积运算与池化操作可以获得输入图像的不同信息，并行处理这些运算并结合所有结果将获得更好的图像表征。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">另一方面，Inception 网络是复杂的（需要大量工程工作）。它使用大量 trick 来提升性能，包括速度和准确率两方面。它的不断进化带来了多种 Inception 网络版本的出现。常见的版本有：</span></p><p><br></p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">Inception v1</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">Inception v2 和 Inception v3</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">Inception v4 和 Inception-ResNet</span></p></li></ul><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">每个版本都是前一个版本的迭代进化。了解 Inception 网络的升级可以帮助我们构建自定义分类器，优化速度和准确率。此外，根据你的已有数据，或许较低版本工作效果更好。</span></p><p><br></p><p style="text-align: center;"><strong>Inception v1</strong></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">这是 Inception 网络的第一个版本。我们来分析一下它可以解决什么问题，以及如何解决。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">在《Going deeper with convolutions》论文中，作者提出一种深度卷积神经网络 Inception，它在 ILSVRC14 中达到了当时最好的分类和检测性能。该架构的主要特点是更好地利用网络内部的计算资源，这通过一个精心制作的设计来实现，该设计允许增加网络的深度和宽度，同时保持计算预算不变。为了优化质量，架构决策基于赫布原则和多尺度处理。作者向 ILSVRC14 提交使用该架构的模型即 GoogLeNet，这是一个 22 层的深度网络，它的质量是在分类和检测领域进行了评估。</span></p><p><br></p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p style="text-align: left;line-height: 1.75em;"><span style="font-size: 15px;">论文：Going deeper with convolutions</span></p></li><li><p style="text-align: left;line-height: 1.75em;"><span style="font-size: 15px;">论文链接：https://arxiv.org/pdf/1409.4842v1.pdf</span></p></li></ul><p><br></p><p style="text-align: justify;line-height: 1.75em;"><strong><span style="font-size: 15px;">问题：</span></strong></p><p><br></p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">图像中突出部分的大小差别很大。例如，狗的图像可以是以下任意情况。每张图像中狗所占区域都是不同的。</span></p></li></ul><p style="text-align: justify;line-height: 1.75em;"><br></p><p><img class="" data-ratio="0.33669609079445145" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWibicCBZFh6icBUicU6B6MmHibo8herqLlEdBwiamKyExpoDIfAjx5SqVoOzT2Z7wTu5ibLQrPiaicZvpuomGw/640?wx_fmt=png" data-type="png" data-w="1586" style=""></p><p style="text-align: left;line-height: 1.75em;"><span style="color: rgb(136, 136, 136);font-size: 12px;"><em>从左到右：狗占据图像的区域依次减小（图源：https://unsplash.com/）。</em></span></p><p><br></p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">由于信息位置的巨大差异，为卷积操作选择合适的卷积核大小就比较困难。信息分布更全局性的图像偏好较大的卷积核，信息分布比较局部的图像偏好较小的卷积核。</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">非常深的网络更容易过拟合。将梯度更新传输到整个网络是很困难的。</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">简单地堆叠较大的卷积层非常消耗计算资源。</span></p></li></ul><p><br></p><p style="text-align: justify;line-height: 1.75em;"><strong><span style="font-size: 15px;">解决方案：</span></strong></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">为什么不在同一层级上运行具备多个尺寸的滤波器呢？网络本质上会变得稍微「宽一些」，而不是「更深」。作者因此设计了 Inception 模块。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">下图是「原始」Inception 模块。它使用 3 个不同大小的滤波器（1x1、3x3、5x5）对输入执行卷积操作，此外它还会执行最大池化。所有子层的输出最后会被级联起来，并传送至下一个 Inception 模块。</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;"></span></p><p><img class="" data-ratio="0.5728643216080402" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWibicCBZFh6icBUicU6B6MmHibo8GlywapAM4rn9RcHDADcm7eME0RfHC9YW6ac44GNCoQfoRurQZYIuJA/640?wx_fmt=png" data-type="png" data-w="796" style=""></p><p style="text-align: left;line-height: 1.75em;"><span style="color: rgb(136, 136, 136);font-size: 12px;"><em>原始 Inception 模块。（图源：https://arxiv.org/pdf/1409.4842v1.pdf）</em></span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">如前所述，深度神经网络需要耗费大量计算资源。为了降低算力成本，作者在 3x3 和 5x5 卷积层之前添加额外的 1x1 卷积层，来限制输入信道的数量。尽管添加额外的卷积操作似乎是反直觉的，但是 1x1 卷积比 5x5 卷积要廉价很多，而且输入信道数量减少也有利于降低算力成本。不过一定要注意，1x1 卷积是在最大池化层之后，而不是之前。</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;"></span></p><p><img class="" data-ratio="0.5766497461928934" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWibicCBZFh6icBUicU6B6MmHibo87ev1Y77OqD9t0yKlwoml7icuQUpCpgHm89ibfqGyWQ25OZhRyHBGicic6Q/640?wx_fmt=png" data-type="png" data-w="985" style=""></p><p style="text-align: left;line-height: 1.75em;"><span style="color: rgb(136, 136, 136);font-size: 12px;"><em>实现降维的 Inception 模块。（图源：https://arxiv.org/pdf/1409.4842v1.pdf）</em></span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">利用实现降维的 Inception 模块可以构建 GoogLeNet（Inception v1），其架构如下图所示：</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;"></span></p><p><img class="" data-copyright="0" data-ratio="0.3635265700483092" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWibicCBZFh6icBUicU6B6MmHibo89zANxP88feWsmCdbLVyGah5of1E7vvDlyChCIrPsBibIhQEBk6FtLFQ/640?wx_fmt=png" data-type="png" data-w="828" style=""></p><p style="text-align: left;line-height: 1.75em;"><span style="color: rgb(136, 136, 136);font-size: 12px;"><em>GoogLeNet。橙色框是 stem，包含一些初始卷积。紫色框是辅助分类器。较宽的部分是 inception 模块。（图源：https://arxiv.org/pdf/1409.4842v1.pdf）</em></span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">GoogLeNet 有 9 个线性堆叠的 Inception 模块。它有 22 层（包括池化层的话是 27 层）。该模型在最后一个 inception 模块处使用全局平均池化。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">不用多说，这是一个深层分类器。和所有深层网络一样，它也会遇到梯度消失问题。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">为了阻止该网络中间部分梯度的「消失」过程，作者引入了两个辅助分类器（上图紫色框）。它们对其中两个 Inception 模块的输出执行 softmax 操作，然后在同样的标签上计算辅助损失。总损失即辅助损失和真实损失的加权和。该论文中对每个辅助损失使用的权重值是 0.3。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;"></span></p><pre style="box-sizing: border-box;margin-top: 0px;margin-bottom: 0px;padding: 0px;font-size: 16px;color: rgb(62, 62, 62);line-height: inherit;background-color: rgb(255, 255, 255);"><code class="javascript language-javascript hljs" style="box-sizing: border-box;margin-right: 2px;margin-left: 2px;padding: 0.5em;font-size: 14px;color: rgb(169, 183, 198);line-height: 18px;border-radius: 0px;background: rgb(40, 43, 46);font-family: Consolas, Inconsolata, Courier, monospace;display: block;overflow-x: auto;letter-spacing: 0px;word-wrap: normal !important;word-break: normal !important;overflow-y: auto !important;"># The total loss used by the inception net during training.<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">total_loss = real_loss + <span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">0.3</span> * aux_loss_1 + <span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">0.3</span> * aux_loss_2<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"></code></pre><p style="text-align: justify;line-height: 1.75em;"><br><span style="font-size: 15px;"></span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">辅助损失只是用于训练，在推断过程中并不使用。</span></p><p><br></p><p style="text-align: center;line-height: 1.75em;"><strong><span style="font-size: 16px;">Inception v2</span></strong></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">Inception v2 和 Inception v3 来自同一篇论文《Rethinking the Inception Architecture for Computer Vision》，作者提出了一系列能增加准确度和减少计算复杂度的修正方法。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">在这一篇论文中，作者表示非常深的卷积网络自 2014 年以来就成为了计算机视觉领域的主流，它在各种基准测试中都获得了非常多的提升。只要有足够的标注数据，增加模型大小与计算成本可以在大多数任务中快速提升模型质量。在这篇论文中，作者积极探索扩展网络的方法，旨在通过适当的分解卷积与积极的正则化尽可能高效地利用添加的计算。他们在 ILSVRC 2012 分类任务挑战赛的验证集上证明了模型的优秀性能，使用每个推断过程有 50 亿次乘加运算的模型，作者实现了单帧评估 21.2% top-1 和 5.6% top-5 误差率，且模型的总参数还不到 250 万。</span></p><p><br></p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p style="text-align: left;line-height: 1.75em;"><span style="font-size: 15px;">论文：Rethinking the Inception Architecture for Computer Vision</span></p></li><li><p style="text-align: left;line-height: 1.75em;"><span style="font-size: 15px;">论文地址：https://arxiv.org/pdf/1512.00567v3.pdf</span></p></li></ul><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">以下首先介绍 Inception V2。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><strong><span style="font-size: 15px;">问题：</span></strong></p><p><br></p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">减少特征的表征性瓶颈。直观上来说，当卷积不会大幅度改变输入维度时，神经网络可能会执行地更好。过多地减少维度可能会造成信息的损失，这也称为「表征性瓶颈」。</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">使用更优秀的因子分解方法，卷积才能在计算复杂度上更加高效。</span></p></li></ul><p><br></p><p style="text-align: justify;line-height: 1.75em;"><strong><span style="font-size: 15px;">解决方案：</span></strong></p><p><br></p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">将 5×5 的卷积分解为两个 3×3 的卷积运算以提升计算速度。尽管这有点违反直觉，但一个 5×5 的卷积在计算成本上是一个 3×3 卷积的 2.78 倍。所以叠加两个 3×3 卷积实际上在性能上会有所提升，如下图所示：</span></p></li></ul><p><br></p><p><img class="" data-ratio="0.8797736916548797" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWibicCBZFh6icBUicU6B6MmHibo84wcqSqG40RRPKxBpQGO9EuekYE0vDI4cEmPXecqdzwa3MuqTad5WgA/640?wx_fmt=png" data-type="png" data-w="707" style=""></p><p style="text-align: left;line-height: 1.75em;"><span style="color: rgb(136, 136, 136);font-size: 12px;"><em>最左侧前一版 Inception 模块中的 5×5 卷积变成了两个 3×3 卷积的堆叠。（图源：https://arxiv.org/pdf/1512.00567v3.pdf）</em></span></p><p><br></p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">此外，作者将 n*n 的卷积核尺寸分解为 1×n 和 n×1 两个卷积。例如，一个 3×3 的卷积等价于首先执行一个 1×3 的卷积再执行一个 3×1 的卷积。他们还发现这种方法在成本上要比单个 3×3 的卷积降低 33%，这一结构如下图所示：</span></p></li></ul><p><br></p><p><img class="" data-ratio="1.1403973509933776" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWibicCBZFh6icBUicU6B6MmHibo8YAJPodqx3VUciaicDgBUsjwicEdJNibAkUpszcOTA209p3IKcTVUfIwliaA/640?wx_fmt=png" data-type="png" data-w="755" style=""></p><p style="text-align: left;line-height: 1.75em;"><span style="color: rgb(136, 136, 136);font-size: 12px;"><em>此处如果 n=3，则与上一张图像一致。最左侧的 5x5 卷积可被表示为两个 3x3 卷积，它们又可以被表示为 1x3 和 3x1 卷积。（图源：https://arxiv.org/pdf/1512.00567v3.pdf）</em></span><br></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">模块中的滤波器组被扩展（即变得更宽而不是更深），以解决表征性瓶颈。如果该模块没有被拓展宽度，而是变得更深，那么维度会过多减少，造成信息损失。如下图所示：</span></p><p><br></p><p><img class="" data-ratio="0.8181818181818182" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWibicCBZFh6icBUicU6B6MmHibo8s9tJBNcL0o6VucDIUlUzwcu2mXPHNbC9AOok0QyRD5Xuaj9Np70KZQ/640?wx_fmt=png" data-type="png" data-w="726" style=""></p><p style="text-align: left;line-height: 1.75em;"><em><span style="color: rgb(136, 136, 136);font-size: 12px;">使 Inception 模块变得更宽。这种类型等同于前面展示的模块（图源：https://arxiv.org/pdf/1512.00567v3.pdf）</span></em></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">前面三个原则用来构建三种不同类型的 Inception 模块（这里我们按引入顺序称之为模块 A、B、C，这里使用「A、B、C」作为名称只是为了清晰期间，并不是它们的正式名称）。架构如下所示：</span></p><p><br></p><p><img class="" data-ratio="0.8586088939566705" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWibicCBZFh6icBUicU6B6MmHibo8ahodeZreYdULgtNHwocUic83zATicplrWPR8icUvjkoADichUA1TYdsloQ/640?wx_fmt=png" data-type="png" data-w="877" style=""></p><p style="text-align: left;"><em><span style="color: rgb(136, 136, 136);font-size: 12px;">这里，「figure 5」是模块 A，「figure 6」是模块 B，「figure 7」是模块 C。（图源：https://arxiv.org/pdf/1512.00567v3.pdf）</span></em><br></p><p><span style="font-size: 15px;text-align: justify;"><br></span></p><p style="text-align: center;"><strong>Inception v3</strong><br></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><strong><span style="font-size: 15px;">问题：</span></strong></p><p><br></p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">作者注意到辅助分类器直到训练过程快结束时才有较多贡献，那时准确率接近饱和。作者认为辅助分类器的功能是正则化，尤其是它们具备 BatchNorm 或 Dropout 操作时。</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">是否能够改进 Inception v2 而无需大幅更改模块仍需要调查。</span></p></li></ul><p><br></p><p style="text-align: justify;line-height: 1.75em;"><strong><span style="font-size: 15px;">解决方案：</span></strong></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">Inception Net v3 整合了前面 Inception v2 中提到的所有升级，还使用了：</span></p><p><br></p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">RMSProp 优化器；</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">Factorized 7x7 卷积；</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">辅助分类器使用了 BatchNorm；</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">标签平滑（添加到损失公式的一种正则化项，旨在阻止网络对某一类别过分自信，即阻止过拟合）。</span></p></li></ul><p><br></p><p style="text-align: center;"><strong>Inception v4</strong></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">Inception v4 和 Inception -ResNet 在同一篇论文《Inception-v4, Inception-ResNet and the Impact of Residual Connections on Learning》中介绍。为清晰起见，我们分成两个部分来介绍。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">在该论文中，研究者介绍道，Inception 架构可以用很低的计算成本达到很高的性能。而在传统的网络架构中引入残差连接曾在 2015ILSVRC 挑战赛中获得当前最佳结果，其结果和 Inception-v3 网络当时的最新版本相近。这使得人们好奇，如果将 Inception 架构和残差连接结合起来会是什么效果。在这篇论文中，研究者通过实验明确地证实了，结合残差连接可以显著加速 Inception 的训练。也有一些证据表明残差 Inception 网络在相近的成本下略微超过没有残差连接的 Inception 网络。研究者还展示了多种新型残差和非残差 Inception 网络的简化架构。这些变体显著提高了在 ILSVRC2012 分类任务挑战赛上的单帧识别性能。作者进一步展示了适当的激活值缩放如何稳定非常宽的残差 Inception 网络的训练过程。通过三个残差和一个 Inception v4 的模型集成，作者在 ImageNet 分类挑战赛的测试集上取得了 3.08% 的 top-5 误差率。</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;"><br></span></p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p style="text-align: left;line-height: 1.75em;"><span style="font-size: 15px;">论文：Inception</span><span style="font-size: 15px;">-v4, Inception-ResNet and
the Impact of Residual Connections on Learning</span></p></li><li><p style="text-align: left;line-height: 1.75em;"><span style="font-size: 15px;">论文地址：https:/</span><span style="font-size: 15px;">/arxiv.org/pdf/1602.07261.pdf</span></p></li></ul><p><br></p><p style="text-align: justify;line-height: 1.75em;"><strong><span style="font-size: 15px;">问题：</span></strong></p><p><br></p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">使模块更加一致。作者还注意到某些模块有不必要的复杂性。这允许我们通过添加更多一致的模块来提高性能。</span></p></li></ul><p><br></p><p style="text-align: justify;line-height: 1.75em;"><strong><span style="font-size: 15px;">解决方案：</span></strong></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">Inception v4 的 stem 被修改了。这里的 stem 参考了在引入 Inception 块之前执行的初始运算集。</span></p><p><br></p><p><img class="" data-ratio="0.7139001349527665" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWibicCBZFh6icBUicU6B6MmHibo87TEiamcCmIoE7wtmoZvmtxAHrxhzSZZdB8HmaYZg2MQqkQKOOHkU51w/640?wx_fmt=png" data-type="png" data-w="741" style=""></p><p style="text-align: left;line-height: 1.75em;"><em><span style="color: rgb(136, 136, 136);font-size: 12px;">图上部是 Inception-ResNet v1 的 stem。图下部是 Inception v4 和 Inception-ResNet v2 的 stem。（图源：https://arxiv.org/pdf/1602.07261.pdf）</span></em></p><p><br></p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">它们有三个主要的 Inception 模块，称为 A、B 和 C（和 Inception v2 不同，这些模块确实被命名为 A、B 和 C）。它们看起来和 Inception v2（或 v3）变体非常相似。</span></p></li></ul><p style="text-align: justify;line-height: 1.75em;"><br></p><p><img class="" data-ratio="0.3189287888009738" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWibicCBZFh6icBUicU6B6MmHibo8d9fAqK4VsFBHyWiaBYUic7gVJKicvG70UMFW1S3OxPUqMjSrASVHEjlibQ/640?wx_fmt=png" data-type="png" data-w="1643" style=""></p><p style="text-align: left;line-height: 1.75em;"><em><span style="color: rgb(136, 136, 136);font-size: 12px;">（左起）在 Inception v4 中使用的 Inception 模块 A、B、C。注意它们和 Inception v2（或 v3）模块的相似性。（图源：https://arxiv.org/pdf/1602.07261.pdf）</span></em></p><p><br></p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">Inception v4 引入了专用的「缩减块」（reduction block），它被用于改变网格的宽度和高度。早期的版本并没有明确使用缩减块，但也实现了其功能。</span></p></li></ul><p style="text-align: justify;line-height: 1.75em;"><br></p><p><img class="" data-ratio="0.5390909090909091" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWibicCBZFh6icBUicU6B6MmHibo8TqySOAjLXscD0Z2Ye8vVYvImFP2Ou7YYiaza07Pg4IRG3D9ZXMK7aQA/640?wx_fmt=png" data-type="png" data-w="1100" style=""></p><p style="text-align: left;line-height: 1.75em;"><em><span style="color: rgb(136, 136, 136);font-size: 12px;">缩减块 A（从 35x35 到 17x17 的尺寸缩减）和缩减块 B（从 17x17 到 8x8 的尺寸缩减）。这里参考了论文中的相同超参数设置（V,I,k）。（图源：https://arxiv.org/pdf/1602.07261.pdf）</span></em></p><p><br></p><p style="text-align: center;"><strong>Inception-ResNet v1 和 v2</strong><br></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">受 ResNet 的优越性能启发，研究者提出了一种混合 inception 模块。Inception ResNet 有两个子版本：v1 和 v2。在我们分析其显著特征之前，先看看这两个子版本之间的微小差异。</span></p><p><br></p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">Inception-ResNet v1 的计算成本和 Inception v3 的接近。</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">Inception-ResNetv2 的计算成本和 Inception v4 的接近。</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">它们有不同的 stem，正如 Inception v4 部分所展示的。</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">两个子版本都有相同的模块 A、B、C 和缩减块结构。唯一的不同在于超参数设置。在这一部分，我们将聚焦于结构，并参考论文中的相同超参数设置（图像是关于 Inception-ResNet v1 的）。</span></p></li></ul><p><br></p><p style="text-align: justify;line-height: 1.75em;"><strong><span style="font-size: 15px;">问题：</span></strong></p><p><br></p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">引入残差连接，它将 inception 模块的卷积运算输出添加到输入上。</span></p></li></ul><p><br></p><p style="text-align: justify;line-height: 1.75em;"><strong><span style="font-size: 15px;">解决方案：</span></strong></p><p><br></p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">为了使残差加运算可行，卷积之后的输入和输出必须有相同的维度。因此，我们在初始卷积之后使用 1x1 卷积来匹配深度（深度在卷积之后会增加）。</span></p></li></ul><p style="text-align: justify;line-height: 1.75em;"><br></p><p><img class="" data-ratio="0.41672025723472667" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWibicCBZFh6icBUicU6B6MmHibo8l7AghEZJArrysEKDnBibNK2lJ5dn7G3r0TlALg5FvNLVicUntuXBRDPA/640?wx_fmt=png" data-type="png" data-w="1555" style=""></p><p style="text-align: left;"><em><span style="color: rgb(136, 136, 136);font-size: 12px;">（左起）Inception ResNet 中的 Inception 模块 A、B、C。注意池化层被残差连接所替代，并在残差加运算之前有额外的 1x1 卷积。（图源：https://arxiv.org/pdf/1602.07261.pdf）</span></em><br></p><p><br></p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">主要 inception 模块的池化运算由残差连接替代。然而，你仍然可以在缩减块中找到这些运算。缩减块 A 和 Inception v4 中的缩减块相同。</span></p></li></ul><p style="text-align: justify;line-height: 1.75em;"><br></p><p><img class="" data-ratio="0.4738771769019248" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWibicCBZFh6icBUicU6B6MmHibo8BKAdtpeKtEr7pny3eJpB2p6uPm4nOn0lib2GibicoQNpboOKUdTw05eFQ/640?wx_fmt=png" data-type="png" data-w="1091" style=""></p><p style="text-align: left;line-height: 1.75em;"><em><span style="color: rgb(136, 136, 136);font-size: 12px;">（左起）缩减块 A（从 35x35 到 17x17 的尺寸缩减）和缩减块 B（从 17x17 到 8x8 的尺寸缩减）。这里参考了论文中的相同超参数设置（V,I,K）。（图源：https://arxiv.org/pdf/1602.07261.pdf）</span></em></p><p><br></p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">如果卷积核的数量超过 1000，则网络架构更深层的残差单元将导致网络崩溃。因此，为了增加稳定性，作者通过 0.1 到 0.3 的比例缩放残差激活值。</span></p></li></ul><p><span style="font-size: 15px;text-align: justify;"><br></span></p><p><span style="font-size: 15px;text-align: justify;"></span></p><p><img class="" data-ratio="0.718336483931947" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWibicCBZFh6icBUicU6B6MmHibo8HeGLbxzo3uiby5Nnb2nZSa39lINYzdeKLm3xppndFA5sMibRpX5346SA/640?wx_fmt=png" data-type="png" data-w="529" style=""></p><p><span style="font-size: 15px;text-align: justify;"></span><br></p><p style="text-align: left;"><em><span style="color: rgb(136, 136, 136);font-size: 12px;">激活值通过一个常数进行比例缩放，以防止网络崩溃。（图源：https://arxiv.org/pdf/1602.07261.pdf）</span></em><br></p><p><br></p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">原始论文并没有在求和之后使用批归一化，以在单个 GPU 上训练模型（在单个 GPU 上拟合整个模型）。</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">研究发现 Inception-ResNet 模型可以在更少的 epoch 内达到更高的准确率。</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">Inception v4 和 Inception-ResNet 的网络完整架构如下图所示：</span></p></li></ul><p><br></p><p><img class="" data-ratio="0.758703481392557" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWibicCBZFh6icBUicU6B6MmHibo8f0pUJic72EZNEyVaY9duHt2ShDRmGwSQx4V1UVvvaI3vH8BiaU3viczqg/640?wx_fmt=png" data-type="png" data-w="833" style=""></p><p style="text-align: left;line-height: 1.75em;"><em><span style="color: rgb(136, 136, 136);font-size: 12px;">图上部是 Inception v4 的架构。图下部是 Inception-ResNet 的架构。（图源：https://arxiv.org/pdf/1602.07261.pdf）</span></em></p><p><br></p><p style="text-align: left;"><span style="color: rgb(136, 136, 136);font-size: 12px;"><em>原文地址：https://towardsdatascience.com/a-simple-guide-to-the-versions-of-the-inception-network-7fc52b863202</em></span></p><p><br></p><p style="white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;line-height: 25.6px;font-family: 微软雅黑;font-size: 14px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(127, 127, 127);box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;color: rgb(62, 62, 62);line-height: 25.6px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(127, 127, 127);box-sizing: border-box !important;word-wrap: break-word !important;"></span></strong></span></strong></p><p style="white-space: normal;max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);"><span style="font-size: 15px;text-align: justify;color: rgb(123, 12, 0);">在 INTERFACE 第七期中，我们邀请到了 GeekPwn 黑客大赛创办人、碁震公司创始人兼 CEO 王琦与清华大学计算机系长聘副教授朱军来一起讨论 AI 安全的攻与防。点击「阅读原文」参与报名。</span></p><p style="white-space: normal;max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);"><span style="font-size: 15px;text-align: justify;color: rgb(123, 12, 0);"><br></span></p><p style="white-space: normal;max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);"><span style="font-size: 15px;text-align: justify;color: rgb(123, 12, 0);"><img class="" data-copyright="0" data-ratio="0.5925925925925926" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_jpg/KmXPKA19gW8kZIZl018dwT1W94WX4N61lDr78OPsUWIZCR09SpgiaOM5wkBtRm3aaLb5GsqKGzVekbSwDGvHxEg/640?wx_fmt=jpeg" data-type="jpeg" data-w="1080"></span></p><p style="white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 12px;color: rgb(217, 33, 66);line-height: 1.6;box-sizing: border-box !important;word-wrap: break-word !important;"></span></strong><br></p>
                </div>
                <script nonce="469685275" type="text/javascript">
                    var first_sceen__time = (+new Date());

                    if ("" == 1 && document.getElementById('js_content')) {
                        document.getElementById('js_content').addEventListener("selectstart",function(e){ e.preventDefault(); });
                    }

                    
                    (function(){
                        if (navigator.userAgent.indexOf("WindowsWechat") != -1){
                            var link = document.createElement('link');
                            var head = document.getElementsByTagName('head')[0];
                            link.rel = 'stylesheet';
                            link.type = 'text/css';
                            link.href = "//res.wx.qq.com/mmbizwap/zh_CN/htmledition/style/page/appmsg_new/winwx3de35e.css";
                            head.appendChild(link);
                        }
                    })();
                </script>
                
                
                                
                <div class="ct_mpda_wrp" id="js_sponsor_ad_area" style="display:none;"></div>

                
                                <div class="reward_area tc reward_area_primary" id="js_preview_reward_author" style="display:none;">
                    <div class="reward-avatar" style="display: none;" id="js_preview_reward_author_avatar">
                        <img src="" alt="" id="js_preview_reward_author_head">
                    </div>
                    <div class="reward-author" id="js_preview_reward_author_name"></div>
                    <p class="reward_tips js_preview_reward_author_wording" style="display:none;"></p>
                    <p>
                        <a class="reward_access" id="js_preview_reward_author_link" href="##"><span id="js_preview_reward_link_text">赞赏</span></a>
                    </p>
                </div>
                
                <div class="reward_qrcode_area reward_area tc" id="js_preview_reward_qrcode" style="display:none;">
                    <p class="tips_global">长按二维码向我转账</p>
                    <p id="js_preview_reward_ios_wording" class="reward_tips" style="display:none;"></p>
                    <span class="reward_qrcode_img_wrp"><img class="reward_qrcode_img" src="//res.wx.qq.com/mmbizwap/zh_CN/htmledition/images/pic/appmsg/pic_reward_qrcode.2x3534dd.png"></span>
                    <p class="tips_global">受苹果公司新规定影响，微信 iOS 版的赞赏功能被关闭，可通过二维码转账支持公众号。</p>
                </div>
                            </div>
                                        
                                

                        
            <ul id="js_hotspot_area" class="article_extend_area"></ul>


            
                        <div class="rich_media_tool" id="js_toobar3">

                                            <a class="media_tool_meta meta_primary" id="js_view_source" href="##">阅读原文</a>
                                <div id="js_read_area3" class="media_tool_meta tips_global_primary meta_primary" style="display:none;">阅读 <span id="readNum3"></span></div>

                <span style="display:none;" class="media_tool_meta meta_extra meta_praise" id="like3">
                    <i class="icon_praise_gray"></i><span class="praise_num" id="likeNum3"></span>
                </span>

                

            </div>


                        <div class="rich_media_tool" id="js_sg_bar">

                                <a class="media_tool_meta meta_primary" href="http://t.cn/R1zjsHc" target="_blank">阅读原文</a>
                                
            </div>
                    </div>

        <div class="rich_media_area_primary sougou" id="sg_tj" style="display:none"></div>


        
        <div class="rich_media_area_extra">
            
            <div id="js_share_appmsg">
            </div>

            
                        <div class="mpda_bottom_container" id="js_bottom_ad_area"></div>
                        
            <div id="js_iframetest" style="display:none;"></div>
                        
                        
            <div class="rich_media_extra rich_media_extra_discuss" id="js_cmt_container" style="display:none">
              

              
              <div class="discuss_mod" id="js_friend_cmt_area" style="display:none">
                
                
                
              </div>

                            <div class="discuss_mod" id="js_cmt_area" style="display:none">
              </div>
                          </div>
        </div>

        
        <div id="js_pc_qr_code" class="qr_code_pc_outer" style="display:none;">
            <div class="qr_code_pc_inner">
                <div class="qr_code_pc">
                    <img id="js_pc_qr_code_img" class="qr_code_pc_img">
                    <p>微信扫一扫<br>关注该公众号</p>
                </div>
            </div>
        </div>
    </div>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
