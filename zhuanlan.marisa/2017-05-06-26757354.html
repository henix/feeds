<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>亮灯问题、杨辉三角与Sierpinski三角形</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/26757354">原文</a></p>
<div class="title-image"><img src="https://pic1.zhimg.com/v2-1666cb908c3f43c75a8fb2f28acc9aac_r.jpg" alt=""></div><h2><b>背景</b><br></h2><p>　　在生日前几天，我出了五道题作为有奖问答，亮灯问题作为第二题，一道规律题出场。答案很容易猜到——只需要模拟一下<equation>n=1</equation>到<equation>n=4</equation>的情况就可以猜到。然而给出一个证明却并不那么简单，甚至可能涉及比表象深得多的东西。</p><h2><b>亮灯问题</b><br></h2><p>　　有<equation>n</equation>盏灯环形排列，顺时针依次标号为<equation>0..n-1</equation>。初始时刻为<equation>0</equation>，所有灯的亮灭（我们称之为状态）<i>随机</i>。下一时刻每盏灯的亮灭取决于当前时刻这盏灯与顺时针方向下一盏灯的亮灭。若两盏灯状态相同，则下一时刻该灯灭，否则该灯亮。  <br>　　试求：当<equation>n</equation>满足什么条件时，能保证在<i>初始状态随机</i>的情况下，时刻<equation>n</equation>所有灯均为灭？</p><br><br><br><br><h2><b>答案</b></h2><equation>n=2^p \quad (p \in \mathbb{N})</equation><br><h2><b>证明</b><br></h2><p>　　环形排列下，直接对灯的标号进行加减可能会出现越界的情况，所以我们需要对结果取模，即第<equation>i</equation>盏灯顺时针方向下<equation>k</equation>盏灯为第<equation>(i+k) \bmod n</equation>盏灯。<br>　　定义<equation>S_t^i</equation>表示时刻<equation>t</equation>第<equation>i</equation>盏灯的亮灭，<equation>0</equation>表示灭，<equation>1</equation>表示亮。</p><p><b>异或？</b> </p><p>　　异或运算应用于逻辑运算（也可以看作为二进制下）。<equation>\oplus</equation>为异或运算符。其运算法则相当于<i>不带进位</i>的二进制加法：<equation>0 \oplus 0=0\\ 1 \oplus 0=1\\ 0 \oplus 1=1\\ 1 \oplus 1=0</equation><br>　　即二进制位相同则结果为<equation>0</equation>，不同为<equation>1</equation>。<br><br>　　根据<i>异或</i>运算的定义及题意，我们可以得到：<equation>S_t^i=S_{t-1}^i \oplus S_{t-1}^{(i+1)\bmod n}</equation><br></p><p>　　又因为异或运算等价于不带进位的加法，而我们只关注<equation>S_t^i</equation>的奇偶，所以有：<equation>S_t^i=\left(S_{t-1}^i+S_{t-1}^{(i+1)\bmod n}\right) \bmod 2</equation></p><p>　　由于在时刻<equation>t</equation>，标号为<equation>i</equation>的灯受到上一时刻标号<equation>i</equation>、<equation>(i+1) \bmod n</equation>的灯的影响，而在时刻<equation>(t-1)</equation>，标号<equation>(i+1) \bmod n</equation>灯受到时刻<equation>(t-2)</equation>下标号<equation>(i+1) \bmod n</equation>、<equation>(i+2) \bmod n</equation>灯的影响。继续推导可知，时刻<equation>t</equation>下<equation>i</equation>灯受到时刻<equation>0</equation>下<equation>i</equation>灯到<equation>(i+t) \bmod n</equation>灯初始状态的影响，<i>并且可能不止一次</i>。</p><p>　　注意有<equation>a \bmod p+b \bmod p=(a+b) \bmod p</equation>的性质，所以方便起见，我们可以将取模运算放在最后操作。以下<equation>S</equation>的值域将会扩充到自然数集，但是其意义仍为<equation>S \bmod 2</equation>。</p><p><b>受几次影响？</b> </p><p>　　定义<equation>Z_t^k</equation>表示时刻<equation>t</equation>下标号为<equation>i</equation>的灯受到<equation>(i+k) \bmod n</equation>灯初始状态的影响次数，则有：<equation>S_t^i=\sum_{j=0}^t Z_t^j S_0^{(i+j) \bmod n}</equation></p><p>　　根据<equation>S</equation>与<equation>Z</equation>的定义，我们有：<equation>S_{t+1}^i=\sum_{j=0}^{t+1} Z_{t+1}^j S_0^{(i+j) \bmod n}=S_t^i+S_t^{i+1}</equation></p><p>　　展开上式，得：<equation>\sum_{j=0}^{t+1} Z_{t+1}^j S_0^{(i+j) \bmod n}=\sum_{k=0}^t Z_t^k S_0^{(i+k) \bmod n}+\sum_{l=0}^t Z_t^l S_0^{(i+l+1) \bmod n}</equation></p><p>　　因为<equation>Z</equation>的定义，所以<equation>Z_t^{-1}</equation>与<equation>Z_t^{t+1}</equation>是无意义的，值为<equation>0</equation>，则上式可改写成下式形式：<equation>\begin{align}\sum_{j=0}^{t+1} Z_{t+1}^j S_0^{(i+j) \bmod n}&amp;=\sum_{k=0}^{t+1} Z_t^k S_0^{(i+k) \bmod n}+\sum_{l=0}^{t+1} Z_t^{l-1} S_0^{(i+l) \bmod n}\\ &amp;=\sum_{k=0}^{t+1} \left(Z_t^k S_0^{(i+k) \bmod n}+Z_t^{k-1} S_0^{(i+k) \bmod n}\right)\\ &amp;=\sum_{k=0}^{t+1} \left(Z_t^k+Z_t^{k-1}\right) S_0^{(i+k) \bmod n} \end{align}</equation></p><p>　　所以有<equation>Z</equation>的推导公式：<equation>Z_{t+1}^k=Z_t^{k-1}+Z_t^k</equation></p><p>　　根据定义可以得到边界条件：<equation>Z_0^0=1</equation></p><p>　　不难发现<equation>Z</equation>与<equation>C</equation>的边界条件与推导公式相同，则有：<equation>Z_t^k=C_t^k</equation>，<equation>S_t^i=\left(\sum_{j=0}^t C_t^j S_0^{(i+j) \bmod n}\right) \bmod 2</equation></p><p><b>均灭？</b> </p><p>　　若时刻<equation>n</equation>所有灯均灭，则上一时刻即时刻<equation>(n-1)</equation>时，标号<equation>i</equation>的灯应受所有灯影响或不受任何一灯影响。但通过<equation>C_{n-1}^k</equation>的奇偶性我们发现，不受任何一灯影响是不可能的。则<equation>i</equation>灯应受所有灯影响，即为：<equation>C_{n-1}^k=1 \quad (n \in Result, k \in \mathbb{N}, 0 \leq k \leq n-1)</equation></p><p>　　不妨将<equation>C_t^k \bmod 2</equation>即杨辉三角对<equation>2</equation>取模的图形）列出来：<br><img src="https://pic4.zhimg.com/v2-646bcd3eff9aad3f18b0d8842d09f956_r.png" data-rawwidth="966" data-rawheight="800">　　不难发现<i>规律</i>：第<equation>2^p-1</equation>行符合全为<equation>1</equation>的条件，也就是说，答案为<equation>n=2^p (p \in \mathbb{N})</equation>（别忘了<equation>n=1</equation>的情况！）而如果我们将<equation>1</equation>染为黑色等边三角形，将<equation>0</equation>染为白色等边三角形（如图），我们将得到<i>Sierpinski三角形</i>（谢尔宾斯基三角形）。Sierpinski三角形是分形图形的一个经典图形，在<a href="http://www.matrix67.com/blog/archives/280">Matrix67的博客</a>里也有提及。</p><p><b>Sierpinski三角形？</b> </p><p>　　接下来，我们需要证明为什么第<equation>2^p-1</equation>行符合全为<equation>1</equation>的条件。则我们需要证明：<equation>C_{2^p-1}^k \equiv 1 \pmod 2 \quad (k \in \mathbb{N}, 0 \leq k \leq 2^p-1)</equation></p><p>　　展开得：<equation>\frac{(2^p-1)!}{k!(2^p-1-k)!} \equiv 1 \pmod 2</equation></p><p>　　定义<equation>G_i</equation>表示<equation>i</equation>分解质因数后<equation>2</equation>的个数。定义<equation>T_r^l=\sum_{j=l}^r G_j</equation>，则上式可由下式证得：<equation>T_k^1=T_{2^p-1}^{2^p-k}</equation><br></p><p>　　若将<equation>i</equation>写为二进制，则<equation>G_i</equation>为二进制下<equation>i</equation>末尾<equation>0</equation>的个数。不难发现有以下两条性质：<equation>G_i=G_{i+2^j} \quad (i, j \in \mathbb{Z^{+}}, 2^j &gt; i)</equation>，<equation>G_{2^j}=j \quad (j \in \mathbb{Z^{+}})</equation></p><p>　　二进制下<equation>(i+2^j)</equation>可由二进制下<equation>i</equation>的第<equation>j</equation>位由<equation>0</equation>变<equation>1</equation>得到，由于第<equation>j</equation>位在限制条件下一定比<equation>i</equation>的最高位更高，所以在第<equation>j</equation>位添加<equation>1</equation>对末尾<equation>0</equation>的个数即<equation>G</equation>无影响，第一条式子得证。第二条式子也可以根据<equation>G</equation>的定义得到。</p><p>　　接下来我们需要证明：在<equation>1..2^p-1</equation>的范围内，<equation>G</equation>以<equation>2^{p-1}</equation>为轴对称。</p><p>　　首先注意到，在<equation>p=1</equation>的条件下，该结论成立。我们需要将结论扩展到<equation>p \in \mathbb{Z^{+}}</equation>。</p><p>　　若在<equation>1..2^p-1</equation>范围内，<equation>G</equation>以<equation>2^{p-1}</equation>为轴对称，则有：<equation>G_i=G_{2^{p-1}+(2^{p-1}-i)}=G_{2^p-i}</equation></p><p>　　又因为<equation>G_i=G_{i+2^p}</equation>，所以：<equation>G_{i+2^p}=G_i=G_{2^p-i}</equation></p><p>　　并且有<equation>G_{2^p}=G_{2^p}</equation>，所以在<equation>1..2^{p+1}-1</equation>范围内，<equation>G</equation>以<equation>2^p</equation>为轴对称。所以我们可以将<equation>p=1</equation>下的结论扩展到<equation>p \in \mathbb{Z^{+}}</equation>。</p><p>　　根据<equation>G</equation>的对称性，我们有下式成立：<equation>T_k^1=T_{2^p-1}^{2^p-k}</equation><br></p><p>　　所以下式成立：<equation>\frac{(2^p-1)!}{k!(2^p-1-k)!} \equiv 1 \pmod 2</equation></p><p>　　得：<equation>C_{2^p-1}^k \equiv 1 \pmod 2 \quad (k \in \mathbb{N}, 0 \leq k \leq 2^p-1)</equation></p><p>　　得证。</p><p>　　根据第<equation>2^p-1</equation>行均为<equation>1</equation>，我们可以推得第<equation>2^p</equation>行只有<equation>C_{2^p}^0</equation>与<equation>C_{2^p}^{2^p}</equation>为<equation>1</equation>，其余为<equation>0</equation>，这两个<equation>1</equation>将分别向下扩展到<equation>2^{p+1}-1</equation>行，形成与<equation>1</equation>到<equation>2^p-1</equation>行相同的Sierpinski三角形。</p><p>　　所以杨辉三角在对<equation>2</equation>取模的情况下，将会形成Sierpinski三角形。</p><p>　　我们的问题也证明完毕，证得答案为<equation>n=2^p (p \in \mathbb{N})</equation>。</p><p>　　本文同步发表于<a href="http://snakes.moe/detail/3">我的博客</a>。</p><p>　　本人才疏学浅，难免有错漏之处，请于评论区指正，谢谢。</p><p>　　版权所有，转载请联系作者，禁止任何形式的未经授权的转载。 </p>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
