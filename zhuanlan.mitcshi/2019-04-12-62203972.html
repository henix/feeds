<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>估值过高能否预测市场下行风险？</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/62203972">原文</a></p>
<div class="title-image"><img src="https://pic3.zhimg.com/v2-a53c2fea03930bed0cd7aa14f8b91adf_b.jpg" alt=""></div><h2><b>摘要</b></h2><p>基于 A 股的实证显示，使用市场估值指标后，发生市场下行的条件概率显著高于非条件概率。市场整体估值对预测股灾有一定的作用。</p><h2><b>1 引言</b></h2><p>预测市场下行风险不仅是量化投资中的一个热门课题，对于高波动的 A 股市场有更重要的实践意义。学术界的预测模型主要包括基本面模型、统计模型和行为模型三大类（下表）。</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-ce515e0bedef939b5c778d5ec2a75c74_b.jpg" data-caption="" data-size="normal" data-rawwidth="937" data-rawheight="337" class="origin_image zh-lightbox-thumb" width="937" data-original="https://pic1.zhimg.com/v2-ce515e0bedef939b5c778d5ec2a75c74_r.jpg"/></noscript><img src="https://pic1.zhimg.com/v2-ce515e0bedef939b5c778d5ec2a75c74_b.jpg" data-caption="" data-size="normal" data-rawwidth="937" data-rawheight="337" class="origin_image zh-lightbox-thumb lazy" width="937" data-original="https://pic1.zhimg.com/v2-ce515e0bedef939b5c778d5ec2a75c74_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-ce515e0bedef939b5c778d5ec2a75c74_b.jpg"/></figure><p>无论采用哪种模型，<b>其目标是给出未来一段时间市场发生给定程度以上跌幅的条件概率</b>。如果预测准确，它可以帮我们有效的规避下行风险、降低投资损失。</p><p>近三十年来，学术界使用以上模型针对海外股市进行了大量的研究。然而由于 A 股的年头较短，这方面的研究相对欠缺。近日，一篇发表在 Journal of Portfolio Management 的文章对于 A 股进行了相关研究（Lleo and Ziemba 2018）。该文使用基本面模型中的估值指标 —— BSEYD、P/E、CAPE —— 对沪、深两市的下行风险构建了预测模型和准确性检验。<b>从结果来看，使用估值指标可以显著提高市场下行风险的条件概率，对预测股灾有一定作用。</b></p><p>本文简要介绍 Lleo and Ziemba (2018)。</p><h2><b>2 下行样本识别</b></h2><p>研究的第一步是识别下行样本。根据 Lleo and Ziemba (2018) 的定义，一个下行样本始于某局部高点（该交易日称为 Peak Date）、止于某局部低点（该交易日称为 Trough Date），且两者之间的跌幅不小于 10%。此外，对于一个下行样本，还有一个非常重要的概念 —— <b>Crash Identification Date</b>，即<b>下行</b>（或股灾）<b>识别日</b>。</p><p>从任意局部高点开始，如果在后续的某个交易日的收盘价满足下行识别日条件，该交易日被选做下行识别日，从而确定了下行样本，该下行样本直到再后面的某个局部低点结束。<b>Lleo and Ziemba (2018) 对于下行识别日需要满足的条件限制十分苛刻，目的是为了保证算法找出的下行样本相互独立</b>，否则在市场连续长时间阴跌的时期，挑出的下行样本可能出现相互重叠的现象。</p><p>下行识别日在 Lleo and Ziemba (2018) 的模型中的作用十分关键。本文第四节中我们会看到，在评价预测模型准确性时也会用到它。</p><p>下图是上证指数上的一个下行样本。根据Lleo and Ziemba (2018) 的识别算法，它从 2002/07/08 开始（收盘价 1732.93），然而它并没有在图中第一个“深沟”即 2003/01/03 日结束。其原因是算法确认的下行识别日是 2003/04/23，晚于第一个“深沟”的日期。最终，这段下行样本止于 2003/11/18（收盘价 1316.56），跌幅超过 24%。</p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-930f85be261cf0420fe40647ebfe0697_b.jpg" data-caption="" data-size="normal" data-rawwidth="719" data-rawheight="389" class="origin_image zh-lightbox-thumb" width="719" data-original="https://pic4.zhimg.com/v2-930f85be261cf0420fe40647ebfe0697_r.jpg"/></noscript><img src="https://pic4.zhimg.com/v2-930f85be261cf0420fe40647ebfe0697_b.jpg" data-caption="" data-size="normal" data-rawwidth="719" data-rawheight="389" class="origin_image zh-lightbox-thumb lazy" width="719" data-original="https://pic4.zhimg.com/v2-930f85be261cf0420fe40647ebfe0697_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-930f85be261cf0420fe40647ebfe0697_b.jpg"/></figure><p>实证中，Lleo and Ziemba (2018) 分别考虑了 1990 年到 2016 年的上证指数和深证综指（399106）。按照上述说明，他们在沪、深两市分别找到了 22 和 21 个下行区间，分别汇总于下表中。</p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-f57067178eb572e0336154a43be7ec5a_b.jpg" data-caption="" data-size="normal" data-rawwidth="1068" data-rawheight="695" class="origin_image zh-lightbox-thumb" width="1068" data-original="https://pic3.zhimg.com/v2-f57067178eb572e0336154a43be7ec5a_r.jpg"/></noscript><img src="https://pic3.zhimg.com/v2-f57067178eb572e0336154a43be7ec5a_b.jpg" data-caption="" data-size="normal" data-rawwidth="1068" data-rawheight="695" class="origin_image zh-lightbox-thumb lazy" width="1068" data-original="https://pic3.zhimg.com/v2-f57067178eb572e0336154a43be7ec5a_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-f57067178eb572e0336154a43be7ec5a_b.jpg"/></figure><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-62fac23a878be392f53b18b0a38b69fe_b.jpg" data-caption="" data-size="normal" data-rawwidth="1079" data-rawheight="672" class="origin_image zh-lightbox-thumb" width="1079" data-original="https://pic3.zhimg.com/v2-62fac23a878be392f53b18b0a38b69fe_r.jpg"/></noscript><img src="https://pic3.zhimg.com/v2-62fac23a878be392f53b18b0a38b69fe_b.jpg" data-caption="" data-size="normal" data-rawwidth="1079" data-rawheight="672" class="origin_image zh-lightbox-thumb lazy" width="1079" data-original="https://pic3.zhimg.com/v2-62fac23a878be392f53b18b0a38b69fe_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-62fac23a878be392f53b18b0a38b69fe_b.jpg"/></figure><p>接下来就是针对这些下行样本构建预测模型。</p><h2><b>3 预测模型</b></h2><p>下行风险预测模型使用选定的基本面估值指标 —— 如 BSEYD、P/E ratio 或 CAPE —— 计算信号：信号等于 1 说明在未来有跌幅超过 10% 的下行风险；信号为 0 说明没有该风险。此外，Lleo and Ziemba (2018) 给出了评价该模型准确性的算法。本节和下节分别介绍预测模型和评价模型准确性的算法。</p><p>预测模型的原理非常简单。<b>假设基本面指标在交易日 t 的取值为 M_t，使用该指标在过去一段长度为 d 的窗口内的均值和标准差计算出一个阈值 K_t；如果 M_t &gt; K_t，则认为市场估值过高，因而下行风险信号 S_t = 1、反之则认为下行风险信号 S_t = 0。</b></p><p>在计算阈值 K_t 时，Lleo and Ziemba (2018) 选择的滚动窗口长度 d 为 252 个交易日，从而动态计算不同市场环境下估值的阈值。在具体计算 K_t 时，他们采用了两种方法：（1）正态分布假设；（2）Cantelli 不等式。</p><p>由于仅考虑估值过高风险，故采用单边 95% 的置信区间。在正态分布的假设下，该阈值 K_t 对应均值加上 1.645 个标准差：</p><p><img src="https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Brrll%7D+%26K_t%26%3D%26%5Cdisplaystyle%5Cmu_t%5Ed%2B1.645%5Ctimes%5Csigma_t%5Ed%5C%5C+%5Cmbox%7Bwhere%7D%26%5Cmu_t%5Ed%26%3D%26%5Cdisplaystyle%5Cfrac%7B1%7D%7Bd%7D%5Csum_%7Bi%3D0%7D%5E%7Bd-1%7DM_%7Bt-i%7D%5C%5C+%26%5Csigma_t%5Ed%26%3D%26%5Cdisplaystyle%5Csqrt%7B%5Cfrac%7B1%7D%7Bd-1%7D%5Csum_%7Bi%3D0%7D%5E%7Bd-1%7D%5Cleft%28M_%7Bt-i%7D-%5Cmu_t%5Ed%5Cright%29%5E2%7D+%5Cend%7Barray%7D+" alt="\begin{array}{rrll} &amp;K_t&amp;=&amp;\displaystyle\mu_t^d+1.645\times\sigma_t^d\\ \mbox{where}&amp;\mu_t^d&amp;=&amp;\displaystyle\frac{1}{d}\sum_{i=0}^{d-1}M_{t-i}\\ &amp;\sigma_t^d&amp;=&amp;\displaystyle\sqrt{\frac{1}{d-1}\sum_{i=0}^{d-1}\left(M_{t-i}-\mu_t^d\right)^2} \end{array} " eeimg="1"/> </p><p>考虑到市场估值指标在任意一段给定长度为 d 的窗口内不一定很好的满足正态分布假设，Lleo and Ziemba (2018) 同时使用了Cantelli 不等式作为另外一种计算阈值 K_t 的方法。该不等式是我们熟悉的 Chebyshev’s inequality（切比雪夫不等式）的单尾形式。对于未知分布的随机变量 M，假设其均值和标准差为 μ 和 σ，由 Cantelli 不等式有：</p><p><img src="https://www.zhihu.com/equation?tex=%5Cdisplaystyle+%5Cmbox%7Bprob%7D%28M-%5Cmu%5Cge%5Cgamma%5Csigma%29%5Cle%5Cfrac%7B1%7D%7B1%2B%5Cgamma%5E2%7D" alt="\displaystyle \mbox{prob}(M-\mu\ge\gamma\sigma)\le\frac{1}{1+\gamma^2}" eeimg="1"/> </p><p>上式中，另 β = 1/(1+γ²) 可得：</p><p><img src="https://www.zhihu.com/equation?tex=%5Cdisplaystyle+%5Cmbox%7Bprob%7D%5Cleft%28M-%5Cmu%5Cge%5Csigma%5Csqrt%7B%5Cfrac%7B1%7D%7B%5Cbeta%7D-1%7D%5Cright%29%5Cle%5Cbeta" alt="\displaystyle \mbox{prob}\left(M-\mu\ge\sigma\sqrt{\frac{1}{\beta}-1}\right)\le\beta" eeimg="1"/> </p><p>在模型中，Lleo and Ziemba (2018) 选择 β = 0.25，对应 σ 的乘数为 1.732，比正态分布下的 1.645 略高。</p><p>采用上述正态分布模型或 Cantelli 不等式即可计算出给定交易日 t 的估值阈值上限 K_t。通过比较当日实际估值指标 M_t 和 K_t 的关系，就能发出市场是否在未来出现下行风险的信号 S_t。<b>在这个判断中，必须要回答的另一个问题就是：这个信号管多久 —— 市场在未来多长时间窗口内（记为 H）会出现 10% 以上的下行风险</b>。H 的选择是预测模型设定问题，在 Lleo and Ziemba (2018) 中其取值为 252 个交易日。</p><h2><b>4 模型准确性评价</b></h2><p>接下来介绍如何评价预测模型的准确性。</p><p>当模型给出 S_t = 1 的信号后，如果在 t 之后的 H 个交易日内包含了某个下行识别日（回想一下第二节的定义），那么则认为发生了市场下行（记为  <img src="https://www.zhihu.com/equation?tex=C_%7Bt%2C+H%7D+%3D+1" alt="C_{t, H} = 1" eeimg="1"/> ）、模型信号准确。根据这个定义，预测模型的准确性可以由下面这个条件概率度量：</p><p><img src="https://www.zhihu.com/equation?tex=%5Cdisplaystyle+%5Cmbox%7Bprob%7D%28%5Cmbox%7BC%7D_%7Bt%2CH%7D%3D1%7C%5Cmbox%7BS%7D_t%3D1%29" alt="\displaystyle \mbox{prob}(\mbox{C}_{t,H}=1|\mbox{S}_t=1)" eeimg="1"/> </p><p>因此，只需找出实证期内所有独立的 S_t = 1 信号（为排除市场的自相关性，只有当两个下行风险信号相差 30 个交易日时才被视作独立信号），并考察每个信号之后的 H 个交易日是否包含下行识别日，即可计算出上述条件概率。数学推导可知，使用样本数据计算的条件概率也是模型准确性的 maximum likelihood estimate（具体推导请见 Lleo and Ziemba 2018，这里不再赘述）。</p><p>别着急，还没完。</p><p>由于 A 股牛短熊长、波动巨大的特点，从任何一个天往后看 252（H 的取值）个交易日，出现下行风险（跌 10% 以上）的先验概率都很大（实证数据显示，这个先验概率大概是 70% 左右）。<b>只有当预测模型给出的条件概率显著高于这个非条件先验概率时，我们才能说使用估值指标进行预测能带来一定的价值。</b></p><p>出于这个考虑，Lleo and Ziemba (2018) 使用 Likelihood Ratio Test 对此进行了假设检验。该检验的 null hypothesis 是 p = p_0，这里 p_0 是下行先验概率 —— 即在实证期内任选一天，在其后 252 个交易日内包含下行识别日的概率。该假设的 Likelihood Ratio Test 如下：</p><p><img src="https://www.zhihu.com/equation?tex=%5Cdisplaystyle+%5CLambda%3D%5Cfrac%7BL%28p%3Dp_0%29%7D%7BL%28p%3D%5Chat+p%29%7D" alt="\displaystyle \Lambda=\frac{L(p=p_0)}{L(p=\hat p)}" eeimg="1"/> </p><p>其中 L 为 likelihood function，\hat p 是预测模型给出的条件概率（p = \hat p 为 alternative hypothesis）。使用 Λ 定义 test statistic：Y = -2logΛ，它满足自由度为 1 的 chi-squared 分布，其 10%、5%、1% 显著性水平下对应的阈值分别为 2.71、3.83 和 6.63。如果实证数据给出的 Y 值超过上述某个阈值，则我们就可以在相应的显著性水平下拒绝原假设。</p><h2><b>5 实证结果</b></h2><p>下面来看实证结果。</p><p>Lleo and Ziemba (2018) 首先考察了 P/E 和 log(P/E) 两个市场估值指标。下表总结了模型的预测结果以及准确性分析结果，其中对于沪、深两市各有四行，这是因为对于每个指标，都分别有两种计算阈值的方法 —— 正态分布和 Cantelli 不等式。</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-d39d0fc41ce30c321ca0eebbfa31e754_b.jpg" data-caption="" data-size="normal" data-rawwidth="1176" data-rawheight="505" class="origin_image zh-lightbox-thumb" width="1176" data-original="https://pic1.zhimg.com/v2-d39d0fc41ce30c321ca0eebbfa31e754_r.jpg"/></noscript><img src="https://pic1.zhimg.com/v2-d39d0fc41ce30c321ca0eebbfa31e754_b.jpg" data-caption="" data-size="normal" data-rawwidth="1176" data-rawheight="505" class="origin_image zh-lightbox-thumb lazy" width="1176" data-original="https://pic1.zhimg.com/v2-d39d0fc41ce30c321ca0eebbfa31e754_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-d39d0fc41ce30c321ca0eebbfa31e754_b.jpg"/></figure><p>以上证指数为例，P/E 指标在这使用这两种计算阈值方法时，分别给出了 19 和 18 次下行风险信号，其中正确的次数分别为 17 和 16 次，因此条件概率高达 89% 上下。另一方面，对于上证指数，出现下行风险的非条件先验概率为 70%。</p><p><b>通过假设检验可知，test statistic Y 的取值在这两种方法下分别为 4.31（5% 的显著性水平）和 3.81（10% 的显著性水平），因此可以说基于 P/E 估值指标的预测模型对于鉴别市场下行风险提供了显著的增量信息。</b>我们可以对上表中其他各行的结果做类似的解读。</p><p>除了预测信号的准确性外，我们也关注召回率。对于沪深两市，在整段实证期内分别由 22 和 21 次下行样本。使用 P/E 及 log(P/E)，在上证指数上正确找到 17 个，召回率为 77%；而在深证综指上正确找出 8 个，召回率仅有可怜的 38%。<b>该模型的召回率在沪深两市上的巨大差异值得进一步的研究。</b></p><p>除了 P/E 和 log(P/E) 之外，Lleo and Ziemba (2018) 还考虑了其他估值指标：BSEYD、log(BSEYD)、CAPE、log(CAPE)。由于计算 CAPE 需要用到十年的历史数据，因此预测模型的实证期为 2005 年到 2016 年。下表给出了不同估值指标的预测结果。</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-93554605bb60e61bd91520af1fafa6f0_b.jpg" data-caption="" data-size="normal" data-rawwidth="1167" data-rawheight="728" class="origin_image zh-lightbox-thumb" width="1167" data-original="https://pic1.zhimg.com/v2-93554605bb60e61bd91520af1fafa6f0_r.jpg"/></noscript><img src="https://pic1.zhimg.com/v2-93554605bb60e61bd91520af1fafa6f0_b.jpg" data-caption="" data-size="normal" data-rawwidth="1167" data-rawheight="728" class="origin_image zh-lightbox-thumb lazy" width="1167" data-original="https://pic1.zhimg.com/v2-93554605bb60e61bd91520af1fafa6f0_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-93554605bb60e61bd91520af1fafa6f0_b.jpg"/></figure><p>首先需要插一句的是，上表中特别用红框标出来的部分应该是 typo。根据 Lleo and Ziemba (2018) 上下文的描述，对于上证指数，CAPE 和 log(CAPE) 应该各自发出了 3 次信号、而非 5 次，且 3 次全部正确，因此准确率才有 100%。在此特别“鄙视”一下审稿人。</p><blockquote><i>For the SHCOMP, none of the measures produced more than five signals. The CAPE, logCAPE, and BSEYD10 generated</i> <i><b>three</b></i> <i>signals each.</i></blockquote><p>下面来讨论结果。非常有意思的是，对于 2005 年之后的市场，该模型 —— 无论使用什么指标 —— 在沪、深两市上的效果较整段实证期来说发生了反转。对于深证综指，这些指标的准确率和召回率都更高，而对于上证指数，仅 CAPE 和 log(CAPE) 较非条件先验概率显著的提升了准确性。然而从召回率来看，自 2005 年到 2016 年之间，上证指数一共出现 6 次下行样本，而上述两个指标仅找到三次，召回率仅有 50%。</p><p>Lleo and Ziemba (2018) 对于模型在沪、深两市上的差异也做了思考。除了样本量较少造成的误差之外，二位作者认为该分歧也和沪深两市上市公司的属性差异很大有关。上交所的上市公司多为国有企业，而深交所的上市公司多为民营企业。二位作者猜测，政府对国有企业支持而造成对市场的干预，有可能会推迟和减少下行风险的出现，从而影响预测模型的效果。</p><h2><b>6 结语</b></h2><p>预测市场什么时候要 crash 从来就不容易。将市场的 P/E 或者 CAPE 这类估值指标和未来收益率关联起来的尝试并也不是什么新鲜事物。但今天之所以介绍 Lleo and Ziemba (2018) 是希望它在 A 股上的实证结果能给我们一些启发。</p><p>2014 年，Robert Shiller 教授纽约时报上撰文称，<b>提出 CAPE 的目的不是为了预测市场未来的涨跌</b>，而是希望在市场估值过高时引发人们的思考。</p><blockquote><b><i>The CAPE was never intended to indicate exactly when to buy and to sell.</i></b> <i>The market could remain at these valuations for years. But we should recognize that we are in an unusual period, and that it&#39;s time to ask some serious questions about it.</i></blockquote><p>从 Lleo and Ziemba (2018) 的结果以及其他针对 A 股的实证分析来看，过高估值和未来的下行风险之间肯定存在着某种正相关性。然而，要想利用这种相关性、将其作为整套量化系统（特别是风险管理）的一部分，或者使用它进行市场或者其他风格因子择时，仍有很多的问题需要解答。</p><p class="ztext-empty-paragraph"><br/></p><p><b>参考文献</b></p><ul><li>Goetzmann, W., D. Kim, and R. Shiller (2016). <i>Crash beliefs from investor surveys</i>. Working paper.</li><li>Gresnigt, F., E. Kole, and P. Franses (2015). Interpreting financial market crashes as earthquakes: a new early warning system for medium-term crashes. <i>Journal of Banking &amp; Finance</i>, Vol. 56, 123 – 139.</li><li>Jarrow, R. A., Y. Kchia, and P. Protter (2011). How to detect an asset bubble. <i>SIAM Journal on Financial Mathematics</i>, Vol. 2(1), 839 – 865.</li><li>Lleo, S. and W. T. Ziemba (2017). Does the bond-stock earnings yield differential model predict equity market corrections better than high P/E models? <i>Financial Markets, Institutions &amp; Instruments</i>, Vol. 26(2), 61 – 123.</li><li>Lleo, S. and W. T. Ziemba (2018). Predicting stock market crashes in China. <i>The Journal of Portfolio Management</i>, Vol. 44(5), 125 – 135.</li><li>Shiryaev, A. N. and M. V. Zhitlukhin (2012). Bayesian disorder detection problems on filtered probability space. <i>Theory of Probability and Its Applications</i>, Vol. 57(3), 497 – 511.</li><li>Ziemba, W. T. and S. L. Schwartz (1991). <i>Invest Japan</i>. Chicago: Probus.</li></ul><p class="ztext-empty-paragraph"><br/></p><p class="ztext-empty-paragraph"><br/></p><p>原创不易，请保护版权。如需转载，请联系获得授权，并注明出处，谢谢。已委托“维权骑士”(<a href="https://link.zhihu.com/?target=http%3A//rightknights.com/" class=" wrap external" target="_blank" rel="nofollow noreferrer">维权骑士_免费版权监测/版权保护/版权分发</a>) 为进行维权行动。</p>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
