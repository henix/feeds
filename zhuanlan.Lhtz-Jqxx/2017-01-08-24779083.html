<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>【Python量化投资】系列之SVR预测第二天开盘趋势和股价的正负统计分析</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/24779083">原文</a></p>
<div class="title-image"><img src="https://pic4.zhimg.com/v2-e9df2a0aa4b1ce3fab4e3f1a13fea6d4_r.jpg" alt=""></div><strong>本期导读</strong><p>⊙ML、SVM介绍</p><p>⊙股价的正负统计分析</p><p>⊙预测第二天开盘趋势</p><br><p>机器学习方法是计算机科学的一个分支，它借助于计算机算法，对数据进行分析后，实现模式识别，进而实现对未来数据的预测。</p><p>机器学习方法可以分为以下几个类别：</p><blockquote><h4><strong>1.监督学习：</strong></h4></blockquote><p>训练的输出分类是预先设定好的，根据输入和输出，算法的目标在于寻找其中的对应函数。</p><br><blockquote><h4><strong>2.无监督学习：</strong></h4></blockquote><p>训练的输出分类是预先不知道的。算法的目标在于发现数据中的结构，如聚类分析。</p><br><blockquote><h4><strong>3.半监督学习：</strong></h4></blockquote><p>介于监督学习和无监督学习之间。</p><br><blockquote><h4><strong>4.增强学习：</strong></h4></blockquote><p>算法通过执行一系列的动作，影响环境中的可观察变量，从而得到环境对动作反应的规律。最后根据这个规律，判断该采取何种行动以最大化某种回报。</p><br><p>监督式学习是机器学习的一个分支，可以通过训练样本而建立起一个输入和输出之间的函数，并以此对新的事件进行预测。<br></p><br><h4>典型的监督学习流程如下：</h4><img src="https://pic4.zhimg.com/v2-b41ad2f7103afe564ecb187286376e9f_r.png" data-rawwidth="654" data-rawheight="528"><br><br><h4><strong>支持向量机</strong></h4><p>是监督学习中一种常用的学习方法。</p><p>支持向量机（ Support Vector Machines SVM ）是一种比较好的实现了结构风险最小化思想的方法。它的机器学习策略是结构风险最小化原则 为了最小化期望风险，应同时最小化经验风险和置信范围）。具体就不详细介绍了，百度有很多资料。</p><p>http://scikit-learn.org/stable/modules/svm.html#svm 中是SVM函数和简单介绍。</p><p>from sklearn.svm import SVR 可以构造支持向量回归（Support Vector Regression）模型</p><p>from sklearn.svm import SVC 可以用于分类（Support Vector Classification）</p><p>Support Vector Regression官网的一个简单例子。<br></p><p>http://scikit-learn.org/stable/auto_examples/svm/plot_svm_regression.html#example-svm-plot-svm-regression-py</p><img src="https://pic1.zhimg.com/v2-8ed37a0c2c8d5622b6e31459432885bc_r.png" data-rawwidth="868" data-rawheight="603"><img src="https://pic3.zhimg.com/v2-0c1663263b121783e7bf1e19c04fb0d6_r.png" data-rawwidth="621" data-rawheight="507"><br><p>从回归的角度，可以根据之前的历史数据，预测下一个时间点的股价。</p><p>分类的角度，可以根据历史数据，预测下一个时间点股价的正负。</p><p>下面对股票数据进行回归建模。</p><img src="https://pic4.zhimg.com/v2-66f708b0e122397f83df8dce5fb44631_r.png" data-rawwidth="1042" data-rawheight="582"><img src="https://pic2.zhimg.com/v2-1e847d1583cce83c4efddeb175c65f14_r.png" data-rawwidth="846" data-rawheight="451"><br><br><h4><strong>特征选择</strong><br></h4><p>基本面因子：PE，PB，ROE等</p><p>技术指标因子：RSI、KDJ、MA、MACD等</p><p>蜡烛图形态因子：三乌鸦、锤子线等</p><h4><strong>输出</strong><br></h4><p>股价</p><p>股价涨跌分类</p><p>未来一段时间收益率</p><h4><strong>利用非监督学习甚至深度学习找到特征</strong></h4><p>比如找到大涨的股票，然后看大涨前一段时间的形态有没有相似的，利用非监督学习的方法。显然，这样的关系可能不是那么明显地存在于股票的价格中，可能存在于收益曲线中或者方差曲线中，甚至更高复杂度的统计量中。深度学习提供了将原数据投影到另一个特征空间中的方法，而且是高度非线性的。那么，原数据中没有体现出来的相关性，会不会在这种高度非线性的投影空间中体现出来呢？这个问题值思考。</p><br><br><h2><strong>SVR (Support Vector Regression)</strong></h2><p>SVR是SVM(Support Vector Machine)中的一个版本，可以用于解决回归问题。</p><img src="https://pic3.zhimg.com/v2-04cbf82edb750ed521194408a1cd6451_r.png" data-rawwidth="1041" data-rawheight="385">-0.192138249253<br>0.897470249992 4.88498130835e-17 1.0<br>array([[ 0.22282753,  0.25228758,  0.3448784 ,  0.33066172],       [ 0.26034535,  0.27540362,  0.24237401,  0.20206961]])<br><h2><strong>拟合与预测</strong></h2><p>假设i为1，days为30，</p><p><strong>X</strong>：第i~i+days 天的开盘，收盘，最高，最低数据。</p><p><strong>y</strong>：第i+1~i+days+1 天（对应的第二天）的开盘价。</p><p><strong>X2</strong>：第i~i+days+1天的开盘，收盘，最高，最低数据。</p><p><strong>yrep</strong>：第i+1~i+days+2天（对应的第二天）的预测开盘价。</p><p><strong>yreal</strong>：第i+1~i+days+2天的开盘价。</p><p><strong>yreal2</strong>：第i+days+2天的开盘价减第i+days+1天的开盘价。（真实趋势，大于0表示涨了）</p><p><strong>yrep2</strong>：第i+days+2天的开盘价减第i+days+1天的预测开盘价。（预测趋势，大于0表示涨了）</p><p><strong>同号相乘大于零，这里统计的是所有预测趋势的正确数量，预测涨和跌都算在里面了。</strong><br></p><p><strong>t</strong>：预测成功次数。<br></p><p><strong>后面的两个if统计的是当预测为涨的时候，实际涨的次数和跌的次数。这个胜率只统计预测涨的成功率。</strong><br></p><p><strong>m</strong>：预测上涨，且真实情况上涨的次数。<br></p><p><strong>e</strong>：预测上涨，但真实情况下跌的次数。</p><img src="https://pic4.zhimg.com/v2-0ac121f64f690f491a280245cc8fe631_r.png" data-rawwidth="1046" data-rawheight="626">70.9523809524<br>66.3636363636<p>（结果还不错）<br></p><p>图中蓝线代表的是预测的走势，红点代表输入的训练集，绿点代表未来值，可以看到，蓝线最后一段的走势和红点很接近。</p><img src="https://pic2.zhimg.com/v2-4377891a2f0c99d3e0c13a0a305b5741_r.png" data-rawwidth="1041" data-rawheight="286"><img src="https://pic3.zhimg.com/v2-6afc3e2b38e064cf4908d971146c609e_r.png" data-rawwidth="959" data-rawheight="451">
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
