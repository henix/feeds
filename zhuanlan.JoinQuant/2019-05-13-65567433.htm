<p>　　在今天的文章中，我们将向大家再次介绍经典的CAPM和三五因子模型，并通过beta和市值因子构建一个双因子模型，从一个因子到五个因子，试图来解释中国股票市场的个股价格，我们的模型模板来自经典的三五因子模型，我们评价不同因子的解释力的工具，就是模型的R-square，也就是决定系数。</p><h2><b>一因子CAPM模型</b></h2><p>　　投资组合获取的收益均可以分为两个部分，一部分是来自市场的收益也就是贝塔（β风险），另一部分则是超出市场的收益也就是我们常说的阿尔法（α风险）。这种分类方式源于资本资产定价模型CAPM，该模型由美国经济学家W．F．Sharpe博士于20世纪60年代中期首次提出。</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-0784326fadbd5f409d05b15675e3739d_b.jpg" data-caption="" data-size="normal" data-rawwidth="530" data-rawheight="324" class="origin_image zh-lightbox-thumb" width="530" data-original="https://pic2.zhimg.com/v2-0784326fadbd5f409d05b15675e3739d_r.jpg"/></noscript><img src="https://pic2.zhimg.com/v2-0784326fadbd5f409d05b15675e3739d_b.jpg" data-caption="" data-size="normal" data-rawwidth="530" data-rawheight="324" class="origin_image zh-lightbox-thumb lazy" width="530" data-original="https://pic2.zhimg.com/v2-0784326fadbd5f409d05b15675e3739d_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-0784326fadbd5f409d05b15675e3739d_b.jpg"/></figure><p>CAPM模型的公式是：</p><p>Ri=Rf+βi(Rm-Rf) </p><p>Ri：在给定风险水平条件下资产i的合理预期投资收益率；</p><p>Rf：无风险投资收益率；</p><p>βi：投资于资产i的风险矫正系数，即对资本市场系统风险变化的敏感程度；</p><p>Rm：资本市场的平均投资收益率。</p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-bfdc845def5858d39bc1555817c86b4e_b.jpg" data-caption="" data-size="normal" data-rawwidth="513" data-rawheight="367" class="origin_image zh-lightbox-thumb" width="513" data-original="https://pic3.zhimg.com/v2-bfdc845def5858d39bc1555817c86b4e_r.jpg"/></noscript><img src="https://pic3.zhimg.com/v2-bfdc845def5858d39bc1555817c86b4e_b.jpg" data-caption="" data-size="normal" data-rawwidth="513" data-rawheight="367" class="origin_image zh-lightbox-thumb lazy" width="513" data-original="https://pic3.zhimg.com/v2-bfdc845def5858d39bc1555817c86b4e_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-bfdc845def5858d39bc1555817c86b4e_b.jpg"/></figure><p>　　模型认为市场风险系数是用β值来衡量，更重要的是资产收益率仅和β有关，和其他无关。单只股票的β则定义为：资产收益率与市场组合收益率（可以理解为市场基准指数）之间的协方差（cov((个股收益率,市场收益率)）除以市场组合收益率方差（Var(市场收益率)）。因此我们可以将CAPM模型看作以市场收益率为因子的单因子模型。</p><p><b>CAPM模型是一个单因子模型，因子名称是β</b>。BETA因子用以度量一种证券或一个投资证券组合相对总体市场的波动性，它对于个股收益率具备很强的解释能力，尤其是中国证券市场这种个股受到大盘情绪影响很重的市场，只有少部分股票能够走出独立走势，大部分股票随波逐流。</p><h2><b>二因子beta+市值模型</b></h2><p>　　我们尝试构建了一个双因子模型，因为在中国证券市场，曾经有一段时间认为小市值就是绝对的真理，在2017年之前，我们通过简单的截面回归直观地发现，本期市值升序排名靠前的小市值股票，在下一考核期内的涨幅较高。<b>所以市值因子加上CAPM的beta因子，这两个因子，应该也有很强的解释力度</b>。</p><p>　　我们横向考察了小市值因子相对其他财务因子或动量因子的收益率标准差，回撤表现，夏普比率，认为这是一个优秀的因子。因为小市值公司容易被较少的资金推动，且从企业成长历程看，它有成长为大市值公司的潜质。</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-af90ceee6de37022b9187c2a96fa09c9_b.jpg" data-caption="" data-size="normal" data-rawwidth="853" data-rawheight="415" class="origin_image zh-lightbox-thumb" width="853" data-original="https://pic2.zhimg.com/v2-af90ceee6de37022b9187c2a96fa09c9_r.jpg"/></noscript><img src="https://pic2.zhimg.com/v2-af90ceee6de37022b9187c2a96fa09c9_b.jpg" data-caption="" data-size="normal" data-rawwidth="853" data-rawheight="415" class="origin_image zh-lightbox-thumb lazy" width="853" data-original="https://pic2.zhimg.com/v2-af90ceee6de37022b9187c2a96fa09c9_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-af90ceee6de37022b9187c2a96fa09c9_b.jpg"/></figure><p>　　如果单独以每次买入市值最小的公司作为调仓规则，即可获得上图效果</p><p>　　所以二因子beta+市值模型的公式是：</p><p>　　Ri=Rf+β0(Rm-Rf) +β1(MarketCapBig - MarketCapSmall)</p><p>　　这里的MarketCapBig - MarketCapSmall采用了经典的三因子构建方式，<b>用市值将个股分为三组，最高组 - 最低组，得到一个每日横截面数值，为因子值</b>。然后用该因子值和beta因子，在个股时间序列上做线性回归。</p><h2><b>Fama-French三因子模型</b></h2><p>　　事实上除了CAPM所说的市场风险外，Fama-French认为市场上还存在还有市值风险，账面市值比风险等，据此建立的模型被称为“Fama-French三因子模型”。</p><p>　　Fama和French在1992年提出PB和市值因子对股票的收益率有十分显著的影响，并且基于这个发现建立了Fama-French三因素模型。</p><p>　　Fama-French三因素模型认为，一个投资组合(包括单个股票)的超额回报率可由它对三个因子的暴露 来解释，这三个因子是：市场资产组合(Rm - Rf) 、市值因子(SMB)、账面市值比因子(HML)。需要再次说明，市值风险、账面市值比这两个因子，都是使用前文所说的最大1/3减去最小1/3，获得一个每日的截面差值来构建的，这个多因子均衡定价模型可以表示为：</p><p class="ztext-empty-paragraph"><br/></p><p>　　E(R_it) - R_ft = βi[E(R_mt) - R_ft] + siSMB_t + hi*HMI_t</p><p>其中：</p><p>R_ft表示时间t的无风险收益率；</p><p>R_mt表示时间t的市场收益率；</p><p>R_it表示资产i在时间t的收益率；</p><p>E(Rmt) - Rft是市场风险溢价；</p><p>SMB_t为时间t的市值(size)因子收益指数(Small comp return minus Big comp return)；</p><p>HMI_t为时间t的账面市值比(book—to—market)因子收益指数(High btm return minus Low btm return)。</p><p>　　βi、si和hi分别是三个因子的系数，回归模型表示如下：</p><p>　　Rit - Rft = αi + βi(Rmt - Rft) + siSMBt + hiHMIt + εit</p><p>　　该模型的提出，对于个股的风险解释有一个新的能力提升，具体能够解释多少我们在之后设计回归模型来详细计算。三因子模型<b>被评选诺贝尔经济学奖委员会肯定为金融学过去25年最重大的成就之一</b>。</p><h2><b>Carhart四因子模型</b></h2><p>　　三个因子解释个股收益率是否足够多？Carhart在1997年提出了动量因子（Momentum）得到四因子模型，通过加入一个鲜为人知的动量因子，有效再一次提升了模型的解释力，而且这个因子还和之前的三个因子相关性较低。</p><p>　　四因素模型可将个股收益表示为在市场因素（MKT）、规模因素（SMB）、价值因素（HML）与动量因素（UMD）共同作用下所达到的一个均衡。模型中新加入的动量因素能够对市场上的“趋势效应＂进行有效解释，它所表示的“动量效应＂的时问间隔可以是较长的一段期间，比如Carhart四因素模型中的一年，也可以是较短的一段期间，比如一个月。</p><p>　　但是这个动量的时间周期非常关键，我们通常都采用过去12个月的动量不包含最近一个月的动量，作为个股的动量值。</p><h2><b>Fama-French五因子模型</b></h2><p>　　在推出了三因子这个行业重磅工具后，Fama和French发现还有盈利水平风险、投资水平风险也能带来个股的超额收益，并在2013年发表了五因子模型。</p><p>　　这多出来的两个因子就是：</p><p><b>　　1、盈利水平风险</b></p><p>　　盈利水平风险是指，盈利能力较高的行业一般会伴随着更高的风险。我们用ROE来衡量盈利水平。记做 E(RMW)E(RMW)，其计算方法和E(SMB)E(SMB)、E(HML)E(HML)类似（也是将股票分成三份，然后计算高/低盈利水平的股票期望收益率之差）。</p><p><b>　　2、投资水平风险</b></p><p>　　投资水平可以用再投资率来衡量，我们认为投资率偏低的公司风险较大，投资者对这些公司有更高的收益率要求，反之亦然。Fama和French在他们五因子模型的文章里面提供了一种计算再投资比例的方法：用总资产年增长率来计算再投资比率。投资水平风险带来的超额收益E(CMA)E(CMA)计算方法和E(SMB)E(SMB)、E(HML)E(HML)、E(RMW)E(RMW)类似。</p><p>　　但是因子多了，解释能力就一定更好吗？在聚宽之前的测试中我们已经看到，五因子如果用残差作为获利方式，其收益是低于三因子的。不过今天我们不考虑收益，我们仅考虑这些相对不同源的因子对于风险（或者说个股收益）的解释能力。</p><h2><b>检验结果与分析</b></h2><p>　　我们采用聚宽量化课堂的三因子模型模板，但是略有改进：</p><p>　　1、先设定一个调仓频率，每T=21天调仓一次。同时在此区间内的个股停牌的都剔除不参与时间序列回归。</p><p>　　2、针对每一个因子，都将因子值分为三层，最大一层减去最小一层，获得当日的一个全市场该因子值。</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-0453b57631ec04be42e6655632c202a9_b.jpg" data-caption="" data-size="normal" data-rawwidth="600" data-rawheight="187" class="origin_image zh-lightbox-thumb" width="600" data-original="https://pic2.zhimg.com/v2-0453b57631ec04be42e6655632c202a9_r.jpg"/></noscript><img src="https://pic2.zhimg.com/v2-0453b57631ec04be42e6655632c202a9_b.jpg" data-caption="" data-size="normal" data-rawwidth="600" data-rawheight="187" class="origin_image zh-lightbox-thumb lazy" width="600" data-original="https://pic2.zhimg.com/v2-0453b57631ec04be42e6655632c202a9_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-0453b57631ec04be42e6655632c202a9_b.jpg"/></figure><p>　　3、然后在调仓日对于过去21天的数据进行回归分析，计算出每个股票在过去的21天里的每一只个股的残差和回归可决系数R-square。</p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-418361122b7699d9cc430046e1d12782_b.jpg" data-caption="" data-size="normal" data-rawwidth="705" data-rawheight="365" class="origin_image zh-lightbox-thumb" width="705" data-original="https://pic3.zhimg.com/v2-418361122b7699d9cc430046e1d12782_r.jpg"/></noscript><img src="https://pic3.zhimg.com/v2-418361122b7699d9cc430046e1d12782_b.jpg" data-caption="" data-size="normal" data-rawwidth="705" data-rawheight="365" class="origin_image zh-lightbox-thumb lazy" width="705" data-original="https://pic3.zhimg.com/v2-418361122b7699d9cc430046e1d12782_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-418361122b7699d9cc430046e1d12782_b.jpg"/></figure><p>　　然后我们在每个截面上，统计一次全市场所有股票R-square均值，作为模型的解释力度表达变量。</p><p>　　然后我们在每个截面上，<b>统计一次全市场所有股票R-square均值，作为模型的解释力度表达变量。</b></p><p>　　统计结果如下：</p><p>　　沪深300股票池：</p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-9f39545957a18699fdf635eba71bc482_b.jpg" data-caption="" data-size="normal" data-rawwidth="952" data-rawheight="385" class="origin_image zh-lightbox-thumb" width="952" data-original="https://pic3.zhimg.com/v2-9f39545957a18699fdf635eba71bc482_r.jpg"/></noscript><img src="https://pic3.zhimg.com/v2-9f39545957a18699fdf635eba71bc482_b.jpg" data-caption="" data-size="normal" data-rawwidth="952" data-rawheight="385" class="origin_image zh-lightbox-thumb lazy" width="952" data-original="https://pic3.zhimg.com/v2-9f39545957a18699fdf635eba71bc482_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-9f39545957a18699fdf635eba71bc482_b.jpg"/></figure><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-9c18e36fc4c253cc53163f63aee2b4e2_b.jpg" data-caption="" data-size="normal" data-rawwidth="574" data-rawheight="309" class="origin_image zh-lightbox-thumb" width="574" data-original="https://pic3.zhimg.com/v2-9c18e36fc4c253cc53163f63aee2b4e2_r.jpg"/></noscript><img src="https://pic3.zhimg.com/v2-9c18e36fc4c253cc53163f63aee2b4e2_b.jpg" data-caption="" data-size="normal" data-rawwidth="574" data-rawheight="309" class="origin_image zh-lightbox-thumb lazy" width="574" data-original="https://pic3.zhimg.com/v2-9c18e36fc4c253cc53163f63aee2b4e2_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-9c18e36fc4c253cc53163f63aee2b4e2_b.jpg"/></figure><p>　　中证全指000985股票池：</p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-58b8a9c40ee9feecb99214440e551ccb_b.jpg" data-caption="" data-size="normal" data-rawwidth="952" data-rawheight="385" class="origin_image zh-lightbox-thumb" width="952" data-original="https://pic4.zhimg.com/v2-58b8a9c40ee9feecb99214440e551ccb_r.jpg"/></noscript><img src="https://pic4.zhimg.com/v2-58b8a9c40ee9feecb99214440e551ccb_b.jpg" data-caption="" data-size="normal" data-rawwidth="952" data-rawheight="385" class="origin_image zh-lightbox-thumb lazy" width="952" data-original="https://pic4.zhimg.com/v2-58b8a9c40ee9feecb99214440e551ccb_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-58b8a9c40ee9feecb99214440e551ccb_b.jpg"/></figure><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-7b3792aa6a032fe20527ecb8e6329738_b.jpg" data-caption="" data-size="normal" data-rawwidth="574" data-rawheight="309" class="origin_image zh-lightbox-thumb" width="574" data-original="https://pic1.zhimg.com/v2-7b3792aa6a032fe20527ecb8e6329738_r.jpg"/></noscript><img src="https://pic1.zhimg.com/v2-7b3792aa6a032fe20527ecb8e6329738_b.jpg" data-caption="" data-size="normal" data-rawwidth="574" data-rawheight="309" class="origin_image zh-lightbox-thumb lazy" width="574" data-original="https://pic1.zhimg.com/v2-7b3792aa6a032fe20527ecb8e6329738_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-7b3792aa6a032fe20527ecb8e6329738_b.jpg"/></figure><p><b>　　我们发现如下特征：</b></p><p>　　首先在不同的股票池，多因子模型解释力度是不同的，但是差异不大，因为沪深300指数和中证全指都包含了行业分布比较广泛的上市公司，市值分布特性也各异，虽然沪深300样本偏少。</p><p>　　其次是不同时段，因子模型的解释能力是不一样的，在市场萧条阶段解释力度偏低，在市场火爆阶段解释能力偏高，如2014年底到2015年的牛市阶段。2017年市场出现了价值投资的短暂火热气氛，<b>但是导致了资金流向少数几只个股，这个现象对于模型在全市场解释风险带来了负面影响</b>，特别是沪深300股票池内，因子模型解释力走入低谷。</p><p>　　同时我们抽取了每年1个横截面，验证了因子间相关性（9个横截面相关性矩阵求均值），<b>如下图，分别是沪深300和中证全指的截面相关性均值</b>。我们可以看到这5个大类收益解释因子之间的相关性的确不高，<b>仅有市值和投资能力（total_assets总资产增长能力）的相关性较高</b>，这一点很容易理解。</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-a4a3ea883a01905040c8cb8fc5cb0c59_b.jpg" data-caption="" data-size="normal" data-rawwidth="368" data-rawheight="360" class="content_image" width="368"/></noscript><img src="https://pic2.zhimg.com/v2-a4a3ea883a01905040c8cb8fc5cb0c59_b.jpg" data-caption="" data-size="normal" data-rawwidth="368" data-rawheight="360" class="content_image lazy" width="368" data-actualsrc="https://pic2.zhimg.com/v2-a4a3ea883a01905040c8cb8fc5cb0c59_b.jpg"/></figure><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-afe8ef2ed7cf1f0434ed80f990fa43f4_b.jpg" data-caption="" data-size="normal" data-rawwidth="389" data-rawheight="360" class="content_image" width="389"/></noscript><img src="https://pic1.zhimg.com/v2-afe8ef2ed7cf1f0434ed80f990fa43f4_b.jpg" data-caption="" data-size="normal" data-rawwidth="389" data-rawheight="360" class="content_image lazy" width="389" data-actualsrc="https://pic1.zhimg.com/v2-afe8ef2ed7cf1f0434ed80f990fa43f4_b.jpg"/></figure><p>　　我们也可喜地看到，无论是最简单的CAPM单因子模型，还是FF五因子模型，都拥有从40%~60%的收益解释能力，可以说市场上大部分风险随着因子的添加，都得到了有效解释，因子模型在中国股票市场得到了验证，<b>如果设置更好的测试规则，以及选择更合适的因子，更多风险都会得到解释</b>。</p><p>点击【<b><a href="https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzI0MjE2MjE2MA%3D%3D%26mid%3D2716578802%26idx%3D1%26sn%3D5751670cbec81e35282b28e3a308a33a%26chksm%3Dcd1f936dfa681a7bc60c8aa1c0038ce15d5f69e8c95221a288cb6f69c166c14be8f537be6fa9%26scene%3D0%26xtrack%3D1%26key%3Ddecf44071a41819976e64bbc4a374db2bde144d34702e5faedf322a8e7a16008964717523dbcd3b2e217738e054955c2adc2dce3c96840680cdb7bdbfea503fa5e055263e4cd4e686c1defadeb89e392%26ascene%3D1%26uin%3DOTA2NzA2Mjkz%26devicetype%3DWindows%2B7%26version%3D62060739%26lang%3Dzh_CN%26pass_ticket%3D%252BBd16Fg3%252FcZZk4JwfffspiYjXTL6%252B2Tcxpie0PSan57HU%252BGBut1EnoxKTY4tR%252FpJ" class=" wrap external" target="_blank" rel="nofollow noreferrer">阅读原文</a></b>】，查看完整研究源码~</p>