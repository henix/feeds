<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>碰到民生银行这样的“乌龙”怎么办？</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/30611727">原文</a></p>
<div class="title-image"><img src="https://pic1.zhimg.com/v2-308037ab0fddc01758e04722c99088c0_r.jpg" alt=""></div><p>昨天晚上民生银行公布的三季报中股东总数为58,946户，同比下降88.5%，小编一度以为民生银行遭遇了史诗级的变故。正在小编准备问问民生银行董秘的时候，一则公告告诉大家“对不起，这是乌龙”。（<b>还好不是我的民生银行存款数......</b>）</p><img src="https://pic3.zhimg.com/v2-11c366a34f2cc4cd3cf670c1767bdec7_r.jpg" data-caption="" data-rawwidth="604" data-rawheight="326"><p>面对这种数据错误，作为吃瓜群众有没有办法应对呢？下面以因子值为例，看看如何降低数据出现异常时的影响。</p><p><br></p><p><b>一、离群值处理</b></p><p><br></p><p>因为过大或过小的数据可能会影响到分析结果，尤其是在做回归的时候，我们需要对那些离群值进行处理。实际上离群值和极值是有区别的，因为极值不代表异常，但实际处理中这两个所用方法差不多，所以这里也不强行区分了。</p><p><br></p><p>处理方法是调整因子值中的离群值至上下限（Winsorzation处理），其中上下限由离群值判断的标准给出，从而减小离群值的影响力。离群值的判断标准有三种，分别为 MAD、 3σ、百分位法。</p><p><br></p><p>下图是2017-10-23日的全市场BP原始数据。</p><img src="https://pic1.zhimg.com/v2-bc725b89671c8e7dd165a4b83d84aca0_r.jpg" data-caption="" data-rawwidth="1622" data-rawheight="647"><p><b>1. MAD法：</b></p><p><br></p><p>MAD又称为绝对值差中位数法（Median Absolute Deviation）。MAD 是一种先需计算所有因子与平均值之间的距离总和来检测离群值的方法。        </p><p><br></p><p>处理的逻辑：第一步，找出所有因子的中位数 Xmedian；第二步，得到每个因子与中位数的绝对偏差值 Xi−Xmedian；第三步，得到绝对偏差值的中位数 MAD；最后，确定参数 n，从而确定合理的范围为 [Xmedian−nMAD,Xmedian+nMAD]，并针对超出合理范围的因子值做如下的调整：</p><img src="https://pic3.zhimg.com/v2-b9967e29d287fee79e298ecd4c093686_r.jpg" data-caption="" data-rawwidth="922" data-rawheight="123"><img src="https://pic1.zhimg.com/v2-4916680182187bf11f2b9c087ea6fa1c_r.jpg" data-caption="" data-rawwidth="1622" data-rawheight="647"><p><b>2. 3σ法</b></p><p><br></p><p>又称为标准差法。标准差本身可以体现因子的离散程度，是基于因子的平均值 Xmean而定的。在离群值处理过程中，可通过用 Xmean±nσ来衡量因子与平均值的距离。</p><p><br></p><p>标准差法处理的逻辑与MAD法类似，首先计算出因子的平均值与标准差，其次确认参数 n（这里选定 n = 3），从而确认因子值的合理范围为[Xmean−nσ,Xmean+nσ]，并对因子值作如下的调整：</p><img src="https://pic4.zhimg.com/v2-cae26c31a466fe688c6e74be92e67a63_r.jpg" data-caption="" data-rawwidth="717" data-rawheight="133"><img src="https://pic1.zhimg.com/v2-f33f46010825bf514d0c87e5accecd6d_r.jpg" data-caption="" data-rawwidth="1622" data-rawheight="647"><p><b>3. 百分位法：</b></p><p><br></p><p>计算的逻辑是将因子值进行升序的排序，对排位百分位高于97.5%或排位百分位低于2.5%的因子值，进行类似于 MAD 、 3σ 的方法进行调整。<br></p><p><br></p><p>对全市场BP原始数据进行百分位法处理后的结果：</p><img src="https://pic2.zhimg.com/v2-7038371cff1d0ddd35bc12d672c73fbc_r.jpg" data-caption="" data-rawwidth="1622" data-rawheight="647"><p>通过这几个图表比对，我们可以发现百分位法的结果和MAD很相似。</p><p><br></p><p><b>二、标准化</b></p><p><br></p><p>标准化（normalization）是将数据按比例缩放，使其能落入一个小的特定区间，例如将数据归一化后映射到[0,1]区间。标准化处理后的数据从有量纲转化为无量纲，从而使得数据更加集中，或者使得不同的指标能够进行比较和回归。</p><p><br></p><p>由此可见，标准化应该用于多个不同量级指标之间需要互相比较的时候。讲到这里，我们应该区分一下标准化和中性化。中性化的目的在于消除因子中的偏差和不需要的影响，详细的内容将会在下一个帖子总结。</p><p><br></p><p>对因子进行标准化处理的方法主要有以下两种：</p><p><br></p><p><b>1、对原始因子值进行标准化；</b> </p><p><br></p><p>方法一可以保留更多的因子分布信息，但是需要去掉极端值，否则会影响到回归结果。回归的方法一般使用z-score，将因子值的均值调整为0，标准差调整为1。 标准化处理基于原始数据的均值和标准差，处理的逻辑是因子值减去均值后，再除以标准差。</p><p><br></p><p>对已经过3σ法去极值后的结果进行标准化：</p><img src="https://pic1.zhimg.com/v2-0efe570acaf112cd81b462bf6053d0b3_r.jpg" data-caption="" data-rawwidth="1622" data-rawheight="647"><p><b>2、用因子的排序值进行标准化。   </b> </p><p><br></p><p>方法二只关注原始序列的相对排序关系，所以对原始变量的分布不做要求，属于非参数统计方法，可以适用于更多类型的数据。首先将原始数据的排序值作为参数，再将之带入方法一的标准化计算中。</p><p><br></p><p>由于转为排序值之后的分布图像意义不大，就不在此贴出。</p><p><br></p><p><a href="https://www.ricequant.com/community/topic/4271?utm_source=zhihu">一键跳转克隆代码！</a></p>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
