<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>基于风险中性的深度学习选股策略</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/37825515">原文</a></p>
<div class="title-image"><img src="https://pic4.zhimg.com/v2-25bea7616bcbaf07dc5df54a18c8a343_r.jpg" alt=""></div><p>今天我们为大家带来最新的研报内容，来自<b>广发证券金工团队</b>的<b>《风险中性的深度学习选股策略》</b>。下面让我们来一起学习吧！</p><a href="https://mp.weixin.qq.com/s?__biz=MzAxNTc0Mjg0Mg==&amp;mid=2653288319&amp;idx=1&amp;sn=e2be2ffda6b8c63f46a966790e8147ad&amp;chksm=802e356ab759bc7c9a607ffb2145a020b454b2a97dac956684d484d5ed8bba5b09770d049dab#rd" data-draft-node="block" data-draft-type="link-card">https://mp.weixin.qq.com/s?__biz=MzAxNTc0Mjg0Mg==&amp;mid=2653288319&amp;idx=1&amp;sn=e2be2ffda6b8c63f46a966790e8147ad&amp;chksm=802e356ab759bc7c9a607ffb2145a020b454b2a97dac956684d484d5ed8bba5b09770d049dab#rd</a><p><br></p><h2><b>风险中性的机器学习选股模型</b></h2><p>模型训练<b>：</b>通过训练样本，确定模型结构，优化模型参数。</p><p>预测输出 Y 的维度：3。</p><p>输入特征 X 的维度：156(128个因子+28个行业) 通过网格搜索获取最优的模型结构。</p><p>选取模型结构为: 156(输入层)-512-200-200-200-128-3(输出层) 即一共包含5个隐层。</p><p>隐层节点数依次为：512(隐层1)、 200(隐层2)、 200(隐层3)、 200(隐层4)、 128(隐层5)。 </p><img src="https://pic2.zhimg.com/v2-844e209fc8469fea59e68ce7b9590d59_r.jpg" data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="700" data-watermark="watermark" data-original-src="v2-844e209fc8469fea59e68ce7b9590d59" data-watermark-src="v2-a2d4c29518d310d1be0ccaf0d2a8b697" data-private-watermark-src=""><img src="https://pic1.zhimg.com/v2-fb4d528d322fb103a3a4254ab797c9ab_r.jpg" data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="581" data-watermark="watermark" data-original-src="v2-fb4d528d322fb103a3a4254ab797c9ab" data-watermark-src="v2-d192d2b784554bfbb8cb55b95059127f" data-private-watermark-src=""><p><b>提高深层神经网络选股性能的主要方法：</b></p><blockquote>1、采用relu等激活函数。 <br>2、将优化目标函数MSE改成交叉熵。<br>3、Batch normalization技术。<br>4、Dropout技术。</blockquote><p><b>采用Keras作为机器学习平台：</b></p><blockquote>1、可以选择Tensorflow、CNTK、Theano(目前已经停止更新)作为后端。<br>2、目前已经支持多GPU。<br>3、显卡选择：Nvidia GTX Titan XP, GTX 1080Ti, GTX Titan, GTX 1080, GTX1070, GTX 1060。</blockquote><p>机器学习多因子选股模型:从股票特征中提取信息，对股票未来的收益进行预 测，选出能够产生超额收益的股票组合。</p><p><b>多因子选股模型：</b></p><p>挑选出未来一期能够产，生超额收益的股票。</p><p><b>↓↓↓</b></p><p><b>风险中性的多因子选股模型：</b></p><p>挑选出未来一期，<b>在剥离风险因子影响后</b>，能够产生的超额收益的股票。</p><p>如何实现上述目标? 针对具体的应用场景，构建适当的机器学习预测模型。</p><img src="https://pic4.zhimg.com/v2-dafe277c46455f5f9175889158bc2a9f_r.jpg" data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="97" data-watermark="" data-original-src="" data-watermark-src="" data-private-watermark-src=""><p><b>普通的样本标注方法</b></p><img src="https://pic3.zhimg.com/v2-79217feb78e801e41d8f4a1a0e4273f4_r.jpg" data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="430" data-watermark="watermark" data-original-src="v2-79217feb78e801e41d8f4a1a0e4273f4" data-watermark-src="v2-1a876a2053204f5dd558b4d6c5a92c65" data-private-watermark-src=""><p>训练时，根据未来一期的股票涨跌幅来给样本贴“标签”：上涨、下跌、平盘同一时刻，按照涨跌幅进行排序，确定样本的输出标签。</p><p><b>行业中性的样本标注：寻找不同行业内能够跑出超额收益的股票</b></p><img src="https://pic2.zhimg.com/v2-33303614ca7045b3ad4ee643ed3ef881_r.jpg" data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="383" data-watermark="watermark" data-original-src="v2-33303614ca7045b3ad4ee643ed3ef881" data-watermark-src="v2-d507766e1e1ae548bd7b7fce9a87452a" data-private-watermark-src=""><p>训练时，根据未来一期的股票涨跌幅来给样本贴“标签”：上涨、下跌、平盘 同一时刻，按照涨跌幅进行排序，确定样本的输出标签。</p><p><b>市值中性的样本标注：寻找不同市值区间内能够跑出超额收益的股票</b></p><img src="https://pic1.zhimg.com/v2-ced80a85c56dddbf69b15f2ba9db19b4_r.jpg" data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="382" data-watermark="watermark" data-original-src="v2-ced80a85c56dddbf69b15f2ba9db19b4" data-watermark-src="v2-061744656233882e81a737cc4d8740df" data-private-watermark-src=""><p>训练时，根据未来一期的股票涨跌幅来给样本贴“标签”：上涨、下跌、平盘 同一时刻，按照涨跌幅进行排序，确定样本的输出标签。</p><p><b>风险中性的样本标注：更一般的方法</b></p><p>未来一期股票收益率对风险因子做线性回归，获得残差，按残差进行样本标注</p><img src="https://pic1.zhimg.com/v2-6f382c4d95cc5712c5f73cf74d2f11dc_r.jpg" data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="107" data-watermark="" data-original-src="" data-watermark-src="" data-private-watermark-src=""><img src="https://pic2.zhimg.com/v2-102ff051c45683ffe9b075900c042048_r.jpg" data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="429" data-watermark="watermark" data-original-src="v2-102ff051c45683ffe9b075900c042048" data-watermark-src="v2-f10d6365d716849b6f0d4db5e6e32bd7" data-private-watermark-src=""><p><br></p><h2><b>策略与实证分析</b></h2><p><b>策略流程</b></p><img src="https://pic4.zhimg.com/v2-2add35ff66c958ebb9cc571a55021f56_r.jpg" data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="543" data-watermark="watermark" data-original-src="v2-2add35ff66c958ebb9cc571a55021f56" data-watermark-src="v2-a037ceb507a436f49c8ad0cd379fac17" data-private-watermark-src=""><p><b>数据预处理</b></p><img src="https://pic4.zhimg.com/v2-27360a75951fe3f0d014a8d3f32c9630_r.jpg" data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="182" data-watermark="watermark" data-original-src="v2-27360a75951fe3f0d014a8d3f32c9630" data-watermark-src="v2-5186573c58d4da81c1c1e04750ee369f" data-private-watermark-src=""><p><b>因子标准化：</b></p><blockquote>1、异常值、缺失值处理<br>2、极值压边界处理<br>3、沿时间方向的因子标准化<br>4、沿截面的因子标准化<br>5、按照机器学习模型来调整因子分布</blockquote><p><b>风险中性的深度学习选股模型的IC</b></p><img src="https://pic3.zhimg.com/v2-b0ceebef0a410d4819da483be34c3805_r.jpg" data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="661" data-watermark="watermark" data-original-src="v2-b0ceebef0a410d4819da483be34c3805" data-watermark-src="v2-28a2a5c9982c8309d828364b1fd3885e" data-private-watermark-src=""><p>IC的平均值为0.082，标准差为0.108。</p><p><b>深度学习因子与流通市值的相关性：IC序列的相关性</b></p><img src="https://pic3.zhimg.com/v2-ca8af024801a7d0bee71da784bc89f05_r.jpg" data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="426" data-watermark="watermark" data-original-src="v2-ca8af024801a7d0bee71da784bc89f05" data-watermark-src="v2-a091fc9ca1b81b7e6eecb10c3a019cdf" data-private-watermark-src=""><p>经过行业和市值中性化之后，深度学习因子更少受到市值因子的影响。</p><p><b>深度学习因子与流通市值的相关性：截面相关性</b></p><img src="https://pic1.zhimg.com/v2-915f5fc005e3409da3b2fd7f06794bd8_r.jpg" data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="392" data-watermark="watermark" data-original-src="v2-915f5fc005e3409da3b2fd7f06794bd8" data-watermark-src="v2-53c89c7e8d6e93d24f8d6d2dbf22a5b1" data-private-watermark-src=""><p>经过行业和市值中性化之后，深度学习因子更少受到流通市值因子的影响。</p><p><b>回测参数设置 </b></p><ul><li><b>调仓周期：</b>10个交易日 <br></li><li><b>股票池：</b>中证500成份股，剔除ST股票，剔除交易日停牌和涨停、跌停的股票 <br></li><li><b>超配组合：</b>调仓时分10档，等权买入深度学习模型打分最高的一档 <br></li><li><b>对冲基准：</b>中证500指数 <br></li><li><b>原始因子数据：</b>估值因子、规模因子、反转因子、流动性因子、波动性因子、技术 指标，共计128个因子，以及28个行业0-1变量 <br></li><li><b>风险因子：</b>行业、流通市值 <br></li><li><b>深度学习模型训练：</b>每半年滚动更新模型，采用最近4年的样本作为训练集 <br></li><li><b>策略回测：</b>2011年1月-2018年4月30日 <br></li><li><b>交易成本：</b>千分之三<br></li></ul><p><b>普通的深度学习选股策略</b></p><p>2011年以来，年化收益率19.71%，最大回撤 -5.35%，胜率为 69.5%，信息比2.47。</p><img src="https://pic2.zhimg.com/v2-cfb2849ab3b4d2028626635596b0490b_r.jpg" data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="546" data-watermark="watermark" data-original-src="v2-cfb2849ab3b4d2028626635596b0490b" data-watermark-src="v2-0ba39ca594002b4258b35ceb8d22c10d" data-private-watermark-src=""><img src="https://pic4.zhimg.com/v2-a9f59e7003260b20ccaa5bd7fb649805_r.jpg" data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="372" data-watermark="watermark" data-original-src="v2-a9f59e7003260b20ccaa5bd7fb649805" data-watermark-src="v2-edba9a96273e6709ecd5999595668d0d" data-private-watermark-src=""><p><b>风险中性的深度学习选股策略</b><br>2011年以来，年化收益率21.95%，最大回撤 -5.03%，胜率为 74.6%，信息比2.92。</p><img src="https://pic2.zhimg.com/v2-057030572eb58627d582ab6bc7f8e745_r.jpg" data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="546" data-watermark="watermark" data-original-src="v2-057030572eb58627d582ab6bc7f8e745" data-watermark-src="v2-71dd1677d9543f1e41321d21cd14c530" data-private-watermark-src=""><img src="https://pic4.zhimg.com/v2-f057b1f1d2b9459f71b84371c2f4f978_r.jpg" data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="369" data-watermark="watermark" data-original-src="v2-f057b1f1d2b9459f71b84371c2f4f978" data-watermark-src="v2-86e20188d631bdedd1338b3574640d72" data-private-watermark-src=""><p><b>风险中性深度学习选股策略</b><br>年化收益率21.95%，最大回撤 -5.03%，胜率为 74.6%，信息比2.92</p><p><b>普通深度学习选股策略</b><br>年化收益率19.71%，最大回撤 -5.35%，胜率为 69.5%，信息比2.47</p><img src="https://pic4.zhimg.com/v2-a088863104d695a6d936445f2ae72378_r.jpg" data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="573" data-watermark="watermark" data-original-src="v2-a088863104d695a6d936445f2ae72378" data-watermark-src="v2-9c62ea2a524510d2b7ff08aa43e3904f" data-private-watermark-src=""><p><b>机器学习策略表现的同质性：不同策略的表现有一定的相关性</b></p><p>用普通深度学习模型的IC对风险中性深度学习模型的IC进行回归，R方为0.84。 说明两种策略的表现有较强的相关性。 </p><img src="https://pic1.zhimg.com/v2-17155dc249303335f7e87171eef6cdcb_r.jpg" data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="772" data-watermark="watermark" data-original-src="v2-17155dc249303335f7e87171eef6cdcb" data-watermark-src="v2-439338d3c18ee9a1da613cf8b207135d" data-private-watermark-src=""><p><b>机器学习策略每期组合的同质性：选取的组合有较大的差异</b></p><p>当组合规模N为50时，两种深度学习选股策略平均每期选到的股票有41.9%重合。（参考：两次独立的随机选股中，平均有10%重合。）</p><p>当组合规模N为100时，两种深度学习选股策略平均每期选到的股票有53.3%重合。（参考：两次独立的随机选股中，平均有20%重合。）</p><img src="https://pic3.zhimg.com/v2-d40fe567d947ceb12e3361e837a007c8_r.jpg" data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="559" data-watermark="watermark" data-original-src="v2-d40fe567d947ceb12e3361e837a007c8" data-watermark-src="v2-a03866c3e52bc4bb9fca7896f0ffea84" data-private-watermark-src=""><h2><b>总结</b></h2><ul><li>将风险因子中性化处理后，可以构建新的深度学习选股模型，该模型受风险 因子的影响较小。</li><li>2011年以来，中证500内选股对冲策略年化收益率21.95%，最大回撤 - 5.03%，胜率为 74.6%，信息比2.92。</li><li>即使是采用同样的特征和模型结构，风险因子中性化之后，训练的策略也会 有较大的差别，可以通过此方法丰富深度学习选股策略的多样性。</li></ul><blockquote>本文旨在对所研究问题的主要关注点进行分析，因此对市场及相 关交易做了一些合理假设，但这样会导致建立的模型以及基于模型所得 出的结论并不能完全准确地刻画现实环境。而且由于分析时采用的相关 数据都是过去的时间序列，因此可能会与未来真实的情况出现偏差。本 文内容并不是适合所有的投资者，客户在制定投资策略时，必须结合自 身的环境和投资理念。</blockquote><p><br></p><p><i><b>知识在于分享</b></i></p><p><i><b>在量化投资的道路上</b></i></p><p><i><b>你不是一个人在战斗</b></i></p>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
