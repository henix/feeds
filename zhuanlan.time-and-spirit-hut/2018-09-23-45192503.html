<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>「Rust每日新闻」本周精选 • 第十二期</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/45192503">原文</a></p>
<div class="title-image"><img src="https://pic4.zhimg.com/v2-10c6913d0bc44f08fed6d57e31af7e30_r.jpg" alt=""></div><blockquote>前言：<br>从2018年开始，我每天会花1个小时关注Rust社区动态，并且在<a href="https://link.zhihu.com/?target=http%3A//rust.cc">http://rust.cc</a>论坛、<a href="https://link.zhihu.com/?target=https%3A//t.me/rust_daily_news">tg channel</a>、<a href="https://link.zhihu.com/?target=https%3A//steemit.com/%40blackanger">Steemit</a>、GitHub都开通了Rust每日新闻，分享我每天的见闻，偶尔也夹杂了一些个人的观点。半年过去了，Rust每日新闻已经成为了Rust社区群大家每天必看的内容。今天突然想到，在这个知乎专栏里，每周精选几篇Rust社区中的动态，和大家分享。分享的内容就不按时间排序了。<br><i>2018-09-23</i></blockquote><h2><b>官方新闻</b></h2><p><b>同志们！Rust 2018 RC1 来了</b></p><blockquote>rustup install beta<br>rustc +beta --version<br>rustc 1.30.0-beta.2 (7a0062e46 2018-09-19)</blockquote><p><a href="https://internals.rust-lang.org/t/rust-2018-rc1-is-available/8435">原文</a></p><p><b>str::repeat曝安全漏洞</b></p><p>官方目前正在申请CVE，目前官方已经修复此漏洞，将在9.25发布Rust 1.29.1中稳定此修复。</p><p>标准库中的<code class="inline">str :: repeat</code>函数允许重复字符串固定次数，返回最终的字符串。最终字符串的容量通过相乘来计算<br>字符串的长度，这个计算可能会溢出。</p><p><code class="inline">str :: repeat</code>的其余实现包含不安全的代码，它依赖于具有计算容量的预分配Vec。在整数溢出时，预分配容量将小于实际需要的容量，然后在分配的缓冲区之外写入，导致缓冲区溢出。</p><p>这个漏洞和VecDeque那个类似。</p><p>受影响的版本</p><p>虽然<code class="inline">str :: repeat</code>函数自1.16.0以来一直存在于Rust中，但是这个<br>漏洞被引入标准库中是在2018年5月10日发布的1.26.0稳定版中。</p><p><a href="https://blog.rust-lang.org/2018/09/21/Security-advisory-for-std.html">原文</a></p><p>事后诸葛亮：</p><p>查看了一下修复的代码，问题主要是在 slice::repeat方法中。</p><p>修复代码就简单了，加检查就好，整数溢出即panic</p><code lang="rust">let mut buf = Vec::with_capacity(self.len().checked_mul(n).expect("capacity overflow"));</code><p><a href="https://github.com/rust-lang/rust/blob/master/src/liballoc/slice.rs#L434">Rust修复源码位置</a></p><p><b>Manning直播： Rust in Motion</b></p><p><a href="https://www.manning.com/livevideo/rust-in-motion">原文</a></p><hr><h2><b>社区新闻</b></h2><p><b>【RustConf 2018闭幕演讲文稿】使用Rust进行游戏开发的正确姿势</b></p><p>该文来自于RustConf 2018闭幕演讲文稿，但并非是对文章的全文翻译，只是我在阅读过程中的梳理和总结。</p><p><a href="https://zhuanlan.zhihu.com/p/44657202">原文</a></p><p><b>Niko工作时间：使用GDB调试Rust代码</b></p><p><a href="http://smallcultfollowing.com/babysteps/blog/2018/09/21/office-hours-0-debugging-with-gdb/">原文</a></p><p><b>Rayon的力量</b></p><p>作者在工作中使用sklearn（一个Python第三方提供的非常强力的机器学习库）的内置工具进行余弦相似度查询，并行性不足，并且会产生很多OOM（内存不足）错误。他们还使用了Gensim和一些其他工具，往往会使用大量内存。</p><p>最终他厌倦了这一切，拿起了Rust，装备了Serde，序列化了查询所用的JSON矩阵，架起了Rayon，最终得到了一个成功的并行故事。 480G的内存只用了不到3G。</p><p><a href="https://www.reddit.com/r/rust/comments/9hwqt9/powered_by_rayon/">原文</a></p><img src="https://pic4.zhimg.com/v2-5bc56effb8bfdb7d2eb60c4adc0921fe_r.jpg" data-caption="" data-size="normal" data-rawwidth="2400" data-rawheight="820" data-watermark="watermark" data-original-src="v2-5bc56effb8bfdb7d2eb60c4adc0921fe" data-watermark-src="v2-aea3042b73bd2a0cb710b3633f0b9a97" data-private-watermark-src=""><p><b>Rust全文搜索引擎Tantivy 0.7发布</b></p><p>新版本改为使用failure crate进行错误处理</p><p><a href="https://github.com/tantivy-search/tantivy">原文</a></p><p><b>Rust实现的Juniper GraphQL server库发布 0.10</b></p><p>增加了对Warp和Hyper集成支持</p><ul><li><a href="https://github.com/graphql-rust/juniper/">juniper</a></li><li><a href="https://graphql-rust.github.io/servers/warp.html">warp支持</a></li></ul><p><b>Rust开发的城市模拟游戏</b></p><p>作者经过5年的努力，现在基本成形。基于Rust、React、Wasm、WebGL等技术</p><p><a href="https://github.com/citybound/citybound">源码 </a></p><p><a href="http://aeplay.co/citybound-devblog/introducing-live-builds">相关博文</a></p><p><b>linkerd 2.0 发布</b></p><p>可以在Kubernetes 1.9+ 集群测试 linkerd 2.0</p><p>Linkerd 2.0 数据板块 由Rust 实现，P99延迟小于 1ms，控制板块由Go实现</p><p><a href="https://blog.linkerd.io/2018/09/18/announcing-linkerd-2-0/">原文</a></p><p><b>从Bash到Rust</b></p><p>在过去的一年里，作者自己编写bash脚本来维护一个长期运行的服务，基本一切都挺合适，但是唯一的困难是管理进程id，查找旧的pid，并kill它。</p><p>比如当前有如下进程：</p><code lang="text">PID  ARGS
1111 /bin/bash
2222 wiredforge
3333 pizza_freak
444  chat_bot
6666 robertmasen.pizza</code><p>为此作者使用了一个很复杂的命令</p><code lang="text">ps -axo pid,args | egrep "[w]iredforge" | head -1 | sed -e 's/^[ \t]*// ' | cut -d ' ' -f 1</code><p>然后得到 <code class="inline">2222 wiredforge</code>里的<code class="inline">2222</code></p><p>这命令通常可以工作，但是要重新部署脚本的话，则很难记得住。所以作者想要用Rust实现一个小程序来帮助它完成这些工作。</p><p>本文就是记录了作者实现这个小工具的过程。该工具还跨平台(linux/ mac)。</p><p><a href="https://gist.github.com/FreeMasen/909f2ed04cab2bd960ea68714e9199b6">完整代码</a></p><p><a href="https://wiredforge.com/blog/misc/getpid/index.html">原文 </a></p><p><b>计算机图形相关的crate推荐列表</b></p><p><a href="https://jonathansteyfkens.com/rust/graphics/compute/2018/09/15/my-recommended-cg-crates.html">原文</a></p><p><b>C++ Lifetime profile v1.0 发布</b></p><p>用于检测C++代码中 悬空指针/迭代器/ string_views / spans /等常见情况。</p><p>估计是跟Rust学的</p><p><a href="https://herbsutter.com/2018/09/20/lifetime-profile-v1-0-posted/">原文</a></p><p><b>LLVM 7.0发布了</b></p><p><a href="http://releases.llvm.org/7.0.0/docs/ReleaseNotes.html">原文</a></p><hr><h2><b>博文与库</b></h2><p><b>在FFI中进行不安全的冒险</b></p><p>可以算作一个FFI和Unsafe的教程</p><p><a href="https://travisf.net/capstone-rs-unsafety-adventure">原文</a></p><p><b>系列文章 ： 探索Rust生命周期</b></p><p><a href="https://exphp.github.io/2018/09/16/lockout-part-1.html">原文</a></p><p><b>Rust如何与C#集成</b></p><p>这是来自于Flare 服务团队（已经在每日新闻里出镜多次的存储引擎）的文章，介绍了他们在生产级将C# 和Rust集成的宝贵经验。</p><p>本文很长，图文并茂，需耐心阅读。有时间我会翻译一下。</p><p><a href="https://blog.getseq.net/rust-at-datalust-how-we-integrate-rust-with-csharp/">原文</a></p><p><b>postgres 和 r2d2_postgres使用TLS建立连接池</b></p><p><a href="https://matthewkmayer.github.io/blag/public/post/postgres-tls/">原文</a></p><p><b>整数和指针之间有什么区别？</b></p><p>在汇编语言级别，不需要担心混淆整数和指针。对于高级语言来说，高程度的抽象也会将指针和整数完全隔离，不容易混淆。但是对于C/ C++/ Rust这样的语言，需要注意整数和指针的区别。</p><p>该文章是一篇论文的预告文，具体的区别估计还在论文中有详细描述。</p><p><a href="https://blog.regehr.org/archives/1621">原文</a></p><p><a href="http://www.cs.utah.edu/~regehr/oopsla18.pdf">论文 </a></p><p><b>一个无锁Map</b></p><p>使用有序的Bucket构造的树形多级Hash Table来实现无锁Map</p><p><a href="https://docs.rs/lockfree/0.2.0/lockfree/map/struct.Map.html">DOC</a></p><p><a href="https://www.reddit.com/r/rust/comments/9hbl5s/a_lockfree_map/">原文</a></p><p><b>尝试解决孤儿问题</b></p><p>该文作者尝试挑战孤儿规则</p><p>非常hack的技术：features gate和条件编译配合突破孤儿规则</p><p><a href="https://phaazon.net/blog/orphans-problem">原文</a></p><p><b>一次项目编程语言选择之旅</b></p><p>作者要为新项目选择语言，考量了诸多语言的特点，最终选了Rust。可以看看他的思考过程。</p><p><a href="https://packnback.github.io/blog/programming_languages/">原文</a></p><p><b>爱上Rust</b></p><p>作者记录了他和Rust的长篇「爱情」故事。长达十年的追逐，从不屑到爱，祝愿这份「爱情」天长地久。</p><p>[原文]<a href="http://dtrace.org/blogs/bmc/2018/09/18/falling-in-love-with-rust/">http://dtrace.org/blogs/bmc/2018/09/18/falling-in-love-with-rust/</a>)</p><p><b>新库 cargo-stabilize</b></p><p>可以帮助开发者将Cargo.toml中所有使用通配符标注的crate替换为最新版，包含依赖项</p><p><a href="https://crates.io/crates/cargo-stabilize">cargo-stabilize</a></p><p><b>一个实验性的Rust实现的shell</b></p><p><a href="https://github.com/psinghal20/rush">rush</a></p><p><b>GitHub趋势榜新上榜项目</b></p><ul><li><a href="https://github.com/BurntSushi/rust-memchr">rust-memchr</a>，libc memchr（在某一内存范围中查找一特定字符）的Rust安全接口</li><li><a href="https://github.com/sigp/lighthouse">lighthouse</a>， 轻量级以太坊2.0客户端</li><li><a href="https://github.com/orlp/slotmap">slotmap</a>，在Rust 2018 Conf闭幕演讲中提过的slotmap，是分代索引模式的践行库</li><li><a href="https://github.com/antoyo/relm">relm</a>，之前介绍过，基于GTK+，受Elm语言启发的GUI库</li></ul><p></p><p></p><p></p><p></p>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
