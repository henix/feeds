<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>一种对Vol，Skew，Smile建仓的参数化方法</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/44590087">原文</a></p>
<div class="title-image"><img src="https://pic1.zhimg.com/v2-582a24682bccd7ddf4d0bdd6325b96c6_r.jpg" alt=""></div><p>本文的动机是向认真回答一下</p><a href="https://www.zhihu.com/question/294457328/answer/491159371" data-draft-node="block" data-draft-type="link-card" class="internal">期权做多波动率，跨式和宽跨式，哪种更合适？</a><p><b>声明：本文和”量化交易“，”预测“， ”策略”等笔者厌恶的问题没有任何关系，想入行的，觉得本文内容是虚假理论的读者们酌情右上角。</b></p><p><br></p><p>当投资者对波动率的观点与市场观点不同时应该如何选用什么组合？</p><p>一般来说，不考虑非常特殊的敞口，观点一般有三种（以多方为例）：</p><p>1.认为Vol的平均水平被市场低估</p><p>2.认为Vol和underlying的相关程度被市场低估</p><p>3.认为VolofVol被市场低估（一般会导致等距OTMVol的平均水平和ATM不一）</p><p><br></p><p>1对应的是 ATMstraddle，这个ATM可以是单纯的ATM，也可以是远期ATM，也可以是Delta-NeutralATM ，也称一般意义的Vol trade</p><p>2对应的是Risk Reversal ，也称Skew trade</p><p>3对应的是买入strangle 卖出straddle， 也称 Smile trade(或者butterfly）</p><p><br></p><p>完了么？如果是一般意义上的“理论”那确实完了。那么头寸应该是多少呢？ 接下来一般意义上的实践派会根据自己的经验布置头寸了。 但是如果想从参数化的方法建模头寸呢？</p><p><b>对不起，接下来的东西看起来就更像一般意义上“虚假的理论”了 ：</b></p><hr><p><b>一些定义： </b></p><p>不失一般性的，我们在外汇underlying， BS框架下进行叙述。 参考talk的作者Peter Carr便是在如下环境下讨论。选取BS作为框架比较一般性，选取外汇underlying是因为不少外汇期权的报价中是含RR和STR的。</p><p>如果读者觉得BS框架过于虚假可以自行替换别的框架，但是请保留建模目标和过程——我们的目的就是对三种头寸进行参数化。</p><p><br></p><p>定义 <img src="https://www.zhihu.com/equation?tex=I_t%28K%29+" alt="I_t(K) " eeimg="1"> 为隐含波动率， S为即期外汇</p><p>因为外汇具有本国对外国或者外国对本国的特殊性，我们定义S所在等价鞅测度为Q_ , 1/S所在等价鞅测度为Q+。 然后我们需要对两个测度进行“配平”来保证来保证一价定理。过程可以参考：</p><a href="https://zhuanlan.zhihu.com/p/30542844" data-draft-node="block" data-draft-type="link-card" data-image="https://pic3.zhimg.com/v2-b5ecf8eaaba4995357bb3f78a80ec73e_ipico.jpg" data-image-width="1024" data-image-height="1024" class="internal">黑猫Q形态：Quanto与Composite 条款</a><p><br></p><p>在取得一致的等价鞅测度Q^b后，我们做如下假设或者规定。</p><p>1.S_t 服从 <img src="https://www.zhihu.com/equation?tex=dS_t+%3D+%5Csigma_tS_tdW_t" alt="dS_t = \sigma_tS_tdW_t" eeimg="1"> (如果觉得虚假可以自行把S切换为F）</p><p><br></p><p>2.定义对数在值度： <img src="https://www.zhihu.com/equation?tex=l_%5Cpm%28K%2FS%2C%5Csigma+%5Csqrt%5Ctau%29++%5Cequiv+++ln%28K%2FS%29+-+E%5EQ_%7B%5Cpm%7D%5Bln%28S_T%2FS_t%29%7CS_t+%3DS%5D+%3D+ln%28K%2FS%29+%5Cmp+%5Csigma%5E2+%5Ctau%2F2" alt="l_\pm(K/S,\sigma \sqrt\tau)  \equiv   ln(K/S) - E^Q_{\pm}[ln(S_T/S_t)|S_t =S] = ln(K/S) \mp \sigma^2 \tau/2" eeimg="1"> </p><p>其中第二个等式只在BS假设下成立，觉得的BS虚假的读者可以自行在喜欢的假设下计算期望部分</p><p><br></p><p>3.定义相对Gamma： <img src="https://www.zhihu.com/equation?tex=R%5CGamma+%3D+S_t%5E2%5Cfrac%7B%5Cpartial%5E2P%28S%2C%5Csigma%2C%5Ctau%2CK%29%7D%7B%5Cpartial+S%5E2%7D" alt="R\Gamma = S_t^2\frac{\partial^2P(S,\sigma,\tau,K)}{\partial S^2}" eeimg="1"> </p><p>则有对应的相对Vega，相对Vanna，相对Volga，Theta（正常的）表达形式：</p><p><img src="https://www.zhihu.com/equation?tex=R%5CGamma+%5Csigma%5E2+%5Ctau++++%2C%7ER%5CGamma+l_-+%2C%7ER%5CGamma+l_-+l_%2B+%2C%7E-R%5CGamma%5Csigma%5E2%2F2++%E2%80%94%E2%80%94%E2%80%94%E2%80%94%281%29++" alt="R\Gamma \sigma^2 \tau    ,~R\Gamma l_- ,~R\Gamma l_- l_+ ,~-R\Gamma\sigma^2/2  ————(1)  " eeimg="1"> </p><p>这一步的目的是作为乘数消除S本身对Greeks的影响。 这些关系只在BS假设下成立，觉得的BS虚假的读者可以自行在喜欢的假设计算</p><p><br></p><p>4. 隐含波动率I_t服从 <img src="https://www.zhihu.com/equation?tex=dI_t%28K%29+%3D+%5Comega_tI_t%28K%29dZ_t" alt="dI_t(K) = \omega_tI_t(K)dZ_t" eeimg="1"> ， <img src="https://www.zhihu.com/equation?tex=d%3CW%2CZ%3E_t+%3D+%5Crho_tdt" alt="d<W,Z>_t = \rho_tdt" eeimg="1"> , 并定义 <img src="https://www.zhihu.com/equation?tex=%5Cgamma_t+%5Cequiv+%5Csigma_t%5Crho_t%5Comega_t" alt="\gamma_t \equiv \sigma_t\rho_t\omega_t" eeimg="1"> </p><p>这一步是为了简化头寸的计算使其不带有一般意义上SV里的参数。 一般情况下， SV框架不会对IV进行建模，所以在SV框架下，本文所介绍的参数化方法会发生巨大变化，有兴趣的读者可以自行研究（说不定能发文）。</p><p><br></p><p>5.定义K_atm 或者K^a 为能解出方程 <img src="https://www.zhihu.com/equation?tex=l_-%28K%5Ea_t%2FSt+%2C++I_%7Batm%7D%5Csqrt%7BT-t%7D%29+%3D0" alt="l_-(K^a_t/St ,  I_{atm}\sqrt{T-t}) =0" eeimg="1">  的K</p><p>这一步是为了确定一个model free的ATM strike定义。 </p><p>同时定义 <img src="https://www.zhihu.com/equation?tex=I_%7Bat%7D+%5Cequiv+I_t%28K%5Ea_t%29" alt="I_{at} \equiv I_t(K^a_t)" eeimg="1"> </p><p><br></p><p>6.假设波动曲面已知，则：</p><p><img src="https://www.zhihu.com/equation?tex=P_t%28K%5Ep_t%29+%3D+P%5Eb%28S_t%2C+I_%7Bpt%7D%2C+T-t+%3B+K_t%5Ep%29%5C%5C+C_t%28K%5Ec_t%29+%3D+C%5Eb%28S_t%2C+I_%7Bct%7D%2C+T-t+%3B+K_t%5Ec%29+" alt="P_t(K^p_t) = P^b(S_t, I_{pt}, T-t ; K_t^p)\\ C_t(K^c_t) = C^b(S_t, I_{ct}, T-t ; K_t^c) " eeimg="1"> </p><p>其中b表示价格是在上面找到的一致测度下，此时我们可以获得瞬时损益（以put为例）：</p><p><img src="https://www.zhihu.com/equation?tex=gP_t%28K%5Ep_t%29+%5Cequiv+%5BdP%28S_t%2C+I_t%28K%29%2CT-t%2CK%7C_%7BK+%3D+K_t%5Ep%7D%5D" alt="gP_t(K^p_t) \equiv [dP(S_t, I_t(K),T-t,K|_{K = K_t^p}]" eeimg="1"> </p><p><br></p><p>7.定义A 为 ATM straddle：</p><p><img src="https://www.zhihu.com/equation?tex=A%5Eb%28S%2C+%5Csigma%2C+%5Ctau%2C+K%29+%3D+P%5Eb%28S%2C%5Csigma%2C%5Ctau%2CK%29+%2B+C%5Eb%28S%2C%5Csigma%2C+%5Ctau%2C+K%29" alt="A^b(S, \sigma, \tau, K) = P^b(S,\sigma,\tau,K) + C^b(S,\sigma, \tau, K)" eeimg="1"> <br></p><p><br></p><p>8.定义组合，组合损益及其对应头寸：</p><p><img src="https://www.zhihu.com/equation?tex=V_t+%3D+%5Ceta_t%5EpP_t%28K_t%5Ep%29+%2B++%5Ceta_t%5EaA_t%28K_t%5Ea%29+%2B++%5Ceta_t%5EcC_t%28K_t%5Ec%29%5C%5C+gV_t+%3D+%5Ceta_t%5EpgP_t%28K_t%5Ep%29+%2B++%5Ceta_t%5EagA_t%28K_t%5Ea%29+%2B++%5Ceta_t%5EcgC_t%28K_t%5Ec%29" alt="V_t = \eta_t^pP_t(K_t^p) +  \eta_t^aA_t(K_t^a) +  \eta_t^cC_t(K_t^c)\\ gV_t = \eta_t^pgP_t(K_t^p) +  \eta_t^agA_t(K_t^a) +  \eta_t^cgC_t(K_t^c)" eeimg="1"> </p><p>该头寸可以构成任意Straddle， Strangle和Risk Reversal之间的组合</p><p><br></p><p><b>损益拆分：</b></p><p>定义里8中的组合，由伊藤定理可知：</p><p><img src="https://www.zhihu.com/equation?tex=gP_%28K_t%5Ep%29+%3D+P_s%5Eb%28S_t%2CI_%7Bpt%7D%2CT-t%3BK_t%5Ep%29dS_t+%2B+P_s%5Eb%28S_t%2CI_%7Bpt%7D%2CT-t%3BK_t%5Ep%29dI_%7Bpt%7D+%2B+G%5Ep_dt++%E2%80%94%E2%80%94%E2%80%94%E2%80%94%282%29" alt="gP_(K_t^p) = P_s^b(S_t,I_{pt},T-t;K_t^p)dS_t + P_s^b(S_t,I_{pt},T-t;K_t^p)dI_{pt} + G^p_dt  ————(2)" eeimg="1"> </p><p>这里我们用下表示对该变量求偏导，上式中的G在Q_（本币对外币）为：</p><p><img src="https://www.zhihu.com/equation?tex=+P_%7Bss%7D%5Eb%28S_t%2CI_%7Bpt%7D%2CT-t%3BK_t%5Ep%29%5Cfrac%7Bd%3CS%3E_t%7D%7B2dt%7D+%2B++P_%7BsI%7D%5Eb%28S_t%2CI_%7Bpt%7D%2CT-t%3BK_t%5Ep%29%5Cfrac%7Bd%3CS%2CI_p%3E_t%7D%7B2dt%7D+%2B+%5C%5C+P_%7BII%7D%5Eb%28S_t%2CI_%7Bpt%7D%2CT-t%3BK_t%5Ep%29%5Cfrac%7Bd%3CI_p%3E_t%7D%7B2dt%7D+-+%5CTheta_t+%E2%80%94%E2%80%94%E2%80%94%E2%80%94%283%29" alt=" P_{ss}^b(S_t,I_{pt},T-t;K_t^p)\frac{d<S>_t}{2dt} +  P_{sI}^b(S_t,I_{pt},T-t;K_t^p)\frac{d<S,I_p>_t}{2dt} + \\ P_{II}^b(S_t,I_{pt},T-t;K_t^p)\frac{d<I_p>_t}{2dt} - \Theta_t ————(3)" eeimg="1"> </p><p>式2的前两部分都是Q_ 下的鞅，也就是一般人喜欢“预测”的部分。对此随机部分观点的读者可根绝观点自行决定方向。本文不提供决定方向的任何看法，因为本文只介绍头寸配置多少这个问题。（因此本文是“虚假理论”，入行的人判断对方想就能滋滋滋收获PnLCut了）</p><p>式3中，Theta的折损不可避免，因此建立头寸的重心不会放在Theta上而主要考虑二次项，四次项（伪，其表象形式为二次）和交叉项带来的各种二次变差</p><p>根据S和I各自服从的过程我们易知：</p><p><img src="https://www.zhihu.com/equation?tex=%5Cfrac%7Bd%3CS%3E_t%7D%7Bd_t%7D+%3D+%5Csigma_t%5E2S_t%5E2%2C++%7E%5Cfrac%7Bd%3CS%2C+I_p%3E_t%7D%7Bd_t%7D+%3D+S_t%5Cgamma_tI_%7Bpt%7D%2C++%5Cfrac%7Bd%3CI%3E_t%7D%7Bd_t%7D+%3D+%5Comega_t%5E2I_%7Bpt%7D%5E2" alt="\frac{d<S>_t}{d_t} = \sigma_t^2S_t^2,  ~\frac{d<S, I_p>_t}{d_t} = S_t\gamma_tI_{pt},  \frac{d<I>_t}{d_t} = \omega_t^2I_{pt}^2" eeimg="1"> </p><p>觉的服从过程假设虚假，不入行的读者可以自行建模，可以使用你们喜爱的”纯data based深度神经网络“，但要保证各类相关二次项能够被分解出来，否则无法继续。</p><p>在根据上节式1中的相对Greeks表达我们分别把put，call，atmstraddle的变差项损益表示为：</p><p><img src="https://www.zhihu.com/equation?tex=G_t%5Ep+%3D+R%5CGamma_t%5Ep%5B%5Csigma%5E2_t%2F2+-+I_%7Bpt%7D%5E2%2F2+%2B%5Cgamma_%7Bt%7D+l%5Ep_%7B-t%7D+%2B%5Comega_t%5E2l_%7B-t%7D%5Epl_%7B%2Bt%7D%5Ep%5Ddt+%5C%5C+G_t%5Ec+%3D+R%5CGamma_t%5Ec%5B%5Csigma%5E2_t%2F2+-+I_%7Bct%7D%5E2%2F2+%2B%5Cgamma_%7Bt%7D+l%5Ec_%7B-t%7D+%2B%5Comega_t%5E2l_%7B-t%7D%5Ecl_%7B%2Bt%7D%5Ec%5Ddt+%5C%5C+G_t%5Ea+%3D+R%5CGamma_t%5Ea%5B%5Csigma%5E2_t%2F2+-+I_%7Bat%7D%5E2%2F2+%5Ddt++%E2%80%94%E2%80%94%E2%80%94%E2%80%94%E2%80%94%284%29" alt="G_t^p = R\Gamma_t^p[\sigma^2_t/2 - I_{pt}^2/2 +\gamma_{t} l^p_{-t} +\omega_t^2l_{-t}^pl_{+t}^p]dt \\ G_t^c = R\Gamma_t^c[\sigma^2_t/2 - I_{ct}^2/2 +\gamma_{t} l^c_{-t} +\omega_t^2l_{-t}^cl_{+t}^c]dt \\ G_t^a = R\Gamma_t^a[\sigma^2_t/2 - I_{at}^2/2 ]dt  —————(4)" eeimg="1"> </p><p>这一步的目的是为了分解变差损益，首先我们可以看到我们组合中三个成分都是”相对Gamma“的倍数。 其次straddle的变差向收益单纯就是实际波动率和隐含波动的差。 最后我们可以看到put和call分别会有变差项损益: <img src="https://www.zhihu.com/equation?tex=%5Cgamma_%7Bt%7D+l%5Ep_%7B-t%7D+%2B%5Comega_t%5E2l_%7B-t%7D%5Epl_%7B%2Bt%7D%5Ep+%2C%7E%5Cgamma_%7Bt%7D+l%5Ec_%7B-t%7D+%2B%5Comega_t%5E2l_%7B-t%7D%5Ecl_%7B%2Bt%7D%5Ec" alt="\gamma_{t} l^p_{-t} +\omega_t^2l_{-t}^pl_{+t}^p ,~\gamma_{t} l^c_{-t} +\omega_t^2l_{-t}^cl_{+t}^c" eeimg="1"> 这些将会构成Risk Reversal和Strangle- Straddle（非随机项）的收益来源</p><p><br></p><p><b>头寸建模：</b></p><p>基于式4的结果我们可以构建三种trading的头寸</p><p>对于Straddle，购入每单位：</p><p><img src="https://www.zhihu.com/equation?tex=%5Ceta_t%5Ep+%3D+0%2C+%7E%5Ceta_t%5Ea+%3D+2%2FR%5CGamma%5Ea_t%2C++%7E%5Ceta_t%5Ec" alt="\eta_t^p = 0, ~\eta_t^a = 2/R\Gamma^a_t,  ~\eta_t^c" eeimg="1"> </p><p>这一步除以”相对Gamma的目的“是消除方差和gamma本身对收益的缩放，喜欢缩放的读者可以不除</p><p>如此，Straddle的瞬时损益期望为：<br> <img src="https://www.zhihu.com/equation?tex=G%5Ev_t%5Cequiv%5Csigma%5E2_t+-+I_%7Bpt%7D%5E2" alt="G^v_t\equiv\sigma^2_t - I_{pt}^2" eeimg="1"> </p><p><br></p><p>对于Risk Reversal，购入每单位：</p><p><img src="https://www.zhihu.com/equation?tex=%5Ceta_t%5Ep+%3D+%5Cfrac%7B-1%7D%7B%28l_%7B-t%7D%5Ec+-+l_%7B-t%7D%5Ep%29R%5CGamma%5Ep_t%7D%2C+%7E%5Ceta_t%5Ea+%3D+0%2C++%7E%5Ceta_t%5Ec+%3D%5Cfrac%7B1%7D%7B%28l_%7B-t%7D%5Ec+-+l_%7B-t%7D%5Ep%29R%5CGamma%5Ec_t%7D" alt="\eta_t^p = \frac{-1}{(l_{-t}^c - l_{-t}^p)R\Gamma^p_t}, ~\eta_t^a = 0,  ~\eta_t^c =\frac{1}{(l_{-t}^c - l_{-t}^p)R\Gamma^c_t}" eeimg="1"> </p><p>除以 <img src="https://www.zhihu.com/equation?tex=l_%7B-t%7D%5Ec+-+l_%7B-t%7D%5Ep" alt="l_{-t}^c - l_{-t}^p" eeimg="1"> 和除以相对Gamma的目的相同，为了消除在值度差缩放作用，喜欢缩放读者可以不除</p><p>如此，Risk Reversal的瞬时损益期望为：</p><p><img src="https://www.zhihu.com/equation?tex=G%5E2_t+%5Cequiv+%5Cgamma_t+-+%5Cfrac%7BI%5E2_%7Bct%7D+-I%5E2_%7Bpt%7D%7D%7B2%28l_%7B-t%7D%5Ec+-+l_%7B-t%7D%5Ep%29%7D" alt="G^2_t \equiv \gamma_t - \frac{I^2_{ct} -I^2_{pt}}{2(l_{-t}^c - l_{-t}^p)}" eeimg="1"> </p><p>通俗讲，左边就是交叉相的损益（一般是负的），右边是被在值度的缩放的pc间IV的差</p><p><br></p><p>对于Strangle- ATMStraddle 购入每单位：</p><p><img src="https://www.zhihu.com/equation?tex=%5Ceta_t%5Ep+%3D+%5Cfrac%7B1%7D%7B%5Cbar%7Bl%7D_%7Bagt%7D%5E2R%5CGamma%5Ep_t%7D%2C+%7E%5Ceta_t%5Ea+%3D++%5Cfrac%7B2%7D%7B%5Cbar%7Bl%7D_%7Bagt%7D%5E2R%5CGamma%5Ea_t%7D%2C++%7E%5Ceta_t%5Ec+%3D+%5Cfrac%7B1%7D%7B%5Cbar%7Bl%7D_%7Bagt%7D%5E2R%5CGamma%5Ec_t%7D" alt="\eta_t^p = \frac{1}{\bar{l}_{agt}^2R\Gamma^p_t}, ~\eta_t^a =  \frac{2}{\bar{l}_{agt}^2R\Gamma^a_t},  ~\eta_t^c = \frac{1}{\bar{l}_{agt}^2R\Gamma^c_t}" eeimg="1"> </p><p>其中 <img src="https://www.zhihu.com/equation?tex=%5Cbar%7Bl%7D_%7Bagt%7D%5E2+%3D%28l_%7B-t%7D%5Ec+%2B+%7Cl_%7B-t%7D%5Ep%7C%29%28l_%7B%2Bt%7D%5Ec+%2B+%7Cl_%7B%2Bt%7D%5Ep%7C%29%2F4" alt="\bar{l}_{agt}^2 =(l_{-t}^c + |l_{-t}^p|)(l_{+t}^c + |l_{+t}^p|)/4" eeimg="1">  是为了消除在值度的缩放，喜欢缩放读者可以不除</p><p>如此butterfly的收益的瞬时损益期望为：</p><p><img src="https://www.zhihu.com/equation?tex=G%5Ev_t+%3D+%5Comega%5E2_t+-++%5Cfrac%7B%28I_%7Bct%7D%5E2%2BI_%7Bpt%7D%5E2%29%2F2+-+I%5E2_%7Bat%7D%7D%7B%5Cbar%7Bl%7D_%7Bagt%7D%5E2+%7D" alt="G^v_t = \omega^2_t -  \frac{(I_{ct}^2+I_{pt}^2)/2 - I^2_{at}}{\bar{l}_{agt}^2 }" eeimg="1"> </p><p>通俗讲，左边是波动率的波动率， 右边是被在值度的缩放的strangle平均IV和atmIV的差</p><p><br></p><p>我们可以发现这个参数化模型的一大优点就是不需要拟合诸如Heston的SV模型就可以对三种涉及到高阶信息的仓位进行拆分和建模。</p><p>当然，如果需要对收益期望的大小建模还是需要一个SV模型，由于本文中模型是直接对IV建模，因此嫁接SV模型时会发生非常大的变化（需另对IV和SV的差另外进行建模）。</p><p><br></p><p><b>吐槽和骂人：</b></p><p>是，本问不是不入行的”虚假模型“，问题是当交易员一个个都只想着赌方向的时候，有谁会去想应该赌多少呢？怕是连下注都容易下错吧。当然这些都是猫这个低等文职闲的无聊考虑的问题，交易员们可能没时间考虑，忙着滋滋滋赚PnLCut。</p><p><br></p><p><br></p><p><br></p><p><br></p><p>最后，按照惯例，希望这些”被时代淘汰的虚假理论"能帮助一些从业者和学习者。</p><p><br></p><p>模型出处：</p><a href="https://link.zhihu.com/?target=https%3A//kolmogorov.fsc.stevens.edu/hff_conference/images/Presentation_File/Peter-Carr_Vol-Skew-and-Smile-Trading.pdf" data-draft-node="block" data-draft-type="link-card" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">https://</span><span class="visible">kolmogorov.fsc.stevens.edu</span><span class="invisible">/hff_conference/images/Presentation_File/Peter-Carr_Vol-Skew-and-Smile-Trading.pdf</span><span class="ellipsis"></span></a><p></p>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
