<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>卡特兰数（Catalan number）（二）</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/31526354">原文</a></p>
<div class="title-image"><img src="https://pic4.zhimg.com/v2-e0f4a3c50018f889a267ba82de7ad0f3_r.jpg" alt=""></div><p>➤ 满位置二叉树的计数</p><p>有 <equation>n+1</equation> 个叶子节点的满位置二叉树（即每个节点有0或2个子节点，且左子节点和右子节点是不同的）的计数问题，相当于有 <equation>n</equation> 个内节点的满位置二叉树的计数问题。</p><p>例如 <equation>n=3</equation> 时，有如下5种不同的满位置二叉树。</p><img src="https://pic4.zhimg.com/v2-75c2dfb21c076c417bfa71b1ce70e231_r.jpg" data-caption="" data-size="normal" data-rawwidth="989" data-rawheight="458"><p>➤ 矩阵连乘顺序</p><p>假设矩阵序列 <equation>\mathbf{A}_1,\mathbf{A}_2,\cdots,\mathbf{A}_n</equation> 满足对于任意 <equation>1\leq i&lt;n</equation> ， <equation>\mathbf{A}_{i}</equation> 和 <equation>\mathbf{A}_{i+1}</equation> 都是可乘的。</p><p>由于矩阵乘法满足结合律，因此计算矩阵连乘积的不同的计算次序（每次计算都是两个矩阵相乘得到一个结果矩阵）。</p><p>例如 <equation>n=4</equation> 时有如下5种计算次序。</p><img src="https://pic4.zhimg.com/v2-602a5cf28aa89539d39d8a83be1768f0_r.jpg" data-caption="" data-size="normal" data-rawwidth="480" data-rawheight="275"><p>如果将“加括号”的乘法次序使用树来表示，就得到了有 <equation>n+1</equation> 个叶子节点的满位置二叉树。</p><img src="https://pic4.zhimg.com/v2-d711ef3c30ffe63c5809cb3bce5d48b6_r.jpg" data-caption="" data-size="normal" data-rawwidth="1369" data-rawheight="869"><p>➤ 正多边形的三角剖分</p><p>不解释了，直接看例子吧。</p><p>正5边形有如下5种不同的三角剖分。</p><img src="https://pic1.zhimg.com/v2-66d42a09566969b034c3320d332f21be_r.jpg" data-caption="" data-size="normal" data-rawwidth="1334" data-rawheight="220"><p>对于正 <equation>n+2</equation> 边形，固定某一条边，包括该边的三角形作为根，其他三角形作为其他内点，其他边作为叶子。相邻三角形代表的内点之间连线、其三角形代表的内点和该三角形中属于原来多边形的边之间连线，则得到有 <equation>n+1</equation> 个叶子节点的位置二叉树。</p><img src="https://pic2.zhimg.com/v2-5bc23b56200cd4c9f8aaa5efe1b1e4f5_r.jpg" data-caption="" data-size="normal" data-rawwidth="1372" data-rawheight="219"><p>➤ 阶梯形的矩形剖分</p><p>使用 <equation>n</equation> 个矩形拼成 <equation>n</equation> 阶梯形。</p><img src="https://pic4.zhimg.com/v2-bf17a6f89c451c9d21e9fd3efb942963_r.jpg" data-caption="" data-size="normal" data-rawwidth="1016" data-rawheight="159"><p>考虑 <equation>n</equation> 阶梯形的 <equation>n</equation> 个“尖”（下图左中的黄色方格），一定每一个都恰好属于一个分剖的矩形。</p><p>考虑顶端（下图左中的红色方格），它一定和某一个“尖”同属一个矩形。于是这个矩形将大的阶梯形分成左右两个小阶梯形（允许0阶梯形的存在）（例如下图右）。</p><img src="https://pic4.zhimg.com/v2-2b0b5036c4bc43f5481dab30b651066f_r.jpg" data-caption="" data-size="normal" data-rawwidth="938" data-rawheight="257"><p>例如 <equation>n=6</equation> 时，包含顶端的矩形有如下6种可能：</p><img src="https://pic2.zhimg.com/v2-7ebd549dceac59c2f1d60642b930b10f_r.jpg" data-caption="" data-size="normal" data-rawwidth="1226" data-rawheight="511"><p>递归地将这个矩形“顶端”和左右两个小阶梯形的“顶端”相连，最终得到“阶梯形的矩形剖分”和“位置二叉树”之间的对应。</p><img src="https://pic1.zhimg.com/v2-3f3141c4df8153672a7103832abe32a2_r.jpg" data-caption="" data-size="normal" data-rawwidth="1297" data-rawheight="168"><hr><p>用 <equation>C_n</equation> 表示 <equation>n</equation> 阶梯形剖分成 <equation>n</equation> 个矩形的方法数，则由于包含顶端的矩形将大的阶梯形分成左右两个小阶梯形，于是有</p><p><equation>C _n=C_0C_{n-1}+C_1C_{n-2}+C_2C_{n-3}+\cdots+C_{n-2}C_1+C_{n-1}C_0</equation> 。</p><p>例如由下图可得：<equation>C _6=C_0C_5+C_1C_4+C_2C_3+C_3C_2+C_4C_1+C_5C_0</equation> 。</p><img src="https://pic2.zhimg.com/v2-7ebd549dceac59c2f1d60642b930b10f_r.jpg" data-caption="" data-size="normal" data-rawwidth="1226" data-rawheight="511"><p>设 <equation>C(x)=\sum_{i=0}^{\infty}{C _ix^i}=C_0+C_1x+C_2x^2+C_3x^3+\cdots</equation> ，则有</p><p><equation>\begin{equation} \begin{split} C(x)\times C(x)= &amp;(C_0C_0) +\\ &amp; (C_0C_1+C_1C_0)x+\\ &amp; (C_0C_2+C_1C_1+C_2C_0)x^2+\\ &amp; (C_0C_3+C_1C_2+C_2C_1+C_3C_0)x^3+\cdots\\ =&amp;C_1+C_2x+C_3x^2++C_4x^3+\cdots \\ =&amp;(C(x)-1)/x \end{split} \end{equation}</equation> </p><p>整理得到 <equation>C(x)=1+xC(x)^{2}</equation> ，解得 <equation>C(x)={\frac {1\pm{\sqrt {1-4x}}}{2x}}</equation> 。经过简单验算后可以舍弃 <equation>\frac {1+{\sqrt {1-4x}}}{2x}</equation>，于是由 <equation>{\sqrt {1-4x}}=\sum _{n=0}^{\infty }{{\frac {1}{2}} \choose n}(-4x)^{n}=\sum _{n=0}^{\infty }{\frac {(-1)^{n+1}}{4^{n}(2n-1)}}{2n \choose n}(-4x)^{n}</equation> （牛顿二项式定理）整理得： <equation>C(x)=\sum _{n=0}^{\infty }{2n \choose n}{\frac {x^{n}}{n+1}}</equation> ，即：</p><p><equation>C_n={\frac {1}{n+1}}{2n \choose n}</equation> 。</p><p>——这就是著名的<b>卡特兰数（Catalan number）</b>，它们因比利时数学家Eugène Charles Catalan (1814–1894)而命名。</p><p></p><p></p>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
