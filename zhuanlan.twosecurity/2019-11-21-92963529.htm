<div class="title-image"><img src="https://pic3.zhimg.com/v2-66b6cdd630366930f3cf4da4193b0817_b.jpg" alt=""></div><p>Hawkeye（鹰眼），提到这个词你可能会想到百步穿杨的漫威英雄鹰眼，亦或是刺客信条的鹰眼视觉。</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-d8cdc6e348c18b80f9f3ed5a480f5fb1_b.jpg" data-caption="" data-size="normal" data-rawwidth="302" data-rawheight="167" class="content_image" width="302"/></noscript><img src="https://pic2.zhimg.com/v2-d8cdc6e348c18b80f9f3ed5a480f5fb1_b.jpg" data-caption="" data-size="normal" data-rawwidth="302" data-rawheight="167" class="content_image lazy" width="302" data-actualsrc="https://pic2.zhimg.com/v2-d8cdc6e348c18b80f9f3ed5a480f5fb1_b.jpg"/></figure><blockquote>鹰眼（Hawkeye）是美国漫威漫画旗下超级英雄，曾化名为歌利亚（Goliath）与浪人（Ronin），是个在马戏团长大的孤儿，师从剑客（Swordsman）和捷射（Trick Shot），天赋异常，小时候便获得“鹰眼“和“世界最佳狙击手”的称号，因在某次演出时看到钢铁侠救人的一幕后，决定利用自己的能力成为超级英雄，后加入复仇者联盟，成为其中重要的一员。</blockquote><p><b>“我们为什么具有这些天赋？这些能力？因为他们流淌在我们的血脉之中。”</b></p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-817a98a8722380883579074c17ad2310_b.jpg" data-caption="" data-size="normal" data-rawwidth="590" data-rawheight="334" class="origin_image zh-lightbox-thumb" width="590" data-original="https://pic1.zhimg.com/v2-817a98a8722380883579074c17ad2310_r.jpg"/></noscript><img src="https://pic1.zhimg.com/v2-817a98a8722380883579074c17ad2310_b.jpg" data-caption="" data-size="normal" data-rawwidth="590" data-rawheight="334" class="origin_image zh-lightbox-thumb lazy" width="590" data-original="https://pic1.zhimg.com/v2-817a98a8722380883579074c17ad2310_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-817a98a8722380883579074c17ad2310_b.jpg"/></figure><blockquote>鹰眼视觉（Eagle Vision），也被维京刺客们称作奥丁视力（Odin-Sight）而古希腊人则把它称作雅典娜之视（Athena&#39;s Sight），是特定血统的人类所具有的第六感，这是人类被第一文明创造的结果。尽管每个人都具备这种潜质，但那些曾与自身创造者交合的人类后裔拥有更多启用这种感官的必要基因，因而更有可能展现这种能力。</blockquote><p>而我今天要为大家介绍的是一个堪比“鹰眼”，名也叫“鹰眼”的监控系统。监控 github 代码库，及时发现员工托管公司代码到 GitHub 行为并预警，降低代码泄露风险。</p><h2>Hawkeye👁‍🗨</h2><p>GitHub 泄露监控系统（GitHub Sensitive Information Leakage Monitor Spider）</p><p>项目地址👓：<a href="https://link.zhihu.com/?target=https%3A//github.com/0xbug/Hawkeye" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">https://</span><span class="visible">github.com/0xbug/Hawkey</span><span class="invisible">e</span><span class="ellipsis"></span></a></p><p><b>特点🎯</b></p><ul><li>周期监测</li><li>web管理</li><li>邮箱告警通知</li><li>黑名单添加</li><li>爬虫任务设置</li></ul><p><b>最新内容📢</b></p><ul><li>添加健康检查接口 /api/health</li><li>添加企业微信告警</li><li>支持翻页刷新</li><li>搜索方式切换成 API，支持添加多 GitHub 用户，API 配额可视化</li><li>配置可视化，去除配置文件</li><li>crontab 切换成轻量级的任务队列 Huey ,任务周期可自定义</li><li>支持 Docker 部署</li><li>支持批量忽略</li><li>爬虫任务状态、结果记录展示</li><li>优化解析受影响资产</li><li>重构邮件 告警，添加钉钉告警</li></ul><h2>开启心灵之眼🔯</h2><p>推荐环境：Linux or macOS</p><p>依赖：Python 3.x、Flask、MongoDB &gt;= 3.x</p><p><b>下载：</b></p><p>1️⃣直接拉取</p><div class="highlight"><pre><code class="language-text">git clone https://github.com/0xbug/Hawkeye.git --depth 1</code></pre></div><p>2️⃣下载源文件到本地</p><p><a href="https://link.zhihu.com/?target=https%3A//github.com/0xbug/Hawkeye" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">https://</span><span class="visible">github.com/0xbug/Hawkey</span><span class="invisible">e</span><span class="ellipsis"></span></a> </p><p><b>docker部署：</b></p><p>下载后，使用 docker 直接创建镜像。</p><div class="highlight"><pre><code class="language-text">docker build -t hawkeye .</code></pre></div><figure data-size="small"><noscript><img src="https://pic1.zhimg.com/v2-28e3e024dba820e61ac4a6f4fc51e324_b.jpg" data-caption="" data-size="small" data-rawwidth="1672" data-rawheight="662" class="origin_image zh-lightbox-thumb" width="1672" data-original="https://pic1.zhimg.com/v2-28e3e024dba820e61ac4a6f4fc51e324_r.jpg"/></noscript><img src="https://pic1.zhimg.com/v2-28e3e024dba820e61ac4a6f4fc51e324_b.jpg" data-caption="" data-size="small" data-rawwidth="1672" data-rawheight="662" class="origin_image zh-lightbox-thumb lazy" width="1672" data-original="https://pic1.zhimg.com/v2-28e3e024dba820e61ac4a6f4fc51e324_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-28e3e024dba820e61ac4a6f4fc51e324_b.jpg"/></figure><p><b>mongodb</b></p><p>再在 docker 上搭一个 mongodb。 </p><div class="highlight"><pre><code class="language-text">docker pull mongo
docker run -p 27017:27017 -v $PWD:/data/db --name docker_mongodb -d mongo</code></pre></div><figure data-size="small"><noscript><img src="https://pic4.zhimg.com/v2-37cccce1203cb85e1847e9e876c5d4a3_b.jpg" data-caption="" data-size="small" data-rawwidth="1712" data-rawheight="292" class="origin_image zh-lightbox-thumb" width="1712" data-original="https://pic4.zhimg.com/v2-37cccce1203cb85e1847e9e876c5d4a3_r.jpg"/></noscript><img src="https://pic4.zhimg.com/v2-37cccce1203cb85e1847e9e876c5d4a3_b.jpg" data-caption="" data-size="small" data-rawwidth="1712" data-rawheight="292" class="origin_image zh-lightbox-thumb lazy" width="1712" data-original="https://pic4.zhimg.com/v2-37cccce1203cb85e1847e9e876c5d4a3_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-37cccce1203cb85e1847e9e876c5d4a3_b.jpg"/></figure><p>然后打开一个容器，这里涉及 mongodb 的认证问题，所以有两种开启方法，一种带认证，一种无认证。</p><div class="highlight"><pre><code class="language-text">docker run -ti -p 80:80 -e MONGODB_URI=mongodb://username:password@ip:27017/hawkeye -e MONGODB_USER= -e MONGODB_PASSWORD= -d hawkeye ## mongodb 需认证
docker run -ti -p 80:80 -e MONGODB_URI=mongodb://ip:27017 -d hawkeye ## mongodb 无认证</code></pre></div><p>测试服务容器连接到数据库容器</p><div class="highlight"><pre><code class="language-text">docker exec 容器id curl 127.0.0.1:27017</code></pre></div><p>查看容器的ip地址</p><div class="highlight"><pre><code class="language-text">ifconfig</code></pre></div><p>查看端口占用情况</p><div class="highlight"><pre><code class="language-text">lsof -i:8888 </code></pre></div><p>（docker 坑太多，建议回避）</p><p><b>直接部署</b></p><p>安装依赖 (修改/usr/local/bin/python3 为系统的 Python 3 路径)</p><div class="highlight"><pre><code class="language-text">cd Hawkeye
pip install virtualenv
virtualenv --python=/usr/local/bin/python3 venv
source venv/bin/activate</code></pre></div><p>一键导入第三方包</p><div class="highlight"><pre><code class="language-text">pip install -r deploy/pyenv/requirements.txt</code></pre></div><p><b>修改配置</b></p><p>打开配置文件</p><div class="highlight"><pre><code class="language-text">cp config.ini.example config.ini
vim config.ini</code></pre></div><p>平台认证配置(BasicAuth)</p><div class="highlight"><pre><code class="language-text">[Auth]
ENABLE = 1 或者 0 #是否开启认证功能
TYPE = basic #(暂时只支持basic认证)
USERNAME = 帐号 #平台登录账号
PASSWORD = 密码 #平台登录密码</code></pre></div><p>github 帐户配置</p><div class="highlight"><pre><code class="language-text">[GitHub]
USERNAME = 帐号 #自己的github账号
PASSWORD = 密码 #自己的github密码</code></pre></div><p>MongoDB 认证配置（可选）</p><p>先创建用户</p><div class="highlight"><pre><code class="language-text">mongo
&gt;db.createUser({user:&#39;root&#39;,pwd:&#39;password&#39;,roles:[{role:&#39;dbOwner&#39;,db:&#39;Hawkeye&#39;}]})</code></pre></div><p>然后修改配置文件</p><div class="highlight"><pre><code class="language-text">[MongoDB]
HOST = localhost
PORT = 27017
ACCOUNT = 帐号 #MongoDB数据库账号（自己创建的）
PASSWORD = 密码 #MongoDB数据库密码（自己创建的）</code></pre></div><p>告警配置（ENABLE:是否开启告警功能）</p><div class="highlight"><pre><code class="language-text">[Notice]
ENABLE = 1
MAIL_SERVER = 邮件服务器
MAIL_PORT = smtp端口
FROM = 发件人
PASSWORD = 密码</code></pre></div><h2>运行💮</h2><div class="highlight"><pre><code class="language-text">python Hawkeye.py</code></pre></div><p>然后访问 <a href="https://link.zhihu.com/?target=http%3A//0.0.0.0%3A5000/" class=" wrap external" target="_blank" rel="nofollow noreferrer">http://xxxx:5000/</a> 进行关键词、告警、黑名单、定时任务配置(初次运行需要点击确认按钮新建cron任务)。</p><figure data-size="small"><noscript><img src="https://pic3.zhimg.com/v2-f5e509f7680bd74e313eff0abf2471d2_b.jpg" data-caption="" data-size="small" data-rawwidth="1387" data-rawheight="724" class="origin_image zh-lightbox-thumb" width="1387" data-original="https://pic3.zhimg.com/v2-f5e509f7680bd74e313eff0abf2471d2_r.jpg"/></noscript><img src="https://pic3.zhimg.com/v2-f5e509f7680bd74e313eff0abf2471d2_b.jpg" data-caption="" data-size="small" data-rawwidth="1387" data-rawheight="724" class="origin_image zh-lightbox-thumb lazy" width="1387" data-original="https://pic3.zhimg.com/v2-f5e509f7680bd74e313eff0abf2471d2_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-f5e509f7680bd74e313eff0abf2471d2_b.jpg"/></figure><h2>实现永久部署</h2><p>建议使用 supervisor 设置成开机自启，并监控进程，配置文件 deploy/Hawkeye.conf.example </p><p>有关 <b>Hawkeye</b> 的内容就简单介绍到这里，向作者致敬。更多资讯请关注 <a href="https://link.zhihu.com/?target=https%3A//twosecurity.cn/%3Fquery_ref%3DqGLdXm" class=" wrap external" target="_blank" rel="nofollow noreferrer">二向箔安全</a> 进行了解，最近推出了一系列免费的网络安全技能包，有关渗透测试、网络攻防、黑客技巧尽在其中，学它涨姿势💯。</p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-fe65256149738f54b5bfcbd1ae5c9f1b_b.jpg" data-caption="" data-size="normal" data-rawwidth="720" data-rawheight="403" class="origin_image zh-lightbox-thumb" width="720" data-original="https://pic4.zhimg.com/v2-fe65256149738f54b5bfcbd1ae5c9f1b_r.jpg"/></noscript><img src="https://pic4.zhimg.com/v2-fe65256149738f54b5bfcbd1ae5c9f1b_b.jpg" data-caption="" data-size="normal" data-rawwidth="720" data-rawheight="403" class="origin_image zh-lightbox-thumb lazy" width="720" data-original="https://pic4.zhimg.com/v2-fe65256149738f54b5bfcbd1ae5c9f1b_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-fe65256149738f54b5bfcbd1ae5c9f1b_b.jpg"/></figure><p></p>