<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>中国剩余定理（CRT ）</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/44591114">原文</a></p>
<div class="title-image"><img src="https://pic4.zhimg.com/v2-749a14807cb3f0a0400742d9807367d5_b.jpg" alt=""></div><p>题图如有侵权请告知，将道歉并删除。</p><p>这次我决定简单粗暴地引入主题，因为要介绍的是我认为非常重要的、我非常喜欢的——<b>中国剩余定理(Chinese remainder theorem, CRT) </b>！</p><hr><p>《孙子算经》是中国古代重要的数学著作，共三卷，成书约在四、五世纪，作者生平和具体编写年不详。</p><p>其卷下的第26题为：</p><blockquote>今有物不知其数，三三数之剩二，五五数之剩三，七七数之剩二，问物几何？<br>答曰：‘二十三’。<br>术曰：三三数之剩二，置一百四十；五五数之剩三，置六十三，七七数之剩二，置三十，并之。得二百三十三，以二百一十减之，即得。凡三三数之剩一，则置七十；五五数之剩一，则置二十一；七七数之剩一，则置十五；一百六以上以一百五减之即得。</blockquote><figure data-size="small"><noscript><img src="https://pic2.zhimg.com/v2-77ea0e0aa8a6542442a5296ac7a66255_b.jpg" data-caption="" data-size="small" data-rawwidth="1653" data-rawheight="2191" class="origin_image zh-lightbox-thumb" width="1653" data-original="https://pic2.zhimg.com/v2-77ea0e0aa8a6542442a5296ac7a66255_r.jpg"></noscript><img src="https://pic2.zhimg.com/v2-77ea0e0aa8a6542442a5296ac7a66255_b.jpg" data-caption="" data-size="small" data-rawwidth="1653" data-rawheight="2191" class="origin_image zh-lightbox-thumb lazy" width="1653" data-original="https://pic2.zhimg.com/v2-77ea0e0aa8a6542442a5296ac7a66255_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-77ea0e0aa8a6542442a5296ac7a66255_b.jpg"></figure><p>（即——</p><blockquote>一个整数除以3余2、除以5余3、除以7余2，求这个整数。<br>答案：23<br>解法：由于除以3余2，因此加上一个140；由于除以5余3，因此加上一个63；由于除以7余2，因此加上一个30；这三个数的和是140+63+30=233，再减去210，就得到了23了。<br>这么说吧，只要是除以3余了一个1，就加上一个70；只要是除以5余了一个1，就加上一个21；只要是除以7余了一个1，就加上一个15。然后累加。超过了106就减去105就行了。</blockquote><p>）</p><p>该问题称之为“<b>物不知数</b>”问题。</p><hr><p>在中国民间还有所谓“<b>韩信点兵</b>”等类似问题：</p><p>（先插播一下所谓“<b>韩信将兵多多益善</b>”）</p><blockquote>上尝从容与信言诸将能不，各有差。上问曰：“如我，能将几何？”信曰：“陛下不过能将十万。”上曰：“如公何如？”曰：“如臣，多多益善耳。”上笑曰：“多多益善，何为为我禽？” 信曰：“陛下不能将兵，而善将将，此乃信之所以为陛下禽也。”<br>——《汉史·韩彭英卢吴传第四》</blockquote><p>“<b>韩信点兵</b>”问题的描述（之一）是：韩信让士兵排队，站3人一排，多出2人；站5人一排，多出4人；站7人一排，多出6人。于是他没有数就说出了士兵的数目。</p><hr><p>南宋，秦九韶在《数书九章》中明确地系统地叙述了求解一次同余组的一般计算步骤。在卷一“大衍总术”中详载了计算乘率的方法——“大衍求一术”。</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-3f5387ced226137ae01567f6001ff875_b.jpg" data-caption="" data-size="normal" data-rawwidth="375" data-rawheight="539" class="content_image" width="375"></noscript><img src="https://pic2.zhimg.com/v2-3f5387ced226137ae01567f6001ff875_b.jpg" data-caption="" data-size="normal" data-rawwidth="375" data-rawheight="539" class="content_image lazy" width="375" data-actualsrc="https://pic2.zhimg.com/v2-3f5387ced226137ae01567f6001ff875_b.jpg"></figure><p>然而我看不懂= =</p><p>（<a href="http://link.zhihu.com/?target=http%3A//yuedu.163.com/book_reader/42fe434f7bd048a284378b05a54757c9_4/b1c568b0109c443f863e6243347a0217_5" class=" wrap external" target="_blank" rel="nofollow noreferrer">数学九章-【宋】秦九韶-免费电子书-在线阅读-网易云阅读</a>）</p><hr><p>明代，程大位</p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-7c62ddd5bf41e79248a41618266432cf_b.jpg" data-size="normal" data-rawwidth="268" data-rawheight="335" class="content_image" width="268"></noscript><img src="https://pic4.zhimg.com/v2-7c62ddd5bf41e79248a41618266432cf_b.jpg" data-size="normal" data-rawwidth="268" data-rawheight="335" class="content_image lazy" width="268" data-actualsrc="https://pic4.zhimg.com/v2-7c62ddd5bf41e79248a41618266432cf_b.jpg"><figcaption>（图片来自百度百科）</figcaption></figure><p>在他的著作《直指算法统宗》（简称《算法统宗》）</p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-50e42055b4d525a6af5b078dff734fbe_b.jpg" data-caption="" data-size="normal" data-rawwidth="512" data-rawheight="363" class="origin_image zh-lightbox-thumb" width="512" data-original="https://pic3.zhimg.com/v2-50e42055b4d525a6af5b078dff734fbe_r.jpg"></noscript><img src="https://pic3.zhimg.com/v2-50e42055b4d525a6af5b078dff734fbe_b.jpg" data-caption="" data-size="normal" data-rawwidth="512" data-rawheight="363" class="origin_image zh-lightbox-thumb lazy" width="512" data-original="https://pic3.zhimg.com/v2-50e42055b4d525a6af5b078dff734fbe_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-50e42055b4d525a6af5b078dff734fbe_b.jpg"></figure><p>卷五中，提出了“孙子歌”——“<b>三人同行七十稀，五树梅花廿一枝， 七子团圆正半月，除百令五便得知</b>。”。</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-9ee7334e4e3f59da212566f68c9f9b31_b.jpg" data-caption="" data-size="normal" data-rawwidth="320" data-rawheight="458" class="content_image" width="320"></noscript><img src="https://pic2.zhimg.com/v2-9ee7334e4e3f59da212566f68c9f9b31_b.jpg" data-caption="" data-size="normal" data-rawwidth="320" data-rawheight="458" class="content_image lazy" width="320" data-actualsrc="https://pic2.zhimg.com/v2-9ee7334e4e3f59da212566f68c9f9b31_b.jpg"></figure><p>实际上说的就是前文的：只要是除以3余了一个1，就加上一个70；只要是除以5余了一个1，就加上一个21；只要是除以7余了一个1，就加上一个15。然后累加。</p><p>再加上一句：计算这个总和除以105的余数。</p><hr><p>而我只会用现代的数学语言来解释：</p><p>先考虑问题的分解：</p><p><b>问题1：</b>计算一个整数 <img src="https://www.zhihu.com/equation?tex=x" alt="x" eeimg="1"> ，使得它满足除以3余2、除以5余3、除以7余2。</p><p>如果能够找到三个整数 <img src="https://www.zhihu.com/equation?tex=x_1%2Cx_2%2Cx_3" alt="x_1,x_2,x_3" eeimg="1"> ，使得：</p><p><img src="https://www.zhihu.com/equation?tex=x_1" alt="x_1" eeimg="1"> 除以3余2、除以5余0、除以7余0；</p><p><img src="https://www.zhihu.com/equation?tex=x_2" alt="x_2" eeimg="1"> 除以3余0、除以5余3、除以7余0；</p><p><img src="https://www.zhihu.com/equation?tex=x_3" alt="x_3" eeimg="1"> 除以3余0、除以5余0、除以7余2；</p><p>那么令 <img src="https://www.zhihu.com/equation?tex=x%3D+x_1%2Bx_2%2Bx_3" alt="x= x_1+x_2+x_3" eeimg="1"> ，就很容易验证这时的 <img src="https://www.zhihu.com/equation?tex=x" alt="x" eeimg="1"> 就满足除以3余2、除以5余3、除以7余2。</p><p>分别称找到整数 <img src="https://www.zhihu.com/equation?tex=x_1%2Cx_2%2Cx_3" alt="x_1,x_2,x_3" eeimg="1"> 的问题为<b>问题1-1</b>、<b>问题1-2</b>、<b>问题1-3</b>。可以看出这三个问题本质上是类似的。</p><p>下面对<b>问题1-1</b>继续分解，如果能够找到一个整数 <img src="https://www.zhihu.com/equation?tex=y_1" alt="y_1" eeimg="1"> 满足 <img src="https://www.zhihu.com/equation?tex=y_1" alt="y_1" eeimg="1"> 除以3余1、除以5余0、除以7余0，那么令 <img src="https://www.zhihu.com/equation?tex=x_1%3D+2%5Ctimes+y_1" alt="x_1= 2\times y_1" eeimg="1"> ，就很容易验证这时的 <img src="https://www.zhihu.com/equation?tex=x_1" alt="x_1" eeimg="1"> 就满足除以3余2、除以5余0、除以7余0。</p><p>因此定义</p><p><b>问题1-1-1</b>为：寻找整数 <img src="https://www.zhihu.com/equation?tex=y_1" alt="y_1" eeimg="1"> 满足 <img src="https://www.zhihu.com/equation?tex=y_1" alt="y_1" eeimg="1"> 除以3余1、除以5余0、除以7余0；</p><p><b>问题1-2-1</b>为：寻找整数 <img src="https://www.zhihu.com/equation?tex=y_2" alt="y_2" eeimg="1"> 满足 <img src="https://www.zhihu.com/equation?tex=y_2" alt="y_2" eeimg="1"> 除以3余0、除以5余1、除以7余0；</p><p><b>问题1-3-1</b>为：寻找整数 <img src="https://www.zhihu.com/equation?tex=y_3" alt="y_3" eeimg="1"> 满足 <img src="https://www.zhihu.com/equation?tex=y_3" alt="y_3" eeimg="1"> 除以3余0、除以5余0、除以7余1。</p><p>这三个问题本质上是相同的。</p><p>如果找到了 <img src="https://www.zhihu.com/equation?tex=y_1%2Cy_2%2Cy_3" alt="y_1,y_2,y_3" eeimg="1"> ，那么就可以取 <img src="https://www.zhihu.com/equation?tex=x%3D2%5Ctimes+y_1%2B3%5Ctimes+y_2%2B2%5Ctimes+y_3" alt="x=2\times y_1+3\times y_2+2\times y_3" eeimg="1"> 。</p><hr><p>下面就以<b>问题1-1-1</b>为例：寻找整数 <img src="https://www.zhihu.com/equation?tex=z" alt="z" eeimg="1"> 使得 <img src="https://www.zhihu.com/equation?tex=z" alt="z" eeimg="1"> 除以3余1、除以5余0、除以7余0。</p><p>于是 <img src="https://www.zhihu.com/equation?tex=z" alt="z" eeimg="1"> 一定是 <img src="https://www.zhihu.com/equation?tex=5%5Ctimes7%3D35" alt="5\times7=35" eeimg="1"> 的倍数，假设 <img src="https://www.zhihu.com/equation?tex=z%3D35k" alt="z=35k" eeimg="1"> 。</p><p>那么就有 <img src="https://www.zhihu.com/equation?tex=35k%5Cequiv+1%5Cpmod+3" alt="35k\equiv 1\pmod 3" eeimg="1"> ，而这时的 <img src="https://www.zhihu.com/equation?tex=k" alt="k" eeimg="1"> 就是 <img src="https://www.zhihu.com/equation?tex=5%5Ctimes7" alt="5\times7" eeimg="1"> 模3的逆（参看“<a href="https://zhuanlan.zhihu.com/p/44523169" class="internal">5÷2=6？——是的，模7意义下</a>”），将这个 <img src="https://www.zhihu.com/equation?tex=k" alt="k" eeimg="1"> 记作 <img src="https://www.zhihu.com/equation?tex=%5Cleft%5B+35%5E%7B-1%7D+%5Cright%5D_%7B3%7D" alt="\left[ 35^{-1} \right]_{3}" eeimg="1"> ，那么 <img src="https://www.zhihu.com/equation?tex=z" alt="z" eeimg="1"> 就等于 <img src="https://www.zhihu.com/equation?tex=5%5Ctimes7%5Ctimes%5Cleft%5B+%5Cleft%28+5%5Ctimes7+%5Cright%29%5E%7B-1%7D+%5Cright%5D_%7B3%7D" alt="5\times7\times\left[ \left( 5\times7 \right)^{-1} \right]_{3}" eeimg="1"> ，恰好就是 <img src="https://www.zhihu.com/equation?tex=5%5Ctimes7%5Ctimes2%3D70" alt="5\times7\times2=70" eeimg="1"> ，对应“凡三三数之剩一，则置七十”一句及“三人同行七十稀”一句。</p><p>于是类推得到，</p><p><b>问题1-1-2</b>的解答是 <img src="https://www.zhihu.com/equation?tex=3%5Ctimes7%5Ctimes%5Cleft%5B+%5Cleft%28+3%5Ctimes7+%5Cright%29%5E%7B-1%7D+%5Cright%5D_%7B5%7D" alt="3\times7\times\left[ \left( 3\times7 \right)^{-1} \right]_{5}" eeimg="1"> ，恰好就是 <img src="https://www.zhihu.com/equation?tex=3%5Ctimes7%5Ctimes1%3D21" alt="3\times7\times1=21" eeimg="1"> ，对应“五五数之剩一，则置二十一”一句及“五树梅花廿一枝”一句；</p><p><b>问题1-1-3</b>的解答是 <img src="https://www.zhihu.com/equation?tex=3%5Ctimes5%5Ctimes%5Cleft%5B+%5Cleft%28+3%5Ctimes5+%5Cright%29%5E%7B-1%7D+%5Cright%5D_%7B7%7D" alt="3\times5\times\left[ \left( 3\times5 \right)^{-1} \right]_{7}" eeimg="1"> ，恰好就是 <img src="https://www.zhihu.com/equation?tex=3%5Ctimes5%5Ctimes1%3D15" alt="3\times5\times1=15" eeimg="1"> ，对应“七七数之剩一，则置十五”一句及“七子团圆月正半”一句。</p><p>所以将分解的问题复原，可得：</p><p><img src="https://www.zhihu.com/equation?tex=x%3D2%5Ctimes%5Cleft%28+5%5Ctimes7%5Ctimes%5Cleft%5B+%5Cleft%28+5%5Ctimes7+%5Cright%29%5E%7B-1%7D+%5Cright%5D_%7B3%7D+%5Cright%29%2B3%5Ctimes+%5Cleft%283%5Ctimes7%5Ctimes%5Cleft%5B+%5Cleft%28+3%5Ctimes7+%5Cright%29%5E%7B-1%7D+%5Cright%5D_%7B5%7D+%5Cright%29%2B2%5Ctimes+%5Cleft%28+3%5Ctimes5%5Ctimes%5Cleft%5B+%5Cleft%28+3%5Ctimes5+%5Cright%29%5E%7B-1%7D+%5Cright%5D_%7B7%7D+%5Cright%29" alt="x=2\times\left( 5\times7\times\left[ \left( 5\times7 \right)^{-1} \right]_{3} \right)+3\times \left(3\times7\times\left[ \left( 3\times7 \right)^{-1} \right]_{5} \right)+2\times \left( 3\times5\times\left[ \left( 3\times5 \right)^{-1} \right]_{7} \right)" eeimg="1"> 。</p><p>最后 ，注意到，如果 <img src="https://www.zhihu.com/equation?tex=x" alt="x" eeimg="1"> 满足除以3余2、除以5余3、除以7余2，那么 <img src="https://www.zhihu.com/equation?tex=x%2B3%5Ctimes5%5Ctimes7" alt="x+3\times5\times7" eeimg="1"> 也同样满足。</p><p>因此要计算满足要求的最小的非负整数，就只需要计算总和除以105的余数即可。——对应“除百零五便得知”一句。</p><hr><p>下面要讨论的是：如果有多个满足要求的整数，那么<b>它们之间有什么关系</b>呢？</p><p>假设 <img src="https://www.zhihu.com/equation?tex=X%2CY" alt="X,Y" eeimg="1"> 都满足“除以3余a、除以5余b、除以7余c”。</p><p>观察 <img src="https://www.zhihu.com/equation?tex=X-Y" alt="X-Y" eeimg="1"> 会发现， <img src="https://www.zhihu.com/equation?tex=X-Y" alt="X-Y" eeimg="1"> 满足“除以3余0、除以5余0、除以7余0”。因此 <img src="https://www.zhihu.com/equation?tex=X-Y" alt="X-Y" eeimg="1"> 一定是 <img src="https://www.zhihu.com/equation?tex=3%5Ctimes5%5Ctimes7%3D105" alt="3\times5\times7=105" eeimg="1"> 的倍数。</p><p>这也就是说，在“模105同余”的意义下，之前通过分解问题、组合解答的方法所得到的 <img src="https://www.zhihu.com/equation?tex=x" alt="x" eeimg="1"> 恰恰就是<b>唯一解</b>。</p><hr><p>下面把这个问题一般化：假设整数 <img src="https://www.zhihu.com/equation?tex=m_1%2Cm_2%2C+...+%2Cm_n" alt="m_1,m_2, ... ,m_n" eeimg="1"> 两两互素，则对于任意的整数 <img src="https://www.zhihu.com/equation?tex=a_1%2Ca_2%2C+...+%2Ca_n" alt="a_1,a_2, ... ,a_n" eeimg="1"> ，方程组</p><p><img src="https://www.zhihu.com/equation?tex=++++++%5Cbegin%7Bequation%7D+++++%5Cbegin%7Bcases%7D+++++x%5Cequiv+a_1%5Cpmod+%7Bm_1%7D%5C%5C+++++x%5Cequiv+a_2%5Cpmod+%7Bm_2%7D%5C%5C+++++%5Ccdots+%5C%5C+++++x%5Cequiv+a_n%5Cpmod+%7Bm_n%7D%5C%5C+++++%5Cend%7Bcases%7D+++++%5Cend%7Bequation%7D" alt="      \begin{equation}     \begin{cases}     x\equiv a_1\pmod {m_1}\\     x\equiv a_2\pmod {m_2}\\     \cdots \\     x\equiv a_n\pmod {m_n}\\     \end{cases}     \end{equation}" eeimg="1"> </p><p>都存在整数解，且若<img src="https://www.zhihu.com/equation?tex=X%2CY" alt="X,Y" eeimg="1"> 都满足该方程组，则必有 <img src="https://www.zhihu.com/equation?tex=X%5Cequiv+Y%5Cpmod+N" alt="X\equiv Y\pmod N" eeimg="1"> ，其中 <img src="https://www.zhihu.com/equation?tex=N%3D%5Cprod_%7Bi%3D1%7D%5E%7Bn%7Dm_i" alt="N=\prod_{i=1}^{n}m_i" eeimg="1"> 。</p><p>具体而言， <img src="https://www.zhihu.com/equation?tex=x%5Cequiv%5Csum_%7Bi%3D1%7D%5E%7Bn%7D%7Ba_i%5Ctimes%5Cfrac%7BN%7D%7Bm_i%7D%5Ctimes%5Cleft%5B+%5Cleft%28+%5Cfrac%7BN%7D%7Bm_i%7D+%5Cright%29%5E%7B-1%7D+%5Cright%5D_%7Bm_i%7D%7D%5Cpmod+N" alt="x\equiv\sum_{i=1}^{n}{a_i\times\frac{N}{m_i}\times\left[ \left( \frac{N}{m_i} \right)^{-1} \right]_{m_i}}\pmod N" eeimg="1"> 。</p><p>——这就是我非常看重和喜欢的<b>中国剩余定理(Chinese remainder theorem, CRT)</b>。</p><hr><p>最后，中国剩余定理有<b>很多重要</b>的应用！我将在后续文章里慢慢介绍。</p>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
