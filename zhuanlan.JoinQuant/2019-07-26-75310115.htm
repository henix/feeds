<div class="title-image"><img src="https://pic1.zhimg.com/v2-c84ee2b770ce13fefc66f5eb7e4eb9bb_b.jpg" alt=""></div><p></p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-eca987e734abb9dfc541c5eabfa65e14_b.gif" data-caption="" data-size="normal" data-rawwidth="900" data-rawheight="200" data-thumbnail="https://pic1.zhimg.com/v2-eca987e734abb9dfc541c5eabfa65e14_b.jpg" class="origin_image zh-lightbox-thumb" width="900" data-original="https://pic1.zhimg.com/v2-eca987e734abb9dfc541c5eabfa65e14_r.jpg"/></noscript><img src="https://pic1.zhimg.com/v2-eca987e734abb9dfc541c5eabfa65e14_b.gif" data-caption="" data-size="normal" data-rawwidth="900" data-rawheight="200" data-thumbnail="https://pic1.zhimg.com/v2-eca987e734abb9dfc541c5eabfa65e14_b.jpg" class="origin_image zh-lightbox-thumb lazy" width="900" data-original="https://pic1.zhimg.com/v2-eca987e734abb9dfc541c5eabfa65e14_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-eca987e734abb9dfc541c5eabfa65e14_b.gif"/></figure><p class="ztext-empty-paragraph"><br/></p><p class="ztext-empty-paragraph"><br/></p><p><b>未经授权，严禁转载</b></p><h2><b>引言</b></h2><h3><b>&gt;&gt;&gt; 研究目的</b></h3><p>本文参考东吴证券研报《“订单簿的温度”系列研究（一）：反转因子的精细结构》，根据研报分析，A股市场是订单驱动型市场。从动力学的角度讲，股票行情的所有演化过程，都能由订单簿（orderbook）自下而上精确决定。逐笔成交与逐笔委托数据的信息量非常丰富。</p><p>本篇报告我们从最简单的数据入手，考察了“成交笔数”这个指标。所谓成交笔数，即撮合交易的次数，是从逐笔成交数据中汇总出来的统计量借助成交笔数的信息，对传统反转因子进行切割，首次提出一个理想反转因子, 实现对未来收益的预测，为订单簿因子挖掘提供了一定思路。<br/></p><h3><b>&gt;&gt;&gt; 研究内容</b></h3><p>（1）研究在订单簿数据中挖掘alpha因子，考虑到传统反转因子在稳定性上的困难，本文认为传统反转因子存在动量效应与反转效应，因此借助单笔成交金额信息用于实现W切割，切割后形成的新因子称为理想反转因子。</p><p>（2）针对全A股数据，对理想反转因子进行单因子有效性测试，分别从因子有效性显著性检验、因子IC分析以及分层回测这三个角度分析因子有效性。</p><p>（3）进一步分析理想反转因子，分别就参数N的取值、样本空间的选择、因子收益的累积以及分组比例这四个角度对理想反转因子进行分析。</p><p class="ztext-empty-paragraph"><br/></p><h3><b>&gt;&gt;&gt; 研究结论</b></h3><p>（1）对理想反转因子进行单因子有效性分析，根据因子收益率显著性检验结果t值绝对值序列的均值为 3.96，因子IC分析结果为 ，IC序列均值为 0.0492，IR值为 0.54，分层回测结果如下：组合1能够明显跑赢组合5，且每个组合都能够跑赢HS300指数，且组合1能够吗明显获得更高的收益。</p><p>（2）对理想反转因子进行深入分析，当N分别取 20、40、60 时，IC分析结果同样效果出色，但是相对而言，随着N取值越大，因子有效性不断降低，可见合理选择N的取值有利于获取对预测未来收益更为有效性的因子。</p><p>（3）针对HS300股票池，理想反转因子的五分组多空对冲总收益为 47.74%，年化波动31.38%，夏普比率为0.314，最大回撤为9.69%；原始反转因子Ret20的五分组多空对冲总收益为16.22%，年化波动53.88%，夏普比率为 -0.016，最大回撤为20.88%。</p><p>（4）由于多空组合收益累积过程比较均匀，因此可以尝试做周频调仓或半月调仓。针对N=60的情况，当高D组的分组比例X取值在25 - 50 之间时，均能够取得较好的结果，当X为42时，IC值能够获得最大值。</p><p class="ztext-empty-paragraph"><br/></p><h2><b>实证分析</b></h2><p class="ztext-empty-paragraph"><br/></p><p><b>1. 数据准备</b></p><p><b>1.1 日期列表获取</b></p><p>在每个月的月末对因子数据进行提取，因此需要对每个月的月末日期进行统计。</p><p>输入参数分别为peroid、start_date和 end_date，其中peroid 进行周期选择，可选周期为周(W)、月(M)和季(Q)，start_date和end_date分别为开始日期和结束日期。</p><p>函数返回值为对应的月末日期。本文选取开始日期为2013.1.1，结束日期为2018.1.1。</p><p class="ztext-empty-paragraph"><br/></p><p><b>1.2 股票列表获取</b></p><p>股票池: 全A股</p><p><br/>股票筛选：剔除ST股票，剔除上市3个月内的股票，每只股票视作一个样本</p><p><br/>取2016-08-31当天的股票成分股</p><p class="ztext-empty-paragraph"><br/></p><p><b>1.3 数据获取</b></p><p>具体因子的计算步骤如下所示：</p><p>（1）在每个月底，对于股票s回溯其过去N个交易日的数据（为方便处理，N取偶数）；</p><p><br/>（2）对于股票s逐日计算平均单笔成交金额D（D 当日成交金额 当日成交笔数），将N个交易日按D值从大到小排序，前N/2个交易日称为高D组，后N/2个交易日称为低D组；</p><p><br/>（3）对于股票 s ，将高D组交易日的涨跌幅加总，得到因子M_high；将低D组交易日的涨跌幅加总，得到因子M_low；</p><p><br/>（4）对于所有股票，分别按照上述流程计算因子值。</p><p><br/>反转因子的计算公式如下所示：</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-b0005ba46fa4ca739dda47af35da90c0_b.jpg" data-caption="" data-size="normal" data-rawwidth="227" data-rawheight="37" class="content_image" width="227"/></noscript><img src="https://pic1.zhimg.com/v2-b0005ba46fa4ca739dda47af35da90c0_b.jpg" data-caption="" data-size="normal" data-rawwidth="227" data-rawheight="37" class="content_image lazy" width="227" data-actualsrc="https://pic1.zhimg.com/v2-b0005ba46fa4ca739dda47af35da90c0_b.jpg"/></figure><p class="ztext-empty-paragraph"><br/></p><p><b>2. 单因子有效性分析</b></p><p class="ztext-empty-paragraph"><br/></p><p><b>2.1 因子收益率显著性检验</b></p><p>主要通过T检验分析，根据APT模型，对历史数据进行进行多元线性回归，从而得到需要分析的因子收益率的t值，然后进行以下两个方面的分析：</p><p>（1）t 值绝对值序列的均值: 之所以要取绝对值，是因为只要t值显著不等于0即可以认为在当期，因子和收益率存在明显的相关性。但是这种相关性有的时候为正，有的时候为负，如果不取绝对值，则很多正负抵消，会低估因子的有效性;</p><p>（2）t值绝对值序列大于2的比例: 检验|t|&gt;2 的比例主要是为了保证|t|平均值的稳定性， 避免出现少数数值特别大的样本值拉高均值。</p><p>根据上面结果分析，t值绝对值序列的均值为3.96，符合大于2的特征，且t值绝对值序列大于2的比例为59.27%，根据因子收益率显著性检验的标准，该因子为有效因子。</p><p class="ztext-empty-paragraph"><br/></p><p><b>2.2 因子 IC 分析</b></p><p>因子k的IC值一般是指个股第T期在因子k上的暴露度与T+1期的收益率的相关系数。当得到因子IC值序列后，我们可以仿照上一小节t检验的分析方法进行计算:</p><p>（1）IC值序列的均值及绝对值均值: 判断因子有效性;</p><p><br/>（2）IC值序列的标准差:判断因子稳定性;</p><p><br/>（3）IC值系列的均值与标准差比值（IR）：分析分析有效性</p><p><br/>（4）IC值序列大于零(或小于零)的占比：判断因子效果的一致性。</p><p>由上可知，IC序列均值为0.0492，IR值为0.54，IC值序列大于0占比为65%，由这几个指标可以看出，该因子收益预测稳定性较高，符合因子IC分析的筛选条件，判断该因子为有效因子。</p><p class="ztext-empty-paragraph"><br/></p><p><b>2.3 分层回测</b></p><p><b>策略步骤：</b></p><p>（1）在每个月最后一个交易日，统计全A股反转因子值（M）的值；</p><p><br/>（2）根据反转因子（M）值按照从小到大的顺序排序，并将其等分为5组</p><p><br/>（3）每个调仓日对每组股票池进行调仓交易，从而获得5组股票组合的收益曲线</p><p>评价方法: 回测年化收益率、夏普比率、最大回撤、胜率等。</p><p class="ztext-empty-paragraph"><br/></p><p><b>2.3.1 分层回测策略模型收益指标</b></p><p><b>2.3.2 分层回测净值</b></p><p>为了进一步更直观的对5个组合进行分析，绘制了5个组合及HS300基准的净值收益曲线，具体下图所示。</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-27f0f9d4b1cda352506898983701df79_b.jpg" data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="423" class="origin_image zh-lightbox-thumb" width="1080" data-original="https://pic2.zhimg.com/v2-27f0f9d4b1cda352506898983701df79_r.jpg"/></noscript><img src="https://pic2.zhimg.com/v2-27f0f9d4b1cda352506898983701df79_b.jpg" data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="423" class="origin_image zh-lightbox-thumb lazy" width="1080" data-original="https://pic2.zhimg.com/v2-27f0f9d4b1cda352506898983701df79_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-27f0f9d4b1cda352506898983701df79_b.jpg"/></figure><p>由图可以看出，组合1能够明显跑赢组合5，且每个组合都能够跑赢HS300指数，且组合1能够吗明显获得更高的收益。可见符合单因子有效性的检验，即证明反转因子是有效的。</p><p class="ztext-empty-paragraph"><br/></p><p><b>2.3.3 模型策略组合回测分析表</b></p><b><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-579fa59cbd763437df703e38668bb4ab_b.jpg" data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="388" class="origin_image zh-lightbox-thumb" width="1080" data-original="https://pic4.zhimg.com/v2-579fa59cbd763437df703e38668bb4ab_r.jpg"/></noscript><img src="https://pic4.zhimg.com/v2-579fa59cbd763437df703e38668bb4ab_b.jpg" data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="388" class="origin_image zh-lightbox-thumb lazy" width="1080" data-original="https://pic4.zhimg.com/v2-579fa59cbd763437df703e38668bb4ab_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-579fa59cbd763437df703e38668bb4ab_b.jpg"/></figure></b><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-3e3e9b0b878b8f88145ddc1a60569a5a_b.jpg" data-caption="" data-size="normal" data-rawwidth="535" data-rawheight="209" class="origin_image zh-lightbox-thumb" width="535" data-original="https://pic3.zhimg.com/v2-3e3e9b0b878b8f88145ddc1a60569a5a_r.jpg"/></noscript><img src="https://pic3.zhimg.com/v2-3e3e9b0b878b8f88145ddc1a60569a5a_b.jpg" data-caption="" data-size="normal" data-rawwidth="535" data-rawheight="209" class="origin_image zh-lightbox-thumb lazy" width="535" data-original="https://pic3.zhimg.com/v2-3e3e9b0b878b8f88145ddc1a60569a5a_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-3e3e9b0b878b8f88145ddc1a60569a5a_b.jpg"/></figure><p>从5组的具体绩效分析来看，年化收益率以及夏普比率基本呈现出单调的走势，组合1的效果远远优于组合5，且最大回撤也体现出组合1的风险控制能力更强。从各年的收益来看，组合1至组合5每一年基本上也呈现出单调的走势，可见因子在每一年都具有较好的选股效果，体现出因子有效性的稳定性。</p><p class="ztext-empty-paragraph"><br/></p><p><b>2.3.4 多空组合净值</b></p><p>从分层组合回测净值曲线图来看，每个组合波动性较大，策略存在较大的风险，因此考虑建立多空组合。多空组合是买入组合1、卖空组合5(月度调仓)的一个资产组合，为了方便统计，多空组合每日收益率为（组合1每日收益率 - 组合5每日收益率）/2，然后获得多空组合的净值收益曲线。</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-2c3ca7a548c8063fd12672942d303c15_b.jpg" data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="430" class="origin_image zh-lightbox-thumb" width="1080" data-original="https://pic2.zhimg.com/v2-2c3ca7a548c8063fd12672942d303c15_r.jpg"/></noscript><img src="https://pic2.zhimg.com/v2-2c3ca7a548c8063fd12672942d303c15_b.jpg" data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="430" class="origin_image zh-lightbox-thumb lazy" width="1080" data-original="https://pic2.zhimg.com/v2-2c3ca7a548c8063fd12672942d303c15_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-2c3ca7a548c8063fd12672942d303c15_b.jpg"/></figure><p><br/>如图所示，多空组合净值收益曲线明显比任何一个组合的波动性更低，能够获得更为稳定的收益，风险控制效果较好。</p><p><br/>综上所述，从分层回测的分析来看，反转因子（M）有效性较强。</p><p class="ztext-empty-paragraph"><br/></p><p><b>3. 深入分析</b></p><p><b>3.1 参数 N 的敏感度</b></p><p>本文选择过去N（N=20） 天的数据用于计算反转因子，但是参数N的选择对因子有效性的影响仍然不是非常清晰，因此接下来针对参数N的不同选择，对因子有效性进行分析。具体分析过程如下所示。</p><p>当N分别取 20、40、60 时，IC分析结果同样效果出色，但是相对而言，随着N取值越大，因子有效性不断降低，可见合理选择N的取值有利于获取对预测未来收益更为有效性的因子。</p><p>根据上述分析结果，当N=20 时，因子有效性最高。</p><p class="ztext-empty-paragraph"><br/></p><p><b>3.2 其他样本空间的测试</b></p><p>本文进行了理想反转因子在全A股的测试，为了进一步证明因子的有效性，在其他样本空间，对该因子进行分析，针对五分组的情况构建多空组合，分析理想反转因子与原始反转因子Ret20之间的区别。</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-bdfc1d2581057ed262ce22ae578a9f80_b.jpg" data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="457" class="origin_image zh-lightbox-thumb" width="1080" data-original="https://pic1.zhimg.com/v2-bdfc1d2581057ed262ce22ae578a9f80_r.jpg"/></noscript><img src="https://pic1.zhimg.com/v2-bdfc1d2581057ed262ce22ae578a9f80_b.jpg" data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="457" class="origin_image zh-lightbox-thumb lazy" width="1080" data-original="https://pic1.zhimg.com/v2-bdfc1d2581057ed262ce22ae578a9f80_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-bdfc1d2581057ed262ce22ae578a9f80_b.jpg"/></figure><p>原始反转因子Ret20与理想反转因子的五分组多空对冲净值走势如下所示。理想反转因子的五分组多空对冲总收益为47.74%，年化波动31.38%，夏普比率为0.314，最大回撤为9.69%；原始反转因子 Ret20 的五分组多空对冲总收益为16.22%，年化波动53.88%，夏普比率为-0.016，最大回撤为20.88%。</p><p class="ztext-empty-paragraph"><br/></p><p><b>3.3 因子收益的累积过程</b></p><p>在本报告中，因子回测均采用月频调仓，但是更高频率的调仓可能也会有需求，针对该情况，本文进行因子收益的累积计算，分别计算从调仓日开始，第一个交易日至第二十个交易日多空组合的累积收益。</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-1c21c2d744ffb7b5b0107806c961ccec_b.jpg" data-caption="" data-size="normal" data-rawwidth="494" data-rawheight="330" class="origin_image zh-lightbox-thumb" width="494" data-original="https://pic1.zhimg.com/v2-1c21c2d744ffb7b5b0107806c961ccec_r.jpg"/></noscript><img src="https://pic1.zhimg.com/v2-1c21c2d744ffb7b5b0107806c961ccec_b.jpg" data-caption="" data-size="normal" data-rawwidth="494" data-rawheight="330" class="origin_image zh-lightbox-thumb lazy" width="494" data-original="https://pic1.zhimg.com/v2-1c21c2d744ffb7b5b0107806c961ccec_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-1c21c2d744ffb7b5b0107806c961ccec_b.jpg"/></figure><p>如上图所示，展示了N=20时理想反转因子在月初建仓后(全市场股票、分五组)，多空对冲收益的累积过程。由于收益累积过程比较均匀，我们定性地判断，可以尝试做周频调仓或半月调仓。</p><p class="ztext-empty-paragraph"><br/></p><p><b>3.4 分组比例的影响</b></p><p>在本文中，高D组与低D组的交易日各占回溯交易日的一半，也即N/2 个。如果调整分组的比例，效果会有多大的区别呢?</p><p><br/>接下来以N=60为例，将单笔成交金额大的X个交易日作为高D组，将剩余60-X 个交易日作为低D组，遍历X的值，分别计算M因子的信息比率（IR）</p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-a42a421fcb2ae78ea7406a72c51751cb_b.jpg" data-caption="" data-size="normal" data-rawwidth="493" data-rawheight="330" class="origin_image zh-lightbox-thumb" width="493" data-original="https://pic4.zhimg.com/v2-a42a421fcb2ae78ea7406a72c51751cb_r.jpg"/></noscript><img src="https://pic4.zhimg.com/v2-a42a421fcb2ae78ea7406a72c51751cb_b.jpg" data-caption="" data-size="normal" data-rawwidth="493" data-rawheight="330" class="origin_image zh-lightbox-thumb lazy" width="493" data-original="https://pic4.zhimg.com/v2-a42a421fcb2ae78ea7406a72c51751cb_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-a42a421fcb2ae78ea7406a72c51751cb_b.jpg"/></figure><p>结果如上图所示。从图中可以发现，当X取值在25-50之间时，均能够取得较好的结果，当X为42时，IC值能够获得最大值。</p><h2><b>总结</b></h2><p>以上我们对理想反转因子进行了有效性分析的具体测试，初步得到以下几个结论:</p><p><br/>（1）对理想反转因子进行单因子有效性分析，根据因子收益率显著性检验结果t值绝对值序列的均值为3.96，因子IC分析结果为IC序列均值为0.0492，IR值为0.54，分层回测结果如下：组合1能够明显跑赢组合5，且每个组合都能够跑赢HS300指数，且组合1能够吗明显获得更高的收益。</p><p><br/>（2）对理想反转因子进行深入分析，当N分别取20、40、60时，IC分析结果同样效果出色，但是相对而言，随着N取值越大，因子有效性不断降低，可见合理选择N的取值有利于获取对预测未来收益更为有效性的因子。</p><p><br/>（3）针对HS300股票池，理想反转因子的五分组多空对冲总收益为47.74%，年化波动31.38%，夏普比率为0.314，最大回撤为9.69%；原始反转因子Ret20的五分组多空对冲总收益为16.22%，年化波动53.88%，夏普比率为-0.016，最大回撤为20.88%。</p><p><br/>（4）由于多空组合收益累积过程比较均匀，因此可以尝试做周频调仓或半月调仓。针对N=60的情况，当高D组的分组比例X取值在25 - 50之间时，均能够取得较好的结果，当X为42时，IC值能够获得最大值。</p><p><br/>（5）为挖掘订单簿信息提供了一定思路，给高频交易数据的挖掘提供一定参考价值。</p><p>点击<a href="https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s/bME3JPhd9msvQnErFKIrBw" class=" wrap external" target="_blank" rel="nofollow noreferrer">【阅读原文】</a>，查看源代码及更多内容~</p>