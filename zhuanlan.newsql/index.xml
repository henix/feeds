<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:media="http://search.yahoo.com/mrss/">
<channel>
<title>TiDB çš„åèŠ±å›­</title>
<link>https://henix.github.io/feeds/zhuanlan.newsql/</link>
<description></description>
<language>zh-cn</language>
<lastBuildDate>Fri, 13 Dec 2019 03:47:21 +0800</lastBuildDate>
<item>
<title>TiKV æºç è§£æç³»åˆ—æ–‡ç« ï¼ˆåå…­ï¼‰TiKV Coprocessor Executor æºç è§£æ</title>
<link>https://henix.github.io/feeds/zhuanlan.newsql/2019-12-12-96906129.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/96906129&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-88d254931476b5e8cedbb60207b79334_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;ä½œè€…ï¼šé‚“åŠ›é“­&lt;/p&gt;&lt;p&gt;åœ¨å‰ä¸¤ç¯‡æ–‡ç«  &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s/cdC7f9N9C88MJ_syNUg21g&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TiKV æºç è§£æç³»åˆ—æ–‡ç« ï¼ˆåå››ï¼‰Coprocessor æ¦‚è§ˆ&lt;/a&gt;ã€&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s/UYcny9G5snh-MoMFm2qxsw&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TiKV æºç è§£æç³»åˆ—æ–‡ç« ï¼ˆåäº”ï¼‰è¡¨è¾¾å¼è®¡ç®—æ¡†æ¶ä¸­&lt;/a&gt;ï¼Œè®²åˆ°äº† TiDB ä¸ºäº†æœ€å¤§åŒ–åˆ©ç”¨åˆ†å¸ƒå¼è®¡ç®—èƒ½åŠ›ï¼Œä¼šå°½é‡å°† Selection ç®—å­ã€Aggregation ç®—å­ç­‰ç®—å­ä¸‹æ¨åˆ° TiKV èŠ‚ç‚¹ä¸Šï¼Œä»¥åŠä¸‹æ¨çš„è¡¨è¾¾å¼æ˜¯å¦‚ä½•åœ¨ TiKV ä¸Šåšè®¡ç®—çš„ã€‚æœ¬æ–‡å°†åœ¨å‰ä¸¤ç¯‡æ–‡ç« çš„åŸºç¡€ä¸Šï¼Œä»‹ç»ä¸‹æ¨ç®—å­çš„æ‰§è¡Œæµç¨‹å¹¶åˆ†æä¸‹æ¨ç®—å­çš„éƒ¨åˆ†å®ç°ç»†èŠ‚ï¼ŒåŠ æ·±å¤§å®¶å¯¹ TiKV Coprocessor çš„ç†è§£ã€‚&lt;/p&gt;&lt;h2&gt;ä»€ä¹ˆæ˜¯ä¸‹æ¨ç®—å­&lt;/h2&gt;&lt;p&gt;ä»¥ä¸‹è¾¹çš„ &lt;code&gt;SQL&lt;/code&gt; ä¸ºä¾‹å­ï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;select  *  from students where age &amp;gt;  21  limit  2&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;TiDB åœ¨è§£æå®Œè¿™æ¡ &lt;code&gt;SQL&lt;/code&gt; è¯­å¥ä¹‹åï¼Œä¼šå¼€å§‹åˆ¶å®šæ‰§è¡Œè®¡åˆ’ã€‚åœ¨è¿™ä¸ªè¯­å¥ä¸­ï¼Œ TiDB ä¼šå‘ TiKV ä¸‹æ¨ä¸€ä¸ªå¯ä»¥ç”¨æœ‰å‘æ— ç¯å›¾ï¼ˆDAGï¼‰æ¥æè¿°çš„æŸ¥è¯¢è¯·æ±‚ï¼š&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-2aab23543ed86a6d8b6c487ae71fbe15_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;818&quot; data-rawheight=&quot;279&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;818&quot; data-original=&quot;https://pic2.zhimg.com/v2-2aab23543ed86a6d8b6c487ae71fbe15_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-2aab23543ed86a6d8b6c487ae71fbe15_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;818&quot; data-rawheight=&quot;279&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;818&quot; data-original=&quot;https://pic2.zhimg.com/v2-2aab23543ed86a6d8b6c487ae71fbe15_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-2aab23543ed86a6d8b6c487ae71fbe15_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;ä»¥ä¸Šçš„ &lt;code&gt;DAG&lt;/code&gt; æ˜¯ä¸€ä¸ªç”±ä¸€ç³»åˆ—ç®—å­ç»„æˆçš„æœ‰å‘æ— ç¯å›¾ï¼Œç®—å­åœ¨ TiKV ä¸­ç§°ä¸º &lt;code&gt;Executor&lt;/code&gt; ã€‚æ•´ä¸ª &lt;code&gt;DAG&lt;/code&gt; æè¿°äº†æŸ¥è¯¢è®¡åˆ’åœ¨ TiKV çš„æ‰§è¡Œè¿‡ç¨‹ã€‚åœ¨ä¸Šè¾¹çš„ä¾‹å­ä¸­ï¼Œä¸€æ¡æŸ¥è¯¢ &lt;code&gt;SQL&lt;/code&gt; è¢«ç¿»è¯‘æˆäº†ä¸‰ä¸ªæ‰§è¡Œæ­¥éª¤ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;æ‰«è¡¨&lt;/li&gt;&lt;li&gt;é€‰æ‹©è¿‡æ»¤&lt;/li&gt;&lt;li&gt;å–è‹¥å¹²è¡Œ&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;æœ‰äº†åŸºæœ¬æ¦‚å¿µåï¼Œä¸‹é¢æˆ‘ä»¬ç®€å•ä»‹ç»ä¸€ä¸‹è¿™æ ·çš„æŸ¥è¯¢è®¡åˆ’åœ¨ TiKV å†…éƒ¨çš„ä¸€ä¸ªæ‰§è¡Œæµç¨‹ã€‚&lt;/p&gt;&lt;h2&gt;ä¸‹æ¨ç®—å­å¦‚ä½•æ‰§è¡Œ&lt;/h2&gt;&lt;h3&gt;ç»•ä¸å¼€çš„ç«å±±&lt;/h3&gt;&lt;p&gt;TiKV æ‰§è¡Œå™¨æ˜¯åŸºäº Volcano Model ï¼ˆç«å±±æ¨¡å‹ï¼‰ï¼Œä¸€ç§ç»å…¸çš„åŸºäºè¡Œçš„æµå¼è¿­ä»£æ¨¡å‹ã€‚ç°åœ¨ä¸»æµçš„å…³ç³»å‹æ•°æ®åº“éƒ½é‡‡ç”¨äº†è¿™ç§æ¨¡å‹ï¼Œä¾‹å¦‚ Oracleï¼ŒMySQL ç­‰ã€‚&lt;/p&gt;&lt;p&gt;æˆ‘ä»¬å¯ä»¥æŠŠæ¯ä¸ªç®—å­çœ‹æˆä¸€ä¸ªè¿­ä»£å™¨ã€‚æ¯æ¬¡è°ƒç”¨å®ƒçš„ &lt;code&gt;next()&lt;/code&gt; æ–¹æ³•ï¼Œæˆ‘ä»¬å°±å¯ä»¥è·å¾—ä¸€è¡Œï¼Œç„¶åå‘ä¸Šè¿”å›ã€‚è€Œæ¯ä¸ªç®—å­éƒ½æŠŠä¸‹å±‚ç®—å­çœ‹æˆä¸€å¼ è¡¨ï¼Œè¿”å›å“ªäº›è¡Œï¼Œè¿”å›æ€ä¹ˆæ ·çš„è¡Œç”±ç®—å­æœ¬èº«å†³å®šã€‚ä¸¾ä¸ªä¾‹å­ï¼š&lt;/p&gt;&lt;p&gt;å‡è®¾æˆ‘ä»¬ç°åœ¨å¯¹ä¸€å¼ æ²¡æœ‰ä¸»é”®ï¼Œæ²¡æœ‰ç´¢å¼•çš„è¡¨ &lt;code&gt;[1]&lt;/code&gt; ï¼Œæ‰§è¡Œä¸€æ¬¡å…¨è¡¨æ‰«ææ“ä½œï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;select * from t where a &amp;gt; 2 limit 2&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¡¨ &lt;code&gt;[1]&lt;/code&gt;ï¼š&lt;/p&gt;&lt;p&gt;a&lt;code&gt;(int)&lt;/code&gt;b&lt;code&gt;(int)&lt;/code&gt;3112522314&lt;/p&gt;&lt;p&gt;é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°è¿™æ ·çš„ä¸€ä¸ªæ‰§è¡Œè®¡åˆ’ï¼š&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-648d673829c8078ea48bd8eee0e5331c_b.gif&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;487&quot; data-rawheight=&quot;559&quot; data-thumbnail=&quot;https://pic1.zhimg.com/v2-648d673829c8078ea48bd8eee0e5331c_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;487&quot; data-original=&quot;https://pic1.zhimg.com/v2-648d673829c8078ea48bd8eee0e5331c_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-648d673829c8078ea48bd8eee0e5331c_b.gif&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;487&quot; data-rawheight=&quot;559&quot; data-thumbnail=&quot;https://pic1.zhimg.com/v2-648d673829c8078ea48bd8eee0e5331c_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;487&quot; data-original=&quot;https://pic1.zhimg.com/v2-648d673829c8078ea48bd8eee0e5331c_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-648d673829c8078ea48bd8eee0e5331c_b.gif&quot;/&gt;&lt;/figure&gt;&lt;p&gt;æ¯ä¸ªç®—å­éƒ½å®ç°äº†ä¸€ä¸ª &lt;code&gt;Executor&lt;/code&gt; çš„ &lt;code&gt;trait&lt;/code&gt;ï¼Œ æ‰€ä»¥æ¯ä¸ªç®—å­éƒ½å¯ä»¥è°ƒç”¨ &lt;code&gt;next()&lt;/code&gt; æ¥å‘ä¸Šè¿”å›ä¸€è¡Œã€‚&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;pub trait Executor: Send {
    fn next(&amp;amp;mut self) -&amp;gt; Result&amp;lt;Option&amp;lt;Row&amp;gt;&amp;gt;;
    // ...
}
å½“ä»¥ä¸Šçš„è¯·æ±‚è¢«è§£æä¹‹åï¼Œæˆ‘ä»¬ä¼šåœ¨ ExecutorRunner é‡Œè¾¹ä¸æ–­çš„è°ƒç”¨æœ€ä¸Šå±‚ç®—å­çš„ next() æ–¹æ³•ï¼Œ ç›´åˆ°å…¶æ— æ³•å†è¿”å›è¡Œã€‚
pub fn handle_request(&amp;amp;mut self) -&amp;gt; Result&amp;lt;SelectResponse&amp;gt; {
    loop {
        match self.executor.next()? {
            Some(row) =&amp;gt; {
                // Do some aggregation.
            },
            None =&amp;gt; {
                // ...
                return result;
            }
        }
    }
}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¤§æ¦‚çš„é€»è¾‘å°±æ˜¯ï¼š&lt;code&gt;Runner&lt;/code&gt; è°ƒç”¨ &lt;code&gt;Limit&lt;/code&gt; ç®—å­çš„ &lt;code&gt;next()&lt;/code&gt; æ–¹æ³•ï¼Œç„¶åè¿™ä¸ªæ—¶å€™ &lt;code&gt;Limit&lt;/code&gt; å®ç°çš„ &lt;code&gt;next()&lt;/code&gt; æ–¹æ³•ä¼šå»è°ƒç”¨ä¸‹ä¸€å±‚ç®—å­ &lt;code&gt;Selection&lt;/code&gt; çš„ &lt;code&gt;next()&lt;/code&gt; æ–¹æ³•è¦ä¸€è¡Œä¸Šæ¥åšèšåˆï¼Œç›´åˆ°è¾¾åˆ°é¢„è®¾çš„é˜€å€¼ï¼Œåœ¨ä¾‹å­ä¸­ä¹Ÿå°±æ˜¯ä¸¤è¡Œï¼Œæ¥ç€ &lt;code&gt;Selection&lt;/code&gt; å®ç°çš„ &lt;code&gt;next()&lt;/code&gt; åˆä¼šå»è°ƒç”¨ä¸‹ä¸€å±‚ç®—å­çš„ &lt;code&gt;next()&lt;/code&gt; æ–¹æ³•ï¼Œ ä¹Ÿå°±æ˜¯ &lt;code&gt;TableScan&lt;/code&gt;ï¼Œ &lt;code&gt;TableScan&lt;/code&gt; çš„ &lt;code&gt;next()&lt;/code&gt; å®ç°æ˜¯æ ¹æ®è¯·æ±‚ä¸­çš„ &lt;code&gt;KeyRange&lt;/code&gt;ï¼Œ å‘ä¸‹è¾¹çš„ &lt;code&gt;MVCC&lt;/code&gt; è¦ä¸Šä¸€è¡Œï¼Œç„¶åè¿”å›ç»™ä¸Šå±‚ç®—å­, ä¹Ÿå°±æ˜¯ç¬¬ä¸€è¡Œ &lt;code&gt;(3, 1)&lt;/code&gt;ï¼Œ&lt;code&gt;Selection&lt;/code&gt; æ”¶åˆ°è¡Œåæ ¹æ® &lt;code&gt;where&lt;/code&gt; å­—å¥ä¸­çš„è¡¨è¾¾å¼çš„å€¼åšåˆ¤æ–­ï¼Œå¦‚æœæ»¡è¶³æ¡ä»¶å‘ä¸Šè¿”å›ä¸€è¡Œï¼Œ å¦åˆ™ç»§ç»­é—®ä¸‹å±‚ç®—å­è¦ä¸€è¡Œï¼Œæ­¤æ—¶ &lt;code&gt;a == 3 &amp;gt; 2&lt;/code&gt;, æ»¡è¶³æ¡ä»¶å‘ä¸Šè¿”å›ï¼Œ &lt;code&gt;Limit&lt;/code&gt; æ¥æ”¶åˆ°ä¸€è¡Œåˆ™åˆ¤æ–­å½“å‰æ”¶åˆ°çš„è¡Œæ•°æ—¶å€™æ»¡ä¸¤è¡Œï¼Œä½†æ˜¯ç°åœ¨åªæ”¶åˆ°ä¸€è¡Œï¼Œæ‰€ä»¥ç»§ç»­é—®ä¸‹å±‚ç®—å­è¦ä¸€è¡Œã€‚æ¥ä¸‹æ¥ &lt;code&gt;TableScan&lt;/code&gt; è¿”å› &lt;code&gt;(1,2), Selection&lt;/code&gt; å‘ç°ä¸æ»¡è¶³æ¡ä»¶ï¼Œç»§ç»­é—® &lt;code&gt;TableScan&lt;/code&gt; è¦ä¸€è¡Œä¹Ÿå°±æ˜¯ &lt;code&gt;(5,2), Selection&lt;/code&gt; å‘ç°è¿™è¡Œæ»¡è¶³æ¡ä»¶ï¼Œç„¶åè¿”å›è¿™ä¸€è¡Œï¼Œ&lt;code&gt;Limit&lt;/code&gt; æ¥æ”¶åˆ°ä¸€è¡Œï¼Œç„¶ååœ¨ä¸‹ä¸€æ¬¡è°ƒç”¨å…¶ &lt;code&gt;next()&lt;/code&gt; æ–¹æ³•æ—¶ï¼Œå‘ç°æ¥æ”¶åˆ°çš„è¡Œæ•°å·²ç»æ»¡ä¸¤è¡Œï¼Œæ­¤æ—¶è¿”å› &lt;code&gt;None&lt;/code&gt;ï¼Œ &lt;code&gt;Runner&lt;/code&gt; ä¼šå¼€å§‹å¯¹ç»“æœå¼€å§‹èšåˆï¼Œç„¶ä¼šè¿”å›ä¸€ä¸ªå“åº”ç»“æœã€‚&lt;/p&gt;&lt;h3&gt;å¼•å…¥å‘é‡åŒ–çš„æŸ¥è¯¢å¼•æ“&lt;/h3&gt;&lt;p&gt;å½“å‰ TiKV å¼•å…¥äº†å‘é‡åŒ–çš„æ‰§è¡Œå¼•æ“ï¼Œæ‰€è°“çš„å‘é‡åŒ–ï¼Œå°±æ˜¯åœ¨ &lt;code&gt;Executor&lt;/code&gt; é—´ä¼ é€’çš„ä¸å†æ˜¯å•å•çš„ä¸€è¡Œï¼Œè€Œæ˜¯å¤šè¡Œï¼Œæ¯”å¦‚ &lt;code&gt;TableScan&lt;/code&gt; åœ¨åº•å±‚ &lt;code&gt;MVCC Snapshot&lt;/code&gt; ä¸­æ‰«ä¸Šæ¥çš„ä¸å†æ˜¯ä¸€è¡Œï¼Œè€Œæ˜¯è¯´å¤šè¡Œã€‚è‡ªç„¶çš„ï¼Œåœ¨ç®—å­æ‰§è¡Œè®¡ç®—ä»»åŠ¡çš„æ—¶å€™ï¼Œè®¡ç®—çš„å•å…ƒä¹Ÿä¸å†æ˜¯ä¸€ä¸ªæ ‡é‡ï¼Œè€Œæ˜¯ä¸€ä¸ªå‘é‡ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå½“é‡åˆ°ä¸€ä¸ªè¡¨è¾¾å¼ï¼š&lt;code&gt;a + b&lt;/code&gt; çš„æ—¶å€™ï¼Œ æˆ‘ä»¬ä¸æ˜¯è®¡ç®—ä¸€è¡Œé‡Œè¾¹ &lt;code&gt;a&lt;/code&gt; åˆ—å’Œ &lt;code&gt;b&lt;/code&gt; åˆ—ä¸¤ä¸ªæ ‡é‡ç›¸åŠ çš„ç»“æœï¼Œè€Œæ˜¯è®¡ç®— &lt;code&gt;a&lt;/code&gt; åˆ—å’Œ &lt;code&gt;b&lt;/code&gt; åˆ—ä¸¤åˆ—ç›¸åŠ çš„ç»“æœã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-f80e2243e24af3bb84f7bd46ff202204_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;916&quot; data-rawheight=&quot;583&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;916&quot; data-original=&quot;https://pic1.zhimg.com/v2-f80e2243e24af3bb84f7bd46ff202204_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-f80e2243e24af3bb84f7bd46ff202204_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;916&quot; data-rawheight=&quot;583&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;916&quot; data-original=&quot;https://pic1.zhimg.com/v2-f80e2243e24af3bb84f7bd46ff202204_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-f80e2243e24af3bb84f7bd46ff202204_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;ä¸ºä»€ä¹ˆè¦å¼•å…¥å‘é‡åŒ–æ¨¡å‹å‘¢ï¼ŒåŸå› æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;å¯¹äºæ¯è¡Œæˆ‘ä»¬è‡³å°‘å¾—è°ƒç”¨ 1 æ¬¡ &lt;code&gt;next()&lt;/code&gt; æ–¹æ³•ï¼Œå¦‚æœ &lt;code&gt;DAG&lt;/code&gt; çš„æœ€å¤§æ·±åº¦å¾ˆæ·±ï¼Œä¸ºäº†è·å–ä¸€è¡Œæˆ‘ä»¬éœ€è¦è°ƒç”¨æ›´å¤šæ¬¡çš„ &lt;code&gt;next()&lt;/code&gt; æ–¹æ³•ï¼Œæ‰€ä»¥åœ¨ä¼ ç»Ÿçš„è¿­ä»£æ¨¡å‹ä¸­ï¼Œè™šå‡½æ•°è°ƒç”¨çš„å¼€é”€éå¸¸å¤§ã€‚å¦‚æœä¸€æ¬¡ &lt;code&gt;next()&lt;/code&gt; æ–¹æ³•å°±è¿”å›å¤šè¡Œï¼Œè¿™æ ·å¹³å‡ä¸‹æ¥æ¯æ¬¡ &lt;code&gt;next()&lt;/code&gt; æ–¹æ³•å°±å¯ä»¥è¿”å›å¤šè¡Œï¼Œè€Œä¸æ˜¯è‡³å¤šä¸€è¡Œã€‚&lt;/li&gt;&lt;li&gt;ç”±äºè¿­ä»£çš„å¼€é”€éå¸¸å¤§ï¼Œæ•´ä¸ªæ‰§è¡Œçš„å¾ªç¯æ— æ³•è¢« &lt;code&gt;loop-pipelining&lt;/code&gt; ä¼˜åŒ–ï¼Œä½¿å¾—æ•´ä¸ªå¾ªç¯æµæ°´çº¿è¢«å¡æ­»ï¼ŒIPC å¤§å¤§ä¸‹é™ã€‚è¿”å›å¤šè¡Œä¹‹åï¼Œæ¯ä¸ªç®—å­å†…éƒ¨å¯ä»¥é‡‡ç”¨å¼€é”€è¾ƒå°çš„å¾ªç¯ï¼Œæ›´å¥½åˆ©ç”¨ &lt;code&gt;loop-pipelining&lt;/code&gt; ä¼˜åŒ–ã€‚&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;å½“ç„¶å‘é‡åŒ–æ¨¡å‹ä¹Ÿä¼šå¸¦æ¥ä¸€äº›é—®é¢˜ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;åŸå…ˆæœ€ä¸Šå±‚ç®—å­æŒ‰éœ€å‘ä¸‹å±‚ç®—å­æ‹¿ä¸Šä¸€è¡Œï¼Œè€Œç°åœ¨æ‹¿ä¸Šå¤šè¡Œï¼Œå†…å­˜å¼€é”€è‡ªç„¶ä¼šå¢åŠ ã€‚&lt;/li&gt;&lt;li&gt;è®¡ç®—æ¨¡å‹å‘ç”Ÿå˜åŒ–ï¼ŒåŸæ¥åŸºäºæ ‡é‡è®¡ç®—çš„è¡¨è¾¾å¼æ¡†æ¶éœ€è¦é‡æ„ ï¼ˆè¯¦è§ä¸Šç¯‡æ–‡ç« ï¼‰ã€‚&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;ä½†æ˜¯è¿™æ ·å¹¶ä¸å½±å“å‘é‡åŒ–æŸ¥è¯¢å¸¦æ¥çš„æ˜¾è‘—çš„æ€§èƒ½æå‡ï¼Œä¸‹è¾¹æ˜¯å¼•å…¥å‘é‡åŒ–æ¨¡å‹åä¸€ä¸ªåŸºå‡†æµ‹è¯•ç»“æœï¼šï¼ˆéœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒCoprocessor è®¡ç®—è¿˜åªæ˜¯ TPC-H ä¸­çš„å…¶ä¸­ä¸€éƒ¨åˆ†ï¼Œæ‰€ä»¥è®¡ç®—ä»»åŠ¡æ¯”é‡å¾ˆå¤§ç¨‹åº¦ä¸Šå†³å®šäº†å¼€ä¸å¼€å‘é‡åŒ–å¸¦æ¥çš„æå‡æ¯”ä¾‹ï¼‰ã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-3877d6e8bb3b713b5ad3789769faf7e2_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;974&quot; data-rawheight=&quot;497&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;974&quot; data-original=&quot;https://pic3.zhimg.com/v2-3877d6e8bb3b713b5ad3789769faf7e2_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-3877d6e8bb3b713b5ad3789769faf7e2_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;974&quot; data-rawheight=&quot;497&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;974&quot; data-original=&quot;https://pic3.zhimg.com/v2-3877d6e8bb3b713b5ad3789769faf7e2_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-3877d6e8bb3b713b5ad3789769faf7e2_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;å¼•å…¥å‘é‡åŒ–æ¨¡å‹åï¼ŒåŸå…ˆçš„ &lt;code&gt;Execturor&lt;/code&gt; trait å°±å˜æˆäº† &lt;code&gt;BatchExecutor&lt;/code&gt;ï¼Œ å¯¹åº”çš„ &lt;code&gt;next()&lt;/code&gt; æ–¹æ³•å°±æˆäº† &lt;code&gt;next_batch()&lt;/code&gt;ã€‚ è‡ªç„¶çš„ &lt;code&gt;next_batch&lt;/code&gt; ä¸å†è¿”å›ä¸€ä¸ªè¡Œï¼Œè€Œæ˜¯ä¸€ä¸ª &lt;code&gt;BatchExecuteResult&lt;/code&gt;ï¼Œä¸Šè¾¹è®°å½•äº†æ‰«ä¸Šæ¥çš„ä¸€å¼ è¡¨ &lt;code&gt;physical_columns&lt;/code&gt;ï¼Œä»¥åŠå­è¡¨ä¸­å“ªäº›è¡Œåº”å½“è¢«ä¿ç•™çš„ &lt;code&gt;logical_rows&lt;/code&gt; å’Œä¸€ä¸ª &lt;code&gt;is_drain&lt;/code&gt; ç”¨æ¥è¡¨ç¤ºä¸‹å±‚ç®—å­æ˜¯å¦å·²ç»æ²¡æœ‰æ•°æ®å¯ä»¥è¿”å›ã€‚&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;pub trait BatchExecutor: Send {

    /// è·å–è¡¨çš„ `schema`
    fn schema(&amp;amp;self) -&amp;gt; &amp;amp;[FieldType];

    // å‘ä¸‹å±‚ç®—å­è¦å›ä¸€å¼ è¡¨
    fn next_batch(&amp;amp;mut self, scan_rows: usize) -&amp;gt; BatchExecuteResult;

    // ...
}

pub struct BatchExecuteResult {
    // æœ¬è½®å¾ªç¯ `TableScan` æ‰«ä¸Šæ¥çš„æ•°æ®
    pub physical_columns: LazyBatchColumnVec,

    /// è®°å½• `physical_columns` ä¸­æœ‰æ•ˆçš„è¡Œçš„ä¸‹æ ‡
    pub logical_rows: Vec&amp;lt;usize&amp;gt;,

    // ...

    // è¡¨ç¤ºä¸‹å±‚ç®—å­æ˜¯å¦å·²ç»æ²¡æœ‰æ•°æ®å¯ä»¥è¿”å›
    pub is_drained: Result&amp;lt;bool&amp;gt;,
}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åœ¨æ¥ä¸‹æ¥çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†ç®€å•ä»‹ç»ä¸€ä¸‹å‡ ç§å…¸å‹ç®—å­çš„å®ç°ç»†èŠ‚ï¼Œæ—¨åœ¨è®©å¤§å®¶æ›´åŠ ç†Ÿæ‚‰å„ä¸ªç®—å­çš„å·¥ä½œåŸç†ã€‚&lt;/p&gt;&lt;h2&gt;å…¸å‹ç®—å­çš„å®ç°&lt;/h2&gt;&lt;h3&gt;&lt;code&gt;BatchTableScanExecutor&lt;/code&gt; çš„å®ç°&lt;/h3&gt;&lt;p&gt;é¦–å…ˆæˆ‘ä»¬å…ˆæ˜ç¡®ä¸€ä¸‹ &lt;code&gt;BatchTableScanExecutor&lt;/code&gt; çš„åŠŸèƒ½ï¼Œ&lt;code&gt;TableScan&lt;/code&gt; å®ç°çš„ &lt;code&gt;next_batch()&lt;/code&gt; æ¯è¢«è°ƒç”¨ä¸€æ¬¡ï¼Œå®ƒå°±ä¼šä»åº•å±‚çš„å®ç°äº† &lt;code&gt;Storage trait&lt;/code&gt; çš„å­˜å‚¨å±‚ä¸­æ‰«ä¸ŠæŒ‡å®šçš„è¡Œæ•°ï¼Œä¹Ÿå°±æ˜¯ &lt;code&gt;scan_rows&lt;/code&gt; è¡Œã€‚ä½†æ˜¯ç”±äºæˆ‘ä»¬åœ¨è®¡ç®—çš„æ—¶å€™æ˜¯é‡‡ç”¨å‘é‡åŒ–çš„è®¡ç®—æ¨¡å‹ï¼Œè®¡ç®—éƒ½æ˜¯åŸºäºåˆ—è¿›è¡Œçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼šå¯¹æ‰«ä¸Šæ¥çš„è¡Œè¿›è¡Œä¸€æ¬¡è¡Œåˆ—è½¬æ¢ï¼Œå°†è¡¨ä»è¡Œå­˜æ ¼å¼è½¬æ¢æˆåˆ—å­˜æ ¼å¼ã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-bb0e84cbb640b86a5adbc4e82eecd821_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;743&quot; data-rawheight=&quot;504&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;743&quot; data-original=&quot;https://pic2.zhimg.com/v2-bb0e84cbb640b86a5adbc4e82eecd821_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-bb0e84cbb640b86a5adbc4e82eecd821_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;743&quot; data-rawheight=&quot;504&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;743&quot; data-original=&quot;https://pic2.zhimg.com/v2-bb0e84cbb640b86a5adbc4e82eecd821_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-bb0e84cbb640b86a5adbc4e82eecd821_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹ &lt;code&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/tikv/tikv/blob/96c3f978f655148b1703a520cb9b2e9001dd256d/components/tidb_query/src/batch/interface.rs%23L19&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;BatchTableScanExecutor&lt;/a&gt;&lt;/code&gt; ç°åœ¨çš„å®šä¹‰ï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;pub struct BatchTableScanExecutor&amp;lt;S: Storage&amp;gt;(ScanExecutor&amp;lt;S, TableScanExecutorImpl&amp;gt;);&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä»ç»“æ„ä½“çš„å®šä¹‰ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œ&lt;code&gt;BatchTableScanExecutor&lt;/code&gt; ä¾èµ–äº &lt;code&gt;ScanExecutor&lt;/code&gt;ï¼Œè€Œè¿™ä¸ª &lt;code&gt;ScanExecutor&lt;/code&gt; ä¾èµ–äºä¸€ä¸ªå®ç° &lt;code&gt;Storage&lt;/code&gt; çš„ç±»å‹å’Œå…·ä½“ &lt;code&gt;TableScanExecutorImpl&lt;/code&gt;ã€‚&lt;/p&gt;&lt;p&gt;å…¶ä¸­ &lt;code&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/tikv/tikv/blob/96c3f978f655148b1703a520cb9b2e9001dd256d/components/tidb_query/src/batch/executors/util/scan_executor.rs%23L38&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;ScanExecutor&lt;/a&gt;&lt;/code&gt; æ˜¯ä¸€ä¸ªé€šç”¨çš„ç»“æ„ä½“ï¼Œå…¶ä½œç”¨æ˜¯ä¸ºäº†æŠ½è±¡å‡ºæ‰«è¡¨å’Œæ‰«ç´¢å¼•ä¸¤ç§æ“ä½œï¼Œè¿™ä¸¤ç§æ“ä½œéƒ½éœ€è¦ä¾èµ–ä¸€ä¸ª &lt;code&gt;Storage&lt;/code&gt; è€ŒåŒºåˆ«ä»–ä»¬å…·ä½“è¡Œä¸ºçš„æ˜¯ä¸€ä¸ªå®ç°äº† &lt;code&gt;ScanExecutorImpl&lt;/code&gt; çš„ç»“æ„ä½“ï¼Œåœ¨ä¸Šè¾¹çš„å®šä¹‰ä¸­å°±æ˜¯ï¼š&lt;code&gt;TableScanExecutorImpl&lt;/code&gt;ã€‚&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;pub struct ScanExecutor&amp;lt;S: Storage, I: ScanExecutorImpl&amp;gt; {
    /// å…·ä½“çš„æ‰«è¡¨/æ‰«ç´¢å¼•å®ç°ã€‚
    imp: I,

    /// ç»™å®šä¸€ä¸ª `KeyRange`ï¼Œæ‰«ä¸Šä¸€è¡Œæˆ–è€…å¤šè¡Œã€‚
    scanner: RangesScanner&amp;lt;S&amp;gt;,

    // æ ‡è®°æ˜¯å¦å·²ç»æ‰«å®Œäº†æ‰€æœ‰çš„è¡Œã€‚
    is_ended: bool,
}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;BatchTableScanExecutor&lt;/code&gt; ä¸­æˆ‘ä»¬éœ€è¦é‡ç‚¹å…³æ³¨çš„æ˜¯å…¶å®ç°çš„ &lt;code&gt;BatchExecutor&lt;/code&gt;, å…¶ä¸­æœ€ä¸ºå…³é”®çš„å°±æ˜¯ &lt;code&gt;next_batch()&lt;/code&gt;ï¼Œç„¶è€Œå…¶ä¾èµ–äºå†…éƒ¨ &lt;code&gt;ScanExecutor&lt;/code&gt; çš„ &lt;code&gt;BatchExecutor&lt;/code&gt; å®ç°ï¼Œä¹Ÿå°±æ˜¯ï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;fn next_batch(&amp;amp;mut self, scan_rows: usize) -&amp;gt; BatchExecuteResult {

        // åˆ›å»ºä¸€ä¸ªåˆ—æ•°ç»„
        let mut logical_columns = self.imp.build_column_vec(scan_rows);
        
        // æ‰«ä¸Š `scan_rows` è¡Œï¼Œ ç„¶åæŒ‰åˆ—å¡«å……åˆ°åˆ›å»ºå¥½çš„åˆ—æ•°ç»„ä¸­ã€‚
        let is_drained = self.fill_column_vec(scan_rows, &amp;amp;mut logical_columns);

        // åˆ›å»ºä¸€ä¸ª `logical_rows`, è¡¨ç¤ºå½“å‰è¡¨ä¸­æ‰€æœ‰è¡Œæœ‰æ•ˆã€‚åè¾¹å¯èƒ½æ ¹æ® `Selection` çš„ç»“æœä¿®æ”¹è¿™ä¸ª `logical_rows`ã€‚
        let logical_rows = (0..logical_columns.rows_len()).collect();

        // åˆ¤æ–­æ˜¯å¦æ‰«å®Œä¼ å…¥çš„ `KeyRange`
        match &amp;amp;is_drained {
            // Note: `self.is_ended` is only used for assertion purpose.
            Err(_) | Ok(true) =&amp;gt; self.is_ended = true,
            Ok(false) =&amp;gt; {}
        };

        // è¿”å› `BatchExecuteResult`
        BatchExecuteResult {
            // ...
        }
    }&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å€¼å¾—æ³¨æ„çš„æ˜¯ä¸Šè¾¹ &lt;code&gt;fill_column_vec&lt;/code&gt; çš„å®ç°, å®ƒå¤§æ¦‚çš„é€»è¾‘å°±æ˜¯æ¯æ¬¡é—® &lt;code&gt;self.scanner&lt;/code&gt; è¦ä¸Šä¸€ä¸ª &lt;code&gt;Key-Value&lt;/code&gt; å¯¹, ç„¶åæ‰”ç»™ &lt;code&gt;self.imp.process_kv_pair&lt;/code&gt; å¤„ç†ï¼Œåœ¨æ‰«è¡¨çš„å®ç°ä¸­å°±æ˜¯å°† &lt;code&gt;value&lt;/code&gt; çœ‹æˆæ˜¯ä¸€ä¸ªè¡Œçš„ &lt;code&gt;datum&lt;/code&gt; ç¼–ç ï¼Œç„¶åå°†æ¯åˆ—çš„æ•°æ®è§£å‡ºæ¥ç„¶åæ”¾åˆ°å»ºå¥½çš„åˆ—æ•°ç»„é‡Œè¾¹å»ã€‚&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;fn fill_column_vec(
        &amp;amp;mut self,
        scan_rows: usize,
        columns: &amp;amp;mut LazyBatchColumnVec,
    ) -&amp;gt; Result&amp;lt;bool&amp;gt; {
        assert!(scan_rows &amp;gt; 0);

        for _ in 0..scan_rows {
            let some_row = self.scanner.next()?;
            if let Some((key, value)) = some_row {
                // å°†æ‰«ä¸Šæ¥çš„ä¸€è¡Œæ”¾å…¥ `columns` ä¸­
                self.imp.process_kv_pair(&amp;amp;key, &amp;amp;value, columns)?;
            } else {
                // æ²¡æœ‰ `KeyRange` å¯ä¾›æ‰«æï¼Œå·²ç»å®Œæˆæ‰«è¡¨ã€‚
                return Ok(true);
            }
        }

        // è¡¨ç¤ºä¸‹å±‚æ•°æ®è¿˜æ²¡æœ‰æ‰«å®Œã€‚
        Ok(false)
    }&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œç°åœ¨è¡¨ä¸­çš„æ•°æ®éƒ½æ˜¯æœªç»è§£ç çš„ç”Ÿæ•°æ®ï¼Œæ‰€è°“çš„ç”Ÿæ•°æ®å°±æ˜¯è¿˜ä¸èƒ½ç›´æ¥å‚ä¸åˆ°è¡¨è¾¾å¼è®¡ç®—çš„æ•°æ®ï¼Œè¿™é‡Œé‡‡ç”¨çš„æ˜¯ä¸€ç§ lazy decoding çš„ç­–ç•¥ï¼Œåªæœ‰è¦å‚ä¸è®¡ç®—çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ‰ä¼šè§£ç ç‰¹å®šçš„åˆ—ï¼Œè€Œä¸æ˜¯å°†æ•°æ®æ‰«ä¸Šæ¥å°±å¼€å§‹è§£ç æ•°æ®ï¼Œå°†å…¶å˜æˆèƒ½å¤Ÿç›´æ¥å‚ä¸è®¡ç®—çš„ç»“æ„ã€‚&lt;/b&gt;&lt;/p&gt;&lt;h3&gt;&lt;code&gt;BatchSelectionExecutor&lt;/code&gt; çš„å®ç°&lt;/h3&gt;&lt;p&gt;æ¥ä¸‹æ¥è¦ä»‹ç»çš„æ˜¯ &lt;code&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/tikv/tikv/blob/96c3f978f655148b1703a520cb9b2e9001dd256d/components/tidb_query/src/batch/executors/selection_executor.rs%23L17&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;BatchSelectionExecutor&lt;/a&gt;&lt;/code&gt; çš„å®ç°ï¼Œæˆ‘ä»¬é¦–å…ˆæ¥çœ‹çœ‹å®šä¹‰ï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;pub struct BatchSelectionExecutor&amp;lt;Src: BatchExecutor&amp;gt; {
    // ...
    
    // æ•°æ®æº
    src: Src,

    // æ¡ä»¶è¡¨è¾¾å¼
    conditions: Vec&amp;lt;RpnExpression&amp;gt;,
}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;é¦–å…ˆï¼Œ &lt;code&gt;BatchSelectionExecutor&lt;/code&gt; éœ€è¦ä¾èµ–ä¸€ä¸ª &lt;code&gt;Src&lt;/code&gt;ï¼Œä¸€ä¸ª &lt;code&gt;BatchExecutor&lt;/code&gt; æ¥æä¾›æ•°æ®çš„æ¥æºï¼Œç„¶åæ˜¯ä¸€ç»„æ¡ä»¶è¡¨è¾¾å¼ï¼Œå½“ &lt;code&gt;BatchSelectionExecutor&lt;/code&gt; åœ¨æ‰§è¡Œçš„æ—¶å€™ä¼šå¯¹è¡¨è¾¾å¼è¿›è¡Œæ±‚å€¼ï¼Œç„¶åæ ¹æ®æ±‚å‡ºçš„å€¼å¯¹ä¸‹å±‚æ•°æ®æ‹‰ä¸Šæ¥çš„è¡Œåšè¿‡æ»¤èšåˆï¼Œç„¶åè¿”å›è¿‡æ»¤å‡ºçš„è¡Œã€‚&lt;/p&gt;&lt;p&gt;è§‚å¯Ÿ &lt;code&gt;BatchSelectionExecutor&lt;/code&gt; å®ç°çš„ &lt;code&gt;BatchExecutor&lt;/code&gt; å¯ä»¥å‘ç°ï¼Œå…¶ä¸­çš„ &lt;code&gt;next_batch()&lt;/code&gt; æ–¹æ³•ä¾èµ–äº &lt;code&gt;handle_src_result()&lt;/code&gt;ï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;#[inline]
    fn next_batch(&amp;amp;mut self, scan_rows: usize) -&amp;gt; BatchExecuteResult {
        // ä»ä¸‹å±‚ç®—å­é‚£ä¼šä¸€å—æ•°æ®å¼€å§‹è¿‡æ»¤
        let mut src_result = self.src.next_batch(scan_rows);

        // æ ¹æ®è¡¨è¾¾å¼çš„å€¼ï¼Œè¿‡æ»¤å‡ºå¯¹åº”çš„è¡Œã€‚
        if let Err(e) = self.handle_src_result(&amp;amp;mut src_result) {
            src_result.is_drained = src_result.is_drained.and(Err(e));
            src_result.logical_rows.clear();
        } else {
            // ... 
        }

        src_result&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;é€šè¿‡è§‚å¯Ÿ &lt;code&gt;handle_src_result&lt;/code&gt; çš„å®ç°ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œå®ƒä¼šéå†æ‰€æœ‰è¡¨è¾¾å¼ï¼Œå¯¹å…¶æ±‚å€¼ï¼Œè¡¨è¾¾å¼çš„å€¼å¯èƒ½æ˜¯ä¸€ä¸ªæ ‡é‡ï¼Œä¹Ÿå¯èƒ½æ˜¯ä¸€ä¸ªå‘é‡ï¼Œä½†æ˜¯æˆ‘ä»¬å®Œå…¨æ˜¯å¯ä»¥æŠŠæ ‡é‡çœ‹æˆæ˜¯æ¯è¡Œéƒ½ä¸€æ ·çš„å‘é‡ï¼Œç„¶åæ ¹æ®æ¯è¡Œçš„å€¼ï¼Œå°†å…¶è½¬æ¢æˆ &lt;code&gt;bool&lt;/code&gt;ï¼Œå¦‚æœè¯¥è¡Œçš„å€¼ä¸º &lt;code&gt;true&lt;/code&gt;ï¼Œåˆ™åœ¨ &lt;code&gt;logical_rows&lt;/code&gt; ä¸­ä¿ç•™ä»–çš„ä¸‹æ ‡ã€‚&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;fn handle_src_result(&amp;amp;mut self, src_result: &amp;amp;mut BatchExecuteResult) -&amp;gt; Result&amp;lt;()&amp;gt; {
        let mut src_logical_rows_copy = Vec::with_capacity(src_result.logical_rows.len());
        let mut condition_index = 0;
        while condition_index &amp;lt; self.conditions.len() &amp;amp;&amp;amp; !src_result.logical_rows.is_empty() {
            // æ‹·è´ä¸€ä»½ä¸‹å±‚ç®—å­çš„ `logical_rows`ï¼Œç”¨åšè®¡ç®—è¡¨è¾¾å¼ã€‚
            src_logical_rows_copy.clear();
            src_logical_rows_copy.extend_from_slice(&amp;amp;src_result.logical_rows);

            // è®¡ç®—è¡¨è¾¾å¼çš„å€¼ï¼Œç„¶åæ ¹æ®è¡¨è¾¾å¼çš„å€¼å»æ›´æ–°ä¸‹å±‚ç®—å­çš„ `logical_rows`ã€‚
            match self.conditions[condition_index].eval(
                &amp;amp;mut self.context,
                self.src.schema(),
                &amp;amp;mut src_result.physical_columns,
                &amp;amp;src_logical_rows_copy,
                // è¡¨è¾¾å¼äº§ç”Ÿçš„ç»“æœå¦‚æœæ˜¯ä¸€åˆ—çš„è¯, è¿™é‡Œè¡¨ç¤ºè¡¨è¾¾å¼åº”è¯¥è¾“å‡ºçš„è¡Œæ•°
                src_logical_rows_copy.len(),
            )? {
                RpnStackNode::Scalar { value, .. } =&amp;gt; {
                    // å¦‚æœè¡¨è¾¾å¼æ˜¯ä¸€ä¸ªæ ‡é‡ï¼Œæ ¹æ®è½¬æ¢æˆ `bool` çš„å€¼ç¡®å®šæ˜¯å¦ä¿ç•™è¯¥åˆ—ã€‚
                    update_logical_rows_by_scalar_value(
                        &amp;amp;mut src_result.logical_rows,
                        &amp;amp;mut self.context,
                        value,
                    )?;
                }
                RpnStackNode::Vector { value, .. } =&amp;gt; {
                    // æ ¹æ®æ¯è¡Œçš„ç»“æœï¼Œç¡®å®šæ˜¯å¦ä¿ç•™é‚£è¡Œã€‚
                    update_logical_rows_by_vector_value(
                    &amp;amp;mut src_result.logical_rows,
                    &amp;amp;mut self.context,
                    eval_result,
                    eval_result_logical_rows,
                    )?;
                }
            }

            condition_index += 1;
        }

        Ok(())
    }
}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3&gt;&lt;code&gt;BatchFastHashAggregationExecutor&lt;/code&gt; çš„å®ç°&lt;/h3&gt;&lt;p&gt;èšåˆç®—å­çš„ç§ç±»æœ‰å¾ˆå¤šç§ï¼ŒåŒ…æ‹¬ï¼š&lt;/p&gt;&lt;p&gt;&lt;code&gt;SimpleAggregation&lt;/code&gt; (æ²¡æœ‰ &lt;code&gt;group by&lt;/code&gt; å­—å¥ï¼Œåªæœ‰èšåˆå‡½æ•°)&lt;/p&gt;&lt;ul&gt;&lt;ul&gt;&lt;li&gt;=&amp;gt; &lt;code&gt;select count(*) from t where a &amp;gt; 1&lt;/code&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;p&gt;&lt;code&gt;FastHashAggregation&lt;/code&gt; (åªæœ‰ä¸€ä¸ª &lt;code&gt;group by&lt;/code&gt; column)&lt;/p&gt;&lt;ul&gt;&lt;ul&gt;&lt;li&gt;=&amp;gt; &lt;code&gt;select count(*) from t group by a&lt;/code&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;p&gt;&lt;code&gt;SlowHashAggregation&lt;/code&gt; (å¤šä¸ª &lt;code&gt;groub by&lt;/code&gt; columns, æˆ–è€…è¡¨è¾¾å¼å€¼ä¸æ˜¯ &lt;code&gt;Hashable&lt;/code&gt; çš„)&lt;/p&gt;&lt;ul&gt;&lt;ul&gt;&lt;li&gt;=&amp;gt; &lt;code&gt;select sum(*) from t group by a, b&lt;/code&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;p&gt;&lt;code&gt;StreamAggregation&lt;/code&gt; è¿™ç§èšåˆç®—å­å‡è®¾è¾“å…¥å·²ç»æŒ‰ç…§ &lt;code&gt;group by&lt;/code&gt; columns æ’å¥½åºã€‚&lt;/p&gt;&lt;p&gt;æˆ‘ä»¬è¿™é‡ŒæŒ‘å‡ºä¸€ä¸ªæ¯”è¾ƒå…·æœ‰ä»£è¡¨æ€§çš„ç®—å­ï¼š&lt;code&gt;BatchFastHashAggregationExecutor&lt;/code&gt; æ¥è¿›è¡Œåˆ†æã€‚&lt;/p&gt;&lt;p&gt;é¦–å…ˆè¦æ˜ç¡®ä¸€ä¸‹ &lt;code&gt;BatchFastHashAggregationExecutor&lt;/code&gt; å¤§è‡´çš„æ‰§è¡Œè¿‡ç¨‹ï¼Œé¦–å…ˆæˆ‘ä»¬ä¼šæ ¹æ® &lt;code&gt;group by&lt;/code&gt; column é‡Œè¾¹çš„å€¼ç»™ä¸‹å±‚ç®—å­è¿”å›çš„è¡¨è¿›è¡Œåˆ†ç»„ï¼Œæ¯”å¦‚ï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;select count(*) from t group by a&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-39c46a99e107639c311e6e2cce953021_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;725&quot; data-rawheight=&quot;479&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;725&quot; data-original=&quot;https://pic2.zhimg.com/v2-39c46a99e107639c311e6e2cce953021_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-39c46a99e107639c311e6e2cce953021_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;725&quot; data-rawheight=&quot;479&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;725&quot; data-original=&quot;https://pic2.zhimg.com/v2-39c46a99e107639c311e6e2cce953021_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-39c46a99e107639c311e6e2cce953021_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;ç„¶åï¼Œæˆ‘ä»¬ä¼šéå†æ¯ä¸ªç»„ï¼Œç„¶åé’ˆå¯¹æ¯ä¸ªç»„æ±‚å‡ºæ¯ä¸ªèšåˆå‡½æ•°çš„å€¼ï¼Œåœ¨è¿™é‡Œå°±æ˜¯ï¼š&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-20e346377b4bd8fe66031f7423510512_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;602&quot; data-rawheight=&quot;493&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;602&quot; data-original=&quot;https://pic3.zhimg.com/v2-20e346377b4bd8fe66031f7423510512_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-20e346377b4bd8fe66031f7423510512_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;602&quot; data-rawheight=&quot;493&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;602&quot; data-original=&quot;https://pic3.zhimg.com/v2-20e346377b4bd8fe66031f7423510512_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-20e346377b4bd8fe66031f7423510512_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;æ¥ä¸‹æ¥å°±æ¶‰åŠåˆ°ä¸¤ä¸ªé‡è¦çš„ç»†èŠ‚ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;èšåˆå‡½æ•°å¦‚ä½•æ±‚å€¼ã€‚&lt;/li&gt;&lt;li&gt;å¦‚ä½•æ ¹æ® &lt;code&gt;group_by column&lt;/code&gt; å¯¹è¡Œè¿›è¡Œåˆ†ç»„å¹¶èšåˆã€‚&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;åç»­å‡ èŠ‚æˆ‘ä»¬ç€é‡ä»‹ç»ä¸€ä¸‹è¿™ä¸¤ä¸ªç»†èŠ‚æ˜¯å¦‚ä½•å®ç°çš„ã€‚&lt;/p&gt;&lt;h3&gt;èšåˆå‡½æ•°&lt;/h3&gt;&lt;p&gt;æ¯ä¸ªèšåˆå‡½æ•°éƒ½ä¼šå®ç°ä¸€ä¸ª &lt;code&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/tikv/tikv/blob/96c3f978f655148b1703a520cb9b2e9001dd256d/components/tidb_query/src/aggr_fn/mod.rs%23L35&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;AggrFunction&lt;/a&gt;&lt;/code&gt; è¿™ä¸ª traitï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;pub trait AggrFunction: std::fmt::Debug + Send + &amp;#39;static {
    /// The display name of the function.
    fn name(&amp;amp;self) -&amp;gt; &amp;amp;&amp;#39;static str;

    /// Creates a new state instance. Different states aggregate independently.
    fn create_state(&amp;amp;self) -&amp;gt; Box&amp;lt;dyn AggrFunctionState&amp;gt;;
}

// NOTE: AggrFunctionState æ˜¯ AggrFunctionStateUpdatePartial çš„ super trait
pub trait AggrFunctionState:
    std::fmt::Debug
    + Send
    + &amp;#39;static
    + AggrFunctionStateUpdatePartial&amp;lt;Int&amp;gt;
    + AggrFunctionStateUpdatePartial&amp;lt;Real&amp;gt;
    + AggrFunctionStateUpdatePartial&amp;lt;Decimal&amp;gt;
    + AggrFunctionStateUpdatePartial&amp;lt;Bytes&amp;gt;
    + AggrFunctionStateUpdatePartial&amp;lt;DateTime&amp;gt;
    + AggrFunctionStateUpdatePartial&amp;lt;Duration&amp;gt;
    + AggrFunctionStateUpdatePartial&amp;lt;Json&amp;gt;
{
    fn push_result(&amp;amp;self, ctx: &amp;amp;mut EvalContext, target: &amp;amp;mut [VectorValue]) -&amp;gt; Result&amp;lt;()&amp;gt;;
}
pub trait AggrFunctionStateUpdatePartial&amp;lt;T: Evaluable&amp;gt; {
    fn update(&amp;amp;mut self, ctx: &amp;amp;mut EvalContext, value: &amp;amp;Option&amp;lt;T&amp;gt;) -&amp;gt; Result&amp;lt;()&amp;gt;;

    fn update_repeat(
        &amp;amp;mut self,
        ctx: &amp;amp;mut EvalContext,
        value: &amp;amp;Option&amp;lt;T&amp;gt;,
        repeat_times: usize,
    ) -&amp;gt; Result&amp;lt;()&amp;gt;;

    fn update_vector(
        &amp;amp;mut self,
        ctx: &amp;amp;mut EvalContext,
        physical_values: &amp;amp;[Option&amp;lt;T&amp;gt;],
        logical_rows: &amp;amp;[usize],
    ) -&amp;gt; Result&amp;lt;()&amp;gt;;
}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;èšåˆå‡½æ•°çš„æ±‚å€¼è¿‡ç¨‹åˆ†ä¸ºä¸‰ä¸ªæ­¥éª¤ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;åˆ›å»ºå¹¶åˆå§‹åŒ–çŠ¶æ€ï¼Œè¿™ä¸€è¿‡ç¨‹ä¸€èˆ¬æ˜¯ç”±è°ƒç”¨è€…è°ƒç”¨ï¼š&lt;code&gt;create_state&lt;/code&gt; å®ç°çš„ã€‚&lt;/li&gt;&lt;li&gt;ç„¶ååœ¨ä¸æ–­éå†è¡Œ/å‘é‡çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¼šå°†è¡Œçš„å†…å®¹ä¼ å…¥ &lt;code&gt;update/update_repeat/update_vector&lt;/code&gt; å‡½æ•°(å…·ä½“è°ƒç”¨é‚£ç§å–å†³äºä¸åŒçš„èšåˆå‡½æ•°å®ç°)ï¼Œæ›´æ–°å†…éƒ¨çš„çŠ¶æ€ï¼Œæ¯”å¦‚é‡åˆ°ä¸€ä¸ªéç©ºè¡Œï¼Œ&lt;code&gt;COUNT()&lt;/code&gt; å°±ä¼šç»™è‡ªå·±å†…éƒ¨è®¡æ•°å™¨+1ã€‚&lt;/li&gt;&lt;li&gt;å½“éå†ç»“æŸä¹‹åï¼Œèšåˆå‡½æ•°å°±ä¼šå°†è‡ªå·±çš„çŠ¶æ€é€šè¿‡ push_result(), å†™å…¥åˆ°ä¸€ä¸ªåˆ—æ•°ç»„é‡Œè¾¹ï¼Œè¿™é‡Œä¹‹æ‰€ä»¥æ˜¯åˆ—æ•°ç»„æ˜¯å› ä¸ºèšåˆå‡½æ•°å¯èƒ½æœ‰å¤šä¸ªè¾“å‡ºåˆ—ï¼Œæ¯”å¦‚ AVG()ï¼Œåœ¨åˆ†å¸ƒå¼çš„åœºæ™¯ï¼Œæˆ‘ä»¬éœ€è¦è¿”å›ä¸¤åˆ—ï¼š&lt;code&gt;SUM&lt;/code&gt; å’Œ &lt;code&gt;COUNT&lt;/code&gt;ã€‚&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;è¿™ä¸ª &lt;code&gt;trait&lt;/code&gt; å¯ä»¥é€šè¿‡ &lt;code&gt;#[derive(AggrFuntion)]&lt;/code&gt; è‡ªåŠ¨æ¨å¯¼å‡ºå®ç°ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡è¿‡ç¨‹å® &lt;code&gt;#[aggr_funtion(state = FooState::new())]&lt;/code&gt; æ¥æŒ‡å®š &lt;code&gt;create_state&lt;/code&gt; åˆ›å»ºå‡ºæ¥çš„ &lt;code&gt;State&lt;/code&gt; ç±»å‹ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œ&lt;code&gt;COUNT&lt;/code&gt; çš„å®ç°ï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;/// The COUNT aggregate function.
#[derive(Debug, AggrFunction)]
#[aggr_function(state = AggrFnStateCount::new())]
pub struct AggrFnCount;

/// The state of the COUNT aggregate function.
#[derive(Debug)]
pub struct AggrFnStateCount {
    count: usize,
}

impl AggrFnStateCount {
    pub fn new() -&amp;gt; Self {
        Self { count: 0 }
    }
}

impl AggrFunctionStateUpdatePartial for AggrFnStateCount { /* .. */ }
impl AggrFunctionState for AggrFnStateCount { /* .. */ }&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™ä¸ªæ—¶å€™ï¼Œè°ƒç”¨ &lt;code&gt;create_state()&lt;/code&gt; çš„æ—¶å€™å°±ä¼šå°†å†…éƒ¨çŠ¶æ€ Box èµ·æ¥ç„¶åè¿”å›ã€‚&lt;/p&gt;&lt;h3&gt;å¦‚ä½•æ ¹æ® &lt;code&gt;group by&lt;/code&gt; column åˆ†ç»„å¹¶èšåˆ&lt;/h3&gt;&lt;p&gt;&lt;code&gt;BatchFastHashAggregationExecutor&lt;/code&gt; å†…éƒ¨ä¼šæœ‰ä¸€ä¸ª &lt;code&gt;Groups&lt;/code&gt; çš„ç»“æ„ï¼Œå…¶æ ¸å¿ƒæ˜¯ä¸€ä¸ª &lt;code&gt;HashTable&lt;/code&gt;ï¼Œæ ¹æ® &lt;code&gt;group by&lt;/code&gt; è¡¨è¾¾å¼å…·ä½“çš„ç±»å‹ä½œä¸º &lt;code&gt;key&lt;/code&gt; çš„ç±»å‹ï¼Œè€Œ &lt;code&gt;value&lt;/code&gt; çš„å€¼åˆ™æ˜¯ä¸€ä¸ª &lt;code&gt;AggrFunctionState&lt;/code&gt; æ•°ç»„ä¸­è¯¥ç»„å¯¹åº”çš„èšåˆå‡½æ•°çŠ¶æ€é›†åˆçš„å¼€å§‹ä¸‹æ ‡ã€‚ä¸¾ä¸ªä¾‹å­ï¼š&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-58cb3d5d6e4ce20f68169eafd34332eb_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;691&quot; data-rawheight=&quot;449&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;691&quot; data-original=&quot;https://pic4.zhimg.com/v2-58cb3d5d6e4ce20f68169eafd34332eb_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-58cb3d5d6e4ce20f68169eafd34332eb_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;691&quot; data-rawheight=&quot;449&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;691&quot; data-original=&quot;https://pic4.zhimg.com/v2-58cb3d5d6e4ce20f68169eafd34332eb_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-58cb3d5d6e4ce20f68169eafd34332eb_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;code&gt;Hash&lt;/code&gt; å€¼ä¸€æ ·çš„è¡Œä¼šè¢«åˆ†é…åˆ°åŒä¸€ä¸ªç»„ä¸­ï¼Œæ¯ç»„ä¼šæœ‰è‹¥å¹²ä¸ªçŠ¶æ€ï¼Œèšåˆçš„è¿‡ç¨‹å…¶å®å°±æ˜¯æ ¹æ®æ¯è¡Œçš„ &lt;code&gt;group by&lt;/code&gt; column æ‰¾åˆ°å…¶å¯¹åº”çš„åˆ†ç»„ (HashTable::get)ï¼Œç„¶åå¯¹ç»„å†…çš„æ¯ä¸€ä¸ªçŠ¶æ€ï¼Œæ ¹æ®è¯¥è¡Œçš„å†…å®¹è¿›è¡Œæ›´æ–°ã€‚æœ€åéå†æ¯ä¸ªç»„ï¼Œå°†ä»–ä»¬çš„çŠ¶æ€å†™å…¥åˆ°åˆ—æ•°ç»„å³å¯ã€‚&lt;/p&gt;&lt;h3&gt;å°†ä¸¤ä¸ªè¿‡ç¨‹ç»“åˆèµ·æ¥&lt;/h3&gt;&lt;p&gt;ä¸Šè¾¹ä¸¤èŠ‚è®¨è®ºäº†èšåˆå‡½æ•°å¦‚ä½•è®¡ç®—ï¼Œå¦‚ä½•åˆ†ç»„ä»¥åŠå¦‚ä½•å¯¹æ¯ä¸ªç»„åšèšåˆçš„åŸºæœ¬è¿‡ç¨‹ã€‚ç°åœ¨æˆ‘ä»¬é€šè¿‡ä»£ç ï¼Œæ¥æ¢è®¨ä¸€ä¸‹å…¶ä¸­çš„å…·ä½“ç»†èŠ‚ã€‚&lt;/p&gt;&lt;p&gt;å…ˆæ¥çœ‹çœ‹ &lt;code&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/tikv/tikv/blob/96c3f978f655148b1703a520cb9b2e9001dd256d/components/tidb_query/src/batch/executors/fast_hash_aggr_executor.rs%23L34&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;BatchFastHashAggregationExecutor&lt;/a&gt;&lt;/code&gt; çš„å®šä¹‰:&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;pub struct BatchFastHashAggregationExecutor&amp;lt;Src: BatchExecutor&amp;gt;(
    AggregationExecutor&amp;lt;Src, FastHashAggregationImpl&amp;gt;,
);&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æˆ‘ä»¬å‘ç°ï¼Œè¿™ä¸ªå’Œ &lt;code&gt;BatchTableScanExecutor&lt;/code&gt; çš„å®šä¹‰ååˆ†ç›¸ä¼¼ï¼ŒåŒºåˆ«æ¯ä¸ªèšåˆç®—å­è¡Œä¸ºçš„æ˜¯ &lt;code&gt;AggregationExecutor&lt;/code&gt; é‡Œè¾¹å®ç°äº† &lt;code&gt;AggregationExecutorImpl&lt;/code&gt; trait çš„ä¸€ä¸ªç»“æ„ä½“ã€‚ æˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹çœ‹è¿™ä¸ª trait æä¾›äº†å“ªäº›æ–¹æ³•ã€‚&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;pub struct AggregationExecutor&amp;lt;Src: BatchExecutor, I: AggregationExecutorImpl&amp;lt;Src&amp;gt;&amp;gt; {
    imp: I,
    is_ended: bool,
    entities: Entities&amp;lt;Src&amp;gt;,
}

pub trait AggregationExecutorImpl&amp;lt;Src: BatchExecutor&amp;gt;: Send {
    // æ ¹æ® `group by` columns å’Œ èšåˆå‡½æ•°åˆå§‹åŒ– `entities` ä¸­çš„ `schema`
    fn prepare_entities(&amp;amp;mut self, entities: &amp;amp;mut Entities&amp;lt;Src&amp;gt;);

    // æ ¹æ®ä¸‹å±‚ç®—å­æ‰«ä¸Šæ¥çš„æ•°æ®åšèšåˆå’Œåˆ†ç»„
    fn process_batch_input(
        &amp;amp;mut self,
        entities: &amp;amp;mut Entities&amp;lt;Src&amp;gt;,
        input_physical_columns: LazyBatchColumnVec,
        input_logical_rows: &amp;amp;[usize],
    ) -&amp;gt; Result&amp;lt;()&amp;gt;;

    // å°†æ¯ä¸ªèšåˆå‡½æ•°çš„çŠ¶æ€æ›´æ–°åˆ°åˆ—æ•°ç»„ä¸­ï¼Œå³å†™å…¥èšåˆç»“æœ
    // è¿™é‡Œè¿”å›çš„æ˜¯ `group by` columnï¼Œåœ¨åˆ†å¸ƒå¼åœºæ™¯å¦‚æœä¸æŠŠ `group by` column è¿”å›ï¼Œ`TiDB` æ²¡æœ‰åŠæ³•æ ¹æ®åˆ†ç»„åšäºŒæ¬¡èšåˆã€‚
    fn iterate_available_groups(
        &amp;amp;mut self,
        entities: &amp;amp;mut Entities&amp;lt;Src&amp;gt;,
        src_is_drained: bool,
        iteratee: impl FnMut(&amp;amp;mut Entities&amp;lt;Src&amp;gt;, &amp;amp;[Box&amp;lt;dyn AggrFunctionState&amp;gt;]) -&amp;gt; Result&amp;lt;()&amp;gt;,
    ) -&amp;gt; Result&amp;lt;Vec&amp;lt;LazyBatchColumn&amp;gt;&amp;gt;;
}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¸Šè¾¹ä»£ç ä¸­çš„ &lt;code&gt;Entities&lt;/code&gt; æ˜¯è®°å½•æºç®—å­å·²ç»èšåˆå‡½æ•°å…ƒä¿¡æ¯çš„ä¸€ä¸ªç»“æ„ä½“ï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;pub struct Entities&amp;lt;Src: BatchExecutor&amp;gt; {
    pub src: Src,
    
    // ...

    // èšåˆåäº§ç”Ÿçš„ `schmea`ï¼Œ åŒ…å« `group_by` columns
    pub schema: Vec&amp;lt;FieldType&amp;gt;,

    /// èšåˆå‡½æ•°çš„é›†åˆ
    pub each_aggr_fn: Vec&amp;lt;Box&amp;lt;dyn AggrFunction&amp;gt;&amp;gt;,

    /// æ¯ä¸ªèšåˆå‡½æ•°è¾“å‡ºçš„åˆ—å¤§å°ï¼Œ`COUNT` æ˜¯ 1ï¼Œ`AVG` æ˜¯ 2
    pub each_aggr_cardinality: Vec&amp;lt;usize&amp;gt;,

    /// èšåˆå‡½æ•°é‡Œè¾¹çš„è¡¨è¾¾å¼
    pub each_aggr_exprs: Vec&amp;lt;RpnExpression&amp;gt;,

    // æ¯ä¸ªèšåˆè¡¨è¾¾å¼è¾“å‡ºçš„ç±»å‹çš„é›†åˆ
    pub all_result_column_types: Vec&amp;lt;EvalType&amp;gt;,
}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;é¦–å…ˆï¼Œä¸ºäº†è§‚å¯Ÿåˆ° &lt;code&gt;BatchFastHashAggregationExecutor&lt;/code&gt; æˆ‘ä»¬éœ€è¦è¿½è¸ªä»–çš„ &lt;code&gt;next_batch()&lt;/code&gt; çš„å®ç°ï¼Œåœ¨è¿™é‡Œä¹Ÿå°±æ˜¯ï¼š &lt;code&gt;AggregationExecutor::handle_next_batch&lt;/code&gt;ï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;fn handle_next_batch(&amp;amp;mut self) -&amp;gt; Result&amp;lt;(Option&amp;lt;LazyBatchColumnVec&amp;gt;, bool)&amp;gt; {
        // ä»ä¸‹å±‚ç®—å­å–å›ä¸€ä¸ª `batch`
        let src_result = self
            .entities
            .src
            .next_batch(crate::batch:ğŸƒ:BATCH_MAX_SIZE);

        self.entities.context.warnings = src_result.warnings;

        let src_is_drained = src_result.is_drained?;

        // å¦‚æœä¸‹å±‚è¿”å›çš„æ•°æ®ä¸ä¸ºç©ºï¼Œå°†æ ¹æ®æ¯è¡Œçš„ç»“æœåˆ†ç»„å¹¶èšåˆ
        if !src_result.logical_rows.is_empty() {
            self.imp.process_batch_input(
                &amp;amp;mut self.entities,
                src_result.physical_columns,
                &amp;amp;src_result.logical_rows,
            )?;
        }

        // åœ¨ `FastHashAggr` ä¸­ï¼Œåªæœ‰ä¸‹å±‚ç®—å­æ²¡æœ‰åŠæ³•å†è¿”å›æ•°æ®çš„æ—¶å€™ï¼Œæ‰èƒ½è®¤ä¸ºèšåˆå·²ç»å®Œæˆï¼Œ
        // å¦åˆ™æˆ‘ä»¬è¿”å›ä¸€ä¸ªç©ºæ•°æ®ç»™ä¸Šå±‚ç®—å­ï¼Œç­‰å¾…ä¸‹ä¸€æ¬¡ `next_batch` è¢«è°ƒç”¨ã€‚
        let result = if src_is_drained {
            Some(self.aggregate_partial_results(src_is_drained)?)
        } else {
            None
        };
        Ok((result, src_is_drained))
    }&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å…·ä½“åˆ° &lt;code&gt;FastHashAggr&lt;/code&gt; ä¸­ï¼Œ&lt;code&gt;process_batch_input&lt;/code&gt; å°±æ˜¯åˆ†ç»„å¹¶æ›´æ–°æ¯ç»„çš„çŠ¶æ€ã€‚&lt;code&gt;aggregate_partial_results&lt;/code&gt; å°±æ˜¯å†™å…¥æœ€ç»ˆçš„çŠ¶æ€åˆ°åˆ—æ•°ç»„ä¸­ã€‚&lt;/p&gt;&lt;h2&gt;æ€»ç»“&lt;/h2&gt;&lt;p&gt;æœ¬æ–‡ç®€ç•¥çš„ä»‹ç»äº† TiKV æŸ¥è¯¢å¼•æ“çš„å®ç°åŸç†å’Œå‡ ä¸ªç®€å•ç®—å­çš„å®ç°ï¼Œå¦‚æœå¤§å®¶å¯¹å…¶ä»–ç®—å­ä¹Ÿæ„Ÿå…´è¶£çš„è¯ï¼Œå¯ä»¥åˆ° &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/tikv/tikv/tree/983c626b069f2a2314d0a47009ca74033b346069/components/tidb_query/src/batch/executors&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;tikv/components/tidb_query/src/batch/executors&lt;/a&gt; ä¸‹è¾¹æ‰¾åˆ°å¯¹åº”çš„å®ç°ï¼Œæœ¬æ–‡ä¸­å‡ºç°çš„ä»£ç éƒ½ç»è¿‡ä¸€å®šåˆ å‡ï¼Œæ¬¢è¿å¤§å®¶é˜…è¯» TiKV çš„æºç è·å–æ›´å¤šçš„ç»†èŠ‚ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;åŸæ–‡é˜…è¯»ï¼š&lt;/b&gt;&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pingcap.com/blog-cn/tikv-source-code-reading-16/&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic2.zhimg.com/v2-60ab5bd867c2434d70c957a02a2169e1_ipico.jpg&quot; data-image-width=&quot;1200&quot; data-image-height=&quot;1200&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TiKV æºç è§£æç³»åˆ—æ–‡ç« ï¼ˆåå…­ï¼‰TiKV Coprocessor Executor æºç è§£æ | PingCAP&lt;/a&gt;&lt;p&gt;&lt;b&gt;æ›´å¤š TiKV æºç é˜…è¯»ï¼š&lt;/b&gt;&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pingcap.com/blog-cn/%23TiKV-%25E6%25BA%2590%25E7%25A0%2581%25E8%25A7%25A3%25E6%259E%2590&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic2.zhimg.com/v2-60ab5bd867c2434d70c957a02a2169e1_ipico.jpg&quot; data-image-width=&quot;1200&quot; data-image-height=&quot;1200&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Blog-cns | PingCAP&lt;/a&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>ZoeyZhai</author>
<guid isPermaLink="false">2019-12-12-96906129</guid>
<pubDate>Thu, 12 Dec 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>æ‹¥æŠ± Elasticsearchï¼šç»™ TiDB æ’ä¸Šå…¨æ–‡æ£€ç´¢çš„ç¿…è†€</title>
<link>https://henix.github.io/feeds/zhuanlan.newsql/2019-12-10-96514042.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/96514042&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-b874880ffe6069ffd21d8c00e1cd46fb_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;æ¨èä¸‹çŸ¥ä¹çš„æ™“å…‰è€å¸ˆçš„æ–‡ç« ã€‚TiDB çš„ AP å½¢æ€å…¶å®ä¸€ç›´éƒ½è¿˜åœ¨ä¸æ–­è¡¥å®Œçš„è·¯ä¸Šï¼Œè¿™é‡Œå°‘ä¸äº†ç¤¾åŒºå„è·¯ç¥ä»™çš„å„ç§ç¥å¥‡è´¡çŒ®ã€‚è¿™é‡Œæ¨èä¸‹çŸ¥ä¹å¤§ç¥å­™æ™“å…‰è€å¸ˆåœ¨ TiDB Hackathon 2019 è·å¥–ä½œå“ TiSearch çš„ä»‹ç»ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;ä½œè€…ä»‹ç»&lt;/b&gt;&lt;/p&gt;&lt;p&gt;å­™æ™“å…‰ï¼ŒçŸ¥ä¹æŠ€æœ¯å¹³å°è´Ÿè´£äººï¼Œä¸è–›å®ï¼ˆ@Inkeï¼‰ã€é»„æ¢¦é¾™ï¼ˆ@PingCAPï¼‰ã€å†¯åšï¼ˆ@çŸ¥ä¹ï¼‰ç»„é˜Ÿå‚åŠ äº† TiDB Hackathon 2019ï¼Œä»–ä»¬çš„é¡¹ç›® TiSearch è·å¾—äº† CTO ç‰¹åˆ«å¥–ã€‚&lt;/p&gt;&lt;p&gt;&lt;br/&gt;â€œæœç´¢â€æ˜¯å¤§å®¶åœ¨ä½¿ç”¨å„ç§ APP ä¸­éå¸¸é‡è¦çš„ä¸€ä¸ªè¡Œä¸ºï¼Œå¯¹äºçŸ¥ä¹è¿™æ ·ä»¥æµ·é‡ä¼˜è´¨å†…å®¹ä¸ºç‰¹è‰²çš„äº§å“æ¥è¯´ï¼Œå€ŸåŠ©æœç´¢å¸®åŠ©ç”¨æˆ·å‡†ç¡®ã€å¿«é€Ÿåœ°è§¦è¾¾æƒ³è¦å¯»æ‰¾çš„å†…å®¹æ›´æ˜¯è‡³å…³é‡è¦ã€‚è€Œâ€œå…¨æ–‡æ£€ç´¢â€åˆ™æ˜¯éšè—åœ¨ç®€å•çš„æœç´¢æ¡†èƒŒåä¸å¯æˆ–ç¼ºçš„ä¸€é¡¹åŸºæœ¬èƒ½åŠ›ã€‚&lt;br/&gt;&lt;br/&gt;å½“å‰æˆ‘ä»¬æ­£é€æ­¥å°†è¶Šæ¥è¶Šå¤šçš„ä¸šåŠ¡æ•°æ®å‘ TiDB è¿ç§»ï¼Œç›®å‰åœ¨ TiDB ä¸Šæˆ‘ä»¬åªèƒ½ä½¿ç”¨ SQL Like å¯¹å†…å®¹è¿›è¡Œç®€å•çš„æ£€ç´¢ã€‚ä½†å³ä¾¿ä¸è€ƒè™‘æ€§èƒ½é—®é¢˜ï¼ŒSQL Like ä»ç„¶æ— æ³•å®ç°ä¸€äº›åœ¨æœç´¢åœºæ™¯ä¸‹å¸¸è§çš„ä¿¡æ¯æ£€ç´¢éœ€æ±‚ï¼Œä¾‹å¦‚ä¸‹å›¾æ‰€ç¤ºçš„å‡ ç§åœºæ™¯ï¼Œå•çº¯ä½¿ç”¨ Like ä¼šå¯¼è‡´æŸ¥è¯¢åˆ°æœ‰æ­§ä¹‰çš„ç»“æœæˆ–æ»¡è¶³æœç´¢æ¡ä»¶çš„ç»“æœæ— æ³•è¿”å›ã€‚&lt;br/&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-3f79cd814896271be7784cb561953565_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;471&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-3f79cd814896271be7784cb561953565_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-3f79cd814896271be7784cb561953565_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;471&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic2.zhimg.com/v2-3f79cd814896271be7784cb561953565_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-3f79cd814896271be7784cb561953565_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;å½“å‰ TiDB å…¨æ–‡æ£€ç´¢èƒ½åŠ›çš„ç¼ºå¤±ï¼Œä½¿å¾—æˆ‘ä»¬ä¾æ—§éœ€è¦ä½¿ç”¨ä¼ ç»Ÿçš„æ–¹å¼å°†æ•°æ®åŒæ­¥åˆ°æœç´¢å¼•æ“ï¼Œåœ¨è¿‡ç¨‹ä¸­éœ€è¦æ ¹æ®ä¸šåŠ¡ç‰¹ç‚¹åšå¤§é‡ç¹ççš„æ•°æ®æµæ°´çº¿å·¥ä½œç»´æŠ¤ä¸šåŠ¡æ•°æ®çš„å…¨æ–‡ç´¢å¼•ã€‚ä¸ºäº†å‡å°‘è¿™æ ·çš„é‡å¤åŠ³åŠ¨ï¼Œåœ¨ä»Šå¹´ &lt;u&gt;&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//mp.weixin.qq.com/s%3F__biz%3DMzI3NDIxNTQyOQ%3D%3D%26mid%3D2247490046%26idx%3D1%26sn%3D962bb8aa4619c3815fcc561ed96331d7%26chksm%3Deb163e94dc61b7826b7e73a057f4c9823261c1a79005104dd41dbd6ef4276c01bd6e41a69d14%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TiDB Hackathon&lt;/a&gt;&lt;/u&gt; ä¸­æˆ‘ä»¬å°è¯•ä¸º TiDB å¼•å…¥â€œå…¨æ–‡æ£€ç´¢â€åŠŸèƒ½ï¼Œä¸ºå­˜å‚¨åœ¨ TiDB ä¸­çš„æ–‡æœ¬æ•°æ®æä¾›éšæ—¶éšåœ°æœç´¢çš„èƒ½åŠ›ã€‚ä»¥ä¸‹æ˜¯æœ€ç»ˆçš„æ•ˆæœå±•ç¤ºï¼š&lt;br/&gt;&lt;br/&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-4446cea979a0fe1eb26efe31ee1c8aeb_b.gif&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;639&quot; data-rawheight=&quot;380&quot; data-thumbnail=&quot;https://pic4.zhimg.com/v2-4446cea979a0fe1eb26efe31ee1c8aeb_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;639&quot; data-original=&quot;https://pic4.zhimg.com/v2-4446cea979a0fe1eb26efe31ee1c8aeb_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-4446cea979a0fe1eb26efe31ee1c8aeb_b.gif&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;639&quot; data-rawheight=&quot;380&quot; data-thumbnail=&quot;https://pic4.zhimg.com/v2-4446cea979a0fe1eb26efe31ee1c8aeb_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;639&quot; data-original=&quot;https://pic4.zhimg.com/v2-4446cea979a0fe1eb26efe31ee1c8aeb_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-4446cea979a0fe1eb26efe31ee1c8aeb_b.gif&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;br/&gt;&lt;br/&gt;&lt;b&gt;æ–¹æ¡ˆè®¾è®¡&lt;/b&gt;&lt;br/&gt;è¦åœ¨çŸ­çŸ­ä¸€å¤©çš„ Hackathon æ—¶é—´å†…è®© TiDB ä¸­æ”¯æŒå…¨æ–‡æ£€ç´¢ï¼Œéš¾åº¦è¿˜æ˜¯éå¸¸å¤§çš„ï¼Œäºæ˜¯åœ¨æœ€å¼€å§‹çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±é€‰æ‹©äº†ä¸€æ¡éå¸¸ç¨³å¦¥çš„è®¾è®¡æ–¹æ¡ˆ - é‡‡ç”¨æ•´åˆ &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//www.elastic.co/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Elasticsearch&lt;/a&gt;ï¼ˆåç»­ç®€ç§° ESï¼‰ çš„æ–¹å¼ä¸º TiDB æ‰©å±•å…¨æ–‡æ£€ç´¢èƒ½åŠ›ã€‚&lt;br/&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-7c21a68c4e684244ee7e1ac743653262_b.gif&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;639&quot; data-rawheight=&quot;310&quot; data-thumbnail=&quot;https://pic3.zhimg.com/v2-7c21a68c4e684244ee7e1ac743653262_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;639&quot; data-original=&quot;https://pic3.zhimg.com/v2-7c21a68c4e684244ee7e1ac743653262_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-7c21a68c4e684244ee7e1ac743653262_b.gif&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;639&quot; data-rawheight=&quot;310&quot; data-thumbnail=&quot;https://pic3.zhimg.com/v2-7c21a68c4e684244ee7e1ac743653262_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;639&quot; data-original=&quot;https://pic3.zhimg.com/v2-7c21a68c4e684244ee7e1ac743653262_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-7c21a68c4e684244ee7e1ac743653262_b.gif&quot;/&gt;&lt;/figure&gt;&lt;p&gt;ä¸ºä»€ä¹ˆé€‰æ‹© ESï¼Ÿä¸€æ–¹é¢æˆ‘ä»¬å¯ä»¥å……åˆ†åˆ©ç”¨ ES æˆç†Ÿçš„ç”Ÿæ€ç›´æ¥è·å¾—ä¸­æ–‡åˆ†è¯å’Œ query ç†è§£èƒ½åŠ›ã€‚å¦å¤–ç”Ÿæ€èåˆæ‰€å¸¦æ¥çš„å¼ºå¼ºè”åˆæ•ˆåº”ï¼Œä¹Ÿç¬¦åˆ TiDB å´‡å°šç¤¾åŒºåˆä½œçš„ä»·å€¼è§‚ã€‚è€ƒè™‘åˆ°å·¥ä½œé‡ï¼Œå¯¹äºå…¨æ–‡ç´¢å¼•çš„æ•°æ®åŒæ­¥æ–¹æ¡ˆæˆ‘ä»¬æ²¡æœ‰é‡‡ç”¨ TiKV &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/tikv/tikv/issues/2475&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Raft Learner&lt;/a&gt; æœºåˆ¶ï¼Œä¹Ÿæ²¡æœ‰ä½¿ç”¨ &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/pingcap/tidb-binlog&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TiDB Binlog&lt;/a&gt; çš„æ–¹å¼è¿›è¡ŒåŒæ­¥ï¼Œè€Œæ˜¯é‡‡ç”¨äº†æœ€ä¿å®ˆçš„åŒå†™æœºåˆ¶ç›´æ¥åœ¨ TiDB çš„å†™å…¥æµç¨‹ä¸­å¢åŠ äº†å…¨æ–‡ç´¢å¼•æ›´æ–°çš„æµç¨‹ã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-20928a5a4d50deff0a204f376439c78a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;938&quot; data-rawheight=&quot;602&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;938&quot; data-original=&quot;https://pic3.zhimg.com/v2-20928a5a4d50deff0a204f376439c78a_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-20928a5a4d50deff0a204f376439c78a_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;938&quot; data-rawheight=&quot;602&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;938&quot; data-original=&quot;https://pic3.zhimg.com/v2-20928a5a4d50deff0a204f376439c78a_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-20928a5a4d50deff0a204f376439c78a_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;æ¶æ„å¦‚ä¸Šå›¾æ‰€ç¤ºï¼ŒTiDB ä½œä¸º ES å’Œ TiKV ä¹‹é—´çš„æ¡¥æ¢ï¼Œæ‰€æœ‰åŒ ES çš„äº¤äº’æ“ä½œéƒ½åµŒå…¥åœ¨ TiDB å†…éƒ¨ç›´æ¥å®Œæˆã€‚åœ¨ TiDB å†…éƒ¨ï¼Œæˆ‘ä»¬å°†è¡¨é¢å¤–å¢åŠ äº†æ”¯æŒ FULLTEXT ç´¢å¼•çš„å…ƒæ•°æ®è®°å½•ï¼Œå¹¶ä¸”åœ¨ ES ä¸Šé¢åˆ›å»ºäº†å¯¹åº”çš„ç´¢å¼•å’Œ &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//www.elastic.co/cn/blog/found-elasticsearch-mapping-introduction&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Mapping&lt;/a&gt;ï¼Œå¯¹äº FULLTEXT ç´¢å¼•ä¸­çš„æ¯ä¸€ä¸ªæ–‡æœ¬åˆ—ï¼Œæˆ‘ä»¬éƒ½å°†å®ƒæ·»åŠ åˆ° Mapping ä¸­å¹¶æŒ‡å®šå¥½éœ€è¦çš„ &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//www.elastic.co/cn/blog/found-text-analysis-part-1&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Analyzer&lt;/a&gt;ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨ç´¢å¼•ä¸Šå¯¹è¿™äº›æ–‡æœ¬åˆ—è¿›è¡Œå…¨æ–‡æ£€ç´¢äº†ã€‚åœ¨ ES çš„ç´¢å¼•çš„å¸®åŠ©ä¸‹ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨å†™å…¥æ•°æ®æˆ–è€…å¯¹æ•°æ®è¿›è¡Œæ›´æ–°çš„æ—¶å€™åœ¨ ES çš„ç´¢å¼•ä¸Šè¿›è¡Œå¯¹åº”çš„æ›´æ–°æ“ä½œï¼Œå°±ä¿æŒ TiDB å’Œ ES æ•°æ®çš„åŒæ­¥ã€‚è€Œå¯¹äºæŸ¥è¯¢ï¼Œç°åœ¨æµç¨‹å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;TiDB è§£æç”¨æˆ·å‘é€çš„ Queryã€‚&lt;/li&gt;&lt;li&gt;å¦‚æœå‘ç°è¯¥ Query å¸¦æœ‰å…¨æ–‡æ£€ç´¢çš„ hintï¼ŒTiDB åˆ™ä¼šå°†è¯·æ±‚å‘ç»™ ESï¼Œä½¿ç”¨ ES ç´¢å¼•æŸ¥è¯¢åˆ°è®°å½•ä¸»é”®ã€‚&lt;/li&gt;&lt;li&gt;TiDB æ‹¿åˆ°æ‰€æœ‰è®°å½•ä¸»é”®ä¹‹åï¼Œåœ¨ TiDB å†…éƒ¨è·å–å®é™…çš„æ•°æ®ï¼Œå®Œæˆæœ€ç»ˆçš„æ•°æ®è¯»å–ã€‚&lt;/li&gt;&lt;li&gt;TiDB å°†ç»“æœè¿”å›ç»™ç”¨æˆ·ã€‚&lt;br/&gt;&lt;br/&gt;&lt;b&gt;æœªæ¥è§„åˆ’&lt;/b&gt;&lt;br/&gt;Hackathon çŸ­çŸ­çš„ 24 å°æ—¶ï¼Œè®©æˆ‘ä»¬éªŒè¯äº†æ•´åˆ TiDB å’Œ ES çš„å¯èƒ½æ€§ï¼Œå½“ç„¶ï¼Œæˆ‘ä»¬ä¸ä¼šæ»¡è¶³äºè¿™å¥—åŒå†™çš„æ–¹æ¡ˆã€‚æœªæ¥æˆ‘ä»¬ä¼šå‚è€ƒ &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//medium.com/%40PingCAP/delivering-real-time-analytics-and-true-htap-by-combining-columnstore-and-rowstore-1e006d3c3ef5&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TiFlash&lt;/a&gt;ï¼ŒåŸºäº Raft Learner å®æ—¶å°†æ•°æ®å˜æ›´åŒæ­¥ç»™ ESï¼Œå°† TiDB æ‰“é€ æˆä¸€ä¸ªçœŸæ­£çš„èƒ½æ”¯æŒå®æ—¶å…¨æ–‡æ£€ç´¢çš„ HTAP æ•°æ®åº“ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/li&gt;&lt;/ol&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-eb3067e81b08d71bcad8cb3189329eb3_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;938&quot; data-rawheight=&quot;602&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;938&quot; data-original=&quot;https://pic4.zhimg.com/v2-eb3067e81b08d71bcad8cb3189329eb3_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-eb3067e81b08d71bcad8cb3189329eb3_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;938&quot; data-rawheight=&quot;602&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;938&quot; data-original=&quot;https://pic4.zhimg.com/v2-eb3067e81b08d71bcad8cb3189329eb3_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-eb3067e81b08d71bcad8cb3189329eb3_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;ä½¿ç”¨ Raft Learnerï¼Œå¯¹äºå†™æµç¨‹ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;TiDB ä¼šç›´æ¥å°†æ•°æ®å†™ç»™åº•å±‚çš„ TiKVã€‚&lt;/li&gt;&lt;li&gt;TiKV ä¼šé€šè¿‡ Raft åè®®å°†å†™å…¥æ•°æ®åŒæ­¥åˆ° ES Learner èŠ‚ç‚¹ï¼Œé€šè¿‡è¯¥ Learner èŠ‚ç‚¹å†™å…¥åˆ° ESã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;å¯¹äºè¯»æµç¨‹ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;TiDB è§£æåˆ°ç”¨æˆ·å‘è¿‡æ¥çš„ Query å¸¦æœ‰å…¨æ–‡æ£€ç´¢çš„ hintã€‚&lt;/li&gt;&lt;li&gt;TiDB å°†è¯·æ±‚å‘ç»™ ES Learner èŠ‚ç‚¹ã€‚&lt;/li&gt;&lt;li&gt;ES Learner èŠ‚ç‚¹é¦–å…ˆé€šè¿‡ Raft åè®®æ¥ç¡®ä¿èŠ‚ç‚¹ä¸Šé¢æœ‰äº†æœ€æ–°çš„æ•°æ®ï¼Œå¹¶ä¸”æœ€æ–°çš„æ•°æ®å·²ç»å†™å…¥åˆ° ESã€‚&lt;/li&gt;&lt;li&gt;ES Learner èŠ‚ç‚¹é€šè¿‡ ES çš„ç´¢å¼•è¯»å–åˆ°å¯¹åº”çš„è®°å½•ä¸»é”®ï¼Œè¿”å›ç»™ TiDBã€‚&lt;/li&gt;&lt;li&gt;TiDB ä½¿ç”¨è®°å½•ä¸»é”®è·å–åˆ°å®Œæ•´çš„æ•°æ®ï¼Œå¹¶è¿”å›ç»™å®¢æˆ·ç«¯ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;å¯ä»¥çœ‹åˆ°ï¼Œç›¸æ¯”äºä¹‹å‰è®© TiDB åŒå†™åˆ° ES å’Œ TiKV çš„æ–¹æ¡ˆï¼Œåœ¨å†™å…¥ä¸Šé¢ï¼ŒTiDB å¹¶ä¸éœ€è¦è·Ÿ ES è¿›è¡Œäº¤äº’ï¼Œè€Œåœ¨è¯»å–æ–¹é¢ï¼Œé€šè¿‡ Raft åè®®ï¼ŒTiDB ä¹Ÿèƒ½ä¿è¯ä» ES è¯»å–åˆ°æœ€æ–°çš„æ•°æ®ï¼Œä¿è¯äº†æ•°æ®çš„ä¸€è‡´æ€§ã€‚å½“ç„¶ï¼Œè¦å®ç°ä¸Šé¢çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦æ›´å¤šçš„å¸®åŠ©ï¼Œæˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿè·Ÿç¤¾åŒºå°ä¼™ä¼´ä¸€èµ·ï¼Œä¸€èµ·å®Œæˆè¿™ä¸ªéå¸¸é…·çš„ç‰¹æ€§ã€‚&lt;br/&gt;&lt;br/&gt;&lt;b&gt;å†™åœ¨æœ€å&lt;/b&gt;&lt;br/&gt;å¾—ç›Šäºä¸ªäººåœ¨çŸ¥ä¹æœç´¢å›¢é˜Ÿçš„çŸ­æš‚ç»å†ï¼Œå¯¹æœç´¢çš„ä»·å€¼å’Œä¸šåŠ¡æ¥å…¥æœç´¢çš„å·¥ä½œé‡æœ‰è¿‡å¾ˆç›´è§‚çš„æ„Ÿå—ã€‚åœ¨è¶Šæ¥è¶Šå¤šçš„æ•°æ®å­˜åœ¨äº TiDB çš„æ—¶ä»£ï¼Œéšæ—¶å¯ä»¥å¯¹ä¸šåŠ¡æ•°æ®çš„æŸäº›å­—æ®µè¿›è¡Œå…¨æ–‡æ£€ç´¢çš„ä»·å€¼å¾ˆå¤§ã€‚è¿™ä¸ªä»·å€¼ä¸ä½†ä½“ç°åœ¨èƒ½å¤Ÿå®ç°ä»¥å¾€ SQL éš¾ä»¥åšå¥½çš„ä¸€äº›äº‹æƒ…ï¼Œæ›´å¤§çš„æ„ä¹‰æ˜¯å°†å…¨æ–‡æ£€ç´¢çš„èƒ½åŠ›ä»¥æ¥è¿‘ free çš„æ–¹å¼æä¾›ç»™ä¸šåŠ¡æ–¹ï¼Œç»™ç”¨æˆ·æ­å»ºèµ·ä¸€åº§è¿æ¥å…³ç³»å‹æ•°æ®åº“ä¸æœç´¢å¼•æ“çš„æ¡¥æ¢ï¼Œåšåˆ°éšæ—¶å†™å…¥ï¼Œéšæ—¶æœç´¢ã€‚å¦‚æœä½ ä¹Ÿæœ‰è¿™æ–¹é¢çš„æƒ³æ³•ï¼Œæ¬¢è¿é‚®ä»¶è”ç³»æˆ‘ï¼ˆsunxiaoguang@zhihu.comï¼‰ã€‚&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>Xiaoyu Ma</author>
<guid isPermaLink="false">2019-12-10-96514042</guid>
<pubDate>Tue, 10 Dec 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>360 æ™ºèƒ½å•†ä¸šä¸šåŠ¡çº¿ç»éªŒåˆ†äº«ï¼šTiDB å†™çƒ­ç‚¹è°ƒä¼˜å®æˆ˜</title>
<link>https://henix.github.io/feeds/zhuanlan.newsql/2019-12-09-96095292.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/96095292&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-531b791e16a674af439a2da8666f0e31_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;blockquote&gt;&lt;b&gt;ä½œè€…ä»‹ç»&lt;/b&gt;ï¼šä»£æ™“ç£Šï¼Œç° 360 å•†ä¸šåŒ–æ•°æ®åº“è¿ç»´ä¸“å®¶ï¼ŒTiDB User Group Ambassadorï¼Œè´Ÿè´£æ•´ä¸ªæ™ºèƒ½å•†ä¸šä¸šåŠ¡çº¿æ•°æ®åº“è¿ç»´ï¼Œè§£å†³å„ç§æ•°æ®åº“ç–‘éš¾é—®é¢˜ï¼Œæ¨å¹¿ TiDB ç­‰æ–°å¼€æºæ•°æ®åº“åº”ç”¨ã€‚&lt;/blockquote&gt;&lt;p&gt;360 æ™ºèƒ½å•†ä¸šä¸šåŠ¡çº¿ä» 2019 å¹´ 3 æœˆä»½å¼€å§‹ä½¿ç”¨ TiDBï¼Œç›®å‰çº¿ä¸Šæœ‰ 5 å¥— TiDB é›†ç¾¤ï¼Œæ•°æ®æ€»å®¹é‡ 20Tï¼Œä¸»è¦åº”ç”¨åœ¨æ•°æ®åˆ†æå¹³å°ã€å¹¿å‘Šä¸»å®æ—¶æŠ¥è¡¨ã€ç‰©æ–™åº“ã€å®æ—¶ç›‘æ§å¹³å°ç­‰æ ¸å¿ƒä¸šåŠ¡ä¸­ã€‚&lt;/p&gt;&lt;p&gt;åœ¨ä½¿ç”¨ TiDB çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿé‡åˆ°è¿‡ä¸€äº›é—®é¢˜ï¼Œç§¯æ”’äº†ä¸€äº›ç»éªŒã€‚ç”±äºç¯‡å¹…æœ‰é™ï¼Œä¸‹é¢ä¸»è¦åˆ†äº«å†™çƒ­ç‚¹é—®é¢˜ç°è±¡å’Œå¯¹åº”çš„è§£å†³æ–¹æ¡ˆï¼Œå¸Œæœ›èƒ½å¤Ÿèƒ½å¯¹å…¶ä»– TiDB ç”¨æˆ·æœ‰æ‰€å¸®åŠ©ã€‚&lt;/p&gt;&lt;h2&gt;ä¸šåŠ¡ç®€ä»‹ä»¥åŠæ•°æ®åº“é€‰å‹&lt;/h2&gt;&lt;h3&gt;360 æ™ºèƒ½å•†ä¸šä¸šåŠ¡çº¿å¹¿å‘Šä¸»å®æ—¶æŠ¥è¡¨ä¸šåŠ¡ç®€ä»‹&lt;/h3&gt;&lt;p&gt;å¹¿å‘Šä¸»å…³é”®è¯å®æ—¶ç»Ÿè®¡æŠ¥è¡¨ä¸šåŠ¡çš„æµç¨‹æ˜¯ï¼šä¸šåŠ¡æ•°æ®é¦–å…ˆè¿›å…¥ Kafkaï¼Œæ¯ 30 ç§’ä¼šæœ‰ç¨‹åºè¯» Kafka æ•°æ®ï¼Œå¹¶è¿›è¡Œèšåˆï¼Œç„¶åå­˜å‚¨åˆ° TiDB ä¸­ï¼Œå­˜å‚¨åˆ° TiDB çš„è¿‡ç¨‹æ¯æ‰¹æ¬¡ä¼šæœ‰å‡ åä¸‡çš„å†™å…¥ï¼Œå•è¡¨æ•°æ®é‡1.2~1.5 äº¿ã€‚&lt;/p&gt;&lt;p&gt;ä¸šåŠ¡å†™å…¥ SQL ä¸»è¦æ˜¯ï¼šinsert on duplicate key updateï¼ŒBatch ä¸º 100ï¼Œå¹¶å‘ä¸º 300ï¼Œå¹¶ä¸”æ¯å¤©åˆ›å»ºä¸€å¼ æ–°è¡¨è¿›è¡Œå†™å…¥ã€‚å†™å…¥åˆæœŸç”±äºæ²¡æœ‰é‡å¤çš„ &lt;code&gt;uniq_key&lt;/code&gt;ï¼Œæ‰€ä»¥ä¸»è¦æ˜¯ insert ã€‚éšç€æ•°æ®é‡åˆ°è¾¾ 2000 å¤šä¸‡ï¼Œupdate çš„æ“ä½œä¹Ÿè¶Šæ¥è¶Šå¤šã€‚&lt;/p&gt;&lt;p&gt;è¡¨ç»“æ„å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-cbcaabce395fa44fccd0d97d99aece17_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;864&quot; data-rawheight=&quot;387&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;864&quot; data-original=&quot;https://pic4.zhimg.com/v2-cbcaabce395fa44fccd0d97d99aece17_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-cbcaabce395fa44fccd0d97d99aece17_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;864&quot; data-rawheight=&quot;387&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;864&quot; data-original=&quot;https://pic4.zhimg.com/v2-cbcaabce395fa44fccd0d97d99aece17_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-cbcaabce395fa44fccd0d97d99aece17_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;h3&gt;æ•°æ®åº“é€‰å‹ï¼šMySQL or TiDB?&lt;/h3&gt;&lt;p&gt;è¯´åˆ° TiDB ä¸å¾—ä¸æå…¶æ¶æ„ã€‚ä¸‹é¢ç»“åˆæ¶æ„å›¾ç®€å•ä»‹ç»ä¸€ä¸‹ TiDB å¯¹äºæˆ‘ä»¬æ¥è¯´æœ€æœ‰å¸å¼•åŠ›çš„ç‰¹æ€§ã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-f082b71edbcf06ebffef528905f684ce_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1996&quot; data-rawheight=&quot;1112&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1996&quot; data-original=&quot;https://pic3.zhimg.com/v2-f082b71edbcf06ebffef528905f684ce_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-f082b71edbcf06ebffef528905f684ce_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1996&quot; data-rawheight=&quot;1112&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1996&quot; data-original=&quot;https://pic3.zhimg.com/v2-f082b71edbcf06ebffef528905f684ce_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-f082b71edbcf06ebffef528905f684ce_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;ol&gt;&lt;li&gt;å¯åœ¨çº¿æ‰©å±•ï¼šTiDB Server/PD/TiKV è¿™ 3 å¤§æ ¸å¿ƒæ¨¡å—å„å¸å…¶èŒï¼Œå¹¶ä¸”æ”¯æŒåœ¨çº¿æ‰©å®¹ï¼Œregion è‡ªåŠ¨ balanceï¼Œè¿ç§»è¿‡ç¨‹å¯¹ä¸šåŠ¡æ— æ„ŸçŸ¥ã€‚&lt;/li&gt;&lt;li&gt;é«˜å¯ç”¨ï¼šåŸºäº Raft çš„å¤šæ•°æ´¾é€‰ä¸¾åè®®å®ç°äº†é‡‘èçº§åˆ«çš„æ•°æ®å¼ºä¸€è‡´æ€§ä¿è¯ï¼Œä¸”åœ¨ä¸ä¸¢å¤±å¤§å¤šæ•°å‰¯æœ¬çš„å‰æä¸‹ï¼Œå¯ä»¥å®ç°æ•…éšœçš„è‡ªåŠ¨æ¢å¤ (auto-failover)ï¼Œæ— éœ€äººå·¥ä»‹å…¥ã€‚&lt;/li&gt;&lt;li&gt;æ— ç¼è¿ç§»ï¼šæ”¯æŒ MySQL åè®®ï¼Œä¸šåŠ¡è¿ç§»æ— éœ€ä¿®æ”¹ä»£ç ã€‚&lt;/li&gt;&lt;li&gt;ä¸°å¯Œçš„ç›‘æ§+è¿ç»´å·¥å…·ï¼š&lt;/li&gt;&lt;/ol&gt;&lt;ul&gt;&lt;li&gt;ç›‘æ§ï¼šåŸºäº Prometheus + Grafana çš„ä¸°å¯Œç›‘æ§æ¨¡æ¿ï¼›&lt;/li&gt;&lt;li&gt;è¿ç»´å·¥å…·ï¼šTiDB Ansible éƒ¨ç½²+è¿ç»´ï¼›&lt;/li&gt;&lt;li&gt;TiDB Data Migration(DM)ï¼šå°†æ•°æ®ä» MySQL è¿ç§»+åŒæ­¥çš„å·¥å…·ï¼›&lt;/li&gt;&lt;li&gt;TiDB Lightningï¼šå¯ä»¥ä» CSV æ–‡ä»¶æˆ–è€…ç¬¬ä¸‰æ–¹æ•°æ®æºå°†æ•°æ®ç›´æ¥å¯¼å…¥åˆ° TiKVï¼›&lt;/li&gt;&lt;li&gt;TiDB Binlogï¼šå¤‡ä»½å·¥å…·ï¼Œä¹Ÿå¯ä»¥é‡æ”¾åˆ° Kafka/MySQL/TiDB ç­‰æ•°æ®åº“ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;TiDB æœ€æ ¸å¿ƒçš„åº”ç”¨åœºæ™¯æ˜¯ï¼šå¤§æ•°æ®é‡ä¸‹çš„åˆ†åº“åˆ†è¡¨ï¼Œæ¯”å¦‚ç»å¸¸éœ€è¦ 1 æ‹† 4ï¼Œ4 æ‹† 8 ç­‰æ•°æ®åº“æ— é™åˆ¶æ‹†åˆ†æƒ…å†µï¼Œå¹¶ä¸”ä¸šåŠ¡ç«¯è¿˜éœ€è¦è‡ªå·±ç»´æŠ¤è·¯ç”±è§„åˆ™ï¼ŒTiDB è‰¯å¥½çš„æ‰©å±•æ€§è§£å†³äº†è¿™äº›é—®é¢˜ã€‚&lt;/p&gt;&lt;p&gt;ä¸ºäº†èƒ½æ»¡è¶³è¿™ä¹ˆå¤§çš„å†™å…¥é‡ï¼Œæˆ‘ä»¬å…¶å®æ›¾ç»å°è¯•è¿‡å•å®ä¾‹ MySQL å»æŠ—è¯·æ±‚ï¼Œæµ‹è¯•å®Œåå‘ç°å•å®ä¾‹ MySQL å‹åŠ›è¾ƒå¤§ï¼Œå¦‚æœè¦åˆ†æ•£å†™å‹åŠ›ä¸”ä¸æ”¹å˜æ¶æ„ï¼Œé‚£ä¹ˆåˆè¦èµ° MySQL åˆ†åº“åˆ†è¡¨è¿™ç§è€è·¯ï¼ŒTiDB 3.0 GA å‘å¸ƒä¹‹åï¼Œæˆ‘ä»¬æ‹¿ç¦»çº¿æ•°æ®è¿›è¡Œäº†å‹æµ‹ï¼Œ2 å°æ—¶ 1.5 äº¿çš„æ•°æ®å­˜å‚¨ (tps:2W/s)ï¼Œæ•´ä¸ªç³»ç»Ÿè´Ÿè½½è‰¯å¥½ï¼Œæ‰€ä»¥æˆ‘ä»¬æœ€ç»ˆå†³å®šä½¿ç”¨ TiDBã€‚&lt;/p&gt;&lt;h3&gt;ç³»ç»Ÿé…ç½®åŠéƒ¨ç½²æ¶æ„&lt;/h3&gt;&lt;p&gt;&lt;b&gt;æœåŠ¡å™¨ç¡¬ä»¶é…ç½®&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;CPU:E5-2630v2*2&lt;/li&gt;&lt;li&gt;Mem:16G DDR3*8&lt;/li&gt;&lt;li&gt;Diskï¼š&lt;/li&gt;&lt;ul&gt;&lt;li&gt;Intel S3500 300G*1&lt;/li&gt;&lt;li&gt;flash:å®å­˜1.6T*1&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;Net:1000M*2&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;æœåŠ¡å™¨ç³»ç»Ÿç‰ˆæœ¬&lt;/b&gt; ï¼šCentOS Linux release 7.4.1708 (Core) &lt;/p&gt;&lt;p&gt;&lt;b&gt;TiDB çš„ç‰ˆæœ¬&lt;/b&gt; ï¼štidb-ansible-3.0.0&lt;/p&gt;&lt;p&gt;&lt;b&gt;è§„æ¨¡&lt;/b&gt; ï¼š2.8 äº¿/å¤©&lt;/p&gt;&lt;p&gt;&lt;b&gt;å­˜å‚¨&lt;/b&gt; ï¼š3.8T&lt;/p&gt;&lt;p&gt;&lt;b&gt;TiDB éƒ¨ç½²æ¶æ„å›¾&lt;/b&gt; ï¼š&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-60a8ec27a74edc4a0339c2b57d16e0aa_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;864&quot; data-rawheight=&quot;554&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;864&quot; data-original=&quot;https://pic3.zhimg.com/v2-60a8ec27a74edc4a0339c2b57d16e0aa_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-60a8ec27a74edc4a0339c2b57d16e0aa_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;864&quot; data-rawheight=&quot;554&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;864&quot; data-original=&quot;https://pic3.zhimg.com/v2-60a8ec27a74edc4a0339c2b57d16e0aa_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-60a8ec27a74edc4a0339c2b57d16e0aa_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;blockquote&gt;æ³¨ï¼šPD è·Ÿ TiDB å…±ç”¨æœåŠ¡å™¨&lt;/blockquote&gt;&lt;h2&gt;å†™çƒ­ç‚¹é—®é¢˜ä¼˜åŒ–å®è·µ&lt;/h2&gt;&lt;h3&gt;çƒ­ç‚¹ç°è±¡æè¿°&lt;/h3&gt;&lt;p&gt;ä¸šåŠ¡æ–¹å‘æˆ‘ä»¬åé¦ˆä» 7 æœˆä»½å¼€å§‹ï¼Œ Kafka é˜Ÿåˆ—é‡Œé¢æœ‰å¤§é‡çš„æ•°æ®ç´¯ç§¯ï¼Œç­‰å¾…å†™å…¥TiDBã€‚Kafka é«˜å³°æœŸçš„å¾…å†™å…¥ lag æœ‰ 3000 å¤šä¸‡ï¼Œæ¥å£çš„è°ƒç”¨æ—¶é—´ç”±ä¹‹å‰çš„ 1s å˜æˆç°åœ¨çš„ 3s-5sã€‚æˆ‘ä»¬ç™»å½• TiDB å‘ç°ï¼Œå•è¡¨çš„æ•°æ®é‡ç”±ä¹‹å‰çš„ 7000 é£™å‡åˆ° 1.2-1.5 äº¿ï¼Œè™½ç„¶æ•°æ®é‡å‡ ä¹ç¿»äº†ä¸€å€ï¼Œä½†å•æ¡ insert çš„æ€§èƒ½åº”è¯¥ä¸è‡³äºè¿™ä¹ˆå·®ï¼Œäºæ˜¯å¼€å§‹ç€æ‰‹å®šä½é—®é¢˜ã€‚&lt;/p&gt;&lt;p&gt;ä¸‹å›¾æ˜¯ Kafka å½“æ—¶çš„å¾…å†™å…¥çš„ lag æƒ…å†µï¼š&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-bbda2928191e1d247fa7b5cc4a2f40ba_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;864&quot; data-rawheight=&quot;431&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;864&quot; data-original=&quot;https://pic3.zhimg.com/v2-bbda2928191e1d247fa7b5cc4a2f40ba_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-bbda2928191e1d247fa7b5cc4a2f40ba_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;864&quot; data-rawheight=&quot;431&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;864&quot; data-original=&quot;https://pic3.zhimg.com/v2-bbda2928191e1d247fa7b5cc4a2f40ba_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-bbda2928191e1d247fa7b5cc4a2f40ba_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;æŸ¥çœ‹ Grafana Overview ç›‘æ§ï¼Œé€šè¿‡ TiKV ç›‘æ§é¡¹ â€œscheduler pending commandsâ€ï¼Œå‘ç° TiKV 227 èŠ‚ç‚¹å¤§é‡ç­‰å¾…çš„å‘½ä»¤ã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-74c360a2d8cd339786aafefd7a5a5a65_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;864&quot; data-rawheight=&quot;318&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;864&quot; data-original=&quot;https://pic2.zhimg.com/v2-74c360a2d8cd339786aafefd7a5a5a65_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-74c360a2d8cd339786aafefd7a5a5a65_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;864&quot; data-rawheight=&quot;318&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;864&quot; data-original=&quot;https://pic2.zhimg.com/v2-74c360a2d8cd339786aafefd7a5a5a65_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-74c360a2d8cd339786aafefd7a5a5a65_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;é€šè¿‡ TiKV ç›‘æ§é¡¹â€œCPU ä½¿ç”¨â€ä¹Ÿå¯ä»¥çœ‹å‡ºçƒ­ç‚¹éƒ½é›†ä¸­åœ¨ 227 è¿™ä¸ª TiKV èŠ‚ç‚¹ä¸Šã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-5797ee94a831a8ac7555ebf069e76654_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;864&quot; data-rawheight=&quot;312&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;864&quot; data-original=&quot;https://pic1.zhimg.com/v2-5797ee94a831a8ac7555ebf069e76654_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-5797ee94a831a8ac7555ebf069e76654_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;864&quot; data-rawheight=&quot;312&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;864&quot; data-original=&quot;https://pic1.zhimg.com/v2-5797ee94a831a8ac7555ebf069e76654_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-5797ee94a831a8ac7555ebf069e76654_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;h3&gt;è§£å†³æ–¹æ¡ˆ&lt;/h3&gt;&lt;p&gt;ä¸€èˆ¬æ¥è¯´æœ‰ä¸‰ä¸ªä¼˜åŒ–æ–¹æ³•ï¼šæ‰‹åŠ¨ split çƒ­ç‚¹ã€å‚æ•°ä¼˜åŒ–ã€è¡¨ç»“æ„ä¼˜åŒ–ï¼Œå¤§å®¶å¯ä»¥æ ¹æ®çº¿ä¸Šå†™çƒ­ç‚¹è¡¨çš„è¡¨ç»“æ„ä¸åŒè€Œé‡‡ç”¨ä¸åŒçš„ä¼˜åŒ–æ–¹æ¡ˆã€‚&lt;/p&gt;&lt;p&gt;å¯¹äº PK éæ•´æ•°æˆ–æ²¡æœ‰ PK çš„è¡¨ï¼Œæ•°æ®åœ¨ Insert æ—¶ï¼ŒTiDB ä¼šä½¿ç”¨ä¸€ä¸ªéšå¼çš„è‡ªå¢ rowidï¼Œå¤§é‡çš„ Insert ä¼šæŠŠæ•°æ®é›†ä¸­å†™å…¥å•ä¸ª Regionï¼Œé€ æˆå†™çƒ­ç‚¹ã€‚&lt;/p&gt;&lt;p&gt;æ­¤æ—¶å¯ä»¥ä½¿ç”¨ &lt;code&gt;SHARD_ROW_ID_BITS&lt;/code&gt; æ¥æ‰“æ•£çƒ­ç‚¹ï¼Œå¦‚æœä¸šåŠ¡è¡¨å¯ä»¥æ–°å»ºçš„è¯(æ¯”å¦‚æˆ‘ä»¬çš„æŠ¥è¡¨ä¸šåŠ¡æ˜¯æŒ‰å¤©åˆ†è¡¨)ï¼Œå¯ä»¥ç»“åˆ pre-split-regions å±æ€§ä¸€èµ·åœ¨å»ºè¡¨é˜¶æ®µå°±å°† Region æ‰“æ•£ã€‚å¦‚æœä¸æ»¡è¶³ä¸Šé¢çš„è¡¨ç»“æ„ï¼ˆæ¯”å¦‚å°±æ˜¯ä»¥è‡ªå¢ ID ä¸ºä¸»é”®çš„è¡¨ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨æ‰‹åŠ¨ split region åŠŸèƒ½ã€‚ä¸Šé¢çš„ä¸¤ç§æ–¹æ³•éƒ½éœ€è¦ PD çš„å‚æ•°è°ƒæ•´æ¥åŠ å¿«çƒ­ç‚¹ Region çš„è°ƒåº¦ã€‚&lt;/p&gt;&lt;h3&gt;æ‰‹åŠ¨ split çƒ­ç‚¹&lt;/h3&gt;&lt;p&gt;å› ä¸ºæˆ‘ä»¬çš„è¡¨ç»“æ„æ˜¯ ID è‡ªå¢ä¸»é”®ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆä½¿ç”¨æ‰‹åŠ¨ split çƒ­ç‚¹ã€‚&lt;/p&gt;&lt;p&gt;1. æ‰¾å‡ºçƒ­ç‚¹ TiKV çš„ Store Number&lt;/p&gt;&lt;p&gt;åœ¨ tidb-ansible çš„ scripts ç›®å½•ä¸‹ table-regions.py è„šæœ¬å¯ä»¥æŸ¥çœ‹çƒ­ç‚¹è¡¨å’Œç´¢å¼• Region åˆ†å¸ƒæƒ…å†µï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;python table-regions.py --host=tidb_host â€“port=10080 db_name tb_name
[RECORD â€“ db_name.tb_name] - Leaders Distribution:
total leader count: 282
store: 1, num_leaders: 1, percentage: 0.35%
store: 4, num_leaders: 13, percentage: 4.61%
store: 5, num_leaders: 16, percentage: 5.67%
store: 7, num_leaders: 252, percentage: 89.36%
~~~~~~~~~~~~~~~~~~~~~~~~~~~&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;é€šè¿‡æ‰§è¡Œä¸Šé¢çš„å‘½ä»¤ï¼Œèƒ½æŸ¥çœ‹çƒ­ç‚¹è¡¨éƒ½åœ¨ store 7(227 æœåŠ¡å™¨) è¿™ä¸ª TiKV èŠ‚ç‚¹ã€‚&lt;/p&gt;&lt;p&gt;2. æŸ¥çœ‹çƒ­ç‚¹çš„è¡¨ Regions åˆ†å¸ƒ&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;curl http:// ${tidb_host}:10080/tables/db_name/tb_name/regions &amp;gt; regions.log&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;3. æ‰‹åŠ¨åˆ‡åˆ† Region&lt;/p&gt;&lt;p&gt;åˆ‡åˆ†å‘½ä»¤å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;pd-ctl -u http:// ${pd_host}:2379 operator add split-region region_id&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä½¿ç”¨å‘½ä»¤æ‰¾å‡º Store7 çš„ Region IDï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;grep -B 3 &amp;#34;: 7&amp;#34; regions.log |grep &amp;#34;region_id&amp;#34;|awk -F&amp;#39;: &amp;#39; &amp;#39;{print $2}&amp;#39;|awk -F&amp;#39;,&amp;#39; &amp;#39;{print &amp;#34;pd-ctl -u http://pd_host:2379 operator add split-region&amp;#34;,$1}&amp;#39; &amp;gt; split_region.sh&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;4. æ‰§è¡Œåˆ‡åˆ†è„šæœ¬å°±å®ç°äº† Region åˆ‡åˆ†&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;sh split_region.sh&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;å‚æ•°ä¼˜åŒ–&lt;/b&gt;&lt;/p&gt;&lt;p&gt;1. è°ƒæ•´ PD è°ƒåº¦å‚æ•°&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;pd-ctl -u http://pd_host:2379 config set å‚æ•°å€¼
    &amp;#34;hot-region-schedule-limit&amp;#34;: 8  
&amp;#34;leader-schedule-limit&amp;#34;: 8,     
&amp;#34;region-schedule-limit&amp;#34;: 16&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¸Šé¢ 3 ä¸ªå‚æ•°åˆ†åˆ«æ˜¯æ§åˆ¶è¿›è¡Œ hot-region\leader\region è°ƒåº¦çš„ä»»åŠ¡ä¸ªæ•°ã€‚è¿™ä¸ªå€¼ä¸»è¦å½±å“ç›¸åº” Region balance çš„é€Ÿåº¦ï¼Œå€¼è¶Šå¤§è°ƒåº¦å¾—è¶Šå¿«ï¼Œä½†æ˜¯ä¹Ÿä¸å®œè¿‡å¤§ï¼Œå¯ä»¥å…ˆå¢åŠ ä¸€å€çœ‹æ•ˆæœã€‚&lt;/p&gt;&lt;p&gt;2. TiKV å‚æ•°ä¹‹ï¼šsync-log&lt;/p&gt;&lt;p&gt;è·Ÿ MySQL çš„ &lt;code&gt;innodb_flush_log_at_trx_commit(0,1,2)&lt;/code&gt; ç±»ä¼¼ï¼ŒTiDB ä¹Ÿæœ‰ä¸€ä¸ª sync-log å‚æ•°ï¼Œè¯¥å‚æ•°æ§åˆ¶æ•°æ®ã€log è½ç›˜æ˜¯å¦ syncã€‚æ³¨æ„ï¼šå¦‚æœæ˜¯éé‡‘èå®‰å…¨çº§åˆ«çš„ä¸šåŠ¡åœºæ™¯ï¼Œå¯ä»¥è€ƒè™‘è®¾ç½®æˆ falseï¼Œä»¥ä¾¿è·å¾—æ›´é«˜çš„æ€§èƒ½ï¼Œä½†å¯èƒ½ä¼šä¸¢æ•°æ®ã€‚&lt;/p&gt;&lt;p&gt;è¯¥å‚æ•°æ˜¯ TiKV å‚æ•°ï¼Œéœ€è¦è°ƒæ•´ tidb-ansible ä¸‹ conf ç›®å½•ä¸­ tikv.ymlï¼Œç„¶åä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ï¼Œåªæ»šåŠ¨å‡çº§ TiKV èŠ‚ç‚¹ã€‚&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;ansible-playbook rolling_update.yml --tags=tikv&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;blockquote&gt;æ³¨ï¼šæœ¬æ¬¡ä¼˜åŒ–ä¿æŒé»˜è®¤ &lt;code&gt;true&lt;/code&gt;ã€‚&lt;/blockquote&gt;&lt;p&gt;&lt;b&gt;ä¸‹é¢ä»‹ç»å‡ ä¸ªæŸ¥çœ‹å‚æ•°ä¼˜åŒ–æ•ˆæœçš„æ–¹å¼ï¼š&lt;/b&gt;&lt;/p&gt;&lt;p&gt;1. é€šè¿‡å‘½ä»¤æŸ¥çœ‹ Leader è°ƒåº¦æƒ…å†µ&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;pd-ctl -u http:// ${pd_host}:2379 operator show leader&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;2. é€šè¿‡ Grafana ç›‘æ§å›¾æŸ¥çœ‹&lt;/p&gt;&lt;p&gt;åœ¨ PD ç›‘æ§æ¨¡å—ä¸­æ‰¾åˆ° Scheduler æ¨¡å—-&amp;gt;Scheduler is running-&amp;gt;balance-hot-region-schedulerï¼Œbalance-hot-region-scheduler æœ‰å€¼ï¼Œåˆ™ä»£è¡¨æœ‰çƒ­ç‚¹ Region è°ƒåº¦ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-b126c8793ac30ca6e7c6971e5d745eef_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;864&quot; data-rawheight=&quot;247&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;864&quot; data-original=&quot;https://pic4.zhimg.com/v2-b126c8793ac30ca6e7c6971e5d745eef_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-b126c8793ac30ca6e7c6971e5d745eef_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;864&quot; data-rawheight=&quot;247&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;864&quot; data-original=&quot;https://pic4.zhimg.com/v2-b126c8793ac30ca6e7c6971e5d745eef_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-b126c8793ac30ca6e7c6971e5d745eef_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;åœ¨ PD ç›‘æ§æ¨¡æ¿ä¸­æ‰¾åˆ° Operator-&amp;gt;Schedule operator create-&amp;gt;balance-leaderï¼Œè¿™ä¸ªå‚æ•°ä»£è¡¨å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-f1e7d9a8fe5d3866241773e5855341d4_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;864&quot; data-rawheight=&quot;354&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;864&quot; data-original=&quot;https://pic1.zhimg.com/v2-f1e7d9a8fe5d3866241773e5855341d4_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-f1e7d9a8fe5d3866241773e5855341d4_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;864&quot; data-rawheight=&quot;354&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;864&quot; data-original=&quot;https://pic1.zhimg.com/v2-f1e7d9a8fe5d3866241773e5855341d4_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-f1e7d9a8fe5d3866241773e5855341d4_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;ç„¶åä» Overview ä¸­ï¼ŒæŸ¥çœ‹ TiKV æ¨¡å—çš„ Leaderã€Regionï¼ŒCPUã€Scheduler Pending Commands ç­‰å˜åŒ–æƒ…å†µï¼Œå¯¹ä¼˜åŒ–æ•ˆæœè¿›è¡Œç»¼åˆåˆ†æã€‚&lt;/p&gt;&lt;h3&gt;ç»ˆæå¤§æ‹›ä¹‹è¡¨ç»“æ„ä¼˜åŒ–&lt;/h3&gt;&lt;p&gt;æˆ‘ä»¬å‘ç°é€šè¿‡æ‰‹ split çš„æ–¹å¼å¹¶æ²¡æœ‰è¾ƒå¥½åœ°è§£å†³ä¸šåŠ¡çš„å†™çƒ­ç‚¹é—®é¢˜ï¼Œæ‰€ä»¥åˆé‡‡ç”¨äº†&lt;code&gt;SHARD_ROW_ID_BITS&lt;/code&gt; ç»“åˆ &lt;code&gt;PRE_SPLIT_REGION&lt;/code&gt; çš„æ–¹å¼æ¥æ‰“æ•£çƒ­ç‚¹ã€‚&lt;/p&gt;&lt;p&gt;å¯¹äº PK éæ•´æ•°æˆ–æ²¡æœ‰ PK çš„è¡¨ï¼Œåœ¨ insert çš„æ—¶å€™ TiDB ä¼šä½¿ç”¨ä¸€ä¸ªéšå¼çš„è‡ªå¢ rowidï¼Œå¤§é‡ INSERT ä¼šæŠŠæ•°æ®é›†ä¸­å†™å…¥å•ä¸ª Regionï¼Œé€ æˆå†™å…¥çƒ­ç‚¹ã€‚é€šè¿‡è®¾ç½® &lt;code&gt;SHARD_ROW_ID_BITS&lt;/code&gt; æ¥é€‚åº¦åˆ†è§£ Region åˆ†ç‰‡ï¼Œä»¥è¾¾åˆ°æ‰“æ•£ Region çƒ­ç‚¹çš„æ•ˆæœã€‚ä½¿ç”¨æ–¹å¼ï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;ALTER TABLE t SHARD_ROW_ID_BITS = 4;  #å€¼ä¸º 4 è¡¨ç¤º 16 ä¸ªåˆ†ç‰‡&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç”±äºæˆ‘ä»¬æ¯å¤©éƒ½ä¼šæ–°å»ºè¡¨ï¼Œæ‰€ä»¥ä¸ºäº†æ›´å¥½çš„æ•ˆæœï¼Œä¹Ÿä½¿ç”¨äº† &lt;code&gt;PRE_SPLIT_REGIONS&lt;/code&gt; å»ºè¡¨é¢„åˆ‡åˆ†åŠŸèƒ½ï¼Œé€šè¿‡é…ç½®å¯ä»¥é¢„åˆ‡åˆ† &lt;code&gt;2^(pre_split_regions-1)&lt;/code&gt; ä¸ª Regionã€‚&lt;/p&gt;&lt;p&gt;ä¸‹é¢æ˜¯æœ€æ–°çš„è¡¨ç»“æ„ï¼Œå…¶ä¸­æœ€é‡è¦çš„ä¼˜åŒ–æ˜¯åˆ é™¤äº†è‡ªå¢ä¸»é”® IDï¼Œå»ºè¡¨æ—¶æ·»åŠ äº† &lt;code&gt;SHARD_ROW_ID_BITS&lt;/code&gt; ç»“åˆ &lt;code&gt;PRE_SPLIT_REGION&lt;/code&gt; é…ç½®ã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-0224fbd0a02cc9913f5bcfeb6101dd9d_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;847&quot; data-rawheight=&quot;283&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;847&quot; data-original=&quot;https://pic2.zhimg.com/v2-0224fbd0a02cc9913f5bcfeb6101dd9d_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-0224fbd0a02cc9913f5bcfeb6101dd9d_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;847&quot; data-rawheight=&quot;283&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;847&quot; data-original=&quot;https://pic2.zhimg.com/v2-0224fbd0a02cc9913f5bcfeb6101dd9d_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-0224fbd0a02cc9913f5bcfeb6101dd9d_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;è¯¥å»ºè¡¨è¯­å¥ä¼šå¯¹è¿™ä¸ªè¡¨ t é¢„åˆ‡åˆ†å‡º 4 + 1 ä¸ª Regionã€‚4 *(2^(3-1)) ä¸ª Region æ¥å­˜ table çš„è¡Œæ•°æ®ï¼Œ1 ä¸ª Region æ˜¯ç”¨æ¥å­˜ç´¢å¼•çš„æ•°æ®ã€‚&lt;/p&gt;&lt;p&gt;å…³äº &lt;code&gt;SHARD_ROW_ID_BITS&lt;/code&gt; å’Œ &lt;code&gt;PRE_SPLIT_REGION&lt;/code&gt; è¿™ 2 ä¸ªå‚æ•°ä½¿ç”¨è¯¦æƒ…å‚è§å®˜æ–¹æ–‡æ¡£ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pingcap.com/docs-cn/stable/faq/tidb/%236-1-2-%25E5%25A6%2582%25E4%25BD%2595%25E6%2589%2593%25E6%2595%25A3%25E7%2583%25AD%25E7%2582%25B9&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;https://pingcap.com/docs-cn/v3.0/faq/tidb/#6-1-2-å¦‚ä½•æ‰“æ•£çƒ­ç‚¹&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pingcap.com/docs-cn/v3.0/reference/sql/statements/split-region/%23pre-split-region&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;pingcap.com/docs-cn/v3.&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;0/reference/sql/statements/split-region/#pre-split-region&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;æ­¤å¤–ï¼Œé’ˆå¯¹è‡ªå¢ä¸»é”® ID é€ æˆå†™å…¥çƒ­ç‚¹çš„é—®é¢˜ï¼ŒTiDB å°†ä¼šåœ¨ 4.0 ç‰ˆæœ¬ä¸ºæä¾›ä¸€ä¸ªæ–°çš„åˆ—å±æ€§ï¼š&lt;code&gt;Auto_Random&lt;/code&gt;ã€‚è¿™ä¸ªå±æ€§ç±»ä¼¼äº &lt;code&gt;Auto_Increment&lt;/code&gt;ï¼Œå¯ä»¥å®šä¹‰åœ¨æ•´å‹ä¸»é”®ä¸Šï¼Œç”± TiDB è‡ªåŠ¨åˆ†é…ä¸€ä¸ªä¿è¯ä¸é‡å¤çš„éšæœº IDã€‚æœ‰äº†è¿™ä¸ªç‰¹æ€§åï¼Œä¸Šé¢çš„ä¾‹å­å¯ä»¥åšåˆ°ä¸åˆ é™¤ä¸»é”® IDï¼ŒåŒæ—¶é¿å…å†™å…¥çƒ­ç‚¹ã€‚&lt;/p&gt;&lt;h3&gt;æœ€ç»ˆä¼˜åŒ–æ•ˆæœ&lt;/h3&gt;&lt;p&gt;ä»ç›‘æ§ä¸Šçœ‹ï¼ŒTiKV çš„ CPU ä½¿ç”¨éå¸¸å‡è¡¡ï¼š&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-513ca0e98a2cf3437adf6c3f06a87774_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;864&quot; data-rawheight=&quot;300&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;864&quot; data-original=&quot;https://pic1.zhimg.com/v2-513ca0e98a2cf3437adf6c3f06a87774_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-513ca0e98a2cf3437adf6c3f06a87774_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;864&quot; data-rawheight=&quot;300&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;864&quot; data-original=&quot;https://pic1.zhimg.com/v2-513ca0e98a2cf3437adf6c3f06a87774_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-513ca0e98a2cf3437adf6c3f06a87774_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;ä»å‘½ä»¤è°ƒåº¦çš„ç»“æœæ¥çœ‹ä¹Ÿæ¯”è¾ƒå‡è¡¡ï¼š&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-aa4128c76d01340dea32d3f3b348b6de_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;862&quot; data-rawheight=&quot;300&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;862&quot; data-original=&quot;https://pic3.zhimg.com/v2-aa4128c76d01340dea32d3f3b348b6de_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-aa4128c76d01340dea32d3f3b348b6de_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;862&quot; data-rawheight=&quot;300&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;862&quot; data-original=&quot;https://pic3.zhimg.com/v2-aa4128c76d01340dea32d3f3b348b6de_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-aa4128c76d01340dea32d3f3b348b6de_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;h2&gt;æ€»ç»“&lt;/h2&gt;&lt;p&gt;æœ¬æ–‡åªæ˜¯æ‹¿ 360 æ™ºèƒ½å•†ä¸šä¸šåŠ¡çº¿çš„ä¸€ä¸ªä¸šåŠ¡åœºæ™¯åˆ†äº«äº†çƒ­ç‚¹ Region çš„æ‰“æ•£æ–¹æ³•ï¼Œç›®çš„æ˜¯æä¾›å†™çƒ­ç‚¹ä¼˜åŒ–çš„æ€è·¯ï¼Œå¸Œæœ›èƒ½å¯¹å¤§å®¶æœ‰ä¸€å®šçš„å¸®åŠ©ã€‚æœ¬æ–‡è°ƒä¼˜è¿‡ç¨‹ä¸­å¾—åˆ°äº† PingCAP å…¬å¸æŠ€æœ¯äººå‘˜çš„å¤§åŠ›æ”¯æŒï¼Œåœ¨æ­¤è¡¨ç¤ºè¡·å¿ƒçš„æ„Ÿè°¢ã€‚&lt;/p&gt;&lt;p&gt;TiDB çš„å­˜å‚¨å’Œè®¡ç®—åˆ†ç¦»çš„æ¶æ„ï¼Œç»“åˆé«˜å¯ç”¨ã€é«˜æ€§èƒ½ã€æ˜“æ‰©å±•ã€æ˜“è¿ç»´ç­‰ç‰¹æ€§ï¼Œç»™å¤§æ•°æ®é‡çš„æ•°æ®æ‹†åˆ†å¸¦æ¥äº†æ›™å…‰ï¼Œæœªæ¥ä¼šåœ¨ 360 æ™ºèƒ½å•†ä¸šä¸šåŠ¡çº¿æœ‰æ›´å¤šçš„é¡¹ç›®è½åœ°ã€‚åœ¨æœªæ¥ï¼Œæˆ‘ä»¬æœŸæœ›ç”¨ TiFlash è§£å†³ TiDB ä¸‹æ¸¸æ•°æ®æ²»ç†é—®é¢˜ï¼Œå¹¶åšåˆ°è·¨æ•°æ®ä¸­å¿ƒéƒ¨ç½²çš„æ–¹æ¡ˆã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;åŸæ–‡é˜…è¯»ï¼š&lt;/b&gt;&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pingcap.com/cases-cn/user-case-360-business/&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic2.zhimg.com/v2-60ab5bd867c2434d70c957a02a2169e1_ipico.jpg&quot; data-image-width=&quot;1200&quot; data-image-height=&quot;1200&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;360 æ™ºèƒ½å•†ä¸šä¸šåŠ¡çº¿ç»éªŒåˆ†äº«ï¼šTiDB å†™çƒ­ç‚¹è°ƒä¼˜å®æˆ˜ | PingCAP&lt;/a&gt;&lt;p&gt;&lt;b&gt;æ›´å¤šæ¡ˆä¾‹é˜…è¯»ï¼š&lt;/b&gt;&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pingcap.com/cases-cn/&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic2.zhimg.com/v2-60ab5bd867c2434d70c957a02a2169e1_ipico.jpg&quot; data-image-width=&quot;1200&quot; data-image-height=&quot;1200&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;æ¡ˆä¾‹ | PingCAP&lt;/a&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>ZoeyZhai</author>
<guid isPermaLink="false">2019-12-09-96095292</guid>
<pubDate>Mon, 09 Dec 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>èµ›ç¨‹åˆšè¿‡ 1/3ï¼Œä»€ä¹ˆæ“ä½œè®©æ€§èƒ½æå‡ 150+ å€ï¼Ÿ</title>
<link>https://henix.github.io/feeds/zhuanlan.newsql/2019-12-05-95592990.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/95592990&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-b3b78e1059984e6e3386e276422eca5a_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;ä½œè€…ï¼šå§šç»´&lt;/p&gt;&lt;p&gt;11 æœˆåˆæˆ‘ä»¬å¼€å¯äº†ä¸€é¡¹ç¤¾åŒºæ–°æ´»åŠ¨ã€ŒTiDB æ€§èƒ½æŒ‘æˆ˜èµ›ã€(Performance Challenge Programï¼Œç®€ç§° PCP)ï¼Œè¿™é¡¹ç§¯åˆ†èµ›å°†æŒç»­ 3 ä¸ªæœˆï¼Œé€‰æ‰‹å°†å®Œæˆä¸€ç³»åˆ—éš¾åº¦ä¸åŒçš„ä»»åŠ¡ï¼Œèµ¢å¾—ç›¸åº”çš„ç§¯åˆ†ã€‚ç›®å‰èµ›ç¨‹åˆšåˆšè¿‡å»ä¸‰åˆ†ä¹‹ä¸€ï¼Œå·²ç»å–å¾—äº†ååˆ†è€€çœ¼çš„é˜¶æ®µæ€§æˆæœï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;è¿‡å»ä¸€ä¸ªæœˆå…±å¸å¼•äº†æ¥è‡ªç¤¾åŒºçš„ 156 ä½è´¡çŒ®è€…ï¼ŒåŒ…æ‹¬ï¼š&lt;/li&gt;&lt;ul&gt;&lt;li&gt;14 æ”¯å‚èµ›é˜Ÿä¼ã€‚&lt;/li&gt;&lt;li&gt;110 ä½ä¸ªäººå‚èµ›è€…ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;å‚èµ›é€‰æ‰‹ä»¬æ€»å…±å®Œæˆäº† 147 ä¸ªæŒ‘æˆ˜ä»»åŠ¡ï¼Œè¿™äº›æˆæœå·²ç»é€æ­¥è½åœ°åˆ° TiDB äº§å“ä¸­ï¼š&lt;/li&gt;&lt;ul&gt;&lt;li&gt;TiDB è¡¨è¾¾å¼æ¡†æ¶ä¸­å®Œæˆäº† 70+ ä¸ªå‡½æ•°çš„å‘é‡åŒ–ã€‚&lt;/li&gt;&lt;li&gt;TiKV åå¤„ç†å™¨ä¸­å®Œæˆäº† 40+ ä¸ªå‡½æ•°çš„å‘é‡åŒ–ï¼Œå…¶ä¸­ 34 ä¸ªå·²åœ¨ TiDB ä¾§æ–°å¼€å¯äº†ä¸‹æ¨ï¼Œè®©ä¸‹æ¨çš„å‡½æ•°è®¡ç®—é€Ÿåº¦å¤§å¹…ä¸Šå‡ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;æˆªè‡³å‘ç¨¿æ—¶ç§¯åˆ†æ’è¡Œæ¦œå‰äº”åçš„å‚èµ›é€‰æ‰‹ / Team åˆ†åˆ«æ˜¯ï¼š.* teamã€ekalininã€mmyjã€AerysNanã€js00070ã€‚&lt;/b&gt;&lt;/p&gt;&lt;p&gt;å…¶ä¸­ .* team è¡¨ç°å°¤ä¸ºä¼˜å¼‚ï¼Œä»–ä»¬å·²ç»æ‹¿åˆ°äº† 4150 ç§¯åˆ†ï¼Œåœ¨æ’è¡Œæ¦œä¸Šé¥é¥é¢†å…ˆã€‚è€Œæ¥è‡ªä¿„ç½—æ–¯çš„ä¸ªäººå‚èµ›è€… ekalinin è·å¾—äº† 1450 ç§¯åˆ†ï¼Œæ˜¯ç›®å‰ç§¯åˆ†æœ€é«˜çš„ä¸ªäººå‚èµ›è€…ï¼Œä»–å…±æäº¤äº† 17 ä¸ªä»»åŠ¡ï¼Œç›®å‰å®Œæˆäº† 12 ä¸ªï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ª Medium éš¾åº¦çš„ä»»åŠ¡ã€‚â€‹&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-ee470bebf82f06949107d218f053b5c1_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;554&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic2.zhimg.com/v2-ee470bebf82f06949107d218f053b5c1_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-ee470bebf82f06949107d218f053b5c1_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;554&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic2.zhimg.com/v2-ee470bebf82f06949107d218f053b5c1_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-ee470bebf82f06949107d218f053b5c1_b.jpg&quot;/&gt;&lt;figcaption&gt;ç§¯åˆ†æ’è¡Œæ¦œ&lt;/figcaption&gt;&lt;/figure&gt;&lt;blockquote&gt;â€œå› ä¸ºå¯¹ Rust æ„Ÿå…´è¶£å‚åŠ äº†è¿™æ¬¡ PCPï¼Œèƒ½å¤Ÿäº²è‡ªæ”¹å–„ä¸€ä¸ªè‡ªå·±ä¼šä½¿ç”¨çš„å·¥å…·çš„æ„Ÿå—éå¸¸ä»¤äººæ„‰æ‚¦ï¼Œé¡¹ç›®çš„æ–‡æ¡£ï¼Œä»£ç ç»“æ„å’Œç¤¾åŒºéƒ½éå¸¸å‹å¥½,å¸¦æ¥äº†å¾ˆå¼ºçš„æ­£åé¦ˆã€‚â€&lt;br/&gt;â€”â€” Renkaiï¼ˆPCP ä¸ªäººå‚èµ›è€…ï¼‰&lt;br/&gt;â€œå‚åŠ  PCP æ˜¯å¾ˆæœ‰è¶£çš„ä½“éªŒï¼Œæ—¢èƒ½æ·±åº¦å‚ä¸å¼€æºé¡¹ç›®ï¼Œåˆèƒ½åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­å­¦åˆ°å¾ˆå¤šæ•°æ®åº“å’Œ Rust çš„çŸ¥è¯†ï¼Œè¿˜èƒ½é€šè¿‡è·å¾—ç§¯åˆ†å…‘æ¢å¥–åŠ±ï¼Œå¯¼å¸ˆçš„æŒ‡å¯¼éå¸¸è€å¿ƒï¼Œå¸Œæœ›èƒ½æœ‰æ›´å¤šçš„äººå‚ä¸è¿›è¿™ä¸ªé¡¹ç›®æ¥ã€‚â€&lt;br/&gt;â€”â€” TennyZhuangï¼ˆPCP å›¢é˜Ÿå‚èµ›è€… .* team æˆå‘˜ï¼‰&lt;br/&gt;â€œI like Go &amp;amp; databases. TiDB has both of them. So I just decided to deep dive into internals of the TiDB and check if I can be useful for it. Iâ€™m a big fan of open source. I have a couple of open sourced projects and I understand the importance of the contribution into open source projects.&lt;br/&gt;I feel great after joining the PCP and TiDB community! Good docs, a lot of tests, well written code :)â€&lt;br/&gt;â€”â€” ekalininï¼ˆPCP ä¸ªäººå‚èµ›è€…ï¼Œæ¥è‡ªä¿„ç½—æ–¯ï¼‰&lt;/blockquote&gt;&lt;p&gt;&lt;b&gt;ä¸‹é¢è®©æˆ‘ä»¬æ¥çœ‹çœ‹è¿‡å»çš„ä¸€ä¸ªæœˆé‡Œå¤§å®¶åœ¨ã€Œæ€§èƒ½æå‡ã€æ–¹é¢æœ‰å“ªäº›çªç ´æ€§çš„æˆ˜ç»©å§ï¼&lt;/b&gt;&lt;/p&gt;&lt;h3&gt;1. IN() å‡½æ•°æ€§èƒ½æå‡ 150+ å€&lt;/h3&gt;&lt;p&gt;ç›¸å…³ PR &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/tikv/tikv/pull/6000&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;é“¾æ¥&lt;/a&gt;ï¼Œä½œè€…ï¼š&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/TennyZhuang&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TennyZhuang&lt;/a&gt;ï¼ˆ .* team ï¼‰&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-5c2a2a4dc7a8f27a933d60b05895b914_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1180&quot; data-rawheight=&quot;724&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1180&quot; data-original=&quot;https://pic1.zhimg.com/v2-5c2a2a4dc7a8f27a933d60b05895b914_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-5c2a2a4dc7a8f27a933d60b05895b914_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1180&quot; data-rawheight=&quot;724&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1180&quot; data-original=&quot;https://pic1.zhimg.com/v2-5c2a2a4dc7a8f27a933d60b05895b914_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-5c2a2a4dc7a8f27a933d60b05895b914_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;code&gt;IN()&lt;/code&gt; æ˜¯ä¸€ä¸ªå¤§å®¶ç”¨çš„å¾ˆå¤šçš„ SQL å†…ç½®å‡½æ•°ã€‚è¿™ä¸ª PR ä½¿å¾— &lt;code&gt;IN()&lt;/code&gt; å†…ç½®å‡½æ•°çš„æ€§èƒ½æœ‰äº†å¤æ‚åº¦çº§åˆ«çš„æå‡ï¼Œä» &lt;code&gt;O(N)&lt;/code&gt; æå‡åˆ° &lt;code&gt;O(1)&lt;/code&gt;ï¼Œå¦‚ä¸Šå›¾æ‰€ç¤ºã€‚è¿™å¯¹äº &lt;code&gt;IN()&lt;/code&gt; å‡½æ•°ä¸­æœ‰å¾ˆå¤šå‚æ•°çš„æƒ…å†µèƒ½æœ‰å¾ˆå¤§çš„å¸®åŠ©ï¼Œä¾‹å¦‚åœ¨ä»¥ä¸‹ 1000 ä¸ªå‚æ•°åœºæ™¯ä¸­æ€§èƒ½æå‡å¯è¾¾ 150+ å€ï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;CREATE TABLE `foo` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `c` char(100),
  PRIMARY KEY (`id`)
);

select * from foo where c in (
&amp;#34;271a76b46731d9&amp;#34;, &amp;#34;a7a69f89d4b32e&amp;#34;, &amp;#34;8d969b6b76f6f4&amp;#34;, &amp;#34;8ea63d5c33dabe&amp;#34;, &amp;#34;4c5dabf74df99f&amp;#34;, &amp;#34;897ab55a20218b&amp;#34;, &amp;#34;80d73f4331a342&amp;#34;, &amp;#34;a4747627a2e05d&amp;#34;,
&amp;#34;e20beca46373&amp;#34;, &amp;#34;4dbc295621b4c5&amp;#34;, &amp;#34;79ab1ea844c293&amp;#34;, &amp;#34;86d75b32f6b1b8&amp;#34;, &amp;#34;7fd827adcc7cd0&amp;#34;, &amp;#34;bf26b53dd73dd&amp;#34;,
...
);&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;i&gt;å¤§å®¶ä¸è¦è§‰å¾—è¿™ä¹ˆå¤šå‚æ•°æ˜¯å¾ˆå°‘è§çš„æƒ…å†µï¼Œå®é™…ä¸Šæˆ‘ä»¬å·²ç»é‡åˆ°å¤šä¸ª TiDB ç”¨æˆ·ç»™&lt;/i&gt; &lt;i&gt;&lt;code&gt;IN()&lt;/code&gt;&lt;/i&gt; &lt;i&gt;å†…ç½®å‡½æ•°ä¼ é€’å¤šè¾¾å‡ åƒä¸ªå‚æ•°çš„åœºæ™¯ã€‚&lt;/i&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/TennyZhuang&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TennyZhuang&lt;/a&gt;ï¼ˆ .* team æˆå‘˜ï¼‰æˆåŠŸé€šè¿‡è¿™ä¸ª PR è·å¾—äº† 2100 ç§¯åˆ†ï¼Œè¿™ä¸ªæ˜¯ç›®å‰é€‰æ‰‹è·å¾—çš„å•ä¸ªè´¡çŒ®æœ€é«˜ç§¯åˆ†ã€‚ä¸è¿‡è¿™è¿˜åªæ˜¯ Medium éš¾åº¦çš„ä»»åŠ¡ï¼Œæˆ‘ä»¬è¿˜æœ‰è®¸å¤šæ›´é«˜ç§¯åˆ†å¥–åŠ±çš„ Hard çº§åˆ«ä»»åŠ¡ç­‰å¾…å¤§å®¶æ¥æŒ‘æˆ˜ã€‚&lt;/p&gt;&lt;h3&gt;2. LIKE() å‡½æ•°æ€§èƒ½æŒ‡æ•°çº§æå‡&lt;/h3&gt;&lt;p&gt;ç›¸å…³ PR &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/tikv/tikv/pull/5866&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;é“¾æ¥&lt;/a&gt;ï¼Œä½œè€…ï¼š&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/TennyZhuang&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TennyZhuang&lt;/a&gt;ï¼ˆ .* team æˆå‘˜ï¼‰&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-e669500262244591e235f1fccba0a00e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1186&quot; data-rawheight=&quot;730&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1186&quot; data-original=&quot;https://pic3.zhimg.com/v2-e669500262244591e235f1fccba0a00e_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-e669500262244591e235f1fccba0a00e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1186&quot; data-rawheight=&quot;730&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1186&quot; data-original=&quot;https://pic3.zhimg.com/v2-e669500262244591e235f1fccba0a00e_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-e669500262244591e235f1fccba0a00e_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;è¿™ä¸ª PR é€šè¿‡ä¿®æ”¹äº†ç®—æ³•ï¼Œå®ç°äº†å¯¹ &lt;code&gt;LIKE()&lt;/code&gt; å†…ç½®å‡½æ•°æ€§èƒ½çš„æŒ‡æ•°çº§åˆ«æ”¹è¿›ï¼Œä» &lt;code&gt;O(2^N)&lt;/code&gt; ä¼˜åŒ–åˆ° &lt;code&gt;O(N)&lt;/code&gt;ã€‚åœ¨ä¼˜åŒ–å‰ï¼Œä»…ä»…æ˜¯ 6 ä¸ªé€šé…ç¬¦å°±èƒ½å°†å•è¡Œè®¡ç®—æ€§èƒ½é™ä½åˆ°ç§’çº§ï¼Œå¯¹æ€§èƒ½å¯ä»¥é€ æˆéå¸¸ä¸¥é‡çš„å½±å“ã€‚ä¸Šå›¾ç›´è§‚å±•ç¤ºäº†è¿™ä¸ª PR å¸¦æ¥çš„æ€§èƒ½æå‡ï¼ˆçºµåæ ‡æ˜¯å¯¹æ•°åæ ‡ï¼‰ã€‚&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/TennyZhuang&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TennyZhuang&lt;/a&gt;ï¼ˆ .* team æˆå‘˜ï¼‰é€šè¿‡è¿™ä¸ª PR è·å¾—äº† 1500 ç§¯åˆ†ã€‚&lt;/p&gt;&lt;h3&gt;3. å…¨é¢æå‡ TPC-H æ€§èƒ½&lt;/h3&gt;&lt;p&gt;ç›¸å…³ PR &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/tikv/tikv/pull/5979&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;é“¾æ¥&lt;/a&gt;ï¼Œä½œè€…ï¼š&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/Renkai&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Renkai&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//www.tpc.org/tpch/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TPC-H&lt;/a&gt; æ˜¯ç›®å‰ä¸šç•Œé€šç”¨çš„è¡¡é‡æ•°æ®åº“åˆ†æå¤„ç†èƒ½åŠ›çš„åŸºå‡†æµ‹è¯•ã€‚è¿™ä¸ªä»»åŠ¡é€šè¿‡å‡å°‘å†…å­˜å¤åˆ¶çš„æ–¹å¼ï¼Œå…¨é¢æå‡äº† TPC-H å„æŸ¥è¯¢ 5%~14% çš„è€—æ—¶ï¼Œå¯ä»¥è¯´æ˜¯éå¸¸ä»¤äººæƒŠè‰³çš„ç»“æœäº†ï¼Œä»¥ä¸‹æ˜¯å¯¹æ¯”ç»“æœï¼š&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-2c54cf3f86965ec8e9c177386f3c9028_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;579&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic1.zhimg.com/v2-2c54cf3f86965ec8e9c177386f3c9028_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-2c54cf3f86965ec8e9c177386f3c9028_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;579&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic1.zhimg.com/v2-2c54cf3f86965ec8e9c177386f3c9028_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-2c54cf3f86965ec8e9c177386f3c9028_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;ä¸‹è¡¨åŠ çº¢åŠ ç²—éƒ¨åˆ†æ¯ä¸ªè¯­å¥æå‡çš„ç™¾åˆ†æ¯”ã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-1a87039ab2ab4977139a091f31d8ada1_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1228&quot; data-rawheight=&quot;848&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1228&quot; data-original=&quot;https://pic2.zhimg.com/v2-1a87039ab2ab4977139a091f31d8ada1_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-1a87039ab2ab4977139a091f31d8ada1_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1228&quot; data-rawheight=&quot;848&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1228&quot; data-original=&quot;https://pic2.zhimg.com/v2-1a87039ab2ab4977139a091f31d8ada1_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-1a87039ab2ab4977139a091f31d8ada1_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;h2&gt;æ›´å¤šæœ‰æ„æ€çš„ä»»åŠ¡&lt;/h2&gt;&lt;p&gt;ç›®å‰è¿˜æœ‰æ›´å¤šæ›´æœ‰æŒ‘æˆ˜ï¼Œæ›´é«˜ç§¯åˆ†çš„ä»»åŠ¡åœ¨ç­‰å¾…ç€å¤§å®¶æ¥æŒ‘æˆ˜ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/tikv/rust-rocksdb/issues/375&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;PCP-27&lt;/a&gt;ï¼šé€šè¿‡è·³è¿‡ RocksDB Compaction é˜¶æ®µçš„æŸäº› SSTï¼Œä»¥å‡å°‘ RocksDB å†™æ”¾å¤§ï¼ˆç§¯åˆ†ï¼š3600ï¼‰ã€‚&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/pingcap/pd/issues/1847&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;PCP-26&lt;/a&gt;ï¼šä¼˜åŒ– PD è·å– TSO çš„æ€§èƒ½ ï¼ˆç§¯åˆ†ï¼š20000ï¼‰ã€‚&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/pingcap/tidb/issues/12979&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;PCP-10&lt;/a&gt; ï¼šä¼˜åŒ–å®½è¡¨æƒ…å†µä¸‹çš„æŸ¥è¯¢æ•ˆç‡ï¼ˆç§¯åˆ†ï¼š3000ï¼‰ã€‚&lt;/li&gt;&lt;li&gt;â€¦â€¦&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;å½“å‰å¼€æ”¾çš„ä»»åŠ¡åˆ—è¡¨å¯åˆ†åˆ«åœ¨ &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/pingcap/tidb/projects/26&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TiDB Tasks&lt;/a&gt;ã€&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/tikv/tikv/projects/20&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TiKV Tasks&lt;/a&gt;ã€&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/pingcap/pd/projects/2&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;PD Tasks&lt;/a&gt; ä¸­æ‰¾åˆ°ã€‚&lt;/p&gt;&lt;p&gt;æ›´å¤šå‚èµ›è¯¦æƒ…ï¼Œå¯ä»¥è¿›å…¥ &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pingcap.com/community-cn/tidb-performance-challenge/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;å®˜æ–¹ç½‘ç«™&lt;/a&gt; æŸ¥çœ‹ã€‚&lt;/p&gt;&lt;h2&gt;è‡´è°¢&lt;/h2&gt;&lt;p&gt;è¿™é‡Œä¹Ÿéœ€è¦å¯¹å„ä¸ª Special Interest Groupï¼ˆSIGï¼‰çš„ Tech Lead ä»¥åŠ Mentor è¡¨è¾¾æ„Ÿè°¢ï¼Œä»–ä»¬ä¸º PCP å®Œæˆäº†å‡ºé¢˜ä»¥åŠæŒ‡å¯¼å‚èµ›è€…ä»¬å®Œæˆäº†è¿™äº›ä»¤äººå°è±¡æ·±åˆ»çš„æŒ‘æˆ˜ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/breeswish&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;breeswish&lt;/a&gt;ï¼ˆ&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/tikv/community/tree/master/sig/coprocessor&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;@Coprocessor SIG&lt;/a&gt;ï¼‰&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/lonng&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;lonng&lt;/a&gt;ï¼ˆ&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/tikv/community/tree/master/sig/coprocessor&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;@Coprocessor SIG&lt;/a&gt;ï¼‰&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/sticnarf&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;sticnarf&lt;/a&gt; ï¼ˆ&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/tikv/community/tree/master/sig/coprocessor&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;@Coprocessor SIG&lt;/a&gt;ï¼‰&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/yiwu-arbug&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;yiwu-arbug&lt;/a&gt; ï¼ˆ&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/tikv/community/tree/master/sig/engine&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;@Storage Engine SIG&lt;/a&gt;ï¼‰&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/zhangjinpeng1987&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;zhangjinpeng1987&lt;/a&gt;ï¼ˆ&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/tikv/community/tree/master/sig/engine&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;@Storage Engine SIG&lt;/a&gt;ï¼‰&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/SunRunAway&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;SunRunAway&lt;/a&gt;ï¼ˆ&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/pingcap/community/blob/master/special-interest-groups/sig-expr&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;@Expression SIG&lt;/a&gt;ï¼‰&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/qw4990&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;qw4990&lt;/a&gt;ï¼ˆ&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/pingcap/community/blob/master/special-interest-groups/sig-expr&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;@Expression SIG&lt;/a&gt;ï¼‰&lt;/li&gt;&lt;/ul&gt;&lt;blockquote&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pingcap.com/community-cn/tidb-performance-challenge/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TiDB æ€§èƒ½æŒ‘æˆ˜èµ›&lt;/a&gt; ç”± PingCAP å‘èµ·ï¼Œæ—¨åœ¨æ¿€å‘ç¤¾åŒºåˆ›é€ æ€§ï¼Œå‚èµ›é€‰æ‰‹å¯ä»¥é€šè¿‡å®Œæˆä¸€ç³»åˆ—çš„ä»»åŠ¡æå‡ TiDB äº§å“çš„æ€§èƒ½ã€‚èµ›äº‹äº 2019 å¹´ 11 æœˆ 4 æ—¥æ­£å¼å¼€å¯ï¼Œå°†æŒç»­ 3 ä¸ªæœˆï¼Œæ¯”èµ›ä»»åŠ¡åˆ†ä¸ºä¸‰ä¸ªéš¾åº¦ï¼šEasyã€Mediumã€Hardï¼Œä¸åŒéš¾åº¦å¯¹åº”ä¸åŒç§¯åˆ†ï¼Œå‚èµ›é€‰æ‰‹è·å¾—çš„ç§¯åˆ†å¯ä»¥å…‘æ¢ TiDB é™é‡å‘¨è¾¹ç¤¼å“ç­‰ä¸°å¯Œçš„å¥–åŠ±ã€‚&lt;/blockquote&gt;&lt;p&gt;&lt;b&gt;åŸæ–‡é˜…è¯»ï¼š&lt;/b&gt;&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pingcap.com/blog-cn/pcp-report-201911/&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic2.zhimg.com/v2-60ab5bd867c2434d70c957a02a2169e1_ipico.jpg&quot; data-image-width=&quot;1200&quot; data-image-height=&quot;1200&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;èµ›ç¨‹åˆšè¿‡ 1/3ï¼Œä»€ä¹ˆæ“ä½œè®©æ€§èƒ½æå‡ 150+ å€ï¼Ÿ | PingCAP&lt;/a&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>ZoeyZhai</author>
<guid isPermaLink="false">2019-12-05-95592990</guid>
<pubDate>Thu, 05 Dec 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>ä½ å‘¼å‘¼å¤§ç¡ï¼Œæœºå™¨äººå´åœ¨æ‰¾ bugï¼Ÿ</title>
<link>https://henix.github.io/feeds/zhuanlan.newsql/2019-12-05-95494206.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/95494206&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-f8086e25ea66e0c9f8d5245c26cbb1ec_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;blockquote&gt;ä½œè€…ä»‹ç»ï¼šæˆ‘å’Œæˆ‘çš„ SQL é˜Ÿï¼ˆæˆå‘˜ï¼šæœæ²å›­ã€éŸ©ç‰åšã€é»„å®çµã€æ»¡ä¿Šæœ‹ï¼‰ï¼Œä»–ä»¬çš„é¡¹ç›®ã€ŒåŸºäºè·¯å¾„ç»Ÿè®¡çš„ sql bug root cause åˆ†æã€è·å¾—äº† &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pingcap.com/community-cn/hackathon2019/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TiDB Hackathon 2019&lt;/a&gt; çš„ä¸‰ç­‰å¥–ã€‚&lt;/blockquote&gt;&lt;p&gt;æ›¾åœ¨ Hacker News ä¸Šçœ‹åˆ°è¿‡ä¸€ä¸ª Oracle å·¥ç¨‹å¸ˆå¤„ç† bug çš„ &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//news.ycombinator.com/item%3Fid%3D1842637&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;æ—¥å¸¸&lt;/a&gt;ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;å…ˆèŠ±ä¸¤å‘¨å·¦å³æ—¶é—´æ¥ç†è§£ 20 ä¸ªå‚æ•°å¦‚ä½•é€šè¿‡ç¥å¥‡çš„ç»„åˆå¼•å‘ bugã€‚&lt;/li&gt;&lt;li&gt;æ”¹äº†å‡ è¡Œä»£ç ï¼Œå°è¯•å¯¹ bug è¿›è¡Œä¿®å¤ï¼Œæäº¤æµ‹è¯•é›†ç¾¤å¼€å§‹è·‘è¿‘ç™¾ä¸‡ä¸ªæµ‹è¯• caseï¼Œé€šå¸¸è¦ 20~30 å°æ—¶ã€‚&lt;/li&gt;&lt;li&gt;è¿æ°”å¥½çš„è¯ä¼šæœ‰ 100 å¤šä¸ª case æ²¡è¿‡ï¼Œæœ‰æ—¶å€™ä¸Šåƒä¸ªä¹Ÿæœ‰å¯èƒ½ï¼Œåªå¥½æŒ‘é€‰å‡ ä¸ªæ¥çœ‹ï¼Œå‘ç°è¿˜æœ‰ 10 ä¸ªå‚æ•°ä¹‹å‰æ²¡æœ‰æ³¨æ„åˆ°ã€‚&lt;/li&gt;&lt;li&gt;åˆè¿‡äº†ä¸¤å‘¨ï¼Œç»ˆäºæ‰¾åˆ°äº†å¼•èµ· bug çš„çœŸæ­£å‚æ•°ç»„åˆï¼Œå¹¶è·‘é€šäº†æ‰€æœ‰æµ‹è¯•ã€‚å¹¶å¢åŠ  100 å¤šä¸ªæµ‹è¯• case ç¡®ä¿è¦†ç›–ä»–çš„ä¿®æ”¹ã€‚&lt;/li&gt;&lt;li&gt;ç»è¿‡ä¸€ä¸ªå¤šæœˆçš„ä»£ç  reviewï¼Œä»–çš„ä¿®æ”¹ç»ˆäºåˆå¹¶äº†ï¼Œå¼€å§‹å¤„ç†ä¸‹ä¸€ä¸ª bugâ€¦â€¦&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;åæ¥è¿™ä¸ªå·¥ç¨‹å¸ˆæ„Ÿæ…¨è¯´ï¼šâ€œI donâ€™t work for Oracle anymore. Will never work for Oracle again!â€&lt;/p&gt;&lt;p&gt;Oracle 12.2 æœ‰å°†è¿‘ 2500 ä¸‡è¡Œ C ä»£ç ï¼Œå¤æ‚ç³»ç»Ÿçš„æµ‹è¯•æ˜¯ä¸€ä»¶è‰°éš¾ã€è‰°è‹¦å’Œè‰°å·¨çš„äº‹æƒ…ã€‚è€Œæµ‹è¯•ä¸€ä¸ªåˆ†å¸ƒå¼æ•°æ®åº“çš„æƒ…å†µå°±æ›´å¤æ‚äº†ï¼Œæˆ‘ä»¬æ°¸è¿œä¸çŸ¥é“ç”¨æˆ·å¯èƒ½å†™å‡ºä»€ä¹ˆæ ·çš„ SQLï¼Œè¡¨ç»“æ„å’Œç´¢å¼•æœ‰å¤šå°‘ç§ç»„åˆï¼Œæ­¤å¤–è¿˜è¦è€ƒè™‘é›†ç¾¤åœ¨ä»€ä¹ˆæ—¶å€™èŠ‚ç‚¹å‘ç”Ÿå®•æœºï¼Œä»¥åŠå—åˆ°ç½‘ç»œæŠ–åŠ¨ã€ç£ç›˜æ€§èƒ½é€€åŒ–ç­‰å› ç´ çš„å½±å“ï¼Œå¯èƒ½æ€§å‡ ä¹æ˜¯æ— é™çš„ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;é‚£ä¹ˆæœ‰æ²¡æœ‰ä¸€ç§æ–¹æ³•èƒ½è®©ç¨‹åºè‡ªåŠ¨å¸®æˆ‘ä»¬æŸ¥ bugï¼Ÿ&lt;/b&gt;&lt;/p&gt;&lt;p&gt;è¿™ä¼¼ä¹æ˜¯ä¸ªä¸é”™çš„ä¸»æ„ï¼Œå¸¦ç€è¿™ä¸ªæƒ³æ³•æˆ‘ä»¬ç»„äº†å›¢é˜Ÿï¼Œæ¥å‚åŠ  &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pingcap.com/community-cn/hackathon2019/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TiDB Hackathon 2019&lt;/a&gt; æ¯”èµ›ï¼Œå¹¶æ„å¤–åœ°æ–©è·äº†ä¸‰ç­‰å¥–ã€‚&lt;/p&gt;&lt;h2&gt;å¦‚ä½•åšåˆ°ã€Œç¡è§‰çš„æ—¶å€™è®©ç¨‹åºè‡ªåŠ¨å®šä½ bugã€ï¼Ÿ&lt;/h2&gt;&lt;p&gt;é¡¹ç›®çš„æ€è·¯å…¶å®å¾ˆç®€å•ï¼Œå¦‚æœåœ¨æ¯æ¬¡è·‘ case çš„æ—¶å€™èƒ½ç”¨ç»Ÿè®¡å­¦çš„æ–¹æ³•å¯¹è¶³å¤Ÿå¤šæ¬¡å®éªŒçš„ä»£ç è·¯å¾„è¿›è¡Œåˆ†æï¼Œå°±å¯ä»¥æ‰¾å‡ºç–‘ä¼¼ bug çš„ä»£ç ï¼Œæœ€ç»ˆç»“æœä»¥ä»£ç æŸ“è‰²çš„æ–¹å¼ç”±å‰ç«¯å¯è§†åŒ–å‘ˆç°ï¼Œå°±å¾—åˆ°äº†å¦‚ä¸‹å›¾å±•ç¤ºçš„æ•ˆæœï¼š&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-ecc1c0cfffe63684bcfff15bbe0ab1e6_b.gif&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;837&quot; data-rawheight=&quot;576&quot; data-thumbnail=&quot;https://pic3.zhimg.com/v2-ecc1c0cfffe63684bcfff15bbe0ab1e6_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;837&quot; data-original=&quot;https://pic3.zhimg.com/v2-ecc1c0cfffe63684bcfff15bbe0ab1e6_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-ecc1c0cfffe63684bcfff15bbe0ab1e6_b.gif&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;837&quot; data-rawheight=&quot;576&quot; data-thumbnail=&quot;https://pic3.zhimg.com/v2-ecc1c0cfffe63684bcfff15bbe0ab1e6_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;837&quot; data-original=&quot;https://pic3.zhimg.com/v2-ecc1c0cfffe63684bcfff15bbe0ab1e6_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-ecc1c0cfffe63684bcfff15bbe0ab1e6_b.gif&quot;/&gt;&lt;/figure&gt;&lt;p&gt;è¿™æ˜¯æˆ‘ä»¬åœ¨ Hackathon æ¯”èµ›ä¸­é’ˆå¯¹ä¸€ä¸ª TiDB çš„ &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/pingcap/tidb/pull/12476&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;PR&lt;/a&gt; æ‰€åšçš„å®éªŒï¼Œé¢œè‰²è¶Šæ·±ï¼Œäº®åº¦è¶Šé«˜è¡¨ç¤ºåŒ…å«é”™è¯¯é€»è¾‘çš„å¯èƒ½æ€§è¶Šå¤§ã€‚è¯¥æ–¹æ³•ä¸ä»…é€‚ç”¨äºæ•°æ®åº“ç³»ç»Ÿçš„æµ‹è¯•ï¼ŒåŒæ ·é€‚ç”¨äºå…¶ä»–ä»»ä½•å¤æ‚çš„ç³»ç»Ÿã€‚&lt;/p&gt;&lt;h2&gt;èƒŒåçš„åŸç†&lt;/h2&gt;&lt;p&gt;é¡¹ç›®æœ€åˆæ˜¯å—åˆ° VLDB çš„ä¸€ç¯‡è®ºæ–‡çš„å¯å‘ &lt;a href=&quot;https://link.zhihu.com/?target=http%3A//www.vldb.org/pvldb/vol13/p57-jung.pdf&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;APOLLO: Automatic Detection and Diagnosis of Performance Regressions in Database Systems&lt;/a&gt;ï¼Œåœ¨æ­¤æ„Ÿè°¢ä¸€ä¸‹ä¹”æ²»äºšç†å·¥å­¦é™¢å’Œ eBay å…¬å¸çš„å‡ ä½ä½œè€…ã€‚è¯¥è®ºæ–‡ä¸»è¦å›´ç»•å¦‚ä½•è¯Šæ–­å¼•å‘æ•°æ®åº“æ€§èƒ½å›é€€çš„ä»£ç ï¼Œå…¶æ ¸å¿ƒæ€æƒ³ä¹ŸåŒæ ·é€‚ç”¨äºæ’æŸ¥ bugã€‚è®ºæ–‡ä¸­æåˆ°çš„è‡ªåŠ¨è¯Šæ–­ç³»ç»Ÿç”± SQLFuzzï¼ŒSQLMin å’Œ SQLDebug ä¸‰ä¸ªæ¨¡å—ç»„æˆã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-7ac746b36a3c52a94f0bbe003c0bafaf_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1282&quot; data-rawheight=&quot;278&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1282&quot; data-original=&quot;https://pic4.zhimg.com/v2-7ac746b36a3c52a94f0bbe003c0bafaf_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-7ac746b36a3c52a94f0bbe003c0bafaf_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1282&quot; data-rawheight=&quot;278&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1282&quot; data-original=&quot;https://pic4.zhimg.com/v2-7ac746b36a3c52a94f0bbe003c0bafaf_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-7ac746b36a3c52a94f0bbe003c0bafaf_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;ul&gt;&lt;li&gt;SQLFuzzï¼šè´Ÿè´£éšæœºç”Ÿæˆ SQLï¼Œå¹¶åˆ©ç”¨äºŒåˆ†æŸ¥æ‰¾å®šä½åˆ°æ€§èƒ½å›é€€çš„å‰åä¸¤ä¸ªç‰ˆæœ¬ï¼Œä¼ é€’ç»™ SQLMin æ¨¡å—ã€‚&lt;/li&gt;&lt;li&gt;SQLMinï¼šé€šè¿‡å‰ªæç®—æ³•å°† SQLFuzz ç”Ÿæˆçš„ SQL è¿›è¡ŒåŒ–ç®€ï¼Œå¾—å‡ºèƒ½å¤Ÿå¤ç°è¯¥é—®é¢˜çš„æœ€å° SQL ï¼Œä¼ é€’ç»™ SQLDebug æ¨¡å—ã€‚ç›®çš„æ˜¯å‡å°‘æ— å…³çš„ä»£ç è·¯å¾„ï¼Œé™ä½å™ªéŸ³ã€‚&lt;/li&gt;&lt;li&gt;SQLDebugï¼šå¯¹æºç è¿›è¡Œæ’æ¡©ï¼Œä½¿å…¶åœ¨æ‰§è¡Œ SQL æ—¶èƒ½å¤Ÿè¾“å‡ºä»£ç çš„æ‰§è¡Œè·¯å¾„ã€‚ç„¶åå¯¹ä¸¤ä¸ªç‰ˆæœ¬çš„ä»£ç è·¯å¾„è¿›è¡Œåˆ†æï¼Œå»ºç«‹ä¸€ä¸ªç»Ÿè®¡æ¨¡å‹æ¥å®šä½é—®é¢˜çš„ä½ç½®ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;æœ€ç»ˆç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆæµ‹è¯•æŠ¥å‘Šï¼Œå†…å®¹åŒ…å«ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;å“ªä¸€æ¬¡çš„ä»£ç  commit å¼•å…¥äº†æ€§èƒ½å›é€€ã€‚&lt;/li&gt;&lt;li&gt;å­˜åœ¨é—®é¢˜çš„ä»£ç æºæ–‡ä»¶ã€‚&lt;/li&gt;&lt;li&gt;å…·ä½“çš„å‡½æ•°ä½ç½®ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;è€Œå®é™…ä¸Šï¼Œè€ƒè™‘åˆ°å¹¶å‘ã€å¾ªç¯ã€é€’å½’ç­‰å¸¦æ¥çš„å½±å“ï¼Œä»£ç æ‰§è¡Œè·¯å¾„åˆ†æä¼šéå¸¸å¤æ‚ã€‚ä¸ºäº†ä¿è¯èƒ½å¤Ÿåœ¨ Hackathon é‚£ä¹ˆçŸ­çš„æ—¶é—´å†…å±•ç¤ºå‡ºæ•ˆæœï¼Œæˆ‘ä»¬åˆå‚è€ƒäº†å¦ä¸€ç¯‡è®ºæ–‡ &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//www.cc.gatech.edu/~john.stasko/papers/icse02.pdf&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Visualization of Test Information to Assist Fault Localization&lt;/a&gt;ï¼Œå…¶æ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡ç»Ÿè®¡ä»£ç å—è¢«æ­£ç¡®å’Œé”™è¯¯æµ‹è¯•ç”¨ä¾‹ç»è¿‡æ¬¡æ•°ï¼Œå†åŸºäºåˆ†æç®—æ³•æ¥æ¶‚ä¸Šä¸åŒçš„é¢œè‰²ï¼Œç®€å•è€Œå®ç”¨ã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-b61d1079af296457b29e4a2bf0c5806d_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;770&quot; data-rawheight=&quot;565&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;770&quot; data-original=&quot;https://pic2.zhimg.com/v2-b61d1079af296457b29e4a2bf0c5806d_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-b61d1079af296457b29e4a2bf0c5806d_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;770&quot; data-rawheight=&quot;565&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;770&quot; data-original=&quot;https://pic2.zhimg.com/v2-b61d1079af296457b29e4a2bf0c5806d_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-b61d1079af296457b29e4a2bf0c5806d_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;å…¶å®å€ŸåŠ©è¿™ä¸ªæ€è·¯ä¹Ÿå¯ä»¥åº”ç”¨åˆ°å…¶ä»–é¢†åŸŸï¼Œåé¢æˆ‘ä»¬å°†å±•å¼€æ¥ä»‹ç»ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ SQLDebug æ˜¯å¦‚ä½•å®ç°çš„ã€‚&lt;/p&gt;&lt;h2&gt;èŠèŠç»† (gÄn) èŠ‚ (huÃ²)&lt;/h2&gt;&lt;h3&gt;å¦‚ä½•è‡ªåŠ¨äº§ç”Ÿæµ‹è¯• caseï¼Ÿ&lt;/h3&gt;&lt;p&gt;ç”±äºæ˜¯åŸºäºç»Ÿè®¡çš„è¯Šæ–­ï¼Œæˆ‘ä»¬éœ€è¦å…ˆæ„å»ºè¶³å¤Ÿå¤šçš„æµ‹è¯•ç”¨ä¾‹ï¼Œè¿™ä¸ªè¿‡ç¨‹å½“ç„¶æœ€å¥½ä¹Ÿç”±ç¨‹åºè‡ªåŠ¨å®Œæˆã€‚äº‹å®ä¸Šï¼Œgrammar-based çš„æµ‹è¯•åœ¨æ£€éªŒç¼–è¯‘å™¨æ­£ç¡®æ€§æ–¹é¢æœ‰ç›¸å½“é•¿çš„å†å²ï¼ŒDBMS ç¤¾åŒºä¹Ÿé‡‡ç”¨ç±»ä¼¼çš„æ–¹æ³•æ¥éªŒè¯æ•°æ®åº“çš„åŠŸèƒ½æ€§ã€‚æ¯”å¦‚ï¼šå¾®è½¯çš„ SQL Server å›¢é˜Ÿå¼€å‘çš„ &lt;a href=&quot;https://link.zhihu.com/?target=http%3A//vldb.org/conf/2007/papers/industrial/p1243-bati.pdf&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;RAGS&lt;/a&gt; ç³»ç»Ÿå¯¹æ•°æ®åº“è¿›è¡ŒæŒç»­çš„è‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œè¿˜æœ‰ç¤¾åŒºæ¯”è¾ƒå‡ºåçš„ &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/anse1/sqlsmith&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;SQLSmith&lt;/a&gt; é¡¹ç›®ç­‰ç­‰ã€‚ä»Šå¹´ TiDB Hackathon çš„å¦ä¸€ä¸ªè·å¥–é¡¹ç›® &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/zyguan/sql-spider&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;sql-spider&lt;/a&gt; ä¹Ÿæ˜¯å®ç°ç±»ä¼¼çš„ç›®çš„ã€‚&lt;/p&gt;&lt;p&gt;è¿™é‡Œæˆ‘ä»¬æš‚æ—¶é‡‡ç”¨ PingCAP å¼€æºçš„éšæœºæµ‹è¯•æ¡†æ¶ &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/pingcap/go-randgen&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;go-randgen&lt;/a&gt; å®ç° SQL fuzzingï¼Œå®ƒéœ€è¦ç”¨æˆ·å†™ä¸€äº›è§„åˆ™æ–‡ä»¶æ¥å¸®åŠ©ç”Ÿæˆéšæœºçš„ SQL æµ‹è¯•ç”¨ä¾‹ã€‚è§„åˆ™æ–‡ä»¶ç”±ä¸€äº›äº§ç”Ÿå¼ç»„æˆã€‚randgen æ¯æ¬¡ä» query å¼€å§‹éšæœºæ¸¸èµ°ä¸€éäº§ç”Ÿå¼ï¼Œç”Ÿæˆä¸€æ¡ SQLï¼Œäº§ç”Ÿä¸€æ¡åƒä¸‹å›¾çº¢çº¿è¿™æ ·çš„è·¯å¾„ã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-067353d7fd533d1114a5faff48bb314e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;316&quot; data-rawheight=&quot;282&quot; class=&quot;content_image&quot; width=&quot;316&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-067353d7fd533d1114a5faff48bb314e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;316&quot; data-rawheight=&quot;282&quot; class=&quot;content_image lazy&quot; width=&quot;316&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-067353d7fd533d1114a5faff48bb314e_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;æˆ‘ä»¬å°†æ¯ä¸ªäº§ç”Ÿå¼ç”Ÿæˆæ­£ç¡®ä¸é”™è¯¯ç”¨ä¾‹çš„æ¯”ä¾‹ä½œä¸ºè¯¥äº§ç”Ÿå¼çš„é¢œè‰²å€¼ï¼Œç»˜åˆ¶æˆä¸€ä¸ªé¡µé¢ï¼Œä½œä¸º SQLFuzz çš„å±•ç¤ºé¡µé¢ã€‚é€šè¿‡è¯¥é¡µé¢ï¼Œå¯ä»¥æ¯”è¾ƒå®¹æ˜“åœ°çœ‹å‡ºå“ªæ¡äº§ç”Ÿå¼æ›´å®¹æ˜“äº§ç”Ÿé”™è¯¯çš„ SQLã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-368f4c1f21b3d9fab8118ae4205fec1e_b.gif&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;631&quot; data-rawheight=&quot;389&quot; data-thumbnail=&quot;https://pic3.zhimg.com/v2-368f4c1f21b3d9fab8118ae4205fec1e_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;631&quot; data-original=&quot;https://pic3.zhimg.com/v2-368f4c1f21b3d9fab8118ae4205fec1e_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-368f4c1f21b3d9fab8118ae4205fec1e_b.gif&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;631&quot; data-rawheight=&quot;389&quot; data-thumbnail=&quot;https://pic3.zhimg.com/v2-368f4c1f21b3d9fab8118ae4205fec1e_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;631&quot; data-original=&quot;https://pic3.zhimg.com/v2-368f4c1f21b3d9fab8118ae4205fec1e_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-368f4c1f21b3d9fab8118ae4205fec1e_b.gif&quot;/&gt;&lt;/figure&gt;&lt;h3&gt;ä»£ç è·Ÿè¸ª&lt;/h3&gt;&lt;p&gt;ä¸ºäº†è·Ÿè¸ªæ¯ä¸€æ¡ SQL åœ¨è¿è¡Œæ—¶çš„ä»£ç æ‰§è¡Œè·¯å¾„ï¼Œä¸€ä¸ªå…³é”®æ“ä½œæ˜¯å¯¹è¢«æµ‹ç¨‹åºè¿›è¡Œæ’æ¡© (Dynamic Instrumentation)ã€‚VLDB è®ºæ–‡ä¸­æåˆ°ä¸€ä¸ªäºŒè¿›åˆ¶æ’æ¡©å·¥å…· &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//www.dynamorio.org/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;DynamoRIO&lt;/a&gt;ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸ç¡®å®šç”¨å®ƒæ¥æ Go ç¼–è¯‘çš„äºŒè¿›åˆ¶èƒ½å¦æ­£å¸¸å·¥ä½œã€‚æ¢ä¸€ä¸ªæ€è·¯ï¼Œå¦‚æœèƒ½åœ¨ç¼–è¯‘ä¹‹å‰ç›´æ¥å¯¹æºç è¿›è¡Œæ’æ¡©å‘¢ï¼Ÿ&lt;/p&gt;&lt;p&gt;å‚è€ƒ &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/golang/tools/blob/master/cmd/cover/cover.go&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;go cover tool&lt;/a&gt; çš„å®ç°ï¼Œæˆ‘ä»¬å†™äº†ä¸€ä¸ªä¸“é—¨çš„ä»£ç æ’æ¡©å·¥å…· &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/fuzzdebugplatform/tidb-wrapper&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;tidb-wrapper&lt;/a&gt;ã€‚å®ƒèƒ½å¤Ÿå¯¹ä»»æ„ç‰ˆæœ¬çš„ TiDB æºç è¿›è¡Œå¤„ç†ï¼Œç”Ÿæˆ &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/DQinYuan/tidb-v3.0.0-wrapped&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;wrapped&lt;/a&gt; ä»£ç ã€‚å¹¶ä¸”åœ¨ç¨‹åºä¸­æ³¨å…¥ä¸€ä¸ª HTTP Serverï¼Œå‡è®¾æŸæ¡ SQL çš„æ‘˜è¦æ˜¯ &lt;code&gt;df6bfbff&lt;/code&gt;ï¼ˆè¿™é‡Œçš„æ‘˜è¦æŒ‡çš„æ˜¯ SQL è¯­å¥çš„ 32 ä½ MurmurHash è®¡ç®—ç»“æœçš„åå…­è¿›åˆ¶ï¼Œä¸»è¦ç›®çš„æ˜¯ç®€åŒ–ä¼ è¾“çš„æ•°æ®ï¼‰ï¼Œé‚£ä¹ˆåªè¦è®¿é—® &lt;code&gt;http://&amp;lt;tidb-server-ip&amp;gt;::43222/trace/df6bfbff&lt;/code&gt; å°±èƒ½è·å¾—è¯¥ SQL æ‰€ç»è¿‡çš„æºç æ–‡ä»¶å’Œä»£ç å—ä¿¡æ¯ã€‚&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;// http://localhost:43222/trace/df6bfbff

{
  &amp;#34;sql&amp;#34;: &amp;#34;show databases&amp;#34;,
  &amp;#34;trace&amp;#34;: [
    {
      &amp;#34;file&amp;#34;: &amp;#34;executor/batch_checker.go&amp;#34;,
      &amp;#34;line&amp;#34;: null
    },
    {
      &amp;#34;file&amp;#34;: &amp;#34;infoschema/infoschema.go&amp;#34;,
      &amp;#34;line&amp;#34;: [
        [
          113,
          113
        ],
        [
          261,
          261
        ],
       //....
    }
   ],
}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;line å­—æ®µè¾“å‡ºçš„æ¯ä¸ªäºŒå…ƒç»„éƒ½æ˜¯ä¸€ä¸ªåŸºæœ¬å—çš„èµ·å§‹ä¸ç»“æŸè¡Œå·ï¼ˆå·¦é—­å³é—­ï¼‰ã€‚åŸºæœ¬å—çš„å®šä¹‰æ˜¯ç»å¯¹ä¸ä¼šäº§ç”Ÿåˆ†æ”¯çš„ä¸€ä¸ªä»£ç å—ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬ç»Ÿè®¡çš„æœ€å°ç²’åº¦ã€‚é‚£æ˜¯å¦‚ä½•è¯†åˆ«å‡º Go ä»£ç ä¸­åŸºæœ¬å—çš„å‘¢ï¼Ÿå…¶å®å·¥ä½œé‡è¿˜æŒºå¤§çš„ï¼Œå¹¸å¥½ Go çš„æºç ä¸­æœ‰è¿™ä¸€æ®µï¼Œæˆ‘ä»¬åˆåˆšå¥½çœ‹åˆ°è¿‡ï¼Œå°±æŠŠå®ƒè£å‰ªå‡ºæ¥ï¼Œæˆä¸º &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/DQinYuan/go-blockscanner&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;go-blockscanner&lt;/a&gt;ã€‚&lt;/p&gt;&lt;p&gt;å› ä¸ºä¸»è¦ç›®æ ‡æ˜¯æ­£ç¡®æ€§è¯Šæ–­ï¼Œæ‰€ä»¥æˆ‘ä»¬é™å®šç³»ç»Ÿä¸å¯¹ TiDB å¹¶å‘æ‰§è¡Œ SQLï¼Œè¿™æ ·å°±å¯ä»¥è®¤ä¸ºä» &lt;code&gt;server/conn.go:handleQuery&lt;/code&gt; æ–¹æ³•è¢«è°ƒç”¨å¼€å§‹ï¼Œåˆ° SQLDebug æ¨¡å—è®¿é—® trace æ¥å£çš„è¿™æ®µæ—¶é—´æ‰€æœ‰è¢«æ‰§è¡Œçš„åŸºæœ¬å—éƒ½æ˜¯è¿™æ¡ SQL çš„æ‰§è¡Œè·¯å¾„ã€‚å½“ SQLDebug æ¨¡å—è®¿é—® HTTP æ¥å£ï¼Œå°†ä¼šåŒæ—¶åˆ é™¤è¯¥ SQL ç›¸å…³çš„ trace ä¿¡æ¯ï¼Œé¿å…å†…å­˜è¢«æ’‘çˆ†ã€‚&lt;/p&gt;&lt;h3&gt;åŸºæœ¬å—ç»Ÿè®¡&lt;/h3&gt;&lt;p&gt;SQLDebug æ¨¡å—åœ¨è·å–åˆ°æ¯æ¡ SQL ç»è¿‡çš„åŸºæœ¬å—ä¿¡æ¯åï¼Œä¼šå¯¹æ¯ä¸ªåŸºæœ¬å—å»ºç«‹å¦‚ä¸‹çš„å¯è§†åŒ–æ¨¡å‹ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;é¦–å…ˆæ˜¯é¢œè‰²ï¼Œç»è¿‡åŸºæœ¬å—çš„å¤±è´¥ç”¨ä¾‹æ¯”ä¾‹è¶Šé«˜ï¼ŒåŸºæœ¬å—çš„é¢œè‰²å°±è¶Šæ·±ã€‚&lt;/b&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-f783ff28d49ad35410493664321b796c_b.png&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;475&quot; data-rawheight=&quot;78&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;475&quot; data-original=&quot;https://pic1.zhimg.com/v2-f783ff28d49ad35410493664321b796c_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-f783ff28d49ad35410493664321b796c_b.png&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;475&quot; data-rawheight=&quot;78&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;475&quot; data-original=&quot;https://pic1.zhimg.com/v2-f783ff28d49ad35410493664321b796c_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-f783ff28d49ad35410493664321b796c_b.png&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;ç„¶åæ˜¯äº®åº¦ï¼Œç»è¿‡åŸºæœ¬å—çš„å¤±è´¥ç”¨ä¾‹åœ¨æ€»çš„å¤±è´¥ç”¨ä¾‹ä¸­å çš„æ¯”ä¾‹è¶Šé«˜ï¼ŒåŸºæœ¬å—çš„äº®åº¦è¶Šé«˜ã€‚&lt;/b&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-e39e7532c39b4af5b6908c227be49ebc_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;316&quot; data-rawheight=&quot;84&quot; class=&quot;content_image&quot; width=&quot;316&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-e39e7532c39b4af5b6908c227be49ebc_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;316&quot; data-rawheight=&quot;84&quot; class=&quot;content_image lazy&quot; width=&quot;316&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-e39e7532c39b4af5b6908c227be49ebc_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;å·²ç»æœ‰äº†é¢œè‰²æŒ‡æ ‡ï¼Œä¸ºä»€ä¹ˆè¿˜è¦ä¸€ä¸ªäº®åº¦æŒ‡æ ‡å‘¢ï¼Ÿå…¶å®äº®åº¦æŒ‡æ ‡æ˜¯ä¸ºäº†å¼¥è¡¥â€œé¢œè‰²æŒ‡æ ‡ Scoreâ€çš„ä¸€äº›åè§ã€‚æ¯”å¦‚æŸä¸ªä»£ç è·¯å¾„åªè¢«ä¸€ä¸ªé”™è¯¯ç”¨ä¾‹ç»è¿‡äº†ï¼Œé‚£ä¹ˆå®ƒæ˜¾ç„¶ä¼šè·å¾— Score çš„æœ€é«˜åˆ† 1ï¼Œäº‹å®ä¸Šè¿™æ¡è·¯å¾„ä¸é‚£ä¹ˆæœ‰ä»£è¡¨æ€§ï¼Œå› ä¸ºè¿™ä¹ˆå¤šé”™è¯¯ç”¨ä¾‹ä¸­åªæœ‰ä¸€ä¸ªç»è¿‡äº†è¿™æ¡è·¯å¾„ï¼Œå¤§æ¦‚ç‡ä¸æ˜¯é”™è¯¯çš„çœŸæ­£åŸå› ã€‚æ‰€ä»¥éœ€è¦é¢å¤–çš„ä¸€ä¸ªäº®åº¦æŒ‡æ ‡æ¥é¿å…è¿™ç§è·¯å¾„çš„å¹²æ‰°ï¼Œ&lt;b&gt;åªæœ‰é¢œè‰²æ·±ï¼Œäº®åº¦é«˜çš„ä»£ç å—ï¼Œæ‰æ˜¯çœŸæ­£å€¼å¾—æ€€ç–‘çš„ä»£ç å—ã€‚&lt;/b&gt;&lt;/p&gt;&lt;p&gt;ä¸Šé¢çš„ä¸¤ä¸ªæ¨¡å‹ä¸»è¦æ˜¯ä¾æ®ä¹‹å‰æåˆ°çš„ Visualization çš„è®ºæ–‡ï¼Œæˆ‘ä»¬è¿˜è‡ªåˆ›äº†ä¸€ä¸ªæ–‡ä»¶æ’åºçš„æŒ‡æ ‡ï¼Œå¤±è´¥ç”¨ä¾‹åœ¨è¯¥æ–‡ä»¶ä¸­çš„å¯†åº¦è¶Šå¤§ï¼ˆæŒ‰ç…§åŸºæœ¬å—ï¼‰ï¼Œæ–‡ä»¶æ’åè¶Šé å‰ï¼š&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-73142df482171a993ac3138dc24e5801_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;384&quot; data-rawheight=&quot;80&quot; class=&quot;content_image&quot; width=&quot;384&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-73142df482171a993ac3138dc24e5801_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;384&quot; data-rawheight=&quot;80&quot; class=&quot;content_image lazy&quot; width=&quot;384&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-73142df482171a993ac3138dc24e5801_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;å‰ç«¯æ‹¿åˆ°è¿™äº›æŒ‡æ ‡åï¼ŒæŒ‰ç…§ä¸Šé¢è®¡ç®—å‡ºçš„æ–‡ä»¶æ’åé¡ºåºè¿›è¡Œå±•ç¤ºï¼Œè¶Šé å‰çš„æ–‡ä»¶å­˜åœ¨é—®é¢˜çš„é£é™©å°±è¶Šé«˜ã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-46e202359b584ea75145b605df276ce0_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1000&quot; data-rawheight=&quot;570&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1000&quot; data-original=&quot;https://pic1.zhimg.com/v2-46e202359b584ea75145b605df276ce0_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-46e202359b584ea75145b605df276ce0_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1000&quot; data-rawheight=&quot;570&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1000&quot; data-original=&quot;https://pic1.zhimg.com/v2-46e202359b584ea75145b605df276ce0_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-46e202359b584ea75145b605df276ce0_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;å½“ç‚¹å‡»å±•å¼€åå¯ä»¥çœ‹åˆ°æŸ“è‰²åçš„ä»£ç å—ï¼š&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-c08dfb0511ca4fd2e017ef1b7b065dd1_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1000&quot; data-rawheight=&quot;685&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1000&quot; data-original=&quot;https://pic2.zhimg.com/v2-c08dfb0511ca4fd2e017ef1b7b065dd1_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-c08dfb0511ca4fd2e017ef1b7b065dd1_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1000&quot; data-rawheight=&quot;685&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1000&quot; data-original=&quot;https://pic2.zhimg.com/v2-c08dfb0511ca4fd2e017ef1b7b065dd1_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-c08dfb0511ca4fd2e017ef1b7b065dd1_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;æˆ‘ä»¬ç»è¿‡ä¸€äº›ç®€å•çš„å®éªŒï¼Œæ–‡ä»¶çº§åˆ«çš„è¯Šæ–­ç›¸å¯¹æ¯”è¾ƒå‡†ç¡®ï¼Œå¯¹äºåŸºæœ¬å—çš„è¯Šæ–­ç›¸å¯¹è¿˜æœ‰äº›ç²—ç³™ï¼Œè¿™è·Ÿæ²¡æœ‰å®ç° SQLMin æœ‰å¾ˆå¤§å…³ç³»ï¼Œæ¯•ç«Ÿ SQLMin èƒ½å»é™¤ä¸å°‘ç»Ÿè®¡æ—¶çš„å™ªå£°ã€‚&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;è¿˜èƒ½ä¸èƒ½åšç‚¹åˆ«çš„ï¼Ÿ&lt;/h2&gt;&lt;p&gt;çœ‹åˆ°è¿™é‡Œï¼Œä½ å¯èƒ½è§‰å¾—è¿™ä¸ªé¡¹ç›®ä¸è¿‡æ˜¯é’ˆå¯¹æ•°æ®åº“ç³»ç»Ÿçš„è‡ªåŠ¨åŒ–æµ‹è¯•ã€‚è€Œå®é™…ä¸Šå€ŸåŠ©ä»£ç è‡ªåŠ¨è°ƒè¯•çš„æ€è·¯ï¼Œå¯ä»¥ç»™æˆ‘ä»¬æ›´å¤šçš„å¯å‘ã€‚&lt;/p&gt;&lt;h3&gt;æºç æ•™å­¦&lt;/h3&gt;&lt;p&gt;é˜…è¯»å’Œåˆ†æå¤æ‚ç³»ç»Ÿçš„æºç æ˜¯ä¸ªå¤´ç–¼çš„äº‹æƒ…ï¼ŒTiDB å°±æ›¾å‡ºè¿‡ &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pingcap.com/blog-cn/%23TiDB-%25E6%25BA%2590%25E7%25A0%2581%25E9%2598%2585%25E8%25AF%25BB&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;24 ç¯‡æºç é˜…è¯»ç³»åˆ—æ–‡ç« &lt;/a&gt;ï¼Œç”¨ä¸€ç¯‡ç¯‡æ–‡å­—ä¸ºå¤§å®¶è§£è¯»æºç â€‹ï¼Œæ±Ÿæ¹–äººç§° â€œäºŒåå››ç« ç»â€ã€‚é‚£ä¹ˆæ˜¯å¦å¯ä»¥åŸºäºæºç çš„è¿è¡Œæ—¶å¯è§†åŒ–è·Ÿè¸ªåšæˆä¸€ä¸ªé€šç”¨å·¥å…·å‘¢ï¼Ÿè¿™æ ·åœ¨ç¨‹åºæ‰§è¡Œçš„åŒæ—¶å°±å¯ä»¥ç›´è§‚åœ°çœ‹åˆ°ä»£ç çš„è¿è¡Œè¿‡ç¨‹ï¼Œå¯¹å¿«é€Ÿç†è§£æºç ä¸€å®šä¼šå¤§æœ‰å¸®åŠ©ã€‚æ›´è¿›ä¸€æ­¥ï¼Œé…åˆæºç åœ¨çº¿æ‰§è¡Œæœ‰æ²¡æœ‰å¯èƒ½åšæˆä¸€ä¸ªåœ¨çº¿ web åº”ç”¨å‘¢ï¼Ÿ&lt;/p&gt;&lt;h3&gt;å…¨é“¾è·¯æµ‹è¯•è¦†ç›–ç»Ÿè®¡&lt;/h3&gt;&lt;p&gt;è¯­è¨€æœ¬èº«æä¾›çš„å•æµ‹è¦†ç›–ç»Ÿè®¡å·¥å…·å·²ç»æ¯”è¾ƒå®Œå¤‡äº†ï¼Œä½†ä¸€èˆ¬æµ‹è¯•æµç¨‹ä¸­è¿˜è¦é€šè¿‡ e2e æµ‹è¯•ã€é›†æˆæµ‹è¯•ã€ç¨³å®šæ€§æµ‹è¯•ç­‰ç­‰ã€‚èƒ½å¦ç”¨æœ¬æ–‡çš„æ–¹æ³•ç»¼åˆè®¡ç®—å‡ºå„ç§æµ‹è¯•çš„è¦†ç›–åº¦ï¼Œå¹¶ä¸”ä¸ CI ç³»ç»Ÿå’Œè‡ªåŠ¨åŒ–æµ‹è¯•å¹³å°æ•´åˆèµ·æ¥ã€‚åˆ©ç”¨ä»£ç æŸ“è‰²æŠ€æœ¯ï¼Œè¿˜å¯ä»¥è¾“å‡ºä»£ç æ‰§è¡Œçš„çƒ­åŠ›å›¾åˆ†æã€‚ç»“åˆ profiler å·¥å…·ï¼Œæ˜¯ä¸æ˜¯è¿˜å¯ä»¥è¾…åŠ©æ¥å®šä½ä»£ç çš„æ€§èƒ½é—®é¢˜ï¼Ÿ&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-1991043e766646c86581455e6a750458_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;919&quot; data-rawheight=&quot;357&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;919&quot; data-original=&quot;https://pic1.zhimg.com/v2-1991043e766646c86581455e6a750458_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-1991043e766646c86581455e6a750458_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;919&quot; data-rawheight=&quot;357&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;919&quot; data-original=&quot;https://pic1.zhimg.com/v2-1991043e766646c86581455e6a750458_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-1991043e766646c86581455e6a750458_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;h3&gt;Chaos Engineering&lt;/h3&gt;&lt;p&gt;åœ¨ &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pingcap.com/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;PingCAP&lt;/a&gt; å†…éƒ¨æœ‰è¯¸å¤šçš„ &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//www.infoq.cn/article/EEKM947YbboGtD_zQuLw&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Chaos&lt;/a&gt; æµ‹è¯•å¹³å°ï¼Œç”¨æ¥éªŒè¯åˆ†å¸ƒå¼ç³»ç»Ÿçš„é²æ£’æ€§ï¼Œè­¬å¦‚åƒ Schrodingerï¼Œ&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/jepsen-io/jepsen&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Jepsen&lt;/a&gt; ç­‰ç­‰ã€‚æ··æ²Œæµ‹è¯•æœ‰ä¸ªå¼Šç«¯å°±æ˜¯ï¼Œå½“è·‘å‡ºé—®é¢˜ä¹‹åæƒ³å†æ¬¡å¤ç°å°±å¾ˆéš¾ï¼Œæ‰€ä»¥åªèƒ½é€šè¿‡å½“æ—¶çš„æƒ…å½¢å»çŒœä»£ç å¯èƒ½å“ªé‡Œæœ‰é—®é¢˜ã€‚å¦‚æœèƒ½åœ¨ç¨‹åºè¿è¡Œæ—¶è®°å½•ä»£ç çš„æ‰§è¡Œè·¯å¾„ï¼Œæ ¹æ®é—®é¢˜å‘ç”Ÿæ—¶é—´ç‚¹é™„è¿‘çš„æ—¥å¿—å’Œç›‘æ§è¿›ä¸€æ­¥ç¼©å°èŒƒå›´ï¼Œå†ç»“åˆä»£ç è·¯å¾„è¿›è¡Œåˆ†æå°±èƒ½ç²¾ç¡®å¿«é€Ÿçš„å®šä½åˆ°é—®é¢˜çš„åŸå› ã€‚&lt;/p&gt;&lt;h3&gt;ä¸åˆ†å¸ƒå¼ Tracing ç³»ç»Ÿé›†æˆ&lt;/h3&gt;&lt;p&gt;Google æœ‰ä¸€ç¯‡è®ºæ–‡æ˜¯ä»‹ç»å…¶å†…éƒ¨çš„ &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//ai.google/research/pubs/pub36356&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;åˆ†å¸ƒå¼è¿½è¸ªç³»ç»Ÿ Dapper&lt;/a&gt; ï¼ŒåŒæ—¶ç¤¾åŒºä¹Ÿæœ‰æ¯”è¾ƒå‡ºåçš„é¡¹ç›® &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//opentracing.io/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Open Tracing&lt;/a&gt; ä½œä¸ºå…¶å¼€æºå®ç°ï¼ŒApache ä¸‹é¢ä¹Ÿæœ‰ç±»ä¼¼çš„é¡¹ç›® &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//skywalking.apache.org/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Skywalking&lt;/a&gt;ã€‚ä¸€èˆ¬çš„ Tracing ç³»ç»Ÿä¸»è¦æ˜¯è·Ÿè¸ªç”¨æˆ·è¯·æ±‚åœ¨å¤šä¸ªæœåŠ¡ä¹‹é—´çš„è°ƒç”¨å…³ç³»ï¼Œå¹¶é€šè¿‡å¯è§†åŒ–æ¥è¾…åŠ©æ’æŸ¥é—®é¢˜ã€‚ä½†æ˜¯ Tracing ç³»ç»Ÿçš„è·Ÿè¸ªç²’åº¦ä¸€èˆ¬æ˜¯æœåŠ¡å±‚é¢ï¼Œå¦‚æœæˆ‘ä»¬æŠŠ &lt;code&gt;trace_id&lt;/code&gt; å’Œ &lt;code&gt;span_id&lt;/code&gt; ä¹Ÿå½“ä½œæ ‡æ³¨ä¼ é€’ç»™ä»£ç å—è¿›è¡Œæ‰“æ¡©ï¼Œé‚£æ˜¯ä¸æ˜¯å¯ä»¥åœ¨ Tracing ç³»ç»Ÿçš„ç•Œé¢ä¸Šç›´æ¥ä¸‹é’»åˆ°æºç ï¼Œå¬èµ·æ¥æ˜¯ä¸æ˜¯ç‰¹åˆ«é…·ï¼Ÿ&lt;/p&gt;&lt;h2&gt;æ¥ä¸‹æ¥çš„å·¥ä½œ&lt;/h2&gt;&lt;p&gt;å› ä¸º Hackathon æ—¶é—´æœ‰é™ï¼Œæˆ‘ä»¬å½“æ—¶åªå®Œæˆäº†ä¸€ä¸ªéå¸¸ç®€å•çš„åŸå‹ï¼Œè·ç¦»çœŸæ­£å®ç°ç¡è§‰æ—¶ç¨‹åºè‡ªåŠ¨æŸ¥ bug è¿˜æœ‰ä¸€æ®µè·¯è¦èµ°ï¼Œæˆ‘ä»¬è®¡åˆ’å¯¹é¡¹ç›®æŒç»­çš„è¿›è¡Œå®Œå–„ã€‚&lt;/p&gt;&lt;p&gt;æ¥ä¸‹æ¥ï¼Œé¦–å…ˆè¦æ”¯æŒå¹¶è¡Œæ‰§è¡Œå¤šä¸ªæµ‹è¯•ç”¨ä¾‹ï¼Œè¿™æ ·æ‰èƒ½åœ¨çŸ­æ—¶é—´å¾—åˆ°è¶³å¤Ÿå¤šçš„å®éªŒæ ·æœ¬ï¼Œåˆ†æç»“æœæ‰èƒ½æ›´åŠ å‡†ç¡®ã€‚å¦å¤–ï¼Œè¦å°†æ³¨å…¥çš„ä»£ç å¯¹ç¨‹åºæ€§èƒ½çš„å½±å“é™ä½åˆ°æœ€å°ï¼Œä»è€Œåº”ç”¨äºæ›´åŠ å¹¿æ³›çš„é¢†åŸŸï¼Œæ¯”å¦‚æ€§èƒ½å‹æµ‹åœºæ™¯ï¼Œç”šè‡³åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä¹Ÿèƒ½å¤Ÿå¼€å¯ã€‚&lt;/p&gt;&lt;p&gt;çœ‹åˆ°è¿™é‡Œå¯èƒ½ä½ å·²ç»æŒ‰è€ä¸ä½äº†ï¼Œé™„ä¸Š &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/fuzzdebugplatform/fuzz_debug_platform&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;é¡¹ç›®çš„å®Œæ•´æºç &lt;/a&gt;ï¼ŒWelcome to hack!&lt;/p&gt;&lt;p&gt;&lt;b&gt;åŸæ–‡é˜…è¯»ï¼š&lt;/b&gt;&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pingcap.com/blog-cn/sqldebug-automatically/&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic2.zhimg.com/v2-60ab5bd867c2434d70c957a02a2169e1_ipico.jpg&quot; data-image-width=&quot;1200&quot; data-image-height=&quot;1200&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;åœ¨æˆ‘ä»¬ç¡è§‰çš„æ—¶å€™ï¼Œç¨‹åºèƒ½ä¸èƒ½è‡ªåŠ¨æŸ¥ bugï¼Ÿ | PingCAP&lt;/a&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>ZoeyZhai</author>
<guid isPermaLink="false">2019-12-05-95494206</guid>
<pubDate>Thu, 05 Dec 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>TiDB Binlog æºç é˜…è¯»ç³»åˆ—æ–‡ç« ï¼ˆå…­ï¼‰Pump Storage ä»‹ç»ï¼ˆä¸‹ï¼‰</title>
<link>https://henix.github.io/feeds/zhuanlan.newsql/2019-12-03-95036171.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/95036171&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-cf68ef645aebb053bc01b25e81db5071_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;ä½œè€…ï¼šChunzhu Li&lt;/p&gt;&lt;p&gt;åœ¨ &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pingcap.com/blog-cn/tidb-binlog-source-code-reading-5/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;ä¸Šç¯‡æ–‡ç« &lt;/a&gt; ä¸­ï¼Œæˆ‘ä»¬ä¸»è¦ä»‹ç»äº† Pump Storage æ˜¯å¦‚ä½•å¯¹ binlog è¿›è¡ŒæŒä¹…åŒ–å­˜å‚¨ã€æ’åºã€é…å¯¹çš„ã€‚åœ¨æ–‡ä¸­æˆ‘ä»¬æåˆ° binlog çš„æŒä¹…åŒ–é”®å€¼å­˜å‚¨ä¸»è¦æ˜¯ç”± &lt;code&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/pingcap/tidb-binlog/blob/9f3c81683bb3428c4940611a6203288474d4aff0/pump/storage/vlog.go&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;valueLog&lt;/a&gt;&lt;/code&gt; ç»„ä»¶å®Œæˆçš„ã€‚åŒæ—¶ï¼Œå¤§å®¶å¦‚æœåœ¨ä¸Šæ–‡ç‚¹å¼€ &lt;code&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/pingcap/tidb-binlog/blob/9f3c81683bb3428c4940611a6203288474d4aff0/pump/storage/storage.go%23L889&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;writeToValueLog&lt;/a&gt;&lt;/code&gt; ä»£ç é˜…è¯»çš„è¯ä¼šå‘ç°åœ¨å…¶ä¸­è¿˜ä¼šä½¿ç”¨ä¸€ä¸ª &lt;code&gt;slowChaser&lt;/code&gt; ç»„ä»¶ã€‚&lt;code&gt;slowChaser&lt;/code&gt; ç»„ä»¶ä¸»è¦ç”¨äºé¿å…åœ¨å†™ kv ç¯èŠ‚ä¸­ GoLevelDB å†™å…¥å¤ªæ…¢ç”šè‡³å‡ºç° write paused æ—¶å½±å“ Pump Storage çš„æ‰§è¡Œæ•ˆç‡çš„é—®é¢˜ã€‚&lt;/p&gt;&lt;p&gt;æ¥ä¸‹æ¥ï¼Œæœ¬ç¯‡æ–‡ç« é‡ç‚¹ä»‹ç» &lt;code&gt;valueLog&lt;/code&gt; ä¸ &lt;code&gt;slowChaser&lt;/code&gt; è¿™ä¸¤ä¸ªç»„ä»¶ã€‚&lt;/p&gt;&lt;h2&gt;valueLog&lt;/h2&gt;&lt;p&gt;&lt;code&gt;valueLog&lt;/code&gt; ç»„ä»¶çš„ä»£ç ä½äº &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/pingcap/tidb-binlog/blob/9f3c81683bb3428c4940611a6203288474d4aff0/pump/storage/vlog.go%23L156&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;pump/storage/vlog.go&lt;/a&gt; ä¸­ï¼Œä¸»è¦ä½œç”¨æ˜¯ç®¡ç†ç£ç›˜ä¸­çš„æ‰€æœ‰å­˜æ”¾ Binlog Event çš„ logFile æ–‡ä»¶ã€‚Pump æœ¬åœ° GoLevelDB ä¸­å­˜å‚¨çš„ key value ä¸­ï¼Œkey ç”¨ Binlog çš„ &lt;code&gt;StartTs/CommitTs&lt;/code&gt; æ‹¼æˆï¼Œvalue åˆ™åªæ˜¯ä¸€ä¸ªç´¢å¼•ï¼ŒæŒ‡å‘ &lt;code&gt;valueLog&lt;/code&gt; ä¸­çš„ä¸€æ¡ Binlog è®°å½•ã€‚&lt;code&gt;valueLog&lt;/code&gt; çš„ç»“æ„ä½“å®šä¹‰å¦‚ä¸‹æ‰€ç¤ºï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;type valueLog struct {
	buf *bytes.Buffer // buf to write to the current log file

	dirPath   string
	sync      bool
	maxFid    uint32
	filesLock sync.RWMutex
	filesMap  map[uint32]*logFile

	opt *Options
}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;logFile æ–‡ä»¶åœ¨ Pump æŒ‡å®šæ•°æ®ç›®å½•ä¸‹ä¼šä»¥ç±»ä¼¼ â€œ000001.logâ€ çš„å‘½åä¿å­˜ï¼Œå…¶ä¸­çš„ â€œ000001â€ å³ä¸ºè¡¨ç¤º logFile æ–‡ä»¶ç¼–å·çš„ Fidã€‚&lt;code&gt;valueLog&lt;/code&gt; ä¸­çš„ &lt;code&gt;maxFid&lt;/code&gt; ä¸ºæ–‡ä»¶ä¸­æœ€å¤§çš„ Fidï¼Œ&lt;code&gt;valueLog&lt;/code&gt; ä¹Ÿåªä¼šæŠŠ binlog å†™åˆ° maxFid çš„ logFileã€‚ filesMap ä¸­ä¼šä¿å­˜æ‰€æœ‰çš„ Fid ç¼–å·æ‰€å¯¹åº”çš„ logFile å¯¹è±¡ã€‚logFile åŒ…å«äº†å•ä¸ª logFile çš„ä¸€äº›å±æ€§å’Œæ–¹æ³•ï¼Œä¸»è¦åŒ…å«åœ¨ &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/pingcap/tidb-binlog/blob/9f3c81683bb3428c4940611a6203288474d4aff0/pump/storage/log.go%23L51&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;pump/storage/log.go&lt;/a&gt; ä¸­ã€‚&lt;/p&gt;&lt;p&gt;valueLog ä½œä¸ºæŒä¹…åŒ– Binlog Event åˆ° logFiles çš„ç»„ä»¶ï¼ŒåŒ…å«äº†ä¸€ç³»åˆ—å¯¹ logFiles è¿›è¡Œçš„æ“ä½œã€‚ä¸‹é¢æˆ‘ä»¬æ¥çœ‹çœ‹å…¶ä¸­å‡ ä¸ªæ¯”è¾ƒé‡è¦çš„æ–¹æ³•ã€‚&lt;/p&gt;&lt;h3&gt;1. &lt;code&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/pingcap/tidb-binlog/blob/9f3c81683bb3428c4940611a6203288474d4aff0/pump/storage/vlog.go%23L297&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;readValue&lt;/a&gt;&lt;/code&gt;&lt;/h3&gt;&lt;p&gt;è¯¥å‡½æ•°çš„ä½œç”¨æ˜¯ä½¿ç”¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­æåˆ°çš„ &lt;code&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/pingcap/tidb-binlog/blob/9f3c81683bb3428c4940611a6203288474d4aff0/pump/storage/vlog.go%23L123&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;valuePointer&lt;/a&gt;&lt;/code&gt; åœ¨ç£ç›˜çš„ logFiles ä¸­å®šä½åˆ°å¯¹åº”çš„ Binlog Eventã€‚è¯¥å‡½æ•°ä¼šåœ¨ Pump å‘ Drainer å‘ Binlogs å’Œå‘ TiKV æŸ¥è¯¢ Binlog çš„æäº¤çŠ¶æ€æ—¶è¢«ç”¨åˆ°ã€‚&lt;/p&gt;&lt;h3&gt;2. &lt;code&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/pingcap/tidb-binlog/blob/9f3c81683bb3428c4940611a6203288474d4aff0/pump/storage/vlog.go%23L314&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;write&lt;/a&gt;&lt;/code&gt;&lt;/h3&gt;&lt;p&gt;é¡¾åæ€ä¹‰ï¼Œä¸»è¦ä½œç”¨æ˜¯å¤„ç† &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/pingcap/tidb-binlog/blob/9f3c81683bb3428c4940611a6203288474d4aff0/pump/storage/vlog.go%23L100&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;å†™ binlog è¯·æ±‚&lt;/a&gt;ï¼Œåœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­æåˆ°çš„ &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/pingcap/tidb-binlog/blob/9f3c81683bb3428c4940611a6203288474d4aff0/pump/storage/storage.go%23L889&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;writeToValueLog&lt;/a&gt; è¢«ç”¨åˆ°ï¼Œä¸æ˜¯å¹¶å‘å®‰å…¨çš„ã€‚ä¸ºäº†æé«˜å†™å…¥æ•ˆç‡ï¼Œ&lt;code&gt;write&lt;/code&gt; å‡½æ•°åœ¨å¤„ç†ä¸€ç»„å†™ binlog request æ—¶ï¼Œä¼šå…ˆä½¿ç”¨ &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/pingcap/tidb-binlog/blob/9f3c81683bb3428c4940611a6203288474d4aff0/pump/storage/log.go%23L83&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;encodeRecord&lt;/a&gt; å‡½æ•°æŠŠå°†è¦å†™å…¥çš„ binlog event ç¼–ç åå­˜å…¥ &lt;code&gt;bufReqs&lt;/code&gt; æ•°ç»„ï¼Œéšåå†é€šè¿‡ &lt;code&gt;toDisk&lt;/code&gt; å‡½æ•°å†™å…¥ logFile æ–‡ä»¶ã€‚å¦‚æœè¦å†™å…¥çš„ç›®æ ‡ logFile æ–‡ä»¶å·²ç»å¾ˆå¤§ï¼Œåˆ™æ–°å»ºå¹¶åˆ‡æ¢åˆ°æ–°çš„ log æ–‡ä»¶ï¼ŒåŒæ—¶å¢å¤§ maxFidã€‚&lt;/p&gt;&lt;p&gt;ä¸€ä¸ªå®Œæ•´çš„ binlog æ–‡ä»¶çš„ç¼–ç æ ¼å¼åœ¨ log.go &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/pingcap/tidb-binlog/blob/9f3c81683bb3428c4940611a6203288474d4aff0/pump/storage/log.go%23L33&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;å¼€å¤´æ³¨é‡Š&lt;/a&gt; ä¸­ï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;/*
log file := records + log file footer
record :=
  magic: uint32   // magic number of a record start
  length: uint64  // payload é•¿åº¦
  checksum: uint32   // checksum of payload
  payload:  uint8[length]    // binlog æ•°æ®
footer :=
  maxTS: uint64     // the max ts of all binlog in this log file, so we can check if we can safe delete the file when gc according to ts
  fileEndMagic: uint32  // check if the file has a footer
*/&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¸€ä¸ª binlog æ–‡ä»¶ä¸­å¾€å¾€åŒ…å«äº†å¤šæ¡ recordã€‚ä¸€æ¡ record ä¸­å¼€å¤´çš„ 16 ä¸ªå­—èŠ‚ä¸º record å¤´ï¼šå…¶ä¸­å‰ 4 ä¸ªå­—èŠ‚ä¸ºè¡¨ç¤º record æ•°æ®å¼€å§‹çš„ magic ç ï¼›ä¸­é—´ 8 ä¸ªå­—èŠ‚ä¿å­˜äº†è¯¥æ¡ record çš„é•¿åº¦ï¼›æœ€å 4 ä¸ªå­—èŠ‚ä¸º checksumï¼Œç”¨äºæ ¡éªŒã€‚record å¤´åé¢ç´§è·Ÿçš„æ˜¯å•ä¸ª binlog event çš„äºŒè¿›åˆ¶ç¼–ç ã€‚è¿™æ ·ç¼–ç çš„ä¸€å¤§å¥½å¤„æ˜¯ &lt;code&gt;valueLog&lt;/code&gt; åªéœ€è¦ Offset å‚æ•°å°±èƒ½å¾—åˆ° binlog ç¼–ç æ®µã€‚&lt;/p&gt;&lt;p&gt;å®Œæ•´çš„ log æ–‡ä»¶å°¾éƒ¨è¿˜æœ‰ä¸€ä¸ª footerã€‚valueLog ä¸ä¼šå‘å·²ç»æœ‰ footer çš„ log æ–‡ä»¶å†™å…¥æ–°çš„ binlog eventã€‚footer çš„å‰ 8 ä¸ªå­—èŠ‚ä¸ºè¯¥ logFile ä¸­æ‰€æœ‰ Binlog çš„ maxTSï¼Œè¯¥å€¼å¯ç”¨äºåé¢ä»‹ç»åˆ°çš„ GC æ“ä½œã€‚å 4 ä¸ªå­—èŠ‚ä¸ºè¡¨ç¤ºæ–‡ä»¶å·²ç»“æŸçš„ magic ç ã€‚&lt;/p&gt;&lt;h3&gt;3. &lt;code&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/pingcap/tidb-binlog/blob/9f3c81683bb3428c4940611a6203288474d4aff0/pump/storage/vlog.go%23L202&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;openOrCreateFiles&lt;/a&gt;&lt;/code&gt;&lt;/h3&gt;&lt;p&gt;åœ¨ Pump Storage å¯åŠ¨æ—¶ä¼šä½¿ç”¨è¯¥å‡½æ•°å¯åŠ¨ &lt;code&gt;valueLog&lt;/code&gt; ç»„ä»¶ï¼Œåˆå§‹åŒ– &lt;code&gt;valueLog&lt;/code&gt; çš„é…ç½®ä¿¡æ¯ï¼Œè¯»å–ç£ç›˜çš„ log æ–‡ä»¶å¹¶å°†æ–‡æ¡£ä¿¡æ¯å¯¼å…¥åˆ° &lt;code&gt;filesMap&lt;/code&gt; ä¸­ã€‚&lt;/p&gt;&lt;p&gt;åœ¨ &lt;code&gt;valueLog&lt;/code&gt; å¯åŠ¨æ—¶ï¼Œå¦‚æœè¦å†™å…¥çš„ logFile æ²¡æœ‰ footerï¼Œåˆ™è¯¥å‡½æ•°ä¼šä½¿ç”¨ &lt;code&gt;scan&lt;/code&gt; æ–¹æ³•æ‰«æè¯¥ logFile çš„æ‰€æœ‰ binlogï¼Œæ±‚å‡º &lt;code&gt;maxTS&lt;/code&gt; æ›´æ–°è‡³å†…å­˜ã€‚å› æ­¤åœ¨å…³é—­ &lt;code&gt;valueLog&lt;/code&gt; æ—¶ï¼Œå¦‚æœå½“å‰æ–‡ä»¶å·²ç»è¾ƒå¤§ï¼Œåˆ™å°†æ–‡ä»¶åŠ ä¸Š footerï¼Œå°†å†…å­˜ä¸­çš„ &lt;code&gt;maxTS&lt;/code&gt; æŒä¹…åŒ–åˆ° footer ä»¥èŠ‚çœä¸‹æ¬¡å¯åŠ¨ &lt;code&gt;valueLog&lt;/code&gt; æ—¶è¿›è¡Œ &lt;code&gt;scan&lt;/code&gt; æŸ¥è¯¢çš„æ—¶é—´ã€‚&lt;/p&gt;&lt;h3&gt;4. &lt;code&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/pingcap/tidb-binlog/blob/9f3c81683bb3428c4940611a6203288474d4aff0/pump/storage/vlog.go%23L415&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;scan&lt;/a&gt;&lt;/code&gt; ä¸ &lt;code&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/pingcap/tidb-binlog/blob/9f3c81683bb3428c4940611a6203288474d4aff0/pump/storage/vlog.go%23L386&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;scanRequests&lt;/a&gt;&lt;/code&gt;&lt;/h3&gt;&lt;p&gt;æ‰«ææŸä¸ª &lt;code&gt;valuePointer&lt;/code&gt; ä¹‹åçš„æ‰€æœ‰åœ¨ logFiles ä¸­çš„ binlog eventï¼Œå¹¶å°†è¯»åˆ°çš„ binlog event é€šè¿‡ &lt;code&gt;fn&lt;/code&gt; å‡½æ•°è¿›è¡Œå¯¹åº”çš„å¤„ç†ã€‚Pump Storage åœ¨é‡å¯æ—¶ä¼šä½¿ç”¨è¯¥å‡½æ•°è¯»å–æŒä¹…åŒ–åˆ° vlog ä½†è¿˜æ²¡å°†ç´¢å¼•å†™åˆ° kv çš„ binlog event å¹¶ &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/pingcap/tidb-binlog/blob/9f3c81683bb3428c4940611a6203288474d4aff0/pump/storage/storage.go%23L229&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;äº¤ç»™ kv ç»„ä»¶å¤„ç†&lt;/a&gt;ã€‚ä¸ºæé«˜æ•ˆç‡ï¼Œscan åªåœ¨è¯»å–æ–‡ä»¶åˆ—è¡¨æ—¶åŠ æ–‡ä»¶é”ï¼Œè¯»å–å®Œæ¯•å¼€å§‹æ‰«æåå¦‚æœæœ‰å¹¶å‘å†™å…¥çš„ logFile åˆ™ä¸ä¼šè¢« scan æ‰«åˆ°ã€‚&lt;/p&gt;&lt;h3&gt;5. &lt;code&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/pingcap/tidb-binlog/blob/9f3c81683bb3428c4940611a6203288474d4aff0/pump/storage/vlog.go%23L442&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;gcTS&lt;/a&gt;&lt;/code&gt;&lt;/h3&gt;&lt;p&gt;åœ¨ Storage è¿›è¡Œ GC æ—¶ä½¿ç”¨ï¼Œå‰é¢ write ä¸­æåˆ°çš„ &lt;code&gt;maxTS&lt;/code&gt; å³åœ¨è¿™é‡Œä½¿ç”¨ã€‚è¯¥å‡½æ•°ä¼šç›´æ¥åˆ æ‰ç£ç›˜ç›®å½•ä¸‹æ‰€æœ‰ &lt;code&gt;maxTS&lt;/code&gt; å°äº &lt;code&gt;gcTS&lt;/code&gt; çš„ logFile ä»¥èŠ‚çº¦ç£ç›˜ç©ºé—´ã€‚&lt;/p&gt;&lt;h2&gt;slowChaser&lt;/h2&gt;&lt;p&gt;&lt;code&gt;slowChaser&lt;/code&gt; ç»„ä»¶çš„ä»£ç ä¸»è¦ä½äº &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/pingcap/tidb-binlog/blob/9f3c81683bb3428c4940611a6203288474d4aff0/pump/storage/chaser.go&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;pump/storage/chaser.go&lt;/a&gt; ä¸­ã€‚å…¶ç»“æ„ä½“å®šä¹‰å¦‚ä¸‹æ‰€ç¤ºï¼š&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;type slowChaser struct {
	on                 int32
	vlog               valLogScanner
	lastUnreadPtr      *valuePointer
	recoveryTimeout    time.Duration
	lastRecoverAttempt time.Time
	output             chan *request
	WriteLock          sync.Mutex
}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;çœ‹åˆ°è¿™é‡Œï¼Œç›¸ä¿¡å¤§å®¶ä¹Ÿä¸€å®šæœ‰ä¸ªç–‘é—®ï¼šæ—¢ç„¶ Pump å·²ç»æœ‰äº†æ­£å¸¸å†™ binlogs çš„é“¾è·¯ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬è¿˜è¦å†å¼•å…¥&lt;/b&gt; &lt;b&gt;&lt;code&gt;slowChaser&lt;/code&gt;&lt;/b&gt; &lt;b&gt;ç»„ä»¶å‘¢ï¼Ÿ&lt;/b&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-60eaf7c835ab40acf184f4d5cd2a99c2_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;287&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic3.zhimg.com/v2-60eaf7c835ab40acf184f4d5cd2a99c2_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-60eaf7c835ab40acf184f4d5cd2a99c2_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;287&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic3.zhimg.com/v2-60eaf7c835ab40acf184f4d5cd2a99c2_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-60eaf7c835ab40acf184f4d5cd2a99c2_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;åœ¨ä¸Šç¯‡æ–‡ç« ä¸­æˆ‘ä»¬æåˆ°ï¼Œå½“ Pump Server æ”¶åˆ° binlog åï¼Œä¼šæŒ‰ç…§ vlog -&amp;gt; kv -&amp;gt;  sorter çš„é¡ºåºä¼ é€’ binlogï¼Œæ¯ä¸€æ¡ binlog éƒ½ä¼šåœ¨ä¸Šä¸€æ­¥å†™å…¥å®Œæˆåå‘é€ç»™ä¸‹ä¸€æ­¥ç»„ä»¶çš„è¾“å…¥ channelã€‚åœ¨ &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/pingcap/tidb-binlog/blob/9f3c81683bb3428c4940611a6203288474d4aff0/pump/storage/storage.go%23L1367&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;å†™ kv æ—¶&lt;/a&gt;ï¼ŒGoLevelDB å¯èƒ½ä¼šå› ä¸ºæ‰§è¡Œ compaction å¯¼è‡´å†™å…¥å˜æ…¢ç”šè‡³å‡ºç° write paused ç°è±¡ã€‚æ­¤æ—¶ï¼Œå½“ vlog -&amp;gt; kv channel è£…æ»¡åï¼Œåˆ™éœ€è¦ &lt;code&gt;slowChaser&lt;/code&gt; æ¥å¤„ç†åç»­çš„ binlog åˆ° kvã€‚&lt;/p&gt;&lt;h3&gt;slowChaser çš„åˆå§‹åŒ–ä¸å¯åŠ¨&lt;/h3&gt;&lt;p&gt;&lt;code&gt;slowChaser&lt;/code&gt; ä¼šåœ¨è°ƒç”¨ &lt;code&gt;writeValueLog&lt;/code&gt; å‡½æ•°çš„ä¸€å¼€å§‹å°±è¢«å®ä¾‹åŒ–ï¼Œå¹¶åŒæ—¶å¼€å¯çº¿ç¨‹è¿è¡Œ &lt;code&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/pingcap/tidb-binlog/blob/9f3c81683bb3428c4940611a6203288474d4aff0/pump/storage/chaser.go%23L72&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;slowChaser.Run()&lt;/a&gt;&lt;/code&gt;ã€‚ä½†æ­¤æ—¶ &lt;code&gt;slowChaser&lt;/code&gt; å¹¶æœªå¼€å§‹æ‰«æï¼Œåªæ˜¯å¼€å§‹ç›‘è§† Pump å†™ kv çš„é€Ÿåº¦ã€‚&lt;/p&gt;&lt;p&gt;å¼€å¯ &lt;code&gt;slowChaser&lt;/code&gt; çš„ä»£ç ä½äº &lt;code&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/pingcap/tidb-binlog/blob/9f3c81683bb3428c4940611a6203288474d4aff0/pump/storage/storage.go%23L946&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;writeValueLog&lt;/a&gt;&lt;/code&gt;ã€‚å½“æˆ‘ä»¬å‘ç°å‘ buffer channel ä¸­å†™å…¥ request &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/pingcap/tidb-binlog/blob/9f3c81683bb3428c4940611a6203288474d4aff0/pump/storage/storage.go%23L945&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;ç­‰å¾…çš„æ—¶é—´è¶…è¿‡ 1 ç§’&lt;/a&gt;ï¼Œ&lt;code&gt;slowChaser&lt;/code&gt; ä¾¿ä¼šè¢«å¼€å¯ã€‚åŒæ—¶ä»è¯¥ binlog å¼€å§‹ä¹‹ååœ¨ &lt;code&gt;writeValueLog&lt;/code&gt; ä¸­å†™å…¥ç£ç›˜çš„ binlog å‡ä¸ä¼šå†å†ä¼ é€’è¿› vlog -&amp;gt; kv ä¹‹é—´çš„ buffer channelï¼Œç›´åˆ° &lt;code&gt;slowChaser&lt;/code&gt; è¢«å…³é—­ä¸ºæ­¢ã€‚&lt;/p&gt;&lt;p&gt;å› ä¸º &lt;code&gt;slowChaser&lt;/code&gt; æ˜¯å¯èƒ½è¢«å¤šæ¬¡å¯åœçš„ï¼Œå› æ­¤åœ¨ &lt;code&gt;slowChaser&lt;/code&gt; çš„ &lt;code&gt;Run&lt;/code&gt; å‡½æ•°ä¸­æˆ‘ä»¬ä½¿ç”¨ &lt;code&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/pingcap/tidb-binlog/blob/9f3c81683bb3428c4940611a6203288474d4aff0/pump/storage/chaser.go%23L150&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;waitUntilTurnedOn&lt;/a&gt;&lt;/code&gt; å‡½æ•°æ¯éš” 0.5 ç§’å°±æ£€æŸ¥ &lt;code&gt;slowChaser&lt;/code&gt; çš„å¯åŠ¨çŠ¶æ€ã€‚&lt;/p&gt;&lt;h3&gt;slowChaser çš„æ‰«ææ“ä½œï¼šcatchUp&lt;/h3&gt;&lt;p&gt;&lt;code&gt;slowChaser&lt;/code&gt; åœ¨è¢«å¯åŠ¨åä¼šä½¿ç”¨ &lt;code&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/pingcap/tidb-binlog/blob/9f3c81683bb3428c4940611a6203288474d4aff0/pump/storage/chaser.go%23L130&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;catchUp&lt;/a&gt;&lt;/code&gt; å‡½æ•°å»æ‰«æç£ç›˜ç›®å½•ï¼Œä» &lt;code&gt;lastUnreadPtr&lt;/code&gt; å³ç¬¬ä¸€ä¸ªæ²¡æœ‰è¢«å†™ kv çš„ binlog çš„ &lt;code&gt;valuePointer&lt;/code&gt; å¼€å§‹ã€‚è¯¥å€¼ä¼šåœ¨å¯åŠ¨ &lt;code&gt;slowChaser&lt;/code&gt; æ—¶è®¾ç½®ä¸ºå½“æ—¶çš„ binlog å¯¹åº”çš„ &lt;code&gt;valuePointer&lt;/code&gt;ï¼Œä¹‹åä¼šåœ¨æ¯æ¬¡æˆåŠŸå†™å…¥ kv åå°±æ›´æ–°ã€‚&lt;/p&gt;&lt;p&gt;æœ‰äº†èµ·å§‹ &lt;code&gt;valuePointer&lt;/code&gt; ä»¥åï¼Œ&lt;code&gt;slowChaser&lt;/code&gt; ä¼šä½¿ç”¨å‰æ–‡æåˆ°çš„ &lt;code&gt;valueLog&lt;/code&gt; çš„ &lt;code&gt;scanRequests&lt;/code&gt; æ–¹æ³•è¿›è¡Œä¸€æ¬¡æ‰«æã€‚æ‰«ææ—¶ chaser ä¼šæŠŠæ‰«å‡ºçš„æ¯æ¡ binlog é€ä¸€å‘ç»™ toKV channelã€‚&lt;/p&gt;&lt;h3&gt;slowChaser çš„è¿è¡Œä¸å…³é—­&lt;/h3&gt;&lt;p&gt;åœ¨å‰é¢ä»‹ç»äº† &lt;code&gt;slowChaser&lt;/code&gt; çš„ä½œç”¨ï¼Œä½†æˆ‘ä»¬åº”å½“æ³¨æ„çš„æ˜¯ &lt;code&gt;slowChaser&lt;/code&gt; æ¯•ç«Ÿæ˜¯ä¸€ä¸ª â€œslowâ€ çš„ç»„ä»¶ï¼Œæ˜¯é’ˆå¯¹å†™ kv ç¼“æ…¢çš„æ— å¥ˆä¹‹ä¸¾ï¼Œä»ç¡¬ç›˜ä¸­æ‰«æè¯»å– binlog å†å†™ kv çš„æ“ä½œæ˜¯å¿…ç„¶æ…¢äºç›´æ¥ä»å†…å­˜å†™ kv çš„ã€‚å› æ­¤ &lt;code&gt;slowChaser&lt;/code&gt; å¯åŠ¨æ‰«æåï¼Œæˆ‘ä»¬å°±åº”è¯¥è§‚å¯Ÿå†™ kv çš„é€Ÿåº¦æ˜¯å¦å·²ç»æ¢å¤æ­£å¸¸ï¼Œä»¥åŠåœ¨ç£ç›˜ä¸­çš„ binlog æ˜¯å¦å·²ç»å…¨éƒ¨å†™åˆ° kvï¼Œä»è€Œé€‚æ—¶å…³æ‰ &lt;code&gt;slowChaser&lt;/code&gt; ä»¥æé«˜è¿è¡Œé€Ÿåº¦ã€‚åŸºäºæ­¤ï¼Œä¸‹é¢æˆ‘ä»¬å°†ä»‹ç» &lt;code&gt;slowChaser&lt;/code&gt; çš„ &lt;code&gt;catchUp&lt;/code&gt; ä¸å…³é—­æ“ä½œï¼Œä¸»è¦æ¶‰åŠ &lt;code&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/pingcap/tidb-binlog/blob/9f3c81683bb3428c4940611a6203288474d4aff0/pump/storage/chaser.go%23L72&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;slowChaser.Run()&lt;/a&gt;&lt;/code&gt; çš„ for å¾ªç¯é‡Œçš„ä»£ç ã€‚&lt;/p&gt;&lt;p&gt;&lt;code&gt;slowChaser&lt;/code&gt; åœ¨æ¯è½®è¿è¡Œæ—¶ä¼šè¿›è¡Œè‡³å¤šä¸¤æ¬¡ &lt;code&gt;catchUp&lt;/code&gt; æ“ä½œï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;ç¬¬ä¸€æ¬¡ &lt;code&gt;catchUp&lt;/code&gt; æ“ä½œä¸ä¼šä½¿ç”¨å†™é”ç¦æ­¢ &lt;code&gt;valueLog&lt;/code&gt; ç»„ä»¶å†™ logFile åˆ°ç£ç›˜ã€‚åœ¨æ­£å¸¸æ‰«æå®Œç£ç›˜ä¸­çš„ binlog åï¼Œchaser ä¼šåŒæ—¶è®¡ç®—æœ¬æ¬¡ &lt;code&gt;catchUp&lt;/code&gt; æ‰€èŠ±è´¹çš„æ—¶é—´ï¼Œå¦‚æœèŠ±è´¹æ—¶é—´è¾ƒçŸ­ï¼Œè¯´æ˜è¿™å¯èƒ½æ˜¯ä¸ªæ¢å¤æ­£å¸¸è¿è½¬çš„å¥½æ—¶æœºã€‚è¿™æ—¶ &lt;code&gt;slowChaser&lt;/code&gt; ä¼šè¿›å…¥ç¬¬äºŒæ¬¡ &lt;code&gt;catchUp&lt;/code&gt; æ“ä½œï¼Œå°è¯•æ‰«å®Œæ‰€æœ‰ binlog å¹¶å…³é—­ &lt;code&gt;slowChaser&lt;/code&gt;ã€‚å¦‚æœæœ¬æ¬¡ &lt;code&gt;catchUp&lt;/code&gt; èŠ±è´¹æ—¶é—´è¿‡é•¿æˆ–è€…åœ¨ 1 åˆ†é’Ÿå†…è¿›è¡Œè¿‡ç¬¬äºŒæ¬¡çš„ &lt;code&gt;catchUp&lt;/code&gt; æ“ä½œåˆ™ä¼šè·³è¿‡ç¬¬äºŒæ¬¡ &lt;code&gt;catchUp&lt;/code&gt; ç›´æ¥è¿›å…¥ä¸‹ä¸€è½®ã€‚&lt;/li&gt;&lt;li&gt;ç¬¬äºŒæ¬¡ &lt;code&gt;catchUp&lt;/code&gt; ä¼šåœ¨æ“ä½œå¼€å§‹å‰è®°å½•æœ¬æ¬¡æ¢å¤å¼€å§‹çš„æ—¶é—´ï¼ŒåŒæ—¶ä¸Šé”é˜»æ­¢ vlog å†™ binlog åˆ°ç£ç›˜ã€‚å¦‚æœ &lt;code&gt;catchUp&lt;/code&gt; åœ¨ 1 ç§’å†…å®Œæˆï¼Œæ­¤æ—¶ç£ç›˜ä¸­æ‰€æœ‰ binlog éƒ½å·²ç»å†™åˆ° kv ï¼Œ åˆ™ &lt;code&gt;slowChaser&lt;/code&gt; å¯ä»¥å®‰å…¨åœ°è¢«å…³é—­ã€‚å¦‚æœ &lt;code&gt;catchUp&lt;/code&gt; è¶…æ—¶ï¼Œä¸ºé¿å…é•¿æ—¶é—´æŒé”é˜»æ­¢ vlog å†™ binlog å½±å“æ€§èƒ½ï¼Œ&lt;code&gt;slowChaser&lt;/code&gt; å°†ç»§ç»­è¿›è¡Œä¸‹ä¸€è½®çš„ &lt;code&gt;catchUp&lt;/code&gt;ã€‚ç¬¬äºŒæ¬¡ catchUp æ“ä½œç»“æŸæ—¶ä¸è®ºæˆè´¥äº’æ–¥é”éƒ½å°†è¢«é‡Šæ”¾ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;code&gt;slowChaser&lt;/code&gt; åœ¨æˆåŠŸ catch up ä¹‹åä¼šè¢«å…³é—­ï¼Œä½†ä¸ä¼šå®Œå…¨åœæ­¢è¿è¡Œï¼Œåªæ˜¯è¿›å…¥äº† â€œç¡çœ â€ çŠ¶æ€ï¼Œç»§ç»­ä¸æ–­ç›‘è§† Pump å†™ kv çš„é€Ÿåº¦ã€‚ä¸€æ—¦ &lt;code&gt;writeValueLog&lt;/code&gt; ä¸­å†æ¬¡å‡ºç°äº†å†™ kv æ…¢çš„ç°è±¡ï¼Œ&lt;code&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/pingcap/tidb-binlog/blob/9f3c81683bb3428c4940611a6203288474d4aff0/pump/storage/chaser.go%23L58&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;slowChaser.TurnOn&lt;/a&gt;&lt;/code&gt; è¢«è°ƒç”¨ï¼Œ&lt;code&gt;slowChaser&lt;/code&gt; åˆä¼šé‡æ–°å¯åŠ¨ï¼Œå¼€å§‹æ–°çš„è½®æ¬¡çš„ &lt;code&gt;catchUp&lt;/code&gt; æ“ä½œã€‚åªæœ‰å½“ &lt;code&gt;writeValueLog&lt;/code&gt; å‡½æ•°é€€å‡ºæ—¶ï¼Œ&lt;code&gt;slowChaser&lt;/code&gt; æ‰ä¼šçœŸæ­£éšä¹‹é€€å‡ºå¹¶å®Œå…¨åœæ­¢è¿è¡Œã€‚&lt;/p&gt;&lt;h2&gt;å°ç»“&lt;/h2&gt;&lt;p&gt;æœ¬æ–‡ä»‹ç»äº† Pump Storage çš„ä¸¤ä¸ªé‡è¦ç»„ä»¶ &lt;code&gt;valueLog&lt;/code&gt;ï¼Œ&lt;code&gt;slowChaser&lt;/code&gt; çš„ä¸»è¦åŠŸèƒ½ä¸å…·ä½“å®ç°ï¼Œå¸Œæœ›èƒ½å¸®åŠ©å¤§å®¶æ›´å¥½åœ°ç†è§£ Pump éƒ¨åˆ†çš„æºç ã€‚&lt;/p&gt;&lt;p&gt;è‡³æ­¤ TiDB Binlog æºç çš„ Pump éƒ¨åˆ†çš„ä»£ç å·²åŸºæœ¬ä»‹ç»å®Œæ¯•ï¼Œåœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­æˆ‘ä»¬å°†å¼€å§‹ä»‹ç» Drainer Server æ¨¡å—ï¼Œå¸®åŠ©å¤§å®¶ç†è§£ Drainer æ˜¯å¦‚ä½•å¯åŠ¨ï¼Œç»´æŠ¤çŠ¶æ€ä¸è·å–å…¨å±€ binlog æ•°æ®ä¸ Schema ä¿¡æ¯çš„ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;åŸæ–‡é˜…è¯»ï¼š&lt;/b&gt;&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pingcap.com/blog-cn/tidb-binlog-source-code-reading-6/&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic2.zhimg.com/v2-60ab5bd867c2434d70c957a02a2169e1_ipico.jpg&quot; data-image-width=&quot;1200&quot; data-image-height=&quot;1200&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TiDB Binlog æºç é˜…è¯»ç³»åˆ—æ–‡ç« ï¼ˆå…­ï¼‰Pump Storage ä»‹ç»ï¼ˆä¸‹ï¼‰ | PingCAP&lt;/a&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>ZoeyZhai</author>
<guid isPermaLink="false">2019-12-03-95036171</guid>
<pubDate>Tue, 03 Dec 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>æ±½è½¦ä¹‹å®¶ä» SQL Server åˆ° TiDB çš„å¼‚æ„å˜è¿</title>
<link>https://henix.github.io/feeds/zhuanlan.newsql/2019-12-02-94674193.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/94674193&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-809d87ae1ec627f1c9ae4032a13146f7_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;blockquote&gt;ä»¥ä¸‹æ–‡ç« æ¥æºäºå¾®ä¿¡å…¬ä¼—å·ä¹‹å®¶æŠ€æœ¯ï¼Œä½œè€…ä¹‹å®¶æŠ€æœ¯æ¶æ„ç»„ã€‚&lt;/blockquote&gt;&lt;p&gt;SQL Server + .Net æ˜¯å¾ˆå¤šæ—©æœŸäº’è”ç½‘ä¼ä¸šçš„æ ‡é…æŠ€æœ¯æ ˆï¼Œè™½ç„¶ TiDB æ˜¯å…¼å®¹ MySQL åè®®å’Œç”Ÿæ€çš„æ•°æ®åº“ï¼Œä½†æ˜¯ TiDB é€‚ç”¨çš„ä¸šåŠ¡åœºæ™¯æ˜¯é€šç”¨çš„ã€‚åœ¨å¼€æºæ–°æŠ€æœ¯å¤§è¡Œå…¶é“çš„ä»Šå¤©ï¼Œå¦‚ä½•ä» SQL Server æ— ç¼è¿ç§»è‡³ TiDBï¼Œæ±½è½¦ä¹‹å®¶åšäº†ä¸€ä¸ªåˆ›æ–°çš„ç¤ºèŒƒã€‚&lt;/p&gt;&lt;p&gt;æœ¬æ–‡å°†ä»ä¸šåŠ¡èƒŒæ™¯ã€è¿ç§»æ–¹æ¡ˆã€åŒæ­¥ã€ä¸šåŠ¡æ”¹é€ ã€ä¸Šçº¿æ•ˆæœã€å‘¨è¾¹å»ºè®¾ç­‰å¤šä¸ªè§’åº¦ï¼Œè¯¦ç»†ä»‹ç»äº†å¦‚ä½•ä» SQL Server æ•°æ®åº“è¿ç§»è‡³ TiDB æ•°æ®åº“ã€‚ç›¸ä¿¡æ— è®ºä½ æ˜¯æ¶æ„å¸ˆã€ä¸šåŠ¡å¼€å‘ã€è¿˜æ˜¯ DBAï¼Œéƒ½ä¼šæœ‰ä¸åŒå±‚é¢çš„æ”¶è·ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;ä¸€ã€é¡¹ç›®èƒŒæ™¯&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;æ±½è½¦ä¹‹å®¶ç¤¾åŒºäº 2005 å¹´ä¸Šçº¿ï¼Œä½œä¸ºæ±½è½¦ä¹‹å®¶æœ€è€çš„ä¸šåŠ¡ä¹‹ä¸€ï¼Œåå››å¹´æ¥æ²‰æ·€äº†äº¿çº§å¸–å­ã€åäº¿çº§å›å¤æ•°æ®ï¼Œç›®å‰æ¯å¤©æœ‰åƒä¸‡çº§ DAUã€äº¿çº§çš„è®¿é—®é‡ï¼Œæ¥å£æ—¥å‡è°ƒç”¨é‡ 10 äº¿+ æ¬¡ ã€‚æœŸé—´ç»å†è¿‡æ¶æ„å‡çº§é‡æ„ã€æŠ€æœ¯æ ˆå‡çº§ç­‰ï¼Œä½†å…¶æ•°æ®å§‹ç»ˆå­˜æ”¾åœ¨ SQL Server ä¸­ã€‚éšç€æ•°æ®çš„ä¸æ–­é€’å¢ï¼Œæˆ‘ä»¬åœ¨ä½¿ç”¨ SQL Server æ•°æ®åº“æ–¹é¢é‡åˆ°äº†å¾ˆå¤šç“¶é¢ˆï¼Œä»¥è‡³äºæˆ‘ä»¬ä¸å¾—ä¸å¯»æ‰¾ä¸€ä¸ªæ–°çš„æ•°æ®åº“æ›¿æ¢æ–¹æ¡ˆã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;äºŒã€ä½¿ç”¨ SQL Server é‡åˆ°çš„ç“¶é¢ˆ&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;éšç€ä¸šåŠ¡çš„ä¸æ–­æ‰©å¤§ï¼Œæ±½è½¦ä¹‹å®¶ç¤¾åŒºçš„è®¿é—®é‡å’Œå‘è¡¨é‡ä¸æ–­ä¸Šæ¶¨ï¼Œé‡åˆ°çš„æ•°æ®åº“é—®é¢˜ä¹Ÿè¶Šæ¥è¶Šå¤šï¼Œä¸‹é¢åˆ—ä¸¾ä¸¤ä¸ªå¿…é¡»å¾ˆå¿«è§£å†³æ‰çš„é—®é¢˜ï¼š&lt;/p&gt;&lt;p&gt;&lt;b&gt;1.&lt;/b&gt;å†å²ä¸Šï¼Œæ±½è½¦ä¹‹å®¶ç¤¾åŒºå›å¤åº“é‡‡ç”¨äº†åˆ†åº“åˆ†è¡¨çš„è®¾è®¡ï¼Œç”¨ä»¥è§£å†³ SQL Server å•è¡¨è¿‡å¤§æ—¶æ€§èƒ½ä¸‹é™ç­‰é—®é¢˜ã€‚æ—¶è‡³ä»Šæ—¥ï¼Œå›å¤åº“æœ‰ 100+ ä¸ªåº“ã€1000+ å¼ è¡¨ï¼ˆæ ¹æ®å¸–å­ ID åˆ†åº“åˆ†è¡¨ï¼‰ã€‚è¿™æœ¬èº«å¹¶æ²¡æœ‰é—®é¢˜ï¼Œä»£ç å†™å¥½äº†ï¼Œæ•°æ®è¯¥å†™å“ªé‡Œå†™å“ªé‡Œï¼Œè¯¥è¯»å“ªé‡Œè¯»å“ªé‡Œã€‚ä½†æ˜¯éšç€åº”ç”¨çš„å‘å±•ã€éœ€æ±‚çš„å˜åŒ–ï¼Œæˆ‘ä»¬å‘ç°åœ¨å®ç°æŸäº›éœ€æ±‚æ—¶ï¼Œåˆ†åº“åˆ†è¡¨çš„ç»“æ„éš¾ä»¥æ»¡è¶³ã€‚æˆ‘ä»¬éœ€è¦æ•°æ®é€»è¾‘ä¸Šåœ¨ä¸€å¼ è¡¨é‡Œã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;2.&lt;/b&gt;è¿‘äº›å¹´æ¥ï¼Œéšç€ä¸šåŠ¡åŠ é€Ÿæˆé•¿ï¼Œæ•°æ®é‡çªé£çŒ›è¿›ï¼Œè€Œç¡¬ç›˜å®¹é‡æ˜¯æœ‰é™çš„ï¼Œæ¯å°æœåŠ¡å™¨ä¸Šèƒ½æ‰©å±•çš„ç¡¬ç›˜æ•°é‡ä¹Ÿæ˜¯æœ‰é™çš„ï¼Œè‡´ä½¿æ¯éš”ä¸€æ®µæ—¶é—´éƒ½è¦å¢åŠ æ›´å¤§å®¹é‡çš„å­˜å‚¨æœåŠ¡å™¨æ¥åº”å¯¹ã€‚è€Œä¸”è¿™ä¸ªäº‹æƒ…ä¸€å¼€å§‹æ˜¯å¾ˆå¤æ‚çš„ï¼Œæ¶‰åŠåˆ°å¾ˆå¤šå…³è”é¡¹ç›®ï¼Œå³ä¾¿åˆ°ç°åœ¨æˆ‘ä»¬è½»è½¦ç†Ÿè·¯äº†ï¼Œæ¯æ¬¡æ¢æœåŠ¡å™¨çš„æ—¶å€™ä¾ç„¶éœ€è¦å…³æ³¨å®ƒï¼Œå¹¶ä¸”å¤§å®¹é‡æ•°æ®åº“æœåŠ¡å™¨ä»·æ ¼æ˜‚è´µã€‚æˆ‘ä»¬éœ€è¦è®©æ‰©å®¹å¯¹åº”ç”¨æ¥è¯´ï¼Œæ— æ„ŸçŸ¥ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;ä¸‰ã€åˆ†å¸ƒå¼æ•°æ®åº“è°ƒç ”&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;3.1 ç¡®å®šæ–¹å‘&lt;/b&gt;&lt;/p&gt;&lt;p&gt;åœ¨ 2018 å¹´åº•çš„æ—¶å€™ï¼Œå…¬å¸ä¸“é—¨æˆç«‹äº†è™šæ‹Ÿæ¶æ„ç»„æ¥è°ƒç ”æ–°çš„æ•°æ®åº“æ¥è§£å†³æ±½è½¦ä¹‹å®¶ç¤¾åŒºé‡åˆ°çš„é—®é¢˜ã€‚ç»è¿‡å„ç§åˆ†æå’Œæµ‹è¯•ï¼Œä»Šå¹´å¹´åˆç¡®å®šæ–¹å‘ä¸ºåˆ†å¸ƒå¼æ•°æ®åº“ï¼Œä¸€å…±è°ƒç ”äº†ä¸‰æ¬¾å½“å‰æ¯”è¾ƒç«çš„åˆ†å¸ƒå¼æ•°æ®åº“ï¼šTiDB (PingCAP)ï¼ŒIgnite(ASF-TLP) å’Œ CockroachDBã€‚ç»è¿‡æ— æ•°æ¬¡æµ‹è¯•æˆ‘ä»¬æœ€ç»ˆé€‰æ‹©äº† TiDBï¼Œä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªåŸå› ï¼š&lt;/p&gt;&lt;p&gt;1. å…¼å®¹ MySQL åè®®ä¸ç”Ÿæ€ï¼Œä¸Šæ‰‹é—¨æ§›ä½ï¼›&lt;/p&gt;&lt;p&gt;2. è·Ÿ TiDB å®˜æ–¹ä¸€ç›´ä¿æŒæ¯”è¾ƒå¥½çš„æŠ€æœ¯æ²Ÿé€šï¼›&lt;/p&gt;&lt;p&gt;3. TiDB å…¬å¸åœ¨åŒ—äº¬ï¼Œæœ‰é—®é¢˜å¯ä»¥å½“é¢è§£å†³ï¼›&lt;/p&gt;&lt;p&gt;4. TiDB çš„è®¾è®¡æ¶æ„æ›´åŠ ä¼˜ç§€ï¼›&lt;/p&gt;&lt;p&gt;5. å®˜æ–¹ç¤¾åŒºæ¯”è¾ƒæ´»è·ƒï¼Œæ–‡æ¡£ä¸°å¯Œï¼›&lt;/p&gt;&lt;p&gt;6. å®˜æ–¹çš„æŠ€æœ¯äººå‘˜ç»å¸¸åˆ°å…¬å¸è¿›è¡Œäº¤æµã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-8bfea2c5ab655ee2829580b4aed4a977_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;702&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic4.zhimg.com/v2-8bfea2c5ab655ee2829580b4aed4a977_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-8bfea2c5ab655ee2829580b4aed4a977_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;702&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic4.zhimg.com/v2-8bfea2c5ab655ee2829580b4aed4a977_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-8bfea2c5ab655ee2829580b4aed4a977_b.jpg&quot;/&gt;&lt;figcaption&gt;TiDB çš„ç ”å‘åŒå­¦åˆ°ä¹‹å®¶è¿›è¡ŒæŠ€æœ¯äº¤æµ&lt;/figcaption&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-93ae636438d3dd0a987760817c5a7238_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;702&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic1.zhimg.com/v2-93ae636438d3dd0a987760817c5a7238_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-93ae636438d3dd0a987760817c5a7238_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;702&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic1.zhimg.com/v2-93ae636438d3dd0a987760817c5a7238_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-93ae636438d3dd0a987760817c5a7238_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;æˆ‘ä»¬å» TiDB è¿›è¡Œç³»ç»Ÿçš„è¯¾ç¨‹åŸ¹è®­ä¸‹é¢å¼•ç”¨ TiDB å®˜æ–¹çš„ä¸€æ®µæè¿°ï¼š&lt;/p&gt;&lt;blockquote&gt;TiDB æ˜¯ä¸€æ¬¾å®šä½äºåœ¨çº¿äº‹åŠ¡å¤„ç†ã€åœ¨çº¿åˆ†æå¤„ç†ï¼ˆHTAP: Hybrid Transactional/Analytical Processingï¼‰çš„èåˆå‹æ•°æ®åº“äº§å“ï¼Œå®ç°äº†ä¸€é”®æ°´å¹³ä¼¸ç¼©ï¼Œå¼ºä¸€è‡´æ€§çš„å¤šå‰¯æœ¬æ•°æ®å®‰å…¨ï¼Œåˆ†å¸ƒå¼äº‹åŠ¡ï¼Œå®æ—¶ OLAP ç­‰é‡è¦ç‰¹æ€§ã€‚åŒæ—¶å…¼å®¹ MySQL åè®®å’Œç”Ÿæ€ï¼Œè¿ç§»ä¾¿æ·ï¼Œè¿ç»´æˆæœ¬æä½ã€‚&lt;/blockquote&gt;&lt;p&gt;ä»ä¸­æˆ‘ä»¬ä¸éš¾å‘ç°ï¼ŒTiDB åˆ‡å®è§£å†³äº†æˆ‘ä»¬åœ¨åº”ç”¨ SQL Server æ—¶å€™çš„ç—›ç‚¹ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;æ°´å¹³ä¼¸ç¼©ï¼šåœ¨å½“å‰é›†ç¾¤å†…å¯ä»¥éšæ—¶åŠ èŠ‚ç‚¹ï¼Œæ›´æ¢èŠ‚ç‚¹ä¹Ÿè½»è€Œæ˜“ä¸¾ã€‚&lt;/li&gt;&lt;li&gt;æµ·é‡æ•°æ®æ”¯æŒï¼šåŸºäºå…¶ç‰¹æ€§ä»¥åŠä¸šå†…ä½¿ç”¨çš„ç»éªŒï¼Œåäº¿ä¹ƒè‡³ç™¾äº¿çº§åˆ«çš„æ•°æ®é‡è½»æ¾æå®šã€‚&lt;/li&gt;&lt;li&gt;é«˜å¯ç”¨ï¼šç›¸è¾ƒ SQL Server çš„ä¸»ä»æ¨¡å¼ï¼ŒTiDB åŸºäº Raft åè®®ï¼Œå¯ä»¥å®ç° 100% çš„æ•°æ®å¼ºä¸€è‡´æ€§ï¼Œå¹¶ä¸”å¤šæ•°å‰¯æœ¬å¯ç”¨çš„æƒ…å†µä¸‹ï¼Œå¯å®ç°è‡ªåŠ¨æ•…éšœæ¢å¤ã€‚&lt;/li&gt;&lt;li&gt;HTAPï¼šTiDB è‡ªèº«å°±æ”¯æŒä¸€å®šç¨‹åº¦çš„ OLAP åœºæ™¯ï¼Œæ›´å¤æ‚çš„ OLAP åˆ†æå¯ä»¥é€šè¿‡ TiSpark é¡¹ç›®æ¥å®Œæˆã€‚å¯¹äºæ›´æ·±åº¦çš„ OLAP åº”ç”¨ï¼Œæˆ‘ä»¬ä¹Ÿå·²ç»åœ¨å®è·µçš„è·¯ä¸Šã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;3.2 å®è·µå‡ºçœŸçŸ¥&lt;/b&gt;&lt;/p&gt;&lt;p&gt;åŸºäºä»¥ä¸Šç†è®ºçš„æ”¯æŒï¼Œæˆ‘ä»¬è¿›è¡Œäº†å¤§é‡çš„åŠŸèƒ½æµ‹è¯•ã€æ€§èƒ½æµ‹è¯•ã€å¼‚å¸¸æµ‹è¯•ã€ä¸šåŠ¡æ¥å…¥æµ‹è¯•ç­‰ã€‚&lt;/p&gt;&lt;p&gt;1. OLTP æµ‹è¯•ï¼š2000 ä¸‡æ•°æ®ï¼Œ500 å¹¶å‘çº¿ç¨‹æµ‹è¯•ï¼Œåœ¨ OLTP åœºæ™¯æµ‹è¯•ä¸‹ TiDB çš„å“åº”æ—¶é—´ 99% åœ¨ 16ms ä»¥å†…ï¼Œæ»¡è¶³ä¸šåŠ¡éœ€æ±‚ã€‚ä¸”åœ¨æ•°æ®é‡çº§è¶Šæ¥è¶Šå¤§çš„æƒ…å†µä¸‹ï¼ŒTiDB ä¼šä½“ç°å‡ºæ›´å¤§çš„ä¼˜åŠ¿ï¼Œåç»­è¿˜å¯ä»¥é€šè¿‡æ·»åŠ  TiDB/PD/TiKV èŠ‚ç‚¹æ¥æé«˜è¯»å†™æ€§èƒ½ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-7212a28e2a4cd01b0becd22f690b3558_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;424&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic1.zhimg.com/v2-7212a28e2a4cd01b0becd22f690b3558_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-7212a28e2a4cd01b0becd22f690b3558_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;424&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic1.zhimg.com/v2-7212a28e2a4cd01b0becd22f690b3558_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-7212a28e2a4cd01b0becd22f690b3558_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;2. OLAP æµ‹è¯•ï¼š50G TPC-H æµ‹è¯•ï¼ŒTiDB ç›¸è¾ƒ MySQL æœ‰å¾ˆå¤§çš„é€Ÿåº¦ä¼˜åŠ¿ï¼š&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-c749b75154679259d8b3b96a36e60f62_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;1092&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-c749b75154679259d8b3b96a36e60f62_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-c749b75154679259d8b3b96a36e60f62_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;1092&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1080&quot; data-original=&quot;https://pic3.zhimg.com/v2-c749b75154679259d8b3b96a36e60f62_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-c749b75154679259d8b3b96a36e60f62_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;* TPC Benchmarkâ„¢Hï¼ˆTPC-Hï¼‰ æ˜¯å†³ç­–æ”¯æŒåŸºå‡†ã€‚å®ƒç”±ä¸€å¥—é¢å‘ä¸šåŠ¡çš„ä¸´æ—¶æŸ¥è¯¢å’Œå¹¶å‘æ•°æ®ä¿®æ”¹ç»„æˆã€‚é€‰æ‹©æŸ¥è¯¢å’Œå¡«å……æ•°æ®åº“çš„æ•°æ®å…·æœ‰å¹¿æ³›çš„è¡Œä¸šèŒƒå›´ç›¸å…³æ€§ã€‚è¯¥åŸºå‡†æµ‹è¯•è¯´æ˜äº†å†³ç­–æ”¯æŒç³»ç»Ÿï¼Œè¯¥ç³»ç»Ÿå¯æ£€æŸ¥å¤§é‡æ•°æ®ï¼Œé«˜åº¦å¤æ‚åœ°æ‰§è¡ŒæŸ¥è¯¢å¹¶ä¸ºå…³é”®ä¸šåŠ¡é—®é¢˜æä¾›ç­”æ¡ˆã€‚&lt;/p&gt;&lt;p&gt;3. å¼‚å¸¸æµ‹è¯•ï¼šæˆ‘ä»¬æµ‹è¯•äº† PDã€TiKV å¼‚å¸¸å®•æœºæƒ…å†µä¸‹çš„è¡¨ç°ï¼Œå¯¹ä¸šåŠ¡å½±å“å¾ˆå°ï¼Œå¯å®ç°è‡ªåŠ¨æ•…éšœæ¢å¤ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;å››ã€è¿ç§»æ–¹æ¡ˆ&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;4.1 è¿ç§»å‰éœ€è¦è§£å†³çš„é—®é¢˜&lt;/b&gt;&lt;/p&gt;&lt;p&gt;åœ¨çœŸæ­£çš„æ•°æ®è¿ç§»ä¹‹å‰ï¼Œæˆ‘ä»¬è¿˜æœ‰ä¸€äº›å®é™…é—®é¢˜éœ€è¦è§£å†³ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;SQL Server å’Œ TiDB çš„éƒ¨åˆ†å­—æ®µç±»å‹æ˜¯ä¸ä¸€æ ·çš„ã€‚&lt;/b&gt;é€šè¿‡æŸ¥é˜…ç›¸å…³æ–‡æ¡£ï¼Œå°†ä¸åŒçš„å­—æ®µä¸€ä¸€å¯¹åº”åå†åœ¨ TiDB ä¸­å»ºè¡¨ï¼Œä¾‹å¦‚ DATETIME çš„ç²¾åº¦é—®é¢˜ã€‚&lt;/li&gt;&lt;li&gt;&lt;b&gt;åŒæ­¥æ—¶å°†åˆ†åº“åˆ†è¡¨çš„æ•°æ®åˆå¹¶åˆ°ä¸€ä¸ªè¡¨é‡Œã€‚&lt;/b&gt;å€¼å¾—åº†å¹¸çš„æ˜¯åŸæœ‰è®¾è®¡ä¸­ï¼Œæˆ‘ä»¬é™¤äº†è‡ªå¢ä¸»é”® IDï¼Œè¿˜æœ‰ä¸€ä»½ä¸šåŠ¡ IDï¼Œå…¶åœ¨å„ä¸ªè¡¨ä¸­å‡ä¸é‡å¤ï¼Œè¿™æ ·çœäº†ä¸å°‘äº‹æƒ…ã€‚&lt;/li&gt;&lt;li&gt;ä¸€æ¬¡æ€§å¯¼å…¥åäº¿çº§æ•°æ®ä»¥åŠåç»­å¢é‡åŒæ­¥çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚ä½•ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ã€‚&lt;/li&gt;&lt;li&gt;&lt;b&gt;å¦‚æœ TiDB åœ¨ç”Ÿäº§æ—¶å‡ºç°äº†ä¸å¯é¢„ä¼°çš„é—®é¢˜ï¼Œä¸€æ—¶æ— æ³•è§£å†³ï¼Œé‚£æˆ‘ä»¬å¿…é¡»ç«‹åˆ»åˆ‡æ¢åˆ° SQL Serverï¼Œä¿è¯ä¸šåŠ¡ä¸å—å½±å“ã€‚&lt;/b&gt;æ¢å¥è¯è¯´ï¼Œåœ¨ TiDB ä¸­äº§ç”Ÿçš„æ•°æ®éœ€è¦å®æ—¶åŒæ­¥å› SQL Serverã€‚&lt;/li&gt;&lt;li&gt;&lt;b&gt;å› ä¸ºè®¿é—®é‡æ¯”è¾ƒå¤§ï¼Œåˆ‡æ¢æ—¶é—´å¿…é¡»æ§åˆ¶åœ¨ç§’çº§ã€‚&lt;/b&gt;&lt;/li&gt;&lt;li&gt;å› ä¸º SQL Server æ˜¯å•†ä¸šæ•°æ®åº“ï¼Œè·Ÿå¼€æºæ•°æ®åº“è¿›è¡Œæ•°æ®åŒæ­¥çš„æ–¹æ¡ˆè¾ƒå°‘ï¼Œæ‰€ä»¥åŒæ­¥æ–¹æ¡ˆã€æ¶æ„è®¾è®¡ã€ç ”å‘ã€æµ‹è¯•å¿…é¡»æˆ‘ä»¬è‡ªå·±è§£å†³ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;4.2 æ•´ä½“è¿ç§»æ¶æ„å›¾&lt;/b&gt;&lt;/p&gt;&lt;p&gt;ä¸‹å›¾æ˜¯æˆ‘ä»¬æ•´ä¸ªè¿ç§»è¿‡ç¨‹çš„æ¶æ„å›¾ï¼ŒåŒ…å« SQL Server åˆ° TiDB çš„å…¨é‡åŒæ­¥ã€å¢é‡åŒæ­¥ï¼Œä»¥åŠ TiDB åˆ° SQL Server çš„åå‘åŒæ­¥è¿‡ç¨‹ã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-a4058b3f15b708ace755fa8edf87064f_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;941&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic4.zhimg.com/v2-a4058b3f15b708ace755fa8edf87064f_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-a4058b3f15b708ace755fa8edf87064f_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;941&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic4.zhimg.com/v2-a4058b3f15b708ace755fa8edf87064f_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-a4058b3f15b708ace755fa8edf87064f_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;ç°åœ¨ï¼Œéœ€è¦ç¡®å®šçš„æ˜¯æ•´ä¸ªé¡¹ç›®çš„è¿ç§»æµç¨‹ï¼Œæœ‰äº†å¤§çš„æ–¹å‘ï¼Œåœ¨å®æ–½ä¸­ç›®æ ‡ä¼šæ›´æ˜ç¡®ä¸€äº›ã€‚&lt;/p&gt;&lt;p&gt;ä»¥æ±½è½¦ä¹‹å®¶ç¤¾åŒºçš„ä¸šåŠ¡å½¢æ€ä»¥åŠæ•°æ®é‡çº§æ¥çœ‹ï¼ŒåŠ¨è¾„åå¤šä¸ªå°æ—¶çš„ç¦»çº¿è¿ç§»æ˜¯å®Œå…¨ä¸å¯èƒ½æ¥å—çš„ï¼Œæˆ‘ä»¬åªèƒ½åœ¨å‡Œæ™¨ 1:00-3:00 è¿™ä¸ªæ—¶é—´çª—å£æ¥å®Œæˆè¿ç§»ï¼Œä¸”æ—¶é—´è¶ŠçŸ­è¶Šå¥½ã€‚&lt;/p&gt;&lt;p&gt;æ‰€ä»¥æˆ‘ä»¬é€‰æ‹©åœ¨çº¿è¿ç§»çš„æ–¹æ¡ˆï¼Œåœ¨çº¿è¿ç§»ç¨å¾®å¤æ‚ä¸€äº›ï¼Œæµç¨‹ä¸Šæœ‰å‡†å¤‡å…¨é‡æ•°æ®ï¼Œç„¶åå®æ—¶åŒæ­¥å¢é‡æ•°æ®ï¼Œåœ¨æ•°æ®åŒæ­¥è·Ÿä¸Šï¼ˆå»¶è¿Ÿç§’çº§åˆ«ï¼‰ä¹‹åï¼Œé‡‡ç”¨æ»šåŠ¨å‡çº§çš„æ–¹å¼å°†åº”ç”¨çš„è¯»æµé‡åˆ‡æ¢åˆ° TiDB ä¸Šã€‚&lt;/p&gt;&lt;p&gt;è§‚å¯Ÿåº”ç”¨æ­£å¸¸è¿è¡Œï¼Œè¿›è¡ŒçŸ­æš‚åœæœºå’Œå…³åœ SQL Server å†™æƒé™ï¼Œç¡®ä¿æ²¡æœ‰æ•°æ®å†å†™å…¥ SQL Serverï¼Œ å°±å¯ä»¥å°†å†™æµé‡æŒ‡å‘ TiDBï¼Œè‡³æ­¤è¿ç§»å®Œæ¯•ã€‚&lt;/p&gt;&lt;p&gt;æ•´ä¸ªè¿ç§»æµç¨‹ä¸­ï¼Œåº”ç”¨çš„è¯»æ•°æ®åœºæ™¯ä¸å—å½±å“ï¼Œå†™å…¥åœºæ™¯å—å½±å“å‘¨æœŸä¸ºåœæœºï¼ˆå…³å†™æƒé™ï¼‰åˆ°å†™æµé‡æŒ‡å‘ TiDBã€‚&lt;/p&gt;&lt;p&gt;ä¸‹å›¾æ˜¯æˆ‘ä»¬æ¢³ç†å‡ºæ¥çš„æµç¨‹å›¾ï¼Œæˆ‘ä»¬åœ¨æ•´ä¸ªè¿ç§»çš„è¿‡ç¨‹ä¸­å¿…é¡»ä¸¥æ ¼æŒ‰è¿™äº›æµç¨‹æ‰§è¡Œã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-216b0ec07e9243945e04e9e8a0ad87a5_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;443&quot; data-rawheight=&quot;1250&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;443&quot; data-original=&quot;https://pic2.zhimg.com/v2-216b0ec07e9243945e04e9e8a0ad87a5_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-216b0ec07e9243945e04e9e8a0ad87a5_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;443&quot; data-rawheight=&quot;1250&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;443&quot; data-original=&quot;https://pic2.zhimg.com/v2-216b0ec07e9243945e04e9e8a0ad87a5_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-216b0ec07e9243945e04e9e8a0ad87a5_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;ä¸‹é¢æˆ‘ä»¬æ¥è¯¦ç»†ä»‹ç»å…¨é‡å’Œå¢é‡åŒæ­¥çš„å®æ–½æ–¹æ¡ˆã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;äº”ã€å…¨é‡åŒæ­¥&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;é¦–å…ˆæˆ‘ä»¬è¦æ„Ÿè°¢ä»¥ä¸‹ä¸¤ä¸ªå¼€æºé¡¹ç›®ï¼Œç«™åœ¨å·¨äººçš„è‚©è†€ä¸Šä½¿æˆ‘ä»¬èŠ‚çº¦äº†å¾ˆå¤šæ—¶é—´ã€‚&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/alibaba/yugong&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;github.com/alibaba/yugo&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;ng&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt; &lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/alswl/yugong&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;github.com/alswl/yugong&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;æ„šå…¬æ˜¯é˜¿é‡Œå·´å·´æ¨å‡ºçš„ä¸€æ¬¾ Oracle æ•°æ®è¿ç§»åŒæ­¥å·¥å…·ï¼Œè€Œä½œè€… alswl åœ¨æ­¤åŸºç¡€ä¸Šå®ç°äº† SQL Server æ•°æ®æºçš„æ”¯æŒã€‚åœ¨æ­¤æ„šå…¬çš„ä½¿ç”¨æ–¹æ³•æˆ‘ä»¬ä¸å†èµ˜è¿°ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦è¯·è‡ªè¡ŒæŸ¥çœ‹ã€‚åœ¨è®¤çœŸæ‹œè¯»äº†å¤§ç¥çš„é¡¹ç›®ï¼Œå¹¶è¿›è¡Œäº†ç›¸å…³æµ‹è¯•åï¼Œå‘ç°å®ƒå¹¶ä¸èƒ½ 100% æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-9200646df133ddc73bea82a024158e0e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;933&quot; data-rawheight=&quot;162&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;933&quot; data-original=&quot;https://pic3.zhimg.com/v2-9200646df133ddc73bea82a024158e0e_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-9200646df133ddc73bea82a024158e0e_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;933&quot; data-rawheight=&quot;162&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;933&quot; data-original=&quot;https://pic3.zhimg.com/v2-9200646df133ddc73bea82a024158e0e_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-9200646df133ddc73bea82a024158e0e_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;Yugong æ•°æ®æµæ˜¯æ ‡å‡† ETL æµç¨‹ï¼Œåˆ†åˆ«æœ‰ Extractorã€ Translatorã€Applier è¿™ä¸‰ä¸ªå¤§ç±»æ¥å®ç° ETL è¿‡ç¨‹ã€‚é¦–å…ˆè®² Extractorï¼Œæ„šå…¬åŸæœ‰çš„é…ç½®æ–¹å¼æ˜¯å°†éœ€è¦å¯¼å‡ºçš„åº“è¡¨å†™åœ¨é…ç½®æ–‡ä»¶å½“ä¸­ï¼Œè¿™å¯¹äº 1000+ å¼ è¡¨æ¥è¯´ï¼Œå¤ªä¸ç°å®äº†ã€‚è¿™é‡Œæˆ‘ä»¬å¢äº†ä¸€ä¸ªæ–°ç‰¹æ€§ï¼Œåœ¨ä¸é…ç½®éœ€è¦å¯¼å‡ºçš„è¡¨åçš„æƒ…å†µä¸‹ï¼Œå°†æ•°æ®åº“ä¸­æ‰€æœ‰çš„ç”¨æˆ·è¡¨è¯»å‡ºæ¥ï¼Œå¹¶é€šè¿‡ä¸€ä¸ªæ–°å¢çš„é…ç½®é¡¹è¿›è¡Œæ­£åˆ™åŒ¹é…ï¼Œä»¥æ­¤å†³å®šå“ªäº›è¡¨éœ€è¦è¿›è¡Œæ•°æ®åŒæ­¥ã€‚&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;#æŸ¥è¯¢è¡¨
SELECT name FROM sys.databases WITH (nolock) WHERE state_desc = &amp;#39;ONLINE&amp;#39;

#æŸ¥è¯¢å¼€å¯CDCçš„è¡¨
SELECT name FROM %s.sys.tables t WITH (nolock) JOIN %s.[cdc].[change_tables] ct WITH (nolock) ON t.object_id = ct.source_object_id &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å…¶æ¬¡ï¼Œåˆåº“åˆè¡¨åï¼ŒåŸæœ‰ SQL Server ä¸­å„ä¸ªè¡¨çš„è‡ªå¢ä¸»é”® ID å†²çªï¼Œæ‰€ä»¥æ–°å¢å®ç° RowDataMergeTranslatorï¼Œå…¶åŠŸèƒ½æ˜¯ï¼Œè¯»å–å†…å­˜ä¸­çš„ RowData ç„¶åè¿›è¡Œè½¬æ¢ï¼Œå°†ä» SQL Server ä¸­è¯»å–çš„è¡Œæ•°æ®ï¼Œä¸¢å¼ƒå…¶åŸæœ‰çš„ä¸»é”®åˆ—ï¼Œè½¬è€Œä½¿ç”¨ TiDB ç”Ÿæˆã€‚å¹¶æ ¹æ®é…ç½®æ–‡ä»¶å†³å®šå“ªäº›è¡¨éœ€è¦å®ç°è¿™ä¸€ç‰¹æ€§ã€‚&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;record.removeColumnByName(config.getDiscardKey()); &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æœ€åçš„ Applier å¹¶æœªåšæ”¹åŠ¨ï¼Œå¤„ç†å¥½çš„æ•°æ®ç›´æ¥å†™å…¥ TiDBã€‚è‡ªæ­¤åˆåº“åˆè¡¨çš„äº‹æƒ…æˆ‘ä»¬è§£å†³äº†ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;å…­ã€å¢é‡åŒæ­¥ä¸å®æ—¶æ ¡éªŒ&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;åœ¨å®ç°è¿™éƒ¨åˆ†éœ€æ±‚çš„æ—¶å€™ï¼Œæˆ‘ä»¬åº”ç”¨äº† SQL Server çš„ CDCï¼Œå¹¶åœ¨å¢é‡åŒæ­¥çš„åŸºç¡€ä¸Šå¢åŠ äº†å»¶è¿ŸéªŒè¯æ•°æ®æ­£ç¡®æ€§çš„åŠŸèƒ½ã€‚æ›´å¤šå…³äº CDC çš„å†…å®¹ï¼Œè¿™é‡Œä¸å†èµ˜è¯‰ï¼Œä½ åªéœ€è¦çŸ¥é“å®ƒèƒ½è·å–åˆ°å¢é‡æ•°æ®ï¼Œå‚è€ƒ &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//docs.microsoft.com/en-us/sql/relational-databases/track-changes/about-change-data-capture-sql-server%3Fview%3Dsql-server-ver15&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;CDCå®˜æ–¹æ–‡æ¡£&lt;/a&gt;ã€‚&lt;/p&gt;&lt;p&gt;éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒCDC å¼€å¯çš„æ—¶æœºéœ€è¦åœ¨å…¨é‡åŒæ­¥ä¹‹å‰ï¼Œä¿è¯ CDC è®°å½•å¯ä»¥è¦†ç›–å…¨é‡åŒæ­¥è¿‡ç¨‹ä¸­äº§ç”Ÿçš„å¢é‡æ•°æ®ã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-a4e4a0485b5b40483c2ac7d78cf5180c_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;279&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic1.zhimg.com/v2-a4e4a0485b5b40483c2ac7d78cf5180c_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-a4e4a0485b5b40483c2ac7d78cf5180c_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;279&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic1.zhimg.com/v2-a4e4a0485b5b40483c2ac7d78cf5180c_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-a4e4a0485b5b40483c2ac7d78cf5180c_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;æ ¹æ®ä»¥ä¸Šçš„æµç¨‹å›¾å¯ä»¥çœ‹åˆ°ï¼ŒProducer ä» SQL Server ä¸­è¯»å– CDC æ—¥å¿—ï¼Œå¹¶å°†å…¶è½¬åŒ–æˆä¸€æ¡åŒ…å«è¡¨ä¿¡æ¯ã€åˆ—ä¿¡æ¯å’Œè¡Œæ•°æ®çš„æ¶ˆæ¯ï¼ŒæŠ•é€’åˆ° Kafka ä¸­ã€‚ä¸‹æ¸¸çš„æ¶ˆè´¹è€…åœ¨æ‹‰å–åˆ°æ¶ˆæ¯ä¹‹åï¼ŒæŠŠæ•°æ®è½¬åŒ–æˆå…¼å®¹ MySQL çš„ SQL è¯­å¥åœ¨ TiDB ä¸­æ‰§è¡Œï¼ˆè¿™é‡Œä¹Ÿå®ç°äº†åˆåº“åˆè¡¨ï¼‰ï¼Œä»è€Œå®ç°æ•´ä¸ªæ•°æ®å¢é‡åŒæ­¥çš„è¿‡ç¨‹ã€‚&lt;/p&gt;&lt;p&gt;è¿™é‡Œè¿˜æœ‰å¦ä¸€ä¸ªæ¶ˆè´¹è€…å®ç°æ•°æ®æ ¡éªŒåŠŸèƒ½ï¼Œå®ƒä¼šå»¶è¿Ÿäº”ç§’æ¶ˆè´¹åŒä¸€é˜Ÿåˆ—ï¼Œå¹¶é€šè¿‡æå–ä¸»é”®ï¼ˆæˆ–ç´¢å¼•ï¼‰çš„æ–¹å¼ä» TiDB ä¸­æŸ¥å‡ºè¯¥æ¡å·²ç»å†™å…¥çš„æ•°æ®ï¼Œå°†ä¸¤ä¾§çš„æ•´è¡Œæ•°æ®åšæ¯”è¾ƒï¼ˆæœ¬å®è·µä¸­å»é™¤ä¸»é”®åæ¯”è¾ƒï¼‰ï¼Œå¦‚æœæœ‰é—®é¢˜ä¼šè¿›è¡Œå°è¯•é‡æ–°å†™å…¥ï¼Œå¦‚å‡ºç°å¼‚å¸¸åˆ™å‘ç›¸å…³äººå‘˜å‘é€æŠ¥è­¦ã€‚&lt;/p&gt;&lt;p&gt;åœ¨å®ç°äº†è¿™äº›å¹¶è¿›å…¥åˆ°æµ‹è¯•é˜¶æ®µåï¼Œæˆ‘ä»¬å‘ç°äº†ä¸€ä¸ªé—®é¢˜ï¼Œ1000+ å›å¤è¡¨ï¼Œå¯¹åº” 1000+ CDC æ—¥å¿—è¡¨ï¼Œä¸€ä¸ª Producer å°±éœ€è¦å¼€å¯ 1000+ çº¿ç¨‹ã€‚ä»¥è®¾è®¡çš„ 5s é—´éš”å»è½®è¯¢è¿™äº›è¡¨æ—¶ï¼ŒæœåŠ¡å™¨ CPU ç›´æ¥å°±è·‘æ»¡äº†ï¼Œäº§ç”Ÿäº†å¤§é‡çº¿ç¨‹ç­‰å¾…ï¼Œè½®è¯¢ CDC æ—¥å¿—çš„åŠæ—¶æ€§æ— æ³•ä¿è¯ã€‚é€šè¿‡åˆ†æä¸šåŠ¡å’Œ DBA æŸ¥è¯¢å¾—çŸ¥ï¼Œå…¶å®æ±½è½¦ä¹‹å®¶ç¤¾åŒºæ¯å¤©äº§ç”Ÿçš„å›å¤æœ‰ 95% éƒ½é›†ä¸­åœ¨æœ€æ–°çš„ 5% çš„å¸–å­å½“ä¸­ã€‚æ¢è¨€ä¹‹ï¼Œæˆ‘ä»¬åªæœ‰å‡ åå¼ è¡¨éœ€è¦å¦‚æ­¤é«˜é¢‘çš„å»æ£€ç´¢ CDC æ—¥å¿—ï¼Œå…¶ä»–çš„è¡¨æˆ‘ä»¬é€šè¿‡å¢åŠ è½®è¯¢é—´éš”ã€åˆ†æ‰¹éƒ¨ç½²ç­‰æ–¹å¼ï¼Œå°†è¿™ä¸ªé—®é¢˜è§£å†³äº†ã€‚&lt;/p&gt;&lt;p&gt;ç»†å¿ƒçš„åŒå­¦è¯»åˆ°è¿™é‡Œä¼šå‘ç°ï¼Œæ ¡éªŒåŠŸèƒ½å…¶å®é€»è¾‘ä¸Šå¹¶ä¸ä¸¥è°¨ï¼Œå¦‚æœè¯´åœ¨äº”ç§’é’Ÿå†…ä¸Šæ¸¸æ•°æ®äº§ç”Ÿäº†å˜æ›´ï¼Œå°±æœ‰å¯èƒ½ä¼šäº§ç”Ÿæ‹¿ç€æ–°æ•°æ®å»æ ¡éªŒè€æ•°æ®çš„é—®é¢˜ã€‚è¿™é‡Œæœ‰ä¸¤ä¸ªè§£å†³æ–¹æ¡ˆï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;é‡‡ç”¨å• partition çš„ topic å’Œå•ä¸ªæ¶ˆè´¹ç¨‹åºï¼Œä¿è¯å¢é‡åŒæ­¥å’Œæ ¡éªŒçš„é¡ºåºä¸¥æ ¼ä¸€è‡´ï¼Œä½†æ­¤ç§æ–¹æ¡ˆæ€§èƒ½ç›¸å¯¹è¾ƒä½ï¼Œå¯ç”¨æ€§æ— æ³•ä¿è¯ã€‚&lt;/li&gt;&lt;li&gt;æˆ‘ä»¬å°† SQL Server ä¸­çš„è¡¨è¡ŒåŠ å…¥ä¸Šç‰ˆæœ¬æˆ³ï¼ˆrowversionï¼‰ï¼Œå°†ç‰ˆæœ¬æˆ³ä¸€å¹¶åŒæ­¥åˆ° TiDB ä¸­ã€‚æ ¡éªŒæ—¶æ¯”è¾ƒè¯¥å€¼ï¼Œå¦‚ä¸ä¸€è‡´åˆ™æ”¾å¼ƒæœ¬æ¬¡æ ¡éªŒã€‚æœ¬æ–¹æ¡ˆä¼šæŸå¤±ä¸€å®šçš„æ ¡éªŒæ ·æœ¬ï¼Œä½†å¯é€šè¿‡å¢åŠ  Partition å’Œæ¶ˆè´¹è€…æé«˜æ€§èƒ½å’Œå¯ç”¨æ€§ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;h2&gt;ä¸ƒã€å›æ»šæ–¹æ¡ˆ&lt;/h2&gt;&lt;p&gt;ä¹‹å‰æˆ‘ä»¬æåˆ°äº†ï¼Œå½“é¡¹ç›®åˆ‡æ¢åˆ° TiDB ä»¥åï¼Œéœ€è¦é¢„é˜²å…¶å‡ºç°ä¸å¯é¢„ä¼°çš„é—®é¢˜ï¼Œèƒ½å¤Ÿéšæ—¶åˆ‡å› SQL Server æ‰èƒ½ä¿éšœä¸‡æ— ä¸€å¤±ã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-24b503244ee43c8a5d0a5229c8f5290b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;343&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic4.zhimg.com/v2-24b503244ee43c8a5d0a5229c8f5290b_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-24b503244ee43c8a5d0a5229c8f5290b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;343&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic4.zhimg.com/v2-24b503244ee43c8a5d0a5229c8f5290b_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-24b503244ee43c8a5d0a5229c8f5290b_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pingcap.com/blog-cn/tidb-ecosystem-tools-1/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TiDB Binlog&lt;/a&gt; ä½¿å¾—è¿™ä»¶äº‹æƒ…è½»è€Œæ˜“ä¸¾ã€‚æˆ‘ä»¬ä½¿ç”¨å®˜æ–¹æä¾›çš„ Pump å’Œ Drainer å°† Binlog æŠ½å–åˆ° Kafka ä¹‹ä¸­ï¼Œè§£ææ•°æ®å˜æ›´çš„å†…å®¹ï¼Œæ ¹æ®ä¸šåŠ¡ ID è®¡ç®—å‡ºæ•°æ®åœ¨ SQL Server ä¸­åŸæœ¬å±äºå“ªä¸ªåº“å“ªä¸ªè¡¨ï¼Œç„¶åè¿›è¡Œæ•°æ®åŒæ­¥ã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-b5b8af49ff0bb76787447a4ba3b70b56_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;668&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic3.zhimg.com/v2-b5b8af49ff0bb76787447a4ba3b70b56_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-b5b8af49ff0bb76787447a4ba3b70b56_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;668&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic3.zhimg.com/v2-b5b8af49ff0bb76787447a4ba3b70b56_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-b5b8af49ff0bb76787447a4ba3b70b56_b.jpg&quot;/&gt;&lt;figcaption&gt;è§£æ Binlog (Protobuf åè®®)&lt;/figcaption&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-6de2df3067c220e10c902664251eb3d6_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;552&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic3.zhimg.com/v2-6de2df3067c220e10c902664251eb3d6_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-6de2df3067c220e10c902664251eb3d6_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;552&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic3.zhimg.com/v2-6de2df3067c220e10c902664251eb3d6_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-6de2df3067c220e10c902664251eb3d6_b.jpg&quot;/&gt;&lt;figcaption&gt;é€šè¿‡ä¸šåŠ¡ ID å†³å®šæ•°æ®å†™åˆ°å“ªä¸ªåº“è¡¨&lt;/figcaption&gt;&lt;/figure&gt;&lt;h2&gt;å…«ã€æ±½è½¦ä¹‹å®¶ç¤¾åŒºä¸šåŠ¡ TiDB è¿ç§»æ”¹é€ &lt;/h2&gt;&lt;p&gt;å°±ä¸šåŠ¡çš„æ”¹é€ è¿™ä¸€ç¯èŠ‚ï¼Œå› å†å²ç§¯æ·€ï¼Œéœ€ä¿®æ”¹çš„åœ°æ–¹å¾ˆå¤šï¼Œåˆ†å¸ƒäºå„ä¸ªé¡¹ç›®ä¹‹ä¸­ï¼Œæˆ‘ä»¬é‡‡å–é€šè¿‡æ¥å£æŸ¥æ‰¾å®ç°ã€æœç´¢ä»£ç ã€DBA å¸®åŠ©æŠ“å– SQL çš„æ–¹å¼ï¼Œä¿è¯æ¶µç›–äº† 100% çš„ç›¸å…³ä¸šåŠ¡ï¼Œåªæœ‰è¿™æ ·æ‰èƒ½ä¿éšœä¸Šçº¿åæ— æ•…éšœã€‚&lt;/p&gt;&lt;ul&gt;&lt;li&gt;æ•°æ®è®¿é—®å±‚å¢åŠ å¯¹ MySQL è¯­æ³•çš„æ”¯æŒã€‚&lt;/li&gt;&lt;li&gt;å»æ‰ SQL Server ä¸­çš„å­˜å‚¨è¿‡ç¨‹ã€‚&lt;/li&gt;&lt;li&gt;SQL Server å’Œ TiDBï¼ˆMySQLï¼‰çš„è¯­å¥å’Œå‡½æ•°æ”¯æŒä¸å°½ç›¸åŒï¼Œé€ä¸ªæ”¹é€ ã€æµ‹è¯•å¹¶ä¼˜åŒ–ã€‚&lt;/li&gt;&lt;li&gt;æ ¹æ® TiDB ç´¢å¼•çš„åŸç†ä»¥åŠæ¢³ç†å‡ºæ¥çš„ SQL è¯­å¥ï¼Œé‡æ–°å»ºç´¢å¼•ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;ä¸æ­¤åŒæ—¶ï¼Œæˆ‘ä»¬é’ˆå¯¹æ¯ä¸€æ¡æ”¹é€ åçš„ SQL éƒ½è¿›è¡Œäº†ä¼˜åŒ–ï¼Œä½¿å¯ä»¥ç²¾ç¡®çš„å‘½ä¸­æœ€ä¼˜çš„ç´¢å¼•ï¼Œä»è€Œå®ç°äº†åœ¨åäº¿çº§æ•°æ®é‡ä¸‹ï¼ŒTP ä¸šåŠ¡ 99% çš„å“åº”æ—¶é—´åœ¨ 12msï¼Œ99.9% çš„å“åº”æ—¶é—´åœ¨ 62msã€‚ &lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-f91ee64671b175f4c426aa02198bd9d6_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;418&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic3.zhimg.com/v2-f91ee64671b175f4c426aa02198bd9d6_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-f91ee64671b175f4c426aa02198bd9d6_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;418&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic3.zhimg.com/v2-f91ee64671b175f4c426aa02198bd9d6_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-f91ee64671b175f4c426aa02198bd9d6_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;h2&gt;ä¹ã€TiDB å‘¨è¾¹ä½“ç³»å»ºè®¾&lt;/h2&gt;&lt;p&gt;é™¤ä»¥ä¸Šè¿ç§»æµç¨‹æ‰€æ¶‰åŠåˆ°çš„åŠŸèƒ½ç‚¹ä»¥å¤–ï¼Œæˆ‘ä»¬è¿˜åˆ¶å®šäº†ä¸€äº›å¼€å‘è§„èŒƒå’Œä¸€äº›å®ç”¨å·¥å…·çš„ç ”å‘ï¼Œç”¨ä»¥ä¿éšœ TiDB åœ¨æ±½è½¦ä¹‹å®¶æ›´å¥½çš„åº”ç”¨ã€‚&lt;/p&gt;&lt;ul&gt;&lt;li&gt;æˆ‘ä»¬å»ºç«‹äº†å®Œå–„çš„ TiDB å¼€å‘è§„èŒƒã€è¿ç»´è§„èŒƒã€ä¸Šçº¿è§„èŒƒï¼Œå¹¶åœ¨å…¬å¸å†…éƒ¨å¯¹å¼€å‘åŒå­¦è¿›è¡Œç›¸å…³çš„åŸ¹è®­ã€‚&lt;/li&gt;&lt;li&gt;å¼€å‘äº†å®æ—¶æ…¢ SQL åˆ†æå·¥å…·â€”â€”TiSlowSQLï¼Œè¯¥å·¥å…·å¯ä»¥æä¾›å®æ—¶ã€å¤šç»´åº¦ã€å…¨è§†è§’çš„ SQL æŠ¥å‘Šï¼Œå¸®åŠ©æˆ‘ä»¬å¿«é€Ÿå®šä½æ…¢ SQL å¯¼è‡´çš„é›†ç¾¤çº§æ•…éšœã€‚&lt;/li&gt;&lt;li&gt;ä¸ºè§£å†³ç›‘æ§å•ç‚¹é—®é¢˜ï¼Œæˆ‘ä»¬è‡ªå·±å¼€å‘äº†ä¸€å¥—ç›‘æ§å·¥å…·ï¼Œå¯¹ TiDB æ ¸å¿ƒç»„ä»¶è¿›è¡Œç›‘æ§ï¼Œåç»­ä¼šå°†ç›‘æ§ç³»ç»Ÿç»Ÿä¸€è¿ç§»åˆ°ä¹‹å®¶äº‘å¹³å°ã€‚&lt;/li&gt;&lt;li&gt;å®šæœŸåœ¨æ±½è½¦ä¹‹å®¶å¤§å­¦ä¸¾è¡ŒæŠ€æœ¯åŸ¹è®­ï¼Œå®šæœŸåœ¨ç»„å†…è¿›è¡ŒæŠ€æœ¯åˆ†äº«ï¼Œç»éªŒæ€»ç»“ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;blockquote&gt;TiSlowSQL ä¹Ÿæ˜¯æ±½è½¦ä¹‹å®¶è¿ç»´ç»„å‚åŠ  Hackathon é¡¹ç›®ï¼Œå…·ä½“å†…å®¹æ•¬è¯·æœŸå¾…åç»­æ–‡ç« ï¼&lt;/blockquote&gt;&lt;h2&gt;åã€æ€»ç»“ä¸å±•æœ›&lt;/h2&gt;&lt;p&gt;æ±½è½¦ä¹‹å®¶ç¤¾åŒºå·²äº 9 æœˆåº•æ­£å¼ä¸Šçº¿åˆ†å¸ƒå¼æ•°æ®åº“ TiDBï¼Œç›®å‰è¿è¡Œç¨³å®šã€‚åœ¨å…¶ä»–ä¸šåŠ¡è¿ç§»å®Œæˆä¹‹åï¼Œæ±½è½¦ä¹‹å®¶ç¤¾åŒºçš„ SQL Server æœåŠ¡ä¼šé€æ­¥ä¸‹çº¿ã€‚å¯¹äºæœ¬æ¬¡è¿ç§»çš„è¿‡ç¨‹æˆ‘ä»¬åšäº†ä»¥ä¸‹å‡ ç‚¹æ€»ç»“ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;é€šè¿‡ä¸æ–­çš„ä¼˜åŒ– SQLï¼Œç›®å‰çº¿ä¸Š TP99 ç¨³å®šï¼Œä¸è¿ç§»ä¹‹å‰å¹¶æ— å¤ªå¤§å·®åˆ«ï¼Œè·Ÿæµ‹è¯•æ•ˆæœç›¸ç¬¦ã€‚å¯¹ç”¨æˆ·å’Œä¸šåŠ¡éƒ½æ— æ„ŸçŸ¥ã€‚&lt;/li&gt;&lt;li&gt;éšç€ä¸šåŠ¡çš„ä¸æ–­æ‰©å¤§ï¼Œå¯ä»¥æ›´å¥½çš„åº”å¯¹æ•°æ®çš„æš´å¢ï¼Œå†æ‰©å®¹é›†ç¾¤å°±ä¸éœ€è¦æ‰¾æ˜‚è´µçš„å¤§å­˜å‚¨æœºå™¨ï¼Œè€Œä¸”å¯ä»¥åœ¨çº¿ä¸åœä¸šåŠ¡éšæ—¶æ‰©å®¹ã€‚&lt;/li&gt;&lt;li&gt;æœ¬æ¬¡è¿ç§»æˆ‘ä»¬ç§¯ç´¯äº† SQL Server è½¬ TiDB çš„å¾ˆå¤šç»éªŒï¼Œå¯ä»¥ä¸ºå…¶ä»–å›¢é˜Ÿä½¿ç”¨åˆ†å¸ƒå¼æ•°æ®åº“ TiDB æä¾›æŠ€æœ¯æ”¯æŒï¼Œè®©å…¶ä»–å›¢é˜Ÿåœ¨è¿ç§»è¿‡ç¨‹ä¸­èŠ‚çœæ—¶é—´ã€‚&lt;/li&gt;&lt;li&gt;ç›®å‰æ­£åœ¨ä¸ TiDB å®˜æ–¹æ²Ÿé€šï¼Œå‡†å¤‡æŠŠè¿ç§»æ–¹æ¡ˆå’Œä¸ä¸šåŠ¡æ— å…³çš„è¿ç§»é€»è¾‘æ”¾åˆ°å¼€æºç¤¾åŒºã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;ç”± SQL Server è¿ç§»è‡³ TiDBï¼Œä»ä¼ ç»Ÿå…³ç³»å‹åˆ°åˆ†å¸ƒå¼ HTAPï¼Œä»å•†ä¸šæˆæƒåˆ°å¼€æºç¤¾åŒºï¼Œæ˜¯æ±½è½¦ä¹‹å®¶ç¤¾åŒºå†å²ä¸Šä¸€æ¬¡é‡å¤§çš„æŠ€æœ¯æ–¹å‘è½¬å‹ã€‚&lt;/b&gt;&lt;/p&gt;&lt;p&gt;æ±½è½¦ä¹‹å®¶æœ‰å¾ˆå¤šæµ·é‡æ•°æ®çš„åº”ç”¨åœºæ™¯ï¼Œè¿™ä¸€æ¬¡ä» SQL Server åˆ°åˆ†å¸ƒå¼æ•°æ®åº“ TiDB çš„è¿ç§»ï¼Œä¸ºæˆ‘ä»¬ä»¥åå…¶ä»–ä¸šåŠ¡è¿ç§»è‡³ TiDB æ‰“ä¸‹äº†è‰¯å¥½çš„åŸºç¡€ï¼Œä¹Ÿä¸ TiDB å®˜æ–¹å»ºç«‹äº†è‰¯å¥½çš„å®šæœŸæ²Ÿé€šæœºåˆ¶ã€‚å¸Œæœ› TiDB å®˜æ–¹ä¸€å¦‚æ—¢å¾€çš„å¿«é€Ÿè¿­ä»£ï¼Œæˆ‘ä»¬ä¹Ÿä¼šå’Œ TiDB å®˜æ–¹åˆä½œå¼€å‘ä¸€äº›æ¯”è¾ƒå®ç”¨çš„åŠŸèƒ½ã€‚&lt;/p&gt;&lt;blockquote&gt;&lt;b&gt;ä½œè€…ä»‹ç»ï¼š&lt;/b&gt;&lt;br/&gt;ä¹‹å®¶æŠ€æœ¯æ¶æ„ç»„ç”±å„æŠ€æœ¯å›¢é˜Ÿæ ¸å¿ƒæˆå‘˜ç»„æˆï¼Œæˆç«‹è·¨éƒ¨é—¨çš„æ¨ªå‘æ²Ÿé€šæœºåˆ¶ï¼ˆå¼€å‘ã€æµ‹è¯•ã€è¿ç»´ç­‰ï¼‰ï¼Œä¸»è¦è´Ÿè´£åˆ†å¸ƒå¼æ•°æ®åº“ã€æœåŠ¡ç½‘æ ¼ç­‰å‰æ²¿æŠ€æœ¯çš„ç ”ç©¶ã€æµ‹è¯•ã€è½åœ°å®æ–½ç­‰å·¥ä½œï¼Œå…¶ç›®çš„æ˜¯ç”¨äºè§£å†³å›¢é˜Ÿåœ¨å®é™…ç”Ÿäº§è¿‡ç¨‹ä¸­é‡åˆ°çš„æŠ€æœ¯é—®é¢˜ï¼Œæ¨è¿›ç°æœ‰ç³»ç»Ÿæ¶æ„å‡çº§ï¼Œå»ºç«‹å­¦ä¹ å‹ç¤¾ç¾¤ï¼Œæœ€ä½³å®è·µä¼ æ’­åˆ†äº«ã€‚&lt;/blockquote&gt;&lt;p&gt;&lt;b&gt;å…³äº TiDB  ä½¿ç”¨ä¸Šçš„ç–‘æƒ‘æˆ–ç»éªŒï¼Œå¯ä»¥ç™»é™† &lt;a href=&quot;https://link.zhihu.com/?target=http%3A//www.asktug.com&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;http://www.&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;asktug.com&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;&lt;/span&gt;&lt;/a&gt; å’Œå¤§å®¶ä¸€èµ·äº¤æµå“¦ï½&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;æ›´å¤šç²¾å½©æ¡ˆä¾‹ï¼š&lt;/b&gt;&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pingcap.com/cases-cn/&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic2.zhimg.com/v2-60ab5bd867c2434d70c957a02a2169e1_ipico.jpg&quot; data-image-width=&quot;1200&quot; data-image-height=&quot;1200&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;æ¡ˆä¾‹ | PingCAP&lt;/a&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>ZoeyZhai</author>
<guid isPermaLink="false">2019-12-02-94674193</guid>
<pubDate>Mon, 02 Dec 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>æµé‡å’Œå»¶è¿Ÿå‡åŠï¼æŒ‘æˆ˜ TiDB è·¨æ•°æ®ä¸­å¿ƒéš¾é¢˜</title>
<link>https://henix.github.io/feeds/zhuanlan.newsql/2019-12-02-94663335.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/94663335&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-ca2c50ac144c47f169931b60bc924788_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;ä¼—æ‰€å‘¨çŸ¥ï¼Œåœ¨å¯¹å¯ç”¨æ€§è¦æ±‚æé«˜çš„è¡Œä¸šé¢†åŸŸï¼ˆæ¯”å¦‚é‡‘èã€é€šä¿¡ï¼‰ï¼Œåˆ†å¸ƒå¼æ•°æ®åº“éœ€è¦è·¨åœ°åŸŸçš„åœ¨å¤šä¸ªæ•°æ®ä¸­å¿ƒä¹‹é—´å»ºç«‹å®¹ç¾ä»¥åŠå¤šæ´»çš„ç³»ç»Ÿæ¶æ„ï¼ŒåŒæ—¶éœ€è¦ä¿æŒæ•°æ®å®Œæ•´å¯ç”¨ã€‚ä½†è¿™ç§æ–¹å¼åŒæ—¶ä¹Ÿå¸¦æ¥äº†ä¸€äº›é—®é¢˜ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;è·¨åœ°åŸŸçš„ç½‘ç»œå»¶è¿Ÿéå¸¸é«˜ï¼Œé€šå¸¸åœ¨å‡ åæ¯«ç§’å·¦å³ï¼Œæ´²é™…é—´æ›´èƒ½è¾¾åˆ°å‡ ç™¾æ¯«ç§’ã€‚&lt;/li&gt;&lt;li&gt;è·¨åœ°åŸŸçš„ç½‘ç»œä¸“çº¿å¸¦å®½æ˜‚è´µã€æœ‰é™ï¼Œä¸”éš¾äºæ‰©å±•ã€‚&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;åœ¨ä»Šå¹´ TiDB Hackathon çš„æ¯”èµ›è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬é’ˆå¯¹ä»¥ä¸Šé—®é¢˜åšäº†ä¸€äº›æœ‰è¶£çš„äº‹æƒ…ï¼Œå¹¶è·å¾—å¦‚ä¸‹ä¼˜åŒ–æˆæœï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;è·¨åœ°åŸŸ SQL æŸ¥è¯¢ï¼Œå»¶è¿Ÿä¸‹é™ 50%ï¼ˆå›¾ 1ï¼‰ã€‚&lt;/li&gt;&lt;li&gt;è·¨èŠ‚ç‚¹æ¶ˆæ¯æ•°å‡åŠï¼Œå³ç½‘ç»œæµé‡å‡åŠï¼ˆå›¾ 2ï¼‰ã€‚&lt;/li&gt;&lt;/ol&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-2205d01f13a8826d255064bc884b83ed_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;750&quot; data-rawheight=&quot;460&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;750&quot; data-original=&quot;https://pic2.zhimg.com/v2-2205d01f13a8826d255064bc884b83ed_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-2205d01f13a8826d255064bc884b83ed_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;750&quot; data-rawheight=&quot;460&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;750&quot; data-original=&quot;https://pic2.zhimg.com/v2-2205d01f13a8826d255064bc884b83ed_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-2205d01f13a8826d255064bc884b83ed_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 1 å»¶è¿Ÿå¯¹æ¯”&lt;/figcaption&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-6ab2013f7246d4b49084d4a5032155bf_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;714&quot; data-rawheight=&quot;462&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;714&quot; data-original=&quot;https://pic4.zhimg.com/v2-6ab2013f7246d4b49084d4a5032155bf_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-6ab2013f7246d4b49084d4a5032155bf_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;714&quot; data-rawheight=&quot;462&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;714&quot; data-original=&quot;https://pic4.zhimg.com/v2-6ab2013f7246d4b49084d4a5032155bf_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-6ab2013f7246d4b49084d4a5032155bf_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 2 ç½‘ç»œæµé‡å¯¹æ¯”&lt;/figcaption&gt;&lt;/figure&gt;&lt;blockquote&gt;â€œGoogle Spanner é«˜æ€§èƒ½äº‹åŠ¡å’Œå¼ºä¸€è‡´ç‰¹æ€§ï¼ˆè·¨åŒºåŸŸç”šè‡³è·¨æ´²ï¼‰ï¼Œæ˜¯æ¯ä¸€ä¸ªåšå¤šæ•°æ®ä¸­å¿ƒæ¶æ„è®¾è®¡çš„å·¥ç¨‹å¸ˆå¿ƒä¸­æ‰€å‘å¾€çš„ç›®æ ‡ã€‚è™½ç„¶å½“å‰ TiDB åœ¨å¤šæ•°æ®ä¸­å¿ƒéƒ¨ç½²æ—¶çš„è¡¨ç°åŒ Google Spanner è¿˜æœ‰æ˜æ˜¾çš„å·®è·ï¼Œä½†æˆ‘ä»¬å¾ˆé«˜å…´çš„çœ‹åˆ°â€œå¤šæ•°æ®ä¸­å¿ƒè¯»å†™ä¼˜åŒ–â€é¡¹ç›®è®© TiDB å‘ Spanner çº§åˆ«å¤šæ•°æ®ä¸­å¿ƒèƒ½åŠ›è¿ˆå‡ºäº†åšå®çš„ä¸€æ­¥ã€‚ç›¸ä¿¡åœ¨ç¤¾åŒºå°ä¼™ä¼´ä»¬çš„å…±åŒåŠªåŠ›ä¸‹ï¼Œå‡ä»¥æ—¶æ—¥ TiDB ä¸€å®šèƒ½å¤Ÿä¸ºå¤§å®¶å¸¦æ¥ Google Spanner çº§åˆ«çš„ä½“éªŒã€‚â€&lt;br/&gt;â€”â€” å­™æ™“å…‰ï¼ˆçŸ¥ä¹ï½œæŠ€æœ¯å¹³å°è´Ÿè´£äººï¼‰&lt;br/&gt;&lt;br/&gt;â€œåœ¨å®˜æ–¹æ¨èçš„å…·å¤‡åŒåŸå¤šæ´»èƒ½åŠ›çš„åŒåŸä¸‰ä¸­å¿ƒäº”å‰¯æœ¬ï¼Œä»¥åŠä¸¤åœ°ä¸‰ä¸­å¿ƒäº”å‰¯æœ¬çš„éƒ¨ç½²æ–¹æ¡ˆä¸­ï¼Œä¸‰ä¸ªæ•°æ®ä¸­å¿ƒæŒ‰ç…§ 2:2:1 çš„æ–¹å¼åˆ†é…å‰¯æœ¬ï¼Œç½‘ç»œç§Ÿç”¨æˆæœ¬æ˜¯è¯¥æ¶æ„çš„ä¸»è¦æŠ•å…¥ï¼Œæˆ‘ä»¬åœ¨ä¸€æ¬¡å‹åŠ›æµ‹è¯•è¿‡ç¨‹ä¸­ï¼Œæ›¾é‡åˆ°è¿‡åœ¨æè‡´çš„å‹åŠ›ä¸‹å æ»¡ç½‘ç»œå¸¦å®½çš„æƒ…å†µã€‚è¿™ä¸ªé¡¹ç›®æ˜¾è‘—ä¼˜åŒ–äº†ä¸¤æœºæˆ¿ä¹‹é—´çš„å¸¦å®½å ç”¨ï¼Œå¯ä»¥ä¸ºå®¢æˆ·èŠ‚çº¦æ›´å¤šçš„æˆæœ¬ã€‚â€&lt;br/&gt;â€”â€” ç§¦å¤©çˆ½ï¼ˆPingCAPï½œæŠ€æœ¯æ”¯æŒæ€»ç›‘ï¼‰&lt;/blockquote&gt;&lt;p&gt;æ¥ä¸‹æ¥æˆ‘ä»¬å°†ä»æŠ€æœ¯åŸç†åˆ†ææ˜¯å¦‚ä½•åšåˆ°ä»¥ä¸Šä¼˜åŒ–æ•ˆæœçš„ã€‚ä»¥ä¸‹å†…å®¹éœ€è¦è¯»è€…å…·å¤‡ &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//raft.github.io/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Raft ä¸€è‡´æ€§åè®®&lt;/a&gt; çš„ä¸€äº›é¢„å¤‡çŸ¥è¯†ï¼Œå¦‚æœå¤§å®¶å‡†å¤‡å¥½äº†ï¼Œå°±ç»§ç»­å¾€ä¸‹çœ‹å§ï½&lt;/p&gt;&lt;h2&gt;æŠ€æœ¯åŸç†&lt;/h2&gt;&lt;p&gt;è€ƒè™‘ä¸€ä¸ªä¸¤æ•°æ®ä¸­å¿ƒçš„éƒ¨ç½²æ–¹æ¡ˆï¼ˆå¦‚å›¾ 3 æ‰€ç¤ºï¼‰ï¼Œå·¦åŠéƒ¨åˆ†ä¸ºä¸»æ•°æ®ä¸­å¿ƒï¼ˆMaster DCï¼Œå‡è®¾åœ¨åŒ—äº¬ï¼‰TiKV å’Œ PD çš„å¤šæ•°å‰¯æœ¬éƒ½éƒ¨ç½²åœ¨è¿™é‡Œï¼Œå¹¶ä¸”å¾ˆé‡è¦çš„æ˜¯ Leader ä¼šè¢«å›ºå®šåœ¨è¿™é‡Œï¼›å›¾ 3 å³åŠéƒ¨åˆ†ä¸ºä»æ•°æ®ä¸­å¿ƒï¼ˆSlave DCï¼Œå‡è®¾åœ¨è¥¿å®‰ï¼‰é‡Œé¢æœ‰ TiKV å’Œ TiDBã€‚ç”¨æˆ·åªä¼šåœ¨ä¸»æ•°æ®ä¸­å¿ƒè¿›è¡Œæ•°æ®å†™å…¥ï¼Œä½†ä¼šåœ¨ä¸¤è¾¹éƒ½è¿›è¡Œæ•°æ®è¯»å–ã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-3f0c02ee22d7700379462de1a546890f_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;506&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic4.zhimg.com/v2-3f0c02ee22d7700379462de1a546890f_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-3f0c02ee22d7700379462de1a546890f_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;506&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic4.zhimg.com/v2-3f0c02ee22d7700379462de1a546890f_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-3f0c02ee22d7700379462de1a546890f_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 3 ä¸»æ•°æ®ä¸­å¿ƒ &amp;amp;amp;amp; ä»æ•°æ®ä¸­å¿ƒéƒ¨ç½²&lt;/figcaption&gt;&lt;/figure&gt;&lt;h2&gt;Follower Read Improvement&lt;/h2&gt;&lt;p&gt;åœ¨ TiDB é‡Œé¢ï¼Œå½“æˆ‘ä»¬éœ€è¦ä»è¥¿å®‰è¿™è¾¹è¯»å–æ•°æ®çš„æ—¶å€™ï¼Œä¸€ä¸ªå…¸å‹çš„æµç¨‹å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;è¥¿å®‰çš„ TiDB å‘åŒ—äº¬çš„ PD å‘èµ·è·å– TSO è¯·æ±‚ï¼Œå¾—åˆ°ä¸€ä¸ª &lt;code&gt;start_ts&lt;/code&gt;ï¼ˆäº‹åŠ¡å¼€å§‹é˜¶æ®µçš„ IDï¼‰ã€‚ï¼ˆ1 RTTï¼‰&lt;/li&gt;&lt;li&gt;è¥¿å®‰çš„ TiDB ä¸ºæ¶‰åŠåˆ°çš„æ¯ä¸ª Region å‘åŒ—äº¬çš„ TiKV Leader èŠ‚ç‚¹å‘èµ·å¤šä¸ªï¼ˆå¹¶è¡Œï¼‰è¯»è¯·æ±‚ï¼ˆå¦‚å›¾ 4ï¼‰ã€‚ï¼ˆ1 RTTï¼‰&lt;/li&gt;&lt;/ol&gt;&lt;blockquote&gt;åè¯è§£é‡Šï¼š&lt;br/&gt;RTTï¼ˆRound-Trip Timeï¼‰ï¼Œå¯ä»¥ç®€å•ç†è§£ä¸ºå‘é€æ¶ˆæ¯æ–¹ä»å‘é€æ¶ˆæ¯åˆ°å¾—çŸ¥æ¶ˆæ¯åˆ°è¾¾æ‰€ç»è¿‡çš„æ—¶é—´ã€‚&lt;br/&gt;TSOï¼ˆTimestamp Oracleï¼‰ï¼Œç”¨äºè¡¨ç¤ºåˆ†å¸ƒå¼äº‹åŠ¡å¼€å§‹é˜¶æ®µçš„ IDã€‚&lt;/blockquote&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-4a7a82db0361121d3b1997e57fcfc8b8_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;950&quot; data-rawheight=&quot;200&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;950&quot; data-original=&quot;https://pic1.zhimg.com/v2-4a7a82db0361121d3b1997e57fcfc8b8_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-4a7a82db0361121d3b1997e57fcfc8b8_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;950&quot; data-rawheight=&quot;200&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;950&quot; data-original=&quot;https://pic1.zhimg.com/v2-4a7a82db0361121d3b1997e57fcfc8b8_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-4a7a82db0361121d3b1997e57fcfc8b8_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 4 ä¸å¯ç”¨ Follower Read çš„è¯»æµç¨‹&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;å¯ä»¥çœ‹åˆ°ï¼Œè™½ç„¶è¥¿å®‰æœ¬åœ°ä¹Ÿæœ‰ TiKV å‰¯æœ¬æ•°æ®ï¼Œä½†å®Œå…¨æ²¡æœ‰å‚ä¸è¿™ä¸ªè¿‡ç¨‹ã€‚è¯¥å®ç°å­˜åœ¨ä¸¤ä¸ªé—®é¢˜ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;è·¨åœ°åŸŸç½‘ç»œå®½å¸¦å ç”¨å¤§ã€‚&lt;/li&gt;&lt;li&gt;å»¶è¿Ÿé«˜ï¼ˆ2 RTTï¼‰ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;ä¸‹é¢æˆ‘ä»¬åˆ†åˆ«é˜è¿°å¯¹è¿™ä¸¤ä¸ªé—®é¢˜çš„ä¼˜åŒ–æ€è·¯ã€‚&lt;/p&gt;&lt;h3&gt;1. è·¨åœ°åŸŸç½‘ç»œå®½å¸¦å ç”¨å¤§&lt;/h3&gt;&lt;p&gt;å…¶å®é’ˆå¯¹è¿™ä¸ªé—®é¢˜ï¼ŒTiDB å·²ç»åœ¨ 3.1 ç‰ˆæœ¬å¼•å…¥äº† &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pingcap.com/blog-cn/follower-read-the-new-features-of-tidb/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Follower Read&lt;/a&gt; ç‰¹æ€§ã€‚å¼€å¯è¯¥ç‰¹æ€§åï¼ŒTiKV Leader ä¸Šçš„èŠ‚ç‚¹ä»å¿…é¡»å¤„ç†æ•´ä¸ªè¯»è¯·æ±‚æ”¹ä¸ºåªç”¨å¤„ç†ä¸€æ¬¡ read_index è¯·æ±‚ï¼ˆä¸€æ¬¡ read_index é€šå¸¸åªæ˜¯ä½ç½®ä¿¡æ¯çš„äº¤äº’ï¼Œä¸æ¶‰åŠæ•°æ®ï¼Œæ‰€ä»¥è½»é‡å¾ˆå¤šï¼‰ï¼Œè´Ÿè½½å‹åŠ›å¤§å¹…é™ä½ï¼Œæ˜¯ä¸€ä¸ªå¾ˆå¤§çš„ä¼˜åŒ–ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-1ddab02554d2f27c485cd99ffe0d776a_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;971&quot; data-rawheight=&quot;350&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;971&quot; data-original=&quot;https://pic3.zhimg.com/v2-1ddab02554d2f27c485cd99ffe0d776a_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-1ddab02554d2f27c485cd99ffe0d776a_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;971&quot; data-rawheight=&quot;350&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;971&quot; data-original=&quot;https://pic3.zhimg.com/v2-1ddab02554d2f27c485cd99ffe0d776a_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-1ddab02554d2f27c485cd99ffe0d776a_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 5 å¼€å¯ Follower Read çš„è¯»æµç¨‹&lt;/figcaption&gt;&lt;/figure&gt;&lt;h2&gt;2. å»¶è¿Ÿé«˜&lt;/h2&gt;&lt;p&gt;åœ¨è¯»å»¶è¿Ÿä¸Šï¼ŒTiDB ä»ç„¶éœ€è¦ 2 ä¸ªè·¨åœ°åŸŸçš„ RTTã€‚è¿™ä¸¤ä¸ª RTT çš„å»¶è¿Ÿæ˜¯ç”±ä¸€æ¬¡è·å– TSO è¯·æ±‚å’Œå¤šæ¬¡ï¼ˆå¹¶è¡Œçš„ï¼‰&lt;code&gt;read_index&lt;/code&gt; å¸¦æ¥çš„ã€‚ç®€å•è§‚å¯Ÿåï¼Œæˆ‘ä»¬ä¸éš¾å‘ç°ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥å°†ä¸Šé¢ä¸¤ä¸ªæ“ä½œå¹¶è¡Œä¸€èµ·å¤„ç†ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-18001f075eb12773075f37c6e51487d4_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;985&quot; data-rawheight=&quot;500&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;985&quot; data-original=&quot;https://pic1.zhimg.com/v2-18001f075eb12773075f37c6e51487d4_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-18001f075eb12773075f37c6e51487d4_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;985&quot; data-rawheight=&quot;500&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;985&quot; data-original=&quot;https://pic1.zhimg.com/v2-18001f075eb12773075f37c6e51487d4_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-18001f075eb12773075f37c6e51487d4_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 6 Follower Read æµç¨‹ä¼˜åŒ–&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;é€šè¿‡è¿™ç§ä¼˜åŒ–æ–¹å¼ï¼Œæˆ‘ä»¬å®ç°äº†è·¨æ•°æ®ä¸­å¿ƒè¯»è¯·æ±‚ 2RTT -&amp;gt; 1RTT çš„æå‡ï¼Œå¹¶ä¸”æˆ‘ä»¬åœ¨æ¨¡æ‹Ÿçš„é«˜å»¶è¿Ÿç½‘ç»œç¯å¢ƒä¸­çš„ benchmark è¯å®äº†è¿™ä¸€ç‚¹ï¼š&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-40729e93130f6385466b9a5bd819df59_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;291&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;939&quot; data-original=&quot;https://pic2.zhimg.com/v2-40729e93130f6385466b9a5bd819df59_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-40729e93130f6385466b9a5bd819df59_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;939&quot; data-rawheight=&quot;291&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;939&quot; data-original=&quot;https://pic2.zhimg.com/v2-40729e93130f6385466b9a5bd819df59_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-40729e93130f6385466b9a5bd819df59_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 7 benchmark&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;è€ƒè™‘åˆ°æ²¡æœ‰åŸå­é’Ÿçš„æƒ…å†µä¸‹æƒ³è¦ä¿è¯çº¿æ€§ä¸€è‡´æ€§ï¼Œä¸€æ¬¡è·å– TSO çš„è¯·æ±‚æ˜¯æ— æ³•é¿å…çš„ï¼Œå› æ­¤å¯ä»¥è®¤ä¸º 1RTT å·²ç»æ˜¯åœ¨ç›®å‰çš„æ¶æ„ä¸‹æœ€ä¼˜çš„è§£å†³æ–¹æ¡ˆäº†ã€‚&lt;/p&gt;&lt;h3&gt;ç”¨ Follower Replication å‡å°‘å¸¦å®½æˆæœ¬&lt;/h3&gt;&lt;p&gt;æ¥ä¸‹æ¥è°ˆä¸€è°ˆå¦‚ä½•ç”¨ Follower Replication è¿™ç§æ–¹å¼ï¼Œå‡å°‘è·¨æ•°æ®ä¸­å¿ƒçš„å¸¦å®½æˆæœ¬ã€‚&lt;/p&gt;&lt;p&gt;ä¼—æ‰€å‘¨çŸ¥ TiKV é›†ç¾¤ä¸­çš„ä¸€è‡´æ€§æ˜¯ä¾é  Raft åè®®æ¥ä¿è¯çš„ã€‚åœ¨ Raft åè®®ä¸­ï¼Œæ‰€éœ€è¦è¢«å…±è¯†ä¸€è‡´çš„æ•°æ®å¯ä»¥ç”¨ Entry æ¥è¡¨ç¤ºã€‚ä¸€ä¸ª Entry è¢«å…±è¯†ï¼Œéœ€è¦ Leader åœ¨æ¥æ”¶åˆ°è¯·æ±‚ä¹‹åï¼Œå¹¿æ’­ç»™å…¶ä»– Follower èŠ‚ç‚¹ï¼Œä¹‹åé€šè¿‡ä¸æ–­çš„æ¶ˆæ¯äº¤äº’æ¥ä½¿è¿™ä¸ª Entry è¢« commitã€‚è¿™é‡Œå¯èƒ½ä¼šé‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼šæœ‰äº›æ—¶å€™ TiKV è¢«éƒ¨ç½²åœ¨ä¸–ç•Œå„åœ°ä¸åŒçš„æ•°æ®ä¸­å¿ƒä¸­ï¼Œæ•°æ®ä¸­å¿ƒä¹‹é—´çš„ç½‘ç»œä¼ è¾“æˆæœ¬å’Œå»¶è¿Ÿæ¯”è¾ƒé«˜ï¼Œç„¶è€Œ Leader åªæœ‰ä¸€ä¸ªï¼Œå¯æƒ³è€ŒçŸ¥ä¼šå‘ç”Ÿå¾ˆå¤šæ¬¡è·¨æ•°æ®ä¸­å¿ƒçš„æ¶ˆæ¯ä¼ è¾“ã€‚&lt;/p&gt;&lt;p&gt;ä¸¾ä¸ªä¾‹å­ï¼Œç”Ÿäº§ç¯å¢ƒä¸­å¯èƒ½éœ€è¦ 5 ä¸ªå‰¯æœ¬æ¥ä¿è¯å¯ç”¨æ€§ï¼Œå‡è®¾ 3 ä¸ªå‰¯æœ¬åœ¨åŒ—äº¬åˆ†åˆ«æ˜¯ A B Cï¼Œ2 ä¸ªåœ¨è¥¿å®‰åˆ†åˆ«æ˜¯ D Eï¼ŒåŒæ—¶ Leader ä¸º Aï¼Œé‚£ä¹ˆä¸€æ¡ Entry éœ€è¦åŒ—äº¬çš„ Leader Aï¼Œå¹¿æ’­ç»™è¥¿å®‰çš„ DEï¼Œé‚£ä¹ˆè¿™æ¬¡å¹¿æ’­è‡³å°‘éœ€è¦ä¸¤æ¬¡è·¨æ•°æ®ä¸­å¿ƒçš„ç½‘ç»œä¼ è¾“ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-1bc49f641cb2bfdb12e4ada62b28d370_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;800&quot; data-rawheight=&quot;400&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;800&quot; data-original=&quot;https://pic1.zhimg.com/v2-1bc49f641cb2bfdb12e4ada62b28d370_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-1bc49f641cb2bfdb12e4ada62b28d370_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;800&quot; data-rawheight=&quot;400&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;800&quot; data-original=&quot;https://pic1.zhimg.com/v2-1bc49f641cb2bfdb12e4ada62b28d370_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-1bc49f641cb2bfdb12e4ada62b28d370_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 8 æ­£å¸¸çš„æ¶ˆæ¯å¹¿æ’­&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;Follower Replication çš„ç›®æ ‡æ˜¯å°†è¿™ä¸ªå¤šæ¬¡çš„è·¨æ•°æ®ä¸­å¿ƒä¼ è¾“å°½é‡å‡å°‘ã€‚è¦å®ç° Follower Replicationï¼Œæœ€å…³é”®çš„æ˜¯éœ€è¦è®© Leader èŠ‚ç‚¹çŸ¥é“æ‰€æœ‰ Raft èŠ‚ç‚¹ä¸å®ƒæ‰€åœ¨çš„ æ•°æ®ä¸­å¿ƒçš„ä¿¡æ¯ã€‚è¿™é‡Œæˆ‘ä»¬å¼•å…¥äº†ä¸€ä¸ªæ–°æ¦‚å¿µ Groupï¼Œæ¯ä¸€ä¸ª Raft èŠ‚ç‚¹éƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„ Group IDï¼Œæ‹¥æœ‰ç›¸åŒ Group ID çš„èŠ‚ç‚¹å³åœ¨åŒä¸€ä¸ªæ•°æ®ä¸­å¿ƒä¸­ã€‚æ—¢ç„¶æœ‰äº†æ¯ä¸ª Raft èŠ‚ç‚¹çš„ Group ä¿¡æ¯ï¼ŒLeader å°±å¯ä»¥åœ¨å¹¿æ’­æ¶ˆæ¯æ—¶åœ¨æ¯ä¸€ä¸ª Group ä¸­é€‰æ‹©ä¸€ä¸ªä»£ç†äººèŠ‚ç‚¹ï¼ˆæˆ‘ä»¬ç§°ä¸º Follower  Delegateï¼‰ï¼Œå°†æ•´ä¸ª Group æˆå‘˜æ‰€éœ€è¦çš„ä¿¡æ¯å‘ç»™è¿™ä¸ªä»£ç†äººï¼Œä»£ç†äººè´Ÿè´£å°†æ•°æ®åŒæ­¥ç»™ Group å†…çš„å…¶ä»–æˆå‘˜ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-cf202bd591a6a0488b42f1e8c305b8e4_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;800&quot; data-rawheight=&quot;400&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;800&quot; data-original=&quot;https://pic1.zhimg.com/v2-cf202bd591a6a0488b42f1e8c305b8e4_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-cf202bd591a6a0488b42f1e8c305b8e4_b.jpg&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;800&quot; data-rawheight=&quot;400&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;800&quot; data-original=&quot;https://pic1.zhimg.com/v2-cf202bd591a6a0488b42f1e8c305b8e4_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-cf202bd591a6a0488b42f1e8c305b8e4_b.jpg&quot;/&gt;&lt;figcaption&gt;å›¾ 9 é€‰æ‹©ä»£ç†äººä¹‹åçš„æ¶ˆæ¯å¹¿æ’­&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;é€šè¿‡ä½¿ç”¨ Follower Replicationï¼ŒLeader å‡å°‘äº†ä¸€åŠçš„æ•°æ®å‘é€ï¼Œæ—¢å¤§å¤§é™ä½äº†è·¨æ•°æ®ä¸­å¿ƒå¸¦å®½çš„å‹åŠ›ï¼ŒåŒæ—¶ä¹Ÿå‡å°‘äº† Leader åœ¨å‘é€ç½‘ç»œæ¶ˆæ¯ä¸Šçš„å¼€é”€ã€‚å½“ç„¶ï¼Œå®é™… Follower Replication çš„å®ç°è¿˜æ˜¯å¾ˆå¤æ‚çš„ï¼Œæˆ‘ä»¬åç»­ä¼šä¸“é—¨å†™ä¸€ç¯‡è¯¦ç»†çš„æ–‡ç« æ¥ä»‹ç»ã€‚&lt;/p&gt;&lt;p&gt;å…³äºè¿™ä¸ªå¯¹ Raft å®ç°çš„æ”¹è¿›ï¼Œæˆ‘ä»¬å·²ç»æäº¤äº† RFC å’Œå®ç°çš„ PRï¼Œåç»­ä¹Ÿä¼šè´¡çŒ®ç»™ etcdï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥å‚è€ƒï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/tikv/rfcs/pull/33&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;github.com/tikv/rfcs/pu&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;ll/33&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/tikv/raft-rs/pull/249/&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;github.com/tikv/raft-rs&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;/pull/249/&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/etcd-io/etcd/issues/11357&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;github.com/etcd-io/etcd&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;/issues/11357&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h2&gt;æ€»ç»“&lt;/h2&gt;&lt;p&gt;é™¤äº†æˆ‘ä»¬åœ¨ Hackathon åšçš„ä¸¤ä¸ªä¼˜åŒ–ï¼Œè·¨æ•°æ®ä¸­å¿ƒçš„åœºæ™¯æœ‰æ›´å¤šéœ€è¦è§£å†³çš„é—®é¢˜å’Œå¯ä»¥ä¼˜åŒ–çš„ç‚¹ï¼Œæˆ‘ä»¬çš„ä¼˜åŒ–ä¹Ÿè¿œéæœ€ç»ˆå®ç°ï¼Œä¸€äº›ä¸éš¾æƒ³åˆ°çš„ä¼˜åŒ–è¿˜æœ‰ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Follower Read Improvement èƒ½å°†ä¸€ä¸ªéäº¤äº’å¼çš„è¯»äº‹åŠ¡ä» 2RTT é™åˆ° 1RTTï¼Œä½†å¯¹äºäº¤äº’å¼çš„è¯»äº‹åŠ¡ï¼Œç”±äºäº‹å…ˆä¸çŸ¥é“æ¶‰åŠåˆ°äº‹åŠ¡çš„ Regionï¼Œæ— æ³•é¢„è¯»æ•´ä¸ªè¯»è¯·æ±‚ä¸­æ‰€æœ‰ Region &lt;code&gt;read_index&lt;/code&gt;ï¼Œå› æ­¤åªæœ‰ç¬¬ä¸€æ¬¡è¯»è¯·æ±‚å’Œ &lt;code&gt;get_tso&lt;/code&gt; å¯ä»¥å¹¶è¡Œï¼Œå°† n+1 RTT ä¼˜åŒ–åˆ°äº† n RTTï¼ˆn ä¸ºäº¤äº’å¼äº‹åŠ¡ä¸­è¯»è¯­å¥çš„æ•°é‡ï¼‰ï¼Œè€Œå¦‚æœæˆ‘ä»¬èƒ½å°† ts å’Œ committed index çš„å¯¹åº”å…³ç³»æ‰¾åˆ°ï¼Œå¹¶ä¸”å®šæœŸç»´æŠ¤æ¯ä¸ª Region çš„ safe tsï¼ˆå°äºè¯¥ ts çš„äº‹åŠ¡ä¸€å®šå·²ç» committed or abortedï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å°†äº¤äº’å¼è¯»äº‹åŠ¡çš„å»¶è¿Ÿä¹Ÿé™ä½åˆ° 1RTTã€‚&lt;/li&gt;&lt;li&gt;è·¨æ•°æ®ä¸­å¿ƒçš„è¯»è¯·æ±‚ä¸€ä¸ªå¾ˆå¸¸è§çš„åœºæ™¯æ˜¯å¹¶ä¸éœ€è¦æ˜¯æœ€æ–°çš„æ•°æ®ï¼Œåº”è¯¥æä¾›æ€ä¹ˆæ ·çš„è¯­ä¹‰æ¥è®©è¿™ç§åœºæ™¯ä¸‹çš„è¯»è¯·æ±‚å®Œå…¨åœ¨æœ¬åœ° 0RTT åœ°è¯»å–æ•°æ®ï¼ŒçœŸæ­£åšåˆ°å¯¹ä¸»æ•°æ®ä¸­å¿ƒæ— ä¾èµ–ï¼Œåšåˆ°æ•°æ®ä¸­å¿ƒçº§åˆ«çš„ scalabilityã€‚&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;b&gt;æœ‰å¥è¯æ˜¯è¿™æ ·è¯´çš„ï¼Œâ€œå¯¹äºåŸºç¡€æ¶æ„æ–¹å‘çš„è½¯ç¡¬ä»¶å·¥ç¨‹å¸ˆè€Œè¨€ï¼Œä¸–ç•Œä¸Šæœ€è¿œçš„è·ç¦»ï¼Œæ˜¯ä½ åœ¨è”é€šï¼Œæˆ‘åœ¨ç”µä¿¡ :Dâ€è½¯ä»¶å·¥ç¨‹å¸ˆåšå¾—è¶Šå¥½ï¼Œç§ƒé¡¶çš„ç¡¬ä»¶å·¥ç¨‹å¸ˆå°±è¶Šå°‘ã€‚&lt;/b&gt;å¸Œæœ›æˆ‘ä»¬çš„é¡¹ç›®åœ¨åˆ‡å®è½åœ°ä¹‹åï¼Œèƒ½å¤Ÿå¤§å¹…ä¼˜åŒ– TiDB è·¨åœ°åŸŸæ•°æ®ä¸­å¿ƒçš„å»¶è¿Ÿå’Œç½‘ç»œæµé‡ï¼Œè®© TiDB èƒ½å¤Ÿæ»¡è¶³æ›´å¤šç”¨æˆ·çš„éœ€æ±‚ï¼Œæˆä¸ºåˆ†å¸ƒå¼æ•°æ®åº“é¢†åŸŸçš„äº‹å®æ ‡å‡†ã€‚&lt;/p&gt;&lt;blockquote&gt;&lt;b&gt;ä½œè€…ä»‹ç»&lt;/b&gt;ï¼š&lt;br/&gt;.* team ç”±åº„å¤©ç¿¼ã€æœ±è´ºå¤©ã€å±ˆé¹ã€æ—è±ªç¿”ç»„æˆï¼Œä»–ä»¬å‚åŠ äº† &lt;u&gt;&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//mp.weixin.qq.com/s%3F__biz%3DMzI3NDIxNTQyOQ%3D%3D%26mid%3D2247490046%26idx%3D1%26sn%3D962bb8aa4619c3815fcc561ed96331d7%26chksm%3Deb163e94dc61b7826b7e73a057f4c9823261c1a79005104dd41dbd6ef4276c01bd6e41a69d14%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TiDB Hackathon 2019&lt;/a&gt;&lt;/u&gt;ï¼Œå…¶é¡¹ç›®ã€ŒTiDB è·¨æ•°æ®ä¸­å¿ƒæ–¹æ¡ˆçš„ä¼˜åŒ–ã€æ–©è·äº†äºŒç­‰å¥–ã€‚&lt;br/&gt;å¦å¤–ï¼Œ.* team ä¹Ÿå‚åŠ äº†  &lt;u&gt;&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//mp.weixin.qq.com/s%3F__biz%3DMzI3NDIxNTQyOQ%3D%3D%26mid%3D2247490113%26idx%3D1%26sn%3D5322d6ae9795403e416724903c1d93ff%26chksm%3Deb163d2bdc61b43d5e6bc91cb6d98b7f2f9ddf9816010433ada403487ff3e8521e3f5966a9dd%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TiDB æ€§èƒ½æŒ‘æˆ˜èµ›&lt;/a&gt;&lt;/u&gt;ï¼Œç§¯åˆ†æˆç»©å¾ˆæ˜¯è€€çœ¼å“¦ï¼å¦‚æœå¤§å®¶æƒ³å’Œä»–ä»¬äº¤æµåˆ‡ç£‹ï¼Œæˆ–è€…æ·±å…¥å‚ä¸ç¤¾åŒºäº’åŠ¨ï¼Œå¯ä»¥æŸ¥çœ‹ &lt;u&gt;&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//mp.weixin.qq.com/s%3F__biz%3DMzI3NDIxNTQyOQ%3D%3D%26mid%3D2247490088%26idx%3D1%26sn%3D82f185e38ad4d8c86cbc21c19750aa8c%26chksm%3Deb163d42dc61b454295f6ba36e1142d2bf8549bb0b79a87dce876ad48982260a926a7d1fcf9a%26scene%3D21%23wechat_redirect&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;è¿™ç¯‡æ–‡ç« &lt;/a&gt;&lt;/u&gt; äº†è§£å‚èµ›ç»†åˆ™ï¼Œå¤§èµ›è®¾ç½®äº†ä¸€ç³»åˆ—ä» Easy åˆ° Hard çš„é¡¹ç›®ï¼Œå¤§å®¶å¯ä»¥å‡çº§æ‰“æ€ªèµ¢å–ç§¯åˆ†ï¼Œå¸Œæœ›å„ä½éƒ½èƒ½åœ¨ç¤¾åŒºé‡Œç©å¾—å¼€å¿ƒï¼&lt;/blockquote&gt;</description>
<author>ZoeyZhai</author>
<guid isPermaLink="false">2019-12-02-94663335</guid>
<pubDate>Mon, 02 Dec 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>TiKV Engine SIG æˆç«‹ï¼Œç¡¬æ ¸ç©å®¶ä»¬çœ‹è¿‡æ¥ï¼</title>
<link>https://henix.github.io/feeds/zhuanlan.newsql/2019-11-28-94184098.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/94184098&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-484fb1e84e94d2ee42e92b89d64bf3ca_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;ä½œè€…ï¼šYi Wu&lt;/p&gt;&lt;p&gt;TiKV æ˜¯ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œæˆ‘ä»¬ä¸€ç›´éƒ½æ¬¢è¿å’Œæ„Ÿæ¿€å¼€æºç¤¾åŒºå¯¹ TiKV æ‰€ä½œå‡ºçš„è´¡çŒ®ã€‚ä½†æˆ‘ä»¬ä¹‹å‰å¯¹å¼€æºç¤¾åŒºçš„åˆä½œä¸»è¦æ˜¯åœ¨ä»£ç å®¡é˜…å’Œæ•£è½åœ¨å„ç§ç¤¾äº¤åª’ä½“çš„çº¿ä¸‹è®¨è®ºï¼Œå¼€å‘è€…å¹¶æ²¡æœ‰åˆé€‚çš„é€”å¾„å»äº†è§£å’Œå½±å“ TiKV çš„å¼€å‘è®¡åˆ’ã€‚æ€ä¹ˆæ‰èƒ½æ›´å¥½çš„å¸®åŠ©å¤§å®¶æ‰¾åˆ°ç»„ç»‡ï¼Œæ›´å¥½åœ°å‚ä¸åˆ° TiKV çš„å¼€å‘ä¸­æ¥å‘¢ï¼Ÿæˆ‘ä»¬çš„è®¾æƒ³æ˜¯æ­å»ºå…¬å¼€çš„å¹³å°ï¼Œé‚€è¯·å¯¹ TiKV ä¸­ç‰¹å®šé¢†åŸŸæ„Ÿå…´è¶£çš„å¼€å‘è€…åŠ å…¥å…¶ä¸­ï¼Œä¸æˆ‘ä»¬ä¸€èµ·æ¢è®¨å’Œæ¨è¿›ç›¸åº”å·¥ä½œã€‚Special Interest Groupï¼ˆSIGï¼‰å°±æ˜¯è¿™æ ·çš„å¹³å°ã€‚&lt;/p&gt;&lt;p&gt;TiKV Engine SIG æ˜¯ç»§ &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pingcap.com/blog-cn/tikv-coprocessor-sig/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Coprocessor SIG&lt;/a&gt; ä¹‹åæˆç«‹çš„ç¬¬äºŒä¸ª TiKV SIG ç¤¾åŒºç»„ç»‡ï¼Œä¸»è¦èŒè´£æ˜¯å¯¹ TiKV çš„å­˜å‚¨å¼•æ“çš„æœªæ¥å‘å±•è¿›è¡Œè®¨è®ºå’Œè§„åˆ’ï¼Œå¹¶è¿›è¡Œç›¸å…³å¼€å‘å’Œç»´æŠ¤ã€‚&lt;/p&gt;&lt;p&gt;ç›®å‰ TiKV ä»…æ”¯æŒé»˜è®¤å­˜å‚¨å¼•æ“ RocksDBï¼Œä½†æ˜¯é€šè¿‡æ‰©å±•æ¥å£ï¼Œå¸Œæœ›æœªæ¥ TiKV å¯ä»¥æ”¯æŒæ›´å¤šçš„å­˜å‚¨å¼•æ“ï¼Œæˆ‘ä»¬ä¹ŸæœŸå¾…è¿™éƒ¨åˆ†å·¥ä½œå¯ä»¥å¾—åˆ°ç¤¾åŒºçš„æ”¯æŒï¼Œåœ¨ç¤¾åŒºçš„è®¨è®ºå’Œè´¡çŒ®ä¸­å¾—åˆ°æ›´å¥½çš„å®Œå–„ã€‚æ­¤å¤–ï¼ŒEngine SIG ä¹Ÿä¼šå¯¹å·²æœ‰çš„å­˜å‚¨å¼•æ“è¿›è¡Œç›¸å…³çš„å¼€å‘å’Œå®Œå–„å·¥ä½œã€‚&lt;/p&gt;&lt;p&gt;Engine SIG çš„å·¥ä½œä¸»è¦æ¶‰åŠçš„æ¨¡å—åŒ…æ‹¬ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Engine Traitï¼š TiKV ä¸­å­˜å‚¨å¼•æ“çš„æŠ½è±¡å±‚ã€‚&lt;/li&gt;&lt;li&gt;RocksDBï¼šåŒ…æ‹¬ç»´æŠ¤ TiKV æ‰€ä½¿ç”¨çš„ RocksDB åˆ†æ”¯ï¼Œä»¥åŠ rust-rocksdb å°è£…ã€‚&lt;/li&gt;&lt;li&gt;Titanï¼šæä¾› KV åˆ†ç¦»æ”¯æŒçš„ RocksDB å­˜å‚¨å¼•æ“æ’ä»¶ã€‚&lt;/li&gt;&lt;li&gt;æœªæ¥ TiKV å¯¹å…¶å®ƒå­˜å‚¨å¼•æ“çš„æ”¯æŒã€‚&lt;/li&gt;&lt;/ul&gt;&lt;h2&gt;å¦‚ä½•åŠ å…¥ Engine SIG&lt;/h2&gt;&lt;p&gt;æ— è®ºä½ æ˜¯æ•°æ®åº“å¼€å‘æ–°æ‰‹ï¼Œå¸Œæœ›é€šè¿‡å®æˆ˜äº†è§£å­˜å‚¨å¼€å‘ç›¸å…³çŸ¥è¯†ï¼›â€‹è¿˜æ˜¯ TiKV èµ„æ·±ç”¨æˆ·ï¼Œå¸Œæœ›æ‰©å±• TiKV çš„èƒ½åŠ›ä»¥åº”ç”¨åˆ°ç”Ÿäº§ç¯å¢ƒï¼ŒEngine SIG éƒ½æ¬¢è¿ä½ çš„åŠ å…¥ï¼&lt;/p&gt;&lt;p&gt;æœ‰å…´è¶£çš„å¼€å‘è€…å¯ä»¥æµè§ˆ Engine SIG æ–‡æ¡£å¹¶åŠ å…¥ Engine SIG çš„ Slack é¢‘é“ã€‚Engine SIG å¸Œæœ›èƒ½å¤Ÿå¸®åŠ© Contributor é€æ¸æˆé•¿ä¸º Reviewerï¼ŒCommitter ä¹ƒè‡³ TiKV çš„ Maintanerã€‚&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Engine SIG ä¸»é¡µï¼š&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/tikv/community/tree/master/sig/engine&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;github.com/tikv/communi&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;ty/tree/master/sig/engine&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;&lt;li&gt;Engine SIG ç« ç¨‹ï¼š&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/tikv/community/blob/master/sig/engine/constitution-zh_CN.md&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;github.com/tikv/communi&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;ty/blob/master/sig/engine/constitution-zh_CN.md&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;&lt;li&gt;Engine SIG Slackï¼šåŠ å…¥ &lt;a href=&quot;https://link.zhihu.com/?target=http%3A//tikv-wg.slack.com&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;http://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;tikv-wg.slack.com&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;&lt;/span&gt;&lt;/a&gt; å¹¶è¿›å…¥ &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//tikv-wg.slack.com/%3Fredir%3D%252Fmessages%252Fengine-sig&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;#engine-sig&lt;/a&gt; é¢‘é“ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;h2&gt;è¿‘æœŸå·¥ä½œè®¡åˆ’&lt;/h2&gt;&lt;p&gt;è¿‘æœŸ Engine SIG å·¥ä½œä¼šå›´ç»•åœ¨å¯¹ TiKV å·²æœ‰å­˜å‚¨å¼•æ“çš„æ”¹è¿›ä¸Šé¢ï¼Œä½†æˆ‘ä»¬ä¼šå°½é‡é€‰å–ä¸€äº›å¯¹ä»¥åå¼•å…¥å…¶å®ƒå­˜å‚¨å¼•æ“ä¹Ÿæœ‰æ„ä¹‰çš„å·¥ä½œã€‚å…·ä½“æœ‰ä»¥ä¸‹å‡ æ–¹é¢ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;ä½¿ç”¨ &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//rust-lang.github.io/rust-bindgen/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Bindgen&lt;/a&gt; å¯¹ &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/tikv/rust-rocksdb&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;rust-rocksdb&lt;/a&gt; è¿›è¡Œé‡æ„ï¼Œå‡å°‘æ–°å¢å­˜å‚¨å¼•æ“æ¥å£çš„å¼€å‘å¤æ‚åº¦ã€‚&lt;/li&gt;&lt;li&gt;æ‰©å±• &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pingcap.com/blog-cn/tikv-source-code-reading-5/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;failpoint&lt;/a&gt; æ¥å£ï¼Œå…è®¸ä¸ºä¸åŒçš„å­˜å‚¨å¼•æ“å¼€å‘ç›¸åº”çš„æ’ä»¶ï¼Œä½¿å¾— TiKV æµ‹è¯•èƒ½å¤Ÿå¯¹å­˜å‚¨å¼•æ“å†…éƒ¨è¿›è¡Œé”™è¯¯æ³¨å…¥ã€‚&lt;/li&gt;&lt;li&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/pingcap/titan&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;Titan&lt;/a&gt; å­˜å‚¨å¼•æ“æ’ä»¶çš„æ€§èƒ½å’ŒåŠŸèƒ½çš„æ”¹è¿›ã€‚&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;è¯¦ç»†ä»»åŠ¡åˆ—è¡¨è§ï¼š&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/tikv/tikv/projects/22&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;github.com/tikv/tikv/pr&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;ojects/22&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;/a&gt;ã€‚&lt;/p&gt;&lt;h2&gt;æœªæ¥å·¥ä½œè®¡åˆ’&lt;/h2&gt;&lt;p&gt;æœªæ¥ Engine SIG ä¼šæ›´å¤šå…³æ³¨äºä¸º TiKV å¼•å…¥æ–°çš„å­˜å‚¨å¼•æ“ã€‚è¿™ä¸Šé¢å¯ä»¥åšçš„å·¥ä½œå¾ˆå¤šã€‚æ¯”å¦‚è¯´ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘ä¸º TiKV å¼•å…¥é’ˆå¯¹ä¸åŒç¡¬ä»¶ï¼ˆçº¯å†…å­˜ã€æŒä¹…åŒ–å†…å­˜ã€äº‘ç›˜ç­‰ï¼‰çš„å­˜å‚¨å¼•æ“ï¼Œä¸åŒæ•°æ®ç»“æ„çš„å­˜å‚¨å¼•æ“ï¼ˆB-Tree å¼•æ“ç­‰ï¼‰ï¼Œé’ˆå¯¹ç‰¹æ®Šåœºæ™¯çš„å­˜å‚¨å¼•æ“ï¼ˆå…¨æ–‡æœç´¢ç­‰ï¼‰ï¼Œæˆ–è€…å•çº¯æ˜¯ä¸ä¸€æ ·çš„å­˜å‚¨å¼•æ“å®ç°ï¼ˆLevelDB ç­‰ï¼‰ã€‚è¿™äº›å·¥ä½œéå¸¸éœ€è¦ç¤¾åŒºçš„å‚ä¸ã€‚æˆ‘ä»¬å¸Œæœ›è¿™äº›å·¥ä½œæœªæ¥èƒ½å¤Ÿæ‰©å±• TiKV çš„é¢†åŸŸå’Œå¯èƒ½ã€‚ç›®å‰ TiKV æ­£åœ¨åŠ ç´§å¯¹å­˜å‚¨å¼•æ“æŠ½è±¡ Engine Trait è¿›è¡Œå¼€å‘ï¼Œä½¿ä»¥ä¸Šçš„è®¾æƒ³æˆä¸ºå¯èƒ½ã€‚&lt;/p&gt;&lt;p&gt;æœŸå¾…ç¤¾åŒºä¼™ä¼´ä»¬çš„åŠ å…¥ï¼æ¬¢è¿åœ¨ Slack &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//tikv-wg.slack.com/%3Fredir%3D%252Fmessages%252Fengine-sig&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;#engine-sig&lt;/a&gt; ä¸­ä¸æˆ‘ä»¬äº¤æµï¼å¦‚æœå¯¹äºæµç¨‹æˆ–æŠ€æœ¯ç»†èŠ‚æœ‰ä»»ä½•ç–‘é—®ï¼Œéƒ½å¯åœ¨ channel ä¸­è®¨è®ºï½&lt;/p&gt;&lt;p&gt;&lt;b&gt;åŸæ–‡é˜…è¯»ï¼š&lt;/b&gt;&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pingcap.com/blog-cn/tikv-engine-sig-introduction/&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic2.zhimg.com/v2-60ab5bd867c2434d70c957a02a2169e1_ipico.jpg&quot; data-image-width=&quot;1200&quot; data-image-height=&quot;1200&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;TiKV Engine SIG æˆç«‹ï¼Œç¡¬æ ¸ç©å®¶ä»¬çœ‹è¿‡æ¥ï¼ | PingCAP&lt;/a&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>ZoeyZhai</author>
<guid isPermaLink="false">2019-11-28-94184098</guid>
<pubDate>Thu, 28 Nov 2019 00:00:00 +0800</pubDate>
</item>
<item>
<title>å¼€æºç¤¾åŒºæ€ä¹ˆç©ï¼Ÿæ˜æ˜Ÿé¡¹ç›® TiKV çš„ Maintainer è¿™æ ·è¯´â€¦â€¦</title>
<link>https://henix.github.io/feeds/zhuanlan.newsql/2019-11-28-94183475.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/94183475&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-be999aa922899cf3aec5c6803b249563_b.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;çŸ¥ä¹æŠ€æœ¯å¹³å°å›¢é˜Ÿè´Ÿè´£äººå­™æ™“å…‰æœ‰ä¸€ä¸ªæ–°çš„èº«ä»½ï¼šå¼€æºåˆ†å¸ƒå¼äº‹åŠ¡ Key-Value æ•°æ®åº“ TiKVé¡¹ç›®çš„ Maintainerã€‚Maintainer æ˜¯ TiDB/TiKV å¼€æºç¤¾åŒºçš„è§’è‰²ä¹‹ä¸€ï¼Œæ˜¯ç¤¾åŒºä¸­è¾ƒé«˜çº§åˆ«çš„ä»£ç è´¡çŒ®è€…ï¼Œé¡¹ç›®çš„è§„åˆ’å’Œè®¾è®¡è€…ï¼Œæ‹¥æœ‰åˆå¹¶ä¸»å¹²åˆ†æ”¯çš„æƒé™ã€‚ä¸€èˆ¬æ¥è¯´ä»å¼€å§‹è´¡çŒ®ä»£ç çš„ Contributor æˆé•¿ä¸º Maintainerï¼Œæœ€æ˜æ˜¾çš„å˜åŒ–æ˜¯ï¼Œå¯¹é¡¹ç›®æœ‰æ›´å…¨å±€ã€æ·±å…¥çš„äº†è§£ï¼Œå¯¹é¡¹ç›®æœªæ¥çš„å‘å±•ä¹Ÿæœ‰ç‹¬åˆ°ã€å‡†ç¡®çš„è§è§£ã€‚&lt;/p&gt;&lt;p&gt;å­™æ™“å…‰è§‰å¾—ï¼Œå…¶å®ä» Contributor åˆ° Committer å†åˆ°æœ€åæˆä¸º Maintainer è¿™ä¸ªè¿‡ç¨‹ï¼Œæœ€å¤§çš„æ„Ÿå—æ˜¯è‡ªå·±é€æ¸èå…¥åˆ°äº† TiKV ç¤¾åŒºä¸­ï¼ŒçœŸæ­£æœ‰äº†å½’å±æ„Ÿã€‚ä»Šå¤©æˆ‘ä»¬å°±å¸¦ç€ TiDB/TiKV ç¤¾åŒºä¼™ä¼´ä»¬çš„æœŸå¾…ï¼Œå’Œå­™æ™“å…‰èŠäº†èŠï¼Œæ‰“æ¢äº†ä¸€ä¸‹ä»–æˆä¸º Maintainer çš„ç»å†ï¼Œä»¥åŠå¯¹ TiKV ç¤¾åŒºæœªæ¥çš„æƒ³æ³•ã€‚&lt;/p&gt;&lt;h2&gt;åˆè¯†ï¼šå¯»æ‰¾åŸç”Ÿçš„åˆ†å¸ƒå¼å­˜å‚¨æ–¹æ¡ˆ&lt;/h2&gt;&lt;p&gt;&lt;b&gt;&lt;i&gt;&amp;gt; ä¸ TiKV é¡¹ç›®åˆè¯†ï¼Œå…¶å®æ˜¯å¸¦ç€æ˜ç¡®çš„ç›®æ ‡çš„ã€‚&lt;/i&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&gt;å­™æ™“å…‰ 2007 å¹´æ¯•ä¸šå›å›½ï¼Œå½“æ—¶å›½å†…åˆšå¼€å§‹åšäº‘ï¼Œä»–è¿›å…¥ä¸€å®¶åšç§æœ‰äº‘çš„å…¬å¸ï¼Œä»äº‹ç§æœ‰äº‘ç›¸å…³äº§å“å¼€å‘å·¥ä½œ 7 å¹´å¤šæ—¶é—´ï¼Œä»–å¦è¨€ï¼Œè¿™æ®µå·¥ä½œç»å†è®©ä»–ä¸ªäººç§¯ç´¯äº†è®¸å¤šäº‘ç›¸å…³åº•å±‚ç³»ç»Ÿçš„å·¥ä½œç»éªŒï¼Œè¿™ä¹Ÿæ˜¯ä»–å¯¹å¹³å°ç±»æŠ€æœ¯æ¯”è¾ƒæ„Ÿå…´è¶£çš„æ ¸å¿ƒåŸå› ã€‚2017 å¹´å­™æ™“å…‰åŠ å…¥çŸ¥ä¹ã€‚ åˆšåˆ°çŸ¥ä¹æ—¶ï¼Œä»–è´Ÿè´£å·²è¯»æœåŠ¡çš„å¼€å‘ï¼ŒçŸ¥ä¹çš„å­˜å‚¨å±‚é‡‡ç”¨çš„è¿˜æ˜¯ MySQL åˆ†åº“åˆ†è¡¨æŠ€æœ¯æ–¹æ¡ˆã€‚â€œé¡¹ç›®ä¸Šçº¿åï¼Œå°±æˆ‘ä¸ªäººè€Œè¨€æ˜¯éš¾ä»¥æ¥å—è¿™ç§æ–¹æ¡ˆçš„ï¼Œäºæ˜¯æˆ‘å°±å¼€å§‹å¯»æ‰¾åŸç”Ÿçš„åˆ†å¸ƒå¼å­˜å‚¨ç³»ç»Ÿæ¥æ›¿ä»£å®ƒã€‚å€Ÿæ­¤æœºä¼šæˆ‘å°è¯•äº† TiKVï¼Œåœ¨æµ‹è¯•çš„è¿‡ç¨‹ä¸­æˆ‘å‘ç°ä¸€äº›æ€§èƒ½æœ‰æ”¹å–„çš„ç©ºé—´ï¼Œäºæ˜¯æˆ‘å°±è¾¹æµ‹è¯•è¾¹ä¸Šæ‰‹åšäº†ä¸€äº›ä¼˜åŒ–å·¥ä½œï¼Œæœ€åæäº†ä¸€ä¸ªå¤§ PR ä¸Šå»ã€‚PR æå‡ºåï¼ŒPingCAP é¦–å¸­æ¶æ„å¸ˆå”åˆ˜å¾ˆå¿«å°±è·Ÿæˆ‘å»ºç«‹äº†è”ç³»ï¼Œæ…¢æ…¢çš„æˆ‘ä¹Ÿè¿›å…¥åˆ°äº† TiKV ç¤¾åŒºå½“ä¸­ã€‚è¿™å°±æ˜¯æˆ‘ç¬¬ä¸€æ¬¡æ¥è§¦ TiKV çš„ç»å†ã€‚â€&lt;/p&gt;&lt;h2&gt;æ›´åŠ ç†è§£ã€Œå¼€æºç¤¾åŒºã€&lt;/h2&gt;&lt;p&gt;&lt;b&gt;&lt;i&gt;&amp;gt; æˆ‘å¯¹å¼€æºç¤¾åŒºçš„ç†è§£æ›´åŠ æ¸…æ™°äº†ã€‚&lt;/i&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&gt;å­™æ™“å…‰ä»¥å‰ä¹Ÿç”¨è¿‡å¾ˆå¤šå¼€æºè½¯ä»¶ï¼Œä½†æ˜¯å½“æ—¶å¹¶æ²¡æœ‰æ·±åˆ»ç†è§£å¼€æºçš„ä»·å€¼ã€‚&lt;b&gt;å¼€æºçš„ç¬¬ä¸€ç›®æ ‡åº”è¯¥æ˜¯å¯¹åˆ«äººæœ‰å¸®åŠ©ã€æœ‰ä»·å€¼ï¼Œè¿™ä¸ªç›®æ ‡å°±å·²ç»æ‹¦ä½äº†æ— æ•°çš„å¼€æºé¡¹ç›®&lt;/b&gt;ã€‚å¾ˆå¤šé¡¹ç›®ä»…ä»…æŠŠä»£ç å¼€æ”¾å‡ºæ¥ï¼Œä½†æ˜¯æ²¡æœ‰ä»»ä½•åç»­çš„æ”¯æŒä¸ç»´æŠ¤ï¼Œåœ¨è¿™æ ·çš„æƒ…å†µä¸‹ç¤¾åŒºæ˜¯æ— æ³•å‘å±•çš„ï¼Œè‡ªç„¶ä¹Ÿéš¾ä»¥ä¸ºä»–äººåˆ›é€ ä»·å€¼ã€‚&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-bb8946a93828be2e05abb5e766daeb67_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1557&quot; data-rawheight=&quot;903&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;1557&quot; data-original=&quot;https://pic4.zhimg.com/v2-bb8946a93828be2e05abb5e766daeb67_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-bb8946a93828be2e05abb5e766daeb67_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1557&quot; data-rawheight=&quot;903&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;1557&quot; data-original=&quot;https://pic4.zhimg.com/v2-bb8946a93828be2e05abb5e766daeb67_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-bb8946a93828be2e05abb5e766daeb67_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;â€œ&lt;b&gt;å…¶å®å½“ä½ æŒç»­çš„è®¤çœŸæŠ•å…¥åˆ°å¼€æºåï¼Œé¡¹ç›®å’Œç¤¾åŒºå°±ä¼šäº§ç”ŸåŒå‘çš„äº¤æµï¼Œä¸å†åªæ˜¯ä½ å•å‘çš„æŠ•å…¥ï¼Œç¤¾åŒºä¹Ÿä¼šç»™äºˆä½ åå“ºï¼Œè¿™æ—¶å°±ä¼šå½¢æˆæ­£å‘å¾ªç¯ï¼Œå¯¹é¡¹ç›®å‘å±•ä¼šèµ·åˆ°éå¸¸å¤§çš„æ¨åŠ¨ä½œç”¨&lt;/b&gt;ã€‚æˆ‘å¯¹å¼€æºçš„ç†è§£æ­£æ˜¯åœ¨ TiKV ç¤¾åŒºæ…¢æ…¢å»ºç«‹èµ·æ¥çš„ï¼ŒTiKV æœ‰ä¸€ä¸ªéå¸¸å¼€æ”¾å‹å¥½çš„ç¤¾åŒºï¼ŒPingCAP å’Œç¤¾åŒºä¼™ä¼´ä»¬çƒ­å¿ƒçš„å¸®åŠ©åŠé¼“åŠ±è®©æˆ‘åˆ‡èº«æ„Ÿå—åˆ°æ´»è·ƒçš„å¼€æºç¤¾åŒºæ‰€å…·æœ‰çš„ç‹¬ç‰¹é­…åŠ›ã€‚åœ¨å‚ä¸å…±å»ºç¤¾åŒºçš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä¸ä½†å­¦ä¹ åˆ°äº†å¦‚ä½•åŒå¼€æºç¤¾åŒºä¸­ä¼—å¤šä¼˜ç§€çš„è´¡çŒ®è€…æ›´åŠ é«˜æ•ˆçš„äº¤æµï¼ŒåŒæ—¶ä¹Ÿå¯¹å¼€æºçš„ä»·å€¼ç†å¿µå’Œå¼€æºåœ¨åŸºç¡€è½¯ä»¶é¢†åŸŸçš„é‡å¤§æ„ä¹‰æœ‰äº†æ›´åŠ æ·±å…¥çš„ç†è§£ã€‚â€&lt;/p&gt;&lt;h2&gt;ã€ŒæŒç»­è´¡çŒ®ï¼Œé•¿æœŸæ´»è·ƒã€çš„åŠ¨åŠ›ä½•åœ¨ï¼Ÿ&lt;/h2&gt;&lt;p&gt;&lt;b&gt;&lt;i&gt;&amp;gt; ç¡¬æ ¸çš„é¡¹ç›® + å¼€æ”¾çš„æ°›å›´&lt;/i&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&gt;è¿‡å»å¤šå¹´åœ¨äº‘æ–¹å‘çš„å·¥ä½œç»å†è®©å­™æ™“å…‰åšå®šçš„ç›¸ä¿¡ï¼Œäº‘æ˜¯æœªæ¥çš„è¶‹åŠ¿ï¼Œè€Œ TiKV ä½œä¸ºäº‘åŸç”Ÿæ¶æ„ä¸­æ‰¿è½½çŠ¶æ€çš„åŸºçŸ³ç»„ä»¶ï¼Œå®ƒçš„é‡è¦ç¨‹åº¦æ¯‹åº¸ç½®ç–‘ã€‚ä½œä¸ºä¸€ä¸ªæŠ€æœ¯æ§ï¼ŒTiKV è¿™æ ·ä¸€ä¸ªæ—¢ç¡¬æ ¸å£ç¢‘åˆå¾ˆå¥½çš„é¡¹ç›®å¾ˆè‡ªç„¶åœ°å¸å¼•ç€ä»–ã€‚åŒæ—¶ TiKV ç¤¾åŒºäº’å¸®äº’åŠ©ã€å¼€æ”¾å…±èµ¢çš„è‰¯å¥½æ°›å›´ä¹Ÿæ˜¯å­™æ™“å…‰æŒç»­å‚ä¸ç¤¾åŒºå»ºè®¾çš„é‡è¦åŠ¨åŠ›ã€‚&lt;/p&gt;&lt;p&gt;â€œä¹‹å‰ä¹Ÿä¸ºå…¶ä»–å¼€æºé¡¹ç›®åšè¿‡è´¡çŒ®ï¼Œå¯èƒ½æ˜¯è¿™äº›é¡¹ç›®å¯¹ç¤¾åŒºå»ºè®¾å¹¶æ²¡æœ‰æŠ•å…¥å¤ªå¤šç²¾åŠ›ï¼Œå¤§éƒ¨åˆ†çš„ PR åˆå¹¶å®Œæˆå°±æ²¡æœ‰åç»­äº†ã€‚ä½†æ˜¯åœ¨ TiKV ç¤¾åŒºï¼Œæˆ‘æ„Ÿå—åˆ°å½“æˆ‘å‚ä¸ç¤¾åŒºåï¼Œåç»­ä¼šæœ‰å¾ˆå¤šè¿½è¸ªçš„åŠ¨ä½œï¼Œè¿™ä¼šæ¿€åŠ±æˆ‘ä¿æŒå…´è¶£ï¼ŒæŒç»­åœ¨ç¤¾åŒºä¸­å»åšè´¡çŒ®ã€‚åŒæ—¶åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä¹Ÿåœ¨ç¤¾åŒºä¸­å­¦ä¹ äº†å¾ˆå¤šçŸ¥è¯†ï¼Œå¾—åˆ°äº†å¾ˆå¤šå¸®åŠ©ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘é•¿æœŸåšæŒåœ¨ TiKV ç¤¾åŒºä¸­ä¿æŒæ´»è·ƒçš„ä¸€ä¸ªé‡è¦åŸå› ã€‚â€&lt;/p&gt;&lt;p&gt;è¿„ä»Šä¸ºæ­¢ï¼Œå­™æ™“å…‰å·²ç»ä¸º TiDB/TiKV é¡¹ç›®è´¡çŒ®äº† 18 ä¸ª PRï¼Œ&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pingcap.com/blog-cn/zhihu-the-story-of-contributing-to-tidb-community/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;æ¨åŠ¨äº† TiKV é‡è¦åŠŸèƒ½ Follower Read çš„å¼€å‘å’Œè½åœ°&lt;/a&gt;ï¼Œè¿™ä¸ªåŠŸèƒ½åŒæ—¶ä¹Ÿè§£å†³äº†çŸ¥ä¹ä¸šåŠ¡åœºæ™¯ä¸­æç«¯çƒ­ç‚¹æ•°æ®è®¿é—®çš„ååé—®é¢˜ã€‚ä»–åœ¨ä¸€å¹´ä¸­å®Œæˆäº† Contributor -&amp;gt; Committer -&amp;gt; Maitainer çš„è§’è‰²å‡çº§ï¼Œå¯è°“æ˜¯å¼€æŒ‚å¼çš„é€Ÿåº¦ï¼Œä½†ä»–å¹¶æ²¡æœ‰å°±æ­¤æ­¢æ­¥ï¼Œè€Œæ˜¯å¼€å¯äº†ä¸€ä¸ªæ–°çš„æŒ‘æˆ˜ã€‚&lt;/p&gt;&lt;h2&gt;æ–°çš„æŒ‘æˆ˜&lt;/h2&gt;&lt;p&gt;ä»Šå¤© TiKV Engine SIGï¼ˆSIG = Special Interest Groupï¼‰æ­£å¼æˆç«‹ï¼Œè¿™æ˜¯ TiKV é¡¹ç›®æˆç«‹çš„ç¬¬äºŒä¸ª SIG ç¤¾åŒºç»„ç»‡ï¼Œå­™æ™“å…‰å°†ä½œä¸ºç¬¬ä¸€ä¸ªé PingCAP çš„ SIG TechLeadï¼Œå°†ä¸å…¶ä»– TechLead ä¸€èµ·ï¼Œç»„ç»‡å¤§å®¶æ¨åŠ¨ TiKV Engine çš„ç›¸å…³å¼€å‘å’Œå®Œå–„ã€‚&lt;/p&gt;&lt;p&gt;å¯¹äº TiKV Engine SIGï¼Œå­™æ™“å…‰éå¸¸å…´å¥‹ã€‚&lt;/p&gt;&lt;p&gt;â€œæˆ‘è®¤ä¸º TiKV éå¸¸é€‚åˆ SIG è¿™ä¸ªæ¨¡å¼ï¼Œå› ä¸º TiKV æ˜¯ä¸€ä¸ªéå¸¸åºå¤§ä¸”å¤æ‚çš„ç³»ç»Ÿï¼Œè¿›å…¥çš„é—¨æ§›å¾ˆé«˜ï¼Œå¹¶ä¸”å®ƒè¿˜åœ¨ä»¥é£å¿«çš„é€Ÿåº¦ç»§ç»­æ¼”è¿›ç€ã€‚åœ¨è¿™æ ·ä¸€ä¸ªåºå¤§çš„ç³»ç»Ÿé‡Œï¼Œæƒ³è®©å¤§å®¶å‚ä¸è¿›æ¥å…¶å®æ˜¯éå¸¸æœ‰éš¾åº¦çš„ã€‚&lt;b&gt;ä½† SIG å¯ä»¥ä¸ºå¤§å®¶åˆ›é€ ä¸€ä¸ªæ›´å®¹æ˜“å‚ä¸çš„å°ç¯å¢ƒï¼Œä¸”åœ¨è¿™ä¸ªå°ç¯å¢ƒä¸­æ˜¯æœ‰ç»„ç»‡æœ‰é¢†å¯¼çš„ï¼Œæœ‰äººä¼šå¸®åŠ©å¤§å®¶æŒ‡æ–¹å‘ï¼ŒæŒ‡å¯¼å¤§å®¶è¦åšä»€ä¹ˆæ ·çš„äº‹æƒ…ï¼Œè¿™æ ·ä¸€æ–¹é¢é™ä½ç¤¾åŒºå‚ä¸ TiKV å»ºè®¾çš„é—¨æ§›ï¼Œå¦å¤–ä¸€æ–¹é¢ä¹Ÿå¯ä»¥æ›´å¥½çš„å°†å¯¹ç‰¹å®šé¢†åŸŸæœ‰ç»éªŒä¸”æ„Ÿå…´è¶£çš„ä¼™ä¼´ä»¬èšé›†èµ·æ¥ï¼Œé«˜æ•ˆçš„æ¨è¿› TiKV æ¯ä¸€ä¸ªå…³é”®æ–¹å‘çš„å‰è¿›é€Ÿåº¦ã€‚&lt;/b&gt;&lt;/p&gt;&lt;p&gt;åœ¨æˆ‘ä¸ªäººçœ‹æ¥ï¼Œå­˜å‚¨å¼•æ“æ˜¯ TiKV ä¸­æœ€å…³é”®çš„ç»„ä»¶ä¹‹ä¸€ï¼Œå®ƒå½±å“ç€æ•´ä¸ªç³»ç»Ÿçš„ç¨³å®šæ€§ã€åŠŸèƒ½ç‰¹æ€§ä»¥åŠæ€§èƒ½è¡¨ç°ã€‚ç›¸ä¿¡ Engine SIG æˆç«‹åï¼Œæˆ‘ä»¬å¯ä»¥æ¸…æ™°çš„å®šä¹‰å­˜å‚¨å¼•æ“åŒ TiKV å…¶å®ƒéƒ¨åˆ†çš„å¥‘çº¦ï¼Œæä¾›å¼ºå¤§ä¸”æ˜“ç”¨çš„å­˜å‚¨å¼•æ“æŠ½è±¡ï¼Œå€ŸåŠ© TiKV å®Œå¤‡çš„åˆ†å¸ƒå¼èƒ½åŠ›ï¼Œæˆ‘ä»¬å¯ä»¥ä¸º TiKV æ‹“å±•æ›´å¤šçš„é¢†åŸŸå’Œå¯èƒ½ã€‚â€&lt;/p&gt;&lt;p&gt;TiKV Engine SIG æ˜¯ä¸»è¦èŒè´£æ˜¯å¯¹ TiKV çš„å­˜å‚¨å¼•æ“çš„æœªæ¥å‘å±•è¿›è¡Œè®¨è®ºå’Œè§„åˆ’ï¼Œå¹¶è¿›è¡Œç›¸å…³å¼€å‘å’Œç»´æŠ¤ã€‚ç›®å‰ TiKV ä»…æ”¯æŒé»˜è®¤å­˜å‚¨å¼•æ“ RocksDBï¼Œä½†æ˜¯é€šè¿‡æ‰©å±•æ¥å£ï¼Œå¸Œæœ›æœªæ¥ TiKV å¯ä»¥æ”¯æŒæ›´å¤šçš„å­˜å‚¨å¼•æ“ã€‚è¿‘æœŸ Engine SIG çš„å·¥ä½œä¼šå›´ç»•åœ¨å¯¹ TiKV å·²æœ‰å­˜å‚¨å¼•æ“çš„æ”¹è¿›ä¸Šé¢ã€‚&lt;/p&gt;&lt;blockquote&gt;&lt;i&gt;å…³äº TiKV Engine SIG çš„æ›´å¤šä¿¡æ¯ï¼Œæ„Ÿå…´è¶£çš„æœ‹å‹ä»¬å¯ä»¥æŸ¥çœ‹&lt;/i&gt; &lt;i&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pingcap.com/blog-cn/tikv-engine-sig-introduction&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;è¿™ç¯‡æ–‡ç« &lt;/a&gt;ï¼Œä¹Ÿå¯ä»¥åŠ å…¥ Slack&lt;/i&gt; &lt;i&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//tikv-wg.slack.com/%3Fredir%3D%252Fmessages%252Fengine-sig&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;#engine-sig&lt;/a&gt;&lt;/i&gt; &lt;i&gt;å’Œå­™æ™“å…‰ç­‰ç¤¾åŒºä¼™ä¼´ä»¬ä¸€èµ·è®¨è®ºã€‚&lt;/i&gt;&lt;/blockquote&gt;&lt;h2&gt;æœŸæœ›&lt;/h2&gt;&lt;p&gt;ä½œä¸º TiKV &amp;amp; TiDB é‡åº¦ç²‰ä¸ï¼Œå­™æ™“å…‰å¸Œæœ›åœ¨æœªæ¥èƒ½æ›´å¥½çš„ä¿ƒè¿›ã€ŒçŸ¥ä¹ã€å’Œ TiKV ç¤¾åŒºçš„å…±å»ºã€‚ä¸€æ–¹é¢ä¾æ‰˜ TiKV ç¤¾åŒºçš„è¿›æ­¥ä¸ºã€ŒçŸ¥ä¹ã€çš„ä¸šåŠ¡å‘å±•æä¾›æ›´å¥½çš„æ”¯æ’‘åŸºç¡€ï¼ŒåŒæ—¶å¸Œæœ›èƒ½å¤ŸåŸºäºã€ŒçŸ¥ä¹ã€çš„ä¸šåŠ¡åœºæ™¯ä¸º TiKV çš„å‘å±•æä¾›è¶³å¤Ÿå¤§çš„æ–½å±•ç©ºé—´ã€‚&lt;/p&gt;&lt;p&gt;â€œæˆ‘éå¸¸å¸Œæœ›æˆ‘ä»¬çš„å›¢é˜Ÿä¹Ÿèƒ½å¤ŸçœŸæ­£å‚ä¸è¿›æ¥ï¼Œæˆä¸ºç¤¾åŒºçš„è´¡çŒ®è€…ã€‚ç›¸ä¿¡æœªæ¥ TiKV èƒ½å¤Ÿä¿æŒå¼€æ”¾å…±èµ¢çš„é£æ ¼ï¼Œå»ºè®¾æ›´æˆç†Ÿæ›´å¤§è§„æ¨¡çš„ç¤¾åŒºã€‚æˆ‘ä»¬è¿™äº›ç¤¾åŒºä¼™ä¼´ä¼šä¸€èµ·æ¨åŠ¨ TiKV çš„é«˜é€ŸæŒç»­å‘å±•ï¼Œè®© TiKV æˆä¸ºæœªæ¥æœ‰çŠ¶æ€ç³»ç»ŸåŸºçŸ³çš„ç¬¬ä¸€é€‰æ‹©ã€‚â€&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-6da2dca1411907ffbbfc81d9a9724a30_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;2866&quot; data-rawheight=&quot;1270&quot; class=&quot;origin_image zh-lightbox-thumb&quot; width=&quot;2866&quot; data-original=&quot;https://pic1.zhimg.com/v2-6da2dca1411907ffbbfc81d9a9724a30_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-6da2dca1411907ffbbfc81d9a9724a30_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;2866&quot; data-rawheight=&quot;1270&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; width=&quot;2866&quot; data-original=&quot;https://pic1.zhimg.com/v2-6da2dca1411907ffbbfc81d9a9724a30_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-6da2dca1411907ffbbfc81d9a9724a30_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;blockquote&gt;TiKV æ˜¯ä¸€ä¸ªå¼€æºçš„åˆ†å¸ƒå¼äº‹åŠ¡ Key-Value æ•°æ®åº“ï¼Œæ”¯æŒè·¨è¡Œ ACID äº‹åŠ¡ï¼ŒåŒæ—¶å®ç°äº†è‡ªåŠ¨æ°´å¹³ä¼¸ç¼©ã€æ•°æ®å¼ºä¸€è‡´æ€§ã€è·¨æ•°æ®ä¸­å¿ƒé«˜å¯ç”¨å’Œäº‘åŸç”Ÿç­‰é‡è¦ç‰¹æ€§ã€‚ä½œä¸ºä¸€ä¸ªåŸºç¡€ç»„ä»¶ï¼ŒTiKV å¯ä½œä¸ºæ„å»ºå…¶å®ƒç³»ç»Ÿçš„åŸºçŸ³ã€‚ç›®å‰ï¼ŒTiKV å·²ç”¨äºæ”¯æŒåˆ†å¸ƒå¼ HTAP æ•°æ®åº“â€”â€” TiDB ä¸­ï¼Œè´Ÿè´£å­˜å‚¨æ•°æ®ï¼Œå¹¶å·²è¢«å¤šä¸ªè¡Œä¸šçš„é¢†å…ˆä¼ä¸šåº”ç”¨åœ¨å®é™…ç”Ÿäº§ç¯å¢ƒã€‚2019 å¹´ 5 æœˆï¼ŒCNCF çš„ TOCï¼ˆæŠ€æœ¯ç›‘ç£å§”å‘˜ä¼šï¼‰æŠ•ç¥¨å†³å®šæ¥å— TiKV æ™‹çº§ä¸ºå­µåŒ–é¡¹ç›®ã€‚&lt;br/&gt;æºç åœ°å€ï¼š&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/tikv/tikv&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;github.com/tikv/tikv&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;br/&gt;æ›´å¤šä¿¡æ¯ï¼š&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//tikv.org/&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;https://tikv.org&lt;/a&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;b&gt;åŸæ–‡é˜…è¯»ï¼š&lt;/b&gt;&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//pingcap.com/blog-cn/tikv-maintainer-sunxiaoguang/&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot; data-image=&quot;https://pic2.zhimg.com/v2-60ab5bd867c2434d70c957a02a2169e1_ipico.jpg&quot; data-image-width=&quot;1200&quot; data-image-height=&quot;1200&quot; class=&quot; wrap external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;å¼€æºç¤¾åŒºæ€ä¹ˆç©ï¼Ÿæ˜æ˜Ÿé¡¹ç›® TiKV çš„ Maintainer è¿™æ ·è¯´â€¦â€¦ | PingCAP&lt;/a&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>ZoeyZhai</author>
<guid isPermaLink="false">2019-11-28-94183475</guid>
<pubDate>Thu, 28 Nov 2019 00:00:00 +0800</pubDate>
</item>
</channel>
</rss>
