<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>【量化课堂】数学规划简介</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/23551893">原文</a></p>
<div class="title-image"><img src="https://pic4.zhimg.com/v2-2b88f9140f964e6cb7f33a38e859b28f_b.jpg" alt=""></div><b>导语</b>：在一定的资源和条件限制下，将某一个目标最大化或最小化，这就是数学规划问题。<h4>前言</h4><p><em>数学规划(mathematical programming)</em>，也称<em>数学优化(mathematical optimization)</em>，是数学中的一个分支，它主要研究的目标在给定的区域中寻找可以最小化或最大化某一函数的最优解。数学规划在几乎所有的科学领域都有着不容忽视的应用，所以一直都是一门受到着重关注和研究的学科。本文是对数学规划问题的一个浅显的介绍，不涉及任何理论和算法。<br/></p><h4>数学规划</h4><p>一个数学规划问题一般具有以下形式</p><p><figure><noscript><img src="https://pic2.zhimg.com/v2-1d7b3a61a68b4bcfbf02c8f79f242e75_b.png" data-rawwidth="402" data-rawheight="120" class="content_image" width="402"/></noscript><img src="https://pic2.zhimg.com/v2-1d7b3a61a68b4bcfbf02c8f79f242e75_b.png" data-rawwidth="402" data-rawheight="120" class="content_image lazy" width="402" data-actualsrc="https://pic2.zhimg.com/v2-1d7b3a61a68b4bcfbf02c8f79f242e75_b.png"/></figure>在这里面，函数 f:<img src="https://www.zhihu.com/equation?tex=R%5E%7Bn%7D+" alt="R^{n} " eeimg="1"/>→R，ci:<img src="https://www.zhihu.com/equation?tex=R%5E%7Bn%7D+" alt="R^{n} " eeimg="1"/>→R，bi∈R。函数 f 是我们想最小化的目标函数(objective function)；而函数 ci 和常量 bi 则对可行集构成一些限制，不等式 ci(x)≤bi 叫做一个约束(constraint)，所有满足这些约束的点的集合<br/></p><p><figure><noscript><img src="https://pic2.zhimg.com/v2-b270c62e90f3b58dcb7ac8bff0981a51_b.png" data-rawwidth="491" data-rawheight="55" class="origin_image zh-lightbox-thumb" width="491" data-original="https://pic2.zhimg.com/v2-b270c62e90f3b58dcb7ac8bff0981a51_r.jpg"/></noscript><img src="https://pic2.zhimg.com/v2-b270c62e90f3b58dcb7ac8bff0981a51_b.png" data-rawwidth="491" data-rawheight="55" class="origin_image zh-lightbox-thumb lazy" width="491" data-original="https://pic2.zhimg.com/v2-b270c62e90f3b58dcb7ac8bff0981a51_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-b270c62e90f3b58dcb7ac8bff0981a51_b.png"/></figure>被称作这个问题的<em>可行区域(fesaible region)</em>。</p><p>我们看一下实际应用中的问题是如何以数学规划的方式表达。假设呢，现在我们有两种金融资产可以进行选择，第一个资产平均每年有 10% 的收益，但是在最坏情况下可能损失 20%；第二个资产每年平均有 5% 的收益，但最大损失也不会超过 5%。方便起见，假设这两个资产是可以无限拆分的，也就是说我们可以买 1/2 个或者 <img src="https://www.zhihu.com/equation?tex=e%5E%7B%5Cpi+%7D+%2F%281%2B%5Csqrt%7B5%7D+%29" alt="e^{\pi } /(1+\sqrt{5} )" eeimg="1"/>个。现在假设我们有本金 100，可以投资于这两个资产；我们希望在最坏的情况下损失不超过本金的 10%，也就是 10，目标嘛，当然是要最大化预期收益率。</p><p>好哟。首先确定我们的问题，是这两种资产要各配置多少钱。那么，这个问题所在的空间是 R2，对于里面的一个向量 x，坐标 x1 和 x2分别是两种资产购买的净值。其次，我们想最大化的是预期收益，也就是</p><p><figure><noscript><img src="https://pic4.zhimg.com/v2-75b35b4510e7e227cad960c82eb45bc7_b.png" data-rawwidth="338" data-rawheight="49" class="content_image" width="338"/></noscript><img src="https://pic4.zhimg.com/v2-75b35b4510e7e227cad960c82eb45bc7_b.png" data-rawwidth="338" data-rawheight="49" class="content_image lazy" width="338" data-actualsrc="https://pic4.zhimg.com/v2-75b35b4510e7e227cad960c82eb45bc7_b.png"/></figure>有两个要求。第一个是购买的资产总值不可以超过起始资金 100。让 c1 代表两种资产价值总和的函数，b1 代表总值产 100，有<br/></p><p><figure><noscript><img src="https://pic3.zhimg.com/v2-c6f86159a63199b99d6687635c8fa03e_b.png" data-rawwidth="396" data-rawheight="54" class="content_image" width="396"/></noscript><img src="https://pic3.zhimg.com/v2-c6f86159a63199b99d6687635c8fa03e_b.png" data-rawwidth="396" data-rawheight="54" class="content_image lazy" width="396" data-actualsrc="https://pic3.zhimg.com/v2-c6f86159a63199b99d6687635c8fa03e_b.png"/></figure>还有呢，最坏情况下损失不可以超过 10，那么设 c2 为最大损失的函数，设 b2 等于 10，有<br/></p><p><figure><noscript><img src="https://pic4.zhimg.com/v2-4836fa4db77351b685a35fc7e51df687_b.png" data-rawwidth="463" data-rawheight="42" class="origin_image zh-lightbox-thumb" width="463" data-original="https://pic4.zhimg.com/v2-4836fa4db77351b685a35fc7e51df687_r.jpg"/></noscript><img src="https://pic4.zhimg.com/v2-4836fa4db77351b685a35fc7e51df687_b.png" data-rawwidth="463" data-rawheight="42" class="origin_image zh-lightbox-thumb lazy" width="463" data-original="https://pic4.zhimg.com/v2-4836fa4db77351b685a35fc7e51df687_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-4836fa4db77351b685a35fc7e51df687_b.png"/></figure>好，新鲜的规划问题就出炉了：<figure><noscript><img src="https://pic1.zhimg.com/v2-fad078c1b71bf602d1179c50db582ffc_b.png" data-rawwidth="374" data-rawheight="117" class="content_image" width="374"/></noscript><img src="https://pic1.zhimg.com/v2-fad078c1b71bf602d1179c50db582ffc_b.png" data-rawwidth="374" data-rawheight="117" class="content_image lazy" width="374" data-actualsrc="https://pic1.zhimg.com/v2-fad078c1b71bf602d1179c50db582ffc_b.png"/></figure>当然，也可以写成矩阵的形式<br/></p><figure><noscript><img src="https://pic2.zhimg.com/v2-b4d271bc9520b825ad5eedcf7e6d6f99_b.png" data-rawwidth="456" data-rawheight="154" class="origin_image zh-lightbox-thumb" width="456" data-original="https://pic2.zhimg.com/v2-b4d271bc9520b825ad5eedcf7e6d6f99_r.jpg"/></noscript><img src="https://pic2.zhimg.com/v2-b4d271bc9520b825ad5eedcf7e6d6f99_b.png" data-rawwidth="456" data-rawheight="154" class="origin_image zh-lightbox-thumb lazy" width="456" data-original="https://pic2.zhimg.com/v2-b4d271bc9520b825ad5eedcf7e6d6f99_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-b4d271bc9520b825ad5eedcf7e6d6f99_b.png"/></figure><h4>格式上的细节</h4><p>你说，啊，教程里都是骗人的。说好了的最小化 f(x)，为什么上面的问题是最大化呢？</p><p>---不，我才不会骗小孩。</p><p>上面的问题是可以转换成最小化问题的，只需要在目标函数前加上一个负号，最大化 f(x) 和最小化 −f(x) 是等同的，如果 (x1∗,x2∗) 是 −f 的最小解，那么它也必定是 f 的最大解。</p><p>同理的，如果有大于号的限制</p><p><figure><noscript><img src="https://pic3.zhimg.com/v2-e3684091b17468c6a9359e4080110fd6_b.png" data-rawwidth="136" data-rawheight="47" class="content_image" width="136"/></noscript><img src="https://pic3.zhimg.com/v2-e3684091b17468c6a9359e4080110fd6_b.png" data-rawwidth="136" data-rawheight="47" class="content_image lazy" width="136" data-actualsrc="https://pic3.zhimg.com/v2-e3684091b17468c6a9359e4080110fd6_b.png"/></figure>加上负号就可以转换为等同的小于号限制<br/></p><p><figure><noscript><img src="https://pic1.zhimg.com/v2-ecf4bf269939d787bd0f578414a2e020_b.png" data-rawwidth="189" data-rawheight="50" class="content_image" width="189"/></noscript><img src="https://pic1.zhimg.com/v2-ecf4bf269939d787bd0f578414a2e020_b.png" data-rawwidth="189" data-rawheight="50" class="content_image lazy" width="189" data-actualsrc="https://pic1.zhimg.com/v2-ecf4bf269939d787bd0f578414a2e020_b.png"/></figure>另外，如果我们需要等于号的限制<br/></p><p><figure><noscript><img src="https://pic3.zhimg.com/v2-0325b944d4d6804f2b204ad7a5e174a6_b.png" data-rawwidth="139" data-rawheight="49" class="content_image" width="139"/></noscript><img src="https://pic3.zhimg.com/v2-0325b944d4d6804f2b204ad7a5e174a6_b.png" data-rawwidth="139" data-rawheight="49" class="content_image lazy" width="139" data-actualsrc="https://pic3.zhimg.com/v2-0325b944d4d6804f2b204ad7a5e174a6_b.png"/></figure>也可以将它转换为一个大于一个小于两个限制的交集<br/></p><p><figure><noscript><img src="https://pic2.zhimg.com/v2-93a24e6db5d29134ca82f212c765879d_b.png" data-rawwidth="174" data-rawheight="95" class="content_image" width="174"/></noscript><img src="https://pic2.zhimg.com/v2-93a24e6db5d29134ca82f212c765879d_b.png" data-rawwidth="174" data-rawheight="95" class="content_image lazy" width="174" data-actualsrc="https://pic2.zhimg.com/v2-93a24e6db5d29134ca82f212c765879d_b.png"/></figure>第二个大于有可以转变成小于<br/></p><p><figure><noscript><img src="https://pic3.zhimg.com/v2-29c378b570eb05b1d66be2c40e22828a_b.png" data-rawwidth="184" data-rawheight="88" class="content_image" width="184"/></noscript><img src="https://pic3.zhimg.com/v2-29c378b570eb05b1d66be2c40e22828a_b.png" data-rawwidth="184" data-rawheight="88" class="content_image lazy" width="184" data-actualsrc="https://pic3.zhimg.com/v2-29c378b570eb05b1d66be2c40e22828a_b.png"/></figure>同样变成了上面的标准格式。</p><p>经过这些转换的技巧，标准格式</p><p><figure><noscript><img src="https://pic3.zhimg.com/v2-4ff2d4a97f08d0a31761069cc548749a_b.png" data-rawwidth="408" data-rawheight="90" class="content_image" width="408"/></noscript><img src="https://pic3.zhimg.com/v2-4ff2d4a97f08d0a31761069cc548749a_b.png" data-rawwidth="408" data-rawheight="90" class="content_image lazy" width="408" data-actualsrc="https://pic3.zhimg.com/v2-4ff2d4a97f08d0a31761069cc548749a_b.png"/></figure>实际上可以表达各种各样的问题。对于单独的问题，我们一般会以最方便的方式写出来，用大于号、等于号或最大化都没有关系；但在整体地研究优化理论时，一般会用统一的问题格式，这样研究和推导的过程会更方便。<br/></p><h4>规划问题的分类</h4><p>数学规划问题可以分为很多很多种类，这里我们将介绍四个最常用到的类别。这四类问题并不是并列关系，而是（很大程度上的）包含关系，其中更小的类别会包含更少的问题，但是由于这些问题普遍有着同样的结构和性质，在这个类别中会有一致受用高效算法；而更大的类别会包含更多的优化问题，但是由于缺乏良好的函数结构，解决起来一般会更麻烦。<br/><br/><b>线性规划</b></p><p>如果一个规划问题的目标函数 f 和约束函数 ci 都是线性函数，我们说它是一个<em>线性规划(linear programming)</em>问题。线性规划都可以写成矩阵的形式：</p><figure><noscript><img src="https://pic3.zhimg.com/v2-5e71a7ce224f02e2fe88d907f459b706_b.png" data-rawwidth="241" data-rawheight="132" class="content_image" width="241"/></noscript><img src="https://pic3.zhimg.com/v2-5e71a7ce224f02e2fe88d907f459b706_b.png" data-rawwidth="241" data-rawheight="132" class="content_image lazy" width="241" data-actualsrc="https://pic3.zhimg.com/v2-5e71a7ce224f02e2fe88d907f459b706_b.png"/></figure><p>这里，c∈<img src="https://www.zhihu.com/equation?tex=R%5E%7Bn%7D+" alt="R^{n} " eeimg="1"/>，A∈<img src="https://www.zhihu.com/equation?tex=R%5E%7Bm%2An%7D+" alt="R^{m*n} " eeimg="1"/> 并且 b∈<img src="https://www.zhihu.com/equation?tex=R%5E%7Bm%7D+" alt="R^{m} " eeimg="1"/>。第2节中举的例子就是一个线性规划问题。</p><p>线性函数是在实数域上最容易分析的一类函数，它们有很强的结构性，直线嘛，从哪里看都是一模一样的。也正是因为如此，解决线性规划问题也相对简单，所有线性规划问题都可以在多项式时间内找到最优解。</p><p><b>二次规划</b></p><p>满足以下格式的规划问题都被称作<em>二次规划(quadratic programming)</em>：<br/></p><p><figure><noscript><img src="https://pic2.zhimg.com/v2-73c082144173374ea51196489737bbd9_b.png" data-rawwidth="319" data-rawheight="137" class="content_image" width="319"/></noscript><img src="https://pic2.zhimg.com/v2-73c082144173374ea51196489737bbd9_b.png" data-rawwidth="319" data-rawheight="137" class="content_image lazy" width="319" data-actualsrc="https://pic2.zhimg.com/v2-73c082144173374ea51196489737bbd9_b.png"/></figure>这里，Q∈<img src="https://www.zhihu.com/equation?tex=R%5E%7Bn%2An%7D+" alt="R^{n*n} " eeimg="1"/>是一个对称矩阵（也就是说 <img src="https://www.zhihu.com/equation?tex=Q%5E%7BT%7D+" alt="Q^{T} " eeimg="1"/>=Q），c∈<img src="https://www.zhihu.com/equation?tex=R%5E%7Bn%7D+" alt="R^{n} " eeimg="1"/>，A∈<img src="https://www.zhihu.com/equation?tex=R%5E%7Bm%2An%7D+" alt="R^{m*n} " eeimg="1"/> 还有 b∈<img src="https://www.zhihu.com/equation?tex=R%5E%7Bm%7D+" alt="R^{m} " eeimg="1"/>。二次规划比线性规划多出了一个 <img src="https://www.zhihu.com/equation?tex=x%5E%7BT%7D+" alt="x^{T} " eeimg="1"/>Qx 项，也是由矩阵的乘积表示的，所以虽然不是线性函数，但是仍可以使用很多线性代数的技巧进行分析。二次规划问题的难度取决于矩阵 Q：如果 Q 是正定矩阵（所有的特征值都大于 0），那么可以在多项式时间内找到最优解；如果 Q 是不定的（有小于 0 的特征值），寻找最优解一般是 NP-难的。</p><p>应该指出，任何一个线性规划问题都是二次规划问题 --- 将二次项的 Q 设成零矩阵即可。</p><p><b>凸规划</b></p><p>讲到凸规划，我们应该先了解凸函数什么。如果 f:<img src="https://www.zhihu.com/equation?tex=R%5E%7Bn%7D+" alt="R^{n} " eeimg="1"/>→R 是一个连续函数，并且对于任何 x，x′∈<img src="https://www.zhihu.com/equation?tex=R%5E%7Bn%7D+" alt="R^{n} " eeimg="1"/> 以及 λ∈[0,1]，满足</p><p><figure><noscript><img src="https://pic3.zhimg.com/v2-b43a2d58a1bd3eccd4c82d81e0870f36_b.png" data-rawwidth="517" data-rawheight="53" class="origin_image zh-lightbox-thumb" width="517" data-original="https://pic3.zhimg.com/v2-b43a2d58a1bd3eccd4c82d81e0870f36_r.jpg"/></noscript><img src="https://pic3.zhimg.com/v2-b43a2d58a1bd3eccd4c82d81e0870f36_b.png" data-rawwidth="517" data-rawheight="53" class="origin_image zh-lightbox-thumb lazy" width="517" data-original="https://pic3.zhimg.com/v2-b43a2d58a1bd3eccd4c82d81e0870f36_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-b43a2d58a1bd3eccd4c82d81e0870f36_b.png"/></figure>我们说 f 是一个<em>凸函数(convex function)</em>。在直观的理解上，就是在这个函数的图上的任意连点之间连一条直线，这个函数不会超过这条直线。<br/></p><p><figure><noscript><img src="https://pic2.zhimg.com/v2-6b5be99a9ead9afbede7fdc0c9e5fef5_b.png" data-rawwidth="1335" data-rawheight="456" class="origin_image zh-lightbox-thumb" width="1335" data-original="https://pic2.zhimg.com/v2-6b5be99a9ead9afbede7fdc0c9e5fef5_r.jpg"/></noscript><img src="https://pic2.zhimg.com/v2-6b5be99a9ead9afbede7fdc0c9e5fef5_b.png" data-rawwidth="1335" data-rawheight="456" class="origin_image zh-lightbox-thumb lazy" width="1335" data-original="https://pic2.zhimg.com/v2-6b5be99a9ead9afbede7fdc0c9e5fef5_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-6b5be99a9ead9afbede7fdc0c9e5fef5_b.png"/></figure>那么，如果在一个规划问题中，<br/></p><p><figure><noscript><img src="https://pic4.zhimg.com/v2-1e5950d479e1a7d0f7cfaef304266227_b.png" data-rawwidth="431" data-rawheight="137" class="origin_image zh-lightbox-thumb" width="431" data-original="https://pic4.zhimg.com/v2-1e5950d479e1a7d0f7cfaef304266227_r.jpg"/></noscript><img src="https://pic4.zhimg.com/v2-1e5950d479e1a7d0f7cfaef304266227_b.png" data-rawwidth="431" data-rawheight="137" class="origin_image zh-lightbox-thumb lazy" width="431" data-original="https://pic4.zhimg.com/v2-1e5950d479e1a7d0f7cfaef304266227_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-1e5950d479e1a7d0f7cfaef304266227_b.png"/></figure>函数 f 和 ci 都是凸的，我们说它是一个<em>凸规划(convex programming)</em>问题。凸函数有什么好处呢，我们举一个形象的例子：在上面的两个函数曲线（红色）上，我们在 f(x′) 的位置放一个圆珠，让它自己滚下去。在第一个凸函数里，圆珠会一路滚下去并停在整个函数的最低点；而在第二个不凸的函数里，圆珠会停在右边的局部低点里，却到不了全局的最低点。从这可以看出，如果 f 是凸函数，寻找它的最低点会更容易。但即便如此，很多凸规划问题的最优解还是 NP-难的。</p><p>对于一个二次规划问题，如果二次项的矩阵 Q 是半正定的，那么它也是一个凸规划问题；但是如果 Q 是不定的，那么二次目标函数并不是一个凸函数。<br/><br/><b>非线性规划</b></p><p>非线性规划是一个非常大的问题类型，一般来说，如果规划问题中</p><p><figure><noscript><img src="https://pic2.zhimg.com/v2-97451978bf9e9ca9db0a6d57969ff525_b.png" data-rawwidth="401" data-rawheight="123" class="content_image" width="401"/></noscript><img src="https://pic2.zhimg.com/v2-97451978bf9e9ca9db0a6d57969ff525_b.png" data-rawwidth="401" data-rawheight="123" class="content_image lazy" width="401" data-actualsrc="https://pic2.zhimg.com/v2-97451978bf9e9ca9db0a6d57969ff525_b.png"/></figure>函数 f 和 ci 都是连续的，它就是一个<em>非线性规划(non-linear programming)</em>问题。也许这个类别的名字起得有点不恰当，因为线性规划问题其实也属于非线性规划问题，而这个“非”字可以这么理解：线性规划是非线性规划中极其小的一部分，如果我们有一个线性规划问题，那么用线性规划的方法就可以很简便地解决，并不需要非线性规划的理论，所以非线性规划实际研究的是线性规划以外的问题。</p><p>非线性规划的涉及面太广，以至于很多未解的数学难题都可以写做为非线性规划的形式，可见普遍的非线性规划问题有多难。因此，在研究非线性规划问题时，我们一般会加上一些额外的条件限制，比如：目标函数 f 是可导的或是平滑的、f 或 f 的导数是 Lipschitz 的、问题的可行区域是凸的，等等。不难看出，上面的所有其他类别的规划问题都属于非线性规划问题。<br/></p><h4>结语</h4><p>本文概括性地介绍了数学规划的基本内容和一些问题的分类。在量化课堂未来的文章中，我们将介绍各类规划问题的数学理论、解题算法以及应用方法，敬请期待。</p><p>到JoinQuant查看策略并与作者交流讨论：<a class=" wrap external" href="https://link.zhihu.com/?target=https%3A//www.joinquant.com/post/3293%3Ff%3Dzhzl%26m%3D23551893" target="_blank" rel="nofollow noreferrer">【量化课堂】数学规划简介</a></p>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
