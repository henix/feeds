<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>「说明」为什么C++标准草案中会提出和Rust交互</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/39248745">原文</a></p>
<div class="title-image"><img src="https://pic4.zhimg.com/v2-43bcd32f4c95674da0401ba8976fc0e6_r.jpg" alt=""></div><p>在今天发的「Rust每日新闻」本周精选里，有这么一篇动态：</p><p><br></p><blockquote><b>C/C++标准委员会提出草案要求C++可以和Rust直接相互调用</b><br><br>原文： <a href="https://www.reddit.com/r/rust/comments/8wlphf/d1095r0n2xxx_draft_3_a_c_either_metatype_so_rust/">r/rust - D1095R0/N2xxx draft 3: A C Either metatype so Rust and C++ can call each other directly</a><br>具体论文 <a href="https://docs.google.com/viewer?a=v&amp;pid=forums&amp;srcid=MTE5NTAwNjk0ODI0NDg0MTc0MjkBMDUwMzkwMTkzNjc2Nzg5MzcyNzABMlg3NnNpUlFDd0FKATAuMQFpc29jcHAub3JnAXYy&amp;authuser=0">https://docs.google.com/viewer?a=v&amp;pid=forums&amp;srcid=MTE5NTAwNjk0ODI0NDg0MTc0MjkBMDUwMzkwMTkzNjc2Nzg5MzcyNzABMlg3NnNpUlFDd0FKATAuMQFpc29jcHAub3JnAXYy&amp;authuser=0</a></blockquote><p><br></p><p>有人（ <a class="member_mention" href="http://www.zhihu.com/people/abb87b3b02e0081c82e5cfb380b2ab0f" data-hash="abb87b3b02e0081c82e5cfb380b2ab0f" data-hovercard="p$b$abb87b3b02e0081c82e5cfb380b2ab0f">@Torosar</a> ）产生疑问：</p><p><b>一般说来，推动语言的可互操作性应该是像Rust这种追赶者更热衷于做的，没想到这次是C++世界提出来。</b></p><p><br></p><p>可能是新闻有点标题党了，我又大概看了一遍论文，来解释一下：</p><p><br></p><p>提交论文的作者是niall douglas，他是一名C++专家和Boost顾问。</p><p>他提交的这个论文，标题叫：C Either元类型。提案同时提交给了C和C++标准委员会。</p><p>主要目的是为了给C语言添加Either(A, B)类型（或者是要成为一种约定俗成），给C++提供一种确定性异常，就是在现有的异常处理基础上，增加可以抛出错误值的异常，就是类似于Rust的Result，或者Go的错误处理机制。</p><p>这样做的目的有两个：</p><p>1. 为了让C语言和C++语言的ABI差距更小，这样其他语言和C++交互也可以更加方便。 </p><p>2. 提升C语言和C++语言和其他语言交互的便利性。</p><p>论文里举的是Rust的示例，如果实现了提案，那么Rust就可以和C++无痛调用，比如Rust里的Result可以转换为C++的std::error提供的确定性异常（可以说，C++的求生欲很强了，顺便说一下，该论文作者在邀请Rust官方团队老大编写关于Rust那一节内容的时候，被拒绝了，因为Rust官方团队现在非常忙，正在忙于Rust 2018发布，找的不是时候）。</p><p>所以，由C++提出来和Rust交互，是C++的求生欲在驱动，因为在现代语言中基本都是基于返回值的错误处理，C++也要加入了（确定性异常）。当然不只C++，也要求C能支持，因为C语言在当今环境下，是一门重要的「粘合」语言。各大编程语言之间相互调用，全靠C ABI了。这是必须要做的。所以，这本来就是应该C/C++标准委员会推动的事情。所以，追赶者应该是C/C++。</p><p><b>Rust并不是追赶者，而是时代的开创者。</b></p><p><br></p><p>以上。</p><p>本文的立场可能比较明显，如果引起您的不快，请无视。</p>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
