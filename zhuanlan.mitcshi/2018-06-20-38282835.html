<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Black-Litterman 模型 —— 贝叶斯框架下的资产配置利器</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/38282835">原文</a></p>
<div class="title-image"><img src="https://pic4.zhimg.com/v2-e012d0762c8347f184b80e73e6d7afc3_r.jpg" alt=""></div><h2><b>1 引言</b></h2><p>毫无疑问，马科维茨（Harry Markowitz）的现代投资组合理论（Modern Portfolio Theory）对于量化投资有着开天辟地的作用。它通过“均值 — 方差”最优化来确定最佳资产配置组合，同时考虑收益的最大化和风险的最小化（Markowitz 1952）。马科维茨也因此获得 1990 年诺贝尔经济学奖。</p><p>然而，令人倍感意外的是，<b>“均值 — 方差”法虽然在数学上十分优雅，但它在投资实务中的影响却远不及它在理论上的名声卓著。</b>究其原因，是因为它给出的<b>最佳投资组合对该模型的核心输入之一即投资品的期望收益率非常敏感；而且期望收益率很难准确预测。</b></p><p>为解决这个问题，两位量化投资界的先驱 —— 高盛的 Fischer Black 和 Robert Litterman 发明了大名鼎鼎的 <b>Black-Litterman 资产配置模型</b>（Black and Litterman 1992）。<b>该模型以市场均衡假设推出的资产收益率为出发点，结合投资者对不同投资品收益率的主动判断，最终确定投资品的收益率和最佳的投资组合配置。</b></p><p>本文就来介绍 Black-Litterman 模型，<b>它的核心是对收益率进行贝叶斯收缩</b>。首先让我们来看看马科维茨的“均值 — 方差”模型为什么在实际中不好用。</p><h2><b>2 “均值 — 方差”模型：冰冷的现实</b></h2><p>假设我们要在 N 个投资品之间进行资产配置。马科维茨的现代资产配置理论以这些投资品的期望收益率和协方差矩阵作为输入，通过最优化下列目标函数求出最佳的投资组合：</p><p><equation>\max_\omega \omega'\mu-\frac{1}{2}\delta\omega'\Sigma\omega</equation> </p><p>其中 <equation>\mu</equation> 表示投资品的期望收益率向量， <equation>\Sigma</equation> 表示投资品的协方差矩阵， <equation>\delta</equation> 表示投资者的风险厌恶系数， <equation>\omega</equation> 则是投资品在投资组合中的配置权重。在不考虑任何约束的情况下，该问题的最优解，即最佳资产配置为：</p><p><equation>\omega^\star=(\delta\Sigma)^{-1}\mu</equation> </p><p>该模型之所以在实际中被专业投资机构诟病有两个原因。<b>第一是因为它的输入非常严苛：投资者必须提供待配置投资品的期望收益率和协方差。</b>一旦预测的数值非常离谱，那么资产配置效用的最大化就变成误差的最大化。对于协方差，通过历史数据计算尚且能用，但是对于未来的期望收益率的准确预测却难上加难。二者相较，期望的预测比协方差的预测更加重要</p><p><b>Chopra and Ziemba (1993) 指出，收益率期望的误差对资产配置的影响比协方差的影响高一个数量级。</b></p><p><b>第二个原因是，它求出的最佳资产配置权重对期望收益率非常敏感。</b>当期望收益率有哪怕仅仅一点变化时，它给出的最佳配置较之前的配置可能发生很大的改变，这样的结果很难被投资者所接受。</p><p>来看一个例子。</p><p>假设我们的投资品来自下列七个国家的股市：澳大利亚、加拿大、法国、德国、日本、英国和美国。通过历史数据得到这些投资品收益率的协方差矩阵如下（注：本文中的所有数据都是假想的，仅做示意之用）：</p><img src="https://pic4.zhimg.com/v2-cb5d9c3b9d3cb9357aebef2e764b00b2_r.jpg" data-caption="" data-size="normal" data-rawwidth="636" data-rawheight="298" data-watermark="watermark" data-original-src="v2-cb5d9c3b9d3cb9357aebef2e764b00b2" data-watermark-src="v2-2a29df03ac8c5838c8daa84ed687ff59" data-private-watermark-src=""><p>对于收益率，由于不好预测，我们假设这七个国家的期望收益率都是 5%，并假设风险厌恶系数为 2.5。根据“均值 — 方差”最优化，得到的最优资产配置权重如下图中的蓝色柱状图所示。按照该配置，我们大幅做空德国，微微做空法国，并做多其他国家。</p><p>现在，假设我们得到了最新靠谱的研报分析，表明德国的期望收益率将会达到 6%，而法国和英国则仅有 4%，其他国家不变。带着新的输入，重新使用“均值 — 方差”最优化，新的结果如下图中绿色的柱状图所示。</p><img src="https://pic2.zhimg.com/v2-8ee417d7673ad01ec8ca212d999c51b1_r.jpg" data-caption="" data-size="normal" data-rawwidth="544" data-rawheight="390" data-watermark="watermark" data-original-src="v2-8ee417d7673ad01ec8ca212d999c51b1" data-watermark-src="v2-011874db7c6b3adedf21b445c6e50360" data-private-watermark-src=""><p>比较蓝色和绿色的柱状图可见，随着我们对德国、法国以及英国预期收益率的调整，最佳的权重也发生了变化。然而，权重的变化发生的非常剧烈（对收益率敏感），我们对这些变化感到非常费解：</p><ol><li>我们之前大幅做空德国，做多英国。然而在微调了收益率之后，却大幅做多德国，做空英国并大幅做空法国。收益率微调前后最优配置权重的变化幅度令我们惊讶。</li><li>我们的收益率预期仅仅针对德国、法国和英国，对其他四个国家没有变化。然而新的最优配置不但改变了那三个国家，更是改变了其他四个国家。比如，新的最优组合中增加了对美国和日本的配置。为什么对欧洲国预期收益率的改变会影响美国和日本？这从直觉上令人难以理解。</li></ol><p>这个例子强调了“均值 — 方差”模型的两个问题：<b>（1）人们很难有效的预测期望收益率；（2）最优资产组合配置对输入非常敏感，结果往往难以被人理解。</b></p><p>为了解决这两个问题，Black 和 Litterman 于 1992 年提出了 Black-Litterman 模型。</p><h2><b>3 收益率的贝叶斯收缩</b></h2><p><b>与“均值 — 方差”模型相比，Black-Litterman 模型最大的区别在于对收益率的预测。在收益率预测方面，Black-Litterman 最本质的核心是它在贝叶斯框架下使用先验收益率以及新息得到后验收益率，它是一种对收益率的贝叶斯收缩（Bayes shrinkage）。</b>得到收益率后，Black-Litterman 模型同样通过求解第二节中的最优化问题确定最优的资产配置权重。</p><p>收益率的贝叶斯收缩是<a href="http://www.liang-xin.com/website/w/h?mt=2&amp;mc=3194267&amp;cc=3021364&amp;fp=d&amp;c=3195156">《贝叶斯统计》</a>的一个经典应用。我们在<a href="http://www.liang-xin.com/website/w/h?mt=2&amp;mc=3194267&amp;cc=3021364&amp;fp=d&amp;c=3195187">《收益率预测的贝叶斯收缩》</a>中介绍过这个技术。经典的贝叶斯收缩定义如下：</p><p><b>贝叶斯收缩以某种方法得出的期望收益率作为先验（prior），以最近 T 期收益率数据求出样本期望收益率作为新息（new observation），结合前两者最终计算出后验期望收益率（posterior）。该方法以最优的比例使基于新息的预测向先验预测“收缩”，这个最优的比例使得后验期望收益率的误差最小。</b></p><p>在数学上，上述方法的表达式如下：</p><p><equation>\mu_p=(\Xi^{-1}+(\Sigma/T)^{-1})^{-1}(\Xi^{-1}\mu_0+(\Sigma/T)^{-1}\bar r)</equation> </p><p>其中 <equation>\mu_0</equation>， <equation>\mu_p</equation> 及 <equation>\bar r</equation> 分别表示先验、后验、新息期望收益率向量；<equation>\Xi</equation> 是先验期望收益率的协方差矩阵， <equation>\Sigma/T</equation> 为新息期望收益率的协方差矩阵（ <equation>\Sigma</equation> 为收益率的样本协方差矩阵、T 为样本数即期数）；-1 次方表示对矩阵求逆。</p><p>不难看出，<b>后验期望收益率 </b><equation>\mu_p</equation><b> 就是 先验 </b><equation>\mu_0</equation><b> 和新息 </b><equation>\bar r</equation> <b>的加权平均，而这两者的权重与它们各自的精度（由协方差矩阵的逆衡量）有关，这就是贝叶斯收缩的核心。</b>在现实中使用上述方法时，对于期望收益率的先验，可以采用因子法或者经验法估计，不同的方法各有千秋。了解了贝叶斯收缩之后，我们马上来看解释 Black-Litterman 模型。</p><h2><b>4 贝叶斯框架下的 Black-Litterman 模型</b></h2><p><b>Black-Litterman 模型的本质就是一种收益率的贝叶斯收缩</b>，只不过无论是期望收益率的先验还是新息，都是从投资的实务出发的（毕竟提出这个的人来自高盛，出发点是为了解决实际资产配置中遇到的问题）。</p><p>先来看看先验期望收益率。</p><p><b>Black-Litterman 模型从市场的供需出发，认为投资品在整个市场中按其市值的占比体现了当前市场供需关系的均衡状态（equilibrium）。</b>投资品市值与市场总市值的比值就是该投资品在这个市场均衡组合中的权重，记为 <equation>\omega_{eq}</equation>。<b>在这个基础上，模型进一步假设各投资品的在市场组合中的配置比例 </b><equation>\omega_{eq}</equation> <b>是由投资者追求效用的最大化（即第二节中的最优化问题）所致</b>，并由 <equation>\omega_{eq}</equation> 反推出市场均衡状态下各投资品的收益率，把它作为先验：</p><p><equation>\mu_0=\delta\Sigma\omega_{eq}</equation> </p><p>对于先验<b>期望</b>收益率的协方差矩阵，模型假设它和收益率的协方差矩阵 <equation>\Sigma</equation> 有着同样的结构，但是数量级要小很多。它用一个很小的标量 <equation>\tau</equation> 作为缩放尺度，得到先验期望收益率的协方差矩阵 <equation>\tau\Sigma</equation>。</p><p>再来看看新息期望收益率。</p><p><b>Black-Litterman 模型将新息定义为投资者对于投资品收益率相对强弱的主动判断（称为 views，即观点）。</b>举个例子，有两个投资品 A 和 B，我们通过分析认为 A 比 B 的期望收益率要高 2%，这意味着做多 A 并同时做空 B 的投资组合可以获得 2% 的收益。在数学上，假设 E[A] 和 E[B] 表示 A 和 B 的新息期望收益率，则上述观点可以表述为：</p><p><equation>P\mu=Q</equation> </p><p>其中 P 是 K × N 矩阵（K 表示 views 的个数；N 表示投资品的个数；本例中 P = [1, -1]）；μ 表示新息期望收益率向量（本例中是 [E[A], E[B]]’）；Q 是 K 阶向量（本例中 Q = [0.02]），表示每个 view 中投资品收益率相对强弱的大小。</p><p><b>这个方法的好处是，它事实上根本无需投资者来猜 μ（在稍后的推导中可以看到，μ 不出现在贝叶斯收缩的表达式中），而只需要投资者提供矩阵 P 和向量 Q 来表达自己的观点。</b></p><p><b>现实中，投资者往往对自己的 views 并不是 100% 确定。</b>这时，我们可以把收益率相对强弱的取值理解为来自一个正态分布，并通过该分布的标准差来描述主动判断的不确定性。例如在上面的例子中，我们可以说 A 比 B 的期望收益率要高 2%，而标准差为 3%。在数学上，该模型使用 K × K 的矩阵 <equation>\Omega</equation> 记录 views 的不确定性。<b>模型假设 views 之间相互独立，因此 Ω 是一个对角阵，对角线上的元素表示对这 K 个 views 的方差。</b>最后，通过 P 将 <equation>\Omega</equation> 的逆矩阵转化为 <equation>P'(\Omega^{-1})P</equation>（N × N 矩阵）作为新息期望收益率的精度。</p><p>把先验和新息期望收益率套到贝叶斯收缩的框架中就得到 Black-Litterman 模型下的后验期望收益率：</p><p><equation>\begin{array}{rll} \displaystyle \mu_p&amp;=&amp;\left((\tau\Sigma)^{-1}+P^\prime\Omega^{-1}P\right)^{-1}\left((\tau\Sigma)^{-1}\mu_0+P^\prime\Omega^{-1}P\mu\right)\\ &amp;=&amp;\displaystyle\left((\tau\Sigma)^{-1}+P^\prime\Omega^{-1}P\right)^{-1}\left((\tau\Sigma)^{-1}\mu_0+P^\prime\Omega^{-1}Q\right) \end{array} </equation> </p><p>上面的推导中用到了 <equation>P\mu=Q</equation>，从而巧妙的将 <equation>\mu</equation> 从贝叶斯收缩的表达式中消除了。求出后验期望收益率 <equation>\mu_p</equation> 之后，带入第二节的最优化问题中，便可以求出 Black-Litterman 模型下的最优投资组合权重：</p><p><equation>\omega^{\star}=(\delta\Sigma)^{-1}\mu_p</equation> </p><p>下面就来几个 Black-Litterman 模型应用的例子。</p><h2><b>5 Black-Litterman 模型应用举例</b></h2><p>我们仍然假设市场中包括本文第二节提到的七个国家的股市。它们的协方差矩阵已在第二节给出。假设它们在市场均衡状态下的权重 <equation>\omega_{eq}</equation> 如下表所示。进一步的，另标量 <equation>\tau=0.1</equation> 且风险厌恶系数 <equation>\delta=2.5</equation>。根据 <equation>\delta</equation>、 <equation>\omega_{eq}</equation> 以及协方差矩阵 <equation>\Sigma</equation> 可以求出先验期望收益率 <equation>\mu_0</equation>：</p><img src="https://pic1.zhimg.com/v2-b23c0b03b55d902610a5e57a9747bb9e_r.jpg" data-caption="" data-size="normal" data-rawwidth="630" data-rawheight="127" data-watermark="watermark" data-original-src="v2-b23c0b03b55d902610a5e57a9747bb9e" data-watermark-src="v2-dd29f34217363f3cd471aee89f2f4ff9" data-private-watermark-src=""><p>首先假设我们只有一个 view：预期德国的期望收益率较英国和法国期望收益率的等权重之和高 5%，我们对这个判断的标准差为 2%。</p><p>上述 view 转换成 Black-Litterman 模型的参数有：</p><p><equation>\begin{array}{rll} P&amp;=&amp;[0,0,-0.5,1.0,0,-0.5,0]\\ Q&amp;=&amp;[0.05]\\ \Omega&amp;=&amp;[0.04] \end{array}</equation> </p><p>应用 Black-Litterman 模型得到的后验期望收益率（绿色）与作为先验的市场均衡状态期望收益率（蓝色）比较如下。乍一看去，这个结果似乎令人意外，因为我们的新息是德国会比英国和法国更好，但是在后验收益率中，法国和英国的收益率不降反升。这是因为新息仅仅说明英法两国会比德国差，它并不意味着英、法两国收益率的绝对取值较先验会减小。由于英法两国的收益率和整个市场组合的收益率正相关，且这个新息提高了市场组合的预期，因此英法两国的后验收益率也提高了。上述论述对其他国家的后验收益率同样成立。</p><img src="https://pic4.zhimg.com/v2-40bfe0fdf765f9671ba1ba2a55487a88_r.jpg" data-caption="" data-size="normal" data-rawwidth="549" data-rawheight="391" data-watermark="watermark" data-original-src="v2-40bfe0fdf765f9671ba1ba2a55487a88" data-watermark-src="v2-039efb0184d79e8316ed6ad7dcbec190" data-private-watermark-src=""><p>再来看看 Black-Litterman 模型下的最优投资组合配置：</p><img src="https://pic4.zhimg.com/v2-3f13f9b016028bbb82016264b3badcc4_r.jpg" data-caption="" data-size="normal" data-rawwidth="1027" data-rawheight="363" data-watermark="watermark" data-original-src="v2-3f13f9b016028bbb82016264b3badcc4" data-watermark-src="v2-937b3bafdcf703e6654bf31adbcd24a1" data-private-watermark-src=""><p>上图中，左图比较了最优配置 <equation>\omega^*</equation> 和市场均衡配置 <equation>\omega_{eq}</equation>；右图显示了这二者的差别。这个结果清晰的说明，我们关于德国、英国、法国收益率的判断仅仅影响了它们三个国家在最优投资组合中的权重。<b>由于我们更看好德国，因此它的权重更高，而英法两国的权重相应相抵。其他国家的权重等于市场均衡状态的权重，不受我们的主观判断的影响。</b>这样的配置结果非常符合投资者的预期，较马科维茨的“均值 — 方差”法，Black-Litterman 模型的最优配置显然更容易被投资者接受。</p><p><b>投资者的主动判断通过 Q（描述相对强弱的幅度）和 </b><equation>\Omega</equation><b>（描述投资者对 views 的自信程度）两个参数影响着最优的资产配置。</b>为了说明这一点，假设在上面的例子中，首先把 Q 从 0.05 提高到 0.08，即我们判断德国较英法两国的超额收益更多。在最优的资产配置中，我们更加超配德国，低配法国和英国：</p><img src="https://pic1.zhimg.com/v2-03b10709e848b795fdaa4e8cf304a9a9_r.jpg" data-caption="" data-size="normal" data-rawwidth="1006" data-rawheight="366" data-watermark="watermark" data-original-src="v2-03b10709e848b795fdaa4e8cf304a9a9" data-watermark-src="v2-3a69e3bcb8b3010c8cd60e31c6db5e3a" data-private-watermark-src=""><p>再来，我们保持 Q = [0.05]，但是将 <equation>\Omega</equation> 从 0.04 减小到 0.01，即我们对自己的判断更加有信心。同样，在最优的资产配置中，我们更加超配德国，低配法国和英国（我们甚至做空了法国）：</p><img src="https://pic3.zhimg.com/v2-eeae21e423277b65df7ce327adcf5913_r.jpg" data-caption="" data-size="normal" data-rawwidth="1012" data-rawheight="364" data-watermark="watermark" data-original-src="v2-eeae21e423277b65df7ce327adcf5913" data-watermark-src="v2-2524e8b73457e02d82d0c9c3d2667dd7" data-private-watermark-src=""><p>最后，来看看有多个 views 的情况。假设除了上述德国、法国、英国的 view，我们有另外一个 view：加拿大相对于美国可以获得 3% 的超额收益，判断的标准差为 2%。同时考虑这两个 views，有：</p><p><equation>\begin{array}{rll} P&amp;=&amp;\left[\begin{array}{rrrrrrr}0,&amp;0,&amp;-0.5,&amp;1.0,&amp;0,&amp;-0.5,&amp;0\\0,&amp;1.0,&amp;0,&amp;0,&amp;0,&amp;0,&amp;1.0\end{array}\right]\\\\ Q&amp;=&amp;\left[\begin{array}{c}0.05\\0.03\end{array}\right]\\\\ \Omega&amp;=&amp;\left[\begin{array}{cc}0.04&amp;0\\0&amp;0.04\end{array}\right] \end{array}</equation> </p><p>由 Black-Litterman 模型得到的最优配置如下图所示。由于加入了新的关于加拿大和美国的 view，我们超配了加拿大而低配了美国。由于上述两个 views 均不涉及澳大利亚和日本，它们在投资组合中的权重不受影响。</p><img src="https://pic4.zhimg.com/v2-efb3c6f228f8e6869705b1cc25267994_r.jpg" data-caption="" data-size="normal" data-rawwidth="1000" data-rawheight="369" data-watermark="watermark" data-original-src="v2-efb3c6f228f8e6869705b1cc25267994" data-watermark-src="v2-cfcfffb9b0499ab14040bf11b6f129c7" data-private-watermark-src=""><h2><b>6 结语</b></h2><p>Black-Litterman 资产配置模型解决了马科维茨模型在应用中的两个痛点：</p><p>（1）投资品的期望收益率很难预测；</p><p>（2）模型对输入参数太敏感，导致投资者无法理解模型给出的最佳投资组合中投资品的配置权重。</p><p><b>Black-Litterman 模型从市场均衡配置出发，有效的结合了投资者对投资品的主动判断，求出的配置结果符合投资者的预期。在华尔街，Black-Litterman 模型在高盛以及其他金融机构都有着广泛的应用。</b></p><p><b>But, and this is a BIG but，该模型在投资实务中能够带来超额收益的前提是投资者提供的 views 比较准确。</b>这显然是以深入了解各投资品背后的逻辑以及大量细致的数据分析为前提的。如果 views 很离谱，那么即便是 Black-Litterman 模型给出的最佳配置权重也无能为力。</p><p>我们有理由相信，拥有众多专业人士的大型金融机构在提供主动 views 方面有着独到的见解。但预测未来有时又谈何容易？至少在预测黄金这件事儿上，高盛就常常南辕北辙。</p><img src="https://pic1.zhimg.com/v2-8c5a90842309c2f6632eb2680fc73d67_r.jpg" data-caption="" data-size="normal" data-rawwidth="560" data-rawheight="581" data-watermark="watermark" data-original-src="v2-8c5a90842309c2f6632eb2680fc73d67" data-watermark-src="v2-4a906f1c20e86316c9b7e850a25f6510" data-private-watermark-src=""><p>本文简要介绍了 Black-Litterman 模型，并通过一系列例子说明如何使用它。在这些例子中，我们均考虑的是无约束优化。<b>在实际中进行资产配置时，投资者往往需要考虑来自风险、波动率、预算等方面的限制。</b>在这种情况下，根据后验收益率求解最优化资产配置时需要考虑上述限制。感兴趣的读者可以进一步阅读 He and Litterman (1999)。</p><p><br></p><p><b>参考文献</b></p><ul><li>Black, F. and R. Litterman (1992). Global Portfolio Optimization. <i>Financial Analysts Journal</i>, Vol. 48(5), 28 – 43.</li><li>Chopra, V. K. and W. T. Ziemba (1993). The effort of errors in means, variances, and covariances on optimal portfolio choice. <i>Journal of Portfolio Management</i>, Vol. 19(2), 6 – 11.</li><li>He, G. and R. Litterman (1999). <i>The intuition behind Black-Litterman model portfolios.</i> Technical note, Goldman Sachs Quantitative Resources Group.</li><li>Markowitz, H. (1952). Portfolio Selection. <i>The Journal of Finance</i>, Vol. 7(1), 77 – 91.</li></ul>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
