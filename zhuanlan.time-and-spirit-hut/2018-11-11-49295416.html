<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>「Rust每日新闻」本周精选 • 第十九期</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/49295416">原文</a></p>
<div class="title-image"><img src="https://pic4.zhimg.com/v2-23599072636a1820bba7b49b9d586092_r.jpg" alt=""></div><blockquote>前言： 从2018年开始，我每天会花1个小时关注Rust社区动态，并且在<a href="http://rust.cc/">Rust.CC论坛</a>、<a href="https://t.me/rust_daily_news">tg channel</a>、<a href="https://steemit.com/@blackanger">Steemit</a>、<a href="https://github.com/RustStudy/rust_daily_news">GitHub</a>、<a href="https://www.yuque.com/chaosbot/rustnews">语雀订阅</a>都开通了Rust每日新闻，分享我每天的见闻，偶尔也夹杂了一些个人的观点。大半年过去了，Rust每日新闻已经成为了Rust社区群大家每天必看的内容。在这个知乎专栏里，每周会精选几篇Rust社区中的动态，和大家分享。分享的内容就不按时间排序了。 2018-11-11</blockquote><h2>官方新闻</h2><h2>Rust 1.30.1 发布</h2><p>修补了一些bug</p><p><a href="https://blog.rust-lang.org/2018/11/08/Rust-1.30.1.html">Read More</a></p><h2>Pin API即将在1.32版本中稳定</h2><p><a href="https://github.com/rust-lang/rust/issues/55766">issues-55766</a></p><h2>如何在2018年加速Rust编译器：NLL edition</h2><p>本篇文章是对Niko之前博文的增补。其中按时间线罗列了针对NLL性能提升的各个PR。</p><p>这些PR主要是提升了编译器基于NLL做静态借用检查的性能。</p><p><a href="https://blog.mozilla.org/nnethercote/2018/11/06/how-to-speed-up-the-rust-compiler-in-2018-nll-edition/">Read More</a></p><hr><h2>社区新闻</h2><h2>「有趣的数据」Firefox中近一年内Rust使用数据统计</h2><p>从2017年11月1日 ~ 2018年11月1日</p><ul><li>Rust代码行数从3.7%增加到6.24%，反过来C++代码的比例就降低了</li><li>一共有405,379行Rust代码，6,091,861行C++代码</li><li>更有趣的是，Rust代码增加了172,839行，C++代码减少了38,241行</li></ul><p><br></p><img src="https://pic1.zhimg.com/v2-f54e2802acb01ca15a950edd609ae7ea_r.jpg" data-caption="" data-size="normal" data-rawwidth="690" data-rawheight="466" data-watermark="watermark" data-original-src="v2-f54e2802acb01ca15a950edd609ae7ea" data-watermark-src="v2-2c5c8fcb2d77a974e97ae992f24e06a9" data-private-watermark-src=""><img src="https://pic4.zhimg.com/v2-bb0ef6f2ea438d169b91ac495844892a_r.jpg" data-caption="" data-size="normal" data-rawwidth="690" data-rawheight="445" data-watermark="watermark" data-original-src="v2-bb0ef6f2ea438d169b91ac495844892a" data-watermark-src="v2-a53802c74edf45ec9e5e96b066129e77" data-private-watermark-src=""><img src="https://pic2.zhimg.com/v2-3fe59b16546a3059edacfdf79f2a28a4_r.jpg" data-caption="" data-size="normal" data-rawwidth="690" data-rawheight="500" data-watermark="watermark" data-original-src="v2-3fe59b16546a3059edacfdf79f2a28a4" data-watermark-src="v2-395e794a714b8f11bc9e519b7a2ff4f9" data-private-watermark-src=""><p><br></p><p><a href="https://mobile.twitter.com/eroc/status/1061049330574884864">Read More推文</a></p><h2>前EA首席设计官成立的新独立游戏工作室Embark宣布使用Rust为主要语言</h2><p>作为EA的CDO（首席设计官，Chief design officer）在DICE/EA为游戏奉献了十八个年头，现在创建了新公司Embark，打算尝试点新东西。Embark宣布将用Rust构建他们的技术。</p><p><a href="https://www.theverge.com/2018/11/8/18073992/patrick-soderlund-new-studio-embark-nexon">相关新闻</a></p><p><a href="https://twitter.com/repi/status/1060469377500274689">推文</a></p><p><br></p><img src="https://pic4.zhimg.com/v2-7322f977211c46558177d2f1443fe990_r.jpg" data-caption="" data-size="normal" data-rawwidth="690" data-rawheight="569" data-watermark="watermark" data-original-src="v2-7322f977211c46558177d2f1443fe990" data-watermark-src="v2-9ee4931db8e27a2a92a34a18af2ac296" data-private-watermark-src=""><p><br></p><h2>官方异步Web开发框架Tide中间件介绍</h2><p><a href="https://zhuanlan.zhihu.com/p/49293350">Read More</a></p><h2>「录播视频」11-07晚上杭州秘猿Rust开发分享会</h2><p>秘猿计划每个月的Dev Meetup第一场都会开设Rust专题</p><p>B站视频前面几分钟无声音，后面有了</p><p><a href="https://www.bilibili.com/video/av35546990/"> B站 </a></p><p><a href="https://www.youtube.com/watch?reload=9&amp;v=s7gFNTb3rWU&amp;feature=youtu.be"> 油管视频声音比较完整 </a></p><h2>Suricata 4.1 发布</h2><p>Suricata是一个网络实时入侵检测(IDS)、嵌入式入侵防御(IPS)和网络安全监控(NSM)的引擎。本来是C语言实现的，现在4.1版本中引入的新协议支持是基于Rust构建。</p><p>也就是说:</p><blockquote> Suricata 4.1 is not really 4.1 if you don’t have Rust.<br> </blockquote><p><a href="https://suricata-ids.org/2018/11/06/suricata-4-1-released/">Read More</a></p><p><a href="https://github.com/OISF/suricata">suricata</a></p><h2>Parity与Zcash 基金会合作</h2><p>新的Zcash节点将使用Rust编写，并成为Zcash公司自zcashed之后的第一个可选客户端。zcashed是Zcash唯一可用的完整节点。</p><p><a href="https://www.parity.io/parity-teams-up-with-zcash-foundation-for-parity-zcash-client/">Read More</a></p><h2>lazy_static发布1.2.0版本</h2><p>该版本主要是让lazy_static可以在no_std下使用。</p><p><a href="https://www.reddit.com/r/rust/comments/9u8u6h/psa_lazy_static_120_requires_rustc_1241_or_higher/">Read More</a></p><h2>探讨所有权和借用语义对API接口设计的影响</h2><p><a href="https://zhuanlan.zhihu.com/p/48585534">Read More</a></p><h2>xray有什么进展？</h2><p>xray是Atom团队使用Rust和Electron实现的下一代文本编辑器。今天看了下其代码仓库，发现还是在持续地更新。在2018第三个季度，团队主要聚焦于memo子项目。memo是xray的基础，它是一个版本控制系统，也可以作为独立库使用。</p><p>memo是想作为Git的扩展，使用无冲突的复制数据类型（CRDT）记录工作副本，用于增强Git的实时协作功能。其技术栈也用到了WebAssembly，用于公开虚拟文件系统的API。</p><p>在memo稳定以后，会将其从xray独立出来，然后会继续进行xray的开发。将xray作为一个以memo为基础的一流的可实时协作的编辑器。</p><p>牛逼了</p><p><a href="https://github.com/atom/xray/tree/master/memo_core">memo</a></p><p><a href="https://github.com/atom/xray">xray</a></p><h2>「演讲」使用Rust构建下一代网络基础设施</h2><p>Buoyant的软件工程师Carl分享了在Conduit开发过程中利用Rust零成本抽象开发下一代网络基础平台。</p><p><a href="https://www.infoq.com/presentations/rust-infrastructure">infoq 视频</a></p><hr><h2>学习资源</h2><h2>Monadic Rust: Part I</h2><p><a href="https://zhuanlan.zhihu.com/p/49276748"> Read More </a></p><h2>NLL之后：移动借用数据和Sentinel模式</h2><p><a href="https://zhuanlan.zhihu.com/p/49290855">Read More</a></p><h2>用Rust编写网络驱动程序</h2><p><a href="https://www.net.in.tum.de/fileadmin/bibtex/publications/theses/2018-ixy-rust.pdf">PDF</a></p><h2>利用Rust所有权语义来构造有约束的API</h2><p>该文作者在2017年的Rust Fest大会做了分享，直到昨天，他才把演讲内容更新成了文稿。</p><p><a href="https://www.youtube.com/watch?v=3Q2hQfYW-XM&amp;index=9&amp;list=PL85XCvVPmGQj9mqbJizw-zi-EhcpS5jTP">演讲视频</a></p><p>（ 我在《Rust编程之道》一书的设计模式 - RAII模式 里也借鉴了他的这次演讲内容 ）</p><p><a href="https://blog.systems.ethz.ch/blog/2018/a-hammer-you-can-only-hold-by-the-handle.html">Read More</a></p><h2>「语言特性」重温proc_macro_attribute</h2><h2>proc_macro #attribute #flame #flamegraph</h2><p>随着proc-macro功能的逐渐稳定，proc_macro_attribute现在也不需要再加特定的features，比如registrar 和 rustc_private。该文作者重构了他的项目flamer(一个编译器插件)，包含了最新的proc_macro_attribute用法，当然还是需要nightly版本。</p><p><a href="https://github.com/llogiq/flamer">flamer</a></p><p><a href="https://llogiq.github.io/2018/11/10/proc-macro.html">Read More</a></p><h2>Rust实现可选参数</h2><p>本文记录了作者使用Rust实现可选参数的一步步思路，也是对Rust设计API的思考。</p><p>P.S 这还是一个PingCAP隐藏的招聘贴呢。</p><p><a href="https://hoverbear.org/2018/11/04/optional-arguments/">Read More</a></p><h2>Rust谜题：让内嵌于迭代中的Result扁平化</h2><p>ndarray-csv的作者第三次重构该库的时候碰到一个问题。</p><p>他想实现一个函数：</p><code lang="rust">pub fn flatten_nested_results&lt;T, E, II, IO&gt;(iter_outer: IO) -&gt; impl Iterator&lt;Item = Result&lt;T, E&gt;&gt;
where
    II: Iterator&lt;Item = Result&lt;T, E&gt;&gt;,
    IO: Iterator&lt;Item = Result&lt;II, E&gt;&gt;,
{
    /// Fill me in!
}</code><p>然后用于处理像下面这种迭代器中的Result</p><code lang="rust">fn vec_to_nested_iter(
    vec_outer: Vec&lt;Result&lt;Vec&lt;Result&lt;i8, f32&gt;&gt;, f32&gt;&gt;,
) -&gt; impl Iterator&lt;Item = Result&lt;impl Iterator&lt;Item = Result&lt;i8, f32&gt;&gt;, f32&gt;&gt; {
    vec_outer
        .into_iter()
        .map(|vec_inner| vec_inner.map(Vec::into_iter))
}

/// Without any Errs, we should return the whole sequence
#[test]
fn test_all_ok() {
    let iter_outer = vec_to_nested_iter(vec![Ok(vec![Ok(1), Ok(2)]), Ok(vec![Ok(3)])]);
    let expected: Result&lt;Vec&lt;i8&gt;, f32&gt; = Ok(vec![1, 2, 3]);
    assert_eq!(expected, flatten_nested_results(iter_outer).collect())
}</code><p>作者经过三次失败的flatten_nested_results函数实现，首先找出的解决方案是使用trait object。</p><code lang="rust">pub fn flatten_nested_results&lt;T, E, II, IO&gt;(iter_outer: IO) -&gt; impl Iterator&lt;Item = Result&lt;T, E&gt;&gt;
where
    T: 'static,
    E: 'static,
    II: 'static + Iterator&lt;Item = Result&lt;T, E&gt;&gt;,
    IO: 'static + Iterator&lt;Item = Result&lt;II, E&gt;&gt;,
{
    iter_outer.flat_map(|iter_inner_result| match iter_inner_result {
        Ok(iter_inner) =&gt; Box::new(iter_inner) as Box&lt;Iterator&lt;Item = Result&lt;T, E&gt;&gt;&gt;,
        Err(err) =&gt; Box::new(once(Err(err))) as Box&lt;Iterator&lt;Item = Result&lt;T, E&gt;&gt;&gt;,
    })
}</code><p>但他还不喜欢这个方案，最终他使用了either库来解决此问题</p><code lang="rust">extern crate either;

use either::Either;
use std::iter::once;

pub fn flatten_nested_results&lt;T, E, II, IO&gt;(iter_outer: IO) -&gt; impl Iterator&lt;Item = Result&lt;T, E&gt;&gt;
where
    II: Iterator&lt;Item = Result&lt;T, E&gt;&gt;,
    IO: Iterator&lt;Item = Result&lt;II, E&gt;&gt;,
{
    iter_outer.flat_map(|iter_inner_result| match iter_inner_result {
        Ok(iter_inner) =&gt; Either::Right(iter_inner),
        Err(err) =&gt; Either::Left(once(Err(err))),
    })
}</code><p><a href="https://paulkernfeld.com/2018/11/03/flatten-nested-iterator-result.html">Read More</a></p><hr><h2>项目</h2><h2>swc：加速web开发</h2><p>swc是babel 和 closure compiler二合一的Rust实现。潜力不错，但目前缺乏文档。</p><p><a href="https://github.com/swc-project/swc">swc</a></p><h2>rust-analyzer：给IDE使用的Rust实验性模块化编译器前端</h2><p>旨在为优秀的IDE支持奠定基础</p><p><a href="https://github.com/rust-analyzer/rust-analyzer">rust-analyzer</a></p><h2>martin： PostGIS矢量切片（ vector tiles）服务器</h2><p>martin是基于rust和actix-web实现的PostGIS矢量切片服务器。主要是基于mapbox格式做矢量切片，一般用于地图服务。</p><p>PostGIS 是 PostgreSQL 的空间数据库扩展。</p><blockquote> 考察了一下该库背后的公司Urbica，是一家来自莫斯科的数据分析及可视化公司。他们最新开发的产品AReal，是一款 iOS 平台上的增强现实 App，通过 3D 的方式展示了圣彼得堡的地图和地标建筑，包括了七座杰出建筑在地图上用星标标记。但是展示方式可能与大家想象的有所不同——不再是低下头在屏幕上看，而是举起手机把建筑“搭建”到你眼前！只要点击任何一座建筑，你就可以通过 AR 模块将建筑融入你所处的环境，并通过缩放、旋转等操作来探索。<br> </blockquote><p>一句话描述： Urbica公司是做AR地图的。据说苹果公司也正在筹备做AR地图产品。</p><p><a href="https://zhuanlan.zhihu.com/p/43656372">Urbica介绍来源</a></p><p><a href="https://github.com/urbica/martin">martin</a></p><h2>「小游戏」Rust和WASM实现的贪食蛇</h2><p><a href="https://github.com/yiransheng/rust-snake-wasm">rust-snake-wasm</a></p><h2>「嵌入式」Monotron在Rust Belt上的展示</h2><p>Monotron是基于TM4C123单片机和ARM Cortex-M4内核的一款DIY 8位家用小电脑，作者在RustBelt大会上展示了让它来跑snake小游戏。 并且可以使用C和Rust来为其编写应用。</p><p><a href="https://github.com/thejpster/monotron">Monotron</a></p><p><a href="https://railwayelectronics.blogspot.com/2018/11/monotron-at-rust-belt-rust.html">Read More</a></p><h2>Plume:又一个基于ActivityPub协议开发的社区联盟博客系统</h2><p>plume是基于rocket和diesel实现。</p><p><a href="https://github.com/Plume-org/Plume">Plume</a></p><p><a href="https://baptiste.gelez.xyz/">Demo</a></p><p>相似的项目有: <a href="https://github.com/Aardwolf-Social/aardwolf">Aardwolf</a></p><h2>Rust + SDL实现的rougelike沙盒游戏</h2><blockquote> Roguelike是电子角色扮演游戏（RPG游戏）的一个子类。标志性特征有：在随机生成的地牢中探索、回合制、基于图块的图像（tile-based graphics）以及角色的永久死亡。<br> </blockquote><p><a href="https://github.com/garkimasera/rusted-ruins">rusted-ruins</a></p><hr><h2>工具与库</h2><h2>Mundane : 基于BoringSSL的Rust加密库</h2><p>BoringSSL 是由谷歌从 OpenSSL 中抽出来后独立发展的作品。</p><p><a href="https://github.com/google/mundane">mundane</a></p><h2>JSON5的序列化和反序列化工具</h2><p>基于pest和serde</p><p><a href="https://github.com/callum-oakley/json5-rs">json5-rs</a></p><h2>s3-concat: 使用Rust快速合并S3文件</h2><p><a href="https://github.com/whitfin/s3-concat">s3-concat</a></p><p><a href="https://whitfin.io/quickly-concatenating-files-in-amazon-s3/">Read More</a></p><h2>「机器学习」使用Rust在命令行构建训练数据</h2><p>ttv是一个命令行工具，用于将大型文件拆分为适合于机器学习的训练/测试/验证拆分的块。基于Rust 2018版本。</p><p><a href="https://github.com/sd2k/ttv">ttv</a></p><h2>vulkano 0.11 发布</h2><p>vulkano是对Vulkan API的安全包装</p><p><a href="https://github.com/vulkano-rs/vulkano">vulkano</a></p><p><a href="https://www.patreon.com/posts/22587417">Read More</a></p><h2>「库」imag 0.9发布</h2><p>私人信息管理套件工具imag发布了新版本：</p><ul><li>本次版本修改影响比较广</li><li>增加了读取大文件的支持，不会遇到文件描述符限制</li><li>加速图片操作</li><li>使用统一的IO系统</li><li>使用failure库进行错误处理</li><li>imag-diagnostics增加进度条</li><li>大量bug修复</li></ul><p><a href="https://imag-pim.org/blog/2018/11/10/imag-0-9-0/">imag</a></p><h2>instru: 监控Rust代码性能</h2><p>instru通过在编译阶段（编译器插件）将代码注入到AST来执行对整个程序的跟踪。需要使用nightly版本。</p><p>该工具和flamer库有点相似，flamer库可以生成火焰图，用来帮助跟踪代码性能。</p><p><a href="https://github.com/da-x/instru">instru</a></p><p><a href="https://github.com/llogiq/flamer">flamer</a></p><h2>「小工具」清理cargo或rustc产生的构建垃圾</h2><p><a href="https://github.com/holmgr/cargo-sweep">cargo-sweep</a></p><h2>hexyl 命令行16进制查看器</h2><p>彩色输出不同类别的字节</p><p><a href="https://github.com/sharkdp/hexyl">hexyl</a></p><h2>no-panic ：通过一个属性宏让编译器检验函数不会发生panic</h2><p>serde/syn 作者dtolnay的新库：no-panic。 提供了一个属性宏，通过编译器来保证函数不会发生panic。</p><p>比如：</p><code lang="rust">extern crate no_panic;
use no_panic::no_panic;

#[no_panic]
fn demo(s: &amp;str) -&gt; &amp;str {
    &amp;s[1..]
}

fn main() {
    println!("{}", demo("input string"));
}</code><p>如果该demo函数发生panic（或编译器无法检验函数不能panic），则该函数会编译失败，并且错误信息中会携带包含该函数名称标识的链接器错误信息。</p><p>注意：通过看该库的源码发现：</p><ul><li>Rust的proc_macro_attribute功能也移出了<code class="inline">#![feature(custom_attribute)]</code>特性，意味着，也要准备稳定了</li><li>现在稳定的proc_macro功能，不能用作表达式，除非使用<code class="inline">#![feature(proc_macro_hygiene)]</code>特性。<a href="https://github.com/rust-lang/blog.rust-lang.org/issues/285">相关issues </a></li></ul><p><a href="https://github.com/dtolnay/no-panic">no-panic</a></p><hr><h2>招聘</h2><h2>「远程Job」来自丹麦的召唤：Rust全栈工程师</h2><p>丹麦的一家正规公司：impero，目前正在招募Rust全栈工程师。可远程。</p><p><a href="https://www.reddit.com/r/rust/comments/9v7qpx/rust_fullstack_developer_denmark_or_remote/">Read More</a></p>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
