<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>多因子模型与细分行业多因子测试源码（以医疗行业为例）</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/58704341">原文</a></p>
<div class="title-image"><img src="https://pic2.zhimg.com/v2-84e062a791fb4913862dfc0d6479f3c0_b.jpg" alt=""></div><h2><b>研究内容</b></h2><p>本文主要研究内容是基于rank IC分析医疗板块四大类因子（<b>风格类、技术类、盈利能力类、基本面类</b>）盈利预测能力，以及在此基础上构建医疗板块多因子rank IC赋权模型。</p><p>本文将分为以下三个板块：</p><ul><li><b>因子选取及数据预处理</b></li><li><b>医疗板块因子分析</b></li><li><b>构建医疗板块多因子模型</b></li></ul><h2><b>因子选取及数据预处理</b></h2><p><b>&gt;&gt;&gt;    因子选取</b></p><p>本文基于海通证券研报的内容，选取四大类因子（<b>风格类、技术类、盈利能力类、基本面类</b>）作为所选研究因子。具体如下表：</p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-c29c76374d6fb431401a7636a4b8724a_b.jpg" data-caption="" data-size="normal" data-rawwidth="640" data-rawheight="617" class="origin_image zh-lightbox-thumb" width="640" data-original="https://pic3.zhimg.com/v2-c29c76374d6fb431401a7636a4b8724a_r.jpg"/></noscript><img src="https://pic3.zhimg.com/v2-c29c76374d6fb431401a7636a4b8724a_b.jpg" data-caption="" data-size="normal" data-rawwidth="640" data-rawheight="617" class="origin_image zh-lightbox-thumb lazy" width="640" data-original="https://pic3.zhimg.com/v2-c29c76374d6fb431401a7636a4b8724a_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-c29c76374d6fb431401a7636a4b8724a_b.jpg"/></figure><p><b>&gt;&gt;&gt;    数据预处理</b></p><p><b>股票池：</b>申万一级医疗行业中非*ST股<br/><b>时间维度：</b>2010年1月1日——2018年8月1日<br/><b>处理方式：</b>去空值、去极值、中性化、标准化</p><p><b>去空值：</b>先将任一因子数据全部为空的股票从股票池中剔除，再将剩余股票的空值用当天医药行业该因子的平均水平进行填充。<br/><b>去极值：</b>采取中位数去极值法<br/><b>中性化：</b>将除了市值外的因子对市值进行中性化。因为股票池全部为同一行业的股票。无需对行业哑变量进行中性化。<br/><b>标准化：</b>采取传统均值标准化方法</p><h2><b>医疗板块因子分析</b></h2><p>本文的因子分析方式为<b>rank IC均值分析法</b>。rank IC是分析因子有效性的常用指标。</p><p><b>&gt;&gt;&gt;    rank IC介绍</b></p><p>因子IC的求解方式为：时间维度上因子与股票收益率相关系数的均值。因子rank IC求解原理与IC相同，不同的仅在于其使用的数据是因子在股票池中的排名而非其数值。这样的做法能够在统计学中避免很多问题，数值效果也更为有效。</p><p>具体公式如下：</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-ac727aa16ff20a25dd56921c4f7f5ad5_b.png" data-caption="" data-size="normal" data-rawwidth="1001" data-rawheight="155" class="origin_image zh-lightbox-thumb" width="1001" data-original="https://pic2.zhimg.com/v2-ac727aa16ff20a25dd56921c4f7f5ad5_r.jpg"/></noscript><img src="https://pic2.zhimg.com/v2-ac727aa16ff20a25dd56921c4f7f5ad5_b.png" data-caption="" data-size="normal" data-rawwidth="1001" data-rawheight="155" class="origin_image zh-lightbox-thumb lazy" width="1001" data-original="https://pic2.zhimg.com/v2-ac727aa16ff20a25dd56921c4f7f5ad5_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-ac727aa16ff20a25dd56921c4f7f5ad5_b.png"/></figure><p><b>t：</b>日期<br/><b>n：</b>日期总数<br/><b>rank_Sit：</b>第i个因子在第t天的数据向量<br/><b>rank_PCTt：</b>第t天的股票收益率数据向量<br/><b>rank_ICi：</b>第i个因子的IC均值</p><p><b>&gt;&gt;&gt;    医疗行业因子IC分析</b></p><p>医疗板块因子分析的结果汇总如下表：</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-171cafd1fcb68138d72a694141a086b8_b.jpg" data-caption="" data-size="normal" data-rawwidth="1085" data-rawheight="875" class="origin_image zh-lightbox-thumb" width="1085" data-original="https://pic1.zhimg.com/v2-171cafd1fcb68138d72a694141a086b8_r.jpg"/></noscript><img src="https://pic1.zhimg.com/v2-171cafd1fcb68138d72a694141a086b8_b.jpg" data-caption="" data-size="normal" data-rawwidth="1085" data-rawheight="875" class="origin_image zh-lightbox-thumb lazy" width="1085" data-original="https://pic1.zhimg.com/v2-171cafd1fcb68138d72a694141a086b8_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-171cafd1fcb68138d72a694141a086b8_b.jpg"/></figure><p>可以很明显地看到：<b>对于医药板块而言，部分基本面因子仍然有十分出色的表现。盈利能力因子（ROE）表现也十分出色。换手率、反转率等技术面因子与股票收益率有显著的反向相关关系。</b></p><p>而其中需要注意的是风格类因子：<b>市值、PE和PB的rank IC表现并不出色。</b>但如果将其与股票收益率做回归的话会发现R方仍然很高。其原因是17年后市值因子等出现反转，在17年前市值与股票收益反向相关而17年后变成正向相关，从而使得rank IC均值降低。因此我又测算了rank IC绝对值的均值，发现风格类因子的绝对值均值仍保持在较高水平，说明风格类因子仍然时有效的。</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-f47945acaaa2ab6c66d15eb0dc209041_b.jpg" data-caption="" data-size="normal" data-rawwidth="864" data-rawheight="672" class="origin_image zh-lightbox-thumb" width="864" data-original="https://pic2.zhimg.com/v2-f47945acaaa2ab6c66d15eb0dc209041_r.jpg"/></noscript><img src="https://pic2.zhimg.com/v2-f47945acaaa2ab6c66d15eb0dc209041_b.jpg" data-caption="" data-size="normal" data-rawwidth="864" data-rawheight="672" class="origin_image zh-lightbox-thumb lazy" width="864" data-original="https://pic2.zhimg.com/v2-f47945acaaa2ab6c66d15eb0dc209041_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-f47945acaaa2ab6c66d15eb0dc209041_b.jpg"/></figure><p>不同因子随时间的IC值如下：</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-5a703f45904cfd1b01a35ecafedc22fd_b.jpg" data-caption="" data-size="normal" data-rawwidth="724" data-rawheight="1027" class="origin_image zh-lightbox-thumb" width="724" data-original="https://pic2.zhimg.com/v2-5a703f45904cfd1b01a35ecafedc22fd_r.jpg"/></noscript><img src="https://pic2.zhimg.com/v2-5a703f45904cfd1b01a35ecafedc22fd_b.jpg" data-caption="" data-size="normal" data-rawwidth="724" data-rawheight="1027" class="origin_image zh-lightbox-thumb lazy" width="724" data-original="https://pic2.zhimg.com/v2-5a703f45904cfd1b01a35ecafedc22fd_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-5a703f45904cfd1b01a35ecafedc22fd_b.jpg"/></figure><p>可以看出：<b>风格类因子（典型如PB值、市值对数）在后期逐渐出现反转趋势。</b>技术类因子与收益率大体呈反向关系。基本面因子中，销售毛利率、净利润同比增长率、销售净利率等具有出色表现，而经营净现金流/净收益、经营净现金流/营业收入等效果不显著。</p><h2><b>构建医疗板块多因子模型</b></h2><p>根据研报内容，本文先通过逐步筛选法筛选出选股效果最为显著的因子，然后通过因子在不同时间段的rank IC值对因子进行赋权，形成新的组合因子。通过组合因子进行选股。</p><p><b>&gt;&gt;&gt;    逐步筛选法</b></p><p>筛选因子过程中，本文采用了<b>线性回归WLS模型</b>。</p><p>模型将股票收益率看做是能用若干因子作为自变量的WLS线性回归模型进行解释的因变量。</p><p>本文通过以下筛选条件筛选因子：</p><ul><li><b>已选因子f的WLS模型系数显著</b></li><li><b>在满足条件一的备选因子中，因子f能使模型新增调整R方最大</b></li></ul><p>通过以上条件，筛选出如下的因子表：</p><p><b>显著性水平=0.2：</b><br/>PB值、市值对数、换手率、ROE</p><p><b>显著性水平=0.3：</b><br/>PB值、市值对数、换手率、ROE、销售毛利率、营业收入同比增长率、营业利润/营业收入</p><p><b>&gt;&gt;&gt;    多因子模型</b></p><p>通过以上所选因子，合成新的组合因子。因子的权重为学习周期内各因子的IC均值。然后选取组合因子分数最高的20只股票构建等权组合。</p><p>具体参数如下：</p><p><b>调仓周期：</b>1个月<br/><b>学习周期：</b>12个月<br/><b>购买股票数量：</b>20<br/><b>回测周期：</b>2010年1月1日——2018年8月1日<br/><b>因子池：</b>显著性水平=0.2的因子（显著性水平=0.3的因子也有测试，收益率相差不大但是最大回撤会放大）</p><p>在测试中，学习周期为24个月的回测结果不如学习周期为12个月的回测结果。</p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-35d842f07d9ab21d25bf69f5435e614f_b.jpg" data-caption="" data-size="normal" data-rawwidth="1448" data-rawheight="475" class="origin_image zh-lightbox-thumb" width="1448" data-original="https://pic4.zhimg.com/v2-35d842f07d9ab21d25bf69f5435e614f_r.jpg"/></noscript><img src="https://pic4.zhimg.com/v2-35d842f07d9ab21d25bf69f5435e614f_b.jpg" data-caption="" data-size="normal" data-rawwidth="1448" data-rawheight="475" class="origin_image zh-lightbox-thumb lazy" width="1448" data-original="https://pic4.zhimg.com/v2-35d842f07d9ab21d25bf69f5435e614f_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-35d842f07d9ab21d25bf69f5435e614f_b.jpg"/></figure><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-0cfe2976bfd7279186d2f5c9013a6a73_b.jpg" data-caption="" data-size="normal" data-rawwidth="1447" data-rawheight="538" class="origin_image zh-lightbox-thumb" width="1447" data-original="https://pic4.zhimg.com/v2-0cfe2976bfd7279186d2f5c9013a6a73_r.jpg"/></noscript><img src="https://pic4.zhimg.com/v2-0cfe2976bfd7279186d2f5c9013a6a73_b.jpg" data-caption="" data-size="normal" data-rawwidth="1447" data-rawheight="538" class="origin_image zh-lightbox-thumb lazy" width="1447" data-original="https://pic4.zhimg.com/v2-0cfe2976bfd7279186d2f5c9013a6a73_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-0cfe2976bfd7279186d2f5c9013a6a73_b.jpg"/></figure><p>学习周期为6个月的回测结果也不如学习周期为12个月的回测结果。</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-6b1b39a64544156992f607df10cd57b1_b.jpg" data-caption="" data-size="normal" data-rawwidth="1442" data-rawheight="468" class="origin_image zh-lightbox-thumb" width="1442" data-original="https://pic2.zhimg.com/v2-6b1b39a64544156992f607df10cd57b1_r.jpg"/></noscript><img src="https://pic2.zhimg.com/v2-6b1b39a64544156992f607df10cd57b1_b.jpg" data-caption="" data-size="normal" data-rawwidth="1442" data-rawheight="468" class="origin_image zh-lightbox-thumb lazy" width="1442" data-original="https://pic2.zhimg.com/v2-6b1b39a64544156992f607df10cd57b1_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-6b1b39a64544156992f607df10cd57b1_b.jpg"/></figure><p>该模型策略年化收益达到<b>28.19%</b>，也具有较为明显的超额收益。</p><h2><b>总结</b></h2><p>常见选股因子在医药行业内存在显著选股效果。风格类因子收益高但稳定性较差，从17年后存在反转趋势。技术类因子较为有效，与收益率呈显著负相关性。基本面因子则部分有效部分不有效。总体而言，企业盈利能力越高，资产增长越快，利润增长越快，盈利质量越好，偿债能力越强，股票收益表现越优。</p><hr/><p>点击下方链接，即可查看<b>完整回测源代码</b></p><a href="https://link.zhihu.com/?target=https%3A//www.joinquant.com/view/community/detail/3b4e952bf277d3f59a7fea1e62dcddaf%3Ftype%3D1" data-draft-node="block" data-draft-type="link-card" class=" wrap external" target="_blank" rel="nofollow noreferrer">加载中</a><p></p>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
