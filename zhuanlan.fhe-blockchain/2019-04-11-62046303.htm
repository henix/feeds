<p></p><p><b>术语：</b></p><p><b>明文(plaintext or cleartext)</b>：发送者想要传送给接收者的可理解消息</p><p><b>密码(ciphertext):</b> 使用密码系统的明文加密生成无法理解的消息</p><p><b>加密(encryption):</b> 将明文转换为密文的过程</p><p><b>解密(decryption):</b> 将密文转换为明文的过程（加密反向）</p><p class="ztext-empty-paragraph"><br/></p><h2><b>传统密码学：</b></h2><p>它也称为对称密钥或共享密钥加密。同一个密钥用于加密和解密消息。将下面这个例子视为传统加密：</p><p>你和你的室友都使用相同的钥匙来锁定/解锁你家的门。因此，您共享相同的密钥以保护房间。确实，你的室友可以有你的钥匙副本，这样他就可以在你工作时进入房间，反之亦然。</p><p class="ztext-empty-paragraph"><br/></p><p>使用对称密钥的传统密码系统算法：数据加密标准（DES），高级加密标准（AES）</p><p>优点：快速。</p><p>缺点：不安全！<br/>发送方和接收方必须就密钥达成一致，并阻止其他人访问密钥。(这样做)有一个大的问题，如果两者不在同一物理位置，该如何发布密钥。你在中国的时候怎么能把你的钥匙给你在美国的室友呢！</p><p class="ztext-empty-paragraph"><br/></p><p>实用建议：对每条消息加密后都要更改对称密钥，以便在发生灾难时（密码分析，窃取等）只能泄漏一条消息。</p><p class="ztext-empty-paragraph"><br/></p><p>密钥分发</p><p>在上一段中，我们讨论的了密码系统使用对称密钥，以及缺乏与室友安全共享密钥的有效方式。密钥分发有助于解决这个缺点。接下来，我们将解释如何通过不受信任的通信通道进行密钥交换。</p><p class="ztext-empty-paragraph"><br/></p><p>Diffie-Hellman key exchange (Diffie-Hellman密钥交换)</p><p>这种密钥交换基于一种算法，该算法在数学上不能在合理的时间内轻松地计算大数的离散对数。在使用数字和抽象公式直接运行之前，我们将使用颜色概述算法。</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-844eab87a51441a9efeed6609978a579_b.jpg" data-caption="" data-size="normal" data-rawwidth="441" data-rawheight="660" class="origin_image zh-lightbox-thumb" width="441" data-original="https://pic2.zhimg.com/v2-844eab87a51441a9efeed6609978a579_r.jpg"/></noscript><img src="https://pic2.zhimg.com/v2-844eab87a51441a9efeed6609978a579_b.jpg" data-caption="" data-size="normal" data-rawwidth="441" data-rawheight="660" class="origin_image zh-lightbox-thumb lazy" width="441" data-original="https://pic2.zhimg.com/v2-844eab87a51441a9efeed6609978a579_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-844eab87a51441a9efeed6609978a579_b.jpg"/></figure><p class="ztext-empty-paragraph"><br/></p><p>11. 第1步：Alice和Bob达成了共同颜色的协议。</p><p>2. 第2步：Alice选择她不会告诉Bob的秘密颜色。鲍勃会做同样的事情。</p><p>3. 步骤3：Alice将共同颜色与秘密颜色混合，结果是混合物。Bob也将他的秘密颜色与普通颜色混合，并将会得到不同于alice的混合物。</p><p>4. 步骤4：Alice和Bob交换混合物。这是沟通中最关键的一步，因为”中间人攻击(man-in-the-middle)”可以访问这两种混合物。如果中间人有双方的混合物，这也将会是一个问题。颜色分解是不可逆的。因此，找到两个秘密颜色的唯一机会是将所有可能的颜色与第一步中的常见颜色混合。此外，请记住，秘密颜色也可以是许多其他颜色的混合。</p><p class="ztext-empty-paragraph"><br/></p><p>更新：Diffie-Hellman不会保护您免受中间人攻击。为了了解原因，想象一下攻击者从Alice接收所有消息并将其重播回Bob。</p><p>5. 步骤5：Alice将再次将她的秘密颜色添加到Bob发送给她的混合物中。鲍勃将遵循相同的步骤。</p><p>最后Alice和Bob将获得一个共同的秘密颜色。现在，Alice和Bob可以安全地交换我们在前一章中讨论的对称密钥，因为他们可以使用上述秘密颜色加密和解密任何消息（通过通信信道发送）。</p><p> 数学来了，当我们没有足够的颜色时，总是关于数学。</p><p> 步骤1：Alice和Bob达成了两个大数的协议：一个素数p（推荐至少512位）和一个基数g（p的原始根模量）。</p><p class="ztext-empty-paragraph"><br/></p><p class="ztext-empty-paragraph"><br/></p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-874c2a6afa8ca1bbcec218959d4bbd38_b.jpg" data-caption="" data-size="normal" data-rawwidth="234" data-rawheight="114" class="content_image" width="234"/></noscript><img src="https://pic1.zhimg.com/v2-874c2a6afa8ca1bbcec218959d4bbd38_b.jpg" data-caption="" data-size="normal" data-rawwidth="234" data-rawheight="114" class="content_image lazy" width="234" data-actualsrc="https://pic1.zhimg.com/v2-874c2a6afa8ca1bbcec218959d4bbd38_b.jpg"/></figure><p class="ztext-empty-paragraph"><br/></p><p>步骤 2:Alice选择一个秘密的整数 a  。 Bob 选择一个秘密整数 b。</p><p class="ztext-empty-paragraph"><br/></p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-10e14fbbcaaa7afc388b24e0d402082f_b.jpg" data-caption="" data-size="normal" data-rawwidth="252" data-rawheight="120" class="content_image" width="252"/></noscript><img src="https://pic4.zhimg.com/v2-10e14fbbcaaa7afc388b24e0d402082f_b.jpg" data-caption="" data-size="normal" data-rawwidth="252" data-rawheight="120" class="content_image lazy" width="252" data-actualsrc="https://pic4.zhimg.com/v2-10e14fbbcaaa7afc388b24e0d402082f_b.jpg"/></figure><p class="ztext-empty-paragraph"><br/></p><p>步骤3：Alice计算公共值x = g ^ a mod p。 Bob计算公共值y = g ^ b mod p，其中mod是模运算符。</p><p>步骤4：Alice和Bob交换x和y。</p><p>步骤5：Alice计算她的秘密密钥k_a = y ^ a mod p。Bob计算他的秘密密钥k_b = x ^ b mod p。在数学上可以证明k_a = k_b。 Alice和Bob现在有一个共同的密钥，用于加密和解密他们想要安全交换的明文</p><p>例子:</p><p class="ztext-empty-paragraph"><br/></p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-56dfb00cc653ecc5661765616bd69ac6_b.jpg" data-caption="" data-size="normal" data-rawwidth="719" data-rawheight="377" class="origin_image zh-lightbox-thumb" width="719" data-original="https://pic3.zhimg.com/v2-56dfb00cc653ecc5661765616bd69ac6_r.jpg"/></noscript><img src="https://pic3.zhimg.com/v2-56dfb00cc653ecc5661765616bd69ac6_b.jpg" data-caption="" data-size="normal" data-rawwidth="719" data-rawheight="377" class="origin_image zh-lightbox-thumb lazy" width="719" data-original="https://pic3.zhimg.com/v2-56dfb00cc653ecc5661765616bd69ac6_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-56dfb00cc653ecc5661765616bd69ac6_b.jpg"/></figure><p class="ztext-empty-paragraph"><br/></p><p>如果中间人知道秘密整数a = 6和b = 15，他可以找到用于通信的秘密密钥。方法如下：</p><p class="ztext-empty-paragraph"><br/></p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-2b8efb059146927dbb073697bc4fb09f_b.png" data-caption="" data-size="normal" data-rawwidth="688" data-rawheight="96" class="origin_image zh-lightbox-thumb" width="688" data-original="https://pic4.zhimg.com/v2-2b8efb059146927dbb073697bc4fb09f_r.jpg"/></noscript><img src="https://pic4.zhimg.com/v2-2b8efb059146927dbb073697bc4fb09f_b.png" data-caption="" data-size="normal" data-rawwidth="688" data-rawheight="96" class="origin_image zh-lightbox-thumb lazy" width="688" data-original="https://pic4.zhimg.com/v2-2b8efb059146927dbb073697bc4fb09f_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-2b8efb059146927dbb073697bc4fb09f_b.png"/></figure><p class="ztext-empty-paragraph"><br/></p><p>优点：安全。避免中间人攻击。</p><p>缺点：您无法确定真正的&#39;Bob&#39;的实际身份。(无法确定’Bob’的真实身份)</p><p>也可以使用XOR（异或）运算符来解释Diffie-Hellman:</p><p>假设Alice想要将消息 ’M = Hello‘ 发送给Bob。消息M的二进制表示是B（M）= 0100100001100101011011000110110001101111。Alice用秘钥K = 1010101000101110100101010001110010101010加密消息。</p><p class="ztext-empty-paragraph"><br/></p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-e21b40c159473fd44e4a2d4876908b80_b.jpg" data-caption="" data-size="normal" data-rawwidth="728" data-rawheight="219" class="origin_image zh-lightbox-thumb" width="728" data-original="https://pic1.zhimg.com/v2-e21b40c159473fd44e4a2d4876908b80_r.jpg"/></noscript><img src="https://pic1.zhimg.com/v2-e21b40c159473fd44e4a2d4876908b80_b.jpg" data-caption="" data-size="normal" data-rawwidth="728" data-rawheight="219" class="origin_image zh-lightbox-thumb lazy" width="728" data-original="https://pic1.zhimg.com/v2-e21b40c159473fd44e4a2d4876908b80_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-e21b40c159473fd44e4a2d4876908b80_b.jpg"/></figure><p class="ztext-empty-paragraph"><br/></p><p>加密消息L的明文的等效消息是&amp;#226;K&amp;#249;p&amp;#197; 。Bob收到&amp;#226;K&amp;#249;p&amp;#197;，并使用已经与Alice交换的相同的密钥K来解密消息。</p><p class="ztext-empty-paragraph"><br/></p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-bd2f1feddfb974c8fa6a7023cdd630a7_b.jpg" data-caption="" data-size="normal" data-rawwidth="732" data-rawheight="216" class="origin_image zh-lightbox-thumb" width="732" data-original="https://pic4.zhimg.com/v2-bd2f1feddfb974c8fa6a7023cdd630a7_r.jpg"/></noscript><img src="https://pic4.zhimg.com/v2-bd2f1feddfb974c8fa6a7023cdd630a7_b.jpg" data-caption="" data-size="normal" data-rawwidth="732" data-rawheight="216" class="origin_image zh-lightbox-thumb lazy" width="732" data-original="https://pic4.zhimg.com/v2-bd2f1feddfb974c8fa6a7023cdd630a7_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-bd2f1feddfb974c8fa6a7023cdd630a7_b.jpg"/></figure><p class="ztext-empty-paragraph"><br/></p><p class="ztext-empty-paragraph"><br/></p><p>为什么这个算法很重要？因为像SSL，TLS，SSH，IPSec ,  PKI的协议，都使用Diffie-Hellman。</p><p class="ztext-empty-paragraph"><br/></p><p class="ztext-empty-paragraph"><br/></p><p class="ztext-empty-paragraph"><br/></p><p class="ztext-empty-paragraph"><br/></p><p>==========================================================================</p><p><b>文章首发在微信公众号：btc201800</b><br/><b>知识星球ID：28018093</b></p><p><br/><b>音频发布在喜马拉雅上“区块链杂谈 (第2季)”</b> <b><u><a href="https://link.zhihu.com/?target=http%3A//xima.tv/Bjq4se" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">http://</span><span class="visible">xima.tv/Bjq4se</span><span class="invisible"></span></a></u></b></p><p><b>解读区块链白皮书</b> <u><a href="https://link.zhihu.com/?target=http%3A//xima.tv/RNU1Q8" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">http://</span><span class="visible">xima.tv/RNU1Q8</span><span class="invisible"></span></a></u></p><p><br/><b>宁波格密链网络科技有限公司，专注于区块链上的密码技术研发。</b></p>