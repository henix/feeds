<div class="title-image"><img src="https://pic1.zhimg.com/13e07d74f57d884152225de0ce3e1bca_b.jpg" alt=""></div>CAPM模型认为，收益风险同源。市场风险是唯一能给股票带来超额收益的风险。但是事实上除了市场风险外，Fama-French认为市场上还存在市值风险，账面市值比风险等，据此建立的模型被称为“Fama-French三因子模型”。本文旨在深入浅出介绍三因子模型的思想并提供一个实用的三因子策略。<figure><noscript><img src="https://pic2.zhimg.com/3b20972c5b3b8d3d858d421c3c7ad211_b.jpg" data-rawheight="345" data-rawwidth="257" class="content_image" width="257"/></noscript><img src="https://pic2.zhimg.com/3b20972c5b3b8d3d858d421c3c7ad211_b.jpg" data-rawheight="345" data-rawwidth="257" class="content_image lazy" width="257" data-actualsrc="https://pic2.zhimg.com/3b20972c5b3b8d3d858d421c3c7ad211_b.jpg"/></figure><p>本文由JoinQuant量化课堂推出 。难度标签为进阶上，理解深度标签：level-0</p><p><b>一、</b><b>Fama-French</b><b>三因子模型概述</b></p><p>看到CAPM模型，大家有没有想过，为什么有的股票有正的超额收益，有的股票的超额收益却是负的？是不是市场风险不能够完全解释个股的超额收益？</p><p> 是的。</p><p> Fama和French这两个人研究股票超额收益率的时候发现了一个神奇的现象：有两类股票的历史平均收益率一般会高于CAPM模型所预测的收益率。它们是小公司股票、以及具有较高股权账面-市值比的股票。Fama和French认为分别分析了两种原因，认为：</p><p>1）市值比较小的公司通常规模比较小，公司相对而言没那么稳定，因此风险较大，需要获得更高的收益来偿；</p><p>2）账面市值比就是账面的所有者权益除以市值（下以简称B/M）。B/M较高则说明市场上对公司的估值比公司自己的估值更低。这些公司一般都是销售状况或者盈利能力不是十分好的公司，因此相对于低B/M的公司来说需要更高的收益来补偿。</p><p> 这个三因子模型的本质就是把CAPM中的<img src="https://www.zhihu.com/equation?tex=%5Calpha+" alt="\alpha " eeimg="1"/>（未被解释的超额收益）分解掉，将其分解成市值因素、B/M因素和其他未被解释的因素（可以看成是新的<img src="https://www.zhihu.com/equation?tex=%5Calpha+" alt="\alpha " eeimg="1"/>），可以用如下公式表达：</p><figure><noscript><img src="https://pic3.zhimg.com/3707bca196853e1ea8c32c0aa34d2232_b.png" data-rawheight="32" data-rawwidth="390" class="content_image" width="390"/></noscript><img src="https://pic3.zhimg.com/3707bca196853e1ea8c32c0aa34d2232_b.png" data-rawheight="32" data-rawwidth="390" class="content_image lazy" width="390" data-actualsrc="https://pic3.zhimg.com/3707bca196853e1ea8c32c0aa34d2232_b.png"/></figure><p>其中<img src="https://www.zhihu.com/equation?tex=R_%7Bi%7D+%3DE%28r_%7Bi%7D-r_%7Bf%7D%29" alt="R_{i} =E(r_{i}-r_{f})" eeimg="1"/>,指股票i比起无风险投资的期望超额收益率。<img src="https://www.zhihu.com/equation?tex=R_%7BM%7D+%3DE%28r_%7BM%7D-r_%7Bf%7D%29" alt="R_{M} =E(r_{M}-r_{f})" eeimg="1"/>,为市场相对无风险投资的期望超额收益率，E(SMB)是小市值公司相对大市值公司股票的期望超额收益率,E(HMI)则是高B/M公司股票比起低B/M的公司股票的期望超额收益率，而<img src="https://www.zhihu.com/equation?tex=%5Cvarepsilon_%7Bi%7D+" alt="\varepsilon_{i} " eeimg="1"/>是回归残差项。</p><p><b>二、对三因子模型的理解</b></p><p>上面这个三因子模型和CAMP模型在表达式上面的区别就是多了几个回归的自变量。因此，打眼一看，不少的读者（包括小编第一次接触的时候）可能会觉得这个模型只是为传统多因子模型提供了两个因子（市值、B/M）而已，然后用传统的因子打分、回归等方法进行选股。<br/></p><p>小编只想说，然而并不是这样。</p><p> 诚然，上面这种理解也可以用来建模，但它并不是本来Fama和French想表达的！那么他们究竟想说什么呢？我们再仔细看一下三因子模型的表达式：</p><figure><noscript><img src="https://pic1.zhimg.com/a40bd864f6b176167964367156752f34_b.png" data-rawheight="41" data-rawwidth="469" class="origin_image zh-lightbox-thumb" width="469" data-original="https://pic1.zhimg.com/a40bd864f6b176167964367156752f34_r.jpg"/></noscript><img src="https://pic1.zhimg.com/a40bd864f6b176167964367156752f34_b.png" data-rawheight="41" data-rawwidth="469" class="origin_image zh-lightbox-thumb lazy" width="469" data-original="https://pic1.zhimg.com/a40bd864f6b176167964367156752f34_r.jpg" data-actualsrc="https://pic1.zhimg.com/a40bd864f6b176167964367156752f34_b.png"/></figure><p>这个E(SMB)如何理解呢？Fama把市场里面的所有股票按市值排序，然后等分成三份：第一份是大市值股票（市值在所有股票中最大的1/3），第二份是中市值股票，第三份是小市值股票（市值在所有股票中最小的1/3）。记大市值股票的平均期望收益率为<img src="https://www.zhihu.com/equation?tex=E_%7Br_%7BS%7D+%7D+" alt="E_{r_{S} } " eeimg="1"/>,小市值股票的期望收益率为<img src="https://www.zhihu.com/equation?tex=E_%7Br_%7BB%7D+%7D+" alt="E_{r_{B} } " eeimg="1"/>,那么<img src="https://www.zhihu.com/equation?tex=E%28SMB%29%3D" alt="E(SMB)=" eeimg="1"/><img src="https://www.zhihu.com/equation?tex=E_%7Br_%7BS%7D+%7D+" alt="E_{r_{S} } " eeimg="1"/>-<img src="https://www.zhihu.com/equation?tex=E_%7Br_%7BB%7D+%7D+" alt="E_{r_{B} } " eeimg="1"/>。E（HMI）的定义也类似。</p><p>小编认为，三因子模型的贡献，在于发现了股票的期望收益不仅仅与市场的系统风险有关，还和市值风险和账面市值比风险有关。市值和B/M这一类因子是对市场整体进行一个衡量的，而不是对个股的衡量。</p><p> 对于市场的衡量，我们也可以用多元线性回归的方法来估计。三因子模型的表达式中<img src="https://www.zhihu.com/equation?tex=a_%7Bi%7D%2Cb_%7Bi%7D%2Cs_%7Bi%7D%2Ch_%7Bi%7D++" alt="a_{i},b_{i},s_{i},h_{i}  " eeimg="1"/>都是回归系数，<img src="https://www.zhihu.com/equation?tex=b_%7Bi%7D+" alt="b_{i} " eeimg="1"/>描述的是股票本身的市场方面风险的大小，<img src="https://www.zhihu.com/equation?tex=s_%7Bi%7D" alt="s_{i}" eeimg="1"/>描述的是股票本身的市值方面风险的大小，<img src="https://www.zhihu.com/equation?tex=h_%7Bi%7D+" alt="h_{i} " eeimg="1"/>描述的是股票本身的账面市值比方面风险的大小。</p><p><b>三、</b><b>FF</b><b>三因子模型套利法选股</b></p><p>举一个具体应用的例子：</p><p>我们再看一眼三因子模型的表达式（是最后一眼了，各位别烦躁）：</p><figure><noscript><img src="https://pic1.zhimg.com/84674c7d140339a54a9155c211b0ebe8_b.png" data-rawheight="37" data-rawwidth="469" class="origin_image zh-lightbox-thumb" width="469" data-original="https://pic1.zhimg.com/84674c7d140339a54a9155c211b0ebe8_r.jpg"/></noscript><img src="https://pic1.zhimg.com/84674c7d140339a54a9155c211b0ebe8_b.png" data-rawheight="37" data-rawwidth="469" class="origin_image zh-lightbox-thumb lazy" width="469" data-original="https://pic1.zhimg.com/84674c7d140339a54a9155c211b0ebe8_r.jpg" data-actualsrc="https://pic1.zhimg.com/84674c7d140339a54a9155c211b0ebe8_b.png"/></figure><p>如果默认三因子模型是正确的，而且市场风险、市值风险、账面市值比这三类风险能很好地解释个股的超额收益，<img src="https://www.zhihu.com/equation?tex=a_%7Bi%7D+" alt="a_{i} " eeimg="1"/>的长期均值应该是0。那么，如果对于某个时期的股票，回归得到<img src="https://www.zhihu.com/equation?tex=a_%7Bi%7D+%3C0" alt="a_{i} &lt;0" eeimg="1"/>,说明这段时间里面收益率偏低（因此股价也偏低），而根据有效市场假设，出来混总是要还的，今天的偏离在未来要涨回来的。所以我们的选股思路非常简单，就是先设定一个调仓频率，比如每T天调仓一次，然后设定一个样本长度，比如S天。然后在调仓日对于过去S天的数据进行回归分析，计算出每个股票在过去的S天里面的<img src="https://www.zhihu.com/equation?tex=a_%7Bi%7D+" alt="a_{i} " eeimg="1"/>观测值，然后买入<img src="https://www.zhihu.com/equation?tex=a_%7Bi%7D+" alt="a_{i} " eeimg="1"/>最小的N支股票即可。2006年至今的收益率高达1484%，不仅跑赢了大盘，还跑赢了不少转化为多因子模型的方法的选股策略。下图表示这个策略的收益情况：</p><p><figure><noscript><img src="https://pic1.zhimg.com/c73a0524f0b0fc56aca518d2f88b2b74_b.png" data-rawheight="288" data-rawwidth="1146" class="origin_image zh-lightbox-thumb" width="1146" data-original="https://pic1.zhimg.com/c73a0524f0b0fc56aca518d2f88b2b74_r.jpg"/></noscript><img src="https://pic1.zhimg.com/c73a0524f0b0fc56aca518d2f88b2b74_b.png" data-rawheight="288" data-rawwidth="1146" class="origin_image zh-lightbox-thumb lazy" width="1146" data-original="https://pic1.zhimg.com/c73a0524f0b0fc56aca518d2f88b2b74_r.jpg" data-actualsrc="https://pic1.zhimg.com/c73a0524f0b0fc56aca518d2f88b2b74_b.png"/></figure>这个策略的Alpha高达18.4%，而且beta非常接近1，因此可以使用沪深300指数来对冲市场风险从而获得超额收益，下图表示这个策略的净值和沪深300组合的净值的比值：<br/></p><figure><noscript><img src="https://pic2.zhimg.com/4c43b2ed214ca6eef1044af44c296a91_b.png" data-rawheight="477" data-rawwidth="648" class="origin_image zh-lightbox-thumb" width="648" data-original="https://pic2.zhimg.com/4c43b2ed214ca6eef1044af44c296a91_r.jpg"/></noscript><img src="https://pic2.zhimg.com/4c43b2ed214ca6eef1044af44c296a91_b.png" data-rawheight="477" data-rawwidth="648" class="origin_image zh-lightbox-thumb lazy" width="648" data-original="https://pic2.zhimg.com/4c43b2ed214ca6eef1044af44c296a91_r.jpg" data-actualsrc="https://pic2.zhimg.com/4c43b2ed214ca6eef1044af44c296a91_b.png"/></figure><p>从这个图中我们可以看出，虽然在熊市的时候回撤较大，但是如果用适合仓位的沪深300股指期货进行对冲的话，收益还是比较稳定的，因此说明了这个策略还是非常有效的。</p><p>好啦，本篇到此为止，欢迎关注后续文章！</p><p><i>本文由JoinQuant量化课堂推出，版权归JoinQuant所有，商业转载请联系我们获得授权，非商业转载请注明出处。</i><br/></p><p>策略源码见 <a class=" external" href="https://link.zhihu.com/?target=https%3A//www.joinquant.com/post/1668" target="_blank" rel="nofollow noreferrer"><span class="invisible">https://www.</span><span class="visible">joinquant.com/post/1668</span><span class="invisible"></span></a></p>