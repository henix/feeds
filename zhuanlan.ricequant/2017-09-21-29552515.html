<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Tesnor Ridge Regression 与多信息源因子张量表征</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/29552515">原文</a></p>
<div class="title-image"><img src="https://pic4.zhimg.com/v2-304680848d5fffaeb5fdf90a23c096eb_r.jpg" alt=""></div><h2>首先给自己打个广告，应届小硕，求量化相关工作、实习。</h2><p>联系信箱：<a href="mailto:aidabloc@163.com">aidabloc@163.com</a></p><p># 2017-09-24 更新</p><p><a href="https://www.ricequant.com/community/topic/4097//3">简单示例代码</a></p><p><a href="https://github.com/AlphaSmartDog/DeepLearningNotes">github</a> markdown和pdf版本见github</p><p><br></p><p>本文先简单归纳《A Tensor-Based Information Framework for Predicting the Stock Market 》中介绍的一种探索多维数组（张量）表征多因子并计算不同因子抽象关系并降低维度的方法，然后归纳《Tensor Learning for Regression 》中介绍的Tesnor Ridge Regression算法，通过CP分解张量降低需要估计回归系数（因子收益率）的数量。</p><p>股票趋势受各种高度相关信息的强烈影响，这通常涵盖经济学、政治学和心理学等多方面研究。传统的有效市场假说（EMH）指出，股价总是由“理性”的投资者驱动，股价等于公司预期未来现金流的理性现值。与市场有关的新信息可能会改变投资者的期望，并导致股价波动，这种对信息反应的分歧导致股价的实际价格与内在价值之间的差异。竞争市场参与者导致股价波动周围的股价内在价值，即新信息对股价产生复杂的影响。然而，股价并不严格遵循随机游走，行为金融研究将股票趋势的非随机性归结为投资者由于认知和情绪偏见的对不利消息的过度反应。虽然传统金融和行为金融均认为新的信息对股票趋势产生复杂影响。</p><p>A股市场刨除内幕等操作方法为，一般分为基本面分析和技术分析两类。基本面分析通常通过构建经济、商业和市场行业等多信息源的数据与股票未来走势之间的关系来预测股票趋势，即国家整体经济，行业条件，公司的财务状况和管理层能力等因素，可以深度拆解股价未来走势。技术分析通过历史股票趋势预测股价未来走势，技术分析流派认为股价市场是周期性或者类周期性的，并且具有特定的模式，这些模式随着时间的推移而重复出现。</p><p>受到移动互联网的影响，股票信息迅速更新并以前所未有的速度传播，并且通常在正式统计报告之前向投资者对投资者产生影响。用户参与社交媒体（包括评论，评分和投票）的变化可以更快速地互动交换信息。这种情况可能导致群体投资行为，因为投资者的决策倾向于受同行的情绪影响。目前常见的做法是使用NLP量化新闻和社交网络的新信息提供定性信息，如舆情指数。影响股票趋势的信息是多方面的且互相影响的，反映到因子数据方面就是存在多重共线性。</p><p>传统的线性回归将多个信息源（模式）的特征（无量纲因子）连接到一个复合特征的向量中处理。由于维度灾难和多重共线性，这种做法限制了多因子模型囊括因子数量。此外使用马赛克拼接(mosaic approach)通常包含各种信息源的混合和交互，但级联向量假设每个信息膜是是相互独立的。如下图这里，矩阵用于建模简化的投资信息源，其中每行代表一种信息模式，如企业信息、事件信息或情绪信息。根据马赛克拼接信息结构，特征模式可以存在于不同信息源（行）或不同模式之间。</p><img src="https://pic3.zhimg.com/v2-c183f6eb89b0937cde6d9d2ef72e0ace_r.jpg" data-rawwidth="492" data-rawheight="450"><p>如图右所示，删除马赛克信息结构并将各种信息模式的特征连接成一个复合特征向量，级联向量方法忽略了各种信息模式之间的固有链路导致明显的相似性的出现。除了在一个信息矩阵中捕获各种模式之间的这些静态互连之外，重要的是在一系列信息矩阵之间识别和强调各种模式之间的动态连接。例如，在不同时间发布的两篇新闻文章可能是文本上不相似的，但两者可能包含有关相同股价的有利信息。此外，在这两个时间点的相应的企业特定数据可能相似，可能表明良好的投资机会。在这种情况下，可以通过相应的基本面数据的相似性来增强不同文本信息处理、舆情指数相似性。捕捉，推论和加强各种信息模式之间的动态关系将有利于提高对股票趋势的预测能力。</p><p>此文中应用基于张量的信息框架来捕捉新信息与股票走势之间的非线性关系。该框架使用全局维数降低算法和基于张量的回归获取多信息源之前的非线性关系，并研究这些信息源对股票趋势的影响。影响股票走势的各种信息因素，在过去已被广泛研究。 传统金融主要集中在企业特定因素的长期影响上，而现代行为金融主要集中在公众情绪和当前事件造成的短期影响。此文试图通过建立多维度模型处理各种信息源对股票趋势的共同影响。这里将信息按照信息源分成三类：(a) 企业特定模型信息模式：主要指企业的基本面和量价因子；(b) 事件特定模式：主要指新闻资讯对股价走势的影响，受新信息的影响，股票投资者不断更新他们公司经营情况等基本面及股价走势的看法或非理性投资者的情绪。具体来说，可以对相关新闻文章使用词向量表示，其中每个条目是名词和情感词的加权。(c) 情绪特定模式：发达的社交媒体使一部分投资者潜意识群体和情绪的影响，这可能导致投资者的群体性行为。</p><img src="https://pic1.zhimg.com/v2-00f20dcb02aa630dbd842bdfa6f06008_r.jpg" data-rawwidth="757" data-rawheight="286"><p>可以使用张量处理多信息源信息的相互关联特性，这里使用三阶张量表示三种不同的信息模式。将三种不同信息源的信息（因子）填入张量不同维度（形成一个稀疏张量），如下图，应用张量分解和重构来降低维度，加强不同信息模式的内在联系。通过使用张量分解子空间中的因子矩阵来实现从张量序列的几何结构中识别出几个信息源之间的深层关联。使用Tucker分解因子张量 <equation>\mathcal{X}_i = \mathcal{C}_i \times_1 U^{i_1} \times_2 U^{i}_2 \times_3U^{i}_3</equation> 使用GDR算法计算因子矩阵修正矩阵并重新合成信息因子张量 <equation>\bar{\mathcal{X}_i} = \mathcal{C}_i \times_1(V^T_1 U^{i_1}) \times_2 (V^T_2 U^{i}_2) \times_3(V^T_3U^{i}_3)</equation> 这样多信息源的原始因子稀疏张量转化为低维度的密集因子张量。 <equation>\mathcal{X}\in\mathbb{R}^{I_1 \times I_2 \times I_3} \to \bar{\mathcal{X}} \in \mathbb{R}^{J_1 \times J_2 \times J_3}</equation> </p><img src="https://pic4.zhimg.com/v2-f6a19338c7e18b02b4fa73b1e9eece83_r.jpg" data-rawwidth="659" data-rawheight="449"><p>尽管通过前述步骤分解-重构技术可以大大压缩稀疏的因子张量的体积规模，然而使用传统的方法如张量向量化估计张量回归权重系数依然具有较大的难度。例如对形状为[30, 30, 10]因子张量进行回归，张量向量化的处理方法导致权重系数张量需要估计 <equation>30 \times 30 \times 10 = 9000</equation> 个权重参数（标量），对于传统多因子模型这显然是不实用。可以通过使用张量分解的方法（如CP分解）大幅度降低所需估计的权重系数的数量，从而将张量回归方法嵌入传统多因子体系中。例如在《Tensor Learning for Regression 》介绍的tensor ridge regression。对上面的假设，使用CP分解权重张量之后，例如分解为4个坐标基（秩一张量）累加和则只需要估计 <equation>(30 + 30 +10) \times 4 =280</equation> 个权重参数。</p><p><equation>y_i = \left&lt;\mathcal{X},\mathcal{W} \right &gt; + b\\=\left&lt; \mathcal{X}, \sum\limits^R_{r=1} u^{(1)}_r \circ u^{(2)}_r \circ \cdots \circ u^{(M)}_r \right&gt; + b\\=\sum\limits^R_{r=1} \left&lt; \mathcal{X}, u^{(1)}_r \circ u^{(2)}_r \circ \cdots \circ u^{(M)}_r \right&gt; + b\\=\sum \limits ^{R} _{r=1} \mathcal{X} \prod^{M_{k=1}} \times_k u^{(k)}_r</equation> </p><p>对一组给定的有标签训练集 <equation> \{ \mathcal{X}_i ,y_i \}^N_{i=1}</equation> 其中 <equation>\mathcal{X}_i = \mathbb{R}^{I_1 \times \cdots I_M}</equation> 为 <equation>M-mode</equation> 张量， <equation>y_i</equation> 为对应的标量标签。评估权重参数的目标函数可以写作</p><p><equation>\mathcal{L} (\mathcal{W},b) = \frac{1}{2} \sum\limits^{N}_{i=1} l(y_i, f(\mathcal{X}_i, \Theta)) + \frac{1}{2} \psi(\Theta)</equation> </p><p>其中 <equation>l(\cdot)</equation>  偏差损失函数， <equation>\psi (\cdot)</equation> 惩罚函数。当使用响应变量和标签差最小平方和作为损失函数的时候就是张量形式的最小二乘估计，添加2范数作为惩罚函数便得到张量形式的岭回归。在不使用惩罚项修正权重参数的时候，即张量形式的最小二乘回归中偏置 <equation>b</equation> 直接使用上式得出，在使用 <equation>L2-norm</equation> 修正权重参数的时候由于偏置权重参数同时被修正，这导致常数偏置项的错误。所以TRR的常数偏置应该使用无偏置回归的残差平均值获得，也就是使用无偏置回归模型的残差平均值计算偏置，但哑变量表示的行业收益率可以直接计算。</p><img src="https://pic3.zhimg.com/v2-766f25ec71f543f54106ca3a798c8365_r.jpg" data-rawwidth="1536" data-rawheight="2048"><img src="https://pic1.zhimg.com/v2-3e80118e549b46ad6ffc8e3fd9feb230_r.jpg" data-rawwidth="1536" data-rawheight="2048"><img src="https://pic1.zhimg.com/v2-1e35320d4b6cf72e0426b88d3fa4cba5_r.jpg" data-rawwidth="1536" data-rawheight="2048"><img src="https://pic4.zhimg.com/v2-cf78e4ba6c66413219ff91cc8695b939_r.jpg" data-rawwidth="1536" data-rawheight="2048"><img src="https://pic4.zhimg.com/v2-6ef8f43dce71dcc8f86beaabe4857f81_r.jpg" data-rawwidth="1536" data-rawheight="2048"><img src="https://pic3.zhimg.com/v2-c230b4ee9d129531aee7f4ba71c30d29_r.jpg" data-rawwidth="1536" data-rawheight="2048"><img src="https://pic4.zhimg.com/v2-6af4a1b8e18ec42b1a58989c279b36d4_r.jpg" data-rawwidth="1536" data-rawheight="2048"><img src="https://pic3.zhimg.com/v2-f865ae64e54fa36b36a264b40f3aac50_r.jpg" data-rawwidth="1536" data-rawheight="2048"><img src="https://pic1.zhimg.com/v2-55a1b20f3b2955978c8549e2194c342c_r.jpg" data-rawwidth="1536" data-rawheight="2048"><img src="https://pic2.zhimg.com/v2-ac9643906863f23e0392b8e2a2d396c2_r.jpg" data-rawwidth="1536" data-rawheight="2048"><img src="https://pic3.zhimg.com/v2-aec2446379d6aaf1273d95206bede23a_r.jpg" data-rawwidth="1536" data-rawheight="2048"><img src="https://pic3.zhimg.com/v2-75fb8466fb22925ddbaa9b35d3bb597e_r.jpg" data-rawwidth="1536" data-rawheight="2048"><img src="https://pic1.zhimg.com/v2-3578c6c63bfa0e5d003f8da281b935f3_r.jpg" data-rawwidth="1536" data-rawheight="2048"><p><a href="https://github.com/AlphaSmartDog/DeepLearningNotes">github</a> markdown和pdf版本见github</p>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
