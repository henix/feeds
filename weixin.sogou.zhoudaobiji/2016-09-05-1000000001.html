<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>先定一个能达到的小目标：把函数写短</title>
</head>
<body>
<p><a href="https://mp.weixin.qq.com/s?timestamp=1562566731&amp;src=3&amp;ver=1&amp;signature=DRNhB7mJG4abMWu-Quy47du*tpMzhWbkRA5c43hrlxCXyAqL0*DxFIBwJHOUCISokFDcTUIpE2Z8VkM2WzcOe3W0Yvj3b-mOUWhu0K3GV8I0yzkvxucaQRf7NbffGpE7bLKy0pq1Fbz-sBasSvcZobMZMZU053DKtnBGQC7DZeY=">原文</a></p>
<div id="img-content">
                
                <h2 class="rich_media_title" id="activity-name">
                    先定一个能达到的小目标：把函数写短                                    </h2>
                <div id="meta_content" class="rich_media_meta_list">
                                                            <em id="post-date" class="rich_media_meta rich_media_meta_text">2016-09-05</em>

                                        <em class="rich_media_meta rich_media_meta_text">周亮</em>
                                        <a class="rich_media_meta rich_media_meta_link rich_media_meta_nickname" href="##" id="post-user">周导笔记</a>
                    <span class="rich_media_meta rich_media_meta_text rich_media_meta_nickname">周导笔记</span>

                    <div id="js_profile_qrcode" class="profile_container" style="display:none;">
                        <div class="profile_inner">
                            <strong class="profile_nickname">周导笔记</strong>
                            <img class="profile_avatar" id="js_profile_qrcode_img" src="" alt="">

                            <p class="profile_meta">
                            <label class="profile_meta_label">微信号</label>
                            <span class="profile_meta_value">zhoudaobiji</span>
                            </p>

                            <p class="profile_meta">
                            <label class="profile_meta_label">功能介绍</label>
                            <span class="profile_meta_value">周亮的笔记</span>
                            </p>
                            
                        </div>
                        <span class="profile_arrow_wrp" id="js_profile_arrow_wrp">
                            <i class="profile_arrow arrow_out"></i>
                            <i class="profile_arrow arrow_in"></i>
                        </span>
                    </div>
                </div>
                
                
                
                
                                                
                                <div class="rich_media_thumb_wrp" id="media">
                    
                                        <script nonce="1493983727">
                        (function(){
                            </script><img class="rich_media_thumb" id="js_cover" src="http://mmbiz.qpic.cn/mmbiz_jpg/yiacCuYak8bdrJw5YUoLxjyx58icf7XlrWb1f5K1ALdfwbZACy37icnTP2cLBjPbQcq8BcStvIjcv9wO2RvQ6Y3Dw/0?wx_fmt=jpeg"><script>
                            document.write('<img class="rich_media_thumb" id="js_cover" onerror="this.parentNode.removeChild(this)" data-backsrc='+ cover +'  src="' + cover + '" />');
                        })();
                    </script>
                                    </div>
                                                
                
                <div class="rich_media_content " id="js_content">
                    

                    

                    
                    
                    <p style="line-height: 25.6px;">看到之前老同事最近写的代码，为了实现一个功能，写了好几百行代码，全部在一个函数里面。这个函数把不管该不该干的事情全都干了。因为函数太长，也可能是因为我愚笨，阅读了好几遍也没能理解其具体的处理逻辑。</p><p style="line-height: 25.6px;"><br></p><p style="line-height: 25.6px;">这位同事写代码不下五年了，可似乎写可读性强代码的能力上并没有得到很好锻炼。这样下去，让他自己悟出来怎么把代码写好恐怕是极为困难的事情。<span style="line-height: 25.6px;">细思极恐，</span>于是想着应该写出来，希望他能看到，也希望能引发他更多的思考。</p><p style="line-height: 25.6px;"><br></p><p style="line-height: 25.6px;">为什么函数要写短呢？道理大家都懂，无需多言，我们虽然大部分时候是“行动上的矮子”，但我们从来都是<span style="line-height: 25.6px;">“思想上的巨人”。这里简单列几个显而易见的方法，仅供参考。</span></p><p style="line-height: 25.6px;"><br></p><p style="line-height: 25.6px;">首先，尽量做到<span style="line-height: 1.6;">变量的声明和使用尽量在一屏之内。</span></p><p style="line-height: 25.6px;"><span style="line-height: 1.6;"><br></span></p><p style="line-height: 25.6px;"><span style="line-height: 1.6;">人的短暂记忆队列是有限的，当你上下翻滚代码找变量声明和使用的时候，你只能记住最近几个，当你在追溯一个变量的使用时，需要上下翻滚好几屏，那说明这个函数太长了。可以尝试把变量声明和变量最后一次使用中间的部分抽出来做为一个子函数。</span></p><p style="line-height: 25.6px;"><br></p><p style="line-height: 25.6px;">其次，函数应该职责单一、便于测试。</p><p style="line-height: 25.6px;"><span style="line-height: 25.6px;"><br></span></p><p style="line-height: 25.6px;"><span style="line-height: 25.6px;">有个词语叫做“测试驱动开发”，理论大家都认可，但是实践时发现很难做到，其主要原因是我们写的很多代码没办法单元测试，也就是函数职责不单一。比如，实现一个API包含这四步：读取和验证请求参数、查询数据库、处理和拼装数据、生成响应。如果我们将这四步放到一个函数中，你会发现测试这个函数太麻烦了。但是如果我们将每一步都拆分成单独的函数，则每一步都可以测试了，而且很容易。目标拆解后，事情总是变得很容易。</span></p><p style="line-height: 25.6px;"><br></p><p style="line-height: 25.6px;">最后，多多阅读、刻意练习。</p><p style="line-height: 25.6px;"><br></p><p style="line-height: 25.6px;">在积累的一定的代码量后，需要仔细思考如何将代码写短。一方面多阅读优秀的开源代码，比如从你使用最多的开源框架的代码开始；另一方面将你的代码提交给你所敬佩的人评审，不要怕丑，也不要嫌麻烦，成长的道路总是充满了烦恼的。同时，将“把函数写短”这句话贴到显示器上，时时刻刻提醒自己，不放过任何一次练习的机会。</p><p style="line-height: 25.6px;"><br></p><p style="line-height: 25.6px;">砌砖是将砖块用水泥拼在一起，写程序也是一样，只是<span style="line-height: 25.6px;">拼在一起是</span>语句（statement）而已。砌砖师傅会时不时拿起吊线锤来检查其所砌的墙是不是垂直，写<span style="line-height: 25.6px;">程序</span>也是一样，需要经常检查代码是不是短小精干和稳定，如果你平常写程序不检查的，那真的连砌砖师傅都不如了，以后千万别说自己是码农，农民工比你更专业。</p><p><br></p>
                </div>
                <script nonce="1493983727" type="text/javascript">
                    var first_sceen__time = (+new Date());

                    if ("" == 1 && document.getElementById('js_content')) {
                        document.getElementById('js_content').addEventListener("selectstart",function(e){ e.preventDefault(); });
                    }

                    
                    (function(){
                        if (navigator.userAgent.indexOf("WindowsWechat") != -1){
                            var link = document.createElement('link');
                            var head = document.getElementsByTagName('head')[0];
                            link.rel = 'stylesheet';
                            link.type = 'text/css';
                            link.href = "//res.wx.qq.com/mmbizwap/zh_CN/htmledition/style/page/appmsg/page_mp_article_improve_winwx31619e.css";
                            head.appendChild(link);
                        }
                    })();
                </script>
                
                
                                
                <div class="ct_mpda_wrp" id="js_sponsor_ad_area" style="display:none;"></div>

                
                                <div class="reward_area tc" id="js_preview_reward" style="display:none;">
                    <p id="js_preview_reward_wording" class="tips_global reward_tips" style="display:none;"></p>
                    <p>
                        <a class="reward_access" id="js_preview_reward_link" href="##">赞赏</a>
                    </p>
                </div>
                <div class="reward_qrcode_area reward_area tc" id="js_preview_reward_qrcode" style="display:none;">
                    <p class="tips_global">长按二维码向我转账</p>
                    <p id="js_preview_reward_ios_wording" class="reward_tips" style="display:none;"></p>
                    <span class="reward_qrcode_img_wrp"><img class="reward_qrcode_img" src="//res.wx.qq.com/mmbizwap/zh_CN/htmledition/images/pic/appmsg/pic_reward_qrcode.2x3534dd.png"></span>
                    <p class="tips_global">受苹果公司新规定影响，微信 iOS 版的赞赏功能被关闭，可通过二维码转账支持公众号。</p>
                </div>
                            </div><div class="rich_media_tool" id="js_toobar3">
                                            <div id="js_read_area3" class="media_tool_meta tips_global meta_primary" style="display:none;">阅读 <span id="readNum3"></span></div>

                <span style="display:none;" class="media_tool_meta meta_primary tips_global meta_praise" id="like3">
                    <i class="icon_praise_gray"></i><span class="praise_num" id="likeNum3"></span>
                </span>

                <a id="js_report_article3" style="display:none;" class="media_tool_meta tips_global meta_extra" href="##">投诉</a>

            </div><div class="rich_media_tool" id="js_sg_bar">
                                
            </div>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
