<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>火绒5.0公测阶段就立功  有效防御某一类常见黑客攻击</title>
</head>
<body>
<p><a href="https://mp.weixin.qq.com/s?timestamp=1556778103&amp;src=3&amp;ver=1&amp;signature=WugNrBvYiRYgHt0xwnRd5GlS*4defst8GhkD-NPrAH8RNpNY6vsCcSMyldm4Amiiiqx4*b6XNypvPUpGkGI**zkvJQNxHkZ7BMgVZ46H0-6fL4FGgKx8yGyskt7sTR9maWNXHr9crEIzCf4BP5sHV026rSsoS46R3edrgvMV7*A=">原文</a></p>
<div id="js_top_ad_area" class="top_banner"></div><div class="rich_media_inner">

        
        
        <div id="page-content" class="rich_media_area_primary">
          <div class="rich_media_area_primary_inner">
                                    
                        

            <div id="img-content">

                
                <h2 class="rich_media_title" id="activity-name">
                    
                    
                    火绒5.0公测阶段就立功  有效防御某一类常见黑客攻击

                                                                                </h2>
                <div id="meta_content" class="rich_media_meta_list">
                                                            <span id="copyright_logo" class="rich_media_meta rich_media_meta_text meta_tag_text">原创：</span>
                                                            <span class="rich_media_meta rich_media_meta_text">
                                                火绒安全实验室
                                            </span>
                                        
                                        <span class="rich_media_meta rich_media_meta_nickname" id="profileBt">
                      <a href="javascript:void(0);" id="js_name">
                        火绒安全实验室                      </a>
                      <div id="js_profile_qrcode" class="profile_container" style="display:none;">
                          <div class="profile_inner">
                              <strong class="profile_nickname">火绒安全实验室</strong>
                              <img class="profile_avatar" id="js_profile_qrcode_img" src="" alt="">

                              <p class="profile_meta">
                              <label class="profile_meta_label">微信号</label>
                              <span class="profile_meta_value">HuorongLab</span>
                              </p>

                              <p class="profile_meta">
                              <label class="profile_meta_label">功能介绍</label>
                              <span class="profile_meta_value">火绒是一家纯粹的信息安全公司。在这里为大家分享专业的技术报告和安全信息。</span>
                              </p>
                              
                          </div>
                          <span class="profile_arrow_wrp" id="js_profile_arrow_wrp">
                              <i class="profile_arrow arrow_out"></i>
                              <i class="profile_arrow arrow_in"></i>
                          </span>
                      </div>
                    </span>


                    <em id="publish_time" class="rich_media_meta rich_media_meta_text"></em>





                </div>
                
                
                
                
                                                
                                                                
                                
                
                <div class="rich_media_content " id="js_content">
                    

                    

                    
                    
                    <p><strong style="font-size: 16px;">一、概述</strong></p><p style="text-align: justify;"><span style="font-size: 15px;">正在公测的火绒5.0新版初显威力，在用户的试用过程中，顺利完成了对一种常见黑客攻击的防御，不光及时感知、拦截了黑客攻击，还通过“火绒威胁情报系统”完整解析出整个攻击流程，进而实现对该种攻击的多重防御。</span><br></p><p style="text-align: justify;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;"><span style="font-size: 15px;">该事件中，用户的服务器数据库被攻击时，火绒5.0版的“应用加固”模块被触发，立刻拦截了黑客攻击。随后，“火绒威胁情报系统”收到相关威胁信息并展开分析，解析出该种攻击的全部流程。</span></p><p style="text-align: justify;"><span style="font-size: 15px;"><br></span></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="1.3865814696485623" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4VpSftRpxxLB4wuO4BU3r7hoYrdVPVz7HqTw4XKV0xxKwOia0ropfZ1hibPmFoFW0zHSOZdGiaADoiag/640?wx_fmt=png" data-type="png" data-w="313" style="width: 219px;height: 304px;"></p><p style="text-align: justify;"><span style="font-size: 15px;"></span><br></p><p style="text-align: justify;"><span style="font-size: 15px;">【黑客攻击完整流程】：</span><span style="font-size: 15px;">黑客通过攻击服务器中的数据库，入侵用户电脑，然后植入多个“后门病毒”，再通过“后门病毒”派发各种病毒模块，甚至还有可能使被感染的电脑，攻击其他电脑。</span><br></p><p style="text-align: justify;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;"><span style="font-size: 15px;">针对这种较为常见的黑客攻击行为，火绒5.0可实现多重防御。</span></p><p style="text-align: justify;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;"><span style="font-size: 15px;">1、黑客在攻击服务器数据库时，会触发火绒5.0【应用加固-数据库】防御功能。该功能可针对电脑及服务器上的各类程序进行加固，阻止黑客利用程序，实施下载病毒等恶意行为；</span></p><p style="text-align: justify;"><span style="font-size: 15px;"><br></span></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.6593673965936739" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4VpSftRpxxLB4wuO4BU3r7SiaUBsHPFJOYicK9ic4fkuCw4edL4c4044ibEacibxpmF1E6JvaT4tJYqgw/640?wx_fmt=png" data-type="png" data-w="822" style=""></p><p style="text-align: justify;"><span style="font-size: 15px;"></span><br></p><p style="text-align: justify;"><span style="font-size: 15px;">2、如果【应用加固】功能被关闭，导致黑客成功入侵电脑并下载后门病毒文件，一旦病毒文件开始运行，火绒5.0的【文件实时监控】就会及时拦截、查杀，使其无法运行作恶；</span><br></p><p style="text-align: justify;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;"><span style="font-size: 15px;">3、如果上述两个功能都关闭，这些“后门病毒”控制用户电脑，向外发起攻击时，火绒5.0的【僵尸网络防护】功能可有效拦截，阻止被黑客控制。</span></p><p style="text-align: justify;"><span style="font-size: 15px;"><br></span></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.6584766584766585" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4VpSftRpxxLB4wuO4BU3r717Q0TQBmC9tcDlvRdOzZKGXAUpZickPdWHrsmphV7jNEsMGH2iayeDmA/640?wx_fmt=png" data-type="png" data-w="814" style=""></p><p style="text-align: justify;"><br><span style="font-size: 15px;"></span></p><p style="text-align: justify;"><span style="font-size: 15px;">火绒5.0是火绒安全软件最新版，整体防御能力再次升级，增添、优化多项硬核功能（默认为开启，请不要随意关闭）。这些功能都是针对普通用户在日常使用中，经常遇到的安全威胁而研发，可以有效解决病毒、木马、流氓软件、恶意网站等诸多常见安全问题，让用户能够“安全、方便、自主、自由地使用自己的电脑”。</span></p><p style="text-align: justify;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;"><span style="font-size: 15px;">目前，火绒5.0公测版已经在官网上线，欢迎大家前往下载、体验。（点击阅读原文）</span></p><p style="text-align: justify;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;"><span style="font-size: 15px;">此外，火绒4.0用户无需担心，最新版也可查杀该病毒。</span></p><p><br></p><p style="text-align: justify;"><br></p><p style="text-align: justify;"><span style="font-size: 16px;"><strong>二、样本分析</strong></span><br></p><h1 style="text-align: justify;"><span style="font-size: 15px;"></span></h1><p style="text-align: justify;"><span style="font-size: 15px;">近期，火绒通过5.0应用加固功能截获到一起病毒攻击事件，黑客会通过攻击SQL Server服务器的方式进行病毒传播，攻击成功后，数据库相关进程会执行恶意代码下载执行后门病毒。此次被传播的后门病毒为Gh0st后门病毒的变种，具体功能包括：终端数据收集，接收和执行控制命令、派发执行任意病毒模块等。</span></p><p style="text-align: justify;"><span style="color: rgb(0, 0, 0);"><strong><span style="font-size: 15px;"><br></span></strong></span></p><h2 style="text-align: justify;"><span style="color: rgb(0, 0, 0);"><strong><span style="color: rgb(0, 0, 0);font-size: 15px;">后门病毒启动流程</span></strong></span><span style="font-size: 15px;"></span></h2><p style="text-align: justify;"><span style="font-size: 15px;">后门病毒外层为混淆器代码，混淆器逻辑较为简单，首先会解密原始PE镜像，之后调用原始PE镜像中的导出函数Shellex。被解密执行的原始镜像为Gh0st后门病毒变种，病毒运行后会将其注册为系统服务驻留用户电脑。相关代码，如下图所示：</span></p><p style="text-align: justify;"><span style="font-size: 15px;"><br></span></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.5553719008264463" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4VpSftRpxxLB4wuO4BU3r7jq8SBrXGeibsebVBN618o1Ku6nIOtkiaYACKlslvqVNrWgzKWRb8P1vA/640?wx_fmt=png" data-type="png" data-w="605" style=""></p><p style="text-align: center;"><span style="font-size: 15px;">混淆器</span><br><span style="font-size: 15px;"></span></p><p style="text-align: justify;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;"><span style="font-size: 15px;">后门病毒代码执行后，首先会初始化字符串、获取运行所需API地址。相关代码，如下图所示：</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.45198902606310015" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4VpSftRpxxLB4wuO4BU3r7rW4Vicxw2F1KtDm7NibicaKwQqraavUOVF5Uaj829Km6JQjWACo4iapic8Q/640?wx_fmt=png" data-type="png" data-w="1458" style=""></p><p style="text-align: center;"><span style="font-size: 15px;">初始化字符串、获取API地址</span></p><p style="text-align: justify;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;"><span style="font-size: 15px;">病毒会在不同的操作系统中执行不同的病毒逻辑。如果是Vista以上的系统， 则在命令行后添加Win7 参数，以当前用户权限重新启动程序。相关代码，如下图所示：</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.45493562231759654" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4VpSftRpxxLB4wuO4BU3r7ma0odPvEalic0BwLKZNLSb9dTqZ0XOhNfg8BhJBohW5fNN0pzRWN1nQ/640?wx_fmt=png" data-type="png" data-w="932" style=""></p><p style="text-align: center;"><span style="font-size: 15px;">以当前用户权限重新启动</span></p><p style="text-align: justify;"><span style="font-size: 15px;"><br></span></p><h2><span style="font-size: 15px;color: rgb(0, 0, 0);"><strong>后门病毒部署</strong></span></h2><p style="text-align: justify;"><span style="font-size: 15px;">病毒运行后，会在ProgramFiles目录下创建WinRAP文件夹，并会将自身拷贝为该目录下的随机名可执行文件，之后隐藏文件并将其注册为系统服务。相关代码，如下图所示：</span></p><p style="text-align: justify;"><span style="font-size: 15px;"><br></span></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="1.1974865350089767" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4VpSftRpxxLB4wuO4BU3r7ga2ibIV4LiaUzEOkdjiaZxmRcfsFclCCN1cTGh7G8uvbgzk2nI7CTJavg/640?wx_fmt=png" data-type="png" data-w="1114" style=""></p><p style="text-align: center;"><span style="font-size: 15px;">病毒执行相关代码</span><br><span style="font-size: 15px;"></span></p><p style="text-align: justify;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;"><span style="font-size: 15px;">添加感染信息注册表，方便之后的信息收集和控制。相关代码，如下图所示：</span></p><p style="text-align: justify;"><span style="font-size: 15px;"><br></span></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="1.4096534653465347" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4VpSftRpxxLB4wuO4BU3r72hRLKwD8ia4KPAV2QWaD30kk4h5vDPsL80XmvJL8ExOhEvlCLZchgxA/640?wx_fmt=png" data-type="png" data-w="808" style=""></p><p style="text-align: center;"><span style="font-size: 15px;">添加病毒注册表</span><br><span style="font-size: 15px;"></span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.4731182795698925" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4VpSftRpxxLB4wuO4BU3r7bkZSiaIdskvUOmqPw6Y54BVj0CGs5BlhicbfUdLs2KPpwxickj0YDbwzw/640?wx_fmt=png" data-type="png" data-w="930" style=""></p><p style="text-align: center;"><span style="font-size: 15px;">病毒注册表</span></p><p style="text-align: justify;"><span style="font-size: 15px;"><br></span></p><h2><span style="color: rgb(0, 0, 0);"><strong><span style="color: rgb(0, 0, 0);font-size: 15px;">后门控制功能</span></strong></span></h2><p style="text-align: justify;"><span style="font-size: 15px;">收集计算机的软硬件信息，用于发送上线包。收集的信息具体如下：</span></p><p style="text-align: justify;"><span style="font-size: 15px;"><br></span></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.291958041958042" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4VpSftRpxxLB4wuO4BU3r7MhtnbmlK59hmwlqsKJNbnkHuPK0cMtNH5sfgD7oO1ibjDgFwaTb4hug/640?wx_fmt=png" data-type="png" data-w="572" style=""><span style="font-size: 15px;text-align: justify;">收集的信息</span></p><p style="text-align: center;"><span style="font-size: 15px;text-align: justify;"><br></span></p><p style="text-align: justify;"><span style="font-size: 15px;"></span></p><p style="text-align: justify;"><span style="font-size: 15px;">检测软件运行信息，如下图所示：</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.9370629370629371" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4VpSftRpxxLB4wuO4BU3r7mtH1hF9K9ph4IiaNx8dz5SR1LzWa7Rfl1QTvMzS1X3N2MrwnIDmsdjg/640?wx_fmt=png" data-type="png" data-w="715" style=""></p><p style="text-align: center;"><span style="font-size: 15px;">检测软件名称</span></p><p style="text-align: justify;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;"><span style="font-size: 15px;">信息收集相关代码，如下图所示：</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.7533265097236438" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4VpSftRpxxLB4wuO4BU3r7kgOsW2Oia8ozgt0uvASrmApibjhW8WlWx4xg5Il6TrWVnPWuZOZcM5icw/640?wx_fmt=png" data-type="png" data-w="977" style=""></p><p style="text-align: center;"><span style="font-size: 15px;">收集软硬件信息</span></p><p style="text-align: justify;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;"><span style="font-size: 15px;">将收集到的信息添加固定数据头HTTPWWW.NCBUG.COM，进行简单加密，发送到服务器，服务器域名为fjm187.f3322.org，端口号为1987。相关代码，如下图所示：</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.458808618504436" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4VpSftRpxxLB4wuO4BU3r7IcQ5YY1QzHLJy0qgEcdrYm6bIknBXH00KENO32lJqE864RMibooguQg/640?wx_fmt=png" data-type="png" data-w="789" style=""></p><p style="text-align: center;"><span style="font-size: 15px;">添加固定数据头</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.43414634146341463" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4VpSftRpxxLB4wuO4BU3r76gYmGBhHcMD37TwlytJ5vQbW8p2pPZscLhib9qdgjFYlMpLyAa06hCg/640?wx_fmt=png" data-type="png" data-w="1230" style=""></p><p style="text-align: center;"><span style="font-size: 15px;">发送加密后的上线数据</span></p><p style="text-align: justify;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;"><span style="font-size: 15px;">接收服务器回传的数据后同样需要进行解密，解密后可以根据控制命令执行后门控制功能。相关代码，如下图所示：</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.8112305854241338" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4VpSftRpxxLB4wuO4BU3r7XfpEXGibF3ByLSXPzkRx8Xr3zhAIpRxezLR5dgV09ElommlOPESmb8Q/640?wx_fmt=png" data-type="png" data-w="837" style=""></p><p style="text-align: center;"><span style="font-size: 15px;">解密执行控制命令</span></p><p style="text-align: center;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;"><span style="font-size: 15px;">后门控制功能如下：</span></p><p style="text-align: justify;"><span style="font-size: 15px;"><br></span></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.3902439024390244" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4VpSftRpxxLB4wuO4BU3r7icxhFQ5ttzpzcbpom0PPkIOibVs4Viawp4SLLv9KZMlOiaqSmWPQMsGI9g/640?wx_fmt=png" data-type="png" data-w="492" style=""></p><p style="text-align: center;"><span style="text-align: justify;font-size: 15px;">后门控制功能</span></p><p style="text-align: center;"><span style="text-align: justify;font-size: 15px;"><br></span></p><p style="text-align: justify;"><span style="font-size: 15px;"></span></p><p style="text-align: justify;"><span style="font-size: 15px;">相关代码，如下图所示：</span></p><p style="text-align: justify;"><span style="font-size: 15px;"><br></span></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="1.5361620057859209" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4VpSftRpxxLB4wuO4BU3r7IRCL7YceaJdoHvxiargDVYL5piagmzAoBiaKxUsIQvjQ8IkIERnL4XZzQ/640?wx_fmt=png" data-type="png" data-w="1037" style=""></p><p style="text-align: center;"><span style="font-size: 15px;">后门功能</span><br><span style="font-size: 15px;"></span></p><p style="text-align: justify;"><span style="font-size: 15px;"><br></span></p><h2 style="text-align: justify;"><strong><span style="font-size: 15px;color: rgb(0, 0, 0);">被释放病毒模块</span></strong><span style="font-size: 15px;"></span></h2><p style="text-align: justify;"><span style="font-size: 15px;">后门病毒还会根据不同的操作系统，释放不同的病毒模块进行执行。通过检测是否存在vmtoolsd.exe进程，进行检测虚拟机。如果不是虚拟机，则检查操作系统的版本，如果是win8或者是windowsserver2012，则释放并运行名为cscrss.exe的后门病毒，否则释放运行cszrss.exe。相关代码，如下图所示：</span></p><p style="text-align: justify;"><span style="font-size: 15px;"> </span></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.7898338220918866" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4VpSftRpxxLB4wuO4BU3r7N45G8s6ZuQed9eBgMNPqU8WmxwibJrBleSfZHoboBzjsUM53bDibdiaWg/640?wx_fmt=png" data-type="png" data-w="1023" style=""></p><p style="text-align: center;"><span style="font-size: 15px;">释放文件</span><br><span style="font-size: 15px;"></span></p><p style="text-align: center;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;"><span style="font-size: 15px;">cscrss的恶意行为与之前的后门病毒基本相同，只是更改服务器域名和端口， 域名为etc.xmcxmr.com, 端口为2218。相关代码，如下图所示：</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.5410677618069816" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4VpSftRpxxLB4wuO4BU3r728hHHy2GNzBMWdVHTIict5zBia8JsyG4PosMQYMvFYAPcUic7bKoNibw5Q/640?wx_fmt=png" data-type="png" data-w="974" style=""></p><p style="text-align: center;"><span style="font-size: 15px;">后门病毒cscrss</span></p><p style="text-align: justify;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;"><span style="font-size: 15px;">cszrss为另一个后门病毒，病毒逻辑与之前后门病毒相似，连接域名为backmuma.ddns.net，端口为81。相关代码，如下图所示：</span></p><p style="text-align: justify;"><span style="font-size: 15px;"><br></span></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.48870967741935484" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4VpSftRpxxLB4wuO4BU3r7d7gp9vK7CyHc94Xdm6Wav1ZeeOVibnV5R75j36VuoIVfSSalUkIDXuw/640?wx_fmt=png" data-type="png" data-w="620" style=""></p><p style="text-align: center;"><span style="font-size: 15px;">后门病毒cszrss</span><br><span style="font-size: 15px;"></span></p><p style="text-align: justify;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;"><span style="font-size: 15px;">在cszrss中带有“神农远控”相关字符串，并且利用神农远控生成的后门病毒与之前的所有后门程序都有一定的相似性，而神农远控由Gh0st后门代码改写，因此判断上述后门均是Gh0st后门的不同变种。</span></p><p style="text-align: justify;"><span style="font-size: 15px;"><br></span></p><h2 style="text-align: justify;"><strong><span style="font-size: 15px;color: rgb(0, 0, 0);">下载执行其他病毒模块</span></strong><span style="font-size: 15px;"></span></h2><p style="text-align: justify;"><span style="font-size: 15px;">后门病毒会通过控制命令从C&amp;C服务器派发执行其他病毒模块，以派发下的一个蠕虫病毒为例进行分析。派发到终端的蠕虫病毒名为notepad_protected.exe，该病毒会连接不同的域名和端口进行上线包的发送，接收指令，下载执行其他病毒模块。病毒连接的C&amp;C服务器地址及端口信息，如下图所示：</span></p><p style="text-align: justify;"><span style="font-size: 15px;"><br></span></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.5518987341772152" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4VpSftRpxxLB4wuO4BU3r760l8zibGoRAWjCePGv7BQYq1bGvpibXib7WnwecKziaNwjVckbOjeCN8QA/640?wx_fmt=png" data-type="png" data-w="395" style=""></p><p style="text-align: center;"><span style="font-size: 15px;">C&amp;C服务器地址及端口信息</span><br><span style="font-size: 15px;"></span></p><p style="text-align: justify;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;"><span style="font-size: 15px;">相关代码，如下图所示：</span></p><p style="text-align: justify;"><span style="font-size: 15px;"><br></span></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.508495145631068" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4VpSftRpxxLB4wuO4BU3r7bbXYONZjqXgiaRjZdOjUzfjruMB2qP68CMFZc5nyBpuMXNNicJmLLdLQ/640?wx_fmt=png" data-type="png" data-w="1648" style=""></p><p style="text-align: center;"><span style="font-size: 15px;">后门连接不同域名</span><br><span style="font-size: 15px;"></span></p><p style="text-align: justify;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;"><span style="font-size: 15px;">其中ddos.jqddos.in域名，通过搜索该域名网站的历史数据我们得知，该域名下网站，曾对外提供付费的DDoS攻击服务，该域名下网站几年前已被关停。相关信息，如下图所示：</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.5110526315789473" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4VpSftRpxxLB4wuO4BU3r7tG5vacUwFtFsibl0jmqNWTjkPZt4BGTJd49KgmzW6JurEl0cCueib0eQ/640?wx_fmt=png" data-type="png" data-w="1900" style=""></p><p style="text-align: center;"><span style="font-size: 15px;">ddos.jqddos.in域名下网站页面信息</span></p><p style="text-align: justify;"><span style="font-size: 15px;"><br></span></p><p style="text-align: justify;"><span style="font-size: 15px;">病毒执行后会遍历磁盘目录释放lpk.dll文件，进行动态库劫持。lpk.dll装载后会从资源节释放文件并执行（释放文件与派发下来的病毒文件为同一文件），以此进行驻留和传播。相关代码，如下图所示：</span></p><p><br></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.4079159935379645" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4VpSftRpxxLB4wuO4BU3r7J5ZsuLlHtiab7O5VK6ZX2qGq07fSbPBO02RErVEWhOKZW6wR3esFQ3g/640?wx_fmt=png" data-type="png" data-w="1238" style=""></p><p style="text-align: center;"><span style="font-size: 15px;">释放lpk.dll</span></p><p style="text-align: justify;"><span style="font-size: 15px;"><br></span></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.6540948275862069" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4VpSftRpxxLB4wuO4BU3r7GYqa7oiaDoTQD9VFLbBico2eqnI1BODscRJTzzdMiaJjiaZvhccSLF9K1A/640?wx_fmt=png" data-type="png" data-w="928" style=""></p><p style="text-align: center;"><span style="font-size: 15px;">从资源节释放文件并执行</span><br><span style="font-size: 15px;"></span></p><p style="text-align: justify;"><br></p><h1 style="text-align: justify;"><span style="color: rgb(0, 0, 0);font-size: 16px;"><strong>三．附录</strong></span></h1><p style="text-align: justify;"><span style="font-size: 15px;">样本hash:</span></p><p style="text-align: justify;"><span style="font-size: 15px;"><br></span></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.2028368794326241" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/0icdicRft8tz4VpSftRpxxLB4wuO4BU3r7a7crRIbCRSZjSk84vQeTnKbsyiaj8dVgM6XDOs1WTp8x7rzW08Kuic5A/640?wx_fmt=png" data-type="png" data-w="705" style=""></p><p style="text-align: justify;"><span style="font-size: 15px;"></span><br></p><p style="text-align: justify;"><span style="font-size: 15px;">  <br></span></p><p style="text-align: justify;"><span style="font-size: 15px;">   </span></p><p style="text-align: justify;"><span style="font-size: 15px;"></span></p><p><br></p>
                </div>
                <script nonce="1078430403" type="text/javascript">
                    var first_sceen__time = (+new Date());

                    if ("" == 1 && document.getElementById('js_content')) {
                        document.getElementById('js_content').addEventListener("selectstart",function(e){ e.preventDefault(); });
                    }

                    
                    (function(){
                        if (navigator.userAgent.indexOf("WindowsWechat") != -1){
                            var link = document.createElement('link');
                            var head = document.getElementsByTagName('head')[0];
                            link.rel = 'stylesheet';
                            link.type = 'text/css';
                            link.href = "//res.wx.qq.com/mmbizwap/zh_CN/htmledition/style/page/appmsg_new/winwx4516f8.css";
                            head.appendChild(link);
                        }
                    })();
                </script>

                
                <div class="ct_mpda_wrp" id="js_sponsor_ad_area" style="display:none;"></div>

                
                <div class="read-more__area" id="js_more_read_area" style="display:none;">
                    
                </div>

                
                                <div class="reward_area tc reward_area_primary" id="js_preview_reward_author" style="display:none;">
                    <div class="reward-avatar" style="display: none;" id="js_preview_reward_author_avatar">
                        <img src="" alt="" id="js_preview_reward_author_head">
                    </div>
                    
                                        <div class="reward-author" id="js_preview_reward_author_name">火绒安全实验室</div>
                                        <p class="reward_tips" id="js_preview_reward_author_wording" style="display:none;"></p>
                    <p>
                        <a class="reward_button" id="js_preview_reward_author_link" href="##"><span id="js_preview_reward_link_text">赞赏</span></a>
                    </p>
                </div>

                <div class="reward_qrcode_area reward_area tc" id="js_preview_reward_qrcode" style="display:none;">
                    <p class="tips_global">长按二维码向我转账</p>
                    <p id="js_preview_reward_ios_wording" class="reward_tips" style="display:none;"></p>
                    <span class="reward_qrcode_img_wrp"><img class="reward_qrcode_img" src="//res.wx.qq.com/mmbizwap/zh_CN/htmledition/images/pic/appmsg/pic_reward_qrcode.2x42f400.png"></span>
                    <p class="tips_global">受苹果公司新规定影响，微信 iOS 版的赞赏功能被关闭，可通过二维码转账支持公众号。</p>
                </div>
                                
                
                            </div>
                                    
                        


                        
            <ul id="js_hotspot_area" class="article_extend_area"></ul>


            

            


<div class="rich_media_tool" id="js_toobar3">

        <a class="media_tool_meta meta_primary" id="js_view_source" href="##">阅读原文</a>
        <div id="js_read_area3" class="media_tool_meta tips_global_primary meta_primary" style="display:none;">阅读 <span id="readNum3"></span></div>

    <span style="display:none;" class="media_tool_meta meta_extra meta_praise" id="like_old">
        <i class="icon_praise_gray"></i><span class="praise_num" id="likeNum_old"></span>
    </span>

    <span style="display:none;" class="media_tool_meta meta_extra meta_like" id="like3">
        <button class="like_btn" id="js_like_btn"> 
          <span id="js_like_wording"> 在看</span><span class="like_num" id="likeNum3"></span>
        </button>
    </span>


    <div style="display:none">
        <div class="weui-mask"></div>
        <div class="weui-dialog weui-dialog_haokan">
        <div class="weui-dialog__hd"><strong class="weui-dialog__title" id="educate_title">已同步到看一看</strong></div>
        <div class="weui-dialog__bd">
        </div>
        <div class="weui-dialog__ft" id="educate_btn" style="display: none">
          <a href="javascript:;" class="weui-dialog__btn weui-dialog__btn_default" id="js_cancel">取消</a>
          <a href="javascript:;" class="weui-dialog__btn weui-dialog__btn_primary" id="js_confirm">发送</a>
        </div>
        <div class="weui-dialog__ft" id="educate_btn2" style="display: none">
          <a href="javascript:;" class="weui-dialog__btn weui-dialog__btn_primary" id="js_acknowledge">我知道了</a>
        </div>
        </div>
    </div>

    <div id="js_unlike_educate" style="display:none">
        <div class="weui-mask"></div>
        <div class="weui-dialog">
        
        <div class="weui-dialog__bd">
            已取消，想法已同步删除        </div>
        <div class="weui-dialog__ft">
          <a href="javascript:;" class="weui-dialog__btn weui-dialog__btn_primary" id="js_unlike_know">知道了</a>
        </div>
        </div>
    </div>

    
    </div>

<div style="display: none;" id="js_like_educate" class="like_skin_primary like_comment_primary_pop">
  <div id="js_like_educate_wrapper" class="like_comment_primary_wrp like_comment_primary_pos_top">
    <div class="like_comment_primary_inner">
      <div class="like_comment_primary_hd">
        <h4 class="like_comment_primary_title">
          朋友会在“发现-看一看”看到你“在看”的内容        </h4>
        <button id="js_b_like_confirm" class="like_comment_primary_btn">确定</button>
      </div>
      <div class="like_comment_primary_bd">
        <img class="pic_haokan" src="//res.wx.qq.com/mmbizwap/zh_CN/htmledition/images/pic/appmsg/pic_haokan4516f7.png">
      </div>
    </div>
  </div>
  <div class="like_comment_primary_mask" id="js_mask_3"></div>
</div>

<div class="like_comment_wrp" id="js_a_like_comment" style="display: none;">
  <div class="like_comment_inner">
    <div class="like_comment_hd" style="display:none" id="js_like_title"></div>
    <div class="like_comment_bd">
      <div class="tips_global_primary like_comment_tips">
        <i class="weui-icon-success"></i>已同步到看一看<a href="javascript:;" class="like_comment_share_link" id="js_a_like_comment_share">写下你的想法</a>
      </div>
    </div>
    <div class="like_comment_ft">
      <span id="js_a_like_comment_msg" class="like_comment_msg" style="visibility:hidden">最多200字，当前共<span id="js_a_like_current_cnt"></span>字</span>
      <button class="like_comment_btn" disabled id="js_a_like_confirm">发送</button>
    </div>
  </div>
</div>

<div id="js_like_toast" style="display: none;">
  <div class="weui-mask_transparent"></div>
  <div class="weui-toast">
    <i class="weui-icon-success-no-circle weui-icon_toast"></i>
    <p class="weui-toast__content" id="js_toast_msg">已发送</p>
  </div>
</div>


<div style="display: none;" id="js_b_comment_panel" class="like_comment_primary_pop">
  <div class="like_comment_primary_wrp" id="js_b_wrp">
    <div class="like_comment_primary_inner">
      <div class="like_comment_primary_hd">
        <h4 class="like_comment_primary_title">
          朋友将在看一看看到        </h4>
        <button id="js_b_like_confirm" class="like_comment_primary_btn">确定</button>
      </div>
      <div id="js_b_comment_text_first" class="like_comment_primary_bd">
        <span class="tips_global_primary">
          写下你的想法...        </span>
      </div>
    </div>
  </div>
  <div class="like_comment_primary_mask" id="js_mask_1"></div>
</div>

<div style="display: none;" id="js_b_comment_final">
  <div class="like_comment_primary_wrp editing" id="js_comment_wrp">
    <div class="like_comment_primary_inner">
      <div class="like_comment_primary_hd">
        <button class="like_comment_primary_cancel" id="js_b_comment_cancel">取消</button>
        <h4 class="like_comment_primary_title"> 发布到看一看 </h4>
        <button class="like_comment_primary_btn" id="js_b_comment_confirm">确定</button>
      </div>
      <div class="like_comment_primary_bd">
        <textarea class="like_comment_textarea weui-textarea" placeholder="写下你的想法..." id="js_b_comment_text_second"></textarea>
      </div>
      <span class="like_comment_msg" id="js_b_like_comment_msg" style="visibility: hidden;">最多200字，当前共<span id="js_b_like_current_cnt"></span>字</span>
    </div>
  </div>
  <div class="like_comment_primary_mask" id="js_mask_2"></div>
</div>

<div id="js_loading" style=" display: none;">
    <div class="weui-mask_transparent"></div>
    <div class="weui-toast">
        <i class="weui-loading weui-icon_toast"></i>
        <p class="weui-toast__content">发送中</p>
    </div>
</div>

<div id="js_fail" style="display:none">
    <div class="weui-mask"></div>
    <div class="weui-dialog">
    <div class="weui-dialog__bd">
        网络异常，请稍后重试    </div>
    <div class="weui-dialog__ft">
      <a href="javascript:;" class="weui-dialog__btn weui-dialog__btn_primary" id="js_fail_inform">知道了</a>
    </div>
    </div>
</div>



                        <div class="rich_media_tool" id="js_sg_bar">

                                <a class="media_tool_meta meta_primary" href="https://www.huorong.cn/betaPage.html" target="_blank">阅读原文</a>
                                
            </div>
                      </div>
        </div>

        <div class="rich_media_area_primary sougou" id="sg_tj" style="display:none"></div>


        
        <div class="rich_media_area_extra">
          <div class="rich_media_area_extra_inner">
              
              <div id="js_share_appmsg">
              </div>

              
                            <div class="mpda_bottom_container" id="js_bottom_ad_area"></div>
                            
              <div id="js_iframetest" style="display:none;"></div>
                            
                            
              <div class="rich_media_extra rich_media_extra_discuss" id="js_cmt_container" style="display:none">
                

                
                <div class="discuss_mod" id="js_friend_cmt_area" style="display:none">
                  
                  
                  
                </div>

                                <div class="discuss_mod" id="js_cmt_area" style="display:none">
                </div>
                              </div>
          </div>
        </div>

        
        <div id="js_pc_qr_code" class="qr_code_pc_outer" style="display:none;">
            <div class="qr_code_pc_inner">
                <div class="qr_code_pc">
                    <img id="js_pc_qr_code_img" class="qr_code_pc_img">
                    <p>微信扫一扫<br>关注该公众号</p>
                </div>
            </div>
        </div>
    </div>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
