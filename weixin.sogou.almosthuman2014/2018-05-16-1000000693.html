<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>用机器学习构建O(N)复杂度的排序算法，可在GPU和TPU上加速计算</title>
</head>
<body>
<p><a href="https://mp.weixin.qq.com/s?timestamp=1527271892&amp;src=3&amp;ver=1&amp;signature=Vq0u7uuuYO3YyLZQ3oD1o6eO3Teyts0KR3s5Isc*aHKAr-LfWIU*MN-PDj071vnAWR0BLX3BzE-q-aWAtF-BcIVodHiTHCPcFqXzt-DSrvfKo9Fw-c1SrYz-XswEJqIrue3jMHfilFooAdNN5jS7OSl6jyQ5C*Awsefy9lENCgE=">原文</a></p>
<div id="js_top_ad_area" class="top_banner"></div><div class="rich_media_inner">
                        
        
        <div id="page-content" class="rich_media_area_primary">
            
                        
            <div id="img-content">
                
                <h2 class="rich_media_title" id="activity-name">
                    用机器学习构建O(N)复杂度的排序算法，可在GPU和TPU上加速计算                                                                                </h2>
                <div id="meta_content" class="rich_media_meta_list">
                                                            <span class="rich_media_meta rich_media_meta_nickname" id="profileBt">
                      <a href="javascript:void(0);">
                        机器之心                      </a>
                      <div id="js_profile_qrcode" class="profile_container" style="display:none;">
                          <div class="profile_inner">
                              <strong class="profile_nickname">机器之心</strong>
                              <img class="profile_avatar" id="js_profile_qrcode_img" src="" alt="">

                              <p class="profile_meta">
                              <label class="profile_meta_label">微信号</label>
                              <span class="profile_meta_value">almosthuman2014</span>
                              </p>

                              <p class="profile_meta">
                              <label class="profile_meta_label">功能介绍</label>
                              <span class="profile_meta_value">专业的人工智能媒体和产业服务平台</span>
                              </p>
                              
                          </div>
                          <span class="profile_arrow_wrp" id="js_profile_arrow_wrp">
                              <i class="profile_arrow arrow_out"></i>
                              <i class="profile_arrow arrow_in"></i>
                          </span>
                      </div>
                    </span>

                    <em id="publish_time" class="rich_media_meta rich_media_meta_text">2018-05-16</em>

                                    </div>
                
                
                
                
                                                
                                                                
                
                <div class="rich_media_content " id="js_content">
                    

                    

                    
                    
                    <p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;"></span></p><section style="white-space: normal;max-width: 100%;caret-color: rgb(51, 51, 51);"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section data-id="85660" data-custom="rgb(117, 117, 118)" data-color="rgb(117, 117, 118)" style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section data-id="85660" data-custom="rgb(117, 117, 118)" data-color="rgb(117, 117, 118)" style="max-width: 100%;border-width: 0px;border-style: initial;border-color: currentcolor;font-family: 微软雅黑;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="margin-top: 2em;padding-top: 0.5em;padding-bottom: 0.5em;max-width: 100%;border-style: solid none;font-family: inherit;text-decoration: inherit;border-top-color: rgb(204, 204, 204);border-bottom-color: rgb(204, 204, 204);border-top-width: 1px;border-bottom-width: 1px;box-sizing: border-box !important;word-wrap: break-word !important;"><p style="margin-top: -1.2em;max-width: 100%;min-height: 1em;text-align: center;line-height: 1.75em;border-width: initial;border-style: initial;border-color: currentcolor;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="color: rgb(255, 255, 255);"><span style="background-color: rgb(117, 117, 118);">选自arXiv</span></span></p><section data-style="white-space: normal; text-align: left;font-size: 14px;line-height: 1.5em; color: rgb(12, 12, 12);" style="padding: 16px 16px 10px;max-width: 100%;font-family: inherit;box-sizing: border-box !important;word-wrap: break-word !important;"><p style="max-width: 100%;min-height: 1em;text-align: center;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="color: rgb(136, 136, 136);"><span style="font-size: 12px;"><strong>作者：Hanqing Zhao等</strong></span></span></p><p style="max-width: 100%;min-height: 1em;text-align: center;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="color: rgb(136, 136, 136);"><span style="font-size: 12px;"><strong>机器之心编译</strong></span></span></p><p style="max-width: 100%;min-height: 1em;text-align: center;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="color: rgb(136, 136, 136);"><span style="font-size: 12px;"><strong>参与：刘晓坤、李亚洲</strong></span></span></p></section></section></section></section></section></section></section></section></section></section></section></section><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;"></span><br></p><blockquote><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;color: rgb(136, 136, 136);">排序一直是计算机科学中最为基础的算法之一，从简单的冒泡排序到高效的桶排序，我们已经开发了非常多的优秀方法。但随着机器学习的兴起与大数据的应用，简单的排序方法要求在大规模场景中有更高的稳定性与效率。中国科技大学和兰州大学等研究者提出了一种基于机器学习的排序算法，它能实现 O(N) 的时间复杂度，且可以在 GPU 和 TPU 上高效地实现并行计算。这篇论文在 Reddit 上也有所争议，我们也希望机器学习能在更多的基础算法上展现出更优秀的性能。</span></p></blockquote><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">排序，作为数据上的基础运算，从计算伊始就有着极大的吸引力。虽然当前已有大量的卓越算法，但基于比较的排序算法对Ω(N log N) 比较有着根本的需求，也就是 O(N log N) 时间复杂度。近年来，随着大数据的兴起（甚至万亿字节的数据），效率对数据处理而言愈为重要，研究者们也做了许多努力来提高排序算法的效率。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">大部分顶尖的排序算法采用并行计算来处理大数据集，也取得了卓越的成果。例如，2015 年阿里巴巴开发的 FuxiSort，就是在 Apsara 上的分布式排序实现。FuxiSort 能够在随机非偏态（non-skewed）数据集上用 377 秒完成 100TB 的 Daytona GraySort 基准，在偏态数据集上的耗时是 510 秒，而在 Indy GraySort 基准上的耗时是 329 秒。到了 2016 年，在 Indy GraySort 基准上，Tencent Sort 排序 100TB 数据时达到了 60.7TB/min 的速度，使用的是为超大数据中心优化过的包含 512 个 OpenPOWER 服务器集群。然而，这些算法仍旧受下边界复杂度和网络耗时的限制。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">另一方面，机器学习在近年来发展迅速，已经在多个领域中得到广泛应用。在 2012 年，使用深度卷积神经网络实现 ImageNet 图像的接近误差减半的分类是一项重大突破，并使深度学习迅速被计算机视觉社区所接受。在 2016 年 3 月，AlphaGo 使用神经网络在人工智能的重大挑战即围棋中打败了世界冠军李世石。机器学习的巨大成功表明计算机 AI 可以在复杂任务中超越人类知识，即使是从零开始。在这之后，机器学习算法被广泛应用到了多种领域例如人类视觉、自然语言理解、医学图像处理等，并取得了很高的成就。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">由人类大脑结构启发而来的神经网络方法拥有输入层、输出层和隐藏层。隐藏层由多个链接人工神经元构成。这些神经元连接强度根据输入和输出数据进行调整，以精确地反映数据之间的关联。神经网络的本质是从输入数据到输出数据的映射。一旦训练阶段完成，我们可以应用该神经网络来对未知数据进行预测。这就是所谓的推理阶段。推理阶段的精度和效率启发研究者应用机器学习技术到排序问题上。在某种程度上，可以将排序问题看成是从数据到其在数据集位置的映射。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">在本文中，研究者提出了一个复杂度为 O（N·M）的使用机器学习的排序算法，其在大数据上表现得尤其好。这里 M 是表示神经网络隐藏层中的神经元数量的较小常数。我们首先使用一个 3 层神经网络在一个小规模训练数据集上训练来逼近大规模数据集的分布。然后使用该网络来评估每个位置数据在未来排序序列中的位置。在推理阶段，我们不需要对两个数据之间进行比较运算，因为我们已经有了近似分布。在推理阶段完成之后，我们得到了几乎排序好的序列。因此，我们仅需要应用 O(N) 时间复杂度的运算来得到完全排序的数据序列。此外，该算法还可以应用到稀疏哈希表上。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><strong><span style="font-size: 15px;">算法</span></strong></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">若假定我们有一个实数序列 S，它的长度为 N、上边界和下边界分别为 x_max 和 x_min。对于一个有效的排序算法，我们需要交换 x_i 的位置来确保新的序列 S' 是经过排序的。假设一个实数 x_i 在序列 S' 中的位置为 r_i，那么我们可以将排序问题视为一个双映射函数 G(x_i)=r_i。如果我们可以预先求得这个函数，那么排序算法的复杂度就为 O(N)。实际上，如果序列 S 中所有的实数都来自同一分布 f(x)，且当 N 足够大时，那么 x_i 在新序列 S' 中的排位 r_i 将近似等于：</span></p><p><br></p><p><img class="" data-ratio="0.18341708542713567" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gW8sjsncEjIKgibrFIP6yuty9Sd84JSibRk5cqze4t6I6oB2jOhvgSQTKvtRUKPWx57wVQC3hPumMqicA/640?wx_fmt=png" data-type="png" data-w="796" style=""></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">其中 F 为数据的概率分布函数，且当 N 趋向于无穷大时，表达式左右两边取等号。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">这样形式化排序问题的困难时函数 G(x) 通常是很难推导的，概率密度函数 f(x) 同样也如此。然而当我们处理大数据序列时，N 会足够大以令序列保持一些统计属性。因此如果我们能推出概率密度函数 f(x)，那么就有机会根据上面所示的方程 1 降低排序算法的复杂度到 O(N)。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">在这一篇论文中，作者们应用了广义支持向量机（General Vector Machine，GVM）来逼近概率密度函数 f(x)。这种 GVM 是带有一个隐藏层的三层神经网络，且它的结构展示在以下图 1 中。GVM 的学习过程基于蒙特卡洛算法而不是反向传播，作者们也发现 GVM 非常适合拟合函数。</span></p><p><br></p><p><img class="" data-ratio="0.7940841865756542" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gW8sjsncEjIKgibrFIP6yuty9h7gtiavPyqvF8TMJKdtdiapJPWN2Rg7UMuJ5CSiagdSMianewll6fXiccRQ/640?wx_fmt=png" data-type="png" data-w="879" style=""></p><p style="text-align: left;line-height: 1.75em;"><span style="color: rgb(136, 136, 136);font-size: 12px;"><em>图 1：GVM 的简单图示。研究者在每个实验中固定 M 为 100 个隐藏层神经元。</em></span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">在该神经网络中，输入层仅有一个神经元且输入是用于拟合函数的 x_i，输出层也只有一个神经元，输出为 y_i。研究者修改了隐藏层的神经元数量为 M=100。实际在某种程度上，隐藏层的神经元越多拟合的精度就越大，但同时也伴随着过拟合问题，以及计算效率降低的问题。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">N 个实数的排序估计过程仅需要 O(N·M) 的时间。M 与 N 是互相独立的，且在理论分析上 M 是没有下界的。例如如果数据序列服从高斯分布且我们只使用一个隐藏神经元，那么计算复杂度就为 log(N)。特别地，我们也可以用多个神经元拟合高斯分布，神经元的数量依赖于机器学习方法。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">在预测过程中，这种算法不需要比较和交换运算，并且每个数据的排序估计都是互相独立的，这使得并行计算变得高效且网络负载小。除了高效并行计算之外，由于机器学习需要矩阵运算，它还适用于在 GPU 或 TPU 上工作以实现加速 [19]。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><strong><span style="font-size: 15px;">实验</span></strong></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">如图 2 所示，我们选择两种分布进行实验：均匀分布和截尾正态分布。</span></p><p><br></p><p><img class="" data-ratio="0.7391304347826086" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gW8sjsncEjIKgibrFIP6yuty9J7DxrPx2IajL0IODTXFccxFGqn39jefHZKnyk12bl44nzrV5dppDeQ/640?wx_fmt=png" data-type="png" data-w="828" style=""></p><p style="text-align: justify;line-height: 1.75em;"><span style="color: rgb(136, 136, 136);font-size: 12px;"><em>图 2：数据分布。（a）截尾正态分布和（b）均匀分布的 107 个数据点。（c）截尾正态分布和（d）均匀分布的训练序列分布的 103 个数据点。紫色实线是解析分布，粉色点线是实验数据。</em></span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">图 3 对比了 Tim Sorting 和 Machine Learning Sorting 的运行时间。</span></p><p style="text-align: justify;line-height: 1.75em;"><br></p><p><img class="" data-ratio="0.7613219094247246" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gW8sjsncEjIKgibrFIP6yuty9AaedbJF01bUjtUCyHDWppmoGVbUJqwaibcZ46RICb1TEV1DOyTnDX0Q/640?wx_fmt=png" data-type="png" data-w="817" style=""></p><p style="text-align: justify;line-height: 1.75em;"><span style="color: rgb(136, 136, 136);font-size: 12px;"><em>图 3：（a）截尾正态分布的数据数量和时间复杂度的关系。（b）截尾正态分布的数据数量和时间复杂度离均差的关系。（c）均匀分布的数据数量和时间复杂度的关系。（d）均匀分布的数据数量和时间复杂度离均差的关系，研究者使用了 102 次实现的总体均值来获得结果。</em></span></p><p><br></p><p><strong><span style="font-size: 15px;">论文：An O(N) Sorting Algorithm: Machine Learning Sorting</span></strong></p><p><br></p><p><img class="" data-ratio="0.3164750957854406" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gW8sjsncEjIKgibrFIP6yuty9r0hC7JRocCswcRibqEYmlASNNYKHEUxupE3uWT4BCckvwhA3Pb4KXCA/640?wx_fmt=png" data-type="png" data-w="1305" style=""></p><p><br></p><p><span style="color: rgb(123, 12, 0);font-size: 15px;">论文地址：https://arxiv.org/pdf/1805.04272.pdf</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 15px;">我们提出了一种基于机器学习方法的 O(N) 排序算法，其在大数据排序应用上有巨大的潜力。该排序算法可以应用到并行排序，且适用于 GPU 或 TPU 加速。此外，我们还将该算法应用到了稀疏哈希表上。<img class="" data-ratio="0.3287671232876712" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gW8Zfpicd40EribGuaFicDBCRH6IOu1Rnc4T3W3J1wE0j6kQ6GorRSgicib0fmNrj3yzlokup2jia9Z0YVeA/640?wx_fmt=png" data-type="png" data-w="73" style="color: rgb(51, 51, 51);width: 42px;height: 16px;" width="48px"></span></p><p><br></p><p style="max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);"><span style="max-width: 100%;font-size: 14px;color: rgb(123, 12, 0);box-sizing: border-box !important;word-wrap: break-word !important;">蚂蚁金服举办首届金融科技领域算法类大赛——ATEC 蚂蚁开发者大赛人工智能大赛，点击「阅读原文」 进入大赛官网了解比赛信息，比赛报名请使用PC端浏览器打开官网。</span></p><p style="max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);"><span style="max-width: 100%;font-size: 14px;color: rgb(123, 12, 0);box-sizing: border-box !important;word-wrap: break-word !important;"></span></p><p style="max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);"><img class="" data-copyright="0" data-ratio="0.5555555555555556" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_jpg/KmXPKA19gW8GkZEft8vap2wf7yxZnZzTicLwAibquDgibicuW6HbEoe8oyW0p09Sz02PicD6zHwyIW3Ip3Wl7Dx6ibXQ/640?wx_fmt=jpeg" data-type="jpeg" data-w="900" style="box-sizing: border-box !important;word-wrap: break-word !important;visibility: visible !important;width: auto !important;" width="auto"></p>
                </div>
                <script nonce="201643802" type="text/javascript">
                    var first_sceen__time = (+new Date());

                    if ("" == 1 && document.getElementById('js_content')) {
                        document.getElementById('js_content').addEventListener("selectstart",function(e){ e.preventDefault(); });
                    }

                    
                    (function(){
                        if (navigator.userAgent.indexOf("WindowsWechat") != -1){
                            var link = document.createElement('link');
                            var head = document.getElementsByTagName('head')[0];
                            link.rel = 'stylesheet';
                            link.type = 'text/css';
                            link.href = "//res.wx.qq.com/mmbizwap/zh_CN/htmledition/style/page/appmsg_new/winwx3db0db.css";
                            head.appendChild(link);
                        }
                    })();
                </script>
                
                
                                
                <div class="ct_mpda_wrp" id="js_sponsor_ad_area" style="display:none;"></div>

                
                                <div class="reward_area tc appmsg_card_context" id="js_preview_reward" style="display:none;">
                    <div class="reward_inner">
                        <p id="js_preview_reward_wording" class="tips_global reward_tips" style="display:none;"></p>
                        <p>
                            <a class="reward_access" id="js_preview_reward_link" href="##">赞赏</a>
                        </p>
                    </div>
                </div>
                <div class="reward_qrcode_area reward_area tc" id="js_preview_reward_qrcode" style="display:none;">
                    <p class="tips_global">长按二维码向我转账</p>
                    <p id="js_preview_reward_ios_wording" class="reward_tips" style="display:none;"></p>
                    <span class="reward_qrcode_img_wrp"><img class="reward_qrcode_img" src="//res.wx.qq.com/mmbizwap/zh_CN/htmledition/images/pic/appmsg/pic_reward_qrcode.2x3534dd.png"></span>
                    <p class="tips_global">受苹果公司新规定影响，微信 iOS 版的赞赏功能被关闭，可通过二维码转账支持公众号。</p>
                </div>
                            </div>
                                        
                                

                        
            <ul id="js_hotspot_area" class="article_extend_area"></ul>


            
                        <div class="rich_media_tool" id="js_toobar3">

                                            <a class="media_tool_meta meta_primary" id="js_view_source" href="##">阅读原文</a>
                                <span style="display:none;" class="media_tool_meta meta_primary tips_global meta_praise" id="like3">
                    <i class="icon_praise_gray"></i><span class="praise_num" id="likeNum3"></span>
                </span>
                <div id="js_read_area3" class="media_tool_meta tips_global meta_primary" style="display:none;">阅读 <span id="readNum3"></span></div>

                <a id="js_report_article3" style="display:none;" class="media_tool_meta tips_global meta_extra" href="##">投诉</a>

            </div>


                        <div class="rich_media_tool" id="js_sg_bar">

                                <a class="media_tool_meta meta_primary" href="https://dc.antfin.com/index" target="_blank">阅读原文</a>
                                
            </div>
                    </div>

        <div class="rich_media_area_primary sougou" id="sg_tj" style="display:none"></div>


        
        <div class="rich_media_area_extra">
            
            <div id="js_share_appmsg">
            </div>

            
                        <div class="mpda_bottom_container" id="js_bottom_ad_area"></div>
                        
            <div id="js_iframetest" style="display:none;"></div>
                        
                        
            <div class="rich_media_extra rich_media_extra_discuss" id="js_cmt_container" style="display:none">
              
              <div class="discuss_mod" id="js_cmt_title" style="display:none">
                <div class="discuss_container">
                  <div class="weui-loadmore weui-loadmore_line mod_title_context_primary">
                    <span class="weui-loadmore__tips">留言</span>
                  </div>
                </div>
              </div>

              
              <div class="discuss_mod" id="js_friend_cmt_area" style="display:none">
                
                
                
              </div>

                            <div class="discuss_mod" id="js_cmt_area" style="display:none">
              </div>
                          </div>
        </div>

        
        <div id="js_pc_qr_code" class="qr_code_pc_outer" style="display:none;">
            <div class="qr_code_pc_inner">
                <div class="qr_code_pc">
                    <img id="js_pc_qr_code_img" class="qr_code_pc_img">
                    <p>微信扫一扫<br>关注该公众号</p>
                </div>
            </div>
        </div>
    </div>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
