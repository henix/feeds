<div class="title-image"><img src="https://pic2.zhimg.com/v2-8eec1bba32fd0da619e3282f391992b4_b.jpg" alt=""></div><h2>CanHackMeğŸ¯</h2><p>ä¸€ä¸ªåŸºäº php çš„ CTF å¼€æºå¹³å°ã€‚</p><p>å®˜ç½‘ï¼š<a href="https://link.zhihu.com/?target=https%3A//canhack.me/" class=" wrap external" target="_blank" rel="nofollow noreferrer">ht</a>tps://canhack.me/</p><p>é¡¹ç›®åœ°å€ï¼š<a href="https://link.zhihu.com/?target=https%3A//github.com/safflower/canhackme" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">https://</span><span class="visible">github.com/safflower/ca</span><span class="invisible">nhackme</span><span class="ellipsis"></span></a></p><h2>æ­å»ºç¯å¢ƒğŸ“</h2><p><b>ç¯å¢ƒï¼ˆUbuntu 16.04+Apache 2.4+PHP 7.3ï¼‰</b></p><p><b>å®‰è£… Apache 2.4</b></p><p>å‘½ä»¤ï¼š</p><div class="highlight"><pre><code class="language-text">sudo apt update
sudo apt install apache2</code></pre></div><p>ç„¶åæ£€æŸ¥æ˜¯å¦æˆåŠŸï¼š</p><div class="highlight"><pre><code class="language-text">apache2 -v</code></pre></div><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-3715489f4a091937442405ef8bab17df_b.jpg" data-caption="" data-size="normal" data-rawwidth="444" data-rawheight="89" class="origin_image zh-lightbox-thumb" width="444" data-original="https://pic4.zhimg.com/v2-3715489f4a091937442405ef8bab17df_r.jpg"/></noscript><img src="https://pic4.zhimg.com/v2-3715489f4a091937442405ef8bab17df_b.jpg" data-caption="" data-size="normal" data-rawwidth="444" data-rawheight="89" class="origin_image zh-lightbox-thumb lazy" width="444" data-original="https://pic4.zhimg.com/v2-3715489f4a091937442405ef8bab17df_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-3715489f4a091937442405ef8bab17df_b.jpg"/></figure><p><b>å®‰è£… PHP 7.3</b></p><p>å‘½ä»¤ï¼š</p><div class="highlight"><pre><code class="language-text">sudo apt-get install software-properties-common
sudo add-apt-repository ppa:ondrej/php
sudo apt-get update
sudo apt-get install -y php7.3</code></pre></div><p>æ£€æŸ¥æ˜¯å¦æˆåŠŸï¼š</p><div class="highlight"><pre><code class="language-text">php -v</code></pre></div><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-0614cbe2c15f07977b1385af62d47e3d_b.jpg" data-caption="" data-size="normal" data-rawwidth="1053" data-rawheight="142" class="origin_image zh-lightbox-thumb" width="1053" data-original="https://pic2.zhimg.com/v2-0614cbe2c15f07977b1385af62d47e3d_r.jpg"/></noscript><img src="https://pic2.zhimg.com/v2-0614cbe2c15f07977b1385af62d47e3d_b.jpg" data-caption="" data-size="normal" data-rawwidth="1053" data-rawheight="142" class="origin_image zh-lightbox-thumb lazy" width="1053" data-original="https://pic2.zhimg.com/v2-0614cbe2c15f07977b1385af62d47e3d_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-0614cbe2c15f07977b1385af62d47e3d_b.jpg"/></figure><p><b>å®‰è£… Sqlite3</b></p><div class="highlight"><pre><code class="language-text">sudo apt install sqlite3</code></pre></div><blockquote>SQLite æ˜¯ä¸€ä¸ªè½¯ä»¶åº“ï¼Œå®ç°äº†è‡ªç»™è‡ªè¶³çš„ã€æ— æœåŠ¡å™¨çš„ã€é›¶é…ç½®çš„ã€äº‹åŠ¡æ€§çš„ SQL æ•°æ®åº“å¼•æ“ã€‚SQLite æ˜¯åœ¨ä¸–ç•Œä¸Šæœ€å¹¿æ³›éƒ¨ç½²çš„ SQL æ•°æ®åº“å¼•æ“ã€‚SQLite æºä»£ç ä¸å—ç‰ˆæƒé™åˆ¶ã€‚</blockquote><p><b>å®‰è£… php-sqlite3 æ¨¡å—</b></p><p>å‘½ä»¤ï¼š</p><div class="highlight"><pre><code class="language-text">sudo apt install php7.3-sqlite3</code></pre></div><p>è¿™é‡Œéœ€è¦æ³¨æ„ï¼Œè¦ä¿®æ”¹ php.ini æ–‡ä»¶ /etc/php/7.3/apache2/php.iniï¼ŒæŠŠå‰é¢çš„åˆ†å·å»æ‰</p><div class="highlight"><pre><code class="language-text">extension=sqlite3</code></pre></div><p><b>å®‰è£… php-mbstring æ¨¡å—</b></p><div class="highlight"><pre><code class="language-text">sudo apt install php-mbstring</code></pre></div><p>åŒæ ·çš„ï¼Œéœ€è¦ä¿®æ”¹ php.ini æ–‡ä»¶ /etc/php/7.3/apache2/php.iniï¼ŒæŠŠå‰é¢çš„åˆ†å·å»æ‰</p><div class="highlight"><pre><code class="language-text">extension=mbstring</code></pre></div><h2>é¡¹ç›®æ­å»º</h2><p><b>ä¸‹è½½</b></p><p>å…ˆä¸‹è½½é¡¹ç›®ï¼Œç›´æ¥ä¸‹è½½ä¸Šä¼ ï¼š</p><p>ä¸‹è½½åœ°å€ï¼š<a href="https://link.zhihu.com/?target=https%3A//github.com/safflower/canhackme" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">https://</span><span class="visible">github.com/safflower/ca</span><span class="invisible">nhackme</span><span class="ellipsis"></span></a></p><p>git æ–¹å¼ä¸‹è½½ï¼š</p><div class="highlight"><pre><code class="language-text">git clone https://github.com/safflower/canhackme</code></pre></div><p><b>é…ç½®è·¯ç”±</b></p><p>å…ˆé…ç½®è·¯ç”±ï¼Œä¿®æ”¹ apache2 é…ç½®æ–‡ä»¶</p><div class="highlight"><pre><code class="language-text">vim /etc/apache2/apache2.conf</code></pre></div><p>æŠŠè·¯å¾„æ”¹æˆä½ å®é™…çš„ç½‘ç«™æ ¹ç›®å½•ï¼ŒAllowOverride None æ”¹ä¸º AllowOverride ALL</p><div class="highlight"><pre><code class="language-text">&lt;Directory /var/www/html&gt;
        Options Indexes FollowSymLinks
        AllowOverride ALL
        Require all granted
&lt;/Directory&gt;</code></pre></div><p><b>å¼€å¯ mod_rewrite æ¨¡å—</b></p><p>å‘½ä»¤ï¼š</p><div class="highlight"><pre><code class="language-text">sudo a2enmod rewrite</code></pre></div><p>ç„¶åé‡å¯ apache2</p><div class="highlight"><pre><code class="language-text">service apache2 restart</code></pre></div><p><b>å¯¼å…¥ .sql æ•°æ®åº“æ–‡ä»¶</b></p><p>è¿›å…¥åˆ° @import/confs/ ç›®å½•ä¸‹ï¼Œå¯¼å…¥ init.sql æ–‡ä»¶åˆ° sqlite3</p><div class="highlight"><pre><code class="language-text">sqlite3 .common.db &lt; init.sql
root@linuz:/var/www/html/@import/confs# sqlite3 .common.db
SQLite version 3.11.0 2016-02-15 17:29:24
Enter &#34;.help&#34; for usage hints.
sqlite&gt; .dump
PRAGMA foreign_keys=OFF;
BEGIN TRANSACTION;
CREATE TABLE `users` (
        `user_no` INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
        `user_name` TEXT NOT NULL UNIQUE,
        `user_email` TEXT NOT NULL UNIQUE,
        `user_password` TEXT NOT NULL,
        `user_comment` TEXT NOT NULL,
        `user_score` INTEGER NOT NULL,
        `user_signed_up_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP
);
......
sqlite&gt; .exit</code></pre></div><p>ç„¶åæ›´æ”¹ confs ç›®å½•æƒé™ä¸º www-data</p><div class="highlight"><pre><code class="language-text">sudo chown -R www-data:www-data confs/</code></pre></div><p><b>è®¾ç½® recaptcha</b></p><p>recaptcha åœ°å€ï¼š<a href="https://link.zhihu.com/?target=https%3A//www.google.com/recaptcha" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">https://www.</span><span class="visible">google.com/recaptcha</span><span class="invisible"></span></a></p><p>åœ¨ä¸Šé¢æ³¨å†Œä½ çš„å¹³å°ç½‘ç«™ï¼ˆé€‰æ‹© recaptcha ç¬¬3ç‰ˆï¼‰</p><figure data-size="small"><noscript><img src="https://pic1.zhimg.com/v2-6e504dd8151d5921a780114ea4369bd4_b.jpg" data-caption="" data-size="small" data-rawwidth="939" data-rawheight="1174" class="origin_image zh-lightbox-thumb" width="939" data-original="https://pic1.zhimg.com/v2-6e504dd8151d5921a780114ea4369bd4_r.jpg"/></noscript><img src="https://pic1.zhimg.com/v2-6e504dd8151d5921a780114ea4369bd4_b.jpg" data-caption="" data-size="small" data-rawwidth="939" data-rawheight="1174" class="origin_image zh-lightbox-thumb lazy" width="939" data-original="https://pic1.zhimg.com/v2-6e504dd8151d5921a780114ea4369bd4_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-6e504dd8151d5921a780114ea4369bd4_b.jpg"/></figure><p>ç„¶åè·å–ç§˜é’¥ï¼š</p><figure data-size="small"><noscript><img src="https://pic1.zhimg.com/v2-d5b745c9c61a55ee1963cb58be17bf50_b.jpg" data-caption="" data-size="small" data-rawwidth="1409" data-rawheight="667" class="origin_image zh-lightbox-thumb" width="1409" data-original="https://pic1.zhimg.com/v2-d5b745c9c61a55ee1963cb58be17bf50_r.jpg"/></noscript><img src="https://pic1.zhimg.com/v2-d5b745c9c61a55ee1963cb58be17bf50_b.jpg" data-caption="" data-size="small" data-rawwidth="1409" data-rawheight="667" class="origin_image zh-lightbox-thumb lazy" width="1409" data-original="https://pic1.zhimg.com/v2-d5b745c9c61a55ee1963cb58be17bf50_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-d5b745c9c61a55ee1963cb58be17bf50_b.jpg"/></figure><p>åœ¨å¹³å°çš„é…ç½®æ–‡ä»¶common.phpé‡Œé¢ï¼Œä¿®æ”¹ä¸€äº›ç½‘ç«™çš„åŸºæœ¬ä¿¡æ¯ï¼ŒåŒ…æ‹¬ç½‘ç«™URLã€ä½œè€…ä¿¡æ¯ç­‰</p><figure data-size="small"><noscript><img src="https://pic1.zhimg.com/v2-847438c2653cca3548f01d1b0f557c50_b.jpg" data-caption="" data-size="small" data-rawwidth="858" data-rawheight="685" class="origin_image zh-lightbox-thumb" width="858" data-original="https://pic1.zhimg.com/v2-847438c2653cca3548f01d1b0f557c50_r.jpg"/></noscript><img src="https://pic1.zhimg.com/v2-847438c2653cca3548f01d1b0f557c50_b.jpg" data-caption="" data-size="small" data-rawwidth="858" data-rawheight="685" class="origin_image zh-lightbox-thumb lazy" width="858" data-original="https://pic1.zhimg.com/v2-847438c2653cca3548f01d1b0f557c50_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-847438c2653cca3548f01d1b0f557c50_b.jpg"/></figure><p><b>æ›´æ¢ç§˜é’¥</b></p><p>ç¬¬ä¸€ä¸ªå¯†é’¥æ›¿æ¢ common.php æ–‡ä»¶é‡Œçš„ recaptcha_sitekey å†…å®¹</p><p>ç¬¬äºŒä¸ªå¯†é’¥ç¼–è¾‘æˆ .recaptcha_secretkey.txt æ–‡ä»¶ï¼Œæ”¾åˆ° @import/confs è·¯å¾„ä¸‹</p><h2>åˆ›å»ºé¢˜ç›®</h2><p>å¹³å°æ²¡æœ‰åå°ï¼Œæ‰€ä»¥åªèƒ½ç›´æ¥è®¿é—® sqlite3 æ•°æ®åº“æ·»åŠ é¢˜ç›®</p><p>æ·»åŠ é¢˜ç›®å‘½ä»¤ï¼š</p><div class="highlight"><pre><code class="language-text">sqlite&gt; INSERT INTO &#34;chals&#34; VALUES(1,&#39;name&#39;,&#39;title&#39;,&#39;contents&#39;,100,&#39;CanHackMe{xxxxxxxxxxxx}&#39;,&#39;web&#39;,&#39;1&#39;,&#39;2019-09-12&#39;);</code></pre></div><p>æŸ¥çœ‹é¢˜ç›®ï¼š</p><figure data-size="small"><noscript><img src="https://pic1.zhimg.com/v2-389c954a050d187e4eaa68318159c578_b.jpg" data-caption="" data-size="small" data-rawwidth="1602" data-rawheight="663" class="origin_image zh-lightbox-thumb" width="1602" data-original="https://pic1.zhimg.com/v2-389c954a050d187e4eaa68318159c578_r.jpg"/></noscript><img src="https://pic1.zhimg.com/v2-389c954a050d187e4eaa68318159c578_b.jpg" data-caption="" data-size="small" data-rawwidth="1602" data-rawheight="663" class="origin_image zh-lightbox-thumb lazy" width="1602" data-original="https://pic1.zhimg.com/v2-389c954a050d187e4eaa68318159c578_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-389c954a050d187e4eaa68318159c578_b.jpg"/></figure><p>å‘é€å…¬å‘Šï¼š</p><div class="highlight"><pre><code class="language-text">sqlite&gt; INSERT INTO &#34;notis&#34; VALUES(1,&#39;xxx&#39;,1,&#39;2020-01-09&#39;);</code></pre></div><figure data-size="small"><noscript><img src="https://pic1.zhimg.com/v2-cc79cf771cf800bbed34d235ef819458_b.jpg" data-caption="" data-size="small" data-rawwidth="1319" data-rawheight="398" class="origin_image zh-lightbox-thumb" width="1319" data-original="https://pic1.zhimg.com/v2-cc79cf771cf800bbed34d235ef819458_r.jpg"/></noscript><img src="https://pic1.zhimg.com/v2-cc79cf771cf800bbed34d235ef819458_b.jpg" data-caption="" data-size="small" data-rawwidth="1319" data-rawheight="398" class="origin_image zh-lightbox-thumb lazy" width="1319" data-original="https://pic1.zhimg.com/v2-cc79cf771cf800bbed34d235ef819458_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-cc79cf771cf800bbed34d235ef819458_b.jpg"/></figure><p><b>è®¾ç½® flag</b></p><p>flag çš„é»˜è®¤çš„æ ¼å¼ä¸º CanHackMe{...} ä¸”é•¿åº¦ä¸å°äº 10 ä½æ•°ï¼Œå¯ä»¥åœ¨ init.php æ–‡ä»¶ä¸­ä¿®æ”¹ã€‚</p><p>æŠŠ CanHackMe ä¿®æ”¹æˆä½ æƒ³è¦çš„æ ¼å¼ï¼š</p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-a4d5e1c9ffd744591355f70842c3498e_b.jpg" data-caption="" data-size="normal" data-rawwidth="1001" data-rawheight="76" class="origin_image zh-lightbox-thumb" width="1001" data-original="https://pic3.zhimg.com/v2-a4d5e1c9ffd744591355f70842c3498e_r.jpg"/></noscript><img src="https://pic3.zhimg.com/v2-a4d5e1c9ffd744591355f70842c3498e_b.jpg" data-caption="" data-size="normal" data-rawwidth="1001" data-rawheight="76" class="origin_image zh-lightbox-thumb lazy" width="1001" data-original="https://pic3.zhimg.com/v2-a4d5e1c9ffd744591355f70842c3498e_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-a4d5e1c9ffd744591355f70842c3498e_b.jpg"/></figure><h2>PSï¼š</h2><p><a href="https://link.zhihu.com/?target=https%3A//www.baidu.com/link%3Furl%3DOcGTJIGtwpNYrGru7tSszpEf10ZQ0xIE7SvER9ejNcCar00KI-fG2lu214M4WKPc%26wd%3D%26eqid%3Da24dabb2002f492b000000065e13d46a" class=" wrap external" target="_blank" rel="nofollow noreferrer">äºŒå‘ç®”å®‰å…¨</a>çš„ç½‘ç»œå®‰å…¨æŠ€èƒ½åŒ…æ›´æ–°äº†ï¼æ— éœ€ç™»å½•ã€æ— éœ€æ‰«æï¼Œåªéœ€ç‚¹å‡»ä¸‹æ–¹é“¾æ¥å³å¯ç•…ç©æŠ€èƒ½åŒ…ã€‚ï¼ˆCISP-PTE æŠ€èƒ½åŒ…ã€CTF æŠ€èƒ½åŒ…å³å°†ä¸Šçº¿ï¼Œæ•¬è¯·å…³æ³¨ï¼ï¼‰</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-41a1365ee0d9566c882af75894478f08_b.jpg" data-caption="" data-size="normal" data-rawwidth="2560" data-rawheight="1192" class="origin_image zh-lightbox-thumb" width="2560" data-original="https://pic1.zhimg.com/v2-41a1365ee0d9566c882af75894478f08_r.jpg"/></noscript><img src="https://pic1.zhimg.com/v2-41a1365ee0d9566c882af75894478f08_b.jpg" data-caption="" data-size="normal" data-rawwidth="2560" data-rawheight="1192" class="origin_image zh-lightbox-thumb lazy" width="2560" data-original="https://pic1.zhimg.com/v2-41a1365ee0d9566c882af75894478f08_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-41a1365ee0d9566c882af75894478f08_b.jpg"/></figure><a href="https://link.zhihu.com/?target=https%3A//lelge.exeye.run/skill_library_o" data-draft-node="block" data-draft-type="link-card" class=" wrap external" target="_blank" rel="nofollow noreferrer">æ–°æ‰‹å…¥é—¨ | æ¢¦å¢ƒç©¿è¶Š - ä¸»é¢˜æŠ€èƒ½åŒ…</a><p>æ›´å¤šæœ‰å…³æ¸—é€æµ‹è¯•çš„å†…å®¹è¯·å‰å¾€<a href="https://link.zhihu.com/?target=https%3A//www.baidu.com/link%3Furl%3DOcGTJIGtwpNYrGru7tSszpEf10ZQ0xIE7SvER9ejNcCar00KI-fG2lu214M4WKPc%26wd%3D%26eqid%3Da24dabb2002f492b000000065e13d46a" class=" wrap external" target="_blank" rel="nofollow noreferrer">äºŒå‘ç®”å®‰å…¨</a>è¿›è¡Œå­¦ä¹ ï¼Œæœ€è¿‘æ¨å‡ºäº†â€œæŒ–æ´â€ç­ï¼Œæƒ³äº†è§£æ›´å¤šèµ„è®¯çš„ï¼Œå¯å’¨è¯¢å®¢æœå¾®ä¿¡ <b>twosecurity02</b></p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-2222e29c6decda168e1be1f049d93ccf_b.jpg" data-caption="" data-size="normal" data-rawwidth="3041" data-rawheight="2000" class="origin_image zh-lightbox-thumb" width="3041" data-original="https://pic4.zhimg.com/v2-2222e29c6decda168e1be1f049d93ccf_r.jpg"/></noscript><img src="https://pic4.zhimg.com/v2-2222e29c6decda168e1be1f049d93ccf_b.jpg" data-caption="" data-size="normal" data-rawwidth="3041" data-rawheight="2000" class="origin_image zh-lightbox-thumb lazy" width="3041" data-original="https://pic4.zhimg.com/v2-2222e29c6decda168e1be1f049d93ccf_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-2222e29c6decda168e1be1f049d93ccf_b.jpg"/></figure>