<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>资源 | textgenrnn：只需几行代码即可训练文本生成网络</title>
</head>
<body>
<p><a href="https://mp.weixin.qq.com/s?timestamp=1525313243&amp;src=3&amp;ver=1&amp;signature=UPcz6OeZan3Pyo84tuZiAjdDQKxw6z90a4mcmBaAjvPVMFJbC4meoVrJGoT1yl9qWVqIHS7F481rJGvoUusHtFVUIGxVw5SoD8R2-sDilUoOFXIVrv2dPKy1oj1E2MNZLwNqg-5y5s96S73tkN18j3xAIqNE-xrz6vpzNYWG1ug=">原文</a></p>
<div id="img-content">
                
                <h2 class="rich_media_title" id="activity-name">
                    资源 | textgenrnn：只需几行代码即可训练文本生成网络                                    </h2>
                <div id="meta_content" class="rich_media_meta_list">
                                                            <em id="post-date" class="rich_media_meta rich_media_meta_text">2018-04-23</em>

                                        <a class="rich_media_meta rich_media_meta_link rich_media_meta_nickname" href="##" id="post-user">机器之心</a>
                    <span class="rich_media_meta rich_media_meta_text rich_media_meta_nickname">机器之心</span>


                    <div id="js_profile_qrcode" class="profile_container" style="display:none;">
                        <div class="profile_inner">
                            <strong class="profile_nickname">机器之心</strong>
                            <img class="profile_avatar" id="js_profile_qrcode_img" src="" alt="">

                            <p class="profile_meta">
                            <label class="profile_meta_label">微信号</label>
                            <span class="profile_meta_value">almosthuman2014</span>
                            </p>

                            <p class="profile_meta">
                            <label class="profile_meta_label">功能介绍</label>
                            <span class="profile_meta_value">专业的人工智能媒体和产业服务平台</span>
                            </p>
                            
                        </div>
                        <span class="profile_arrow_wrp" id="js_profile_arrow_wrp">
                            <i class="profile_arrow arrow_out"></i>
                            <i class="profile_arrow arrow_in"></i>
                        </span>
                    </div>
                </div>
                                
                
                
                
                                                
                                                                
                
                <div class="rich_media_content " id="js_content">
                    

                    

                    
                    
                    <section style="max-width: 100%;color: rgb(62, 62, 62);font-size: 16px;white-space: normal;caret-color: rgb(62, 62, 62);background-color: rgb(255, 255, 255);line-height: 28.4444px;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section data-id="85660" data-custom="rgb(117, 117, 118)" data-color="rgb(117, 117, 118)" style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section data-id="85660" data-custom="rgb(117, 117, 118)" data-color="rgb(117, 117, 118)" style="max-width: 100%;border-width: 0px;border-style: initial;border-color: currentcolor;font-family: 微软雅黑;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="margin-top: 2em;padding-top: 0.5em;padding-bottom: 0.5em;max-width: 100%;border-style: solid none;font-family: inherit;text-decoration: inherit;border-top-color: rgb(204, 204, 204);border-bottom-color: rgb(204, 204, 204);border-top-width: 1px;border-bottom-width: 1px;box-sizing: border-box !important;word-wrap: break-word !important;"><p style="margin-top: -1.2em;max-width: 100%;min-height: 1em;text-align: center;line-height: 1.75em;border-width: initial;border-style: initial;border-color: currentcolor;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(255, 255, 255);background-color: rgb(117, 117, 118);box-sizing: border-box !important;word-wrap: break-word !important;">选自GitHub</span></p><section data-style="white-space: normal; text-align: left;font-size: 14px;line-height: 1.5em; color: rgb(12, 12, 12);" style="padding: 16px 16px 10px;max-width: 100%;font-family: inherit;box-sizing: border-box !important;word-wrap: break-word !important;"><p style="max-width: 100%;min-height: 1em;text-align: center;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(136, 136, 136);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;">作者：</strong><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(136, 136, 136);text-align: justify;box-sizing: border-box !important;word-wrap: break-word !important;">minimaxir </span></strong></span></p><p style="max-width: 100%;min-height: 1em;text-align: center;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;font-family: inherit;text-decoration: inherit;color: rgb(136, 136, 136);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">机器之心编译</strong></p><p style="max-width: 100%;min-height: 1em;text-align: center;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(136, 136, 136);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">参与：</span></strong><span style="max-width: 100%;font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="color: rgb(136, 136, 136);max-width: 100%;text-align: justify;box-sizing: border-box !important;word-wrap: break-word !important;">Geek AI、路</span></strong></span></p></section></section></section></section></section></section></section></section></section></section></section></section><p><br></p><blockquote><p style="text-align: justify;line-height: 1.75em;"><span style="text-align: justify;font-size: 14px;color: rgb(136, 136, 136);">本文是一个 GitHub 项目，介绍了 textgenrnn，一个基于 Keras/TensorFlow 的 Python 3 模块。只需几行代码即可训练文本生成网络。</span></p></blockquote><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"><br></span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;color: rgb(123, 12, 0);">项目地址：https://github.com/minimaxir/textgenrnn?reddit=1</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;color: rgb(123, 12, 0);"><br></span></p><p><img class="" data-copyright="0" data-ratio="0.6713091922005571" src="https://mmbiz.qpic.cn/mmbiz_gif/KmXPKA19gWicqq0P7gR2IDEM9NoBQ8iaMNIcqF6ur1WXUSx8iccMBYWNVdic8jiaHDmRmHcabLGt2FOXupGHlTNO8VQ/640?wx_fmt=gif" data-type="gif" data-w="718" style=""></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"><br></span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">通过简简单单的几行代码，使用预训练神经网络生成文本，或者在任意文本数据集上训练你自己的任意规模和复杂度的文本生成神经网络。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">textgenrnn 是一个基于 Keras/TensorFlow 的 Python 3 模块，用于创建 char-rnn，具有许多很酷炫的特性：</span></p><p><br></p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">它是一个使用注意力权重（attention-weighting）和跳跃嵌入（skip-embedding）等先进技术的现代神经网络架构，用于加速训练并提升模型质量。</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">能够在字符层级和词层级上进行训练和预测。</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">能够设置 RNN 的大小、层数，以及是否使用双向 RNN。</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">能够对任何通用的输入文本文件进行训练。</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">能够在 GPU 上训练模型，然后在 CPU 上使用这些模型。</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">在 GPU 上训练时能够使用强大的 CuDNN 实现 RNN，这比标准的 LSTM 实现大大加速了训练时间。</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">能够使用语境标签训练模型，能够更快地学习并在某些情况下产生更好的结果。</span></p></li></ul><p><span style="font-size: 14px;text-align: justify;"><br></span></p><p><span style="font-size: 14px;text-align: justify;">你可以使用 textgenrnn，并且在该 Colaboratory Notebook（https://drive.google.com/file/d/1mMKGnVxirJnqDViH7BDJxFqWrsXlPSoK/view?usp=sharing）中免费使用 GPU 训练任意文本文件。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><strong><span style="font-size: 14px;">示例</span></strong></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"></span></p><pre style="box-sizing: border-box;margin-top: 0px;margin-bottom: 0px;padding: 0px;font-size: 16px;color: rgb(62, 62, 62);line-height: inherit;background-color: rgb(255, 255, 255);"><code class="python language-python hljs" style="box-sizing: border-box;margin-right: 2px;margin-left: 2px;padding: 0.5em;font-size: 14px;color: rgb(169, 183, 198);line-height: 18px;border-radius: 0px;background: rgb(40, 43, 46);font-family: Consolas, Inconsolata, Courier, monospace;display: block;overflow-x: auto;letter-spacing: 0px;word-wrap: normal !important;word-break: normal !important;overflow-y: auto !important;"><span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">from</span> textgenrnn <span class="hljs-keyword" style="box-sizing: border-box;font-size: inherit;color: rgb(248, 35, 117);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">import</span> textgenrnn<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;"><br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">textgen = textgenrnn()<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">textgen.generate()</code></pre><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"></span></p><p><br></p><blockquote><p><span style="font-size: 14px;color: rgb(136, 136, 136);">[Spoiler] Anyone else find this post and their person that was a little more than I really like the Star Wars in the fire or health and posting a personal house of the 2016 Letter for the game in a report of my backyard.</span></p></blockquote><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">该模型可以很容易地在新的文本上进行训练，甚至可以在仅仅输入一次数据之后生成合适的文本。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"></span></p><pre style="box-sizing: border-box;margin-top: 0px;margin-bottom: 0px;padding: 0px;font-size: 16px;color: rgb(62, 62, 62);line-height: inherit;background-color: rgb(255, 255, 255);"><code class="python language-python hljs" style="box-sizing: border-box;margin-right: 2px;margin-left: 2px;padding: 0.5em;font-size: 14px;color: rgb(169, 183, 198);line-height: 18px;border-radius: 0px;background: rgb(40, 43, 46);font-family: Consolas, Inconsolata, Courier, monospace;display: block;overflow-x: auto;letter-spacing: 0px;word-wrap: normal !important;word-break: normal !important;overflow-y: auto !important;">textgen.train_from_file(<span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">'hacker-news-2000.txt'</span>, num_epochs=<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">1</span>)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">textgen.generate()<br></code></pre><p><br></p><blockquote><p><span style="font-size: 14px;color: rgb(136, 136, 136);">Project State Project Firefox</span></p></blockquote><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"><br></span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">这个模型的权重比较小（占磁盘上 2 MB 的空间），它们可以很容易地被保存并加载到新的 textgenrnn 实例中。因此，你可以使用经过数百次数据输入训练的模型。（实际上，textgenrnn 的学习能力过于强大了，以至于你必须大大提高温度（Temperature）来得到有创造性的输出。）</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"></span></p><pre style="box-sizing: border-box;margin-top: 0px;margin-bottom: 0px;padding: 0px;font-size: 16px;color: rgb(62, 62, 62);line-height: inherit;background-color: rgb(255, 255, 255);"><code class="python language-python hljs" style="box-sizing: border-box;margin-right: 2px;margin-left: 2px;padding: 0.5em;font-size: 14px;color: rgb(169, 183, 198);line-height: 18px;border-radius: 0px;background: rgb(40, 43, 46);font-family: Consolas, Inconsolata, Courier, monospace;display: block;overflow-x: auto;letter-spacing: 0px;word-wrap: normal !important;word-break: normal !important;overflow-y: auto !important;">textgen_2 = textgenrnn(<span class="hljs-string" style="box-sizing: border-box;font-size: inherit;color: rgb(238, 220, 112);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">'/weights/hacker_news.hdf5'</span>)<br style="box-sizing: border-box;font-size: inherit;color: inherit;line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">textgen_2.generate(<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">3</span>, temperature=<span class="hljs-number" style="box-sizing: border-box;font-size: inherit;color: rgb(174, 135, 250);line-height: inherit;word-wrap: inherit !important;word-break: inherit !important;">1.0</span>)</code></pre><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"></span></p><pre lang="text" style="box-sizing: border-box;"><code style="box-sizing: border-box;"></code></pre><blockquote><p><span style="font-size: 14px;color: rgb(136, 136, 136);">Why we got money “regular alter”</span></p><p><br></p><p><span style="font-size: 14px;color: rgb(136, 136, 136);">Urburg to Firefox acquires Nelf Multi Shamn</span></p><p><br></p><p><span style="font-size: 14px;color: rgb(136, 136, 136);">Kubernetes by Google’s Bern</span></p></blockquote><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">您还可以训练一个支持词级别嵌入和双向 RNN 层的新模型。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><strong><span style="font-size: 14px;">使用方法</span></strong></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">textgenrnn 可以通过 pip 从 pypi（https://pypi.python.org/pypi/textgenrnn）中安装：</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"></span></p><pre style="box-sizing: border-box;margin-top: 0px;margin-bottom: 0px;padding: 0px;font-size: 16px;color: rgb(62, 62, 62);line-height: inherit;background-color: rgb(255, 255, 255);"><code class="python language-python hljs" style="box-sizing: border-box;margin-right: 2px;margin-left: 2px;padding: 0.5em;font-size: 14px;color: rgb(169, 183, 198);line-height: 18px;border-radius: 0px;background: rgb(40, 43, 46);font-family: Consolas, Inconsolata, Courier, monospace;display: block;overflow-x: auto;letter-spacing: 0px;word-wrap: normal !important;word-break: normal !important;overflow-y: auto !important;">pip3 install textgenrnn</code></pre><p><br></p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p style="text-align: left;line-height: 1.75em;"><span style="font-size: 14px;">你可以在该 Jupyter Notebook（https://github.com/minimaxir/textgenrnn/blob/master/docs/textgenrnn-demo.ipynb）中查看常见的功能和配置选项的演示案例。</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">/datasets 包含用于训练 textgenrnn 的 Hacker News 和 Reddit data 示例数据集。</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">/weights 包含在上述的数据集上进一步预训练的模型，它可以被加载到 textgenrnn 中。</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">/output 包含从上述预训练模型中生成文本的示例。</span></p></li></ul><p><br></p><p style="text-align: justify;line-height: 1.75em;"><strong><span style="font-size: 14px;">神经网络架构及实现</span></strong></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">textgenrnn 基于 Andrej Karpathy 的 char-rnn 项目（https://github.com/karpathy/char-rnn），并且融入了一些最新的优化，如处理非常小的文本序列的能力。</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"><br></span></p><p><img class="" data-copyright="0" data-ratio="1.0300859598853869" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWicqq0P7gR2IDEM9NoBQ8iaMNSk0icicELqKBmqsu2vlNFBPW87Nh01FicZ9AgSz3ndgibFY9z0QkibXTs5Q/640?wx_fmt=png" data-type="png" data-w="698" style=""></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"><br></span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">本文涉及到的预训练模型遵循 DeepMoji 的神经网络架构（https://github.com/bfelbo/DeepMoji/blob/master/deepmoji/model_def.py）的启发。对于默认的模型，textgenrnn 接受最多 40 个字符的输入，它将每个字符转换为 100 维的字符嵌入向量，并将这些向量输入到一个包含 128 个神经元的长短期记忆（LSTM）循环层中。接着，这些输出被传输至另一个包含 128 个神经元的 LSTM 中。以上所有三层都被输入到一个注意力层中，用来给最重要的时序特征赋权，并且将它们取平均（由于嵌入层和第一个 LSTM 层是通过跳跃连接与注意力层相连的，因此模型的更新可以更容易地向后传播并且防止梯度消失）。该输出被映射到最多 394 个不同字符的概率分布上，这些字符是序列中的下一个字符，包括大写字母、小写字母、标点符号和表情。（如果在新的数据集上训练一个新模型，可以配置所有上面提到的数值参数。）</span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"><br></span></p><p><img class="" data-copyright="0" data-ratio="0.7477396021699819" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gWicqq0P7gR2IDEM9NoBQ8iaMNqHPsIJd2PiaFOL0JH7MlQHbdewdAW7z53Wgc9bacZ5nLe4YjGyRLrbw/640?wx_fmt=png" data-type="png" data-w="1106" style=""></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"><br></span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">或者，如果可以获得每个文本文档的语境标签，则可以在语境模式下训练模型。在这种模式下，模型会学习给定语境的文本，这样循环层就会学习到非语境化的语言。前面提到的只包含文本的路径可以借助非语境化层提升性能；总之，这比单纯使用文本训练的模型训练速度更快，且具备更好的定量和定性的模型性能。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">软件包包含的模型权重是基于（通过 BigQuery）在 Reddit 上提交的成千上万的文本文档训练的，它们来自各种各样的 subreddit 板块。此外，该网络还采用了上文提到的非语境方法，从而提高训练的性能，同时减少作者的偏见。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">当使用 textgenrnn 在新的文本数据集上对模型进行微调时，所有的层都会被重新训练。然而，由于原始的预训练网络最初具备鲁棒性强得多的「知识」，新的 textgenrnn 最终能够训练地更快、更准确，并且可以学习原始数据集中未出现的新关系。（例如：预训练的字符嵌入包含所有可能的现代互联网语法类型中的字符语境。）</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">此外，重新训练是通过基于动量的优化器和线性衰减的学习率实现的，这两种方法都可以防止梯度爆炸，并且大大降低模型在长时间训练后发散的可能性。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><strong><span style="font-size: 14px;">注意事项</span></strong></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">即使使用经过严格训练的神经网络，你也不能每次都能得到高质量的文本。这就是使用神经网络文本生成的博文（http://aiweirdness.com/post/170685749687/candy-heart-messages-written-by-a-neural-network）或推文（https://twitter.com/botnikstudios/status/955870327652970496）通常生成大量文本，然后挑选出最好的那些再进行编辑的主要原因。</span></p><p style="text-align: justify;line-height: 1.75em;"><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">不同的数据集得到的结果差异很大。因为预训练的神经网络相对来说较小，因此它不能像上述博客展示的 RNN 那样存储大量的数据。为了获得最佳结果，请使用至少包含 2000-5000 个文档的数据集。如果数据集较小，你需要在调用训练方法和／或从头开始训练一个新模型时，通过调高 num_epochs 参数来对模型进行更长时间的训练。即便如此，目前也没有一个判断模型」好坏」的启发式方法。</span></p><p style="text-align: justify;line-height: 1.75em;"><br></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">你并不一定需要用 GPU 重新训练 textgenrnn，但是在 CPU 上训练花费的时间较长。如果你使用 GPU 训练，我建议你增加 batch_size 参数，获得更好的硬件利用率。</span></p><p><br></p><p style="text-align: justify;line-height: 1.75em;"><strong><span style="font-size: 14px;">未来计划</span></strong></p><p><br></p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">更多正式文档；</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">一个使用 tensorflow.js 的基于 web 的实现（由于网络规模小，效果特别好）；</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">一种将注意力层输出可视化的方法，以查看神经网络是如何「学习」的；</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">有监督的文本生成模式：允许模型显示 top n 选项，并且由用户选择生成的下一个字符/单词（https://fivethirtyeight.com/features/some-like-it-bot/）；</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">一个允许将模型架构用于聊天机器人对话的模式（也许可以作为单独的项目发布）；</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">对语境进行更深入的探索（语境位置 + 允许多个语境标签）；</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">一个更大的预训练网络，它能容纳更长的字符序列和对语言的更深入理解，生成更好的语句；</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">层次化的作用于词级别模型的 softmax 激活函数（Keras 对此有很好的支持）；</span></p></li><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">在 Volta／TPU 上进行超高速训练的 FP16 浮点运算（Keras 对此有很好的支持）。</span></p></li></ul><p><br></p><p style="text-align: justify;line-height: 1.75em;"><strong><span style="font-size: 14px;">使用 textgenrnn 的项目</span></strong></p><p><br></p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;">Tweet Generator：训练一个为任意数量的 Twitter 用户生成推文而优化的神经网络。<img class="" data-ratio="0.3287671232876712" src="https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gW8Zfpicd40EribGuaFicDBCRH6IOu1Rnc4T3W3J1wE0j6kQ6GorRSgicib0fmNrj3yzlokup2jia9Z0YVeA/640?wx_fmt=png" data-type="png" data-w="73" style="color: rgb(62, 62, 62);font-size: 14px;text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);caret-color: rgb(62, 62, 62);box-sizing: border-box !important;word-wrap: break-word !important;visibility: visible !important;width: 48px !important;" width="48px"></span></p></li></ul><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"></span></p><p style="text-align: justify;line-height: 1.75em;"><span style="font-size: 14px;"><br></span></p><p style="max-width: 100%;min-height: 1em;color: rgb(62, 62, 62);font-size: 16px;white-space: normal;background-color: rgb(255, 255, 255);box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;text-align: justify;line-height: 25.6px;font-family: 微软雅黑;font-size: 14px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(127, 127, 127);box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;color: rgb(62, 62, 62);line-height: 25.6px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(127, 127, 127);box-sizing: border-box !important;word-wrap: break-word !important;">本文为机器之心编译，<strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;">转载请联系本公众号获得授权</span></strong></span></strong>。</span></strong><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></p><p style="margin-bottom: 5px;max-width: 100%;min-height: 1em;color: rgb(62, 62, 62);white-space: normal;background-color: rgb(255, 255, 255);font-size: 18px;line-height: 1.75em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(127, 127, 127);line-height: 25.6px;font-family: 微软雅黑;text-align: justify;box-sizing: border-box !important;word-wrap: break-word !important;">✄------------------------------------------------</span></p><p style="margin-bottom: 5px;max-width: 100%;min-height: 1em;color: rgb(62, 62, 62);white-space: normal;background-color: rgb(255, 255, 255);font-size: 18px;font-family: 微软雅黑;text-align: center;line-height: 1.75em;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(217, 33, 66);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">加入机器之心（全职记者/实习生）：hr@jiqizhixin.com</span></strong></p><p style="max-width: 100%;min-height: 1em;color: rgb(62, 62, 62);white-space: normal;background-color: rgb(255, 255, 255);font-size: 18px;font-family: 微软雅黑;text-align: center;line-height: 1.75em;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(217, 33, 66);line-height: 1.6;font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">投稿或寻求报道：editor@jiqizhixin.com</span></strong></p><p style="max-width: 100%;min-height: 1em;color: rgb(62, 62, 62);white-space: normal;background-color: rgb(255, 255, 255);font-size: 18px;font-family: 微软雅黑;text-align: center;line-height: 1.75em;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 12px;color: rgb(217, 33, 66);line-height: 1.6;box-sizing: border-box !important;word-wrap: break-word !important;">广告&amp;商务合作：bd@jiqizhixin.com</span></strong></p>
                </div>
                <script nonce="1200783855" type="text/javascript">
                    var first_sceen__time = (+new Date());

                    if ("" == 1 && document.getElementById('js_content')) {
                        document.getElementById('js_content').addEventListener("selectstart",function(e){ e.preventDefault(); });
                    }

                    
                    (function(){
                        if (navigator.userAgent.indexOf("WindowsWechat") != -1){
                            var link = document.createElement('link');
                            var head = document.getElementsByTagName('head')[0];
                            link.rel = 'stylesheet';
                            link.type = 'text/css';
                            link.href = "//res.wx.qq.com/mmbizwap/zh_CN/htmledition/style/page/appmsg/page_mp_article_improve_winwx3d171e.css";
                            head.appendChild(link);
                        }
                    })();
                </script>
                
                
                                
                <div class="ct_mpda_wrp" id="js_sponsor_ad_area" style="display:none;"></div>

                
                                <div class="reward_area tc" id="js_preview_reward" style="display:none;">
                    <p id="js_preview_reward_wording" class="tips_global reward_tips" style="display:none;"></p>
                    <p>
                        <a class="reward_access" id="js_preview_reward_link" href="##"><span class="icon-reward"></span>赞赏</a>

                    </p>
                </div>
                <div class="reward_qrcode_area reward_area tc" id="js_preview_reward_qrcode" style="display:none;">
                    <p class="tips_global">长按二维码向我转账</p>
                    <p id="js_preview_reward_ios_wording" class="reward_tips" style="display:none;"></p>
                    <span class="reward_qrcode_img_wrp"><img class="reward_qrcode_img" src="//res.wx.qq.com/mmbizwap/zh_CN/htmledition/images/pic/appmsg/pic_reward_qrcode.2x3534dd.png"></span>
                    <p class="tips_global">受苹果公司新规定影响，微信 iOS 版的赞赏功能被关闭，可通过二维码转账支持公众号。</p>
                </div>
                            </div><div class="rich_media_tool" id="js_toobar3">
                
                                
                                            <div id="js_read_area3" class="media_tool_meta tips_global meta_primary" style="display:none;">阅读 <span id="readNum3"></span></div>

                <span style="display:none;" class="media_tool_meta meta_primary tips_global meta_praise" id="like3">
                    <i class="icon_praise_gray"></i><span class="praise_num" id="likeNum3"></span>
                </span>

                <a id="js_report_article3" style="display:none;" class="media_tool_meta tips_global meta_extra" href="##">投诉</a>

            </div><div class="rich_media_tool" id="js_sg_bar">
                
                                
                                
            </div>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
