<p><b>本文由陈智罡博士撰写</b></p><p class="ztext-empty-paragraph"><br/></p><p>整个技术论文分为10部分：</p><p class="ztext-empty-paragraph"><br/></p><p>1 Introduction--引言</p><p><b>2 Logical Data Model--逻辑数据模型</b></p><p>3 Executing Transactions--交易的执行</p><p>4 Authenticated Data Structures and Storage--可认证的数据结构和存储</p><p>5 Byzantine Fault Tolerant Consensus--拜占庭容错共识</p><p>6 Networking--网络</p><p>7 Libra Core Implementation-- Libra 内核实现</p><p>8 Performance--性能</p><p>9 Implementing Libra Ecosystem Policies with Move--使用Move实现Libra生态系统规则</p><p>10 What&#39;s Next for Libra?-- Libra发展规划</p><p>在比特币里面有个很重要的概念：时间戳。通过时间戳把交易与时间绑定，时间戳还控制着整个比特币系统运行的节奏。我们在解读比特币白皮书的文章里（<a href="https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzU3MTYzMjMzNA%3D%3D%26mid%3D2247483780%26idx%3D1%26sn%3D450c2d939ba1906a461febdfee8883a6%26chksm%3Dfcdc7e25cbabf733efa192ebdb7833145b928b77edf5ebe9b3ee58fdc1dd56233fa1cf9e1cd1%26token%3D235019033%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect" class=" wrap external" target="_blank" rel="nofollow noreferrer">解析比特币白皮书之时间戳服务</a>）详细解释了其背后的含义。</p><p>Libra区块链是一个数据库，如何把数据与时间进行挂钩，交易与时间的关系，以及历史交易如何查询（也是一个与时间有关的问题），这些都属于数据逻辑模型需要阐述的。</p><p><b>Libra区块链中的所有数据都对应于数据库的某一个版本号</b>，数据库的版本号表明了该数据库在某一段时间的状态。所以在描述Libra区块链中的交易时，必须指明是在哪一个版本状态下进行的。</p><p>一个版本号是一个无符号64位整数，与系统执行的交易数量相对应。</p><p><b>所以在Libra区块链中，通过一个三元组(<i>Ti</i>，<i>Oi</i>，<i>Si</i>)</b> <b>来刻画交易的状态</b>。其中<i>Ti</i> 表示当前的交易，<i>Oi</i>表示交易执行的结果，<i>Si</i> 表示账本状态。通过这三个元素刻画了交易的状态。例如对执行某个交易的操作Apply，可以用三元组来刻画，即在账本状态<i>Si</i>-1下执行交易<i>Ti</i> ，执行的结果为<i>Oi</i> ，新的账本状态是<i>Si</i> 。形式化表示为：</p><p class="ztext-empty-paragraph"><br/></p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-5b1f85f3c7e47f77e39a6eaf09e1f74c_b.jpg" data-caption="" data-size="normal" data-rawwidth="575" data-rawheight="111" class="origin_image zh-lightbox-thumb" width="575" data-original="https://pic1.zhimg.com/v2-5b1f85f3c7e47f77e39a6eaf09e1f74c_r.jpg"/></noscript><img src="https://pic1.zhimg.com/v2-5b1f85f3c7e47f77e39a6eaf09e1f74c_b.jpg" data-caption="" data-size="normal" data-rawwidth="575" data-rawheight="111" class="origin_image zh-lightbox-thumb lazy" width="575" data-original="https://pic1.zhimg.com/v2-5b1f85f3c7e47f77e39a6eaf09e1f74c_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-5b1f85f3c7e47f77e39a6eaf09e1f74c_b.jpg"/></figure><p class="ztext-empty-paragraph"><br/></p><p class="ztext-empty-paragraph"><br/></p><p>Libra协议通过Move语言实现区块链支付系统中对操作的执行。本节主要关注带有版本号的数据库。通过版本号控制的数据库允许验证者完成以下操作：</p><p><b>1. 在最新版本的账本下，执行某个交易</b></p><p><b>2. 对客户查询当前以及历史账本记录做出响应</b></p><p>问题来了，能够反映某个版本下的账本数据结构应该是什么样的呢？为什么要让账本的历史数据都是可查的呢？</p><p class="ztext-empty-paragraph"><br/></p><p>首先从账本状态说起。</p><p class="ztext-empty-paragraph"><br/></p><figure data-size="small"><noscript><img src="https://pic2.zhimg.com/v2-4296fc5fa71c7d958dc533b29352f7ed_b.jpg" data-caption="" data-size="small" data-rawwidth="960" data-rawheight="585" class="origin_image zh-lightbox-thumb" width="960" data-original="https://pic2.zhimg.com/v2-4296fc5fa71c7d958dc533b29352f7ed_r.jpg"/></noscript><img src="https://pic2.zhimg.com/v2-4296fc5fa71c7d958dc533b29352f7ed_b.jpg" data-caption="" data-size="small" data-rawwidth="960" data-rawheight="585" class="origin_image zh-lightbox-thumb lazy" width="960" data-original="https://pic2.zhimg.com/v2-4296fc5fa71c7d958dc533b29352f7ed_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-4296fc5fa71c7d958dc533b29352f7ed_b.jpg"/></figure><p><b>账本状态</b></p><p>账本状态根本上反映了Libra系统的客观状态。例如在某个时间某个用户持有多少Libra 币（当然这里时间是通过版本号来反映的）。而且为了执行交易，验证者必须知道目前账本的状态。</p><p>所以账本状态是执行操作依赖的基础，也是反映Libra系统的状态晴雨表。</p><p>Libra协议采用的是基于账户的模型。这是与比特币不同的地方，比特币采用的UTXO模型可以参考我们的比特币白皮书解析文章（<a href="https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzU3MTYzMjMzNA%3D%3D%26mid%3D2247483759%26idx%3D1%26sn%3Df780b496c5961277bb6e5c533e4ca410%26chksm%3Dfcdc7ececbabf7d83d866d7deb01462d2be0df583bafb4242c723030bea95e2760247ed4cbaf%26token%3D235019033%26lang%3Dzh_CN%26scene%3D21%23wechat_redirect" class=" wrap external" target="_blank" rel="nofollow noreferrer">解析比特币白皮书之交易</a>）。</p><p>账本状态通过“键值对”存储在数据库中。学过数据库的人对“键值对”的概念不陌生。键值对将<b>账户地址</b>(key)映射到<b>账户值</b>(value)。<b>账户值是由已发布的Move资源和模块构成</b>，其中Move资源存储的是数据值，而模块存储的是代码。账户的初始状态是由创世块赋值。</p><p>下面解释账户地址。</p><p><b>账户地址</b></p><p>账户地址是一个长度为256位的值。为了建立一个账户，首先需要用户生成一个公钥私钥对(vk, sk)，公钥 vk用于验证，私钥sk 用于签名。通过对公钥vk计算哈希值后产生一个账户地址a = H(vk)。</p><p>当某个账户将一笔交易发送给某个用户时，将调用create_account(a) Move指令产生一个账户，该新账户与这个用户对应。这种情况一般是发生在交易产生时，目标地址a还没有账户的情况下。</p><p><b>注意有了地址，还需要创建与之对应的账户</b>。</p><p>一旦账户建立后，用户就可以使用该账户下的私钥sk 对交易签名。有时为了防止密钥可能被攻击的危险，可以采用密钥替换机制，每隔一段时间采用新密钥，终止原密钥的使用。当然使用新密钥意味着需要建立新的账户地址。所以一个用户可以有多个账户。</p><p><b>Libra协议允许一个用户建立多个账户</b>，而且不会把账户与现实世界的身份对应起来。属于统一用户的账户之间没有关联关系。<b>因此Libra协议提供了一种伪匿名的特性，与比特币和以太坊类似。</b></p><p>如果读完后感觉有收获，请点个赞！</p><a href="https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzU3MTYzMjMzNA%3D%3D%26mid%3D2247485153%26idx%3D1%26sn%3D5444b14aaf3948fd34576e2c0a1404f8%26chksm%3Dfcdc7940cbabf05661d61bd9d20a4b72af44ff107c4f954d56dba09f6f77d796a34fa23961b3%26token%3D235019033%26lang%3Dzh_CN%23rd" data-draft-node="block" data-draft-type="link-card" class=" wrap external" target="_blank" rel="nofollow noreferrer">Libra区块链论文解析4-数据逻辑模型-part 1</a><hr/><p><b>文章首发在微信公众号：btc201800</b><br/><b>知识星球ID：28018093</b><br/><br/><b>音频发布在喜马拉雅上“区块链杂谈 (第2季)”</b> <b><u><a href="https://link.zhihu.com/?target=http%3A//xima.tv/Bjq4se" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">http://</span><span class="visible">xima.tv/Bjq4se</span><span class="invisible"></span></a></u></b><br/><b>解读区块链白皮书</b> <u><a href="https://link.zhihu.com/?target=http%3A//xima.tv/RNU1Q8" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">http://</span><span class="visible">xima.tv/RNU1Q8</span><span class="invisible"></span></a></u><br/><br/><b>宁波格密链网络科技有限公司，专注于区块链上的密码技术研发。</b></p>