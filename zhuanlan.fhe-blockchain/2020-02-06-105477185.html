<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>全同态加密数学基础—分圆多项式-1</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/105477185">原文</a></p>
<p>本文由陈智罡博士撰写</p><p>在全同态加密论文中，分圆多项式经常会用到。例如在定义全同态加密算法的明文和密文空间时，以及明文槽的定义时。如下：</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-604911c702d91766435a35e3662179d9_b.png" data-caption="" data-size="normal" data-rawwidth="864" data-rawheight="78" class="origin_image zh-lightbox-thumb" width="864" data-original="https://pic2.zhimg.com/v2-604911c702d91766435a35e3662179d9_r.jpg"/></noscript><img src="https://pic2.zhimg.com/v2-604911c702d91766435a35e3662179d9_b.png" data-caption="" data-size="normal" data-rawwidth="864" data-rawheight="78" class="origin_image zh-lightbox-thumb lazy" width="864" data-original="https://pic2.zhimg.com/v2-604911c702d91766435a35e3662179d9_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-604911c702d91766435a35e3662179d9_b.png"/></figure><p>这里</p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-59c4c4020584ccfef96755aa521226d3_b.png" data-caption="" data-size="normal" data-rawwidth="345" data-rawheight="56" class="content_image" width="345"/></noscript><img src="https://pic4.zhimg.com/v2-59c4c4020584ccfef96755aa521226d3_b.png" data-caption="" data-size="normal" data-rawwidth="345" data-rawheight="56" class="content_image lazy" width="345" data-actualsrc="https://pic4.zhimg.com/v2-59c4c4020584ccfef96755aa521226d3_b.png"/></figure><p>中的</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-9ce35a97db36b434068750dd48e61f69_b.png" data-caption="" data-size="normal" data-rawwidth="134" data-rawheight="46" class="content_image" width="134"/></noscript><img src="https://pic2.zhimg.com/v2-9ce35a97db36b434068750dd48e61f69_b.png" data-caption="" data-size="normal" data-rawwidth="134" data-rawheight="46" class="content_image lazy" width="134" data-actualsrc="https://pic2.zhimg.com/v2-9ce35a97db36b434068750dd48e61f69_b.png"/></figure><p>就是一个分圆多项式。</p><p>使用分圆多项式的好处是：一方面保证了环LWE问题的分布随机性，另外一方面能够提高计算效率。此外在全同态加密中，利用分圆多项式的分解特性，可以结合中国剩余定理将多个明文打包到一个密文中。</p><p>因此分圆多项式的理解在全同态加密中非常重要。下面分析一下分圆多项式的来由以及分解特性。</p><p>首先看看什么是单位根。</p><p>我们把满足于 xn = 1的根称为n次单位根，其中n=1,2,3……。</p><p>所以如果z是一个n 次单位根，则满足 <i>z</i>n = 1。</p><p>另外<b>单位原根</b>的概念经常会用到，即：</p><p>如果n 次单位根是<b>原根</b>的话， 则n是满足 <i>z</i>n = 1的最小幂，即任何0&lt;k&lt;n都有<i>z</i>k ≠1成立。</p><p>以下都假设 <i>z</i>是n 次单位根。则有如下一个性质：</p><p>如果z是n 次单位根，则z的整数幂也是n 次单位根，注意不是原根</p><p>这是因为：</p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-bebb5f867611129ced7c522ddb8dfbfb_b.png" data-caption="" data-size="normal" data-rawwidth="353" data-rawheight="47" class="content_image" width="353"/></noscript><img src="https://pic4.zhimg.com/v2-bebb5f867611129ced7c522ddb8dfbfb_b.png" data-caption="" data-size="normal" data-rawwidth="353" data-rawheight="47" class="content_image lazy" width="353" data-actualsrc="https://pic4.zhimg.com/v2-bebb5f867611129ced7c522ddb8dfbfb_b.png"/></figure><p>此外，还有一个重要性质：</p><p>如果z是n 次单位原根，则z的整数幂： <i>z</i>, <i>z</i>2, ..., <i>zn</i>−1, <i>zn</i> = <i>z</i>0 = 1都是互不相同的。</p><p>这说明了一个重要的特征：z相当于生成元。</p><p>而且n在这里相当于模，每次计算到n次就循环往复。</p><p>那么既然当z是n 次单位根时，则z的整数幂也是n 次单位根。而我们更重视的是原根，问题就来了：</p><p>在<i>z</i>, <i>z</i>2, ..., <i>zn</i>−1, <i>zn</i> = <i>z</i>0 = 1这些根中，哪些是n 次原根？</p><p>这个问题转化为更加通用的问题：对于整数k，什么时候<i>z</i>k是a次原根？</p><p>假设存在这样的a，有 <i>z</i>ka＝1。由于z是n次原根，所以</p><p>ka＝n（mod n）</p><p>即ka是n的倍数，且满足n&lt;= ka，a&lt;＝n。如果a&gt;n就没意义了，因为<i>z</i>kn＝1,<i> z</i>k本身就是n次根。现在是要找<i>z</i>k的原根，所以a&lt;＝n。</p><p>现在我们固定k和n，寻找a。</p><p>由于ka是n的倍数，所以既含有k又含有n，而且是最小的，因此是 k和n的最小公倍数：记为lcm(k,n)。</p><p>根据最大公约数与最小公倍数公式，有：kn=gcd(k,n) ▪ lcm(k,n)</p><p>从而lcm(k,n)=kn/gcd(k,n)，即当a＝n/gcd(k,n) 时，<i>z</i>k是a次原根。</p><p>例如k=1，a=n，z是n次原根，依次类推。</p><p>当 k和n互素的时候，zk是n次原根。记为φ(n)欧拉函数，那么一共有φ(n)个n次单位原根。</p><p>根据 </p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-5d251d9f494cefb9e5d08bb90f03c5ba_b.png" data-caption="" data-size="normal" data-rawwidth="198" data-rawheight="96" class="content_image" width="198"/></noscript><img src="https://pic3.zhimg.com/v2-5d251d9f494cefb9e5d08bb90f03c5ba_b.png" data-caption="" data-size="normal" data-rawwidth="198" data-rawheight="96" class="content_image lazy" width="198" data-actualsrc="https://pic3.zhimg.com/v2-5d251d9f494cefb9e5d08bb90f03c5ba_b.png"/></figure><p>可知：在z, z2 ,… , zn-1中，如果k与n互素，则zk是n次单位原根。除此之外，那些与n不互素的k，一定是某个a次单位原根，其中<b>a是n的一个因子</b>。</p><p>例如n=12=2*2*3，其因子有6个：1,2,3,4,6,12。</p><p>与n互素的元素有4个： 1,5,7,11</p><p>即有φ(n)= 4个n次原根：z，z5，z7，z11</p><p>与n不互素的元素有7个：2,3,4,6,8,9,10</p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-f3dfb58eb73d0f152b83c02816c64ede_b.jpg" data-caption="" data-size="normal" data-rawwidth="925" data-rawheight="381" class="origin_image zh-lightbox-thumb" width="925" data-original="https://pic3.zhimg.com/v2-f3dfb58eb73d0f152b83c02816c64ede_r.jpg"/></noscript><img src="https://pic3.zhimg.com/v2-f3dfb58eb73d0f152b83c02816c64ede_b.jpg" data-caption="" data-size="normal" data-rawwidth="925" data-rawheight="381" class="origin_image zh-lightbox-thumb lazy" width="925" data-original="https://pic3.zhimg.com/v2-f3dfb58eb73d0f152b83c02816c64ede_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-f3dfb58eb73d0f152b83c02816c64ede_b.jpg"/></figure><p>也就是说，n次<b>单位根</b>其实都是由原根构成：一方面由n次单位原根构成（例如z是n次单位原根。此外当k与n互素，则zk是n次单位原根。），另外一方面由n的因子为次数的单位原根构成。有如下公式：</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-7dd887b8598c6d0ac4b0fcca9911cbc4_b.jpg" data-caption="" data-size="normal" data-rawwidth="241" data-rawheight="101" class="content_image" width="241"/></noscript><img src="https://pic1.zhimg.com/v2-7dd887b8598c6d0ac4b0fcca9911cbc4_b.jpg" data-caption="" data-size="normal" data-rawwidth="241" data-rawheight="101" class="content_image lazy" width="241" data-actualsrc="https://pic1.zhimg.com/v2-7dd887b8598c6d0ac4b0fcca9911cbc4_b.jpg"/></figure><p>其中</p><p>P(n) 表示 n次单位原根的个数,有φ(n)个</p><p>P(d) 表示d次单位原根的个数,有φ(d)个</p><p>而n次单位根一共有n个，所以有</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-55adae294beff923d9c208401dc9fdcc_b.jpg" data-caption="" data-size="normal" data-rawwidth="246" data-rawheight="90" class="content_image" width="246"/></noscript><img src="https://pic1.zhimg.com/v2-55adae294beff923d9c208401dc9fdcc_b.jpg" data-caption="" data-size="normal" data-rawwidth="246" data-rawheight="90" class="content_image lazy" width="246" data-actualsrc="https://pic1.zhimg.com/v2-55adae294beff923d9c208401dc9fdcc_b.jpg"/></figure><p>待续。。。。。。。。。。。。。。。</p><p>格密链一直致力于全同态加密与区块链技术的研发。</p><a href="https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzU3MTYzMjMzNA%3D%3D%26mid%3D2247485606%26idx%3D1%26sn%3Da4a36727f2b038c2b23a036785e34f93%26chksm%3Dfcdc7707cbabfe1198dc2b95177e77c05ac65a3aa9304c2cc97441d03b164714b87d7f860b58%26token%3D1053722773%26lang%3Dzh_CN%23rd" data-draft-node="block" data-draft-type="link-card" data-image="https://pic4.zhimg.com/v2-6f3bab89e33cea5ab818da1bc308ebd7_180x120.jpg" data-image-width="719" data-image-height="305" class=" wrap external" target="_blank" rel="nofollow noreferrer">全同态加密数学基础—分圆多项式-1</a><hr/><p><b>文章首发在微信公众号：btc201800</b><br/><b>知识星球ID：28018093</b><br/><br/><b>音频发布在喜马拉雅上“区块链杂谈 (第2季)”</b> <b><u><a href="https://link.zhihu.com/?target=http%3A//xima.tv/Bjq4se" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">http://</span><span class="visible">xima.tv/Bjq4se</span><span class="invisible"></span></a></u></b><br/><b>解读区块链白皮书</b> <u><a href="https://link.zhihu.com/?target=http%3A//xima.tv/RNU1Q8" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">http://</span><span class="visible">xima.tv/RNU1Q8</span><span class="invisible"></span></a></u></p>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
