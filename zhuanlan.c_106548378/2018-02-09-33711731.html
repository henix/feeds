<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>关于lasso/ridge/pca对过度拟合的比较</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/33711731">原文</a></p>
<p>骑士金融建模最担心的一点是过度拟合，一般常见的减少过度拟合的方法是正则化，比如lasso/ridge/pca regression等等，现在简单对比一下。</p><p>一般统计背景的人喜欢lasso，因为统计研究的问题样本会比较小，比如几十个病人，但银子会比较多，比如几万个基因，那么到底哪个基因导致生病呢？</p><p>对于这类参数的数目p远远大于样本的数目n（及p&gt;&gt;n）的高维统计问题，一般来说只能用lasso了，因为其它涉及矩阵求逆运算的无法操作。</p><p>在金融里面，或许也会出现这种情况。比如有篇论文就是说，2000只股票，要动态预测下一分钟的价格变化，然后用的因子是过去3分钟每分钟的价格变化，此时因子数是2000*3=6000，样本数是2000，可见就是p&gt;&gt;n了，这时候当然是用lasso的。</p><p>lasso这类又叫稀疏性建模（sparsity），因为它会让很多因子的系数变成零，只保留一部分因子，比如几千个变成10-20个。那么，是保留哪些删除哪些呢？其实，最直观的方法，<b>当然是保留系数最大的，</b>系数小的因子很可能是噪音。</p><p>但有些人会说，因子取值的幅度本来就很不一样，比如有的因子是-1到1，有的是-10到10，那么系数肯定会很不一样。因此，在使用lasso之前，有必要对因子的取值幅度进行调整，这样计算出来的系数才具有可比性。</p><p>事实上，哪怕大家都是过去1分钟的收益，有的股票波动大，取值就大，系数反而可能更小，这些就需要调整一下。</p><p>ridge跟lasso不大一样，<b>它不会删除因子，但是会对因子的取值幅度进行压缩</b>。如果做主成分分析，会发现它会对每个特征向量进行相同操作的压缩，这样特征值小的特征向量会被压缩得最厉害，比如压缩比例是(d/(d+lambda）,如果d是100，lambda是1，自然没啥变化，从1变成100/101；但如果d是0.5，lambda不变的还是1，那么就变成1/3，自然被压缩得更厉害。因此，其实这类压缩还是要求因子取值幅度最好差不多，这样系数也差不多，压缩起来才更有意义。</p><p>其实很多人喜欢ridge，是因为绝大多数情况下其实它跟lasso也差不多，特别是样本数远大于因子数的情况，几千个样本，几十个因子，ridge计算快得多，直接矩阵求逆，简单粗暴，也未必不好。如果是那种精心设计的因子，比如就几十个因子，数值都调整好，偏度、峰度、正态化、去极值等等，而且普遍适用多个品种，在经济学上也有意义，这样用ridge当然是好的，比如很多cross sectional regression，几十个因子，几千只股票，当然是不大需要稀疏化那一套的。</p><p>但现在很多公司喜欢大量训练因子，几万、几十万、几百万的因子库，而样本数目往往没有这么多，所以这时候ridge就未必有什么好处。比如另外一个极端简单粗暴的公司，数据驱动，没那么多时间打磨因子，反正买了无数台机器，硬盘空间大，计算设备充足，反正就批量自动化产生这些因子，不同数据套差不多的公式，然后简单的相关性过滤，比如跟目标变量的相关性大于3%（日线），但跟已有因子的相关性小于70%等，这样就可以进入因子库，然后再直接一个lasso类型的模型去筛选。</p><p>所以说，lasso选出来的一般都是短期有效的因子，这么简单粗暴弄出来的，很难长期稳定有效，但反正因子数量庞大，任何时候总有合适的；ridge的话，本来备选因子库就不会很大，所以因子质量首先就需要高一些，比如较长期稳定的，然后只是适当弱化，使之更适应最近的行情而已。</p><p>最后就是主成分回归，其实本质上也是为了防止过度拟合。比如主成分的最大数量就是特征值的数量，一般也就是因子的个数。跟ridge不同的地方在于，它并不是对小的特征值进行收缩，而是对小的特征值直接去掉不要了。因此，<b>它既有ridge关于主成分的特点，又有lasso稀疏化的成分。</b>比如很多人认为lasso的各个因子多多少少存在相关性，这在因子设计中很难避免；但提取主成分就不同了，每个特征向量都是垂直的，这就避免了因子之间的相关性，或许在预测中也更有优势。</p><p>其实也可以主成分跟lasso相结合的，比如主成分产生了一系列因子，本质上就是原本因子的线性组合；如果原本因子取值幅度差不多，其实产生的这些主成分，哪怕幅度不同，也可以进行一定的压缩，使之幅度差不多，但方向不变，所以还是垂直的。<b>然后就可以用这些主成分进行回归，再套用lasso把系数取值小的删掉</b>，或许效果会更好，因为这进一步降低了对因子质量的要求。</p><p></p><p></p><p></p>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
