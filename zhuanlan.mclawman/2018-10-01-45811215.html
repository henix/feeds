<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>哈希算法</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/45811215">原文</a></p>
<div class="title-image"><img src="https://pic1.zhimg.com/v2-8af4ce64d6b2e6b67e18b79acc14361b_r.jpg" alt=""></div><p>咱们作为非计算机专业的人去看一些区块链相关的技术资料的时候，经常会被一些讨厌的术语挡在门外。这次咱们聊的哈希就是非常重要的一个。哈希是密码学的基础，理解哈希是理解数字签名和加密通信等技术的必要前提。</p><h2>基本含义</h2><p>先来从基本定义入手。哈希，英文是 hash ，本来意思是”切碎并搅拌“，有一种食物就叫 Hash ，就是把食材切碎并搅拌一下做成的。哈希函数的运算结果就是哈希值，通常简称为哈希。哈希函数有时候也翻译做散列函数，也就是把数据拆散然后重新排列。</p><p><br></p><img src="https://pic3.zhimg.com/v2-c11cbea71a546fa13b3e8b4fe659e0da_r.jpg" data-caption="" data-size="normal" data-rawwidth="2880" data-rawheight="1800" data-watermark="watermark" data-original-src="v2-c11cbea71a546fa13b3e8b4fe659e0da" data-watermark-src="v2-011a2f6e7339000f35caddcd4797e19b" data-private-watermark-src=""><p><br></p><p>根据维基百科的定义，哈希函数要做的事情是给一个任意大小的数据生成出一个固定长度的数据，作为它的映射。所谓映射就是一一对应。一个可靠的哈希算法要满足三点。第一是安全，给定数据 M 容易算出哈希值 X ，而给定 X 不能算出 M ，或者说哈希算法应该是一个单向算法。第二是独一无二，两个不同的数据，要拥有不相同的哈希。第三是长度固定，给定一种哈希算法，不管输入是多大的数据，输出长度都是固定的。但是仔细想一下，如果哈希的长度是固定的，也就是取值范围是有限的，而输入数据的取值范围是无限的，所以总会找到两个不同的输入拥有相同的哈希。所以，哈希函数的安全性肯定是个相对概念。如果出现了两个不同输入有相同输出的情况，就叫碰撞，collision 。不同的哈希算法，哈希位数越多，也就基本意味着安全级别越高，或者说它的”抗碰撞性“就越好。</p><p>再来说说哈希函数的主要作用。哈希的独一无二性，保证了如果数据在存储或者传输过程中有丝毫损坏，那么它的哈希就会变。哈希函数的主要作用就是进行完整性校验，完整的意思是数据无损坏。哈希有很多不同的称呼，有时候叫 digest 摘要，有时候叫 Checksum 校验值，有时候叫 fingerprint 指纹，其实说的意思差不多，就是用哈希来代表数据本身进行对比，根据对比结果判断数据是否保持不变。</p><p>所以说，哈希函数的基本作用就是给大数据算出一个摘要性的长度固定的字符串，也就是所谓的哈希。哈希的作用主要是进行完整性校验。</p><h2>哈希算法的分类</h2><p>下一步我们把哈希函数分类，更细致的聊聊哈希算法的特点。首先说哈希算法有很多种，例如 md5 ，sha256 等等，但是它们总体上可以分为两大类，一类是普通哈希，另外一类是加密哈希，cryptographic hash function 。</p><p>业界可以找到的哈希算法是有很多种的。我们可以大致按照输出的哈希的长度来聊，虽然哈希算法的安全性也不单单是跟哈希长度有关。例如 CRC-32 的输出是32 bit，也就是32位的二进制数，表示成十六进制就是8位。MD5 算法的哈希是32位16进制数，比较常见。SHA-256是256个 Bit ，十六进制表示就是64位。这些算法可以分成普通哈希和加密哈希算法，两种算法之间没有特别明显的区别。例如本来 MD5 就是设计出来做加密哈希的，但是后来由于计算机的发展 MD5 出现碰撞的可能性就很大了，所以目前 MD5 只能当普通哈希用，用来做数据校验。加密哈希跟普通哈希的区别就是安全性，一般原则是只要一种哈希算法出现过碰撞，就会不被推荐成为加密哈希了，只有安全度高的哈希算法才能用作加密哈希。同时加密哈希其实也能当普通哈希来用，Git 版本控制工具就是用 SHA1 这个加密哈希算法来做完整性校验的。一般来讲越安全的哈希算法，处理速度也就越慢，所以并不是所有的场合都适合用加密哈希来替代普通哈希。</p><p><br></p><img src="https://pic4.zhimg.com/v2-a2a43e77f13adf670795ffe7c04af3ed_r.jpg" data-caption="" data-size="normal" data-rawwidth="2880" data-rawheight="1800" data-watermark="watermark" data-original-src="v2-a2a43e77f13adf670795ffe7c04af3ed" data-watermark-src="v2-1b45a7ce475bab7f5904a7c225d3b0a6" data-private-watermark-src=""><p><br></p><p>在密码学领域，有两个算法都是把数据做输入，而输出是一段谁也看不懂的数据。其中一个就是哈希算法，另外一个是加密算法。注意，哈希算法和加密算法是完全不同的。首先哈希算法的输出长度是固定的，而加密算法的输出长度是跟数据本身长度直接相关的，第二，哈希是不可以逆向运算出数据的，而加密算法的输出是要能够逆向运算出数据的。关于加密算法，我们这里就不展开聊了。Peter 这里主要是强调加密哈希算法只是被用在加密过程中，但是它本身不是加密算法。</p><p>总之，哈希算法有很多种，长度越长的算法基本认为越安全。安全度低的哈希算法被认为是普通哈希算法，主要用来做完整性校验。安全度高的被称为加密哈希算法，会被用在加密安全领域。所谓的高低都是相对概念，例如 MD5 曾经属于加密哈希，但是目前只能用来做安全校验了。而从2017年开始，SHA-1 算法生成的加密证书也会被各大浏览器拒绝了。目前最流行的加密算法是 SHA-2 ，但是跟 SHA-1 不同，SHA-2 不是一种算法，而是一系列算法的统称，其中就包括咱们之前提过的 SHA-256 。</p><h2>实用例子</h2><p>说了这么多基础知识，最后一部分咱们聊聊哈希在现实中的应用。</p><p>首先一个场景是在注册一个网站的时候。当我们提交用户名密码的时候，用户名被会直接保存到网站公司的数据库中，但是密码却不是直接保存的，而是先把密码转换成哈希，保存到数据库中的其实是密码的哈希。所以，即使是公司后台管理人员，也拿不到用户的密码。这样，如果万一公司数据库泄露了，用户的密码依然是安全的。而当用户自己登录网站的时候，输入密码提交到服务器，服务器上进行相同的哈希运算，因为输入数据没变，所以哈希也不会变，登录也就成功了。</p><p>另外一个场景是区块链和加密货币中。比特币地址生成的时候，就用到了 SHA-256 算法，POW 也就是工作量证明，用的也是这个算法。</p><p>基本上凡是涉及到密码学的地方，都会或多或少的用到哈希函数。</p><h2>总结</h2><p>关于哈希和哈希函数，我们就聊到这里，下面来总结几句。哈希的基本作用就是提供一个数据的摘要或者指纹，通常的使用场景就是完整性校验。哈希算法有很多种，一般来讲哈希越长的算法，安全性也就越高，安全度足够高的哈希，或者说没有任何人能够成功实现碰撞的哈希，才有资格被考虑用在加密场合，而这类的哈希算法也被叫做加密哈希算法。实际中常见的哈希算法有 MD5 ，SHA-1 ，和 SHA-256 等等，其中 MD5 通常用来进行数据校验，SHA-1 曾经是加密哈希算法，但是目前已经被除名，也只能做为一种安全度更高的校验算法了。SHA-256 依然是广泛使用的加密哈希算法，在比特币生成地址以及 POW 工作量证明算法中都会用到。</p><p>参考：</p><ul><li><a href="https://www.youtube.com/watch?v=xsp--srKWKw&amp;list=PLSNNzog5eydvsPPMwn-6waomQXOOxZew4&amp;index=2">https://www.youtube.com/watch?v=xsp--srKWKw&amp;list=PLSNNzog5eydvsPPMwn-6waomQXOOxZew4&amp;index=2</a>)</li><li><a href="https://en.wikipedia.org/wiki/Hash_function">https://en.wikipedia.org/wiki/Hash_function</a></li><li><a href="https://en.wikipedia.org/wiki/Cryptographic_hash_function">https://en.wikipedia.org/wiki/Cryptographic_hash_function</a></li></ul>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
