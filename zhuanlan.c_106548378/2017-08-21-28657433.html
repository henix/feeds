<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>风控故事——当两个程序同时登录一个帐号</title>
</head>
<body>
<p><a href="https://zhuanlan.zhihu.com/p/28657433">原文</a></p>
<p>比如说一个量化交易员叫小A，他是个认真负责小心谨慎的人，每天下午收盘后为了确保夜盘启动没问题，他都自己先手动启动一下程序，确保一切无误后，才离开。毕竟这年头人力成本很高，很难派专人盯着夜盘，只能让程序自己跑，启动也只能自己启动。而且小A晚上可能也有其他活动，年轻人嘛，陪老婆也好，约一下师妹吃饭也好，很正常。</p><p>有时候可能周五下午也有很多其他事情，提前下班也很正常。比如某天下午收盘，小A重新优化了策略，一些配置文件做了修改，他想看看程序能否正常启动，于是就启动来看看，发现没问题。这时候可能领导叫小A有点事，也可能老婆突然有事，也可能某个师妹来咨询一些问题，于是小A忘记退出了，但毕竟收盘了嘛，没什么事，然后就这么过去了。</p><p>于是小A就下班了，程序还放在那，没问题，晚上开盘反正自己也会跑起来的。但晚上夜盘开始后，由于小A设置了一些自动运行的脚本程序，实盘交易程序自动启动的，它才不管之前有没有程序启动，反正到了时间我就还要再启动一次。。。其实同一个应用程序启动很多次都是可以的。然后现在两个同样的程序登录了同一个账户，他们都是交易同样的程序。</p><p>这时候，比如某品种实际持仓是0，但策略突然有个信号，理论持仓是1，于是第一个程序就去买，但第二个程序也会买，于是实际持仓变成2，但两个程序都不知道对方的存在，他们只认为现在理论持仓就应该是1，但发现貌似实际持仓怎么是2？于是又开始卖，但大家一起卖，于是卖了两手，实际持仓变成0，但各自的理论持仓都是1啊，于是又开始买。。。。</p><p>当然，小A采取了一些降低交易成本的措施，比如他知道螺纹钢日内平仓很贵，所以基本都是开仓，这么频繁开多开空，一下子就用满保证金了，然后的报单都无效，所以小A也没有太大损失。</p><p>如果是美国就比较壮观了，人家是net position based，交易所对这种一多一空直接按零处理，于是交易可以一直进行下去，直到资金耗尽。曾经著名的骑士资本40分钟亏了4亿美元，我不清楚他是不是这个问题造成的。。。。</p><p>所以说，如果多个程序多个账户多个策略，你也不知道现在系统里有神马进程在运行，也不清楚他们一起运行会产生神马结果，因此一个好方法是在开盘前先杀死所有进程，然后再启动。</p><p>所以说，<b>量化有风险，入行需谨慎</b>，有兴趣可以听听我的知乎live：</p><p><a href="https://zhihu.com/lives/876135312345137153">国内量化交易求职面试</a></p>
<script async defer="defer" src="https://www.googletagmanager.com/gtag/js?id=UA-7909075-5"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'UA-7909075-5');
</script>
<script>
var _hmt = _hmt || [];
</script>
<script async defer="defer" src="https://hm.baidu.com/hm.js?e3d40295e416616ddc21287da9646d31"></script>
</body>
</html>
